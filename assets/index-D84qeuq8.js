var Km=Object.defineProperty;var If=t=>{throw TypeError(t)};var Hm=(t,e,n)=>e in t?Km(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ht=(t,e,n)=>Hm(t,typeof e!="symbol"?e+"":e,n),zc=(t,e,n)=>e.has(t)||If("Cannot "+n);var F=(t,e,n)=>(zc(t,e,"read from private field"),n?n.call(t):e.get(t)),Ie=(t,e,n)=>e.has(t)?If("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Et=(t,e,n,r)=>(zc(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),An=(t,e,n)=>(zc(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const du=!1;var Ul=Array.isArray,Gm=Array.prototype.indexOf,ti=Array.prototype.includes,Vl=Array.from,Um=Object.defineProperty,ja=Object.getOwnPropertyDescriptor,ch=Object.getOwnPropertyDescriptors,uh=Object.prototype,Vm=Array.prototype,Wl=Object.getPrototypeOf,Pf=Object.isExtensible;function Ci(t){return typeof t=="function"}const Es=()=>{};function Wm(t){return t()}function fu(t){for(var e=0;e<t.length;e++)t[e]()}function dh(){var t,e,n=new Promise((r,a)=>{t=r,e=a});return{promise:n,resolve:t,reject:e}}function Bn(t,e,n=!1){return t===void 0?n?e():e:t}function ho(t,e){if(Array.isArray(t))return t;if(e===void 0||!(Symbol.iterator in t))return Array.from(t);const n=[];for(const r of t)if(n.push(r),n.length===e)break;return n}const In=2,Zi=4,po=8,td=1<<24,ka=16,zr=32,Ua=64,fh=128,gr=512,xn=1024,Pn=2048,Lr=4096,cr=8192,ya=16384,go=32768,Fa=65536,Mf=1<<17,vh=1<<18,As=1<<19,hh=1<<20,pa=1<<25,gs=65536,vu=1<<21,nd=1<<22,za=1<<23,Qr=Symbol("$state"),ph=Symbol("legacy props"),Ym=Symbol(""),rs=new class extends Error{constructor(){super(...arguments);ht(this,"name","StaleReactionError");ht(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};var sh;const gh=((sh=globalThis.document)==null?void 0:sh.contentType.includes("xml"))??!1;function rd(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Xm(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Zm(t,e,n){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Qm(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Jm(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function $m(t){throw new Error("https://svelte.dev/e/effect_orphan")}function ey(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ty(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function ny(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ry(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ay(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function sy(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const iy=1,oy=2,mh=4,ly=8,cy=16,uy=1,dy=2,fy=4,vy=8,hy=16,yh=1,py=2,wn=Symbol(),_h="http://www.w3.org/1999/xhtml",gy="@attach";function my(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function yy(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function bh(t){return t===this.v}function wh(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function xh(t){return!wh(t,this.v)}let vi=!1,_y=!1;function by(){vi=!0}const wy=[];function kh(t,e=!1,n=!1){return ol(t,new Map,"",wy,null,n)}function ol(t,e,n,r,a=null,s=!1){if(typeof t=="object"&&t!==null){var i=e.get(t);if(i!==void 0)return i;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(Ul(t)){var l=Array(t.length);e.set(t,l),a!==null&&e.set(a,l);for(var u=0;u<t.length;u+=1){var d=t[u];u in t&&(l[u]=ol(d,e,n,r,null,s))}return l}if(Wl(t)===uh){l={},e.set(t,l),a!==null&&e.set(a,l);for(var v in t)l[v]=ol(t[v],e,n,r,null,s);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!s)return ol(t.toJSON(),e,n,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}let tn=null;function ni(t){tn=t}function ad(t){return sd().get(t)}function Sh(t,e){return sd().set(t,e),e}function xy(t){return sd().has(t)}function at(t,e=!1,n){tn={p:tn,i:!1,c:null,e:null,s:t,x:null,l:vi&&!e?{s:null,u:null,$:[]}:null}}function st(t){var e=tn,n=e.e;if(n!==null){e.e=null;for(var r of n)Vh(r)}return t!==void 0&&(e.x=t),e.i=!0,tn=e.p,t??{}}function mo(){return!vi||tn!==null&&tn.l===null}function sd(t){return tn===null&&rd(),tn.c??(tn.c=new Map(ky(tn)||void 0))}function ky(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}let as=[];function Eh(){var t=as;as=[],fu(t)}function Jr(t){if(as.length===0&&!Gi){var e=as;queueMicrotask(()=>{e===as&&Eh()})}as.push(t)}function Sy(){for(;as.length>0;)Eh()}function Ah(t){var e=Yt;if(e===null)return Lt.f|=za,t;if((e.f&go)===0&&(e.f&Zi)===0)throw t;ri(t,e)}function ri(t,e){for(;e!==null;){if((e.f&fh)!==0){if((e.f&go)===0)throw t;try{e.b.error(t);return}catch(n){t=n}}e=e.parent}throw t}const Ey=-7169;function gn(t,e){t.f=t.f&Ey|e}function id(t){(t.f&gr)!==0||t.deps===null?gn(t,xn):gn(t,Lr)}function Th(t){if(t!==null)for(const e of t)(e.f&In)===0||(e.f&gs)===0||(e.f^=gs,Th(e.deps))}function Ch(t,e,n){(t.f&Pn)!==0?e.add(t):(t.f&Lr)!==0&&n.add(t),Th(t.deps),gn(t,xn)}const Vo=new Set;let It=null,bl=null,Tn=null,Qn=[],Yl=null,hu=!1,Gi=!1;var Ws,Ys,os,Xs,io,oo,ls,ua,Zs,aa,pu,gu,Ih;const ef=class ef{constructor(){Ie(this,aa);ht(this,"committed",!1);ht(this,"current",new Map);ht(this,"previous",new Map);Ie(this,Ws,new Set);Ie(this,Ys,new Set);Ie(this,os,0);Ie(this,Xs,0);Ie(this,io,null);Ie(this,oo,new Set);Ie(this,ls,new Set);Ie(this,ua,new Map);ht(this,"is_fork",!1);Ie(this,Zs,!1)}is_deferred(){return this.is_fork||F(this,Xs)>0}skip_effect(e){F(this,ua).has(e)||F(this,ua).set(e,{d:[],m:[]})}unskip_effect(e){var n=F(this,ua).get(e);if(n){F(this,ua).delete(e);for(var r of n.d)gn(r,Pn),Nr(r);for(r of n.m)gn(r,Lr),Nr(r)}}process(e){var a;Qn=[],this.apply();var n=[],r=[];for(const s of e)An(this,aa,pu).call(this,s,n,r);if(this.is_deferred()){An(this,aa,gu).call(this,r),An(this,aa,gu).call(this,n);for(const[s,i]of F(this,ua))Nh(s,i)}else{for(const s of F(this,Ws))s();F(this,Ws).clear(),F(this,os)===0&&An(this,aa,Ih).call(this),bl=this,It=null,Of(r),Of(n),bl=null,(a=F(this,io))==null||a.resolve()}Tn=null}capture(e,n){n!==wn&&!this.previous.has(e)&&this.previous.set(e,n),(e.f&za)===0&&(this.current.set(e,e.v),Tn==null||Tn.set(e,e.v))}activate(){It=this,this.apply()}deactivate(){It===this&&(It=null,Tn=null)}flush(){if(this.activate(),Qn.length>0){if(Ph(),It!==null&&It!==this)return}else F(this,os)===0&&this.process([]);this.deactivate()}discard(){for(const e of F(this,Ys))e(this);F(this,Ys).clear()}increment(e){Et(this,os,F(this,os)+1),e&&Et(this,Xs,F(this,Xs)+1)}decrement(e){Et(this,os,F(this,os)-1),e&&Et(this,Xs,F(this,Xs)-1),!F(this,Zs)&&(Et(this,Zs,!0),Jr(()=>{Et(this,Zs,!1),this.is_deferred()?Qn.length>0&&this.flush():this.revive()}))}revive(){for(const e of F(this,oo))F(this,ls).delete(e),gn(e,Pn),Nr(e);for(const e of F(this,ls))gn(e,Lr),Nr(e);this.flush()}oncommit(e){F(this,Ws).add(e)}ondiscard(e){F(this,Ys).add(e)}settled(){return(F(this,io)??Et(this,io,dh())).promise}static ensure(){if(It===null){const e=It=new ef;Vo.add(It),Gi||Jr(()=>{It===e&&e.flush()})}return It}apply(){}};Ws=new WeakMap,Ys=new WeakMap,os=new WeakMap,Xs=new WeakMap,io=new WeakMap,oo=new WeakMap,ls=new WeakMap,ua=new WeakMap,Zs=new WeakMap,aa=new WeakSet,pu=function(e,n,r){e.f^=xn;for(var a=e.first,s=null;a!==null;){var i=a.f,l=(i&(zr|Ua))!==0,u=l&&(i&xn)!==0,d=u||(i&cr)!==0||F(this,ua).has(a);if(!d&&a.fn!==null){l?a.f^=xn:s!==null&&(i&(Zi|po|td))!==0?s.b.defer_effect(a):(i&Zi)!==0?n.push(a):wo(a)&&((i&ka)!==0&&F(this,ls).add(a),si(a));var v=a.first;if(v!==null){a=v;continue}}var p=a.parent;for(a=a.next;a===null&&p!==null;)p===s&&(s=null),a=p.next,p=p.parent}},gu=function(e){for(var n=0;n<e.length;n+=1)Ch(e[n],F(this,oo),F(this,ls))},Ih=function(){var a;if(Vo.size>1){this.previous.clear();var e=Tn,n=!0;for(const s of Vo){if(s===this){n=!1;continue}const i=[];for(const[u,d]of this.current){if(s.current.has(u))if(n&&d!==s.current.get(u))s.current.set(u,d);else continue;i.push(u)}if(i.length===0)continue;const l=[...s.current.keys()].filter(u=>!this.current.has(u));if(l.length>0){var r=Qn;Qn=[];const u=new Set,d=new Map;for(const v of i)Mh(v,l,u,d);if(Qn.length>0){It=s,s.apply();for(const v of Qn)An(a=s,aa,pu).call(a,v,[],[]);s.deactivate()}Qn=r}}It=null,Tn=e}this.committed=!0,Vo.delete(this)};let _a=ef;function Ay(t){var e=Gi;Gi=!0;try{for(var n;;){if(Sy(),Qn.length===0&&(It==null||It.flush(),Qn.length===0))return Yl=null,n;Ph()}}finally{Gi=e}}function Ph(){hu=!0;var t=null;try{for(var e=0;Qn.length>0;){var n=_a.ensure();if(e++>1e3){var r,a;Ty()}n.process(Qn),qa.clear()}}finally{Qn=[],hu=!1,Yl=null}}function Ty(){try{ey()}catch(t){ri(t,Yl)}}let Ar=null;function Of(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(ya|cr))===0&&wo(r)&&(Ar=new Set,si(r),r.deps===null&&r.first===null&&r.nodes===null&&r.teardown===null&&r.ac===null&&Jh(r),(Ar==null?void 0:Ar.size)>0)){qa.clear();for(const a of Ar){if((a.f&(ya|cr))!==0)continue;const s=[a];let i=a.parent;for(;i!==null;)Ar.has(i)&&(Ar.delete(i),s.push(i)),i=i.parent;for(let l=s.length-1;l>=0;l--){const u=s[l];(u.f&(ya|cr))===0&&si(u)}}Ar.clear()}}Ar=null}}function Mh(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const a of t.reactions){const s=a.f;(s&In)!==0?Mh(a,e,n,r):(s&(nd|ka))!==0&&(s&Pn)===0&&Oh(a,e,r)&&(gn(a,Pn),Nr(a))}}function Oh(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const a of t.deps){if(ti.call(e,a))return!0;if((a.f&In)!==0&&Oh(a,e,n))return n.set(a,!0),!0}return n.set(t,!1),!1}function Nr(t){for(var e=Yl=t;e.parent!==null;){e=e.parent;var n=e.f;if(hu&&e===Yt&&(n&ka)!==0&&(n&vh)===0)return;if((n&(Ua|zr))!==0){if((n&xn)===0)return;e.f^=xn}}Qn.push(e)}function Nh(t,e){if(!((t.f&zr)!==0&&(t.f&xn)!==0)){(t.f&Pn)!==0?e.d.push(t):(t.f&Lr)!==0&&e.m.push(t),gn(t,xn);for(var n=t.first;n!==null;)Nh(n,e),n=n.next}}function Dh(t){let e=0,n=ms(0),r;return()=>{cd()&&(o(n),Zl(()=>(e===0&&(r=er(()=>t(()=>Ui(n)))),e+=1,()=>{Jr(()=>{e-=1,e===0&&(r==null||r(),r=void 0,Ui(n))})})))}}var Cy=Fa|As|fh;function Iy(t,e,n){new Py(t,e,n)}var hr,ed,Ur,cs,Vr,pr,Yn,Wr,da,Na,us,Da,Qs,ds,Js,$s,fa,Fl,Sn,My,Oy,mu,ll,cl,yu;class Py{constructor(e,n,r){Ie(this,Sn);ht(this,"parent");ht(this,"is_pending",!1);Ie(this,hr);Ie(this,ed,null);Ie(this,Ur);Ie(this,cs);Ie(this,Vr);Ie(this,pr,null);Ie(this,Yn,null);Ie(this,Wr,null);Ie(this,da,null);Ie(this,Na,null);Ie(this,us,0);Ie(this,Da,0);Ie(this,Qs,!1);Ie(this,ds,!1);Ie(this,Js,new Set);Ie(this,$s,new Set);Ie(this,fa,null);Ie(this,Fl,Dh(()=>(Et(this,fa,ms(F(this,us))),()=>{Et(this,fa,null)})));Et(this,hr,e),Et(this,Ur,n),Et(this,cs,r),this.parent=Yt.b,this.is_pending=!!F(this,Ur).pending,Et(this,Vr,bo(()=>{Yt.b=this;{var a=An(this,Sn,mu).call(this);try{Et(this,pr,$n(()=>r(a)))}catch(s){this.error(s)}F(this,Da)>0?An(this,Sn,cl).call(this):this.is_pending=!1}return()=>{var s;(s=F(this,Na))==null||s.remove()}},Cy))}defer_effect(e){Ch(e,F(this,Js),F(this,$s))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!F(this,Ur).pending}update_pending_count(e){An(this,Sn,yu).call(this,e),Et(this,us,F(this,us)+e),!(!F(this,fa)||F(this,Qs))&&(Et(this,Qs,!0),Jr(()=>{Et(this,Qs,!1),F(this,fa)&&ai(F(this,fa),F(this,us))}))}get_effect_pending(){return F(this,Fl).call(this),o(F(this,fa))}error(e){var n=F(this,Ur).onerror;let r=F(this,Ur).failed;if(F(this,ds)||!n&&!r)throw e;F(this,pr)&&(kn(F(this,pr)),Et(this,pr,null)),F(this,Yn)&&(kn(F(this,Yn)),Et(this,Yn,null)),F(this,Wr)&&(kn(F(this,Wr)),Et(this,Wr,null));var a=!1,s=!1;const i=()=>{if(a){yy();return}a=!0,s&&sy(),_a.ensure(),Et(this,us,0),F(this,Wr)!==null&&vs(F(this,Wr),()=>{Et(this,Wr,null)}),this.is_pending=this.has_pending_snippet(),Et(this,pr,An(this,Sn,ll).call(this,()=>(Et(this,ds,!1),$n(()=>F(this,cs).call(this,F(this,hr)))))),F(this,Da)>0?An(this,Sn,cl).call(this):this.is_pending=!1};Jr(()=>{try{s=!0,n==null||n(e,i),s=!1}catch(l){ri(l,F(this,Vr)&&F(this,Vr).parent)}r&&Et(this,Wr,An(this,Sn,ll).call(this,()=>{_a.ensure(),Et(this,ds,!0);try{return $n(()=>{r(F(this,hr),()=>e,()=>i)})}catch(l){return ri(l,F(this,Vr).parent),null}finally{Et(this,ds,!1)}}))})}}hr=new WeakMap,ed=new WeakMap,Ur=new WeakMap,cs=new WeakMap,Vr=new WeakMap,pr=new WeakMap,Yn=new WeakMap,Wr=new WeakMap,da=new WeakMap,Na=new WeakMap,us=new WeakMap,Da=new WeakMap,Qs=new WeakMap,ds=new WeakMap,Js=new WeakMap,$s=new WeakMap,fa=new WeakMap,Fl=new WeakMap,Sn=new WeakSet,My=function(){try{Et(this,pr,$n(()=>F(this,cs).call(this,F(this,hr))))}catch(e){this.error(e)}},Oy=function(){const e=F(this,Ur).pending;e&&(Et(this,Yn,$n(()=>e(F(this,hr)))),Jr(()=>{var n=An(this,Sn,mu).call(this);Et(this,pr,An(this,Sn,ll).call(this,()=>(_a.ensure(),$n(()=>F(this,cs).call(this,n))))),F(this,Da)>0?An(this,Sn,cl).call(this):(vs(F(this,Yn),()=>{Et(this,Yn,null)}),this.is_pending=!1)}))},mu=function(){var e=F(this,hr);return this.is_pending&&(Et(this,Na,ba()),F(this,hr).before(F(this,Na)),e=F(this,Na)),e},ll=function(e){var n=Yt,r=Lt,a=tn;na(F(this,Vr)),_r(F(this,Vr)),ni(F(this,Vr).ctx);try{return e()}catch(s){return Ah(s),null}finally{na(n),_r(r),ni(a)}},cl=function(){const e=F(this,Ur).pending;F(this,pr)!==null&&(Et(this,da,document.createDocumentFragment()),F(this,da).append(F(this,Na)),tp(F(this,pr),F(this,da))),F(this,Yn)===null&&Et(this,Yn,$n(()=>e(F(this,hr))))},yu=function(e){var n;if(!this.has_pending_snippet()){this.parent&&An(n=this.parent,Sn,yu).call(n,e);return}if(Et(this,Da,F(this,Da)+e),F(this,Da)===0){this.is_pending=!1;for(const r of F(this,Js))gn(r,Pn),Nr(r);for(const r of F(this,$s))gn(r,Lr),Nr(r);F(this,Js).clear(),F(this,$s).clear(),F(this,Yn)&&vs(F(this,Yn),()=>{Et(this,Yn,null)}),F(this,da)&&(F(this,hr).before(F(this,da)),Et(this,da,null))}};function Rh(t,e,n,r){const a=mo()?yo:od;var s=t.filter(h=>!h.settled);if(n.length===0&&s.length===0){r(e.map(a));return}var i=It,l=Yt,u=Ny(),d=s.length===1?s[0].promise:s.length>1?Promise.all(s.map(h=>h.promise)):null;function v(h){u();try{r(h)}catch(m){(l.f&ya)===0&&ri(m,l)}i==null||i.deactivate(),_u()}if(n.length===0){d.then(()=>v(e.map(a)));return}function p(){u(),Promise.all(n.map(h=>Dy(h))).then(h=>v([...e.map(a),...h])).catch(h=>ri(h,l))}d?d.then(p):p()}function Ny(){var t=Yt,e=Lt,n=tn,r=It;return function(s=!0){na(t),_r(e),ni(n),s&&(r==null||r.activate())}}function _u(){na(null),_r(null),ni(null)}function yo(t){var e=In|Pn,n=Lt!==null&&(Lt.f&In)!==0?Lt:null;return Yt!==null&&(Yt.f|=As),{ctx:tn,deps:null,effects:null,equals:bh,f:e,fn:t,reactions:null,rv:0,v:wn,wv:0,parent:n??Yt,ac:null}}function Dy(t,e,n){let r=Yt;r===null&&Xm();var a=r.b,s=void 0,i=ms(wn),l=!Lt,u=new Map;return Yy(()=>{var m;var d=dh();s=d.promise;try{Promise.resolve(t()).then(d.resolve,d.reject).then(()=>{v===It&&v.committed&&v.deactivate(),_u()})}catch(x){d.reject(x),_u()}var v=It;if(l){var p=a.is_rendered();a.update_pending_count(1),v.increment(p),(m=u.get(v))==null||m.reject(rs),u.delete(v),u.set(v,d)}const h=(x,k=void 0)=>{if(v.activate(),k)k!==rs&&(i.f|=za,ai(i,k));else{(i.f&za)!==0&&(i.f^=za),ai(i,x);for(const[E,N]of u){if(u.delete(E),E===v)break;N.reject(rs)}}l&&(a.update_pending_count(-1),v.decrement(p))};d.promise.then(h,x=>h(null,x||"unknown"))}),ud(()=>{for(const d of u.values())d.reject(rs)}),new Promise(d=>{function v(p){function h(){p===s?d(i):v(s)}p.then(h,h)}v(s)})}function J(t){const e=yo(t);return np(e),e}function od(t){const e=yo(t);return e.equals=xh,e}function Ry(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)kn(e[n])}}function Ly(t){for(var e=t.parent;e!==null;){if((e.f&In)===0)return(e.f&ya)===0?e:null;e=e.parent}return null}function ld(t){var e,n=Yt;na(Ly(t));try{t.f&=~gs,Ry(t),e=ip(t)}finally{na(n)}return e}function Lh(t){var e=ld(t);if(!t.equals(e)&&(t.wv=ap(),(!(It!=null&&It.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){gn(t,xn);return}Ka||(Tn!==null?(cd()||It!=null&&It.is_fork)&&Tn.set(t,e):id(t))}function jy(t){var e,n;if(t.effects!==null)for(const r of t.effects)(r.teardown||r.ac)&&((e=r.teardown)==null||e.call(r),(n=r.ac)==null||n.abort(rs),r.teardown=Es,r.ac=null,Qi(r,0),dd(r))}function jh(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&si(e)}let bu=new Set;const qa=new Map;let zh=!1;function ms(t,e){var n={f:0,v:t,reactions:null,equals:bh,rv:0,wv:0};return n}function Pe(t,e){const n=ms(t);return np(n),n}function zy(t,e=!1,n=!0){var a;const r=ms(t);return e||(r.equals=xh),vi&&n&&tn!==null&&tn.l!==null&&((a=tn.l).s??(a.s=[])).push(r),r}function P(t,e,n=!1){Lt!==null&&(!Dr||(Lt.f&Mf)!==0)&&mo()&&(Lt.f&(In|ka|nd|Mf))!==0&&(mr===null||!ti.call(mr,t))&&ay();let r=n?Wt(e):e;return ai(t,r)}function ai(t,e){if(!t.equals(e)){var n=t.v;Ka?qa.set(t,e):qa.set(t,n),t.v=e;var r=_a.ensure();if(r.capture(t,n),(t.f&In)!==0){const a=t;(t.f&Pn)!==0&&ld(a),id(a)}t.wv=ap(),qh(t,Pn),mo()&&Yt!==null&&(Yt.f&xn)!==0&&(Yt.f&(zr|Ua))===0&&(vr===null?Zy([t]):vr.push(t)),!r.is_fork&&bu.size>0&&!zh&&qy()}return e}function qy(){zh=!1;for(const t of bu)(t.f&xn)!==0&&gn(t,Lr),wo(t)&&si(t);bu.clear()}function Ui(t){P(t,t.v+1)}function qh(t,e){var n=t.reactions;if(n!==null)for(var r=mo(),a=n.length,s=0;s<a;s++){var i=n[s],l=i.f;if(!(!r&&i===Yt)){var u=(l&Pn)===0;if(u&&gn(i,e),(l&In)!==0){var d=i;Tn==null||Tn.delete(d),(l&gs)===0&&(l&gr&&(i.f|=gs),qh(d,Lr))}else u&&((l&ka)!==0&&Ar!==null&&Ar.add(i),Nr(i))}}}function Wt(t){if(typeof t!="object"||t===null||Qr in t)return t;const e=Wl(t);if(e!==uh&&e!==Vm)return t;var n=new Map,r=Ul(t),a=Pe(0),s=hs,i=l=>{if(hs===s)return l();var u=Lt,d=hs;_r(null),Lf(s);var v=l();return _r(u),Lf(d),v};return r&&n.set("length",Pe(t.length)),new Proxy(t,{defineProperty(l,u,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&ny();var v=n.get(u);return v===void 0?i(()=>{var p=Pe(d.value);return n.set(u,p),p}):P(v,d.value,!0),!0},deleteProperty(l,u){var d=n.get(u);if(d===void 0){if(u in l){const v=i(()=>Pe(wn));n.set(u,v),Ui(a)}}else P(d,wn),Ui(a);return!0},get(l,u,d){var m;if(u===Qr)return t;var v=n.get(u),p=u in l;if(v===void 0&&(!p||(m=ja(l,u))!=null&&m.writable)&&(v=i(()=>{var x=Wt(p?l[u]:wn),k=Pe(x);return k}),n.set(u,v)),v!==void 0){var h=o(v);return h===wn?void 0:h}return Reflect.get(l,u,d)},getOwnPropertyDescriptor(l,u){var d=Reflect.getOwnPropertyDescriptor(l,u);if(d&&"value"in d){var v=n.get(u);v&&(d.value=o(v))}else if(d===void 0){var p=n.get(u),h=p==null?void 0:p.v;if(p!==void 0&&h!==wn)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(l,u){var h;if(u===Qr)return!0;var d=n.get(u),v=d!==void 0&&d.v!==wn||Reflect.has(l,u);if(d!==void 0||Yt!==null&&(!v||(h=ja(l,u))!=null&&h.writable)){d===void 0&&(d=i(()=>{var m=v?Wt(l[u]):wn,x=Pe(m);return x}),n.set(u,d));var p=o(d);if(p===wn)return!1}return v},set(l,u,d,v){var V;var p=n.get(u),h=u in l;if(r&&u==="length")for(var m=d;m<p.v;m+=1){var x=n.get(m+"");x!==void 0?P(x,wn):m in l&&(x=i(()=>Pe(wn)),n.set(m+"",x))}if(p===void 0)(!h||(V=ja(l,u))!=null&&V.writable)&&(p=i(()=>Pe(void 0)),P(p,Wt(d)),n.set(u,p));else{h=p.v!==wn;var k=i(()=>Wt(d));P(p,k)}var E=Reflect.getOwnPropertyDescriptor(l,u);if(E!=null&&E.set&&E.set.call(v,d),!h){if(r&&typeof u=="string"){var N=n.get("length"),j=Number(u);Number.isInteger(j)&&j>=N.v&&P(N,j+1)}Ui(a)}return!0},ownKeys(l){o(a);var u=Reflect.ownKeys(l).filter(p=>{var h=n.get(p);return h===void 0||h.v!==wn});for(var[d,v]of n)v.v!==wn&&!(d in l)&&u.push(d);return u},setPrototypeOf(){ry()}})}function Nf(t){try{if(t!==null&&typeof t=="object"&&Qr in t)return t[Qr]}catch{}return t}function By(t,e){return Object.is(Nf(t),Nf(e))}var Wn,Bh,Fh,Kh;function Fy(){if(Wn===void 0){Wn=window,Bh=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;Fh=ja(e,"firstChild").get,Kh=ja(e,"nextSibling").get,Pf(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Pf(n)&&(n.__t=void 0)}}function ba(t=""){return document.createTextNode(t)}function lr(t){return Fh.call(t)}function _o(t){return Kh.call(t)}function _(t,e){return lr(t)}function Ye(t,e=!1){{var n=lr(t);return n instanceof Comment&&n.data===""?_o(n):n}}function b(t,e=1,n=!1){let r=t;for(;e--;)r=_o(r);return r}function Ky(t){t.textContent=""}function Hh(){return!1}function Hy(t,e,n){return document.createElementNS(_h,t,void 0)}function Gy(t,e){if(e){const n=document.body;t.autofocus=!0,Jr(()=>{document.activeElement===n&&t.focus()})}}let Df=!1;function Uy(){Df||(Df=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function Xl(t){var e=Lt,n=Yt;_r(null),na(null);try{return t()}finally{_r(e),na(n)}}function Gh(t,e,n,r=n){t.addEventListener(e,()=>Xl(n));const a=t.__on_r;a?t.__on_r=()=>{a(),r(!0)}:t.__on_r=()=>r(!0),Uy()}function Uh(t){Yt===null&&(Lt===null&&$m(),Jm()),Ka&&Qm()}function Vy(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function wr(t,e,n){var r=Yt;r!==null&&(r.f&cr)!==0&&(t|=cr);var a={ctx:tn,deps:null,nodes:null,f:t|Pn|gr,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{si(a)}catch(l){throw kn(a),l}else e!==null&&Nr(a);var s=a;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&As)===0&&(s=s.first,(t&ka)!==0&&(t&Fa)!==0&&s!==null&&(s.f|=Fa)),s!==null&&(s.parent=r,r!==null&&Vy(s,r),Lt!==null&&(Lt.f&In)!==0&&(t&Ua)===0)){var i=Lt;(i.effects??(i.effects=[])).push(s)}return a}function cd(){return Lt!==null&&!Dr}function ud(t){const e=wr(po,null,!1);return gn(e,xn),e.teardown=t,e}function yn(t){Uh();var e=Yt.f,n=!Lt&&(e&zr)!==0&&(e&go)===0;if(n){var r=tn;(r.e??(r.e=[])).push(t)}else return Vh(t)}function Vh(t){return wr(Zi|hh,t,!1)}function Wh(t){return Uh(),wr(po|hh,t,!0)}function Yh(t){_a.ensure();const e=wr(Ua|As,t,!0);return()=>{kn(e)}}function Wy(t){_a.ensure();const e=wr(Ua|As,t,!0);return(n={})=>new Promise(r=>{n.outro?vs(e,()=>{kn(e),r(void 0)}):(kn(e),r(void 0))})}function hi(t){return wr(Zi,t,!1)}function Yy(t){return wr(nd|As,t,!0)}function Zl(t,e=0){return wr(po|e,t,!0)}function oe(t,e=[],n=[],r=[]){Rh(r,e,n,a=>{wr(po,()=>t(...a.map(o)),!0)})}function bo(t,e=0){var n=wr(ka|e,t,!0);return n}function Xh(t,e=0){var n=wr(td|e,t,!0);return n}function $n(t){return wr(zr|As,t,!0)}function Zh(t){var e=t.teardown;if(e!==null){const n=Ka,r=Lt;Rf(!0),_r(null);try{e.call(null)}finally{Rf(n),_r(r)}}}function dd(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const a=n.ac;a!==null&&Xl(()=>{a.abort(rs)});var r=n.next;(n.f&Ua)!==0?n.parent=null:kn(n,e),n=r}}function Xy(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&zr)===0&&kn(e),e=n}}function kn(t,e=!0){var n=!1;(e||(t.f&vh)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Qh(t.nodes.start,t.nodes.end),n=!0),dd(t,e&&!n),Qi(t,0),gn(t,ya);var r=t.nodes&&t.nodes.t;if(r!==null)for(const s of r)s.stop();Zh(t);var a=t.parent;a!==null&&a.first!==null&&Jh(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Qh(t,e){for(;t!==null;){var n=t===e?null:_o(t);t.remove(),t=n}}function Jh(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function vs(t,e,n=!0){var r=[];$h(t,r,!0);var a=()=>{n&&kn(t),e&&e()},s=r.length;if(s>0){var i=()=>--s||a();for(var l of r)l.out(i)}else a()}function $h(t,e,n){if((t.f&cr)===0){t.f^=cr;var r=t.nodes&&t.nodes.t;if(r!==null)for(const l of r)(l.is_global||n)&&e.push(l);for(var a=t.first;a!==null;){var s=a.next,i=(a.f&Fa)!==0||(a.f&zr)!==0&&(t.f&ka)!==0;$h(a,e,i?n:!1),a=s}}}function fd(t){ep(t,!0)}function ep(t,e){if((t.f&cr)!==0){t.f^=cr,(t.f&xn)===0&&(gn(t,Pn),Nr(t));for(var n=t.first;n!==null;){var r=n.next,a=(n.f&Fa)!==0||(n.f&zr)!==0;ep(n,a?e:!1),n=r}var s=t.nodes&&t.nodes.t;if(s!==null)for(const i of s)(i.is_global||e)&&i.in()}}function tp(t,e){if(t.nodes)for(var n=t.nodes.start,r=t.nodes.end;n!==null;){var a=n===r?null:_o(n);e.append(n),n=a}}let ul=!1,Ka=!1;function Rf(t){Ka=t}let Lt=null,Dr=!1;function _r(t){Lt=t}let Yt=null;function na(t){Yt=t}let mr=null;function np(t){Lt!==null&&(mr===null?mr=[t]:mr.push(t))}let Jn=null,ir=0,vr=null;function Zy(t){vr=t}let rp=1,ss=0,hs=ss;function Lf(t){hs=t}function ap(){return++rp}function wo(t){var e=t.f;if((e&Pn)!==0)return!0;if(e&In&&(t.f&=~gs),(e&Lr)!==0){for(var n=t.deps,r=n.length,a=0;a<r;a++){var s=n[a];if(wo(s)&&Lh(s),s.wv>t.wv)return!0}(e&gr)!==0&&Tn===null&&gn(t,xn)}return!1}function sp(t,e,n=!0){var r=t.reactions;if(r!==null&&!(mr!==null&&ti.call(mr,t)))for(var a=0;a<r.length;a++){var s=r[a];(s.f&In)!==0?sp(s,e,!1):e===s&&(n?gn(s,Pn):(s.f&xn)!==0&&gn(s,Lr),Nr(s))}}function ip(t){var k;var e=Jn,n=ir,r=vr,a=Lt,s=mr,i=tn,l=Dr,u=hs,d=t.f;Jn=null,ir=0,vr=null,Lt=(d&(zr|Ua))===0?t:null,mr=null,ni(t.ctx),Dr=!1,hs=++ss,t.ac!==null&&(Xl(()=>{t.ac.abort(rs)}),t.ac=null);try{t.f|=vu;var v=t.fn,p=v();t.f|=go;var h=t.deps,m=It==null?void 0:It.is_fork;if(Jn!==null){var x;if(m||Qi(t,ir),h!==null&&ir>0)for(h.length=ir+Jn.length,x=0;x<Jn.length;x++)h[ir+x]=Jn[x];else t.deps=h=Jn;if(cd()&&(t.f&gr)!==0)for(x=ir;x<h.length;x++)((k=h[x]).reactions??(k.reactions=[])).push(t)}else!m&&h!==null&&ir<h.length&&(Qi(t,ir),h.length=ir);if(mo()&&vr!==null&&!Dr&&h!==null&&(t.f&(In|Lr|Pn))===0)for(x=0;x<vr.length;x++)sp(vr[x],t);if(a!==null&&a!==t){if(ss++,a.deps!==null)for(let E=0;E<n;E+=1)a.deps[E].rv=ss;if(e!==null)for(const E of e)E.rv=ss;vr!==null&&(r===null?r=vr:r.push(...vr))}return(t.f&za)!==0&&(t.f^=za),p}catch(E){return Ah(E)}finally{t.f^=vu,Jn=e,ir=n,vr=r,Lt=a,mr=s,ni(i),Dr=l,hs=u}}function Qy(t,e){let n=e.reactions;if(n!==null){var r=Gm.call(n,t);if(r!==-1){var a=n.length-1;a===0?n=e.reactions=null:(n[r]=n[a],n.pop())}}if(n===null&&(e.f&In)!==0&&(Jn===null||!ti.call(Jn,e))){var s=e;(s.f&gr)!==0&&(s.f^=gr,s.f&=~gs),id(s),jy(s),Qi(s,0)}}function Qi(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Qy(t,n[r])}function si(t){var e=t.f;if((e&ya)===0){gn(t,xn);var n=Yt,r=ul;Yt=t,ul=!0;try{(e&(ka|td))!==0?Xy(t):dd(t),Zh(t);var a=ip(t);t.teardown=typeof a=="function"?a:null,t.wv=rp;var s;du&&_y&&(t.f&Pn)!==0&&t.deps}finally{ul=r,Yt=n}}}async function op(){await Promise.resolve(),Ay()}function o(t){var e=t.f,n=(e&In)!==0;if(Lt!==null&&!Dr){var r=Yt!==null&&(Yt.f&ya)!==0;if(!r&&(mr===null||!ti.call(mr,t))){var a=Lt.deps;if((Lt.f&vu)!==0)t.rv<ss&&(t.rv=ss,Jn===null&&a!==null&&a[ir]===t?ir++:Jn===null?Jn=[t]:Jn.push(t));else{(Lt.deps??(Lt.deps=[])).push(t);var s=t.reactions;s===null?t.reactions=[Lt]:ti.call(s,Lt)||s.push(Lt)}}}if(Ka&&qa.has(t))return qa.get(t);if(n){var i=t;if(Ka){var l=i.v;return((i.f&xn)===0&&i.reactions!==null||cp(i))&&(l=ld(i)),qa.set(i,l),l}var u=(i.f&gr)===0&&!Dr&&Lt!==null&&(ul||(Lt.f&gr)!==0),d=(i.f&go)===0;wo(i)&&(u&&(i.f|=gr),Lh(i)),u&&!d&&(jh(i),lp(i))}if(Tn!=null&&Tn.has(t))return Tn.get(t);if((t.f&za)!==0)throw t.v;return t.v}function lp(t){if(t.f|=gr,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&In)!==0&&(e.f&gr)===0&&(jh(e),lp(e))}function cp(t){if(t.v===wn)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(qa.has(e)||(e.f&In)!==0&&cp(e))return!0;return!1}function er(t){var e=Dr;try{return Dr=!0,t()}finally{Dr=e}}function Jy(t,e){var n={};for(var r in t)e.includes(r)||(n[r]=t[r]);for(var a of Object.getOwnPropertySymbols(t))Object.propertyIsEnumerable.call(t,a)&&!e.includes(a)&&(n[a]=t[a]);return n}function up(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Qr in t)wu(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&Qr in n&&wu(n)}}}function wu(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{wu(t[r],e)}catch{}const n=Wl(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=ch(n);for(let a in r){const s=r[a].get;if(s)try{s.call(t)}catch{}}}}}function $y(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const e_=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function t_(t){return e_.includes(t)}const n_={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function r_(t){return t=t.toLowerCase(),n_[t]??t}const a_=["touchstart","touchmove"];function s_(t){return a_.includes(t)}const dp=new Set,xu=new Set;function vd(t,e,n,r={}){function a(s){if(r.capture||Su.call(e,s),!s.cancelBubble)return Xl(()=>n==null?void 0:n.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Jr(()=>{e.addEventListener(t,a,r)}):e.addEventListener(t,a,r),a}function ku(t,e,n,r={}){var a=vd(e,t,n,r);return()=>{t.removeEventListener(e,a,r)}}function wl(t,e,n,r,a){var s={capture:r,passive:a},i=vd(t,e,n,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&ud(()=>{e.removeEventListener(t,i,s)})}function Xt(t){for(var e=0;e<t.length;e++)dp.add(t[e]);for(var n of xu)n(t)}let jf=null;function Su(t){var E;var e=this,n=e.ownerDocument,r=t.type,a=((E=t.composedPath)==null?void 0:E.call(t))||[],s=a[0]||t.target;jf=t;var i=0,l=jf===t&&t.__root;if(l){var u=a.indexOf(l);if(u!==-1&&(e===document||e===window)){t.__root=e;return}var d=a.indexOf(e);if(d===-1)return;u<=d&&(i=u)}if(s=a[i]||t.target,s!==e){Um(t,"currentTarget",{configurable:!0,get(){return s||n}});var v=Lt,p=Yt;_r(null),na(null);try{for(var h,m=[];s!==null;){var x=s.assignedSlot||s.parentNode||s.host||null;try{var k=s["__"+r];k!=null&&(!s.disabled||t.target===s)&&k.call(s,t)}catch(N){h?m.push(N):h=N}if(t.cancelBubble||x===e||x===null)break;s=x}if(h){for(let N of m)queueMicrotask(()=>{throw N});throw h}}finally{t.__root=e,delete t.currentTarget,_r(v),na(p)}}}var ih,oh;const qc=(oh=(ih=globalThis==null?void 0:globalThis.window)==null?void 0:ih.trustedTypes)==null?void 0:oh.createPolicy("svelte-trusted-html",{createHTML:t=>t});function i_(t){return(qc==null?void 0:qc.createHTML(t))??t}function hd(t,e=!1){var n=Hy("template");return t=t.replaceAll("<!>","<!---->"),n.innerHTML=e?i_(t):t,n.content}function ys(t,e){var n=Yt;n.nodes===null&&(n.nodes={start:t,end:e,a:null,t:null})}function L(t,e){var n=(e&yh)!==0,r=(e&py)!==0,a,s=!t.startsWith("<!>");return()=>{a===void 0&&(a=hd(s?t:"<!>"+t,!0),n||(a=lr(a)));var i=r||Bh?document.importNode(a,!0):a.cloneNode(!0);if(n){var l=lr(i),u=i.lastChild;ys(l,u)}else ys(i,i);return i}}function o_(t,e,n="svg"){var r=!t.startsWith("<!>"),a=(e&yh)!==0,s=`<${n}>${r?t:"<!>"+t}</${n}>`,i;return()=>{if(!i){var l=hd(s,!0),u=lr(l);if(a)for(i=document.createDocumentFragment();lr(u);)i.appendChild(lr(u));else i=lr(u)}var d=i.cloneNode(!0);if(a){var v=lr(d),p=d.lastChild;ys(v,p)}else ys(d,d);return d}}function mn(t,e){return o_(t,e,"svg")}function on(t=""){{var e=ba(t+"");return ys(e,e),e}}function an(){var t=document.createDocumentFragment(),e=document.createComment(""),n=ba();return t.append(e,n),ys(e,n),t}function C(t,e){t!==null&&t.before(e)}function ee(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function l_(t,e){return c_(t,e)}const Wo=new Map;function c_(t,{target:e,anchor:n,props:r={},events:a,context:s,intro:i=!0}){Fy();var l=new Set,u=p=>{for(var h=0;h<p.length;h++){var m=p[h];if(!l.has(m)){l.add(m);var x=s_(m);for(const N of[e,document]){var k=Wo.get(N);k===void 0&&(k=new Map,Wo.set(N,k));var E=k.get(m);E===void 0?(N.addEventListener(m,Su,{passive:x}),k.set(m,1)):k.set(m,E+1)}}}};u(Vl(dp)),xu.add(u);var d=void 0,v=Wy(()=>{var p=n??e.appendChild(ba());return Iy(p,{pending:()=>{}},h=>{at({});var m=tn;s&&(m.c=s),a&&(r.$$events=a),d=t(h,r)||{},st()}),()=>{var k;for(var h of l)for(const E of[e,document]){var m=Wo.get(E),x=m.get(h);--x==0?(E.removeEventListener(h,Su),m.delete(h),m.size===0&&Wo.delete(E)):m.set(h,x)}xu.delete(u),p!==n&&((k=p.parentNode)==null||k.removeChild(p))}});return u_.set(d,v),d}let u_=new WeakMap;var Cr,Yr,or,fs,lo,co,Kl;class pd{constructor(e,n=!0){ht(this,"anchor");Ie(this,Cr,new Map);Ie(this,Yr,new Map);Ie(this,or,new Map);Ie(this,fs,new Set);Ie(this,lo,!0);Ie(this,co,()=>{var e=It;if(F(this,Cr).has(e)){var n=F(this,Cr).get(e),r=F(this,Yr).get(n);if(r)fd(r),F(this,fs).delete(n);else{var a=F(this,or).get(n);a&&(F(this,Yr).set(n,a.effect),F(this,or).delete(n),a.fragment.lastChild.remove(),this.anchor.before(a.fragment),r=a.effect)}for(const[s,i]of F(this,Cr)){if(F(this,Cr).delete(s),s===e)break;const l=F(this,or).get(i);l&&(kn(l.effect),F(this,or).delete(i))}for(const[s,i]of F(this,Yr)){if(s===n||F(this,fs).has(s))continue;const l=()=>{if(Array.from(F(this,Cr).values()).includes(s)){var d=document.createDocumentFragment();tp(i,d),d.append(ba()),F(this,or).set(s,{effect:i,fragment:d})}else kn(i);F(this,fs).delete(s),F(this,Yr).delete(s)};F(this,lo)||!r?(F(this,fs).add(s),vs(i,l,!1)):l()}}});Ie(this,Kl,e=>{F(this,Cr).delete(e);const n=Array.from(F(this,Cr).values());for(const[r,a]of F(this,or))n.includes(r)||(kn(a.effect),F(this,or).delete(r))});this.anchor=e,Et(this,lo,n)}ensure(e,n){var r=It,a=Hh();if(n&&!F(this,Yr).has(e)&&!F(this,or).has(e))if(a){var s=document.createDocumentFragment(),i=ba();s.append(i),F(this,or).set(e,{effect:$n(()=>n(i)),fragment:s})}else F(this,Yr).set(e,$n(()=>n(this.anchor)));if(F(this,Cr).set(r,e),a){for(const[l,u]of F(this,Yr))l===e?r.unskip_effect(u):r.skip_effect(u);for(const[l,u]of F(this,or))l===e?r.unskip_effect(u.effect):r.skip_effect(u.effect);r.oncommit(F(this,co)),r.ondiscard(F(this,Kl))}else F(this,co).call(this)}}Cr=new WeakMap,Yr=new WeakMap,or=new WeakMap,fs=new WeakMap,lo=new WeakMap,co=new WeakMap,Kl=new WeakMap;function ue(t,e,n=!1){var r=new pd(t),a=n?Fa:0;function s(i,l){r.ensure(i,l)}bo(()=>{var i=!1;e((l,u=0)=>{i=!0,s(u,l)}),i||s(!1,null)},a)}function Ut(t,e){return e}function d_(t,e,n){for(var r=[],a=e.length,s,i=e.length,l=0;l<a;l++){let p=e[l];vs(p,()=>{if(s){if(s.pending.delete(p),s.done.add(p),s.pending.size===0){var h=t.outrogroups;Eu(Vl(s.done)),h.delete(s),h.size===0&&(t.outrogroups=null)}}else i-=1},!1)}if(i===0){var u=r.length===0&&n!==null;if(u){var d=n,v=d.parentNode;Ky(v),v.append(d),t.items.clear()}Eu(e,!u)}else s={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(s)}function Eu(t,e=!0){for(var n=0;n<t.length;n++)kn(t[n],e)}var zf;function Ot(t,e,n,r,a,s=null){var i=t,l=new Map,u=(e&mh)!==0;if(u){var d=t;i=d.appendChild(ba())}var v=null,p=od(()=>{var N=n();return Ul(N)?N:N==null?[]:Vl(N)}),h,m=!0;function x(){E.fallback=v,f_(E,h,i,e,r),v!==null&&(h.length===0?(v.f&pa)===0?fd(v):(v.f^=pa,Bi(v,null,i)):vs(v,()=>{v=null}))}var k=bo(()=>{h=o(p);for(var N=h.length,j=new Set,V=It,S=Hh(),K=0;K<N;K+=1){var B=h[K],O=r(B,K),Q=m?null:l.get(O);Q?(Q.v&&ai(Q.v,B),Q.i&&ai(Q.i,K),S&&V.unskip_effect(Q.e)):(Q=v_(l,m?i:zf??(zf=ba()),B,O,K,a,e,n),m||(Q.e.f|=pa),l.set(O,Q)),j.add(O)}if(N===0&&s&&!v&&(m?v=$n(()=>s(i)):(v=$n(()=>s(zf??(zf=ba()))),v.f|=pa)),N>j.size&&Zm(),!m)if(S){for(const[se,xe]of l)j.has(se)||V.skip_effect(xe.e);V.oncommit(x),V.ondiscard(()=>{})}else x();o(p)}),E={effect:k,items:l,outrogroups:null,fallback:v};m=!1}function Ii(t){for(;t!==null&&(t.f&zr)===0;)t=t.next;return t}function f_(t,e,n,r,a){var xe,z,M,q,T,D,I,X,Y;var s=(r&ly)!==0,i=e.length,l=t.items,u=Ii(t.effect.first),d,v=null,p,h=[],m=[],x,k,E,N;if(s)for(N=0;N<i;N+=1)x=e[N],k=a(x,N),E=l.get(k).e,(E.f&pa)===0&&((z=(xe=E.nodes)==null?void 0:xe.a)==null||z.measure(),(p??(p=new Set)).add(E));for(N=0;N<i;N+=1){if(x=e[N],k=a(x,N),E=l.get(k).e,t.outrogroups!==null)for(const Z of t.outrogroups)Z.pending.delete(E),Z.done.delete(E);if((E.f&pa)!==0)if(E.f^=pa,E===u)Bi(E,null,n);else{var j=v?v.next:u;E===t.effect.last&&(t.effect.last=E.prev),E.prev&&(E.prev.next=E.next),E.next&&(E.next.prev=E.prev),Ca(t,v,E),Ca(t,E,j),Bi(E,j,n),v=E,h=[],m=[],u=Ii(v.next);continue}if((E.f&cr)!==0&&(fd(E),s&&((q=(M=E.nodes)==null?void 0:M.a)==null||q.unfix(),(p??(p=new Set)).delete(E))),E!==u){if(d!==void 0&&d.has(E)){if(h.length<m.length){var V=m[0],S;v=V.prev;var K=h[0],B=h[h.length-1];for(S=0;S<h.length;S+=1)Bi(h[S],V,n);for(S=0;S<m.length;S+=1)d.delete(m[S]);Ca(t,K.prev,B.next),Ca(t,v,K),Ca(t,B,V),u=V,v=B,N-=1,h=[],m=[]}else d.delete(E),Bi(E,u,n),Ca(t,E.prev,E.next),Ca(t,E,v===null?t.effect.first:v.next),Ca(t,v,E),v=E;continue}for(h=[],m=[];u!==null&&u!==E;)(d??(d=new Set)).add(u),m.push(u),u=Ii(u.next);if(u===null)continue}(E.f&pa)===0&&h.push(E),v=E,u=Ii(E.next)}if(t.outrogroups!==null){for(const Z of t.outrogroups)Z.pending.size===0&&(Eu(Vl(Z.done)),(T=t.outrogroups)==null||T.delete(Z));t.outrogroups.size===0&&(t.outrogroups=null)}if(u!==null||d!==void 0){var O=[];if(d!==void 0)for(E of d)(E.f&cr)===0&&O.push(E);for(;u!==null;)(u.f&cr)===0&&u!==t.fallback&&O.push(u),u=Ii(u.next);var Q=O.length;if(Q>0){var se=(r&mh)!==0&&i===0?n:null;if(s){for(N=0;N<Q;N+=1)(I=(D=O[N].nodes)==null?void 0:D.a)==null||I.measure();for(N=0;N<Q;N+=1)(Y=(X=O[N].nodes)==null?void 0:X.a)==null||Y.fix()}d_(t,O,se)}}s&&Jr(()=>{var Z,U;if(p!==void 0)for(E of p)(U=(Z=E.nodes)==null?void 0:Z.a)==null||U.apply()})}function v_(t,e,n,r,a,s,i,l){var u=(i&iy)!==0?(i&cy)===0?zy(n,!1,!1):ms(n):null,d=(i&oy)!==0?ms(a):null;return{v:u,i:d,e:$n(()=>(s(e,u??n,d??a,l),()=>{t.delete(r)}))}}function Bi(t,e,n){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end,s=e&&(e.f&pa)===0?e.nodes.start:n;r!==null;){var i=_o(r);if(s.before(r),r===a)return;r=i}}function Ca(t,e,n){e===null?t.effect.first=n:e.next=n,n===null?t.effect.last=e:n.prev=e}function h_(t,e,n=!1,r=!1,a=!1){var s=t,i="";oe(()=>{var l=Yt;if(i!==(i=e()??"")&&(l.nodes!==null&&(Qh(l.nodes.start,l.nodes.end),l.nodes=null),i!=="")){var u=i+"";n?u=`<svg>${u}</svg>`:r&&(u=`<math>${u}</math>`);var d=hd(u);if((n||r)&&(d=lr(d)),ys(lr(d),d.lastChild),n||r)for(;lr(d);)s.before(lr(d));else s.before(d)}})}function yr(t,e,...n){var r=new pd(t);bo(()=>{const a=e()??null;r.ensure(a,a&&(s=>a(s,...n)))},Fa)}function gd(t,e,n){var r=new pd(t);bo(()=>{var a=e()??null;r.ensure(a,a&&(s=>n(s,a)))},Fa)}function Xn(t,e,n){hi(()=>{var r=er(()=>e(t,n==null?void 0:n())||{});if(n&&(r!=null&&r.update)){var a=!1,s={};Zl(()=>{var i=n();up(i),a&&wh(s,i)&&(s=i,r.update(i))}),a=!0}if(r!=null&&r.destroy)return()=>r.destroy()})}function p_(t,e){var n=void 0,r;Xh(()=>{n!==(n=e())&&(r&&(kn(r),r=null),n&&(r=$n(()=>{hi(()=>n(t))})))})}function fp(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=fp(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function g_(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=fp(t))&&(r&&(r+=" "),r+=e);return r}function Ts(t){return typeof t=="object"?g_(t):t??""}const qf=[...` 	
\r\fÂ \v\uFEFF`];function m_(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var a in n)if(n[a])r=r?r+" "+a:a;else if(r.length)for(var s=a.length,i=0;(i=r.indexOf(a,i))>=0;){var l=i+s;(i===0||qf.includes(r[i-1]))&&(l===r.length||qf.includes(r[l]))?r=(i===0?"":r.substring(0,i))+r.substring(l+1):i=l}}return r===""?null:r}function Bf(t,e=!1){var n=e?" !important;":";",r="";for(var a in t){var s=t[a];s!=null&&s!==""&&(r+=" "+a+": "+s+n)}return r}function Bc(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function y_(t,e){if(e){var n="",r,a;if(Array.isArray(e)?(r=e[0],a=e[1]):r=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,i=0,l=!1,u=[];r&&u.push(...Object.keys(r).map(Bc)),a&&u.push(...Object.keys(a).map(Bc));var d=0,v=-1;const k=t.length;for(var p=0;p<k;p++){var h=t[p];if(l?h==="/"&&t[p-1]==="*"&&(l=!1):s?s===h&&(s=!1):h==="/"&&t[p+1]==="*"?l=!0:h==='"'||h==="'"?s=h:h==="("?i++:h===")"&&i--,!l&&s===!1&&i===0){if(h===":"&&v===-1)v=p;else if(h===";"||p===k-1){if(v!==-1){var m=Bc(t.substring(d,v).trim());if(!u.includes(m)){h!==";"&&p++;var x=t.substring(d,p).trim();n+=" "+x+";"}}d=p+1,v=-1}}}}return r&&(n+=Bf(r)),a&&(n+=Bf(a,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function St(t,e,n,r,a,s){var i=t.__className;if(i!==n||i===void 0){var l=m_(n,r,s);l==null?t.removeAttribute("class"):e?t.className=l:t.setAttribute("class",l),t.__className=n}else if(s&&a!==s)for(var u in s){var d=!!s[u];(a==null||d!==!!a[u])&&t.classList.toggle(u,d)}return s}function Fc(t,e={},n,r){for(var a in n){var s=n[a];e[a]!==s&&(n[a]==null?t.style.removeProperty(a):t.style.setProperty(a,s,r))}}function Dt(t,e,n,r){var a=t.__style;if(a!==e){var s=y_(e,r);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=e}else r&&(Array.isArray(r)?(Fc(t,n==null?void 0:n[0],r[0]),Fc(t,n==null?void 0:n[1],r[1],"important")):Fc(t,n,r));return r}function xl(t,e,n=!1){if(t.multiple){if(e==null)return;if(!Ul(e))return my();for(var r of t.options)r.selected=e.includes(Vi(r));return}for(r of t.options){var a=Vi(r);if(By(a,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function vp(t){var e=new MutationObserver(()=>{xl(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ud(()=>{e.disconnect()})}function pi(t,e,n=e){var r=new WeakSet,a=!0;Gh(t,"change",s=>{var i=s?"[selected]":":checked",l;if(t.multiple)l=[].map.call(t.querySelectorAll(i),Vi);else{var u=t.querySelector(i)??t.querySelector("option:not([disabled])");l=u&&Vi(u)}n(l),It!==null&&r.add(It)}),hi(()=>{var s=e();if(t===document.activeElement){var i=bl??It;if(r.has(i))return}if(xl(t,s,a),a&&s===void 0){var l=t.querySelector(":checked");l!==null&&(s=Vi(l),n(s))}t.__value=s,a=!1}),vp(t)}function Vi(t){return"__value"in t?t.__value:t.value}const Ma=Symbol("class"),va=Symbol("style"),hp=Symbol("is custom element"),pp=Symbol("is html"),__=gh?"option":"OPTION",b_=gh?"select":"SELECT";function w_(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function xt(t,e,n,r){var a=gp(t);a[e]!==(a[e]=n)&&(e==="loading"&&(t[Ym]=n),n==null?t.removeAttribute(e):typeof n!="string"&&mp(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function x_(t,e,n,r,a=!1,s=!1){var i=gp(t),l=i[hp],u=!i[pp],d=e||{},v=t.nodeName===__;for(var p in e)p in n||(n[p]=null);n.class?n.class=Ts(n.class):(r||n[Ma])&&(n.class=null),n[va]&&(n.style??(n.style=null));var h=mp(t);for(const V in n){let S=n[V];if(v&&V==="value"&&S==null){t.value=t.__value="",d[V]=S;continue}if(V==="class"){var m=t.namespaceURI==="http://www.w3.org/1999/xhtml";St(t,m,S,r,e==null?void 0:e[Ma],n[Ma]),d[V]=S,d[Ma]=n[Ma];continue}if(V==="style"){Dt(t,S,e==null?void 0:e[va],n[va]),d[V]=S,d[va]=n[va];continue}var x=d[V];if(!(S===x&&!(S===void 0&&t.hasAttribute(V)))){d[V]=S;var k=V[0]+V[1];if(k!=="$$")if(k==="on"){const K={},B="$$"+V;let O=V.slice(2);var E=t_(O);if($y(O)&&(O=O.slice(0,-7),K.capture=!0),!E&&x){if(S!=null)continue;t.removeEventListener(O,d[B],K),d[B]=null}if(S!=null)if(E)t[`__${O}`]=S,Xt([O]);else{let Q=function(se){d[V].call(this,se)};d[B]=vd(O,t,Q,K)}else E&&(t[`__${O}`]=void 0)}else if(V==="style")xt(t,V,S);else if(V==="autofocus")Gy(t,!!S);else if(!l&&(V==="__value"||V==="value"&&S!=null))t.value=t.__value=S;else if(V==="selected"&&v)w_(t,S);else{var N=V;u||(N=r_(N));var j=N==="defaultValue"||N==="defaultChecked";if(S==null&&!l&&!j)if(i[V]=null,N==="value"||N==="checked"){let K=t;const B=e===void 0;if(N==="value"){let O=K.defaultValue;K.removeAttribute(N),K.defaultValue=O,K.value=K.__value=B?O:null}else{let O=K.defaultChecked;K.removeAttribute(N),K.defaultChecked=O,K.checked=B?O:!1}}else t.removeAttribute(V);else j||h.includes(N)&&(l||typeof S!="string")?(t[N]=S,N in i&&(i[N]=wn)):typeof S!="function"&&xt(t,N,S)}}}return d}function Va(t,e,n=[],r=[],a=[],s,i=!1,l=!1){Rh(a,n,r,u=>{var d=void 0,v={},p=t.nodeName===b_,h=!1;if(Xh(()=>{var x=e(...u.map(o)),k=x_(t,d,x,s,i,l);h&&p&&"value"in x&&xl(t,x.value);for(let N of Object.getOwnPropertySymbols(v))x[N]||kn(v[N]);for(let N of Object.getOwnPropertySymbols(x)){var E=x[N];N.description===gy&&(!d||E!==d[N])&&(v[N]&&kn(v[N]),v[N]=$n(()=>p_(t,()=>E))),k[N]=E}d=k}),p){var m=t;hi(()=>{xl(m,d.value,!0),vp(m)})}h=!0})}function gp(t){return t.__attributes??(t.__attributes={[hp]:t.nodeName.includes("-"),[pp]:t.namespaceURI===_h})}var Ff=new Map;function mp(t){var e=t.getAttribute("is")||t.nodeName,n=Ff.get(e);if(n)return n;Ff.set(e,n=[]);for(var r,a=t,s=Element.prototype;s!==a;){r=ch(a);for(var i in r)r[i].set&&n.push(i);a=Wl(a)}return n}function Zr(t,e,n=e){var r=new WeakSet;Gh(t,"input",async a=>{var s=a?t.defaultValue:t.value;if(s=Kc(t)?Hc(s):s,n(s),It!==null&&r.add(It),await op(),s!==(s=e())){var i=t.selectionStart,l=t.selectionEnd,u=t.value.length;if(t.value=s??"",l!==null){var d=t.value.length;i===l&&l===u&&d>u?(t.selectionStart=d,t.selectionEnd=d):(t.selectionStart=i,t.selectionEnd=Math.min(l,d))}}}),er(e)==null&&t.value&&(n(Kc(t)?Hc(t.value):t.value),It!==null&&r.add(It)),Zl(()=>{var a=e();if(t===document.activeElement){var s=bl??It;if(r.has(s))return}Kc(t)&&a===Hc(t.value)||t.type==="date"&&!a&&!t.value||a!==t.value&&(t.value=a??"")})}function Kc(t){var e=t.type;return e==="number"||e==="range"}function Hc(t){return t===""?null:+t}var Ra,ei,uo,Hl,yp;const Gl=class Gl{constructor(e){Ie(this,Hl);Ie(this,Ra,new WeakMap);Ie(this,ei);Ie(this,uo);Et(this,uo,e)}observe(e,n){var r=F(this,Ra).get(e)||new Set;return r.add(n),F(this,Ra).set(e,r),An(this,Hl,yp).call(this).observe(e,F(this,uo)),()=>{var a=F(this,Ra).get(e);a.delete(n),a.size===0&&(F(this,Ra).delete(e),F(this,ei).unobserve(e))}}};Ra=new WeakMap,ei=new WeakMap,uo=new WeakMap,Hl=new WeakSet,yp=function(){return F(this,ei)??Et(this,ei,new ResizeObserver(e=>{for(var n of e){Gl.entries.set(n.target,n);for(var r of F(this,Ra).get(n.target)||[])r(n)}}))},ht(Gl,"entries",new WeakMap);let Au=Gl;var k_=new Au({box:"border-box"});function Kf(t,e,n){var r=k_.observe(t,()=>n(t[e]));hi(()=>(er(()=>n(t[e])),r))}function Hf(t,e){return t===e||(t==null?void 0:t[Qr])===e}function Cs(t={},e,n,r){return hi(()=>{var a,s;return Zl(()=>{a=s,s=[],er(()=>{t!==n(...s)&&(e(t,...s),a&&Hf(n(...a),t)&&e(null,...a))})}),()=>{Jr(()=>{s&&Hf(n(...s),t)&&e(null,...s)})}}),t}function S_(t=!1){const e=tn,n=e.l.u;if(!n)return;let r=()=>up(e.s);if(t){let a=0,s={};const i=yo(()=>{let l=!1;const u=e.s;for(const d in u)u[d]!==s[d]&&(s[d]=u[d],l=!0);return l&&a++,a});r=()=>o(i)}n.b.length&&Wh(()=>{Gf(e,r),fu(n.b)}),yn(()=>{const a=er(()=>n.m.map(Wm));return()=>{for(const s of a)typeof s=="function"&&s()}}),n.a.length&&yn(()=>{Gf(e,r),fu(n.a)})}function Gf(t,e){if(t.l.s)for(const n of t.l.s)o(n);e()}let Yo=!1;function E_(t){var e=Yo;try{return Yo=!1,[t(),Yo]}finally{Yo=e}}const A_={get(t,e){if(!t.exclude.includes(e))return t.props[e]},set(t,e){return!1},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function Is(t,e,n){return new Proxy({props:t,exclude:e},A_)}const T_={get(t,e){let n=t.props.length;for(;n--;){let r=t.props[n];if(Ci(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,n){let r=t.props.length;for(;r--;){let a=t.props[r];Ci(a)&&(a=a());const s=ja(a,e);if(s&&s.set)return s.set(n),!0}return!1},getOwnPropertyDescriptor(t,e){let n=t.props.length;for(;n--;){let r=t.props[n];if(Ci(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const a=ja(r,e);return a&&!a.configurable&&(a.configurable=!0),a}}},has(t,e){if(e===Qr||e===ph)return!1;for(let n of t.props)if(Ci(n)&&(n=n()),n!=null&&e in n)return!0;return!1},ownKeys(t){const e=[];for(let n of t.props)if(Ci(n)&&(n=n()),!!n){for(const r in n)e.includes(r)||e.push(r);for(const r of Object.getOwnPropertySymbols(n))e.includes(r)||e.push(r)}return e}};function Fs(...t){return new Proxy({props:t},T_)}function Ae(t,e,n,r){var V;var a=!vi||(n&dy)!==0,s=(n&vy)!==0,i=(n&hy)!==0,l=r,u=!0,d=()=>(u&&(u=!1,l=i?er(r):r),l),v;if(s){var p=Qr in t||ph in t;v=((V=ja(t,e))==null?void 0:V.set)??(p&&e in t?S=>t[e]=S:void 0)}var h,m=!1;s?[h,m]=E_(()=>t[e]):h=t[e],h===void 0&&r!==void 0&&(h=d(),v&&(a&&ty(),v(h)));var x;if(a?x=()=>{var S=t[e];return S===void 0?d():(u=!0,S)}:x=()=>{var S=t[e];return S!==void 0&&(l=void 0),S===void 0?l:S},a&&(n&fy)===0)return x;if(v){var k=t.$$legacy;return(function(S,K){return arguments.length>0?((!a||!K||k||m)&&v(K?x():S),S):x()})}var E=!1,N=((n&uy)!==0?yo:od)(()=>(E=!1,x()));s&&o(N);var j=Yt;return(function(S,K){if(arguments.length>0){const B=K?o(N):a&&s?Wt(S):S;return P(N,B),E=!0,l!==void 0&&(l=B),S}return Ka&&E||(j.f&ya)!==0?N.v:o(N)})}function _n(t){tn===null&&rd(),vi&&tn.l!==null?C_(tn).m.push(t):yn(()=>{const e=er(t);if(typeof e=="function")return e})}function md(t){tn===null&&rd(),_n(()=>()=>er(t))}function C_(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const I_="5";var lh;typeof window<"u"&&((lh=window.__svelte??(window.__svelte={})).v??(lh.v=new Set)).add(I_);var P_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dl={exports:{}},O_=dl.exports,Uf;function N_(){return Uf||(Uf=1,(function(t,e){((n,r)=>{t.exports=r()})(O_,function(){var n=function(c,f){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(g,y){g.__proto__=y}:function(g,y){for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(g[w]=y[w])}))(c,f)},r=function(){return(r=Object.assign||function(c){for(var f,g=1,y=arguments.length;g<y;g++)for(var w in f=arguments[g])Object.prototype.hasOwnProperty.call(f,w)&&(c[w]=f[w]);return c}).apply(this,arguments)};function a(c,f,g){for(var y,w=0,A=f.length;w<A;w++)!y&&w in f||((y=y||Array.prototype.slice.call(f,0,w))[w]=f[w]);return c.concat(y||Array.prototype.slice.call(f))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:P_,i=Object.keys,l=Array.isArray;function u(c,f){return typeof f=="object"&&i(f).forEach(function(g){c[g]=f[g]}),c}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var d=Object.getPrototypeOf,v={}.hasOwnProperty;function p(c,f){return v.call(c,f)}function h(c,f){typeof f=="function"&&(f=f(d(c))),(typeof Reflect>"u"?i:Reflect.ownKeys)(f).forEach(function(g){x(c,g,f[g])})}var m=Object.defineProperty;function x(c,f,g,y){m(c,f,u(g&&p(g,"get")&&typeof g.get=="function"?{get:g.get,set:g.set,configurable:!0}:{value:g,configurable:!0,writable:!0},y))}function k(c){return{from:function(f){return c.prototype=Object.create(f.prototype),x(c.prototype,"constructor",c),{extend:h.bind(null,c.prototype)}}}}var E=Object.getOwnPropertyDescriptor,N=[].slice;function j(c,f,g){return N.call(c,f,g)}function V(c,f){return f(c)}function S(c){if(!c)throw new Error("Assertion Failed")}function K(c){s.setImmediate?setImmediate(c):setTimeout(c,0)}function B(c,f){if(typeof f=="string"&&p(c,f))return c[f];if(!f)return c;if(typeof f!="string"){for(var g=[],y=0,w=f.length;y<w;++y){var A=B(c,f[y]);g.push(A)}return g}var R,W=f.indexOf(".");return W===-1||(R=c[f.substr(0,W)])==null?void 0:B(R,f.substr(W+1))}function O(c,f,g){if(c&&f!==void 0&&!("isFrozen"in Object&&Object.isFrozen(c)))if(typeof f!="string"&&"length"in f){S(typeof g!="string"&&"length"in g);for(var y=0,w=f.length;y<w;++y)O(c,f[y],g[y])}else{var A,R,W=f.indexOf(".");W!==-1?(A=f.substr(0,W),(W=f.substr(W+1))===""?g===void 0?l(c)&&!isNaN(parseInt(A))?c.splice(A,1):delete c[A]:c[A]=g:O(R=(R=c[A])&&p(c,A)?R:c[A]={},W,g)):g===void 0?l(c)&&!isNaN(parseInt(f))?c.splice(f,1):delete c[f]:c[f]=g}}function Q(c){var f,g={};for(f in c)p(c,f)&&(g[f]=c[f]);return g}var se=[].concat;function xe(c){return se.apply([],c)}var ie="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(xe([8,16,32,64].map(function(c){return["Int","Uint","Float"].map(function(f){return f+c+"Array"})}))).filter(function(c){return s[c]}),z=new Set(ie.map(function(c){return s[c]})),M=null;function q(c){return M=new WeakMap,c=(function f(g){if(!g||typeof g!="object")return g;var y=M.get(g);if(y)return y;if(l(g)){y=[],M.set(g,y);for(var w=0,A=g.length;w<A;++w)y.push(f(g[w]))}else if(z.has(g.constructor))y=g;else{var R,W=d(g);for(R in y=W===Object.prototype?{}:Object.create(W),M.set(g,y),g)p(g,R)&&(y[R]=f(g[R]))}return y})(c),M=null,c}var T={}.toString;function D(c){return T.call(c).slice(8,-1)}var I=typeof Symbol<"u"?Symbol.iterator:"@@iterator",X=typeof I=="symbol"?function(c){var f;return c!=null&&(f=c[I])&&f.apply(c)}:function(){return null};function Y(c,f){f=c.indexOf(f),0<=f&&c.splice(f,1)}var Z={};function U(c){var f,g,y,w;if(arguments.length===1){if(l(c))return c.slice();if(this===Z&&typeof c=="string")return[c];if(w=X(c))for(g=[];!(y=w.next()).done;)g.push(y.value);else{if(c==null)return[c];if(typeof(f=c.length)!="number")return[c];for(g=new Array(f);f--;)g[f]=c[f]}}else for(f=arguments.length,g=new Array(f);f--;)g[f]=arguments[f];return g}var te=typeof Symbol<"u"?function(c){return c[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ie=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],tt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ie),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function G(c,f){this.name=c,this.message=f}function re(c,f){return c+". Errors: "+Object.keys(f).map(function(g){return f[g].toString()}).filter(function(g,y,w){return w.indexOf(g)===y}).join(`
`)}function ae(c,f,g,y){this.failures=f,this.failedKeys=y,this.successCount=g,this.message=re(c,f)}function pe(c,f){this.name="BulkError",this.failures=Object.keys(f).map(function(g){return f[g]}),this.failuresByPos=f,this.message=re(c,this.failures)}k(G).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(ae).from(G),k(pe).from(G);var _e=tt.reduce(function(c,f){return c[f]=f+"Error",c},{}),ne=G,$=tt.reduce(function(c,f){var g=f+"Error";function y(w,A){this.name=g,w?typeof w=="string"?(this.message="".concat(w).concat(A?`
 `+A:""),this.inner=A||null):typeof w=="object"&&(this.message="".concat(w.name," ").concat(w.message),this.inner=w):(this.message=H[f]||g,this.inner=null)}return k(y).from(ne),c[f]=y,c},{}),ke=($.Syntax=SyntaxError,$.Type=TypeError,$.Range=RangeError,ie.reduce(function(c,f){return c[f+"Error"]=$[f],c},{}));ie=tt.reduce(function(c,f){return["Syntax","Type","Range"].indexOf(f)===-1&&(c[f+"Error"]=$[f]),c},{});function be(){}function Me(c){return c}function Xe(c,f){return c==null||c===Me?f:function(g){return f(c(g))}}function Je(c,f){return function(){c.apply(this,arguments),f.apply(this,arguments)}}function ct(c,f){return c===be?f:function(){var g=c.apply(this,arguments),y=(g!==void 0&&(arguments[0]=g),this.onsuccess),w=this.onerror,A=(this.onsuccess=null,this.onerror=null,f.apply(this,arguments));return y&&(this.onsuccess=this.onsuccess?Je(y,this.onsuccess):y),w&&(this.onerror=this.onerror?Je(w,this.onerror):w),A!==void 0?A:g}}function De(c,f){return c===be?f:function(){c.apply(this,arguments);var g=this.onsuccess,y=this.onerror;this.onsuccess=this.onerror=null,f.apply(this,arguments),g&&(this.onsuccess=this.onsuccess?Je(g,this.onsuccess):g),y&&(this.onerror=this.onerror?Je(y,this.onerror):y)}}function Oe(c,f){return c===be?f:function(w){var y=c.apply(this,arguments),w=(u(w,y),this.onsuccess),A=this.onerror,R=(this.onsuccess=null,this.onerror=null,f.apply(this,arguments));return w&&(this.onsuccess=this.onsuccess?Je(w,this.onsuccess):w),A&&(this.onerror=this.onerror?Je(A,this.onerror):A),y===void 0?R===void 0?void 0:R:u(y,R)}}function qe(c,f){return c===be?f:function(){return f.apply(this,arguments)!==!1&&c.apply(this,arguments)}}function Ne(c,f){return c===be?f:function(){var g=c.apply(this,arguments);if(g&&typeof g.then=="function"){for(var y=this,w=arguments.length,A=new Array(w);w--;)A[w]=arguments[w];return g.then(function(){return f.apply(y,A)})}return f.apply(this,arguments)}}ie.ModifyError=ae,ie.DexieError=G,ie.BulkError=pe;var Fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ke(c){Fe=c}var $e={},Ze=100,Ge=typeof Promise>"u"?[]:(tt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Ge=crypto.subtle.digest("SHA-512",new Uint8Array([0])),d(Ge),tt]:[tt,d(tt),tt]),tt=Ge[0],Ls=Ge[1],Ls=Ls&&Ls.then,nt=tt&&tt.constructor,ft=!!Ge[2],mt=function(c,f){Rt.push([c,f]),kt&&(queueMicrotask(Mn),kt=!1)},vt=!0,kt=!0,bt=[],pt=[],yt=Me,dt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:be,pgp:!1,env:{},finalize:be},je=dt,Rt=[],At=0,Gt=[];function Re(c){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var f=this._PSD=je;if(typeof c!="function"){if(c!==$e)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&ye(this,this._value)}else this._state=null,this._value=null,++f.ref,(function g(y,w){try{w(function(A){if(y._state===null){if(A===y)throw new TypeError("A promise cannot be resolved with itself.");var R=y._lib&&it();A&&typeof A.then=="function"?g(y,function(W,fe){A instanceof Re?A._then(W,fe):A.then(W,fe)}):(y._state=!0,y._value=A,ln(y)),R&&ut()}},ye.bind(null,y))}catch(A){ye(y,A)}})(this,c)}var Qt={get:function(){var c=je,f=en;function g(y,w){var A=this,R=!c.global&&(c!==je||f!==en),W=R&&!xr(),fe=new Re(function(Se,ve){En(A,new Gn(ce(y,c,R,W),ce(w,c,R,W),Se,ve,c))});return this._consoleTask&&(fe._consoleTask=this._consoleTask),fe}return g.prototype=$e,g},set:function(c){x(this,"then",c&&c.prototype===$e?Qt:{get:function(){return c},set:Qt.set})}};function Gn(c,f,g,y,w){this.onFulfilled=typeof c=="function"?c:null,this.onRejected=typeof f=="function"?f:null,this.resolve=g,this.reject=y,this.psd=w}function ye(c,f){var g,y;pt.push(f),c._state===null&&(g=c._lib&&it(),f=yt(f),c._state=!1,c._value=f,y=c,bt.some(function(w){return w._value===y._value})||bt.push(y),ln(c),g)&&ut()}function ln(c){var f=c._listeners;c._listeners=[];for(var g=0,y=f.length;g<y;++g)En(c,f[g]);var w=c._PSD;--w.ref||w.finalize(),At===0&&(++At,mt(function(){--At==0&&Pt()},[]))}function En(c,f){if(c._state===null)c._listeners.push(f);else{var g=c._state?f.onFulfilled:f.onRejected;if(g===null)return(c._state?f.resolve:f.reject)(c._value);++f.psd.ref,++At,mt(Ct,[g,c,f])}}function Ct(c,f,g){try{var y,w=f._value;!f._state&&pt.length&&(pt=[]),y=Fe&&f._consoleTask?f._consoleTask.run(function(){return c(w)}):c(w),f._state||pt.indexOf(w)!==-1||(A=>{for(var R=bt.length;R;)if(bt[--R]._value===A._value)return bt.splice(R,1)})(f),g.resolve(y)}catch(A){g.reject(A)}finally{--At==0&&Pt(),--g.psd.ref||g.psd.finalize()}}function Mn(){ot(dt,function(){it()&&ut()})}function it(){var c=vt;return kt=vt=!1,c}function ut(){var c,f,g;do for(;0<Rt.length;)for(c=Rt,Rt=[],g=c.length,f=0;f<g;++f){var y=c[f];y[0].apply(null,y[1])}while(0<Rt.length);kt=vt=!0}function Pt(){for(var c=bt,f=(bt=[],c.forEach(function(y){y._PSD.onunhandled.call(null,y._value,y)}),Gt.slice(0)),g=f.length;g;)f[--g]()}function $t(c){return new Re($e,!1,c)}function _t(c,f){var g=je;return function(){var y=it(),w=je;try{return kr(g,!0),c.apply(this,arguments)}catch(A){f&&f(A)}finally{kr(w,!1),y&&ut()}}}h(Re.prototype,{then:Qt,_then:function(c,f){En(this,new Gn(null,null,c,f,je))},catch:function(c){var f,g;return arguments.length===1?this.then(null,c):(f=c,g=arguments[1],typeof f=="function"?this.then(null,function(y){return(y instanceof f?g:$t)(y)}):this.then(null,function(y){return(y&&y.name===f?g:$t)(y)}))},finally:function(c){return this.then(function(f){return Re.resolve(c()).then(function(){return f})},function(f){return Re.resolve(c()).then(function(){return $t(f)})})},timeout:function(c,f){var g=this;return c<1/0?new Re(function(y,w){var A=setTimeout(function(){return w(new $.Timeout(f))},c);g.then(y,w).finally(clearTimeout.bind(null,A))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&x(Re.prototype,Symbol.toStringTag,"Dexie.Promise"),dt.env=Po(),h(Re,{all:function(){var c=U.apply(null,arguments).map(Wa);return new Re(function(f,g){c.length===0&&f([]);var y=c.length;c.forEach(function(w,A){return Re.resolve(w).then(function(R){c[A]=R,--y||f(c)},g)})})},resolve:function(c){return c instanceof Re?c:c&&typeof c.then=="function"?new Re(function(f,g){c.then(f,g)}):new Re($e,!0,c)},reject:$t,race:function(){var c=U.apply(null,arguments).map(Wa);return new Re(function(f,g){c.map(function(y){return Re.resolve(y).then(f,g)})})},PSD:{get:function(){return je},set:function(c){return je=c}},totalEchoes:{get:function(){return en}},newPSD:On,usePSD:ot,scheduler:{get:function(){return mt},set:function(c){mt=c}},rejectionMapper:{get:function(){return yt},set:function(c){yt=c}},follow:function(c,f){return new Re(function(g,y){return On(function(w,A){var R=je;R.unhandleds=[],R.onunhandled=A,R.finalize=Je(function(){var W,fe=this;W=function(){fe.unhandleds.length===0?w():A(fe.unhandleds[0])},Gt.push(function Se(){W(),Gt.splice(Gt.indexOf(Se),1)}),++At,mt(function(){--At==0&&Pt()},[])},R.finalize),c()},f,g,y)})}}),nt&&(nt.allSettled&&x(Re,"allSettled",function(){var c=U.apply(null,arguments).map(Wa);return new Re(function(f){c.length===0&&f([]);var g=c.length,y=new Array(g);c.forEach(function(w,A){return Re.resolve(w).then(function(R){return y[A]={status:"fulfilled",value:R}},function(R){return y[A]={status:"rejected",reason:R}}).then(function(){return--g||f(y)})})})}),nt.any&&typeof AggregateError<"u"&&x(Re,"any",function(){var c=U.apply(null,arguments).map(Wa);return new Re(function(f,g){c.length===0&&g(new AggregateError([]));var y=c.length,w=new Array(y);c.forEach(function(A,R){return Re.resolve(A).then(function(W){return f(W)},function(W){w[R]=W,--y||g(new AggregateError(w))})})})}),nt.withResolvers)&&(Re.withResolvers=nt.withResolvers);var jt={awaits:0,echoes:0,id:0},fn=0,cn=[],Jt=0,en=0,jn=0;function On(c,R,g,y){var w=je,A=Object.create(w),R=(A.parent=w,A.ref=0,A.global=!1,A.id=++jn,dt.env,A.env=ft?{Promise:Re,PromiseProp:{value:Re,configurable:!0,writable:!0},all:Re.all,race:Re.race,allSettled:Re.allSettled,any:Re.any,resolve:Re.resolve,reject:Re.reject}:{},R&&u(A,R),++w.ref,A.finalize=function(){--this.parent.ref||this.parent.finalize()},ot(A,c,g,y));return A.ref===0&&A.finalize(),R}function Nn(){return jt.id||(jt.id=++fn),++jt.awaits,jt.echoes+=Ze,jt.id}function xr(){return!!jt.awaits&&(--jt.awaits==0&&(jt.id=0),jt.echoes=jt.awaits*Ze,!0)}function Wa(c){return jt.echoes&&c&&c.constructor===nt?(Nn(),c.then(function(f){return xr(),f},function(f){return xr(),Ue(f)})):c}function Io(){var c=cn[cn.length-1];cn.pop(),kr(c,!1)}function kr(c,f){var g,y,w=je;(f?!jt.echoes||Jt++&&c===je:!Jt||--Jt&&c===je)||queueMicrotask(f?(function(A){++en,jt.echoes&&--jt.echoes!=0||(jt.echoes=jt.awaits=jt.id=0),cn.push(je),kr(A,!0)}).bind(null,c):Io),c!==je&&(je=c,w===dt&&(dt.env=Po()),ft)&&(g=dt.env.Promise,y=c.env,w.global||c.global)&&(Object.defineProperty(s,"Promise",y.PromiseProp),g.all=y.all,g.race=y.race,g.resolve=y.resolve,g.reject=y.reject,y.allSettled&&(g.allSettled=y.allSettled),y.any)&&(g.any=y.any)}function Po(){var c=s.Promise;return ft?{Promise:c,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:c.all,race:c.race,allSettled:c.allSettled,any:c.any,resolve:c.resolve,reject:c.reject}:{}}function ot(c,f,g,y,w){var A=je;try{return kr(c,!0),f(g,y,w)}finally{kr(A,!1)}}function ce(c,f,g,y){return typeof c!="function"?c:function(){var w=je;g&&Nn(),kr(f,!0);try{return c.apply(this,arguments)}finally{kr(w,!1),y&&queueMicrotask(xr)}}}function Be(c){Promise===nt&&jt.echoes===0?Jt===0?c():enqueueNativeMicroTask(c):setTimeout(c,0)}(""+Ls).indexOf("[native code]")===-1&&(Nn=xr=be);var Ue=Re.reject,Ft="ï¿¿",nn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",un="String expected.",hn=[],Un="__dbnames",Br="readonly",Ya="readwrite";function sn(c,f){return c?f?function(){return c.apply(this,arguments)&&f.apply(this,arguments)}:c:f}var yi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xa(c){return typeof c!="string"||/\./.test(c)?function(f){return f}:function(f){return f[c]===void 0&&c in f&&delete(f=q(f))[c],f}}function tf(){throw $.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function zt(c,f){try{var g=nf(c),y=nf(f);if(g!==y)return g==="Array"?1:y==="Array"?-1:g==="binary"?1:y==="binary"?-1:g==="string"?1:y==="string"?-1:g==="Date"?1:y!=="Date"?NaN:-1;switch(g){case"number":case"Date":case"string":return f<c?1:c<f?-1:0;case"binary":for(var w=rf(c),A=rf(f),R=w.length,W=A.length,fe=R<W?R:W,Se=0;Se<fe;++Se)if(w[Se]!==A[Se])return w[Se]<A[Se]?-1:1;return R===W?0:R<W?-1:1;case"Array":for(var ve=c,le=f,ge=ve.length,me=le.length,he=ge<me?ge:me,de=0;de<he;++de){var Ee=zt(ve[de],le[de]);if(Ee!==0)return Ee}return ge===me?0:ge<me?-1:1}}catch{}return NaN}function nf(c){var f=typeof c;return f=="object"&&(ArrayBuffer.isView(c)||(f=D(c))==="ArrayBuffer")?"binary":f}function rf(c){return c instanceof Uint8Array?c:ArrayBuffer.isView(c)?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c)}function Mo(c,f,g){var y=c.schema.yProps;return y?(f&&0<g.numFailures&&(f=f.filter(function(w,A){return!g.failures[A]})),Promise.all(y.map(function(w){return w=w.updatesTable,f?c.db.table(w).where("k").anyOf(f).delete():c.db.table(w).clear()})).then(function(){return g})):g}af.prototype.execute=function(c){var f=this["@@propmod"];if(f.add!==void 0){var g=f.add;if(l(g))return a(a([],l(c)?c:[],!0),g).sort();if(typeof g=="number")return(Number(c)||0)+g;if(typeof g=="bigint")try{return BigInt(c)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(f.remove!==void 0){var y=f.remove;if(l(y))return l(c)?c.filter(function(w){return!y.includes(w)}).sort():[];if(typeof y=="number")return Number(c)-y;if(typeof y=="bigint")try{return BigInt(c)-y}catch{return BigInt(0)-y}throw new TypeError("Invalid subtrahend ".concat(y))}return g=(g=f.replacePrefix)==null?void 0:g[0],g&&typeof c=="string"&&c.startsWith(g)?f.replacePrefix[1]+c.substring(g.length):c};var _i=af;function af(c){this["@@propmod"]=c}function sf(c,f){for(var g=i(f),y=g.length,w=!1,A=0;A<y;++A){var R=g[A],W=f[R],fe=B(c,R);W instanceof _i?(O(c,R,W.execute(fe)),w=!0):fe!==W&&(O(c,R,W),w=!0)}return w}rn.prototype._trans=function(c,f,g){var y=this._tx||je.trans,w=this.name,A=Fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(c==="readonly"?"read":"write"," ").concat(this.name));function R(Se,ve,le){if(le.schema[w])return f(le.idbtrans,le);throw new $.NotFound("Table "+w+" not part of transaction")}var W=it();try{var fe=y&&y.db._novip===this.db._novip?y===je.trans?y._promise(c,R,g):On(function(){return y._promise(c,R,g)},{trans:y,transless:je.transless||je}):(function Se(ve,le,ge,me){if(ve.idbdb&&(ve._state.openComplete||je.letThrough||ve._vip)){var he=ve._createTransaction(le,ge,ve._dbSchema);try{he.create(),ve._state.PR1398_maxLoop=3}catch(de){return de.name===_e.InvalidState&&ve.isOpen()&&0<--ve._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ve.close({disableAutoOpen:!1}),ve.open().then(function(){return Se(ve,le,ge,me)})):Ue(de)}return he._promise(le,function(de,Ee){return On(function(){return je.trans=he,me(de,Ee,he)})}).then(function(de){if(le==="readwrite")try{he.idbtrans.commit()}catch{}return le==="readonly"?de:he._completion.then(function(){return de})})}if(ve._state.openComplete)return Ue(new $.DatabaseClosed(ve._state.dbOpenError));if(!ve._state.isBeingOpened){if(!ve._state.autoOpen)return Ue(new $.DatabaseClosed);ve.open().catch(be)}return ve._state.dbReadyPromise.then(function(){return Se(ve,le,ge,me)})})(this.db,c,[this.name],R);return A&&(fe._consoleTask=A,fe=fe.catch(function(Se){return console.trace(Se),Ue(Se)})),fe}finally{W&&ut()}},rn.prototype.get=function(c,f){var g=this;return c&&c.constructor===Object?this.where(c).first(f):c==null?Ue(new $.Type("Invalid argument to Table.get()")):this._trans("readonly",function(y){return g.core.get({trans:y,key:c}).then(function(w){return g.hook.reading.fire(w)})}).then(f)},rn.prototype.where=function(c){if(typeof c=="string")return new this.db.WhereClause(this,c);if(l(c))return new this.db.WhereClause(this,"[".concat(c.join("+"),"]"));var f=i(c);if(f.length===1)return this.where(f[0]).equals(c[f[0]]);var g=this.schema.indexes.concat(this.schema.primKey).filter(function(W){if(W.compound&&f.every(function(Se){return 0<=W.keyPath.indexOf(Se)})){for(var fe=0;fe<f.length;++fe)if(f.indexOf(W.keyPath[fe])===-1)return!1;return!0}return!1}).sort(function(W,fe){return W.keyPath.length-fe.keyPath.length})[0];if(g&&this.db._maxKey!==Ft)return R=g.keyPath.slice(0,f.length),this.where(R).equals(R.map(function(W){return c[W]}));!g&&Fe&&console.warn("The query ".concat(JSON.stringify(c)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(f.join("+"),"]"));var y=this.schema.idxByName;function w(W,fe){return zt(W,fe)===0}var R=f.reduce(function(ve,fe){var Se=ve[0],ve=ve[1],le=y[fe],ge=c[fe];return[Se||le,Se||!le?sn(ve,le&&le.multi?function(me){return me=B(me,fe),l(me)&&me.some(function(he){return w(ge,he)})}:function(me){return w(ge,B(me,fe))}):ve]},[null,null]),A=R[0],R=R[1];return A?this.where(A.name).equals(c[A.keyPath]).filter(R):g?this.filter(R):this.where(f).equals("")},rn.prototype.filter=function(c){return this.toCollection().and(c)},rn.prototype.count=function(c){return this.toCollection().count(c)},rn.prototype.offset=function(c){return this.toCollection().offset(c)},rn.prototype.limit=function(c){return this.toCollection().limit(c)},rn.prototype.each=function(c){return this.toCollection().each(c)},rn.prototype.toArray=function(c){return this.toCollection().toArray(c)},rn.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rn.prototype.orderBy=function(c){return new this.db.Collection(new this.db.WhereClause(this,l(c)?"[".concat(c.join("+"),"]"):c))},rn.prototype.reverse=function(){return this.toCollection().reverse()},rn.prototype.mapToClass=function(c){for(var f=this.db,g=this.name,y=((this.schema.mappedClass=c).prototype instanceof tf&&(c=(R=>{var W=ve,fe=R;if(typeof fe!="function"&&fe!==null)throw new TypeError("Class extends value "+String(fe)+" is not a constructor or null");function Se(){this.constructor=W}function ve(){return R!==null&&R.apply(this,arguments)||this}return n(W,fe),W.prototype=fe===null?Object.create(fe):(Se.prototype=fe.prototype,new Se),Object.defineProperty(ve.prototype,"db",{get:function(){return f},enumerable:!1,configurable:!0}),ve.prototype.table=function(){return g},ve})(c)),new Set),w=c.prototype;w;w=d(w))Object.getOwnPropertyNames(w).forEach(function(R){return y.add(R)});function A(R){if(!R)return R;var W,fe=Object.create(c.prototype);for(W in R)if(!y.has(W))try{fe[W]=R[W]}catch{}return fe}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=A,this.hook("reading",A),c},rn.prototype.defineClass=function(){return this.mapToClass(function(c){u(this,c)})},rn.prototype.add=function(c,f){var g=this,y=this.schema.primKey,w=y.auto,A=y.keyPath,R=c;return A&&w&&(R=Xa(A)(c)),this._trans("readwrite",function(W){return g.core.mutate({trans:W,type:"add",keys:f!=null?[f]:null,values:[R]})}).then(function(W){return W.numFailures?Re.reject(W.failures[0]):W.lastResult}).then(function(W){if(A)try{O(c,A,W)}catch{}return W})},rn.prototype.upsert=function(c,f){var g=this,y=this.schema.primKey.keyPath;return this._trans("readwrite",function(w){return g.core.get({trans:w,key:c}).then(function(A){var R=A??{};return sf(R,f),y&&O(R,y,c),g.core.mutate({trans:w,type:"put",values:[R],keys:[c],upsert:!0,updates:{keys:[c],changeSpecs:[f]}}).then(function(W){return W.numFailures?Re.reject(W.failures[0]):!!A})})})},rn.prototype.update=function(c,f){return typeof c!="object"||l(c)?this.where(":id").equals(c).modify(f):(c=B(c,this.schema.primKey.keyPath))===void 0?Ue(new $.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(f)},rn.prototype.put=function(c,f){var g=this,y=this.schema.primKey,w=y.auto,A=y.keyPath,R=c;return A&&w&&(R=Xa(A)(c)),this._trans("readwrite",function(W){return g.core.mutate({trans:W,type:"put",values:[R],keys:f!=null?[f]:null})}).then(function(W){return W.numFailures?Re.reject(W.failures[0]):W.lastResult}).then(function(W){if(A)try{O(c,A,W)}catch{}return W})},rn.prototype.delete=function(c){var f=this;return this._trans("readwrite",function(g){return f.core.mutate({trans:g,type:"delete",keys:[c]}).then(function(y){return Mo(f,[c],y)}).then(function(y){return y.numFailures?Re.reject(y.failures[0]):void 0})})},rn.prototype.clear=function(){var c=this;return this._trans("readwrite",function(f){return c.core.mutate({trans:f,type:"deleteRange",range:yi}).then(function(g){return Mo(c,null,g)})}).then(function(f){return f.numFailures?Re.reject(f.failures[0]):void 0})},rn.prototype.bulkGet=function(c){var f=this;return this._trans("readonly",function(g){return f.core.getMany({keys:c,trans:g}).then(function(y){return y.map(function(w){return f.hook.reading.fire(w)})})})},rn.prototype.bulkAdd=function(c,f,g){var y=this,w=Array.isArray(f)?f:void 0,A=(g=g||(w?void 0:f))?g.allKeys:void 0;return this._trans("readwrite",function(R){var W=y.schema.primKey,Se=W.auto,W=W.keyPath;if(W&&w)throw new $.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(w&&w.length!==c.length)throw new $.InvalidArgument("Arguments objects and keys must have the same length");var fe=c.length,Se=W&&Se?c.map(Xa(W)):c;return y.core.mutate({trans:R,type:"add",keys:w,values:Se,wantResults:A}).then(function(ve){var le=ve.numFailures,ge=ve.failures;if(le===0)return A?ve.results:ve.lastResult;throw new pe("".concat(y.name,".bulkAdd(): ").concat(le," of ").concat(fe," operations failed"),ge)})})},rn.prototype.bulkPut=function(c,f,g){var y=this,w=Array.isArray(f)?f:void 0,A=(g=g||(w?void 0:f))?g.allKeys:void 0;return this._trans("readwrite",function(R){var W=y.schema.primKey,Se=W.auto,W=W.keyPath;if(W&&w)throw new $.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(w&&w.length!==c.length)throw new $.InvalidArgument("Arguments objects and keys must have the same length");var fe=c.length,Se=W&&Se?c.map(Xa(W)):c;return y.core.mutate({trans:R,type:"put",keys:w,values:Se,wantResults:A}).then(function(ve){var le=ve.numFailures,ge=ve.failures;if(le===0)return A?ve.results:ve.lastResult;throw new pe("".concat(y.name,".bulkPut(): ").concat(le," of ").concat(fe," operations failed"),ge)})})},rn.prototype.bulkUpdate=function(c){var f=this,g=this.core,y=c.map(function(R){return R.key}),w=c.map(function(R){return R.changes}),A=[];return this._trans("readwrite",function(R){return g.getMany({trans:R,keys:y,cache:"clone"}).then(function(W){var fe=[],Se=[],ve=(c.forEach(function(le,ge){var me=le.key,he=le.changes,de=W[ge];if(de){for(var Ee=0,Te=Object.keys(he);Ee<Te.length;Ee++){var we=Te[Ee],Ce=he[we];if(we===f.schema.primKey.keyPath){if(zt(Ce,me)!==0)throw new $.Constraint("Cannot update primary key in bulkUpdate()")}else O(de,we,Ce)}A.push(ge),fe.push(me),Se.push(de)}}),fe.length);return g.mutate({trans:R,type:"put",keys:fe,values:Se,updates:{keys:y,changeSpecs:w}}).then(function(le){var ge=le.numFailures,me=le.failures;if(ge===0)return ve;for(var he=0,de=Object.keys(me);he<de.length;he++){var Ee,Te=de[he],we=A[Number(Te)];we!=null&&(Ee=me[Te],delete me[Te],me[we]=Ee)}throw new pe("".concat(f.name,".bulkUpdate(): ").concat(ge," of ").concat(ve," operations failed"),me)})})})},rn.prototype.bulkDelete=function(c){var f=this,g=c.length;return this._trans("readwrite",function(y){return f.core.mutate({trans:y,type:"delete",keys:c}).then(function(w){return Mo(f,c,w)})}).then(function(y){var w=y.numFailures,A=y.failures;if(w===0)return y.lastResult;throw new pe("".concat(f.name,".bulkDelete(): ").concat(w," of ").concat(g," operations failed"),A)})};var of=rn;function rn(){}function bi(c){function f(R,W){if(W){for(var fe=arguments.length,Se=new Array(fe-1);--fe;)Se[fe-1]=arguments[fe];return g[R].subscribe.apply(null,Se),c}if(typeof R=="string")return g[R]}var g={};f.addEventType=A;for(var y=1,w=arguments.length;y<w;++y)A(arguments[y]);return f;function A(R,W,fe){var Se,ve;if(typeof R!="object")return W=W||qe,ve={subscribers:[],fire:fe=fe||be,subscribe:function(le){ve.subscribers.indexOf(le)===-1&&(ve.subscribers.push(le),ve.fire=W(ve.fire,le))},unsubscribe:function(le){ve.subscribers=ve.subscribers.filter(function(ge){return ge!==le}),ve.fire=ve.subscribers.reduce(W,fe)}},g[R]=f[R]=ve;i(Se=R).forEach(function(le){var ge=Se[le];if(l(ge))A(le,Se[le][0],Se[le][1]);else{if(ge!=="asap")throw new $.InvalidArgument("Invalid event config");var me=A(le,Me,function(){for(var he=arguments.length,de=new Array(he);he--;)de[he]=arguments[he];me.subscribers.forEach(function(Ee){K(function(){Ee.apply(null,de)})})})}})}}function wi(c,f){return k(f).from({prototype:c}),f}function Ns(c,f){return!(c.filter||c.algorithm||c.or)&&(f?c.justLimit:!c.replayFilter)}function hc(c,f){c.filter=sn(c.filter,f)}function pc(c,f,g){var y=c.replayFilter;c.replayFilter=y?function(){return sn(y(),f())}:f,c.justLimit=g&&!y}function Oo(c,f){if(c.isPrimKey)return f.primaryKey;var g=f.getIndexByKeyPath(c.index);if(g)return g;throw new $.Schema("KeyPath "+c.index+" on object store "+f.name+" is not indexed")}function lf(c,f,g){var y=Oo(c,f.schema);return f.openCursor({trans:g,values:!c.keysOnly,reverse:c.dir==="prev",unique:!!c.unique,query:{index:y,range:c.range}})}function No(c,f,g,y){var w,A,R=c.replayFilter?sn(c.filter,c.replayFilter()):c.filter;return c.or?(w={},A=function(W,fe,Se){var ve,le;R&&!R(fe,Se,function(ge){return fe.stop(ge)},function(ge){return fe.fail(ge)})||((le=""+(ve=fe.primaryKey))=="[object ArrayBuffer]"&&(le=""+new Uint8Array(ve)),p(w,le))||(w[le]=!0,f(W,fe,Se))},Promise.all([c.or._iterate(A,g),cf(lf(c,y,g),c.algorithm,A,!c.keysOnly&&c.valueMapper)])):cf(lf(c,y,g),sn(c.algorithm,R),f,!c.keysOnly&&c.valueMapper)}function cf(c,f,g,y){var w=_t(y?function(A,R,W){return g(y(A),R,W)}:g);return c.then(function(A){if(A)return A.start(function(){var R=function(){return A.continue()};f&&!f(A,function(W){return R=W},function(W){A.stop(W),R=be},function(W){A.fail(W),R=be})||w(A.value,A,function(W){return R=W}),R()})})}Kt.prototype._read=function(c,f){var g=this._ctx;return g.error?g.table._trans(null,Ue.bind(null,g.error)):g.table._trans("readonly",c).then(f)},Kt.prototype._write=function(c){var f=this._ctx;return f.error?f.table._trans(null,Ue.bind(null,f.error)):f.table._trans("readwrite",c,"locked")},Kt.prototype._addAlgorithm=function(c){var f=this._ctx;f.algorithm=sn(f.algorithm,c)},Kt.prototype._iterate=function(c,f){return No(this._ctx,c,f,this._ctx.table.core)},Kt.prototype.clone=function(c){var f=Object.create(this.constructor.prototype),g=Object.create(this._ctx);return c&&u(g,c),f._ctx=g,f},Kt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Kt.prototype.each=function(c){var f=this._ctx;return this._read(function(g){return No(f,c,g,f.table.core)})},Kt.prototype.count=function(c){var f=this;return this._read(function(g){var y,w=f._ctx,A=w.table.core;return Ns(w,!0)?A.count({trans:g,query:{index:Oo(w,A.schema),range:w.range}}).then(function(R){return Math.min(R,w.limit)}):(y=0,No(w,function(){return++y,!1},g,A).then(function(){return y}))}).then(c)},Kt.prototype.sortBy=function(c,f){var g=c.split(".").reverse(),y=g[0],w=g.length-1;function A(fe,Se){return Se?A(fe[g[Se]],Se-1):fe[y]}var R=this._ctx.dir==="next"?1:-1;function W(fe,Se){return zt(A(fe,w),A(Se,w))*R}return this.toArray(function(fe){return fe.sort(W)}).then(f)},Kt.prototype.toArray=function(c){var f=this;return this._read(function(g){var y,w,A,R=f._ctx;return R.dir==="next"&&Ns(R,!0)&&0<R.limit?(y=R.valueMapper,w=Oo(R,R.table.core.schema),R.table.core.query({trans:g,limit:R.limit,values:!0,query:{index:w,range:R.range}}).then(function(W){return W=W.result,y?W.map(y):W})):(A=[],No(R,function(W){return A.push(W)},g,R.table.core).then(function(){return A}))},c)},Kt.prototype.offset=function(c){var f=this._ctx;return c<=0||(f.offset+=c,Ns(f)?pc(f,function(){var g=c;return function(y,w){return g===0||(g===1?--g:w(function(){y.advance(g),g=0}),!1)}}):pc(f,function(){var g=c;return function(){return--g<0}})),this},Kt.prototype.limit=function(c){return this._ctx.limit=Math.min(this._ctx.limit,c),pc(this._ctx,function(){var f=c;return function(g,y,w){return--f<=0&&y(w),0<=f}},!0),this},Kt.prototype.until=function(c,f){return hc(this._ctx,function(g,y,w){return!c(g.value)||(y(w),f)}),this},Kt.prototype.first=function(c){return this.limit(1).toArray(function(f){return f[0]}).then(c)},Kt.prototype.last=function(c){return this.reverse().first(c)},Kt.prototype.filter=function(c){var f;return hc(this._ctx,function(g){return c(g.value)}),(f=this._ctx).isMatch=sn(f.isMatch,c),this},Kt.prototype.and=function(c){return this.filter(c)},Kt.prototype.or=function(c){return new this.db.WhereClause(this._ctx.table,c,this)},Kt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Kt.prototype.desc=function(){return this.reverse()},Kt.prototype.eachKey=function(c){var f=this._ctx;return f.keysOnly=!f.isMatch,this.each(function(g,y){c(y.key,y)})},Kt.prototype.eachUniqueKey=function(c){return this._ctx.unique="unique",this.eachKey(c)},Kt.prototype.eachPrimaryKey=function(c){var f=this._ctx;return f.keysOnly=!f.isMatch,this.each(function(g,y){c(y.primaryKey,y)})},Kt.prototype.keys=function(c){var f=this._ctx,g=(f.keysOnly=!f.isMatch,[]);return this.each(function(y,w){g.push(w.key)}).then(function(){return g}).then(c)},Kt.prototype.primaryKeys=function(c){var f=this._ctx;if(f.dir==="next"&&Ns(f,!0)&&0<f.limit)return this._read(function(y){var w=Oo(f,f.table.core.schema);return f.table.core.query({trans:y,values:!1,limit:f.limit,query:{index:w,range:f.range}})}).then(function(y){return y.result}).then(c);f.keysOnly=!f.isMatch;var g=[];return this.each(function(y,w){g.push(w.primaryKey)}).then(function(){return g}).then(c)},Kt.prototype.uniqueKeys=function(c){return this._ctx.unique="unique",this.keys(c)},Kt.prototype.firstKey=function(c){return this.limit(1).keys(function(f){return f[0]}).then(c)},Kt.prototype.lastKey=function(c){return this.reverse().firstKey(c)},Kt.prototype.distinct=function(){var c,f=this._ctx,f=f.index&&f.table.schema.idxByName[f.index];return f&&f.multi&&(c={},hc(this._ctx,function(y){var y=y.primaryKey.toString(),w=p(c,y);return c[y]=!0,!w})),this},Kt.prototype.modify=function(c){var f=this,g=this._ctx;return this._write(function(y){function w(de,Ee){var Te=Ee.failures;ge+=de-Ee.numFailures;for(var we=0,Ce=i(Te);we<Ce.length;we++){var Le=Ce[we];le.push(Te[Le])}}var A=typeof c=="function"?c:function(de){return sf(de,c)},R=g.table.core,ve=R.schema.primaryKey,W=ve.outbound,fe=ve.extractKey,Se=200,ve=f.db._options.modifyChunkSize,le=(ve&&(Se=typeof ve=="object"?ve[R.name]||ve["*"]||200:ve),[]),ge=0,me=[],he=c===uf;return f.clone().primaryKeys().then(function(de){function Ee(we){var Ce=Math.min(Se,de.length-we),Le=de.slice(we,we+Ce);return(he?Promise.resolve([]):R.getMany({trans:y,keys:Le,cache:"immutable"})).then(function(Ve){var We=[],ze=[],et=W?[]:null,Qe=he?Le:[];if(!he)for(var He=0;He<Ce;++He){var rt=Ve[He],qt={value:q(rt),primKey:de[we+He]};A.call(qt,qt.value,qt)!==!1&&(qt.value==null?Qe.push(de[we+He]):W||zt(fe(rt),fe(qt.value))===0?(ze.push(qt.value),W&&et.push(de[we+He])):(Qe.push(de[we+He]),We.push(qt.value)))}return Promise.resolve(0<We.length&&R.mutate({trans:y,type:"add",values:We}).then(function(Ht){for(var gt in Ht.failures)Qe.splice(parseInt(gt),1);w(We.length,Ht)})).then(function(){return(0<ze.length||Te&&typeof c=="object")&&R.mutate({trans:y,type:"put",keys:et,values:ze,criteria:Te,changeSpec:typeof c!="function"&&c,isAdditionalChunk:0<we}).then(function(Ht){return w(ze.length,Ht)})}).then(function(){return(0<Qe.length||Te&&he)&&R.mutate({trans:y,type:"delete",keys:Qe,criteria:Te,isAdditionalChunk:0<we}).then(function(Ht){return Mo(g.table,Qe,Ht)}).then(function(Ht){return w(Qe.length,Ht)})}).then(function(){return de.length>we+Ce&&Ee(we+Se)})})}var Te=Ns(g)&&g.limit===1/0&&(typeof c!="function"||he)&&{index:g.index,range:g.range};return Ee(0).then(function(){if(0<le.length)throw new ae("Error modifying one or more objects",le,ge,me);return de.length})})})},Kt.prototype.delete=function(){var c=this._ctx,f=c.range;return!Ns(c)||c.table.schema.yProps||!c.isPrimKey&&f.type!==3?this.modify(uf):this._write(function(g){var y=c.table.core.schema.primaryKey,w=f;return c.table.core.count({trans:g,query:{index:y,range:w}}).then(function(A){return c.table.core.mutate({trans:g,type:"deleteRange",range:w}).then(function(fe){var W=fe.failures,fe=fe.numFailures;if(fe)throw new ae("Could not delete some values",Object.keys(W).map(function(Se){return W[Se]}),A-fe);return A-fe})})})};var xm=Kt;function Kt(){}var uf=function(c,f){return f.value=null};function km(c,f){return c<f?-1:c===f?0:1}function Sm(c,f){return f<c?-1:c===f?0:1}function rr(c,f,g){return c=c instanceof ff?new c.Collection(c):c,c._ctx.error=new(g||TypeError)(f),c}function Ds(c){return new c.Collection(c,function(){return df("")}).limit(0)}function Do(me,f,g,y){var w,A,R,W,fe,Se,ve,le=g.length;if(!g.every(function(de){return typeof de=="string"}))return rr(me,un);function ge(de){w=de==="next"?function(Te){return Te.toUpperCase()}:function(Te){return Te.toLowerCase()},A=de==="next"?function(Te){return Te.toLowerCase()}:function(Te){return Te.toUpperCase()},R=de==="next"?km:Sm;var Ee=g.map(function(Te){return{lower:A(Te),upper:w(Te)}}).sort(function(Te,we){return R(Te.lower,we.lower)});W=Ee.map(function(Te){return Te.upper}),fe=Ee.map(function(Te){return Te.lower}),ve=(Se=de)==="next"?"":y}ge("next");var me=new me.Collection(me,function(){return Ea(W[0],fe[le-1]+y)}),he=(me._ondirectionchange=function(de){ge(de)},0);return me._addAlgorithm(function(de,Ee,Te){var we=de.key;if(typeof we=="string"){var Ce=A(we);if(f(Ce,fe,he))return!0;for(var Le=null,Ve=he;Ve<le;++Ve){var We=((ze,et,Qe,He,rt,qt)=>{for(var Ht=Math.min(ze.length,He.length),gt=-1,Mt=0;Mt<Ht;++Mt){var dn=et[Mt];if(dn!==He[Mt])return rt(ze[Mt],Qe[Mt])<0?ze.substr(0,Mt)+Qe[Mt]+Qe.substr(Mt+1):rt(ze[Mt],He[Mt])<0?ze.substr(0,Mt)+He[Mt]+Qe.substr(Mt+1):0<=gt?ze.substr(0,gt)+et[gt]+Qe.substr(gt+1):null;rt(ze[Mt],dn)<0&&(gt=Mt)}return Ht<He.length&&qt==="next"?ze+Qe.substr(ze.length):Ht<ze.length&&qt==="prev"?ze.substr(0,Qe.length):gt<0?null:ze.substr(0,gt)+He[gt]+Qe.substr(gt+1)})(we,Ce,W[Ve],fe[Ve],R,Se);We===null&&Le===null?he=Ve+1:(Le===null||0<R(Le,We))&&(Le=We)}Ee(Le!==null?function(){de.continue(Le+ve)}:Te)}return!1}),me}function Ea(c,f,g,y){return{type:2,lower:c,upper:f,lowerOpen:g,upperOpen:y}}function df(c){return{type:1,lower:c,upper:c}}Object.defineProperty(bn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),bn.prototype.between=function(c,f,g,y){g=g!==!1,y=y===!0;try{return 0<this._cmp(c,f)||this._cmp(c,f)===0&&(g||y)&&(!g||!y)?Ds(this):new this.Collection(this,function(){return Ea(c,f,!g,!y)})}catch{return rr(this,nn)}},bn.prototype.equals=function(c){return c==null?rr(this,nn):new this.Collection(this,function(){return df(c)})},bn.prototype.above=function(c){return c==null?rr(this,nn):new this.Collection(this,function(){return Ea(c,void 0,!0)})},bn.prototype.aboveOrEqual=function(c){return c==null?rr(this,nn):new this.Collection(this,function(){return Ea(c,void 0,!1)})},bn.prototype.below=function(c){return c==null?rr(this,nn):new this.Collection(this,function(){return Ea(void 0,c,!1,!0)})},bn.prototype.belowOrEqual=function(c){return c==null?rr(this,nn):new this.Collection(this,function(){return Ea(void 0,c)})},bn.prototype.startsWith=function(c){return typeof c!="string"?rr(this,un):this.between(c,c+Ft,!0,!0)},bn.prototype.startsWithIgnoreCase=function(c){return c===""?this.startsWith(c):Do(this,function(f,g){return f.indexOf(g[0])===0},[c],Ft)},bn.prototype.equalsIgnoreCase=function(c){return Do(this,function(f,g){return f===g[0]},[c],"")},bn.prototype.anyOfIgnoreCase=function(){var c=U.apply(Z,arguments);return c.length===0?Ds(this):Do(this,function(f,g){return g.indexOf(f)!==-1},c,"")},bn.prototype.startsWithAnyOfIgnoreCase=function(){var c=U.apply(Z,arguments);return c.length===0?Ds(this):Do(this,function(f,g){return g.some(function(y){return f.indexOf(y)===0})},c,Ft)},bn.prototype.anyOf=function(){var c,f,g=this,y=U.apply(Z,arguments),w=this._cmp;try{y.sort(w)}catch{return rr(this,nn)}return y.length===0?Ds(this):((c=new this.Collection(this,function(){return Ea(y[0],y[y.length-1])}))._ondirectionchange=function(A){w=A==="next"?g._ascending:g._descending,y.sort(w)},f=0,c._addAlgorithm(function(A,R,W){for(var fe=A.key;0<w(fe,y[f]);)if(++f===y.length)return R(W),!1;return w(fe,y[f])===0||(R(function(){A.continue(y[f])}),!1)}),c)},bn.prototype.notEqual=function(c){return this.inAnyRange([[-1/0,c],[c,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},bn.prototype.noneOf=function(){var c=U.apply(Z,arguments);if(c.length===0)return new this.Collection(this);try{c.sort(this._ascending)}catch{return rr(this,nn)}var f=c.reduce(function(g,y){return g?g.concat([[g[g.length-1][1],y]]):[[-1/0,y]]},null);return f.push([c[c.length-1],this.db._maxKey]),this.inAnyRange(f,{includeLowers:!1,includeUppers:!1})},bn.prototype.inAnyRange=function(c,Te){var g=this,y=this._cmp,w=this._ascending,A=this._descending,R=this._min,W=this._max;if(c.length===0)return Ds(this);if(!c.every(function(we){return we[0]!==void 0&&we[1]!==void 0&&w(we[0],we[1])<=0}))return rr(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",$.InvalidArgument);var fe=!Te||Te.includeLowers!==!1,Se=Te&&Te.includeUppers===!0,ve,le=w;function ge(we,Ce){return le(we[0],Ce[0])}try{(ve=c.reduce(function(we,Ce){for(var Le=0,Ve=we.length;Le<Ve;++Le){var We=we[Le];if(y(Ce[0],We[1])<0&&0<y(Ce[1],We[0])){We[0]=R(We[0],Ce[0]),We[1]=W(We[1],Ce[1]);break}}return Le===Ve&&we.push(Ce),we},[])).sort(ge)}catch{return rr(this,nn)}var me=0,he=Se?function(we){return 0<w(we,ve[me][1])}:function(we){return 0<=w(we,ve[me][1])},de=fe?function(we){return 0<A(we,ve[me][0])}:function(we){return 0<=A(we,ve[me][0])},Ee=he,Te=new this.Collection(this,function(){return Ea(ve[0][0],ve[ve.length-1][1],!fe,!Se)});return Te._ondirectionchange=function(we){le=we==="next"?(Ee=he,w):(Ee=de,A),ve.sort(ge)},Te._addAlgorithm(function(we,Ce,Le){for(var Ve,We=we.key;Ee(We);)if(++me===ve.length)return Ce(Le),!1;return!he(Ve=We)&&!de(Ve)||(g._cmp(We,ve[me][1])===0||g._cmp(We,ve[me][0])===0||Ce(function(){le===w?we.continue(ve[me][0]):we.continue(ve[me][1])}),!1)}),Te},bn.prototype.startsWithAnyOf=function(){var c=U.apply(Z,arguments);return c.every(function(f){return typeof f=="string"})?c.length===0?Ds(this):this.inAnyRange(c.map(function(f){return[f,f+Ft]})):rr(this,"startsWithAnyOf() only works with strings")};var ff=bn;function bn(){}function Fr(c){return _t(function(f){return xi(f),c(f.target.error),!1})}function xi(c){c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault()}var ki="storagemutated",gc="x-storagemutated-1",Aa=bi(null,ki),Em=(Kr.prototype._lock=function(){return S(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},Kr.prototype._unlock=function(){if(S(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var c=this._blockedFuncs.shift();try{ot(c[1],c[0])}catch{}}return this},Kr.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},Kr.prototype.create=function(c){var f=this;if(this.mode){var g=this.db.idbdb,y=this.db._state.dbOpenError;if(S(!this.idbtrans),!c&&!g)switch(y&&y.name){case"DatabaseClosedError":throw new $.DatabaseClosed(y);case"MissingAPIError":throw new $.MissingAPI(y.message,y);default:throw new $.OpenFailed(y)}if(!this.active)throw new $.TransactionInactive;S(this._completion._state===null),(c=this.idbtrans=c||(this.db.core||g).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=_t(function(w){xi(w),f._reject(c.error)}),c.onabort=_t(function(w){xi(w),f.active&&f._reject(new $.Abort(c.error)),f.active=!1,f.on("abort").fire(w)}),c.oncomplete=_t(function(){f.active=!1,f._resolve(),"mutatedParts"in c&&Aa.storagemutated.fire(c.mutatedParts)})}return this},Kr.prototype._promise=function(c,f,g){var y,w=this;return c==="readwrite"&&this.mode!=="readwrite"?Ue(new $.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Re(function(A,R){w._blockedFuncs.push([function(){w._promise(c,f,g).then(A,R)},je])}):g?On(function(){var A=new Re(function(R,W){w._lock();var fe=f(R,W,w);fe&&fe.then&&fe.then(R,W)});return A.finally(function(){return w._unlock()}),A._lib=!0,A}):((y=new Re(function(A,R){var W=f(A,R,w);W&&W.then&&W.then(A,R)}))._lib=!0,y):Ue(new $.TransactionInactive)},Kr.prototype._root=function(){return this.parent?this.parent._root():this},Kr.prototype.waitFor=function(c){var f,g=this._root(),y=Re.resolve(c),w=(g._waitingFor?g._waitingFor=g._waitingFor.then(function(){return y}):(g._waitingFor=y,g._waitingQueue=[],f=g.idbtrans.objectStore(g.storeNames[0]),(function A(){for(++g._spinCount;g._waitingQueue.length;)g._waitingQueue.shift()();g._waitingFor&&(f.get(-1/0).onsuccess=A)})()),g._waitingFor);return new Re(function(A,R){y.then(function(W){return g._waitingQueue.push(_t(A.bind(null,W)))},function(W){return g._waitingQueue.push(_t(R.bind(null,W)))}).finally(function(){g._waitingFor===w&&(g._waitingFor=null)})})},Kr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new $.Abort))},Kr.prototype.table=function(c){var f=this._memoizedTables||(this._memoizedTables={});if(p(f,c))return f[c];var g=this.schema[c];if(g)return(g=new this.db.Table(c,g,this)).core=this.db.core.table(c),f[c]=g;throw new $.NotFound("Table "+c+" not part of transaction")},Kr);function Kr(){}function mc(c,f,g,y,w,A,R,W){return{name:c,keyPath:f,unique:g,multi:y,auto:w,compound:A,src:(g&&!R?"&":"")+(y?"*":"")+(w?"++":"")+vf(f),type:W}}function vf(c){return typeof c=="string"?c:c?"["+[].join.call(c,"+")+"]":""}function yc(c,f,g){return{name:c,primKey:f,indexes:g,mappedClass:null,idxByName:(y=function(w){return[w.name,w]},g.reduce(function(w,A,R){return A=y(A,R),A&&(w[A[0]]=A[1]),w},{}))};var y}var Si=function(c){try{return c.only([[]]),Si=function(){return[[]]},[[]]}catch{return Si=function(){return Ft},Ft}};function _c(c){return c==null?function(){}:typeof c=="string"?(f=c).split(".").length===1?function(g){return g[f]}:function(g){return B(g,f)}:function(g){return B(g,c)};var f}function hf(c){return[].slice.call(c)}var Am=0;function Ei(c){return c==null?":id":typeof c=="string"?c:"[".concat(c.join("+"),"]")}function Tm(c,f,fe){function y(he){if(he.type===3)return null;if(he.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var le=he.lower,ge=he.upper,me=he.lowerOpen,he=he.upperOpen;return le===void 0?ge===void 0?null:f.upperBound(ge,!!he):ge===void 0?f.lowerBound(le,!!me):f.bound(le,ge,!!me,!!he)}function w(ve){var le,ge=ve.name;return{name:ge,schema:ve,mutate:function(me){var he=me.trans,de=me.type,Ee=me.keys,Te=me.values,we=me.range;return new Promise(function(Ce,Le){Ce=_t(Ce);var Ve=he.objectStore(ge),We=Ve.keyPath==null,ze=de==="put"||de==="add";if(!ze&&de!=="delete"&&de!=="deleteRange")throw new Error("Invalid operation type: "+de);var et,Qe=(Ee||Te||{length:1}).length;if(Ee&&Te&&Ee.length!==Te.length)throw new Error("Given keys array must have same length as given values array.");if(Qe===0)return Ce({numFailures:0,failures:{},results:[],lastResult:void 0});function He(vn){++Ht,xi(vn)}var rt=[],qt=[],Ht=0;if(de==="deleteRange"){if(we.type===4)return Ce({numFailures:Ht,failures:qt,results:[],lastResult:void 0});we.type===3?rt.push(et=Ve.clear()):rt.push(et=Ve.delete(y(we)))}else{var We=ze?We?[Te,Ee]:[Te,null]:[Ee,null],gt=We[0],Mt=We[1];if(ze)for(var dn=0;dn<Qe;++dn)rt.push(et=Mt&&Mt[dn]!==void 0?Ve[de](gt[dn],Mt[dn]):Ve[de](gt[dn])),et.onerror=He;else for(dn=0;dn<Qe;++dn)rt.push(et=Ve[de](gt[dn])),et.onerror=He}function fr(vn){vn=vn.target.result,rt.forEach(function(Ja,jc){return Ja.error!=null&&(qt[jc]=Ja.error)}),Ce({numFailures:Ht,failures:qt,results:de==="delete"?Ee:rt.map(function(Ja){return Ja.result}),lastResult:vn})}et.onerror=function(vn){He(vn),fr(vn)},et.onsuccess=fr})},getMany:function(me){var he=me.trans,de=me.keys;return new Promise(function(Ee,Te){Ee=_t(Ee);for(var we,Ce=he.objectStore(ge),Le=de.length,Ve=new Array(Le),We=0,ze=0,et=function(rt){rt=rt.target,Ve[rt._pos]=rt.result,++ze===We&&Ee(Ve)},Qe=Fr(Te),He=0;He<Le;++He)de[He]!=null&&((we=Ce.get(de[He]))._pos=He,we.onsuccess=et,we.onerror=Qe,++We);We===0&&Ee(Ve)})},get:function(me){var he=me.trans,de=me.key;return new Promise(function(Ee,Te){Ee=_t(Ee);var we=he.objectStore(ge).get(de);we.onsuccess=function(Ce){return Ee(Ce.target.result)},we.onerror=Fr(Te)})},query:(le=W,function(me){return new Promise(function(he,de){he=_t(he);var Ee,Te,we,ze=me.trans,Ce=me.values,Le=me.limit,We=me.query,Ve=Le===1/0?void 0:Le,et=We.index,We=We.range,ze=ze.objectStore(ge),ze=et.isPrimaryKey?ze:ze.index(et.name),et=y(We);if(Le===0)return he({result:[]});le?((We=Ce?ze.getAll(et,Ve):ze.getAllKeys(et,Ve)).onsuccess=function(Qe){return he({result:Qe.target.result})},We.onerror=Fr(de)):(Ee=0,Te=!Ce&&"openKeyCursor"in ze?ze.openKeyCursor(et):ze.openCursor(et),we=[],Te.onsuccess=function(Qe){var He=Te.result;return!He||(we.push(Ce?He.value:He.primaryKey),++Ee===Le)?he({result:we}):void He.continue()},Te.onerror=Fr(de))})}),openCursor:function(me){var he=me.trans,de=me.values,Ee=me.query,Te=me.reverse,we=me.unique;return new Promise(function(Ce,Le){Ce=_t(Ce);var ze=Ee.index,Ve=Ee.range,We=he.objectStore(ge),We=ze.isPrimaryKey?We:We.index(ze.name),ze=Te?we?"prevunique":"prev":we?"nextunique":"next",et=!de&&"openKeyCursor"in We?We.openKeyCursor(y(Ve),ze):We.openCursor(y(Ve),ze);et.onerror=Fr(Le),et.onsuccess=_t(function(Qe){var He,rt,qt,Ht,gt=et.result;gt?(gt.___id=++Am,gt.done=!1,He=gt.continue.bind(gt),rt=(rt=gt.continuePrimaryKey)&&rt.bind(gt),qt=gt.advance.bind(gt),Ht=function(){throw new Error("Cursor not stopped")},gt.trans=he,gt.stop=gt.continue=gt.continuePrimaryKey=gt.advance=function(){throw new Error("Cursor not started")},gt.fail=_t(Le),gt.next=function(){var Mt=this,dn=1;return this.start(function(){return dn--?Mt.continue():Mt.stop()}).then(function(){return Mt})},gt.start=function(Mt){function dn(){if(et.result)try{Mt()}catch(vn){gt.fail(vn)}else gt.done=!0,gt.start=function(){throw new Error("Cursor behind last entry")},gt.stop()}var fr=new Promise(function(vn,Ja){vn=_t(vn),et.onerror=Fr(Ja),gt.fail=Ja,gt.stop=function(jc){gt.stop=gt.continue=gt.continuePrimaryKey=gt.advance=Ht,vn(jc)}});return et.onsuccess=_t(function(vn){et.onsuccess=dn,dn()}),gt.continue=He,gt.continuePrimaryKey=rt,gt.advance=qt,dn(),fr},Ce(gt)):Ce(null)},Le)})},count:function(me){var he=me.query,de=me.trans,Ee=he.index,Te=he.range;return new Promise(function(we,Ce){var Le=de.objectStore(ge),Le=Ee.isPrimaryKey?Le:Le.index(Ee.name),Ve=y(Te),Ve=Ve?Le.count(Ve):Le.count();Ve.onsuccess=_t(function(We){return we(We.target.result)}),Ve.onerror=Fr(Ce)})}}}A=fe,R=hf((fe=c).objectStoreNames);var A,fe={schema:{name:fe.name,tables:R.map(function(ve){return A.objectStore(ve)}).map(function(ve){var le=ve.keyPath,ge=ve.autoIncrement,he=l(le),me={},he={name:ve.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:le==null,compound:he,keyPath:le,autoIncrement:ge,unique:!0,extractKey:_c(le)},indexes:hf(ve.indexNames).map(function(de){return ve.index(de)}).map(function(we){var Ce=we.name,Ee=we.unique,Te=we.multiEntry,we=we.keyPath,Ce={name:Ce,compound:l(we),keyPath:we,unique:Ee,multiEntry:Te,extractKey:_c(we)};return me[Ei(we)]=Ce}),getIndexByKeyPath:function(de){return me[Ei(de)]}};return me[":id"]=he.primaryKey,le!=null&&(me[Ei(le)]=he.primaryKey),he})},hasGetAll:0<R.length&&"getAll"in A.objectStore(R[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},R=fe.schema,W=fe.hasGetAll,fe=R.tables.map(w),Se={};return fe.forEach(function(ve){return Se[ve.name]=ve}),{stack:"dbcore",transaction:c.transaction.bind(c),table:function(ve){if(Se[ve])return Se[ve];throw new Error("Table '".concat(ve,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Si(f),schema:R}}function Cm(c,f,g,y){return g=g.IDBKeyRange,f=Tm(f,g,y),{dbcore:c.dbcore.reduce(function(w,A){return A=A.create,r(r({},w),A(w))},f)}}function Ro(c,f){var g=f.db,g=Cm(c._middlewares,g,c._deps,f);c.core=g.dbcore,c.tables.forEach(function(y){var w=y.name;c.core.schema.tables.some(function(A){return A.name===w})&&(y.core=c.core.table(w),c[w]instanceof c.Table)&&(c[w].core=y.core)})}function Lo(c,f,g,y){g.forEach(function(w){var A=y[w];f.forEach(function(R){var W=(function fe(Se,ve){return E(Se,ve)||(Se=d(Se))&&fe(Se,ve)})(R,w);(!W||"value"in W&&W.value===void 0)&&(R===c.Transaction.prototype||R instanceof c.Transaction?x(R,w,{get:function(){return this.table(w)},set:function(fe){m(this,w,{value:fe,writable:!0,configurable:!0,enumerable:!0})}}):R[w]=new c.Table(w,A))})})}function bc(c,f){f.forEach(function(g){for(var y in g)g[y]instanceof c.Table&&delete g[y]})}function Im(c,f){return c._cfg.version-f._cfg.version}function Pm(c,f,g,y){var w=c._dbSchema,A=(g.objectStoreNames.contains("$meta")&&!w.$meta&&(w.$meta=yc("$meta",gf("")[0],[]),c._storeNames.push("$meta")),c._createTransaction("readwrite",c._storeNames,w)),R=(A.create(g),A._completion.catch(y),A._reject.bind(A)),W=je.transless||je;On(function(){if(je.trans=A,je.transless=W,f!==0)return Ro(c,g),Se=f,((fe=A).storeNames.includes("$meta")?fe.table("$meta").get("version").then(function(ve){return ve??Se}):Re.resolve(Se)).then(function(Ee){var le=c,ge=Ee,me=A,he=g,de=[],Ee=le._versions,Te=le._dbSchema=zo(0,le.idbdb,he);return(Ee=Ee.filter(function(we){return we._cfg.version>=ge})).length===0?Re.resolve():(Ee.forEach(function(we){de.push(function(){var Ce,Le,Ve,We=Te,ze=we._cfg.dbschema,et=(qo(le,We,he),qo(le,ze,he),Te=le._dbSchema=ze,wc(We,ze)),Qe=(et.add.forEach(function(He){xc(he,He[0],He[1].primKey,He[1].indexes)}),et.change.forEach(function(He){if(He.recreate)throw new $.Upgrade("Not yet support for changing primary key");var rt=he.objectStore(He.name);He.add.forEach(function(qt){return jo(rt,qt)}),He.change.forEach(function(qt){rt.deleteIndex(qt.name),jo(rt,qt)}),He.del.forEach(function(qt){return rt.deleteIndex(qt)})}),we._cfg.contentUpgrade);if(Qe&&we._cfg.version>ge)return Ro(le,he),me._memoizedTables={},Ce=Q(ze),et.del.forEach(function(He){Ce[He]=We[He]}),bc(le,[le.Transaction.prototype]),Lo(le,[le.Transaction.prototype],i(Ce),Ce),me.schema=Ce,(Le=te(Qe))&&Nn(),ze=Re.follow(function(){var He;(Ve=Qe(me))&&Le&&(He=xr.bind(null,null),Ve.then(He,He))}),Ve&&typeof Ve.then=="function"?Re.resolve(Ve):ze.then(function(){return Ve})}),de.push(function(Ce){var Le,Ve,We=we._cfg.dbschema;Le=We,Ve=Ce,[].slice.call(Ve.db.objectStoreNames).forEach(function(ze){return Le[ze]==null&&Ve.db.deleteObjectStore(ze)}),bc(le,[le.Transaction.prototype]),Lo(le,[le.Transaction.prototype],le._storeNames,le._dbSchema),me.schema=le._dbSchema}),de.push(function(Ce){le.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(le.idbdb.version/10)===we._cfg.version?(le.idbdb.deleteObjectStore("$meta"),delete le._dbSchema.$meta,le._storeNames=le._storeNames.filter(function(Le){return Le!=="$meta"})):Ce.objectStore("$meta").put(we._cfg.version,"version"))})}),(function we(){return de.length?Re.resolve(de.shift()(me.idbtrans)).then(we):Re.resolve()})().then(function(){pf(Te,he)}))}).catch(R);var fe,Se;i(w).forEach(function(ve){xc(g,ve,w[ve].primKey,w[ve].indexes)}),Ro(c,g),Re.follow(function(){return c.on.populate.fire(A)}).catch(R)})}function Mm(c,f){pf(c._dbSchema,f),f.db.version%10!=0||f.objectStoreNames.contains("$meta")||f.db.createObjectStore("$meta").add(Math.ceil(f.db.version/10-1),"version");var g=zo(0,c.idbdb,f);qo(c,c._dbSchema,f);for(var y=0,w=wc(g,c._dbSchema).change;y<w.length;y++){var A=(R=>{if(R.change.length||R.recreate)return console.warn("Unable to patch indexes of table ".concat(R.name," because it has changes on the type of index or primary key.")),{value:void 0};var W=f.objectStore(R.name);R.add.forEach(function(fe){Fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(R.name,".").concat(fe.src)),jo(W,fe)})})(w[y]);if(typeof A=="object")return A.value}}function wc(c,f){var g,y={del:[],add:[],change:[]};for(g in c)f[g]||y.del.push(g);for(g in f){var w=c[g],A=f[g];if(w){var R={name:g,def:A,recreate:!1,del:[],add:[],change:[]};if(""+(w.primKey.keyPath||"")!=""+(A.primKey.keyPath||"")||w.primKey.auto!==A.primKey.auto)R.recreate=!0,y.change.push(R);else{var W=w.idxByName,fe=A.idxByName,Se=void 0;for(Se in W)fe[Se]||R.del.push(Se);for(Se in fe){var ve=W[Se],le=fe[Se];ve?ve.src!==le.src&&R.change.push(le):R.add.push(le)}(0<R.del.length||0<R.add.length||0<R.change.length)&&y.change.push(R)}}else y.add.push([g,A])}return y}function xc(c,f,g,y){var w=c.db.createObjectStore(f,g.keyPath?{keyPath:g.keyPath,autoIncrement:g.auto}:{autoIncrement:g.auto});y.forEach(function(A){return jo(w,A)})}function pf(c,f){i(c).forEach(function(g){f.db.objectStoreNames.contains(g)||(Fe&&console.debug("Dexie: Creating missing table",g),xc(f,g,c[g].primKey,c[g].indexes))})}function jo(c,f){c.createIndex(f.name,f.keyPath,{unique:f.unique,multiEntry:f.multi})}function zo(c,f,g){var y={};return j(f.objectStoreNames,0).forEach(function(w){for(var A=g.objectStore(w),R=mc(vf(Se=A.keyPath),Se||"",!0,!1,!!A.autoIncrement,Se&&typeof Se!="string",!0),W=[],fe=0;fe<A.indexNames.length;++fe){var ve=A.index(A.indexNames[fe]),Se=ve.keyPath,ve=mc(ve.name,Se,!!ve.unique,!!ve.multiEntry,!1,Se&&typeof Se!="string",!1);W.push(ve)}y[w]=yc(w,R,W)}),y}function qo(c,f,g){for(var y=g.db.objectStoreNames,w=0;w<y.length;++w){var A=y[w],R=g.objectStore(A);c._hasGetAll="getAll"in R;for(var W=0;W<R.indexNames.length;++W){var fe,Se=R.indexNames[W],ve=R.index(Se).keyPath,ve=typeof ve=="string"?ve:"["+j(ve).join("+")+"]";f[A]&&(fe=f[A].idxByName[ve])&&(fe.name=Se,delete f[A].idxByName[ve],f[A].idxByName[Se]=fe)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(c._hasGetAll=!1)}function gf(c){return c.split(",").map(function(f,g){var w=f.split(":"),y=(y=w[1])==null?void 0:y.trim(),w=(f=w[0].trim()).replace(/([&*]|\+\+)/g,""),A=/^\[/.test(w)?w.match(/^\[(.*)\]$/)[1].split("+"):w;return mc(w,A||null,/\&/.test(f),/\*/.test(f),/\+\+/.test(f),l(A),g===0,y)})}Rs.prototype._createTableSchema=yc,Rs.prototype._parseIndexSyntax=gf,Rs.prototype._parseStoresSpec=function(c,f){var g=this;i(c).forEach(function(y){if(c[y]!==null){var w=g._parseIndexSyntax(c[y]),A=w.shift();if(!A)throw new $.Schema("Invalid schema for table "+y+": "+c[y]);if(A.unique=!0,A.multi)throw new $.Schema("Primary key cannot be multiEntry*");w.forEach(function(R){if(R.auto)throw new $.Schema("Only primary key can be marked as autoIncrement (++)");if(!R.keyPath)throw new $.Schema("Index must have a name and cannot be an empty string")}),A=g._createTableSchema(y,A,w),f[y]=A}})},Rs.prototype.stores=function(g){var f=this.db,g=(this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,g):g,f._versions),y={},w={};return g.forEach(function(A){u(y,A._cfg.storesSource),w=A._cfg.dbschema={},A._parseStoresSpec(y,w)}),f._dbSchema=w,bc(f,[f._allTables,f,f.Transaction.prototype]),Lo(f,[f._allTables,f,f.Transaction.prototype,this._cfg.tables],i(w),w),f._storeNames=i(w),this},Rs.prototype.upgrade=function(c){return this._cfg.contentUpgrade=Ne(this._cfg.contentUpgrade||be,c),this};var Om=Rs;function Rs(){}function kc(c,f){var g=c._dbNamesDB;return g||(g=c._dbNamesDB=new ia(Un,{addons:[],indexedDB:c,IDBKeyRange:f})).version(1).stores({dbnames:"name"}),g.table("dbnames")}function Sc(c){return c&&typeof c.databases=="function"}function Ec(c){return On(function(){return je.letThrough=!0,c()})}function Ac(c){return!("from"in c)}var Dn=function(c,f){var g;if(!this)return g=new Dn,c&&"d"in c&&u(g,c),g;u(this,arguments.length?{d:1,from:c,to:1<arguments.length?f:c}:{d:0})};function Ai(c,f,g){var y=zt(f,g);if(!isNaN(y)){if(0<y)throw RangeError();if(Ac(c))return u(c,{from:f,to:g,d:1});var y=c.l,w=c.r;if(zt(g,c.from)<0)return y?Ai(y,f,g):c.l={from:f,to:g,d:1,l:null,r:null},yf(c);if(0<zt(f,c.to))return w?Ai(w,f,g):c.r={from:f,to:g,d:1,l:null,r:null},yf(c);zt(f,c.from)<0&&(c.from=f,c.l=null,c.d=w?w.d+1:1),0<zt(g,c.to)&&(c.to=g,c.r=null,c.d=c.l?c.l.d+1:1),f=!c.r,y&&!c.l&&Ti(c,y),w&&f&&Ti(c,w)}}function Ti(c,f){Ac(f)||(function g(y,w){var A=w.from,R=w.l,W=w.r;Ai(y,A,w.to),R&&g(y,R),W&&g(y,W)})(c,f)}function mf(c,f){var g=Bo(f),y=g.next();if(!y.done)for(var w=y.value,A=Bo(c),R=A.next(w.from),W=R.value;!y.done&&!R.done;){if(zt(W.from,w.to)<=0&&0<=zt(W.to,w.from))return!0;zt(w.from,W.from)<0?w=(y=g.next(W.from)).value:W=(R=A.next(w.from)).value}return!1}function Bo(c){var f=Ac(c)?null:{s:0,n:c};return{next:function(g){for(var y=0<arguments.length;f;)switch(f.s){case 0:if(f.s=1,y)for(;f.n.l&&zt(g,f.n.from)<0;)f={up:f,n:f.n.l,s:1};else for(;f.n.l;)f={up:f,n:f.n.l,s:1};case 1:if(f.s=2,!y||zt(g,f.n.to)<=0)return{value:f.n,done:!1};case 2:if(f.n.r){f.s=3,f={up:f,n:f.n.r,s:0};continue}case 3:f=f.up}return{done:!0}}}}function yf(c){var f,g,y,w=(((w=c.r)==null?void 0:w.d)||0)-(((w=c.l)==null?void 0:w.d)||0),w=1<w?"r":w<-1?"l":"";w&&(f=w=="r"?"l":"r",g=r({},c),y=c[w],c.from=y.from,c.to=y.to,c[w]=y[w],g[w]=y[f],(c[f]=g).d=_f(g)),c.d=_f(c)}function _f(g){var f=g.r,g=g.l;return(f?g?Math.max(f.d,g.d):f.d:g?g.d:0)+1}function Fo(c,f){return i(f).forEach(function(g){c[g]?Ti(c[g],f[g]):c[g]=(function y(w){var A,R,W={};for(A in w)p(w,A)&&(R=w[A],W[A]=!R||typeof R!="object"||z.has(R.constructor)?R:y(R));return W})(f[g])}),c}function Tc(c,f){return c.all||f.all||Object.keys(c).some(function(g){return f[g]&&mf(f[g],c[g])})}h(Dn.prototype,((tt={add:function(c){return Ti(this,c),this},addKey:function(c){return Ai(this,c,c),this},addKeys:function(c){var f=this;return c.forEach(function(g){return Ai(f,g,g)}),this},hasKey:function(c){var f=Bo(this).next(c).value;return f&&zt(f.from,c)<=0&&0<=zt(f.to,c)}})[I]=function(){return Bo(this)},tt));var Za={},Cc={},Ic=!1;function Ko(c){Fo(Cc,c),Ic||(Ic=!0,setTimeout(function(){Ic=!1,Pc(Cc,!(Cc={}))},0))}function Pc(c,f){f===void 0&&(f=!1);var g=new Set;if(c.all)for(var y=0,w=Object.values(Za);y<w.length;y++)bf(W=w[y],c,g,f);else for(var A in c){var R,W,A=/^idb\:\/\/(.*)\/(.*)\//.exec(A);A&&(R=A[1],A=A[2],W=Za["idb://".concat(R,"/").concat(A)])&&bf(W,c,g,f)}g.forEach(function(fe){return fe()})}function bf(c,f,g,y){for(var w=[],A=0,R=Object.entries(c.queries.query);A<R.length;A++){for(var W=R[A],fe=W[0],Se=[],ve=0,le=W[1];ve<le.length;ve++){var ge=le[ve];Tc(f,ge.obsSet)?ge.subscribers.forEach(function(Ee){return g.add(Ee)}):y&&Se.push(ge)}y&&w.push([fe,Se])}if(y)for(var me=0,he=w;me<he.length;me++){var de=he[me],fe=de[0],Se=de[1];c.queries.query[fe]=Se}}function Nm(c){var f=c._state,g=c._deps.indexedDB;if(f.isBeingOpened||c.idbdb)return f.dbReadyPromise.then(function(){return f.dbOpenError?Ue(f.dbOpenError):c});f.isBeingOpened=!0,f.dbOpenError=null,f.openComplete=!1;var y=f.openCanceller,w=Math.round(10*c.verno),A=!1;function R(){if(f.openCanceller!==y)throw new $.DatabaseClosed("db.open() was cancelled")}function W(){return new Re(function(ge,me){if(R(),!g)throw new $.MissingAPI;var he=c.name,de=f.autoSchema||!w?g.open(he):g.open(he,w);if(!de)throw new $.MissingAPI;de.onerror=Fr(me),de.onblocked=_t(c._fireOnBlocked),de.onupgradeneeded=_t(function(Ee){var Te;ve=de.transaction,f.autoSchema&&!c._options.allowEmptyDB?(de.onerror=xi,ve.abort(),de.result.close(),(Te=g.deleteDatabase(he)).onsuccess=Te.onerror=_t(function(){me(new $.NoSuchDatabase("Database ".concat(he," doesnt exist")))})):(ve.onerror=Fr(me),Te=Ee.oldVersion>Math.pow(2,62)?0:Ee.oldVersion,le=Te<1,c.idbdb=de.result,A&&Mm(c,ve),Pm(c,Te/10,ve,me))},me),de.onsuccess=_t(function(){ve=null;var Ee,Te,we,Ce,Le,Ve,We=c.idbdb=de.result,ze=j(We.objectStoreNames);if(0<ze.length)try{var et=We.transaction((Le=ze).length===1?Le[0]:Le,"readonly");if(f.autoSchema)Ve=We,Ce=et,(we=c).verno=Ve.version/10,Ce=we._dbSchema=zo(0,Ve,Ce),we._storeNames=j(Ve.objectStoreNames,0),Lo(we,[we._allTables],i(Ce),Ce);else if(qo(c,c._dbSchema,et),Te=et,((Te=wc(zo(0,(Ee=c).idbdb,Te),Ee._dbSchema)).add.length||Te.change.some(function(Qe){return Qe.add.length||Qe.change.length}))&&!A)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),We.close(),w=We.version+1,A=!0,ge(W());Ro(c,et)}catch{}hn.push(c),We.onversionchange=_t(function(Qe){f.vcFired=!0,c.on("versionchange").fire(Qe)}),We.onclose=_t(function(){c.close({disableAutoOpen:!1})}),le&&(ze=c._deps,Le=he,Sc(Ve=ze.indexedDB)||Le===Un||kc(Ve,ze.IDBKeyRange).put({name:Le}).catch(be)),ge()},me)}).catch(function(ge){switch(ge==null?void 0:ge.name){case"UnknownError":if(0<f.PR1398_maxLoop)return f.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),W();break;case"VersionError":if(0<w)return w=0,W()}return Re.reject(ge)})}var fe,Se=f.dbReadyResolve,ve=null,le=!1;return Re.race([y,(typeof navigator>"u"?Re.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ge){function me(){return indexedDB.databases().finally(ge)}fe=setInterval(me,100),me()}).finally(function(){return clearInterval(fe)}):Promise.resolve()).then(W)]).then(function(){return R(),f.onReadyBeingFired=[],Re.resolve(Ec(function(){return c.on.ready.fire(c.vip)})).then(function ge(){var me;if(0<f.onReadyBeingFired.length)return me=f.onReadyBeingFired.reduce(Ne,be),f.onReadyBeingFired=[],Re.resolve(Ec(function(){return me(c.vip)})).then(ge)})}).finally(function(){f.openCanceller===y&&(f.onReadyBeingFired=null,f.isBeingOpened=!1)}).catch(function(ge){f.dbOpenError=ge;try{ve&&ve.abort()}catch{}return y===f.openCanceller&&c._close(),Ue(ge)}).finally(function(){f.openComplete=!0,Se()}).then(function(){var ge;return le&&(ge={},c.tables.forEach(function(me){me.schema.indexes.forEach(function(he){he.name&&(ge["idb://".concat(c.name,"/").concat(me.name,"/").concat(he.name)]=new Dn(-1/0,[[[]]]))}),ge["idb://".concat(c.name,"/").concat(me.name,"/")]=ge["idb://".concat(c.name,"/").concat(me.name,"/:dels")]=new Dn(-1/0,[[[]]])}),Aa(ki).fire(ge),Pc(ge,!0)),c})}function Mc(c){function f(A){return c.next(A)}var g=w(f),y=w(function(A){return c.throw(A)});function w(A){return function(W){var W=A(W),fe=W.value;return W.done?fe:fe&&typeof fe.then=="function"?fe.then(g,y):l(fe)?Promise.all(fe).then(g,y):g(fe)}}return w(f)()}function Ho(c,f,g){for(var y=l(c)?c.slice():[c],w=0;w<g;++w)y.push(f);return y}var Dm={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(c){return r(r({},c),{table:function(y){var g=c.table(y),y=g.schema,w={},A=[];function R(ge,me,he){var we=Ei(ge),de=w[we]=w[we]||[],Ee=ge==null?0:typeof ge=="string"?1:ge.length,Te=0<me,we=r(r({},he),{name:Te?"".concat(we,"(virtual-from:").concat(he.name,")"):he.name,lowLevelIndex:he,isVirtual:Te,keyTail:me,keyLength:Ee,extractKey:_c(ge),unique:!Te&&he.unique});return de.push(we),we.isPrimaryKey||A.push(we),1<Ee&&R(Ee===2?ge[0]:ge.slice(0,Ee-1),me+1,he),de.sort(function(Ce,Le){return Ce.keyTail-Le.keyTail}),we}var W=R(y.primaryKey.keyPath,0,y.primaryKey);w[":id"]=[W];for(var fe=0,Se=y.indexes;fe<Se.length;fe++){var ve=Se[fe];R(ve.keyPath,0,ve)}function le(ge){var me,he=ge.query.index;return he.isVirtual?r(r({},ge),{query:{index:he.lowLevelIndex,range:(me=ge.query.range,he=he.keyTail,{type:me.type===1?2:me.type,lower:Ho(me.lower,me.lowerOpen?c.MAX_KEY:c.MIN_KEY,he),lowerOpen:!0,upper:Ho(me.upper,me.upperOpen?c.MIN_KEY:c.MAX_KEY,he),upperOpen:!0})}}):ge}return r(r({},g),{schema:r(r({},y),{primaryKey:W,indexes:A,getIndexByKeyPath:function(ge){return(ge=w[Ei(ge)])&&ge[0]}}),count:function(ge){return g.count(le(ge))},query:function(ge){return g.query(le(ge))},openCursor:function(ge){var me=ge.query.index,he=me.keyTail,de=me.keyLength;return me.isVirtual?g.openCursor(le(ge)).then(function(Te){return Te&&Ee(Te)}):g.openCursor(ge);function Ee(Te){return Object.create(Te,{continue:{value:function(we){we!=null?Te.continue(Ho(we,ge.reverse?c.MAX_KEY:c.MIN_KEY,he)):ge.unique?Te.continue(Te.key.slice(0,de).concat(ge.reverse?c.MIN_KEY:c.MAX_KEY,he)):Te.continue()}},continuePrimaryKey:{value:function(we,Ce){Te.continuePrimaryKey(Ho(we,c.MAX_KEY,he),Ce)}},primaryKey:{get:function(){return Te.primaryKey}},key:{get:function(){var we=Te.key;return de===1?we[0]:we.slice(0,de)}},value:{get:function(){return Te.value}}})}}})}})}};function Oc(c,f,g,y){return g=g||{},y=y||"",i(c).forEach(function(w){var A,R,W;p(f,w)?(A=c[w],R=f[w],typeof A=="object"&&typeof R=="object"&&A&&R?(W=D(A))!==D(R)?g[y+w]=f[w]:W==="Object"?Oc(A,R,g,y+w+"."):A!==R&&(g[y+w]=f[w]):A!==R&&(g[y+w]=f[w])):g[y+w]=void 0}),i(f).forEach(function(w){p(c,w)||(g[y+w]=f[w])}),g}function Nc(c,f){return f.type==="delete"?f.keys:f.keys||f.values.map(c.extractKey)}var Rm={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(c){return r(r({},c),{table:function(f){var g=c.table(f),y=g.schema.primaryKey;return r(r({},g),{mutate:function(w){var A=je.trans,R=A.table(f).hook,W=R.deleting,fe=R.creating,Se=R.updating;switch(w.type){case"add":if(fe.fire===be)break;return A._promise("readwrite",function(){return ve(w)},!0);case"put":if(fe.fire===be&&Se.fire===be)break;return A._promise("readwrite",function(){return ve(w)},!0);case"delete":if(W.fire===be)break;return A._promise("readwrite",function(){return ve(w)},!0);case"deleteRange":if(W.fire===be)break;return A._promise("readwrite",function(){return(function le(ge,me,he){return g.query({trans:ge,values:!1,query:{index:y,range:me},limit:he}).then(function(de){var Ee=de.result;return ve({type:"delete",keys:Ee,trans:ge}).then(function(Te){return 0<Te.numFailures?Promise.reject(Te.failures[0]):Ee.length<he?{failures:[],numFailures:0,lastResult:void 0}:le(ge,r(r({},me),{lower:Ee[Ee.length-1],lowerOpen:!0}),he)})})})(w.trans,w.range,1e4)},!0)}return g.mutate(w);function ve(le){var ge,me,he,de=je.trans,Ee=le.keys||Nc(y,le);if(Ee)return(le=le.type==="add"||le.type==="put"?r(r({},le),{keys:Ee}):r({},le)).type!=="delete"&&(le.values=a([],le.values)),le.keys&&(le.keys=a([],le.keys)),ge=g,he=Ee,((me=le).type==="add"?Promise.resolve([]):ge.getMany({trans:me.trans,keys:he,cache:"immutable"})).then(function(Te){var we=Ee.map(function(Ce,Le){var Ve,We,ze,et=Te[Le],Qe={onerror:null,onsuccess:null};return le.type==="delete"?W.fire.call(Qe,Ce,et,de):le.type==="add"||et===void 0?(Ve=fe.fire.call(Qe,Ce,le.values[Le],de),Ce==null&&Ve!=null&&(le.keys[Le]=Ce=Ve,y.outbound||O(le.values[Le],y.keyPath,Ce))):(Ve=Oc(et,le.values[Le]),(We=Se.fire.call(Qe,Ve,Ce,et,de))&&(ze=le.values[Le],Object.keys(We).forEach(function(He){p(ze,He)?ze[He]=We[He]:O(ze,He,We[He])}))),Qe});return g.mutate(le).then(function(Ce){for(var Le=Ce.failures,Ve=Ce.results,We=Ce.numFailures,Ce=Ce.lastResult,ze=0;ze<Ee.length;++ze){var et=(Ve||Ee)[ze],Qe=we[ze];et==null?Qe.onerror&&Qe.onerror(Le[ze]):Qe.onsuccess&&Qe.onsuccess(le.type==="put"&&Te[ze]?le.values[ze]:et)}return{failures:Le,results:Ve,numFailures:We,lastResult:Ce}}).catch(function(Ce){return we.forEach(function(Le){return Le.onerror&&Le.onerror(Ce)}),Promise.reject(Ce)})});throw new Error("Keys missing")}}})}})}};function wf(c,f,g){try{if(!f||f.keys.length<c.length)return null;for(var y=[],w=0,A=0;w<f.keys.length&&A<c.length;++w)zt(f.keys[w],c[A])===0&&(y.push(g?q(f.values[w]):f.values[w]),++A);return y.length===c.length?y:null}catch{return null}}var Lm={stack:"dbcore",level:-1,create:function(c){return{table:function(f){var g=c.table(f);return r(r({},g),{getMany:function(y){var w;return y.cache?(w=wf(y.keys,y.trans._cache,y.cache==="clone"))?Re.resolve(w):g.getMany(y).then(function(A){return y.trans._cache={keys:y.keys,values:y.cache==="clone"?q(A):A},A}):g.getMany(y)},mutate:function(y){return y.type!=="add"&&(y.trans._cache=null),g.mutate(y)}})}}}};function xf(c,f){return c.trans.mode==="readonly"&&!!c.subscr&&!c.trans.explicit&&c.trans.db._options.cache!=="disabled"&&!f.schema.primaryKey.outbound}function kf(c,f){switch(c){case"query":return f.values&&!f.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var jm={stack:"dbcore",level:0,name:"Observability",create:function(c){var f=c.schema.name,g=new Dn(c.MIN_KEY,c.MAX_KEY);return r(r({},c),{transaction:function(y,w,A){if(je.subscr&&w!=="readonly")throw new $.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return c.transaction(y,w,A)},table:function(y){function w(Ee){var de,Ee=Ee.query;return[de=Ee.index,new Dn((de=(Ee=Ee.range).lower)!=null?de:c.MIN_KEY,(de=Ee.upper)!=null?de:c.MAX_KEY)]}var A=c.table(y),R=A.schema,W=R.primaryKey,fe=R.indexes,Se=W.extractKey,ve=W.outbound,le=W.autoIncrement&&fe.filter(function(he){return he.compound&&he.keyPath.includes(W.keyPath)}),ge=r(r({},A),{mutate:function(he){function de(rt){return rt="idb://".concat(f,"/").concat(y,"/").concat(rt),Le[rt]||(Le[rt]=new Dn)}var Ee,Te,we,Ce=he.trans,Le=he.mutatedParts||(he.mutatedParts={}),Ve=de(""),We=de(":dels"),ze=he.type,Qe=he.type==="deleteRange"?[he.range]:he.type==="delete"?[he.keys]:he.values.length<50?[Nc(W,he).filter(function(rt){return rt}),he.values]:[],et=Qe[0],Qe=Qe[1],He=he.trans._cache;return l(et)?(Ve.addKeys(et),(ze=ze==="delete"||et.length===Qe.length?wf(et,He):null)||We.addKeys(et),(ze||Qe)&&(Ee=de,Te=ze,we=Qe,R.indexes.forEach(function(rt){var qt=Ee(rt.name||"");function Ht(Mt){return Mt!=null?rt.extractKey(Mt):null}function gt(Mt){rt.multiEntry&&l(Mt)?Mt.forEach(function(dn){return qt.addKey(dn)}):qt.addKey(Mt)}(Te||we).forEach(function(Mt,vn){var fr=Te&&Ht(Te[vn]),vn=we&&Ht(we[vn]);zt(fr,vn)!==0&&(fr!=null&&gt(fr),vn!=null)&&gt(vn)})}))):et?(Qe={from:(He=et.lower)!=null?He:c.MIN_KEY,to:(ze=et.upper)!=null?ze:c.MAX_KEY},We.add(Qe),Ve.add(Qe)):(Ve.add(g),We.add(g),R.indexes.forEach(function(rt){return de(rt.name).add(g)})),A.mutate(he).then(function(rt){return!et||he.type!=="add"&&he.type!=="put"||(Ve.addKeys(rt.results),le&&le.forEach(function(qt){for(var Ht=he.values.map(function(fr){return qt.extractKey(fr)}),gt=qt.keyPath.findIndex(function(fr){return fr===W.keyPath}),Mt=0,dn=rt.results.length;Mt<dn;++Mt)Ht[Mt][gt]=rt.results[Mt];de(qt.name).addKeys(Ht)})),Ce.mutatedParts=Fo(Ce.mutatedParts||{},Le),rt})}}),me={get:function(he){return[W,new Dn(he.key)]},getMany:function(he){return[W,new Dn().addKeys(he.keys)]},count:w,query:w,openCursor:w};return i(me).forEach(function(he){ge[he]=function(de){var Ee=je.subscr,Te=!!Ee,we=xf(je,A)&&kf(he,de)?de.obsSet={}:Ee;if(Te){var Ce,Ee=function(Qe){return Qe="idb://".concat(f,"/").concat(y,"/").concat(Qe),we[Qe]||(we[Qe]=new Dn)},Le=Ee(""),Ve=Ee(":dels"),Te=me[he](de),We=Te[0],Te=Te[1];if((he==="query"&&We.isPrimaryKey&&!de.values?Ve:Ee(We.name||"")).add(Te),!We.isPrimaryKey){if(he!=="count")return Ce=he==="query"&&ve&&de.values&&A.query(r(r({},de),{values:!1})),A[he].apply(this,arguments).then(function(Qe){if(he==="query"){if(ve&&de.values)return Ce.then(function(Ht){return Ht=Ht.result,Le.addKeys(Ht),Qe});var He=de.values?Qe.result.map(Se):Qe.result;(de.values?Le:Ve).addKeys(He)}else{var rt,qt;if(he==="openCursor")return qt=de.values,(rt=Qe)&&Object.create(rt,{key:{get:function(){return Ve.addKey(rt.primaryKey),rt.key}},primaryKey:{get:function(){var Ht=rt.primaryKey;return Ve.addKey(Ht),Ht}},value:{get:function(){return qt&&Le.addKey(rt.primaryKey),rt.value}}})}return Qe});Ve.add(g)}}return A[he].apply(this,arguments)}}),ge}})}};function Sf(c,f,g){var y;return g.numFailures===0?f:f.type==="deleteRange"||(y=f.keys?f.keys.length:"values"in f&&f.values?f.values.length:1,g.numFailures===y)?null:(y=r({},f),l(y.keys)&&(y.keys=y.keys.filter(function(w,A){return!(A in g.failures)})),"values"in y&&l(y.values)&&(y.values=y.values.filter(function(w,A){return!(A in g.failures)})),y)}function Dc(c,f){return g=c,((y=f).lower===void 0||(y.lowerOpen?0<zt(g,y.lower):0<=zt(g,y.lower)))&&(g=c,(y=f).upper===void 0||(y.upperOpen?zt(g,y.upper)<0:zt(g,y.upper)<=0));var g,y}function Ef(c,f,g,y,w,A){var R,W,fe,Se,ve,le;return!g||g.length===0||(R=f.query.index,W=R.multiEntry,fe=f.query.range,Se=y.schema.primaryKey.extractKey,ve=R.extractKey,le=(R.lowLevelIndex||R).extractKey,(y=g.reduce(function(ge,me){var he=ge,de=[];if(me.type==="add"||me.type==="put")for(var Ee=new Dn,Te=me.values.length-1;0<=Te;--Te){var we,Ce=me.values[Te],Le=Se(Ce);!Ee.hasKey(Le)&&(we=ve(Ce),W&&l(we)?we.some(function(Qe){return Dc(Qe,fe)}):Dc(we,fe))&&(Ee.addKey(Le),de.push(Ce))}switch(me.type){case"add":var Ve=new Dn().addKeys(f.values?ge.map(function(He){return Se(He)}):ge),he=ge.concat(f.values?de.filter(function(He){return He=Se(He),!Ve.hasKey(He)&&(Ve.addKey(He),!0)}):de.map(function(He){return Se(He)}).filter(function(He){return!Ve.hasKey(He)&&(Ve.addKey(He),!0)}));break;case"put":var We=new Dn().addKeys(me.values.map(function(He){return Se(He)}));he=ge.filter(function(He){return!We.hasKey(f.values?Se(He):He)}).concat(f.values?de:de.map(function(He){return Se(He)}));break;case"delete":var ze=new Dn().addKeys(me.keys);he=ge.filter(function(He){return!ze.hasKey(f.values?Se(He):He)});break;case"deleteRange":var et=me.range;he=ge.filter(function(He){return!Dc(Se(He),et)})}return he},c))===c)?c:(y.sort(function(ge,me){return zt(le(ge),le(me))||zt(Se(ge),Se(me))}),f.limit&&f.limit<1/0&&(y.length>f.limit?y.length=f.limit:c.length===f.limit&&y.length<f.limit&&(w.dirty=!0)),A?Object.freeze(y):y)}function Af(c,f){return zt(c.lower,f.lower)===0&&zt(c.upper,f.upper)===0&&!!c.lowerOpen==!!f.lowerOpen&&!!c.upperOpen==!!f.upperOpen}function zm(c,f){return((g,y,w,A)=>{if(g===void 0)return y!==void 0?-1:0;if(y===void 0)return 1;if((g=zt(g,y))===0){if(w&&A)return 0;if(w)return 1;if(A)return-1}return g})(c.lower,f.lower,c.lowerOpen,f.lowerOpen)<=0&&0<=((g,y,w,A)=>{if(g===void 0)return y!==void 0?1:0;if(y===void 0)return-1;if((g=zt(g,y))===0){if(w&&A)return 0;if(w)return-1;if(A)return 1}return g})(c.upper,f.upper,c.upperOpen,f.upperOpen)}function qm(c,f,g,y){c.subscribers.add(g),y.addEventListener("abort",function(){var w,A;c.subscribers.delete(g),c.subscribers.size===0&&(w=c,A=f,setTimeout(function(){w.subscribers.size===0&&Y(A,w)},3e3))})}var Bm={stack:"dbcore",level:0,name:"Cache",create:function(c){var f=c.schema.name;return r(r({},c),{transaction:function(g,y,w){var A,R,W=c.transaction(g,y,w);return y==="readwrite"&&(w=(A=new AbortController).signal,W.addEventListener("abort",(R=function(fe){return function(){if(A.abort(),y==="readwrite"){for(var Se=new Set,ve=0,le=g;ve<le.length;ve++){var ge=le[ve],me=Za["idb://".concat(f,"/").concat(ge)];if(me){var he=c.table(ge),de=me.optimisticOps.filter(function(rt){return rt.trans===W});if(W._explicit&&fe&&W.mutatedParts)for(var Ee=0,Te=Object.values(me.queries.query);Ee<Te.length;Ee++)for(var we=0,Ce=(We=Te[Ee]).slice();we<Ce.length;we++)Tc((ze=Ce[we]).obsSet,W.mutatedParts)&&(Y(We,ze),ze.subscribers.forEach(function(rt){return Se.add(rt)}));else if(0<de.length){me.optimisticOps=me.optimisticOps.filter(function(rt){return rt.trans!==W});for(var Le=0,Ve=Object.values(me.queries.query);Le<Ve.length;Le++)for(var We,ze,et,Qe=0,He=(We=Ve[Le]).slice();Qe<He.length;Qe++)(ze=He[Qe]).res!=null&&W.mutatedParts&&(fe&&!ze.dirty?(et=Object.isFrozen(ze.res),et=Ef(ze.res,ze.req,de,he,ze,et),ze.dirty?(Y(We,ze),ze.subscribers.forEach(function(rt){return Se.add(rt)})):et!==ze.res&&(ze.res=et,ze.promise=Re.resolve({result:et}))):(ze.dirty&&Y(We,ze),ze.subscribers.forEach(function(rt){return Se.add(rt)})))}}}Se.forEach(function(rt){return rt()})}}})(!1),{signal:w}),W.addEventListener("error",R(!1),{signal:w}),W.addEventListener("complete",R(!0),{signal:w})),W},table:function(g){var y=c.table(g),w=y.schema.primaryKey;return r(r({},y),{mutate:function(A){var R,W=je.trans;return!w.outbound&&W.db._options.cache!=="disabled"&&!W.explicit&&W.idbtrans.mode==="readwrite"&&(R=Za["idb://".concat(f,"/").concat(g)])?(W=y.mutate(A),A.type!=="add"&&A.type!=="put"||!(50<=A.values.length||Nc(w,A).some(function(fe){return fe==null}))?(R.optimisticOps.push(A),A.mutatedParts&&Ko(A.mutatedParts),W.then(function(fe){0<fe.numFailures&&(Y(R.optimisticOps,A),(fe=Sf(0,A,fe))&&R.optimisticOps.push(fe),A.mutatedParts)&&Ko(A.mutatedParts)}),W.catch(function(){Y(R.optimisticOps,A),A.mutatedParts&&Ko(A.mutatedParts)})):W.then(function(fe){var Se=Sf(0,r(r({},A),{values:A.values.map(function(ve,le){var ge;return fe.failures[le]?ve:(O(ge=(ge=w.keyPath)!=null&&ge.includes(".")?q(ve):r({},ve),w.keyPath,fe.results[le]),ge)})}),fe);R.optimisticOps.push(Se),queueMicrotask(function(){return A.mutatedParts&&Ko(A.mutatedParts)})}),W):y.mutate(A)},query:function(A){var R,W,fe,Se,ve,le,ge;return xf(je,y)&&kf("query",A)?(R=((fe=je.trans)==null?void 0:fe.db._options.cache)==="immutable",W=(fe=je).requery,fe=fe.signal,le=((me,he,de,Ee)=>{var Te=Za["idb://".concat(me,"/").concat(he)];if(!Te)return[];if(!(me=Te.queries[de]))return[null,!1,Te,null];var we=me[(Ee.query?Ee.query.index.name:null)||""];if(!we)return[null,!1,Te,null];switch(de){case"query":var Ce=we.find(function(Le){return Le.req.limit===Ee.limit&&Le.req.values===Ee.values&&Af(Le.req.query.range,Ee.query.range)});return Ce?[Ce,!0,Te,we]:[we.find(function(Le){return("limit"in Le.req?Le.req.limit:1/0)>=Ee.limit&&(!Ee.values||Le.req.values)&&zm(Le.req.query.range,Ee.query.range)}),!1,Te,we];case"count":return Ce=we.find(function(Le){return Af(Le.req.query.range,Ee.query.range)}),[Ce,!!Ce,Te,we]}})(f,g,"query",A),ge=le[0],Se=le[2],ve=le[3],ge&&le[1]?ge.obsSet=A.obsSet:(le=y.query(A).then(function(me){var he=me.result;if(ge&&(ge.res=he),R){for(var de=0,Ee=he.length;de<Ee;++de)Object.freeze(he[de]);Object.freeze(he)}else me.result=q(he);return me}).catch(function(me){return ve&&ge&&Y(ve,ge),Promise.reject(me)}),ge={obsSet:A.obsSet,promise:le,subscribers:new Set,type:"query",req:A,dirty:!1},ve?ve.push(ge):(ve=[ge],(Se=Se||(Za["idb://".concat(f,"/").concat(g)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[A.query.index.name||""]=ve)),qm(ge,ve,W,fe),ge.promise.then(function(me){return{result:Ef(me.result,A,Se==null?void 0:Se.optimisticOps,y,ge,R)}})):y.query(A)}})}})}};function Go(c,f){return new Proxy(c,{get:function(g,y,w){return y==="db"?f:Reflect.get(g,y,w)}})}pn.prototype.version=function(c){if(isNaN(c)||c<.1)throw new $.Type("Given version is not a positive number");if(c=Math.round(10*c)/10,this.idbdb||this._state.isBeingOpened)throw new $.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,c);var f=this._versions,g=f.filter(function(y){return y._cfg.version===c})[0];return g||(g=new this.Version(c),f.push(g),f.sort(Im),g.stores({}),this._state.autoSchema=!1),g},pn.prototype._whenReady=function(c){var f=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?c():new Re(function(g,y){if(f._state.openComplete)return y(new $.DatabaseClosed(f._state.dbOpenError));if(!f._state.isBeingOpened){if(!f._state.autoOpen)return void y(new $.DatabaseClosed);f.open().catch(be)}f._state.dbReadyPromise.then(g,y)}).then(c)},pn.prototype.use=function(w){var f=w.stack,g=w.create,y=w.level,w=w.name,A=(w&&this.unuse({stack:f,name:w}),this._middlewares[f]||(this._middlewares[f]=[]));return A.push({stack:f,create:g,level:y??10,name:w}),A.sort(function(R,W){return R.level-W.level}),this},pn.prototype.unuse=function(c){var f=c.stack,g=c.name,y=c.create;return f&&this._middlewares[f]&&(this._middlewares[f]=this._middlewares[f].filter(function(w){return y?w.create!==y:!!g&&w.name!==g})),this},pn.prototype.open=function(){var c=this;return ot(dt,function(){return Nm(c)})},pn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var c=this._state,f=hn.indexOf(this);if(0<=f&&hn.splice(f,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}c.isBeingOpened||(c.dbReadyPromise=new Re(function(g){c.dbReadyResolve=g}),c.openCanceller=new Re(function(g,y){c.cancelOpen=y}))},pn.prototype.close=function(f){var f=(f===void 0?{disableAutoOpen:!0}:f).disableAutoOpen,g=this._state;f?(g.isBeingOpened&&g.cancelOpen(new $.DatabaseClosed),this._close(),g.autoOpen=!1,g.dbOpenError=new $.DatabaseClosed):(this._close(),g.autoOpen=this._options.autoOpen||g.isBeingOpened,g.openComplete=!1,g.dbOpenError=null)},pn.prototype.delete=function(c){var f=this,g=(c===void 0&&(c={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),y=this._state;return new Re(function(w,A){function R(){f.close(c);var W=f._deps.indexedDB.deleteDatabase(f.name);W.onsuccess=_t(function(){var fe,Se,ve;fe=f._deps,Se=f.name,Sc(ve=fe.indexedDB)||Se===Un||kc(ve,fe.IDBKeyRange).delete(Se).catch(be),w()}),W.onerror=Fr(A),W.onblocked=f._fireOnBlocked}if(g)throw new $.InvalidArgument("Invalid closeOptions argument to db.delete()");y.isBeingOpened?y.dbReadyPromise.then(R):R()})},pn.prototype.backendDB=function(){return this.idbdb},pn.prototype.isOpen=function(){return this.idbdb!==null},pn.prototype.hasBeenClosed=function(){var c=this._state.dbOpenError;return c&&c.name==="DatabaseClosed"},pn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pn.prototype,"tables",{get:function(){var c=this;return i(this._allTables).map(function(f){return c._allTables[f]})},enumerable:!1,configurable:!0}),pn.prototype.transaction=function(){var c=(function(f,g,y){var w=arguments.length;if(w<2)throw new $.InvalidArgument("Too few arguments");for(var A=new Array(w-1);--w;)A[w-1]=arguments[w];return y=A.pop(),[f,xe(A),y]}).apply(this,arguments);return this._transaction.apply(this,c)},pn.prototype._transaction=function(c,f,g){var y,w,A=this,R=je.trans,W=(R&&R.db===this&&c.indexOf("!")===-1||(R=null),c.indexOf("?")!==-1);c=c.replace("!","").replace("?","");try{if(w=f.map(function(Se){if(Se=Se instanceof A.Table?Se.name:Se,typeof Se!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Se}),c=="r"||c===Br)y=Br;else{if(c!="rw"&&c!=Ya)throw new $.InvalidArgument("Invalid transaction mode: "+c);y=Ya}if(R){if(R.mode===Br&&y===Ya){if(!W)throw new $.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");R=null}R&&w.forEach(function(Se){if(R&&R.storeNames.indexOf(Se)===-1){if(!W)throw new $.SubTransaction("Table "+Se+" not included in parent transaction.");R=null}}),W&&R&&!R.active&&(R=null)}}catch(Se){return R?R._promise(null,function(ve,le){le(Se)}):Ue(Se)}var fe=(function Se(ve,le,ge,me,he){return Re.resolve().then(function(){var we=je.transless||je,de=ve._createTransaction(le,ge,ve._dbSchema,me),we=(de.explicit=!0,{trans:de,transless:we});if(me)de.idbtrans=me.idbtrans;else try{de.create(),de.idbtrans._explicit=!0,ve._state.PR1398_maxLoop=3}catch(Ce){return Ce.name===_e.InvalidState&&ve.isOpen()&&0<--ve._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ve.close({disableAutoOpen:!1}),ve.open().then(function(){return Se(ve,le,ge,null,he)})):Ue(Ce)}var Ee,Te=te(he),we=(Te&&Nn(),Re.follow(function(){var Ce;(Ee=he.call(de,de))&&(Te?(Ce=xr.bind(null,null),Ee.then(Ce,Ce)):typeof Ee.next=="function"&&typeof Ee.throw=="function"&&(Ee=Mc(Ee)))},we));return(Ee&&typeof Ee.then=="function"?Re.resolve(Ee).then(function(Ce){return de.active?Ce:Ue(new $.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):we.then(function(){return Ee})).then(function(Ce){return me&&de._resolve(),de._completion.then(function(){return Ce})}).catch(function(Ce){return de._reject(Ce),Ue(Ce)})})}).bind(null,this,y,w,R,g);return R?R._promise(y,fe,"lock"):je.trans?ot(je.transless,function(){return A._whenReady(fe)}):this._whenReady(fe)},pn.prototype.table=function(c){if(p(this._allTables,c))return this._allTables[c];throw new $.InvalidTable("Table ".concat(c," does not exist"))};var ia=pn;function pn(c,f){var g,y,w,A,R,W=this,fe=(this._middlewares={},this.verno=0,pn.dependencies),fe=(this._options=f=r({addons:pn.addons,autoOpen:!0,indexedDB:fe.indexedDB,IDBKeyRange:fe.IDBKeyRange,cache:"cloned"},f),this._deps={indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange},f.addons),Se=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:be,dbReadyPromise:null,cancelOpen:be,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:f.autoOpen}),ve=(Se.dbReadyPromise=new Re(function(le){Se.dbReadyResolve=le}),Se.openCanceller=new Re(function(le,ge){Se.cancelOpen=ge}),this._state=Se,this.name=c,this.on=bi(this,"populate","blocked","versionchange","close",{ready:[Ne,be]}),this.once=function(le,ge){var me=function(){for(var he=[],de=0;de<arguments.length;de++)he[de]=arguments[de];W.on(le).unsubscribe(me),ge.apply(W,he)};return W.on(le,me)},this.on.ready.subscribe=V(this.on.ready.subscribe,function(le){return function(ge,me){pn.vip(function(){var he,de=W._state;de.openComplete?(de.dbOpenError||Re.resolve().then(ge),me&&le(ge)):de.onReadyBeingFired?(de.onReadyBeingFired.push(ge),me&&le(ge)):(le(ge),he=W,me||le(function Ee(){he.on.ready.unsubscribe(ge),he.on.ready.unsubscribe(Ee)}))})}}),this.Collection=(g=this,wi(xm.prototype,function(Ee,de){this.db=g;var me=yi,he=null;if(de)try{me=de()}catch(we){he=we}var de=Ee._ctx,Ee=de.table,Te=Ee.hook.reading.fire;this._ctx={table:Ee,index:de.index,isPrimKey:!de.index||Ee.schema.primKey.keyPath&&de.index===Ee.schema.primKey.name,range:me,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:he,or:de.or,valueMapper:Te!==Me?Te:null}})),this.Table=(y=this,wi(of.prototype,function(le,ge,me){this.db=y,this._tx=me,this.name=le,this.schema=ge,this.hook=y._allTables[le]?y._allTables[le].hook:bi(null,{creating:[ct,be],reading:[Xe,Me],updating:[Oe,be],deleting:[De,be]})})),this.Transaction=(w=this,wi(Em.prototype,function(le,ge,me,he,de){var Ee=this;le!=="readonly"&&ge.forEach(function(Te){Te=(Te=me[Te])==null?void 0:Te.yProps,Te&&(ge=ge.concat(Te.map(function(we){return we.updatesTable})))}),this.db=w,this.mode=le,this.storeNames=ge,this.schema=me,this.chromeTransactionDurability=he,this.idbtrans=null,this.on=bi(this,"complete","error","abort"),this.parent=de||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Re(function(Te,we){Ee._resolve=Te,Ee._reject=we}),this._completion.then(function(){Ee.active=!1,Ee.on.complete.fire()},function(Te){var we=Ee.active;return Ee.active=!1,Ee.on.error.fire(Te),Ee.parent?Ee.parent._reject(Te):we&&Ee.idbtrans&&Ee.idbtrans.abort(),Ue(Te)})})),this.Version=(A=this,wi(Om.prototype,function(le){this.db=A,this._cfg={version:le,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(R=this,wi(ff.prototype,function(le,ge,me){if(this.db=R,this._ctx={table:le,index:ge===":id"?null:ge,or:me},this._cmp=this._ascending=zt,this._descending=function(he,de){return zt(de,he)},this._max=function(he,de){return 0<zt(he,de)?he:de},this._min=function(he,de){return zt(he,de)<0?he:de},this._IDBKeyRange=R._deps.IDBKeyRange,!this._IDBKeyRange)throw new $.MissingAPI})),this.on("versionchange",function(le){0<le.newVersion?console.warn("Another connection wants to upgrade database '".concat(W.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(W.name,"'. Closing db now to resume the delete request.")),W.close({disableAutoOpen:!1})}),this.on("blocked",function(le){!le.newVersion||le.newVersion<le.oldVersion?console.warn("Dexie.delete('".concat(W.name,"') was blocked")):console.warn("Upgrade '".concat(W.name,"' blocked by other connection holding version ").concat(le.oldVersion/10))}),this._maxKey=Si(f.IDBKeyRange),this._createTransaction=function(le,ge,me,he){return new W.Transaction(le,ge,me,W._options.chromeTransactionDurability,he)},this._fireOnBlocked=function(le){W.on("blocked").fire(le),hn.filter(function(ge){return ge.name===W.name&&ge!==W&&!ge._state.vcFired}).map(function(ge){return ge.on("versionchange").fire(le)})},this.use(Lm),this.use(Bm),this.use(jm),this.use(Dm),this.use(Rm),new Proxy(this,{get:function(le,ge,me){var he;return ge==="_vip"||(ge==="table"?function(de){return Go(W.table(de),ve)}:(he=Reflect.get(le,ge,me))instanceof of?Go(he,ve):ge==="tables"?he.map(function(de){return Go(de,ve)}):ge==="_createTransaction"?function(){return Go(he.apply(this,arguments),ve)}:he)}}));this.vip=ve,fe.forEach(function(le){return le(W)})}var Uo,Ls=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Fm=(Rc.prototype.subscribe=function(c,f,g){return this._subscribe(c&&typeof c!="function"?c:{next:c,error:f,complete:g})},Rc.prototype[Ls]=function(){return this},Rc);function Rc(c){this._subscribe=c}try{Uo={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Uo={indexedDB:null,IDBKeyRange:null}}function Tf(c){var f,g=!1,y=new Fm(function(w){var A=te(c),R,W=!1,fe={},Se={},ve={get closed(){return W},unsubscribe:function(){W||(W=!0,R&&R.abort(),le&&Aa.storagemutated.unsubscribe(me))}},le=(w.start&&w.start(ve),!1),ge=function(){return Be(he)},me=function(de){Fo(fe,de),Tc(Se,fe)&&ge()},he=function(){var de,Ee,Te;!W&&Uo.indexedDB&&(fe={},de={},R&&R.abort(),R=new AbortController,Te=(we=>{var Ce=it();try{A&&Nn();var Le=On(c,we);return Le=A?Le.finally(xr):Le}finally{Ce&&ut()}})(Ee={subscr:de,signal:R.signal,requery:ge,querier:c,trans:null}),Promise.resolve(Te).then(function(we){g=!0,f=we,W||Ee.signal.aborted||(fe={},(Ce=>{for(var Le in Ce)if(p(Ce,Le))return;return 1})(Se=de)||le||(Aa(ki,me),le=!0),Be(function(){return!W&&w.next&&w.next(we)}))},function(we){g=!1,["DatabaseClosedError","AbortError"].includes(we==null?void 0:we.name)||W||Be(function(){W||w.error&&w.error(we)})}))};return setTimeout(ge,0),ve});return y.hasValue=function(){return g},y.getValue=function(){return f},y}var Qa=ia;function Lc(c){var f=Ta;try{Ta=!0,Aa.storagemutated.fire(c),Pc(c,!0)}finally{Ta=f}}h(Qa,r(r({},ie),{delete:function(c){return new Qa(c,{addons:[]}).delete()},exists:function(c){return new Qa(c,{addons:[]}).open().then(function(f){return f.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(c){try{return f=Qa.dependencies,g=f.indexedDB,f=f.IDBKeyRange,(Sc(g)?Promise.resolve(g.databases()).then(function(y){return y.map(function(w){return w.name}).filter(function(w){return w!==Un})}):kc(g,f).toCollection().primaryKeys()).then(c)}catch{return Ue(new $.MissingAPI)}var f,g},defineClass:function(){return function(c){u(this,c)}},ignoreTransaction:function(c){return je.trans?ot(je.transless,c):c()},vip:Ec,async:function(c){return function(){try{var f=Mc(c.apply(this,arguments));return f&&typeof f.then=="function"?f:Re.resolve(f)}catch(g){return Ue(g)}}},spawn:function(c,f,g){try{var y=Mc(c.apply(g,f||[]));return y&&typeof y.then=="function"?y:Re.resolve(y)}catch(w){return Ue(w)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(c,f){return c=Re.resolve(typeof c=="function"?Qa.ignoreTransaction(c):c).timeout(f||6e4),je.trans?je.trans.waitFor(c):c},Promise:Re,debug:{get:function(){return Fe},set:function(c){Ke(c)}},derive:k,extend:u,props:h,override:V,Events:bi,on:Aa,liveQuery:Tf,extendObservabilitySet:Fo,getByKeyPath:B,setByKeyPath:O,delByKeyPath:function(c,f){typeof f=="string"?O(c,f,void 0):"length"in f&&[].map.call(f,function(g){O(c,g,void 0)})},shallowClone:Q,deepClone:q,getObjectDiff:Oc,cmp:zt,asap:K,minKey:-1/0,addons:[],connections:hn,errnames:_e,dependencies:Uo,cache:Za,semVer:"4.3.0",version:"4.3.0".split(".").map(function(c){return parseInt(c)}).reduce(function(c,f,g){return c+f/Math.pow(10,2*g)})})),Qa.maxKey=Si(Qa.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Aa(ki,function(c){Ta||(c=new CustomEvent(gc,{detail:c}),Ta=!0,dispatchEvent(c),Ta=!1)}),addEventListener(gc,function(c){c=c.detail,Ta||Lc(c)}));var js,Ta=!1,Cf=function(){};return typeof BroadcastChannel<"u"&&((Cf=function(){(js=new BroadcastChannel(gc)).onmessage=function(c){return c.data&&Lc(c.data)}})(),typeof js.unref=="function"&&js.unref(),Aa(ki,function(c){Ta||js.postMessage(c)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(c){if(!ia.disableBfCache&&c.persisted){Fe&&console.debug("Dexie: handling persisted pagehide"),js!=null&&js.close();for(var f=0,g=hn;f<g.length;f++)g[f].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(c){!ia.disableBfCache&&c.persisted&&(Fe&&console.debug("Dexie: handling persisted pageshow"),Cf(),Lc({all:new Dn(-1/0,[[]])}))})),Re.rejectionMapper=function(c,f){return!c||c instanceof G||c instanceof TypeError||c instanceof SyntaxError||!c.name||!ke[c.name]?c:(f=new ke[c.name](f||c.message,c),"stack"in c&&x(f,"stack",{get:function(){return this.inner.stack}}),f)},Ke(Fe),r(ia,Object.freeze({__proto__:null,Dexie:ia,Entity:tf,PropModification:_i,RangeSet:Dn,add:function(c){return new _i({add:c})},cmp:zt,default:ia,liveQuery:Tf,mergeRanges:Ti,rangesOverlap:mf,remove:function(c){return new _i({remove:c})},replacePrefix:function(c,f){return new _i({replacePrefix:[c,f]})}}),{default:ia}),ia})})(dl)),dl.exports}var D_=N_();const Tu=M_(D_),Vf=Symbol.for("Dexie"),Rn=globalThis[Vf]||(globalThis[Vf]=Tu);if(Tu.semVer!==Rn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Tu.semVer} and ${Rn.semVer}`);const{liveQuery:I3,mergeRanges:P3,rangesOverlap:M3,RangeSet:O3,cmp:N3,Entity:D3,PropModification:R3,replacePrefix:L3,add:j3,remove:z3,DexieYProvider:q3}=Rn,lt=new Rn("me-ai-store");lt.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});lt.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});lt.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});lt.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});lt.version(5).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]",settings:"&key"});lt.version(6).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, group, date, scannedAt, status, *tags, [action+status], [group+status]",settings:"&key"});function yd(t,e){return`${t}:${e}`}const R_=Object.freeze(Object.defineProperty({__proto__:null,db:lt,makeItemId:yd},Symbol.toStringTag,{value:"Module"}));async function wa(t,e=null){try{const n=await lt.settings.get(t);return(n==null?void 0:n.value)??e}catch{return e}}async function ii(t,e){try{await lt.settings.put({key:t,value:e})}catch(n){console.error(`[settings] setSetting("${t}") failed:`,n)}}async function _d(t){try{await lt.settings.delete(t)}catch{}}async function L_(t){const e=await lt.settings.bulkGet(t);return Object.fromEntries(t.map((n,r)=>{var a;return[n,((a=e[r])==null?void 0:a.value)??null]}))}const Sa=Object.freeze(Object.defineProperty({__proto__:null,getSetting:wa,getSettings:L_,removeSetting:_d,setSetting:ii},Symbol.toStringTag,{value:"Module"})),$r=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",contextWindow:32768,maxEmailTokens:4e3,description:"Fastest, 32k context, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",contextWindow:32768,maxEmailTokens:6e3,description:"Balanced speed and quality, 32k context"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",contextWindow:32768,maxEmailTokens:12e3,description:"Best reasoning, 32k context, recommended for email",recommendedForEmailProcessing:!0},{id:"onnx-community/Phi-3.5-mini-instruct-onnx-web",name:"Phi-3.5 Mini",size:"~2.5 GB",contextWindow:131072,maxEmailTokens:16e3,description:"128k context, WebGPU-optimized, best for very long emails",recommendedForEmailProcessing:!0},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",contextWindow:32768,maxEmailTokens:5e3,description:"Strong reasoning, CoT focused, 32k context"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Microsoft, good at reasoning, 16k context",requiresV4:!0,gpuWarning:"Requires good GPU (8GB+ VRAM recommended)"},{id:"onnx-community/Phi-4-mini-instruct-ONNX-GQA",name:"Phi-4 Mini GQA",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Phi-4 with Grouped Query Attention, faster inference",requiresV4:!0,gpuWarning:"Requires good GPU (8GB+ VRAM recommended)",isExperimental:!0},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",contextWindow:8192,maxEmailTokens:2e3,description:"Smallest, ultra fast, 8k context, not for long emails"}];function bd(t){return $r.find(e=>e.id===t)}const j_=Object.freeze(Object.defineProperty({__proto__:null,MODELS:$r,getModelInfo:bd},Symbol.toStringTag,{value:"Module"})),ea=[{name:"qwen3:4b",displayName:"Qwen3 4B",params:"4B",contextWindow:131072,maxEmailTokens:1e5,description:"Latest Qwen, 128k context, enhanced reasoning",tags:["multilingual","reasoning","general"],recommended:!0,recommendedForEmailProcessing:!0},{name:"qwen3:8b",displayName:"Qwen3 8B",params:"8B",contextWindow:131072,maxEmailTokens:1e5,description:"Powerful reasoning, 128k context, 100+ languages",tags:["multilingual","reasoning","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"qwen3:14b",displayName:"Qwen3 14B",params:"14B",contextWindow:131072,maxEmailTokens:1e5,description:"Most capable Qwen3, best for complex tasks",tags:["multilingual","reasoning","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:3b",displayName:"Ministral 3 3B",params:"3B",contextWindow:262144,maxEmailTokens:2e5,description:"Mistral's smallest, 256k context, Apache 2.0",tags:["fast","long-context","efficient"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:8b",displayName:"Ministral 3 8B",params:"8B",contextWindow:262144,maxEmailTokens:2e5,description:"Balanced performance, 256k context, vision capable",tags:["general","long-context","vision"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:14b",displayName:"Ministral 3 14B",params:"14B",contextWindow:262144,maxEmailTokens:2e5,description:"Most capable Ministral, 256k context, function calling",tags:["advanced","long-context","vision"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gpt-oss:20b",displayName:"GPT-OSS 20B",params:"20B",contextWindow:131072,maxEmailTokens:1e5,description:"OpenAI's open model, strong reasoning, Apache 2.0",tags:["reasoning","cot","openai"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3:4b",displayName:"Gemma3 4B",params:"4B",contextWindow:131072,maxEmailTokens:1e5,description:"Google, 128k context, multimodal (text + images)",tags:["multimodal","vision","multilingual"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3:12b",displayName:"Gemma3 12B",params:"12B",contextWindow:131072,maxEmailTokens:1e5,description:"Powerful multimodal, 128k context, 140+ languages",tags:["multimodal","vision","multilingual","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3n:e2b",displayName:"Gemma3N E2B",params:"2B effective",contextWindow:32768,maxEmailTokens:25e3,description:"Efficient 2B, multimodal, MatFormer architecture",tags:["efficient","multimodal","fast"],recommendedForEmailProcessing:!1},{name:"gemma3n:e4b",displayName:"Gemma3N E4B",params:"4B effective",contextWindow:32768,maxEmailTokens:25e3,description:"Efficient 4B, multimodal, selective parameter activation",tags:["efficient","multimodal","balanced"],recommendedForEmailProcessing:!1},{name:"deepseek-r1:7b",displayName:"DeepSeek R1 7B",params:"7B",contextWindow:65536,maxEmailTokens:5e4,description:"Strong chain-of-thought reasoning, research-focused",tags:["reasoning","cot"],recommended:!0,recommendedForEmailProcessing:!0},{name:"deepseek-r1:14b",displayName:"DeepSeek R1 14B",params:"14B",contextWindow:65536,maxEmailTokens:5e4,description:"Advanced CoT reasoning, slower but thorough",tags:["reasoning","cot","advanced"],recommended:!0,recommendedForEmailProcessing:!0}];function _p(){return ea.filter(t=>t.recommended)}function wd(t){return ea.find(e=>e.name===t||e.name.startsWith(t+":"))}const z_=Object.freeze(Object.defineProperty({__proto__:null,OLLAMA_MODELS:ea,getOllamaModelInfo:wd,getRecommendedOllamaModels:_p},Symbol.toStringTag,{value:"Module"})),La=[{id:"gpt-4.5-preview",name:"gpt-4.5-preview",displayName:"GPT-4.5 Preview",provider:"openai",description:"OpenAI's latest frontier model",contextWindow:128e3,maxEmailTokens:16384,recommendedForEmailProcessing:!0},{id:"gpt-4o",name:"gpt-4o",displayName:"GPT-4o",provider:"openai",description:"OpenAI's previous flagship model",contextWindow:128e3,maxEmailTokens:16384,recommendedForEmailProcessing:!0},{id:"o3-mini",name:"o3-mini",displayName:"o3-mini",provider:"openai",description:"Fast reasoning model",contextWindow:2e5,maxEmailTokens:32e3,recommendedForEmailProcessing:!0},{id:"claude-3-7-sonnet-latest",name:"claude-3-7-sonnet-latest",displayName:"Claude 3.7 Sonnet",provider:"anthropic",description:"Anthropic's most intelligent model",contextWindow:2e5,maxEmailTokens:32e3,recommendedForEmailProcessing:!0},{id:"claude-3-5-haiku-latest",name:"claude-3-5-haiku-latest",displayName:"Claude 3.5 Haiku",provider:"anthropic",description:"Fastest and most compact model",contextWindow:2e5,maxEmailTokens:32e3,recommendedForEmailProcessing:!0},{id:"grok-3-latest",name:"grok-3-latest",displayName:"Grok 3",provider:"xai",description:"xAI's latest frontier model",contextWindow:128e3,maxEmailTokens:16384,recommendedForEmailProcessing:!0},{id:"grok-2-latest",name:"grok-2-latest",displayName:"Grok 2",provider:"xai",description:"xAI's previous model",contextWindow:128e3,maxEmailTokens:16384,recommendedForEmailProcessing:!0}];function bp(t){return La.find(e=>e.id===t)||null}let Zn=null,ha="idle",fl=null,$a=new Set;function Xo(){return Zn||(Zn=new Worker(new URL("/me-ai/assets/worker-Svid4Xkn.js",import.meta.url),{type:"module"}),Zn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(ha="loading"),e.status==="ready"&&(ha="ready"),e.status==="start"&&(ha="generating"),(e.status==="complete"||e.status==="error")&&(ha=fl?"ready":"idle");for(const n of $a)try{n(e)}catch{}})),Zn}function Gc(){return{check(){Xo().postMessage({type:"check"})},loadModel(t){fl=t,ha="loading",Xo().postMessage({type:"load",modelId:t})},generate(t,e){Xo().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,n){return new Promise((r,a)=>{let s="",i=null,l=0,u=0;const d=p=>{switch(p.status){case"start":u=p.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(s+=p.output,i=p.tps??i,l=p.numTokens??l,n)try{n({tps:i,numTokens:l,text:s})}catch{}break;case"complete":v(),r({text:s,tps:i,numTokens:l,inputTokens:u});break;case"error":v(),a(new Error(p.data));break}},v=()=>{$a.delete(d)};$a.add(d),Xo().postMessage({type:"generate",data:t,options:e})})},interrupt(){Zn==null||Zn.postMessage({type:"interrupt"})},reset(){Zn==null||Zn.postMessage({type:"reset"})},onMessage(t){return $a.add(t),()=>$a.delete(t)},offMessage(t){$a.delete(t)},get status(){return ha},get isReady(){return ha==="ready"},get isGenerating(){return ha==="generating"},get modelId(){return fl},terminate(){Zn==null||Zn.terminate(),Zn=null,ha="idle",fl=null,$a.clear()}}}const q_="modulepreload",B_=function(t){return"/me-ai/"+t},Wf={},Ln=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let i=function(d){return Promise.all(d.map(v=>Promise.resolve(v).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=i(n.map(d=>{if(d=B_(d),d in Wf)return;Wf[d]=!0;const v=d.endsWith(".css"),p=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const h=document.createElement("link");if(h.rel=v?"stylesheet":q_,v||(h.as="script"),h.crossOrigin="",h.href=d,u&&h.setAttribute("nonce",u),document.head.appendChild(h),v)return new Promise((m,x)=>{h.addEventListener("load",m),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},Yf="http://localhost:11434",F_="https://me-ai.metaelon.space";function wp(){try{const t=window.location.hostname;return t==="localhost"||t==="127.0.0.1"||t==="0.0.0.0"?Yf:F_}catch{return Yf}}function xo(){return wp()}async function K_(){const{getSetting:t}=await Ln(async()=>{const{getSetting:e}=await Promise.resolve().then(()=>Sa);return{getSetting:e}},void 0);return await t("ollamaUrl")||wp()}async function H_(t){const{setSetting:e}=await Ln(async()=>{const{setSetting:n}=await Promise.resolve().then(()=>Sa);return{setSetting:n}},void 0);await e("ollamaUrl",t)}async function Cu(t=xo()){try{const e=await fetch(`${t}/api/version`,{method:"GET",signal:AbortSignal.timeout(5e3)});return e.ok?{connected:!0,version:(await e.json()).version}:{connected:!1,error:`HTTP ${e.status}`}}catch(e){return e.message.includes("CORS")||e.message.includes("Failed to fetch")||e.name==="TypeError"?{connected:!1,corsError:!0,error:"CORS error: Server must allow requests from this origin. Configure Access-Control-Allow-Origin header."}:{connected:!1,error:e.name==="TimeoutError"?"Connection timeout":e.message}}}async function G_(t=xo()){const e=await fetch(`${t}/api/tags`,{method:"GET",signal:AbortSignal.timeout(1e4)});if(!e.ok)throw new Error(`Failed to list models: HTTP ${e.status}`);return(await e.json()).models||[]}async function U_(t,e,{temperature:n=.7,maxTokens:r=4096,keepAlive:a}={},s=()=>{},i=xo()){var x;const l={model:t,messages:e,stream:!0,options:{temperature:n,num_predict:r}};a!==void 0?l.keep_alive=a:l.keep_alive="10m";const u=new AbortController,d=setTimeout(()=>u.abort(),3e5),v=await fetch(`${i}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),signal:u.signal});if(clearTimeout(d),!v.ok){const k=await v.text();throw new Error(`Ollama API error: ${k}`)}const p=v.body.getReader(),h=new TextDecoder;let m="";try{for(;;){const{done:k,value:E}=await p.read();if(k)break;const j=h.decode(E).split(`
`).filter(Boolean);for(const V of j)try{const S=JSON.parse(V);if((x=S.message)!=null&&x.content&&(m+=S.message.content,s({content:S.message.content,done:!1,total_duration:S.total_duration,eval_count:S.eval_count,eval_duration:S.eval_duration})),S.done){s({content:"",done:!0,total_duration:S.total_duration,eval_count:S.eval_count,eval_duration:S.eval_duration});break}}catch{}}}finally{p.releaseLock()}return m}let ar="idle",zs=null,es=new Set;function Sr(t){for(const e of es)try{e(t)}catch{}}function V_(){return{async check(){ar="loading",Sr({status:"loading",data:"Testing Ollama connection..."});const t=await Cu();t.connected?(ar="idle",Sr({status:"ready",data:{type:"ollama",version:t.version,url:xo()}})):(ar="idle",Sr({status:"error",data:`Ollama not available: ${t.error}. Make sure Ollama is running.`}))},async loadModel(t){zs=t,ar="loading",Sr({status:"loading",data:`Connecting to Ollama model: ${t}...`});const e=await Cu();if(!e.connected){ar="idle",zs=null,Sr({status:"error",data:`Ollama not available: ${e.error}`});return}ar="ready",Sr({status:"ready"})},async generate(t,e={}){if(!zs){Sr({status:"error",data:"No Ollama model selected"});return}ar="generating",Sr({status:"start",inputTokens:0});let n=0,r=performance.now();try{await U_(zs,t,{temperature:e.temperature??.7,maxTokens:e.maxTokens??4096},a=>{if(a.content){n++;const s=performance.now()-r,i=s>0?n/s*1e3:0;Sr({status:"update",output:a.content,tps:Math.round(i*10)/10,numTokens:n})}a.done&&(ar="ready",Sr({status:"complete",tps:a.eval_duration?Math.round(a.eval_count/(a.eval_duration/1e9)*10)/10:null,numTokens:a.eval_count||n}))})}catch(a){ar="ready",Sr({status:"error",data:a.message})}},generateFull(t,e,n){return new Promise((r,a)=>{let s="",i=null,l=0,u=0;const d=p=>{switch(p.status){case"start":u=p.inputTokens||0;break;case"update":if(s+=p.output,i=p.tps??i,l=p.numTokens??l,n)try{n({tps:i,numTokens:l,text:s})}catch{}break;case"complete":v(),r({text:s,tps:i,numTokens:l,inputTokens:u});break;case"error":v(),a(new Error(p.data));break}},v=()=>{es.delete(d)};es.add(d),this.generate(t,e)})},interrupt(){console.warn("Ollama doesn't support generation interruption")},reset(){},onMessage(t){return es.add(t),()=>es.delete(t)},offMessage(t){es.delete(t)},get status(){return ar},get isReady(){return ar==="ready"},get isGenerating(){return ar==="generating"},get modelId(){return zs},get backend(){return"ollama"},terminate(){ar="idle",zs=null,es.clear()}}}async function xp(t){return await wa(`${t}ApiKey`)}async function kp(t,e){if(!e)return{connected:!1,error:"API key is required"};try{let n,r;if(t==="openai"||t==="xai"){n=t==="openai"?"https://api.openai.com/v1/models":"https://api.x.ai/v1/models",r={Authorization:`Bearer ${e}`};const a=await fetch(n,{method:"GET",headers:r,signal:AbortSignal.timeout(5e3)});if(!a.ok){const s=await a.text();return{connected:!1,error:`HTTP ${a.status}: ${s}`}}return{connected:!0}}else if(t==="anthropic"){n="https://api.anthropic.com/v1/messages",r={"x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerously-allow-browser":"true","content-type":"application/json"};const a=JSON.stringify({model:"claude-3-5-haiku-latest",max_tokens:1,messages:[{role:"user",content:"test"}]}),s=await fetch(n,{method:"POST",headers:r,body:a,signal:AbortSignal.timeout(5e3)});if(!s.ok){const i=await s.text();if(s.status===401||s.status===403)return{connected:!1,error:`HTTP ${s.status}: ${i}`};s.status}return{connected:!0}}return{connected:!1,error:"Unknown provider"}}catch(n){return{connected:!1,error:n.message}}}async function Sp(t,e,n,{temperature:r=.7,maxTokens:a=4096,signal:s}={},i=()=>{}){var N,j,V,S,K,B;const l=await xp(t);if(!l)throw new Error(`No API key configured for ${t}. Please check your settings.`);let u,d,v;if(t==="openai"||t==="xai"){u=t==="openai"?"https://api.openai.com/v1/chat/completions":"https://api.x.ai/v1/chat/completions",d={"Content-Type":"application/json",Authorization:`Bearer ${l}`};const O=n.find(xe=>xe.role==="system"),Q=n.filter(xe=>xe.role!=="system"),se=e.startsWith("o1")||e.startsWith("o3");v=JSON.stringify({model:e,messages:O?[O,...Q]:Q,temperature:se?1:r,max_completion_tokens:a,stream:!0})}else if(t==="anthropic"){u="https://api.anthropic.com/v1/messages",d={"x-api-key":l,"anthropic-version":"2023-06-01","anthropic-dangerously-allow-browser":"true","content-type":"application/json"};const O=n.find(se=>se.role==="system"),Q=n.filter(se=>se.role!=="system");v=JSON.stringify({model:e,system:O?O.content:void 0,messages:Q,temperature:r,max_tokens:a,stream:!0})}const p=await fetch(u,{method:"POST",headers:d,body:v,signal:s});if(!p.ok){const O=await p.text();throw new Error(`${t} API error: ${O}`)}const h=p.body.getReader(),m=new TextDecoder("utf-8");let x=0,k=0,E="";try{for(;;){const{done:O,value:Q}=await h.read();if(O)break;const se=m.decode(Q,{stream:!0});E+=se;const xe=E.split(`
`);E=xe.pop()||"";for(const z of xe){const M=z.trim();if(!M||!M.startsWith("data:"))continue;const q=M.slice(5).trim();if(q==="[DONE]")break;try{const T=JSON.parse(q);if(t==="openai"||t==="xai"){const D=(V=(j=(N=T.choices)==null?void 0:N[0])==null?void 0:j.delta)==null?void 0:V.content;D&&(k++,i({content:D,done:!1})),T.usage&&(x=T.usage.prompt_tokens||0,k=T.usage.completion_tokens||k)}else t==="anthropic"&&(T.type==="message_start"?x=((K=(S=T.message)==null?void 0:S.usage)==null?void 0:K.input_tokens)||0:T.type==="content_block_delta"&&((B=T.delta)!=null&&B.text)?(k++,i({content:T.delta.text,done:!1})):T.type==="message_delta"&&T.usage&&(k=T.usage.output_tokens||k))}catch{}}}i({content:"",done:!0,inputTokens:x,outputTokens:k})}finally{h.releaseLock()}}const Xf=Object.freeze(Object.defineProperty({__proto__:null,getApiKey:xp,streamApiChat:Sp,testApiConnection:kp},Symbol.toStringTag,{value:"Module"}));let zn="idle",qs=null,Pi=null,ts=new Set,Er=null;function sr(t){for(const e of ts)try{e(t)}catch{}}function W_(t){return{async check(){zn="loading",Pi=t,sr({status:"loading",data:`Checking ${t} connection...`});const{getApiKey:e}=await Ln(async()=>{const{getApiKey:a}=await Promise.resolve().then(()=>Xf);return{getApiKey:a}},void 0),n=await e(t);if(!n){zn="idle",sr({status:"error",data:`${t} API key not found. Please configure it in settings.`});return}const r=await kp(t,n);r.connected?(zn="idle",sr({status:"ready",data:{type:"api",provider:t}})):(zn="idle",sr({status:"error",data:`${t} connection failed: ${r.error}`}))},async loadModel(e){qs=e,Pi=t,zn="loading",sr({status:"loading",data:`Connecting to ${t} model: ${e}...`});const{getApiKey:n}=await Ln(async()=>{const{getApiKey:a}=await Promise.resolve().then(()=>Xf);return{getApiKey:a}},void 0);if(!await n(t)){zn="idle",qs=null,sr({status:"error",data:`${t} API key not configured.`});return}zn="ready",sr({status:"ready"})},async generate(e,n={}){if(!qs||!Pi){sr({status:"error",data:"No model or provider selected"});return}zn="generating",sr({status:"start",inputTokens:0});let r=0,a=performance.now();Er=new AbortController;try{await Sp(Pi,qs,e,{...n,signal:Er.signal},s=>{if(!Er.signal.aborted)if(s.done){zn="ready";const i=(performance.now()-a)/1e3,l=i>0?r/i:null;sr({status:"complete",tps:l!==null?Math.round(l*10)/10:null,numTokens:s.outputTokens||r,inputTokens:s.inputTokens||0})}else{r++;const i=performance.now()-a,l=i>0?r/i*1e3:0;sr({status:"update",output:s.content,tps:Math.round(l*10)/10,numTokens:r})}})}catch(s){Er.signal.aborted?(zn="ready",sr({status:"complete",tps:null,numTokens:r})):(zn="ready",sr({status:"error",data:s.message}))}finally{Er=null}},generateFull(e,n,r){return new Promise((a,s)=>{let i="",l=null,u=0,d=0;const v=h=>{switch(h.status){case"start":d=h.inputTokens||0;break;case"update":if(i+=h.output,l=h.tps??l,u=h.numTokens??u,r)try{r({tps:l,numTokens:u,text:i})}catch{}break;case"complete":p(),a({text:i,tps:l,numTokens:u,inputTokens:d});break;case"error":p(),s(new Error(h.data));break}},p=()=>{ts.delete(v)};ts.add(v),this.generate(e,n)})},interrupt(){Er&&Er.abort()},reset(){Er&&Er.abort()},onMessage(e){return ts.add(e),()=>ts.delete(e)},offMessage(e){ts.delete(e)},get status(){return zn},get isReady(){return zn==="ready"},get isGenerating(){return zn==="generating"},get modelId(){return qs},get backend(){return Pi},terminate(){zn="idle",qs=null,Er&&Er.abort(),ts.clear()}}}let Ia=null,Tt=null,Uc=new Set;function Y_(t){if(t.startsWith("onnx-community/")||t.startsWith("microsoft/"))return"webgpu";const e=bp(t);return e?e.provider:"ollama"}function Ep(){return{loadModel(t){const e=Y_(t);if(Ia!==e){Tt&&Tt.terminate(),Ia=e,e==="webgpu"?Tt=Gc():e==="ollama"?Tt=V_():Tt=W_(e);for(const n of Uc)Tt.onMessage(n)}Tt.loadModel(t)},check(){Tt||(Tt=Gc(),Ia="webgpu"),Tt.check()},generate(t,e){if(!Tt)throw new Error("No engine loaded. Call loadModel() first.");return Tt.generate(t,e)},generateFull(t,e,n){return Tt?Tt.generateFull(t,e,n):Promise.reject(new Error("No engine loaded. Call loadModel() first."))},interrupt(){Tt==null||Tt.interrupt()},reset(){Tt==null||Tt.reset()},onMessage(t){return Tt||(Tt=Gc(),Ia="webgpu"),Uc.add(t),Tt.onMessage(t)},offMessage(t){Uc.delete(t),Tt==null||Tt.offMessage(t)},get status(){return(Tt==null?void 0:Tt.status)||"idle"},get isReady(){return(Tt==null?void 0:Tt.isReady)||!1},get isGenerating(){return(Tt==null?void 0:Tt.isGenerating)||!1},get modelId(){return(Tt==null?void 0:Tt.modelId)||null},get backend(){return Ia},getModelInfo(){const t=this.modelId;return t?Ia==="webgpu"?bd(t):Ia==="ollama"?wd(t):bp(t):null},terminate(){Tt==null||Tt.terminate(),Tt=null,Ia=null}}}function Iu(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,r)).toFixed(1)+" "+n[r]}function Vc(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e)),a=t/Math.pow(e,r),s=r>=2?2:r>=1?1:0;return a.toFixed(s)+" "+n[r]}function X_(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function Z_(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function Ql(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+((e<<5)-e);return Math.abs(e)%360}const Q_="https://gmail.googleapis.com/gmail/v1/users/me";class xd extends Error{constructor(e,n,r){super(e),this.name="GmailApiError",this.status=n,this.code=r||null}}function J_(t){return{Authorization:`Bearer ${t}`}}async function Jl(t,e){var r,a,s,i;const n=await fetch(`${Q_}${e}`,{headers:J_(t)});if(!n.ok){const l=await n.json().catch(()=>({})),u=((r=l.error)==null?void 0:r.message)||`Gmail API error: ${n.status}`,d=((i=(s=(a=l.error)==null?void 0:a.errors)==null?void 0:s[0])==null?void 0:i.reason)||void 0;throw new xd(u,n.status,d)}return n.json()}function Ap(t){return Jl(t,"/profile")}function Tp(t,{maxResults:e=20,pageToken:n,q:r}={}){const a=new URLSearchParams;return a.set("maxResults",String(e)),n&&a.set("pageToken",n),r&&a.set("q",r),Jl(t,`/messages?${a}`)}function Cp(t,e,n="full"){return Jl(t,`/messages/${e}?format=${n}`)}function $_(t,{startHistoryId:e,pageToken:n,maxResults:r=500}={}){const a=new URLSearchParams;return a.set("startHistoryId",e),a.set("maxResults",String(r)),a.append("historyTypes","messageAdded"),a.append("historyTypes","messageDeleted"),n&&a.set("pageToken",n),Jl(t,`/history?${a}`)}function Pa(t,e){var s;const n=((s=t==null?void 0:t.payload)==null?void 0:s.headers)||[],r=e.toLowerCase(),a=n.find(i=>i.name.toLowerCase()===r);return(a==null?void 0:a.value)||""}function Wi(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const n=e.length%4;n&&(e+="=".repeat(4-n));const r=atob(e),a=Uint8Array.from(r,s=>s.charCodeAt(0));return new TextDecoder().decode(a)}function eb(t){var s,i,l;const e=t==null?void 0:t.payload;if(!e)return"";if((s=e.body)!=null&&s.data)return Wi(e.body.data);const n=e.parts||[],r=kl(n,"text/plain");if((i=r==null?void 0:r.body)!=null&&i.data)return Wi(r.body.data);const a=kl(n,"text/html");if((l=a==null?void 0:a.body)!=null&&l.data){const u=Wi(a.body.data);return nb(u)}return"(no body)"}function tb(t){var a,s;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((a=e.body)!=null&&a.data))return Wi(e.body.data);const n=e.parts||[],r=kl(n,"text/html");return(s=r==null?void 0:r.body)!=null&&s.data?Wi(r.body.data):null}function kl(t,e){for(const n of t){if(n.mimeType===e)return n;if(n.parts){const r=kl(n.parts,e);if(r)return r}}return null}function nb(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const n of e.querySelectorAll("style, script"))n.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,n)=>String.fromCodePoint(parseInt(n,16))).replace(/&#(\d+);/g,(e,n)=>String.fromCodePoint(Number(n))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function kd(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Ip(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function Pp(t){return Ip(t).charAt(0).toUpperCase()}function rb(t){try{const e=new Date(t),n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${n}-${r}-${a}`}catch{return"email"}}function ab(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Mp(t,e){return`${rb(t.date)}_${ab(t.subject)}.${e}`}function Op(t){const e={};for(const r of t){const a=r.action||"UNKNOWN";e[a]||(e[a]=[]),e[a].push(r)}for(const r of Object.keys(e))e[r].sort((a,s)=>(s.date||0)-(a.date||0));const n=Object.keys(e).sort((r,a)=>e[a].length-e[r].length);return{groups:e,order:n}}async function sb(){const t=await lt.items.where("sourceType").equals("gmail").count(),e=await lt.contacts.count();if(t===0)return null;const n=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:r,newest:a}=await Np();if(r&&a){const s=new Date(r.date).toLocaleDateString(),i=new Date(a.date).toLocaleDateString();n.push(`Date range: ${s} to ${i}.`)}return n.join(" ")}async function ib(){const t=await lt.items.where("sourceType").equals("gmail").count(),e=await lt.contacts.count();if(t===0)return"No emails stored locally.";const n=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:r,newest:a}=await Np();if(r&&a){const s=new Date(r.date).toLocaleDateString(),i=new Date(a.date).toLocaleDateString();n.push(`- **Date range:** ${s} â ${i}`)}return n.join(`
`)}async function ob(t=10){const e=await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Dp).join(`

---

`)}async function lb(t,e=10){if(!t)return"No search query provided.";const n=t.toLowerCase(),a=(await lt.items.where("sourceType").equals("gmail").toArray()).map(s=>{var l,u,d,v,p;let i=0;return(l=s.subject)!=null&&l.toLowerCase().includes(n)&&(i+=3),(u=s.from)!=null&&u.toLowerCase().includes(n)&&(i+=2),(d=s.to)!=null&&d.toLowerCase().includes(n)&&(i+=2),(v=s.snippet)!=null&&v.toLowerCase().includes(n)&&(i+=1),(p=s.body)!=null&&p.toLowerCase().includes(n)&&(i+=1),{item:s,score:i}}).filter(({score:s})=>s>0).sort((s,i)=>i.score-s.score).slice(0,e);return a.length===0?`No results found for "${t}".`:a.map(({item:s})=>Dp(s)).join(`

---

`)}async function Zf(){const t=await lt.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:n}=Op(t);return{groups:e,order:n,total:t.length}}async function cb({query:t,limit:e=50,offset:n=0}={}){if(t){const s=t.toLowerCase(),i=await lt.items.where("sourceType").equals("gmail").filter(l=>{var u,d,v,p;return((u=l.subject)==null?void 0:u.toLowerCase().includes(s))||((d=l.from)==null?void 0:d.toLowerCase().includes(s))||((v=l.to)==null?void 0:v.toLowerCase().includes(s))||((p=l.snippet)==null?void 0:p.toLowerCase().includes(s))}).toArray();return i.sort((l,u)=>(u.date||0)-(l.date||0)),{items:i.slice(n,n+e),total:i.length}}const r=await lt.items.where("sourceType").equals("gmail").count();return{items:await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).reverse().offset(n).limit(e).toArray(),total:r}}async function Np(){const t=await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).first(),e=await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).last();return{oldest:t,newest:e}}function Dp(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",n=Z_(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",n].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",n].join(`
`)}}async function ub(){const t=await sb();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function db(t){const e=[],n=await ib();if(e.push(n),t){const r=await lb(t,5);e.push("","## Relevant Emails",r)}else{const r=await ob(5);e.push("","## Recent Emails",r)}return e.join(`
`)}const nr={NOISE:{id:"NOISE",label:"Noise",description:"Unimportant emails that can be safely deleted or archived automatically.",autoExecute:!0,requiresApproval:!1,color:"#6b7280"},INFO:{id:"INFO",label:"Info",description:"Informational emails to review. Actions run on user request.",autoExecute:!1,requiresApproval:!1,color:"#3b82f6"},CRITICAL:{id:"CRITICAL",label:"Critical",description:"High-stakes emails that change state. User must approve before any action runs.",autoExecute:!1,requiresApproval:!0,color:"#f59e0b"}},Sd="INFO",Rp="me-ai-events",Lp="me-ai-event-groups";async function gi(){const{getSetting:t}=await Ln(async()=>{const{getSetting:e}=await Promise.resolve().then(()=>Sa);return{getSetting:e}},void 0);return await t(Rp)||{}}async function $l(t){const{setSetting:e}=await Ln(async()=>{const{setSetting:n}=await Promise.resolve().then(()=>Sa);return{setSetting:n}},void 0);await e(Rp,t)}async function ec(){const{getSetting:t}=await Ln(async()=>{const{getSetting:e}=await Promise.resolve().then(()=>Sa);return{getSetting:e}},void 0);return await t(Lp)||{}}async function jp(t){const{setSetting:e}=await Ln(async()=>{const{setSetting:n}=await Promise.resolve().then(()=>Sa);return{setSetting:n}},void 0);await e(Lp,t)}async function fb(){try{const{db:t}=await Ln(async()=>{const{db:r}=await Promise.resolve().then(()=>R_);return{db:r}},void 0),e=await t.emailClassifications.toArray();return[...new Set(e.map(r=>r.action).filter(Boolean))].sort()}catch{return[]}}async function vb(){const t=await gi(),e=await fb();return[...new Set([...Object.keys(t),...e])].sort()}async function Ji(t){var r;const e=((r=t==null?void 0:t.toUpperCase)==null?void 0:r.call(t))||"";return(await ec())[e]||Sd}async function hb(t,e){const n=t.toUpperCase();if(!nr[e])throw new Error(`Unknown group: ${e}`);const r=await ec();r[n]=e,await jp(r)}async function pb(){return ec()}async function zp(t){const e=await Ji(t),n=nr[e]||nr[Sd];return{autoExecute:n.autoExecute,requiresApproval:n.requiresApproval,group:e}}async function jr(t){var r;const e=((r=t==null?void 0:t.toUpperCase)==null?void 0:r.call(t))||"";return(await gi())[e]||[]}const Wc=jr;async function gb(t){const e=t.toUpperCase().replace(/\s+/g,"_").replace(/[^A-Z0-9_]/g,"");if(!e)return;const n=await gi();e in n||(n[e]=[],await $l(n))}async function mb(t,e,n){const r=t.toUpperCase().replace(/\s+/g,"_").replace(/[^A-Z0-9_]/g,"");if(!r)return;const a=await gi(),s=await ec();if(!(r in s)){const i=nr[e]?e:Sd;s[r]=i,await jp(s)}if(!(r in a)){const{pluginRegistry:i}=await Ln(async()=>{const{pluginRegistry:v}=await Promise.resolve().then(()=>Ob);return{pluginRegistry:v}},void 0),l=i.getAvailableActions("gmail"),u=Object.fromEntries(l.map(v=>[v.actionId,v])),d=(n||[]).filter(v=>u[v]).map(v=>({id:v,pluginId:"gmail",commandId:v,name:u[v].name,description:u[v].description}));a[r]=d,await $l(a)}}async function yb(t){const e=t.toUpperCase(),n=await gi();delete n[e],await $l(n)}async function Ed(t,e){const n=t.toUpperCase(),r=await gi();r[n]=e,await $l(r)}async function _b(t,e){const n=await jr(t);await Ed(t,[...n,e])}const Qf=_b;async function bb(t,e){const n=await jr(t);await Ed(t,n.filter(r=>r.id!==e))}const wb=bb;async function xb(t,e,n){const r=await jr(t);await Ed(t,r.map(a=>a.id===e?{...a,...n}:a))}const kb=xb;async function Sb(t,e){var a;const n={type:t.action,source:"gmail",data:{subject:e.subject,from:e.from,date:e.date,snippet:e.snippet||((a=e.body)==null?void 0:a.slice(0,200))||""},metadata:{reason:t.reason,summary:t.summary,tags:t.tags||[],classifiedAt:Date.now()}},r=await jr(t.action);return{event:n,commands:r}}async function Eb(t){return{role:"assistant",type:"event-batch",items:await Promise.all(t.filter(n=>n.success&&n.classification).map(async n=>{const{event:r,commands:a}=await Sb(n.classification,n.email);return{event:r,commands:a}})),content:""}}async function Ab(t){const e=await Promise.all(t.order.map(async r=>{const a=t.groups[r]||[],s=await jr(r),i=await Ji(r),l=a.map(u=>({emailId:u.emailId,subject:u.subject||"(no subject)",from:u.from||"",date:u.date,summary:u.summary||"",reason:u.reason||"",tags:u.tags||[],status:u.status||"pending"}));return{eventType:r,group:i,emails:l,commands:s}})),n=e.reduce((r,a)=>r+a.emails.length,0);return{role:"assistant",type:"events-grouped",groups:e,total:n,content:""}}class Tb{constructor(e,n){this.pluginId=e,this.serviceName=n,this.handlers=new Map}registerHandler(e){this.handlers.set(e.actionId,e)}getHandlers(){return Array.from(this.handlers.values())}async execute(e,n){var a,s,i;const r=this.handlers.get(e);if(!r)return{success:!1,error:new Error(`Unknown action: ${e}`),message:`Action "${e}" not found in ${this.serviceName} plugin`};try{(a=n.onProgress)==null||a.call(n,{phase:"executing",actionId:e,actionName:r.name});const l=await r.execute(n);return(s=n.onProgress)==null||s.call(n,{phase:"completed",actionId:e,actionName:r.name,result:l}),l}catch(l){const u={success:!1,error:l,message:l.message||"Unknown error"};return(i=n.onProgress)==null||i.call(n,{phase:"failed",actionId:e,actionName:r.name,error:l.message}),u}}canExecute(e){return this.handlers.has(e)}getRequiredScopes(e){const n=this.handlers.get(e);return(n==null?void 0:n.requiredScopes)||[]}}const Cb="https://gmail.googleapis.com/gmail/v1/users/me",oa={INBOX:"INBOX",UNREAD:"UNREAD",STARRED:"STARRED",SPAM:"SPAM",IMPORTANT:"IMPORTANT"};async function Vn(t,e,n,r=null){var i;const a={method:e,headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}};r&&(a.body=JSON.stringify(r));const s=await fetch(`${Cb}${n}`,a);if(!s.ok){const u=((i=(await s.json().catch(()=>({}))).error)==null?void 0:i.message)||`Gmail API error: ${s.status}`;throw new Error(u)}return s.status===204?{success:!0}:s.json()}class Ib extends Tb{constructor(){super("gmail","Gmail"),this.registerAllHandlers()}extractMessageId(e){const n=e.event.data.emailId||e.event.data.id;return n?n.startsWith("gmail:")?n.substring(6):n:null}registerAllHandlers(){this.registerHandler({actionId:"mark_read",name:"Mark as Read",description:"Remove the UNREAD label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{removeLabelIds:[oa.UNREAD]}),{success:!0,message:"Marked message as read",data:{messageId:n}}}}),this.registerHandler({actionId:"mark_unread",name:"Mark as Unread",description:"Add the UNREAD label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{addLabelIds:[oa.UNREAD]}),{success:!0,message:"Marked message as unread",data:{messageId:n}}}}),this.registerHandler({actionId:"star",name:"Star",description:"Add the STARRED label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{addLabelIds:[oa.STARRED]}),{success:!0,message:"Starred message",data:{messageId:n}}}}),this.registerHandler({actionId:"unstar",name:"Unstar",description:"Remove the STARRED label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{removeLabelIds:[oa.STARRED]}),{success:!0,message:"Unstarred message",data:{messageId:n}}}}),this.registerHandler({actionId:"trash",name:"Move to Trash",description:"Move message to trash (recoverable for 30 days)",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/trash`),{success:!0,message:"Moved message to trash",data:{messageId:n}}}}),this.registerHandler({actionId:"delete",name:"Delete Permanently",description:"Permanently delete message (cannot be recovered)",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"DELETE",`/messages/${n}`),{success:!0,message:"Permanently deleted message",data:{messageId:n}}}}),this.registerHandler({actionId:"mark_spam",name:"Mark as Spam",description:"Move message to spam folder",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{addLabelIds:[oa.SPAM],removeLabelIds:[oa.INBOX]}),{success:!0,message:"Marked message as spam",data:{messageId:n}}}}),this.registerHandler({actionId:"archive",name:"Archive",description:"Remove from inbox (keeps message, removes INBOX label)",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{removeLabelIds:[oa.INBOX]}),{success:!0,message:"Archived message",data:{messageId:n}}}}),this.registerHandler({actionId:"apply_label",name:"Apply Label",description:"Apply a custom label to the message",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{var a;const n=this.extractMessageId(e),r=(a=e.config)==null?void 0:a.labelId;if(!n)throw new Error("No message ID provided");if(!r)throw new Error("No label ID provided in config");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{addLabelIds:[r]}),{success:!0,message:`Applied label: ${r}`,data:{messageId:n,labelId:r}}}}),this.registerHandler({actionId:"remove_label",name:"Remove Label",description:"Remove a label from the message",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{var a;const n=this.extractMessageId(e),r=(a=e.config)==null?void 0:a.labelId;if(!n)throw new Error("No message ID provided");if(!r)throw new Error("No label ID provided in config");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{removeLabelIds:[r]}),{success:!0,message:`Removed label: ${r}`,data:{messageId:n,labelId:r}}}}),this.registerHandler({actionId:"mark_important",name:"Mark as Important",description:"Add the IMPORTANT label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{addLabelIds:[oa.IMPORTANT]}),{success:!0,message:"Marked as important",data:{messageId:n}}}}),this.registerHandler({actionId:"mark_not_important",name:"Mark as Not Important",description:"Remove the IMPORTANT label",requiredScopes:["https://www.googleapis.com/auth/gmail.modify"],execute:async e=>{const n=this.extractMessageId(e);if(!n)throw new Error("No message ID provided");return await Vn(e.accessToken,"POST",`/messages/${n}/modify`,{removeLabelIds:[oa.IMPORTANT]}),{success:!0,message:"Marked as not important",data:{messageId:n}}}})}async batchModify(e,n,r=[],a=[]){if(n.length===0)return{success:!0,message:"No messages to modify"};if(n.length>1e3)throw new Error("Batch modify supports maximum 1000 messages at once");return await Vn(e,"POST","/messages/batchModify",{ids:n,addLabelIds:r,removeLabelIds:a}),{success:!0,message:`Modified ${n.length} messages`,data:{count:n.length}}}async batchDelete(e,n){if(n.length===0)return{success:!0,message:"No messages to delete"};if(n.length>1e3)throw new Error("Batch delete supports maximum 1000 messages at once");return await Vn(e,"POST","/messages/batchDelete",{ids:n}),{success:!0,message:`Deleted ${n.length} messages`,data:{count:n.length}}}}const Pb=new Ib;let Mb=class{constructor(){this.plugins=new Map,this.registerDefaultPlugins()}registerDefaultPlugins(){this.registerPlugin(Pb)}registerPlugin(e){this.plugins.set(e.pluginId,e)}getPlugin(e){return this.plugins.get(e)}getAllPlugins(){return Array.from(this.plugins.values())}async executeAction(e,n){const r=typeof e=="string"?{id:e,commandId:e,pluginId:null}:e,a=r.pluginId||this.resolvePluginId(n.event.source),s=r.commandId||r.id,i=this.getPlugin(a);return i?i.canExecute(s)?i.execute(s,n):{success:!1,message:`Command "${s}" not found in plugin "${i.serviceName}". Available: ${i.getHandlers().map(l=>l.actionId).join(", ")}`,error:new Error(`Command not supported: ${s}`)}:{success:!1,message:`Plugin "${a}" not found. Is it registered?`,error:new Error(`Plugin not found: ${a}`)}}async executePipeline(e,n){var u,d;const r=[];let a=!0;for(const v of e){(u=n.onProgress)==null||u.call(n,{phase:"action_start",actionId:v.id,actionName:v.name,pluginId:v.pluginId,commandId:v.commandId});const p=await this.executeAction(v,n);r.push({actionId:v.id,actionName:v.name,pluginId:v.pluginId,commandId:v.commandId,...p}),p.success||(a=!1),(d=n.onProgress)==null||d.call(n,{phase:"action_complete",actionId:v.id,actionName:v.name,result:p})}const i=r.filter(v=>!v.success).map(v=>{var p;return`${v.pluginId}Â·${v.commandId}: ${v.message||((p=v.error)==null?void 0:p.message)||"Unknown error"}`}).join("; "),l=r.filter(v=>v.success).map(v=>`${v.pluginId}Â·${v.commandId}`).join(", ");return{success:a,results:r,message:a?`Successfully executed: ${l}`:`Pipeline failed: ${i}`}}async executePipelineBatch(e,n,r){var l,u;const a=[];for(let d=0;d<n.length;d++){const v=n[d];(l=r.onProgress)==null||l.call(r,{phase:"batch_event_start",eventIndex:d,totalEvents:n.length,event:v});const p={...r,event:v},h=await this.executePipeline(e,p);a.push({event:v,...h}),(u=r.onProgress)==null||u.call(r,{phase:"batch_event_complete",eventIndex:d,totalEvents:n.length,event:v,result:h})}const s=a.filter(d=>d.success).length,i=a.filter(d=>!d.success).length;return{success:i===0,results:a,total:n.length,successful:s,failed:i,message:`Processed ${n.length} event(s): ${s} successful, ${i} failed`}}resolvePluginId(e){return{gmail:"gmail"}[e]||e}getAvailableActions(e){const n=this.resolvePluginId(e),r=this.getPlugin(n);return r?r.getHandlers():[]}getRequiredScopes(e,n){const r=this.resolvePluginId(n),a=this.getPlugin(r);return a?a.getRequiredScopes(e):[]}};const mi=new Mb,Ob=Object.freeze(Object.defineProperty({__proto__:null,pluginRegistry:mi},Symbol.toStringTag,{value:"Module"})),Nb=20,Db={maxTokens:512};function qp(t){const e=[],n=[];for(const s of t)if(s.actions.length){e.push(`${s.pluginName} plugin:`);for(const i of s.actions)e.push(`  ${i.actionId.padEnd(22)} â ${i.name}: ${i.description}`),n.push(i.actionId)}const r=e.length?e.join(`
`):"  (no actions available)",a=n.join(", ");return`You are an email classifier. Analyze this email and produce a classification with suggested actions.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "group": "NOISE",
  "suggestedActions": ["trash"],
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "group":
- Classify the email into one of three urgency tiers:
  - "NOISE"    â unimportant (promotions, newsletters, notifications with no action needed). Actions run automatically.
  - "INFO"     â informational, worth reading (receipts, shipping updates, account notifications). User decides when to act.
  - "CRITICAL" â requires careful human review before acting (financial transactions, purchases, security alerts, legal notices, anything that changes state or commits money/data).
- When in doubt between NOISE and INFO, use INFO
- When in doubt between INFO and CRITICAL, use CRITICAL

Available actions (from installed plugins):
${r}

Guidelines for "suggestedActions":
- Suggest 1-3 actions from the list above, in execution order
- Use ONLY the exact action IDs listed above (${a})
- Match actions to the email's group and purpose:
    NOISE    â prefer: trash, mark_spam, archive (auto-cleanup)
    INFO     â prefer: mark_read, archive, star (quiet filing)
    CRITICAL â prefer: star, mark_important (never trash/delete CRITICAL emails)
- Choose the most specific and least destructive actions that serve the event type
- These seed the default pipeline for this event type (the user can edit later)
- If genuinely no action is needed, use []

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "group" must be exactly "NOISE", "INFO", or "CRITICAL"
- "suggestedActions" must be an array of valid action IDs from the list above
- "tags" must be an array of lowercase strings
- "summary" must be a string`}function Bp(){return mi.getAllPlugins().map(t=>({pluginId:t.pluginId,pluginName:t.serviceName,actions:t.getHandlers()}))}const Fp=qp(Bp());async function Kp(t,{count:e=Nb,force:n=!1,onProgress:r=()=>{},signal:a}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");r({phase:"loading",message:"Loading recent emails..."});let s,i=0;if(n)s=await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).reverse().limit(e).toArray();else{const B=new Set(await lt.emailClassifications.toCollection().primaryKeys());i=0,s=[],await lt.items.where("[sourceType+date]").between(["gmail",Rn.minKey],["gmail",Rn.maxKey]).reverse().until(()=>s.length>=e).each(O=>{B.has(O.id)?i++:s.push(O)})}if(s.length===0){const B=n?"No emails to scan.":`All emails already classified (${i} total). Use "Rescan All" to reclassify.`;return r({phase:"done",message:B,classified:0}),{scanned:0,classified:0,skipped:i,errors:0}}const l=Date.now(),u=performance.now();let d=0,v=0,p=0,h=0;const m=[],x=Bp(),k=qp(x),E=new Set(x.flatMap(B=>B.actions.map(O=>O.actionId))),N=t.modelId,j=bd(N)||wd(N);if(!j)throw new Error(`Unknown model: ${N}`);if(!j.recommendedForEmailProcessing&&s.length>0){const{MODELS:B}=await Ln(async()=>{const{MODELS:xe}=await Promise.resolve().then(()=>j_);return{MODELS:xe}},void 0),{OLLAMA_MODELS:O}=await Ln(async()=>{const{OLLAMA_MODELS:xe}=await Promise.resolve().then(()=>z_);return{OLLAMA_MODELS:xe}},void 0),Q=[...B.filter(xe=>xe.recommendedForEmailProcessing).map(xe=>xe.name),...O.filter(xe=>xe.recommendedForEmailProcessing).map(xe=>xe.displayName)],se=j.displayName||j.name;console.warn(`â ï¸ Current model (${se}) is not optimized for email processing. For best results with long emails, use: ${Q.join(", ")}. Some emails may fail due to memory limits.`)}for(let B=0;B<s.length&&!(a!=null&&a.aborted);B++){const O=s[B],Q=Up(O),se=[{role:"system",content:k},{role:"user",content:Q}];r({phase:"scanning",current:B+1,total:s.length,classified:d,errors:v,results:m,email:{subject:O.subject,from:O.from,date:O.date},prompt:{system:Fp,user:Q},systemPromptLength:k.length,live:null,lastResult:null,totals:{outputTokens:p,inputTokens:h,elapsed:performance.now()-u}});const xe=performance.now();try{const{text:z,tps:M,numTokens:q,inputTokens:T}=await t.generateFull(se,{maxTokens:512,enableThinking:!1,temperature:0},X=>{r({phase:"generating",current:B+1,total:s.length,classified:d,errors:v,results:m,email:{subject:O.subject,from:O.from,date:O.date},live:{tps:X.tps,numTokens:X.numTokens},streamingText:X.text||"",totals:{outputTokens:p,inputTokens:h,elapsed:performance.now()-u}})});p+=q,h+=T;const D=Lb(z,E),I=performance.now()-xe;if(D){await lt.emailClassifications.put({emailId:O.id,action:D.action,group:D.group,reason:D.reason,summary:D.summary,tags:D.tags,subject:O.subject||"(no subject)",from:O.from||"",date:O.date,scannedAt:l,status:"pending"}),await mb(D.action,D.group,D.suggestedActions),d++;const X={success:!0,email:{subject:O.subject,from:O.from,date:O.date},classification:D,rawResponse:z,stats:{tps:M,numTokens:q,inputTokens:T,elapsed:I},promptSize:Q.length};m.push(X),r({phase:"classified",current:B+1,total:s.length,classified:d,errors:v,results:m,email:{subject:O.subject,from:O.from,date:O.date},result:D,rawResponse:z,emailStats:{tps:M,numTokens:q,inputTokens:T,elapsed:I},totals:{outputTokens:p,inputTokens:h,elapsed:performance.now()-u}})}}catch(z){console.error(`Triage email ${B+1} failed:`,z),v++;const M=z.message||String(z),q=M.length>200?M.slice(0,200)+"...":M;m.push({success:!1,email:{subject:O.subject,from:O.from,date:O.date},error:q,promptSize:Q.length})}}const V=performance.now()-u,S=m.length>0?Math.round(m.reduce((B,O)=>B+O.promptSize,0)/m.length):0,K=m.filter(B=>{var O;return B.success&&((O=B.stats)==null?void 0:O.tps)}).length>0?Math.round(m.filter(B=>B.success).reduce((B,O)=>{var Q;return B+(((Q=O.stats)==null?void 0:Q.tps)||0)},0)/m.filter(B=>{var O;return B.success&&((O=B.stats)==null?void 0:O.tps)}).length):null;return r({phase:"done",current:s.length,total:s.length,classified:d,errors:v,results:m,summary:{avgPromptSize:S,avgTps:K,systemPromptSize:k.length,processed:s.length,skipped:i,modelName:j.displayName||j.name,modelContextWindow:j.contextWindow,modelMaxEmailTokens:j.maxEmailTokens},totals:{outputTokens:p,inputTokens:h,elapsed:V}}),{scanned:s.length,classified:d,skipped:i,errors:v}}async function Hp(){const t=await lt.emailClassifications.toArray();return Op(t)}async function Rb(){const t=await lt.emailClassifications.toArray(),e={total:t.length};for(const n of t){const r=n.action||"UNKNOWN";e[r]=(e[r]||0)+1}return e}async function Sl(t,e){await lt.emailClassifications.update(t,{status:e})}async function Jf(){await lt.emailClassifications.clear()}async function Ad(t){await lt.emailClassifications.where("action").equals(t).delete()}async function Gp(t){await lt.emailClassifications.delete(t)}async function Pu(){const t=await lt.items.where("sourceType").equals("gmail").count(),e=await lt.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Up(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",n=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",n].join(`
`)}function Lb(t,e){if(!t||!t.trim())return null;let n=t.trim();n=n.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),n=n.trim();const r=n.indexOf("{"),a=n.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const s=n.indexOf("[");if(s!==-1&&s<r)return console.warn("Triage: expected JSON object, got array"),null;const i=n.slice(r,a+1);try{const l=JSON.parse(i);if(!l||typeof l!="object"||Array.isArray(l))return null;const u=jb(l.action);if(!u)return console.warn("Triage: missing or invalid action field"),null;const v=["NOISE","INFO","CRITICAL"].includes(l.group)?l.group:"INFO";let p=[];Array.isArray(l.suggestedActions)&&(p=l.suggestedActions.filter(m=>typeof m!="string"||!m.trim()?!1:e?e.has(m.trim()):!0).map(m=>m.trim()).slice(0,5)),p.length===0&&Array.isArray(l.suggestedActions)&&l.suggestedActions.length>0&&console.warn("Triage: suggestedActions contained unknown IDs â all filtered out:",l.suggestedActions);let h=[];return Array.isArray(l.tags)&&(h=l.tags.filter(m=>typeof m=="string"&&m.trim()).map(m=>m.trim().toLowerCase()).slice(0,10)),{action:u,group:v,suggestedActions:p,reason:String(l.reason||"").slice(0,300),summary:String(l.summary||"").slice(0,500),tags:h}}catch(l){return console.warn("Triage: failed to parse JSON response:",l.message),null}}function jb(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function Mu(t){return`hsl(${Ql(t)}, 55%, 55%)`}function zb(t){return`hsl(${Ql(t)}, 40%, 35%)`}var qb=L('<p class="warning svelte-1n2kfl0">WebGPU not available in this browser. Use Ollama or upgrade your browser.</p>'),Bb=L('<div class="backend-selector svelte-1n2kfl0"><div class="backend-label svelte-1n2kfl0">AI Backend:</div> <div class="backend-options svelte-1n2kfl0"><button><span class="backend-icon svelte-1n2kfl0">ð·</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">WebGPU</div> <div class="backend-desc svelte-1n2kfl0">Browser, private, no server</div></div></button> <button><span class="backend-icon svelte-1n2kfl0">ð¦</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">Ollama</div> <div class="backend-desc svelte-1n2kfl0">Local server, larger models</div></div></button> <button><span class="backend-icon svelte-1n2kfl0">âï¸</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">Cloud APIs</div> <div class="backend-desc svelte-1n2kfl0">ChatGPT, Claude, Grok</div></div></button></div> <!></div>');function Fb(t,e){at(e,!0);let n=Ae(e,"backend",15,"webgpu"),r=Ae(e,"isWebGPUAvailable",3,!0);var a=Bb(),s=b(_(a),2),i=_(s);let l;i.__click=()=>n("webgpu");var u=b(i,2);let d;u.__click=()=>n("ollama");var v=b(u,2);let p;v.__click=()=>n("cloud");var h=b(s,2);{var m=x=>{var k=qb();C(x,k)};ue(h,x=>{!r()&&n()==="webgpu"&&x(m)})}oe(()=>{l=St(i,1,"backend-btn svelte-1n2kfl0",null,l,{active:n()==="webgpu"}),i.disabled=!r(),d=St(u,1,"backend-btn svelte-1n2kfl0",null,d,{active:n()==="ollama"}),p=St(v,1,"backend-btn cloud-btn svelte-1n2kfl0",null,p,{active:n()==="cloud"})}),C(t,a),st()}Xt(["click"]);const Kb=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function $f(...t){Kb&&console.log("[debug]",...t)}function dr(t){return $f(`[MOUNT] ${t}`),()=>$f(`[DESTROY] ${t}`)}var Hb=L("<option> </option>"),Gb=L('<p class="model-description svelte-1p89qnn"> </p>'),Ub=L('<span class="current-badge svelte-1p89qnn">Current</span>'),Vb=L('<span class="rec-badge rec-good svelte-1p89qnn">â</span>'),Wb=L('<span class="rec-badge rec-ok svelte-1p89qnn">â ï¸</span>'),Yb=L('<span class="rec-badge rec-bad svelte-1p89qnn">â</span>'),Xb=L('<tr><td class="model-name svelte-1p89qnn"> <!></td><td class="context-col svelte-1p89qnn"><strong> </strong></td><td class="tokens-col svelte-1p89qnn"> </td><td class="rec-col svelte-1p89qnn"><!></td></tr>'),Zb=L('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Qb=L('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!></div></div>'),Jb=L('<p class="error svelte-1p89qnn"> </p>'),$b=L('<div class="container svelte-1p89qnn"><div class="content-wrapper svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <details class="model-details svelte-1p89qnn"><summary class="model-details-summary svelte-1p89qnn">Model Capabilities</summary> <div class="model-table-wrapper svelte-1p89qnn"><table class="model-table svelte-1p89qnn"><thead class="svelte-1p89qnn"><tr><th class="svelte-1p89qnn">Model</th><th class="svelte-1p89qnn">Context</th><th class="svelte-1p89qnn">Email Limit</th><th class="svelte-1p89qnn">Status</th></tr></thead><tbody class="svelte-1p89qnn"></tbody></table></div> <p class="model-table-note svelte-1p89qnn"><strong class="svelte-1p89qnn">Context</strong> = max input capacity. <strong class="svelte-1p89qnn">Email Limit</strong> = WebGPU safe limit. â = Recommended, â ï¸ = Limited, â = May fail.</p></details> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div></div>');function e0(t,e){at(e,!0);let n=Ae(e,"selectedModel",15),r=Ae(e,"gpuInfo",3,null),a=Ae(e,"error",3,null);_n(()=>dr("ModelSelector"));var s=$b(),i=_(s),l=b(_(i),2),u=b(_(l),2);Ot(u,21,()=>$r,Ut,(S,K)=>{var B=Hb(),O=_(B),Q={};oe(()=>{ee(O,`${o(K).name??""} â ${o(K).size??""}`),Q!==(Q=o(K).id)&&(B.value=(B.__value=o(K).id)??"")}),C(S,B)});var d=b(u,2);{var v=S=>{const K=J(()=>$r.find(se=>se.id===n()));var B=an(),O=Ye(B);{var Q=se=>{var xe=Gb(),z=_(xe);oe(()=>ee(z,o(K).description)),C(se,xe)};ue(O,se=>{o(K)&&se(Q)})}C(S,B)};ue(d,S=>{n()&&S(v)})}var p=b(l,2),h=b(_(p),2),m=_(h),x=b(_(m));Ot(x,21,()=>$r,Ut,(S,K)=>{var B=Xb();let O;var Q=_(B),se=_(Q),xe=b(se);{var z=ie=>{var H=Ub();C(ie,H)};ue(xe,ie=>{o(K).id===n()&&ie(z)})}var M=b(Q),q=_(M),T=_(q),D=b(M),I=_(D),X=b(D),Y=_(X);{var Z=ie=>{var H=Vb();C(ie,H)},U=ie=>{var H=Wb();C(ie,H)},te=ie=>{var H=Yb();C(ie,H)};ue(Y,ie=>{o(K).recommendedForEmailProcessing?ie(Z):o(K).maxEmailTokens>=6e3?ie(U,1):ie(te,!1)})}oe((ie,H)=>{O=St(B,1,"svelte-1p89qnn",null,O,{selected:o(K).id===n()}),ee(se,`${o(K).name??""} `),ee(T,`${ie??""}k`),ee(I,`~${H??""}k`)},[()=>(o(K).contextWindow/1024).toFixed(0),()=>(o(K).maxEmailTokens/1e3).toFixed(0)]),C(S,B)});var k=b(p,2);{var E=S=>{var K=Qb(),B=b(_(K),2),O=_(B),Q=b(_(O)),se=_(Q),xe=b(O,2),z=b(_(xe)),M=_(z),q=b(xe,2);{var T=D=>{var I=Zb(),X=b(_(I)),Y=_(X);oe(Z=>ee(Y,Z),[()=>Iu(r().limits.maxBufferSize)]),C(D,I)};ue(q,D=>{var I;(I=r().limits)!=null&&I.maxBufferSize&&D(T)})}oe(()=>{ee(se,r().vendor),ee(M,r().architecture)}),C(S,K)};ue(k,S=>{r()&&S(E)})}var N=b(k,2);{var j=S=>{var K=Jb(),B=_(K);oe(()=>ee(B,a())),C(S,K)};ue(N,S=>{a()&&S(j)})}var V=b(N,2);V.__click=function(...S){var K;(K=e.onload)==null||K.apply(this,S)},oe(()=>V.disabled=a()),pi(u,n),C(t,s),st()}Xt(["click"]);var t0=L('<span class="status-dot connected svelte-1bvvk8o"></span> <span> </span>',1),n0=L('<div class="cors-help svelte-1bvvk8o"><strong class="svelte-1bvvk8o">Fix CORS Error:</strong> <ul class="svelte-1bvvk8o"><li class="svelte-1bvvk8o">In Cloudflare: Add Transform Rule to set <code class="svelte-1bvvk8o"></code></li> <li class="svelte-1bvvk8o">Or set <code class="svelte-1bvvk8o"></code> on your server</li> <li class="svelte-1bvvk8o">For testing: Use <code class="svelte-1bvvk8o">http://localhost:5173</code> (no CORS restrictions)</li></ul></div>'),r0=L('<span class="status-dot disconnected svelte-1bvvk8o"></span> <div class="error-content svelte-1bvvk8o"><span> </span> <!></div>',1),a0=L("<div><!></div>"),s0=L("<option> <!></option>"),i0=L("<option> <!></option>"),o0=L('<span class="sep svelte-1bvvk8o">Â·</span> <span> </span>',1),l0=L('<div class="install-hint svelte-1bvvk8o"><strong>Not installed.</strong> Run: <code class="svelte-1bvvk8o"> </code></div>'),c0=L('<div class="install-hint installed svelte-1bvvk8o">â Model installed and ready</div>'),u0=L('<div class="model-info svelte-1bvvk8o"><p class="model-desc svelte-1bvvk8o"> </p> <div class="model-meta svelte-1bvvk8o"><span> </span> <span class="sep svelte-1bvvk8o">Â·</span> <span> </span> <!></div> <!></div>'),d0=L('<span class="current-badge svelte-1bvvk8o">Current</span>'),f0=L('<span class="installed-badge svelte-1bvvk8o">â</span>'),v0=L('<span class="rec-badge svelte-1bvvk8o">â</span>'),h0=L('<tr><td class="model-name svelte-1bvvk8o"> <!> <!></td><td class="context-col svelte-1bvvk8o"><strong> </strong></td><td class="params-col svelte-1bvvk8o"> </td><td class="tags-col svelte-1bvvk8o"><!> </td></tr>'),p0=L('<p class="error svelte-1bvvk8o"> </p>'),g0=L('<div class="ollama-settings svelte-1bvvk8o"><div class="connection-section svelte-1bvvk8o"><label for="ollama-url" class="svelte-1bvvk8o">Ollama Server URL: <span class="env-badge svelte-1bvvk8o"> </span></label> <div class="url-input-group svelte-1bvvk8o"><input id="ollama-url" type="text" class="svelte-1bvvk8o"/> <button class="btn-test svelte-1bvvk8o"> </button></div> <!></div> <div class="model-section svelte-1bvvk8o"><label for="ollama-model" class="svelte-1bvvk8o">Choose Model:</label> <select id="ollama-model" class="svelte-1bvvk8o"><optgroup label="Recommended (install via: ollama pull MODEL_NAME)"></optgroup><optgroup label="Other Models"></optgroup></select> <!></div> <details class="model-details svelte-1bvvk8o"><summary class="model-details-summary svelte-1bvvk8o">Ollama Model Capabilities</summary> <div class="model-table-wrapper svelte-1bvvk8o"><table class="model-table svelte-1bvvk8o"><thead class="svelte-1bvvk8o"><tr><th class="svelte-1bvvk8o">Model</th><th class="svelte-1bvvk8o">Context Window</th><th class="svelte-1bvvk8o">Params</th><th class="svelte-1bvvk8o">Strengths</th></tr></thead><tbody class="svelte-1bvvk8o"></tbody></table></div> <p class="model-table-note svelte-1bvvk8o">â = installed on your Ollama server. To install: <code class="svelte-1bvvk8o">ollama pull MODEL_NAME</code></p></details> <!> <button class="btn primary svelte-1bvvk8o">Load Model</button></div>');function m0(t,e){at(e,!0);let n=Ae(e,"selectedModel",15),r=Ae(e,"error",15);const a=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1");let s=Pe(Wt(xo())),i=Pe(!1),l=Pe(null),u=Pe(Wt([])),d=Pe(!1);yn(()=>{K_().then(G=>{P(s,G,!0),v()})});async function v(){P(i,!0),P(l,null);const G=await Cu(o(s));P(l,G,!0),P(i,!1),G.connected&&p()}async function p(){P(d,!0);try{const G=await G_(o(s));P(u,G.map(re=>re.name),!0)}catch(G){console.error("Failed to load Ollama models:",G),P(u,[],!0)}P(d,!1)}function h(){H_(o(s)),v()}function m(){if(!n()){r("Please select a model");return}e.onload()}function x(G){return o(u).length?o(u).includes(G):!1}const k=_p();var E=g0(),N=_(E),j=_(N),V=b(_(j)),S=_(V),K=b(j,2),B=_(K);B.__change=h;var O=b(B,2);O.__click=v;var Q=_(O),se=b(K,2);{var xe=G=>{var re=a0();let ae;var pe=_(re);{var _e=$=>{var ke=t0(),be=b(Ye(ke),2),Me=_(be);oe(()=>ee(Me,`Connected â¢ v${o(l).version??""}`)),C($,ke)},ne=$=>{var ke=r0(),be=b(Ye(ke),2),Me=_(be),Xe=_(Me),Je=b(Me,2);{var ct=De=>{var Oe=n0(),qe=b(_(Oe),2),Ne=_(qe),Fe=b(_(Ne));Fe.textContent=`Access-Control-Allow-Origin: ${window.location.origin??""}`;var Ke=b(Ne,2),$e=b(_(Ke));$e.textContent=`OLLAMA_ORIGINS=${window.location.origin??""}`,C(De,Oe)};ue(Je,De=>{o(l).corsError&&De(ct)})}oe(()=>ee(Xe,`Disconnected: ${o(l).error??""}`)),C($,ke)};ue(pe,$=>{o(l).connected?$(_e):$(ne,!1)})}oe(()=>ae=St(re,1,"connection-status svelte-1bvvk8o",null,ae,{connected:o(l).connected})),C(G,re)};ue(se,G=>{o(l)&&G(xe)})}var z=b(N,2),M=b(_(z),2),q=_(M);Ot(q,21,()=>k,Ut,(G,re)=>{var ae=s0(),pe=_(ae),_e=b(pe);{var ne=be=>{var Me=on("â");C(be,Me)},$=J(()=>x(o(re).name));ue(_e,be=>{o($)&&be(ne)})}var ke={};oe(be=>{ee(pe,`${o(re).displayName??""} (${o(re).params??""}) - ${be??""}k context `),ke!==(ke=o(re).name)&&(ae.value=(ae.__value=o(re).name)??"")},[()=>(o(re).contextWindow/1024).toFixed(0)]),C(G,ae)});var T=b(q);Ot(T,21,()=>ea.filter(G=>!G.recommended),Ut,(G,re)=>{var ae=i0(),pe=_(ae),_e=b(pe);{var ne=be=>{var Me=on("â");C(be,Me)},$=J(()=>x(o(re).name));ue(_e,be=>{o($)&&be(ne)})}var ke={};oe(be=>{ee(pe,`${o(re).displayName??""} (${o(re).params??""}) - ${be??""}k context `),ke!==(ke=o(re).name)&&(ae.value=(ae.__value=o(re).name)??"")},[()=>(o(re).contextWindow/1024).toFixed(0)]),C(G,ae)});var D=b(M,2);{var I=G=>{const re=J(()=>ea.find(ne=>ne.name===n()));var ae=an(),pe=Ye(ae);{var _e=ne=>{var $=u0(),ke=_($),be=_(ke),Me=b(ke,2),Xe=_(Me),Je=_(Xe),ct=b(Xe,4),De=_(ct),Oe=b(ct,2);{var qe=Ze=>{var Ge=o0(),tt=b(Ye(Ge),2),nt=_(tt);oe(ft=>ee(nt,ft),[()=>o(re).tags.join(", ")]),C(Ze,Ge)};ue(Oe,Ze=>{var Ge;(Ge=o(re).tags)!=null&&Ge.length&&Ze(qe)})}var Ne=b(Me,2);{var Fe=Ze=>{var Ge=l0(),tt=b(_(Ge),2),nt=_(tt);oe(()=>ee(nt,`ollama pull ${n()??""}`)),C(Ze,Ge)},Ke=J(()=>!x(n())),$e=Ze=>{var Ge=c0();C(Ze,Ge)};ue(Ne,Ze=>{o(Ke)?Ze(Fe):Ze($e,!1)})}oe(Ze=>{ee(be,o(re).description),ee(Je,`${Ze??""}k context`),ee(De,`${o(re).params??""} params`)},[()=>(o(re).contextWindow/1024).toFixed(0)]),C(ne,$)};ue(pe,ne=>{o(re)&&ne(_e)})}C(G,ae)};ue(D,G=>{n()&&G(I)})}var X=b(z,2),Y=b(_(X),2),Z=_(Y),U=b(_(Z));Ot(U,21,()=>ea,Ut,(G,re)=>{var ae=h0();let pe;var _e=_(ae),ne=_(_e),$=b(ne);{var ke=Ze=>{var Ge=d0();C(Ze,Ge)};ue($,Ze=>{o(re).name===n()&&Ze(ke)})}var be=b($,2);{var Me=Ze=>{var Ge=f0();C(Ze,Ge)},Xe=J(()=>x(o(re).name));ue(be,Ze=>{o(Xe)&&Ze(Me)})}var Je=b(_e),ct=_(Je),De=_(ct),Oe=b(Je),qe=_(Oe),Ne=b(Oe),Fe=_(Ne);{var Ke=Ze=>{var Ge=v0();C(Ze,Ge)};ue(Fe,Ze=>{o(re).recommended&&Ze(Ke)})}var $e=b(Fe);oe((Ze,Ge,tt)=>{pe=St(ae,1,"svelte-1bvvk8o",null,pe,Ze),ee(ne,`${o(re).displayName??""} `),ee(De,`${Ge??""}k`),ee(qe,o(re).params),ee($e,` ${tt??""}`)},[()=>({selected:o(re).name===n(),installed:x(o(re).name)}),()=>(o(re).contextWindow/1024).toFixed(0),()=>o(re).tags.slice(0,2).join(", ")]),C(G,ae)});var te=b(X,2);{var ie=G=>{var re=p0(),ae=_(re);oe(()=>ee(ae,r())),C(G,re)};ue(te,G=>{r()&&G(ie)})}var H=b(te,2);H.__click=m,oe(()=>{var G;ee(S,a?"ð¥ local":"âï¸ remote"),xt(B,"placeholder",a?"http://localhost:11434":"https://me-ai.metaelon.space"),O.disabled=o(i),ee(Q,o(i)?"Testing...":"Test"),H.disabled=!((G=o(l))!=null&&G.connected)||r()}),Zr(B,()=>o(s),G=>P(s,G)),pi(M,n),C(t,E),st()}Xt(["change","click"]);var y0=L("<option> <!></option>"),_0=L('<span class="warning svelte-1cdiev9">May struggle with long emails.</span>'),b0=L('<div class="model-info svelte-1cdiev9"> <!></div>'),w0=L('<div class="error-msg svelte-1cdiev9"> </div>'),x0=L('<div class="api-settings svelte-1cdiev9"><div class="tabs svelte-1cdiev9"><button><span class="icon svelte-1cdiev9">â¡</span> OpenAI</button> <button><span class="icon svelte-1cdiev9">ð§ </span> Anthropic</button> <button><span class="icon svelte-1cdiev9">âï¸</span> xAI</button></div> <div class="field mt svelte-1cdiev9"><label for="api-key" class="svelte-1cdiev9"> </label> <div class="input-row svelte-1cdiev9"><input id="api-key" type="password" placeholder="Enter your API key..." autocomplete="off" class="svelte-1cdiev9"/></div> <div class="hint svelte-1cdiev9"> </div></div> <div class="field svelte-1cdiev9"><label for="model-select" class="svelte-1cdiev9">Select Model</label> <select id="model-select" class="svelte-1cdiev9"></select> <!></div> <button class="btn primary load-btn svelte-1cdiev9"> </button> <!></div>');function k0(t,e){at(e,!0);let n=Ae(e,"selectedModel",15),r=Ae(e,"error",15,null),a=Pe("openai"),s=Wt({openai:"",anthropic:"",xai:""}),i=Pe(!1),l=J(()=>La.filter(I=>I.provider===o(a)));_n(async()=>{var X;s.openai=await wa("openaiApiKey")||"",s.anthropic=await wa("anthropicApiKey")||"",s.xai=await wa("xaiApiKey")||"";const I=La.find(Y=>Y.id===n());I?P(a,I.provider,!0):(P(a,"openai"),n((X=o(l)[0])==null?void 0:X.id))}),yn(()=>{var I;La.filter(X=>X.provider===o(a)).some(X=>X.id===n())||n((I=La.filter(X=>X.provider===o(a))[0])==null?void 0:I.id)});async function u(){if(!s[o(a)]){r(`API key for ${o(a)} is required`);return}r(null),P(i,!0),await ii(`${o(a)}ApiKey`,s[o(a)]),P(i,!1),e.onload()}var d=x0(),v=_(d),p=_(v);let h;p.__click=()=>P(a,"openai");var m=b(p,2);let x;m.__click=()=>P(a,"anthropic");var k=b(m,2);let E;k.__click=()=>P(a,"xai");var N=b(v,2),j=_(N),V=_(j),S=b(j,2),K=_(S),B=b(S,2),O=_(B),Q=b(N,2),se=b(_(Q),2);Ot(se,21,()=>o(l),Ut,(I,X)=>{var Y=y0(),Z=_(Y),U=b(Z);{var te=H=>{var G=on("â");C(H,G)};ue(U,H=>{o(X).recommendedForEmailProcessing&&H(te)})}var ie={};oe(()=>{ee(Z,`${o(X).displayName??""} `),ie!==(ie=o(X).id)&&(Y.value=(Y.__value=o(X).id)??"")}),C(I,Y)});var xe=b(se,2);{var z=I=>{const X=J(()=>o(l).find(te=>te.id===n()));var Y=an(),Z=Ye(Y);{var U=te=>{var ie=b0(),H=_(ie),G=b(H);{var re=ae=>{var pe=_0();C(ae,pe)};ue(G,ae=>{o(X).recommendedForEmailProcessing||ae(re)})}oe(ae=>ee(H,`${o(X).description??""}. Context window: ${ae??""} tokens. `),[()=>o(X).contextWindow.toLocaleString()]),C(te,ie)};ue(Z,te=>{o(X)&&te(U)})}C(I,Y)};ue(xe,I=>{n()&&I(z)})}var M=b(Q,2);M.__click=u;var q=_(M),T=b(M,2);{var D=I=>{var X=w0(),Y=_(X);oe(()=>ee(Y,r())),C(I,X)};ue(T,I=>{r()&&I(D)})}oe((I,X)=>{h=St(p,1,"tab-btn svelte-1cdiev9",null,h,{active:o(a)==="openai"}),x=St(m,1,"tab-btn svelte-1cdiev9",null,x,{active:o(a)==="anthropic"}),E=St(k,1,"tab-btn svelte-1cdiev9",null,E,{active:o(a)==="xai"}),ee(V,`${I??""} API Key`),ee(O,`Your key is stored locally in your browser's IndexedDB and never sent anywhere except directly to ${X??""}.`),M.disabled=o(i)||!s[o(a)],ee(q,o(i)?"Checking...":"Load Model")},[()=>o(a).toUpperCase(),()=>o(a).toUpperCase()]),Zr(K,()=>s[o(a)],I=>s[o(a)]=I),pi(se,n),C(t,d),st()}Xt(["click"]);var S0=L('<span class="progress-percent svelte-r5fnze"> </span>'),E0=L('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),A0=L('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),T0=L('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),C0=L('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),I0=L('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),P0=L('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function M0(t,e){at(e,!0);let n=Ae(e,"message",3,""),r=Ae(e,"items",19,()=>[]);_n(()=>dr("LoadingProgress"));var a=P0(),s=_(a),i=_(s),l=b(s,2);Ot(l,17,r,Ut,(u,d)=>{const v=J(()=>o(d).total?X_(o(d).loaded||0,o(d).total):null);var p=I0(),h=_(p),m=_(h),x=_(m),k=b(m,2);{var E=S=>{var K=S0(),B=_(K);oe(O=>ee(B,`${O??""}%`),[()=>o(v).toFixed(1)]),C(S,K)};ue(k,S=>{o(v)!==null&&S(E)})}var N=b(h,2);{var j=S=>{var K=E0(),B=Ye(K),O=_(B),Q=b(B,2),se=_(Q),xe=_(se),z=b(se,4),M=_(z),q=b(z,2),T=_(q);oe((D,I,X,Y,Z)=>{Dt(O,`width: ${D??""}%`),ee(xe,I),ee(M,X),ee(T,`(${Y??""} / ${Z??""} B)`)},[()=>Math.max(o(d).progress??0,.5).toFixed(1),()=>Vc(o(d).loaded||0),()=>Vc(o(d).total),()=>(o(d).loaded||0).toLocaleString(),()=>o(d).total.toLocaleString()]),C(S,K)},V=S=>{var K=C0(),B=b(Ye(K),2),O=_(B);{var Q=xe=>{var z=A0(),M=Ye(z),q=_(M),T=b(M,2),D=_(T);oe((I,X)=>{ee(q,I),ee(D,`(${X??""} B)`)},[()=>Vc(o(d).loaded),()=>o(d).loaded.toLocaleString()]),C(xe,z)},se=xe=>{var z=T0();C(xe,z)};ue(O,xe=>{o(d).loaded?xe(Q):xe(se,!1)})}C(S,K)};ue(N,S=>{o(d).total?S(j):S(V,!1)})}oe(()=>{xt(m,"title",o(d).file),ee(x,o(d).file)}),C(u,p)}),oe(()=>ee(i,n())),C(t,a),st()}var O0=L('<span class="thinking-tokens svelte-11gjw00"> </span>'),N0=L('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),D0=L('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),R0=L('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),L0=L('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),j0=L('<span class="cursor svelte-11gjw00">|</span>'),z0=L(" <!>",1),q0=L('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),B0=L('<div class="content svelte-11gjw00"> </div>'),F0=L('<div><div class="role svelte-11gjw00"> </div> <!></div>');function K0(t,e){at(e,!0);let n=Ae(e,"isLast",3,!1),r=Ae(e,"isRunning",3,!1),a=Ae(e,"generationPhase",3,null),s=Ae(e,"numTokens",3,null);_n(()=>dr(`MessageBubble[${e.msg.role}]`));var i=F0(),l=_(i),u=_(l),d=b(l,2);{var v=h=>{var m=q0(),x=Ye(m);{var k=O=>{var Q=N0(),se=b(_(Q),4);{var xe=z=>{var M=O0(),q=_(M);oe(()=>ee(q,`${s()??""} tokens`)),C(z,M)};ue(se,z=>{s()&&z(xe)})}C(O,Q)},E=O=>{var Q=D0();C(O,Q)};ue(x,O=>{r()&&n()&&a()==="thinking"?O(k):r()&&n()&&a()==="preparing"&&O(E,1)})}var N=b(x,2);{var j=O=>{var Q=R0(),se=_(Q),xe=b(_(se),2),z=_(xe),M=b(se,2),q=_(M);oe(T=>{ee(z,`${T??""} words`),ee(q,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),C(O,Q)};ue(N,O=>{e.msg.thinking&&O(j)})}var V=b(N,2),S=_(V);{var K=O=>{var Q=L0();C(O,Q)},B=O=>{var Q=z0(),se=Ye(Q,!0),xe=b(se);{var z=M=>{var q=j0();C(M,q)};ue(xe,M=>{r()&&n()&&M(z)})}oe(()=>ee(se,e.msg.content)),C(O,Q)};ue(S,O=>{r()&&n()&&!e.msg.content&&a()!=="thinking"?O(K):O(B,!1)})}C(h,m)},p=h=>{var m=B0(),x=_(m);oe(()=>ee(x,e.msg.content)),C(h,m)};ue(d,h=>{e.msg.role==="assistant"?h(v):h(p,!1)})}oe(()=>{St(i,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ee(u,e.msg.role==="user"?"You":"AI")}),C(t,i),st()}Xt(["click"]);var H0=L('<div class="group svelte-1fa8qqq"> </div>'),G0=L('<div class="binding svelte-1fa8qqq"> </div>'),U0=L('<div class="binding unbound svelte-1fa8qqq">unbound</div>'),V0=L('<div class="connector svelte-1fa8qqq"><div class="line svelte-1fa8qqq"></div> <div class="arrow svelte-1fa8qqq">â¶</div></div> <div class="node action-node svelte-1fa8qqq"><div class="node-header action-header svelte-1fa8qqq"><span class="icon"> </span> </div> <div class="node-body svelte-1fa8qqq"><div class="desc svelte-1fa8qqq"> </div> <!></div></div>',1),W0=L('<div class="pipeline-graph svelte-1fa8qqq"><div class="node trigger-node svelte-1fa8qqq"><div class="node-header svelte-1fa8qqq"><span class="icon">â¡</span> Trigger</div> <div class="node-body svelte-1fa8qqq"><div class="label svelte-1fa8qqq"> </div> <!></div></div> <!></div>');function vl(t,e){at(e,!0);let n=Ae(e,"commands",19,()=>[]);Ae(e,"executionState",3,null);let r=J(()=>e.group?nr[e.group]:nr.INFO);var a=W0(),s=_(a);let i;var l=_(s);let u;var d=b(l,2),v=_(d),p=_(v),h=b(v,2);{var m=k=>{var E=H0();let N;var j=_(E);oe(()=>{N=Dt(E,"",N,{color:o(r).color}),ee(j,o(r).label)}),C(k,E)};ue(h,k=>{o(r)&&k(m)})}var x=b(s,2);Ot(x,17,n,Ut,(k,E)=>{var N=V0(),j=b(Ye(N),2),V=_(j),S=_(V),K=_(S),B=b(S),O=b(V,2),Q=_(O),se=_(Q),xe=b(Q,2);{var z=q=>{var T=G0(),D=_(T);oe(()=>ee(D,`${o(E).pluginId??""}Â·${o(E).commandId??""}`)),C(q,T)},M=q=>{var T=U0();C(q,T)};ue(xe,q=>{o(E).pluginId&&o(E).commandId?q(z):q(M,!1)})}oe(()=>{ee(K,o(E).icon||"âï¸"),ee(B,` ${o(E).name??""}`),xt(Q,"title",o(E).description),ee(se,o(E).description)}),C(k,N)}),oe(()=>{var k,E;i=Dt(s,"",i,{"border-color":(k=o(r))==null?void 0:k.color}),u=Dt(l,"",u,{background:(E=o(r))==null?void 0:E.color}),ee(p,e.eventType)}),C(t,a),st()}const ev="https://accounts.google.com/gsi/client",Y0="https://www.googleapis.com/auth/gmail.modify",Td="me-ai:oauth-token",Cd=300*1e3;let $i=null,Yi=null,Ha=0;async function Vp(t,e){Ha=Date.now()+e*1e3;const{setSetting:n}=await Ln(async()=>{const{setSetting:r}=await Promise.resolve().then(()=>Sa);return{setSetting:r}},void 0);await n(Td,{access_token:t,expires_at:Ha})}async function Ou(){Ha=0;const{removeSetting:t}=await Ln(async()=>{const{removeSetting:e}=await Promise.resolve().then(()=>Sa);return{removeSetting:e}},void 0);await t(Td)}async function tc(){try{const{getSetting:t}=await Ln(async()=>{const{getSetting:a}=await Promise.resolve().then(()=>Sa);return{getSetting:a}},void 0),e=await t(Td);if(!e)return null;const{access_token:n,expires_at:r}=e;return!n||Date.now()>r-Cd?(await Ou(),null):(Ha=r,{access_token:n})}catch{return await Ou(),null}}function X0(){return Ha>0&&Date.now()<Ha-Cd}function Z0(){return Ha<=0?0:Math.max(0,Ha-Cd-Date.now())}function tv(){return new Promise((t,e)=>{if(!$i){e(new Error("Google Auth not initialized."));return}Yi=async n=>{n.error?e(new Error(n.error_description||n.error)):(await Vp(n.access_token,n.expires_in),t({access_token:n.access_token,expires_in:n.expires_in}))},$i.requestAccessToken({prompt:""})})}function Q0(){return new Promise((t,e)=>{var a,s;if((s=(a=window.google)==null?void 0:a.accounts)!=null&&s.oauth2){t();return}const n=document.querySelector(`script[src="${ev}"]`);if(n){n.addEventListener("load",()=>t()),n.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const r=document.createElement("script");r.src=ev,r.async=!0,r.defer=!0,r.onload=()=>t(),r.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(r)})}async function nv(t){await Q0(),$i=google.accounts.oauth2.initTokenClient({client_id:t,scope:Y0,callback:e=>{Yi&&(Yi(e),Yi=null)}})}function J0(){return new Promise((t,e)=>{if(!$i){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Yi=async n=>{n.error?e(new Error(n.error_description||n.error)):(await Vp(n.access_token,n.expires_in),t({access_token:n.access_token,expires_in:n.expires_in}))},$i.requestAccessToken()})}async function $0(t){return await Ou(),new Promise(e=>{var n,r;(r=(n=window.google)==null?void 0:n.accounts)!=null&&r.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}async function Wp(t,e,n=!1){try{e==null||e({phase:"starting",event:t});const r=await zp(t.type);if(e==null||e({phase:"policy_check",group:r.group,policy:r}),r.requiresApproval&&!n){const d=await jr(t.type);return{success:!1,requiresApproval:!0,group:r.group,actions:d,message:"This event type is CRITICAL â review the actions below and confirm before executing."}}const a=await tc();if(!(a!=null&&a.access_token))throw new Error("Not authenticated. Please sign in to Gmail first.");const s=a.access_token,i=await jr(t.type);if(!i||i.length===0)return{success:!0,message:`No actions defined for event type: ${t.type}`,results:[]};e==null||e({phase:"pipeline_loaded",actions:i,actionCount:i.length});const l={accessToken:s,event:t,onProgress:e},u=await mi.executePipeline(i,l);return e==null||e({phase:"done",result:u}),u}catch(r){return e==null||e({phase:"error",error:r.message}),{success:!1,error:r,message:r.message||"Unknown error"}}}async function Yp(t,e,n,r=!1){try{n==null||n({phase:"starting",eventType:t,eventCount:e.length});const a=await zp(t);if(a.requiresApproval&&!r){const p=await jr(t);return{success:!1,requiresApproval:!0,group:a.group,actions:p,total:e.length,successful:0,failed:0,message:"This event type is CRITICAL â review the actions below and confirm before executing."}}const s=await tc();if(!(s!=null&&s.access_token))throw new Error("Not authenticated. Please sign in to Gmail first.");const i=s.access_token,l=await jr(t);if(!l||l.length===0)return{success:!0,message:`No actions defined for event type: ${t}`,results:[],total:0,successful:0,failed:0};n==null||n({phase:"pipeline_loaded",actions:l,actionCount:l.length});const u=e.map(p=>({type:t,source:"gmail",data:p})),d={accessToken:i,onProgress:n},v=await mi.executePipelineBatch(l,u,d);return n==null||n({phase:"done",result:v}),v}catch(a){return n==null||n({phase:"error",error:a.message}),{success:!1,error:a,message:a.message||"Unknown error",total:e.length,successful:0,failed:e.length}}}function Xp(t){return mi.getAvailableActions(t)}async function Nu(){const t=await tc();return!!(t!=null&&t.access_token)}const ew=Object.freeze(Object.defineProperty({__proto__:null,EVENT_GROUPS:nr,executePipeline:Wp,executePipelineBatch:Yp,getAvailableActions:Xp,isAuthenticated:Nu},Symbol.toStringTag,{value:"Module"}));var tw=L('<div class="event-subject svelte-1w66m1k"> </div>'),nw=L('<span class="sep svelte-1w66m1k">Â·</span> ',1),rw=L('<div class="event-summary svelte-1w66m1k"> </div>'),aw=L('<span class="tag svelte-1w66m1k"> </span>'),sw=L('<div class="event-tags svelte-1w66m1k"></div>'),iw=L('<div class="event-reason svelte-1w66m1k"> </div>'),ow=L("<button><!></button>"),lw=L('<div class="approval-card compact svelte-1w66m1k"><span class="approval-icon svelte-1w66m1k">â ï¸</span> <span class="approval-title svelte-1w66m1k">Confirm execution?</span> <div class="approval-btns svelte-1w66m1k"><button class="approval-confirm svelte-1w66m1k">Confirm</button> <button class="approval-cancel svelte-1w66m1k">Cancel</button></div></div>'),cw=L("<div> </div>"),uw=L('<div class="pipeline-header svelte-1w66m1k" style="margin-top: 0.5rem;"><span class="pipeline-label svelte-1w66m1k">Action Pipeline</span> <!></div> <!> <div class="pipeline-steps-wrapper" style="margin-top: 0.3rem;"><!></div> <!>',1),dw=L('<div class="event-msg svelte-1w66m1k"><div class="event-card svelte-1w66m1k"><div class="event-head svelte-1w66m1k"><span class="event-type svelte-1w66m1k"> </span> <span class="event-source svelte-1w66m1k"> </span></div> <!> <div class="event-meta svelte-1w66m1k"><!> <!></div> <!> <!> <!></div> <!></div>'),fw=L('<span class="event-subject-inline svelte-1w66m1k"> </span>'),vw=L('<span class="sep svelte-1w66m1k">Â·</span> ',1),hw=L('<div class="event-summary svelte-1w66m1k"> </div>'),pw=L('<div class="event-msg compact svelte-1w66m1k"><div class="event-card svelte-1w66m1k"><div class="event-head svelte-1w66m1k"><span class="event-type svelte-1w66m1k"> </span> <!></div> <div class="event-meta svelte-1w66m1k"><!> <!></div> <!></div> <div class="pipeline-steps-wrapper" style="margin-top: 0.3rem;"><!></div></div>'),gw=L('<div class="event-batch svelte-1w66m1k"><div class="batch-head svelte-1w66m1k"><span class="batch-title svelte-1w66m1k"> </span></div> <!></div>'),mw=L('<span class="group-tier-chip svelte-1w66m1k"> </span>'),yw=L("<button><!></button>"),_w=L("<span> </span>"),bw=L('<span class="approval-action-desc svelte-1w66m1k"> </span>'),ww=L("<li><!> <strong> </strong> <!></li>"),xw=L('<ul class="approval-actions svelte-1w66m1k"></ul>'),kw=L(`<div class="approval-card svelte-1w66m1k"><div class="approval-header svelte-1w66m1k"><span class="approval-icon svelte-1w66m1k">â ï¸</span> <span class="approval-title svelte-1w66m1k">Review required â this is a CRITICAL event type</span></div> <p class="approval-body svelte-1w66m1k">The following actions will run on <strong> </strong>.
              This changes email state and cannot be undone easily.</p> <!> <div class="approval-btns svelte-1w66m1k"><button class="approval-confirm svelte-1w66m1k">â Confirm & Execute</button> <button class="approval-cancel svelte-1w66m1k">Cancel</button></div></div>`),Sw=L("<div> </div>"),Ew=L('<span class="email-from svelte-1w66m1k"> </span>'),Aw=L('<span class="sep svelte-1w66m1k">Â·</span><span class="email-date svelte-1w66m1k"> </span>',1),Tw=L('<div class="email-summary svelte-1w66m1k"> </div>'),Cw=L('<span class="tag svelte-1w66m1k"> </span>'),Iw=L('<div class="email-tags svelte-1w66m1k"></div>'),Pw=L("<button><!></button>"),Mw=L('<div class="approval-card compact svelte-1w66m1k"><span class="approval-icon svelte-1w66m1k">â ï¸</span> <span class="approval-title svelte-1w66m1k">Confirm execution?</span> <div class="approval-btns svelte-1w66m1k"><button class="approval-confirm svelte-1w66m1k">Confirm</button> <button class="approval-cancel svelte-1w66m1k">Cancel</button></div></div>'),Ow=L('<div class="pipeline-steps-wrapper" style="margin-top: 0.3rem;"><!></div>'),Nw=L('<div class="pipeline-empty svelte-1w66m1k">No actions defined â configure in Control Board</div>'),Dw=L("<div> </div>"),Rw=L('<div class="email-item svelte-1w66m1k"><div class="email-main svelte-1w66m1k"><div class="email-subject svelte-1w66m1k"> </div> <div class="email-meta svelte-1w66m1k"><!> <!></div> <!> <!></div> <div class="email-pipeline svelte-1w66m1k"><div class="pipeline-header svelte-1w66m1k"><span class="pipeline-label svelte-1w66m1k">Action Pipeline</span> <!></div> <!> <!> <!></div></div>'),Lw=L('<div class="group-emails svelte-1w66m1k"></div>'),jw=L('<div class="group-block svelte-1w66m1k"><div class="group-header-row svelte-1w66m1k"><button class="group-header svelte-1w66m1k"><span class="group-badge svelte-1w66m1k"> </span> <!> <span class="group-count svelte-1w66m1k"> </span> <span class="spacer svelte-1w66m1k"></span> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div> <!> <!> <!></div>'),zw=L('<div class="events-grouped svelte-1w66m1k"><div class="grouped-head svelte-1w66m1k"><span class="grouped-title svelte-1w66m1k">Events</span> <span class="grouped-stat svelte-1w66m1k"> </span></div> <!></div>');function qw(t,e){at(e,!0);let n=Pe(Wt({})),r=Wt({}),a=Pe(Wt({}));function s(S){if(!S)return"â";const K=S.replace(/<.*>/,"").trim();return K.length>40?K.slice(0,38)+"â¦":K}function i(S){if(!S)return"";try{return new Date(S).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch{return""}}async function l(S,K,B=!1){if(!await Nu()){alert("Please sign in to Gmail first (Dashboard page)");return}const O=`single_${K}`;r[O]={running:!0,progress:null,result:null};try{const Q=await Wp(S,se=>{r[O]={...r[O],progress:se}},B);if(Q.requiresApproval){r[O]={running:!1,progress:null,result:null},o(a)[O]={event:S,emailId:K,actions:Q.actions,group:Q.group,isBatch:!1};return}r[O]={running:!1,progress:null,result:Q}}catch(Q){r[O]={running:!1,progress:null,result:{success:!1,message:Q.message}}}}async function u(S,K,B=!1){if(!await Nu()){alert("Please sign in to Gmail first (Dashboard page)");return}const O=`batch_${S}`;r[O]={running:!0,progress:null,result:null};try{const Q=await Yp(S,K,se=>{r[O]={...r[O],progress:se}},B);if(Q.requiresApproval){r[O]={running:!1,progress:null,result:null},o(a)[O]={eventType:S,emails:K,actions:Q.actions,group:Q.group,isBatch:!0};return}r[O]={running:!1,progress:null,result:Q}}catch(Q){r[O]={running:!1,progress:null,result:{success:!1,message:Q.message}}}}async function d(S){const K=o(a)[S];K&&(delete o(a)[S],P(a,{...o(a)},!0),K.isBatch?await u(K.eventType,K.emails,!0):await l(K.event,K.emailId,!0))}function v(S){delete o(a)[S],P(a,{...o(a)},!0)}function p(S){P(n,{...o(n),[S]:!o(n)[S]},!0)}function h(S){return S.split("_").map(K=>K.charAt(0)+K.slice(1).toLowerCase()).join(" ")}function m(S){return`hsl(${Ql(S)}, 55%, 55%)`}function x(S){return r[S]}var k=an(),E=Ye(k);{var N=S=>{var K=dw(),B=_(K),O=_(B),Q=_(O),se=_(Q),xe=b(Q,2),z=_(xe),M=b(O,2);{var q=pe=>{var _e=tw(),ne=_(_e);oe(()=>ee(ne,e.msg.event.data.subject)),C(pe,_e)};ue(M,pe=>{var _e;(_e=e.msg.event.data)!=null&&_e.subject&&pe(q)})}var T=b(M,2),D=_(T);{var I=pe=>{var _e=on();oe(ne=>ee(_e,ne),[()=>s(e.msg.event.data.from)]),C(pe,_e)};ue(D,pe=>{var _e;(_e=e.msg.event.data)!=null&&_e.from&&pe(I)})}var X=b(D,2);{var Y=pe=>{var _e=nw(),ne=b(Ye(_e),1,!0);oe($=>ee(ne,$),[()=>i(e.msg.event.data.date)]),C(pe,_e)};ue(X,pe=>{var _e;(_e=e.msg.event.data)!=null&&_e.date&&pe(Y)})}var Z=b(T,2);{var U=pe=>{var _e=rw(),ne=_(_e);oe(()=>ee(ne,e.msg.event.metadata.summary)),C(pe,_e)};ue(Z,pe=>{var _e;(_e=e.msg.event.metadata)!=null&&_e.summary&&pe(U)})}var te=b(Z,2);{var ie=pe=>{var _e=sw();Ot(_e,21,()=>e.msg.event.metadata.tags,Ut,(ne,$)=>{var ke=aw(),be=_(ke);oe(()=>ee(be,o($))),C(ne,ke)}),C(pe,_e)};ue(te,pe=>{var _e,ne;(ne=(_e=e.msg.event.metadata)==null?void 0:_e.tags)!=null&&ne.length&&pe(ie)})}var H=b(te,2);{var G=pe=>{var _e=iw(),ne=_(_e);oe(()=>ee(ne,e.msg.event.metadata.reason)),C(pe,_e)};ue(H,pe=>{var _e;(_e=e.msg.event.metadata)!=null&&_e.reason&&pe(G)})}var re=b(B,2);{var ae=pe=>{const _e=J(()=>`single_${e.msg.event.data.emailId||Date.now()}`),ne=J(()=>x(o(_e))),$=J(()=>o(a)[o(_e)]),ke=J(()=>{var Ke;return(Ke=e.msg.event.metadata)!=null&&Ke.group?nr[e.msg.event.metadata.group]:null});var be=uw(),Me=Ye(be),Xe=b(_(Me),2);{var Je=Ke=>{var $e=ow();let Ze;$e.__click=()=>l(e.msg.event,e.msg.event.data.emailId);var Ge=_($e);{var tt=vt=>{var kt=on("â³ Running...");C(vt,kt)},nt=vt=>{var kt=on();oe(()=>ee(kt,o(ne).result.success?"â Done":"â Failed")),C(vt,kt)},ft=vt=>{var kt=on("ð Review");C(vt,kt)},mt=vt=>{var kt=on("â¶ Execute");C(vt,kt)};ue(Ge,vt=>{var kt,bt,pt;(kt=o(ne))!=null&&kt.running?vt(tt):(bt=o(ne))!=null&&bt.result?vt(nt,1):(pt=o(ke))!=null&&pt.requiresApproval?vt(ft,2):vt(mt,!1)})}oe(()=>{var vt,kt;Ze=St($e,1,"execute-btn svelte-1w66m1k",null,Ze,{critical:(vt=o(ke))==null?void 0:vt.requiresApproval}),$e.disabled=(kt=o(ne))==null?void 0:kt.running}),C(Ke,$e)};ue(Xe,Ke=>{o($)||Ke(Je)})}var ct=b(Me,2);{var De=Ke=>{var $e=lw(),Ze=b(_($e),4),Ge=_(Ze);Ge.__click=()=>d(o(_e));var tt=b(Ge,2);tt.__click=()=>v(o(_e)),C(Ke,$e)};ue(ct,Ke=>{o($)&&Ke(De)})}var Oe=b(ct,2),qe=_(Oe);{let Ke=J(()=>{var $e;return($e=e.msg.event.metadata)==null?void 0:$e.group});vl(qe,{get eventType(){return e.msg.event.type},get group(){return o(Ke)},get commands(){return e.msg.commands}})}var Ne=b(Oe,2);{var Fe=Ke=>{var $e=cw();let Ze;var Ge=_($e);oe(()=>{Ze=St($e,1,"execution-result svelte-1w66m1k",null,Ze,{success:o(ne).result.success,error:!o(ne).result.success}),ee(Ge,o(ne).result.message)}),C(Ke,$e)};ue(Ne,Ke=>{var $e;($e=o(ne))!=null&&$e.result&&Ke(Fe)})}C(pe,be)};ue(re,pe=>{var _e;(_e=e.msg.commands)!=null&&_e.length&&pe(ae)})}oe(()=>{ee(se,e.msg.event.type),ee(z,e.msg.event.source)}),C(S,K)},j=S=>{var K=gw(),B=_(K),O=_(B),Q=_(O),se=b(B,2);Ot(se,17,()=>e.msg.items,Ut,(xe,z)=>{var M=pw(),q=_(M),T=_(q),D=_(T),I=_(D),X=b(D,2);{var Y=_e=>{var ne=fw(),$=_(ne);oe(()=>ee($,o(z).event.data.subject)),C(_e,ne)};ue(X,_e=>{var ne;(ne=o(z).event.data)!=null&&ne.subject&&_e(Y)})}var Z=b(T,2),U=_(Z);{var te=_e=>{var ne=on();oe($=>ee(ne,$),[()=>s(o(z).event.data.from)]),C(_e,ne)};ue(U,_e=>{var ne;(ne=o(z).event.data)!=null&&ne.from&&_e(te)})}var ie=b(U,2);{var H=_e=>{var ne=vw(),$=b(Ye(ne),1,!0);oe(ke=>ee($,ke),[()=>i(o(z).event.data.date)]),C(_e,ne)};ue(ie,_e=>{var ne;(ne=o(z).event.data)!=null&&ne.date&&_e(H)})}var G=b(Z,2);{var re=_e=>{var ne=hw(),$=_(ne);oe(()=>ee($,o(z).event.metadata.summary)),C(_e,ne)};ue(G,_e=>{var ne;(ne=o(z).event.metadata)!=null&&ne.summary&&_e(re)})}var ae=b(q,2),pe=_(ae);{let _e=J(()=>{var ne;return(ne=o(z).event.metadata)==null?void 0:ne.group});vl(pe,{get eventType(){return o(z).event.type},get group(){return o(_e)},get commands(){return o(z).commands}})}oe(()=>ee(I,o(z).event.type)),C(xe,M)}),oe(()=>ee(Q,`Processed ${e.msg.items.length??""} email${e.msg.items.length===1?"":"s"}`)),C(S,K)},V=S=>{var K=zw(),B=_(K),O=b(_(B),2),Q=_(O),se=b(B,2);Ot(se,17,()=>e.msg.groups,Ut,(xe,z)=>{const M=J(()=>o(n)[o(z).eventType]??!0),q=J(()=>`batch_${o(z).eventType}`),T=J(()=>x(o(q))),D=J(()=>o(a)[o(q)]),I=J(()=>o(z).group?nr[o(z).group]:null);var X=jw(),Y=_(X),Z=_(Y);Z.__click=()=>p(o(z).eventType);var U=_(Z);let te;var ie=_(U),H=b(U,2);{var G=De=>{var Oe=mw();let qe;var Ne=_(Oe);oe(()=>{xt(Oe,"title",o(I).description),qe=Dt(Oe,"",qe,{color:o(I).color}),ee(Ne,o(I).label)}),C(De,Oe)};ue(H,De=>{o(I)&&De(G)})}var re=b(H,2),ae=_(re),pe=b(re,4);let _e;var ne=b(Z,2);{var $=De=>{var Oe=yw();let qe;Oe.__click=Ge=>{Ge.stopPropagation(),u(o(z).eventType,o(z).emails)};var Ne=_(Oe);{var Fe=Ge=>{var tt=on("â³ Running...");C(Ge,tt)},Ke=Ge=>{var tt=on();oe(()=>ee(tt,o(T).result.success?`â Done (${o(T).result.successful}/${o(T).result.total})`:"â Failed")),C(Ge,tt)},$e=Ge=>{var tt=on();oe(()=>ee(tt,`ð Review & Execute (${o(z).emails.length??""})`)),C(Ge,tt)},Ze=Ge=>{var tt=on();oe(()=>ee(tt,`â¶ Execute All (${o(z).emails.length??""})`)),C(Ge,tt)};ue(Ne,Ge=>{var tt,nt,ft;(tt=o(T))!=null&&tt.running?Ge(Fe):(nt=o(T))!=null&&nt.result?Ge(Ke,1):(ft=o(I))!=null&&ft.requiresApproval?Ge($e,2):Ge(Ze,!1)})}oe(()=>{var Ge,tt;qe=St(Oe,1,"execute-all-btn svelte-1w66m1k",null,qe,{critical:(Ge=o(I))==null?void 0:Ge.requiresApproval}),Oe.disabled=(tt=o(T))==null?void 0:tt.running}),C(De,Oe)};ue(ne,De=>{o(D)||De($)})}var ke=b(Y,2);{var be=De=>{var Oe=kw(),qe=b(_(Oe),2),Ne=b(_(qe)),Fe=_(Ne),Ke=b(qe,2);{var $e=nt=>{var ft=xw();Ot(ft,21,()=>o(D).actions,Ut,(mt,vt)=>{var kt=ww(),bt=_(kt);{var pt=At=>{var Gt=_w(),Re=_(Gt);oe(()=>ee(Re,o(vt).icon)),C(At,Gt)};ue(bt,At=>{o(vt).icon&&At(pt)})}var yt=b(bt,2),dt=_(yt),je=b(yt,2);{var Rt=At=>{var Gt=bw(),Re=_(Gt);oe(()=>ee(Re,`â ${o(vt).description??""}`)),C(At,Gt)};ue(je,At=>{o(vt).description&&At(Rt)})}oe(()=>ee(dt,o(vt).name)),C(mt,kt)}),C(nt,ft)};ue(Ke,nt=>{var ft;(ft=o(D).actions)!=null&&ft.length&&nt($e)})}var Ze=b(Ke,2),Ge=_(Ze);Ge.__click=()=>d(o(q));var tt=b(Ge,2);tt.__click=()=>v(o(q)),oe(()=>ee(Fe,`${o(z).emails.length??""} email${o(z).emails.length===1?"":"s"}`)),C(De,Oe)};ue(ke,De=>{o(D)&&De(be)})}var Me=b(ke,2);{var Xe=De=>{var Oe=Sw();let qe;var Ne=_(Oe);oe(()=>{qe=St(Oe,1,"batch-result svelte-1w66m1k",null,qe,{success:o(T).result.success,error:!o(T).result.success}),ee(Ne,o(T).result.message)}),C(De,Oe)};ue(Me,De=>{var Oe;(Oe=o(T))!=null&&Oe.result&&!o(D)&&De(Xe)})}var Je=b(Me,2);{var ct=De=>{var Oe=Lw();Ot(Oe,21,()=>o(z).emails,Ut,(qe,Ne)=>{const Fe=J(()=>`single_${o(Ne).emailId}`),Ke=J(()=>x(o(Fe))),$e=J(()=>o(a)[o(Fe)]);var Ze=Rw(),Ge=_(Ze),tt=_(Ge),nt=_(tt),ft=b(tt,2),mt=_(ft);{var vt=it=>{var ut=Ew(),Pt=_(ut);oe($t=>ee(Pt,$t),[()=>s(o(Ne).from)]),C(it,ut)};ue(mt,it=>{o(Ne).from&&it(vt)})}var kt=b(mt,2);{var bt=it=>{var ut=Aw(),Pt=b(Ye(ut)),$t=_(Pt);oe(_t=>ee($t,_t),[()=>i(o(Ne).date)]),C(it,ut)};ue(kt,it=>{o(Ne).date&&it(bt)})}var pt=b(ft,2);{var yt=it=>{var ut=Tw(),Pt=_(ut);oe(()=>ee(Pt,o(Ne).summary)),C(it,ut)};ue(pt,it=>{o(Ne).summary&&it(yt)})}var dt=b(pt,2);{var je=it=>{var ut=Iw();Ot(ut,21,()=>o(Ne).tags,Ut,(Pt,$t)=>{var _t=Cw(),jt=_(_t);oe(()=>ee(jt,o($t))),C(Pt,_t)}),C(it,ut)};ue(dt,it=>{var ut;(ut=o(Ne).tags)!=null&&ut.length&&it(je)})}var Rt=b(Ge,2),At=_(Rt),Gt=b(_(At),2);{var Re=it=>{var ut=Pw();let Pt;ut.__click=()=>l({type:o(z).eventType,source:"gmail",data:o(Ne)},o(Ne).emailId);var $t=_(ut);{var _t=Jt=>{var en=on("â³ Running...");C(Jt,en)},jt=Jt=>{var en=on();oe(()=>ee(en,o(Ke).result.success?"â Done":"â Failed")),C(Jt,en)},fn=Jt=>{var en=on("ð Review");C(Jt,en)},cn=Jt=>{var en=on("â¶ Execute");C(Jt,en)};ue($t,Jt=>{var en,jn,On;(en=o(Ke))!=null&&en.running?Jt(_t):(jn=o(Ke))!=null&&jn.result?Jt(jt,1):(On=o(I))!=null&&On.requiresApproval?Jt(fn,2):Jt(cn,!1)})}oe(()=>{var Jt,en;Pt=St(ut,1,"execute-btn svelte-1w66m1k",null,Pt,{critical:(Jt=o(I))==null?void 0:Jt.requiresApproval}),ut.disabled=(en=o(Ke))==null?void 0:en.running}),C(it,ut)};ue(Gt,it=>{o($e)||it(Re)})}var Qt=b(At,2);{var Gn=it=>{var ut=Mw(),Pt=b(_(ut),4),$t=_(Pt);$t.__click=()=>d(o(Fe));var _t=b($t,2);_t.__click=()=>v(o(Fe)),C(it,ut)};ue(Qt,it=>{o($e)&&it(Gn)})}var ye=b(Qt,2);{var ln=it=>{var ut=Ow(),Pt=_(ut);vl(Pt,{get eventType(){return o(z).eventType},get group(){return o(z).group},get commands(){return o(z).commands}}),C(it,ut)},En=it=>{var ut=Nw();C(it,ut)};ue(ye,it=>{var ut;(ut=o(z).commands)!=null&&ut.length?it(ln):it(En,!1)})}var Ct=b(ye,2);{var Mn=it=>{var ut=Dw();let Pt;var $t=_(ut);oe(()=>{Pt=St(ut,1,"execution-result svelte-1w66m1k",null,Pt,{success:o(Ke).result.success,error:!o(Ke).result.success}),ee($t,o(Ke).result.message)}),C(it,ut)};ue(Ct,it=>{var ut;(ut=o(Ke))!=null&&ut.result&&it(Mn)})}oe(()=>ee(nt,o(Ne).subject)),C(qe,Ze)}),C(De,Oe)};ue(Je,De=>{o(M)&&De(ct)})}oe((De,Oe)=>{te=Dt(U,"",te,De),ee(ie,Oe),ee(ae,o(z).emails.length),_e=St(pe,0,"chevron svelte-1w66m1k",null,_e,{open:o(M)})},[()=>({background:m(o(z).eventType)}),()=>h(o(z).eventType)]),C(xe,X)}),oe(()=>ee(Q,`${e.msg.total??""} email${e.msg.total===1?"":"s"} in ${e.msg.groups.length??""} event type${e.msg.groups.length===1?"":"s"}`)),C(S,K)};ue(E,S=>{e.msg.type==="event"?S(N):e.msg.type==="event-batch"?S(j,1):e.msg.type==="events-grouped"&&S(V,2)})}C(t,k),st()}Xt(["click"]);var Bw=L('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),Fw=L('<span class="edate svelte-mt5nvh"> </span>'),Kw=L('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),Hw=L('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),Gw=L('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),Uw=L('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="pipeline-preview" style="margin-bottom: 0.5rem; background: #111; padding: 0.2rem 0.5rem; border-radius: 8px; border: 1px solid #1a1a1a;"><!></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),Vw=L('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function Ww(t,e){at(e,!0);let n=Ae(e,"pendingData",3,null),r=Pe(null),a=Pe(null),s=Pe(Wt([])),i=Pe(null);function l(k){P(r,o(r)===k?null:k,!0),P(a,null)}yn(()=>{o(r)?(jr(o(r)).then(k=>P(s,k,!0)),Ji(o(r)).then(k=>P(i,k,!0))):(P(s,[],!0),P(i,null))});function u(k){return k.split("_").map(E=>E.charAt(0)+E.slice(1).toLowerCase()).join(" ")}function d(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(k){if(!k)return"";const E=k.replace(/<.*>/,"").trim();return E.length>24?E.slice(0,22)+"â¦":E}var p={toggleGroup:l},h=an(),m=Ye(h);{var x=k=>{var E=Vw(),N=_(E),j=_(N),V=b(N,2);Ot(V,20,()=>n().order,B=>B,(B,O)=>{const Q=J(()=>n().groups[O]),se=J(()=>Mu(O)),xe=J(()=>o(r)===O);var z=Bw();let M;z.__click=()=>l(O);let q;var T=_(z);let D;var I=b(T),X=b(I),Y=_(X);oe(Z=>{M=St(z,1,"chip svelte-mt5nvh",null,M,{active:o(xe)}),q=Dt(z,"",q,{"--c":o(se)}),D=Dt(T,"",D,{background:o(se)}),ee(I,` ${Z??""} `),ee(Y,o(Q).length)},[()=>u(O)]),C(B,z)});var S=b(V,2);{var K=B=>{const O=J(()=>n().groups[o(r)]),Q=J(()=>Mu(o(r)));var se=Uw(),xe=_(se);let z;var M=_(xe);M.__click=()=>{P(r,null),P(a,null)};var q=b(M,2),T=_(q),D=b(q,2),I=_(D),X=b(xe,2),Y=_(X);vl(Y,{get eventType(){return o(r)},get group(){return o(i)},get commands(){return o(s)}});var Z=b(X,2);Ot(Z,21,()=>o(O),G=>G.emailId,(G,re)=>{var ae=Kw(),pe=_(ae);pe.__click=()=>{var De;return(De=e.onaskai)==null?void 0:De.call(e,`Tell me about the email "${o(re).subject}" from ${o(re).from}`)};var _e=_(pe),ne=_(_e),$=b(_e,2),ke=_($),be=b(ke);{var Me=De=>{var Oe=Fw(),qe=_(Oe);oe(Ne=>ee(qe,Ne),[()=>d(o(re).date)]),C(De,Oe)};ue(be,De=>{o(re).date&&De(Me)})}var Xe=b(pe,2),Je=_(Xe);Je.__click=()=>{var De;return(De=e.onmarkacted)==null?void 0:De.call(e,o(re).emailId)};var ct=b(Je,2);ct.__click=()=>{var De;return(De=e.ondismiss)==null?void 0:De.call(e,o(re).emailId)},oe(De=>{ee(ne,o(re).subject),ee(ke,De)},[()=>v(o(re).from)]),C(G,ae)});var U=b(Z,2),te=_(U);{var ie=G=>{var re=Hw(),ae=Ye(re);ae.__click=()=>o(O).forEach(_e=>{var ne;return(ne=e.onmarkacted)==null?void 0:ne.call(e,_e.emailId)});var pe=b(ae,2);pe.__click=()=>P(a,o(r),!0),C(G,re)},H=G=>{var re=Gw(),ae=Ye(re),pe=_(ae),_e=b(ae,2);_e.__click=()=>P(a,null);var ne=b(_e,2);ne.__click=()=>{var $;($=e.oncleargroup)==null||$.call(e,o(r)),P(a,null),P(r,null)},oe(()=>ee(pe,`Remove ${o(O).length??""}?`)),C(G,re)};ue(te,G=>{o(a)!==o(r)?G(ie):G(H,!1)})}oe(G=>{z=Dt(xe,"",z,{"border-color":o(Q)}),ee(T,G),ee(I,o(O).length)},[()=>u(o(r))]),C(B,se)};ue(S,B=>{o(r)&&n().groups[o(r)]&&B(K)})}oe(()=>ee(j,`${n().total??""} item${n().total!==1?"s":""} need attention`)),C(k,E)};ue(m,k=>{n()&&n().total>0&&k(x)})}return C(t,h),st(p)}Xt(["click"]);var Yw=L('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),Xw=L('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),Zw=L('<div class="strip svelte-1ed7zw1"><!></div>');function Qw(t,e){let n=Ae(e,"hasScanData",3,!1),r=Ae(e,"engineReady",3,!1),a=Ae(e,"isScanning",3,!1),s=J(()=>r()&&!n()&&!a()),i=J(()=>o(s)||a());var l=an(),u=Ye(l);{var d=v=>{var p=Zw(),h=_(p);{var m=k=>{var E=Yw();C(k,E)},x=k=>{var E=Xw();E.__click=function(...N){var j;(j=e.onscan)==null||j.apply(this,N)},C(k,E)};ue(h,k=>{a()?k(m):o(s)&&k(x,1)})}C(v,p)};ue(u,v=>{o(i)&&v(d)})}C(t,l)}Xt(["click"]);var Jw=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),$w=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),e1=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),t1=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),n1=L('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),r1=L('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),a1=L('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function s1(t,e){at(e,!0),_n(()=>dr("GpuPanel"));var n=a1(),r=_(n),a=b(_(r),2),s=b(_(a),2),i=_(s),l=b(a,2),u=b(_(l),2),d=_(u),v=b(l,2);{var p=S=>{var K=Jw(),B=b(_(K),2),O=_(B);oe(()=>ee(O,e.gpuInfo.device)),C(S,K)};ue(v,S=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&S(p)})}var h=b(v,2);{var m=S=>{var K=$w(),B=b(_(K),2),O=_(B);oe(Q=>ee(O,Q),[()=>Iu(e.gpuInfo.limits.maxBufferSize)]),C(S,K)};ue(h,S=>{var K;(K=e.gpuInfo.limits)!=null&&K.maxBufferSize&&S(m)})}var x=b(h,2);{var k=S=>{var K=e1(),B=b(_(K),2),O=_(B);oe(()=>ee(O,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),C(S,K)};ue(x,S=>{var K;(K=e.gpuInfo.limits)!=null&&K.maxComputeInvocationsPerWorkgroup&&S(k)})}var E=b(x,2);{var N=S=>{var K=t1(),B=b(_(K),2),O=_(B);oe(Q=>ee(O,Q),[()=>Iu(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),C(S,K)};ue(E,S=>{var K;(K=e.gpuInfo.limits)!=null&&K.maxComputeWorkgroupStorageSize&&S(N)})}var j=b(E,2);{var V=S=>{var K=r1(),B=_(K),O=_(B),Q=b(B,2);Ot(Q,21,()=>e.gpuInfo.features,Ut,(se,xe)=>{var z=n1(),M=_(z);oe(()=>ee(M,o(xe))),C(se,z)}),oe(()=>ee(O,`Features (${e.gpuInfo.features.length??""})`)),C(S,K)};ue(j,S=>{var K;(K=e.gpuInfo.features)!=null&&K.length&&S(V)})}oe(()=>{ee(i,e.gpuInfo.vendor),ee(d,e.gpuInfo.architecture)}),C(t,n),st()}var i1=L('<button class="gpu-badge svelte-1ktw27c"> </button>'),o1=L('<span class="backend-badge ollama svelte-1ktw27c">ð¦ Ollama</span>'),l1=L('<span class="backend-badge openai svelte-1ktw27c">â¡ OpenAI</span>'),c1=L('<span class="backend-badge anthropic svelte-1ktw27c">ð§  Anthropic</span>'),u1=L('<span class="backend-badge xai svelte-1ktw27c">âï¸ xAI</span>'),d1=L('<span class="stats svelte-1ktw27c"> </span>'),f1=L('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),v1=L('<span class="stats preparing svelte-1ktw27c"> </span>'),h1=L('<span class="stats svelte-1ktw27c"> </span>'),p1=L('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),g1=L('<button class="btn svelte-1ktw27c">Stop</button>'),m1=L('<button class="btn primary svelte-1ktw27c">Send</button>'),y1=L('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function _1(t,e){at(e,!0),_n(()=>dr("ChatView"));let n=Ae(e,"messages",19,()=>[]),r=Ae(e,"pendingData",3,null),a=Ae(e,"hasScanData",3,!1),s=Ae(e,"engineReady",3,!1),i=Ae(e,"isScanning",3,!1),l=Ae(e,"isRunning",3,!1),u=Ae(e,"tps",3,null),d=Ae(e,"numTokens",3,null),v=Ae(e,"generationPhase",3,null),p=Ae(e,"gpuInfo",3,null),h=Ae(e,"backend",3,"webgpu"),m=Ae(e,"chatContainer",15),x=Pe(""),k=Pe(!1);function E(ne){ne.key==="Enter"&&!ne.shiftKey&&(ne.preventDefault(),N())}function N(){const ne=o(x).trim();!ne||l()||(P(x,""),e.onsend(ne))}function j(ne){ne&&!l()&&e.onsend(ne)}var V=y1(),S=_(V),K=_(S);{var B=ne=>{var $=i1();$.__click=()=>P(k,!o(k));var ke=_($);oe(()=>ee(ke,`WebGPU ${o(k)?"â²":"â¼"}`)),C(ne,$)},O=ne=>{var $=o1();C(ne,$)},Q=ne=>{var $=l1();C(ne,$)},se=ne=>{var $=c1();C(ne,$)},xe=ne=>{var $=u1();C(ne,$)};ue(K,ne=>{p()?ne(B):h()==="ollama"?ne(O,1):h()==="openai"?ne(Q,2):h()==="anthropic"?ne(se,3):h()==="xai"&&ne(xe,4)})}var z=b(K,2);{var M=ne=>{var $=d1(),ke=_($);oe((be,Me)=>ee(ke,`${d()??""} tokens in ${be??""}s
        (${Me??""} tok/s)`),[()=>(d()/u()).toFixed(1),()=>u().toFixed(1)]),C(ne,$)},q=ne=>{var $=f1();C(ne,$)},T=ne=>{var $=v1(),ke=_($);oe(be=>ee(ke,`thinking... ${be??""}`),[()=>u()?`${u().toFixed(0)} tok/s`:""]),C(ne,$)},D=ne=>{var $=h1(),ke=_($);oe(be=>ee(ke,`${be??""} tok/s`),[()=>u().toFixed(1)]),C(ne,$)};ue(z,ne=>{u()&&!l()?ne(M):l()&&v()==="preparing"?ne(q,1):l()&&v()==="thinking"?ne(T,2):u()&&l()&&ne(D,3)})}var I=b(z,4);I.__click=function(...ne){var $;($=e.onreset)==null||$.apply(this,ne)};var X=b(S,2);{var Y=ne=>{s1(ne,{get gpuInfo(){return p()}})};ue(X,ne=>{o(k)&&p()&&ne(Y)})}var Z=b(X,2),U=_(Z);{var te=ne=>{var $=p1();C(ne,$)};ue(U,ne=>{n().length===0&&!(r()&&r().total>0)&&ne(te)})}var ie=b(U,2);Ot(ie,17,n,Ut,(ne,$,ke)=>{var be=an(),Me=Ye(be);{var Xe=De=>{Ww(De,{get pendingData(){return o($).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:j})},Je=De=>{qw(De,{get msg(){return o($)},get oncommand(){return e.oncommand}})},ct=De=>{{let Oe=J(()=>ke===n().length-1);K0(De,{get msg(){return o($)},get isLast(){return o(Oe)},get isRunning(){return l()},get generationPhase(){return v()},get numTokens(){return d()}})}};ue(Me,De=>{o($).type==="dashboard"?De(Xe):o($).type==="event"||o($).type==="event-batch"||o($).type==="events-grouped"?De(Je,1):De(ct,!1)})}C(ne,be)}),Cs(Z,ne=>m(ne),()=>m());var H=b(Z,2);Qw(H,{get hasScanData(){return a()},get engineReady(){return s()},get isScanning(){return i()},get onscan(){return e.onscan}});var G=b(H,2),re=_(G);re.__keydown=E;var ae=b(re,2);{var pe=ne=>{var $=g1();$.__click=function(...ke){var be;(be=e.onstop)==null||be.apply(this,ke)},C(ne,$)},_e=ne=>{var $=m1();$.__click=N,oe(ke=>$.disabled=ke,[()=>!o(x).trim()]),C(ne,$)};ue(ae,ne=>{l()?ne(pe):ne(_e,!1)})}oe(()=>{I.disabled=l(),re.disabled=l()}),Zr(re,()=>o(x),ne=>P(x,ne)),C(t,V),st()}Xt(["click","keydown"]);var b1=L('<div class="container center svelte-1bi93vx"><!> <!></div>');function w1(t,e){at(e,!0);const n=!!navigator.gpu,r=Ep();let a=Pe("webgpu"),s=Pe(Wt($r[0].id)),i=Pe(null),l=Pe(null),u=Pe(""),d=Pe(Wt([])),v=Pe(Wt([])),p=Pe(!1),h=Pe(null),m=Pe(null),x=Pe(null),k=Pe(null),E=Pe(null),N=Pe(null),j=Pe(!1),V=Pe(!1),S=!1;_n(async()=>{const[H,G]=await Promise.all([wa("aiBackend"),wa("selectedModel")]);H&&P(a,H,!0),G&&P(s,G,!0),r.check(),r.isReady&&K();const re=r.onMessage(ae=>{switch(ae.status){case"webgpu-info":P(k,ae.data,!0);break;case"loading":P(i,"loading"),P(u,ae.data,!0);break;case"initiate":P(d,[...o(d),ae],!0);break;case"progress":P(d,o(d).map(pe=>pe.file===ae.file?{...pe,...ae}:pe),!0);break;case"done":P(d,o(d).filter(pe=>pe.file!==ae.file),!0);break;case"ready":P(i,"ready"),K();break;case"start":if(!o(p))break;P(E,ae.phase||"preparing",!0),P(v,[...o(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!o(p))break;P(E,ae.phase,!0);break;case"thinking":{if(!o(p))break;P(h,ae.tps,!0),P(m,ae.numTokens,!0);const pe=o(v)[o(v).length-1];P(v,[...o(v).slice(0,-1),{...pe,thinking:(pe.thinking||"")+ae.content}],!0),q();break}case"thinking-done":{if(!o(p))break;P(h,ae.tps,!0),P(m,ae.numTokens,!0);const pe=o(v)[o(v).length-1];P(v,[...o(v).slice(0,-1),{...pe,thinking:ae.content}],!0);break}case"update":{if(!o(p))break;P(h,ae.tps,!0),P(m,ae.numTokens,!0);const pe=o(v)[o(v).length-1];P(v,[...o(v).slice(0,-1),{...pe,content:pe.content+ae.output}],!0),q();break}case"complete":if(!o(p))break;ae.tps!==void 0&&P(h,ae.tps,!0),ae.numTokens!==void 0&&P(m,ae.numTokens,!0),P(p,!1),P(E,null),B();break;case"error":P(l,ae.data,!0),o(i)==="loading"&&P(i,null),o(p)&&(P(p,!1),P(E,null));break}});return()=>re()});async function K(){if(!(S||o(v).length>0))try{const H=await Zf();P(N,H,!0),H&&(S=!0,P(v,[{role:"assistant",type:"dashboard",pendingData:H}],!0),q());const G=await Pu();P(j,G.classified>0)}catch{}}async function B(){try{const H=await Zf();P(N,H,!0);const G=o(v).findIndex(ae=>ae.type==="dashboard");G!==-1&&(H&&H.total>0?P(v,o(v).map((ae,pe)=>pe===G?{...ae,pendingData:H}:ae),!0):P(v,o(v).filter((ae,pe)=>pe!==G),!0));const re=await Pu();P(j,re.classified>0)}catch{}}async function O(H){await Sl(H,"acted"),await B()}async function Q(H){await Sl(H,"dismissed"),await B()}async function se(H){await Gp(H),await B()}async function xe(H){await Ad(H),await B()}async function z(){if(o(V)||!r.isReady)return;P(V,!0);let H=null;try{if(await Kp(r,{count:20,onProgress:G=>{var re;G.phase==="done"&&((re=G.results)==null?void 0:re.length)>0&&(H=G.results)}}),await B(),(H==null?void 0:H.length)>0){const G=await Eb(H);P(v,[...o(v),G],!0),q()}o(N)&&!o(v).some(G=>G.type==="dashboard")&&(P(v,[{role:"assistant",type:"dashboard",pendingData:o(N)},...o(v)],!0),q())}catch(G){console.error("Scan failed:",G)}finally{P(V,!1)}}function M({event:H,commandId:G}){var re,ae;`${G}${H.type}${((re=H.data)==null?void 0:re.subject)||"unknown"}`,P(v,[...o(v),{role:"assistant",content:`Command: ${G}

This command is not yet implemented. In the future, "${G}" will be executed on the ${H.source} event "${((ae=H.data)==null?void 0:ae.subject)||""}".`}],!0),q()}function q(){op().then(()=>{o(x)&&(o(x).scrollTop=o(x).scrollHeight)})}async function T(){P(i,"loading"),await ii("selectedModel",o(s)),await ii("aiBackend",o(a)),o(a)==="ollama"&&P(k,null),r.loadModel(o(s))}yn(()=>{o(a)==="webgpu"&&!$r.find(H=>H.id===o(s))?P(s,$r[0].id,!0):o(a)==="ollama"&&!ea.find(H=>H.name===o(s))?P(s,ea[0].name,!0):o(a)==="cloud"&&!La.find(H=>H.id===o(s))&&P(s,La[0].id,!0)});async function D(H){if(!H||o(p))return;if(H.trim().toLowerCase()==="/events"){P(v,[...o(v),{role:"user",content:H}],!0);try{const ae=await Hp();if(!ae.order.length)P(v,[...o(v),{role:"assistant",content:"No classified emails yet. Run a scan first from the Actions page."}],!0);else{const pe=await Ab(ae);P(v,[...o(v),pe],!0)}}catch(ae){P(v,[...o(v),{role:"assistant",content:`Failed to load events: ${ae.message}`}],!0)}q();return}P(v,[...o(v),{role:"user",content:H}],!0),P(h,null),P(p,!0);let G=[];try{const pe=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(H)?await db(H):await ub();pe&&(G=[{role:"system",content:pe}])}catch{}const re=o(v).filter(ae=>ae.type!=="dashboard"&&ae.type!=="events-grouped"&&ae.type!=="event-batch"&&ae.type!=="event").map(ae=>({role:ae.role,content:ae.content}));r.generate([...G,...re]),q()}function I(){r.interrupt()}function X(){r.reset(),P(v,[],!0),P(h,null),P(m,null),S=!1,K()}var Y=an(),Z=Ye(Y);{var U=H=>{var G=b1(),re=_(G);Fb(re,{get isWebGPUAvailable(){return n},get backend(){return o(a)},set backend($){P(a,$,!0)}});var ae=b(re,2);{var pe=$=>{e0($,{get gpuInfo(){return o(k)},get error(){return o(l)},onload:T,get selectedModel(){return o(s)},set selectedModel(ke){P(s,ke,!0)}})},_e=$=>{m0($,{onload:T,get selectedModel(){return o(s)},set selectedModel(ke){P(s,ke,!0)},get error(){return o(l)},set error(ke){P(l,ke,!0)}})},ne=$=>{k0($,{onload:T,get selectedModel(){return o(s)},set selectedModel(ke){P(s,ke,!0)},get error(){return o(l)},set error(ke){P(l,ke,!0)}})};ue(ae,$=>{o(a)==="webgpu"?$(pe):o(a)==="ollama"?$(_e,1):o(a)==="cloud"&&$(ne,2)})}C(H,G)},te=H=>{M0(H,{get message(){return o(u)},get items(){return o(d)}})},ie=H=>{{let G=J(()=>{var re;return o(a)==="cloud"?((re=La.find(ae=>ae.id===o(s)))==null?void 0:re.provider)||"cloud":o(a)});_1(H,{get messages(){return o(v)},get pendingData(){return o(N)},get hasScanData(){return o(j)},get engineReady(){return r.isReady},get isScanning(){return o(V)},get isRunning(){return o(p)},get tps(){return o(h)},get numTokens(){return o(m)},get generationPhase(){return o(E)},get gpuInfo(){return o(k)},get backend(){return o(G)},onsend:D,onstop:I,onreset:X,onmarkacted:O,ondismiss:Q,onremove:se,oncleargroup:xe,onscan:z,oncommand:M,get chatContainer(){return o(x)},set chatContainer(re){P(x,re,!0)}})}};ue(Z,H=>{o(i)===null?H(U):o(i)==="loading"?H(te,1):H(ie,!1)})}C(t,Y),st()}const Cn="gmail",rv=8,Zp=50,Qp=100;async function x1(t,{limit:e=Zp,onProgress:n=()=>{},signal:r}={}){var i;const a=await lt.syncState.get(Cn);if(a!=null&&a.historyId)try{return await T1(t,a,n,r)}catch(l){if(l instanceof xd&&(l.status===404||l.code==="notFound")||((i=l.message)==null?void 0:i.includes("Start history id")))n({phase:"info",message:"History expired, performing full re-sync..."}),await lt.syncState.delete(Cn);else throw l}return await E1(t,e===0?1/0:e,n,r)}async function k1(t,{limit:e=Zp,onProgress:n=()=>{},signal:r}={}){const a=await lt.syncState.get(Cn);return a!=null&&a.oldestPageToken?await A1(t,a,e===0?1/0:e,n,r):(n({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function S1(){const t=await lt.syncState.get(Cn);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Jp(){await lt.transaction("rw",[lt.items,lt.syncState],async()=>{await lt.items.where("sourceType").equals(Cn).delete(),await lt.syncState.delete(Cn)})}async function E1(t,e,n,r){n({phase:"counting",message:"Getting mailbox info..."}),_s(r);const a=await Ap(t);n({phase:"listing",message:"Listing messages...",current:0,total:Math.min(a.messagesTotal||e,e)});const s=[];let i,l=null;for(;s.length<e;){_s(r);const p=e-s.length,h=await Tp(t,{maxResults:Math.min(Qp,p),pageToken:i}),m=(h.messages||[]).map(x=>x.id);if(s.push(...m),n({phase:"listing",message:`Listed ${s.length} messages...`,current:s.length,total:Math.min(a.messagesTotal||e,e)}),i=h.nextPageToken,!i||m.length===0)break}if(l=i||null,s.length===0)return await lt.syncState.put({sourceType:Cn,historyId:a.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:u,errors:d}=await $p(t,s,n,r),v=await lt.items.where("sourceType").equals(Cn).count();return await lt.syncState.put({sourceType:Cn,historyId:a.historyId,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:l}),n({phase:"done",message:`Synced ${u} messages`,current:u,total:u}),{added:u,deleted:0,errors:d}}async function A1(t,e,n,r,a){r({phase:"listing",message:"Loading more messages...",current:0}),_s(a);const s=[];let i=e.oldestPageToken,l=null;for(;s.length<n;){_s(a);const p=n-s.length,h=await Tp(t,{maxResults:Math.min(Qp,p),pageToken:i}),m=(h.messages||[]).map(x=>x.id);if(s.push(...m),r({phase:"listing",message:`Listed ${s.length} more messages...`,current:s.length}),i=h.nextPageToken,!i||m.length===0)break}if(l=i||null,s.length===0)return await lt.syncState.update(Cn,{oldestPageToken:null,lastSyncAt:Date.now()}),r({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:u,errors:d}=await $p(t,s,r,a),v=await lt.items.where("sourceType").equals(Cn).count();return await lt.syncState.update(Cn,{totalItems:v,lastSyncAt:Date.now(),oldestPageToken:l}),r({phase:"done",message:l?`Downloaded ${u} more (more available)`:`Downloaded ${u} more (all synced)`,current:v,total:v}),{added:u,errors:d}}async function T1(t,e,n,r){n({phase:"syncing",message:"Checking for changes..."}),_s(r);let a=0,s=0,i=0,l,u=e.historyId;do{_s(r);const v=await $_(t,{startHistoryId:e.historyId,pageToken:l});if(u=v.historyId||u,l=v.nextPageToken,!!v.history){for(const p of v.history){if(p.messagesAdded){const h=p.messagesAdded.map(x=>x.message.id),m=[...new Set(h.filter(x=>x))];if(m.length>0){const x=await Promise.allSettled(m.map(E=>Cp(t,E))),k=[];for(const E of x)E.status==="fulfilled"?k.push(eg(E.value)):i++;k.length>0&&(await lt.items.bulkPut(k),await tg(k),a+=k.length)}}if(p.messagesDeleted){const h=p.messagesDeleted.map(m=>yd(Cn,m.message.id)).filter(m=>m);h.length>0&&(await lt.items.bulkDelete(h),s+=h.length)}}n({phase:"syncing",message:`Changes: +${a} -${s}`,current:a+s})}}while(l);const d=await lt.items.where("sourceType").equals(Cn).count();return await lt.syncState.put({sourceType:Cn,historyId:u,lastSyncAt:Date.now(),totalItems:d,oldestPageToken:e.oldestPageToken}),n({phase:"done",message:a===0&&s===0?"Already up to date":`Synced: +${a} -${s}`,current:d,total:d}),{added:a,deleted:s,errors:i}}async function $p(t,e,n,r){n({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let a=0,s=0;for(let i=0;i<e.length;i+=rv){_s(r);const l=e.slice(i,i+rv),u=await Promise.allSettled(l.map(v=>Cp(t,v))),d=[];for(const v of u)v.status==="fulfilled"?d.push(eg(v.value)):s++;d.length>0&&(await lt.items.bulkPut(d),await tg(d)),a+=d.length,n({phase:"downloading",message:`Downloaded ${a} of ${e.length} messages`,current:a,total:e.length})}return{added:a,errors:s}}function eg(t){const e=Pa(t,"From"),n=Pa(t,"To"),r=Pa(t,"Cc"),a=Pa(t,"Subject")||"(no subject)",s=Pa(t,"Date"),i=Pa(t,"Message-ID"),l=Pa(t,"In-Reply-To"),u=Pa(t,"References");let d;try{d=s?new Date(s).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{d=Date.now()}return{id:yd(Cn,t.id),sourceType:Cn,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:n,cc:r,subject:a,snippet:t.snippet||"",body:eb(t),htmlBody:tb(t),date:d,labels:t.labelIds||[],messageId:i,inReplyTo:l,references:u,raw:t,syncedAt:Date.now()}}async function tg(t){const e=new Map;for(const n of t)for(const r of[n.from,n.to,n.cc]){if(!r)continue;const a=r.split(",").map(s=>s.trim()).filter(Boolean);for(const s of a){const i=C1(s);i&&!e.has(i.email)&&e.set(i.email,{...i,date:n.date})}}for(const[n,{name:r,date:a}]of e)try{const s=await lt.contacts.where("email").equals(n).first();if(s){const i={};r&&!s.name&&(i.name=r),a>(s.lastSeen||0)&&(i.lastSeen=a),Object.keys(i).length>0&&await lt.contacts.update(s.id,i)}else await lt.contacts.add({email:n,name:r||"",firstSeen:a,lastSeen:a})}catch(s){(s==null?void 0:s.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",n,(s==null?void 0:s.message)||s)}}function C1(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const r=e[1].toLowerCase().trim(),a=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:r,name:a}}const n=t.toLowerCase().trim();return n.includes("@")?{email:n,name:""}:null}function _s(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var I1=L(`<div class="default-option svelte-1mdd5r2"><div class="default-option-text svelte-1mdd5r2"><span class="default-badge svelte-1mdd5r2">â Ready to use</span> <span>A shared OAuth Client ID is pre-configured. Just click below to sign in.</span></div> <button class="btn primary use-default-btn svelte-1mdd5r2"><svg viewBox="0 0 24 24" width="16" height="16" class="google-icon-sm svelte-1mdd5r2"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google</button></div> <details class="advanced-section svelte-1mdd5r2"><summary class="svelte-1mdd5r2">Use your own Client ID instead</summary> <div class="advanced-content svelte-1mdd5r2"><div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. Changes may take
                  a few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></details>`,1),P1=L(`<div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
              is required because the app is deployed at a subpath. Changes may take a
              few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div>`,1),M1=L(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">Sign in with your Google account to browse Gmail messages.
      Everything runs in your browser â no data is sent to any server.</p> <!></div></div>`);function O1(t,e){at(e,!0);let n=Ae(e,"clientIdInput",15),r=Ae(e,"defaultClientId",3,"");_n(()=>dr("SetupGuide"));let a=Pe(null);async function s(x){try{await navigator.clipboard.writeText(x),P(a,x,!0),setTimeout(()=>{P(a,null)},1500)}catch{const k=document.createElement("input");k.value=x,document.body.appendChild(k),k.select(),document.execCommand("copy"),document.body.removeChild(k),P(a,x,!0),setTimeout(()=>{P(a,null)},1500)}}const i="http://localhost:5173",l="https://cypherkitty.github.io",u="https://cypherkitty.github.io/me-ai/";var d=M1(),v=_(d),p=b(_(v),4);{var h=x=>{var k=I1(),E=Ye(k),N=b(_(E),2);N.__click=()=>{n(r()),e.onsave()};var j=b(E,2),V=b(_(j),2),S=_(V),K=b(_(S),6),B=b(_(K),2),O=b(_(B),2),Q=b(_(O),2),se=_(Q);se.__click=()=>s(i);var xe=_(se);xe.textContent="http://localhost:5173";var z=b(xe,2),M=_(z),q=b(se,2);q.__click=()=>s(l);var T=_(q);T.textContent="https://cypherkitty.github.io";var D=b(T,2),I=_(D),X=b(O,2),Y=b(_(X),2),Z=_(Y);Z.__click=()=>s(i);var U=_(Z);U.textContent="http://localhost:5173";var te=b(U,2),ie=_(te),H=b(Z,2);H.__click=()=>s(l);var G=_(H);G.textContent="https://cypherkitty.github.io";var re=b(G,2),ae=_(re),pe=b(H,2);pe.__click=()=>s(u);var _e=_(pe);_e.textContent="https://cypherkitty.github.io/me-ai/";var ne=b(_e,2),$=_(ne),ke=b(S,2),be=_(ke);be.__keydown=Xe=>Xe.key==="Enter"&&e.onsave();var Me=b(be,2);Me.__click=function(...Xe){var Je;(Je=e.onsave)==null||Je.apply(this,Xe)},oe(Xe=>{ee(M,o(a)===i?"â":"â§"),ee(I,o(a)===l?"â":"â§"),ee(ie,o(a)===i?"â":"â§"),ee(ae,o(a)===l?"â":"â§"),ee($,o(a)===u?"â":"â§"),Me.disabled=Xe},[()=>!n().trim()]),Zr(be,n),C(x,k)},m=x=>{var k=P1(),E=Ye(k),N=b(_(E),6),j=b(_(N),2),V=b(_(j),2),S=b(_(V),2),K=_(S);K.__click=()=>s(i);var B=_(K);B.textContent="http://localhost:5173";var O=b(B,2),Q=_(O),se=b(K,2);se.__click=()=>s(l);var xe=_(se);xe.textContent="https://cypherkitty.github.io";var z=b(xe,2),M=_(z),q=b(V,2),T=b(_(q),2),D=_(T);D.__click=()=>s(i);var I=_(D);I.textContent="http://localhost:5173";var X=b(I,2),Y=_(X),Z=b(D,2);Z.__click=()=>s(l);var U=_(Z);U.textContent="https://cypherkitty.github.io";var te=b(U,2),ie=_(te),H=b(Z,2);H.__click=()=>s(u);var G=_(H);G.textContent="https://cypherkitty.github.io/me-ai/";var re=b(G,2),ae=_(re),pe=b(E,2),_e=_(pe);_e.__keydown=$=>$.key==="Enter"&&e.onsave();var ne=b(_e,2);ne.__click=function(...$){var ke;(ke=e.onsave)==null||ke.apply(this,$)},oe($=>{ee(Q,o(a)===i?"â":"â§"),ee(M,o(a)===l?"â":"â§"),ee(Y,o(a)===i?"â":"â§"),ee(ie,o(a)===l?"â":"â§"),ee(ae,o(a)===u?"â":"â§"),ne.disabled=$},[()=>!n().trim()]),Zr(_e,n),C(x,k)};ue(p,x=>{r()?x(h):x(m,!1)})}C(t,d),st()}Xt(["click","keydown"]);function N1(t){const e=typeof t=="object"&&t!==null?t:null,n=(e==null?void 0:e.message)||String(t||""),r=e instanceof xd?e.status:null;if(n.includes("has not been used in project")||n.includes("is disabled")){const a=n.match(/project\s+(\d+)/),s=a==null?void 0:a[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:s?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${s}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return r===401||n.includes("Invalid Credentials")||n.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:r===403||n.includes("insufficient")&&n.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:n.includes("access_denied")||n.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:n.includes("popup")||n.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:r===429||n.includes("Rate Limit")||n.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:n.includes("Failed to fetch")||n.includes("NetworkError")||n.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:n,fix:null}}var D1=L('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),R1=L('<div class="error-card-title svelte-14buhqq"> </div>'),L1=L('<p class="error-card-fix svelte-14buhqq"> </p>'),j1=L('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),z1=L('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),q1=L('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function ng(t,e){at(e,!0);let n=Ae(e,"ondismiss",3,null),r=Ae(e,"onsignout",3,null),a=J(()=>N1(e.error));_n(()=>dr("ErrorCard"));var s=q1(),i=_(s);{var l=N=>{var j=D1(),V=_(j),S=_(V),K=b(V,2);K.__click=function(...B){var O;(O=n())==null||O.apply(this,B)},oe(()=>ee(S,o(a).title)),C(N,j)},u=N=>{var j=R1(),V=_(j);oe(()=>ee(V,o(a).title)),C(N,j)};ue(i,N=>{n()?N(l):N(u,!1)})}var d=b(i,2),v=_(d),p=b(d,2);{var h=N=>{var j=L1(),V=_(j);oe(()=>ee(V,o(a).fix)),C(N,j)};ue(p,N=>{o(a).fix&&N(h)})}var m=b(p,2);{var x=N=>{var j=j1(),V=_(j);oe(()=>{xt(j,"href",o(a).link.url),ee(V,`${o(a).link.label??""} â`)}),C(N,j)};ue(m,N=>{o(a).link&&N(x)})}var k=b(m,2);{var E=N=>{var j=z1();j.__click=function(...V){var S;(S=r())==null||S.apply(this,V)},C(N,j)};ue(k,N=>{o(a).action==="signout"&&r()&&N(E)})}oe(()=>ee(v,o(a).description)),C(t,s),st()}Xt(["click"]);var B1=L('<span class="spinner svelte-nyqevv"></span> Signing in...',1),F1=mn('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),K1=L('<span class="client-id-badge default svelte-nyqevv">shared default</span>'),H1=L('<span class="client-id-value svelte-nyqevv"> </span>'),G1=L(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <p class="auth-hint svelte-nyqevv">Popup blocked? Use <a href="/oauth-redirect.html" class="auth-link svelte-nyqevv">Sign in with Google (redirect)</a> â works in Cursor and other environments without popups.</p> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <!> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function U1(t,e){at(e,!0);let n=Ae(e,"isDefaultClientId",3,!1),r=Ae(e,"error",3,null),a=Ae(e,"loadingAuth",3,!1);_n(()=>dr("AuthCard"));var s=G1(),i=_(s),l=b(_(i),4);{var u=j=>{ng(j,{get error(){return r()},get onsignout(){return e.onsignout}})};ue(l,j=>{r()&&j(u)})}var d=b(l,2);d.__click=function(...j){var V;(V=e.onsignin)==null||V.apply(this,j)};var v=_(d);{var p=j=>{var V=B1();C(j,V)},h=j=>{var V=F1();C(j,V)};ue(v,j=>{a()?j(p):j(h,!1)})}var m=b(d,4),x=b(_(m),2);{var k=j=>{var V=K1();C(j,V)},E=j=>{var V=H1(),S=_(V);oe(K=>ee(S,`${K??""}...`),[()=>e.clientId.slice(0,20)]),C(j,V)};ue(x,j=>{n()?j(k):j(E,!1)})}var N=b(x,2);N.__click=function(...j){var V;(V=e.onclear)==null||V.apply(this,j)},oe(()=>d.disabled=a()),C(t,s),st()}Xt(["click"]);var V1=L('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),W1=L('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Y1=L('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function X1(t,e){at(e,!0);let n=Ae(e,"profile",3,null),r=Ae(e,"loadingProfile",3,!1);_n(()=>dr("ProfileCard"));var a=Y1(),s=_(a),i=_(s),l=b(s,2),u=_(l);{var d=h=>{var m=V1();C(h,m)},v=h=>{var m=W1(),x=Ye(m),k=_(x),E=b(x,2),N=_(E);oe((j,V)=>{ee(k,n().emailAddress),ee(N,`${j??""} messages
        Â· ${V??""} threads`)},[()=>{var j;return((j=n().messagesTotal)==null?void 0:j.toLocaleString())||"?"},()=>{var j;return((j=n().threadsTotal)==null?void 0:j.toLocaleString())||"?"}]),C(h,m)};ue(u,h=>{r()?h(d):n()&&h(v,1)})}var p=b(l,2);p.__click=function(...h){var m;(m=e.onsignout)==null||m.apply(this,h)},oe(h=>ee(i,h),[()=>n()?Pp(n().emailAddress):"?"]),C(t,a),st()}Xt(["click"]);var Z1=L('<span class="spinner svelte-1ds3j4k"></span>'),Q1=mn('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),J1=L('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),$1=L('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),ex=L('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),tx=L('<option class="svelte-1ds3j4k"> </option>'),nx=L('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),rx=L('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),ax=L('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),sx=L('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),ix=L('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),ox=L('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function lx(t,e){at(e,!0),_n(()=>dr("SyncStatus"));let n=Ae(e,"syncStatus",3,null),r=Ae(e,"syncProgress",3,null),a=Ae(e,"isSyncing",3,!1),s=Pe(!1),i=Pe(50);const l=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function u(Y){if(!Y)return"never";const Z=Math.floor((Date.now()-Y)/1e3);if(Z<60)return"just now";const U=Math.floor(Z/60);if(U<60)return`${U}m ago`;const te=Math.floor(U/60);return te<24?`${te}h ago`:`${Math.floor(te/24)}d ago`}function d(){var Y,Z;return!((Y=r())!=null&&Y.total)||!((Z=r())!=null&&Z.current)?0:Math.round(r().current/r().total*100)}var v=ox(),p=_(v),h=_(p),m=_(h);{var x=Y=>{var Z=Z1();C(Y,Z)},k=Y=>{var Z=Q1();C(Y,Z)};ue(m,Y=>{a()?Y(x):Y(k,!1)})}var E=b(h,2),N=b(_(E),2);{var j=Y=>{var Z=J1(),U=_(Z),te=b(U);{var ie=G=>{var re=on("Â· more available");C(G,re)},H=G=>{var re=on("Â· all synced");C(G,re)};ue(te,G=>{n().hasMore?G(ie):G(H,!1)})}oe((G,re)=>ee(U,`${G??""} emails stored
          Â· synced ${re??""} `),[()=>n().totalItems.toLocaleString(),()=>u(n().lastSyncAt)]),C(Y,Z)},V=Y=>{var Z=$1();C(Y,Z)};ue(N,Y=>{var Z;(Z=n())!=null&&Z.synced?Y(j):Y(V,!1)})}var S=b(E,2),K=_(S);{var B=Y=>{var Z=ex();Z.__click=()=>P(s,!o(s)),C(Y,Z)};ue(K,Y=>{var Z;(Z=n())!=null&&Z.synced&&!a()&&Y(B)})}var O=b(p,2),Q=_(O),se=b(_(Q),2);Ot(se,21,()=>l,Ut,(Y,Z)=>{var U=tx(),te=_(U),ie={};oe(()=>{ee(te,o(Z).label),ie!==(ie=o(Z).value)&&(U.value=(U.__value=o(Z).value)??"")}),C(Y,U)});var xe=b(Q,2),z=_(xe);{var M=Y=>{var Z=rx(),U=Ye(Z);U.__click=()=>e.onsync(o(i));var te=_(U),ie=b(U,2);{var H=G=>{var re=nx();re.__click=()=>e.onsyncmore(o(i));var ae=_(re);oe(()=>{re.disabled=a(),ee(ae,a()?"Loading...":"Sync More")}),C(G,re)};ue(ie,G=>{n().hasMore&&G(H)})}oe(()=>{U.disabled=a(),ee(te,a()?"Syncing...":"Sync New")}),C(Y,Z)},q=Y=>{var Z=ax();Z.__click=()=>e.onsync(o(i));var U=_(Z);oe(()=>{Z.disabled=a(),ee(U,a()?"Syncing...":"Download Emails")}),C(Y,Z)};ue(z,Y=>{var Z;(Z=n())!=null&&Z.synced?Y(M):Y(q,!1)})}var T=b(O,2);{var D=Y=>{var Z=sx(),U=_(Z),te=_(U);let ie,H;var G=b(U,2),re=_(G);oe(ae=>{ie=St(te,1,"progress-fill svelte-1ds3j4k",null,ie,{indeterminate:!r().total}),H=Dt(te,"",H,ae),ee(re,r().message||"Syncing...")},[()=>({width:`${d()??""}%`})]),C(Y,Z)};ue(T,Y=>{a()&&r()&&Y(D)})}var I=b(T,2);{var X=Y=>{var Z=ix(),U=b(_(Z),2),te=_(U);te.__click=()=>P(s,!1);var ie=b(te,2);ie.__click=()=>{e.onclear(),P(s,!1)},C(Y,Z)};ue(I,Y=>{o(s)&&Y(X)})}oe(()=>se.disabled=a()),pi(se,()=>o(i),Y=>P(i,Y)),C(t,v),st()}Xt(["click"]);var cx=L('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),ux=L('<div class="message-list svelte-y2uamw"></div>');function dx(t,e){at(e,!0);let n=Ae(e,"messages",19,()=>[]);_n(()=>dr("MessageList"));var r=ux();Ot(r,21,n,Ut,(a,s)=>{var i=cx();i.__click=()=>e.onselect(o(s));var l=_(i),u=_(l),d=b(l,2),v=_(d),p=_(v),h=_(p),m=b(p,2),x=_(m),k=b(v,2),E=_(k),N=b(k,2),j=_(N);oe((V,S,K)=>{ee(u,V),ee(h,S),ee(x,K),ee(E,o(s).subject),ee(j,o(s).snippet)},[()=>Pp(o(s).from),()=>Ip(o(s).from),()=>kd(o(s).date)]),C(a,i)}),C(t,r),st()}Xt(["click"]);function Id(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ps=Id();function rg(t){Ps=t}var ns={exec:()=>null};function Bt(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(a,s)=>{let i=typeof s=="string"?s:s.source;return i=i.replace(Fn.caret,"$1"),n=n.replace(a,i),r},getRegex:()=>new RegExp(n,e)};return r}var fx=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Fn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},vx=/^(?:[ \t]*(?:\n|$))+/,hx=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,px=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ko=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,gx=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Pd=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,ag=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,sg=Bt(ag).replace(/bull/g,Pd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),mx=Bt(ag).replace(/bull/g,Pd).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Md=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,yx=/^[^\n]+/,Od=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,_x=Bt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Od).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),bx=Bt(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Pd).getRegex(),nc="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Nd=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,wx=Bt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Nd).replace("tag",nc).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ig=Bt(Md).replace("hr",ko).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nc).getRegex(),xx=Bt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ig).getRegex(),Dd={blockquote:xx,code:hx,def:_x,fences:px,heading:gx,hr:ko,html:wx,lheading:sg,list:bx,newline:vx,paragraph:ig,table:ns,text:yx},av=Bt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ko).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nc).getRegex(),kx={...Dd,lheading:mx,table:av,paragraph:Bt(Md).replace("hr",ko).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",av).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nc).getRegex()},Sx={...Dd,html:Bt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Nd).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ns,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Bt(Md).replace("hr",ko).replace("heading",` *#{1,6} *[^
]`).replace("lheading",sg).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Ex=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ax=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,og=/^( {2,}|\\)\n(?!\s*$)/,Tx=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,rc=/[\p{P}\p{S}]/u,Rd=/[\s\p{P}\p{S}]/u,lg=/[^\s\p{P}\p{S}]/u,Cx=Bt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Rd).getRegex(),cg=/(?!~)[\p{P}\p{S}]/u,Ix=/(?!~)[\s\p{P}\p{S}]/u,Px=/(?:[^\s\p{P}\p{S}]|~)/u,ug=/(?![*_])[\p{P}\p{S}]/u,Mx=/(?![*_])[\s\p{P}\p{S}]/u,Ox=/(?:[^\s\p{P}\p{S}]|[*_])/u,Nx=Bt(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",fx?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),dg=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Dx=Bt(dg,"u").replace(/punct/g,rc).getRegex(),Rx=Bt(dg,"u").replace(/punct/g,cg).getRegex(),fg="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Lx=Bt(fg,"gu").replace(/notPunctSpace/g,lg).replace(/punctSpace/g,Rd).replace(/punct/g,rc).getRegex(),jx=Bt(fg,"gu").replace(/notPunctSpace/g,Px).replace(/punctSpace/g,Ix).replace(/punct/g,cg).getRegex(),zx=Bt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,lg).replace(/punctSpace/g,Rd).replace(/punct/g,rc).getRegex(),qx=Bt(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,ug).getRegex(),Bx="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Fx=Bt(Bx,"gu").replace(/notPunctSpace/g,Ox).replace(/punctSpace/g,Mx).replace(/punct/g,ug).getRegex(),Kx=Bt(/\\(punct)/,"gu").replace(/punct/g,rc).getRegex(),Hx=Bt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Gx=Bt(Nd).replace("(?:-->|$)","-->").getRegex(),Ux=Bt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Gx).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),El=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Vx=Bt(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",El).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),vg=Bt(/^!?\[(label)\]\[(ref)\]/).replace("label",El).replace("ref",Od).getRegex(),hg=Bt(/^!?\[(ref)\](?:\[\])?/).replace("ref",Od).getRegex(),Wx=Bt("reflink|nolink(?!\\()","g").replace("reflink",vg).replace("nolink",hg).getRegex(),sv=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Ld={_backpedal:ns,anyPunctuation:Kx,autolink:Hx,blockSkip:Nx,br:og,code:Ax,del:ns,delLDelim:ns,delRDelim:ns,emStrongLDelim:Dx,emStrongRDelimAst:Lx,emStrongRDelimUnd:zx,escape:Ex,link:Vx,nolink:hg,punctuation:Cx,reflink:vg,reflinkSearch:Wx,tag:Ux,text:Tx,url:ns},Yx={...Ld,link:Bt(/^!?\[(label)\]\((.*?)\)/).replace("label",El).getRegex(),reflink:Bt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",El).getRegex()},Du={...Ld,emStrongRDelimAst:jx,emStrongLDelim:Rx,delLDelim:qx,delRDelim:Fx,url:Bt(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",sv).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Bt(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",sv).getRegex()},Xx={...Du,br:Bt(og).replace("{2,}","*").getRegex(),text:Bt(Du.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Zo={normal:Dd,gfm:kx,pedantic:Sx},Mi={normal:Ld,gfm:Du,breaks:Xx,pedantic:Yx},Zx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},iv=t=>Zx[t];function ca(t,e){if(e){if(Fn.escapeTest.test(t))return t.replace(Fn.escapeReplace,iv)}else if(Fn.escapeTestNoEncode.test(t))return t.replace(Fn.escapeReplaceNoEncode,iv);return t}function ov(t){try{t=encodeURI(t).replace(Fn.percentDecode,"%")}catch{return null}return t}function lv(t,e){var s;let n=t.replace(Fn.findPipe,(i,l,u)=>{let d=!1,v=l;for(;--v>=0&&u[v]==="\\";)d=!d;return d?"|":" |"}),r=n.split(Fn.splitPipe),a=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;a<r.length;a++)r[a]=r[a].trim().replace(Fn.slashPipe,"|");return r}function Oi(t,e,n){let r=t.length;if(r===0)return"";let a=0;for(;a<r&&t.charAt(r-a-1)===e;)a++;return t.slice(0,r-a)}function Qx(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function Jx(t,e=0){let n=e,r="";for(let a of t)if(a==="	"){let s=4-n%4;r+=" ".repeat(s),n+=s}else r+=a,n++;return r}function cv(t,e,n,r,a){let s=e.href,i=e.title||null,l=t[1].replace(a.other.outputLinkReplace,"$1");r.state.inLink=!0;let u={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:i,text:l,tokens:r.inlineTokens(l)};return r.state.inLink=!1,u}function $x(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let a=r[1];return e.split(`
`).map(s=>{let i=s.match(n.other.beginningSpace);if(i===null)return s;let[l]=i;return l.length>=a.length?s.slice(a.length):s}).join(`
`)}var Al=class{constructor(t){ht(this,"options");ht(this,"rules");ht(this,"lexer");this.options=t||Ps}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Oi(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],r=$x(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let r=Oi(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Oi(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=Oi(e[0],`
`).split(`
`),r="",a="",s=[];for(;n.length>0;){let i=!1,l=[],u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))l.push(n[u]),i=!0;else if(!i)l.push(n[u]);else break;n=n.slice(u);let d=l.join(`
`),v=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,a=a?`${a}
${v}`:v;let p=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(v,s,!0),this.lexer.state.top=p,n.length===0)break;let h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){let m=h,x=m.raw+`
`+n.join(`
`),k=this.blockquote(x);s[s.length-1]=k,r=r.substring(0,r.length-m.raw.length)+k.raw,a=a.substring(0,a.length-m.text.length)+k.text;break}else if((h==null?void 0:h.type)==="list"){let m=h,x=m.raw+`
`+n.join(`
`),k=this.list(x);s[s.length-1]=k,r=r.substring(0,r.length-h.raw.length)+k.raw,a=a.substring(0,a.length-m.raw.length)+k.raw,n=x.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:a}}}list(t){var n,r;let e=this.rules.block.list.exec(t);if(e){let a=e[1].trim(),s=a.length>1,i={type:"list",raw:"",ordered:s,start:s?+a.slice(0,-1):"",loose:!1,items:[]};a=s?`\\d{1,9}\\${a.slice(-1)}`:`\\${a}`,this.options.pedantic&&(a=s?a:"[*+-]");let l=this.rules.other.listItemRegex(a),u=!1;for(;t;){let v=!1,p="",h="";if(!(e=l.exec(t))||this.rules.block.hr.test(t))break;p=e[0],t=t.substring(p.length);let m=Jx(e[2].split(`
`,1)[0],e[1].length),x=t.split(`
`,1)[0],k=!m.trim(),E=0;if(this.options.pedantic?(E=2,h=m.trimStart()):k?E=e[1].length+1:(E=m.search(this.rules.other.nonSpaceChar),E=E>4?1:E,h=m.slice(E),E+=e[1].length),k&&this.rules.other.blankLine.test(x)&&(p+=x+`
`,t=t.substring(x.length+1),v=!0),!v){let N=this.rules.other.nextBulletRegex(E),j=this.rules.other.hrRegex(E),V=this.rules.other.fencesBeginRegex(E),S=this.rules.other.headingBeginRegex(E),K=this.rules.other.htmlBeginRegex(E),B=this.rules.other.blockquoteBeginRegex(E);for(;t;){let O=t.split(`
`,1)[0],Q;if(x=O,this.options.pedantic?(x=x.replace(this.rules.other.listReplaceNesting,"  "),Q=x):Q=x.replace(this.rules.other.tabCharGlobal,"    "),V.test(x)||S.test(x)||K.test(x)||B.test(x)||N.test(x)||j.test(x))break;if(Q.search(this.rules.other.nonSpaceChar)>=E||!x.trim())h+=`
`+Q.slice(E);else{if(k||m.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||V.test(m)||S.test(m)||j.test(m))break;h+=`
`+x}k=!x.trim(),p+=O+`
`,t=t.substring(O.length+1),m=Q.slice(E)}}i.loose||(u?i.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(u=!0)),i.items.push({type:"list_item",raw:p,task:!!this.options.gfm&&this.rules.other.listIsTask.test(h),loose:!1,text:h,tokens:[]}),i.raw+=p}let d=i.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let v of i.items){if(this.lexer.state.top=!1,v.tokens=this.lexer.blockTokens(v.text,[]),v.task){if(v.text=v.text.replace(this.rules.other.listReplaceTask,""),((n=v.tokens[0])==null?void 0:n.type)==="text"||((r=v.tokens[0])==null?void 0:r.type)==="paragraph"){v.tokens[0].raw=v.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),v.tokens[0].text=v.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let h=this.lexer.inlineQueue.length-1;h>=0;h--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[h].src)){this.lexer.inlineQueue[h].src=this.lexer.inlineQueue[h].src.replace(this.rules.other.listReplaceTask,"");break}}let p=this.rules.other.listTaskCheckbox.exec(v.raw);if(p){let h={type:"checkbox",raw:p[0]+" ",checked:p[0]!=="[ ]"};v.checked=h.checked,i.loose?v.tokens[0]&&["paragraph","text"].includes(v.tokens[0].type)&&"tokens"in v.tokens[0]&&v.tokens[0].tokens?(v.tokens[0].raw=h.raw+v.tokens[0].raw,v.tokens[0].text=h.raw+v.tokens[0].text,v.tokens[0].tokens.unshift(h)):v.tokens.unshift({type:"paragraph",raw:h.raw,text:h.raw,tokens:[h]}):v.tokens.unshift(h)}}if(!i.loose){let p=v.tokens.filter(m=>m.type==="space"),h=p.length>0&&p.some(m=>this.rules.other.anyLine.test(m.raw));i.loose=h}}if(i.loose)for(let v of i.items){v.loose=!0;for(let p of v.tokens)p.type==="text"&&(p.type="paragraph")}return i}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:a}}}table(t){var i;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=lv(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=(i=e[3])!=null&&i.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let l of r)this.rules.other.tableAlignRight.test(l)?s.align.push("right"):this.rules.other.tableAlignCenter.test(l)?s.align.push("center"):this.rules.other.tableAlignLeft.test(l)?s.align.push("left"):s.align.push(null);for(let l=0;l<n.length;l++)s.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:s.align[l]});for(let l of a)s.rows.push(lv(l,s.header.length).map((u,d)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:s.align[d]})));return s}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=Oi(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{let s=Qx(e[2],"()");if(s===-2)return;if(s>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],a="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],a=s[3])}else a=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),cv(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=e[r.toLowerCase()];if(!a){let s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return cv(n,a,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let a=[...r[0]].length-1,s,i,l=a,u=0,d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+a);(r=d.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(i=[...s].length,r[3]||r[4]){l+=i;continue}else if((r[5]||r[6])&&a%3&&!((a+i)%3)){u+=i;continue}if(l-=i,l>0)continue;i=Math.min(i,i+l+u);let v=[...r[0]][0].length,p=t.slice(0,a+r.index+v+i);if(Math.min(a,i)%2){let m=p.slice(1,-1);return{type:"em",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}let h=p.slice(2,-2);return{type:"strong",raw:p,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),a=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&a&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,n=""){let r=this.rules.inline.delLDelim.exec(t);if(r&&(!r[1]||!n||this.rules.inline.punctuation.exec(n))){let a=[...r[0]].length-1,s,i,l=a,u=this.rules.inline.delRDelim;for(u.lastIndex=0,e=e.slice(-1*t.length+a);(r=u.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s||(i=[...s].length,i!==a))continue;if(r[3]||r[4]){l+=i;continue}if(l-=i,l>0)continue;i=Math.min(i,i+l);let d=[...r[0]][0].length,v=t.slice(0,a+r.index+d+i),p=v.slice(a,-a);return{type:"del",raw:v,text:p,tokens:this.lexer.inlineTokens(p)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,r;return e[2]==="@"?(n=e[1],r="mailto:"+n):(n=e[1],r=n),{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let r,a;if(e[2]==="@")r=e[0],a="mailto:"+r;else{let s;do s=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(s!==e[0]);r=e[0],e[1]==="www."?a="http://"+e[0]:a=e[0]}return{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},Ir=class Ru{constructor(e){ht(this,"tokens");ht(this,"options");ht(this,"state");ht(this,"inlineQueue");ht(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ps,this.options.tokenizer=this.options.tokenizer||new Al,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:Fn,block:Zo.normal,inline:Mi.normal};this.options.pedantic?(n.block=Zo.pedantic,n.inline=Mi.pedantic):this.options.gfm&&(n.block=Zo.gfm,this.options.breaks?n.inline=Mi.breaks:n.inline=Mi.gfm),this.tokenizer.rules=n}static get rules(){return{block:Zo,inline:Mi}}static lex(e,n){return new Ru(n).lex(e)}static lexInline(e,n){return new Ru(n).inlineTokens(e)}lex(e){e=e.replace(Fn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var a,s,i;for(this.options.pedantic&&(e=e.replace(Fn.tabCharGlobal,"    ").replace(Fn.spaceLine,""));e;){let l;if((s=(a=this.options.extensions)==null?void 0:a.block)!=null&&s.some(d=>(l=d.call({lexer:this},e,n))?(e=e.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.space(e)){e=e.substring(l.raw.length);let d=n.at(-1);l.raw.length===1&&d!==void 0?d.raw+=`
`:n.push(l);continue}if(l=this.tokenizer.code(e)){e=e.substring(l.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.at(-1).src=d.text):n.push(l);continue}if(l=this.tokenizer.fences(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.heading(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.hr(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.blockquote(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.list(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.html(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.def(e)){e=e.substring(l.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title},n.push(l));continue}if(l=this.tokenizer.table(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.lheading(e)){e=e.substring(l.raw.length),n.push(l);continue}let u=e;if((i=this.options.extensions)!=null&&i.startBlock){let d=1/0,v=e.slice(1),p;this.options.extensions.startBlock.forEach(h=>{p=h.call({lexer:this},v),typeof p=="number"&&p>=0&&(d=Math.min(d,p))}),d<1/0&&d>=0&&(u=e.substring(0,d+1))}if(this.state.top&&(l=this.tokenizer.paragraph(u))){let d=n.at(-1);r&&(d==null?void 0:d.type)==="paragraph"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):n.push(l),r=u.length!==e.length,e=e.substring(l.raw.length);continue}if(l=this.tokenizer.text(e)){e=e.substring(l.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):n.push(l);continue}if(e){let d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var u,d,v,p,h;let r=e,a=null;if(this.tokens.links){let m=Object.keys(this.tokens.links);if(m.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)m.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,a.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s;for(;(a=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)s=a[2]?a[2].length:0,r=r.slice(0,a.index+s)+"["+"a".repeat(a[0].length-s-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=((d=(u=this.options.hooks)==null?void 0:u.emStrongMask)==null?void 0:d.call({lexer:this},r))??r;let i=!1,l="";for(;e;){i||(l=""),i=!1;let m;if((p=(v=this.options.extensions)==null?void 0:v.inline)!=null&&p.some(k=>(m=k.call({lexer:this},e,n))?(e=e.substring(m.raw.length),n.push(m),!0):!1))continue;if(m=this.tokenizer.escape(e)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.tag(e)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.link(e)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(m.raw.length);let k=n.at(-1);m.type==="text"&&(k==null?void 0:k.type)==="text"?(k.raw+=m.raw,k.text+=m.text):n.push(m);continue}if(m=this.tokenizer.emStrong(e,r,l)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.codespan(e)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.br(e)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.del(e,r,l)){e=e.substring(m.raw.length),n.push(m);continue}if(m=this.tokenizer.autolink(e)){e=e.substring(m.raw.length),n.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(e))){e=e.substring(m.raw.length),n.push(m);continue}let x=e;if((h=this.options.extensions)!=null&&h.startInline){let k=1/0,E=e.slice(1),N;this.options.extensions.startInline.forEach(j=>{N=j.call({lexer:this},E),typeof N=="number"&&N>=0&&(k=Math.min(k,N))}),k<1/0&&k>=0&&(x=e.substring(0,k+1))}if(m=this.tokenizer.inlineText(x)){e=e.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(l=m.raw.slice(-1)),i=!0;let k=n.at(-1);(k==null?void 0:k.type)==="text"?(k.raw+=m.raw,k.text+=m.text):n.push(m);continue}if(e){let k="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(k);break}else throw new Error(k)}}return n}},Tl=class{constructor(t){ht(this,"options");ht(this,"parser");this.options=t||Ps}space(t){return""}code({text:t,lang:e,escaped:n}){var s;let r=(s=(e||"").match(Fn.notSpaceStart))==null?void 0:s[0],a=t.replace(Fn.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ca(r)+'">'+(n?a:ca(a,!0))+`</code></pre>
`:"<pre><code>"+(n?a:ca(a,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,r="";for(let i=0;i<t.items.length;i++){let l=t.items[i];r+=this.listitem(l)}let a=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+a+s+`>
`+r+"</"+a+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let a=0;a<t.header.length;a++)n+=this.tablecell(t.header[a]);e+=this.tablerow({text:n});let r="";for(let a=0;a<t.rows.length;a++){let s=t.rows[a];n="";for(let i=0;i<s.length;i++)n+=this.tablecell(s[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ca(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let r=this.parser.parseInline(n),a=ov(t);if(a===null)return r;t=a;let s='<a href="'+t+'"';return e&&(s+=' title="'+ca(e)+'"'),s+=">"+r+"</a>",s}image({href:t,title:e,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let a=ov(t);if(a===null)return ca(n);t=a;let s=`<img src="${t}" alt="${n}"`;return e&&(s+=` title="${ca(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ca(t.text)}},jd=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Pr=class Lu{constructor(e){ht(this,"options");ht(this,"renderer");ht(this,"textRenderer");this.options=e||Ps,this.options.renderer=this.options.renderer||new Tl,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new jd}static parse(e,n){return new Lu(n).parse(e)}static parseInline(e,n){return new Lu(n).parseInline(e)}parse(e){var r,a;let n="";for(let s=0;s<e.length;s++){let i=e[s];if((a=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&a[i.type]){let u=i,d=this.options.extensions.renderers[u.type].call({parser:this},u);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(u.type)){n+=d||"";continue}}let l=i;switch(l.type){case"space":{n+=this.renderer.space(l);break}case"hr":{n+=this.renderer.hr(l);break}case"heading":{n+=this.renderer.heading(l);break}case"code":{n+=this.renderer.code(l);break}case"table":{n+=this.renderer.table(l);break}case"blockquote":{n+=this.renderer.blockquote(l);break}case"list":{n+=this.renderer.list(l);break}case"checkbox":{n+=this.renderer.checkbox(l);break}case"html":{n+=this.renderer.html(l);break}case"def":{n+=this.renderer.def(l);break}case"paragraph":{n+=this.renderer.paragraph(l);break}case"text":{n+=this.renderer.text(l);break}default:{let u='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return n}parseInline(e,n=this.renderer){var a,s;let r="";for(let i=0;i<e.length;i++){let l=e[i];if((s=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&s[l.type]){let d=this.options.extensions.renderers[l.type].call({parser:this},l);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){r+=d||"";continue}}let u=l;switch(u.type){case"escape":{r+=n.text(u);break}case"html":{r+=n.html(u);break}case"link":{r+=n.link(u);break}case"image":{r+=n.image(u);break}case"checkbox":{r+=n.checkbox(u);break}case"strong":{r+=n.strong(u);break}case"em":{r+=n.em(u);break}case"codespan":{r+=n.codespan(u);break}case"br":{r+=n.br(u);break}case"del":{r+=n.del(u);break}case"text":{r+=n.text(u);break}default:{let d='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},il,Fi=(il=class{constructor(t){ht(this,"options");ht(this,"block");this.options=t||Ps}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Ir.lex:Ir.lexInline}provideParser(){return this.block?Pr.parse:Pr.parseInline}},ht(il,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),ht(il,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),il),ek=class{constructor(...t){ht(this,"defaults",Id());ht(this,"options",this.setOptions);ht(this,"parse",this.parseMarkdown(!0));ht(this,"parseInline",this.parseMarkdown(!1));ht(this,"Parser",Pr);ht(this,"Renderer",Tl);ht(this,"TextRenderer",jd);ht(this,"Lexer",Ir);ht(this,"Tokenizer",Al);ht(this,"Hooks",Fi);this.use(...t)}walkTokens(t,e){var r,a;let n=[];for(let s of t)switch(n=n.concat(e.call(this,s)),s.type){case"table":{let i=s;for(let l of i.header)n=n.concat(this.walkTokens(l.tokens,e));for(let l of i.rows)for(let u of l)n=n.concat(this.walkTokens(u.tokens,e));break}case"list":{let i=s;n=n.concat(this.walkTokens(i.items,e));break}default:{let i=s;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[i.type]?this.defaults.extensions.childTokens[i.type].forEach(l=>{let u=i[l].flat(1/0);n=n.concat(this.walkTokens(u,e))}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){let s=e.renderers[a.name];s?e.renderers[a.name]=function(...i){let l=a.renderer.apply(this,i);return l===!1&&(l=s.apply(this,i)),l}:e.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[a.level];s?s.unshift(a.tokenizer):e[a.level]=[a.tokenizer],a.start&&(a.level==="block"?e.startBlock?e.startBlock.push(a.start):e.startBlock=[a.start]:a.level==="inline"&&(e.startInline?e.startInline.push(a.start):e.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(e.childTokens[a.name]=a.childTokens)}),r.extensions=e),n.renderer){let a=this.defaults.renderer||new Tl(this.defaults);for(let s in n.renderer){if(!(s in a))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let i=s,l=n.renderer[i],u=a[i];a[i]=(...d)=>{let v=l.apply(a,d);return v===!1&&(v=u.apply(a,d)),v||""}}r.renderer=a}if(n.tokenizer){let a=this.defaults.tokenizer||new Al(this.defaults);for(let s in n.tokenizer){if(!(s in a))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let i=s,l=n.tokenizer[i],u=a[i];a[i]=(...d)=>{let v=l.apply(a,d);return v===!1&&(v=u.apply(a,d)),v}}r.tokenizer=a}if(n.hooks){let a=this.defaults.hooks||new Fi;for(let s in n.hooks){if(!(s in a))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let i=s,l=n.hooks[i],u=a[i];Fi.passThroughHooks.has(s)?a[i]=d=>{if(this.defaults.async&&Fi.passThroughHooksRespectAsync.has(s))return(async()=>{let p=await l.call(a,d);return u.call(a,p)})();let v=l.call(a,d);return u.call(a,v)}:a[i]=(...d)=>{if(this.defaults.async)return(async()=>{let p=await l.apply(a,d);return p===!1&&(p=await u.apply(a,d)),p})();let v=l.apply(a,d);return v===!1&&(v=u.apply(a,d)),v}}r.hooks=a}if(n.walkTokens){let a=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(i){let l=[];return l.push(s.call(this,i)),a&&(l=l.concat(a.call(this,i))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Ir.lex(t,e??this.defaults)}parser(t,e){return Pr.parse(t,e??this.defaults)}parseMarkdown(t){return(e,n)=>{let r={...n},a={...this.defaults,...r},s=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&r.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(a.hooks&&(a.hooks.options=a,a.hooks.block=t),a.async)return(async()=>{let i=a.hooks?await a.hooks.preprocess(e):e,l=await(a.hooks?await a.hooks.provideLexer():t?Ir.lex:Ir.lexInline)(i,a),u=a.hooks?await a.hooks.processAllTokens(l):l;a.walkTokens&&await Promise.all(this.walkTokens(u,a.walkTokens));let d=await(a.hooks?await a.hooks.provideParser():t?Pr.parse:Pr.parseInline)(u,a);return a.hooks?await a.hooks.postprocess(d):d})().catch(s);try{a.hooks&&(e=a.hooks.preprocess(e));let i=(a.hooks?a.hooks.provideLexer():t?Ir.lex:Ir.lexInline)(e,a);a.hooks&&(i=a.hooks.processAllTokens(i)),a.walkTokens&&this.walkTokens(i,a.walkTokens);let l=(a.hooks?a.hooks.provideParser():t?Pr.parse:Pr.parseInline)(i,a);return a.hooks&&(l=a.hooks.postprocess(l)),l}catch(i){return s(i)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+ca(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}}},bs=new ek;function Vt(t,e){return bs.parse(t,e)}Vt.options=Vt.setOptions=function(t){return bs.setOptions(t),Vt.defaults=bs.defaults,rg(Vt.defaults),Vt};Vt.getDefaults=Id;Vt.defaults=Ps;Vt.use=function(...t){return bs.use(...t),Vt.defaults=bs.defaults,rg(Vt.defaults),Vt};Vt.walkTokens=function(t,e){return bs.walkTokens(t,e)};Vt.parseInline=bs.parseInline;Vt.Parser=Pr;Vt.parser=Pr.parse;Vt.Renderer=Tl;Vt.TextRenderer=jd;Vt.Lexer=Ir;Vt.lexer=Ir.lex;Vt.Tokenizer=Al;Vt.Hooks=Fi;Vt.parse=Vt;Vt.options;Vt.setOptions;Vt.use;Vt.walkTokens;Vt.parseInline;Pr.parse;Ir.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:pg,setPrototypeOf:uv,isFrozen:tk,getPrototypeOf:nk,getOwnPropertyDescriptor:rk}=Object;let{freeze:Kn,seal:br,create:ju}=Object,{apply:zu,construct:qu}=typeof Reflect<"u"&&Reflect;Kn||(Kn=function(e){return e});br||(br=function(e){return e});zu||(zu=function(e,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];return e.apply(n,a)});qu||(qu=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return new e(...r)});const Qo=Hn(Array.prototype.forEach),ak=Hn(Array.prototype.lastIndexOf),dv=Hn(Array.prototype.pop),Ni=Hn(Array.prototype.push),sk=Hn(Array.prototype.splice),hl=Hn(String.prototype.toLowerCase),Yc=Hn(String.prototype.toString),Xc=Hn(String.prototype.match),Di=Hn(String.prototype.replace),ik=Hn(String.prototype.indexOf),ok=Hn(String.prototype.trim),Tr=Hn(Object.prototype.hasOwnProperty),qn=Hn(RegExp.prototype.test),Ri=lk(TypeError);function Hn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return zu(t,e,r)}}function lk(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return qu(t,n)}}function Nt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hl;uv&&uv(t,null);let r=e.length;for(;r--;){let a=e[r];if(typeof a=="string"){const s=n(a);s!==a&&(tk(e)||(e[r]=s),a=s)}t[a]=!0}return t}function ck(t){for(let e=0;e<t.length;e++)Tr(t,e)||(t[e]=null);return t}function Hr(t){const e=ju(null);for(const[n,r]of pg(t))Tr(t,n)&&(Array.isArray(r)?e[n]=ck(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=Hr(r):e[n]=r);return e}function Li(t,e){for(;t!==null;){const r=rk(t,e);if(r){if(r.get)return Hn(r.get);if(typeof r.value=="function")return Hn(r.value)}t=nk(t)}function n(){return null}return n}const fv=Kn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zc=Kn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qc=Kn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),uk=Kn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Jc=Kn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),dk=Kn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vv=Kn(["#text"]),hv=Kn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),$c=Kn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),pv=Kn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Jo=Kn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),fk=br(/\{\{[\w\W]*|[\w\W]*\}\}/gm),vk=br(/<%[\w\W]*|[\w\W]*%>/gm),hk=br(/\$\{[\w\W]*/gm),pk=br(/^data-[\-\w.\u00B7-\uFFFF]+$/),gk=br(/^aria-[\-\w]+$/),gg=br(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mk=br(/^(?:\w+script|data):/i),yk=br(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mg=br(/^html$/i),_k=br(/^[a-z][.\w]*(-[.\w]+)+$/i);var gv=Object.freeze({__proto__:null,ARIA_ATTR:gk,ATTR_WHITESPACE:yk,CUSTOM_ELEMENT:_k,DATA_ATTR:pk,DOCTYPE_NAME:mg,ERB_EXPR:vk,IS_ALLOWED_URI:gg,IS_SCRIPT_OR_DATA:mk,MUSTACHE_EXPR:fk,TMPLIT_EXPR:hk});const ji={element:1,text:3,progressingInstruction:7,comment:8,document:9},bk=function(){return typeof window>"u"?null:window},wk=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const a="data-tt-policy-suffix";n&&n.hasAttribute(a)&&(r=n.getAttribute(a));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},mv=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function yg(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bk();const e=ot=>yg(ot);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==ji.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,a=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:i,Node:l,Element:u,NodeFilter:d,NamedNodeMap:v=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:m}=t,x=u.prototype,k=Li(x,"cloneNode"),E=Li(x,"remove"),N=Li(x,"nextSibling"),j=Li(x,"childNodes"),V=Li(x,"parentNode");if(typeof i=="function"){const ot=n.createElement("template");ot.content&&ot.content.ownerDocument&&(n=ot.content.ownerDocument)}let S,K="";const{implementation:B,createNodeIterator:O,createDocumentFragment:Q,getElementsByTagName:se}=n,{importNode:xe}=r;let z=mv();e.isSupported=typeof pg=="function"&&typeof V=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:M,ERB_EXPR:q,TMPLIT_EXPR:T,DATA_ATTR:D,ARIA_ATTR:I,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:Z}=gv;let{IS_ALLOWED_URI:U}=gv,te=null;const ie=Nt({},[...fv,...Zc,...Qc,...Jc,...vv]);let H=null;const G=Nt({},[...hv,...$c,...pv,...Jo]);let re=Object.seal(ju(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ae=null,pe=null;const _e=Object.seal(ju(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ne=!0,$=!0,ke=!1,be=!0,Me=!1,Xe=!0,Je=!1,ct=!1,De=!1,Oe=!1,qe=!1,Ne=!1,Fe=!0,Ke=!1;const $e="user-content-";let Ze=!0,Ge=!1,tt={},nt=null;const ft=Nt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let mt=null;const vt=Nt({},["audio","video","img","source","image","track"]);let kt=null;const bt=Nt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pt="http://www.w3.org/1998/Math/MathML",yt="http://www.w3.org/2000/svg",dt="http://www.w3.org/1999/xhtml";let je=dt,Rt=!1,At=null;const Gt=Nt({},[pt,yt,dt],Yc);let Re=Nt({},["mi","mo","mn","ms","mtext"]),Qt=Nt({},["annotation-xml"]);const Gn=Nt({},["title","style","font","a","script"]);let ye=null;const ln=["application/xhtml+xml","text/html"],En="text/html";let Ct=null,Mn=null;const it=n.createElement("form"),ut=function(ce){return ce instanceof RegExp||ce instanceof Function},Pt=function(){let ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Mn&&Mn===ce)){if((!ce||typeof ce!="object")&&(ce={}),ce=Hr(ce),ye=ln.indexOf(ce.PARSER_MEDIA_TYPE)===-1?En:ce.PARSER_MEDIA_TYPE,Ct=ye==="application/xhtml+xml"?Yc:hl,te=Tr(ce,"ALLOWED_TAGS")?Nt({},ce.ALLOWED_TAGS,Ct):ie,H=Tr(ce,"ALLOWED_ATTR")?Nt({},ce.ALLOWED_ATTR,Ct):G,At=Tr(ce,"ALLOWED_NAMESPACES")?Nt({},ce.ALLOWED_NAMESPACES,Yc):Gt,kt=Tr(ce,"ADD_URI_SAFE_ATTR")?Nt(Hr(bt),ce.ADD_URI_SAFE_ATTR,Ct):bt,mt=Tr(ce,"ADD_DATA_URI_TAGS")?Nt(Hr(vt),ce.ADD_DATA_URI_TAGS,Ct):vt,nt=Tr(ce,"FORBID_CONTENTS")?Nt({},ce.FORBID_CONTENTS,Ct):ft,ae=Tr(ce,"FORBID_TAGS")?Nt({},ce.FORBID_TAGS,Ct):Hr({}),pe=Tr(ce,"FORBID_ATTR")?Nt({},ce.FORBID_ATTR,Ct):Hr({}),tt=Tr(ce,"USE_PROFILES")?ce.USE_PROFILES:!1,ne=ce.ALLOW_ARIA_ATTR!==!1,$=ce.ALLOW_DATA_ATTR!==!1,ke=ce.ALLOW_UNKNOWN_PROTOCOLS||!1,be=ce.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=ce.SAFE_FOR_TEMPLATES||!1,Xe=ce.SAFE_FOR_XML!==!1,Je=ce.WHOLE_DOCUMENT||!1,Oe=ce.RETURN_DOM||!1,qe=ce.RETURN_DOM_FRAGMENT||!1,Ne=ce.RETURN_TRUSTED_TYPE||!1,De=ce.FORCE_BODY||!1,Fe=ce.SANITIZE_DOM!==!1,Ke=ce.SANITIZE_NAMED_PROPS||!1,Ze=ce.KEEP_CONTENT!==!1,Ge=ce.IN_PLACE||!1,U=ce.ALLOWED_URI_REGEXP||gg,je=ce.NAMESPACE||dt,Re=ce.MATHML_TEXT_INTEGRATION_POINTS||Re,Qt=ce.HTML_INTEGRATION_POINTS||Qt,re=ce.CUSTOM_ELEMENT_HANDLING||{},ce.CUSTOM_ELEMENT_HANDLING&&ut(ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(re.tagNameCheck=ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ce.CUSTOM_ELEMENT_HANDLING&&ut(ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(re.attributeNameCheck=ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ce.CUSTOM_ELEMENT_HANDLING&&typeof ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(re.allowCustomizedBuiltInElements=ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&($=!1),qe&&(Oe=!0),tt&&(te=Nt({},vv),H=[],tt.html===!0&&(Nt(te,fv),Nt(H,hv)),tt.svg===!0&&(Nt(te,Zc),Nt(H,$c),Nt(H,Jo)),tt.svgFilters===!0&&(Nt(te,Qc),Nt(H,$c),Nt(H,Jo)),tt.mathMl===!0&&(Nt(te,Jc),Nt(H,pv),Nt(H,Jo))),ce.ADD_TAGS&&(typeof ce.ADD_TAGS=="function"?_e.tagCheck=ce.ADD_TAGS:(te===ie&&(te=Hr(te)),Nt(te,ce.ADD_TAGS,Ct))),ce.ADD_ATTR&&(typeof ce.ADD_ATTR=="function"?_e.attributeCheck=ce.ADD_ATTR:(H===G&&(H=Hr(H)),Nt(H,ce.ADD_ATTR,Ct))),ce.ADD_URI_SAFE_ATTR&&Nt(kt,ce.ADD_URI_SAFE_ATTR,Ct),ce.FORBID_CONTENTS&&(nt===ft&&(nt=Hr(nt)),Nt(nt,ce.FORBID_CONTENTS,Ct)),ce.ADD_FORBID_CONTENTS&&(nt===ft&&(nt=Hr(nt)),Nt(nt,ce.ADD_FORBID_CONTENTS,Ct)),Ze&&(te["#text"]=!0),Je&&Nt(te,["html","head","body"]),te.table&&(Nt(te,["tbody"]),delete ae.tbody),ce.TRUSTED_TYPES_POLICY){if(typeof ce.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ri('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ce.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ri('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=ce.TRUSTED_TYPES_POLICY,K=S.createHTML("")}else S===void 0&&(S=wk(m,a)),S!==null&&typeof K=="string"&&(K=S.createHTML(""));Kn&&Kn(ce),Mn=ce}},$t=Nt({},[...Zc,...Qc,...uk]),_t=Nt({},[...Jc,...dk]),jt=function(ce){let Be=V(ce);(!Be||!Be.tagName)&&(Be={namespaceURI:je,tagName:"template"});const Ue=hl(ce.tagName),Ft=hl(Be.tagName);return At[ce.namespaceURI]?ce.namespaceURI===yt?Be.namespaceURI===dt?Ue==="svg":Be.namespaceURI===pt?Ue==="svg"&&(Ft==="annotation-xml"||Re[Ft]):!!$t[Ue]:ce.namespaceURI===pt?Be.namespaceURI===dt?Ue==="math":Be.namespaceURI===yt?Ue==="math"&&Qt[Ft]:!!_t[Ue]:ce.namespaceURI===dt?Be.namespaceURI===yt&&!Qt[Ft]||Be.namespaceURI===pt&&!Re[Ft]?!1:!_t[Ue]&&(Gn[Ue]||!$t[Ue]):!!(ye==="application/xhtml+xml"&&At[ce.namespaceURI]):!1},fn=function(ce){Ni(e.removed,{element:ce});try{V(ce).removeChild(ce)}catch{E(ce)}},cn=function(ce,Be){try{Ni(e.removed,{attribute:Be.getAttributeNode(ce),from:Be})}catch{Ni(e.removed,{attribute:null,from:Be})}if(Be.removeAttribute(ce),ce==="is")if(Oe||qe)try{fn(Be)}catch{}else try{Be.setAttribute(ce,"")}catch{}},Jt=function(ce){let Be=null,Ue=null;if(De)ce="<remove></remove>"+ce;else{const un=Xc(ce,/^[\r\n\t ]+/);Ue=un&&un[0]}ye==="application/xhtml+xml"&&je===dt&&(ce='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ce+"</body></html>");const Ft=S?S.createHTML(ce):ce;if(je===dt)try{Be=new h().parseFromString(Ft,ye)}catch{}if(!Be||!Be.documentElement){Be=B.createDocument(je,"template",null);try{Be.documentElement.innerHTML=Rt?K:Ft}catch{}}const nn=Be.body||Be.documentElement;return ce&&Ue&&nn.insertBefore(n.createTextNode(Ue),nn.childNodes[0]||null),je===dt?se.call(Be,Je?"html":"body")[0]:Je?Be.documentElement:nn},en=function(ce){return O.call(ce.ownerDocument||ce,ce,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},jn=function(ce){return ce instanceof p&&(typeof ce.nodeName!="string"||typeof ce.textContent!="string"||typeof ce.removeChild!="function"||!(ce.attributes instanceof v)||typeof ce.removeAttribute!="function"||typeof ce.setAttribute!="function"||typeof ce.namespaceURI!="string"||typeof ce.insertBefore!="function"||typeof ce.hasChildNodes!="function")},On=function(ce){return typeof l=="function"&&ce instanceof l};function Nn(ot,ce,Be){Qo(ot,Ue=>{Ue.call(e,ce,Be,Mn)})}const xr=function(ce){let Be=null;if(Nn(z.beforeSanitizeElements,ce,null),jn(ce))return fn(ce),!0;const Ue=Ct(ce.nodeName);if(Nn(z.uponSanitizeElement,ce,{tagName:Ue,allowedTags:te}),Xe&&ce.hasChildNodes()&&!On(ce.firstElementChild)&&qn(/<[/\w!]/g,ce.innerHTML)&&qn(/<[/\w!]/g,ce.textContent)||ce.nodeType===ji.progressingInstruction||Xe&&ce.nodeType===ji.comment&&qn(/<[/\w]/g,ce.data))return fn(ce),!0;if(!(_e.tagCheck instanceof Function&&_e.tagCheck(Ue))&&(!te[Ue]||ae[Ue])){if(!ae[Ue]&&Io(Ue)&&(re.tagNameCheck instanceof RegExp&&qn(re.tagNameCheck,Ue)||re.tagNameCheck instanceof Function&&re.tagNameCheck(Ue)))return!1;if(Ze&&!nt[Ue]){const Ft=V(ce)||ce.parentNode,nn=j(ce)||ce.childNodes;if(nn&&Ft){const un=nn.length;for(let hn=un-1;hn>=0;--hn){const Un=k(nn[hn],!0);Un.__removalCount=(ce.__removalCount||0)+1,Ft.insertBefore(Un,N(ce))}}}return fn(ce),!0}return ce instanceof u&&!jt(ce)||(Ue==="noscript"||Ue==="noembed"||Ue==="noframes")&&qn(/<\/no(script|embed|frames)/i,ce.innerHTML)?(fn(ce),!0):(Me&&ce.nodeType===ji.text&&(Be=ce.textContent,Qo([M,q,T],Ft=>{Be=Di(Be,Ft," ")}),ce.textContent!==Be&&(Ni(e.removed,{element:ce.cloneNode()}),ce.textContent=Be)),Nn(z.afterSanitizeElements,ce,null),!1)},Wa=function(ce,Be,Ue){if(Fe&&(Be==="id"||Be==="name")&&(Ue in n||Ue in it))return!1;if(!($&&!pe[Be]&&qn(D,Be))){if(!(ne&&qn(I,Be))){if(!(_e.attributeCheck instanceof Function&&_e.attributeCheck(Be,ce))){if(!H[Be]||pe[Be]){if(!(Io(ce)&&(re.tagNameCheck instanceof RegExp&&qn(re.tagNameCheck,ce)||re.tagNameCheck instanceof Function&&re.tagNameCheck(ce))&&(re.attributeNameCheck instanceof RegExp&&qn(re.attributeNameCheck,Be)||re.attributeNameCheck instanceof Function&&re.attributeNameCheck(Be,ce))||Be==="is"&&re.allowCustomizedBuiltInElements&&(re.tagNameCheck instanceof RegExp&&qn(re.tagNameCheck,Ue)||re.tagNameCheck instanceof Function&&re.tagNameCheck(Ue))))return!1}else if(!kt[Be]){if(!qn(U,Di(Ue,Y,""))){if(!((Be==="src"||Be==="xlink:href"||Be==="href")&&ce!=="script"&&ik(Ue,"data:")===0&&mt[ce])){if(!(ke&&!qn(X,Di(Ue,Y,"")))){if(Ue)return!1}}}}}}}return!0},Io=function(ce){return ce!=="annotation-xml"&&Xc(ce,Z)},kr=function(ce){Nn(z.beforeSanitizeAttributes,ce,null);const{attributes:Be}=ce;if(!Be||jn(ce))return;const Ue={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H,forceKeepAttr:void 0};let Ft=Be.length;for(;Ft--;){const nn=Be[Ft],{name:un,namespaceURI:hn,value:Un}=nn,Br=Ct(un),Ya=Un;let sn=un==="value"?Ya:ok(Ya);if(Ue.attrName=Br,Ue.attrValue=sn,Ue.keepAttr=!0,Ue.forceKeepAttr=void 0,Nn(z.uponSanitizeAttribute,ce,Ue),sn=Ue.attrValue,Ke&&(Br==="id"||Br==="name")&&(cn(un,ce),sn=$e+sn),Xe&&qn(/((--!?|])>)|<\/(style|title|textarea)/i,sn)){cn(un,ce);continue}if(Br==="attributename"&&Xc(sn,"href")){cn(un,ce);continue}if(Ue.forceKeepAttr)continue;if(!Ue.keepAttr){cn(un,ce);continue}if(!be&&qn(/\/>/i,sn)){cn(un,ce);continue}Me&&Qo([M,q,T],Xa=>{sn=Di(sn,Xa," ")});const yi=Ct(ce.nodeName);if(!Wa(yi,Br,sn)){cn(un,ce);continue}if(S&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!hn)switch(m.getAttributeType(yi,Br)){case"TrustedHTML":{sn=S.createHTML(sn);break}case"TrustedScriptURL":{sn=S.createScriptURL(sn);break}}if(sn!==Ya)try{hn?ce.setAttributeNS(hn,un,sn):ce.setAttribute(un,sn),jn(ce)?fn(ce):dv(e.removed)}catch{cn(un,ce)}}Nn(z.afterSanitizeAttributes,ce,null)},Po=function ot(ce){let Be=null;const Ue=en(ce);for(Nn(z.beforeSanitizeShadowDOM,ce,null);Be=Ue.nextNode();)Nn(z.uponSanitizeShadowNode,Be,null),xr(Be),kr(Be),Be.content instanceof s&&ot(Be.content);Nn(z.afterSanitizeShadowDOM,ce,null)};return e.sanitize=function(ot){let ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Be=null,Ue=null,Ft=null,nn=null;if(Rt=!ot,Rt&&(ot="<!-->"),typeof ot!="string"&&!On(ot))if(typeof ot.toString=="function"){if(ot=ot.toString(),typeof ot!="string")throw Ri("dirty is not a string, aborting")}else throw Ri("toString is not a function");if(!e.isSupported)return ot;if(ct||Pt(ce),e.removed=[],typeof ot=="string"&&(Ge=!1),Ge){if(ot.nodeName){const Un=Ct(ot.nodeName);if(!te[Un]||ae[Un])throw Ri("root node is forbidden and cannot be sanitized in-place")}}else if(ot instanceof l)Be=Jt("<!---->"),Ue=Be.ownerDocument.importNode(ot,!0),Ue.nodeType===ji.element&&Ue.nodeName==="BODY"||Ue.nodeName==="HTML"?Be=Ue:Be.appendChild(Ue);else{if(!Oe&&!Me&&!Je&&ot.indexOf("<")===-1)return S&&Ne?S.createHTML(ot):ot;if(Be=Jt(ot),!Be)return Oe?null:Ne?K:""}Be&&De&&fn(Be.firstChild);const un=en(Ge?ot:Be);for(;Ft=un.nextNode();)xr(Ft),kr(Ft),Ft.content instanceof s&&Po(Ft.content);if(Ge)return ot;if(Oe){if(qe)for(nn=Q.call(Be.ownerDocument);Be.firstChild;)nn.appendChild(Be.firstChild);else nn=Be;return(H.shadowroot||H.shadowrootmode)&&(nn=xe.call(r,nn,!0)),nn}let hn=Je?Be.outerHTML:Be.innerHTML;return Je&&te["!doctype"]&&Be.ownerDocument&&Be.ownerDocument.doctype&&Be.ownerDocument.doctype.name&&qn(mg,Be.ownerDocument.doctype.name)&&(hn="<!DOCTYPE "+Be.ownerDocument.doctype.name+`>
`+hn),Me&&Qo([M,q,T],Un=>{hn=Di(hn,Un," ")}),S&&Ne?S.createHTML(hn):hn},e.setConfig=function(){let ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pt(ot),ct=!0},e.clearConfig=function(){Mn=null,ct=!1},e.isValidAttribute=function(ot,ce,Be){Mn||Pt({});const Ue=Ct(ot),Ft=Ct(ce);return Wa(Ue,Ft,Be)},e.addHook=function(ot,ce){typeof ce=="function"&&Ni(z[ot],ce)},e.removeHook=function(ot,ce){if(ce!==void 0){const Be=ak(z[ot],ce);return Be===-1?void 0:sk(z[ot],Be,1)[0]}return dv(z[ot])},e.removeHooks=function(ot){z[ot]=[]},e.removeAllHooks=function(){z=mv()},e}var xk=yg();function kk(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${yv(t.from)} |`),e.push(`| **To** | ${yv(t.to)} |`),e.push(`| **Date** | ${kd(t.date)} |`),e.push(""),e.push("---"),e.push("");const n=t.htmlBody?Sk(t.htmlBody):null;return e.push(n||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function yv(t){return(t||"").replace(/\|/g,"\\|")}function Sk(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const n of e.querySelectorAll("style, script, head"))n.remove();return Bu(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Ek(t,e){if(!e||e.startsWith("data:"))return!0;const n=parseInt(t.getAttribute("width"),10),r=parseInt(t.getAttribute("height"),10);if(n>0&&n<=3||r>0&&r<=3)return!0;const a=e.toLowerCase();return a.includes("spacer")||a.includes("transparent")||a.includes("transp.gif")||a.includes("/track")&&a.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(a)?!0:a.includes("mail.google.com/mail/u/")&&a.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(a)||a.endsWith(".gif")&&a.includes("1x1"))}function Bu(t){var a;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const s=t.getAttribute("src")||"",i=t.getAttribute("alt")||"";return Ek(t,s)?"":`![${i}](${s})`}const n=Array.from(t.childNodes).map(Bu).join(""),r=n.trim();if(!r&&!["img","br","hr"].includes(e))return n;if(e==="p"||e==="div")return`

${r}

`;if(e==="blockquote")return`

> ${r.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const s=Number(e[1]);return`

${"#".repeat(s)} ${r}

`}if(e==="ul"||e==="ol")return`

${n}

`;if(e==="li")return`${((a=t.parentElement)==null?void 0:a.tagName.toLowerCase())==="ol"?"1.":"-"} ${r}
`;if(e==="a"){const s=t.getAttribute("href")||"";return!s||s.startsWith("mailto:")?r:r===s?s:`[${r}](${s})`}if(e==="strong"||e==="b")return`**${r}**`;if(e==="em"||e==="i")return`*${r}*`;if(e==="code")return`\`${r}\``;if(e==="table")return`

${n}

`;if(e==="tr")return`| ${Array.from(t.children).map(i=>Bu(i).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return n;if(e==="thead"){const s=n.trim(),i=(s.match(/\|/g)||[]).length-1,l="| "+Array(Math.max(i,1)).fill("---").join(" | ")+" |";return`${s}${l}
`}return n}function Ak(t){return Mp(t,"md")}function _v(t,e,n="text/markdown;charset=utf-8"){const r=new Blob([t],{type:n}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}function Tk(t){return t.raw||null}function Ck(t){const e=Tk(t);return e?JSON.stringify(e,null,2):"null"}function Ik(t){return Mp(t,"json")}var Pk=L('<button title="View as Markdown">.md</button>'),Mk=L('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Ok=L('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Nk=L('<div class="md-preview svelte-1b0rzpb"><!></div>'),Dk=L('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Rk=L('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Lk=L('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),jk=L('<pre class="message-text svelte-1b0rzpb"> </pre>'),zk=L('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),qk=L('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Bk=L('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Fk(t,e){at(e,!0);let n=Ae(e,"loading",3,!1);_n(()=>dr("MessageModal"));const r=new Vt.Renderer;r.link=({href:M,title:q,text:T})=>{const D=q?` title="${q}"`:"";return`<a href="${M}"${D} target="_blank" rel="noopener">${T}</a>`},Vt.setOptions({breaks:!0,gfm:!0,renderer:r});let a=Pe("email"),s=J(()=>e.message.body?kk(e.message):""),i=J(()=>Ck(e.message)),l=Pe("raw");function u(M){P(a,o(a)===M?"email":M,!0),M==="markdown"&&P(l,"raw")}function d(){_v(o(s),Ak(e.message))}function v(){_v(o(i),Ik(e.message),"application/json;charset=utf-8")}function p(M){const q=Vt.parse(M);return xk.sanitize(q,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let h=Pe(null);yn(()=>{var M;if(o(h)&&e.message.htmlBody&&!n()&&o(a)==="email"){const q=o(h).contentDocument||((M=o(h).contentWindow)==null?void 0:M.document);q&&(q.open(),q.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),q.close())}});var m=Bk();m.__click=function(...M){var q;(q=e.onclose)==null||q.apply(this,M)};var x=_(m);x.__click=M=>M.stopPropagation();var k=_(x),E=_(k),N=_(E),j=b(E,2),V=_(j);let S;V.__click=()=>u("json");var K=b(V,2);{var B=M=>{var q=Pk();let T;q.__click=()=>u("markdown"),oe(()=>T=St(q,1,"action-btn svelte-1b0rzpb",null,T,{active:o(a)==="markdown"})),C(M,q)};ue(K,M=>{e.message.body&&M(B)})}var O=b(K,2);O.__click=function(...M){var q;(q=e.onclose)==null||q.apply(this,M)};var Q=b(k,2);{var se=M=>{var q=Mk(),T=Ye(q),D=b(_(T),2);D.__click=v;var I=b(T,2),X=_(I),Y=_(X);oe(()=>ee(Y,o(i))),C(M,q)},xe=M=>{var q=Dk(),T=Ye(q),D=_(T),I=_(D);let X;I.__click=()=>P(l,"raw");var Y=b(I,2);let Z;Y.__click=()=>P(l,"preview");var U=b(D,2);U.__click=d;var te=b(T,2),ie=_(te);{var H=re=>{var ae=Ok(),pe=_(ae);oe(()=>ee(pe,o(s))),C(re,ae)},G=re=>{var ae=Nk(),pe=_(ae);h_(pe,()=>p(o(s))),C(re,ae)};ue(ie,re=>{o(l)==="raw"?re(H):re(G,!1)})}oe(()=>{X=St(I,1,"md-tab svelte-1b0rzpb",null,X,{active:o(l)==="raw"}),Z=St(Y,1,"md-tab svelte-1b0rzpb",null,Z,{active:o(l)==="preview"})}),C(M,q)},z=M=>{var q=qk(),T=Ye(q),D=_(T),I=b(_(D),2),X=_(I),Y=b(D,2),Z=b(_(Y),2),U=_(Z),te=b(Y,2),ie=b(_(te),2),H=_(ie),G=b(T,2),re=_(G);{var ae=$=>{var ke=Rk();C($,ke)},pe=$=>{var ke=Lk();Cs(ke,be=>P(h,be),()=>o(h)),C($,ke)},_e=$=>{var ke=jk(),be=_(ke);oe(()=>ee(be,e.message.body)),C($,ke)},ne=$=>{var ke=zk();C($,ke)};ue(re,$=>{n()?$(ae):e.message.htmlBody?$(pe,1):e.message.body?$(_e,2):$(ne,!1)})}oe($=>{ee(X,e.message.from),ee(U,e.message.to),ee(H,$)},[()=>kd(e.message.date)]),C(M,q)};ue(Q,M=>{o(a)==="json"?M(se):o(a)==="markdown"?M(xe,1):M(z,!1)})}oe(()=>{ee(N,e.message.subject),S=St(V,1,"action-btn svelte-1b0rzpb",null,S,{active:o(a)==="json"})}),C(t,m),st()}Xt(["click"]);var Kk=L('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),Hk=L('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),Gk=L('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Uk=L("<p> </p>"),Vk=L('<p>No emails in local storage. Click "Sync New" to download.</p>'),Wk=L('<div class="empty-state svelte-6ts5xm"><!></div>'),Yk=L('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),Xk=L('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Zk(t,e){at(e,!0),_n(()=>dr("DashboardView"));let n=Ae(e,"error",3,null),r=Ae(e,"profile",3,null),a=Ae(e,"loadingProfile",3,!1),s=Ae(e,"emailMessages",19,()=>[]),i=Ae(e,"totalLocalMessages",3,0),l=Ae(e,"hasMoreLocal",3,!1),u=Ae(e,"loadingMessages",3,!1),d=Ae(e,"selectedMessage",3,null),v=Ae(e,"syncStatus",3,null),p=Ae(e,"syncProgress",3,null),h=Ae(e,"isSyncing",3,!1),m=Ae(e,"searchQuery",15);var x=Xk(),k=Ye(x),E=_(k);{var N=D=>{ng(D,{get error(){return n()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};ue(E,D=>{n()&&D(N)})}var j=b(E,2);X1(j,{get profile(){return r()},get loadingProfile(){return a()},get onsignout(){return e.onsignout}});var V=b(j,2);lx(V,{get syncStatus(){return v()},get syncProgress(){return p()},get isSyncing(){return h()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var S=b(V,2),K=_(S);K.__keydown=D=>D.key==="Enter"&&e.onsearch();var B=b(K,2);B.__click=function(...D){var I;(I=e.onsearch)==null||I.apply(this,D)};var O=_(B),Q=b(S,2);{var se=D=>{var I=Hk(),X=Ye(I),Y=_(X),Z=_(Y),U=b(X,2);dx(U,{get messages(){return s()},get onselect(){return e.onviewmessage}});var te=b(U,2);{var ie=H=>{var G=Kk(),re=_(G);re.__click=function(...pe){var _e;(_e=e.onloadmore)==null||_e.apply(this,pe)};var ae=_(re);oe(()=>{re.disabled=u(),ee(ae,u()?"Loading...":"Load More")}),C(H,G)};ue(te,H=>{l()&&H(ie)})}oe(H=>ee(Z,`Showing ${s().length??""} of ${H??""}
        ${m()?" matching":""} emails`),[()=>i().toLocaleString()]),C(D,I)},xe=D=>{var I=Gk();C(D,I)},z=D=>{var I=Wk(),X=_(I);{var Y=U=>{var te=Uk(),ie=_(te);oe(()=>ee(ie,`No emails match "${m()??""}".`)),C(U,te)},Z=U=>{var te=Vk();C(U,te)};ue(X,U=>{m()?U(Y):U(Z,!1)})}C(D,I)},M=D=>{var I=Yk();C(D,I)};ue(Q,D=>{var I;s().length>0?D(se):u()?D(xe,1):(I=v())!=null&&I.synced?D(z,2):D(M,!1)})}var q=b(k,2);{var T=D=>{Fk(D,{get message(){return d()},loading:!1,get onclose(){return e.onclosedetail}})};ue(q,D=>{d()&&D(T)})}oe(()=>{B.disabled=u(),ee(O,u()?"Searching...":"Search")}),Zr(K,m),C(t,x),st()}Xt(["keydown","click"]);var Qk=L('<div class="dashboard svelte-1q5o2lv"><!></div>');function Jk(t,e){at(e,!0);function n(be){be.key==="Escape"&&o(h)&&ie()}let r=null;_n(async()=>{if(window.addEventListener("keydown",n),!o(l)){const be=await wa("googleClientId");P(l,be||i,!0),P(u,be||i,!0)}return()=>{window.removeEventListener("keydown",n),r&&clearTimeout(r)}});function a(){r&&clearTimeout(r);const be=Z0();if(be<=0)return;const Me=Math.max(0,be-120*1e3);r=setTimeout(async()=>{try{const Xe=await tv();P(v,Xe.access_token,!0),a()}catch{P(v,null),P(p,null),P(S,"Session expired. Please sign in again.")}},Me)}async function s(){if(X0())return o(v);try{const be=await tv();return P(v,be.access_token,!0),a(),o(v)}catch{return P(v,null),P(p,null),P(S,"Session expired. Please sign in again."),null}}const i="562478245230-1gohf6dtsajqo1lu3kge9k7cthm4sdv6.apps.googleusercontent.com";let l=Pe(Wt(i)),u=Pe(Wt(i)),d=Pe(!1),v=Pe(null),p=Pe(null),h=Pe(null),m=Pe(""),x=Pe(Wt([])),k=Pe(0),E=Pe(0),N=Pe(!1),j=Pe(!1),V=Pe(!1),S=Pe(null),K=Pe(null),B=Pe(null),O=Pe(!1);const Q=50;yn(()=>{o(v)&&(H(),Y())});let se=J(()=>!o(l)),xe=J(()=>o(l)===i),z=J(()=>!!o(v)),M=J(()=>o(x).length<o(k));yn(()=>{o(l)&&!o(d)&&nv(o(l)).then(async()=>{if(P(d,!0),!o(v)){const be=await tc();be&&(P(v,be.access_token,!0),a(),X())}}).catch(be=>{P(S,`Auth init failed: ${be.message}`)})});async function q(){const be=o(u).trim();be&&(await ii("googleClientId",be),P(l,be,!0),P(S,null))}async function T(){await _d("googleClientId"),P(l,""),P(u,i),P(d,!1),P(v,null),P(p,null),P(x,[],!0),P(k,0)}async function D(){P(S,null),P(j,!0);try{o(d)||(await nv(o(l)),P(d,!0));const be=await J0();P(v,be.access_token,!0),a(),await X()}catch(be){P(S,be.message,!0)}finally{P(j,!1)}}async function I(){if(r&&clearTimeout(r),o(v))try{await $0(o(v))}catch{}P(v,null),P(p,null),P(x,[],!0),P(k,0),P(h,null),P(S,null)}async function X(){P(V,!0);try{const be=await Ap(o(v));if(!o(v))return;P(p,be,!0)}catch(be){if(!o(v))return;P(S,`Profile fetch failed: ${be.message}`)}finally{P(V,!1)}}async function Y(be=!1){P(N,!0);try{const Me=be?o(E):0,Xe=await cb({query:o(m)||void 0,limit:Q,offset:Me});be?P(x,[...o(x),...Xe.items],!0):P(x,Xe.items,!0),P(k,Xe.total,!0),P(E,o(x).length,!0)}catch(Me){P(S,`Failed to load messages: ${Me.message}`)}finally{P(N,!1)}}function Z(){P(E,0),Y(!1)}function U(){Y(!0)}function te(be){P(h,be,!0)}function ie(){P(h,null)}async function H(){try{P(K,await S1(),!0)}catch{}}async function G(be){if(o(O)||!o(v))return;const Me=await s();if(!Me)return;P(S,null),P(O,!0),P(B,null);const Xe=new AbortController;try{await x1(Me,{limit:be,onProgress:Je=>{P(B,{...Je},!0)},signal:Xe.signal}),await H(),await Y(!1)}catch(Je){if(Je.name!=="AbortError"){if(!o(v))return;P(S,`Sync failed: ${Je.message}`)}}finally{P(O,!1)}}async function re(be){if(o(O)||!o(v))return;const Me=await s();if(!Me)return;P(S,null),P(O,!0),P(B,null);const Xe=new AbortController;try{await k1(Me,{limit:be,onProgress:Je=>{P(B,{...Je},!0)},signal:Xe.signal}),await H(),await Y(!1)}catch(Je){if(Je.name!=="AbortError"){if(!o(v))return;P(S,`Sync more failed: ${Je.message}`)}}finally{P(O,!1)}}async function ae(){try{await Jp(),await H(),P(x,[],!0),P(k,0),P(E,0)}catch(be){P(S,`Failed to clear data: ${be.message}`)}}var pe=Qk(),_e=_(pe);{var ne=be=>{O1(be,{onsave:q,defaultClientId:i,get clientIdInput(){return o(u)},set clientIdInput(Me){P(u,Me,!0)}})},$=be=>{U1(be,{get clientId(){return o(l)},get isDefaultClientId(){return o(xe)},get error(){return o(S)},get loadingAuth(){return o(j)},onsignin:D,onclear:T,onsignout:I})},ke=be=>{Zk(be,{get error(){return o(S)},get profile(){return o(p)},get loadingProfile(){return o(V)},get emailMessages(){return o(x)},get totalLocalMessages(){return o(k)},get hasMoreLocal(){return o(M)},get loadingMessages(){return o(N)},get selectedMessage(){return o(h)},get syncStatus(){return o(K)},get syncProgress(){return o(B)},get isSyncing(){return o(O)},onsignout:I,onsearch:Z,onloadmore:U,onviewmessage:te,onclosedetail:ie,ondismisserror:()=>P(S,null),onsync:G,onsyncmore:re,oncleardata:ae,get searchQuery(){return o(m)},set searchQuery(Me){P(m,Me,!0)}})};ue(_e,be=>{o(se)?be(ne):o(z)?be(ke,!1):be($,1)})}C(t,pe),st()}var $k=L('<span class="err svelte-t1ig66"> </span>'),e2=L('<div class="totals svelte-t1ig66"> <!> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),t2=L('<span class="stream-stats svelte-t1ig66"> </span>'),n2=L('<div class="stream-box svelte-t1ig66"><div class="stream-head svelte-t1ig66"><span class="stream-email svelte-t1ig66"> </span> <!></div> <pre class="stream-output svelte-t1ig66"> </pre></div>'),r2=L('<span class="ei-group svelte-t1ig66"> </span>'),a2=L('<span class="ei-tag svelte-t1ig66"> </span> <!>',1),s2=L('<span class="ei-tag err svelte-t1ig66">ERROR</span>'),i2=L('<span class="sep svelte-t1ig66">Â·</span> ',1),o2=L('<div class="ei-summary svelte-t1ig66"> </div>'),l2=L('<div class="ei-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),c2=L('<details class="ei-llm svelte-t1ig66"><summary class="svelte-t1ig66">LLM output</summary> <pre class="ei-llm-text svelte-t1ig66"> </pre></details>'),u2=L("<!> <!> <!>",1),d2=L('<div class="ei-error svelte-t1ig66"> </div>'),f2=L('<div><div class="ei-row svelte-t1ig66"><span class="ei-num svelte-t1ig66"></span> <span class="ei-subj svelte-t1ig66"> </span> <!></div> <div class="ei-from svelte-t1ig66"> <!></div> <!></div>'),v2=L('<div class="history svelte-t1ig66"><div class="history-head svelte-t1ig66"><span class="history-title svelte-t1ig66">Processed emails</span> <span class="history-count svelte-t1ig66"> </span></div> <!></div>'),h2=L('<span class="sep svelte-t1ig66">Â·</span><span class="err svelte-t1ig66"> </span>',1),p2=L('<span class="sep svelte-t1ig66">Â·</span><span class="svelte-t1ig66"> </span>',1),g2=L(' <span class="sep svelte-t1ig66">Â·</span>',1),m2=L('<div class="summary svelte-t1ig66"><div class="summary-stats svelte-t1ig66"><span class="svelte-t1ig66"> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="good svelte-t1ig66"> </span> <!> <!></div> <div class="summary-perf svelte-t1ig66"><!> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div></div>'),y2=L('<button class="btn svelte-t1ig66">View Prompt</button> <button class="btn primary svelte-t1ig66">Close</button>',1),_2=L('<button class="btn svelte-t1ig66">View Prompt</button> <button class="btn stop svelte-t1ig66">Stop</button>',1),b2=L('<div class="scan-view svelte-t1ig66"><div class="header svelte-t1ig66"><span class="title svelte-t1ig66"><!></span> <span class="pct svelte-t1ig66"> </span></div> <div class="bar svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="btns svelte-t1ig66"><!></div></div>');function w2(t,e){at(e,!0);let n=Ae(e,"progress",3,null);function r(h){return!h||h<0?"â":h<1e3?`${Math.round(h)}ms`:`${(h/1e3).toFixed(1)}s`}function a(h){return h?h>=1e3?`${(h/1e3).toFixed(1)}k`:String(h):"0"}function s(h){if(!h)return"â";const m=h.replace(/<.*>/,"").trim();return m.length>30?m.slice(0,28)+"â¦":m}function i(h){if(!h)return"";try{return new Date(h).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let l=J(()=>{var h;return(h=n())!=null&&h.total?Math.round(n().current/n().total*100):0}),u=J(()=>{var h;return((h=n())==null?void 0:h.phase)==="done"});var d=an(),v=Ye(d);{var p=h=>{var m=b2(),x=_(m),k=_(x),E=_(k);{var N=ie=>{var H=on();oe(()=>ee(H,`Scan complete â ${(n().classified||0)??""} classified`)),C(ie,H)},j=ie=>{var H=on("Loading emailsâ¦");C(ie,H)},V=ie=>{var H=on();oe(()=>ee(H,`Processing ${n().current??0??""} / ${n().total??0??""}`)),C(ie,H)};ue(E,ie=>{o(u)?ie(N):n().phase==="loading"?ie(j,1):ie(V,!1)})}var S=b(k,2),K=_(S),B=b(x,2),O=_(B);let Q,se;var xe=b(B,2);{var z=ie=>{var H=e2(),G=_(H),re=b(G);{var ae=ne=>{var $=$k(),ke=_($);oe(()=>ee(ke,`Â· ${n().errors??""} errors`)),C(ne,$)};ue(re,ne=>{n().errors&&ne(ae)})}var pe=b(re,3),_e=b(pe,2);oe((ne,$,ke)=>{ee(G,`${(n().classified||0)??""} classified `),ee(pe,` ${ne??""} in + ${$??""} out `),ee(_e,` ${ke??""}`)},[()=>a(n().totals.inputTokens),()=>a(n().totals.outputTokens),()=>r(n().totals.elapsed)]),C(ie,H)};ue(xe,ie=>{n().totals&&!o(u)&&ie(z)})}var M=b(xe,2);{var q=ie=>{var H=n2(),G=_(H),re=_(G),ae=_(re),pe=b(re,2);{var _e=ke=>{var be=t2(),Me=_(be);oe(Xe=>ee(Me,`${Xe??""} tok/s Â· ${(n().live.numTokens||0)??""} tokens`),[()=>n().live.tps.toFixed(0)]),C(ke,be)};ue(pe,ke=>{var be;(be=n().live)!=null&&be.tps&&ke(_e)})}var ne=b(G,2),$=_(ne);oe(()=>{ee(ae,n().email.subject||"(no subject)"),ee($,n().streamingText||"Waiting for modelâ¦")}),C(ie,H)};ue(M,ie=>{!o(u)&&n().email&&(n().phase==="generating"||n().phase==="scanning")&&ie(q)})}var T=b(M,2);{var D=ie=>{var H=v2(),G=_(H),re=b(_(G),2),ae=_(re),pe=b(G,2);Ot(pe,17,()=>n().results,Ut,(_e,ne,$)=>{var ke=f2();let be;var Me=_(ke),Xe=_(Me);Xe.textContent=`${$+1}.`;var Je=b(Xe,2),ct=_(Je),De=b(Je,2);{var Oe=nt=>{var ft=a2(),mt=Ye(ft),vt=_(mt),kt=b(mt,2);{var bt=pt=>{const yt=J(()=>nr[o(ne).classification.group]);var dt=an(),je=Ye(dt);{var Rt=At=>{var Gt=r2();let Re;var Qt=_(Gt);oe(()=>{xt(Gt,"title",o(yt).description),Re=Dt(Gt,"",Re,{color:o(yt).color}),ee(Qt,o(yt).label)}),C(At,Gt)};ue(je,At=>{o(yt)&&At(Rt)})}C(pt,dt)};ue(kt,pt=>{o(ne).classification.group&&pt(bt)})}oe(()=>ee(vt,o(ne).classification.action)),C(nt,ft)},qe=nt=>{var ft=s2();C(nt,ft)};ue(De,nt=>{o(ne).success?nt(Oe):nt(qe,!1)})}var Ne=b(Me,2),Fe=_(Ne),Ke=b(Fe);{var $e=nt=>{var ft=i2(),mt=b(Ye(ft),1,!0);oe(vt=>ee(mt,vt),[()=>i(o(ne).email.date)]),C(nt,ft)};ue(Ke,nt=>{o(ne).email.date&&nt($e)})}var Ze=b(Ne,2);{var Ge=nt=>{var ft=u2(),mt=Ye(ft);{var vt=dt=>{var je=o2(),Rt=_(je);oe(()=>ee(Rt,o(ne).classification.summary)),C(dt,je)};ue(mt,dt=>{o(ne).classification.summary&&dt(vt)})}var kt=b(mt,2);{var bt=dt=>{var je=l2(),Rt=_(je),At=b(Rt,2),Gt=b(At,2);oe((Re,Qt)=>{ee(Rt,`${Re??""} `),ee(At,` ${(o(ne).stats.inputTokens||0)??""} in + ${(o(ne).stats.numTokens||0)??""} out `),ee(Gt,` ${Qt??""}`)},[()=>o(ne).stats.tps?`${o(ne).stats.tps.toFixed(0)} tok/s`:"â",()=>r(o(ne).stats.elapsed)]),C(dt,je)};ue(kt,dt=>{o(ne).stats&&dt(bt)})}var pt=b(kt,2);{var yt=dt=>{var je=c2(),Rt=b(_(je),2),At=_(Rt);oe(()=>ee(At,o(ne).rawResponse)),C(dt,je)};ue(pt,dt=>{o(ne).rawResponse&&dt(yt)})}C(nt,ft)},tt=nt=>{var ft=d2(),mt=_(ft);oe(()=>ee(mt,o(ne).error)),C(nt,ft)};ue(Ze,nt=>{o(ne).success?nt(Ge):nt(tt,!1)})}oe(nt=>{be=St(ke,1,"email-item svelte-t1ig66",null,be,{failed:!o(ne).success}),ee(ct,o(ne).email.subject||"(no subject)"),ee(Fe,nt)},[()=>s(o(ne).email.from)]),C(_e,ke)}),oe(()=>ee(ae,n().results.length)),C(ie,H)};ue(T,ie=>{var H;((H=n().results)==null?void 0:H.length)>0&&ie(D)})}var I=b(T,2);{var X=ie=>{var H=m2(),G=_(H),re=_(G),ae=_(re),pe=b(re,4),_e=_(pe),ne=b(pe,2);{var $=qe=>{var Ne=h2(),Fe=b(Ye(Ne)),Ke=_(Fe);oe(()=>ee(Ke,`${n().errors??""} errors`)),C(qe,Ne)};ue(ne,qe=>{n().errors>0&&qe($)})}var ke=b(ne,2);{var be=qe=>{var Ne=p2(),Fe=b(Ye(Ne)),Ke=_(Fe);oe(()=>ee(Ke,`${n().summary.skipped??""} skipped`)),C(qe,Ne)};ue(ke,qe=>{var Ne;(Ne=n().summary)!=null&&Ne.skipped&&qe(be)})}var Me=b(G,2),Xe=_(Me);{var Je=qe=>{var Ne=g2(),Fe=Ye(Ne);oe(()=>ee(Fe,`Avg ${n().summary.avgTps??""} tok/s`)),C(qe,Ne)};ue(Xe,qe=>{var Ne;(Ne=n().summary)!=null&&Ne.avgTps&&qe(Je)})}var ct=b(Xe),De=b(ct,2),Oe=b(De,2);oe((qe,Ne,Fe)=>{var Ke,$e;ee(ae,`${(((Ke=n().summary)==null?void 0:Ke.processed)||n().total||0)??""} processed`),ee(_e,`${(n().classified||0)??""} classified`),ee(ct,` ${qe??""} in + ${Ne??""} out `),ee(De,` ${Fe??""} `),ee(Oe,` Model: ${((($e=n().summary)==null?void 0:$e.modelName)||"Unknown")??""}`)},[()=>a(n().totals.inputTokens),()=>a(n().totals.outputTokens),()=>r(n().totals.elapsed)]),C(ie,H)};ue(I,ie=>{o(u)&&n().totals&&ie(X)})}var Y=b(I,2),Z=_(Y);{var U=ie=>{var H=y2(),G=Ye(H);G.__click=function(...ae){var pe;(pe=e.oninspect)==null||pe.apply(this,ae)};var re=b(G,2);re.__click=function(...ae){var pe;(pe=e.onclose)==null||pe.apply(this,ae)},C(ie,H)},te=ie=>{var H=_2(),G=Ye(H);G.__click=function(...ae){var pe;(pe=e.oninspect)==null||pe.apply(this,ae)};var re=b(G,2);re.__click=function(...ae){var pe;(pe=e.onstop)==null||pe.apply(this,ae)},C(ie,H)};ue(Z,ie=>{o(u)?ie(U):ie(te,!1)})}oe(()=>{ee(K,`${o(l)??""}%`),Q=St(O,1,"bar-fill svelte-t1ig66",null,Q,{done:o(u)}),se=Dt(O,"",se,{width:`${o(l)??""}%`})}),C(h,m)};ue(v,h=>{n()&&h(p)})}C(t,d),st()}Xt(["click"]);var x2=L('<span class="spinner svelte-ois7em"></span>'),k2=mn('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),S2=L('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),E2=L("<option> </option>"),A2=L('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),T2=L('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function C2(t,e){at(e,!0);let n=Ae(e,"engineStatus",3,"idle"),r=Ae(e,"modelName",3,""),a=Ae(e,"isScanning",3,!1),s=Ae(e,"scanProgress",3,null),i=Ae(e,"scanCount",15,20),l=Ae(e,"stats",3,null);const u=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function d(){return n()==="ready"?`${r()} ready`:n()==="loading"?"Loading model...":n()==="generating"?"Model busy...":"No model loaded"}function v(){return n()==="ready"?"#34d399":n()==="loading"?"#fbbf24":"#666"}function p(){return n()==="ready"&&!a()}let h=J(()=>{var H;return a()&&((H=s())==null?void 0:H.phase)!=="done"});var m=T2(),x=_(m),k=_(x),E=_(k);{var N=H=>{var G=x2();C(H,G)},j=H=>{var G=k2();C(H,G)};ue(E,H=>{o(h)?H(N):H(j,!1)})}var V=b(k,2),S=_(V),K=b(_(S),2);K.__click=function(...H){var G;(G=e.oninspect)==null||G.apply(this,H)};var B=b(S,2),O=_(B);let Q;var se=b(O),xe=b(x,2);{var z=H=>{var G=S2(),re=_(G),ae=_(re),pe=b(re,4),_e=_(pe),ne=b(pe,4),$=_(ne);oe(()=>{ee(ae,`${l().totalEmails??""} emails in storage`),ee(_e,`${l().classified??""} classified`),ee($,`${l().unclassified??""} new`)}),C(H,G)};ue(xe,H=>{l()&&H(z)})}var M=b(xe,2),q=_(M),T=b(_(q),2);Ot(T,21,()=>u,Ut,(H,G)=>{var re=E2(),ae=_(re),pe={};oe(()=>{ee(ae,o(G).label),pe!==(pe=o(G).value)&&(re.value=(re.__value=o(G).value)??"")}),C(H,re)});var D=b(q,2),I=_(D);I.__click=function(...H){var G;(G=e.onscan)==null||G.apply(this,H)};var X=_(I),Y=b(I,2);Y.__click=function(...H){var G;(G=e.onrescan)==null||G.apply(this,H)};var Z=b(M,2);{var U=H=>{var G=A2();C(H,G)};ue(Z,H=>{n()!=="ready"&&n()!=="loading"&&H(U)})}var te=b(Z,2);{var ie=H=>{w2(H,{get progress(){return s()},get onstop(){return e.onstop},get oninspect(){return e.oninspect},get onclose(){return e.oncloseprogress}})};ue(te,H=>{var G;(a()||((G=s())==null?void 0:G.phase)==="done")&&H(ie)})}oe((H,G,re,ae)=>{Q=Dt(O,"",Q,H),ee(se,` ${G??""}`),T.disabled=a(),I.disabled=re,ee(X,o(h)?"Scanning...":a()?"Finalizing...":"Scan New"),Y.disabled=ae},[()=>({background:v()}),d,()=>!p(),()=>!p()]),pi(T,i),C(t,m),st()}Xt(["click"]);var I2=L('<span class="row-date svelte-1czytqk"> </span>'),P2=L('<span class="tag svelte-1czytqk"> </span>'),M2=L('<span class="row-tags svelte-1czytqk"></span>'),O2=L('<span class="row-reason svelte-1czytqk"> </span>'),N2=L('<button class="icon-btn exec-btn svelte-1czytqk" title="Execute actions"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></button>'),D2=L('<!> <button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),R2=L('<span class="status-label svelte-1czytqk"> </span>'),L2=L('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),j2=L('<p class="summary-reason svelte-1czytqk"> </p>'),z2=L('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),q2=L('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function bv(t,e){at(e,!0);let n=Ae(e,"actionColor",3,"#666"),r=Ae(e,"dimmed",3,!1);function a(D){if(!D)return"";try{return new Date(D).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let s=J(()=>e.item.status==="pending"),i=Pe(!1);var l=q2(),u=Ye(l);let d;var v=_(u);v.__click=()=>P(i,!o(i));let p;var h=_(v),m=_(h),x=b(h,2),k=_(x),E=_(k),N=b(k,2);{var j=D=>{var I=I2(),X=_(I);oe(Y=>ee(X,Y),[()=>a(e.item.date)]),C(D,I)};ue(N,D=>{e.item.date&&D(j)})}var V=b(x,2);{var S=D=>{var I=M2();Ot(I,21,()=>e.item.tags,Ut,(X,Y)=>{var Z=P2();let U;var te=_(Z);oe(ie=>{U=Dt(Z,"",U,ie),ee(te,o(Y))},[()=>({background:zb(o(Y))})]),C(X,Z)}),C(D,I)};ue(V,D=>{e.item.tags&&e.item.tags.length>0&&D(S)})}var K=b(V,2);{var B=D=>{var I=O2(),X=_(I);oe(()=>ee(X,e.item.reason)),C(D,I)};ue(K,D=>{e.item.reason&&!o(i)&&D(B)})}var O=b(v,2),Q=_(O);{var se=D=>{var I=D2(),X=Ye(I);{var Y=te=>{var ie=N2();ie.__click=H=>{H.stopPropagation(),e.onexecute(e.item)},C(te,ie)};ue(X,te=>{e.onexecute&&te(Y)})}var Z=b(X,2);Z.__click=te=>{te.stopPropagation(),e.onmarkacted(e.item.emailId)};var U=b(Z,2);U.__click=te=>{te.stopPropagation(),e.ondismiss(e.item.emailId)},C(D,I)},xe=D=>{var I=R2(),X=_(I);oe(()=>ee(X,e.item.status)),C(D,I)};ue(Q,D=>{o(s)?D(se):D(xe,!1)})}var z=b(Q,2);{var M=D=>{var I=L2();I.__click=X=>{X.stopPropagation(),e.onremove(e.item.emailId)},C(D,I)};ue(z,D=>{e.onremove&&D(M)})}var q=b(u,2);{var T=D=>{var I=z2();let X;var Y=_(I),Z=_(Y),U=b(Y,2);{var te=ie=>{var H=j2(),G=_(H);oe(()=>ee(G,e.item.reason)),C(ie,H)};ue(U,ie=>{e.item.reason&&ie(te)})}oe(()=>{X=Dt(I,"",X,{"border-left-color":n()}),ee(Z,e.item.summary)}),C(D,I)};ue(q,D=>{o(i)&&e.item.summary&&D(T)})}oe(()=>{d=St(u,1,"email-row svelte-1czytqk",null,d,{dimmed:r()}),p=Dt(v,"",p,{"border-left-color":n()}),ee(m,e.item.subject),ee(E,e.item.from)}),C(t,l),st()}Xt(["click"]);var B2=L('<span class="group-acted svelte-tl1unp"> </span>'),F2=L('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),K2=L('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),H2=L('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),G2=L('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),U2=L('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),V2=L('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function W2(t,e){at(e,!0);let n=Ae(e,"color",3,"#888");Ae(e,"count",3,0);let r=Ae(e,"items",19,()=>[]),a=Ae(e,"expanded",3,!1),s=J(()=>r().filter(B=>B.status==="pending")),i=J(()=>r().filter(B=>B.status!=="pending")),l=Pe(!1);function u(B){return B.split("_").map(O=>O.charAt(0)+O.slice(1).toLowerCase()).join(" ")}var d=V2(),v=_(d);v.__click=function(...B){var O;(O=e.ontoggle)==null||O.apply(this,B)};var p=_(v);let h;var m=_(p),x=b(p,2),k=_(x),E=b(x,2);{var N=B=>{var O=B2(),Q=_(O);oe(()=>ee(Q,`${o(i).length??""} handled`)),C(B,O)};ue(E,B=>{o(i).length>0&&B(N)})}var j=b(E,4);let V;var S=b(v,2);{var K=B=>{var O=U2(),Q=_(O);{var se=X=>{var Y=F2();C(X,Y)};ue(Q,X=>{o(s).length===0&&o(i).length===0&&X(se)})}var xe=b(Q,2);Ot(xe,17,()=>o(s),X=>X.emailId,(X,Y)=>{bv(X,{get item(){return o(Y)},get actionColor(){return n()},get onexecute(){return e.onexecute},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var z=b(xe,2);{var M=X=>{var Y=K2(),Z=_(Y),U=_(Z),te=b(Z,2);Ot(te,17,()=>o(i),ie=>ie.emailId,(ie,H)=>{bv(ie,{get item(){return o(H)},get actionColor(){return n()},get onremove(){return e.onremove},dimmed:!0})}),oe(()=>ee(U,`${o(i).length??""} handled`)),C(X,Y)};ue(z,X=>{o(i).length>0&&X(M)})}var q=b(z,2),T=_(q);{var D=X=>{var Y=H2();Y.__click=()=>P(l,!0),C(X,Y)},I=X=>{var Y=G2(),Z=_(Y),U=b(Z);U.__click=()=>P(l,!1);var te=b(U,2);te.__click=()=>{e.oncleargroup(),P(l,!1)},oe(()=>ee(Z,`Clear ${r().length??""} items? `)),C(X,Y)};ue(T,X=>{o(l)?X(I,!1):X(D)})}C(B,O)};ue(S,B=>{a()&&B(K)})}oe(B=>{h=Dt(p,"",h,{background:n()}),ee(m,B),ee(k,o(s).length),V=St(j,0,"chevron svelte-tl1unp",null,V,{open:a()})},[()=>u(e.action)]),C(t,d),st()}Xt(["click"]);var Y2=L(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),X2=L(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),Z2=L(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),Q2=L('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function J2(t,e){at(e,!0);let n=Ae(e,"open",15,!1),r=Ae(e,"sampleEmail",3,null),a=Pe("system");function s(){return r()?Up(r()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function i(){n(!1)}function l(p){p.target===p.currentTarget&&i()}var u=an(),d=Ye(u);{var v=p=>{var h=Q2();h.__click=l,h.__keydown=M=>M.key==="Escape"&&i();var m=_(h),x=_(m),k=b(_(x),2);k.__click=i;var E=b(x,2),N=_(E);let j;N.__click=()=>P(a,"system");var V=b(N,2);let S;V.__click=()=>P(a,"email");var K=b(V,2);let B;K.__click=()=>P(a,"config");var O=b(E,2),Q=_(O);{var se=M=>{var q=Y2(),T=b(Ye(q),2),D=_(T);oe(()=>ee(D,Fp)),C(M,q)},xe=M=>{var q=X2(),T=b(Ye(q),2),D=b(_(T),2);D.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var I=b(T,2),X=b(_(I),2),Y=_(X);oe(Z=>ee(Y,Z),[s]),C(M,q)},z=M=>{var q=Z2(),T=b(Ye(q),2),D=_(T),I=b(_(D),2),X=_(I),Y=b(D,2),Z=b(_(Y),2),U=_(Z),te=b(Y,2),ie=b(_(te),2),H=_(ie),G=b(T,4);G.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,oe(()=>{ee(X,Db.maxTokens),ee(U,"false"),ee(H,"false")}),C(M,q)};ue(Q,M=>{o(a)==="system"?M(se):o(a)==="email"?M(xe,1):o(a)==="config"&&M(z,2)})}oe(()=>{j=St(N,1,"tab svelte-10pcy9j",null,j,{active:o(a)==="system"}),S=St(V,1,"tab svelte-10pcy9j",null,S,{active:o(a)==="email"}),B=St(K,1,"tab svelte-10pcy9j",null,B,{active:o(a)==="config"})}),C(p,h)};ue(d,p=>{n()&&p(v)})}C(t,u),st()}Xt(["click","keydown"]);var $2={value:()=>{}};function ac(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new pl(n)}function pl(t){this._=t}function eS(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}pl.prototype=ac.prototype={constructor:pl,on:function(t,e){var n=this._,r=eS(t+"",n),a,s=-1,i=r.length;if(arguments.length<2){for(;++s<i;)if((a=(t=r[s]).type)&&(a=tS(n[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<i;)if(a=(t=r[s]).type)n[a]=wv(n[a],t.name,e);else if(e==null)for(a in n)n[a]=wv(n[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new pl(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,s;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,a=s.length;r<a;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,s=r.length;a<s;++a)r[a].value.apply(e,n)}};function tS(t,e){for(var n=0,r=t.length,a;n<r;++n)if((a=t[n]).name===e)return a.value}function wv(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=$2,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Fu="http://www.w3.org/1999/xhtml";const xv={svg:"http://www.w3.org/2000/svg",xhtml:Fu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function sc(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),xv.hasOwnProperty(e)?{space:xv[e],local:t}:t}function nS(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Fu&&e.documentElement.namespaceURI===Fu?e.createElement(t):e.createElementNS(n,t)}}function rS(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _g(t){var e=sc(t);return(e.local?rS:nS)(e)}function aS(){}function zd(t){return t==null?aS:function(){return this.querySelector(t)}}function sS(t){typeof t!="function"&&(t=zd(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var s=e[a],i=s.length,l=r[a]=new Array(i),u,d,v=0;v<i;++v)(u=s[v])&&(d=t.call(u,u.__data__,v,s))&&("__data__"in u&&(d.__data__=u.__data__),l[v]=d);return new ur(r,this._parents)}function iS(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function oS(){return[]}function bg(t){return t==null?oS:function(){return this.querySelectorAll(t)}}function lS(t){return function(){return iS(t.apply(this,arguments))}}function cS(t){typeof t=="function"?t=lS(t):t=bg(t);for(var e=this._groups,n=e.length,r=[],a=[],s=0;s<n;++s)for(var i=e[s],l=i.length,u,d=0;d<l;++d)(u=i[d])&&(r.push(t.call(u,u.__data__,d,i)),a.push(u));return new ur(r,a)}function wg(t){return function(){return this.matches(t)}}function xg(t){return function(e){return e.matches(t)}}var uS=Array.prototype.find;function dS(t){return function(){return uS.call(this.children,t)}}function fS(){return this.firstElementChild}function vS(t){return this.select(t==null?fS:dS(typeof t=="function"?t:xg(t)))}var hS=Array.prototype.filter;function pS(){return Array.from(this.children)}function gS(t){return function(){return hS.call(this.children,t)}}function mS(t){return this.selectAll(t==null?pS:gS(typeof t=="function"?t:xg(t)))}function yS(t){typeof t!="function"&&(t=wg(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var s=e[a],i=s.length,l=r[a]=[],u,d=0;d<i;++d)(u=s[d])&&t.call(u,u.__data__,d,s)&&l.push(u);return new ur(r,this._parents)}function kg(t){return new Array(t.length)}function _S(){return new ur(this._enter||this._groups.map(kg),this._parents)}function Cl(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Cl.prototype={constructor:Cl,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function bS(t){return function(){return t}}function wS(t,e,n,r,a,s){for(var i=0,l,u=e.length,d=s.length;i<d;++i)(l=e[i])?(l.__data__=s[i],r[i]=l):n[i]=new Cl(t,s[i]);for(;i<u;++i)(l=e[i])&&(a[i]=l)}function xS(t,e,n,r,a,s,i){var l,u,d=new Map,v=e.length,p=s.length,h=new Array(v),m;for(l=0;l<v;++l)(u=e[l])&&(h[l]=m=i.call(u,u.__data__,l,e)+"",d.has(m)?a[l]=u:d.set(m,u));for(l=0;l<p;++l)m=i.call(t,s[l],l,s)+"",(u=d.get(m))?(r[l]=u,u.__data__=s[l],d.delete(m)):n[l]=new Cl(t,s[l]);for(l=0;l<v;++l)(u=e[l])&&d.get(h[l])===u&&(a[l]=u)}function kS(t){return t.__data__}function SS(t,e){if(!arguments.length)return Array.from(this,kS);var n=e?xS:wS,r=this._parents,a=this._groups;typeof t!="function"&&(t=bS(t));for(var s=a.length,i=new Array(s),l=new Array(s),u=new Array(s),d=0;d<s;++d){var v=r[d],p=a[d],h=p.length,m=ES(t.call(v,v&&v.__data__,d,r)),x=m.length,k=l[d]=new Array(x),E=i[d]=new Array(x),N=u[d]=new Array(h);n(v,p,k,E,N,m,e);for(var j=0,V=0,S,K;j<x;++j)if(S=k[j]){for(j>=V&&(V=j+1);!(K=E[V])&&++V<x;);S._next=K||null}}return i=new ur(i,r),i._enter=l,i._exit=u,i}function ES(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function AS(){return new ur(this._exit||this._groups.map(kg),this._parents)}function TS(t,e,n){var r=this.enter(),a=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?s.remove():n(s),r&&a?r.merge(a).order():a}function CS(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,s=r.length,i=Math.min(a,s),l=new Array(a),u=0;u<i;++u)for(var d=n[u],v=r[u],p=d.length,h=l[u]=new Array(p),m,x=0;x<p;++x)(m=d[x]||v[x])&&(h[x]=m);for(;u<a;++u)l[u]=n[u];return new ur(l,this._parents)}function IS(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],a=r.length-1,s=r[a],i;--a>=0;)(i=r[a])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function PS(t){t||(t=MS);function e(p,h){return p&&h?t(p.__data__,h.__data__):!p-!h}for(var n=this._groups,r=n.length,a=new Array(r),s=0;s<r;++s){for(var i=n[s],l=i.length,u=a[s]=new Array(l),d,v=0;v<l;++v)(d=i[v])&&(u[v]=d);u.sort(e)}return new ur(a,this._parents).order()}function MS(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function OS(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function NS(){return Array.from(this)}function DS(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,s=r.length;a<s;++a){var i=r[a];if(i)return i}return null}function RS(){let t=0;for(const e of this)++t;return t}function LS(){return!this.node()}function jS(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a=e[n],s=0,i=a.length,l;s<i;++s)(l=a[s])&&t.call(l,l.__data__,s,a);return this}function zS(t){return function(){this.removeAttribute(t)}}function qS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function BS(t,e){return function(){this.setAttribute(t,e)}}function FS(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function KS(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function HS(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function GS(t,e){var n=sc(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?qS:zS:typeof e=="function"?n.local?HS:KS:n.local?FS:BS)(n,e))}function Sg(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function US(t){return function(){this.style.removeProperty(t)}}function VS(t,e,n){return function(){this.style.setProperty(t,e,n)}}function WS(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function YS(t,e,n){return arguments.length>1?this.each((e==null?US:typeof e=="function"?WS:VS)(t,e,n??"")):oi(this.node(),t)}function oi(t,e){return t.style.getPropertyValue(e)||Sg(t).getComputedStyle(t,null).getPropertyValue(e)}function XS(t){return function(){delete this[t]}}function ZS(t,e){return function(){this[t]=e}}function QS(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function JS(t,e){return arguments.length>1?this.each((e==null?XS:typeof e=="function"?QS:ZS)(t,e)):this.node()[t]}function Eg(t){return t.trim().split(/^|\s+/)}function qd(t){return t.classList||new Ag(t)}function Ag(t){this._node=t,this._names=Eg(t.getAttribute("class")||"")}Ag.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Tg(t,e){for(var n=qd(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function Cg(t,e){for(var n=qd(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function $S(t){return function(){Tg(this,t)}}function eE(t){return function(){Cg(this,t)}}function tE(t,e){return function(){(e.apply(this,arguments)?Tg:Cg)(this,t)}}function nE(t,e){var n=Eg(t+"");if(arguments.length<2){for(var r=qd(this.node()),a=-1,s=n.length;++a<s;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?tE:e?$S:eE)(n,e))}function rE(){this.textContent=""}function aE(t){return function(){this.textContent=t}}function sE(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function iE(t){return arguments.length?this.each(t==null?rE:(typeof t=="function"?sE:aE)(t)):this.node().textContent}function oE(){this.innerHTML=""}function lE(t){return function(){this.innerHTML=t}}function cE(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function uE(t){return arguments.length?this.each(t==null?oE:(typeof t=="function"?cE:lE)(t)):this.node().innerHTML}function dE(){this.nextSibling&&this.parentNode.appendChild(this)}function fE(){return this.each(dE)}function vE(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hE(){return this.each(vE)}function pE(t){var e=typeof t=="function"?t:_g(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function gE(){return null}function mE(t,e){var n=typeof t=="function"?t:_g(t),r=e==null?gE:typeof e=="function"?e:zd(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function yE(){var t=this.parentNode;t&&t.removeChild(this)}function _E(){return this.each(yE)}function bE(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wE(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xE(t){return this.select(t?wE:bE)}function kE(t){return arguments.length?this.property("__data__",t):this.node().__data__}function SE(t){return function(e){t.call(this,e,this.__data__)}}function EE(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function AE(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,a=e.length,s;n<a;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function TE(t,e,n){return function(){var r=this.__on,a,s=SE(e);if(r){for(var i=0,l=r.length;i<l;++i)if((a=r[i]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=n),a.value=e;return}}this.addEventListener(t.type,s,n),a={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(a):this.__on=[a]}}function CE(t,e,n){var r=EE(t+""),a,s=r.length,i;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,d=l.length,v;u<d;++u)for(a=0,v=l[u];a<s;++a)if((i=r[a]).type===v.type&&i.name===v.name)return v.value}return}for(l=e?TE:AE,a=0;a<s;++a)this.each(l(r[a],e,n));return this}function Ig(t,e,n){var r=Sg(t),a=r.CustomEvent;typeof a=="function"?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function IE(t,e){return function(){return Ig(this,t,e)}}function PE(t,e){return function(){return Ig(this,t,e.apply(this,arguments))}}function ME(t,e){return this.each((typeof e=="function"?PE:IE)(t,e))}function*OE(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,s=r.length,i;a<s;++a)(i=r[a])&&(yield i)}var Pg=[null];function ur(t,e){this._groups=t,this._parents=e}function So(){return new ur([[document.documentElement]],Pg)}function NE(){return this}ur.prototype=So.prototype={constructor:ur,select:sS,selectAll:cS,selectChild:vS,selectChildren:mS,filter:yS,data:SS,enter:_S,exit:AS,join:TS,merge:CS,selection:NE,order:IS,sort:PS,call:OS,nodes:NS,node:DS,size:RS,empty:LS,each:jS,attr:GS,style:YS,property:JS,classed:nE,text:iE,html:uE,raise:fE,lower:hE,append:pE,insert:mE,remove:_E,clone:xE,datum:kE,on:CE,dispatch:ME,[Symbol.iterator]:OE};function Mr(t){return typeof t=="string"?new ur([[document.querySelector(t)]],[document.documentElement]):new ur([[t]],Pg)}function DE(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Gr(t,e){if(t=DE(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}const RE={passive:!1},eo={capture:!0,passive:!1};function eu(t){t.stopImmediatePropagation()}function Hs(t){t.preventDefault(),t.stopImmediatePropagation()}function Mg(t){var e=t.document.documentElement,n=Mr(t).on("dragstart.drag",Hs,eo);"onselectstart"in e?n.on("selectstart.drag",Hs,eo):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Og(t,e){var n=t.document.documentElement,r=Mr(t).on("dragstart.drag",null);e&&(r.on("click.drag",Hs,eo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const $o=t=>()=>t;function Ku(t,{sourceEvent:e,subject:n,target:r,identifier:a,active:s,x:i,y:l,dx:u,dy:d,dispatch:v}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:v}})}Ku.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function LE(t){return!t.ctrlKey&&!t.button}function jE(){return this.parentNode}function zE(t,e){return e??{x:t.x,y:t.y}}function qE(){return navigator.maxTouchPoints||"ontouchstart"in this}function BE(){var t=LE,e=jE,n=zE,r=qE,a={},s=ac("start","drag","end"),i=0,l,u,d,v,p=0;function h(S){S.on("mousedown.drag",m).filter(r).on("touchstart.drag",E).on("touchmove.drag",N,RE).on("touchend.drag touchcancel.drag",j).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(S,K){if(!(v||!t.call(this,S,K))){var B=V(this,e.call(this,S,K),S,K,"mouse");B&&(Mr(S.view).on("mousemove.drag",x,eo).on("mouseup.drag",k,eo),Mg(S.view),eu(S),d=!1,l=S.clientX,u=S.clientY,B("start",S))}}function x(S){if(Hs(S),!d){var K=S.clientX-l,B=S.clientY-u;d=K*K+B*B>p}a.mouse("drag",S)}function k(S){Mr(S.view).on("mousemove.drag mouseup.drag",null),Og(S.view,d),Hs(S),a.mouse("end",S)}function E(S,K){if(t.call(this,S,K)){var B=S.changedTouches,O=e.call(this,S,K),Q=B.length,se,xe;for(se=0;se<Q;++se)(xe=V(this,O,S,K,B[se].identifier,B[se]))&&(eu(S),xe("start",S,B[se]))}}function N(S){var K=S.changedTouches,B=K.length,O,Q;for(O=0;O<B;++O)(Q=a[K[O].identifier])&&(Hs(S),Q("drag",S,K[O]))}function j(S){var K=S.changedTouches,B=K.length,O,Q;for(v&&clearTimeout(v),v=setTimeout(function(){v=null},500),O=0;O<B;++O)(Q=a[K[O].identifier])&&(eu(S),Q("end",S,K[O]))}function V(S,K,B,O,Q,se){var xe=s.copy(),z=Gr(se||B,K),M,q,T;if((T=n.call(S,new Ku("beforestart",{sourceEvent:B,target:h,identifier:Q,active:i,x:z[0],y:z[1],dx:0,dy:0,dispatch:xe}),O))!=null)return M=T.x-z[0]||0,q=T.y-z[1]||0,function D(I,X,Y){var Z=z,U;switch(I){case"start":a[Q]=D,U=i++;break;case"end":delete a[Q],--i;case"drag":z=Gr(Y||X,K),U=i;break}xe.call(I,S,new Ku(I,{sourceEvent:X,subject:T,target:h,identifier:Q,active:U,x:z[0]+M,y:z[1]+q,dx:z[0]-Z[0],dy:z[1]-Z[1],dispatch:xe}),O)}}return h.filter=function(S){return arguments.length?(t=typeof S=="function"?S:$o(!!S),h):t},h.container=function(S){return arguments.length?(e=typeof S=="function"?S:$o(S),h):e},h.subject=function(S){return arguments.length?(n=typeof S=="function"?S:$o(S),h):n},h.touchable=function(S){return arguments.length?(r=typeof S=="function"?S:$o(!!S),h):r},h.on=function(){var S=s.on.apply(s,arguments);return S===s?h:S},h.clickDistance=function(S){return arguments.length?(p=(S=+S)*S,h):Math.sqrt(p)},h}function Bd(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ng(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Eo(){}var to=.7,Il=1/to,Gs="\\s*([+-]?\\d+)\\s*",no="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ta="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",FE=/^#([0-9a-f]{3,8})$/,KE=new RegExp(`^rgb\\(${Gs},${Gs},${Gs}\\)$`),HE=new RegExp(`^rgb\\(${ta},${ta},${ta}\\)$`),GE=new RegExp(`^rgba\\(${Gs},${Gs},${Gs},${no}\\)$`),UE=new RegExp(`^rgba\\(${ta},${ta},${ta},${no}\\)$`),VE=new RegExp(`^hsl\\(${no},${ta},${ta}\\)$`),WE=new RegExp(`^hsla\\(${no},${ta},${ta},${no}\\)$`),kv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bd(Eo,ws,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Sv,formatHex:Sv,formatHex8:YE,formatHsl:XE,formatRgb:Ev,toString:Ev});function Sv(){return this.rgb().formatHex()}function YE(){return this.rgb().formatHex8()}function XE(){return Dg(this).formatHsl()}function Ev(){return this.rgb().formatRgb()}function ws(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=FE.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Av(e):n===3?new tr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?el(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?el(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=KE.exec(t))?new tr(e[1],e[2],e[3],1):(e=HE.exec(t))?new tr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=GE.exec(t))?el(e[1],e[2],e[3],e[4]):(e=UE.exec(t))?el(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=VE.exec(t))?Iv(e[1],e[2]/100,e[3]/100,1):(e=WE.exec(t))?Iv(e[1],e[2]/100,e[3]/100,e[4]):kv.hasOwnProperty(t)?Av(kv[t]):t==="transparent"?new tr(NaN,NaN,NaN,0):null}function Av(t){return new tr(t>>16&255,t>>8&255,t&255,1)}function el(t,e,n,r){return r<=0&&(t=e=n=NaN),new tr(t,e,n,r)}function ZE(t){return t instanceof Eo||(t=ws(t)),t?(t=t.rgb(),new tr(t.r,t.g,t.b,t.opacity)):new tr}function Hu(t,e,n,r){return arguments.length===1?ZE(t):new tr(t,e,n,r??1)}function tr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Bd(tr,Hu,Ng(Eo,{brighter(t){return t=t==null?Il:Math.pow(Il,t),new tr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?to:Math.pow(to,t),new tr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new tr(ps(this.r),ps(this.g),ps(this.b),Pl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tv,formatHex:Tv,formatHex8:QE,formatRgb:Cv,toString:Cv}));function Tv(){return`#${is(this.r)}${is(this.g)}${is(this.b)}`}function QE(){return`#${is(this.r)}${is(this.g)}${is(this.b)}${is((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cv(){const t=Pl(this.opacity);return`${t===1?"rgb(":"rgba("}${ps(this.r)}, ${ps(this.g)}, ${ps(this.b)}${t===1?")":`, ${t})`}`}function Pl(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ps(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function is(t){return t=ps(t),(t<16?"0":"")+t.toString(16)}function Iv(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Or(t,e,n,r)}function Dg(t){if(t instanceof Or)return new Or(t.h,t.s,t.l,t.opacity);if(t instanceof Eo||(t=ws(t)),!t)return new Or;if(t instanceof Or)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),i=NaN,l=s-a,u=(s+a)/2;return l?(e===s?i=(n-r)/l+(n<r)*6:n===s?i=(r-e)/l+2:i=(e-n)/l+4,l/=u<.5?s+a:2-s-a,i*=60):l=u>0&&u<1?0:i,new Or(i,l,u,t.opacity)}function JE(t,e,n,r){return arguments.length===1?Dg(t):new Or(t,e,n,r??1)}function Or(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Bd(Or,JE,Ng(Eo,{brighter(t){return t=t==null?Il:Math.pow(Il,t),new Or(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?to:Math.pow(to,t),new Or(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new tr(tu(t>=240?t-240:t+120,a,r),tu(t,a,r),tu(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new Or(Pv(this.h),tl(this.s),tl(this.l),Pl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Pl(this.opacity);return`${t===1?"hsl(":"hsla("}${Pv(this.h)}, ${tl(this.s)*100}%, ${tl(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Pv(t){return t=(t||0)%360,t<0?t+360:t}function tl(t){return Math.max(0,Math.min(1,t||0))}function tu(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Fd=t=>()=>t;function $E(t,e){return function(n){return t+n*e}}function eA(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function tA(t){return(t=+t)==1?Rg:function(e,n){return n-e?eA(e,n,t):Fd(isNaN(e)?n:e)}}function Rg(t,e){var n=e-t;return n?$E(t,n):Fd(isNaN(t)?e:t)}const Ml=(function t(e){var n=tA(e);function r(a,s){var i=n((a=Hu(a)).r,(s=Hu(s)).r),l=n(a.g,s.g),u=n(a.b,s.b),d=Rg(a.opacity,s.opacity);return function(v){return a.r=i(v),a.g=l(v),a.b=u(v),a.opacity=d(v),a+""}}return r.gamma=t,r})(1);function nA(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),a;return function(s){for(a=0;a<n;++a)r[a]=t[a]*(1-s)+e[a]*s;return r}}function rA(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function aA(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,a=new Array(r),s=new Array(n),i;for(i=0;i<r;++i)a[i]=Xi(t[i],e[i]);for(;i<n;++i)s[i]=e[i];return function(l){for(i=0;i<r;++i)s[i]=a[i](l);return s}}function sA(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Xr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function iA(t,e){var n={},r={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=Xi(t[a],e[a]):r[a]=e[a];return function(s){for(a in n)r[a]=n[a](s);return r}}var Gu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(Gu.source,"g");function oA(t){return function(){return t}}function lA(t){return function(e){return t(e)+""}}function Lg(t,e){var n=Gu.lastIndex=nu.lastIndex=0,r,a,s,i=-1,l=[],u=[];for(t=t+"",e=e+"";(r=Gu.exec(t))&&(a=nu.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),l[i]?l[i]+=s:l[++i]=s),(r=r[0])===(a=a[0])?l[i]?l[i]+=a:l[++i]=a:(l[++i]=null,u.push({i,x:Xr(r,a)})),n=nu.lastIndex;return n<e.length&&(s=e.slice(n),l[i]?l[i]+=s:l[++i]=s),l.length<2?u[0]?lA(u[0].x):oA(e):(e=u.length,function(d){for(var v=0,p;v<e;++v)l[(p=u[v]).i]=p.x(d);return l.join("")})}function Xi(t,e){var n=typeof e,r;return e==null||n==="boolean"?Fd(e):(n==="number"?Xr:n==="string"?(r=ws(e))?(e=r,Ml):Lg:e instanceof ws?Ml:e instanceof Date?sA:rA(e)?nA:Array.isArray(e)?aA:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?iA:Xr)(t,e)}var Mv=180/Math.PI,Uu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function jg(t,e,n,r,a,s){var i,l,u;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,u/=l),t*r<e*n&&(t=-t,e=-e,u=-u,i=-i),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*Mv,skewX:Math.atan(u)*Mv,scaleX:i,scaleY:l}}var nl;function cA(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Uu:jg(e.a,e.b,e.c,e.d,e.e,e.f)}function uA(t){return t==null||(nl||(nl=document.createElementNS("http://www.w3.org/2000/svg","g")),nl.setAttribute("transform",t),!(t=nl.transform.baseVal.consolidate()))?Uu:(t=t.matrix,jg(t.a,t.b,t.c,t.d,t.e,t.f))}function zg(t,e,n,r){function a(d){return d.length?d.pop()+" ":""}function s(d,v,p,h,m,x){if(d!==p||v!==h){var k=m.push("translate(",null,e,null,n);x.push({i:k-4,x:Xr(d,p)},{i:k-2,x:Xr(v,h)})}else(p||h)&&m.push("translate("+p+e+h+n)}function i(d,v,p,h){d!==v?(d-v>180?v+=360:v-d>180&&(d+=360),h.push({i:p.push(a(p)+"rotate(",null,r)-2,x:Xr(d,v)})):v&&p.push(a(p)+"rotate("+v+r)}function l(d,v,p,h){d!==v?h.push({i:p.push(a(p)+"skewX(",null,r)-2,x:Xr(d,v)}):v&&p.push(a(p)+"skewX("+v+r)}function u(d,v,p,h,m,x){if(d!==p||v!==h){var k=m.push(a(m)+"scale(",null,",",null,")");x.push({i:k-4,x:Xr(d,p)},{i:k-2,x:Xr(v,h)})}else(p!==1||h!==1)&&m.push(a(m)+"scale("+p+","+h+")")}return function(d,v){var p=[],h=[];return d=t(d),v=t(v),s(d.translateX,d.translateY,v.translateX,v.translateY,p,h),i(d.rotate,v.rotate,p,h),l(d.skewX,v.skewX,p,h),u(d.scaleX,d.scaleY,v.scaleX,v.scaleY,p,h),d=v=null,function(m){for(var x=-1,k=h.length,E;++x<k;)p[(E=h[x]).i]=E.x(m);return p.join("")}}}var dA=zg(cA,"px, ","px)","deg)"),fA=zg(uA,", ",")",")"),vA=1e-12;function Ov(t){return((t=Math.exp(t))+1/t)/2}function hA(t){return((t=Math.exp(t))-1/t)/2}function pA(t){return((t=Math.exp(2*t))-1)/(t+1)}const gl=(function t(e,n,r){function a(s,i){var l=s[0],u=s[1],d=s[2],v=i[0],p=i[1],h=i[2],m=v-l,x=p-u,k=m*m+x*x,E,N;if(k<vA)N=Math.log(h/d)/e,E=function(O){return[l+O*m,u+O*x,d*Math.exp(e*O*N)]};else{var j=Math.sqrt(k),V=(h*h-d*d+r*k)/(2*d*n*j),S=(h*h-d*d-r*k)/(2*h*n*j),K=Math.log(Math.sqrt(V*V+1)-V),B=Math.log(Math.sqrt(S*S+1)-S);N=(B-K)/e,E=function(O){var Q=O*N,se=Ov(K),xe=d/(n*j)*(se*pA(e*Q+K)-hA(K));return[l+xe*m,u+xe*x,d*se/Ov(e*Q+K)]}}return E.duration=N*1e3*e/Math.SQRT2,E}return a.rho=function(s){var i=Math.max(.001,+s),l=i*i,u=l*l;return t(i,l,u)},a})(Math.SQRT2,2,4);var li=0,Ki=0,zi=0,qg=1e3,Ol,Hi,Nl=0,xs=0,ic=0,ro=typeof performance=="object"&&performance.now?performance:Date,Bg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Kd(){return xs||(Bg(gA),xs=ro.now()+ic)}function gA(){xs=0}function Dl(){this._call=this._time=this._next=null}Dl.prototype=Fg.prototype={constructor:Dl,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Kd():+n)+(e==null?0:+e),!this._next&&Hi!==this&&(Hi?Hi._next=this:Ol=this,Hi=this),this._call=t,this._time=n,Vu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vu())}};function Fg(t,e,n){var r=new Dl;return r.restart(t,e,n),r}function mA(){Kd(),++li;for(var t=Ol,e;t;)(e=xs-t._time)>=0&&t._call.call(void 0,e),t=t._next;--li}function Nv(){xs=(Nl=ro.now())+ic,li=Ki=0;try{mA()}finally{li=0,_A(),xs=0}}function yA(){var t=ro.now(),e=t-Nl;e>qg&&(ic-=e,Nl=t)}function _A(){for(var t,e=Ol,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ol=n);Hi=t,Vu(r)}function Vu(t){if(!li){Ki&&(Ki=clearTimeout(Ki));var e=t-xs;e>24?(t<1/0&&(Ki=setTimeout(Nv,t-ro.now()-ic)),zi&&(zi=clearInterval(zi))):(zi||(Nl=ro.now(),zi=setInterval(yA,qg)),li=1,Bg(Nv))}}function Dv(t,e,n){var r=new Dl;return e=e==null?0:+e,r.restart(a=>{r.stop(),t(a+e)},e,n),r}var bA=ac("start","end","cancel","interrupt"),wA=[],Kg=0,Rv=1,Wu=2,ml=3,Lv=4,Yu=5,yl=6;function oc(t,e,n,r,a,s){var i=t.__transition;if(!i)t.__transition={};else if(n in i)return;xA(t,n,{name:e,index:r,group:a,on:bA,tween:wA,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Kg})}function Hd(t,e){var n=qr(t,e);if(n.state>Kg)throw new Error("too late; already scheduled");return n}function sa(t,e){var n=qr(t,e);if(n.state>ml)throw new Error("too late; already running");return n}function qr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function xA(t,e,n){var r=t.__transition,a;r[e]=n,n.timer=Fg(s,0,n.time);function s(d){n.state=Rv,n.timer.restart(i,n.delay,n.time),n.delay<=d&&i(d-n.delay)}function i(d){var v,p,h,m;if(n.state!==Rv)return u();for(v in r)if(m=r[v],m.name===n.name){if(m.state===ml)return Dv(i);m.state===Lv?(m.state=yl,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[v]):+v<e&&(m.state=yl,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[v])}if(Dv(function(){n.state===ml&&(n.state=Lv,n.timer.restart(l,n.delay,n.time),l(d))}),n.state=Wu,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Wu){for(n.state=ml,a=new Array(h=n.tween.length),v=0,p=-1;v<h;++v)(m=n.tween[v].value.call(t,t.__data__,n.index,n.group))&&(a[++p]=m);a.length=p+1}}function l(d){for(var v=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(u),n.state=Yu,1),p=-1,h=a.length;++p<h;)a[p].call(t,v);n.state===Yu&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=yl,n.timer.stop(),delete r[e];for(var d in r)return;delete t.__transition}}function _l(t,e){var n=t.__transition,r,a,s=!0,i;if(n){e=e==null?null:e+"";for(i in n){if((r=n[i]).name!==e){s=!1;continue}a=r.state>Wu&&r.state<Yu,r.state=yl,r.timer.stop(),r.on.call(a?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[i]}s&&delete t.__transition}}function kA(t){return this.each(function(){_l(this,t)})}function SA(t,e){var n,r;return function(){var a=sa(this,t),s=a.tween;if(s!==n){r=n=s;for(var i=0,l=r.length;i<l;++i)if(r[i].name===e){r=r.slice(),r.splice(i,1);break}}a.tween=r}}function EA(t,e,n){var r,a;if(typeof n!="function")throw new Error;return function(){var s=sa(this,t),i=s.tween;if(i!==r){a=(r=i).slice();for(var l={name:e,value:n},u=0,d=a.length;u<d;++u)if(a[u].name===e){a[u]=l;break}u===d&&a.push(l)}s.tween=a}}function AA(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=qr(this.node(),n).tween,a=0,s=r.length,i;a<s;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((e==null?SA:EA)(n,t,e))}function Gd(t,e,n){var r=t._id;return t.each(function(){var a=sa(this,r);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return qr(a,r).value[e]}}function Hg(t,e){var n;return(typeof e=="number"?Xr:e instanceof ws?Ml:(n=ws(e))?(e=n,Ml):Lg)(t,e)}function TA(t){return function(){this.removeAttribute(t)}}function CA(t){return function(){this.removeAttributeNS(t.space,t.local)}}function IA(t,e,n){var r,a=n+"",s;return function(){var i=this.getAttribute(t);return i===a?null:i===r?s:s=e(r=i,n)}}function PA(t,e,n){var r,a=n+"",s;return function(){var i=this.getAttributeNS(t.space,t.local);return i===a?null:i===r?s:s=e(r=i,n)}}function MA(t,e,n){var r,a,s;return function(){var i,l=n(this),u;return l==null?void this.removeAttribute(t):(i=this.getAttribute(t),u=l+"",i===u?null:i===r&&u===a?s:(a=u,s=e(r=i,l)))}}function OA(t,e,n){var r,a,s;return function(){var i,l=n(this),u;return l==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),u=l+"",i===u?null:i===r&&u===a?s:(a=u,s=e(r=i,l)))}}function NA(t,e){var n=sc(t),r=n==="transform"?fA:Hg;return this.attrTween(t,typeof e=="function"?(n.local?OA:MA)(n,r,Gd(this,"attr."+t,e)):e==null?(n.local?CA:TA)(n):(n.local?PA:IA)(n,r,e))}function DA(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function RA(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function LA(t,e){var n,r;function a(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&RA(t,s)),n}return a._value=e,a}function jA(t,e){var n,r;function a(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&DA(t,s)),n}return a._value=e,a}function zA(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=sc(t);return this.tween(n,(r.local?LA:jA)(r,e))}function qA(t,e){return function(){Hd(this,t).delay=+e.apply(this,arguments)}}function BA(t,e){return e=+e,function(){Hd(this,t).delay=e}}function FA(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?qA:BA)(e,t)):qr(this.node(),e).delay}function KA(t,e){return function(){sa(this,t).duration=+e.apply(this,arguments)}}function HA(t,e){return e=+e,function(){sa(this,t).duration=e}}function GA(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?KA:HA)(e,t)):qr(this.node(),e).duration}function UA(t,e){if(typeof e!="function")throw new Error;return function(){sa(this,t).ease=e}}function VA(t){var e=this._id;return arguments.length?this.each(UA(e,t)):qr(this.node(),e).ease}function WA(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;sa(this,t).ease=n}}function YA(t){if(typeof t!="function")throw new Error;return this.each(WA(this._id,t))}function XA(t){typeof t!="function"&&(t=wg(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var s=e[a],i=s.length,l=r[a]=[],u,d=0;d<i;++d)(u=s[d])&&t.call(u,u.__data__,d,s)&&l.push(u);return new xa(r,this._parents,this._name,this._id)}function ZA(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,a=n.length,s=Math.min(r,a),i=new Array(r),l=0;l<s;++l)for(var u=e[l],d=n[l],v=u.length,p=i[l]=new Array(v),h,m=0;m<v;++m)(h=u[m]||d[m])&&(p[m]=h);for(;l<r;++l)i[l]=e[l];return new xa(i,this._parents,this._name,this._id)}function QA(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function JA(t,e,n){var r,a,s=QA(e)?Hd:sa;return function(){var i=s(this,t),l=i.on;l!==r&&(a=(r=l).copy()).on(e,n),i.on=a}}function $A(t,e){var n=this._id;return arguments.length<2?qr(this.node(),n).on.on(t):this.each(JA(n,t,e))}function eT(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function tT(){return this.on("end.remove",eT(this._id))}function nT(t){var e=this._name,n=this._id;typeof t!="function"&&(t=zd(t));for(var r=this._groups,a=r.length,s=new Array(a),i=0;i<a;++i)for(var l=r[i],u=l.length,d=s[i]=new Array(u),v,p,h=0;h<u;++h)(v=l[h])&&(p=t.call(v,v.__data__,h,l))&&("__data__"in v&&(p.__data__=v.__data__),d[h]=p,oc(d[h],e,n,h,d,qr(v,n)));return new xa(s,this._parents,e,n)}function rT(t){var e=this._name,n=this._id;typeof t!="function"&&(t=bg(t));for(var r=this._groups,a=r.length,s=[],i=[],l=0;l<a;++l)for(var u=r[l],d=u.length,v,p=0;p<d;++p)if(v=u[p]){for(var h=t.call(v,v.__data__,p,u),m,x=qr(v,n),k=0,E=h.length;k<E;++k)(m=h[k])&&oc(m,e,n,k,h,x);s.push(h),i.push(v)}return new xa(s,i,e,n)}var aT=So.prototype.constructor;function sT(){return new aT(this._groups,this._parents)}function iT(t,e){var n,r,a;return function(){var s=oi(this,t),i=(this.style.removeProperty(t),oi(this,t));return s===i?null:s===n&&i===r?a:a=e(n=s,r=i)}}function Gg(t){return function(){this.style.removeProperty(t)}}function oT(t,e,n){var r,a=n+"",s;return function(){var i=oi(this,t);return i===a?null:i===r?s:s=e(r=i,n)}}function lT(t,e,n){var r,a,s;return function(){var i=oi(this,t),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(t),oi(this,t))),i===u?null:i===r&&u===a?s:(a=u,s=e(r=i,l))}}function cT(t,e){var n,r,a,s="style."+e,i="end."+s,l;return function(){var u=sa(this,t),d=u.on,v=u.value[s]==null?l||(l=Gg(e)):void 0;(d!==n||a!==v)&&(r=(n=d).copy()).on(i,a=v),u.on=r}}function uT(t,e,n){var r=(t+="")=="transform"?dA:Hg;return e==null?this.styleTween(t,iT(t,r)).on("end.style."+t,Gg(t)):typeof e=="function"?this.styleTween(t,lT(t,r,Gd(this,"style."+t,e))).each(cT(this._id,t)):this.styleTween(t,oT(t,r,e),n).on("end.style."+t,null)}function dT(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function fT(t,e,n){var r,a;function s(){var i=e.apply(this,arguments);return i!==a&&(r=(a=i)&&dT(t,i,n)),r}return s._value=e,s}function vT(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,fT(t,e,n??""))}function hT(t){return function(){this.textContent=t}}function pT(t){return function(){var e=t(this);this.textContent=e??""}}function gT(t){return this.tween("text",typeof t=="function"?pT(Gd(this,"text",t)):hT(t==null?"":t+""))}function mT(t){return function(e){this.textContent=t.call(this,e)}}function yT(t){var e,n;function r(){var a=t.apply(this,arguments);return a!==n&&(e=(n=a)&&mT(a)),e}return r._value=t,r}function _T(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,yT(t))}function bT(){for(var t=this._name,e=this._id,n=Ug(),r=this._groups,a=r.length,s=0;s<a;++s)for(var i=r[s],l=i.length,u,d=0;d<l;++d)if(u=i[d]){var v=qr(u,e);oc(u,t,n,d,i,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new xa(r,this._parents,t,n)}function wT(){var t,e,n=this,r=n._id,a=n.size();return new Promise(function(s,i){var l={value:i},u={value:function(){--a===0&&s()}};n.each(function(){var d=sa(this,r),v=d.on;v!==t&&(e=(t=v).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(u)),d.on=e}),a===0&&s()})}var xT=0;function xa(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ug(){return++xT}var la=So.prototype;xa.prototype={constructor:xa,select:nT,selectAll:rT,selectChild:la.selectChild,selectChildren:la.selectChildren,filter:XA,merge:ZA,selection:sT,transition:bT,call:la.call,nodes:la.nodes,node:la.node,size:la.size,empty:la.empty,each:la.each,on:$A,attr:NA,attrTween:zA,style:uT,styleTween:vT,text:gT,textTween:_T,remove:tT,tween:AA,delay:FA,duration:GA,ease:VA,easeVarying:YA,end:wT,[Symbol.iterator]:la[Symbol.iterator]};function kT(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ST={time:null,delay:0,duration:250,ease:kT};function ET(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function AT(t){var e,n;t instanceof xa?(e=t._id,t=t._name):(e=Ug(),(n=ST).time=Kd(),t=t==null?null:t+"");for(var r=this._groups,a=r.length,s=0;s<a;++s)for(var i=r[s],l=i.length,u,d=0;d<l;++d)(u=i[d])&&oc(u,t,e,d,i,n||ET(u,e));return new xa(r,this._parents,t,e)}So.prototype.interrupt=kA;So.prototype.transition=AT;const rl=t=>()=>t;function TT(t,{sourceEvent:e,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function ga(t,e,n){this.k=t,this.x=e,this.y=n}ga.prototype={constructor:ga,scale:function(t){return t===1?this:new ga(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ga(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var lc=new ga(1,0,0);Vg.prototype=ga.prototype;function Vg(t){for(;!t.__zoom;)if(!(t=t.parentNode))return lc;return t.__zoom}function ru(t){t.stopImmediatePropagation()}function qi(t){t.preventDefault(),t.stopImmediatePropagation()}function CT(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function IT(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function jv(){return this.__zoom||lc}function PT(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function MT(){return navigator.maxTouchPoints||"ontouchstart"in this}function OT(t,e,n){var r=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function NT(){var t=CT,e=IT,n=OT,r=PT,a=MT,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],l=250,u=gl,d=ac("start","zoom","end"),v,p,h,m=500,x=150,k=0,E=10;function N(T){T.property("__zoom",jv).on("wheel.zoom",Q,{passive:!1}).on("mousedown.zoom",se).on("dblclick.zoom",xe).filter(a).on("touchstart.zoom",z).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(T,D,I,X){var Y=T.selection?T.selection():T;Y.property("__zoom",jv),T!==Y?K(T,D,I,X):Y.interrupt().each(function(){B(this,arguments).event(X).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},N.scaleBy=function(T,D,I,X){N.scaleTo(T,function(){var Y=this.__zoom.k,Z=typeof D=="function"?D.apply(this,arguments):D;return Y*Z},I,X)},N.scaleTo=function(T,D,I,X){N.transform(T,function(){var Y=e.apply(this,arguments),Z=this.__zoom,U=I==null?S(Y):typeof I=="function"?I.apply(this,arguments):I,te=Z.invert(U),ie=typeof D=="function"?D.apply(this,arguments):D;return n(V(j(Z,ie),U,te),Y,i)},I,X)},N.translateBy=function(T,D,I,X){N.transform(T,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof I=="function"?I.apply(this,arguments):I),e.apply(this,arguments),i)},null,X)},N.translateTo=function(T,D,I,X,Y){N.transform(T,function(){var Z=e.apply(this,arguments),U=this.__zoom,te=X==null?S(Z):typeof X=="function"?X.apply(this,arguments):X;return n(lc.translate(te[0],te[1]).scale(U.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof I=="function"?-I.apply(this,arguments):-I),Z,i)},X,Y)};function j(T,D){return D=Math.max(s[0],Math.min(s[1],D)),D===T.k?T:new ga(D,T.x,T.y)}function V(T,D,I){var X=D[0]-I[0]*T.k,Y=D[1]-I[1]*T.k;return X===T.x&&Y===T.y?T:new ga(T.k,X,Y)}function S(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function K(T,D,I,X){T.on("start.zoom",function(){B(this,arguments).event(X).start()}).on("interrupt.zoom end.zoom",function(){B(this,arguments).event(X).end()}).tween("zoom",function(){var Y=this,Z=arguments,U=B(Y,Z).event(X),te=e.apply(Y,Z),ie=I==null?S(te):typeof I=="function"?I.apply(Y,Z):I,H=Math.max(te[1][0]-te[0][0],te[1][1]-te[0][1]),G=Y.__zoom,re=typeof D=="function"?D.apply(Y,Z):D,ae=u(G.invert(ie).concat(H/G.k),re.invert(ie).concat(H/re.k));return function(pe){if(pe===1)pe=re;else{var _e=ae(pe),ne=H/_e[2];pe=new ga(ne,ie[0]-_e[0]*ne,ie[1]-_e[1]*ne)}U.zoom(null,pe)}})}function B(T,D,I){return!I&&T.__zooming||new O(T,D)}function O(T,D){this.that=T,this.args=D,this.active=0,this.sourceEvent=null,this.extent=e.apply(T,D),this.taps=0}O.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,D){return this.mouse&&T!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var D=Mr(this.that).datum();d.call(T,this.that,new TT(T,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:d}),D)}};function Q(T,...D){if(!t.apply(this,arguments))return;var I=B(this,D).event(T),X=this.__zoom,Y=Math.max(s[0],Math.min(s[1],X.k*Math.pow(2,r.apply(this,arguments)))),Z=Gr(T);if(I.wheel)(I.mouse[0][0]!==Z[0]||I.mouse[0][1]!==Z[1])&&(I.mouse[1]=X.invert(I.mouse[0]=Z)),clearTimeout(I.wheel);else{if(X.k===Y)return;I.mouse=[Z,X.invert(Z)],_l(this),I.start()}qi(T),I.wheel=setTimeout(U,x),I.zoom("mouse",n(V(j(X,Y),I.mouse[0],I.mouse[1]),I.extent,i));function U(){I.wheel=null,I.end()}}function se(T,...D){if(h||!t.apply(this,arguments))return;var I=T.currentTarget,X=B(this,D,!0).event(T),Y=Mr(T.view).on("mousemove.zoom",ie,!0).on("mouseup.zoom",H,!0),Z=Gr(T,I),U=T.clientX,te=T.clientY;Mg(T.view),ru(T),X.mouse=[Z,this.__zoom.invert(Z)],_l(this),X.start();function ie(G){if(qi(G),!X.moved){var re=G.clientX-U,ae=G.clientY-te;X.moved=re*re+ae*ae>k}X.event(G).zoom("mouse",n(V(X.that.__zoom,X.mouse[0]=Gr(G,I),X.mouse[1]),X.extent,i))}function H(G){Y.on("mousemove.zoom mouseup.zoom",null),Og(G.view,X.moved),qi(G),X.event(G).end()}}function xe(T,...D){if(t.apply(this,arguments)){var I=this.__zoom,X=Gr(T.changedTouches?T.changedTouches[0]:T,this),Y=I.invert(X),Z=I.k*(T.shiftKey?.5:2),U=n(V(j(I,Z),X,Y),e.apply(this,D),i);qi(T),l>0?Mr(this).transition().duration(l).call(K,U,X,T):Mr(this).call(N.transform,U,X,T)}}function z(T,...D){if(t.apply(this,arguments)){var I=T.touches,X=I.length,Y=B(this,D,T.changedTouches.length===X).event(T),Z,U,te,ie;for(ru(T),U=0;U<X;++U)te=I[U],ie=Gr(te,this),ie=[ie,this.__zoom.invert(ie),te.identifier],Y.touch0?!Y.touch1&&Y.touch0[2]!==ie[2]&&(Y.touch1=ie,Y.taps=0):(Y.touch0=ie,Z=!0,Y.taps=1+!!v);v&&(v=clearTimeout(v)),Z&&(Y.taps<2&&(p=ie[0],v=setTimeout(function(){v=null},m)),_l(this),Y.start())}}function M(T,...D){if(this.__zooming){var I=B(this,D).event(T),X=T.changedTouches,Y=X.length,Z,U,te,ie;for(qi(T),Z=0;Z<Y;++Z)U=X[Z],te=Gr(U,this),I.touch0&&I.touch0[2]===U.identifier?I.touch0[0]=te:I.touch1&&I.touch1[2]===U.identifier&&(I.touch1[0]=te);if(U=I.that.__zoom,I.touch1){var H=I.touch0[0],G=I.touch0[1],re=I.touch1[0],ae=I.touch1[1],pe=(pe=re[0]-H[0])*pe+(pe=re[1]-H[1])*pe,_e=(_e=ae[0]-G[0])*_e+(_e=ae[1]-G[1])*_e;U=j(U,Math.sqrt(pe/_e)),te=[(H[0]+re[0])/2,(H[1]+re[1])/2],ie=[(G[0]+ae[0])/2,(G[1]+ae[1])/2]}else if(I.touch0)te=I.touch0[0],ie=I.touch0[1];else return;I.zoom("touch",n(V(U,te,ie),I.extent,i))}}function q(T,...D){if(this.__zooming){var I=B(this,D).event(T),X=T.changedTouches,Y=X.length,Z,U;for(ru(T),h&&clearTimeout(h),h=setTimeout(function(){h=null},m),Z=0;Z<Y;++Z)U=X[Z],I.touch0&&I.touch0[2]===U.identifier?delete I.touch0:I.touch1&&I.touch1[2]===U.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(U=Gr(U,this),Math.hypot(p[0]-U[0],p[1]-U[1])<E)){var te=Mr(this).on("dblclick.zoom");te&&te.apply(this,arguments)}}}return N.wheelDelta=function(T){return arguments.length?(r=typeof T=="function"?T:rl(+T),N):r},N.filter=function(T){return arguments.length?(t=typeof T=="function"?T:rl(!!T),N):t},N.touchable=function(T){return arguments.length?(a=typeof T=="function"?T:rl(!!T),N):a},N.extent=function(T){return arguments.length?(e=typeof T=="function"?T:rl([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),N):e},N.scaleExtent=function(T){return arguments.length?(s[0]=+T[0],s[1]=+T[1],N):[s[0],s[1]]},N.translateExtent=function(T){return arguments.length?(i[0][0]=+T[0][0],i[1][0]=+T[1][0],i[0][1]=+T[0][1],i[1][1]=+T[1][1],N):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},N.constrain=function(T){return arguments.length?(n=T,N):n},N.duration=function(T){return arguments.length?(l=+T,N):l},N.interpolate=function(T){return arguments.length?(u=T,N):u},N.on=function(){var T=d.on.apply(d,arguments);return T===d?N:T},N.clickDistance=function(T){return arguments.length?(k=(T=+T)*T,N):Math.sqrt(k)},N.tapDistance=function(T){return arguments.length?(E=+T,N):E},N}const ao={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${t} handle id: "${t==="source"?n:r}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Xu=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Wg=["Enter"," ","Escape"],DT={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:n})=>`Moved selected node ${t}. New position, x: ${e}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var ci;(function(t){t.Strict="strict",t.Loose="loose"})(ci||(ci={}));var Us;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Us||(Us={}));var Rl;(function(t){t.Partial="partial",t.Full="full"})(Rl||(Rl={}));const Zu={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Oa;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Oa||(Oa={}));var Ll;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ll||(Ll={}));var wt;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(wt||(wt={}));const zv={[wt.Left]:wt.Right,[wt.Right]:wt.Left,[wt.Top]:wt.Bottom,[wt.Bottom]:wt.Top};function RT(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const n of t.keys())if(!e.has(n))return!1;return!0}function qv(t,e,n){if(!n)return;const r=[];t.forEach((a,s)=>{e!=null&&e.has(s)||r.push(a)}),r.length&&n(r)}function LT(t){return t===null?null:t?"valid":"invalid"}const Yg=t=>"id"in t&&"source"in t&&"target"in t,jT=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),Ud=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),Ao=(t,e=[0,0])=>{const{width:n,height:r}=Ms(t),a=t.origin??e,s=n*a[0],i=r*a[1];return{x:t.position.x-s,y:t.position.y-i}},zT=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,a)=>{const s=typeof a=="string";let i=!e.nodeLookup&&!s?a:void 0;e.nodeLookup&&(i=s?e.nodeLookup.get(a):Ud(a)?a:e.nodeLookup.get(a.id));const l=i?jl(i,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return uc(r,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return dc(n)},cc=(t,e={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return t.forEach(a=>{(e.filter===void 0||e.filter(a))&&(n=uc(n,jl(a)),r=!0)}),r?dc(n):{x:0,y:0,width:0,height:0}},Vd=(t,e,[n,r,a]=[0,0,1],s=!1,i=!1)=>{const l={...Co(e,[n,r,a]),width:e.width/a,height:e.height/a},u=[];for(const d of t.values()){const{measured:v,selectable:p=!0,hidden:h=!1}=d;if(i&&!p||h)continue;const m=v.width??d.width??d.initialWidth??null,x=v.height??d.height??d.initialHeight??null,k=so(l,di(d)),E=(m??0)*(x??0),N=s&&k>0;(!d.internals.handleBounds||N||k>=E||d.dragging)&&u.push(d)}return u},qT=(t,e)=>{const n=new Set;return t.forEach(r=>{n.add(r.id)}),e.filter(r=>n.has(r.source)||n.has(r.target))};function BT(t,e){const n=new Map,r=e!=null&&e.nodes?new Set(e.nodes.map(a=>a.id)):null;return t.forEach(a=>{a.measured.width&&a.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function FT({nodes:t,width:e,height:n,panZoom:r,minZoom:a,maxZoom:s},i){if(t.size===0)return Promise.resolve(!0);const l=BT(t,i),u=cc(l),d=Wd(u,e,n,(i==null?void 0:i.minZoom)??a,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await r.setViewport(d,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function Xg({nodeId:t,nextPosition:e,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:s}){const i=n.get(t),l=i.parentId?n.get(i.parentId):void 0,{x:u,y:d}=l?l.internals.positionAbsolute:{x:0,y:0},v=i.origin??r;let p=i.extent||a;if(i.extent==="parent"&&!i.expandParent)if(!l)s==null||s("005",ao.error005());else{const m=l.measured.width,x=l.measured.height;m&&x&&(p=[[u,d],[u+m,d+x]])}else l&&fi(i.extent)&&(p=[[i.extent[0][0]+u,i.extent[0][1]+d],[i.extent[1][0]+u,i.extent[1][1]+d]]);const h=fi(p)?ks(e,p,i.measured):e;return(i.measured.width===void 0||i.measured.height===void 0)&&(s==null||s("015",ao.error015())),{position:{x:h.x-u+(i.measured.width??0)*v[0],y:h.y-d+(i.measured.height??0)*v[1]},positionAbsolute:h}}async function KT({nodesToRemove:t=[],edgesToRemove:e=[],nodes:n,edges:r,onBeforeDelete:a}){const s=new Set(t.map(h=>h.id)),i=[];for(const h of n){if(h.deletable===!1)continue;const m=s.has(h.id),x=!m&&h.parentId&&i.find(k=>k.id===h.parentId);(m||x)&&i.push(h)}const l=new Set(e.map(h=>h.id)),u=r.filter(h=>h.deletable!==!1),v=qT(i,u);for(const h of u)l.has(h.id)&&!v.find(x=>x.id===h.id)&&v.push(h);if(!a)return{edges:v,nodes:i};const p=await a({nodes:i,edges:v});return typeof p=="boolean"?p?{edges:v,nodes:i}:{edges:[],nodes:[]}:p}const ui=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),ks=(t={x:0,y:0},e,n)=>({x:ui(t.x,e[0][0],e[1][0]-((n==null?void 0:n.width)??0)),y:ui(t.y,e[0][1],e[1][1]-((n==null?void 0:n.height)??0))});function Zg(t,e,n){const{width:r,height:a}=Ms(n),{x:s,y:i}=n.internals.positionAbsolute;return ks(t,[[s,i],[s+r,i+a]],e)}const Bv=(t,e,n)=>t<e?ui(Math.abs(t-e),1,e)/e:t>n?-ui(Math.abs(t-n),1,e)/e:0,Qg=(t,e,n=15,r=40)=>{const a=Bv(t.x,r,e.width-r)*n,s=Bv(t.y,r,e.height-r)*n;return[a,s]},uc=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Qu=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),dc=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),di=(t,e=[0,0])=>{var a,s;const{x:n,y:r}=Ud(t)?t.internals.positionAbsolute:Ao(t,e);return{x:n,y:r,width:((a=t.measured)==null?void 0:a.width)??t.width??t.initialWidth??0,height:((s=t.measured)==null?void 0:s.height)??t.height??t.initialHeight??0}},jl=(t,e=[0,0])=>{var a,s;const{x:n,y:r}=Ud(t)?t.internals.positionAbsolute:Ao(t,e);return{x:n,y:r,x2:n+(((a=t.measured)==null?void 0:a.width)??t.width??t.initialWidth??0),y2:r+(((s=t.measured)==null?void 0:s.height)??t.height??t.initialHeight??0)}},HT=(t,e)=>dc(uc(Qu(t),Qu(e))),so=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},Fv=t=>ma(t.width)&&ma(t.height)&&ma(t.x)&&ma(t.y),ma=t=>!isNaN(t)&&isFinite(t),GT=(t,e)=>{},To=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),Co=({x:t,y:e},[n,r,a],s=!1,i=[1,1])=>{const l={x:(t-n)/a,y:(e-r)/a};return s?To(l,i):l},zl=({x:t,y:e},[n,r,a])=>({x:t*a+n,y:e*a+r});function Bs(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(n)}if(typeof t=="string"&&t.endsWith("%")){const n=parseFloat(t);if(!Number.isNaN(n))return Math.floor(e*n*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function UT(t,e,n){if(typeof t=="string"||typeof t=="number"){const r=Bs(t,n),a=Bs(t,e);return{top:r,right:a,bottom:r,left:a,x:a*2,y:r*2}}if(typeof t=="object"){const r=Bs(t.top??t.y??0,n),a=Bs(t.bottom??t.y??0,n),s=Bs(t.left??t.x??0,e),i=Bs(t.right??t.x??0,e);return{top:r,right:i,bottom:a,left:s,x:s+i,y:r+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function VT(t,e,n,r,a,s){const{x:i,y:l}=zl(t,[e,n,r]),{x:u,y:d}=zl({x:t.x+t.width,y:t.y+t.height},[e,n,r]),v=a-u,p=s-d;return{left:Math.floor(i),top:Math.floor(l),right:Math.floor(v),bottom:Math.floor(p)}}const Wd=(t,e,n,r,a,s)=>{const i=UT(s,e,n),l=(e-i.x)/t.width,u=(n-i.y)/t.height,d=Math.min(l,u),v=ui(d,r,a),p=t.x+t.width/2,h=t.y+t.height/2,m=e/2-p*v,x=n/2-h*v,k=VT(t,m,x,v,e,n),E={left:Math.min(k.left-i.left,0),top:Math.min(k.top-i.top,0),right:Math.min(k.right-i.right,0),bottom:Math.min(k.bottom-i.bottom,0)};return{x:m-E.left+E.right,y:x-E.top+E.bottom,zoom:v}},ql=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0};function fi(t){return t!=null&&t!=="parent"}function Ms(t){var e,n;return{width:((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth??0,height:((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight??0}}function WT(t){var e,n;return(((e=t.measured)==null?void 0:e.width)??t.width??t.initialWidth)!==void 0&&(((n=t.measured)==null?void 0:n.height)??t.height??t.initialHeight)!==void 0}function YT(t,e={width:0,height:0},n,r,a){const s={...t},i=r.get(n);if(i){const l=i.origin||a;s.x+=i.internals.positionAbsolute.x-(e.width??0)*l[0],s.y+=i.internals.positionAbsolute.y-(e.height??0)*l[1]}return s}function XT(t){return{...DT,...t||{}}}function au(t,{snapGrid:e=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:s,y:i}=Rr(t),l=Co({x:s-((a==null?void 0:a.left)??0),y:i-((a==null?void 0:a.top)??0)},r),{x:u,y:d}=n?To(l,e):l;return{xSnapped:u,ySnapped:d,...l}}const Jg=t=>({width:t.offsetWidth,height:t.offsetHeight}),$g=t=>{var e;return((e=t==null?void 0:t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},ZT=["INPUT","SELECT","TEXTAREA"];function em(t){var r,a;const e=((a=(r=t.composedPath)==null?void 0:r.call(t))==null?void 0:a[0])||t.target;return(e==null?void 0:e.nodeType)!==1?!1:ZT.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const tm=t=>"clientX"in t,Rr=(t,e)=>{var s,i;const n=tm(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,a=n?t.clientY:(i=t.touches)==null?void 0:i[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:a-((e==null?void 0:e.top)??0)}},Kv=(t,e,n,r,a)=>{const s=e.querySelectorAll(`.${t}`);return!s||!s.length?null:Array.from(s).map(i=>{const l=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:t,nodeId:a,position:i.getAttribute("data-handlepos"),x:(l.left-n.left)/r,y:(l.top-n.top)/r,...Jg(i)}})};function QT({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:a,sourceControlY:s,targetControlX:i,targetControlY:l}){const u=t*.125+a*.375+i*.375+n*.125,d=e*.125+s*.375+l*.375+r*.125,v=Math.abs(u-t),p=Math.abs(d-e);return[u,d,v,p]}function al(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Hv({pos:t,x1:e,y1:n,x2:r,y2:a,c:s}){switch(t){case wt.Left:return[e-al(e-r,s),n];case wt.Right:return[e+al(r-e,s),n];case wt.Top:return[e,n-al(n-a,s)];case wt.Bottom:return[e,n+al(a-n,s)]}}function nm({sourceX:t,sourceY:e,sourcePosition:n=wt.Bottom,targetX:r,targetY:a,targetPosition:s=wt.Top,curvature:i=.25}){const[l,u]=Hv({pos:n,x1:t,y1:e,x2:r,y2:a,c:i}),[d,v]=Hv({pos:s,x1:r,y1:a,x2:t,y2:e,c:i}),[p,h,m,x]=QT({sourceX:t,sourceY:e,targetX:r,targetY:a,sourceControlX:l,sourceControlY:u,targetControlX:d,targetControlY:v});return[`M${t},${e} C${l},${u} ${d},${v} ${r},${a}`,p,h,m,x]}function rm({sourceX:t,sourceY:e,targetX:n,targetY:r}){const a=Math.abs(n-t)/2,s=n<t?n+a:n-a,i=Math.abs(r-e)/2,l=r<e?r+i:r-i;return[s,l,a,i]}function JT({sourceNode:t,targetNode:e,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1,zIndexMode:s="basic"}){if(s==="manual")return r;const i=a&&n?r+1e3:r,l=Math.max(t.parentId||a&&t.selected?t.internals.z:0,e.parentId||a&&e.selected?e.internals.z:0);return i+l}function $T({sourceNode:t,targetNode:e,width:n,height:r,transform:a}){const s=uc(jl(t),jl(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return so(i,dc(s))>0}const eC=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`xy-edge__${t}${e||""}-${n}${r||""}`,tC=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),nC=(t,e,n={})=>{if(!t.source||!t.target)return e;const r=n.getEdgeId||eC;let a;return Yg(t)?a={...t}:a={...t,id:r(t)},tC(a,e)?e:(a.sourceHandle===null&&delete a.sourceHandle,a.targetHandle===null&&delete a.targetHandle,e.concat(a))};function am({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[a,s,i,l]=rm({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,a,s,i,l]}const Gv={[wt.Left]:{x:-1,y:0},[wt.Right]:{x:1,y:0},[wt.Top]:{x:0,y:-1},[wt.Bottom]:{x:0,y:1}},rC=({source:t,sourcePosition:e=wt.Bottom,target:n})=>e===wt.Left||e===wt.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},Uv=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function aC({source:t,sourcePosition:e=wt.Bottom,target:n,targetPosition:r=wt.Top,center:a,offset:s,stepPosition:i}){const l=Gv[e],u=Gv[r],d={x:t.x+l.x*s,y:t.y+l.y*s},v={x:n.x+u.x*s,y:n.y+u.y*s},p=rC({source:d,sourcePosition:e,target:v}),h=p.x!==0?"x":"y",m=p[h];let x=[],k,E;const N={x:0,y:0},j={x:0,y:0},[,,V,S]=rm({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(l[h]*u[h]===-1){h==="x"?(k=a.x??d.x+(v.x-d.x)*i,E=a.y??(d.y+v.y)/2):(k=a.x??(d.x+v.x)/2,E=a.y??d.y+(v.y-d.y)*i);const B=[{x:k,y:d.y},{x:k,y:v.y}],O=[{x:d.x,y:E},{x:v.x,y:E}];l[h]===m?x=h==="x"?B:O:x=h==="x"?O:B}else{const B=[{x:d.x,y:v.y}],O=[{x:v.x,y:d.y}];if(h==="x"?x=l.x===m?O:B:x=l.y===m?B:O,e===r){const M=Math.abs(t[h]-n[h]);if(M<=s){const q=Math.min(s-1,s-M);l[h]===m?N[h]=(d[h]>t[h]?-1:1)*q:j[h]=(v[h]>n[h]?-1:1)*q}}if(e!==r){const M=h==="x"?"y":"x",q=l[h]===u[M],T=d[M]>v[M],D=d[M]<v[M];(l[h]===1&&(!q&&T||q&&D)||l[h]!==1&&(!q&&D||q&&T))&&(x=h==="x"?B:O)}const Q={x:d.x+N.x,y:d.y+N.y},se={x:v.x+j.x,y:v.y+j.y},xe=Math.max(Math.abs(Q.x-x[0].x),Math.abs(se.x-x[0].x)),z=Math.max(Math.abs(Q.y-x[0].y),Math.abs(se.y-x[0].y));xe>=z?(k=(Q.x+se.x)/2,E=x[0].y):(k=x[0].x,E=(Q.y+se.y)/2)}return[[t,{x:d.x+N.x,y:d.y+N.y},...x,{x:v.x+j.x,y:v.y+j.y},n],k,E,V,S]}function sC(t,e,n,r){const a=Math.min(Uv(t,e)/2,Uv(e,n)/2,r),{x:s,y:i}=e;if(t.x===s&&s===n.x||t.y===i&&i===n.y)return`L${s} ${i}`;if(t.y===i){const d=t.x<n.x?-1:1,v=t.y<n.y?1:-1;return`L ${s+a*d},${i}Q ${s},${i} ${s},${i+a*v}`}const l=t.x<n.x?1:-1,u=t.y<n.y?-1:1;return`L ${s},${i+a*u}Q ${s},${i} ${s+a*l},${i}`}function Yd({sourceX:t,sourceY:e,sourcePosition:n=wt.Bottom,targetX:r,targetY:a,targetPosition:s=wt.Top,borderRadius:i=5,centerX:l,centerY:u,offset:d=20,stepPosition:v=.5}){const[p,h,m,x,k]=aC({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:a},targetPosition:s,center:{x:l,y:u},offset:d,stepPosition:v});return[p.reduce((N,j,V)=>{let S="";return V>0&&V<p.length-1?S=sC(p[V-1],j,p[V+1],i):S=`${V===0?"M":"L"}${j.x} ${j.y}`,N+=S,N},""),h,m,x,k]}function Vv(t){var e;return t&&!!(t.internals.handleBounds||(e=t.handles)!=null&&e.length)&&!!(t.measured.width||t.width||t.initialWidth)}function iC(t){var p;const{sourceNode:e,targetNode:n}=t;if(!Vv(e)||!Vv(n))return null;const r=e.internals.handleBounds||Wv(e.handles),a=n.internals.handleBounds||Wv(n.handles),s=Yv((r==null?void 0:r.source)??[],t.sourceHandle),i=Yv(t.connectionMode===ci.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),t.targetHandle);if(!s||!i)return(p=t.onError)==null||p.call(t,"008",ao.error008(s?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const l=(s==null?void 0:s.position)||wt.Bottom,u=(i==null?void 0:i.position)||wt.Top,d=Ss(e,s,l),v=Ss(n,i,u);return{sourceX:d.x,sourceY:d.y,targetX:v.x,targetY:v.y,sourcePosition:l,targetPosition:u}}function Wv(t){if(!t)return null;const e=[],n=[];for(const r of t)r.width=r.width??1,r.height=r.height??1,r.type==="source"?e.push(r):r.type==="target"&&n.push(r);return{source:e,target:n}}function Ss(t,e,n=wt.Left,r=!1){const a=((e==null?void 0:e.x)??0)+t.internals.positionAbsolute.x,s=((e==null?void 0:e.y)??0)+t.internals.positionAbsolute.y,{width:i,height:l}=e??Ms(t);if(r)return{x:a+i/2,y:s+l/2};switch((e==null?void 0:e.position)??n){case wt.Top:return{x:a+i/2,y:s};case wt.Right:return{x:a+i,y:s+l/2};case wt.Bottom:return{x:a+i/2,y:s+l};case wt.Left:return{x:a,y:s+l/2}}}function Yv(t,e){return t&&(e?t.find(n=>n.id===e):t[0])||null}function Ju(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`:""}function oC(t,{id:e,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const s=new Set;return t.reduce((i,l)=>([l.markerStart||r,l.markerEnd||a].forEach(u=>{if(u&&typeof u=="object"){const d=Ju(u,e);s.has(d)||(i.push({id:d,color:u.color||n,...u}),s.add(d))}}),i),[]).sort((i,l)=>i.id.localeCompare(l.id))}const sm=1e3,lC=10,Xd={nodeOrigin:[0,0],nodeExtent:Xu,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},cC={...Xd,checkEquality:!0};function Zd(t,e){const n={...t};for(const r in e)e[r]!==void 0&&(n[r]=e[r]);return n}function uC(t,e,n){const r=Zd(Xd,n);for(const a of t.values())if(a.parentId)Jd(a,t,e,r);else{const s=Ao(a,r.nodeOrigin),i=fi(a.extent)?a.extent:r.nodeExtent,l=ks(s,i,Ms(a));a.internals.positionAbsolute=l}}function dC(t,e){if(!t.handles)return t.measured?e==null?void 0:e.internals.handleBounds:void 0;const n=[],r=[];for(const a of t.handles){const s={id:a.id,width:a.width??1,height:a.height??1,nodeId:t.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(s):a.type==="target"&&r.push(s)}return{source:n,target:r}}function Qd(t){return t==="manual"}function fC(t,e,n,r={}){var d,v;const a=Zd(cC,r),s={i:0},i=new Map(e),l=a!=null&&a.elevateNodesOnSelect&&!Qd(a.zIndexMode)?sm:0;let u=t.length>0;e.clear(),n.clear();for(const p of t){let h=i.get(p.id);if(a.checkEquality&&p===(h==null?void 0:h.internals.userNode))e.set(p.id,h);else{const m=Ao(p,a.nodeOrigin),x=fi(p.extent)?p.extent:a.nodeExtent,k=ks(m,x,Ms(p));h={...a.defaults,...p,measured:{width:(d=p.measured)==null?void 0:d.width,height:(v=p.measured)==null?void 0:v.height},internals:{positionAbsolute:k,handleBounds:dC(p,h),z:im(p,l,a.zIndexMode),userNode:p}},e.set(p.id,h)}(h.measured===void 0||h.measured.width===void 0||h.measured.height===void 0)&&!h.hidden&&(u=!1),p.parentId&&Jd(h,e,n,r,s)}return u}function vC(t,e){if(!t.parentId)return;const n=e.get(t.parentId);n?n.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function Jd(t,e,n,r,a){const{elevateNodesOnSelect:s,nodeOrigin:i,nodeExtent:l,zIndexMode:u}=Zd(Xd,r),d=t.parentId,v=e.get(d);if(!v){console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}vC(t,n),a&&!v.parentId&&v.internals.rootParentIndex===void 0&&u==="auto"&&(v.internals.rootParentIndex=++a.i,v.internals.z=v.internals.z+a.i*lC),a&&v.internals.rootParentIndex!==void 0&&(a.i=v.internals.rootParentIndex);const p=s&&!Qd(u)?sm:0,{x:h,y:m,z:x}=hC(t,v,i,l,p,u),{positionAbsolute:k}=t.internals,E=h!==k.x||m!==k.y;(E||x!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:E?{x:h,y:m}:k,z:x}})}function im(t,e,n){const r=ma(t.zIndex)?t.zIndex:0;return Qd(n)?r:r+(t.selected?e:0)}function hC(t,e,n,r,a,s){const{x:i,y:l}=e.internals.positionAbsolute,u=Ms(t),d=Ao(t,n),v=fi(t.extent)?ks(d,t.extent,u):d;let p=ks({x:i+v.x,y:l+v.y},r,u);t.extent==="parent"&&(p=Zg(p,u,e));const h=im(t,a,s),m=e.internals.z??0;return{x:p.x,y:p.y,z:m>=h?m+1:h}}function pC(t,e,n,r=[0,0]){var i;const a=[],s=new Map;for(const l of t){const u=e.get(l.parentId);if(!u)continue;const d=((i=s.get(l.parentId))==null?void 0:i.expandedRect)??di(u),v=HT(d,l.rect);s.set(l.parentId,{expandedRect:v,parent:u})}return s.size>0&&s.forEach(({expandedRect:l,parent:u},d)=>{var V;const v=u.internals.positionAbsolute,p=Ms(u),h=u.origin??r,m=l.x<v.x?Math.round(Math.abs(v.x-l.x)):0,x=l.y<v.y?Math.round(Math.abs(v.y-l.y)):0,k=Math.max(p.width,Math.round(l.width)),E=Math.max(p.height,Math.round(l.height)),N=(k-p.width)*h[0],j=(E-p.height)*h[1];(m>0||x>0||N||j)&&(a.push({id:d,type:"position",position:{x:u.position.x-m+N,y:u.position.y-x+j}}),(V=n.get(d))==null||V.forEach(S=>{t.some(K=>K.id===S.id)||a.push({id:S.id,type:"position",position:{x:S.position.x+m,y:S.position.y+x}})})),(p.width<l.width||p.height<l.height||m||x)&&a.push({id:d,type:"dimensions",setAttributes:!0,dimensions:{width:k+(m?h[0]*m-N:0),height:E+(x?h[1]*x-j:0)}})}),a}function gC(t,e,n,r,a,s,i){const l=r==null?void 0:r.querySelector(".xyflow__viewport");let u=!1;if(!l)return{changes:[],updatedInternals:u};const d=[],v=window.getComputedStyle(l),{m22:p}=new window.DOMMatrixReadOnly(v.transform),h=[];for(const m of t.values()){const x=e.get(m.id);if(!x)continue;if(x.hidden){e.set(x.id,{...x,internals:{...x.internals,handleBounds:void 0}}),u=!0;continue}const k=Jg(m.nodeElement),E=x.measured.width!==k.width||x.measured.height!==k.height;if(!!(k.width&&k.height&&(E||!x.internals.handleBounds||m.force))){const j=m.nodeElement.getBoundingClientRect(),V=fi(x.extent)?x.extent:s;let{positionAbsolute:S}=x.internals;x.parentId&&x.extent==="parent"?S=Zg(S,k,e.get(x.parentId)):V&&(S=ks(S,V,k));const K={...x,measured:k,internals:{...x.internals,positionAbsolute:S,handleBounds:{source:Kv("source",m.nodeElement,j,p,x.id),target:Kv("target",m.nodeElement,j,p,x.id)}}};e.set(x.id,K),x.parentId&&Jd(K,e,n,{nodeOrigin:a,zIndexMode:i}),u=!0,E&&(d.push({id:x.id,type:"dimensions",dimensions:k}),x.expandParent&&x.parentId&&h.push({id:x.id,parentId:x.parentId,rect:di(K,a)}))}}if(h.length>0){const m=pC(h,e,n,a);d.push(...m)}return{changes:d,updatedInternals:u}}async function mC({delta:t,panZoom:e,transform:n,translateExtent:r,width:a,height:s}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const i=await e.setViewportConstrained({x:n[0]+t.x,y:n[1]+t.y,zoom:n[2]},[[0,0],[a,s]],r),l=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(l)}function Xv(t,e,n,r,a,s){let i=a;const l=r.get(i)||new Map;r.set(i,l.set(n,e)),i=`${a}-${t}`;const u=r.get(i)||new Map;if(r.set(i,u.set(n,e)),s){i=`${a}-${t}-${s}`;const d=r.get(i)||new Map;r.set(i,d.set(n,e))}}function yC(t,e,n){t.clear(),e.clear();for(const r of n){const{source:a,target:s,sourceHandle:i=null,targetHandle:l=null}=r,u={edgeId:r.id,source:a,target:s,sourceHandle:i,targetHandle:l},d=`${a}-${i}--${s}-${l}`,v=`${s}-${l}--${a}-${i}`;Xv("source",u,v,t,a,i),Xv("target",u,d,t,s,l),e.set(r.id,r)}}function om(t,e){if(!t.parentId)return!1;const n=e.get(t.parentId);return n?n.selected?!0:om(n,e):!1}function Zv(t,e,n){var a;let r=t;do{if((a=r==null?void 0:r.matches)!=null&&a.call(r,e))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function _C(t,e,n,r){const a=new Map;for(const[s,i]of t)if((i.selected||i.id===r)&&(!i.parentId||!om(i,t))&&(i.draggable||e&&typeof i.draggable>"u")){const l=t.get(s);l&&a.set(s,{id:s,position:l.position||{x:0,y:0},distance:{x:n.x-l.internals.positionAbsolute.x,y:n.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return a}function su({nodeId:t,dragItems:e,nodeLookup:n,dragging:r=!0}){var i,l,u;const a=[];for(const[d,v]of e){const p=(i=n.get(d))==null?void 0:i.internals.userNode;p&&a.push({...p,position:v.position,dragging:r})}if(!t)return[a[0],a];const s=(l=n.get(t))==null?void 0:l.internals.userNode;return[s?{...s,position:((u=e.get(t))==null?void 0:u.position)||s.position,dragging:r}:a[0],a]}function bC({dragItems:t,snapGrid:e,x:n,y:r}){const a=t.values().next().value;if(!a)return null;const s={x:n-a.distance.x,y:r-a.distance.y},i=To(s,e);return{x:i.x-s.x,y:i.y-s.y}}function wC({onNodeMouseDown:t,getStoreItems:e,onDragStart:n,onDrag:r,onDragStop:a}){let s={x:null,y:null},i=0,l=new Map,u=!1,d={x:0,y:0},v=null,p=!1,h=null,m=!1,x=!1,k=null;function E({noDragClassName:j,handleSelector:V,domNode:S,isSelectable:K,nodeId:B,nodeClickDistance:O=0}){h=Mr(S);function Q({x:M,y:q}){const{nodeLookup:T,nodeExtent:D,snapGrid:I,snapToGrid:X,nodeOrigin:Y,onNodeDrag:Z,onSelectionDrag:U,onError:te,updateNodePositions:ie}=e();s={x:M,y:q};let H=!1;const G=l.size>1,re=G&&D?Qu(cc(l)):null,ae=G&&X?bC({dragItems:l,snapGrid:I,x:M,y:q}):null;for(const[pe,_e]of l){if(!T.has(pe))continue;let ne={x:M-_e.distance.x,y:q-_e.distance.y};X&&(ne=ae?{x:Math.round(ne.x+ae.x),y:Math.round(ne.y+ae.y)}:To(ne,I));let $=null;if(G&&D&&!_e.extent&&re){const{positionAbsolute:Me}=_e.internals,Xe=Me.x-re.x+D[0][0],Je=Me.x+_e.measured.width-re.x2+D[1][0],ct=Me.y-re.y+D[0][1],De=Me.y+_e.measured.height-re.y2+D[1][1];$=[[Xe,ct],[Je,De]]}const{position:ke,positionAbsolute:be}=Xg({nodeId:pe,nextPosition:ne,nodeLookup:T,nodeExtent:$||D,nodeOrigin:Y,onError:te});H=H||_e.position.x!==ke.x||_e.position.y!==ke.y,_e.position=ke,_e.internals.positionAbsolute=be}if(x=x||H,!!H&&(ie(l,!0),k&&(r||Z||!B&&U))){const[pe,_e]=su({nodeId:B,dragItems:l,nodeLookup:T});r==null||r(k,l,pe,_e),Z==null||Z(k,pe,_e),B||U==null||U(k,_e)}}async function se(){if(!v)return;const{transform:M,panBy:q,autoPanSpeed:T,autoPanOnNodeDrag:D}=e();if(!D){u=!1,cancelAnimationFrame(i);return}const[I,X]=Qg(d,v,T);(I!==0||X!==0)&&(s.x=(s.x??0)-I/M[2],s.y=(s.y??0)-X/M[2],await q({x:I,y:X})&&Q(s)),i=requestAnimationFrame(se)}function xe(M){var G;const{nodeLookup:q,multiSelectionActive:T,nodesDraggable:D,transform:I,snapGrid:X,snapToGrid:Y,selectNodesOnDrag:Z,onNodeDragStart:U,onSelectionDragStart:te,unselectNodesAndEdges:ie}=e();p=!0,(!Z||!K)&&!T&&B&&((G=q.get(B))!=null&&G.selected||ie()),K&&Z&&B&&(t==null||t(B));const H=au(M.sourceEvent,{transform:I,snapGrid:X,snapToGrid:Y,containerBounds:v});if(s=H,l=_C(q,D,H,B),l.size>0&&(n||U||!B&&te)){const[re,ae]=su({nodeId:B,dragItems:l,nodeLookup:q});n==null||n(M.sourceEvent,l,re,ae),U==null||U(M.sourceEvent,re,ae),B||te==null||te(M.sourceEvent,ae)}}const z=BE().clickDistance(O).on("start",M=>{const{domNode:q,nodeDragThreshold:T,transform:D,snapGrid:I,snapToGrid:X}=e();v=(q==null?void 0:q.getBoundingClientRect())||null,m=!1,x=!1,k=M.sourceEvent,T===0&&xe(M),s=au(M.sourceEvent,{transform:D,snapGrid:I,snapToGrid:X,containerBounds:v}),d=Rr(M.sourceEvent,v)}).on("drag",M=>{const{autoPanOnNodeDrag:q,transform:T,snapGrid:D,snapToGrid:I,nodeDragThreshold:X,nodeLookup:Y}=e(),Z=au(M.sourceEvent,{transform:T,snapGrid:D,snapToGrid:I,containerBounds:v});if(k=M.sourceEvent,(M.sourceEvent.type==="touchmove"&&M.sourceEvent.touches.length>1||B&&!Y.has(B))&&(m=!0),!m){if(!u&&q&&p&&(u=!0,se()),!p){const U=Rr(M.sourceEvent,v),te=U.x-d.x,ie=U.y-d.y;Math.sqrt(te*te+ie*ie)>X&&xe(M)}(s.x!==Z.xSnapped||s.y!==Z.ySnapped)&&l&&p&&(d=Rr(M.sourceEvent,v),Q(Z))}}).on("end",M=>{if(!(!p||m)&&(u=!1,p=!1,cancelAnimationFrame(i),l.size>0)){const{nodeLookup:q,updateNodePositions:T,onNodeDragStop:D,onSelectionDragStop:I}=e();if(x&&(T(l,!1),x=!1),a||D||!B&&I){const[X,Y]=su({nodeId:B,dragItems:l,nodeLookup:q,dragging:!1});a==null||a(M.sourceEvent,l,X,Y),D==null||D(M.sourceEvent,X,Y),B||I==null||I(M.sourceEvent,Y)}}}).filter(M=>{const q=M.target;return!M.button&&(!j||!Zv(q,`.${j}`,S))&&(!V||Zv(q,V,S))});h.call(z)}function N(){h==null||h.on(".drag",null)}return{update:E,destroy:N}}function xC(t,e,n){const r=[],a={x:t.x-n,y:t.y-n,width:n*2,height:n*2};for(const s of e.values())so(a,di(s))>0&&r.push(s);return r}const kC=250;function SC(t,e,n,r){var l,u;let a=[],s=1/0;const i=xC(t,n,e+kC);for(const d of i){const v=[...((l=d.internals.handleBounds)==null?void 0:l.source)??[],...((u=d.internals.handleBounds)==null?void 0:u.target)??[]];for(const p of v){if(r.nodeId===p.nodeId&&r.type===p.type&&r.id===p.id)continue;const{x:h,y:m}=Ss(d,p,p.position,!0),x=Math.sqrt(Math.pow(h-t.x,2)+Math.pow(m-t.y,2));x>e||(x<s?(a=[{...p,x:h,y:m}],s=x):x===s&&a.push({...p,x:h,y:m}))}}if(!a.length)return null;if(a.length>1){const d=r.type==="source"?"target":"source";return a.find(v=>v.type===d)??a[0]}return a[0]}function lm(t,e,n,r,a,s=!1){var d,v,p;const i=r.get(t);if(!i)return null;const l=a==="strict"?(d=i.internals.handleBounds)==null?void 0:d[e]:[...((v=i.internals.handleBounds)==null?void 0:v.source)??[],...((p=i.internals.handleBounds)==null?void 0:p.target)??[]],u=(n?l==null?void 0:l.find(h=>h.id===n):l==null?void 0:l[0])??null;return u&&s?{...u,...Ss(i,u,u.position,!0)}:u}function cm(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function EC(t,e){let n=null;return e?n=!0:t&&!e&&(n=!1),n}const um=()=>!0;function AC(t,{connectionMode:e,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:s,isTarget:i,domNode:l,nodeLookup:u,lib:d,autoPanOnConnect:v,flowId:p,panBy:h,cancelConnection:m,onConnectStart:x,onConnect:k,onConnectEnd:E,isValidConnection:N=um,onReconnectEnd:j,updateConnection:V,getTransform:S,getFromHandle:K,autoPanSpeed:B,dragThreshold:O=1,handleDomNode:Q}){const se=$g(t.target);let xe=0,z;const{x:M,y:q}=Rr(t),T=cm(s,Q),D=l==null?void 0:l.getBoundingClientRect();let I=!1;if(!D||!T)return;const X=lm(a,T,r,u,e);if(!X)return;let Y=Rr(t,D),Z=!1,U=null,te=!1,ie=null;function H(){if(!v||!D)return;const[ke,be]=Qg(Y,D,B);h({x:ke,y:be}),xe=requestAnimationFrame(H)}const G={...X,nodeId:a,type:T,position:X.position},re=u.get(a);let pe={inProgress:!0,isValid:null,from:Ss(re,G,wt.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:re,to:Y,toHandle:null,toPosition:zv[G.position],toNode:null,pointer:Y};function _e(){I=!0,V(pe),x==null||x(t,{nodeId:a,handleId:r,handleType:T})}O===0&&_e();function ne(ke){if(!I){const{x:De,y:Oe}=Rr(ke),qe=De-M,Ne=Oe-q;if(!(qe*qe+Ne*Ne>O*O))return;_e()}if(!K()||!G){$(ke);return}const be=S();Y=Rr(ke,D),z=SC(Co(Y,be,!1,[1,1]),n,u,G),Z||(H(),Z=!0);const Me=dm(ke,{handle:z,connectionMode:e,fromNodeId:a,fromHandleId:r,fromType:i?"target":"source",isValidConnection:N,doc:se,lib:d,flowId:p,nodeLookup:u});ie=Me.handleDomNode,U=Me.connection,te=EC(!!z,Me.isValid);const Xe=u.get(a),Je=Xe?Ss(Xe,G,wt.Left,!0):pe.from,ct={...pe,from:Je,isValid:te,to:Me.toHandle&&te?zl({x:Me.toHandle.x,y:Me.toHandle.y},be):Y,toHandle:Me.toHandle,toPosition:te&&Me.toHandle?Me.toHandle.position:zv[G.position],toNode:Me.toHandle?u.get(Me.toHandle.nodeId):null,pointer:Y};V(ct),pe=ct}function $(ke){if(!("touches"in ke&&ke.touches.length>0)){if(I){(z||ie)&&U&&te&&(k==null||k(U));const{inProgress:be,...Me}=pe,Xe={...Me,toPosition:pe.toHandle?pe.toPosition:null};E==null||E(ke,Xe),s&&(j==null||j(ke,Xe))}m(),cancelAnimationFrame(xe),Z=!1,te=!1,U=null,ie=null,se.removeEventListener("mousemove",ne),se.removeEventListener("mouseup",$),se.removeEventListener("touchmove",ne),se.removeEventListener("touchend",$)}}se.addEventListener("mousemove",ne),se.addEventListener("mouseup",$),se.addEventListener("touchmove",ne),se.addEventListener("touchend",$)}function dm(t,{handle:e,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:s,doc:i,lib:l,flowId:u,isValidConnection:d=um,nodeLookup:v}){const p=s==="target",h=e?i.querySelector(`.${l}-flow__handle[data-id="${u}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:m,y:x}=Rr(t),k=i.elementFromPoint(m,x),E=k!=null&&k.classList.contains(`${l}-flow__handle`)?k:h,N={handleDomNode:E,isValid:!1,connection:null,toHandle:null};if(E){const j=cm(void 0,E),V=E.getAttribute("data-nodeid"),S=E.getAttribute("data-handleid"),K=E.classList.contains("connectable"),B=E.classList.contains("connectableend");if(!V||!j)return N;const O={source:p?V:r,sourceHandle:p?S:a,target:p?r:V,targetHandle:p?a:S};N.connection=O;const se=K&&B&&(n===ci.Strict?p&&j==="source"||!p&&j==="target":V!==r||S!==a);N.isValid=se&&d(O),N.toHandle=lm(V,j,S,v,n,!0)}return N}const Qv={onPointerDown:AC,isValid:dm},fc=t=>({x:t.x,y:t.y,zoom:t.k}),iu=({x:t,y:e,zoom:n})=>lc.translate(t,e).scale(n),Ks=(t,e)=>t.target.closest(`.${e}`),fm=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),TC=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,ou=(t,e=0,n=TC,r=()=>{})=>{const a=typeof e=="number"&&e>0;return a||r(),a?t.transition().duration(e).ease(n).on("end",r):t},vm=t=>{const e=t.ctrlKey&&ql()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function CC({zoomPanValues:t,noWheelClassName:e,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:l,onPanZoom:u,onPanZoomEnd:d}){return v=>{if(Ks(v,e))return v.ctrlKey&&v.preventDefault(),!1;v.preventDefault(),v.stopImmediatePropagation();const p=n.property("__zoom").k||1;if(v.ctrlKey&&i){const E=Gr(v),N=vm(v),j=p*Math.pow(2,N);r.scaleTo(n,j,E,v);return}const h=v.deltaMode===1?20:1;let m=a===Us.Vertical?0:v.deltaX*h,x=a===Us.Horizontal?0:v.deltaY*h;!ql()&&v.shiftKey&&a!==Us.Vertical&&(m=v.deltaY*h,x=0),r.translateBy(n,-(m/p)*s,-(x/p)*s,{internal:!0});const k=fc(n.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(u==null||u(v,k),t.panScrollTimeout=setTimeout(()=>{d==null||d(v,k),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,l==null||l(v,k))}}function IC({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:n}){return function(r,a){const s=r.type==="wheel",i=!e&&s&&!r.ctrlKey,l=Ks(r,t);if(r.ctrlKey&&s&&l&&r.preventDefault(),i||l)return null;r.preventDefault(),n.call(this,r,a)}}function PC({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:n}){return r=>{var s,i,l;if((s=r.sourceEvent)!=null&&s.internal)return;const a=fc(r.transform);t.mouseButton=((i=r.sourceEvent)==null?void 0:i.button)||0,t.isZoomingOrPanning=!0,t.prevViewport=a,((l=r.sourceEvent)==null?void 0:l.type)==="mousedown"&&e(!0),n&&(n==null||n(r.sourceEvent,a))}}function MC({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return s=>{var i,l;t.usedRightMouseButton=!!(n&&fm(e,t.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||r([s.transform.x,s.transform.y,s.transform.k]),a&&!((l=s.sourceEvent)!=null&&l.internal)&&(a==null||a(s.sourceEvent,fc(s.transform)))}}function OC({zoomPanValues:t,panOnDrag:e,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:s}){return i=>{var l;if(!((l=i.sourceEvent)!=null&&l.internal)&&(t.isZoomingOrPanning=!1,s&&fm(e,t.mouseButton??0)&&!t.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),t.usedRightMouseButton=!1,r(!1),a)){const u=fc(i.transform);t.prevViewport=u,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{a==null||a(i.sourceEvent,u)},n?150:0)}}}function NC({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:l,noPanClassName:u,lib:d,connectionInProgress:v}){return p=>{var E;const h=t||e,m=n&&p.ctrlKey,x=p.type==="wheel";if(p.button===1&&p.type==="mousedown"&&(Ks(p,`${d}-flow__node`)||Ks(p,`${d}-flow__edge`)))return!0;if(!r&&!h&&!a&&!s&&!n||i||v&&!x||Ks(p,l)&&x||Ks(p,u)&&(!x||a&&x&&!t)||!n&&p.ctrlKey&&x)return!1;if(!n&&p.type==="touchstart"&&((E=p.touches)==null?void 0:E.length)>1)return p.preventDefault(),!1;if(!h&&!a&&!m&&x||!r&&(p.type==="mousedown"||p.type==="touchstart")||Array.isArray(r)&&!r.includes(p.button)&&p.type==="mousedown")return!1;const k=Array.isArray(r)&&r.includes(p.button)||!p.button||p.button<=1;return(!p.ctrlKey||x)&&k}}function DC({domNode:t,minZoom:e,maxZoom:n,translateExtent:r,viewport:a,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:l,onDraggingChange:u}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},v=t.getBoundingClientRect(),p=NT().scaleExtent([e,n]).translateExtent(r),h=Mr(t).call(p);j({x:a.x,y:a.y,zoom:ui(a.zoom,e,n)},[[0,0],[v.width,v.height]],r);const m=h.on("wheel.zoom"),x=h.on("dblclick.zoom");p.wheelDelta(vm);function k(z,M){return h?new Promise(q=>{p==null||p.interpolate((M==null?void 0:M.interpolate)==="linear"?Xi:gl).transform(ou(h,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>q(!0)),z)}):Promise.resolve(!1)}function E({noWheelClassName:z,noPanClassName:M,onPaneContextMenu:q,userSelectionActive:T,panOnScroll:D,panOnDrag:I,panOnScrollMode:X,panOnScrollSpeed:Y,preventScrolling:Z,zoomOnPinch:U,zoomOnScroll:te,zoomOnDoubleClick:ie,zoomActivationKeyPressed:H,lib:G,onTransformChange:re,connectionInProgress:ae,paneClickDistance:pe,selectionOnDrag:_e}){T&&!d.isZoomingOrPanning&&N();const ne=D&&!H&&!T;p.clickDistance(_e?1/0:!ma(pe)||pe<0?0:pe);const $=ne?CC({zoomPanValues:d,noWheelClassName:z,d3Selection:h,d3Zoom:p,panOnScrollMode:X,panOnScrollSpeed:Y,zoomOnPinch:U,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:l}):IC({noWheelClassName:z,preventScrolling:Z,d3ZoomHandler:m});if(h.on("wheel.zoom",$,{passive:!1}),!T){const be=PC({zoomPanValues:d,onDraggingChange:u,onPanZoomStart:i});p.on("start",be);const Me=MC({zoomPanValues:d,panOnDrag:I,onPaneContextMenu:!!q,onPanZoom:s,onTransformChange:re});p.on("zoom",Me);const Xe=OC({zoomPanValues:d,panOnDrag:I,panOnScroll:D,onPaneContextMenu:q,onPanZoomEnd:l,onDraggingChange:u});p.on("end",Xe)}const ke=NC({zoomActivationKeyPressed:H,panOnDrag:I,zoomOnScroll:te,panOnScroll:D,zoomOnDoubleClick:ie,zoomOnPinch:U,userSelectionActive:T,noPanClassName:M,noWheelClassName:z,lib:G,connectionInProgress:ae});p.filter(ke),ie?h.on("dblclick.zoom",x):h.on("dblclick.zoom",null)}function N(){p.on("zoom",null)}async function j(z,M,q){const T=iu(z),D=p==null?void 0:p.constrain()(T,M,q);return D&&await k(D),new Promise(I=>I(D))}async function V(z,M){const q=iu(z);return await k(q,M),new Promise(T=>T(q))}function S(z){if(h){const M=iu(z),q=h.property("__zoom");(q.k!==z.zoom||q.x!==z.x||q.y!==z.y)&&(p==null||p.transform(h,M,null,{sync:!0}))}}function K(){const z=h?Vg(h.node()):{x:0,y:0,k:1};return{x:z.x,y:z.y,zoom:z.k}}function B(z,M){return h?new Promise(q=>{p==null||p.interpolate((M==null?void 0:M.interpolate)==="linear"?Xi:gl).scaleTo(ou(h,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>q(!0)),z)}):Promise.resolve(!1)}function O(z,M){return h?new Promise(q=>{p==null||p.interpolate((M==null?void 0:M.interpolate)==="linear"?Xi:gl).scaleBy(ou(h,M==null?void 0:M.duration,M==null?void 0:M.ease,()=>q(!0)),z)}):Promise.resolve(!1)}function Q(z){p==null||p.scaleExtent(z)}function se(z){p==null||p.translateExtent(z)}function xe(z){const M=!ma(z)||z<0?0:z;p==null||p.clickDistance(M)}return{update:E,destroy:N,setViewport:V,setViewportConstrained:j,getViewport:K,scaleTo:B,scaleBy:O,setScaleExtent:Q,setTranslateExtent:se,syncViewport:S,setClickDistance:xe}}var Jv;(function(t){t.Line="line",t.Handle="handle"})(Jv||(Jv={}));function $d(){const t={};return[e=>{if(e&&!xy(t))throw new Error(e);return ad(t)},e=>Sh(t,e)]}const[RC,LC]=$d(),[jC,zC]=$d(),[qC,BC]=$d();var FC=L("<div><!></div>");function Ga(t,e){at(e,!0);let n=Ae(e,"id",3,null),r=Ae(e,"type",3,"source"),a=Ae(e,"position",19,()=>wt.Top),s=Ae(e,"isConnectableStart",3,!0),i=Ae(e,"isConnectableEnd",3,!0),l=Is(e,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const u=RC("Handle must be used within a Custom Node component"),d=jC("Handle must be used within a Custom Node component");let v=J(()=>r()==="target"),p=J(()=>e.isConnectable!==void 0?e.isConnectable:d.value),h=Os(),m=J(()=>h.ariaLabelConfig),x=null;Wh(()=>{if(e.onconnect||e.ondisconnect){h.edges;let M=h.connectionLookup.get(`${u}-${r()}${n()?`-${n()}`:""}`);if(x&&!RT(M,x)){const q=M??new Map;qv(x,q,e.ondisconnect),qv(q,x,e.onconnect)}x=new Map(M)}});let k=J(()=>{if(!h.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:M,toHandle:q,isValid:T}=h.connection,D=M&&M.nodeId===u&&M.type===r()&&M.id===n(),I=q&&q.nodeId===u&&q.type===r()&&q.id===n(),X=h.connectionMode===ci.Strict?(M==null?void 0:M.type)!==r():u!==(M==null?void 0:M.nodeId)||n()!==(M==null?void 0:M.id);return[!0,D,I,X,I&&T]}),E=J(()=>ho(o(k),5)),N=J(()=>o(E)[0]),j=J(()=>o(E)[1]),V=J(()=>o(E)[2]),S=J(()=>o(E)[3]),K=J(()=>o(E)[4]);function B(M){var T;const q=h.onbeforeconnect?h.onbeforeconnect(M):M;q&&(h.addEdge(q),(T=h.onconnect)==null||T.call(h,M))}function O(M){const q=tm(M);M.currentTarget&&(q&&M.button===0||!q)&&Qv.onPointerDown(M,{handleId:n(),nodeId:u,isTarget:o(v),connectionRadius:h.connectionRadius,domNode:h.domNode,nodeLookup:h.nodeLookup,connectionMode:h.connectionMode,lib:"svelte",autoPanOnConnect:h.autoPanOnConnect,autoPanSpeed:h.autoPanSpeed,flowId:h.flowId,isValidConnection:e.isValidConnection||((...T)=>{var D;return((D=h.isValidConnection)==null?void 0:D.call(h,...T))??!0}),updateConnection:h.updateConnection,cancelConnection:h.cancelConnection,panBy:h.panBy,onConnect:B,onConnectStart:h.onconnectstart,onConnectEnd:(...T)=>{var D;return(D=h.onconnectend)==null?void 0:D.call(h,...T)},getTransform:()=>[h.viewport.x,h.viewport.y,h.viewport.zoom],getFromHandle:()=>h.connection.fromHandle,dragThreshold:h.connectionDragThreshold,handleDomNode:M.currentTarget})}function Q(M){var ie,H;if(!u||!h.clickConnectStartHandle&&!s())return;if(!h.clickConnectStartHandle){(ie=h.onclickconnectstart)==null||ie.call(h,M,{nodeId:u,handleId:n(),handleType:r()}),h.clickConnectStartHandle={nodeId:u,type:r(),id:n()};return}const q=$g(M.target),T=e.isValidConnection??h.isValidConnection,{connectionMode:D,clickConnectStartHandle:I,flowId:X,nodeLookup:Y}=h,{connection:Z,isValid:U}=Qv.isValid(M,{handle:{nodeId:u,id:n(),type:r()},connectionMode:D,fromNodeId:I.nodeId,fromHandleId:I.id??null,fromType:I.type,isValidConnection:T,flowId:X,doc:q,lib:"svelte",nodeLookup:Y});U&&Z&&B(Z);const te=structuredClone(kh(h.connection));delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,(H=h.onclickconnectend)==null||H.call(h,M,te),h.clickConnectStartHandle=null}var se=FC(),xe=()=>{};Va(se,()=>({"data-handleid":n(),"data-nodeid":u,"data-handlepos":a(),"data-id":`${h.flowId??""}-${u??""}-${n()??"null"??""}-${r()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${a()}`,h.noDragClass,h.noPanClass,a(),e.class],onmousedown:O,ontouchstart:O,onclick:h.clickConnect?Q:void 0,onkeypress:xe,style:e.style,role:"button","aria-label":o(m)["handle.ariaLabel"],tabindex:"-1",...l,[Ma]:{valid:o(K),connectingto:o(V),connectingfrom:o(j),source:!o(v),target:o(v),connectablestart:s(),connectableend:i(),connectable:o(p),connectionindicator:o(p)&&(!o(N)||o(S))&&(o(N)||h.clickConnectStartHandle?i():s())}}));var z=_(se);yr(z,()=>e.children??Es),C(t,se),st()}var KC=L("<!> <!>",1);function hm(t,e){at(e,!0);let n=Ae(e,"targetPosition",19,()=>wt.Top),r=Ae(e,"sourcePosition",19,()=>wt.Bottom);var a=KC(),s=Ye(a);Ga(s,{type:"target",get position(){return n()}});var i=b(s),l=b(i);Ga(l,{type:"source",get position(){return r()}}),oe(()=>{var u;return ee(i,` ${((u=e.data)==null?void 0:u.label)??""} `)}),C(t,a),st()}var HC=L(" <!>",1);function GC(t,e){at(e,!0);let n=Ae(e,"data",19,()=>({label:"Node"})),r=Ae(e,"sourcePosition",19,()=>wt.Bottom);var a=HC(),s=Ye(a),i=b(s);Ga(i,{type:"source",get position(){return r()}}),oe(()=>{var l;return ee(s,`${((l=n())==null?void 0:l.label)??""} `)}),C(t,a),st()}var UC=L(" <!>",1);function VC(t,e){at(e,!0);let n=Ae(e,"data",19,()=>({label:"Node"})),r=Ae(e,"targetPosition",19,()=>wt.Top);var a=UC(),s=Ye(a),i=b(s);Ga(i,{type:"target",get position(){return r()}}),oe(()=>{var l;return ee(s,`${((l=n())==null?void 0:l.label)??""} `)}),C(t,a),st()}function WC(t,e){}function lu(t,e,n){if(!n||!e)return;const r=n==="root"?e:e.querySelector(`.svelte-flow__${n}`);r&&r.appendChild(t)}function cu(t,e){const n=J(Os),r=J(()=>o(n).domNode);let a;return o(r)?lu(t,o(r),e):a=Yh(()=>{yn(()=>{lu(t,o(r),e),a==null||a()})}),{async update(s){lu(t,o(r),s)},destroy(){t.parentNode&&t.parentNode.removeChild(t),a==null||a()}}}function YC(){let t=Pe(typeof window>"u");if(o(t)){const e=Yh(()=>{yn(()=>{P(t,!1),e==null||e()})})}return{get value(){return o(t)}}}const $v=t=>jT(t),XC=t=>Yg(t);function ra(t){return t===void 0?void 0:`${t}px`}const Bl={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var ZC=L("<div><!></div>");function QC(t,e){at(e,!0);let n=Ae(e,"x",3,0),r=Ae(e,"y",3,0),a=Ae(e,"selectEdgeOnClick",3,!1),s=Ae(e,"transparent",3,!1),i=Is(e,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const l=Os(),u=qC("EdgeLabel must be used within a Custom Edge component");let d=J(()=>{var m;return(m=l.visible.edges.get(u))==null?void 0:m.zIndex});var v=ZC(),p=()=>{a()&&u&&l.handleEdgeSelection(u)};Va(v,m=>({class:["svelte-flow__edge-label",{transparent:s()},e.class],tabindex:"-1",onclick:p,...i,[va]:m}),[()=>({display:YC().value?"none":void 0,cursor:a()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${n()??""}px,${r()??""}px)`,"pointer-events":"all",width:ra(e.width),height:ra(e.height),"z-index":o(d)})],void 0,void 0,"svelte-1wg91mu");var h=_(v);yr(h,()=>e.children??Es),Xn(v,(m,x)=>cu==null?void 0:cu(m,x),()=>"edge-labels"),C(t,v),st()}var JC=mn("<path></path>"),$C=mn('<path fill="none"></path><!><!>',1);function vc(t,e){let n=Ae(e,"interactionWidth",3,20),r=Is(e,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var a=$C(),s=Ye(a),i=b(s);{var l=v=>{var p=JC();Va(p,()=>({d:e.path,"stroke-opacity":0,"stroke-width":n(),fill:"none",class:"svelte-flow__edge-interaction",...r})),C(v,p)};ue(i,v=>{n()>0&&v(l)})}var u=b(i);{var d=v=>{QC(v,{get x(){return e.labelX},get y(){return e.labelY},get style(){return e.labelStyle},selectEdgeOnClick:!0,children:(p,h)=>{var m=on();oe(()=>ee(m,e.label)),C(p,m)},$$slots:{default:!0}})};ue(u,v=>{e.label&&v(d)})}oe(()=>{xt(s,"id",e.id),xt(s,"d",e.path),St(s,0,Ts(["svelte-flow__edge-path",e.class])),xt(s,"marker-start",e.markerStart),xt(s,"marker-end",e.markerEnd),Dt(s,e.style)}),C(t,a)}function pm(t,e){at(e,!0);let n=J(()=>{var l;return nm({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,curvature:(l=e.pathOptions)==null?void 0:l.curvature})}),r=J(()=>ho(o(n),3)),a=J(()=>o(r)[0]),s=J(()=>o(r)[1]),i=J(()=>o(r)[2]);vc(t,{get id(){return e.id},get path(){return o(a)},get labelX(){return o(s)},get labelY(){return o(i)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),st()}function eI(t,e){at(e,!0);let n=J(()=>Yd({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition})),r=J(()=>ho(o(n),3)),a=J(()=>o(r)[0]),s=J(()=>o(r)[1]),i=J(()=>o(r)[2]);vc(t,{get path(){return o(a)},get labelX(){return o(s)},get labelY(){return o(i)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),st()}function tI(t,e){at(e,!0);let n=J(()=>am({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY})),r=J(()=>ho(o(n),3)),a=J(()=>o(r)[0]),s=J(()=>o(r)[1]),i=J(()=>o(r)[2]);vc(t,{get path(){return o(a)},get labelX(){return o(s)},get labelY(){return o(i)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),st()}function nI(t,e){at(e,!0);let n=J(()=>Yd({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,borderRadius:0})),r=J(()=>ho(o(n),3)),a=J(()=>o(r)[0]),s=J(()=>o(r)[1]),i=J(()=>o(r)[2]);vc(t,{get path(){return o(a)},get labelX(){return o(s)},get labelY(){return o(i)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),st()}var fo,vo;class rI{constructor(e,n){Ie(this,fo);Ie(this,vo);Et(this,fo,e),Et(this,vo,Dh(n))}get current(){return F(this,vo).call(this),F(this,fo).call(this)}}fo=new WeakMap,vo=new WeakMap;const aI=/\(.+\)/,sI=new Set(["all","print","screen","and","or","not","only"]);class iI extends rI{constructor(e,n){let r=aI.test(e)||e.split(/[\s,]+/).some(s=>sI.has(s.trim()))?e:`(${e})`;const a=window.matchMedia(r);super(()=>a.matches,s=>ku(a,"change",s))}}function oI(t,e,n,r){const a=new Map;return Vd(t,{x:0,y:0,width:n,height:r},e,!0).forEach(s=>{a.set(s.id,s)}),a}function eh(t){const{edges:e,defaultEdgeOptions:n,nodeLookup:r,previousEdges:a,connectionMode:s,onerror:i,onlyRenderVisible:l,elevateEdgesOnSelect:u,zIndexMode:d}=t,v=new Map;for(const p of e){const h=r.get(p.source),m=r.get(p.target);if(!h||!m)continue;if(l){const{visibleNodes:E,transform:N,width:j,height:V}=t;if($T({sourceNode:h,targetNode:m,width:j,height:V,transform:N}))E.set(h.id,h),E.set(m.id,m);else continue}const x=a.get(p.id);if(x&&p===x.edge&&h==x.sourceNode&&m==x.targetNode){v.set(p.id,x);continue}const k=iC({id:p.id,sourceNode:h,targetNode:m,sourceHandle:p.sourceHandle||null,targetHandle:p.targetHandle||null,connectionMode:s,onError:i});k&&v.set(p.id,{...n,...p,...k,zIndex:JT({selected:p.selected,zIndex:p.zIndex??n.zIndex,sourceNode:h,targetNode:m,elevateOnSelect:u,zIndexMode:d}),sourceNode:h,targetNode:m,edge:p})}return v}const gm={input:GC,output:VC,default:hm,group:WC},mm={straight:tI,smoothstep:eI,default:pm,step:nI};function lI(t,e,n,r,a,s){if(e&&!n&&r&&a){const i=cc(s,{filter:l=>!!((l.width||l.initialWidth)&&(l.height||l.initialHeight))});return Wd(i,r,a,.5,2,.1)}else return n??{x:0,y:0,zoom:1}}function cI(t){var n,r,a,s,i,l,u,d,v,p,h,m,x,k,E,N,j,V,S,K,B,O,Q,se,xe,z,M,q,T,D,I,X,Y,Z,U,te,ie,H,G,re,ae,pe,_e,ne,$,ke,be,Me,Xe,Je,ct,De,Oe,qe,Ne,Fe,Ke,$e,Ze,Ge,tt,nt,ft,mt,vt,kt,bt,pt,yt,dt,je,Rt,At,Gt,Re,Qt;class e{constructor(){Ie(this,n,J(()=>t.props.id??"1"));Ie(this,r,Pe(null));Ie(this,a,Pe(null));Ie(this,s,Pe(t.width??0));Ie(this,i,Pe(t.height??0));Ie(this,l,Pe(t.props.zIndexMode??"basic"));Ie(this,u,J(()=>{var ln;const ye=fC(t.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:t.props.elevateNodesOnSelect??!0,checkEquality:!0,zIndexMode:this.zIndexMode});return this.fitViewQueued&&ye&&((ln=this.fitViewOptions)!=null&&ln.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),ye}));Ie(this,d,J(()=>this.panZoom!==null));Ie(this,v,J(()=>(yC(this.connectionLookup,this.edgeLookup,t.edges),t.edges)));ht(this,"_prevSelectedNodes",[]);ht(this,"_prevSelectedNodeIds",new Set);Ie(this,p,J(()=>{const ye=this._prevSelectedNodeIds.size,ln=new Set,En=this.nodes.filter(Ct=>(Ct.selected&&(ln.add(Ct.id),this._prevSelectedNodeIds.delete(Ct.id)),Ct.selected));return(ye!==ln.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=En),this._prevSelectedNodeIds=ln,this._prevSelectedNodes}));ht(this,"_prevSelectedEdges",[]);ht(this,"_prevSelectedEdgeIds",new Set);Ie(this,h,J(()=>{const ye=this._prevSelectedEdgeIds.size,ln=new Set,En=this.edges.filter(Ct=>(Ct.selected&&(ln.add(Ct.id),this._prevSelectedEdgeIds.delete(Ct.id)),Ct.selected));return(ye!==ln.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=En),this._prevSelectedEdgeIds=ln,this._prevSelectedEdges}));ht(this,"selectionChangeHandlers",new Map);ht(this,"nodeLookup",new Map);ht(this,"parentLookup",new Map);ht(this,"connectionLookup",new Map);ht(this,"edgeLookup",new Map);ht(this,"_prevVisibleEdges",new Map);Ie(this,m,J(()=>{const{nodes:ye,_edges:ln,_prevVisibleEdges:En,nodeLookup:Ct,connectionMode:Mn,onerror:it,onlyRenderVisibleElements:ut,defaultEdgeOptions:Pt,zIndexMode:$t}=this;let _t,jt;const fn={edges:ln,defaultEdgeOptions:Pt,previousEdges:En,nodeLookup:Ct,connectionMode:Mn,elevateEdgesOnSelect:t.props.elevateEdgesOnSelect??!0,zIndexMode:$t,onerror:it};if(ut){const{viewport:cn,width:Jt,height:en}=this,jn=[cn.x,cn.y,cn.zoom];_t=oI(Ct,jn,Jt,en),jt=eh({...fn,onlyRenderVisible:!0,visibleNodes:_t,transform:jn,width:Jt,height:en})}else _t=this.nodeLookup,jt=eh(fn);return{nodes:_t,edges:jt}}));Ie(this,x,J(()=>t.props.nodesDraggable??!0));Ie(this,k,J(()=>t.props.nodesConnectable??!0));Ie(this,E,J(()=>t.props.elementsSelectable??!0));Ie(this,N,J(()=>t.props.nodesFocusable??!0));Ie(this,j,J(()=>t.props.edgesFocusable??!0));Ie(this,V,J(()=>t.props.disableKeyboardA11y??!1));Ie(this,S,J(()=>t.props.minZoom??.5));Ie(this,K,J(()=>t.props.maxZoom??2));Ie(this,B,J(()=>t.props.nodeOrigin??[0,0]));Ie(this,O,J(()=>t.props.nodeExtent??Xu));Ie(this,Q,J(()=>t.props.translateExtent??Xu));Ie(this,se,J(()=>t.props.defaultEdgeOptions??{}));Ie(this,xe,J(()=>t.props.nodeDragThreshold??1));Ie(this,z,J(()=>t.props.autoPanOnNodeDrag??!0));Ie(this,M,J(()=>t.props.autoPanOnConnect??!0));Ie(this,q,J(()=>t.props.autoPanOnNodeFocus??!0));Ie(this,T,J(()=>t.props.autoPanSpeed??15));Ie(this,D,J(()=>t.props.connectionDragThreshold??1));ht(this,"fitViewQueued",t.props.fitView??!1);ht(this,"fitViewOptions",t.props.fitViewOptions);ht(this,"fitViewResolver",null);Ie(this,I,J(()=>t.props.snapGrid??null));Ie(this,X,Pe(!1));Ie(this,Y,Pe(null));Ie(this,Z,Pe(!1));Ie(this,U,Pe(!1));Ie(this,te,Pe(!1));Ie(this,ie,Pe(!1));Ie(this,H,Pe(!1));Ie(this,G,Pe(null));Ie(this,re,Pe(""));Ie(this,ae,J(()=>t.props.selectionMode??Rl.Partial));Ie(this,pe,J(()=>({...gm,...t.props.nodeTypes})));Ie(this,_e,J(()=>({...mm,...t.props.edgeTypes})));Ie(this,ne,J(()=>t.props.noPanClass??"nopan"));Ie(this,$,J(()=>t.props.noDragClass??"nodrag"));Ie(this,ke,J(()=>t.props.noWheelClass??"nowheel"));Ie(this,be,J(()=>XT(t.props.ariaLabelConfig)));Ie(this,Me,Pe(lI(this.nodesInitialized,t.props.fitView,t.props.initialViewport,this.width,this.height,this.nodeLookup)));Ie(this,Xe,Pe(Zu));Ie(this,Je,J(()=>this._connection.inProgress?{...this._connection,to:Co(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection));Ie(this,ct,J(()=>t.props.connectionMode??ci.Strict));Ie(this,De,J(()=>t.props.connectionRadius??20));Ie(this,Oe,J(()=>t.props.isValidConnection??(()=>!0)));Ie(this,qe,J(()=>t.props.selectNodesOnDrag??!0));Ie(this,Ne,J(()=>t.props.defaultMarkerColor===void 0?"#b1b1b7":t.props.defaultMarkerColor));Ie(this,Fe,J(()=>oC(t.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd})));Ie(this,Ke,J(()=>t.props.onlyRenderVisibleElements??!1));Ie(this,$e,J(()=>t.props.onflowerror??GT));Ie(this,Ze,J(()=>t.props.ondelete));Ie(this,Ge,J(()=>t.props.onbeforedelete));Ie(this,tt,J(()=>t.props.onbeforeconnect));Ie(this,nt,J(()=>t.props.onconnect));Ie(this,ft,J(()=>t.props.onconnectstart));Ie(this,mt,J(()=>t.props.onconnectend));Ie(this,vt,J(()=>t.props.onbeforereconnect));Ie(this,kt,J(()=>t.props.onreconnect));Ie(this,bt,J(()=>t.props.onreconnectstart));Ie(this,pt,J(()=>t.props.onreconnectend));Ie(this,yt,J(()=>t.props.clickConnect??!0));Ie(this,dt,J(()=>t.props.onclickconnectstart));Ie(this,je,J(()=>t.props.onclickconnectend));Ie(this,Rt,Pe(null));Ie(this,At,J(()=>t.props.onselectiondrag));Ie(this,Gt,J(()=>t.props.onselectiondragstart));Ie(this,Re,J(()=>t.props.onselectiondragstop));ht(this,"resolveFitView",async()=>{var ye;this.panZoom&&(await FT({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),(ye=this.fitViewResolver)==null||ye.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)});ht(this,"_prefersDark",new iI("(prefers-color-scheme: dark)",t.props.colorModeSSR==="dark"));Ie(this,Qt,J(()=>t.props.colorMode==="system"?this._prefersDark.current?"dark":"light":t.props.colorMode??"light"))}get flowId(){return o(F(this,n))}set flowId(ye){P(F(this,n),ye)}get domNode(){return o(F(this,r))}set domNode(ye){P(F(this,r),ye)}get panZoom(){return o(F(this,a))}set panZoom(ye){P(F(this,a),ye)}get width(){return o(F(this,s))}set width(ye){P(F(this,s),ye)}get height(){return o(F(this,i))}set height(ye){P(F(this,i),ye)}get zIndexMode(){return o(F(this,l))}set zIndexMode(ye){P(F(this,l),ye)}get nodesInitialized(){return o(F(this,u))}set nodesInitialized(ye){P(F(this,u),ye)}get viewportInitialized(){return o(F(this,d))}set viewportInitialized(ye){P(F(this,d),ye)}get _edges(){return o(F(this,v))}set _edges(ye){P(F(this,v),ye)}get nodes(){return this.nodesInitialized,t.nodes}set nodes(ye){t.nodes=ye}get edges(){return this._edges}set edges(ye){t.edges=ye}get selectedNodes(){return o(F(this,p))}set selectedNodes(ye){P(F(this,p),ye)}get selectedEdges(){return o(F(this,h))}set selectedEdges(ye){P(F(this,h),ye)}get visible(){return o(F(this,m))}set visible(ye){P(F(this,m),ye)}get nodesDraggable(){return o(F(this,x))}set nodesDraggable(ye){P(F(this,x),ye)}get nodesConnectable(){return o(F(this,k))}set nodesConnectable(ye){P(F(this,k),ye)}get elementsSelectable(){return o(F(this,E))}set elementsSelectable(ye){P(F(this,E),ye)}get nodesFocusable(){return o(F(this,N))}set nodesFocusable(ye){P(F(this,N),ye)}get edgesFocusable(){return o(F(this,j))}set edgesFocusable(ye){P(F(this,j),ye)}get disableKeyboardA11y(){return o(F(this,V))}set disableKeyboardA11y(ye){P(F(this,V),ye)}get minZoom(){return o(F(this,S))}set minZoom(ye){P(F(this,S),ye)}get maxZoom(){return o(F(this,K))}set maxZoom(ye){P(F(this,K),ye)}get nodeOrigin(){return o(F(this,B))}set nodeOrigin(ye){P(F(this,B),ye)}get nodeExtent(){return o(F(this,O))}set nodeExtent(ye){P(F(this,O),ye)}get translateExtent(){return o(F(this,Q))}set translateExtent(ye){P(F(this,Q),ye)}get defaultEdgeOptions(){return o(F(this,se))}set defaultEdgeOptions(ye){P(F(this,se),ye)}get nodeDragThreshold(){return o(F(this,xe))}set nodeDragThreshold(ye){P(F(this,xe),ye)}get autoPanOnNodeDrag(){return o(F(this,z))}set autoPanOnNodeDrag(ye){P(F(this,z),ye)}get autoPanOnConnect(){return o(F(this,M))}set autoPanOnConnect(ye){P(F(this,M),ye)}get autoPanOnNodeFocus(){return o(F(this,q))}set autoPanOnNodeFocus(ye){P(F(this,q),ye)}get autoPanSpeed(){return o(F(this,T))}set autoPanSpeed(ye){P(F(this,T),ye)}get connectionDragThreshold(){return o(F(this,D))}set connectionDragThreshold(ye){P(F(this,D),ye)}get snapGrid(){return o(F(this,I))}set snapGrid(ye){P(F(this,I),ye)}get dragging(){return o(F(this,X))}set dragging(ye){P(F(this,X),ye)}get selectionRect(){return o(F(this,Y))}set selectionRect(ye){P(F(this,Y),ye)}get selectionKeyPressed(){return o(F(this,Z))}set selectionKeyPressed(ye){P(F(this,Z),ye)}get multiselectionKeyPressed(){return o(F(this,U))}set multiselectionKeyPressed(ye){P(F(this,U),ye)}get deleteKeyPressed(){return o(F(this,te))}set deleteKeyPressed(ye){P(F(this,te),ye)}get panActivationKeyPressed(){return o(F(this,ie))}set panActivationKeyPressed(ye){P(F(this,ie),ye)}get zoomActivationKeyPressed(){return o(F(this,H))}set zoomActivationKeyPressed(ye){P(F(this,H),ye)}get selectionRectMode(){return o(F(this,G))}set selectionRectMode(ye){P(F(this,G),ye)}get ariaLiveMessage(){return o(F(this,re))}set ariaLiveMessage(ye){P(F(this,re),ye)}get selectionMode(){return o(F(this,ae))}set selectionMode(ye){P(F(this,ae),ye)}get nodeTypes(){return o(F(this,pe))}set nodeTypes(ye){P(F(this,pe),ye)}get edgeTypes(){return o(F(this,_e))}set edgeTypes(ye){P(F(this,_e),ye)}get noPanClass(){return o(F(this,ne))}set noPanClass(ye){P(F(this,ne),ye)}get noDragClass(){return o(F(this,$))}set noDragClass(ye){P(F(this,$),ye)}get noWheelClass(){return o(F(this,ke))}set noWheelClass(ye){P(F(this,ke),ye)}get ariaLabelConfig(){return o(F(this,be))}set ariaLabelConfig(ye){P(F(this,be),ye)}get _viewport(){return o(F(this,Me))}set _viewport(ye){P(F(this,Me),ye)}get viewport(){return t.viewport??this._viewport}set viewport(ye){t.viewport&&(t.viewport=ye),this._viewport=ye}get _connection(){return o(F(this,Xe))}set _connection(ye){P(F(this,Xe),ye)}get connection(){return o(F(this,Je))}set connection(ye){P(F(this,Je),ye)}get connectionMode(){return o(F(this,ct))}set connectionMode(ye){P(F(this,ct),ye)}get connectionRadius(){return o(F(this,De))}set connectionRadius(ye){P(F(this,De),ye)}get isValidConnection(){return o(F(this,Oe))}set isValidConnection(ye){P(F(this,Oe),ye)}get selectNodesOnDrag(){return o(F(this,qe))}set selectNodesOnDrag(ye){P(F(this,qe),ye)}get defaultMarkerColor(){return o(F(this,Ne))}set defaultMarkerColor(ye){P(F(this,Ne),ye)}get markers(){return o(F(this,Fe))}set markers(ye){P(F(this,Fe),ye)}get onlyRenderVisibleElements(){return o(F(this,Ke))}set onlyRenderVisibleElements(ye){P(F(this,Ke),ye)}get onerror(){return o(F(this,$e))}set onerror(ye){P(F(this,$e),ye)}get ondelete(){return o(F(this,Ze))}set ondelete(ye){P(F(this,Ze),ye)}get onbeforedelete(){return o(F(this,Ge))}set onbeforedelete(ye){P(F(this,Ge),ye)}get onbeforeconnect(){return o(F(this,tt))}set onbeforeconnect(ye){P(F(this,tt),ye)}get onconnect(){return o(F(this,nt))}set onconnect(ye){P(F(this,nt),ye)}get onconnectstart(){return o(F(this,ft))}set onconnectstart(ye){P(F(this,ft),ye)}get onconnectend(){return o(F(this,mt))}set onconnectend(ye){P(F(this,mt),ye)}get onbeforereconnect(){return o(F(this,vt))}set onbeforereconnect(ye){P(F(this,vt),ye)}get onreconnect(){return o(F(this,kt))}set onreconnect(ye){P(F(this,kt),ye)}get onreconnectstart(){return o(F(this,bt))}set onreconnectstart(ye){P(F(this,bt),ye)}get onreconnectend(){return o(F(this,pt))}set onreconnectend(ye){P(F(this,pt),ye)}get clickConnect(){return o(F(this,yt))}set clickConnect(ye){P(F(this,yt),ye)}get onclickconnectstart(){return o(F(this,dt))}set onclickconnectstart(ye){P(F(this,dt),ye)}get onclickconnectend(){return o(F(this,je))}set onclickconnectend(ye){P(F(this,je),ye)}get clickConnectStartHandle(){return o(F(this,Rt))}set clickConnectStartHandle(ye){P(F(this,Rt),ye)}get onselectiondrag(){return o(F(this,At))}set onselectiondrag(ye){P(F(this,At),ye)}get onselectiondragstart(){return o(F(this,Gt))}set onselectiondragstart(ye){P(F(this,Gt),ye)}get onselectiondragstop(){return o(F(this,Re))}set onselectiondragstop(ye){P(F(this,Re),ye)}get colorMode(){return o(F(this,Qt))}set colorMode(ye){P(F(this,Qt),ye)}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=Zu,this.clickConnectStartHandle=null,this.viewport=t.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return n=new WeakMap,r=new WeakMap,a=new WeakMap,s=new WeakMap,i=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,v=new WeakMap,p=new WeakMap,h=new WeakMap,m=new WeakMap,x=new WeakMap,k=new WeakMap,E=new WeakMap,N=new WeakMap,j=new WeakMap,V=new WeakMap,S=new WeakMap,K=new WeakMap,B=new WeakMap,O=new WeakMap,Q=new WeakMap,se=new WeakMap,xe=new WeakMap,z=new WeakMap,M=new WeakMap,q=new WeakMap,T=new WeakMap,D=new WeakMap,I=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,U=new WeakMap,te=new WeakMap,ie=new WeakMap,H=new WeakMap,G=new WeakMap,re=new WeakMap,ae=new WeakMap,pe=new WeakMap,_e=new WeakMap,ne=new WeakMap,$=new WeakMap,ke=new WeakMap,be=new WeakMap,Me=new WeakMap,Xe=new WeakMap,Je=new WeakMap,ct=new WeakMap,De=new WeakMap,Oe=new WeakMap,qe=new WeakMap,Ne=new WeakMap,Fe=new WeakMap,Ke=new WeakMap,$e=new WeakMap,Ze=new WeakMap,Ge=new WeakMap,tt=new WeakMap,nt=new WeakMap,ft=new WeakMap,mt=new WeakMap,vt=new WeakMap,kt=new WeakMap,bt=new WeakMap,pt=new WeakMap,yt=new WeakMap,dt=new WeakMap,je=new WeakMap,Rt=new WeakMap,At=new WeakMap,Gt=new WeakMap,Re=new WeakMap,Qt=new WeakMap,new e}function Os(){const t=ad($u);if(!t)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return t.getStore()}const $u=Symbol();function uI(t){const e=cI(t);function n(z){e.nodeTypes={...gm,...z}}function r(z){e.edgeTypes={...mm,...z}}function a(z){e.edges=nC(z,e.edges)}const s=(z,M=!1)=>{e.nodes=e.nodes.map(q=>{if(e.connection.inProgress&&e.connection.fromNode.id===q.id){const D=e.nodeLookup.get(q.id);D&&(e.connection={...e.connection,from:Ss(D,e.connection.fromHandle,wt.Left,!0)})}const T=z.get(q.id);return T?{...q,position:T.position,dragging:M}:q})};function i(z){var D,I,X;const{changes:M,updatedInternals:q}=gC(z,e.nodeLookup,e.parentLookup,e.domNode,e.nodeOrigin,e.nodeExtent,e.zIndexMode);if(!q)return;uC(e.nodeLookup,e.parentLookup,{nodeOrigin:e.nodeOrigin,nodeExtent:e.nodeExtent,zIndexMode:e.zIndexMode}),e.fitViewQueued&&e.resolveFitView();const T=new Map;for(const Y of M){const Z=(D=e.nodeLookup.get(Y.id))==null?void 0:D.internals.userNode;if(!Z)continue;const U={...Z};switch(Y.type){case"dimensions":{const te={...U.measured,...Y.dimensions};Y.setAttributes&&(U.width=((I=Y.dimensions)==null?void 0:I.width)??U.width,U.height=((X=Y.dimensions)==null?void 0:X.height)??U.height),U.measured=te;break}case"position":U.position=Y.position??U.position;break}T.set(Y.id,U)}e.nodes=e.nodes.map(Y=>T.get(Y.id)??Y)}function l(z){const M=e.fitViewResolver??Promise.withResolvers();return e.fitViewQueued=!0,e.fitViewOptions=z,e.fitViewResolver=M,e.nodes=[...e.nodes],M.promise}async function u(z,M,q){const T=typeof(q==null?void 0:q.zoom)<"u"?q.zoom:e.maxZoom,D=e.panZoom;return D?(await D.setViewport({x:e.width/2-z*T,y:e.height/2-M*T,zoom:T},{duration:q==null?void 0:q.duration,ease:q==null?void 0:q.ease,interpolate:q==null?void 0:q.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function d(z,M){const q=e.panZoom;return q?q.scaleBy(z,M):Promise.resolve(!1)}function v(z){return d(1.2,z)}function p(z){return d(1/1.2,z)}function h(z){const M=e.panZoom;M&&(M.setScaleExtent([z,e.maxZoom]),e.minZoom=z)}function m(z){const M=e.panZoom;M&&(M.setScaleExtent([e.minZoom,z]),e.maxZoom=z)}function x(z){const M=e.panZoom;M&&(M.setTranslateExtent(z),e.translateExtent=z)}function k(z,M=null){let q=!1;const T=z.map(D=>(M?M.has(D.id):!0)&&D.selected?(q=!0,{...D,selected:!1}):D);return[q,T]}function E(z){const M=z!=null&&z.nodes?new Set(z.nodes.map(Y=>Y.id)):null,[q,T]=k(e.nodes,M);q&&(e.nodes=T);const D=z!=null&&z.edges?new Set(z.edges.map(Y=>Y.id)):null,[I,X]=k(e.edges,D);I&&(e.edges=X)}function N(z){const M=e.multiselectionKeyPressed;e.nodes=e.nodes.map(q=>{const T=z.includes(q.id),D=M&&q.selected||T;return!!q.selected!==D?{...q,selected:D}:q}),M||E({nodes:[]})}function j(z){const M=e.multiselectionKeyPressed;e.edges=e.edges.map(q=>{const T=z.includes(q.id),D=M&&q.selected||T;return!!q.selected!==D?{...q,selected:D}:q}),M||E({edges:[]})}function V(z,M,q){const T=e.nodeLookup.get(z);if(!T){console.warn("012",ao.error012(z));return}e.selectionRect=null,e.selectionRectMode=null,T.selected?(M||T.selected&&e.multiselectionKeyPressed)&&(E({nodes:[T],edges:[]}),requestAnimationFrame(()=>q==null?void 0:q.blur())):N([z])}function S(z){const M=e.edgeLookup.get(z);if(!M){console.warn("012",ao.error012(z));return}(M.selectable||e.elementsSelectable&&typeof M.selectable>"u")&&(e.selectionRect=null,e.selectionRectMode=null,M.selected?M.selected&&e.multiselectionKeyPressed&&E({nodes:[],edges:[M]}):j([z]))}function K(z,M){const{nodeExtent:q,snapGrid:T,nodeOrigin:D,nodeLookup:I,nodesDraggable:X,onerror:Y}=e,Z=new Map,U=(T==null?void 0:T[0])??5,te=(T==null?void 0:T[1])??5,ie=z.x*U*M,H=z.y*te*M;for(const G of I.values()){if(!(G.selected&&(G.draggable||X&&typeof G.draggable>"u")))continue;let ae={x:G.internals.positionAbsolute.x+ie,y:G.internals.positionAbsolute.y+H};T&&(ae=To(ae,T));const{position:pe,positionAbsolute:_e}=Xg({nodeId:G.id,nextPosition:ae,nodeLookup:I,nodeExtent:q,nodeOrigin:D,onError:Y});G.position=pe,G.internals.positionAbsolute=_e,Z.set(G.id,G)}s(Z)}function B(z){return mC({delta:z,panZoom:e.panZoom,transform:[e.viewport.x,e.viewport.y,e.viewport.zoom],translateExtent:e.translateExtent,width:e.width,height:e.height})}const O=z=>{e._connection={...z}};function Q(){e._connection=Zu}function se(){e.resetStoreValues(),E()}return Object.assign(e,{setNodeTypes:n,setEdgeTypes:r,addEdge:a,updateNodePositions:s,updateNodeInternals:i,zoomIn:v,zoomOut:p,fitView:l,setCenter:u,setMinZoom:h,setMaxZoom:m,setTranslateExtent:x,unselectNodesAndEdges:E,addSelectedNodes:N,addSelectedEdges:j,handleNodeSelection:V,handleEdgeSelection:S,moveSelectedNodes:K,panBy:B,updateConnection:O,cancelConnection:Q,reset:se})}function uu(t,e){const{minZoom:n,maxZoom:r,initialViewport:a,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:l,translateExtent:u,setPanZoomInstance:d,onDraggingChange:v,onTransformChange:p}=e,h=DC({domNode:t,minZoom:n,maxZoom:r,translateExtent:u,viewport:a,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:l,onDraggingChange:v}),m=h.getViewport();return(a.x!==m.x||a.y!==m.y||a.zoom!==m.zoom)&&p([m.x,m.y,m.zoom]),d(h),h.update(e),{update(x){h.update(x)}}}var dI=L('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function fI(t,e){at(e,!0);let n=Ae(e,"store",15),r=J(()=>n().panActivationKeyPressed||e.panOnDrag),a=J(()=>n().panActivationKeyPressed||e.panOnScroll);const{viewport:s}=n();let i=!1;yn(()=>{var d;!i&&n().viewportInitialized&&((d=e.oninit)==null||d.call(e),i=!0)});var l=dI(),u=_(l);yr(u,()=>e.children),Xn(l,(d,v)=>uu==null?void 0:uu(d,v),()=>({viewport:n().viewport,minZoom:n().minZoom,maxZoom:n().maxZoom,initialViewport:s,onDraggingChange:d=>{n(n().dragging=d,!0)},setPanZoomInstance:d=>{n(n().panZoom=d,!0)},onPanZoomStart:e.onmovestart,onPanZoom:e.onmove,onPanZoomEnd:e.onmoveend,zoomOnScroll:e.zoomOnScroll,zoomOnDoubleClick:e.zoomOnDoubleClick,zoomOnPinch:e.zoomOnPinch,panOnScroll:o(a),panOnDrag:o(r),panOnScrollSpeed:e.panOnScrollSpeed,panOnScrollMode:e.panOnScrollMode,zoomActivationKeyPressed:n().zoomActivationKeyPressed,preventScrolling:typeof e.preventScrolling=="boolean"?e.preventScrolling:!0,noPanClassName:n().noPanClass,noWheelClassName:n().noWheelClass,userSelectionActive:!!n().selectionRect,translateExtent:n().translateExtent,lib:"svelte",paneClickDistance:e.paneClickDistance,selectionOnDrag:e.selectionOnDrag,onTransformChange:d=>{n(n().viewport={x:d[0],y:d[1],zoom:d[2]},!0)},connectionInProgress:n().connection.inProgress})),C(t,l),st()}function th(t,e){return n=>{n.target===e&&(t==null||t(n))}}function nh(t){return e=>{const n=t.has(e.id);return!!e.selected!==n?{...e,selected:n}:e}}function rh(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}var vI=L("<div><!></div>");function hI(t,e){at(e,!0);let n=Ae(e,"store",15),r=Ae(e,"panOnDrag",3,!0),a=Ae(e,"paneClickDistance",3,1),s,i=null,l=new Set,u=new Set,d=J(()=>n().panActivationKeyPressed||r()),v=J(()=>n().selectionKeyPressed||!!n().selectionRect||e.selectionOnDrag&&o(d)!==!0),p=J(()=>n().elementsSelectable&&(o(v)||n().selectionRectMode==="user")),h=!1;function m(Q){var T,D;if(i=s==null?void 0:s.getBoundingClientRect(),!i)return;const se=Q.target===s,xe=!se&&!!Q.target.closest(".nokey"),z=e.selectionOnDrag&&se||n().selectionKeyPressed;if(xe||!o(v)||!z||Q.button!==0||!Q.isPrimary)return;(D=(T=Q.target)==null?void 0:T.setPointerCapture)==null||D.call(T,Q.pointerId),h=!1;const{x:M,y:q}=Rr(Q,i);n(n().selectionRect={width:0,height:0,startX:M,startY:q,x:M,y:q},!0),se||(Q.stopPropagation(),Q.preventDefault())}function x(Q){var I;if(!o(v)||!i||!n().selectionRect)return;const se=Rr(Q,i),{startX:xe=0,startY:z=0}=n().selectionRect;if(!h){const X=n().selectionKeyPressed?0:a();if(Math.hypot(se.x-xe,se.y-z)<=X)return;n().unselectNodesAndEdges(),(I=e.onselectionstart)==null||I.call(e,Q)}h=!0;const M={...n().selectionRect,x:se.x<xe?se.x:xe,y:se.y<z?se.y:z,width:Math.abs(se.x-xe),height:Math.abs(se.y-z)},q=l,T=u;l=new Set(Vd(n().nodeLookup,M,[n().viewport.x,n().viewport.y,n().viewport.zoom],n().selectionMode===Rl.Partial,!0).map(X=>X.id));const D=n().defaultEdgeOptions.selectable??!0;u=new Set;for(const X of l){const Y=n().connectionLookup.get(X);if(Y)for(const{edgeId:Z}of Y.values()){const U=n().edgeLookup.get(Z);U&&(U.selectable??D)&&u.add(Z)}}rh(q,l)||n(n().nodes=n().nodes.map(nh(l)),!0),rh(T,u)||n(n().edges=n().edges.map(nh(u)),!0),n(n().selectionRectMode="user",!0),n(n().selectionRect=M,!0)}function k(Q){var se,xe,z;Q.button===0&&((xe=(se=Q.target)==null?void 0:se.releasePointerCapture)==null||xe.call(se,Q.pointerId),!h&&Q.target===s&&(j==null||j(Q)),n(n().selectionRect=null,!0),h&&n(n().selectionRectMode=l.size>0?"nodes":null,!0),h&&((z=e.onselectionend)==null||z.call(e,Q)))}const E=Q=>{var se;if(Array.isArray(o(d))&&o(d).includes(2)){Q.preventDefault();return}(se=e.onpanecontextmenu)==null||se.call(e,{event:Q})},N=Q=>{h&&(Q.stopPropagation(),h=!1)};function j(Q){var se;if(h||n().connection.inProgress){h=!1;return}(se=e.onpaneclick)==null||se.call(e,{event:Q}),n().unselectNodesAndEdges(),n(n().selectionRectMode=null,!0),n(n().selectionRect=null,!0)}var V=vI();let S;var K=J(()=>o(p)?void 0:th(j,s));V.__click=function(...Q){var se;(se=o(K))==null||se.apply(this,Q)},V.__pointermove=function(...Q){var se;(se=o(p)?x:void 0)==null||se.apply(this,Q)},V.__pointerup=function(...Q){var se;(se=o(p)?k:void 0)==null||se.apply(this,Q)};var B=J(()=>th(E,s));V.__contextmenu=function(...Q){var se;(se=o(B))==null||se.apply(this,Q)};var O=_(V);yr(O,()=>e.children),Cs(V,Q=>s=Q,()=>s),oe(Q=>S=St(V,1,"svelte-flow__pane svelte-flow__container",null,S,Q),[()=>({draggable:r()===!0||Array.isArray(r())&&r().includes(0),dragging:n().dragging,selection:o(v)})]),wl("pointerdown",V,function(...Q){var se;(se=o(p)?m:void 0)==null||se.apply(this,Q)},!0),wl("click",V,function(...Q){var se;(se=o(p)?N:void 0)==null||se.apply(this,Q)},!0),C(t,V),st()}Xt(["click","pointermove","pointerup","contextmenu"]);var pI=L('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function gI(t,e){at(e,!0);var n=pI();let r;var a=_(n);yr(a,()=>e.children),oe(()=>r=Dt(n,"",r,{transform:`translate(${e.store.viewport.x??""}px, ${e.store.viewport.y??""}px) scale(${e.store.viewport.zoom??""})`})),C(t,n),st()}function Vs(t,e){const{store:n,onDrag:r,onDragStart:a,onDragStop:s,onNodeMouseDown:i}=e,l=wC({onDrag:r,onDragStart:a,onDragStop:s,onNodeMouseDown:i,getStoreItems:()=>{const{snapGrid:d,viewport:v}=n;return{nodes:n.nodes,nodeLookup:n.nodeLookup,edges:n.edges,nodeExtent:n.nodeExtent,snapGrid:d||[0,0],snapToGrid:!!d,nodeOrigin:n.nodeOrigin,multiSelectionActive:n.multiselectionKeyPressed,domNode:n.domNode,transform:[v.x,v.y,v.zoom],autoPanOnNodeDrag:n.autoPanOnNodeDrag,nodesDraggable:n.nodesDraggable,selectNodesOnDrag:n.selectNodesOnDrag,nodeDragThreshold:n.nodeDragThreshold,unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,onSelectionDrag:n.onselectiondrag,onSelectionDragStart:n.onselectiondragstart,onSelectionDragStop:n.onselectiondragstop,panBy:n.panBy}}});function u(d,v){if(v.disabled){l.destroy();return}l.update({domNode:d,noDragClassName:v.noDragClass,handleSelector:v.handleSelector,nodeId:v.nodeId,isSelectable:v.isSelectable,nodeClickDistance:v.nodeClickDistance})}return u(t,e),{update(d){u(t,d)},destroy(){l.destroy()}}}var mI=L('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),yI=L('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);function _I(t,e){at(e,!0);var n=yI(),r=Ye(n),a=_(r),s=b(r,2),i=_(s),l=b(s,2);{var u=d=>{var v=mI(),p=_(v);oe(()=>{xt(v,"id",`${bI}-${e.store.flowId}`),ee(p,e.store.ariaLiveMessage)}),C(d,v)};ue(l,d=>{e.store.disableKeyboardA11y||d(u)})}oe(()=>{xt(r,"id",`${ym}-${e.store.flowId}`),ee(a,e.store.disableKeyboardA11y?e.store.ariaLabelConfig["node.a11yDescription.default"]:e.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),xt(s,"id",`${_m}-${e.store.flowId}`),ee(i,e.store.ariaLabelConfig["edge.a11yDescription.default"])}),C(t,n),st()}const ym="svelte-flow__node-desc",_m="svelte-flow__edge-desc",bI="svelte-flow__aria-live";var wI=L("<div><!></div>");function xI(t,e){at(e,!0);let n=Ae(e,"store",15),r=J(()=>Bn(e.node.data,()=>({}),!0)),a=J(()=>Bn(e.node.selected,!1)),s=J(()=>e.node.draggable),i=J(()=>e.node.selectable),l=J(()=>Bn(e.node.deletable,!0)),u=J(()=>e.node.connectable),d=J(()=>e.node.focusable),v=J(()=>Bn(e.node.hidden,!1)),p=J(()=>Bn(e.node.dragging,!1)),h=J(()=>Bn(e.node.style,"")),m=J(()=>e.node.class),x=J(()=>Bn(e.node.type,"default")),k=J(()=>e.node.parentId),E=J(()=>e.node.sourcePosition),N=J(()=>e.node.targetPosition),j=J(()=>Bn(e.node.measured,()=>({width:0,height:0}),!0).width),V=J(()=>Bn(e.node.measured,()=>({width:0,height:0}),!0).height),S=J(()=>e.node.initialWidth),K=J(()=>e.node.initialHeight),B=J(()=>e.node.width),O=J(()=>e.node.height),Q=J(()=>e.node.dragHandle),se=J(()=>Bn(e.node.internals.z,0)),xe=J(()=>e.node.internals.positionAbsolute.x),z=J(()=>e.node.internals.positionAbsolute.y),M=J(()=>e.node.internals.userNode),{id:q}=e.node,T=J(()=>o(s)??n().nodesDraggable),D=J(()=>o(i)??n().elementsSelectable),I=J(()=>o(u)??n().nodesConnectable),X=J(()=>WT(e.node)),Y=J(()=>!!e.node.internals.handleBounds),Z=J(()=>o(X)&&o(Y)),U=J(()=>o(d)??n().nodesFocusable);function te(Oe){return n().parentLookup.has(Oe)}let ie=J(()=>te(q)),H=Pe(null),G=null,re=o(x),ae=o(E),pe=o(N),_e=J(()=>n().nodeTypes[o(x)]??hm),ne=J(()=>n().ariaLabelConfig),$={get value(){return o(I)}};LC(q),zC($);let ke=J(()=>{const Oe=o(j)===void 0?o(B)??o(S):o(B),qe=o(V)===void 0?o(O)??o(K):o(O);if(!(Oe===void 0&&qe===void 0&&o(h)===void 0))return`${o(h)};${Oe?`width:${ra(Oe)};`:""}${qe?`height:${ra(qe)};`:""}`});yn(()=>{(o(x)!==re||o(E)!==ae||o(N)!==pe)&&o(H)!==null&&requestAnimationFrame(()=>{o(H)!==null&&n().updateNodeInternals(new Map([[q,{id:q,nodeElement:o(H),force:!0}]]))}),re=o(x),ae=o(E),pe=o(N)}),yn(()=>{e.resizeObserver&&(!o(Z)||o(H)!==G)&&(G&&e.resizeObserver.unobserve(G),o(H)&&e.resizeObserver.observe(o(H)),G=o(H))}),md(()=>{var Oe;G&&((Oe=e.resizeObserver)==null||Oe.unobserve(G))});function be(Oe){var qe;o(D)&&(!n().selectNodesOnDrag||!o(T)||n().nodeDragThreshold>0)&&n().handleNodeSelection(q),(qe=e.onnodeclick)==null||qe.call(e,{node:o(M),event:Oe})}function Me(Oe){if(!(em(Oe)||n().disableKeyboardA11y))if(Wg.includes(Oe.key)&&o(D)){const qe=Oe.key==="Escape";n().handleNodeSelection(q,qe,o(H))}else o(T)&&e.node.selected&&Object.prototype.hasOwnProperty.call(Bl,Oe.key)&&(Oe.preventDefault(),n(n().ariaLiveMessage=o(ne)["node.a11yDescription.ariaLiveMessage"]({direction:Oe.key.replace("Arrow","").toLowerCase(),x:~~e.node.internals.positionAbsolute.x,y:~~e.node.internals.positionAbsolute.y}),!0),n().moveSelectedNodes(Bl[Oe.key],Oe.shiftKey?4:1))}const Xe=()=>{var Ke;if(n().disableKeyboardA11y||!n().autoPanOnNodeFocus||!((Ke=o(H))!=null&&Ke.matches(":focus-visible")))return;const{width:Oe,height:qe,viewport:Ne}=n();Vd(new Map([[q,e.node]]),{x:0,y:0,width:Oe,height:qe},[Ne.x,Ne.y,Ne.zoom],!0).length>0||n().setCenter(e.node.position.x+(e.node.measured.width??0)/2,e.node.position.y+(e.node.measured.height??0)/2,{zoom:Ne.zoom})};var Je=an(),ct=Ye(Je);{var De=Oe=>{var qe=wI();Va(qe,()=>({"data-id":q,class:["svelte-flow__node",`svelte-flow__node-${o(x)}`,o(m)],style:o(ke),onclick:be,onpointerenter:e.onnodepointerenter?Fe=>e.onnodepointerenter({node:o(M),event:Fe}):void 0,onpointerleave:e.onnodepointerleave?Fe=>e.onnodepointerleave({node:o(M),event:Fe}):void 0,onpointermove:e.onnodepointermove?Fe=>e.onnodepointermove({node:o(M),event:Fe}):void 0,oncontextmenu:e.onnodecontextmenu?Fe=>e.onnodecontextmenu({node:o(M),event:Fe}):void 0,onkeydown:o(U)?Me:void 0,onfocus:o(U)?Xe:void 0,tabIndex:o(U)?0:void 0,role:e.node.ariaRole??(o(U)?"group":void 0),"aria-roledescription":"node","aria-describedby":n().disableKeyboardA11y?void 0:`${ym}-${n().flowId}`,...e.node.domAttributes,[Ma]:{dragging:o(p),selected:o(a),draggable:o(T),connectable:o(I),selectable:o(D),nopan:o(T),parent:o(ie)},[va]:{"z-index":o(se),transform:`translate(${o(xe)??""}px, ${o(z)??""}px)`,visibility:o(X)?"visible":"hidden"}}));var Ne=_(qe);gd(Ne,()=>o(_e),(Fe,Ke)=>{Ke(Fe,{get data(){return o(r)},get id(){return q},get selected(){return o(a)},get selectable(){return o(D)},get deletable(){return o(l)},get sourcePosition(){return o(E)},get targetPosition(){return o(N)},get zIndex(){return o(se)},get dragging(){return o(p)},get draggable(){return o(T)},get dragHandle(){return o(Q)},get parentId(){return o(k)},get type(){return o(x)},get isConnectable(){return o(I)},get positionAbsoluteX(){return o(xe)},get positionAbsoluteY(){return o(z)},get width(){return o(B)},get height(){return o(O)}})}),Xn(qe,(Fe,Ke)=>Vs==null?void 0:Vs(Fe,Ke),()=>({nodeId:q,isSelectable:o(D),disabled:!o(T),handleSelector:o(Q),noDragClass:n().noDragClass,nodeClickDistance:e.nodeClickDistance,onNodeMouseDown:n().handleNodeSelection,onDrag:(Fe,Ke,$e,Ze)=>{var Ge;(Ge=e.onnodedrag)==null||Ge.call(e,{event:Fe,targetNode:$e,nodes:Ze})},onDragStart:(Fe,Ke,$e,Ze)=>{var Ge;(Ge=e.onnodedragstart)==null||Ge.call(e,{event:Fe,targetNode:$e,nodes:Ze})},onDragStop:(Fe,Ke,$e,Ze)=>{var Ge;(Ge=e.onnodedragstop)==null||Ge.call(e,{event:Fe,targetNode:$e,nodes:Ze})},store:n()})),Cs(qe,Fe=>P(H,Fe),()=>o(H)),C(Oe,qe)};ue(ct,Oe=>{o(v)||Oe(De)})}C(t,Je),st()}var kI=L('<div class="svelte-flow__nodes"></div>');function SI(t,e){at(e,!0);let n=Ae(e,"store",15);const r=typeof ResizeObserver>"u"?null:new ResizeObserver(s=>{const i=new Map;s.forEach(l=>{const u=l.target.getAttribute("data-id");i.set(u,{id:u,nodeElement:l.target,force:!0})}),n().updateNodeInternals(i)});md(()=>{r==null||r.disconnect()});var a=kI();Ot(a,21,()=>n().visible.nodes.values(),s=>s.id,(s,i)=>{xI(s,{get node(){return o(i)},get resizeObserver(){return r},get nodeClickDistance(){return e.nodeClickDistance},get onnodeclick(){return e.onnodeclick},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get onnodecontextmenu(){return e.onnodecontextmenu},get store(){return n()},set store(l){n(l)}})}),C(t,a),st()}var EI=mn('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function AI(t,e){at(e,!0);let n=J(()=>e.edge.id),r=J(()=>e.edge.source),a=J(()=>e.edge.target),s=J(()=>e.edge.sourceX),i=J(()=>e.edge.sourceY),l=J(()=>e.edge.targetX),u=J(()=>e.edge.targetY),d=J(()=>e.edge.sourcePosition),v=J(()=>e.edge.targetPosition),p=J(()=>Bn(e.edge.animated,!1)),h=J(()=>Bn(e.edge.selected,!1)),m=J(()=>e.edge.label),x=J(()=>e.edge.labelStyle),k=J(()=>Bn(e.edge.data,()=>({}),!0)),E=J(()=>e.edge.style),N=J(()=>e.edge.interactionWidth),j=J(()=>Bn(e.edge.type,"default")),V=J(()=>e.edge.sourceHandle),S=J(()=>e.edge.targetHandle),K=J(()=>e.edge.markerStart),B=J(()=>e.edge.markerEnd),O=J(()=>e.edge.selectable),Q=J(()=>e.edge.focusable),se=J(()=>Bn(e.edge.deletable,!0)),xe=J(()=>e.edge.hidden),z=J(()=>e.edge.zIndex),M=J(()=>e.edge.class),q=J(()=>e.edge.ariaLabel);BC(o(n));let T=null,D=J(()=>o(O)??e.store.elementsSelectable),I=J(()=>o(Q)??e.store.edgesFocusable),X=J(()=>e.store.edgeTypes[o(j)]??pm),Y=J(()=>o(K)?`url('#${Ju(o(K),e.store.flowId)}')`:void 0),Z=J(()=>o(B)?`url('#${Ju(o(B),e.store.flowId)}')`:void 0);function U(ae){var _e;const pe=e.store.edgeLookup.get(o(n));pe&&(o(D)&&e.store.handleEdgeSelection(o(n)),(_e=e.onedgeclick)==null||_e.call(e,{event:ae,edge:pe}))}function te(ae,pe){const _e=e.store.edgeLookup.get(o(n));_e&&pe({event:ae,edge:_e})}function ie(ae){if(!e.store.disableKeyboardA11y&&Wg.includes(ae.key)&&o(D)){const{unselectNodesAndEdges:pe,addSelectedEdges:_e}=e.store;ae.key==="Escape"?(T==null||T.blur(),pe({edges:[e.edge]})):_e([o(n)])}}var H=an(),G=Ye(H);{var re=ae=>{var pe=EI();let _e;var ne=_(pe);Va(ne,()=>({class:["svelte-flow__edge",o(M)],"data-id":o(n),onclick:U,oncontextmenu:e.onedgecontextmenu?ke=>{te(ke,e.onedgecontextmenu)}:void 0,onpointerenter:e.onedgepointerenter?ke=>{te(ke,e.onedgepointerenter)}:void 0,onpointerleave:e.onedgepointerleave?ke=>{te(ke,e.onedgepointerleave)}:void 0,"aria-label":o(q)===null?void 0:o(q)?o(q):`Edge from ${o(r)} to ${o(a)}`,"aria-describedby":o(I)?`${_m}-${e.store.flowId}`:void 0,role:e.edge.ariaRole??(o(I)?"group":"img"),"aria-roledescription":"edge",onkeydown:o(I)?ie:void 0,tabindex:o(I)?0:void 0,...e.edge.domAttributes,[Ma]:{animated:o(p),selected:o(h),selectable:o(D)}}));var $=_(ne);gd($,()=>o(X),(ke,be)=>{be(ke,{get id(){return o(n)},get source(){return o(r)},get target(){return o(a)},get sourceX(){return o(s)},get sourceY(){return o(i)},get targetX(){return o(l)},get targetY(){return o(u)},get sourcePosition(){return o(d)},get targetPosition(){return o(v)},get animated(){return o(p)},get selected(){return o(h)},get label(){return o(m)},get labelStyle(){return o(x)},get data(){return o(k)},get style(){return o(E)},get interactionWidth(){return o(N)},get selectable(){return o(D)},get deletable(){return o(se)},get type(){return o(j)},get sourceHandleId(){return o(V)},get targetHandleId(){return o(S)},get markerStart(){return o(Y)},get markerEnd(){return o(Z)}})}),Cs(ne,ke=>T=ke,()=>T),oe(()=>_e=Dt(pe,"",_e,{"z-index":o(z)})),C(ae,pe)};ue(G,ae=>{o(xe)||ae(re)})}C(t,H),st()}by();var TI=mn("<defs></defs>");function CI(t,e){at(e,!1);const n=Os();S_();var r=TI();Ot(r,5,()=>n.markers,a=>a.id,(a,s)=>{OI(a,Fs(()=>o(s)))}),C(t,r),st()}var II=mn('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),PI=mn('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),MI=mn('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function OI(t,e){at(e,!0);let n=Ae(e,"width",3,12.5),r=Ae(e,"height",3,12.5),a=Ae(e,"markerUnits",3,"strokeWidth"),s=Ae(e,"orient",3,"auto-start-reverse"),i=Ae(e,"color",3,"none");var l=MI(),u=_(l);{var d=p=>{var h=II();let m;oe(()=>{xt(h,"stroke-width",e.strokeWidth),m=Dt(h,"",m,{stroke:i()})}),C(p,h)},v=p=>{var h=PI();let m;oe(()=>{xt(h,"stroke-width",e.strokeWidth),m=Dt(h,"",m,{stroke:i(),fill:i()})}),C(p,h)};ue(u,p=>{e.type===Ll.Arrow?p(d):e.type===Ll.ArrowClosed&&p(v,1)})}oe(()=>{xt(l,"id",e.id),xt(l,"markerWidth",`${n()}`),xt(l,"markerHeight",`${r()}`),xt(l,"markerUnits",a()),xt(l,"orient",s())}),C(t,l),st()}var NI=L('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function DI(t,e){at(e,!0);let n=Ae(e,"store",15);var r=NI(),a=_(r),s=_(a);CI(s,{});var i=b(a,2);Ot(i,17,()=>n().visible.edges.values(),l=>l.id,(l,u)=>{AI(l,{get edge(){return o(u)},get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return n()},set store(d){n(d)}})}),C(t,r),st()}var RI=L('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function bm(t,e){at(e,!0);let n=Ae(e,"x",3,0),r=Ae(e,"y",3,0),a=Ae(e,"width",3,0),s=Ae(e,"height",3,0),i=Ae(e,"isVisible",3,!0);var l=an(),u=Ye(l);{var d=v=>{var p=RI();let h;oe(m=>h=Dt(p,"",h,m),[()=>({width:typeof a()=="string"?a():ra(a()),height:typeof s()=="string"?s():ra(s()),transform:`translate(${n()}px, ${r()}px)`})]),C(v,p)};ue(u,v=>{i()&&v(d)})}C(t,l),st()}var LI=L("<div><!></div>");function jI(t,e){at(e,!0);let n=Pe(void 0);yn(()=>{var p;e.store.disableKeyboardA11y||(p=o(n))==null||p.focus({preventScroll:!0})});let r=J(()=>{if(e.store.selectionRectMode==="nodes"){e.store.nodes;const p=cc(e.store.nodeLookup,{filter:h=>!!h.selected});if(p.width>0&&p.height>0)return p}return null});function a(p){var m;const h=e.store.nodes.filter(x=>x.selected);(m=e.onselectioncontextmenu)==null||m.call(e,{nodes:h,event:p})}function s(p){var m;const h=e.store.nodes.filter(x=>x.selected);(m=e.onselectionclick)==null||m.call(e,{nodes:h,event:p})}function i(p){Object.prototype.hasOwnProperty.call(Bl,p.key)&&(p.preventDefault(),e.store.moveSelectedNodes(Bl[p.key],p.shiftKey?4:1))}var l=an(),u=Ye(l);{var d=p=>{var h=LI();h.__contextmenu=a,h.__click=s,h.__keydown=function(...k){var E;(E=e.store.disableKeyboardA11y?void 0:i)==null||E.apply(this,k)};let m;var x=_(h);bm(x,{width:"100%",height:"100%",x:0,y:0}),Xn(h,(k,E)=>Vs==null?void 0:Vs(k,E),()=>({disabled:!1,store:e.store,onDrag:(k,E,N,j)=>{var V;(V=e.onnodedrag)==null||V.call(e,{event:k,targetNode:null,nodes:j})},onDragStart:(k,E,N,j)=>{var V;(V=e.onnodedragstart)==null||V.call(e,{event:k,targetNode:null,nodes:j})},onDragStop:(k,E,N,j)=>{var V;(V=e.onnodedragstop)==null||V.call(e,{event:k,targetNode:null,nodes:j})}})),Cs(h,k=>P(n,k),()=>o(n)),oe(k=>{St(h,1,Ts(["svelte-flow__selection-wrapper",e.store.noPanClass]),"svelte-sf2y5e"),xt(h,"role",e.store.disableKeyboardA11y?void 0:"button"),xt(h,"tabindex",e.store.disableKeyboardA11y?void 0:-1),m=Dt(h,"",m,k)},[()=>({width:ra(o(r).width),height:ra(o(r).height),transform:`translate(${o(r).x??""}px, ${o(r).y??""}px)`})]),C(p,h)},v=J(()=>e.store.selectionRectMode==="nodes"&&o(r)&&ma(o(r).x)&&ma(o(r).y));ue(u,p=>{o(v)&&p(d)})}C(t,l),st()}Xt(["contextmenu","click","keydown"]);function zI(t){switch(t){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function Zt(t,e){let{enabled:n=!0,trigger:r,type:a="keydown"}=e;function s(l){var v;const u=Array.isArray(r)?r:[r],d=[l.metaKey,l.altKey,l.shiftKey,l.ctrlKey].reduce((p,h,m)=>h?p|1<<m:p,0);for(const p of u){const h={preventDefault:!1,enabled:!0,...p},{modifier:m,key:x,callback:k,preventDefault:E,enabled:N}=h;if(N){if(l.key!==x)continue;if(m===null||m===!1){if(d!==0)continue}else if(m!==void 0&&((v=m==null?void 0:m[0])==null?void 0:v.length)>0){const V=Array.isArray(m)?m:[m];let S=!1;for(const K of V)if((Array.isArray(K)?K:[K]).reduce((O,Q)=>O|zI(Q),0)===d){S=!0;break}if(!S)continue}E&&l.preventDefault();const j={node:t,trigger:h,originalEvent:l};t.dispatchEvent(new CustomEvent("shortcut",{detail:j})),k==null||k(j)}}}let i;return n&&(i=ku(t,a,s)),{update:l=>{const{enabled:u=!0,type:d="keydown"}=l;n&&(!u||a!==d)?i==null||i():!n&&u&&(i=ku(t,d,s)),n=u,a=d,r=l.trigger},destroy:()=>{i==null||i()}}}function qI(){const t=J(Os),e=s=>{var d,v;const i=$v(s)?s:o(t).nodeLookup.get(s.id),l=i.parentId?YT(i.position,i.measured,i.parentId,o(t).nodeLookup,o(t).nodeOrigin):i.position,u={...i,position:l,width:((d=i.measured)==null?void 0:d.width)??i.width,height:((v=i.measured)==null?void 0:v.height)??i.height};return di(u)};function n(s,i,l={replace:!1}){o(t).nodes=er(()=>o(t).nodes).map(u=>{if(u.id===s){const d=typeof i=="function"?i(u):i;return l!=null&&l.replace&&$v(d)?d:{...u,...d}}return u})}function r(s,i,l={replace:!1}){o(t).edges=er(()=>o(t).edges).map(u=>{if(u.id===s){const d=typeof i=="function"?i(u):i;return l.replace&&XC(d)?d:{...u,...d}}return u})}const a=s=>o(t).nodeLookup.get(s);return{zoomIn:o(t).zoomIn,zoomOut:o(t).zoomOut,getInternalNode:a,getNode:s=>{var i;return(i=a(s))==null?void 0:i.internals.userNode},getNodes:s=>s===void 0?o(t).nodes:ah(o(t).nodeLookup,s),getEdge:s=>o(t).edgeLookup.get(s),getEdges:s=>s===void 0?o(t).edges:ah(o(t).edgeLookup,s),setZoom:(s,i)=>{const l=o(t).panZoom;return l?l.scaleTo(s,{duration:i==null?void 0:i.duration}):Promise.resolve(!1)},getZoom:()=>o(t).viewport.zoom,setViewport:async(s,i)=>{const l=o(t).viewport;return o(t).panZoom?(await o(t).panZoom.setViewport({x:s.x??l.x,y:s.y??l.y,zoom:s.zoom??l.zoom},i),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>kh(o(t).viewport),setCenter:async(s,i,l)=>o(t).setCenter(s,i,l),fitView:s=>o(t).fitView(s),fitBounds:async(s,i)=>{if(!o(t).panZoom)return Promise.resolve(!1);const l=Wd(s,o(t).width,o(t).height,o(t).minZoom,o(t).maxZoom,(i==null?void 0:i.padding)??.1);return await o(t).panZoom.setViewport(l,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(s,i=!0,l)=>{const u=Fv(s),d=u?s:e(s);return d?(l||o(t).nodes).filter(v=>{const p=o(t).nodeLookup.get(v.id);if(!p||!u&&v.id===s.id)return!1;const h=di(p),m=so(h,d);return i&&m>0||m>=h.width*h.height||m>=d.width*d.height}):[]},isNodeIntersecting:(s,i,l=!0)=>{const d=Fv(s)?s:e(s);if(!d)return!1;const v=so(d,i);return l&&v>0||v>=i.width*i.height||v>=d.width*d.height},deleteElements:async({nodes:s=[],edges:i=[]})=>{var d,v;const{nodes:l,edges:u}=await KT({nodesToRemove:s,edgesToRemove:i,nodes:o(t).nodes,edges:o(t).edges,onBeforeDelete:o(t).onbeforedelete});return l&&(o(t).nodes=er(()=>o(t).nodes).filter(p=>!l.some(({id:h})=>h===p.id))),u&&(o(t).edges=er(()=>o(t).edges).filter(p=>!u.some(({id:h})=>h===p.id))),(l.length>0||u.length>0)&&((v=(d=o(t)).ondelete)==null||v.call(d,{nodes:l,edges:u})),{deletedNodes:l,deletedEdges:u}},screenToFlowPosition:(s,i={snapToGrid:!0})=>{if(!o(t).domNode)return s;const l=i.snapToGrid?o(t).snapGrid:!1,{x:u,y:d,zoom:v}=o(t).viewport,{x:p,y:h}=o(t).domNode.getBoundingClientRect(),m={x:s.x-p,y:s.y-h};return Co(m,[u,d,v],l!==null,l||[1,1])},flowToScreenPosition:s=>{if(!o(t).domNode)return s;const{x:i,y:l,zoom:u}=o(t).viewport,{x:d,y:v}=o(t).domNode.getBoundingClientRect(),p=zl(s,[i,l,u]);return{x:p.x+d,y:p.y+v}},toObject:()=>structuredClone({nodes:[...o(t).nodes],edges:[...o(t).edges],viewport:{...o(t).viewport}}),updateNode:n,updateNodeData:(s,i,l)=>{var v;const u=(v=o(t).nodeLookup.get(s))==null?void 0:v.internals.userNode;if(!u)return;const d=typeof i=="function"?i(u):i;n(s,p=>({...p,data:l!=null&&l.replace?d:{...p.data,...d}}))},updateEdge:r,getNodesBounds:s=>zT(s,{nodeLookup:o(t).nodeLookup,nodeOrigin:o(t).nodeOrigin}),getHandleConnections:({type:s,id:i,nodeId:l})=>{var u;return Array.from(((u=o(t).connectionLookup.get(`${l}-${s}-${i??null}`))==null?void 0:u.values())??[])}}}function ah(t,e){var r;const n=[];for(const a of e){const s=t.get(a);if(s){const i="internals"in s?(r=s.internals)==null?void 0:r.userNode:s;n.push(i)}}return n}function BI(t,e){at(e,!0);let n=Ae(e,"store",15),r=Ae(e,"selectionKey",3,"Shift"),a=Ae(e,"multiSelectionKey",19,()=>ql()?"Meta":"Control"),s=Ae(e,"deleteKey",3,"Backspace"),i=Ae(e,"panActivationKey",3," "),l=Ae(e,"zoomActivationKey",19,()=>ql()?"Meta":"Control"),{deleteElements:u}=qI();function d(k){return k!==null&&typeof k=="object"}function v(k){return d(k)?k.modifier||[]:[]}function p(k){return k==null?"":d(k)?k.key:k}function h(k,E){return(Array.isArray(k)?k:[k]).map(j=>{const V=p(j);return{key:V,modifier:v(j),enabled:V!==null,callback:E}})}function m(){n(n().selectionRect=null,!0),n(n().selectionKeyPressed=!1,!0),n(n().multiselectionKeyPressed=!1,!0),n(n().deleteKeyPressed=!1,!0),n(n().panActivationKeyPressed=!1,!0),n(n().zoomActivationKeyPressed=!1,!0)}function x(){const k=n().nodes.filter(N=>N.selected),E=n().edges.filter(N=>N.selected);u({nodes:k,edges:E})}wl("blur",Wn,m),wl("contextmenu",Wn,m),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(r(),()=>n(n().selectionKeyPressed=!0,!0)),type:"keydown"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(r(),()=>n(n().selectionKeyPressed=!1,!0)),type:"keyup"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(a(),()=>{n(n().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(a(),()=>n(n().multiselectionKeyPressed=!1,!0)),type:"keyup"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(s(),k=>{!(k.originalEvent.ctrlKey||k.originalEvent.metaKey||k.originalEvent.shiftKey)&&!em(k.originalEvent)&&(n(n().deleteKeyPressed=!0,!0),x())}),type:"keydown"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(s(),()=>n(n().deleteKeyPressed=!1,!0)),type:"keyup"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(i(),()=>n(n().panActivationKeyPressed=!0,!0)),type:"keydown"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(i(),()=>n(n().panActivationKeyPressed=!1,!0)),type:"keyup"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(l(),()=>n(n().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),Xn(Wn,(k,E)=>Zt==null?void 0:Zt(k,E),()=>({trigger:h(l(),()=>n(n().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),st()}var FI=mn('<path fill="none" class="svelte-flow__connection-path"></path>'),KI=mn('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function HI(t,e){at(e,!0);let n=J(()=>{if(!e.store.connection.inProgress)return"";const i={sourceX:e.store.connection.from.x,sourceY:e.store.connection.from.y,sourcePosition:e.store.connection.fromPosition,targetX:e.store.connection.to.x,targetY:e.store.connection.to.y,targetPosition:e.store.connection.toPosition};switch(e.type){case Oa.Bezier:{const[l]=nm(i);return l}case Oa.Straight:{const[l]=am(i);return l}case Oa.Step:case Oa.SmoothStep:{const[l]=Yd({...i,borderRadius:e.type===Oa.Step?0:void 0});return l}}});var r=an(),a=Ye(r);{var s=i=>{var l=KI(),u=_(l),d=_(u);{var v=h=>{var m=an(),x=Ye(m);gd(x,()=>e.LineComponent,(k,E)=>{E(k,{})}),C(h,m)},p=h=>{var m=FI();oe(()=>{xt(m,"d",o(n)),Dt(m,e.style)}),C(h,m)};ue(d,h=>{e.LineComponent?h(v):h(p,!1)})}oe(h=>{xt(l,"width",e.store.width),xt(l,"height",e.store.height),Dt(l,e.containerStyle),St(u,0,h)},[()=>Ts(["svelte-flow__connection",LT(e.store.connection.isValid)])]),C(i,l)};ue(a,i=>{e.store.connection.inProgress&&i(s)})}C(t,r),st()}var GI=L("<div><!></div>");function wm(t,e){at(e,!0);let n=Ae(e,"position",3,"top-right"),r=Is(e,["$$slots","$$events","$$legacy","position","style","class","children"]),a=J(()=>`${n()}`.split("-"));var s=GI();Va(s,l=>({class:l,style:e.style,...r}),[()=>["svelte-flow__panel",e.class,...o(a)]]);var i=_(s);yr(i,()=>e.children??Es),C(t,s),st()}var UI=L('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function VI(t,e){at(e,!0);let n=Ae(e,"position",3,"bottom-right");var r=an(),a=Ye(r);{var s=i=>{wm(i,{get position(){return n()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(l,u)=>{var d=UI();C(l,d)},$$slots:{default:!0}})};ue(a,i=>{var l;(l=e.proOptions)!=null&&l.hideAttribution||i(s)})}C(t,r),st()}var WI=L("<div><!></div>");function YI(t,e){at(e,!0);let n=Ae(e,"domNode",15),r=Ae(e,"clientWidth",15),a=Ae(e,"clientHeight",15),s=J(()=>e.rest.class),i=J(()=>Jy(e.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed","zIndexMode"]));function l(v){v.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),e.rest.onscroll&&e.rest.onscroll(v)}var u=WI();Va(u,v=>({class:["svelte-flow","svelte-flow__container",o(s),e.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:l,...o(i),[va]:v}),[()=>({width:ra(e.width),height:ra(e.height)})],void 0,void 0,"svelte-mkap6j");var d=_(u);yr(d,()=>e.children??Es),Cs(u,v=>n(v),()=>n()),Kf(u,"clientHeight",a),Kf(u,"clientWidth",r),C(t,u),st()}var XI=L('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),ZI=L("<!> <!>",1),QI=L("<!> <!> <!> <!> <!>",1);function JI(t,e){at(e,!0);let n=Ae(e,"paneClickDistance",3,1),r=Ae(e,"nodeClickDistance",3,1),a=Ae(e,"panOnScrollMode",19,()=>Us.Free),s=Ae(e,"preventScrolling",3,!0),i=Ae(e,"zoomOnScroll",3,!0),l=Ae(e,"zoomOnDoubleClick",3,!0),u=Ae(e,"zoomOnPinch",3,!0),d=Ae(e,"panOnScroll",3,!1),v=Ae(e,"panOnScrollSpeed",3,.5),p=Ae(e,"panOnDrag",3,!0),h=Ae(e,"selectionOnDrag",3,!1),m=Ae(e,"connectionLineType",19,()=>Oa.Bezier),x=Ae(e,"nodes",31,()=>Wt([])),k=Ae(e,"edges",31,()=>Wt([])),E=Ae(e,"viewport",15,void 0),N=Is(e,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),j=uI({props:N,width:e.width,height:e.height,get nodes(){return x()},set nodes(S){x(S)},get edges(){return k()},set edges(S){k(S)},get viewport(){return E()},set viewport(S){E(S)}});const V=ad($u);V&&V.setStore&&V.setStore(j),Sh($u,{provider:!1,getStore(){return j}}),yn(()=>{var K;const S={nodes:j.selectedNodes,edges:j.selectedEdges};(K=er(()=>e.onselectionchange))==null||K(S);for(const B of j.selectionChangeHandlers.values())B(S)}),md(()=>{j.reset()}),YI(t,{get colorMode(){return j.colorMode},get width(){return e.width},get height(){return e.height},get rest(){return N},get domNode(){return j.domNode},set domNode(S){j.domNode=S},get clientWidth(){return j.width},set clientWidth(S){j.width=S},get clientHeight(){return j.height},set clientHeight(S){j.height=S},children:(S,K)=>{var B=QI(),O=Ye(B);BI(O,{get selectionKey(){return e.selectionKey},get deleteKey(){return e.deleteKey},get panActivationKey(){return e.panActivationKey},get multiSelectionKey(){return e.multiSelectionKey},get zoomActivationKey(){return e.zoomActivationKey},get store(){return j},set store(M){j=M}});var Q=b(O,2);fI(Q,{get panOnScrollMode(){return a()},get preventScrolling(){return s()},get zoomOnScroll(){return i()},get zoomOnDoubleClick(){return l()},get zoomOnPinch(){return u()},get panOnScroll(){return d()},get panOnScrollSpeed(){return v()},get panOnDrag(){return p()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get onmovestart(){return e.onmovestart},get onmove(){return e.onmove},get onmoveend(){return e.onmoveend},get oninit(){return e.oninit},get store(){return j},set store(M){j=M},children:(M,q)=>{hI(M,{get onpaneclick(){return e.onpaneclick},get onpanecontextmenu(){return e.onpanecontextmenu},get onselectionstart(){return e.onselectionstart},get onselectionend(){return e.onselectionend},get panOnDrag(){return p()},get paneClickDistance(){return n()},get selectionOnDrag(){return h()},get store(){return j},set store(T){j=T},children:(T,D)=>{var I=ZI(),X=Ye(I);gI(X,{get store(){return j},set store(Z){j=Z},children:(Z,U)=>{var te=XI(),ie=b(Ye(te),2);DI(ie,{get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return j},set store(ae){j=ae}});var H=b(ie,4);HI(H,{get type(){return m()},get LineComponent(){return e.connectionLineComponent},get containerStyle(){return e.connectionLineContainerStyle},get style(){return e.connectionLineStyle},get store(){return j},set store(ae){j=ae}});var G=b(H,2);SI(G,{get nodeClickDistance(){return r()},get onnodeclick(){return e.onnodeclick},get onnodecontextmenu(){return e.onnodecontextmenu},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return j},set store(ae){j=ae}});var re=b(G,2);jI(re,{get onselectionclick(){return e.onselectionclick},get onselectioncontextmenu(){return e.onselectioncontextmenu},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return j},set store(ae){j=ae}}),C(Z,te)},$$slots:{default:!0}});var Y=b(X,2);{let Z=J(()=>!!(j.selectionRect&&j.selectionRectMode==="user")),U=J(()=>{var G;return(G=j.selectionRect)==null?void 0:G.width}),te=J(()=>{var G;return(G=j.selectionRect)==null?void 0:G.height}),ie=J(()=>{var G;return(G=j.selectionRect)==null?void 0:G.x}),H=J(()=>{var G;return(G=j.selectionRect)==null?void 0:G.y});bm(Y,{get isVisible(){return o(Z)},get width(){return o(U)},get height(){return o(te)},get x(){return o(ie)},get y(){return o(H)}})}C(T,I)},$$slots:{default:!0}})},$$slots:{default:!0}});var se=b(Q,2);VI(se,{get proOptions(){return e.proOptions},get position(){return e.attributionPosition}});var xe=b(se,2);_I(xe,{get store(){return j}});var z=b(xe,2);yr(z,()=>e.children??Es),C(S,B)},$$slots:{default:!0}}),st()}var $I=L("<button><!></button>");function sl(t,e){let n=Is(e,["$$slots","$$events","$$legacy","class","bgColor","bgColorHover","color","colorHover","borderColor","onclick","children"]);var r=$I();Va(r,()=>({type:"button",onclick:e.onclick,class:["svelte-flow__controls-button",e.class],...n,[va]:{"--xy-controls-button-background-color-props":e.bgColor,"--xy-controls-button-background-color-hover-props":e.bgColorHover,"--xy-controls-button-color-props":e.color,"--xy-controls-button-color-hover-props":e.colorHover,"--xy-controls-button-border-color-props":e.borderColor}}));var a=_(r);yr(a,()=>e.children??Es),C(t,r)}var eP=mn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');function tP(t){var e=eP();C(t,e)}var nP=mn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');function rP(t){var e=nP();C(t,e)}var aP=mn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');function sP(t){var e=aP();C(t,e)}var iP=mn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');function oP(t){var e=iP();C(t,e)}var lP=mn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');function cP(t){var e=lP();C(t,e)}var uP=L("<!> <!>",1),dP=L("<!> <!> <!> <!> <!> <!>",1);function fP(t,e){at(e,!0);let n=Ae(e,"position",3,"bottom-left"),r=Ae(e,"orientation",3,"vertical"),a=Ae(e,"showZoom",3,!0),s=Ae(e,"showFitView",3,!0),i=Ae(e,"showLock",3,!0),l=Is(e,["$$slots","$$events","$$legacy","position","orientation","showZoom","showFitView","showLock","style","class","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","fitViewOptions","children","before","after"]),u=J(Os);const d={bgColor:e.buttonBgColor,bgColorHover:e.buttonBgColorHover,color:e.buttonColor,colorHover:e.buttonColorHover,borderColor:e.buttonBorderColor};let v=J(()=>o(u).nodesDraggable||o(u).nodesConnectable||o(u).elementsSelectable),p=J(()=>o(u).viewport.zoom<=o(u).minZoom),h=J(()=>o(u).viewport.zoom>=o(u).maxZoom),m=J(()=>o(u).ariaLabelConfig),x=J(()=>r()==="horizontal"?"horizontal":"vertical");const k=()=>{o(u).zoomIn()},E=()=>{o(u).zoomOut()},N=()=>{o(u).fitView(e.fitViewOptions)},j=()=>{let V=!o(v);o(u).nodesDraggable=V,o(u).nodesConnectable=V,o(u).elementsSelectable=V};{let V=J(()=>["svelte-flow__controls",o(x),e.class]);wm(t,Fs({get class(){return o(V)},get position(){return n()},"data-testid":"svelte-flow__controls",get"aria-label"(){return o(m)["controls.ariaLabel"]},get style(){return e.style}},()=>l,{children:(S,K)=>{var B=dP(),O=Ye(B);{var Q=Z=>{var U=an(),te=Ye(U);yr(te,()=>e.before),C(Z,U)};ue(O,Z=>{e.before&&Z(Q)})}var se=b(O,2);{var xe=Z=>{var U=uP(),te=Ye(U);sl(te,Fs({onclick:k,class:"svelte-flow__controls-zoomin",get title(){return o(m)["controls.zoomIn.ariaLabel"]},get"aria-label"(){return o(m)["controls.zoomIn.ariaLabel"]},get disabled(){return o(h)}},()=>d,{children:(H,G)=>{tP(H)},$$slots:{default:!0}}));var ie=b(te,2);sl(ie,Fs({onclick:E,class:"svelte-flow__controls-zoomout",get title(){return o(m)["controls.zoomOut.ariaLabel"]},get"aria-label"(){return o(m)["controls.zoomOut.ariaLabel"]},get disabled(){return o(p)}},()=>d,{children:(H,G)=>{rP(H)},$$slots:{default:!0}})),C(Z,U)};ue(se,Z=>{a()&&Z(xe)})}var z=b(se,2);{var M=Z=>{sl(Z,Fs({class:"svelte-flow__controls-fitview",onclick:N,get title(){return o(m)["controls.fitView.ariaLabel"]},get"aria-label"(){return o(m)["controls.fitView.ariaLabel"]}},()=>d,{children:(U,te)=>{sP(U)},$$slots:{default:!0}}))};ue(z,Z=>{s()&&Z(M)})}var q=b(z,2);{var T=Z=>{sl(Z,Fs({class:"svelte-flow__controls-interactive",onclick:j,get title(){return o(m)["controls.interactive.ariaLabel"]},get"aria-label"(){return o(m)["controls.interactive.ariaLabel"]}},()=>d,{children:(U,te)=>{var ie=an(),H=Ye(ie);{var G=ae=>{cP(ae)},re=ae=>{oP(ae)};ue(H,ae=>{o(v)?ae(G):ae(re,!1)})}C(U,ie)},$$slots:{default:!0}}))};ue(q,Z=>{i()&&Z(T)})}var D=b(q,2);{var I=Z=>{var U=an(),te=Ye(U);yr(te,()=>e.children),C(Z,U)};ue(D,Z=>{e.children&&Z(I)})}var X=b(D,2);{var Y=Z=>{var U=an(),te=Ye(U);yr(te,()=>e.after),C(Z,U)};ue(X,Z=>{e.after&&Z(Y)})}C(S,B)},$$slots:{default:!0}}))}st()}var Ba;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Ba||(Ba={}));var vP=mn("<circle></circle>");function hP(t,e){var n=vP();oe(()=>{xt(n,"cx",e.radius),xt(n,"cy",e.radius),xt(n,"r",e.radius),St(n,0,Ts(["svelte-flow__background-pattern","dots",e.class]))}),C(t,n)}var pP=mn("<path></path>");function gP(t,e){at(e,!0);var n=pP();oe(()=>{xt(n,"stroke-width",e.lineWidth),xt(n,"d",`M${e.dimensions[0]/2} 0 V${e.dimensions[1]} M0 ${e.dimensions[1]/2} H${e.dimensions[0]}`),St(n,0,Ts(["svelte-flow__background-pattern",e.variant,e.class]))}),C(t,n),st()}const mP={[Ba.Dots]:1,[Ba.Lines]:1,[Ba.Cross]:6};var yP=mn('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function _P(t,e){at(e,!0);let n=Ae(e,"variant",19,()=>Ba.Dots),r=Ae(e,"gap",3,20),a=Ae(e,"lineWidth",3,1),s=J(Os),i=J(()=>n()===Ba.Dots),l=J(()=>n()===Ba.Cross),u=J(()=>Array.isArray(r())?r():[r(),r()]),d=J(()=>`background-pattern-${o(s).flowId}-${e.id??""}`),v=J(()=>[o(u)[0]*o(s).viewport.zoom||1,o(u)[1]*o(s).viewport.zoom||1]),p=J(()=>(e.size??mP[n()])*o(s).viewport.zoom),h=J(()=>o(l)?[o(p),o(p)]:o(v)),m=J(()=>o(i)?[o(p)/2,o(p)/2]:[o(h)[0]/2,o(h)[1]/2]);var x=yP();let k;var E=_(x),N=_(E);{var j=K=>{{let B=J(()=>o(p)/2);hP(K,{get radius(){return o(B)},get class(){return e.patternClass}})}},V=K=>{gP(K,{get dimensions(){return o(h)},get variant(){return n()},get lineWidth(){return a()},get class(){return e.patternClass}})};ue(N,K=>{o(i)?K(j):K(V,!1)})}var S=b(E);oe(()=>{St(x,0,Ts(["svelte-flow__background","svelte-flow__container",e.class])),k=Dt(x,"",k,{"--xy-background-color-props":e.bgColor,"--xy-background-pattern-color-props":e.patternColor}),xt(E,"id",o(d)),xt(E,"x",o(s).viewport.x%o(v)[0]),xt(E,"y",o(s).viewport.y%o(v)[1]),xt(E,"width",o(v)[0]),xt(E,"height",o(v)[1]),xt(E,"patternTransform",`translate(-${o(m)[0]},-${o(m)[1]})`),xt(S,"fill",`url(#${o(d)})`)}),C(t,x),st()}var bP=L('<div class="trigger-node svelte-a1pdcu"><div class="trigger-header svelte-a1pdcu"><span class="icon">â¡</span> Trigger</div> <div class="trigger-body svelte-a1pdcu"><div class="label svelte-a1pdcu"> </div> <div class="group svelte-a1pdcu"> </div></div> <!></div>');function wP(t,e){at(e,!0);let n=J(()=>nr[e.data.group]||nr.INFO);var r=bP();let a;var s=_(r);let i;var l=b(s,2),u=_(l),d=_(u),v=b(u,2);let p;var h=_(v),m=b(l,2);Ga(m,{type:"source",get position(){return wt.Right}}),oe(()=>{a=Dt(r,"",a,{"border-color":o(n).color}),i=Dt(s,"",i,{background:o(n).color}),ee(d,`Event: ${e.data.label??""}`),p=Dt(v,"",p,{color:o(n).color}),ee(h,o(n).label)}),C(t,r),st()}var xP=L('<div class="binding svelte-1bgwygg"> </div>'),kP=L('<div class="binding unbound svelte-1bgwygg">unbound</div>'),SP=L('<div class="action-node svelte-1bgwygg"><!> <div class="action-header svelte-1bgwygg"><span class="icon svelte-1bgwygg"> </span> </div> <div class="action-body svelte-1bgwygg"><div class="desc svelte-1bgwygg"> </div> <!></div> <div class="action-footer svelte-1bgwygg"><button title="Edit" class="svelte-1bgwygg">âï¸ Edit</button> <button title="Delete" class="danger svelte-1bgwygg">ðï¸</button></div> <!></div>');function EP(t,e){at(e,!0);let n=J(()=>e.data.cmd);var r=SP(),a=_(r);Ga(a,{type:"target",get position(){return wt.Left}});var s=b(a,2),i=_(s),l=_(i),u=b(i),d=b(s,2),v=_(d),p=_(v),h=b(v,2);{var m=V=>{var S=xP(),K=_(S);oe(()=>ee(K,`${o(n).pluginId??""}Â·${o(n).commandId??""}`)),C(V,S)},x=V=>{var S=kP();C(V,S)};ue(h,V=>{o(n).pluginId&&o(n).commandId?V(m):V(x,!1)})}var k=b(d,2),E=_(k);E.__click=function(...V){var S;(S=e.data.onEdit)==null||S.apply(this,V)};var N=b(E,2);N.__click=function(...V){var S;(S=e.data.onDelete)==null||S.apply(this,V)};var j=b(k,2);Ga(j,{type:"source",get position(){return wt.Right}}),oe(()=>{ee(l,o(n).icon||"âï¸"),ee(u,` ${o(n).name??""}`),xt(v,"title",o(n).description),ee(p,o(n).description)}),C(t,r),st()}Xt(["click"]);var AP=L('<button class="add-node svelte-w8wqxx" title="Add next action"><!> <div class="plus svelte-w8wqxx">+</div></button>');function TP(t,e){at(e,!0);var n=AP();n.__click=function(...a){var s;(s=e.data.onClick)==null||s.apply(this,a)};var r=_(n);Ga(r,{type:"target",get position(){return wt.Left},style:"opacity: 0"}),C(t,n),st()}Xt(["click"]);var CP=L('<div class="new-type-form svelte-d25j4l"><input type="text" placeholder="e.g. ESCALATE" class="svelte-d25j4l"/> <button class="small-btn svelte-d25j4l">Add</button></div>'),IP=L('<span class="type-group-chip svelte-d25j4l"> </span>'),PP=L('<button><span class="type-dot svelte-d25j4l"></span> <span class="type-label svelte-d25j4l"> </span> <span class="spacer-flex svelte-d25j4l"></span> <!> <span class="type-count svelte-d25j4l"> </span></button>'),MP=L("<button> </button>"),OP=L("<!> <!>",1),NP=L('<span class="picker-tile-added svelte-d25j4l">â added</span>'),DP=L('<button><span class="picker-tile-icon svelte-d25j4l"> </span> <span class="picker-tile-name svelte-d25j4l"> </span> <!></button>'),RP=L('<div class="picker-group"><div class="picker-group-label svelte-d25j4l"><span class="picker-plugin-badge svelte-d25j4l"> </span></div> <div class="picker-grid svelte-d25j4l"></div></div>'),LP=L('<div class="floating-panel picker-panel svelte-d25j4l"><div class="panel-header svelte-d25j4l"><h3 class="svelte-d25j4l">Add Action Node</h3> <button class="close-btn svelte-d25j4l">&#10005;</button></div> <div class="action-picker svelte-d25j4l"><!> <div class="picker-custom-row svelte-d25j4l"><button class="small-btn primary svelte-d25j4l">+ Create Custom Action</button> <span class="picker-hint svelte-d25j4l" style="margin-left: 0.5rem;">Link to any plugin command</span></div></div></div>'),jP=L("<option> </option>"),zP=L("<optgroup></optgroup>"),qP=L('<div class="floating-panel editor-panel-inner svelte-d25j4l"><div class="panel-header svelte-d25j4l"><h3 class="svelte-d25j4l">Edit Action Node</h3> <button class="close-btn svelte-d25j4l">&#10005;</button></div> <div class="cmd-form svelte-d25j4l"><div class="form-row svelte-d25j4l"><input type="text" class="icon-input svelte-d25j4l" placeholder="Icon"/> <input type="text" class="name-input svelte-d25j4l" placeholder="Name"/></div> <input type="text" class="desc-input svelte-d25j4l" placeholder="Description"/> <div class="form-row svelte-d25j4l"><select class="plugin-select svelte-d25j4l"><option>-- Select Plugin Command --</option><!></select></div> <div class="form-actions svelte-d25j4l"><button class="small-btn primary svelte-d25j4l">Save</button> <button class="small-btn svelte-d25j4l">Cancel</button></div></div></div>'),BP=L('<div class="commands-head svelte-d25j4l"><span class="type-badge svelte-d25j4l"> </span> <span class="cmd-count svelte-d25j4l"> </span> <span class="spacer svelte-d25j4l"></span> <div class="group-selector svelte-d25j4l"></div> <button class="text-btn danger svelte-d25j4l">Delete</button></div> <div class="canvas-wrapper svelte-d25j4l"><!> <!> <!></div>',1),FP=L('<p class="svelte-d25j4l">No event types yet. Run a scan to discover event types, or click <strong>+</strong> to create one manually.</p>'),KP=L('<p class="svelte-d25j4l">Select an event type on the left to view and edit its visual graph.</p>'),HP=L('<div class="no-selection svelte-d25j4l"><!></div>'),GP=L('<div class="editor-overlay svelte-d25j4l" role="dialog"><div class="editor-panel svelte-d25j4l"><div class="editor-header svelte-d25j4l"><h2 class="svelte-d25j4l">Action Pipeline Editor</h2> <span class="subtitle svelte-d25j4l">n8n-like visual graph editor</span> <button class="close-btn svelte-d25j4l">&#10005;</button></div> <div class="editor-body svelte-d25j4l"><div class="types-sidebar svelte-d25j4l"><div class="sidebar-head svelte-d25j4l"><span class="sidebar-title svelte-d25j4l">Event Types</span> <button class="icon-btn svelte-d25j4l" title="Add event type">+</button></div> <!> <div class="types-list svelte-d25j4l"></div></div> <div class="commands-panel svelte-d25j4l"><!></div></div></div></div>');function UP(t,e){at(e,!0);const n={trigger:wP,action:EP,add:TP};let r=Ae(e,"open",15,!1),a=Pe(Wt([])),s=Pe(Wt({})),i=Pe(Wt({})),l=Pe(null),u=Pe("INFO"),d=Pe(Wt([])),v=Pe(null),p=Pe(!1),h=Pe(""),m=Pe(!1),x=Pe([]),k=Pe([]);const E=[{pluginId:"gmail",pluginName:"Gmail",actions:Xp("gmail")}],N={mark_read:"â",mark_unread:"â",star:"â",unstar:"â",trash:"ð",delete:"â",mark_spam:"â ",archive:"â",apply_label:"ð·",remove_label:"ð·",mark_important:"!",mark_not_important:"â"};async function j(){P(a,await vb(),!0);const U={};await Promise.all(o(a).map(async te=>{U[te]=(await Wc(te)).length})),P(s,U,!0),P(i,await pb(),!0),o(l)&&(P(d,(await Wc(o(l))).map(te=>({...te})),!0),P(u,await Ji(o(l)),!0))}yn(()=>{r()&&j()}),yn(()=>{o(l)?V():(P(x,[]),P(k,[]))});function V(){const U=[],te=[];U.push({id:"trigger",type:"trigger",position:{x:50,y:100},data:{label:o(l),group:o(u)}});let ie="trigger",H=300;o(d).forEach((G,re)=>{U.push({id:G.id,type:"action",position:{x:H,y:100},data:{cmd:G,onEdit:()=>q(G),onDelete:()=>M(G.id)}}),te.push({id:`e-${ie}-${G.id}`,source:ie,target:G.id,animated:!0,style:"stroke: #666; stroke-width: 2"}),ie=G.id,H+=270}),U.push({id:"add-action",type:"add",position:{x:H,y:135},data:{onClick:()=>{P(m,!0),P(v,null)}}}),te.push({id:`e-${ie}-add-action`,source:ie,target:"add-action",style:"stroke: #444; stroke-width: 2; stroke-dasharray: 4"}),P(x,U),P(k,te)}async function S(U){P(l,U,!0),P(d,(await Wc(U)).map(te=>({...te})),!0),P(u,await Ji(U),!0),P(v,null),P(m,!1)}async function K(U){o(l)&&(await hb(o(l),U),P(u,U,!0),V())}function B(U){return U.split("_").map(te=>te.charAt(0)+te.slice(1).toLowerCase()).join(" ")}function O(U){return`hsl(${Ql(U)}, 55%, 55%)`}async function Q(){const U=o(h).trim();if(!U)return;await gb(U),P(h,""),P(p,!1),await j();const te=U.toUpperCase().replace(/\s+/g,"_").replace(/[^A-Z0-9_]/g,"");await S(te)}async function se(){o(l)&&(await yb(o(l)),P(l,null),P(d,[],!0),await j())}async function xe(U,te){await Qf(o(l),{id:U.actionId,pluginId:te,commandId:U.actionId,name:U.name,description:U.description,icon:N[U.actionId]||void 0}),P(m,!1),await j()}function z(U){return o(d).some(te=>te.id===U)}async function M(U){await wb(o(l),U),await j()}function q(U){P(m,!1),P(v,{...U,pluginCommandKey:U.pluginId&&U.commandId?`${U.pluginId}:${U.commandId}`:""},!0)}async function T(){o(v)&&(await kb(o(l),o(v).id,{name:o(v).name,description:o(v).description,icon:o(v).icon,pluginId:o(v).pluginId,commandId:o(v).commandId}),P(v,null),await j())}function D(){P(v,null)}async function I(){const U=`custom_${Date.now()}`;await Qf(o(l),{id:U,pluginId:"",commandId:"",name:"New Custom Action",description:"",icon:"â¡"}),P(m,!1),await j();const te=o(d).find(ie=>ie.id===U);te&&q(te)}var X=an(),Y=Ye(X);{var Z=U=>{var te=GP(),ie=_(te),H=_(ie),G=b(_(H),4);G.__click=()=>r(!1);var re=b(H,2),ae=_(re),pe=_(ae),_e=b(_(pe),2);_e.__click=()=>P(p,!o(p));var ne=b(pe,2);{var $=ct=>{var De=CP(),Oe=_(De);Oe.__keydown=Ne=>Ne.key==="Enter"&&Q();var qe=b(Oe,2);qe.__click=Q,Zr(Oe,()=>o(h),Ne=>P(h,Ne)),C(ct,De)};ue(ne,ct=>{o(p)&&ct($)})}var ke=b(ne,2);Ot(ke,21,()=>o(a),Ut,(ct,De)=>{var Oe=PP();let qe;Oe.__click=()=>S(o(De));var Ne=_(Oe);let Fe;var Ke=b(Ne,2),$e=_(Ke),Ze=b(Ke,4);{var Ge=ft=>{const mt=J(()=>nr[o(i)[o(De)]]);var vt=an(),kt=Ye(vt);{var bt=pt=>{var yt=IP();let dt;var je=_(yt);oe(()=>{xt(yt,"title",o(mt).description),dt=Dt(yt,"",dt,{color:o(mt).color}),ee(je,o(mt).label)}),C(pt,yt)};ue(kt,pt=>{o(mt)&&pt(bt)})}C(ft,vt)};ue(Ze,ft=>{o(i)[o(De)]&&ft(Ge)})}var tt=b(Ze,2),nt=_(tt);oe((ft,mt)=>{qe=St(Oe,1,"type-item svelte-d25j4l",null,qe,{selected:o(l)===o(De)}),Fe=Dt(Ne,"",Fe,ft),ee($e,mt),ee(nt,o(s)[o(De)]??0)},[()=>({background:O(o(De))}),()=>B(o(De))]),C(ct,Oe)});var be=b(ae,2),Me=_(be);{var Xe=ct=>{var De=BP(),Oe=Ye(De),qe=_(Oe);let Ne;var Fe=_(qe),Ke=b(qe,2),$e=_(Ke),Ze=b(Ke,4);Ot(Ze,21,()=>Object.values(nr),Ut,(bt,pt)=>{var yt=MP();let dt;yt.__click=()=>K(o(pt).id);let je;var Rt=_(yt);oe(()=>{dt=St(yt,1,"group-chip svelte-d25j4l",null,dt,{active:o(u)===o(pt).id}),xt(yt,"title",o(pt).description),je=Dt(yt,"",je,{"--grp-color":o(pt).color}),ee(Rt,o(pt).label)}),C(bt,yt)});var Ge=b(Ze,2);Ge.__click=se;var tt=b(Oe,2),nt=_(tt);JI(nt,{get nodes(){return o(x)},get edges(){return o(k)},get nodeTypes(){return n},fitView:!0,fitViewOptions:{padding:.2,minZoom:.8},minZoom:.5,maxZoom:1.5,colorMode:"dark",children:(bt,pt)=>{var yt=OP(),dt=Ye(yt);_P(dt,{bgColor:"#111",patternColor:"#333"});var je=b(dt,2);fP(je,{showInteractive:!1}),C(bt,yt)},$$slots:{default:!0}});var ft=b(nt,2);{var mt=bt=>{var pt=LP(),yt=_(pt),dt=b(_(yt),2);dt.__click=()=>P(m,!1);var je=b(yt,2),Rt=_(je);Ot(Rt,17,()=>E,Ut,(Re,Qt)=>{var Gn=RP(),ye=_(Gn),ln=_(ye),En=_(ln),Ct=b(ye,2);Ot(Ct,21,()=>o(Qt).actions,Ut,(Mn,it)=>{const ut=J(()=>z(o(it).actionId));var Pt=DP();let $t;Pt.__click=()=>xe(o(it),o(Qt).pluginId);var _t=_(Pt),jt=_(_t),fn=b(_t,2),cn=_(fn),Jt=b(fn,2);{var en=jn=>{var On=NP();C(jn,On)};ue(Jt,jn=>{o(ut)&&jn(en)})}oe(()=>{$t=St(Pt,1,"picker-tile svelte-d25j4l",null,$t,{added:o(ut)}),xt(Pt,"title",o(it).description),ee(jt,N[o(it).actionId]??"Â·"),ee(cn,o(it).name)}),C(Mn,Pt)}),oe(()=>ee(En,o(Qt).pluginName)),C(Re,Gn)});var At=b(Rt,2),Gt=_(At);Gt.__click=I,C(bt,pt)};ue(ft,bt=>{o(m)&&bt(mt)})}var vt=b(ft,2);{var kt=bt=>{var pt=qP(),yt=_(pt),dt=b(_(yt),2);dt.__click=D;var je=b(yt,2),Rt=_(je),At=_(Rt),Gt=b(At,2),Re=b(Rt,2),Qt=b(Re,2),Gn=_(Qt);Gn.__change=it=>{if(it.target.value){const[ut,Pt]=it.target.value.split(":");o(v).pluginId=ut,o(v).commandId=Pt}else o(v).pluginId="",o(v).commandId=""};var ye=_(Gn);ye.value=ye.__value="";var ln=b(ye);Ot(ln,17,()=>E,Ut,(it,ut)=>{var Pt=zP();Ot(Pt,21,()=>o(ut).actions,Ut,($t,_t)=>{var jt=jP(),fn=_(jt),cn={};oe(()=>{ee(fn,`${o(_t).name??""} (${o(_t).actionId??""})`),cn!==(cn=`${o(ut).pluginId??""}:${o(_t).actionId??""}`)&&(jt.value=jt.__value=`${o(ut).pluginId??""}:${o(_t).actionId??""}`)}),C($t,jt)}),oe(()=>xt(Pt,"label",o(ut).pluginName)),C(it,Pt)});var En=b(Qt,2),Ct=_(En);Ct.__click=T;var Mn=b(Ct,2);Mn.__click=D,Zr(At,()=>o(v).icon,it=>o(v).icon=it),Zr(Gt,()=>o(v).name,it=>o(v).name=it),Zr(Re,()=>o(v).description,it=>o(v).description=it),pi(Gn,()=>o(v).pluginCommandKey,it=>o(v).pluginCommandKey=it),C(bt,pt)};ue(vt,bt=>{o(v)&&bt(kt)})}oe((bt,pt)=>{Ne=Dt(qe,"",Ne,bt),ee(Fe,pt),ee($e,`${o(d).length??""} action${o(d).length===1?"":"s"}`)},[()=>({background:O(o(l))}),()=>B(o(l))]),C(ct,De)},Je=ct=>{var De=HP(),Oe=_(De);{var qe=Fe=>{var Ke=FP();C(Fe,Ke)},Ne=Fe=>{var Ke=KP();C(Fe,Ke)};ue(Oe,Fe=>{o(a).length===0?Fe(qe):Fe(Ne,!1)})}C(ct,De)};ue(Me,ct=>{o(l)?ct(Xe):ct(Je,!1)})}C(U,te)};ue(Y,U=>{r()&&U(Z)})}C(t,X),st()}Xt(["click","keydown","change"]);var VP=L('<span class="scope-chip svelte-1e15788"> </span>'),WP=L('<div class="scopes-list svelte-1e15788"></div>'),YP=L('<div class="scopes-row svelte-1e15788"><button class="scopes-toggle svelte-1e15788"><!> </button> <!></div>'),XP=L('<div class="action-row svelte-1e15788"><div class="action-icon svelte-1e15788"> </div> <div class="action-body svelte-1e15788"><div class="action-top svelte-1e15788"><span class="action-name svelte-1e15788"> </span> <code class="action-id svelte-1e15788"> </code></div> <span class="action-desc svelte-1e15788"> </span> <!></div></div>'),ZP=L('<div class="plugin-section svelte-1e15788"><div class="plugin-header svelte-1e15788"><div class="plugin-title-row svelte-1e15788"><span class="plugin-name svelte-1e15788"> </span> <code class="plugin-id svelte-1e15788"> </code> <span class="plugin-status svelte-1e15788">â active</span></div> <span class="plugin-action-count svelte-1e15788"> </span></div> <div class="actions-table svelte-1e15788"></div></div>'),QP=L('<div class="empty svelte-1e15788">No plugins registered.</div>'),JP=L('<div class="overlay svelte-1e15788" role="dialog" aria-label="Plugin Registry" tabindex="-1"><div class="panel svelte-1e15788"><div class="panel-header svelte-1e15788"><div class="header-left svelte-1e15788"><span class="header-icon svelte-1e15788">â</span> <div><h2 class="svelte-1e15788">Plugin Registry</h2> <span class="subtitle svelte-1e15788"> </span></div></div> <button class="close-btn svelte-1e15788">â</button></div> <div class="panel-body svelte-1e15788"><!> <!></div> <div class="panel-footer svelte-1e15788"><span class="footer-note svelte-1e15788">Add plugins by extending <code class="svelte-1e15788">BasePlugin</code> and calling <code class="svelte-1e15788">pluginRegistry.registerPlugin()</code></span> <button class="close-footer-btn svelte-1e15788">Close</button></div></div></div>');function $P(t,e){at(e,!0);let n=Ae(e,"open",15,!1);const r=J(()=>n()?mi.getAllPlugins().map(h=>({id:h.pluginId,name:h.serviceName,actions:h.getHandlers().map(m=>({id:m.actionId,name:m.name,description:m.description,scopes:m.requiredScopes||[]}))})):[]),a={mark_read:"â",mark_unread:"â",star:"â",unstar:"â",trash:"ð",delete:"â",mark_spam:"â ",archive:"â",apply_label:"ð·",remove_label:"ð·",mark_important:"!",mark_not_important:"â"},s=J(()=>o(r).reduce((h,m)=>h+m.actions.length,0));let i=Pe(Wt(new Set));function l(h){const m=new Set(o(i));m.has(h)?m.delete(h):m.add(h),P(i,m,!0)}function u(h){return h.replace(/^https?:\/\/[^/]+\/auth\//,"")}var d=an(),v=Ye(d);{var p=h=>{var m=JP();m.__keydown=z=>z.key==="Escape"&&n(!1);var x=_(m),k=_(x),E=_(k),N=b(_(E),2),j=b(_(N),2),V=_(j),S=b(E,2);S.__click=()=>n(!1);var K=b(k,2),B=_(K);Ot(B,17,()=>o(r),Ut,(z,M)=>{var q=ZP(),T=_(q),D=_(T),I=_(D),X=_(I),Y=b(I,2),Z=_(Y),U=b(D,2),te=_(U),ie=b(T,2);Ot(ie,21,()=>o(M).actions,Ut,(H,G)=>{const re=J(()=>`${o(M).id}:${o(G).id}`),ae=J(()=>o(i).has(o(re)));var pe=XP(),_e=_(pe),ne=_(_e),$=b(_e,2),ke=_($),be=_(ke),Me=_(be),Xe=b(be,2),Je=_(Xe),ct=b(ke,2),De=_(ct),Oe=b(ct,2);{var qe=Ne=>{var Fe=YP(),Ke=_(Fe);Ke.__click=()=>l(o(re));var $e=_(Ke);{var Ze=mt=>{var vt=on("â¾");C(mt,vt)},Ge=mt=>{var vt=on("â¸");C(mt,vt)};ue($e,mt=>{o(ae)?mt(Ze):mt(Ge,!1)})}var tt=b($e),nt=b(Ke,2);{var ft=mt=>{var vt=WP();Ot(vt,21,()=>o(G).scopes,Ut,(kt,bt)=>{var pt=VP(),yt=_(pt);oe(dt=>{xt(pt,"title",o(bt)),ee(yt,dt)},[()=>u(o(bt))]),C(kt,pt)}),C(mt,vt)};ue(nt,mt=>{o(ae)&&mt(ft)})}oe(()=>ee(tt,` ${o(G).scopes.length??""} scope${o(G).scopes.length===1?"":"s"}`)),C(Ne,Fe)};ue(Oe,Ne=>{o(G).scopes.length&&Ne(qe)})}oe(()=>{xt(_e,"title",o(G).id),ee(ne,a[o(G).id]??"Â·"),ee(Me,o(G).name),ee(Je,o(G).id),ee(De,o(G).description)}),C(H,pe)}),oe(()=>{ee(X,o(M).name),ee(Z,o(M).id),ee(te,`${o(M).actions.length??""} action${o(M).actions.length===1?"":"s"}`)}),C(z,q)});var O=b(B,2);{var Q=z=>{var M=QP();C(z,M)};ue(O,z=>{o(r).length===0&&z(Q)})}var se=b(K,2),xe=b(_(se),2);xe.__click=()=>n(!1),oe(()=>ee(V,`${o(r).length??""} plugin${o(r).length===1?"":"s"} Â· ${o(s)??""} actions available`)),C(h,m)};ue(v,h=>{n()&&h(p)})}C(t,d),st()}Xt(["keydown","click"]);var e3=L('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),t3=L('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),n3=L('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),r3=L('<button class="chip svelte-s2dwjj"> </button>'),a3=L('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),s3=L('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),i3=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),o3=L('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),l3=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),c3=L('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),u3=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),d3=L('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),f3=L('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),v3=L('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),h3=L('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),p3=L('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function g3(t,e){at(e,!0);let n=Ae(e,"groupOrder",19,()=>[]),r=Pe(!1),a=Pe(null),s=Pe(!1),i=Pe(null);async function l(){var z;const[O,Q,se]=await Promise.all([lt.items.where("sourceType").equals("gmail").count(),lt.emailClassifications.count(),lt.contacts.count()]);let xe=0;try{const M=await((z=navigator.storage)==null?void 0:z.estimate());xe=(M==null?void 0:M.usage)??0}catch{}P(i,{emailCount:O,classCount:Q,contactCount:se,totalBytes:xe},!0)}function u(O){return O?O<1024?`${O} B`:O<1024*1024?`${(O/1024).toFixed(1)} KB`:`${(O/(1024*1024)).toFixed(1)} MB`:"â"}function d(){P(r,!o(r)),o(r)&&l()}async function v(O){var Q;P(s,!0),P(a,null);try{await O(),await l(),(Q=e.onrefresh)==null||Q.call(e)}finally{P(s,!1)}}async function p(){await v(()=>Jf())}async function h(O){await v(()=>Ad(O))}async function m(){await v(async()=>{await Jp(),await Jf()})}async function x(){await v(()=>lt.contacts.clear())}async function k(){await v(async()=>{await lt.delete(),window.location.reload()})}function E(O){return O.split("_").map(Q=>Q.charAt(0)+Q.slice(1).toLowerCase()).join(" ")}var N=p3(),j=_(N);j.__click=d;var V=b(_(j),2);let S;var K=b(j,2);{var B=O=>{var Q=h3(),se=_(Q);{var xe=$=>{var ke=t3(),be=_(ke),Me=_(be),Xe=b(be,4),Je=_(Xe),ct=b(Xe,4),De=_(ct),Oe=b(ct,2);{var qe=Ne=>{var Fe=e3(),Ke=b(Ye(Fe),2),$e=_(Ke);oe(Ze=>ee($e,`${Ze??""} used`),[()=>u(o(i).totalBytes)]),C(Ne,Fe)};ue(Oe,Ne=>{o(i).totalBytes&&Ne(qe)})}oe(()=>{ee(Me,`${o(i).emailCount??""} emails`),ee(Je,`${o(i).classCount??""} classifications`),ee(De,`${o(i).contactCount??""} contacts`)}),C($,ke)};ue(se,$=>{o(i)&&$(xe)})}var z=b(se,2);{var M=$=>{var ke=a3(),be=b(_(ke),2);Ot(be,21,n,Ut,(Me,Xe)=>{var Je=an(),ct=Ye(Je);{var De=qe=>{var Ne=n3(),Fe=_(Ne),Ke=b(Fe);Ke.__click=()=>P(a,null);var $e=b(Ke,2);$e.__click=()=>h(o(Xe)),oe(Ze=>{ee(Fe,`Delete ${Ze??""}? `),$e.disabled=o(s)},[()=>E(o(Xe))]),C(qe,Ne)},Oe=qe=>{var Ne=r3();Ne.__click=()=>P(a,`group:${o(Xe)}`);var Fe=_(Ne);oe(Ke=>{Ne.disabled=o(s),ee(Fe,`${Ke??""} â`)},[()=>E(o(Xe))]),C(qe,Ne)};ue(ct,qe=>{o(a)===`group:${o(Xe)}`?qe(De):qe(Oe,!1)})}C(Me,Je)}),C($,ke)};ue(z,$=>{n().length>0&&$(M)})}var q=b(z,2),T=b(_(q),2),D=_(T);{var I=$=>{var ke=s3(),be=b(_(ke),2);be.__click=()=>P(a,null);var Me=b(be,2);Me.__click=p,oe(()=>Me.disabled=o(s)),C($,ke)},X=$=>{var ke=i3();ke.__click=()=>P(a,"classifications"),oe(()=>ke.disabled=o(s)),C($,ke)};ue(D,$=>{o(a)==="classifications"?$(I):$(X,!1)})}var Y=b(D,2);{var Z=$=>{var ke=o3(),be=b(_(ke),2);be.__click=()=>P(a,null);var Me=b(be,2);Me.__click=m,oe(()=>Me.disabled=o(s)),C($,ke)},U=$=>{var ke=l3();ke.__click=()=>P(a,"emails"),oe(()=>ke.disabled=o(s)),C($,ke)};ue(Y,$=>{o(a)==="emails"?$(Z):$(U,!1)})}var te=b(Y,2);{var ie=$=>{var ke=c3(),be=b(_(ke),2);be.__click=()=>P(a,null);var Me=b(be,2);Me.__click=x,oe(()=>Me.disabled=o(s)),C($,ke)},H=$=>{var ke=u3();ke.__click=()=>P(a,"contacts"),oe(()=>ke.disabled=o(s)),C($,ke)};ue(te,$=>{o(a)==="contacts"?$(ie):$(H,!1)})}var G=b(q,2),re=_(G);{var ae=$=>{var ke=d3(),be=b(_(ke),2);be.__click=()=>P(a,null);var Me=b(be,2);Me.__click=k,oe(()=>Me.disabled=o(s)),C($,ke)},pe=$=>{var ke=f3();ke.__click=()=>P(a,"nuke"),oe(()=>ke.disabled=o(s)),C($,ke)};ue(re,$=>{o(a)==="nuke"?$(ae):$(pe,!1)})}var _e=b(G,2);{var ne=$=>{var ke=v3();C($,ke)};ue(_e,$=>{o(s)&&$(ne)})}C(O,Q)};ue(K,O=>{o(r)&&O(B)})}oe(()=>S=St(V,0,"chev svelte-s2dwjj",null,S,{open:o(r)})),C(t,N),st()}Xt(["click"]);var m3=L('<div class="error-card svelte-aym646"><span> </span> <button class="error-dismiss svelte-aym646">â</button></div>'),y3=L('<div class="success-card svelte-aym646"><span> </span> <button class="success-dismiss svelte-aym646">â</button></div>'),_3=L('<div class="groups-list svelte-aym646"></div> <div class="actions-footer svelte-aym646"><span class="footer-stat svelte-aym646"> </span></div>',1),b3=L('<div class="empty-state svelte-aym646"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-aym646">No emails classified yet</h3> <p class="svelte-aym646">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),w3=L('<div class="actions-container svelte-aym646"><!> <!> <!> <!> <div class="toolbar svelte-aym646"><button class="toolbar-btn svelte-aym646"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-aym646"><circle cx="12" cy="12" r="3"></circle><path d="M19.07 4.93a10 10 0 0 1 0 14.14M4.93 4.93a10 10 0 0 0 0 14.14"></path></svg> Plugins</button> <button class="toolbar-btn svelte-aym646"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-aym646"><path d="M12 3v18M3 12h18"></path></svg> Edit Actions</button></div> <!> <!> <!> <!></div>');function x3(t,e){at(e,!0);let n=Ae(e,"groups",19,()=>({})),r=Ae(e,"groupOrder",19,()=>[]),a=Ae(e,"counts",19,()=>({})),s=Ae(e,"stats",3,null),i=Ae(e,"expandedGroup",3,null),l=Ae(e,"isScanning",3,!1),u=Ae(e,"scanProgress",3,null),d=Ae(e,"scanCount",15,20),v=Ae(e,"error",3,null),p=Ae(e,"successMsg",3,null),h=Pe(!1),m=Pe(!1),x=Pe(!1),k=J(()=>{for(const I of r()){const X=n()[I];if((X==null?void 0:X.length)>0)return X[0]}return null});var E=w3(),N=_(E);C2(N,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return l()},get scanProgress(){return u()},get stats(){return s()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},get oncloseprogress(){return e.oncloseprogress},oninspect:()=>P(h,!0),get scanCount(){return d()},set scanCount(I){d(I)}});var j=b(N,2);J2(j,{get sampleEmail(){return o(k)},get open(){return o(h)},set open(I){P(h,I,!0)}});var V=b(j,2);UP(V,{get open(){return o(m)},set open(I){P(m,I,!0)}});var S=b(V,2);$P(S,{get open(){return o(x)},set open(I){P(x,I,!0)}});var K=b(S,2),B=_(K);B.__click=()=>P(x,!0);var O=b(B,2);O.__click=()=>P(m,!0);var Q=b(K,2);{var se=I=>{var X=m3(),Y=_(X),Z=_(Y),U=b(Y,2);U.__click=function(...te){var ie;(ie=e.ondismisserror)==null||ie.apply(this,te)},oe(()=>ee(Z,v())),C(I,X)};ue(Q,I=>{v()&&I(se)})}var xe=b(Q,2);{var z=I=>{var X=y3(),Y=_(X),Z=_(Y),U=b(Y,2);U.__click=function(...te){var ie;(ie=e.ondismisssuccess)==null||ie.apply(this,te)},oe(()=>ee(Z,p())),C(I,X)};ue(xe,I=>{p()&&I(z)})}var M=b(xe,2);{var q=I=>{var X=_3(),Y=Ye(X);Ot(Y,20,r,ie=>ie,(ie,H)=>{{let G=J(()=>Mu(H)),re=J(()=>{var _e;return((_e=n()[H])==null?void 0:_e.length)||0}),ae=J(()=>n()[H]||[]),pe=J(()=>i()===H);W2(ie,{get action(){return H},get color(){return o(G)},get count(){return o(re)},get items(){return o(ae)},get expanded(){return o(pe)},ontoggle:()=>e.ontogglegroup(H),onexecute:_e=>e.onexecute(H,_e),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(H)})}});var Z=b(Y,2),U=_(Z),te=_(U);oe(()=>ee(te,`${a().total??""} emails classified into ${r().length??""} groups`)),C(I,X)},T=I=>{var X=b3();C(I,X)};ue(M,I=>{a().total>0?I(q):l()||I(T,1)})}var D=b(M,2);g3(D,{get groupOrder(){return r()},get onrefresh(){return e.onrefresh}}),C(t,E),st()}Xt(["click"]);var k3=L('<div class="control-board-page svelte-v2lwbo"><!></div>');function S3(t,e){at(e,!0);const n=Ep();let r=Pe(Wt(n.status)),a=Pe(""),s=Pe(Wt({})),i=Pe(Wt([])),l=Pe(Wt({total:0})),u=Pe(null),d=Pe(null),v=Pe(!1),p=Pe(null),h=Pe(3),m=Pe(null),x=Pe(null),k=Pe(null);const E="me-ai-scan-history";async function N(){return await wa(E)}async function j(I){!I||I.phase!=="done"||await ii(E,{timestamp:Date.now(),classified:I.classified||0,errors:I.errors||0,total:I.total||0,totals:I.totals||{},summary:I.summary||{}})}_n(async()=>{const I=n.onMessage(Y=>{if(Y.status==="ready"){P(r,"ready");const Z=$r.find(ie=>ie.id===n.modelId),U=ea.find(ie=>ie.name===n.modelId),te=Z||U;P(a,(te==null?void 0:te.name)||(te==null?void 0:te.displayName)||n.modelId||"",!0)}Y.status==="loading"&&P(r,"loading")});if(P(r,n.status,!0),n.modelId){const Y=$r.find(te=>te.id===n.modelId),Z=ea.find(te=>te.name===n.modelId),U=Y||Z;P(a,(U==null?void 0:U.name)||(U==null?void 0:U.displayName)||n.modelId||"",!0)}const X=await N();return X&&P(p,{phase:"done",...X},!0),V(),()=>I()});async function V(){try{const I=await Hp();P(s,I.groups,!0),P(i,I.order,!0),P(l,await Rb(),!0),P(u,await Pu(),!0)}catch(I){P(m,`Failed to load data: ${I.message}`)}}async function S(){await B(!1)}async function K(){await B(!0)}async function B(I){if(o(v)||!n.isReady)return;P(m,null),P(x,null),P(v,!0),P(p,null);const X=new AbortController;P(k,X,!0);try{await Kp(n,{count:o(h),force:I,signal:X.signal,onProgress:Y=>{P(p,{...Y},!0),Y.phase==="done"&&j(Y)}}),await V()}catch(Y){X.signal.aborted||P(m,`Scan failed: ${Y.message}`)}finally{P(v,!1),P(k,null)}}function O(){var I;(I=o(k))==null||I.abort()}async function Q(I){await Sl(I,"acted"),await V()}async function se(I,X){const{executePipeline:Y,isAuthenticated:Z}=await Ln(async()=>{const{executePipeline:U,isAuthenticated:te}=await Promise.resolve().then(()=>ew);return{executePipeline:U,isAuthenticated:te}},void 0);if(!await Z()){alert("Please sign in to Gmail first (Dashboard page)");return}try{const te=await Y({type:I,source:"gmail",data:X},ie=>{console.log("Pipeline progress:",ie)},!0);te.success?(P(x,te.message,!0),P(m,null),await Q(X.emailId)):(P(m,`Execution failed: ${te.message}`),P(x,null))}catch(U){P(m,`Execution error: ${U.message}`),P(x,null)}}async function xe(I){await Sl(I,"dismissed"),await V()}async function z(I){await Gp(I),await V()}async function M(I){await Ad(I),await V()}function q(I){P(d,o(d)===I?null:I,!0)}var T=k3(),D=_(T);x3(D,{get engineStatus(){return o(r)},get modelName(){return o(a)},get groups(){return o(s)},get groupOrder(){return o(i)},get counts(){return o(l)},get stats(){return o(u)},get expandedGroup(){return o(d)},get isScanning(){return o(v)},get scanProgress(){return o(p)},get error(){return o(m)},get successMsg(){return o(x)},onscan:S,onrescan:K,ontogglegroup:q,onexecute:se,onmarkacted:Q,ondismiss:xe,onremove:z,oncleargroup:M,ondismisserror:()=>P(m,null),ondismisssuccess:()=>P(x,null),onstop:O,onrefresh:V,oncloseprogress:async()=>{P(p,null),await _d(E)},get scanCount(){return o(h)},set scanCount(I){P(h,I,!0)}}),C(t,T),st()}var E3=L('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#control">Control Board</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function A3(t,e){at(e,!0);function n(){const O=location.hash;return O==="#dashboard"?"dashboard":O==="#control"?"control":"chat"}let r=Pe(Wt(n()));_n(()=>{function O(){P(r,n(),!0)}return window.addEventListener("hashchange",O),()=>window.removeEventListener("hashchange",O)});var a=E3(),s=_(a),i=b(_(s),2),l=_(i);let u;var d=b(l,2);let v;var p=b(d,2);let h;var m=b(s,2),x=_(m);let k;var E=_(x);w1(E,{});var N=b(x,2);let j;var V=_(N);S3(V,{});var S=b(N,2);let K;var B=_(S);Jk(B,{}),oe(()=>{u=St(l,1,"svelte-1n46o8q",null,u,{active:o(r)==="chat"}),v=St(d,1,"svelte-1n46o8q",null,v,{active:o(r)==="control"}),h=St(p,1,"svelte-1n46o8q",null,h,{active:o(r)==="dashboard"}),k=Dt(x,"",k,{display:o(r)==="chat"?"flex":"none"}),j=Dt(N,"",j,{display:o(r)==="control"?"flex":"none"}),K=Dt(S,"",K,{display:o(r)==="dashboard"?"flex":"none"})}),C(t,a),st()}l_(A3,{target:document.getElementById("app")});
