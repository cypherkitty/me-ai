var mf=Object.defineProperty;var Sl=t=>{throw TypeError(t)};var gf=(t,e,r)=>e in t?mf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Xe=(t,e,r)=>gf(t,typeof e!="symbol"?e+"":e,r),zi=(t,e,r)=>e.has(t)||Sl("Cannot "+r);var Z=(t,e,r)=>(zi(t,e,"read from private field"),r?r.call(t):e.get(t)),Qe=(t,e,r)=>e.has(t)?Sl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ye=(t,e,r,a)=>(zi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Qt=(t,e,r)=>(zi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const $i=!1;var So=Array.isArray,yf=Array.prototype.indexOf,Ca=Array.prototype.includes,ci=Array.from,_f=Object.defineProperty,_a=Object.getOwnPropertyDescriptor,bf=Object.getOwnPropertyDescriptors,wf=Object.prototype,kf=Array.prototype,pc=Object.getPrototypeOf,Tl=Object.isExtensible;const xf=()=>{};function Sf(t){for(var e=0;e<t.length;e++)t[e]()}function hc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Gt=2,os=4,ui=8,mc=1<<24,yr=16,Vn=32,fa=64,gc=128,Rn=512,qt=1024,Ht=2048,Yn=4096,_n=8192,mr=16384,ps=32768,Ia=65536,El=1<<17,yc=1<<18,ja=1<<19,Tf=1<<20,hr=1<<25,ia=65536,eo=1<<21,To=1<<22,Pr=1<<23,ra=Symbol("$state"),Ef=Symbol("legacy props"),Af=Symbol(""),Vr=new class extends Error{constructor(){super(...arguments);Xe(this,"name","StaleReactionError");Xe(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Cf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function If(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Pf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Rf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Of(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Df(t){throw new Error("https://svelte.dev/e/effect_orphan")}function jf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Lf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Nf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Bf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const zf=1,Ff=2,_c=4,Kf=8,Uf=16,Gf=1,Hf=4,Wf=8,Yf=16,bc=1,Vf=2,zt=Symbol(),wc="http://www.w3.org/1999/xhtml";function Xf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Qf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function kc(t){return t===this.v}function Zf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function xc(t){return!Zf(t,this.v)}let Jf=!1,bn=null;function Pa(t){bn=t}function _t(t,e=!1,r){bn={p:bn,i:!1,c:null,e:null,s:t,x:null,l:null}}function bt(t){var e=bn,r=e.e;if(r!==null){e.e=null;for(var a of r)Hc(a)}return t!==void 0&&(e.x=t),e.i=!0,bn=e.p,t??{}}function Sc(){return!0}let Xr=[];function Tc(){var t=Xr;Xr=[],Sf(t)}function Rr(t){if(Xr.length===0&&!rs){var e=Xr;queueMicrotask(()=>{e===Xr&&Tc()})}Xr.push(t)}function $f(){for(;Xr.length>0;)Tc()}function Ec(t){var e=ct;if(e===null)return Ze.f|=Pr,t;if((e.f&ps)===0&&(e.f&os)===0)throw t;Ra(t,e)}function Ra(t,e){for(;e!==null;){if((e.f&gc)!==0){if((e.f&ps)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const ed=-7169;function Pt(t,e){t.f=t.f&ed|e}function Eo(t){(t.f&Rn)!==0||t.deps===null?Pt(t,qt):Pt(t,Yn)}function Ac(t){if(t!==null)for(const e of t)(e.f&Gt)===0||(e.f&ia)===0||(e.f^=ia,Ac(e.deps))}function Cc(t,e,r){(t.f&Ht)!==0?e.add(t):(t.f&Yn)!==0&&r.add(t),Ac(t.deps),Pt(t,qt)}const qs=new Set;let He=null,$s=null,Ft=null,cn=[],fi=null,to=!1,rs=!1;var wa,ka,Zr,xa,us,fs,Jr,fr,Sa,ar,no,ro,Ic;const Qo=class Qo{constructor(){Qe(this,ar);Xe(this,"committed",!1);Xe(this,"current",new Map);Xe(this,"previous",new Map);Qe(this,wa,new Set);Qe(this,ka,new Set);Qe(this,Zr,0);Qe(this,xa,0);Qe(this,us,null);Qe(this,fs,new Set);Qe(this,Jr,new Set);Qe(this,fr,new Map);Xe(this,"is_fork",!1);Qe(this,Sa,!1)}is_deferred(){return this.is_fork||Z(this,xa)>0}skip_effect(e){Z(this,fr).has(e)||Z(this,fr).set(e,{d:[],m:[]})}unskip_effect(e){var r=Z(this,fr).get(e);if(r){Z(this,fr).delete(e);for(var a of r.d)Pt(a,Ht),Hn(a);for(a of r.m)Pt(a,Yn),Hn(a)}}process(e){var i;cn=[],this.apply();var r=[],a=[];for(const o of e)Qt(this,ar,no).call(this,o,r,a);if(this.is_deferred()){Qt(this,ar,ro).call(this,a),Qt(this,ar,ro).call(this,r);for(const[o,u]of Z(this,fr))Dc(o,u)}else{for(const o of Z(this,wa))o();Z(this,wa).clear(),Z(this,Zr)===0&&Qt(this,ar,Ic).call(this),$s=this,He=null,Al(a),Al(r),$s=null,(i=Z(this,us))==null||i.resolve()}Ft=null}capture(e,r){r!==zt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Pr)===0&&(this.current.set(e,e.v),Ft==null||Ft.set(e,e.v))}activate(){He=this,this.apply()}deactivate(){He===this&&(He=null,Ft=null)}flush(){if(this.activate(),cn.length>0){if(Pc(),He!==null&&He!==this)return}else Z(this,Zr)===0&&this.process([]);this.deactivate()}discard(){for(const e of Z(this,ka))e(this);Z(this,ka).clear()}increment(e){Ye(this,Zr,Z(this,Zr)+1),e&&Ye(this,xa,Z(this,xa)+1)}decrement(e){Ye(this,Zr,Z(this,Zr)-1),e&&Ye(this,xa,Z(this,xa)-1),!Z(this,Sa)&&(Ye(this,Sa,!0),Rr(()=>{Ye(this,Sa,!1),this.is_deferred()?cn.length>0&&this.flush():this.revive()}))}revive(){for(const e of Z(this,fs))Z(this,Jr).delete(e),Pt(e,Ht),Hn(e);for(const e of Z(this,Jr))Pt(e,Yn),Hn(e);this.flush()}oncommit(e){Z(this,wa).add(e)}ondiscard(e){Z(this,ka).add(e)}settled(){return(Z(this,us)??Ye(this,us,hc())).promise}static ensure(){if(He===null){const e=He=new Qo;qs.add(He),rs||Rr(()=>{He===e&&e.flush()})}return He}apply(){}};wa=new WeakMap,ka=new WeakMap,Zr=new WeakMap,xa=new WeakMap,us=new WeakMap,fs=new WeakMap,Jr=new WeakMap,fr=new WeakMap,Sa=new WeakMap,ar=new WeakSet,no=function(e,r,a){e.f^=qt;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(Vn|fa))!==0,h=d&&(u&qt)!==0,v=h||(u&_n)!==0||Z(this,fr).has(i);if(!v&&i.fn!==null){d?i.f^=qt:o!==null&&(u&(os|ui|mc))!==0?o.b.defer_effect(i):(u&os)!==0?r.push(i):ms(i)&&((u&yr)!==0&&Z(this,Jr).add(i),Da(i));var _=i.first;if(_!==null){i=_;continue}}var S=i.parent;for(i=i.next;i===null&&S!==null;)S===o&&(o=null),i=S.next,S=S.parent}},ro=function(e){for(var r=0;r<e.length;r+=1)Cc(e[r],Z(this,fs),Z(this,Jr))},Ic=function(){var i;if(qs.size>1){this.previous.clear();var e=Ft,r=!0;for(const o of qs){if(o===this){r=!1;continue}const u=[];for(const[h,v]of this.current){if(o.current.has(h))if(r&&v!==o.current.get(h))o.current.set(h,v);else continue;u.push(h)}if(u.length===0)continue;const d=[...o.current.keys()].filter(h=>!this.current.has(h));if(d.length>0){var a=cn;cn=[];const h=new Set,v=new Map;for(const _ of u)Rc(_,d,h,v);if(cn.length>0){He=o,o.apply();for(const _ of cn)Qt(i=o,ar,no).call(i,_,[],[]);o.deactivate()}cn=a}}He=null,Ft=e}this.committed=!0,qs.delete(this)};let Or=Qo;function td(t){var e=rs;rs=!0;try{for(var r;;){if($f(),cn.length===0&&(He==null||He.flush(),cn.length===0))return fi=null,r;Pc()}}finally{rs=e}}function Pc(){to=!0;var t=null;try{for(var e=0;cn.length>0;){var r=Or.ensure();if(e++>1e3){var a,i;nd()}r.process(cn),Dr.clear()}}finally{cn=[],to=!1,fi=null}}function nd(){try{jf()}catch(t){Ra(t,fi)}}let zn=null;function Al(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(mr|_n))===0&&ms(a)&&(zn=new Set,Da(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Xc(a),(zn==null?void 0:zn.size)>0)){Dr.clear();for(const i of zn){if((i.f&(mr|_n))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)zn.has(u)&&(zn.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const h=o[d];(h.f&(mr|_n))===0&&Da(h)}}zn.clear()}}zn=null}}function Rc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Gt)!==0?Rc(i,e,r,a):(o&(To|yr))!==0&&(o&Ht)===0&&Oc(i,e,a)&&(Pt(i,Ht),Hn(i))}}function Oc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ca.call(e,i))return!0;if((i.f&Gt)!==0&&Oc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Hn(t){for(var e=fi=t;e.parent!==null;){e=e.parent;var r=e.f;if(to&&e===ct&&(r&yr)!==0&&(r&yc)===0)return;if((r&(fa|Vn))!==0){if((r&qt)===0)return;e.f^=qt}}cn.push(e)}function Dc(t,e){if(!((t.f&Vn)!==0&&(t.f&qt)!==0)){(t.f&Ht)!==0?e.d.push(t):(t.f&Yn)!==0&&e.m.push(t),Pt(t,qt);for(var r=t.first;r!==null;)Dc(r,e),r=r.next}}function rd(t){let e=0,r=oa(0),a;return()=>{Io()&&(m(r),Po(()=>(e===0&&(a=gs(()=>t(()=>as(r)))),e+=1,()=>{Rr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,as(r))})})))}}var ad=Ia|ja|gc;function sd(t,e,r){new id(t,e,r)}var Cn,xo,$n,$r,er,In,on,tr,dr,Cr,ea,Ir,Ta,ta,Ea,Aa,vr,oi,Bt,od,ld,ao,Ws,Ys,so;class id{constructor(e,r,a){Qe(this,Bt);Xe(this,"parent");Xe(this,"is_pending",!1);Qe(this,Cn);Qe(this,xo,null);Qe(this,$n);Qe(this,$r);Qe(this,er);Qe(this,In,null);Qe(this,on,null);Qe(this,tr,null);Qe(this,dr,null);Qe(this,Cr,null);Qe(this,ea,0);Qe(this,Ir,0);Qe(this,Ta,!1);Qe(this,ta,!1);Qe(this,Ea,new Set);Qe(this,Aa,new Set);Qe(this,vr,null);Qe(this,oi,rd(()=>(Ye(this,vr,oa(Z(this,ea))),()=>{Ye(this,vr,null)})));Ye(this,Cn,e),Ye(this,$n,r),Ye(this,$r,a),this.parent=ct.b,this.is_pending=!!Z(this,$n).pending,Ye(this,er,Ro(()=>{ct.b=this;{var i=Qt(this,Bt,ao).call(this);try{Ye(this,In,Pn(()=>a(i)))}catch(o){this.error(o)}Z(this,Ir)>0?Qt(this,Bt,Ys).call(this):this.is_pending=!1}return()=>{var o;(o=Z(this,Cr))==null||o.remove()}},ad))}defer_effect(e){Cc(e,Z(this,Ea),Z(this,Aa))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!Z(this,$n).pending}update_pending_count(e){Qt(this,Bt,so).call(this,e),Ye(this,ea,Z(this,ea)+e),!(!Z(this,vr)||Z(this,Ta))&&(Ye(this,Ta,!0),Rr(()=>{Ye(this,Ta,!1),Z(this,vr)&&Oa(Z(this,vr),Z(this,ea))}))}get_effect_pending(){return Z(this,oi).call(this),m(Z(this,vr))}error(e){var r=Z(this,$n).onerror;let a=Z(this,$n).failed;if(Z(this,ta)||!r&&!a)throw e;Z(this,In)&&(fn(Z(this,In)),Ye(this,In,null)),Z(this,on)&&(fn(Z(this,on)),Ye(this,on,null)),Z(this,tr)&&(fn(Z(this,tr)),Ye(this,tr,null));var i=!1,o=!1;const u=()=>{if(i){Qf();return}i=!0,o&&Bf(),Or.ensure(),Ye(this,ea,0),Z(this,tr)!==null&&aa(Z(this,tr),()=>{Ye(this,tr,null)}),this.is_pending=this.has_pending_snippet(),Ye(this,In,Qt(this,Bt,Ws).call(this,()=>(Ye(this,ta,!1),Pn(()=>Z(this,$r).call(this,Z(this,Cn)))))),Z(this,Ir)>0?Qt(this,Bt,Ys).call(this):this.is_pending=!1};Rr(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){Ra(d,Z(this,er)&&Z(this,er).parent)}a&&Ye(this,tr,Qt(this,Bt,Ws).call(this,()=>{Or.ensure(),Ye(this,ta,!0);try{return Pn(()=>{a(Z(this,Cn),()=>e,()=>u)})}catch(d){return Ra(d,Z(this,er).parent),null}finally{Ye(this,ta,!1)}}))})}}Cn=new WeakMap,xo=new WeakMap,$n=new WeakMap,$r=new WeakMap,er=new WeakMap,In=new WeakMap,on=new WeakMap,tr=new WeakMap,dr=new WeakMap,Cr=new WeakMap,ea=new WeakMap,Ir=new WeakMap,Ta=new WeakMap,ta=new WeakMap,Ea=new WeakMap,Aa=new WeakMap,vr=new WeakMap,oi=new WeakMap,Bt=new WeakSet,od=function(){try{Ye(this,In,Pn(()=>Z(this,$r).call(this,Z(this,Cn))))}catch(e){this.error(e)}},ld=function(){const e=Z(this,$n).pending;e&&(Ye(this,on,Pn(()=>e(Z(this,Cn)))),Rr(()=>{var r=Qt(this,Bt,ao).call(this);Ye(this,In,Qt(this,Bt,Ws).call(this,()=>(Or.ensure(),Pn(()=>Z(this,$r).call(this,r))))),Z(this,Ir)>0?Qt(this,Bt,Ys).call(this):(aa(Z(this,on),()=>{Ye(this,on,null)}),this.is_pending=!1)}))},ao=function(){var e=Z(this,Cn);return this.is_pending&&(Ye(this,Cr,gr()),Z(this,Cn).before(Z(this,Cr)),e=Z(this,Cr)),e},Ws=function(e){var r=ct,a=Ze,i=bn;rr(Z(this,er)),Dn(Z(this,er)),Pa(Z(this,er).ctx);try{return e()}catch(o){return Ec(o),null}finally{rr(r),Dn(a),Pa(i)}},Ys=function(){const e=Z(this,$n).pending;Z(this,In)!==null&&(Ye(this,dr,document.createDocumentFragment()),Z(this,dr).append(Z(this,Cr)),Jc(Z(this,In),Z(this,dr))),Z(this,on)===null&&Ye(this,on,Pn(()=>e(Z(this,Cn))))},so=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Qt(r=this.parent,Bt,so).call(r,e);return}if(Ye(this,Ir,Z(this,Ir)+e),Z(this,Ir)===0){this.is_pending=!1;for(const a of Z(this,Ea))Pt(a,Ht),Hn(a);for(const a of Z(this,Aa))Pt(a,Yn),Hn(a);Z(this,Ea).clear(),Z(this,Aa).clear(),Z(this,on)&&aa(Z(this,on),()=>{Ye(this,on,null)}),Z(this,dr)&&(Z(this,Cn).before(Z(this,dr)),Ye(this,dr,null))}};function cd(t,e,r,a){const i=di;var o=t.filter(w=>!w.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=He,d=ct,h=ud(),v=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(w=>w.promise)):null;function _(w){h();try{a(w)}catch(k){(d.f&mr)===0&&Ra(k,d)}u==null||u.deactivate(),io()}if(r.length===0){v.then(()=>_(e.map(i)));return}function S(){h(),Promise.all(r.map(w=>fd(w))).then(w=>_([...e.map(i),...w])).catch(w=>Ra(w,d))}v?v.then(S):S()}function ud(){var t=ct,e=Ze,r=bn,a=He;return function(o=!0){rr(t),Dn(e),Pa(r),o&&(a==null||a.activate())}}function io(){rr(null),Dn(null),Pa(null)}function di(t){var e=Gt|Ht,r=Ze!==null&&(Ze.f&Gt)!==0?Ze:null;return ct!==null&&(ct.f|=ja),{ctx:bn,deps:null,effects:null,equals:kc,f:e,fn:t,reactions:null,rv:0,v:zt,wv:0,parent:r??ct,ac:null}}function fd(t,e,r){let a=ct;a===null&&If();var i=a.b,o=void 0,u=oa(zt),d=!Ze,h=new Map;return Td(()=>{var k;var v=hc();o=v.promise;try{Promise.resolve(t()).then(v.resolve,v.reject).then(()=>{_===He&&_.committed&&_.deactivate(),io()})}catch(D){v.reject(D),io()}var _=He;if(d){var S=i.is_rendered();i.update_pending_count(1),_.increment(S),(k=h.get(_))==null||k.reject(Vr),h.delete(_),h.set(_,v)}const w=(D,E=void 0)=>{if(_.activate(),E)E!==Vr&&(u.f|=Pr,Oa(u,E));else{(u.f&Pr)!==0&&(u.f^=Pr),Oa(u,D);for(const[T,U]of h){if(h.delete(T),T===_)break;U.reject(Vr)}}d&&(i.update_pending_count(-1),_.decrement(S))};v.promise.then(w,D=>w(null,D||"unknown"))}),Gc(()=>{for(const v of h.values())v.reject(Vr)}),new Promise(v=>{function _(S){function w(){S===o?v(u):_(o)}S.then(w,w)}_(o)})}function yt(t){const e=di(t);return $c(e),e}function jc(t){const e=di(t);return e.equals=xc,e}function dd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)fn(e[r])}}function vd(t){for(var e=t.parent;e!==null;){if((e.f&Gt)===0)return(e.f&mr)===0?e:null;e=e.parent}return null}function Ao(t){var e,r=ct;rr(vd(t));try{t.f&=~ia,dd(t),e=ru(t)}finally{rr(r)}return e}function Mc(t){var e=Ao(t);if(!t.equals(e)&&(t.wv=tu(),(!(He!=null&&He.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){Pt(t,qt);return}jr||(Ft!==null?(Io()||He!=null&&He.is_fork)&&Ft.set(t,e):Eo(t))}function pd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Vr),a.teardown=xf,a.ac=null,ls(a,0),Oo(a))}function Lc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Da(e)}let oo=new Set;const Dr=new Map;let Nc=!1;function oa(t,e){var r={f:0,v:t,reactions:null,equals:kc,rv:0,wv:0};return r}function Oe(t,e){const r=oa(t);return $c(r),r}function hd(t,e=!1,r=!0){const a=oa(t);return e||(a.equals=xc),a}function L(t,e,r=!1){Ze!==null&&(!Wn||(Ze.f&El)!==0)&&Sc()&&(Ze.f&(Gt|yr|To|El))!==0&&(On===null||!Ca.call(On,t))&&qf();let a=r?Kt(e):e;return Oa(t,a)}function Oa(t,e){if(!t.equals(e)){var r=t.v;jr?Dr.set(t,e):Dr.set(t,r),t.v=e;var a=Or.ensure();if(a.capture(t,r),(t.f&Gt)!==0){const i=t;(t.f&Ht)!==0&&Ao(i),Eo(i)}t.wv=tu(),qc(t,Ht),ct!==null&&(ct.f&qt)!==0&&(ct.f&(Vn|fa))===0&&(An===null?Ad([t]):An.push(t)),!a.is_fork&&oo.size>0&&!Nc&&md()}return e}function md(){Nc=!1;for(const t of oo)(t.f&qt)!==0&&Pt(t,Yn),ms(t)&&Da(t);oo.clear()}function as(t){L(t,t.v+1)}function qc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&Ht)===0;if(d&&Pt(o,e),(u&Gt)!==0){var h=o;Ft==null||Ft.delete(h),(u&ia)===0&&(u&Rn&&(o.f|=ia),qc(h,Yn))}else d&&((u&yr)!==0&&zn!==null&&zn.add(o),Hn(o))}}function Kt(t){if(typeof t!="object"||t===null||ra in t)return t;const e=pc(t);if(e!==wf&&e!==kf)return t;var r=new Map,a=So(t),i=Oe(0),o=sa,u=d=>{if(sa===o)return d();var h=Ze,v=sa;Dn(null),Ol(o);var _=d();return Dn(h),Ol(v),_};return a&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,h,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Lf();var _=r.get(h);return _===void 0?u(()=>{var S=Oe(v.value);return r.set(h,S),S}):L(_,v.value,!0),!0},deleteProperty(d,h){var v=r.get(h);if(v===void 0){if(h in d){const _=u(()=>Oe(zt));r.set(h,_),as(i)}}else L(v,zt),as(i);return!0},get(d,h,v){var k;if(h===ra)return t;var _=r.get(h),S=h in d;if(_===void 0&&(!S||(k=_a(d,h))!=null&&k.writable)&&(_=u(()=>{var D=Kt(S?d[h]:zt),E=Oe(D);return E}),r.set(h,_)),_!==void 0){var w=m(_);return w===zt?void 0:w}return Reflect.get(d,h,v)},getOwnPropertyDescriptor(d,h){var v=Reflect.getOwnPropertyDescriptor(d,h);if(v&&"value"in v){var _=r.get(h);_&&(v.value=m(_))}else if(v===void 0){var S=r.get(h),w=S==null?void 0:S.v;if(S!==void 0&&w!==zt)return{enumerable:!0,configurable:!0,value:w,writable:!0}}return v},has(d,h){var w;if(h===ra)return!0;var v=r.get(h),_=v!==void 0&&v.v!==zt||Reflect.has(d,h);if(v!==void 0||ct!==null&&(!_||(w=_a(d,h))!=null&&w.writable)){v===void 0&&(v=u(()=>{var k=_?Kt(d[h]):zt,D=Oe(k);return D}),r.set(h,v));var S=m(v);if(S===zt)return!1}return _},set(d,h,v,_){var ae;var S=r.get(h),w=h in d;if(a&&h==="length")for(var k=v;k<S.v;k+=1){var D=r.get(k+"");D!==void 0?L(D,zt):k in d&&(D=u(()=>Oe(zt)),r.set(k+"",D))}if(S===void 0)(!w||(ae=_a(d,h))!=null&&ae.writable)&&(S=u(()=>Oe(void 0)),L(S,Kt(v)),r.set(h,S));else{w=S.v!==zt;var E=u(()=>Kt(v));L(S,E)}var T=Reflect.getOwnPropertyDescriptor(d,h);if(T!=null&&T.set&&T.set.call(_,v),!w){if(a&&typeof h=="string"){var U=r.get("length"),re=Number(h);Number.isInteger(re)&&re>=U.v&&L(U,re+1)}as(i)}return!0},ownKeys(d){m(i);var h=Reflect.ownKeys(d).filter(S=>{var w=r.get(S);return w===void 0||w.v!==zt});for(var[v,_]of r)_.v!==zt&&!(v in d)&&h.push(v);return h},setPrototypeOf(){Nf()}})}function Cl(t){try{if(t!==null&&typeof t=="object"&&ra in t)return t[ra]}catch{}return t}function gd(t,e){return Object.is(Cl(t),Cl(e))}var Il,Bc,zc,Fc;function yd(){if(Il===void 0){Il=window,Bc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;zc=_a(e,"firstChild").get,Fc=_a(e,"nextSibling").get,Tl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Tl(r)&&(r.__t=void 0)}}function gr(t=""){return document.createTextNode(t)}function yn(t){return zc.call(t)}function hs(t){return Fc.call(t)}function y(t,e){return yn(t)}function $e(t,e=!1){{var r=yn(t);return r instanceof Comment&&r.data===""?hs(r):r}}function x(t,e=1,r=!1){let a=t;for(;e--;)a=hs(a);return a}function _d(t){t.textContent=""}function Kc(){return!1}function bd(t,e,r){return document.createElementNS(wc,t,void 0)}let Pl=!1;function wd(){Pl||(Pl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Co(t){var e=Ze,r=ct;Dn(null),rr(null);try{return t()}finally{Dn(e),rr(r)}}function Uc(t,e,r,a=r){t.addEventListener(e,()=>Co(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),wd()}function kd(t){ct===null&&(Ze===null&&Df(),Of()),jr&&Rf()}function xd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function _r(t,e,r){var a=ct;a!==null&&(a.f&_n)!==0&&(t|=_n);var i={ctx:bn,deps:null,nodes:null,f:t|Ht|Rn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Da(i)}catch(d){throw fn(i),d}else e!==null&&Hn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&ja)===0&&(o=o.first,(t&yr)!==0&&(t&Ia)!==0&&o!==null&&(o.f|=Ia)),o!==null&&(o.parent=a,a!==null&&xd(o,a),Ze!==null&&(Ze.f&Gt)!==0&&(t&fa)===0)){var u=Ze;(u.effects??(u.effects=[])).push(o)}return i}function Io(){return Ze!==null&&!Wn}function Gc(t){const e=_r(ui,null,!1);return Pt(e,qt),e.teardown=t,e}function ei(t){kd();var e=ct.f,r=!Ze&&(e&Vn)!==0&&(e&ps)===0;if(r){var a=bn;(a.e??(a.e=[])).push(t)}else return Hc(t)}function Hc(t){return _r(os|Tf,t,!1)}function Sd(t){Or.ensure();const e=_r(fa|ja,t,!0);return(r={})=>new Promise(a=>{r.outro?aa(e,()=>{fn(e),a(void 0)}):(fn(e),a(void 0))})}function Wc(t){return _r(os,t,!1)}function Td(t){return _r(To|ja,t,!0)}function Po(t,e=0){return _r(ui|e,t,!0)}function le(t,e=[],r=[],a=[]){cd(a,e,r,i=>{_r(ui,()=>t(...i.map(m)),!0)})}function Ro(t,e=0){var r=_r(yr|e,t,!0);return r}function Pn(t){return _r(Vn|ja,t,!0)}function Yc(t){var e=t.teardown;if(e!==null){const r=jr,a=Ze;Rl(!0),Dn(null);try{e.call(null)}finally{Rl(r),Dn(a)}}}function Oo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Co(()=>{i.abort(Vr)});var a=r.next;(r.f&fa)!==0?r.parent=null:fn(r,e),r=a}}function Ed(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Vn)===0&&fn(e),e=r}}function fn(t,e=!0){var r=!1;(e||(t.f&yc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Vc(t.nodes.start,t.nodes.end),r=!0),Oo(t,e&&!r),ls(t,0),Pt(t,mr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Yc(t);var i=t.parent;i!==null&&i.first!==null&&Xc(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Vc(t,e){for(;t!==null;){var r=t===e?null:hs(t);t.remove(),t=r}}function Xc(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function aa(t,e,r=!0){var a=[];Qc(t,a,!0);var i=()=>{r&&fn(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function Qc(t,e,r){if((t.f&_n)===0){t.f^=_n;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Ia)!==0||(i.f&Vn)!==0&&(t.f&yr)!==0;Qc(i,e,u?r:!1),i=o}}}function Do(t){Zc(t,!0)}function Zc(t,e){if((t.f&_n)!==0){t.f^=_n,(t.f&qt)===0&&(Pt(t,Ht),Hn(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ia)!==0||(r.f&Vn)!==0;Zc(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function Jc(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:hs(r);e.append(r),r=i}}let Vs=!1,jr=!1;function Rl(t){jr=t}let Ze=null,Wn=!1;function Dn(t){Ze=t}let ct=null;function rr(t){ct=t}let On=null;function $c(t){Ze!==null&&(On===null?On=[t]:On.push(t))}let un=null,mn=0,An=null;function Ad(t){An=t}let eu=1,Qr=0,sa=Qr;function Ol(t){sa=t}function tu(){return++eu}function ms(t){var e=t.f;if((e&Ht)!==0)return!0;if(e&Gt&&(t.f&=~ia),(e&Yn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(ms(o)&&Mc(o),o.wv>t.wv)return!0}(e&Rn)!==0&&Ft===null&&Pt(t,qt)}return!1}function nu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(On!==null&&Ca.call(On,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Gt)!==0?nu(o,e,!1):e===o&&(r?Pt(o,Ht):(o.f&qt)!==0&&Pt(o,Yn),Hn(o))}}function ru(t){var E;var e=un,r=mn,a=An,i=Ze,o=On,u=bn,d=Wn,h=sa,v=t.f;un=null,mn=0,An=null,Ze=(v&(Vn|fa))===0?t:null,On=null,Pa(t.ctx),Wn=!1,sa=++Qr,t.ac!==null&&(Co(()=>{t.ac.abort(Vr)}),t.ac=null);try{t.f|=eo;var _=t.fn,S=_();t.f|=ps;var w=t.deps,k=He==null?void 0:He.is_fork;if(un!==null){var D;if(k||ls(t,mn),w!==null&&mn>0)for(w.length=mn+un.length,D=0;D<un.length;D++)w[mn+D]=un[D];else t.deps=w=un;if(Io()&&(t.f&Rn)!==0)for(D=mn;D<w.length;D++)((E=w[D]).reactions??(E.reactions=[])).push(t)}else!k&&w!==null&&mn<w.length&&(ls(t,mn),w.length=mn);if(Sc()&&An!==null&&!Wn&&w!==null&&(t.f&(Gt|Yn|Ht))===0)for(D=0;D<An.length;D++)nu(An[D],t);if(i!==null&&i!==t){if(Qr++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=Qr;if(e!==null)for(const T of e)T.rv=Qr;An!==null&&(a===null?a=An:a.push(...An))}return(t.f&Pr)!==0&&(t.f^=Pr),S}catch(T){return Ec(T)}finally{t.f^=eo,un=e,mn=r,An=a,Ze=i,On=o,Pa(u),Wn=d,sa=h}}function Cd(t,e){let r=e.reactions;if(r!==null){var a=yf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Gt)!==0&&(un===null||!Ca.call(un,e))){var o=e;(o.f&Rn)!==0&&(o.f^=Rn,o.f&=~ia),Eo(o),pd(o),ls(o,0)}}function ls(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Cd(t,r[a])}function Da(t){var e=t.f;if((e&mr)===0){Pt(t,qt);var r=ct,a=Vs;ct=t,Vs=!0;try{(e&(yr|mc))!==0?Ed(t):Oo(t),Yc(t);var i=ru(t);t.teardown=typeof i=="function"?i:null,t.wv=eu;var o;$i&&Jf&&(t.f&Ht)!==0&&t.deps}finally{Vs=a,ct=r}}}async function au(){await Promise.resolve(),td()}function m(t){var e=t.f,r=(e&Gt)!==0;if(Ze!==null&&!Wn){var a=ct!==null&&(ct.f&mr)!==0;if(!a&&(On===null||!Ca.call(On,t))){var i=Ze.deps;if((Ze.f&eo)!==0)t.rv<Qr&&(t.rv=Qr,un===null&&i!==null&&i[mn]===t?mn++:un===null?un=[t]:un.push(t));else{(Ze.deps??(Ze.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ze]:Ca.call(o,Ze)||o.push(Ze)}}}if(jr&&Dr.has(t))return Dr.get(t);if(r){var u=t;if(jr){var d=u.v;return((u.f&qt)===0&&u.reactions!==null||iu(u))&&(d=Ao(u)),Dr.set(u,d),d}var h=(u.f&Rn)===0&&!Wn&&Ze!==null&&(Vs||(Ze.f&Rn)!==0),v=(u.f&ps)===0;ms(u)&&(h&&(u.f|=Rn),Mc(u)),h&&!v&&(Lc(u),su(u))}if(Ft!=null&&Ft.has(t))return Ft.get(t);if((t.f&Pr)!==0)throw t.v;return t.v}function su(t){if(t.f|=Rn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Gt)!==0&&(e.f&Rn)===0&&(Lc(e),su(e))}function iu(t){if(t.v===zt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Dr.has(e)||(e.f&Gt)!==0&&iu(e))return!0;return!1}function gs(t){var e=Wn;try{return Wn=!0,t()}finally{Wn=e}}const Id=["touchstart","touchmove"];function Pd(t){return Id.includes(t)}const ou=new Set,lo=new Set;function Mt(t){for(var e=0;e<t.length;e++)ou.add(t[e]);for(var r of lo)r(t)}let Dl=null;function jl(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;Dl=t;var u=0,d=Dl===t&&t.__root;if(d){var h=i.indexOf(d);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var v=i.indexOf(e);if(v===-1)return;h<=v&&(u=h)}if(o=i[u]||t.target,o!==e){_f(t,"currentTarget",{configurable:!0,get(){return o||r}});var _=Ze,S=ct;Dn(null),rr(null);try{for(var w,k=[];o!==null;){var D=o.assignedSlot||o.parentNode||o.host||null;try{var E=o["__"+a];E!=null&&(!o.disabled||t.target===o)&&E.call(o,t)}catch(U){w?k.push(U):w=U}if(t.cancelBubble||D===e||D===null)break;o=D}if(w){for(let U of k)queueMicrotask(()=>{throw U});throw w}}finally{t.__root=e,delete t.currentTarget,Dn(_),rr(S)}}}var fc,dc;const Fi=(dc=(fc=globalThis==null?void 0:globalThis.window)==null?void 0:fc.trustedTypes)==null?void 0:dc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Rd(t){return(Fi==null?void 0:Fi.createHTML(t))??t}function jo(t,e=!1){var r=bd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Rd(t):t,r.content}function la(t,e){var r=ct;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function z(t,e){var r=(e&bc)!==0,a=(e&Vf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=jo(o?t:"<!>"+t,!0),r||(i=yn(i)));var u=a||Bc?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=yn(u),h=u.lastChild;la(d,h)}else la(u,u);return u}}function Od(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&bc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=jo(o,!0),h=yn(d);if(i)for(u=document.createDocumentFragment();yn(h);)u.appendChild(yn(h));else u=yn(h)}var v=u.cloneNode(!0);if(i){var _=yn(v),S=v.lastChild;la(_,S)}else la(v,v);return v}}function Mo(t,e){return Od(t,e,"svg")}function ti(t=""){{var e=gr(t+"");return la(e,e),e}}function Mr(){var t=document.createDocumentFragment(),e=document.createComment(""),r=gr();return t.append(e,r),la(e,r),t}function N(t,e){t!==null&&t.before(e)}function V(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Dd(t,e){return jd(t,e)}const Bs=new Map;function jd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){yd();var d=new Set,h=S=>{for(var w=0;w<S.length;w++){var k=S[w];if(!d.has(k)){d.add(k);var D=Pd(k);for(const U of[e,document]){var E=Bs.get(U);E===void 0&&(E=new Map,Bs.set(U,E));var T=E.get(k);T===void 0?(U.addEventListener(k,jl,{passive:D}),E.set(k,1)):E.set(k,T+1)}}}};h(ci(ou)),lo.add(h);var v=void 0,_=Sd(()=>{var S=r??e.appendChild(gr());return sd(S,{pending:()=>{}},w=>{_t({});var k=bn;o&&(k.c=o),i&&(a.$$events=i),v=t(w,a)||{},bt()}),()=>{var E;for(var w of d)for(const T of[e,document]){var k=Bs.get(T),D=k.get(w);--D==0?(T.removeEventListener(w,jl),k.delete(w),k.size===0&&Bs.delete(T)):k.set(w,D)}lo.delete(h),S!==r&&((E=S.parentNode)==null||E.removeChild(S))}});return Md.set(v,_),v}let Md=new WeakMap;var Kn,nr,gn,na,ds,vs,li;class Ld{constructor(e,r=!0){Xe(this,"anchor");Qe(this,Kn,new Map);Qe(this,nr,new Map);Qe(this,gn,new Map);Qe(this,na,new Set);Qe(this,ds,!0);Qe(this,vs,()=>{var e=He;if(Z(this,Kn).has(e)){var r=Z(this,Kn).get(e),a=Z(this,nr).get(r);if(a)Do(a),Z(this,na).delete(r);else{var i=Z(this,gn).get(r);i&&(Z(this,nr).set(r,i.effect),Z(this,gn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of Z(this,Kn)){if(Z(this,Kn).delete(o),o===e)break;const d=Z(this,gn).get(u);d&&(fn(d.effect),Z(this,gn).delete(u))}for(const[o,u]of Z(this,nr)){if(o===r||Z(this,na).has(o))continue;const d=()=>{if(Array.from(Z(this,Kn).values()).includes(o)){var v=document.createDocumentFragment();Jc(u,v),v.append(gr()),Z(this,gn).set(o,{effect:u,fragment:v})}else fn(u);Z(this,na).delete(o),Z(this,nr).delete(o)};Z(this,ds)||!a?(Z(this,na).add(o),aa(u,d,!1)):d()}}});Qe(this,li,e=>{Z(this,Kn).delete(e);const r=Array.from(Z(this,Kn).values());for(const[a,i]of Z(this,gn))r.includes(a)||(fn(i.effect),Z(this,gn).delete(a))});this.anchor=e,Ye(this,ds,r)}ensure(e,r){var a=He,i=Kc();if(r&&!Z(this,nr).has(e)&&!Z(this,gn).has(e))if(i){var o=document.createDocumentFragment(),u=gr();o.append(u),Z(this,gn).set(e,{effect:Pn(()=>r(u)),fragment:o})}else Z(this,nr).set(e,Pn(()=>r(this.anchor)));if(Z(this,Kn).set(a,e),i){for(const[d,h]of Z(this,nr))d===e?a.unskip_effect(h):a.skip_effect(h);for(const[d,h]of Z(this,gn))d===e?a.unskip_effect(h.effect):a.skip_effect(h.effect);a.oncommit(Z(this,vs)),a.ondiscard(Z(this,li))}else Z(this,vs).call(this)}}Kn=new WeakMap,nr=new WeakMap,gn=new WeakMap,na=new WeakMap,ds=new WeakMap,vs=new WeakMap,li=new WeakMap;function de(t,e,r=!1){var a=new Ld(t),i=r?Ia:0;function o(u,d){a.ensure(u,d)}Ro(()=>{var u=!1;e((d,h=0)=>{u=!0,o(h,d)}),u||o(!1,null)},i)}function sr(t,e){return e}function Nd(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let S=e[d];aa(S,()=>{if(o){if(o.pending.delete(S),o.done.add(S),o.pending.size===0){var w=t.outrogroups;co(ci(o.done)),w.delete(o),w.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var h=a.length===0&&r!==null;if(h){var v=r,_=v.parentNode;_d(_),_.append(v),t.items.clear()}co(e,!h)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function co(t,e=!0){for(var r=0;r<t.length;r++)fn(t[r],e)}var Ml;function en(t,e,r,a,i,o=null){var u=t,d=new Map,h=(e&_c)!==0;if(h){var v=t;u=v.appendChild(gr())}var _=null,S=jc(()=>{var U=r();return So(U)?U:U==null?[]:ci(U)}),w,k=!0;function D(){T.fallback=_,qd(T,w,u,e,a),_!==null&&(w.length===0?(_.f&hr)===0?Do(_):(_.f^=hr,ts(_,null,u)):aa(_,()=>{_=null}))}var E=Ro(()=>{w=m(S);for(var U=w.length,re=new Set,ae=He,H=Kc(),J=0;J<U;J+=1){var ee=w[J],F=a(ee,J),fe=k?null:d.get(F);fe?(fe.v&&Oa(fe.v,ee),fe.i&&Oa(fe.i,J),H&&ae.unskip_effect(fe.e)):(fe=Bd(d,k?u:Ml??(Ml=gr()),ee,F,J,i,e,r),k||(fe.e.f|=hr),d.set(F,fe)),re.add(F)}if(U===0&&o&&!_&&(k?_=Pn(()=>o(u)):(_=Pn(()=>o(Ml??(Ml=gr()))),_.f|=hr)),U>re.size&&Pf(),!k)if(H){for(const[Ae,Ie]of d)re.has(Ae)||ae.skip_effect(Ie.e);ae.oncommit(D),ae.ondiscard(()=>{})}else D();m(S)}),T={effect:E,items:d,outrogroups:null,fallback:_};k=!1}function Ya(t){for(;t!==null&&(t.f&Vn)===0;)t=t.next;return t}function qd(t,e,r,a,i){var Ie,ce,$,ie,Pe,oe,ve,pe,X;var o=(a&Kf)!==0,u=e.length,d=t.items,h=Ya(t.effect.first),v,_=null,S,w=[],k=[],D,E,T,U;if(o)for(U=0;U<u;U+=1)D=e[U],E=i(D,U),T=d.get(E).e,(T.f&hr)===0&&((ce=(Ie=T.nodes)==null?void 0:Ie.a)==null||ce.measure(),(S??(S=new Set)).add(T));for(U=0;U<u;U+=1){if(D=e[U],E=i(D,U),T=d.get(E).e,t.outrogroups!==null)for(const ue of t.outrogroups)ue.pending.delete(T),ue.done.delete(T);if((T.f&hr)!==0)if(T.f^=hr,T===h)ts(T,null,r);else{var re=_?_.next:h;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),Er(t,_,T),Er(t,T,re),ts(T,re,r),_=T,w=[],k=[],h=Ya(_.next);continue}if((T.f&_n)!==0&&(Do(T),o&&((ie=($=T.nodes)==null?void 0:$.a)==null||ie.unfix(),(S??(S=new Set)).delete(T))),T!==h){if(v!==void 0&&v.has(T)){if(w.length<k.length){var ae=k[0],H;_=ae.prev;var J=w[0],ee=w[w.length-1];for(H=0;H<w.length;H+=1)ts(w[H],ae,r);for(H=0;H<k.length;H+=1)v.delete(k[H]);Er(t,J.prev,ee.next),Er(t,_,J),Er(t,ee,ae),h=ae,_=ee,U-=1,w=[],k=[]}else v.delete(T),ts(T,h,r),Er(t,T.prev,T.next),Er(t,T,_===null?t.effect.first:_.next),Er(t,_,T),_=T;continue}for(w=[],k=[];h!==null&&h!==T;)(v??(v=new Set)).add(h),k.push(h),h=Ya(h.next);if(h===null)continue}(T.f&hr)===0&&w.push(T),_=T,h=Ya(T.next)}if(t.outrogroups!==null){for(const ue of t.outrogroups)ue.pending.size===0&&(co(ci(ue.done)),(Pe=t.outrogroups)==null||Pe.delete(ue));t.outrogroups.size===0&&(t.outrogroups=null)}if(h!==null||v!==void 0){var F=[];if(v!==void 0)for(T of v)(T.f&_n)===0&&F.push(T);for(;h!==null;)(h.f&_n)===0&&h!==t.fallback&&F.push(h),h=Ya(h.next);var fe=F.length;if(fe>0){var Ae=(a&_c)!==0&&u===0?r:null;if(o){for(U=0;U<fe;U+=1)(ve=(oe=F[U].nodes)==null?void 0:oe.a)==null||ve.measure();for(U=0;U<fe;U+=1)(X=(pe=F[U].nodes)==null?void 0:pe.a)==null||X.fix()}Nd(t,F,Ae)}}o&&Rr(()=>{var ue,ge;if(S!==void 0)for(T of S)(ge=(ue=T.nodes)==null?void 0:ue.a)==null||ge.apply()})}function Bd(t,e,r,a,i,o,u,d){var h=(u&zf)!==0?(u&Uf)===0?hd(r,!1,!1):oa(r):null,v=(u&Ff)!==0?oa(i):null;return{v:h,i:v,e:Pn(()=>(o(e,h??r,v??i,d),()=>{t.delete(a)}))}}function ts(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&hr)===0?e.nodes.start:r;a!==null;){var u=hs(a);if(o.before(a),a===i)return;a=u}}function Er(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function zd(t,e,r=!1,a=!1,i=!1){var o=t,u="";le(()=>{var d=ct;if(u!==(u=e()??"")&&(d.nodes!==null&&(Vc(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var h=u+"";r?h=`<svg>${h}</svg>`:a&&(h=`<math>${h}</math>`);var v=jo(h);if((r||a)&&(v=yn(v)),la(yn(v),v.lastChild),r||a)for(;yn(v);)o.before(yn(v));else o.before(v)}})}const Ll=[...` 	
\r\fÂ \v\uFEFF`];function Fd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||Ll.includes(a[u-1]))&&(d===a.length||Ll.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function Nl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Ki(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Kd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,h=[];a&&h.push(...Object.keys(a).map(Ki)),i&&h.push(...Object.keys(i).map(Ki));var v=0,_=-1;const E=t.length;for(var S=0;S<E;S++){var w=t[S];if(d?w==="/"&&t[S-1]==="*"&&(d=!1):o?o===w&&(o=!1):w==="/"&&t[S+1]==="*"?d=!0:w==='"'||w==="'"?o=w:w==="("?u++:w===")"&&u--,!d&&o===!1&&u===0){if(w===":"&&_===-1)_=S;else if(w===";"||S===E-1){if(_!==-1){var k=Ki(t.substring(v,_).trim());if(!h.includes(k)){w!==";"&&S++;var D=t.substring(v,S).trim();r+=" "+D+";"}}v=S+1,_=-1}}}}return a&&(r+=Nl(a)),i&&(r+=Nl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Dt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=Fd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var h in o){var v=!!o[h];(i==null||v!==!!i[h])&&t.classList.toggle(h,v)}return o}function Ui(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function dn(t,e,r,a){var i=t.__style;if(i!==e){var o=Kd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Ui(t,r==null?void 0:r[0],a[0]),Ui(t,r==null?void 0:r[1],a[1],"important")):Ui(t,r,a));return a}function lu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!So(e))return Xf();for(var a of t.options)a.selected=e.includes(ss(a));return}for(a of t.options){var i=ss(a);if(gd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Ud(t){var e=new MutationObserver(()=>{lu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Gc(()=>{e.disconnect()})}function Lo(t,e,r=e){var a=new WeakSet,i=!0;Uc(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),ss);else{var h=t.querySelector(u)??t.querySelector("option:not([disabled])");d=h&&ss(h)}r(d),He!==null&&a.add(He)}),Wc(()=>{var o=e();if(t===document.activeElement){var u=$s??He;if(a.has(u))return}if(lu(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=ss(d),r(o))}t.__value=o,i=!1}),Ud(t)}function ss(t){return"__value"in t?t.__value:t.value}const Gd=Symbol("is custom element"),Hd=Symbol("is html");function cu(t,e,r,a){var i=Wd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Af]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Yd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Wd(t){return t.__attributes??(t.__attributes={[Gd]:t.nodeName.includes("-"),[Hd]:t.namespaceURI===wc})}var ql=new Map;function Yd(t){var e=t.getAttribute("is")||t.nodeName,r=ql.get(e);if(r)return r;ql.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=bf(i);for(var u in a)a[u].set&&r.push(u);i=pc(i)}return r}function No(t,e,r=e){var a=new WeakSet;Uc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Gi(t)?Hi(o):o,r(o),He!==null&&a.add(He),await au(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,h=t.value.length;if(t.value=o??"",d!==null){var v=t.value.length;u===d&&d===h&&v>h?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=u,t.selectionEnd=Math.min(d,v))}}}),gs(e)==null&&t.value&&(r(Gi(t)?Hi(t.value):t.value),He!==null&&a.add(He)),Po(()=>{var i=e();if(t===document.activeElement){var o=$s??He;if(a.has(o))return}Gi(t)&&i===Hi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Gi(t){var e=t.type;return e==="number"||e==="range"}function Hi(t){return t===""?null:+t}function Bl(t,e){return t===e||(t==null?void 0:t[ra])===e}function uu(t={},e,r,a){return Wc(()=>{var i,o;return Po(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&Bl(r(...i),t)&&e(null,...i))})}),()=>{Rr(()=>{o&&Bl(r(...o),t)&&e(null,...o)})}}),t}let zs=!1;function Vd(t){var e=zs;try{return zs=!1,[t(),zs]}finally{zs=e}}function De(t,e,r,a){var re;var i=(r&Wf)!==0,o=(r&Yf)!==0,u=a,d=!0,h=()=>(d&&(d=!1,u=o?gs(a):a),u),v;if(i){var _=ra in t||Ef in t;v=((re=_a(t,e))==null?void 0:re.set)??(_&&e in t?ae=>t[e]=ae:void 0)}var S,w=!1;i?[S,w]=Vd(()=>t[e]):S=t[e],S===void 0&&a!==void 0&&(S=h(),v&&(Mf(),v(S)));var k;if(k=()=>{var ae=t[e];return ae===void 0?h():(d=!0,ae)},(r&Hf)===0)return k;if(v){var D=t.$$legacy;return(function(ae,H){return arguments.length>0?((!H||D||w)&&v(H?k():ae),ae):k()})}var E=!1,T=((r&Gf)!==0?di:jc)(()=>(E=!1,k()));i&&m(T);var U=ct;return(function(ae,H){if(arguments.length>0){const J=H?m(T):i?Kt(ae):ae;return L(T,J),E=!0,u!==void 0&&(u=J),ae}return jr&&E||(U.f&mr)!==0?T.v:m(T)})}function Wt(t){bn===null&&Cf(),ei(()=>{const e=gs(t);if(typeof e=="function")return e})}const Xd="5";var vc;typeof window<"u"&&((vc=window.__svelte??(window.__svelte={})).v??(vc.v=new Set)).add(Xd);const cs=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let ln=null,pr="idle",Xs=null,Wr=new Set;function Fs(){return ln||(ln=new Worker(new URL("/me-ai/assets/worker-CV-t6G85.js",import.meta.url),{type:"module"}),ln.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(pr="loading"),e.status==="ready"&&(pr="ready"),e.status==="start"&&(pr="generating"),(e.status==="complete"||e.status==="error")&&(pr=Xs?"ready":"idle");for(const r of Wr)try{r(e)}catch{}})),ln}function fu(){return{check(){Fs().postMessage({type:"check"})},loadModel(t){Xs=t,pr="loading",Fs().postMessage({type:"load",modelId:t})},generate(t,e){Fs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,h=0;const v=S=>{switch(S.status){case"start":h=S.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=S.output,u=S.tps??u,d=S.numTokens??d,r)try{r({tps:u,numTokens:d})}catch{}break;case"complete":_(),a({text:o,tps:u,numTokens:d,inputTokens:h});break;case"error":_(),i(new Error(S.data));break}},_=()=>{Wr.delete(v)};Wr.add(v),Fs().postMessage({type:"generate",data:t,options:e})})},interrupt(){ln==null||ln.postMessage({type:"interrupt"})},reset(){ln==null||ln.postMessage({type:"reset"})},onMessage(t){return Wr.add(t),()=>Wr.delete(t)},offMessage(t){Wr.delete(t)},get status(){return pr},get isReady(){return pr==="ready"},get isGenerating(){return pr==="generating"},get modelId(){return Xs},terminate(){ln==null||ln.terminate(),ln=null,pr="idle",Xs=null,Wr.clear()}}}var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qs={exports:{}},Jd=Qs.exports,zl;function $d(){return zl||(zl=1,(function(t,e){((r,a)=>{t.exports=a()})(Jd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,p=s.length;f<p;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qd,u=Object.keys,d=Array.isArray;function h(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var v=Object.getPrototypeOf,_={}.hasOwnProperty;function S(n,s){return _.call(n,s)}function w(n,s){typeof s=="function"&&(s=s(v(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){D(n,l,s[l])})}var k=Object.defineProperty;function D(n,s,l,c){k(n,s,h(l&&S(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function E(n){return{from:function(s){return n.prototype=Object.create(s.prototype),D(n.prototype,"constructor",n),{extend:w.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,U=[].slice;function re(n,s,l){return U.call(n,s,l)}function ae(n,s){return s(n)}function H(n){if(!n)throw new Error("Assertion Failed")}function J(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function ee(n,s){if(typeof s=="string"&&S(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var p=ee(n,s[c]);l.push(p)}return l}var g,b=s.indexOf(".");return b===-1||(g=n[s.substr(0,b)])==null?void 0:ee(g,s.substr(b+1))}function F(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){H(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)F(n,s[c],l[c])}else{var p,g,b=s.indexOf(".");b!==-1?(p=s.substr(0,b),(b=s.substr(b+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:F(g=(g=n[p])&&S(n,p)?g:n[p]={},b,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function fe(n){var s,l={};for(s in n)S(n,s)&&(l[s]=n[s]);return l}var Ae=[].concat;function Ie(n){return Ae.apply([],n)}var Y="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ie([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ce=new Set(Y.map(function(n){return o[n]})),$=null;function ie(n){return $=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=$.get(l);if(c)return c;if(d(l)){c=[],$.set(l,c);for(var f=0,p=l.length;f<p;++f)c.push(s(l[f]))}else if(ce.has(l.constructor))c=l;else{var g,b=v(l);for(g in c=b===Object.prototype?{}:Object.create(b),$.set(l,c),l)S(l,g)&&(c[g]=s(l[g]))}return c})(n),$=null,n}var Pe={}.toString;function oe(n){return Pe.call(n).slice(8,-1)}var ve=typeof Symbol<"u"?Symbol.iterator:"@@iterator",pe=typeof ve=="symbol"?function(n){var s;return n!=null&&(s=n[ve])&&s.apply(n)}:function(){return null};function X(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ue={};function ge(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ue&&typeof n=="string")return[n];if(f=pe(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var we=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ht=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),te={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(n,s){this.name=n,this.message=s}function se(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function be(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=se(n,s)}function he(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=se(n,this.failures)}E(W).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(be).from(W),E(he).from(W);var ze=ht.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ue=W,Q=ht.reduce(function(n,s){var l=s+"Error";function c(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=te[s]||l,this.inner=null)}return E(c).from(Ue),n[s]=c,n},{}),Ce=(Q.Syntax=SyntaxError,Q.Type=TypeError,Q.Range=RangeError,Y.reduce(function(n,s){return n[s+"Error"]=Q[s],n},{}));Y=ht.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=Q[s]),n},{});function je(){}function Fe(n){return n}function et(n,s){return n==null||n===Fe?s:function(l){return s(n(l))}}function tt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Ge(n,s){return n===je?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?tt(c,this.onsuccess):c),f&&(this.onerror=this.onerror?tt(f,this.onerror):f),p!==void 0?p:l}}function nt(n,s){return n===je?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?tt(l,this.onsuccess):l),c&&(this.onerror=this.onerror?tt(c,this.onerror):c)}}function ft(n,s){return n===je?s:function(f){var c=n.apply(this,arguments),f=(h(f,c),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?tt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?tt(p,this.onerror):p),c===void 0?g===void 0?void 0:g:h(c,g)}}function kt(n,s){return n===je?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function ut(n,s){return n===je?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(c,p)})}return s.apply(this,arguments)}}Y.ModifyError=be,Y.DexieError=W,Y.BulkError=he;var dt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Yt(n){dt=n}var pt={},jt=100,Rt=typeof Promise>"u"?[]:(ht=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Rt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(Rt),ht]:[ht,v(ht),ht]),ht=Rt[0],ga=Rt[1],ga=ga&&ga.then,xt=ht&&ht.constructor,vn=!!Rt[2],rn=function(n,s){ir.push([n,s]),an&&(queueMicrotask(wr),an=!1)},kn=!0,an=!0,pn=[],xn=[],Mn=Fe,Lt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:je,pgp:!1,env:{},finalize:je},Ne=Lt,ir=[],Ln=0,va=[];function Ee(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Ne;if(typeof n!="function"){if(n!==pt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&or(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var g=c._lib&&kr();p&&typeof p.then=="function"?l(c,function(b,P){p instanceof Ee?p._then(b,P):p.then(b,P)}):(c._state=!0,c._value=p,bs(c)),g&&lr()}},or.bind(null,c))}catch(p){or(c,p)}})(this,n)}var br={get:function(){var n=Ne,s=Br;function l(c,f){var p=this,g=!n.global&&(n!==Ne||s!==Br),b=g&&!qn(),P=new Ee(function(B,R){Ma(p,new _s(C(c,n,g,b),C(f,n,g,b),B,R,n))});return this._consoleTask&&(P._consoleTask=this._consoleTask),P}return l.prototype=pt,l},set:function(n){D(this,"then",n&&n.prototype===pt?br:{get:function(){return n},set:br.set})}};function _s(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function or(n,s){var l,c;xn.push(s),n._state===null&&(l=n._lib&&kr(),s=Mn(s),n._state=!1,n._value=s,c=n,pn.some(function(f){return f._value===c._value})||pn.push(c),bs(n),l)&&lr()}function bs(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)Ma(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),Ln===0&&(++Ln,rn(function(){--Ln==0&&Lr()},[]))}function Ma(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++Ln,rn(At,[l,n,s])}}function At(n,s,l){try{var c,f=s._value;!s._state&&xn.length&&(xn=[]),c=dt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||xn.indexOf(f)!==-1||(p=>{for(var g=pn.length;g;)if(pn[--g]._value===p._value)return pn.splice(g,1)})(s),l.resolve(c)}catch(p){l.reject(p)}finally{--Ln==0&&Lr(),--l.psd.ref||l.psd.finalize()}}function wr(){qe(Lt,function(){kr()&&lr()})}function kr(){var n=kn;return an=kn=!1,n}function lr(){var n,s,l;do for(;0<ir.length;)for(n=ir,ir=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<ir.length);an=kn=!0}function Lr(){for(var n=pn,s=(pn=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),va.slice(0)),l=s.length;l;)s[--l]()}function Nr(n){return new Ee(pt,!1,n)}function vt(n,s){var l=Ne;return function(){var c=kr(),f=Ne;try{return Bn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Bn(f,!1),c&&lr()}}}w(Ee.prototype,{then:br,_then:function(n,s){Ma(this,new _s(null,null,n,s,Ne))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:Nr)(c)}):this.then(null,function(c){return(c&&c.name===s?l:Nr)(c)}))},finally:function(n){return this.then(function(s){return Ee.resolve(n()).then(function(){return s})},function(s){return Ee.resolve(n()).then(function(){return Nr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ee(function(c,f){var p=setTimeout(function(){return f(new Q.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&D(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),Lt.env=ks(),w(Ee,{all:function(){var n=ge.apply(null,arguments).map(zr);return new Ee(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,p){return Ee.resolve(f).then(function(g){n[p]=g,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ee?n:n&&typeof n.then=="function"?new Ee(function(s,l){n.then(s,l)}):new Ee(pt,!0,n)},reject:Nr,race:function(){var n=ge.apply(null,arguments).map(zr);return new Ee(function(s,l){n.map(function(c){return Ee.resolve(c).then(s,l)})})},PSD:{get:function(){return Ne},set:function(n){return Ne=n}},totalEchoes:{get:function(){return Br}},newPSD:Nn,usePSD:qe,scheduler:{get:function(){return rn},set:function(n){rn=n}},rejectionMapper:{get:function(){return Mn},set:function(n){Mn=n}},follow:function(n,s){return new Ee(function(l,c){return Nn(function(f,p){var g=Ne;g.unhandleds=[],g.onunhandled=p,g.finalize=tt(function(){var b,P=this;b=function(){P.unhandleds.length===0?f():p(P.unhandleds[0])},va.push(function B(){b(),va.splice(va.indexOf(B),1)}),++Ln,rn(function(){--Ln==0&&Lr()},[])},g.finalize),n()},s,l,c)})}}),xt&&(xt.allSettled&&D(Ee,"allSettled",function(){var n=ge.apply(null,arguments).map(zr);return new Ee(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,p){return Ee.resolve(f).then(function(g){return c[p]={status:"fulfilled",value:g}},function(g){return c[p]={status:"rejected",reason:g}}).then(function(){return--l||s(c)})})})}),xt.any&&typeof AggregateError<"u"&&D(Ee,"any",function(){var n=ge.apply(null,arguments).map(zr);return new Ee(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(p,g){return Ee.resolve(p).then(function(b){return s(b)},function(b){f[g]=b,--c||l(new AggregateError(f))})})})}),xt.withResolvers)&&(Ee.withResolvers=xt.withResolvers);var Ot={awaits:0,echoes:0,id:0},Sn=0,Tn=[],qr=0,Br=0,La=0;function Nn(n,g,l,c){var f=Ne,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++La,Lt.env,p.env=vn?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},g&&h(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},qe(p,n,l,c));return p.ref===0&&p.finalize(),g}function Vt(){return Ot.id||(Ot.id=++Sn),++Ot.awaits,Ot.echoes+=jt,Ot.id}function qn(){return!!Ot.awaits&&(--Ot.awaits==0&&(Ot.id=0),Ot.echoes=Ot.awaits*jt,!0)}function zr(n){return Ot.echoes&&n&&n.constructor===xt?(Vt(),n.then(function(s){return qn(),s},function(s){return qn(),xe(s)})):n}function ws(){var n=Tn[Tn.length-1];Tn.pop(),Bn(n,!1)}function Bn(n,s){var l,c,f=Ne;(s?!Ot.echoes||qr++&&n===Ne:!qr||--qr&&n===Ne)||queueMicrotask(s?(function(p){++Br,Ot.echoes&&--Ot.echoes!=0||(Ot.echoes=Ot.awaits=Ot.id=0),Tn.push(Ne),Bn(p,!0)}).bind(null,n):ws),n!==Ne&&(Ne=n,f===Lt&&(Lt.env=ks()),vn)&&(l=Lt.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function ks(){var n=o.Promise;return vn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function qe(n,s,l,c,f){var p=Ne;try{return Bn(n,!0),s(l,c,f)}finally{Bn(p,!1)}}function C(n,s,l,c){return typeof n!="function"?n:function(){var f=Ne;l&&Vt(),Bn(s,!0);try{return n.apply(this,arguments)}finally{Bn(f,!1),c&&queueMicrotask(qn)}}}function _e(n){Promise===xt&&Ot.echoes===0?qr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ga).indexOf("[native code]")===-1&&(Vt=qn=je);var xe=Ee.reject,st="ï¿¿",mt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",St="String expected.",Ct=[],sn="__dbnames",Xn="readonly",Fr="readwrite";function wt(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Na={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Kr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=ie(s))[n],s}}function Zo(){throw Q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Je(n,s){try{var l=Jo(n),c=Jo(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=$o(n),p=$o(s),g=f.length,b=p.length,P=g<b?g:b,B=0;B<P;++B)if(f[B]!==p[B])return f[B]<p[B]?-1:1;return g===b?0:g<b?-1:1;case"Array":for(var R=n,A=s,j=R.length,M=A.length,O=j<M?j:M,I=0;I<O;++I){var K=Je(R[I],A[I]);if(K!==0)return K}return j===M?0:j<M?-1:1}}catch{}return NaN}function Jo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=oe(n))==="ArrayBuffer")?"binary":s}function $o(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function xs(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}el.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var qa=el;function el(n){this["@@propmod"]=n}function tl(n,s){for(var l=u(s),c=l.length,f=!1,p=0;p<c;++p){var g=l[p],b=s[g],P=ee(n,g);b instanceof qa?(F(n,g,b.execute(P)),f=!0):P!==b&&(F(n,g,b),f=!0)}return f}gt.prototype._trans=function(n,s,l){var c=this._tx||Ne.trans,f=this.name,p=dt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(B,R,A){if(A.schema[f])return s(A.idbtrans,A);throw new Q.NotFound("Table "+f+" not part of transaction")}var b=kr();try{var P=c&&c.db._novip===this.db._novip?c===Ne.trans?c._promise(n,g,l):Nn(function(){return c._promise(n,g,l)},{trans:c,transless:Ne.transless||Ne}):(function B(R,A,j,M){if(R.idbdb&&(R._state.openComplete||Ne.letThrough||R._vip)){var O=R._createTransaction(A,j,R._dbSchema);try{O.create(),R._state.PR1398_maxLoop=3}catch(I){return I.name===ze.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return B(R,A,j,M)})):xe(I)}return O._promise(A,function(I,K){return Nn(function(){return Ne.trans=O,M(I,K,O)})}).then(function(I){if(A==="readwrite")try{O.idbtrans.commit()}catch{}return A==="readonly"?I:O._completion.then(function(){return I})})}if(R._state.openComplete)return xe(new Q.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return xe(new Q.DatabaseClosed);R.open().catch(je)}return R._state.dbReadyPromise.then(function(){return B(R,A,j,M)})})(this.db,n,[this.name],g);return p&&(P._consoleTask=p,P=P.catch(function(B){return console.trace(B),xe(B)})),P}finally{b&&lr()}},gt.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?xe(new Q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},gt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(b){if(b.compound&&s.every(function(B){return 0<=b.keyPath.indexOf(B)})){for(var P=0;P<s.length;++P)if(s.indexOf(b.keyPath[P])===-1)return!1;return!0}return!1}).sort(function(b,P){return b.keyPath.length-P.keyPath.length})[0];if(l&&this.db._maxKey!==st)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(b){return n[b]}));!l&&dt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(b,P){return Je(b,P)===0}var g=s.reduce(function(R,P){var B=R[0],R=R[1],A=c[P],j=n[P];return[B||A,B||!A?wt(R,A&&A.multi?function(M){return M=ee(M,P),d(M)&&M.some(function(O){return f(j,O)})}:function(M){return f(j,ee(M,P))}):R]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},gt.prototype.filter=function(n){return this.toCollection().and(n)},gt.prototype.count=function(n){return this.toCollection().count(n)},gt.prototype.offset=function(n){return this.toCollection().offset(n)},gt.prototype.limit=function(n){return this.toCollection().limit(n)},gt.prototype.each=function(n){return this.toCollection().each(n)},gt.prototype.toArray=function(n){return this.toCollection().toArray(n)},gt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},gt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},gt.prototype.reverse=function(){return this.toCollection().reverse()},gt.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof Zo&&(n=(g=>{var b=R,P=g;if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");function B(){this.constructor=b}function R(){return g!==null&&g.apply(this,arguments)||this}return r(b,P),b.prototype=P===null?Object.create(P):(B.prototype=P.prototype,new B),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),f=n.prototype;f;f=v(f))Object.getOwnPropertyNames(f).forEach(function(g){return c.add(g)});function p(g){if(!g)return g;var b,P=Object.create(n.prototype);for(b in g)if(!c.has(b))try{P[b]=g[b]}catch{}return P}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},gt.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},gt.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,g=n;return p&&f&&(g=Kr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(b){return b.numFailures?Ee.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{F(n,p,b)}catch{}return b})},gt.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var g=p??{};return tl(g,s),c&&F(g,c,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(b){return b.numFailures?Ee.reject(b.failures[0]):!!p})})})},gt.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=ee(n,this.schema.primKey.keyPath))===void 0?xe(new Q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},gt.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,g=n;return p&&f&&(g=Kr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(b){return b.numFailures?Ee.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{F(n,p,b)}catch{}return b})},gt.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return xs(s,[n],c)}).then(function(c){return c.numFailures?Ee.reject(c.failures[0]):void 0})})},gt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Na}).then(function(l){return xs(n,null,l)})}).then(function(s){return s.numFailures?Ee.reject(s.failures[0]):void 0})},gt.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},gt.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var b=c.schema.primKey,B=b.auto,b=b.keyPath;if(b&&f)throw new Q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var P=n.length,B=b&&B?n.map(Kr(b)):n;return c.core.mutate({trans:g,type:"add",keys:f,values:B,wantResults:p}).then(function(R){var A=R.numFailures,j=R.failures;if(A===0)return p?R.results:R.lastResult;throw new he("".concat(c.name,".bulkAdd(): ").concat(A," of ").concat(P," operations failed"),j)})})},gt.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var b=c.schema.primKey,B=b.auto,b=b.keyPath;if(b&&f)throw new Q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var P=n.length,B=b&&B?n.map(Kr(b)):n;return c.core.mutate({trans:g,type:"put",keys:f,values:B,wantResults:p}).then(function(R){var A=R.numFailures,j=R.failures;if(A===0)return p?R.results:R.lastResult;throw new he("".concat(c.name,".bulkPut(): ").concat(A," of ").concat(P," operations failed"),j)})})},gt.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:c,cache:"clone"}).then(function(b){var P=[],B=[],R=(n.forEach(function(A,j){var M=A.key,O=A.changes,I=b[j];if(I){for(var K=0,G=Object.keys(O);K<G.length;K++){var q=G[K],ne=O[q];if(q===s.schema.primKey.keyPath){if(Je(ne,M)!==0)throw new Q.Constraint("Cannot update primary key in bulkUpdate()")}else F(I,q,ne)}p.push(j),P.push(M),B.push(I)}}),P.length);return l.mutate({trans:g,type:"put",keys:P,values:B,updates:{keys:c,changeSpecs:f}}).then(function(A){var j=A.numFailures,M=A.failures;if(j===0)return R;for(var O=0,I=Object.keys(M);O<I.length;O++){var K,G=I[O],q=p[Number(G)];q!=null&&(K=M[G],delete M[G],M[q]=K)}throw new he("".concat(s.name,".bulkUpdate(): ").concat(j," of ").concat(R," operations failed"),M)})})})},gt.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return xs(s,n,f)})}).then(function(c){var f=c.numFailures,p=c.failures;if(f===0)return c.lastResult;throw new he("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var nl=gt;function gt(){}function Ba(n){function s(g,b){if(b){for(var P=arguments.length,B=new Array(P-1);--P;)B[P-1]=arguments[P];return l[g].subscribe.apply(null,B),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=p;for(var c=1,f=arguments.length;c<f;++c)p(arguments[c]);return s;function p(g,b,P){var B,R;if(typeof g!="object")return b=b||kt,R={subscribers:[],fire:P=P||je,subscribe:function(A){R.subscribers.indexOf(A)===-1&&(R.subscribers.push(A),R.fire=b(R.fire,A))},unsubscribe:function(A){R.subscribers=R.subscribers.filter(function(j){return j!==A}),R.fire=R.subscribers.reduce(b,P)}},l[g]=s[g]=R;u(B=g).forEach(function(A){var j=B[A];if(d(j))p(A,B[A][0],B[A][1]);else{if(j!=="asap")throw new Q.InvalidArgument("Invalid event config");var M=p(A,Fe,function(){for(var O=arguments.length,I=new Array(O);O--;)I[O]=arguments[O];M.subscribers.forEach(function(K){J(function(){K.apply(null,I)})})})}})}}function za(n,s){return E(s).from({prototype:n}),s}function pa(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function mi(n,s){n.filter=wt(n.filter,s)}function gi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return wt(c(),s())}:s,n.justLimit=l&&!c}function Ss(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new Q.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function rl(n,s,l){var c=Ss(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function Ts(n,s,l,c){var f,p,g=n.replayFilter?wt(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(b,P,B){var R,A;g&&!g(P,B,function(j){return P.stop(j)},function(j){return P.fail(j)})||((A=""+(R=P.primaryKey))=="[object ArrayBuffer]"&&(A=""+new Uint8Array(R)),S(f,A))||(f[A]=!0,s(b,P,B))},Promise.all([n.or._iterate(p,l),al(rl(n,c,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):al(rl(n,c,l),wt(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function al(n,s,l,c){var f=vt(c?function(p,g,b){return l(c(p),g,b)}:l);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};s&&!s(p,function(b){return g=b},function(b){p.stop(b),g=je},function(b){p.fail(b),g=je})||f(p.value,p,function(b){return g=b}),g()})})}it.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,xe.bind(null,l.error)):l.table._trans("readonly",n).then(s)},it.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,xe.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},it.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=wt(s.algorithm,n)},it.prototype._iterate=function(n,s){return Ts(this._ctx,n,s,this._ctx.table.core)},it.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&h(l,n),s._ctx=l,s},it.prototype.raw=function(){return this._ctx.valueMapper=null,this},it.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Ts(s,n,l,s.table.core)})},it.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,p=f.table.core;return pa(f,!0)?p.count({trans:l,query:{index:Ss(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(c=0,Ts(f,function(){return++c,!1},l,p).then(function(){return c}))}).then(n)},it.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function p(P,B){return B?p(P[l[B]],B-1):P[c]}var g=this._ctx.dir==="next"?1:-1;function b(P,B){return Je(p(P,f),p(B,f))*g}return this.toArray(function(P){return P.sort(b)}).then(s)},it.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,p,g=s._ctx;return g.dir==="next"&&pa(g,!0)&&0<g.limit?(c=g.valueMapper,f=Ss(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(b){return b=b.result,c?b.map(c):b})):(p=[],Ts(g,function(b){return p.push(b)},l,g.table.core).then(function(){return p}))},n)},it.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,pa(s)?gi(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):gi(s,function(){var l=n;return function(){return--l<0}})),this},it.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),gi(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},it.prototype.until=function(n,s){return mi(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},it.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},it.prototype.last=function(n){return this.reverse().first(n)},it.prototype.filter=function(n){var s;return mi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=wt(s.isMatch,n),this},it.prototype.and=function(n){return this.filter(n)},it.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},it.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},it.prototype.desc=function(){return this.reverse()},it.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},it.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},it.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},it.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},it.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&pa(s,!0)&&0<s.limit)return this._read(function(c){var f=Ss(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},it.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},it.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},it.prototype.lastKey=function(n){return this.reverse().firstKey(n)},it.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},mi(this._ctx,function(c){var c=c.primaryKey.toString(),f=S(n,c);return n[c]=!0,!f})),this},it.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(I,K){var G=K.failures;j+=I-K.numFailures;for(var q=0,ne=u(G);q<ne.length;q++){var me=ne[q];A.push(G[me])}}var p=typeof n=="function"?n:function(I){return tl(I,n)},g=l.table.core,R=g.schema.primaryKey,b=R.outbound,P=R.extractKey,B=200,R=s.db._options.modifyChunkSize,A=(R&&(B=typeof R=="object"?R[g.name]||R["*"]||200:R),[]),j=0,M=[],O=n===sl;return s.clone().primaryKeys().then(function(I){function K(q){var ne=Math.min(B,I.length-q),me=I.slice(q,q+ne);return(O?Promise.resolve([]):g.getMany({trans:c,keys:me,cache:"immutable"})).then(function(Se){var Te=[],ye=[],Me=b?[]:null,Re=O?me:[];if(!O)for(var ke=0;ke<ne;++ke){var Le=Se[ke],rt={value:ie(Le),primKey:I[q+ke]};p.call(rt,rt.value,rt)!==!1&&(rt.value==null?Re.push(I[q+ke]):b||Je(P(Le),P(rt.value))===0?(ye.push(rt.value),b&&Me.push(I[q+ke])):(Re.push(I[q+ke]),Te.push(rt.value)))}return Promise.resolve(0<Te.length&&g.mutate({trans:c,type:"add",values:Te}).then(function(ot){for(var Ke in ot.failures)Re.splice(parseInt(Ke),1);f(Te.length,ot)})).then(function(){return(0<ye.length||G&&typeof n=="object")&&g.mutate({trans:c,type:"put",keys:Me,values:ye,criteria:G,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<q}).then(function(ot){return f(ye.length,ot)})}).then(function(){return(0<Re.length||G&&O)&&g.mutate({trans:c,type:"delete",keys:Re,criteria:G,isAdditionalChunk:0<q}).then(function(ot){return xs(l.table,Re,ot)}).then(function(ot){return f(Re.length,ot)})}).then(function(){return I.length>q+ne&&K(q+B)})})}var G=pa(l)&&l.limit===1/0&&(typeof n!="function"||O)&&{index:l.index,range:l.range};return K(0).then(function(){if(0<A.length)throw new be("Error modifying one or more objects",A,j,M);return I.length})})})},it.prototype.delete=function(){var n=this._ctx,s=n.range;return!pa(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(sl):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(P){var b=P.failures,P=P.numFailures;if(P)throw new be("Could not delete some values",Object.keys(b).map(function(B){return b[B]}),p-P);return p-P})})})};var Xu=it;function it(){}var sl=function(n,s){return s.value=null};function Qu(n,s){return n<s?-1:n===s?0:1}function Zu(n,s){return s<n?-1:n===s?0:1}function hn(n,s,l){return n=n instanceof ol?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function ha(n){return new n.Collection(n,function(){return il("")}).limit(0)}function Es(M,s,l,c){var f,p,g,b,P,B,R,A=l.length;if(!l.every(function(I){return typeof I=="string"}))return hn(M,St);function j(I){f=I==="next"?function(G){return G.toUpperCase()}:function(G){return G.toLowerCase()},p=I==="next"?function(G){return G.toLowerCase()}:function(G){return G.toUpperCase()},g=I==="next"?Qu:Zu;var K=l.map(function(G){return{lower:p(G),upper:f(G)}}).sort(function(G,q){return g(G.lower,q.lower)});b=K.map(function(G){return G.upper}),P=K.map(function(G){return G.lower}),R=(B=I)==="next"?"":c}j("next");var M=new M.Collection(M,function(){return xr(b[0],P[A-1]+c)}),O=(M._ondirectionchange=function(I){j(I)},0);return M._addAlgorithm(function(I,K,G){var q=I.key;if(typeof q=="string"){var ne=p(q);if(s(ne,P,O))return!0;for(var me=null,Se=O;Se<A;++Se){var Te=((ye,Me,Re,ke,Le,rt)=>{for(var ot=Math.min(ye.length,ke.length),Ke=-1,We=0;We<ot;++We){var Tt=Me[We];if(Tt!==ke[We])return Le(ye[We],Re[We])<0?ye.substr(0,We)+Re[We]+Re.substr(We+1):Le(ye[We],ke[We])<0?ye.substr(0,We)+ke[We]+Re.substr(We+1):0<=Ke?ye.substr(0,Ke)+Me[Ke]+Re.substr(Ke+1):null;Le(ye[We],Tt)<0&&(Ke=We)}return ot<ke.length&&rt==="next"?ye+Re.substr(ye.length):ot<ye.length&&rt==="prev"?ye.substr(0,Re.length):Ke<0?null:ye.substr(0,Ke)+ke[Ke]+Re.substr(Ke+1)})(q,ne,b[Se],P[Se],g,B);Te===null&&me===null?O=Se+1:(me===null||0<g(me,Te))&&(me=Te)}K(me!==null?function(){I.continue(me+R)}:G)}return!1}),M}function xr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function il(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Nt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Nt.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?ha(this):new this.Collection(this,function(){return xr(n,s,!l,!c)})}catch{return hn(this,mt)}},Nt.prototype.equals=function(n){return n==null?hn(this,mt):new this.Collection(this,function(){return il(n)})},Nt.prototype.above=function(n){return n==null?hn(this,mt):new this.Collection(this,function(){return xr(n,void 0,!0)})},Nt.prototype.aboveOrEqual=function(n){return n==null?hn(this,mt):new this.Collection(this,function(){return xr(n,void 0,!1)})},Nt.prototype.below=function(n){return n==null?hn(this,mt):new this.Collection(this,function(){return xr(void 0,n,!1,!0)})},Nt.prototype.belowOrEqual=function(n){return n==null?hn(this,mt):new this.Collection(this,function(){return xr(void 0,n)})},Nt.prototype.startsWith=function(n){return typeof n!="string"?hn(this,St):this.between(n,n+st,!0,!0)},Nt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Es(this,function(s,l){return s.indexOf(l[0])===0},[n],st)},Nt.prototype.equalsIgnoreCase=function(n){return Es(this,function(s,l){return s===l[0]},[n],"")},Nt.prototype.anyOfIgnoreCase=function(){var n=ge.apply(ue,arguments);return n.length===0?ha(this):Es(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Nt.prototype.startsWithAnyOfIgnoreCase=function(){var n=ge.apply(ue,arguments);return n.length===0?ha(this):Es(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,st)},Nt.prototype.anyOf=function(){var n,s,l=this,c=ge.apply(ue,arguments),f=this._cmp;try{c.sort(f)}catch{return hn(this,mt)}return c.length===0?ha(this):((n=new this.Collection(this,function(){return xr(c[0],c[c.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(p,g,b){for(var P=p.key;0<f(P,c[s]);)if(++s===c.length)return g(b),!1;return f(P,c[s])===0||(g(function(){p.continue(c[s])}),!1)}),n)},Nt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Nt.prototype.noneOf=function(){var n=ge.apply(ue,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return hn(this,mt)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Nt.prototype.inAnyRange=function(n,G){var l=this,c=this._cmp,f=this._ascending,p=this._descending,g=this._min,b=this._max;if(n.length===0)return ha(this);if(!n.every(function(q){return q[0]!==void 0&&q[1]!==void 0&&f(q[0],q[1])<=0}))return hn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Q.InvalidArgument);var P=!G||G.includeLowers!==!1,B=G&&G.includeUppers===!0,R,A=f;function j(q,ne){return A(q[0],ne[0])}try{(R=n.reduce(function(q,ne){for(var me=0,Se=q.length;me<Se;++me){var Te=q[me];if(c(ne[0],Te[1])<0&&0<c(ne[1],Te[0])){Te[0]=g(Te[0],ne[0]),Te[1]=b(Te[1],ne[1]);break}}return me===Se&&q.push(ne),q},[])).sort(j)}catch{return hn(this,mt)}var M=0,O=B?function(q){return 0<f(q,R[M][1])}:function(q){return 0<=f(q,R[M][1])},I=P?function(q){return 0<p(q,R[M][0])}:function(q){return 0<=p(q,R[M][0])},K=O,G=new this.Collection(this,function(){return xr(R[0][0],R[R.length-1][1],!P,!B)});return G._ondirectionchange=function(q){A=q==="next"?(K=O,f):(K=I,p),R.sort(j)},G._addAlgorithm(function(q,ne,me){for(var Se,Te=q.key;K(Te);)if(++M===R.length)return ne(me),!1;return!O(Se=Te)&&!I(Se)||(l._cmp(Te,R[M][1])===0||l._cmp(Te,R[M][0])===0||ne(function(){A===f?q.continue(R[M][0]):q.continue(R[M][1])}),!1)}),G},Nt.prototype.startsWithAnyOf=function(){var n=ge.apply(ue,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?ha(this):this.inAnyRange(n.map(function(s){return[s,s+st]})):hn(this,"startsWithAnyOf() only works with strings")};var ol=Nt;function Nt(){}function Qn(n){return vt(function(s){return Fa(s),n(s.target.error),!1})}function Fa(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Ka="storagemutated",yi="x-storagemutated-1",Sr=Ba(null,Ka),Ju=(Zn.prototype._lock=function(){return H(!Ne.global),++this._reculock,this._reculock!==1||Ne.global||(Ne.lockOwnerFor=this),this},Zn.prototype._unlock=function(){if(H(!Ne.global),--this._reculock==0)for(Ne.global||(Ne.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{qe(n[1],n[0])}catch{}}return this},Zn.prototype._locked=function(){return this._reculock&&Ne.lockOwnerFor!==this},Zn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(H(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new Q.DatabaseClosed(c);case"MissingAPIError":throw new Q.MissingAPI(c.message,c);default:throw new Q.OpenFailed(c)}if(!this.active)throw new Q.TransactionInactive;H(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=vt(function(f){Fa(f),s._reject(n.error)}),n.onabort=vt(function(f){Fa(f),s.active&&s._reject(new Q.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=vt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Sr.storagemutated.fire(n.mutatedParts)})}return this},Zn.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?xe(new Q.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ee(function(p,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,g)},Ne])}):l?Nn(function(){var p=new Ee(function(g,b){f._lock();var P=s(g,b,f);P&&P.then&&P.then(g,b)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((c=new Ee(function(p,g){var b=s(p,g,f);b&&b.then&&b.then(p,g)}))._lib=!0,c):xe(new Q.TransactionInactive)},Zn.prototype._root=function(){return this.parent?this.parent._root():this},Zn.prototype.waitFor=function(n){var s,l=this._root(),c=Ee.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ee(function(p,g){c.then(function(b){return l._waitingQueue.push(vt(p.bind(null,b)))},function(b){return l._waitingQueue.push(vt(g.bind(null,b)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Zn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Q.Abort))},Zn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(S(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new Q.NotFound("Table "+n+" not part of transaction")},Zn);function Zn(){}function _i(n,s,l,c,f,p,g,b){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:p,src:(l&&!g?"&":"")+(c?"*":"")+(f?"++":"")+ll(s),type:b}}function ll(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function bi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,p,g){return p=c(p,g),p&&(f[p[0]]=p[1]),f},{}))};var c}var Ua=function(n){try{return n.only([[]]),Ua=function(){return[[]]},[[]]}catch{return Ua=function(){return st},st}};function wi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return ee(l,s)}:function(l){return ee(l,n)};var s}function cl(n){return[].slice.call(n)}var $u=0;function Ga(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ef(n,s,P){function c(O){if(O.type===3)return null;if(O.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var A=O.lower,j=O.upper,M=O.lowerOpen,O=O.upperOpen;return A===void 0?j===void 0?null:s.upperBound(j,!!O):j===void 0?s.lowerBound(A,!!M):s.bound(A,j,!!M,!!O)}function f(R){var A,j=R.name;return{name:j,schema:R,mutate:function(M){var O=M.trans,I=M.type,K=M.keys,G=M.values,q=M.range;return new Promise(function(ne,me){ne=vt(ne);var Se=O.objectStore(j),Te=Se.keyPath==null,ye=I==="put"||I==="add";if(!ye&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var Me,Re=(K||G||{length:1}).length;if(K&&G&&K.length!==G.length)throw new Error("Given keys array must have same length as given values array.");if(Re===0)return ne({numFailures:0,failures:{},results:[],lastResult:void 0});function ke(Et){++ot,Fa(Et)}var Le=[],rt=[],ot=0;if(I==="deleteRange"){if(q.type===4)return ne({numFailures:ot,failures:rt,results:[],lastResult:void 0});q.type===3?Le.push(Me=Se.clear()):Le.push(Me=Se.delete(c(q)))}else{var Te=ye?Te?[G,K]:[G,null]:[K,null],Ke=Te[0],We=Te[1];if(ye)for(var Tt=0;Tt<Re;++Tt)Le.push(Me=We&&We[Tt]!==void 0?Se[I](Ke[Tt],We[Tt]):Se[I](Ke[Tt])),Me.onerror=ke;else for(Tt=0;Tt<Re;++Tt)Le.push(Me=Se[I](Ke[Tt])),Me.onerror=ke}function En(Et){Et=Et.target.result,Le.forEach(function(Hr,Bi){return Hr.error!=null&&(rt[Bi]=Hr.error)}),ne({numFailures:ot,failures:rt,results:I==="delete"?K:Le.map(function(Hr){return Hr.result}),lastResult:Et})}Me.onerror=function(Et){ke(Et),En(Et)},Me.onsuccess=En})},getMany:function(M){var O=M.trans,I=M.keys;return new Promise(function(K,G){K=vt(K);for(var q,ne=O.objectStore(j),me=I.length,Se=new Array(me),Te=0,ye=0,Me=function(Le){Le=Le.target,Se[Le._pos]=Le.result,++ye===Te&&K(Se)},Re=Qn(G),ke=0;ke<me;++ke)I[ke]!=null&&((q=ne.get(I[ke]))._pos=ke,q.onsuccess=Me,q.onerror=Re,++Te);Te===0&&K(Se)})},get:function(M){var O=M.trans,I=M.key;return new Promise(function(K,G){K=vt(K);var q=O.objectStore(j).get(I);q.onsuccess=function(ne){return K(ne.target.result)},q.onerror=Qn(G)})},query:(A=b,function(M){return new Promise(function(O,I){O=vt(O);var K,G,q,ye=M.trans,ne=M.values,me=M.limit,Te=M.query,Se=me===1/0?void 0:me,Me=Te.index,Te=Te.range,ye=ye.objectStore(j),ye=Me.isPrimaryKey?ye:ye.index(Me.name),Me=c(Te);if(me===0)return O({result:[]});A?((Te=ne?ye.getAll(Me,Se):ye.getAllKeys(Me,Se)).onsuccess=function(Re){return O({result:Re.target.result})},Te.onerror=Qn(I)):(K=0,G=!ne&&"openKeyCursor"in ye?ye.openKeyCursor(Me):ye.openCursor(Me),q=[],G.onsuccess=function(Re){var ke=G.result;return!ke||(q.push(ne?ke.value:ke.primaryKey),++K===me)?O({result:q}):void ke.continue()},G.onerror=Qn(I))})}),openCursor:function(M){var O=M.trans,I=M.values,K=M.query,G=M.reverse,q=M.unique;return new Promise(function(ne,me){ne=vt(ne);var ye=K.index,Se=K.range,Te=O.objectStore(j),Te=ye.isPrimaryKey?Te:Te.index(ye.name),ye=G?q?"prevunique":"prev":q?"nextunique":"next",Me=!I&&"openKeyCursor"in Te?Te.openKeyCursor(c(Se),ye):Te.openCursor(c(Se),ye);Me.onerror=Qn(me),Me.onsuccess=vt(function(Re){var ke,Le,rt,ot,Ke=Me.result;Ke?(Ke.___id=++$u,Ke.done=!1,ke=Ke.continue.bind(Ke),Le=(Le=Ke.continuePrimaryKey)&&Le.bind(Ke),rt=Ke.advance.bind(Ke),ot=function(){throw new Error("Cursor not stopped")},Ke.trans=O,Ke.stop=Ke.continue=Ke.continuePrimaryKey=Ke.advance=function(){throw new Error("Cursor not started")},Ke.fail=vt(me),Ke.next=function(){var We=this,Tt=1;return this.start(function(){return Tt--?We.continue():We.stop()}).then(function(){return We})},Ke.start=function(We){function Tt(){if(Me.result)try{We()}catch(Et){Ke.fail(Et)}else Ke.done=!0,Ke.start=function(){throw new Error("Cursor behind last entry")},Ke.stop()}var En=new Promise(function(Et,Hr){Et=vt(Et),Me.onerror=Qn(Hr),Ke.fail=Hr,Ke.stop=function(Bi){Ke.stop=Ke.continue=Ke.continuePrimaryKey=Ke.advance=ot,Et(Bi)}});return Me.onsuccess=vt(function(Et){Me.onsuccess=Tt,Tt()}),Ke.continue=ke,Ke.continuePrimaryKey=Le,Ke.advance=rt,Tt(),En},ne(Ke)):ne(null)},me)})},count:function(M){var O=M.query,I=M.trans,K=O.index,G=O.range;return new Promise(function(q,ne){var me=I.objectStore(j),me=K.isPrimaryKey?me:me.index(K.name),Se=c(G),Se=Se?me.count(Se):me.count();Se.onsuccess=vt(function(Te){return q(Te.target.result)}),Se.onerror=Qn(ne)})}}}p=P,g=cl((P=n).objectStoreNames);var p,P={schema:{name:P.name,tables:g.map(function(R){return p.objectStore(R)}).map(function(R){var A=R.keyPath,j=R.autoIncrement,O=d(A),M={},O={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:A==null,compound:O,keyPath:A,autoIncrement:j,unique:!0,extractKey:wi(A)},indexes:cl(R.indexNames).map(function(I){return R.index(I)}).map(function(q){var ne=q.name,K=q.unique,G=q.multiEntry,q=q.keyPath,ne={name:ne,compound:d(q),keyPath:q,unique:K,multiEntry:G,extractKey:wi(q)};return M[Ga(q)]=ne}),getIndexByKeyPath:function(I){return M[Ga(I)]}};return M[":id"]=O.primaryKey,A!=null&&(M[Ga(A)]=O.primaryKey),O})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=P.schema,b=P.hasGetAll,P=g.tables.map(f),B={};return P.forEach(function(R){return B[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(B[R])return B[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ua(s),schema:g}}function tf(n,s,l,c){return l=l.IDBKeyRange,s=ef(s,l,c),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function As(n,s){var l=s.db,l=tf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(p){return p.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function Cs(n,s,l,c){l.forEach(function(f){var p=c[f];s.forEach(function(g){var b=(function P(B,R){return T(B,R)||(B=v(B))&&P(B,R)})(g,f);(!b||"value"in b&&b.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?D(g,f,{get:function(){return this.table(f)},set:function(P){k(this,f,{value:P,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function ki(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function nf(n,s){return n._cfg.version-s._cfg.version}function rf(n,s,l,c){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=bi("$meta",fl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(l),p._completion.catch(c),p._reject.bind(p)),b=Ne.transless||Ne;Nn(function(){if(Ne.trans=p,Ne.transless=b,s!==0)return As(n,l),B=s,((P=p).storeNames.includes("$meta")?P.table("$meta").get("version").then(function(R){return R??B}):Ee.resolve(B)).then(function(K){var A=n,j=K,M=p,O=l,I=[],K=A._versions,G=A._dbSchema=Ps(0,A.idbdb,O);return(K=K.filter(function(q){return q._cfg.version>=j})).length===0?Ee.resolve():(K.forEach(function(q){I.push(function(){var ne,me,Se,Te=G,ye=q._cfg.dbschema,Me=(Rs(A,Te,O),Rs(A,ye,O),G=A._dbSchema=ye,xi(Te,ye)),Re=(Me.add.forEach(function(ke){Si(O,ke[0],ke[1].primKey,ke[1].indexes)}),Me.change.forEach(function(ke){if(ke.recreate)throw new Q.Upgrade("Not yet support for changing primary key");var Le=O.objectStore(ke.name);ke.add.forEach(function(rt){return Is(Le,rt)}),ke.change.forEach(function(rt){Le.deleteIndex(rt.name),Is(Le,rt)}),ke.del.forEach(function(rt){return Le.deleteIndex(rt)})}),q._cfg.contentUpgrade);if(Re&&q._cfg.version>j)return As(A,O),M._memoizedTables={},ne=fe(ye),Me.del.forEach(function(ke){ne[ke]=Te[ke]}),ki(A,[A.Transaction.prototype]),Cs(A,[A.Transaction.prototype],u(ne),ne),M.schema=ne,(me=we(Re))&&Vt(),ye=Ee.follow(function(){var ke;(Se=Re(M))&&me&&(ke=qn.bind(null,null),Se.then(ke,ke))}),Se&&typeof Se.then=="function"?Ee.resolve(Se):ye.then(function(){return Se})}),I.push(function(ne){var me,Se,Te=q._cfg.dbschema;me=Te,Se=ne,[].slice.call(Se.db.objectStoreNames).forEach(function(ye){return me[ye]==null&&Se.db.deleteObjectStore(ye)}),ki(A,[A.Transaction.prototype]),Cs(A,[A.Transaction.prototype],A._storeNames,A._dbSchema),M.schema=A._dbSchema}),I.push(function(ne){A.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(A.idbdb.version/10)===q._cfg.version?(A.idbdb.deleteObjectStore("$meta"),delete A._dbSchema.$meta,A._storeNames=A._storeNames.filter(function(me){return me!=="$meta"})):ne.objectStore("$meta").put(q._cfg.version,"version"))})}),(function q(){return I.length?Ee.resolve(I.shift()(M.idbtrans)).then(q):Ee.resolve()})().then(function(){ul(G,O)}))}).catch(g);var P,B;u(f).forEach(function(R){Si(l,R,f[R].primKey,f[R].indexes)}),As(n,l),Ee.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function af(n,s){ul(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Ps(0,n.idbdb,s);Rs(n,n._dbSchema,s);for(var c=0,f=xi(l,n._dbSchema).change;c<f.length;c++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=s.objectStore(g.name);g.add.forEach(function(P){dt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(P.src)),Is(b,P)})})(f[c]);if(typeof p=="object")return p.value}}function xi(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var g={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,c.change.push(g);else{var b=f.idxByName,P=p.idxByName,B=void 0;for(B in b)P[B]||g.del.push(B);for(B in P){var R=b[B],A=P[B];R?R.src!==A.src&&g.change.push(A):g.add.push(A)}(0<g.del.length||0<g.add.length||0<g.change.length)&&c.change.push(g)}}else c.add.push([l,p])}return c}function Si(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(p){return Is(f,p)})}function ul(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(dt&&console.debug("Dexie: Creating missing table",l),Si(s,l,n[l].primKey,n[l].indexes))})}function Is(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ps(n,s,l){var c={};return re(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),g=_i(ll(B=p.keyPath),B||"",!0,!1,!!p.autoIncrement,B&&typeof B!="string",!0),b=[],P=0;P<p.indexNames.length;++P){var R=p.index(p.indexNames[P]),B=R.keyPath,R=_i(R.name,B,!!R.unique,!!R.multiEntry,!1,B&&typeof B!="string",!1);b.push(R)}c[f]=bi(f,g,b)}),c}function Rs(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var p=c[f],g=l.objectStore(p);n._hasGetAll="getAll"in g;for(var b=0;b<g.indexNames.length;++b){var P,B=g.indexNames[b],R=g.index(B).keyPath,R=typeof R=="string"?R:"["+re(R).join("+")+"]";s[p]&&(P=s[p].idxByName[R])&&(P.name=B,delete s[p].idxByName[R],s[p].idxByName[B]=P)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function fl(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return _i(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,c)})}ma.prototype._createTableSchema=bi,ma.prototype._parseIndexSyntax=fl,ma.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),p=f.shift();if(!p)throw new Q.Schema("Invalid schema for table "+c+": "+n[c]);if(p.unique=!0,p.multi)throw new Q.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new Q.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new Q.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(c,p,f),s[c]=p}})},ma.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(p){h(c,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(c,f)}),s._dbSchema=f,ki(s,[s._allTables,s,s.Transaction.prototype]),Cs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},ma.prototype.upgrade=function(n){return this._cfg.contentUpgrade=ut(this._cfg.contentUpgrade||je,n),this};var sf=ma;function ma(){}function Ti(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new cr(sn,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ei(n){return n&&typeof n.databases=="function"}function Ai(n){return Nn(function(){return Ne.letThrough=!0,n()})}function Ci(n){return!("from"in n)}var Xt=function(n,s){var l;if(!this)return l=new Xt,n&&"d"in n&&h(l,n),l;h(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ha(n,s,l){var c=Je(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Ci(n))return h(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(Je(l,n.from)<0)return c?Ha(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},vl(n);if(0<Je(s,n.to))return f?Ha(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},vl(n);Je(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Je(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Wa(n,c),f&&s&&Wa(n,f)}}function Wa(n,s){Ci(s)||(function l(c,f){var p=f.from,g=f.l,b=f.r;Ha(c,p,f.to),g&&l(c,g),b&&l(c,b)})(n,s)}function dl(n,s){var l=Os(s),c=l.next();if(!c.done)for(var f=c.value,p=Os(n),g=p.next(f.from),b=g.value;!c.done&&!g.done;){if(Je(b.from,f.to)<=0&&0<=Je(b.to,f.from))return!0;Je(f.from,b.from)<0?f=(c=l.next(b.from)).value:b=(g=p.next(f.from)).value}return!1}function Os(n){var s=Ci(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&Je(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||Je(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function vl(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=pl(l)),n.d=pl(n)}function pl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Ds(n,s){return u(s).forEach(function(l){n[l]?Wa(n[l],s[l]):n[l]=(function c(f){var p,g,b={};for(p in f)S(f,p)&&(g=f[p],b[p]=!g||typeof g!="object"||ce.has(g.constructor)?g:c(g));return b})(s[l])}),n}function Ii(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&dl(s[l],n[l])})}w(Xt.prototype,((ht={add:function(n){return Wa(this,n),this},addKey:function(n){return Ha(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ha(s,l,l)}),this},hasKey:function(n){var s=Os(this).next(n).value;return s&&Je(s.from,n)<=0&&0<=Je(s.to,n)}})[ve]=function(){return Os(this)},ht));var Ur={},Pi={},Ri=!1;function js(n){Ds(Pi,n),Ri||(Ri=!0,setTimeout(function(){Ri=!1,Oi(Pi,!(Pi={}))},0))}function Oi(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values(Ur);c<f.length;c++)hl(b=f[c],n,l,s);else for(var p in n){var g,b,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],b=Ur["idb://".concat(g,"/").concat(p)])&&hl(b,n,l,s)}l.forEach(function(P){return P()})}function hl(n,s,l,c){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var b=g[p],P=b[0],B=[],R=0,A=b[1];R<A.length;R++){var j=A[R];Ii(s,j.obsSet)?j.subscribers.forEach(function(K){return l.add(K)}):c&&B.push(j)}c&&f.push([P,B])}if(c)for(var M=0,O=f;M<O.length;M++){var I=O[M],P=I[0],B=I[1];n.queries.query[P]=B}}function of(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?xe(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(s.openCanceller!==c)throw new Q.DatabaseClosed("db.open() was cancelled")}function b(){return new Ee(function(j,M){if(g(),!l)throw new Q.MissingAPI;var O=n.name,I=s.autoSchema||!f?l.open(O):l.open(O,f);if(!I)throw new Q.MissingAPI;I.onerror=Qn(M),I.onblocked=vt(n._fireOnBlocked),I.onupgradeneeded=vt(function(K){var G;R=I.transaction,s.autoSchema&&!n._options.allowEmptyDB?(I.onerror=Fa,R.abort(),I.result.close(),(G=l.deleteDatabase(O)).onsuccess=G.onerror=vt(function(){M(new Q.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(R.onerror=Qn(M),G=K.oldVersion>Math.pow(2,62)?0:K.oldVersion,A=G<1,n.idbdb=I.result,p&&af(n,R),rf(n,G/10,R,M))},M),I.onsuccess=vt(function(){R=null;var K,G,q,ne,me,Se,Te=n.idbdb=I.result,ye=re(Te.objectStoreNames);if(0<ye.length)try{var Me=Te.transaction((me=ye).length===1?me[0]:me,"readonly");if(s.autoSchema)Se=Te,ne=Me,(q=n).verno=Se.version/10,ne=q._dbSchema=Ps(0,Se,ne),q._storeNames=re(Se.objectStoreNames,0),Cs(q,[q._allTables],u(ne),ne);else if(Rs(n,n._dbSchema,Me),G=Me,((G=xi(Ps(0,(K=n).idbdb,G),K._dbSchema)).add.length||G.change.some(function(Re){return Re.add.length||Re.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Te.close(),f=Te.version+1,p=!0,j(b());As(n,Me)}catch{}Ct.push(n),Te.onversionchange=vt(function(Re){s.vcFired=!0,n.on("versionchange").fire(Re)}),Te.onclose=vt(function(){n.close({disableAutoOpen:!1})}),A&&(ye=n._deps,me=O,Ei(Se=ye.indexedDB)||me===sn||Ti(Se,ye.IDBKeyRange).put({name:me}).catch(je)),j()},M)}).catch(function(j){switch(j==null?void 0:j.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(0<f)return f=0,b()}return Ee.reject(j)})}var P,B=s.dbReadyResolve,R=null,A=!1;return Ee.race([c,(typeof navigator>"u"?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(j){function M(){return indexedDB.databases().finally(j)}P=setInterval(M,100),M()}).finally(function(){return clearInterval(P)}):Promise.resolve()).then(b)]).then(function(){return g(),s.onReadyBeingFired=[],Ee.resolve(Ai(function(){return n.on.ready.fire(n.vip)})).then(function j(){var M;if(0<s.onReadyBeingFired.length)return M=s.onReadyBeingFired.reduce(ut,je),s.onReadyBeingFired=[],Ee.resolve(Ai(function(){return M(n.vip)})).then(j)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(j){s.dbOpenError=j;try{R&&R.abort()}catch{}return c===s.openCanceller&&n._close(),xe(j)}).finally(function(){s.openComplete=!0,B()}).then(function(){var j;return A&&(j={},n.tables.forEach(function(M){M.schema.indexes.forEach(function(O){O.name&&(j["idb://".concat(n.name,"/").concat(M.name,"/").concat(O.name)]=new Xt(-1/0,[[[]]]))}),j["idb://".concat(n.name,"/").concat(M.name,"/")]=j["idb://".concat(n.name,"/").concat(M.name,"/:dels")]=new Xt(-1/0,[[[]]])}),Sr(Ka).fire(j),Oi(j,!0)),n})}function Di(n){function s(p){return n.next(p)}var l=f(s),c=f(function(p){return n.throw(p)});function f(p){return function(b){var b=p(b),P=b.value;return b.done?P:P&&typeof P.then=="function"?P.then(l,c):d(P)?Promise.all(P).then(l,c):l(P)}}return f(s)()}function Ms(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var lf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},p=[];function g(j,M,O){var q=Ga(j),I=f[q]=f[q]||[],K=j==null?0:typeof j=="string"?1:j.length,G=0<M,q=a(a({},O),{name:G?"".concat(q,"(virtual-from:").concat(O.name,")"):O.name,lowLevelIndex:O,isVirtual:G,keyTail:M,keyLength:K,extractKey:wi(j),unique:!G&&O.unique});return I.push(q),q.isPrimaryKey||p.push(q),1<K&&g(K===2?j[0]:j.slice(0,K-1),M+1,O),I.sort(function(ne,me){return ne.keyTail-me.keyTail}),q}var b=g(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[b];for(var P=0,B=c.indexes;P<B.length;P++){var R=B[P];g(R.keyPath,0,R)}function A(j){var M,O=j.query.index;return O.isVirtual?a(a({},j),{query:{index:O.lowLevelIndex,range:(M=j.query.range,O=O.keyTail,{type:M.type===1?2:M.type,lower:Ms(M.lower,M.lowerOpen?n.MAX_KEY:n.MIN_KEY,O),lowerOpen:!0,upper:Ms(M.upper,M.upperOpen?n.MIN_KEY:n.MAX_KEY,O),upperOpen:!0})}}):j}return a(a({},l),{schema:a(a({},c),{primaryKey:b,indexes:p,getIndexByKeyPath:function(j){return(j=f[Ga(j)])&&j[0]}}),count:function(j){return l.count(A(j))},query:function(j){return l.query(A(j))},openCursor:function(j){var M=j.query.index,O=M.keyTail,I=M.keyLength;return M.isVirtual?l.openCursor(A(j)).then(function(G){return G&&K(G)}):l.openCursor(j);function K(G){return Object.create(G,{continue:{value:function(q){q!=null?G.continue(Ms(q,j.reverse?n.MAX_KEY:n.MIN_KEY,O)):j.unique?G.continue(G.key.slice(0,I).concat(j.reverse?n.MIN_KEY:n.MAX_KEY,O)):G.continue()}},continuePrimaryKey:{value:function(q,ne){G.continuePrimaryKey(Ms(q,n.MAX_KEY,O),ne)}},primaryKey:{get:function(){return G.primaryKey}},key:{get:function(){var q=G.key;return I===1?q[0]:q.slice(0,I)}},value:{get:function(){return G.value}}})}}})}})}};function ji(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var p,g,b;S(s,f)?(p=n[f],g=s[f],typeof p=="object"&&typeof g=="object"&&p&&g?(b=oe(p))!==oe(g)?l[c+f]=s[f]:b==="Object"?ji(p,g,l,c+f+"."):p!==g&&(l[c+f]=s[f]):p!==g&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){S(n,f)||(l[c+f]=s[f])}),l}function Mi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var cf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=Ne.trans,g=p.table(s).hook,b=g.deleting,P=g.creating,B=g.updating;switch(f.type){case"add":if(P.fire===je)break;return p._promise("readwrite",function(){return R(f)},!0);case"put":if(P.fire===je&&B.fire===je)break;return p._promise("readwrite",function(){return R(f)},!0);case"delete":if(b.fire===je)break;return p._promise("readwrite",function(){return R(f)},!0);case"deleteRange":if(b.fire===je)break;return p._promise("readwrite",function(){return(function A(j,M,O){return l.query({trans:j,values:!1,query:{index:c,range:M},limit:O}).then(function(I){var K=I.result;return R({type:"delete",keys:K,trans:j}).then(function(G){return 0<G.numFailures?Promise.reject(G.failures[0]):K.length<O?{failures:[],numFailures:0,lastResult:void 0}:A(j,a(a({},M),{lower:K[K.length-1],lowerOpen:!0}),O)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function R(A){var j,M,O,I=Ne.trans,K=A.keys||Mi(c,A);if(K)return(A=A.type==="add"||A.type==="put"?a(a({},A),{keys:K}):a({},A)).type!=="delete"&&(A.values=i([],A.values)),A.keys&&(A.keys=i([],A.keys)),j=l,O=K,((M=A).type==="add"?Promise.resolve([]):j.getMany({trans:M.trans,keys:O,cache:"immutable"})).then(function(G){var q=K.map(function(ne,me){var Se,Te,ye,Me=G[me],Re={onerror:null,onsuccess:null};return A.type==="delete"?b.fire.call(Re,ne,Me,I):A.type==="add"||Me===void 0?(Se=P.fire.call(Re,ne,A.values[me],I),ne==null&&Se!=null&&(A.keys[me]=ne=Se,c.outbound||F(A.values[me],c.keyPath,ne))):(Se=ji(Me,A.values[me]),(Te=B.fire.call(Re,Se,ne,Me,I))&&(ye=A.values[me],Object.keys(Te).forEach(function(ke){S(ye,ke)?ye[ke]=Te[ke]:F(ye,ke,Te[ke])}))),Re});return l.mutate(A).then(function(ne){for(var me=ne.failures,Se=ne.results,Te=ne.numFailures,ne=ne.lastResult,ye=0;ye<K.length;++ye){var Me=(Se||K)[ye],Re=q[ye];Me==null?Re.onerror&&Re.onerror(me[ye]):Re.onsuccess&&Re.onsuccess(A.type==="put"&&G[ye]?A.values[ye]:Me)}return{failures:me,results:Se,numFailures:Te,lastResult:ne}}).catch(function(ne){return q.forEach(function(me){return me.onerror&&me.onerror(ne)}),Promise.reject(ne)})});throw new Error("Keys missing")}}})}})}};function ml(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)Je(s.keys[f],n[p])===0&&(c.push(l?ie(s.values[f]):s.values[f]),++p);return c.length===n.length?c:null}catch{return null}}var uf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=ml(c.keys,c.trans._cache,c.cache==="clone"))?Ee.resolve(f):l.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?ie(p):p},p}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function gl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function yl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ff={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Xt(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,p){if(Ne.subscr&&f!=="readonly")throw new Q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ne.querier));return n.transaction(c,f,p)},table:function(c){function f(K){var I,K=K.query;return[I=K.index,new Xt((I=(K=K.range).lower)!=null?I:n.MIN_KEY,(I=K.upper)!=null?I:n.MAX_KEY)]}var p=n.table(c),g=p.schema,b=g.primaryKey,P=g.indexes,B=b.extractKey,R=b.outbound,A=b.autoIncrement&&P.filter(function(O){return O.compound&&O.keyPath.includes(b.keyPath)}),j=a(a({},p),{mutate:function(O){function I(Le){return Le="idb://".concat(s,"/").concat(c,"/").concat(Le),me[Le]||(me[Le]=new Xt)}var K,G,q,ne=O.trans,me=O.mutatedParts||(O.mutatedParts={}),Se=I(""),Te=I(":dels"),ye=O.type,Re=O.type==="deleteRange"?[O.range]:O.type==="delete"?[O.keys]:O.values.length<50?[Mi(b,O).filter(function(Le){return Le}),O.values]:[],Me=Re[0],Re=Re[1],ke=O.trans._cache;return d(Me)?(Se.addKeys(Me),(ye=ye==="delete"||Me.length===Re.length?ml(Me,ke):null)||Te.addKeys(Me),(ye||Re)&&(K=I,G=ye,q=Re,g.indexes.forEach(function(Le){var rt=K(Le.name||"");function ot(We){return We!=null?Le.extractKey(We):null}function Ke(We){Le.multiEntry&&d(We)?We.forEach(function(Tt){return rt.addKey(Tt)}):rt.addKey(We)}(G||q).forEach(function(We,Et){var En=G&&ot(G[Et]),Et=q&&ot(q[Et]);Je(En,Et)!==0&&(En!=null&&Ke(En),Et!=null)&&Ke(Et)})}))):Me?(Re={from:(ke=Me.lower)!=null?ke:n.MIN_KEY,to:(ye=Me.upper)!=null?ye:n.MAX_KEY},Te.add(Re),Se.add(Re)):(Se.add(l),Te.add(l),g.indexes.forEach(function(Le){return I(Le.name).add(l)})),p.mutate(O).then(function(Le){return!Me||O.type!=="add"&&O.type!=="put"||(Se.addKeys(Le.results),A&&A.forEach(function(rt){for(var ot=O.values.map(function(En){return rt.extractKey(En)}),Ke=rt.keyPath.findIndex(function(En){return En===b.keyPath}),We=0,Tt=Le.results.length;We<Tt;++We)ot[We][Ke]=Le.results[We];I(rt.name).addKeys(ot)})),ne.mutatedParts=Ds(ne.mutatedParts||{},me),Le})}}),M={get:function(O){return[b,new Xt(O.key)]},getMany:function(O){return[b,new Xt().addKeys(O.keys)]},count:f,query:f,openCursor:f};return u(M).forEach(function(O){j[O]=function(I){var K=Ne.subscr,G=!!K,q=gl(Ne,p)&&yl(O,I)?I.obsSet={}:K;if(G){var ne,K=function(Re){return Re="idb://".concat(s,"/").concat(c,"/").concat(Re),q[Re]||(q[Re]=new Xt)},me=K(""),Se=K(":dels"),G=M[O](I),Te=G[0],G=G[1];if((O==="query"&&Te.isPrimaryKey&&!I.values?Se:K(Te.name||"")).add(G),!Te.isPrimaryKey){if(O!=="count")return ne=O==="query"&&R&&I.values&&p.query(a(a({},I),{values:!1})),p[O].apply(this,arguments).then(function(Re){if(O==="query"){if(R&&I.values)return ne.then(function(ot){return ot=ot.result,me.addKeys(ot),Re});var ke=I.values?Re.result.map(B):Re.result;(I.values?me:Se).addKeys(ke)}else{var Le,rt;if(O==="openCursor")return rt=I.values,(Le=Re)&&Object.create(Le,{key:{get:function(){return Se.addKey(Le.primaryKey),Le.key}},primaryKey:{get:function(){var ot=Le.primaryKey;return Se.addKey(ot),ot}},value:{get:function(){return rt&&me.addKey(Le.primaryKey),Le.value}}})}return Re});Se.add(l)}}return p[O].apply(this,arguments)}}),j}})}};function _l(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,p){return!(p in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,p){return!(p in l.failures)})),c)}function Li(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<Je(l,c.lower):0<=Je(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?Je(l,c.upper)<0:Je(l,c.upper)<=0));var l,c}function bl(n,s,l,c,f,p){var g,b,P,B,R,A;return!l||l.length===0||(g=s.query.index,b=g.multiEntry,P=s.query.range,B=c.schema.primaryKey.extractKey,R=g.extractKey,A=(g.lowLevelIndex||g).extractKey,(c=l.reduce(function(j,M){var O=j,I=[];if(M.type==="add"||M.type==="put")for(var K=new Xt,G=M.values.length-1;0<=G;--G){var q,ne=M.values[G],me=B(ne);!K.hasKey(me)&&(q=R(ne),b&&d(q)?q.some(function(Re){return Li(Re,P)}):Li(q,P))&&(K.addKey(me),I.push(ne))}switch(M.type){case"add":var Se=new Xt().addKeys(s.values?j.map(function(ke){return B(ke)}):j),O=j.concat(s.values?I.filter(function(ke){return ke=B(ke),!Se.hasKey(ke)&&(Se.addKey(ke),!0)}):I.map(function(ke){return B(ke)}).filter(function(ke){return!Se.hasKey(ke)&&(Se.addKey(ke),!0)}));break;case"put":var Te=new Xt().addKeys(M.values.map(function(ke){return B(ke)}));O=j.filter(function(ke){return!Te.hasKey(s.values?B(ke):ke)}).concat(s.values?I:I.map(function(ke){return B(ke)}));break;case"delete":var ye=new Xt().addKeys(M.keys);O=j.filter(function(ke){return!ye.hasKey(s.values?B(ke):ke)});break;case"deleteRange":var Me=M.range;O=j.filter(function(ke){return!Li(B(ke),Me)})}return O},n))===n)?n:(c.sort(function(j,M){return Je(A(j),A(M))||Je(B(j),B(M))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),p?Object.freeze(c):c)}function wl(n,s){return Je(n.lower,s.lower)===0&&Je(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function df(n,s){return((l,c,f,p)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=Je(l,c))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,p)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=Je(l,c))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function vf(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&X(p,f)},3e3))})}var pf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var p,g,b=n.transaction(l,c,f);return c==="readwrite"&&(f=(p=new AbortController).signal,b.addEventListener("abort",(g=function(P){return function(){if(p.abort(),c==="readwrite"){for(var B=new Set,R=0,A=l;R<A.length;R++){var j=A[R],M=Ur["idb://".concat(s,"/").concat(j)];if(M){var O=n.table(j),I=M.optimisticOps.filter(function(Le){return Le.trans===b});if(b._explicit&&P&&b.mutatedParts)for(var K=0,G=Object.values(M.queries.query);K<G.length;K++)for(var q=0,ne=(Te=G[K]).slice();q<ne.length;q++)Ii((ye=ne[q]).obsSet,b.mutatedParts)&&(X(Te,ye),ye.subscribers.forEach(function(Le){return B.add(Le)}));else if(0<I.length){M.optimisticOps=M.optimisticOps.filter(function(Le){return Le.trans!==b});for(var me=0,Se=Object.values(M.queries.query);me<Se.length;me++)for(var Te,ye,Me,Re=0,ke=(Te=Se[me]).slice();Re<ke.length;Re++)(ye=ke[Re]).res!=null&&b.mutatedParts&&(P&&!ye.dirty?(Me=Object.isFrozen(ye.res),Me=bl(ye.res,ye.req,I,O,ye,Me),ye.dirty?(X(Te,ye),ye.subscribers.forEach(function(Le){return B.add(Le)})):Me!==ye.res&&(ye.res=Me,ye.promise=Ee.resolve({result:Me}))):(ye.dirty&&X(Te,ye),ye.subscribers.forEach(function(Le){return B.add(Le)})))}}}B.forEach(function(Le){return Le()})}}})(!1),{signal:f}),b.addEventListener("error",g(!1),{signal:f}),b.addEventListener("complete",g(!0),{signal:f})),b},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(p){var g,b=Ne.trans;return!f.outbound&&b.db._options.cache!=="disabled"&&!b.explicit&&b.idbtrans.mode==="readwrite"&&(g=Ur["idb://".concat(s,"/").concat(l)])?(b=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Mi(f,p).some(function(P){return P==null}))?(g.optimisticOps.push(p),p.mutatedParts&&js(p.mutatedParts),b.then(function(P){0<P.numFailures&&(X(g.optimisticOps,p),(P=_l(0,p,P))&&g.optimisticOps.push(P),p.mutatedParts)&&js(p.mutatedParts)}),b.catch(function(){X(g.optimisticOps,p),p.mutatedParts&&js(p.mutatedParts)})):b.then(function(P){var B=_l(0,a(a({},p),{values:p.values.map(function(R,A){var j;return P.failures[A]?R:(F(j=(j=f.keyPath)!=null&&j.includes(".")?ie(R):a({},R),f.keyPath,P.results[A]),j)})}),P);g.optimisticOps.push(B),queueMicrotask(function(){return p.mutatedParts&&js(p.mutatedParts)})}),b):c.mutate(p)},query:function(p){var g,b,P,B,R,A,j;return gl(Ne,c)&&yl("query",p)?(g=((P=Ne.trans)==null?void 0:P.db._options.cache)==="immutable",b=(P=Ne).requery,P=P.signal,A=((M,O,I,K)=>{var G=Ur["idb://".concat(M,"/").concat(O)];if(!G)return[];if(!(M=G.queries[I]))return[null,!1,G,null];var q=M[(K.query?K.query.index.name:null)||""];if(!q)return[null,!1,G,null];switch(I){case"query":var ne=q.find(function(me){return me.req.limit===K.limit&&me.req.values===K.values&&wl(me.req.query.range,K.query.range)});return ne?[ne,!0,G,q]:[q.find(function(me){return("limit"in me.req?me.req.limit:1/0)>=K.limit&&(!K.values||me.req.values)&&df(me.req.query.range,K.query.range)}),!1,G,q];case"count":return ne=q.find(function(me){return wl(me.req.query.range,K.query.range)}),[ne,!!ne,G,q]}})(s,l,"query",p),j=A[0],B=A[2],R=A[3],j&&A[1]?j.obsSet=p.obsSet:(A=c.query(p).then(function(M){var O=M.result;if(j&&(j.res=O),g){for(var I=0,K=O.length;I<K;++I)Object.freeze(O[I]);Object.freeze(O)}else M.result=ie(O);return M}).catch(function(M){return R&&j&&X(R,j),Promise.reject(M)}),j={obsSet:p.obsSet,promise:A,subscribers:new Set,type:"query",req:p,dirty:!1},R?R.push(j):(R=[j],(B=B||(Ur["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=R)),vf(j,R,b,P),j.promise.then(function(M){return{result:bl(M.result,p,B==null?void 0:B.optimisticOps,c,j,g)}})):c.query(p)}})}})}};function Ls(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}It.prototype.version=function(n){if(isNaN(n)||n<.1)throw new Q.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new Q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(nf),l.stores({}),this._state.autoSchema=!1),l},It.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Ne.letThrough||this._vip)?n():new Ee(function(l,c){if(s._state.openComplete)return c(new Q.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new Q.DatabaseClosed);s.open().catch(je)}s._state.dbReadyPromise.then(l,c)}).then(n)},It.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:c??10,name:f}),p.sort(function(g,b){return g.level-b.level}),this},It.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},It.prototype.open=function(){var n=this;return qe(Lt,function(){return of(n)})},It.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=Ct.indexOf(this);if(0<=s&&Ct.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ee(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ee(function(l,c){n.cancelOpen=c}))},It.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new Q.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new Q.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},It.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ee(function(f,p){function g(){s.close(n);var b=s._deps.indexedDB.deleteDatabase(s.name);b.onsuccess=vt(function(){var P,B,R;P=s._deps,B=s.name,Ei(R=P.indexedDB)||B===sn||Ti(R,P.IDBKeyRange).delete(B).catch(je),f()}),b.onerror=Qn(p),b.onblocked=s._fireOnBlocked}if(l)throw new Q.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(g):g()})},It.prototype.backendDB=function(){return this.idbdb},It.prototype.isOpen=function(){return this.idbdb!==null},It.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},It.prototype.hasFailed=function(){return this._state.dbOpenError!==null},It.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(It.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),It.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new Q.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return c=p.pop(),[s,Ie(p),c]}).apply(this,arguments);return this._transaction.apply(this,n)},It.prototype._transaction=function(n,s,l){var c,f,p=this,g=Ne.trans,b=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(B){if(B=B instanceof p.Table?B.name:B,typeof B!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return B}),n=="r"||n===Xn)c=Xn;else{if(n!="rw"&&n!=Fr)throw new Q.InvalidArgument("Invalid transaction mode: "+n);c=Fr}if(g){if(g.mode===Xn&&c===Fr){if(!b)throw new Q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(B){if(g&&g.storeNames.indexOf(B)===-1){if(!b)throw new Q.SubTransaction("Table "+B+" not included in parent transaction.");g=null}}),b&&g&&!g.active&&(g=null)}}catch(B){return g?g._promise(null,function(R,A){A(B)}):xe(B)}var P=(function B(R,A,j,M,O){return Ee.resolve().then(function(){var q=Ne.transless||Ne,I=R._createTransaction(A,j,R._dbSchema,M),q=(I.explicit=!0,{trans:I,transless:q});if(M)I.idbtrans=M.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(ne){return ne.name===ze.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return B(R,A,j,null,O)})):xe(ne)}var K,G=we(O),q=(G&&Vt(),Ee.follow(function(){var ne;(K=O.call(I,I))&&(G?(ne=qn.bind(null,null),K.then(ne,ne)):typeof K.next=="function"&&typeof K.throw=="function"&&(K=Di(K)))},q));return(K&&typeof K.then=="function"?Ee.resolve(K).then(function(ne){return I.active?ne:xe(new Q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):q.then(function(){return K})).then(function(ne){return M&&I._resolve(),I._completion.then(function(){return ne})}).catch(function(ne){return I._reject(ne),xe(ne)})})}).bind(null,this,c,f,g,l);return g?g._promise(c,P,"lock"):Ne.trans?qe(Ne.transless,function(){return p._whenReady(P)}):this._whenReady(P)},It.prototype.table=function(n){if(S(this._allTables,n))return this._allTables[n];throw new Q.InvalidTable("Table ".concat(n," does not exist"))};var cr=It;function It(n,s){var l,c,f,p,g,b=this,P=(this._middlewares={},this.verno=0,It.dependencies),P=(this._options=s=a({addons:It.addons,autoOpen:!0,indexedDB:P.indexedDB,IDBKeyRange:P.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),B=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:je,dbReadyPromise:null,cancelOpen:je,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(B.dbReadyPromise=new Ee(function(A){B.dbReadyResolve=A}),B.openCanceller=new Ee(function(A,j){B.cancelOpen=j}),this._state=B,this.name=n,this.on=Ba(this,"populate","blocked","versionchange","close",{ready:[ut,je]}),this.once=function(A,j){var M=function(){for(var O=[],I=0;I<arguments.length;I++)O[I]=arguments[I];b.on(A).unsubscribe(M),j.apply(b,O)};return b.on(A,M)},this.on.ready.subscribe=ae(this.on.ready.subscribe,function(A){return function(j,M){It.vip(function(){var O,I=b._state;I.openComplete?(I.dbOpenError||Ee.resolve().then(j),M&&A(j)):I.onReadyBeingFired?(I.onReadyBeingFired.push(j),M&&A(j)):(A(j),O=b,M||A(function K(){O.on.ready.unsubscribe(j),O.on.ready.unsubscribe(K)}))})}}),this.Collection=(l=this,za(Xu.prototype,function(K,I){this.db=l;var M=Na,O=null;if(I)try{M=I()}catch(q){O=q}var I=K._ctx,K=I.table,G=K.hook.reading.fire;this._ctx={table:K,index:I.index,isPrimKey:!I.index||K.schema.primKey.keyPath&&I.index===K.schema.primKey.name,range:M,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:I.or,valueMapper:G!==Fe?G:null}})),this.Table=(c=this,za(nl.prototype,function(A,j,M){this.db=c,this._tx=M,this.name=A,this.schema=j,this.hook=c._allTables[A]?c._allTables[A].hook:Ba(null,{creating:[Ge,je],reading:[et,Fe],updating:[ft,je],deleting:[nt,je]})})),this.Transaction=(f=this,za(Ju.prototype,function(A,j,M,O,I){var K=this;A!=="readonly"&&j.forEach(function(G){G=(G=M[G])==null?void 0:G.yProps,G&&(j=j.concat(G.map(function(q){return q.updatesTable})))}),this.db=f,this.mode=A,this.storeNames=j,this.schema=M,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Ba(this,"complete","error","abort"),this.parent=I||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee(function(G,q){K._resolve=G,K._reject=q}),this._completion.then(function(){K.active=!1,K.on.complete.fire()},function(G){var q=K.active;return K.active=!1,K.on.error.fire(G),K.parent?K.parent._reject(G):q&&K.idbtrans&&K.idbtrans.abort(),xe(G)})})),this.Version=(p=this,za(sf.prototype,function(A){this.db=p,this._cfg={version:A,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,za(ol.prototype,function(A,j,M){if(this.db=g,this._ctx={table:A,index:j===":id"?null:j,or:M},this._cmp=this._ascending=Je,this._descending=function(O,I){return Je(I,O)},this._max=function(O,I){return 0<Je(O,I)?O:I},this._min=function(O,I){return Je(O,I)<0?O:I},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new Q.MissingAPI})),this.on("versionchange",function(A){0<A.newVersion?console.warn("Another connection wants to upgrade database '".concat(b.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(b.name,"'. Closing db now to resume the delete request.")),b.close({disableAutoOpen:!1})}),this.on("blocked",function(A){!A.newVersion||A.newVersion<A.oldVersion?console.warn("Dexie.delete('".concat(b.name,"') was blocked")):console.warn("Upgrade '".concat(b.name,"' blocked by other connection holding version ").concat(A.oldVersion/10))}),this._maxKey=Ua(s.IDBKeyRange),this._createTransaction=function(A,j,M,O){return new b.Transaction(A,j,M,b._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(A){b.on("blocked").fire(A),Ct.filter(function(j){return j.name===b.name&&j!==b&&!j._state.vcFired}).map(function(j){return j.on("versionchange").fire(A)})},this.use(uf),this.use(pf),this.use(ff),this.use(lf),this.use(cf),new Proxy(this,{get:function(A,j,M){var O;return j==="_vip"||(j==="table"?function(I){return Ls(b.table(I),R)}:(O=Reflect.get(A,j,M))instanceof nl?Ls(O,R):j==="tables"?O.map(function(I){return Ls(I,R)}):j==="_createTransaction"?function(){return Ls(O.apply(this,arguments),R)}:O)}}));this.vip=R,P.forEach(function(A){return A(b)})}var Ns,ga=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",hf=(Ni.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Ni.prototype[ga]=function(){return this},Ni);function Ni(n){this._subscribe=n}try{Ns={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ns={indexedDB:null,IDBKeyRange:null}}function kl(n){var s,l=!1,c=new hf(function(f){var p=we(n),g,b=!1,P={},B={},R={get closed(){return b},unsubscribe:function(){b||(b=!0,g&&g.abort(),A&&Sr.storagemutated.unsubscribe(M))}},A=(f.start&&f.start(R),!1),j=function(){return _e(O)},M=function(I){Ds(P,I),Ii(B,P)&&j()},O=function(){var I,K,G;!b&&Ns.indexedDB&&(P={},I={},g&&g.abort(),g=new AbortController,G=(q=>{var ne=kr();try{p&&Vt();var me=Nn(n,q);return me=p?me.finally(qn):me}finally{ne&&lr()}})(K={subscr:I,signal:g.signal,requery:j,querier:n,trans:null}),Promise.resolve(G).then(function(q){l=!0,s=q,b||K.signal.aborted||(P={},(ne=>{for(var me in ne)if(S(ne,me))return;return 1})(B=I)||A||(Sr(Ka,M),A=!0),_e(function(){return!b&&f.next&&f.next(q)}))},function(q){l=!1,["DatabaseClosedError","AbortError"].includes(q==null?void 0:q.name)||b||_e(function(){b||f.error&&f.error(q)})}))};return setTimeout(j,0),R});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var Gr=cr;function qi(n){var s=Tr;try{Tr=!0,Sr.storagemutated.fire(n),Oi(n,!0)}finally{Tr=s}}w(Gr,a(a({},Y),{delete:function(n){return new Gr(n,{addons:[]}).delete()},exists:function(n){return new Gr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Gr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ei(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==sn})}):Ti(l,s).toCollection().primaryKeys()).then(n)}catch{return xe(new Q.MissingAPI)}var s,l},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return Ne.trans?qe(Ne.transless,n):n()},vip:Ai,async:function(n){return function(){try{var s=Di(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ee.resolve(s)}catch(l){return xe(l)}}},spawn:function(n,s,l){try{var c=Di(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ee.resolve(c)}catch(f){return xe(f)}},currentTransaction:{get:function(){return Ne.trans||null}},waitFor:function(n,s){return n=Ee.resolve(typeof n=="function"?Gr.ignoreTransaction(n):n).timeout(s||6e4),Ne.trans?Ne.trans.waitFor(n):n},Promise:Ee,debug:{get:function(){return dt},set:function(n){Yt(n)}},derive:E,extend:h,props:w,override:ae,Events:Ba,on:Sr,liveQuery:kl,extendObservabilitySet:Ds,getByKeyPath:ee,setByKeyPath:F,delByKeyPath:function(n,s){typeof s=="string"?F(n,s,void 0):"length"in s&&[].map.call(s,function(l){F(n,l,void 0)})},shallowClone:fe,deepClone:ie,getObjectDiff:ji,cmp:Je,asap:J,minKey:-1/0,addons:[],connections:Ct,errnames:ze,dependencies:Ns,cache:Ur,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Gr.maxKey=Ua(Gr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Sr(Ka,function(n){Tr||(n=new CustomEvent(yi,{detail:n}),Tr=!0,dispatchEvent(n),Tr=!1)}),addEventListener(yi,function(n){n=n.detail,Tr||qi(n)}));var ya,Tr=!1,xl=function(){};return typeof BroadcastChannel<"u"&&((xl=function(){(ya=new BroadcastChannel(yi)).onmessage=function(n){return n.data&&qi(n.data)}})(),typeof ya.unref=="function"&&ya.unref(),Sr(Ka,function(n){Tr||ya.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!cr.disableBfCache&&n.persisted){dt&&console.debug("Dexie: handling persisted pagehide"),ya!=null&&ya.close();for(var s=0,l=Ct;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!cr.disableBfCache&&n.persisted&&(dt&&console.debug("Dexie: handling persisted pageshow"),xl(),qi({all:new Xt(-1/0,[[]])}))})),Ee.rejectionMapper=function(n,s){return!n||n instanceof W||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Ce[n.name]?n:(s=new Ce[n.name](s||n.message,n),"stack"in n&&D(s,"stack",{get:function(){return this.inner.stack}}),s)},Yt(dt),a(cr,Object.freeze({__proto__:null,Dexie:cr,Entity:Zo,PropModification:qa,RangeSet:Xt,add:function(n){return new qa({add:n})},cmp:Je,default:cr,liveQuery:kl,mergeRanges:Wa,rangesOverlap:dl,remove:function(n){return new qa({remove:n})},replacePrefix:function(n,s){return new qa({replacePrefix:[n,s]})}}),{default:cr}),cr})})(Qs)),Qs.exports}var ev=$d();const uo=Zd(ev),Fl=Symbol.for("Dexie"),Zt=globalThis[Fl]||(globalThis[Fl]=uo);if(uo.semVer!==Zt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${uo.semVer} and ${Zt.semVer}`);const{liveQuery:Oy,mergeRanges:Dy,rangesOverlap:jy,RangeSet:My,cmp:Ly,Entity:Ny,PropModification:qy,replacePrefix:By,add:zy,remove:Fy,DexieYProvider:Ky}=Zt,Be=new Zt("me-ai-store");Be.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Be.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Be.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Be.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function du(t,e){return`${t}:${e}`}function fo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Wi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function tv(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function nv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function vu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const rv="https://gmail.googleapis.com/gmail/v1/users/me";class qo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function av(t){return{Authorization:`Bearer ${t}`}}async function vi(t,e){var a,i,o,u;const r=await fetch(`${rv}${e}`,{headers:av(t)});if(!r.ok){const d=await r.json().catch(()=>({})),h=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,v=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new qo(h,r.status,v)}return r.json()}function pu(t){return vi(t,"/profile")}function hu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),vi(t,`/messages?${i}`)}function mu(t,e,r="full"){return vi(t,`/messages/${e}?format=${r}`)}function sv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),vi(t,`/history?${i}`)}function Ar(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function is(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function iv(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return is(e.body.data);const r=e.parts||[],a=ni(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return is(a.body.data);const i=ni(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const h=is(i.body.data);return lv(h)}return"(no body)"}function ov(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return is(e.body.data);const r=e.parts||[],a=ni(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?is(a.body.data):null}function ni(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ni(r.parts,e);if(a)return a}}return null}function lv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Bo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function gu(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function yu(t){return gu(t).charAt(0).toUpperCase()}function cv(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function uv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function _u(t,e){return`${cv(t.date)}_${uv(t.subject)}.${e}`}function bu(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function fv(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await wu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function dv(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await wu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function vv(t=10){const e=await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(ku).join(`

---

`)}async function pv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Be.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,h,v,_,S;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(h=o.from)!=null&&h.toLowerCase().includes(r)&&(u+=2),(v=o.to)!=null&&v.toLowerCase().includes(r)&&(u+=2),(_=o.snippet)!=null&&_.toLowerCase().includes(r)&&(u+=1),(S=o.body)!=null&&S.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>ku(o)).join(`

---

`)}async function Kl(){const t=await Be.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=bu(t);return{groups:e,order:r,total:t.length}}async function hv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await Be.items.where("sourceType").equals("gmail").filter(d=>{var h,v,_,S;return((h=d.subject)==null?void 0:h.toLowerCase().includes(o))||((v=d.from)==null?void 0:v.toLowerCase().includes(o))||((_=d.to)==null?void 0:_.toLowerCase().includes(o))||((S=d.snippet)==null?void 0:S.toLowerCase().includes(o))}).toArray();return u.sort((d,h)=>(h.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await Be.items.where("sourceType").equals("gmail").count();return{items:await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function wu(){const t=await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).first(),e=await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).last();return{oldest:t,newest:e}}function ku(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=nv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function mv(){const t=await fv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function gv(t){const e=[],r=await dv();if(e.push(r),t){const a=await pv(t,5);e.push("","## Relevant Emails",a)}else{const a=await vv(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const yv=20,_v={maxTokens:512},ba=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function xu(t,{count:e=yv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).reverse().limit(e).toArray();else{const D=new Set(await Be.emailClassifications.toCollection().primaryKeys());u=0,o=[],await Be.items.where("[sourceType+date]").between(["gmail",Zt.minKey],["gmail",Zt.maxKey]).reverse().until(()=>o.length>=e).each(E=>{D.has(E.id)?u++:o.push(E)})}if(o.length===0){const D=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:D,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const d=Date.now(),h=performance.now();let v=0,_=0,S=0,w=0;for(let D=0;D<o.length&&!(i!=null&&i.aborted);D++){const E=o[D],T=Tu(E),U=[{role:"system",content:ba},{role:"user",content:T}];a({phase:"scanning",current:D+1,total:o.length,classified:v,errors:_,email:{subject:E.subject,from:E.from,date:E.date},prompt:{system:ba,user:T},systemPromptLength:ba.length,live:null,lastResult:null,totals:{outputTokens:S,inputTokens:w,elapsed:performance.now()-h}});const re=performance.now();try{const{text:ae,tps:H,numTokens:J,inputTokens:ee}=await t.generateFull(U,{maxTokens:512,enableThinking:!1},Ae=>{a({phase:"generating",current:D+1,total:o.length,classified:v,errors:_,email:{subject:E.subject,from:E.from,date:E.date},live:{tps:Ae.tps,numTokens:Ae.numTokens},totals:{outputTokens:S,inputTokens:w,elapsed:performance.now()-h}})});S+=J,w+=ee;const F=kv(ae),fe=performance.now()-re;F&&(await Be.emailClassifications.put({emailId:E.id,action:F.action,reason:F.reason,summary:F.summary,tags:F.tags,subject:E.subject||"(no subject)",from:E.from||"",date:E.date,scannedAt:d,status:"pending"}),v++,a({phase:"classified",current:D+1,total:o.length,classified:v,errors:_,email:{subject:E.subject,from:E.from,date:E.date},result:F,emailStats:{tps:H,numTokens:J,inputTokens:ee,elapsed:fe},totals:{outputTokens:S,inputTokens:w,elapsed:performance.now()-h}}))}catch(ae){console.error(`Triage email ${D+1} failed:`,ae),_++}}const k=performance.now()-h;return a({phase:"done",classified:v,errors:_,totals:{outputTokens:S,inputTokens:w,elapsed:k}}),{scanned:o.length,classified:v,skipped:u,errors:_}}async function bv(){const t=await Be.emailClassifications.toArray();return bu(t)}async function wv(){const t=await Be.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ri(t,e){await Be.emailClassifications.update(t,{status:e})}async function Ul(){await Be.emailClassifications.clear()}async function zo(t){await Be.emailClassifications.where("action").equals(t).delete()}async function Su(t){await Be.emailClassifications.delete(t)}async function vo(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Tu(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function kv(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=xv(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let h=[];return Array.isArray(u.tags)&&(h=u.tags.filter(v=>typeof v=="string"&&v.trim()).map(v=>v.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:h}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function xv(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function po(t){return`hsl(${vu(t)}, 55%, 55%)`}function Sv(t){return`hsl(${vu(t)}, 40%, 35%)`}const Tv=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Gl(...t){Tv&&console.log("[debug]",...t)}function wn(t){return Gl(`[MOUNT] ${t}`),()=>Gl(`[DESTROY] ${t}`)}var Ev=z("<option> </option>"),Av=z('<p class="model-description svelte-1p89qnn"> </p>'),Cv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Iv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Pv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Rv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Ov=z('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Dv=z('<p class="error svelte-1p89qnn"> </p>'),jv=z('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Mv(t,e){_t(e,!0);let r=De(e,"selectedModel",15),a=De(e,"gpuInfo",3,null),i=De(e,"error",3,null);Wt(()=>wn("ModelSelector"));var o=jv(),u=x(y(o),2),d=x(y(u),2);en(d,21,()=>cs,sr,(E,T)=>{var U=Ev(),re=y(U),ae={};le(()=>{V(re,`${m(T).name??""} â ${m(T).size??""}`),ae!==(ae=m(T).id)&&(U.value=(U.__value=m(T).id)??"")}),N(E,U)});var h=x(d,2);{var v=E=>{const T=yt(()=>cs.find(H=>H.id===r()));var U=Mr(),re=$e(U);{var ae=H=>{var J=Av(),ee=y(J);le(()=>V(ee,m(T).description)),N(H,J)};de(re,H=>{m(T)&&H(ae)})}N(E,U)};de(h,E=>{r()&&E(v)})}var _=x(u,2);{var S=E=>{var T=Ov(),U=x(y(T),2),re=y(U),ae=x(y(re)),H=y(ae),J=x(re,2),ee=x(y(J)),F=y(ee),fe=x(J,2);{var Ae=ve=>{var pe=Cv(),X=x(y(pe)),ue=y(X);le(()=>V(ue,a().device)),N(ve,pe)};de(fe,ve=>{a().device&&a().device!=="unknown"&&ve(Ae)})}var Ie=x(fe,2);{var ce=ve=>{var pe=Iv(),X=x(y(pe)),ue=y(X);le(()=>V(ue,a().description)),N(ve,pe)};de(Ie,ve=>{a().description&&a().description!=="unknown"&&ve(ce)})}var $=x(Ie,2);{var ie=ve=>{var pe=Pv(),X=x(y(pe)),ue=y(X);le(ge=>V(ue,ge),[()=>fo(a().limits.maxBufferSize)]),N(ve,pe)};de($,ve=>{var pe;(pe=a().limits)!=null&&pe.maxBufferSize&&ve(ie)})}var Pe=x($,2);{var oe=ve=>{var pe=Rv(),X=x(y(pe)),ue=y(X);le(()=>V(ue,`${a().features.length??""} supported`)),N(ve,pe)};de(Pe,ve=>{var pe;(pe=a().features)!=null&&pe.length&&ve(oe)})}le(()=>{V(H,a().vendor),V(F,a().architecture)}),N(E,T)};de(_,E=>{a()&&E(S)})}var w=x(_,2);{var k=E=>{var T=Dv(),U=y(T);le(()=>V(U,i())),N(E,T)};de(w,E=>{i()&&E(k)})}var D=x(w,2);D.__click=function(...E){var T;(T=e.onload)==null||T.apply(this,E)},le(()=>D.disabled=i()),Lo(d,r),N(t,o),bt()}Mt(["click"]);var Lv=z('<span class="progress-percent svelte-r5fnze"> </span>'),Nv=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),qv=z('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Bv=z('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),zv=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Fv=z('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Kv=z('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Uv(t,e){_t(e,!0);let r=De(e,"message",3,""),a=De(e,"items",19,()=>[]);Wt(()=>wn("LoadingProgress"));var i=Kv(),o=y(i),u=y(o),d=x(o,2);en(d,17,a,sr,(h,v)=>{const _=yt(()=>m(v).total?tv(m(v).loaded||0,m(v).total):null);var S=Fv(),w=y(S),k=y(w),D=y(k),E=x(k,2);{var T=H=>{var J=Lv(),ee=y(J);le(F=>V(ee,`${F??""}%`),[()=>m(_).toFixed(1)]),N(H,J)};de(E,H=>{m(_)!==null&&H(T)})}var U=x(w,2);{var re=H=>{var J=Nv(),ee=$e(J),F=y(ee),fe=x(ee,2),Ae=y(fe),Ie=y(Ae),ce=x(Ae,4),$=y(ce),ie=x(ce,2),Pe=y(ie);le((oe,ve,pe,X,ue)=>{dn(F,`width: ${oe??""}%`),V(Ie,ve),V($,pe),V(Pe,`(${X??""} / ${ue??""} B)`)},[()=>Math.max(m(v).progress??0,.5).toFixed(1),()=>Wi(m(v).loaded||0),()=>Wi(m(v).total),()=>(m(v).loaded||0).toLocaleString(),()=>m(v).total.toLocaleString()]),N(H,J)},ae=H=>{var J=zv(),ee=x($e(J),2),F=y(ee);{var fe=Ie=>{var ce=qv(),$=$e(ce),ie=y($),Pe=x($,2),oe=y(Pe);le((ve,pe)=>{V(ie,ve),V(oe,`(${pe??""} B)`)},[()=>Wi(m(v).loaded),()=>m(v).loaded.toLocaleString()]),N(Ie,ce)},Ae=Ie=>{var ce=Bv();N(Ie,ce)};de(F,Ie=>{m(v).loaded?Ie(fe):Ie(Ae,!1)})}N(H,J)};de(U,H=>{m(v).total?H(re):H(ae,!1)})}le(()=>{cu(k,"title",m(v).file),V(D,m(v).file)}),N(h,S)}),le(()=>V(u,r())),N(t,i),bt()}var Gv=z('<span class="thinking-tokens svelte-11gjw00"> </span>'),Hv=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Wv=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Yv=z('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Vv=z('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Xv=z('<span class="cursor svelte-11gjw00">|</span>'),Qv=z(" <!>",1),Zv=z('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Jv=z('<div class="content svelte-11gjw00"> </div>'),$v=z('<div><div class="role svelte-11gjw00"> </div> <!></div>');function ep(t,e){_t(e,!0);let r=De(e,"isLast",3,!1),a=De(e,"isRunning",3,!1),i=De(e,"generationPhase",3,null),o=De(e,"numTokens",3,null);Wt(()=>wn(`MessageBubble[${e.msg.role}]`));var u=$v(),d=y(u),h=y(d),v=x(d,2);{var _=w=>{var k=Zv(),D=$e(k);{var E=F=>{var fe=Hv(),Ae=x(y(fe),4);{var Ie=ce=>{var $=Gv(),ie=y($);le(()=>V(ie,`${o()??""} tokens`)),N(ce,$)};de(Ae,ce=>{o()&&ce(Ie)})}N(F,fe)},T=F=>{var fe=Wv();N(F,fe)};de(D,F=>{a()&&r()&&i()==="thinking"?F(E):a()&&r()&&i()==="preparing"&&F(T,1)})}var U=x(D,2);{var re=F=>{var fe=Yv(),Ae=y(fe),Ie=x(y(Ae),2),ce=y(Ie),$=x(Ae,2),ie=y($);le(Pe=>{V(ce,`${Pe??""} words`),V(ie,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),N(F,fe)};de(U,F=>{e.msg.thinking&&F(re)})}var ae=x(U,2),H=y(ae);{var J=F=>{var fe=Vv();N(F,fe)},ee=F=>{var fe=Qv(),Ae=$e(fe,!0),Ie=x(Ae);{var ce=$=>{var ie=Xv();N($,ie)};de(Ie,$=>{a()&&r()&&$(ce)})}le(()=>V(Ae,e.msg.content)),N(F,fe)};de(H,F=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?F(J):F(ee,!1)})}N(w,k)},S=w=>{var k=Jv(),D=y(k);le(()=>V(D,e.msg.content)),N(w,k)};de(v,w=>{e.msg.role==="assistant"?w(_):w(S,!1)})}le(()=>{Dt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),V(h,e.msg.role==="user"?"You":"AI")}),N(t,u),bt()}var tp=z('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),np=z('<span class="edate svelte-mt5nvh"> </span>'),rp=z('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),ap=z('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),sp=z('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),ip=z('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),op=z('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function lp(t,e){_t(e,!0);let r=De(e,"pendingData",3,null),a=Oe(null),i=Oe(null);function o(k){L(a,m(a)===k?null:k,!0),L(i,null)}function u(k){return k.split("_").map(D=>D.charAt(0)+D.slice(1).toLowerCase()).join(" ")}function d(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function h(k){if(!k)return"";const D=k.replace(/<.*>/,"").trim();return D.length>24?D.slice(0,22)+"â¦":D}var v={toggleGroup:o},_=Mr(),S=$e(_);{var w=k=>{var D=op(),E=y(D),T=y(E),U=x(E,2);en(U,20,()=>r().order,H=>H,(H,J)=>{const ee=yt(()=>r().groups[J]),F=yt(()=>po(J)),fe=yt(()=>m(a)===J);var Ae=tp();let Ie;Ae.__click=()=>o(J);let ce;var $=y(Ae);let ie;var Pe=x($),oe=x(Pe),ve=y(oe);le(pe=>{Ie=Dt(Ae,1,"chip svelte-mt5nvh",null,Ie,{active:m(fe)}),ce=dn(Ae,"",ce,{"--c":m(F)}),ie=dn($,"",ie,{background:m(F)}),V(Pe,` ${pe??""} `),V(ve,m(ee).length)},[()=>u(J)]),N(H,Ae)});var re=x(U,2);{var ae=H=>{const J=yt(()=>r().groups[m(a)]),ee=yt(()=>po(m(a)));var F=ip(),fe=y(F);let Ae;var Ie=y(fe);Ie.__click=()=>{L(a,null),L(i,null)};var ce=x(Ie,2),$=y(ce),ie=x(ce,2),Pe=y(ie),oe=x(fe,2);en(oe,21,()=>m(J),ge=>ge.emailId,(ge,we)=>{var Y=rp(),te=y(Y);te.__click=()=>{var Fe;return(Fe=e.onaskai)==null?void 0:Fe.call(e,`Tell me about the email "${m(we).subject}" from ${m(we).from}`)};var W=y(te),se=y(W),be=x(W,2),he=y(be),ze=x(he);{var Ue=Fe=>{var et=np(),tt=y(et);le(Ge=>V(tt,Ge),[()=>d(m(we).date)]),N(Fe,et)};de(ze,Fe=>{m(we).date&&Fe(Ue)})}var Q=x(te,2),Ce=y(Q);Ce.__click=()=>{var Fe;return(Fe=e.onmarkacted)==null?void 0:Fe.call(e,m(we).emailId)};var je=x(Ce,2);je.__click=()=>{var Fe;return(Fe=e.ondismiss)==null?void 0:Fe.call(e,m(we).emailId)},le(Fe=>{V(se,m(we).subject),V(he,Fe)},[()=>h(m(we).from)]),N(ge,Y)});var ve=x(oe,2),pe=y(ve);{var X=ge=>{var we=ap(),Y=$e(we);Y.__click=()=>m(J).forEach(W=>{var se;return(se=e.onmarkacted)==null?void 0:se.call(e,W.emailId)});var te=x(Y,2);te.__click=()=>L(i,m(a),!0),N(ge,we)},ue=ge=>{var we=sp(),Y=$e(we),te=y(Y),W=x(Y,2);W.__click=()=>L(i,null);var se=x(W,2);se.__click=()=>{var be;(be=e.oncleargroup)==null||be.call(e,m(a)),L(i,null),L(a,null)},le(()=>V(te,`Remove ${m(J).length??""}?`)),N(ge,we)};de(pe,ge=>{m(i)!==m(a)?ge(X):ge(ue,!1)})}le(ge=>{Ae=dn(fe,"",Ae,{"border-color":m(ee)}),V($,ge),V(Pe,m(J).length)},[()=>u(m(a))]),N(H,F)};de(re,H=>{m(a)&&r().groups[m(a)]&&H(ae)})}le(()=>V(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),N(k,D)};de(S,k=>{r()&&r().total>0&&k(w)})}return N(t,_),bt(v)}Mt(["click"]);var cp=z('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),up=z('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),fp=z('<div class="strip svelte-1ed7zw1"><!></div>');function dp(t,e){let r=De(e,"hasScanData",3,!1),a=De(e,"engineReady",3,!1),i=De(e,"isScanning",3,!1),o=yt(()=>a()&&!r()&&!i()),u=yt(()=>m(o)||i());var d=Mr(),h=$e(d);{var v=_=>{var S=fp(),w=y(S);{var k=E=>{var T=cp();N(E,T)},D=E=>{var T=up();T.__click=function(...U){var re;(re=e.onscan)==null||re.apply(this,U)},N(E,T)};de(w,E=>{i()?E(k):m(o)&&E(D,1)})}N(_,S)};de(h,_=>{m(u)&&_(v)})}N(t,d)}Mt(["click"]);var vp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),pp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),hp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),gp=z('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),yp=z('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),_p=z('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function bp(t,e){_t(e,!0),Wt(()=>wn("GpuPanel"));var r=_p(),a=y(r),i=x(y(a),2),o=x(y(i),2),u=y(o),d=x(i,2),h=x(y(d),2),v=y(h),_=x(d,2);{var S=H=>{var J=vp(),ee=x(y(J),2),F=y(ee);le(()=>V(F,e.gpuInfo.device)),N(H,J)};de(_,H=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&H(S)})}var w=x(_,2);{var k=H=>{var J=pp(),ee=x(y(J),2),F=y(ee);le(fe=>V(F,fe),[()=>fo(e.gpuInfo.limits.maxBufferSize)]),N(H,J)};de(w,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxBufferSize&&H(k)})}var D=x(w,2);{var E=H=>{var J=hp(),ee=x(y(J),2),F=y(ee);le(()=>V(F,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),N(H,J)};de(D,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeInvocationsPerWorkgroup&&H(E)})}var T=x(D,2);{var U=H=>{var J=mp(),ee=x(y(J),2),F=y(ee);le(fe=>V(F,fe),[()=>fo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),N(H,J)};de(T,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeWorkgroupStorageSize&&H(U)})}var re=x(T,2);{var ae=H=>{var J=yp(),ee=y(J),F=y(ee),fe=x(ee,2);en(fe,21,()=>e.gpuInfo.features,sr,(Ae,Ie)=>{var ce=gp(),$=y(ce);le(()=>V($,m(Ie))),N(Ae,ce)}),le(()=>V(F,`Features (${e.gpuInfo.features.length??""})`)),N(H,J)};de(re,H=>{var J;(J=e.gpuInfo.features)!=null&&J.length&&H(ae)})}le(()=>{V(u,e.gpuInfo.vendor),V(v,e.gpuInfo.architecture)}),N(t,r),bt()}var wp=z('<button class="gpu-badge svelte-1ktw27c"> </button>'),kp=z('<span class="stats svelte-1ktw27c"> </span>'),xp=z('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Sp=z('<span class="stats preparing svelte-1ktw27c"> </span>'),Tp=z('<span class="stats svelte-1ktw27c"> </span>'),Ep=z('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ap=z('<button class="btn svelte-1ktw27c">Stop</button>'),Cp=z('<button class="btn primary svelte-1ktw27c">Send</button>'),Ip=z('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Pp(t,e){_t(e,!0),Wt(()=>wn("ChatView"));let r=De(e,"messages",19,()=>[]),a=De(e,"pendingData",3,null),i=De(e,"hasScanData",3,!1),o=De(e,"engineReady",3,!1),u=De(e,"isScanning",3,!1),d=De(e,"isRunning",3,!1),h=De(e,"tps",3,null),v=De(e,"numTokens",3,null),_=De(e,"generationPhase",3,null),S=De(e,"gpuInfo",3,null),w=De(e,"chatContainer",15),k=Oe(""),D=Oe(!1);function E(W){W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),T())}function T(){const W=m(k).trim();!W||d()||(L(k,""),e.onsend(W))}function U(W){W&&!d()&&e.onsend(W)}var re=Ip(),ae=y(re),H=y(ae);{var J=W=>{var se=wp();se.__click=()=>L(D,!m(D));var be=y(se);le(()=>V(be,`WebGPU ${m(D)?"â²":"â¼"}`)),N(W,se)};de(H,W=>{S()&&W(J)})}var ee=x(H,2);{var F=W=>{var se=kp(),be=y(se);le((he,ze)=>V(be,`${v()??""} tokens in ${he??""}s
        (${ze??""} tok/s)`),[()=>(v()/h()).toFixed(1),()=>h().toFixed(1)]),N(W,se)},fe=W=>{var se=xp();N(W,se)},Ae=W=>{var se=Sp(),be=y(se);le(he=>V(be,`thinking... ${he??""}`),[()=>h()?`${h().toFixed(0)} tok/s`:""]),N(W,se)},Ie=W=>{var se=Tp(),be=y(se);le(he=>V(be,`${he??""} tok/s`),[()=>h().toFixed(1)]),N(W,se)};de(ee,W=>{h()&&!d()?W(F):d()&&_()==="preparing"?W(fe,1):d()&&_()==="thinking"?W(Ae,2):h()&&d()&&W(Ie,3)})}var ce=x(ee,4);ce.__click=function(...W){var se;(se=e.onreset)==null||se.apply(this,W)};var $=x(ae,2);{var ie=W=>{bp(W,{get gpuInfo(){return S()}})};de($,W=>{m(D)&&S()&&W(ie)})}var Pe=x($,2),oe=y(Pe);{var ve=W=>{var se=Ep();N(W,se)};de(oe,W=>{r().length===0&&!(a()&&a().total>0)&&W(ve)})}var pe=x(oe,2);en(pe,17,r,sr,(W,se,be)=>{var he=Mr(),ze=$e(he);{var Ue=Ce=>{lp(Ce,{get pendingData(){return m(se).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:U})},Q=Ce=>{{let je=yt(()=>be===r().length-1);ep(Ce,{get msg(){return m(se)},get isLast(){return m(je)},get isRunning(){return d()},get generationPhase(){return _()},get numTokens(){return v()}})}};de(ze,Ce=>{m(se).type==="dashboard"?Ce(Ue):Ce(Q,!1)})}N(W,he)}),uu(Pe,W=>w(W),()=>w());var X=x(Pe,2);dp(X,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var ue=x(X,2),ge=y(ue);ge.__keydown=E;var we=x(ge,2);{var Y=W=>{var se=Ap();se.__click=function(...be){var he;(he=e.onstop)==null||he.apply(this,be)},N(W,se)},te=W=>{var se=Cp();se.__click=T,le(be=>se.disabled=be,[()=>!m(k).trim()]),N(W,se)};de(we,W=>{d()?W(Y):W(te,!1)})}le(()=>{ce.disabled=d(),ge.disabled=d()}),No(ge,()=>m(k),W=>L(k,W)),N(t,re),bt()}Mt(["click","keydown"]);var Rp=z('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Op(t,e){_t(e,!0);const r=!!navigator.gpu,a=fu();let i=Oe(Kt(localStorage.getItem("selectedModel")||cs[0].id)),o=Oe(null),u=Oe(null),d=Oe(""),h=Oe(Kt([])),v=Oe(Kt([])),_=Oe(!1),S=Oe(null),w=Oe(null),k=Oe(null),D=Oe(null),E=Oe(null),T=Oe(null),U=Oe(!1),re=Oe(!1),ae=!1;Wt(()=>{a.check(),a.isReady&&H();const Y=a.onMessage(te=>{switch(te.status){case"webgpu-info":L(D,te.data,!0);break;case"loading":L(o,"loading"),L(d,te.data,!0);break;case"initiate":L(h,[...m(h),te],!0);break;case"progress":L(h,m(h).map(W=>W.file===te.file?{...W,...te}:W),!0);break;case"done":L(h,m(h).filter(W=>W.file!==te.file),!0);break;case"ready":L(o,"ready"),H();break;case"start":if(!m(_))break;L(E,te.phase||"preparing",!0),L(v,[...m(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!m(_))break;L(E,te.phase,!0);break;case"thinking":{if(!m(_))break;L(S,te.tps,!0),L(w,te.numTokens,!0);const W=m(v)[m(v).length-1];L(v,[...m(v).slice(0,-1),{...W,thinking:(W.thinking||"")+te.content}],!0),ce();break}case"thinking-done":{if(!m(_))break;L(S,te.tps,!0),L(w,te.numTokens,!0);const W=m(v)[m(v).length-1];L(v,[...m(v).slice(0,-1),{...W,thinking:te.content}],!0);break}case"update":{if(!m(_))break;L(S,te.tps,!0),L(w,te.numTokens,!0);const W=m(v)[m(v).length-1];L(v,[...m(v).slice(0,-1),{...W,content:W.content+te.output}],!0),ce();break}case"complete":if(!m(_))break;L(_,!1),L(E,null),J();break;case"error":if(!m(_))break;L(u,te.data,!0),L(_,!1),L(E,null);break}});return()=>Y()});async function H(){if(!(ae||m(v).length>0))try{const Y=await Kl();L(T,Y,!0),Y&&(ae=!0,L(v,[{role:"assistant",type:"dashboard",pendingData:Y}],!0),ce());const te=await vo();L(U,te.classified>0)}catch{}}async function J(){try{const Y=await Kl();L(T,Y,!0);const te=m(v).findIndex(se=>se.type==="dashboard");te!==-1&&(Y&&Y.total>0?L(v,m(v).map((se,be)=>be===te?{...se,pendingData:Y}:se),!0):L(v,m(v).filter((se,be)=>be!==te),!0));const W=await vo();L(U,W.classified>0)}catch{}}async function ee(Y){await ri(Y,"acted"),await J()}async function F(Y){await ri(Y,"dismissed"),await J()}async function fe(Y){await Su(Y),await J()}async function Ae(Y){await zo(Y),await J()}async function Ie(){if(!(m(re)||!a.isReady)){L(re,!0);try{await xu(a,{count:20}),await J(),m(T)&&!m(v).some(Y=>Y.type==="dashboard")&&(L(v,[{role:"assistant",type:"dashboard",pendingData:m(T)},...m(v)],!0),ce())}catch(Y){console.error("Scan failed:",Y)}finally{L(re,!1)}}}function ce(){au().then(()=>{m(k)&&(m(k).scrollTop=m(k).scrollHeight)})}function $(){L(o,"loading"),localStorage.setItem("selectedModel",m(i)),a.loadModel(m(i))}async function ie(Y){if(!Y||m(_))return;L(v,[...m(v),{role:"user",content:Y}],!0),L(S,null),L(_,!0);let te=[];try{const be=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Y)?await gv(Y):await mv();be&&(te=[{role:"system",content:be}])}catch{}const W=m(v).filter(se=>se.type!=="dashboard").map(se=>({role:se.role,content:se.content}));a.generate([...te,...W]),ce()}function Pe(){a.interrupt()}function oe(){a.reset(),L(v,[],!0),L(S,null),L(w,null),ae=!1,H()}var ve=Mr(),pe=$e(ve);{var X=Y=>{var te=Rp();N(Y,te)},ue=Y=>{Mv(Y,{get gpuInfo(){return m(D)},get error(){return m(u)},onload:$,get selectedModel(){return m(i)},set selectedModel(te){L(i,te,!0)}})},ge=Y=>{Uv(Y,{get message(){return m(d)},get items(){return m(h)}})},we=Y=>{Pp(Y,{get messages(){return m(v)},get pendingData(){return m(T)},get hasScanData(){return m(U)},get engineReady(){return a.isReady},get isScanning(){return m(re)},get isRunning(){return m(_)},get tps(){return m(S)},get numTokens(){return m(w)},get generationPhase(){return m(E)},get gpuInfo(){return m(D)},onsend:ie,onstop:Pe,onreset:oe,onmarkacted:ee,ondismiss:F,onremove:fe,oncleargroup:Ae,onscan:Ie,get chatContainer(){return m(k)},set chatContainer(te){L(k,te,!0)}})};de(pe,Y=>{r?m(o)===null?Y(ue,1):m(o)==="loading"?Y(ge,2):Y(we,!1):Y(X)})}N(t,ve),bt()}const Hl="https://accounts.google.com/gsi/client",Dp="https://www.googleapis.com/auth/gmail.readonly";let ho=null,Zs=null;function jp(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Hl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Hl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Wl(t){await jp(),ho=google.accounts.oauth2.initTokenClient({client_id:t,scope:Dp,callback:e=>{Zs&&(Zs(e),Zs=null)}})}function Mp(){return new Promise((t,e)=>{if(!ho){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Zs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},ho.requestAccessToken()})}function Lp(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Ut="gmail",Yl=8,Eu=50,Au=100;async function Np(t,{limit:e=Eu,onProgress:r=()=>{},signal:a}={}){var u;const i=await Be.syncState.get(Ut);if(i!=null&&i.historyId)try{return await Kp(t,i,r,a)}catch(d){if(d instanceof qo&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Be.syncState.delete(Ut);else throw d}return await zp(t,e===0?1/0:e,r,a)}async function qp(t,{limit:e=Eu,onProgress:r=()=>{},signal:a}={}){const i=await Be.syncState.get(Ut);return i!=null&&i.oldestPageToken?await Fp(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Bp(){const t=await Be.syncState.get(Ut);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Cu(){await Be.transaction("rw",[Be.items,Be.syncState],async()=>{await Be.items.where("sourceType").equals(Ut).delete(),await Be.syncState.delete(Ut)})}async function zp(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ca(a);const i=await pu(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){ca(a);const S=e-o.length,w=await hu(t,{maxResults:Math.min(Au,S),pageToken:u}),k=(w.messages||[]).map(D=>D.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=w.nextPageToken,!u||k.length===0)break}if(d=u||null,o.length===0)return await Be.syncState.put({sourceType:Ut,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:h,errors:v}=await Iu(t,o,r,a),_=await Be.items.where("sourceType").equals(Ut).count();return await Be.syncState.put({sourceType:Ut,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:_,oldestPageToken:d}),r({phase:"done",message:`Synced ${h} messages`,current:h,total:h}),{added:h,deleted:0,errors:v}}async function Fp(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ca(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){ca(i);const S=r-o.length,w=await hu(t,{maxResults:Math.min(Au,S),pageToken:u}),k=(w.messages||[]).map(D=>D.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=w.nextPageToken,!u||k.length===0)break}if(d=u||null,o.length===0)return await Be.syncState.update(Ut,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:h,errors:v}=await Iu(t,o,a,i),_=await Be.items.where("sourceType").equals(Ut).count();return await Be.syncState.update(Ut,{totalItems:_,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${h} more (more available)`:`Downloaded ${h} more (all synced)`,current:_,total:_}),{added:h,errors:v}}async function Kp(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ca(a);let i=0,o=0,u=0,d,h=e.historyId;do{ca(a);const _=await sv(t,{startHistoryId:e.historyId,pageToken:d});if(h=_.historyId||h,d=_.nextPageToken,!!_.history){for(const S of _.history){if(S.messagesAdded){const w=S.messagesAdded.map(D=>D.message.id),k=[...new Set(w.filter(D=>D))];if(k.length>0){const D=await Promise.allSettled(k.map(T=>mu(t,T))),E=[];for(const T of D)T.status==="fulfilled"?E.push(Pu(T.value)):u++;E.length>0&&(await Be.items.bulkPut(E),await Ru(E),i+=E.length)}}if(S.messagesDeleted){const w=S.messagesDeleted.map(k=>du(Ut,k.message.id)).filter(k=>k);w.length>0&&(await Be.items.bulkDelete(w),o+=w.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const v=await Be.items.where("sourceType").equals(Ut).count();return await Be.syncState.put({sourceType:Ut,historyId:h,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:v,total:v}),{added:i,deleted:o,errors:u}}async function Iu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=Yl){ca(a);const d=e.slice(u,u+Yl),h=await Promise.allSettled(d.map(_=>mu(t,_))),v=[];for(const _ of h)_.status==="fulfilled"?v.push(Pu(_.value)):o++;v.length>0&&(await Be.items.bulkPut(v),await Ru(v)),i+=v.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Pu(t){const e=Ar(t,"From"),r=Ar(t,"To"),a=Ar(t,"Cc"),i=Ar(t,"Subject")||"(no subject)",o=Ar(t,"Date"),u=Ar(t,"Message-ID"),d=Ar(t,"In-Reply-To"),h=Ar(t,"References");let v;try{v=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{v=Date.now()}return{id:du(Ut,t.id),sourceType:Ut,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:iv(t),htmlBody:ov(t),date:v,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:h,raw:t,syncedAt:Date.now()}}async function Ru(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Up(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Be.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await Be.contacts.update(o.id,u)}else await Be.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Up(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ca(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Gp=z(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Hp(t,e){_t(e,!0);let r=De(e,"clientIdInput",15);Wt(()=>wn("SetupGuide"));let a=Oe(null);async function i(W){try{await navigator.clipboard.writeText(W),L(a,W,!0),setTimeout(()=>{L(a,null)},1500)}catch{const se=document.createElement("input");se.value=W,document.body.appendChild(se),se.select(),document.execCommand("copy"),document.body.removeChild(se),L(a,W,!0),setTimeout(()=>{L(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var h=Gp(),v=y(h),_=x(y(v),4),S=x(y(_),6),w=x(y(S),2),k=x(y(w),2),D=x(y(k),2),E=y(D);E.__click=()=>i(o);var T=y(E);T.textContent="http://localhost:5173";var U=x(T,2),re=y(U),ae=x(E,2);ae.__click=()=>i(u);var H=y(ae);H.textContent="https://cypherkitty.github.io";var J=x(H,2),ee=y(J),F=x(k,2),fe=x(y(F),2),Ae=y(fe);Ae.__click=()=>i(o);var Ie=y(Ae);Ie.textContent="http://localhost:5173";var ce=x(Ie,2),$=y(ce),ie=x(Ae,2);ie.__click=()=>i(u);var Pe=y(ie);Pe.textContent="https://cypherkitty.github.io";var oe=x(Pe,2),ve=y(oe),pe=x(ie,2);pe.__click=()=>i(d);var X=y(pe);X.textContent="https://cypherkitty.github.io/me-ai/";var ue=x(X,2),ge=y(ue),we=x(_,2),Y=y(we);Y.__keydown=W=>W.key==="Enter"&&e.onsave();var te=x(Y,2);te.__click=function(...W){var se;(se=e.onsave)==null||se.apply(this,W)},le(W=>{V(re,m(a)===o?"â":"â§"),V(ee,m(a)===u?"â":"â§"),V($,m(a)===o?"â":"â§"),V(ve,m(a)===u?"â":"â§"),V(ge,m(a)===d?"â":"â§"),te.disabled=W},[()=>!r().trim()]),No(Y,r),N(t,h),bt()}Mt(["click","keydown"]);function Wp(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof qo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Yp=z('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Vp=z('<div class="error-card-title svelte-14buhqq"> </div>'),Xp=z('<p class="error-card-fix svelte-14buhqq"> </p>'),Qp=z('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),Zp=z('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),Jp=z('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Ou(t,e){_t(e,!0);let r=De(e,"ondismiss",3,null),a=De(e,"onsignout",3,null),i=yt(()=>Wp(e.error));Wt(()=>wn("ErrorCard"));var o=Jp(),u=y(o);{var d=U=>{var re=Yp(),ae=y(re),H=y(ae),J=x(ae,2);J.__click=function(...ee){var F;(F=r())==null||F.apply(this,ee)},le(()=>V(H,m(i).title)),N(U,re)},h=U=>{var re=Vp(),ae=y(re);le(()=>V(ae,m(i).title)),N(U,re)};de(u,U=>{r()?U(d):U(h,!1)})}var v=x(u,2),_=y(v),S=x(v,2);{var w=U=>{var re=Xp(),ae=y(re);le(()=>V(ae,m(i).fix)),N(U,re)};de(S,U=>{m(i).fix&&U(w)})}var k=x(S,2);{var D=U=>{var re=Qp(),ae=y(re);le(()=>{cu(re,"href",m(i).link.url),V(ae,`${m(i).link.label??""} â`)}),N(U,re)};de(k,U=>{m(i).link&&U(D)})}var E=x(k,2);{var T=U=>{var re=Zp();re.__click=function(...ae){var H;(H=a())==null||H.apply(this,ae)},N(U,re)};de(E,U=>{m(i).action==="signout"&&a()&&U(T)})}le(()=>V(_,m(i).description)),N(t,o),bt()}Mt(["click"]);var $p=z('<span class="spinner svelte-nyqevv"></span> Signing in...',1),eh=Mo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),th=z(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function nh(t,e){_t(e,!0);let r=De(e,"error",3,null),a=De(e,"loadingAuth",3,!1);Wt(()=>wn("AuthCard"));var i=th(),o=y(i),u=x(y(o),4);{var d=T=>{Ou(T,{get error(){return r()},get onsignout(){return e.onsignout}})};de(u,T=>{r()&&T(d)})}var h=x(u,2);h.__click=function(...T){var U;(U=e.onsignin)==null||U.apply(this,T)};var v=y(h);{var _=T=>{var U=$p();N(T,U)},S=T=>{var U=eh();N(T,U)};de(v,T=>{a()?T(_):T(S,!1)})}var w=x(h,2),k=x(y(w),2),D=y(k),E=x(k,2);E.__click=function(...T){var U;(U=e.onclear)==null||U.apply(this,T)},le(T=>{h.disabled=a(),V(D,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),N(t,i),bt()}Mt(["click"]);var rh=z('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),ah=z('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),sh=z('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function ih(t,e){_t(e,!0);let r=De(e,"profile",3,null),a=De(e,"loadingProfile",3,!1);Wt(()=>wn("ProfileCard"));var i=sh(),o=y(i),u=y(o),d=x(o,2),h=y(d);{var v=w=>{var k=rh();N(w,k)},_=w=>{var k=ah(),D=$e(k),E=y(D),T=x(D,2),U=y(T);le((re,ae)=>{V(E,r().emailAddress),V(U,`${re??""} messages
        Â· ${ae??""} threads`)},[()=>{var re;return((re=r().messagesTotal)==null?void 0:re.toLocaleString())||"?"},()=>{var re;return((re=r().threadsTotal)==null?void 0:re.toLocaleString())||"?"}]),N(w,k)};de(h,w=>{a()?w(v):r()&&w(_,1)})}var S=x(d,2);S.__click=function(...w){var k;(k=e.onsignout)==null||k.apply(this,w)},le(w=>V(u,w),[()=>r()?yu(r().emailAddress):"?"]),N(t,i),bt()}Mt(["click"]);var oh=z('<span class="spinner svelte-1ds3j4k"></span>'),lh=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),ch=z('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),uh=z('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),fh=z('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),dh=z('<option class="svelte-1ds3j4k"> </option>'),vh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),ph=z('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),hh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),mh=z('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),gh=z('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),yh=z('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function _h(t,e){_t(e,!0),Wt(()=>wn("SyncStatus"));let r=De(e,"syncStatus",3,null),a=De(e,"syncProgress",3,null),i=De(e,"isSyncing",3,!1),o=Oe(!1),u=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function h(X){if(!X)return"never";const ue=Math.floor((Date.now()-X)/1e3);if(ue<60)return"just now";const ge=Math.floor(ue/60);if(ge<60)return`${ge}m ago`;const we=Math.floor(ge/60);return we<24?`${we}h ago`:`${Math.floor(we/24)}d ago`}function v(){var X,ue;return!((X=a())!=null&&X.total)||!((ue=a())!=null&&ue.current)?0:Math.round(a().current/a().total*100)}var _=yh(),S=y(_),w=y(S),k=y(w);{var D=X=>{var ue=oh();N(X,ue)},E=X=>{var ue=lh();N(X,ue)};de(k,X=>{i()?X(D):X(E,!1)})}var T=x(w,2),U=x(y(T),2);{var re=X=>{var ue=ch(),ge=y(ue),we=x(ge);{var Y=W=>{var se=ti("Â· more available");N(W,se)},te=W=>{var se=ti("Â· all synced");N(W,se)};de(we,W=>{r().hasMore?W(Y):W(te,!1)})}le((W,se)=>V(ge,`${W??""} emails stored
          Â· synced ${se??""} `),[()=>r().totalItems.toLocaleString(),()=>h(r().lastSyncAt)]),N(X,ue)},ae=X=>{var ue=uh();N(X,ue)};de(U,X=>{var ue;(ue=r())!=null&&ue.synced?X(re):X(ae,!1)})}var H=x(T,2),J=y(H);{var ee=X=>{var ue=fh();ue.__click=()=>L(o,!m(o)),N(X,ue)};de(J,X=>{var ue;(ue=r())!=null&&ue.synced&&!i()&&X(ee)})}var F=x(S,2),fe=y(F),Ae=x(y(fe),2);en(Ae,21,()=>d,sr,(X,ue)=>{var ge=dh(),we=y(ge),Y={};le(()=>{V(we,m(ue).label),Y!==(Y=m(ue).value)&&(ge.value=(ge.__value=m(ue).value)??"")}),N(X,ge)});var Ie=x(fe,2),ce=y(Ie);{var $=X=>{var ue=ph(),ge=$e(ue);ge.__click=()=>e.onsync(m(u));var we=y(ge),Y=x(ge,2);{var te=W=>{var se=vh();se.__click=()=>e.onsyncmore(m(u));var be=y(se);le(()=>{se.disabled=i(),V(be,i()?"Loading...":"Sync More")}),N(W,se)};de(Y,W=>{r().hasMore&&W(te)})}le(()=>{ge.disabled=i(),V(we,i()?"Syncing...":"Sync New")}),N(X,ue)},ie=X=>{var ue=hh();ue.__click=()=>e.onsync(m(u));var ge=y(ue);le(()=>{ue.disabled=i(),V(ge,i()?"Syncing...":"Download Emails")}),N(X,ue)};de(ce,X=>{var ue;(ue=r())!=null&&ue.synced?X($):X(ie,!1)})}var Pe=x(F,2);{var oe=X=>{var ue=mh(),ge=y(ue),we=y(ge);let Y,te;var W=x(ge,2),se=y(W);le(be=>{Y=Dt(we,1,"progress-fill svelte-1ds3j4k",null,Y,{indeterminate:!a().total}),te=dn(we,"",te,be),V(se,a().message||"Syncing...")},[()=>({width:`${v()??""}%`})]),N(X,ue)};de(Pe,X=>{i()&&a()&&X(oe)})}var ve=x(Pe,2);{var pe=X=>{var ue=gh(),ge=x(y(ue),2),we=y(ge);we.__click=()=>L(o,!1);var Y=x(we,2);Y.__click=()=>{e.onclear(),L(o,!1)},N(X,ue)};de(ve,X=>{m(o)&&X(pe)})}le(()=>Ae.disabled=i()),Lo(Ae,()=>m(u),X=>L(u,X)),N(t,_),bt()}Mt(["click"]);var bh=z('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),wh=z('<div class="message-list svelte-y2uamw"></div>');function kh(t,e){_t(e,!0);let r=De(e,"messages",19,()=>[]);Wt(()=>wn("MessageList"));var a=wh();en(a,21,r,sr,(i,o)=>{var u=bh();u.__click=()=>e.onselect(m(o));var d=y(u),h=y(d),v=x(d,2),_=y(v),S=y(_),w=y(S),k=x(S,2),D=y(k),E=x(_,2),T=y(E),U=x(E,2),re=y(U);le((ae,H,J)=>{V(h,ae),V(w,H),V(D,J),V(T,m(o).subject),V(re,m(o).snippet)},[()=>yu(m(o).from),()=>gu(m(o).from),()=>Bo(m(o).date)]),N(i,u)}),N(t,a),bt()}Mt(["click"]);function Fo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var da=Fo();function Du(t){da=t}var Yr={exec:()=>null};function at(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace($t.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var xh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),$t={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Sh=/^(?:[ \t]*(?:\n|$))+/,Th=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Eh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ys=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ah=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ko=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,ju=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Mu=at(ju).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ch=at(ju).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Uo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Ih=/^[^\n]+/,Go=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ph=at(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Go).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Rh=at(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ko).getRegex(),pi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ho=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Oh=at("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ho).replace("tag",pi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Lu=at(Uo).replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pi).getRegex(),Dh=at(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Lu).getRegex(),Wo={blockquote:Dh,code:Th,def:Ph,fences:Eh,heading:Ah,hr:ys,html:Oh,lheading:Mu,list:Rh,newline:Sh,paragraph:Lu,table:Yr,text:Ih},Vl=at("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pi).getRegex(),jh={...Wo,lheading:Ch,table:Vl,paragraph:at(Uo).replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Vl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pi).getRegex()},Mh={...Wo,html:at(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ho).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:at(Uo).replace("hr",ys).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Mu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Lh=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Nh=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Nu=/^( {2,}|\\)\n(?!\s*$)/,qh=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,hi=/[\p{P}\p{S}]/u,Yo=/[\s\p{P}\p{S}]/u,qu=/[^\s\p{P}\p{S}]/u,Bh=at(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Yo).getRegex(),Bu=/(?!~)[\p{P}\p{S}]/u,zh=/(?!~)[\s\p{P}\p{S}]/u,Fh=/(?:[^\s\p{P}\p{S}]|~)/u,zu=/(?![*_])[\p{P}\p{S}]/u,Kh=/(?![*_])[\s\p{P}\p{S}]/u,Uh=/(?:[^\s\p{P}\p{S}]|[*_])/u,Gh=at(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",xh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Fu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Hh=at(Fu,"u").replace(/punct/g,hi).getRegex(),Wh=at(Fu,"u").replace(/punct/g,Bu).getRegex(),Ku="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Yh=at(Ku,"gu").replace(/notPunctSpace/g,qu).replace(/punctSpace/g,Yo).replace(/punct/g,hi).getRegex(),Vh=at(Ku,"gu").replace(/notPunctSpace/g,Fh).replace(/punctSpace/g,zh).replace(/punct/g,Bu).getRegex(),Xh=at("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,qu).replace(/punctSpace/g,Yo).replace(/punct/g,hi).getRegex(),Qh=at(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,zu).getRegex(),Zh="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Jh=at(Zh,"gu").replace(/notPunctSpace/g,Uh).replace(/punctSpace/g,Kh).replace(/punct/g,zu).getRegex(),$h=at(/\\(punct)/,"gu").replace(/punct/g,hi).getRegex(),em=at(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tm=at(Ho).replace("(?:-->|$)","-->").getRegex(),nm=at("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ai=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,rm=at(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ai).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Uu=at(/^!?\[(label)\]\[(ref)\]/).replace("label",ai).replace("ref",Go).getRegex(),Gu=at(/^!?\[(ref)\](?:\[\])?/).replace("ref",Go).getRegex(),am=at("reflink|nolink(?!\\()","g").replace("reflink",Uu).replace("nolink",Gu).getRegex(),Xl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Vo={_backpedal:Yr,anyPunctuation:$h,autolink:em,blockSkip:Gh,br:Nu,code:Nh,del:Yr,delLDelim:Yr,delRDelim:Yr,emStrongLDelim:Hh,emStrongRDelimAst:Yh,emStrongRDelimUnd:Xh,escape:Lh,link:rm,nolink:Gu,punctuation:Bh,reflink:Uu,reflinkSearch:am,tag:nm,text:qh,url:Yr},sm={...Vo,link:at(/^!?\[(label)\]\((.*?)\)/).replace("label",ai).getRegex(),reflink:at(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ai).getRegex()},mo={...Vo,emStrongRDelimAst:Vh,emStrongLDelim:Wh,delLDelim:Qh,delRDelim:Jh,url:at(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Xl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:at(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Xl).getRegex()},im={...mo,br:at(Nu).replace("{2,}","*").getRegex(),text:at(mo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ks={normal:Wo,gfm:jh,pedantic:Mh},Va={normal:Vo,gfm:mo,breaks:im,pedantic:sm},om={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ql=t=>om[t];function ur(t,e){if(e){if($t.escapeTest.test(t))return t.replace($t.escapeReplace,Ql)}else if($t.escapeTestNoEncode.test(t))return t.replace($t.escapeReplaceNoEncode,Ql);return t}function Zl(t){try{t=encodeURI(t).replace($t.percentDecode,"%")}catch{return null}return t}function Jl(t,e){var o;let r=t.replace($t.findPipe,(u,d,h)=>{let v=!1,_=d;for(;--_>=0&&h[_]==="\\";)v=!v;return v?"|":" |"}),a=r.split($t.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace($t.slashPipe,"|");return a}function Xa(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function lm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function cm(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function $l(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,h}function um(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var si=class{constructor(t){Xe(this,"options");Xe(this,"rules");Xe(this,"lexer");this.options=t||da}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Xa(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=um(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Xa(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Xa(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Xa(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],h;for(h=0;h<r.length;h++)if(this.rules.other.blockquoteStart.test(r[h]))d.push(r[h]),u=!0;else if(!u)d.push(r[h]);else break;r=r.slice(h);let v=d.join(`
`),_=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,i=i?`${i}
${_}`:_;let S=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(_,o,!0),this.lexer.state.top=S,r.length===0)break;let w=o.at(-1);if((w==null?void 0:w.type)==="code")break;if((w==null?void 0:w.type)==="blockquote"){let k=w,D=k.raw+`
`+r.join(`
`),E=this.blockquote(D);o[o.length-1]=E,a=a.substring(0,a.length-k.raw.length)+E.raw,i=i.substring(0,i.length-k.text.length)+E.text;break}else if((w==null?void 0:w.type)==="list"){let k=w,D=k.raw+`
`+r.join(`
`),E=this.list(D);o[o.length-1]=E,a=a.substring(0,a.length-w.raw.length)+E.raw,i=i.substring(0,i.length-k.raw.length)+E.raw,r=D.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),h=!1;for(;t;){let _=!1,S="",w="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;S=e[0],t=t.substring(S.length);let k=cm(e[2].split(`
`,1)[0],e[1].length),D=t.split(`
`,1)[0],E=!k.trim(),T=0;if(this.options.pedantic?(T=2,w=k.trimStart()):E?T=e[1].length+1:(T=k.search(this.rules.other.nonSpaceChar),T=T>4?1:T,w=k.slice(T),T+=e[1].length),E&&this.rules.other.blankLine.test(D)&&(S+=D+`
`,t=t.substring(D.length+1),_=!0),!_){let U=this.rules.other.nextBulletRegex(T),re=this.rules.other.hrRegex(T),ae=this.rules.other.fencesBeginRegex(T),H=this.rules.other.headingBeginRegex(T),J=this.rules.other.htmlBeginRegex(T),ee=this.rules.other.blockquoteBeginRegex(T);for(;t;){let F=t.split(`
`,1)[0],fe;if(D=F,this.options.pedantic?(D=D.replace(this.rules.other.listReplaceNesting,"  "),fe=D):fe=D.replace(this.rules.other.tabCharGlobal,"    "),ae.test(D)||H.test(D)||J.test(D)||ee.test(D)||U.test(D)||re.test(D))break;if(fe.search(this.rules.other.nonSpaceChar)>=T||!D.trim())w+=`
`+fe.slice(T);else{if(E||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||ae.test(k)||H.test(k)||re.test(k))break;w+=`
`+D}E=!D.trim(),S+=F+`
`,t=t.substring(F.length+1),k=fe.slice(T)}}u.loose||(h?u.loose=!0:this.rules.other.doubleBlankLine.test(S)&&(h=!0)),u.items.push({type:"list_item",raw:S,task:!!this.options.gfm&&this.rules.other.listIsTask.test(w),loose:!1,text:w,tokens:[]}),u.raw+=S}let v=u.items.at(-1);if(v)v.raw=v.raw.trimEnd(),v.text=v.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let _ of u.items){if(this.lexer.state.top=!1,_.tokens=this.lexer.blockTokens(_.text,[]),_.task){if(_.text=_.text.replace(this.rules.other.listReplaceTask,""),((r=_.tokens[0])==null?void 0:r.type)==="text"||((a=_.tokens[0])==null?void 0:a.type)==="paragraph"){_.tokens[0].raw=_.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),_.tokens[0].text=_.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let w=this.lexer.inlineQueue.length-1;w>=0;w--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[w].src)){this.lexer.inlineQueue[w].src=this.lexer.inlineQueue[w].src.replace(this.rules.other.listReplaceTask,"");break}}let S=this.rules.other.listTaskCheckbox.exec(_.raw);if(S){let w={type:"checkbox",raw:S[0]+" ",checked:S[0]!=="[ ]"};_.checked=w.checked,u.loose?_.tokens[0]&&["paragraph","text"].includes(_.tokens[0].type)&&"tokens"in _.tokens[0]&&_.tokens[0].tokens?(_.tokens[0].raw=w.raw+_.tokens[0].raw,_.tokens[0].text=w.raw+_.tokens[0].text,_.tokens[0].tokens.unshift(w)):_.tokens.unshift({type:"paragraph",raw:w.raw,text:w.raw,tokens:[w]}):_.tokens.unshift(w)}}if(!u.loose){let S=_.tokens.filter(k=>k.type==="space"),w=S.length>0&&S.some(k=>this.rules.other.anyLine.test(k.raw));u.loose=w}}if(u.loose)for(let _ of u.items){_.loose=!0;for(let S of _.tokens)S.type==="text"&&(S.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Jl(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Jl(d,o.header.length).map((h,v)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[v]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Xa(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=lm(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),$l(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return $l(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,h=0,v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){h+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+h);let _=[...a[0]][0].length,S=t.slice(0,i+a.index+_+u);if(Math.min(i,u)%2){let k=S.slice(1,-1);return{type:"em",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}let w=S.slice(2,-2);return{type:"strong",raw:S,text:w,tokens:this.lexer.inlineTokens(w)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,h=this.rules.inline.delRDelim;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let v=[...a[0]][0].length,_=t.slice(0,i+a.index+v+u),S=_.slice(i,-i);return{type:"del",raw:_,text:S,tokens:this.lexer.inlineTokens(S)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Un=class go{constructor(e){Xe(this,"tokens");Xe(this,"options");Xe(this,"state");Xe(this,"inlineQueue");Xe(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||da,this.options.tokenizer=this.options.tokenizer||new si,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:$t,block:Ks.normal,inline:Va.normal};this.options.pedantic?(r.block=Ks.pedantic,r.inline=Va.pedantic):this.options.gfm&&(r.block=Ks.gfm,this.options.breaks?r.inline=Va.breaks:r.inline=Va.gfm),this.tokenizer.rules=r}static get rules(){return{block:Ks,inline:Va}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace($t.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace($t.tabCharGlobal,"    ").replace($t.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(v=>(d=v.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let v=r.at(-1);d.raw.length===1&&v!==void 0?v.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.raw,this.inlineQueue.at(-1).src=v.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let h=e;if((u=this.options.extensions)!=null&&u.startBlock){let v=1/0,_=e.slice(1),S;this.options.extensions.startBlock.forEach(w=>{S=w.call({lexer:this},_),typeof S=="number"&&S>=0&&(v=Math.min(v,S))}),v<1/0&&v>=0&&(h=e.substring(0,v+1))}if(this.state.top&&(d=this.tokenizer.paragraph(h))){let v=r.at(-1);a&&(v==null?void 0:v.type)==="paragraph"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d),a=h.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var h,v,_,S,w;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((v=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:v.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let k;if((S=(_=this.options.extensions)==null?void 0:_.inline)!=null&&S.some(E=>(k=E.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let E=r.at(-1);k.type==="text"&&(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let D=e;if((w=this.options.extensions)!=null&&w.startInline){let E=1/0,T=e.slice(1),U;this.options.extensions.startInline.forEach(re=>{U=re.call({lexer:this},T),typeof U=="number"&&U>=0&&(E=Math.min(E,U))}),E<1/0&&E>=0&&(D=e.substring(0,E+1))}if(k=this.tokenizer.inlineText(D)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(d=k.raw.slice(-1)),u=!0;let E=r.at(-1);(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(e){let E="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(E);break}else throw new Error(E)}}return r}},ii=class{constructor(t){Xe(this,"options");Xe(this,"parser");this.options=t||da}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match($t.notSpaceStart))==null?void 0:o[0],i=t.replace($t.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ur(a)+'">'+(r?i:ur(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ur(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ur(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Zl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ur(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Zl(t);if(i===null)return ur(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ur(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ur(t.text)}},Xo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Gn=class yo{constructor(e){Xe(this,"options");Xe(this,"renderer");Xe(this,"textRenderer");this.options=e||da,this.options.renderer=this.options.renderer||new ii,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Xo}static parse(e,r){return new yo(r).parse(e)}static parseInline(e,r){return new yo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let h=u,v=this.options.extensions.renderers[h.type].call({parser:this},h);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){r+=v||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let h='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let v=this.options.extensions.renderers[d.type].call({parser:this},d);if(v!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=v||"";continue}}let h=d;switch(h.type){case"escape":{a+=r.text(h);break}case"html":{a+=r.html(h);break}case"link":{a+=r.link(h);break}case"image":{a+=r.image(h);break}case"checkbox":{a+=r.checkbox(h);break}case"strong":{a+=r.strong(h);break}case"em":{a+=r.em(h);break}case"codespan":{a+=r.codespan(h);break}case"br":{a+=r.br(h);break}case"del":{a+=r.del(h);break}case"text":{a+=r.text(h);break}default:{let v='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return a}},Hs,ns=(Hs=class{constructor(t){Xe(this,"options");Xe(this,"block");this.options=t||da}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Un.lex:Un.lexInline}provideParser(){return this.block?Gn.parse:Gn.parseInline}},Xe(Hs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Xe(Hs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Hs),fm=class{constructor(...t){Xe(this,"defaults",Fo());Xe(this,"options",this.setOptions);Xe(this,"parse",this.parseMarkdown(!0));Xe(this,"parseInline",this.parseMarkdown(!1));Xe(this,"Parser",Gn);Xe(this,"Renderer",ii);Xe(this,"TextRenderer",Xo);Xe(this,"Lexer",Un);Xe(this,"Tokenizer",si);Xe(this,"Hooks",ns);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let h of d)r=r.concat(this.walkTokens(h.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let h=u[d].flat(1/0);r=r.concat(this.walkTokens(h,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ii(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],h=i[u];i[u]=(...v)=>{let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new si(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],h=i[u];i[u]=(...v)=>{let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ns;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],h=i[u];ns.passThroughHooks.has(o)?i[u]=v=>{if(this.defaults.async&&ns.passThroughHooksRespectAsync.has(o))return(async()=>{let S=await d.call(i,v);return h.call(i,S)})();let _=d.call(i,v);return h.call(i,_)}:i[u]=(...v)=>{if(this.defaults.async)return(async()=>{let S=await d.apply(i,v);return S===!1&&(S=await h.apply(i,v)),S})();let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Un.lex(t,e??this.defaults)}parser(t,e){return Gn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Un.lex:Un.lexInline)(u,i),h=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let v=await(i.hooks?await i.hooks.provideParser():t?Gn.parse:Gn.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(v):v})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?Un.lex:Un.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Gn.parse:Gn.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+ur(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ua=new fm;function lt(t,e){return ua.parse(t,e)}lt.options=lt.setOptions=function(t){return ua.setOptions(t),lt.defaults=ua.defaults,Du(lt.defaults),lt};lt.getDefaults=Fo;lt.defaults=da;lt.use=function(...t){return ua.use(...t),lt.defaults=ua.defaults,Du(lt.defaults),lt};lt.walkTokens=function(t,e){return ua.walkTokens(t,e)};lt.parseInline=ua.parseInline;lt.Parser=Gn;lt.parser=Gn.parse;lt.Renderer=ii;lt.TextRenderer=Xo;lt.Lexer=Un;lt.lexer=Un.lex;lt.Tokenizer=si;lt.Hooks=ns;lt.parse=lt;lt.options;lt.setOptions;lt.use;lt.walkTokens;lt.parseInline;Gn.parse;Un.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Hu,setPrototypeOf:ec,isFrozen:dm,getPrototypeOf:vm,getOwnPropertyDescriptor:pm}=Object;let{freeze:tn,seal:jn,create:_o}=Object,{apply:bo,construct:wo}=typeof Reflect<"u"&&Reflect;tn||(tn=function(e){return e});jn||(jn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});wo||(wo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Us=nn(Array.prototype.forEach),hm=nn(Array.prototype.lastIndexOf),tc=nn(Array.prototype.pop),Qa=nn(Array.prototype.push),mm=nn(Array.prototype.splice),Js=nn(String.prototype.toLowerCase),Yi=nn(String.prototype.toString),Vi=nn(String.prototype.match),Za=nn(String.prototype.replace),gm=nn(String.prototype.indexOf),ym=nn(String.prototype.trim),Fn=nn(Object.prototype.hasOwnProperty),Jt=nn(RegExp.prototype.test),Ja=_m(TypeError);function nn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function _m(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return wo(t,r)}}function Ve(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Js;ec&&ec(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(dm(e)||(e[a]=o),i=o)}t[i]=!0}return t}function bm(t){for(let e=0;e<t.length;e++)Fn(t,e)||(t[e]=null);return t}function Jn(t){const e=_o(null);for(const[r,a]of Hu(t))Fn(t,r)&&(Array.isArray(a)?e[r]=bm(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=Jn(a):e[r]=a);return e}function $a(t,e){for(;t!==null;){const a=pm(t,e);if(a){if(a.get)return nn(a.get);if(typeof a.value=="function")return nn(a.value)}t=vm(t)}function r(){return null}return r}const nc=tn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xi=tn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qi=tn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wm=tn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Zi=tn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),km=tn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),rc=tn(["#text"]),ac=tn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ji=tn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sc=tn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Gs=tn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xm=jn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Sm=jn(/<%[\w\W]*|[\w\W]*%>/gm),Tm=jn(/\$\{[\w\W]*/gm),Em=jn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Am=jn(/^aria-[\-\w]+$/),Wu=jn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Cm=jn(/^(?:\w+script|data):/i),Im=jn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yu=jn(/^html$/i),Pm=jn(/^[a-z][.\w]*(-[.\w]+)+$/i);var ic=Object.freeze({__proto__:null,ARIA_ATTR:Am,ATTR_WHITESPACE:Im,CUSTOM_ELEMENT:Pm,DATA_ATTR:Em,DOCTYPE_NAME:Yu,ERB_EXPR:Sm,IS_ALLOWED_URI:Wu,IS_SCRIPT_OR_DATA:Cm,MUSTACHE_EXPR:xm,TMPLIT_EXPR:Tm});const es={element:1,text:3,progressingInstruction:7,comment:8,document:9},Rm=function(){return typeof window>"u"?null:window},Om=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},oc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Vu(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rm();const e=qe=>Vu(qe);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==es.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:h,NodeFilter:v,NamedNodeMap:_=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:S,DOMParser:w,trustedTypes:k}=t,D=h.prototype,E=$a(D,"cloneNode"),T=$a(D,"remove"),U=$a(D,"nextSibling"),re=$a(D,"childNodes"),ae=$a(D,"parentNode");if(typeof u=="function"){const qe=r.createElement("template");qe.content&&qe.content.ownerDocument&&(r=qe.content.ownerDocument)}let H,J="";const{implementation:ee,createNodeIterator:F,createDocumentFragment:fe,getElementsByTagName:Ae}=r,{importNode:Ie}=a;let ce=oc();e.isSupported=typeof Hu=="function"&&typeof ae=="function"&&ee&&ee.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:$,ERB_EXPR:ie,TMPLIT_EXPR:Pe,DATA_ATTR:oe,ARIA_ATTR:ve,IS_SCRIPT_OR_DATA:pe,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:ue}=ic;let{IS_ALLOWED_URI:ge}=ic,we=null;const Y=Ve({},[...nc,...Xi,...Qi,...Zi,...rc]);let te=null;const W=Ve({},[...ac,...Ji,...sc,...Gs]);let se=Object.seal(_o(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),be=null,he=null;const ze=Object.seal(_o(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ue=!0,Q=!0,Ce=!1,je=!0,Fe=!1,et=!0,tt=!1,Ge=!1,nt=!1,ft=!1,kt=!1,ut=!1,dt=!0,Yt=!1;const pt="user-content-";let jt=!0,Rt=!1,ht={},xt=null;const vn=Ve({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rn=null;const kn=Ve({},["audio","video","img","source","image","track"]);let an=null;const pn=Ve({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),xn="http://www.w3.org/1998/Math/MathML",Mn="http://www.w3.org/2000/svg",Lt="http://www.w3.org/1999/xhtml";let Ne=Lt,ir=!1,Ln=null;const va=Ve({},[xn,Mn,Lt],Yi);let Ee=Ve({},["mi","mo","mn","ms","mtext"]),br=Ve({},["annotation-xml"]);const _s=Ve({},["title","style","font","a","script"]);let or=null;const bs=["application/xhtml+xml","text/html"],Ma="text/html";let At=null,wr=null;const kr=r.createElement("form"),lr=function(C){return C instanceof RegExp||C instanceof Function},Lr=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wr&&wr===C)){if((!C||typeof C!="object")&&(C={}),C=Jn(C),or=bs.indexOf(C.PARSER_MEDIA_TYPE)===-1?Ma:C.PARSER_MEDIA_TYPE,At=or==="application/xhtml+xml"?Yi:Js,we=Fn(C,"ALLOWED_TAGS")?Ve({},C.ALLOWED_TAGS,At):Y,te=Fn(C,"ALLOWED_ATTR")?Ve({},C.ALLOWED_ATTR,At):W,Ln=Fn(C,"ALLOWED_NAMESPACES")?Ve({},C.ALLOWED_NAMESPACES,Yi):va,an=Fn(C,"ADD_URI_SAFE_ATTR")?Ve(Jn(pn),C.ADD_URI_SAFE_ATTR,At):pn,rn=Fn(C,"ADD_DATA_URI_TAGS")?Ve(Jn(kn),C.ADD_DATA_URI_TAGS,At):kn,xt=Fn(C,"FORBID_CONTENTS")?Ve({},C.FORBID_CONTENTS,At):vn,be=Fn(C,"FORBID_TAGS")?Ve({},C.FORBID_TAGS,At):Jn({}),he=Fn(C,"FORBID_ATTR")?Ve({},C.FORBID_ATTR,At):Jn({}),ht=Fn(C,"USE_PROFILES")?C.USE_PROFILES:!1,Ue=C.ALLOW_ARIA_ATTR!==!1,Q=C.ALLOW_DATA_ATTR!==!1,Ce=C.ALLOW_UNKNOWN_PROTOCOLS||!1,je=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Fe=C.SAFE_FOR_TEMPLATES||!1,et=C.SAFE_FOR_XML!==!1,tt=C.WHOLE_DOCUMENT||!1,ft=C.RETURN_DOM||!1,kt=C.RETURN_DOM_FRAGMENT||!1,ut=C.RETURN_TRUSTED_TYPE||!1,nt=C.FORCE_BODY||!1,dt=C.SANITIZE_DOM!==!1,Yt=C.SANITIZE_NAMED_PROPS||!1,jt=C.KEEP_CONTENT!==!1,Rt=C.IN_PLACE||!1,ge=C.ALLOWED_URI_REGEXP||Wu,Ne=C.NAMESPACE||Lt,Ee=C.MATHML_TEXT_INTEGRATION_POINTS||Ee,br=C.HTML_INTEGRATION_POINTS||br,se=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&lr(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&lr(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(Q=!1),kt&&(ft=!0),ht&&(we=Ve({},rc),te=[],ht.html===!0&&(Ve(we,nc),Ve(te,ac)),ht.svg===!0&&(Ve(we,Xi),Ve(te,Ji),Ve(te,Gs)),ht.svgFilters===!0&&(Ve(we,Qi),Ve(te,Ji),Ve(te,Gs)),ht.mathMl===!0&&(Ve(we,Zi),Ve(te,sc),Ve(te,Gs))),C.ADD_TAGS&&(typeof C.ADD_TAGS=="function"?ze.tagCheck=C.ADD_TAGS:(we===Y&&(we=Jn(we)),Ve(we,C.ADD_TAGS,At))),C.ADD_ATTR&&(typeof C.ADD_ATTR=="function"?ze.attributeCheck=C.ADD_ATTR:(te===W&&(te=Jn(te)),Ve(te,C.ADD_ATTR,At))),C.ADD_URI_SAFE_ATTR&&Ve(an,C.ADD_URI_SAFE_ATTR,At),C.FORBID_CONTENTS&&(xt===vn&&(xt=Jn(xt)),Ve(xt,C.FORBID_CONTENTS,At)),C.ADD_FORBID_CONTENTS&&(xt===vn&&(xt=Jn(xt)),Ve(xt,C.ADD_FORBID_CONTENTS,At)),jt&&(we["#text"]=!0),tt&&Ve(we,["html","head","body"]),we.table&&(Ve(we,["tbody"]),delete be.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=C.TRUSTED_TYPES_POLICY,J=H.createHTML("")}else H===void 0&&(H=Om(k,i)),H!==null&&typeof J=="string"&&(J=H.createHTML(""));tn&&tn(C),wr=C}},Nr=Ve({},[...Xi,...Qi,...wm]),vt=Ve({},[...Zi,...km]),Ot=function(C){let _e=ae(C);(!_e||!_e.tagName)&&(_e={namespaceURI:Ne,tagName:"template"});const xe=Js(C.tagName),st=Js(_e.tagName);return Ln[C.namespaceURI]?C.namespaceURI===Mn?_e.namespaceURI===Lt?xe==="svg":_e.namespaceURI===xn?xe==="svg"&&(st==="annotation-xml"||Ee[st]):!!Nr[xe]:C.namespaceURI===xn?_e.namespaceURI===Lt?xe==="math":_e.namespaceURI===Mn?xe==="math"&&br[st]:!!vt[xe]:C.namespaceURI===Lt?_e.namespaceURI===Mn&&!br[st]||_e.namespaceURI===xn&&!Ee[st]?!1:!vt[xe]&&(_s[xe]||!Nr[xe]):!!(or==="application/xhtml+xml"&&Ln[C.namespaceURI]):!1},Sn=function(C){Qa(e.removed,{element:C});try{ae(C).removeChild(C)}catch{T(C)}},Tn=function(C,_e){try{Qa(e.removed,{attribute:_e.getAttributeNode(C),from:_e})}catch{Qa(e.removed,{attribute:null,from:_e})}if(_e.removeAttribute(C),C==="is")if(ft||kt)try{Sn(_e)}catch{}else try{_e.setAttribute(C,"")}catch{}},qr=function(C){let _e=null,xe=null;if(nt)C="<remove></remove>"+C;else{const St=Vi(C,/^[\r\n\t ]+/);xe=St&&St[0]}or==="application/xhtml+xml"&&Ne===Lt&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const st=H?H.createHTML(C):C;if(Ne===Lt)try{_e=new w().parseFromString(st,or)}catch{}if(!_e||!_e.documentElement){_e=ee.createDocument(Ne,"template",null);try{_e.documentElement.innerHTML=ir?J:st}catch{}}const mt=_e.body||_e.documentElement;return C&&xe&&mt.insertBefore(r.createTextNode(xe),mt.childNodes[0]||null),Ne===Lt?Ae.call(_e,tt?"html":"body")[0]:tt?_e.documentElement:mt},Br=function(C){return F.call(C.ownerDocument||C,C,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},La=function(C){return C instanceof S&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof _)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Nn=function(C){return typeof d=="function"&&C instanceof d};function Vt(qe,C,_e){Us(qe,xe=>{xe.call(e,C,_e,wr)})}const qn=function(C){let _e=null;if(Vt(ce.beforeSanitizeElements,C,null),La(C))return Sn(C),!0;const xe=At(C.nodeName);if(Vt(ce.uponSanitizeElement,C,{tagName:xe,allowedTags:we}),et&&C.hasChildNodes()&&!Nn(C.firstElementChild)&&Jt(/<[/\w!]/g,C.innerHTML)&&Jt(/<[/\w!]/g,C.textContent)||C.nodeType===es.progressingInstruction||et&&C.nodeType===es.comment&&Jt(/<[/\w]/g,C.data))return Sn(C),!0;if(!(ze.tagCheck instanceof Function&&ze.tagCheck(xe))&&(!we[xe]||be[xe])){if(!be[xe]&&ws(xe)&&(se.tagNameCheck instanceof RegExp&&Jt(se.tagNameCheck,xe)||se.tagNameCheck instanceof Function&&se.tagNameCheck(xe)))return!1;if(jt&&!xt[xe]){const st=ae(C)||C.parentNode,mt=re(C)||C.childNodes;if(mt&&st){const St=mt.length;for(let Ct=St-1;Ct>=0;--Ct){const sn=E(mt[Ct],!0);sn.__removalCount=(C.__removalCount||0)+1,st.insertBefore(sn,U(C))}}}return Sn(C),!0}return C instanceof h&&!Ot(C)||(xe==="noscript"||xe==="noembed"||xe==="noframes")&&Jt(/<\/no(script|embed|frames)/i,C.innerHTML)?(Sn(C),!0):(Fe&&C.nodeType===es.text&&(_e=C.textContent,Us([$,ie,Pe],st=>{_e=Za(_e,st," ")}),C.textContent!==_e&&(Qa(e.removed,{element:C.cloneNode()}),C.textContent=_e)),Vt(ce.afterSanitizeElements,C,null),!1)},zr=function(C,_e,xe){if(dt&&(_e==="id"||_e==="name")&&(xe in r||xe in kr))return!1;if(!(Q&&!he[_e]&&Jt(oe,_e))){if(!(Ue&&Jt(ve,_e))){if(!(ze.attributeCheck instanceof Function&&ze.attributeCheck(_e,C))){if(!te[_e]||he[_e]){if(!(ws(C)&&(se.tagNameCheck instanceof RegExp&&Jt(se.tagNameCheck,C)||se.tagNameCheck instanceof Function&&se.tagNameCheck(C))&&(se.attributeNameCheck instanceof RegExp&&Jt(se.attributeNameCheck,_e)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(_e,C))||_e==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&Jt(se.tagNameCheck,xe)||se.tagNameCheck instanceof Function&&se.tagNameCheck(xe))))return!1}else if(!an[_e]){if(!Jt(ge,Za(xe,X,""))){if(!((_e==="src"||_e==="xlink:href"||_e==="href")&&C!=="script"&&gm(xe,"data:")===0&&rn[C])){if(!(Ce&&!Jt(pe,Za(xe,X,"")))){if(xe)return!1}}}}}}}return!0},ws=function(C){return C!=="annotation-xml"&&Vi(C,ue)},Bn=function(C){Vt(ce.beforeSanitizeAttributes,C,null);const{attributes:_e}=C;if(!_e||La(C))return;const xe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let st=_e.length;for(;st--;){const mt=_e[st],{name:St,namespaceURI:Ct,value:sn}=mt,Xn=At(St),Fr=sn;let wt=St==="value"?Fr:ym(Fr);if(xe.attrName=Xn,xe.attrValue=wt,xe.keepAttr=!0,xe.forceKeepAttr=void 0,Vt(ce.uponSanitizeAttribute,C,xe),wt=xe.attrValue,Yt&&(Xn==="id"||Xn==="name")&&(Tn(St,C),wt=pt+wt),et&&Jt(/((--!?|])>)|<\/(style|title|textarea)/i,wt)){Tn(St,C);continue}if(Xn==="attributename"&&Vi(wt,"href")){Tn(St,C);continue}if(xe.forceKeepAttr)continue;if(!xe.keepAttr){Tn(St,C);continue}if(!je&&Jt(/\/>/i,wt)){Tn(St,C);continue}Fe&&Us([$,ie,Pe],Kr=>{wt=Za(wt,Kr," ")});const Na=At(C.nodeName);if(!zr(Na,Xn,wt)){Tn(St,C);continue}if(H&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!Ct)switch(k.getAttributeType(Na,Xn)){case"TrustedHTML":{wt=H.createHTML(wt);break}case"TrustedScriptURL":{wt=H.createScriptURL(wt);break}}if(wt!==Fr)try{Ct?C.setAttributeNS(Ct,St,wt):C.setAttribute(St,wt),La(C)?Sn(C):tc(e.removed)}catch{Tn(St,C)}}Vt(ce.afterSanitizeAttributes,C,null)},ks=function qe(C){let _e=null;const xe=Br(C);for(Vt(ce.beforeSanitizeShadowDOM,C,null);_e=xe.nextNode();)Vt(ce.uponSanitizeShadowNode,_e,null),qn(_e),Bn(_e),_e.content instanceof o&&qe(_e.content);Vt(ce.afterSanitizeShadowDOM,C,null)};return e.sanitize=function(qe){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_e=null,xe=null,st=null,mt=null;if(ir=!qe,ir&&(qe="<!-->"),typeof qe!="string"&&!Nn(qe))if(typeof qe.toString=="function"){if(qe=qe.toString(),typeof qe!="string")throw Ja("dirty is not a string, aborting")}else throw Ja("toString is not a function");if(!e.isSupported)return qe;if(Ge||Lr(C),e.removed=[],typeof qe=="string"&&(Rt=!1),Rt){if(qe.nodeName){const sn=At(qe.nodeName);if(!we[sn]||be[sn])throw Ja("root node is forbidden and cannot be sanitized in-place")}}else if(qe instanceof d)_e=qr("<!---->"),xe=_e.ownerDocument.importNode(qe,!0),xe.nodeType===es.element&&xe.nodeName==="BODY"||xe.nodeName==="HTML"?_e=xe:_e.appendChild(xe);else{if(!ft&&!Fe&&!tt&&qe.indexOf("<")===-1)return H&&ut?H.createHTML(qe):qe;if(_e=qr(qe),!_e)return ft?null:ut?J:""}_e&&nt&&Sn(_e.firstChild);const St=Br(Rt?qe:_e);for(;st=St.nextNode();)qn(st),Bn(st),st.content instanceof o&&ks(st.content);if(Rt)return qe;if(ft){if(kt)for(mt=fe.call(_e.ownerDocument);_e.firstChild;)mt.appendChild(_e.firstChild);else mt=_e;return(te.shadowroot||te.shadowrootmode)&&(mt=Ie.call(a,mt,!0)),mt}let Ct=tt?_e.outerHTML:_e.innerHTML;return tt&&we["!doctype"]&&_e.ownerDocument&&_e.ownerDocument.doctype&&_e.ownerDocument.doctype.name&&Jt(Yu,_e.ownerDocument.doctype.name)&&(Ct="<!DOCTYPE "+_e.ownerDocument.doctype.name+`>
`+Ct),Fe&&Us([$,ie,Pe],sn=>{Ct=Za(Ct,sn," ")}),H&&ut?H.createHTML(Ct):Ct},e.setConfig=function(){let qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lr(qe),Ge=!0},e.clearConfig=function(){wr=null,Ge=!1},e.isValidAttribute=function(qe,C,_e){wr||Lr({});const xe=At(qe),st=At(C);return zr(xe,st,_e)},e.addHook=function(qe,C){typeof C=="function"&&Qa(ce[qe],C)},e.removeHook=function(qe,C){if(C!==void 0){const _e=hm(ce[qe],C);return _e===-1?void 0:mm(ce[qe],_e,1)[0]}return tc(ce[qe])},e.removeHooks=function(qe){ce[qe]=[]},e.removeAllHooks=function(){ce=oc()},e}var Dm=Vu();function jm(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${lc(t.from)} |`),e.push(`| **To** | ${lc(t.to)} |`),e.push(`| **Date** | ${Bo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Mm(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function lc(t){return(t||"").replace(/\|/g,"\\|")}function Mm(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return ko(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Lm(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function ko(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Lm(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(ko).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>ko(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Nm(t){return _u(t,"md")}function cc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function qm(t){return t.raw||null}function Bm(t){const e=qm(t);return e?JSON.stringify(e,null,2):"null"}function zm(t){return _u(t,"json")}var Fm=z('<button title="View as Markdown">.md</button>'),Km=z('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Um=z('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Gm=z('<div class="md-preview svelte-1b0rzpb"><!></div>'),Hm=z('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Wm=z('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Ym=z('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Vm=z('<pre class="message-text svelte-1b0rzpb"> </pre>'),Xm=z('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),Qm=z('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Zm=z('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Jm(t,e){_t(e,!0);let r=De(e,"loading",3,!1);Wt(()=>wn("MessageModal"));const a=new lt.Renderer;a.link=({href:$,title:ie,text:Pe})=>{const oe=ie?` title="${ie}"`:"";return`<a href="${$}"${oe} target="_blank" rel="noopener">${Pe}</a>`},lt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Oe("email"),o=yt(()=>e.message.body?jm(e.message):""),u=yt(()=>Bm(e.message)),d=Oe("raw");function h($){L(i,m(i)===$?"email":$,!0),$==="markdown"&&L(d,"raw")}function v(){cc(m(o),Nm(e.message))}function _(){cc(m(u),zm(e.message),"application/json;charset=utf-8")}function S($){const ie=lt.parse($);return Dm.sanitize(ie,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let w=Oe(null);ei(()=>{var $;if(m(w)&&e.message.htmlBody&&!r()&&m(i)==="email"){const ie=m(w).contentDocument||(($=m(w).contentWindow)==null?void 0:$.document);ie&&(ie.open(),ie.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ie.close())}});var k=Zm();k.__click=function(...$){var ie;(ie=e.onclose)==null||ie.apply(this,$)};var D=y(k);D.__click=$=>$.stopPropagation();var E=y(D),T=y(E),U=y(T),re=x(T,2),ae=y(re);let H;ae.__click=()=>h("json");var J=x(ae,2);{var ee=$=>{var ie=Fm();let Pe;ie.__click=()=>h("markdown"),le(()=>Pe=Dt(ie,1,"action-btn svelte-1b0rzpb",null,Pe,{active:m(i)==="markdown"})),N($,ie)};de(J,$=>{e.message.body&&$(ee)})}var F=x(J,2);F.__click=function(...$){var ie;(ie=e.onclose)==null||ie.apply(this,$)};var fe=x(E,2);{var Ae=$=>{var ie=Km(),Pe=$e(ie),oe=x(y(Pe),2);oe.__click=_;var ve=x(Pe,2),pe=y(ve),X=y(pe);le(()=>V(X,m(u))),N($,ie)},Ie=$=>{var ie=Hm(),Pe=$e(ie),oe=y(Pe),ve=y(oe);let pe;ve.__click=()=>L(d,"raw");var X=x(ve,2);let ue;X.__click=()=>L(d,"preview");var ge=x(oe,2);ge.__click=v;var we=x(Pe,2),Y=y(we);{var te=se=>{var be=Um(),he=y(be);le(()=>V(he,m(o))),N(se,be)},W=se=>{var be=Gm(),he=y(be);zd(he,()=>S(m(o))),N(se,be)};de(Y,se=>{m(d)==="raw"?se(te):se(W,!1)})}le(()=>{pe=Dt(ve,1,"md-tab svelte-1b0rzpb",null,pe,{active:m(d)==="raw"}),ue=Dt(X,1,"md-tab svelte-1b0rzpb",null,ue,{active:m(d)==="preview"})}),N($,ie)},ce=$=>{var ie=Qm(),Pe=$e(ie),oe=y(Pe),ve=x(y(oe),2),pe=y(ve),X=x(oe,2),ue=x(y(X),2),ge=y(ue),we=x(X,2),Y=x(y(we),2),te=y(Y),W=x(Pe,2),se=y(W);{var be=Q=>{var Ce=Wm();N(Q,Ce)},he=Q=>{var Ce=Ym();uu(Ce,je=>L(w,je),()=>m(w)),N(Q,Ce)},ze=Q=>{var Ce=Vm(),je=y(Ce);le(()=>V(je,e.message.body)),N(Q,Ce)},Ue=Q=>{var Ce=Xm();N(Q,Ce)};de(se,Q=>{r()?Q(be):e.message.htmlBody?Q(he,1):e.message.body?Q(ze,2):Q(Ue,!1)})}le(Q=>{V(pe,e.message.from),V(ge,e.message.to),V(te,Q)},[()=>Bo(e.message.date)]),N($,ie)};de(fe,$=>{m(i)==="json"?$(Ae):m(i)==="markdown"?$(Ie,1):$(ce,!1)})}le(()=>{V(U,e.message.subject),H=Dt(ae,1,"action-btn svelte-1b0rzpb",null,H,{active:m(i)==="json"})}),N(t,k),bt()}Mt(["click"]);var $m=z('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),eg=z('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),tg=z('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),ng=z("<p> </p>"),rg=z('<p>No emails in local storage. Click "Sync New" to download.</p>'),ag=z('<div class="empty-state svelte-6ts5xm"><!></div>'),sg=z('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),ig=z('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function og(t,e){_t(e,!0),Wt(()=>wn("DashboardView"));let r=De(e,"error",3,null),a=De(e,"profile",3,null),i=De(e,"loadingProfile",3,!1),o=De(e,"emailMessages",19,()=>[]),u=De(e,"totalLocalMessages",3,0),d=De(e,"hasMoreLocal",3,!1),h=De(e,"loadingMessages",3,!1),v=De(e,"selectedMessage",3,null),_=De(e,"syncStatus",3,null),S=De(e,"syncProgress",3,null),w=De(e,"isSyncing",3,!1),k=De(e,"searchQuery",15);var D=ig(),E=$e(D),T=y(E);{var U=oe=>{Ou(oe,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};de(T,oe=>{r()&&oe(U)})}var re=x(T,2);ih(re,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var ae=x(re,2);_h(ae,{get syncStatus(){return _()},get syncProgress(){return S()},get isSyncing(){return w()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var H=x(ae,2),J=y(H);J.__keydown=oe=>oe.key==="Enter"&&e.onsearch();var ee=x(J,2);ee.__click=function(...oe){var ve;(ve=e.onsearch)==null||ve.apply(this,oe)};var F=y(ee),fe=x(H,2);{var Ae=oe=>{var ve=eg(),pe=$e(ve),X=y(pe),ue=y(X),ge=x(pe,2);kh(ge,{get messages(){return o()},get onselect(){return e.onviewmessage}});var we=x(ge,2);{var Y=te=>{var W=$m(),se=y(W);se.__click=function(...he){var ze;(ze=e.onloadmore)==null||ze.apply(this,he)};var be=y(se);le(()=>{se.disabled=h(),V(be,h()?"Loading...":"Load More")}),N(te,W)};de(we,te=>{d()&&te(Y)})}le(te=>V(ue,`Showing ${o().length??""} of ${te??""}
        ${k()?" matching":""} emails`),[()=>u().toLocaleString()]),N(oe,ve)},Ie=oe=>{var ve=tg();N(oe,ve)},ce=oe=>{var ve=ag(),pe=y(ve);{var X=ge=>{var we=ng(),Y=y(we);le(()=>V(Y,`No emails match "${k()??""}".`)),N(ge,we)},ue=ge=>{var we=rg();N(ge,we)};de(pe,ge=>{k()?ge(X):ge(ue,!1)})}N(oe,ve)},$=oe=>{var ve=sg();N(oe,ve)};de(fe,oe=>{var ve;o().length>0?oe(Ae):h()?oe(Ie,1):(ve=_())!=null&&ve.synced?oe(ce,2):oe($,!1)})}var ie=x(E,2);{var Pe=oe=>{Jm(oe,{get message(){return v()},loading:!1,get onclose(){return e.onclosedetail}})};de(ie,oe=>{v()&&oe(Pe)})}le(()=>{ee.disabled=h(),V(F,h()?"Searching...":"Search")}),No(J,k),N(t,D),bt()}Mt(["keydown","click"]);var lg=z('<div class="dashboard svelte-1q5o2lv"><!></div>');function cg(t,e){_t(e,!0);function r(he){he.key==="Escape"&&m(h)&&pe()}Wt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Oe(Kt(localStorage.getItem("googleClientId")||"")),i=Oe(Kt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),u=Oe(null),d=Oe(null),h=Oe(null),v=Oe(""),_=Oe(Kt([])),S=Oe(0),w=Oe(0),k=Oe(!1),D=Oe(!1),E=Oe(!1),T=Oe(null),U=Oe(null),re=Oe(null),ae=Oe(!1);const H=50;ei(()=>{m(u)&&(X(),ie())});let J=yt(()=>!m(a)),ee=yt(()=>!!m(u)),F=yt(()=>m(_).length<m(S));ei(()=>{m(a)&&!m(o)&&Wl(m(a)).then(()=>{L(o,!0)}).catch(he=>{L(T,`Auth init failed: ${he.message}`)})});function fe(){const he=m(i).trim();he&&(localStorage.setItem("googleClientId",he),L(a,he,!0),L(T,null))}function Ae(){localStorage.removeItem("googleClientId"),L(a,""),L(i,""),L(o,!1),L(u,null),L(d,null),L(_,[],!0),L(S,0)}async function Ie(){L(T,null),L(D,!0);try{m(o)||(await Wl(m(a)),L(o,!0));const he=await Mp();L(u,he.access_token,!0),await $()}catch(he){L(T,he.message,!0)}finally{L(D,!1)}}async function ce(){if(m(u))try{await Lp(m(u))}catch{}L(u,null),L(d,null),L(_,[],!0),L(S,0),L(h,null),L(T,null)}async function $(){L(E,!0);try{const he=await pu(m(u));if(!m(u))return;L(d,he,!0)}catch(he){if(!m(u))return;L(T,`Profile fetch failed: ${he.message}`)}finally{L(E,!1)}}async function ie(he=!1){L(k,!0);try{const ze=he?m(w):0,Ue=await hv({query:m(v)||void 0,limit:H,offset:ze});he?L(_,[...m(_),...Ue.items],!0):L(_,Ue.items,!0),L(S,Ue.total,!0),L(w,m(_).length,!0)}catch(ze){L(T,`Failed to load messages: ${ze.message}`)}finally{L(k,!1)}}function Pe(){L(w,0),ie(!1)}function oe(){ie(!0)}function ve(he){L(h,he,!0)}function pe(){L(h,null)}async function X(){try{L(U,await Bp(),!0)}catch{}}async function ue(he){if(m(ae)||!m(u))return;L(T,null),L(ae,!0),L(re,null);const ze=new AbortController;try{await Np(m(u),{limit:he,onProgress:Ue=>{L(re,{...Ue},!0)},signal:ze.signal}),await X(),await ie(!1)}catch(Ue){if(Ue.name!=="AbortError"){if(!m(u))return;L(T,`Sync failed: ${Ue.message}`)}}finally{L(ae,!1)}}async function ge(he){if(m(ae)||!m(u))return;L(T,null),L(ae,!0),L(re,null);const ze=new AbortController;try{await qp(m(u),{limit:he,onProgress:Ue=>{L(re,{...Ue},!0)},signal:ze.signal}),await X(),await ie(!1)}catch(Ue){if(Ue.name!=="AbortError"){if(!m(u))return;L(T,`Sync more failed: ${Ue.message}`)}}finally{L(ae,!1)}}async function we(){try{await Cu(),await X(),L(_,[],!0),L(S,0),L(w,0)}catch(he){L(T,`Failed to clear data: ${he.message}`)}}var Y=lg(),te=y(Y);{var W=he=>{Hp(he,{onsave:fe,get clientIdInput(){return m(i)},set clientIdInput(ze){L(i,ze,!0)}})},se=he=>{nh(he,{get clientId(){return m(a)},get error(){return m(T)},get loadingAuth(){return m(D)},onsignin:Ie,onclear:Ae,onsignout:ce})},be=he=>{og(he,{get error(){return m(T)},get profile(){return m(d)},get loadingProfile(){return m(E)},get emailMessages(){return m(_)},get totalLocalMessages(){return m(S)},get hasMoreLocal(){return m(F)},get loadingMessages(){return m(k)},get selectedMessage(){return m(h)},get syncStatus(){return m(U)},get syncProgress(){return m(re)},get isSyncing(){return m(ae)},onsignout:ce,onsearch:Pe,onloadmore:oe,onviewmessage:ve,onclosedetail:pe,ondismisserror:()=>L(T,null),onsync:ue,onsyncmore:ge,oncleardata:we,get searchQuery(){return m(v)},set searchQuery(ze){L(v,ze,!0)}})};de(te,he=>{m(J)?he(W):m(ee)?he(be,!1):he(se,1)})}N(t,Y),bt()}var ug=z('<span class="sep svelte-t1ig66">Â·</span> ',1),fg=z('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),dg=z('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),vg=z('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),pg=z('<span class="result-summary svelte-t1ig66"> </span>'),hg=z('<span class="result-tag svelte-t1ig66"> </span>'),mg=z('<div class="result-tags svelte-t1ig66"></div>'),gg=z('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),yg=z('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),_g=z('<span class="err svelte-t1ig66"> </span>'),bg=z('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),wg=z('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),kg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),xg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Sg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Tg=z('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),Eg=z('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function Ag(t,e){_t(e,!0);let r=De(e,"progress",3,null),a=Oe(!1),i=Oe("system");function o(E){return!E||E<0?"â":E<1e3?`${Math.round(E)}ms`:`${(E/1e3).toFixed(1)}s`}function u(E){return E?E>=1e3?`${(E/1e3).toFixed(1)}k`:String(E):"0"}function d(E){if(!E)return"â";const T=E.replace(/<.*>/,"").trim();return T.length>30?T.slice(0,28)+"â¦":T}function h(E){if(!E)return"";try{return new Date(E).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(E){var re;if(!((re=E==null?void 0:E.totals)!=null&&re.elapsed)||!(E!=null&&E.current)||E.current<2)return null;const T=E.totals.elapsed/E.current;return(E.total-E.current)*T}let _=yt(()=>{var E;return(E=r())!=null&&E.total?Math.round(r().current/r().total*100):0}),S=yt(()=>v(r()));var w=Mr(),k=$e(w);{var D=E=>{var T=Eg(),U=$e(T),re=y(U),ae=y(re),H=y(ae);{var J=be=>{var he=ti("Scan complete");N(be,he)},ee=be=>{var he=ti();le(()=>V(he,`Processing ${r().current??""} of ${r().total??""}`)),N(be,he)};de(H,be=>{r().phase==="done"?be(J):be(ee,!1)})}var F=x(ae,2),fe=y(F),Ae=x(re,2),Ie=y(Ae);let ce,$;var ie=x(Ae,2);{var Pe=be=>{var he=fg(),ze=y(he),Ue=y(ze),Q=x(ze,2),Ce=y(Q),je=x(Ce);{var Fe=et=>{var tt=ug(),Ge=x($e(tt),1,!0);le(nt=>V(Ge,nt),[()=>h(r().email.date)]),N(et,tt)};de(je,et=>{r().email.date&&et(Fe)})}le(et=>{V(Ue,r().email.subject||"(no subject)"),V(Ce,`${et??""} `)},[()=>d(r().email.from)]),N(be,he)};de(ie,be=>{r().email&&r().phase!=="done"&&be(Pe)})}var oe=x(ie,2);{var ve=be=>{var he=vg(),ze=y(he),Ue=y(ze),Q=y(Ue),Ce=x(ze,2),je=y(Ce),Fe=y(je),et=x(Ce,2);{var tt=Ge=>{var nt=dg(),ft=y(nt),kt=y(ft);le(ut=>V(kt,`~${ut??""}`),[()=>o(m(S))]),N(Ge,nt)};de(et,Ge=>{m(S)&&Ge(tt)})}le(Ge=>{V(Q,Ge),V(Fe,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),N(be,he)};de(oe,be=>{r().live&&r().phase==="generating"&&be(ve)})}var pe=x(oe,2);{var X=be=>{var he=yg(),ze=y(he),Ue=y(ze),Q=x(ze,2);{var Ce=Ge=>{var nt=pg(),ft=y(nt);le(()=>V(ft,r().result.summary)),N(Ge,nt)};de(Q,Ge=>{r().result.summary&&Ge(Ce)})}var je=x(Q,2);{var Fe=Ge=>{var nt=mg();en(nt,21,()=>r().result.tags,sr,(ft,kt)=>{var ut=hg(),dt=y(ut);le(()=>V(dt,m(kt))),N(ft,ut)}),N(Ge,nt)};de(je,Ge=>{var nt;(nt=r().result.tags)!=null&&nt.length&&Ge(Fe)})}var et=x(je,2);{var tt=Ge=>{var nt=gg(),ft=y(nt),kt=x(ft,2),ut=x(kt,2);le((dt,Yt)=>{V(ft,`${dt??""} `),V(kt,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),V(ut,` ${Yt??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),N(Ge,nt)};de(et,Ge=>{r().emailStats&&Ge(tt)})}le(()=>V(Ue,r().result.action)),N(be,he)};de(pe,be=>{r().result&&be(X)})}var ue=x(pe,2);{var ge=be=>{var he=bg(),ze=y(he),Ue=y(ze),Q=x(ze,2);{var Ce=Ge=>{var nt=_g(),ft=y(nt);le(()=>V(ft,`${r().errors??""} errors`)),N(Ge,nt)};de(Q,Ge=>{r().errors&&Ge(Ce)})}var je=x(Q,4),Fe=y(je),et=x(je,4),tt=y(et);le((Ge,nt,ft)=>{V(Ue,`${(r().classified||0)??""} classified`),V(Fe,`${Ge??""} in + ${nt??""} out tokens`),V(tt,ft)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),N(be,he)};de(ue,be=>{r().totals&&be(ge)})}var we=x(ue,2),Y=y(we);{var te=be=>{var he=wg(),ze=$e(he);ze.__click=()=>L(a,!0);var Ue=x(ze,2);Ue.__click=function(...Q){var Ce;(Ce=e.onstop)==null||Ce.apply(this,Q)},N(be,he)};de(Y,be=>{r().phase!=="done"&&be(te)})}var W=x(U,2);{var se=be=>{var he=Tg();he.__click=()=>L(a,!1),he.__keydown=pt=>pt.key==="Escape"&&L(a,!1);var ze=y(he);ze.__click=pt=>pt.stopPropagation();var Ue=y(ze),Q=x(y(Ue),2);Q.__click=()=>L(a,!1);var Ce=x(Ue,2),je=y(Ce);let Fe;je.__click=()=>L(i,"system");var et=x(je,2);let tt;et.__click=()=>L(i,"email");var Ge=x(et,2);let nt;Ge.__click=()=>L(i,"full");var ft=x(Ce,2),kt=y(ft);{var ut=pt=>{var jt=kg(),Rt=$e(jt),ht=y(Rt),xt=x(Rt,2),vn=y(xt);le(()=>{V(ht,ba),V(vn,`${ba.length??""} chars`)}),N(pt,jt)},dt=pt=>{var jt=xg(),Rt=$e(jt),ht=y(Rt),xt=x(Rt,2),vn=y(xt);le(()=>{var rn,kn,an;V(ht,((rn=r().prompt)==null?void 0:rn.user)||"(no email prompt)"),V(vn,`${(((an=(kn=r().prompt)==null?void 0:kn.user)==null?void 0:an.length)||0)??""} chars`)}),N(pt,jt)},Yt=pt=>{var jt=Sg(),Rt=$e(jt),ht=y(Rt),xt=x(Rt,2),vn=y(xt);le(()=>{var rn,kn,an,pn,xn,Mn;V(ht,`${(((rn=r().prompt)==null?void 0:rn.system)||"")??""}

---

${(((kn=r().prompt)==null?void 0:kn.user)||"")??""}`),V(vn,`${(((pn=(an=r().prompt)==null?void 0:an.system)==null?void 0:pn.length)||0)+(((Mn=(xn=r().prompt)==null?void 0:xn.user)==null?void 0:Mn.length)||0)} chars total`)}),N(pt,jt)};de(kt,pt=>{m(i)==="system"?pt(ut):m(i)==="email"?pt(dt,1):pt(Yt,!1)})}le(()=>{Fe=Dt(je,1,"mtab svelte-t1ig66",null,Fe,{active:m(i)==="system"}),tt=Dt(et,1,"mtab svelte-t1ig66",null,tt,{active:m(i)==="email"}),nt=Dt(Ge,1,"mtab svelte-t1ig66",null,nt,{active:m(i)==="full"})}),N(be,he)};de(W,be=>{m(a)&&be(se)})}le(()=>{V(fe,`${m(_)??""}%`),ce=Dt(Ie,1,"bar-fill svelte-t1ig66",null,ce,{done:r().phase==="done"}),$=dn(Ie,"",$,{width:`${m(_)??""}%`})}),N(E,T)};de(k,E=>{r()&&E(D)})}N(t,w),bt()}Mt(["click","keydown"]);var Cg=z('<span class="spinner svelte-ois7em"></span>'),Ig=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),Pg=z('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),Rg=z("<option> </option>"),Og=z('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),Dg=z('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function jg(t,e){_t(e,!0);let r=De(e,"engineStatus",3,"idle"),a=De(e,"modelName",3,""),i=De(e,"isScanning",3,!1),o=De(e,"scanProgress",3,null),u=De(e,"scanCount",15,20),d=De(e,"stats",3,null);const h=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function v(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function _(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function S(){return r()==="ready"&&!i()}var w=Dg(),k=y(w),D=y(k),E=y(D);{var T=Y=>{var te=Cg();N(Y,te)},U=Y=>{var te=Ig();N(Y,te)};de(E,Y=>{i()?Y(T):Y(U,!1)})}var re=x(D,2),ae=y(re),H=x(y(ae),2);H.__click=function(...Y){var te;(te=e.oninspect)==null||te.apply(this,Y)};var J=x(ae,2),ee=y(J);let F;var fe=x(ee),Ae=x(k,2);{var Ie=Y=>{var te=Pg(),W=y(te),se=y(W),be=x(W,4),he=y(be),ze=x(be,4),Ue=y(ze);le(()=>{V(se,`${d().totalEmails??""} emails in storage`),V(he,`${d().classified??""} classified`),V(Ue,`${d().unclassified??""} new`)}),N(Y,te)};de(Ae,Y=>{d()&&Y(Ie)})}var ce=x(Ae,2),$=y(ce),ie=x(y($),2);en(ie,21,()=>h,sr,(Y,te)=>{var W=Rg(),se=y(W),be={};le(()=>{V(se,m(te).label),be!==(be=m(te).value)&&(W.value=(W.__value=m(te).value)??"")}),N(Y,W)});var Pe=x($,2),oe=y(Pe);oe.__click=function(...Y){var te;(te=e.onscan)==null||te.apply(this,Y)};var ve=y(oe),pe=x(oe,2);pe.__click=function(...Y){var te;(te=e.onrescan)==null||te.apply(this,Y)};var X=x(ce,2);{var ue=Y=>{var te=Og();N(Y,te)};de(X,Y=>{r()!=="ready"&&r()!=="loading"&&Y(ue)})}var ge=x(X,2);{var we=Y=>{Ag(Y,{get progress(){return o()},get onstop(){return e.onstop}})};de(ge,Y=>{var te;(i()||((te=o())==null?void 0:te.phase)==="done")&&Y(we)})}le((Y,te,W,se)=>{F=dn(ee,"",F,Y),V(fe,` ${te??""}`),ie.disabled=i(),oe.disabled=W,V(ve,i()?"Scanning...":"Scan New"),pe.disabled=se},[()=>({background:_()}),v,()=>!S(),()=>!S()]),Lo(ie,u),N(t,w),bt()}Mt(["click"]);var Mg=z('<span class="row-date svelte-1czytqk"> </span>'),Lg=z('<span class="tag svelte-1czytqk"> </span>'),Ng=z('<span class="row-tags svelte-1czytqk"></span>'),qg=z('<span class="row-reason svelte-1czytqk"> </span>'),Bg=z('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),zg=z('<span class="status-label svelte-1czytqk"> </span>'),Fg=z('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Kg=z('<p class="summary-reason svelte-1czytqk"> </p>'),Ug=z('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Gg=z('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function uc(t,e){_t(e,!0);let r=De(e,"actionColor",3,"#666"),a=De(e,"dimmed",3,!1);function i(oe){if(!oe)return"";try{return new Date(oe).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=yt(()=>e.item.status==="pending"),u=Oe(!1);var d=Gg(),h=$e(d);let v;var _=y(h);_.__click=()=>L(u,!m(u));let S;var w=y(_),k=y(w),D=x(w,2),E=y(D),T=y(E),U=x(E,2);{var re=oe=>{var ve=Mg(),pe=y(ve);le(X=>V(pe,X),[()=>i(e.item.date)]),N(oe,ve)};de(U,oe=>{e.item.date&&oe(re)})}var ae=x(D,2);{var H=oe=>{var ve=Ng();en(ve,21,()=>e.item.tags,sr,(pe,X)=>{var ue=Lg();let ge;var we=y(ue);le(Y=>{ge=dn(ue,"",ge,Y),V(we,m(X))},[()=>({background:Sv(m(X))})]),N(pe,ue)}),N(oe,ve)};de(ae,oe=>{e.item.tags&&e.item.tags.length>0&&oe(H)})}var J=x(ae,2);{var ee=oe=>{var ve=qg(),pe=y(ve);le(()=>V(pe,e.item.reason)),N(oe,ve)};de(J,oe=>{e.item.reason&&!m(u)&&oe(ee)})}var F=x(_,2),fe=y(F);{var Ae=oe=>{var ve=Bg(),pe=$e(ve);pe.__click=()=>e.onmarkacted(e.item.emailId);var X=x(pe,2);X.__click=()=>e.ondismiss(e.item.emailId),N(oe,ve)},Ie=oe=>{var ve=zg(),pe=y(ve);le(()=>V(pe,e.item.status)),N(oe,ve)};de(fe,oe=>{m(o)?oe(Ae):oe(Ie,!1)})}var ce=x(fe,2);{var $=oe=>{var ve=Fg();ve.__click=()=>e.onremove(e.item.emailId),N(oe,ve)};de(ce,oe=>{e.onremove&&oe($)})}var ie=x(h,2);{var Pe=oe=>{var ve=Ug();let pe;var X=y(ve),ue=y(X),ge=x(X,2);{var we=Y=>{var te=Kg(),W=y(te);le(()=>V(W,e.item.reason)),N(Y,te)};de(ge,Y=>{e.item.reason&&Y(we)})}le(()=>{pe=dn(ve,"",pe,{"border-left-color":r()}),V(ue,e.item.summary)}),N(oe,ve)};de(ie,oe=>{m(u)&&e.item.summary&&oe(Pe)})}le(()=>{v=Dt(h,1,"email-row svelte-1czytqk",null,v,{dimmed:a()}),S=dn(_,"",S,{"border-left-color":r()}),V(k,e.item.subject),V(T,e.item.from)}),N(t,d),bt()}Mt(["click"]);var Hg=z('<span class="group-acted svelte-tl1unp"> </span>'),Wg=z('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Yg=z('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Vg=z('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Xg=z('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Qg=z('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Zg=z('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Jg(t,e){_t(e,!0);let r=De(e,"color",3,"#888");De(e,"count",3,0);let a=De(e,"items",19,()=>[]),i=De(e,"expanded",3,!1),o=yt(()=>a().filter(ee=>ee.status==="pending")),u=yt(()=>a().filter(ee=>ee.status!=="pending")),d=Oe(!1);function h(ee){return ee.split("_").map(F=>F.charAt(0)+F.slice(1).toLowerCase()).join(" ")}var v=Zg(),_=y(v);_.__click=function(...ee){var F;(F=e.ontoggle)==null||F.apply(this,ee)};var S=y(_);let w;var k=y(S),D=x(S,2),E=y(D),T=x(D,2);{var U=ee=>{var F=Hg(),fe=y(F);le(()=>V(fe,`${m(u).length??""} handled`)),N(ee,F)};de(T,ee=>{m(u).length>0&&ee(U)})}var re=x(T,4);let ae;var H=x(_,2);{var J=ee=>{var F=Qg(),fe=y(F);{var Ae=pe=>{var X=Wg();N(pe,X)};de(fe,pe=>{m(o).length===0&&m(u).length===0&&pe(Ae)})}var Ie=x(fe,2);en(Ie,17,()=>m(o),pe=>pe.emailId,(pe,X)=>{uc(pe,{get item(){return m(X)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ce=x(Ie,2);{var $=pe=>{var X=Yg(),ue=y(X),ge=y(ue),we=x(ue,2);en(we,17,()=>m(u),Y=>Y.emailId,(Y,te)=>{uc(Y,{get item(){return m(te)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),le(()=>V(ge,`${m(u).length??""} handled`)),N(pe,X)};de(ce,pe=>{m(u).length>0&&pe($)})}var ie=x(ce,2),Pe=y(ie);{var oe=pe=>{var X=Vg();X.__click=()=>L(d,!0),N(pe,X)},ve=pe=>{var X=Xg(),ue=y(X),ge=x(ue);ge.__click=()=>L(d,!1);var we=x(ge,2);we.__click=()=>{e.oncleargroup(),L(d,!1)},le(()=>V(ue,`Clear ${a().length??""} items? `)),N(pe,X)};de(Pe,pe=>{m(d)?pe(ve,!1):pe(oe)})}N(ee,F)};de(H,ee=>{i()&&ee(J)})}le(ee=>{w=dn(S,"",w,{background:r()}),V(k,ee),V(E,m(o).length),ae=Dt(re,0,"chevron svelte-tl1unp",null,ae,{open:i()})},[()=>h(e.action)]),N(t,v),bt()}Mt(["click"]);var $g=z(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),ey=z(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),ty=z(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),ny=z('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function ry(t,e){_t(e,!0);let r=De(e,"open",15,!1),a=De(e,"sampleEmail",3,null),i=Oe("system");function o(){return a()?Tu(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(S){S.target===S.currentTarget&&u()}var h=Mr(),v=$e(h);{var _=S=>{var w=ny();w.__click=d,w.__keydown=$=>$.key==="Escape"&&u();var k=y(w),D=y(k),E=x(y(D),2);E.__click=u;var T=x(D,2),U=y(T);let re;U.__click=()=>L(i,"system");var ae=x(U,2);let H;ae.__click=()=>L(i,"email");var J=x(ae,2);let ee;J.__click=()=>L(i,"config");var F=x(T,2),fe=y(F);{var Ae=$=>{var ie=$g(),Pe=x($e(ie),2),oe=y(Pe);le(()=>V(oe,ba)),N($,ie)},Ie=$=>{var ie=ey(),Pe=x($e(ie),2),oe=x(y(Pe),2);oe.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var ve=x(Pe,2),pe=x(y(ve),2),X=y(pe);le(ue=>V(X,ue),[o]),N($,ie)},ce=$=>{var ie=ty(),Pe=x($e(ie),2),oe=y(Pe),ve=x(y(oe),2),pe=y(ve),X=x(oe,2),ue=x(y(X),2),ge=y(ue),we=x(X,2),Y=x(y(we),2),te=y(Y),W=x(Pe,4);W.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,le(()=>{V(pe,_v.maxTokens),V(ge,"false"),V(te,"false")}),N($,ie)};de(fe,$=>{m(i)==="system"?$(Ae):m(i)==="email"?$(Ie,1):m(i)==="config"&&$(ce,2)})}le(()=>{re=Dt(U,1,"tab svelte-10pcy9j",null,re,{active:m(i)==="system"}),H=Dt(ae,1,"tab svelte-10pcy9j",null,H,{active:m(i)==="email"}),ee=Dt(J,1,"tab svelte-10pcy9j",null,ee,{active:m(i)==="config"})}),N(S,w)};de(v,S=>{r()&&S(_)})}N(t,h),bt()}Mt(["click","keydown"]);var ay=z('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),sy=z('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),iy=z('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),oy=z('<button class="chip svelte-s2dwjj"> </button>'),ly=z('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),cy=z('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),uy=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),fy=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),dy=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),vy=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),py=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),hy=z('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),my=z('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),gy=z('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),yy=z('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),_y=z('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function by(t,e){_t(e,!0);let r=De(e,"groupOrder",19,()=>[]),a=Oe(!1),i=Oe(null),o=Oe(!1),u=Oe(null);async function d(){var ce;const[F,fe,Ae]=await Promise.all([Be.items.where("sourceType").equals("gmail").count(),Be.emailClassifications.count(),Be.contacts.count()]);let Ie=0;try{const $=await((ce=navigator.storage)==null?void 0:ce.estimate());Ie=($==null?void 0:$.usage)??0}catch{}L(u,{emailCount:F,classCount:fe,contactCount:Ae,totalBytes:Ie},!0)}function h(F){return F?F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(1)} MB`:"â"}function v(){L(a,!m(a)),m(a)&&d()}async function _(F){var fe;L(o,!0),L(i,null);try{await F(),await d(),(fe=e.onrefresh)==null||fe.call(e)}finally{L(o,!1)}}async function S(){await _(()=>Ul())}async function w(F){await _(()=>zo(F))}async function k(){await _(async()=>{await Cu(),await Ul()})}async function D(){await _(()=>Be.contacts.clear())}async function E(){await _(async()=>{await Be.delete(),window.location.reload()})}function T(F){return F.split("_").map(fe=>fe.charAt(0)+fe.slice(1).toLowerCase()).join(" ")}var U=_y(),re=y(U);re.__click=v;var ae=x(y(re),2);let H;var J=x(re,2);{var ee=F=>{var fe=yy(),Ae=y(fe);{var Ie=Q=>{var Ce=sy(),je=y(Ce),Fe=y(je),et=x(je,4),tt=y(et),Ge=x(et,4),nt=y(Ge),ft=x(Ge,2);{var kt=ut=>{var dt=ay(),Yt=x($e(dt),2),pt=y(Yt);le(jt=>V(pt,`${jt??""} used`),[()=>h(m(u).totalBytes)]),N(ut,dt)};de(ft,ut=>{m(u).totalBytes&&ut(kt)})}le(()=>{V(Fe,`${m(u).emailCount??""} emails`),V(tt,`${m(u).classCount??""} classifications`),V(nt,`${m(u).contactCount??""} contacts`)}),N(Q,Ce)};de(Ae,Q=>{m(u)&&Q(Ie)})}var ce=x(Ae,2);{var $=Q=>{var Ce=ly(),je=x(y(Ce),2);en(je,21,r,sr,(Fe,et)=>{var tt=Mr(),Ge=$e(tt);{var nt=kt=>{var ut=iy(),dt=y(ut),Yt=x(dt);Yt.__click=()=>L(i,null);var pt=x(Yt,2);pt.__click=()=>w(m(et)),le(jt=>{V(dt,`Delete ${jt??""}? `),pt.disabled=m(o)},[()=>T(m(et))]),N(kt,ut)},ft=kt=>{var ut=oy();ut.__click=()=>L(i,`group:${m(et)}`);var dt=y(ut);le(Yt=>{ut.disabled=m(o),V(dt,`${Yt??""} â`)},[()=>T(m(et))]),N(kt,ut)};de(Ge,kt=>{m(i)===`group:${m(et)}`?kt(nt):kt(ft,!1)})}N(Fe,tt)}),N(Q,Ce)};de(ce,Q=>{r().length>0&&Q($)})}var ie=x(ce,2),Pe=x(y(ie),2),oe=y(Pe);{var ve=Q=>{var Ce=cy(),je=x(y(Ce),2);je.__click=()=>L(i,null);var Fe=x(je,2);Fe.__click=S,le(()=>Fe.disabled=m(o)),N(Q,Ce)},pe=Q=>{var Ce=uy();Ce.__click=()=>L(i,"classifications"),le(()=>Ce.disabled=m(o)),N(Q,Ce)};de(oe,Q=>{m(i)==="classifications"?Q(ve):Q(pe,!1)})}var X=x(oe,2);{var ue=Q=>{var Ce=fy(),je=x(y(Ce),2);je.__click=()=>L(i,null);var Fe=x(je,2);Fe.__click=k,le(()=>Fe.disabled=m(o)),N(Q,Ce)},ge=Q=>{var Ce=dy();Ce.__click=()=>L(i,"emails"),le(()=>Ce.disabled=m(o)),N(Q,Ce)};de(X,Q=>{m(i)==="emails"?Q(ue):Q(ge,!1)})}var we=x(X,2);{var Y=Q=>{var Ce=vy(),je=x(y(Ce),2);je.__click=()=>L(i,null);var Fe=x(je,2);Fe.__click=D,le(()=>Fe.disabled=m(o)),N(Q,Ce)},te=Q=>{var Ce=py();Ce.__click=()=>L(i,"contacts"),le(()=>Ce.disabled=m(o)),N(Q,Ce)};de(we,Q=>{m(i)==="contacts"?Q(Y):Q(te,!1)})}var W=x(ie,2),se=y(W);{var be=Q=>{var Ce=hy(),je=x(y(Ce),2);je.__click=()=>L(i,null);var Fe=x(je,2);Fe.__click=E,le(()=>Fe.disabled=m(o)),N(Q,Ce)},he=Q=>{var Ce=my();Ce.__click=()=>L(i,"nuke"),le(()=>Ce.disabled=m(o)),N(Q,Ce)};de(se,Q=>{m(i)==="nuke"?Q(be):Q(he,!1)})}var ze=x(W,2);{var Ue=Q=>{var Ce=gy();N(Q,Ce)};de(ze,Q=>{m(o)&&Q(Ue)})}N(F,fe)};de(J,F=>{m(a)&&F(ee)})}le(()=>H=Dt(ae,0,"chev svelte-s2dwjj",null,H,{open:m(a)})),N(t,U),bt()}Mt(["click"]);var wy=z('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),ky=z('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),xy=z('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Sy=z('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function Ty(t,e){_t(e,!0);let r=De(e,"groups",19,()=>({})),a=De(e,"groupOrder",19,()=>[]),i=De(e,"counts",19,()=>({})),o=De(e,"stats",3,null),u=De(e,"expandedGroup",3,null),d=De(e,"isScanning",3,!1),h=De(e,"scanProgress",3,null),v=De(e,"scanCount",15,20),_=De(e,"error",3,null),S=Oe(!1),w=yt(()=>{for(const ee of a()){const F=r()[ee];if((F==null?void 0:F.length)>0)return F[0]}return null});var k=Sy(),D=y(k);jg(D,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return h()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>L(S,!0),get scanCount(){return v()},set scanCount(ee){v(ee)}});var E=x(D,2);ry(E,{get sampleEmail(){return m(w)},get open(){return m(S)},set open(ee){L(S,ee,!0)}});var T=x(E,2);{var U=ee=>{var F=wy(),fe=y(F),Ae=y(fe),Ie=x(fe,2);Ie.__click=function(...ce){var $;($=e.ondismisserror)==null||$.apply(this,ce)},le(()=>V(Ae,_())),N(ee,F)};de(T,ee=>{_()&&ee(U)})}var re=x(T,2);{var ae=ee=>{var F=ky(),fe=$e(F);en(fe,20,a,$=>$,($,ie)=>{{let Pe=yt(()=>po(ie)),oe=yt(()=>{var X;return((X=r()[ie])==null?void 0:X.length)||0}),ve=yt(()=>r()[ie]||[]),pe=yt(()=>u()===ie);Jg($,{get action(){return ie},get color(){return m(Pe)},get count(){return m(oe)},get items(){return m(ve)},get expanded(){return m(pe)},ontoggle:()=>e.ontogglegroup(ie),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ie)})}});var Ae=x(fe,2),Ie=y(Ae),ce=y(Ie);le(()=>V(ce,`${i().total??""} emails classified into ${a().length??""} groups`)),N(ee,F)},H=ee=>{var F=xy();N(ee,F)};de(re,ee=>{i().total>0?ee(ae):d()||ee(H,1)})}var J=x(re,2);by(J,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),N(t,k),bt()}Mt(["click"]);var Ey=z('<div class="actions-page svelte-3tch4q"><!></div>');function Ay(t,e){_t(e,!0);const r=fu();let a=Oe(Kt(r.status)),i=Oe(""),o=Oe(Kt({})),u=Oe(Kt([])),d=Oe(Kt({total:0})),h=Oe(null),v=Oe(null),_=Oe(!1),S=Oe(null),w=Oe(20),k=Oe(null),D=Oe(null);Wt(()=>{const ce=r.onMessage($=>{if($.status==="ready"){L(a,"ready");const ie=cs.find(Pe=>Pe.id===r.modelId);L(i,(ie==null?void 0:ie.name)||r.modelId||"",!0)}$.status==="loading"&&L(a,"loading")});if(L(a,r.status,!0),r.modelId){const $=cs.find(ie=>ie.id===r.modelId);L(i,($==null?void 0:$.name)||r.modelId||"",!0)}return E(),()=>ce()});async function E(){try{const ce=await bv();L(o,ce.groups,!0),L(u,ce.order,!0),L(d,await wv(),!0),L(h,await vo(),!0)}catch(ce){L(k,`Failed to load data: ${ce.message}`)}}async function T(){await re(!1)}async function U(){await re(!0)}async function re(ce){if(m(_)||!r.isReady)return;L(k,null),L(_,!0),L(S,null);const $=new AbortController;L(D,$,!0);try{await xu(r,{count:m(w),force:ce,signal:$.signal,onProgress:ie=>{L(S,{...ie},!0)}}),await E()}catch(ie){$.signal.aborted||L(k,`Scan failed: ${ie.message}`)}finally{L(_,!1),L(D,null)}}function ae(){var ce;(ce=m(D))==null||ce.abort()}async function H(ce){await ri(ce,"acted"),await E()}async function J(ce){await ri(ce,"dismissed"),await E()}async function ee(ce){await Su(ce),await E()}async function F(ce){await zo(ce),await E()}function fe(ce){L(v,m(v)===ce?null:ce,!0)}var Ae=Ey(),Ie=y(Ae);Ty(Ie,{get engineStatus(){return m(a)},get modelName(){return m(i)},get groups(){return m(o)},get groupOrder(){return m(u)},get counts(){return m(d)},get stats(){return m(h)},get expandedGroup(){return m(v)},get isScanning(){return m(_)},get scanProgress(){return m(S)},get error(){return m(k)},onscan:T,onrescan:U,ontogglegroup:fe,onmarkacted:H,ondismiss:J,onremove:ee,oncleargroup:F,ondismisserror:()=>L(k,null),onstop:ae,onrefresh:E,get scanCount(){return m(w)},set scanCount(ce){L(w,ce,!0)}}),N(t,Ae),bt()}var Cy=z('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Iy(t,e){_t(e,!0);function r(){const F=location.hash;return F==="#dashboard"?"dashboard":F==="#actions"?"actions":"chat"}let a=Oe(Kt(r()));Wt(()=>{function F(){L(a,r(),!0)}return window.addEventListener("hashchange",F),()=>window.removeEventListener("hashchange",F)});var i=Cy(),o=y(i),u=x(y(o),2),d=y(u);let h;var v=x(d,2);let _;var S=x(v,2);let w;var k=x(o,2),D=y(k);let E;var T=y(D);Op(T,{});var U=x(D,2);let re;var ae=y(U);Ay(ae,{});var H=x(U,2);let J;var ee=y(H);cg(ee,{}),le(()=>{h=Dt(d,1,"svelte-1n46o8q",null,h,{active:m(a)==="chat"}),_=Dt(v,1,"svelte-1n46o8q",null,_,{active:m(a)==="actions"}),w=Dt(S,1,"svelte-1n46o8q",null,w,{active:m(a)==="dashboard"}),E=dn(D,"",E,{display:m(a)==="chat"?"flex":"none"}),re=dn(U,"",re,{display:m(a)==="actions"?"flex":"none"}),J=dn(H,"",J,{display:m(a)==="dashboard"?"flex":"none"})}),N(t,i),bt()}Dd(Iy,{target:document.getElementById("app")});
