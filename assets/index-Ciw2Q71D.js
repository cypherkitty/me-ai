var Dd=Object.defineProperty;var zl=t=>{throw TypeError(t)};var jd=(t,e,r)=>e in t?Dd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ot=(t,e,r)=>jd(t,typeof e!="symbol"?e+"":e,r),Ji=(t,e,r)=>e.has(t)||zl("Cannot "+r);var ie=(t,e,r)=>(Ji(t,e,"read from private field"),r?r.call(t):e.get(t)),lt=(t,e,r)=>e.has(t)?zl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),nt=(t,e,r,a)=>(Ji(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),cn=(t,e,r)=>(Ji(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const vo=!1;var qo=Array.isArray,Ld=Array.prototype.indexOf,Ga=Array.prototype.includes,yi=Array.from,Nd=Object.defineProperty,La=Object.getOwnPropertyDescriptor,qd=Object.getOwnPropertyDescriptors,Bd=Object.prototype,zd=Array.prototype,Mc=Object.getPrototypeOf,Fl=Object.isExtensible;const Fd=()=>{};function Kd(t){for(var e=0;e<t.length;e++)t[e]()}function Dc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const nn=2,xs=4,bi=8,jc=1<<24,jr=16,lr=32,Sa=64,Lc=128,Vn=512,Qt=1024,rn=2048,or=4096,Nn=8192,Mr=16384,Is=32768,Wa=65536,Kl=1<<17,Nc=1<<18,Ja=1<<19,Ud=1<<20,Rr=1<<25,ya=65536,po=1<<21,Bo=1<<22,Wr=1<<23,ma=Symbol("$state"),Gd=Symbol("legacy props"),Wd=Symbol(""),ia=new class extends Error{constructor(){super(...arguments);ot(this,"name","StaleReactionError");ot(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Hd(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Vd(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Yd(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Qd(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xd(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Zd(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Jd(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function $d(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function ef(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function tf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function nf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function rf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const af=1,sf=2,qc=4,of=8,lf=16,cf=1,uf=4,df=8,ff=16,Bc=1,vf=2,$t=Symbol(),zc="http://www.w3.org/1999/xhtml";function pf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function hf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Fc(t){return t===this.v}function mf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Kc(t){return!mf(t,this.v)}let gf=!1,qn=null;function Ha(t){qn=t}function Tt(t,e=!1,r){qn={p:qn,i:!1,c:null,e:null,s:t,x:null,l:null}}function Et(t){var e=qn,r=e.e;if(r!==null){e.e=null;for(var a of r)uu(a)}return t!==void 0&&(e.x=t),e.i=!0,qn=e.p,t??{}}function Uc(){return!0}let oa=[];function Gc(){var t=oa;oa=[],Kd(t)}function Hr(t){if(oa.length===0&&!_s){var e=oa;queueMicrotask(()=>{e===oa&&Gc()})}oa.push(t)}function _f(){for(;oa.length>0;)Gc()}function Wc(t){var e=kt;if(e===null)return ct.f|=Wr,t;if((e.f&Is)===0&&(e.f&xs)===0)throw t;Va(t,e)}function Va(t,e){for(;e!==null;){if((e.f&Lc)!==0){if((e.f&Is)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const yf=-7169;function Bt(t,e){t.f=t.f&yf|e}function zo(t){(t.f&Vn)!==0||t.deps===null?Bt(t,Qt):Bt(t,or)}function Hc(t){if(t!==null)for(const e of t)(e.f&nn)===0||(e.f&ya)===0||(e.f^=ya,Hc(e.deps))}function Vc(t,e,r){(t.f&rn)!==0?e.add(t):(t.f&or)!==0&&r.add(t),Hc(t.deps),Bt(t,Qt)}const Zs=new Set;let Ze=null,di=null,en=null,Tn=[],wi=null,ho=!1,_s=!1;var Na,qa,ua,Ba,Es,As,da,Cr,za,br,mo,go,Yc;const fl=class fl{constructor(){lt(this,br);ot(this,"committed",!1);ot(this,"current",new Map);ot(this,"previous",new Map);lt(this,Na,new Set);lt(this,qa,new Set);lt(this,ua,0);lt(this,Ba,0);lt(this,Es,null);lt(this,As,new Set);lt(this,da,new Set);lt(this,Cr,new Map);ot(this,"is_fork",!1);lt(this,za,!1)}is_deferred(){return this.is_fork||ie(this,Ba)>0}skip_effect(e){ie(this,Cr).has(e)||ie(this,Cr).set(e,{d:[],m:[]})}unskip_effect(e){var r=ie(this,Cr).get(e);if(r){ie(this,Cr).delete(e);for(var a of r.d)Bt(a,rn),sr(a);for(a of r.m)Bt(a,or),sr(a)}}process(e){var i;Tn=[],this.apply();var r=[],a=[];for(const o of e)cn(this,br,mo).call(this,o,r,a);if(this.is_deferred()){cn(this,br,go).call(this,a),cn(this,br,go).call(this,r);for(const[o,u]of ie(this,Cr))Jc(o,u)}else{for(const o of ie(this,Na))o();ie(this,Na).clear(),ie(this,ua)===0&&cn(this,br,Yc).call(this),di=this,Ze=null,Ul(a),Ul(r),di=null,(i=ie(this,Es))==null||i.resolve()}en=null}capture(e,r){r!==$t&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Wr)===0&&(this.current.set(e,e.v),en==null||en.set(e,e.v))}activate(){Ze=this,this.apply()}deactivate(){Ze===this&&(Ze=null,en=null)}flush(){if(this.activate(),Tn.length>0){if(Qc(),Ze!==null&&Ze!==this)return}else ie(this,ua)===0&&this.process([]);this.deactivate()}discard(){for(const e of ie(this,qa))e(this);ie(this,qa).clear()}increment(e){nt(this,ua,ie(this,ua)+1),e&&nt(this,Ba,ie(this,Ba)+1)}decrement(e){nt(this,ua,ie(this,ua)-1),e&&nt(this,Ba,ie(this,Ba)-1),!ie(this,za)&&(nt(this,za,!0),Hr(()=>{nt(this,za,!1),this.is_deferred()?Tn.length>0&&this.flush():this.revive()}))}revive(){for(const e of ie(this,As))ie(this,da).delete(e),Bt(e,rn),sr(e);for(const e of ie(this,da))Bt(e,or),sr(e);this.flush()}oncommit(e){ie(this,Na).add(e)}ondiscard(e){ie(this,qa).add(e)}settled(){return(ie(this,Es)??nt(this,Es,Dc())).promise}static ensure(){if(Ze===null){const e=Ze=new fl;Zs.add(Ze),_s||Hr(()=>{Ze===e&&e.flush()})}return Ze}apply(){}};Na=new WeakMap,qa=new WeakMap,ua=new WeakMap,Ba=new WeakMap,Es=new WeakMap,As=new WeakMap,da=new WeakMap,Cr=new WeakMap,za=new WeakMap,br=new WeakSet,mo=function(e,r,a){e.f^=Qt;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(lr|Sa))!==0,g=d&&(u&Qt)!==0,p=g||(u&Nn)!==0||ie(this,Cr).has(i);if(!p&&i.fn!==null){d?i.f^=Qt:o!==null&&(u&(xs|bi|jc))!==0?o.b.defer_effect(i):(u&xs)!==0?r.push(i):Rs(i)&&((u&jr)!==0&&ie(this,da).add(i),Xa(i));var b=i.first;if(b!==null){i=b;continue}}var w=i.parent;for(i=i.next;i===null&&w!==null;)w===o&&(o=null),i=w.next,w=w.parent}},go=function(e){for(var r=0;r<e.length;r+=1)Vc(e[r],ie(this,As),ie(this,da))},Yc=function(){var i;if(Zs.size>1){this.previous.clear();var e=en,r=!0;for(const o of Zs){if(o===this){r=!1;continue}const u=[];for(const[g,p]of this.current){if(o.current.has(g))if(r&&p!==o.current.get(g))o.current.set(g,p);else continue;u.push(g)}if(u.length===0)continue;const d=[...o.current.keys()].filter(g=>!this.current.has(g));if(d.length>0){var a=Tn;Tn=[];const g=new Set,p=new Map;for(const b of u)Xc(b,d,g,p);if(Tn.length>0){Ze=o,o.apply();for(const b of Tn)cn(i=o,br,mo).call(i,b,[],[]);o.deactivate()}Tn=a}}Ze=null,en=e}this.committed=!0,Zs.delete(this)};let Vr=fl;function bf(t){var e=_s;_s=!0;try{for(var r;;){if(_f(),Tn.length===0&&(Ze==null||Ze.flush(),Tn.length===0))return wi=null,r;Qc()}}finally{_s=e}}function Qc(){ho=!0;var t=null;try{for(var e=0;Tn.length>0;){var r=Vr.ensure();if(e++>1e3){var a,i;wf()}r.process(Tn),Yr.clear()}}finally{Tn=[],ho=!1,wi=null}}function wf(){try{Jd()}catch(t){Va(t,wi)}}let er=null;function Ul(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(Mr|Nn))===0&&Rs(a)&&(er=new Set,Xa(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&pu(a),(er==null?void 0:er.size)>0)){Yr.clear();for(const i of er){if((i.f&(Mr|Nn))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)er.has(u)&&(er.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const g=o[d];(g.f&(Mr|Nn))===0&&Xa(g)}}er.clear()}}er=null}}function Xc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&nn)!==0?Xc(i,e,r,a):(o&(Bo|jr))!==0&&(o&rn)===0&&Zc(i,e,a)&&(Bt(i,rn),sr(i))}}function Zc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ga.call(e,i))return!0;if((i.f&nn)!==0&&Zc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function sr(t){for(var e=wi=t;e.parent!==null;){e=e.parent;var r=e.f;if(ho&&e===kt&&(r&jr)!==0&&(r&Nc)===0)return;if((r&(Sa|lr))!==0){if((r&Qt)===0)return;e.f^=Qt}}Tn.push(e)}function Jc(t,e){if(!((t.f&lr)!==0&&(t.f&Qt)!==0)){(t.f&rn)!==0?e.d.push(t):(t.f&or)!==0&&e.m.push(t),Bt(t,Qt);for(var r=t.first;r!==null;)Jc(r,e),r=r.next}}function kf(t){let e=0,r=ba(0),a;return()=>{Uo()&&(v(r),Go(()=>(e===0&&(a=Ms(()=>t(()=>ys(r)))),e+=1,()=>{Hr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,ys(r))})})))}}var xf=Wa|Ja|Lc;function Sf(t,e,r){new Tf(t,e,r)}var Gn,No,vr,fa,pr,Wn,xn,hr,Pr,Ur,va,Gr,Fa,pa,Ka,Ua,Ir,gi,Xt,Ef,Af,_o,si,ii,yo;class Tf{constructor(e,r,a){lt(this,Xt);ot(this,"parent");ot(this,"is_pending",!1);lt(this,Gn);lt(this,No,null);lt(this,vr);lt(this,fa);lt(this,pr);lt(this,Wn,null);lt(this,xn,null);lt(this,hr,null);lt(this,Pr,null);lt(this,Ur,null);lt(this,va,0);lt(this,Gr,0);lt(this,Fa,!1);lt(this,pa,!1);lt(this,Ka,new Set);lt(this,Ua,new Set);lt(this,Ir,null);lt(this,gi,kf(()=>(nt(this,Ir,ba(ie(this,va))),()=>{nt(this,Ir,null)})));nt(this,Gn,e),nt(this,vr,r),nt(this,fa,a),this.parent=kt.b,this.is_pending=!!ie(this,vr).pending,nt(this,pr,Wo(()=>{kt.b=this;{var i=cn(this,Xt,_o).call(this);try{nt(this,Wn,Hn(()=>a(i)))}catch(o){this.error(o)}ie(this,Gr)>0?cn(this,Xt,ii).call(this):this.is_pending=!1}return()=>{var o;(o=ie(this,Ur))==null||o.remove()}},xf))}defer_effect(e){Vc(e,ie(this,Ka),ie(this,Ua))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!ie(this,vr).pending}update_pending_count(e){cn(this,Xt,yo).call(this,e),nt(this,va,ie(this,va)+e),!(!ie(this,Ir)||ie(this,Fa))&&(nt(this,Fa,!0),Hr(()=>{nt(this,Fa,!1),ie(this,Ir)&&Ya(ie(this,Ir),ie(this,va))}))}get_effect_pending(){return ie(this,gi).call(this),v(ie(this,Ir))}error(e){var r=ie(this,vr).onerror;let a=ie(this,vr).failed;if(ie(this,pa)||!r&&!a)throw e;ie(this,Wn)&&(An(ie(this,Wn)),nt(this,Wn,null)),ie(this,xn)&&(An(ie(this,xn)),nt(this,xn,null)),ie(this,hr)&&(An(ie(this,hr)),nt(this,hr,null));var i=!1,o=!1;const u=()=>{if(i){hf();return}i=!0,o&&rf(),Vr.ensure(),nt(this,va,0),ie(this,hr)!==null&&ga(ie(this,hr),()=>{nt(this,hr,null)}),this.is_pending=this.has_pending_snippet(),nt(this,Wn,cn(this,Xt,si).call(this,()=>(nt(this,pa,!1),Hn(()=>ie(this,fa).call(this,ie(this,Gn)))))),ie(this,Gr)>0?cn(this,Xt,ii).call(this):this.is_pending=!1};Hr(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){Va(d,ie(this,pr)&&ie(this,pr).parent)}a&&nt(this,hr,cn(this,Xt,si).call(this,()=>{Vr.ensure(),nt(this,pa,!0);try{return Hn(()=>{a(ie(this,Gn),()=>e,()=>u)})}catch(d){return Va(d,ie(this,pr).parent),null}finally{nt(this,pa,!1)}}))})}}Gn=new WeakMap,No=new WeakMap,vr=new WeakMap,fa=new WeakMap,pr=new WeakMap,Wn=new WeakMap,xn=new WeakMap,hr=new WeakMap,Pr=new WeakMap,Ur=new WeakMap,va=new WeakMap,Gr=new WeakMap,Fa=new WeakMap,pa=new WeakMap,Ka=new WeakMap,Ua=new WeakMap,Ir=new WeakMap,gi=new WeakMap,Xt=new WeakSet,Ef=function(){try{nt(this,Wn,Hn(()=>ie(this,fa).call(this,ie(this,Gn))))}catch(e){this.error(e)}},Af=function(){const e=ie(this,vr).pending;e&&(nt(this,xn,Hn(()=>e(ie(this,Gn)))),Hr(()=>{var r=cn(this,Xt,_o).call(this);nt(this,Wn,cn(this,Xt,si).call(this,()=>(Vr.ensure(),Hn(()=>ie(this,fa).call(this,r))))),ie(this,Gr)>0?cn(this,Xt,ii).call(this):(ga(ie(this,xn),()=>{nt(this,xn,null)}),this.is_pending=!1)}))},_o=function(){var e=ie(this,Gn);return this.is_pending&&(nt(this,Ur,Dr()),ie(this,Gn).before(ie(this,Ur)),e=ie(this,Ur)),e},si=function(e){var r=kt,a=ct,i=qn;_r(ie(this,pr)),Qn(ie(this,pr)),Ha(ie(this,pr).ctx);try{return e()}catch(o){return Wc(o),null}finally{_r(r),Qn(a),Ha(i)}},ii=function(){const e=ie(this,vr).pending;ie(this,Wn)!==null&&(nt(this,Pr,document.createDocumentFragment()),ie(this,Pr).append(ie(this,Ur)),gu(ie(this,Wn),ie(this,Pr))),ie(this,xn)===null&&nt(this,xn,Hn(()=>e(ie(this,Gn))))},yo=function(e){var r;if(!this.has_pending_snippet()){this.parent&&cn(r=this.parent,Xt,yo).call(r,e);return}if(nt(this,Gr,ie(this,Gr)+e),ie(this,Gr)===0){this.is_pending=!1;for(const a of ie(this,Ka))Bt(a,rn),sr(a);for(const a of ie(this,Ua))Bt(a,or),sr(a);ie(this,Ka).clear(),ie(this,Ua).clear(),ie(this,xn)&&ga(ie(this,xn),()=>{nt(this,xn,null)}),ie(this,Pr)&&(ie(this,Gn).before(ie(this,Pr)),nt(this,Pr,null))}};function Cf(t,e,r,a){const i=ki;var o=t.filter(k=>!k.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=Ze,d=kt,g=Pf(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(k=>k.promise)):null;function b(k){g();try{a(k)}catch(x){(d.f&Mr)===0&&Va(x,d)}u==null||u.deactivate(),bo()}if(r.length===0){p.then(()=>b(e.map(i)));return}function w(){g(),Promise.all(r.map(k=>If(k))).then(k=>b([...e.map(i),...k])).catch(k=>Va(k,d))}p?p.then(w):w()}function Pf(){var t=kt,e=ct,r=qn,a=Ze;return function(o=!0){_r(t),Qn(e),Ha(r),o&&(a==null||a.activate())}}function bo(){_r(null),Qn(null),Ha(null)}function ki(t){var e=nn|rn,r=ct!==null&&(ct.f&nn)!==0?ct:null;return kt!==null&&(kt.f|=Ja),{ctx:qn,deps:null,effects:null,equals:Fc,f:e,fn:t,reactions:null,rv:0,v:$t,wv:0,parent:r??kt,ac:null}}function If(t,e,r){let a=kt;a===null&&Vd();var i=a.b,o=void 0,u=ba($t),d=!ct,g=new Map;return Gf(()=>{var x;var p=Dc();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{b===Ze&&b.committed&&b.deactivate(),bo()})}catch(N){p.reject(N),bo()}var b=Ze;if(d){var w=i.is_rendered();i.update_pending_count(1),b.increment(w),(x=g.get(b))==null||x.reject(ia),g.delete(b),g.set(b,p)}const k=(N,C=void 0)=>{if(b.activate(),C)C!==ia&&(u.f|=Wr,Ya(u,C));else{(u.f&Wr)!==0&&(u.f^=Wr),Ya(u,N);for(const[A,Q]of g){if(g.delete(A),A===b)break;Q.reject(ia)}}d&&(i.update_pending_count(-1),b.decrement(w))};p.promise.then(k,N=>k(null,N||"unknown"))}),cu(()=>{for(const p of g.values())p.reject(ia)}),new Promise(p=>{function b(w){function k(){w===o?p(u):b(o)}w.then(k,k)}b(o)})}function bt(t){const e=ki(t);return _u(e),e}function $c(t){const e=ki(t);return e.equals=Kc,e}function Of(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)An(e[r])}}function Rf(t){for(var e=t.parent;e!==null;){if((e.f&nn)===0)return(e.f&Mr)===0?e:null;e=e.parent}return null}function Fo(t){var e,r=kt;_r(Rf(t));try{t.f&=~ya,Of(t),e=ku(t)}finally{_r(r)}return e}function eu(t){var e=Fo(t);if(!t.equals(e)&&(t.wv=bu(),(!(Ze!=null&&Ze.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){Bt(t,Qt);return}Xr||(en!==null?(Uo()||Ze!=null&&Ze.is_fork)&&en.set(t,e):zo(t))}function Mf(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(ia),a.teardown=Fd,a.ac=null,Ss(a,0),Ho(a))}function tu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Xa(e)}let wo=new Set;const Yr=new Map;let nu=!1;function ba(t,e){var r={f:0,v:t,reactions:null,equals:Fc,rv:0,wv:0};return r}function Re(t,e){const r=ba(t);return _u(r),r}function Df(t,e=!1,r=!0){const a=ba(t);return e||(a.equals=Kc),a}function I(t,e,r=!1){ct!==null&&(!ir||(ct.f&Kl)!==0)&&Uc()&&(ct.f&(nn|jr|Bo|Kl))!==0&&(Yn===null||!Ga.call(Yn,t))&&nf();let a=r?Ft(e):e;return Ya(t,a)}function Ya(t,e){if(!t.equals(e)){var r=t.v;Xr?Yr.set(t,e):Yr.set(t,r),t.v=e;var a=Vr.ensure();if(a.capture(t,r),(t.f&nn)!==0){const i=t;(t.f&rn)!==0&&Fo(i),zo(i)}t.wv=bu(),ru(t,rn),kt!==null&&(kt.f&Qt)!==0&&(kt.f&(lr|Sa))===0&&(Un===null?Hf([t]):Un.push(t)),!a.is_fork&&wo.size>0&&!nu&&jf()}return e}function jf(){nu=!1;for(const t of wo)(t.f&Qt)!==0&&Bt(t,or),Rs(t)&&Xa(t);wo.clear()}function ys(t){I(t,t.v+1)}function ru(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&rn)===0;if(d&&Bt(o,e),(u&nn)!==0){var g=o;en==null||en.delete(g),(u&ya)===0&&(u&Vn&&(o.f|=ya),ru(g,or))}else d&&((u&jr)!==0&&er!==null&&er.add(o),sr(o))}}function Ft(t){if(typeof t!="object"||t===null||ma in t)return t;const e=Mc(t);if(e!==Bd&&e!==zd)return t;var r=new Map,a=qo(t),i=Re(0),o=_a,u=d=>{if(_a===o)return d();var g=ct,p=_a;Qn(null),Yl(o);var b=d();return Qn(g),Yl(p),b};return a&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(d,g,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&ef();var b=r.get(g);return b===void 0?u(()=>{var w=Re(p.value);return r.set(g,w),w}):I(b,p.value,!0),!0},deleteProperty(d,g){var p=r.get(g);if(p===void 0){if(g in d){const b=u(()=>Re($t));r.set(g,b),ys(i)}}else I(p,$t),ys(i);return!0},get(d,g,p){var x;if(g===ma)return t;var b=r.get(g),w=g in d;if(b===void 0&&(!w||(x=La(d,g))!=null&&x.writable)&&(b=u(()=>{var N=Ft(w?d[g]:$t),C=Re(N);return C}),r.set(g,b)),b!==void 0){var k=v(b);return k===$t?void 0:k}return Reflect.get(d,g,p)},getOwnPropertyDescriptor(d,g){var p=Reflect.getOwnPropertyDescriptor(d,g);if(p&&"value"in p){var b=r.get(g);b&&(p.value=v(b))}else if(p===void 0){var w=r.get(g),k=w==null?void 0:w.v;if(w!==void 0&&k!==$t)return{enumerable:!0,configurable:!0,value:k,writable:!0}}return p},has(d,g){var k;if(g===ma)return!0;var p=r.get(g),b=p!==void 0&&p.v!==$t||Reflect.has(d,g);if(p!==void 0||kt!==null&&(!b||(k=La(d,g))!=null&&k.writable)){p===void 0&&(p=u(()=>{var x=b?Ft(d[g]):$t,N=Re(x);return N}),r.set(g,p));var w=v(p);if(w===$t)return!1}return b},set(d,g,p,b){var H;var w=r.get(g),k=g in d;if(a&&g==="length")for(var x=p;x<w.v;x+=1){var N=r.get(x+"");N!==void 0?I(N,$t):x in d&&(N=u(()=>Re($t)),r.set(x+"",N))}if(w===void 0)(!k||(H=La(d,g))!=null&&H.writable)&&(w=u(()=>Re(void 0)),I(w,Ft(p)),r.set(g,w));else{k=w.v!==$t;var C=u(()=>Ft(p));I(w,C)}var A=Reflect.getOwnPropertyDescriptor(d,g);if(A!=null&&A.set&&A.set.call(b,p),!k){if(a&&typeof g=="string"){var Q=r.get("length"),de=Number(g);Number.isInteger(de)&&de>=Q.v&&I(Q,de+1)}ys(i)}return!0},ownKeys(d){v(i);var g=Reflect.ownKeys(d).filter(w=>{var k=r.get(w);return k===void 0||k.v!==$t});for(var[p,b]of r)b.v!==$t&&!(p in d)&&g.push(p);return g},setPrototypeOf(){tf()}})}function Gl(t){try{if(t!==null&&typeof t=="object"&&ma in t)return t[ma]}catch{}return t}function Lf(t,e){return Object.is(Gl(t),Gl(e))}var Wl,au,su,iu;function Nf(){if(Wl===void 0){Wl=window,au=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;su=La(e,"firstChild").get,iu=La(e,"nextSibling").get,Fl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Fl(r)&&(r.__t=void 0)}}function Dr(t=""){return document.createTextNode(t)}function Ln(t){return su.call(t)}function Os(t){return iu.call(t)}function m(t,e){return Ln(t)}function Qe(t,e=!1){{var r=Ln(t);return r instanceof Comment&&r.data===""?Os(r):r}}function _(t,e=1,r=!1){let a=t;for(;e--;)a=Os(a);return a}function qf(t){t.textContent=""}function ou(){return!1}function Bf(t,e,r){return document.createElementNS(zc,t,void 0)}let Hl=!1;function zf(){Hl||(Hl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Ko(t){var e=ct,r=kt;Qn(null),_r(null);try{return t()}finally{Qn(e),_r(r)}}function lu(t,e,r,a=r){t.addEventListener(e,()=>Ko(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),zf()}function Ff(t){kt===null&&(ct===null&&Zd(),Xd()),Xr&&Qd()}function Kf(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Lr(t,e,r){var a=kt;a!==null&&(a.f&Nn)!==0&&(t|=Nn);var i={ctx:qn,deps:null,nodes:null,f:t|rn|Vn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Xa(i)}catch(d){throw An(i),d}else e!==null&&sr(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ja)===0&&(o=o.first,(t&jr)!==0&&(t&Wa)!==0&&o!==null&&(o.f|=Wa)),o!==null&&(o.parent=a,a!==null&&Kf(o,a),ct!==null&&(ct.f&nn)!==0&&(t&Sa)===0)){var u=ct;(u.effects??(u.effects=[])).push(o)}return i}function Uo(){return ct!==null&&!ir}function cu(t){const e=Lr(bi,null,!1);return Bt(e,Qt),e.teardown=t,e}function Qa(t){Ff();var e=kt.f,r=!ct&&(e&lr)!==0&&(e&Is)===0;if(r){var a=qn;(a.e??(a.e=[])).push(t)}else return uu(t)}function uu(t){return Lr(xs|Ud,t,!1)}function Uf(t){Vr.ensure();const e=Lr(Sa|Ja,t,!0);return(r={})=>new Promise(a=>{r.outro?ga(e,()=>{An(e),a(void 0)}):(An(e),a(void 0))})}function du(t){return Lr(xs,t,!1)}function Gf(t){return Lr(Bo|Ja,t,!0)}function Go(t,e=0){return Lr(bi|e,t,!0)}function ee(t,e=[],r=[],a=[]){Cf(a,e,r,i=>{Lr(bi,()=>t(...i.map(v)),!0)})}function Wo(t,e=0){var r=Lr(jr|e,t,!0);return r}function Hn(t){return Lr(lr|Ja,t,!0)}function fu(t){var e=t.teardown;if(e!==null){const r=Xr,a=ct;Vl(!0),Qn(null);try{e.call(null)}finally{Vl(r),Qn(a)}}}function Ho(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Ko(()=>{i.abort(ia)});var a=r.next;(r.f&Sa)!==0?r.parent=null:An(r,e),r=a}}function Wf(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&lr)===0&&An(e),e=r}}function An(t,e=!0){var r=!1;(e||(t.f&Nc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(vu(t.nodes.start,t.nodes.end),r=!0),Ho(t,e&&!r),Ss(t,0),Bt(t,Mr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();fu(t);var i=t.parent;i!==null&&i.first!==null&&pu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function vu(t,e){for(;t!==null;){var r=t===e?null:Os(t);t.remove(),t=r}}function pu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ga(t,e,r=!0){var a=[];hu(t,a,!0);var i=()=>{r&&An(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function hu(t,e,r){if((t.f&Nn)===0){t.f^=Nn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Wa)!==0||(i.f&lr)!==0&&(t.f&jr)!==0;hu(i,e,u?r:!1),i=o}}}function Vo(t){mu(t,!0)}function mu(t,e){if((t.f&Nn)!==0){t.f^=Nn,(t.f&Qt)===0&&(Bt(t,rn),sr(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Wa)!==0||(r.f&lr)!==0;mu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function gu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:Os(r);e.append(r),r=i}}let oi=!1,Xr=!1;function Vl(t){Xr=t}let ct=null,ir=!1;function Qn(t){ct=t}let kt=null;function _r(t){kt=t}let Yn=null;function _u(t){ct!==null&&(Yn===null?Yn=[t]:Yn.push(t))}let En=null,Dn=0,Un=null;function Hf(t){Un=t}let yu=1,la=0,_a=la;function Yl(t){_a=t}function bu(){return++yu}function Rs(t){var e=t.f;if((e&rn)!==0)return!0;if(e&nn&&(t.f&=~ya),(e&or)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(Rs(o)&&eu(o),o.wv>t.wv)return!0}(e&Vn)!==0&&en===null&&Bt(t,Qt)}return!1}function wu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Yn!==null&&Ga.call(Yn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&nn)!==0?wu(o,e,!1):e===o&&(r?Bt(o,rn):(o.f&Qt)!==0&&Bt(o,or),sr(o))}}function ku(t){var C;var e=En,r=Dn,a=Un,i=ct,o=Yn,u=qn,d=ir,g=_a,p=t.f;En=null,Dn=0,Un=null,ct=(p&(lr|Sa))===0?t:null,Yn=null,Ha(t.ctx),ir=!1,_a=++la,t.ac!==null&&(Ko(()=>{t.ac.abort(ia)}),t.ac=null);try{t.f|=po;var b=t.fn,w=b();t.f|=Is;var k=t.deps,x=Ze==null?void 0:Ze.is_fork;if(En!==null){var N;if(x||Ss(t,Dn),k!==null&&Dn>0)for(k.length=Dn+En.length,N=0;N<En.length;N++)k[Dn+N]=En[N];else t.deps=k=En;if(Uo()&&(t.f&Vn)!==0)for(N=Dn;N<k.length;N++)((C=k[N]).reactions??(C.reactions=[])).push(t)}else!x&&k!==null&&Dn<k.length&&(Ss(t,Dn),k.length=Dn);if(Uc()&&Un!==null&&!ir&&k!==null&&(t.f&(nn|or|rn))===0)for(N=0;N<Un.length;N++)wu(Un[N],t);if(i!==null&&i!==t){if(la++,i.deps!==null)for(let A=0;A<r;A+=1)i.deps[A].rv=la;if(e!==null)for(const A of e)A.rv=la;Un!==null&&(a===null?a=Un:a.push(...Un))}return(t.f&Wr)!==0&&(t.f^=Wr),w}catch(A){return Wc(A)}finally{t.f^=po,En=e,Dn=r,Un=a,ct=i,Yn=o,Ha(u),ir=d,_a=g}}function Vf(t,e){let r=e.reactions;if(r!==null){var a=Ld.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&nn)!==0&&(En===null||!Ga.call(En,e))){var o=e;(o.f&Vn)!==0&&(o.f^=Vn,o.f&=~ya),zo(o),Mf(o),Ss(o,0)}}function Ss(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Vf(t,r[a])}function Xa(t){var e=t.f;if((e&Mr)===0){Bt(t,Qt);var r=kt,a=oi;kt=t,oi=!0;try{(e&(jr|jc))!==0?Wf(t):Ho(t),fu(t);var i=ku(t);t.teardown=typeof i=="function"?i:null,t.wv=yu;var o;vo&&gf&&(t.f&rn)!==0&&t.deps}finally{oi=a,kt=r}}}async function xu(){await Promise.resolve(),bf()}function v(t){var e=t.f,r=(e&nn)!==0;if(ct!==null&&!ir){var a=kt!==null&&(kt.f&Mr)!==0;if(!a&&(Yn===null||!Ga.call(Yn,t))){var i=ct.deps;if((ct.f&po)!==0)t.rv<la&&(t.rv=la,En===null&&i!==null&&i[Dn]===t?Dn++:En===null?En=[t]:En.push(t));else{(ct.deps??(ct.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[ct]:Ga.call(o,ct)||o.push(ct)}}}if(Xr&&Yr.has(t))return Yr.get(t);if(r){var u=t;if(Xr){var d=u.v;return((u.f&Qt)===0&&u.reactions!==null||Tu(u))&&(d=Fo(u)),Yr.set(u,d),d}var g=(u.f&Vn)===0&&!ir&&ct!==null&&(oi||(ct.f&Vn)!==0),p=(u.f&Is)===0;Rs(u)&&(g&&(u.f|=Vn),eu(u)),g&&!p&&(tu(u),Su(u))}if(en!=null&&en.has(t))return en.get(t);if((t.f&Wr)!==0)throw t.v;return t.v}function Su(t){if(t.f|=Vn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&nn)!==0&&(e.f&Vn)===0&&(tu(e),Su(e))}function Tu(t){if(t.v===$t)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Yr.has(e)||(e.f&nn)!==0&&Tu(e))return!0;return!1}function Ms(t){var e=ir;try{return ir=!0,t()}finally{ir=e}}const Yf=["touchstart","touchmove"];function Qf(t){return Yf.includes(t)}const Eu=new Set,ko=new Set;function zt(t){for(var e=0;e<t.length;e++)Eu.add(t[e]);for(var r of ko)r(t)}let Ql=null;function Xl(t){var A;var e=this,r=e.ownerDocument,a=t.type,i=((A=t.composedPath)==null?void 0:A.call(t))||[],o=i[0]||t.target;Ql=t;var u=0,d=Ql===t&&t.__root;if(d){var g=i.indexOf(d);if(g!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;g<=p&&(u=g)}if(o=i[u]||t.target,o!==e){Nd(t,"currentTarget",{configurable:!0,get(){return o||r}});var b=ct,w=kt;Qn(null),_r(null);try{for(var k,x=[];o!==null;){var N=o.assignedSlot||o.parentNode||o.host||null;try{var C=o["__"+a];C!=null&&(!o.disabled||t.target===o)&&C.call(o,t)}catch(Q){k?x.push(Q):k=Q}if(t.cancelBubble||N===e||N===null)break;o=N}if(k){for(let Q of x)queueMicrotask(()=>{throw Q});throw k}}finally{t.__root=e,delete t.currentTarget,Qn(b),_r(w)}}}var Ic,Oc;const $i=(Oc=(Ic=globalThis==null?void 0:globalThis.window)==null?void 0:Ic.trustedTypes)==null?void 0:Oc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Xf(t){return($i==null?void 0:$i.createHTML(t))??t}function Yo(t,e=!1){var r=Bf("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Xf(t):t,r.content}function wa(t,e){var r=kt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function L(t,e){var r=(e&Bc)!==0,a=(e&vf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Yo(o?t:"<!>"+t,!0),r||(i=Ln(i)));var u=a||au?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=Ln(u),g=u.lastChild;wa(d,g)}else wa(u,u);return u}}function Zf(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Bc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=Yo(o,!0),g=Ln(d);if(i)for(u=document.createDocumentFragment();Ln(g);)u.appendChild(Ln(g));else u=Ln(g)}var p=u.cloneNode(!0);if(i){var b=Ln(p),w=p.lastChild;wa(b,w)}else wa(p,p);return p}}function Qo(t,e){return Zf(t,e,"svg")}function Za(t=""){{var e=Dr(t+"");return wa(e,e),e}}function yr(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Dr();return t.append(e,r),wa(e,r),t}function E(t,e){t!==null&&t.before(e)}function U(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Jf(t,e){return $f(t,e)}const Js=new Map;function $f(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Nf();var d=new Set,g=w=>{for(var k=0;k<w.length;k++){var x=w[k];if(!d.has(x)){d.add(x);var N=Qf(x);for(const Q of[e,document]){var C=Js.get(Q);C===void 0&&(C=new Map,Js.set(Q,C));var A=C.get(x);A===void 0?(Q.addEventListener(x,Xl,{passive:N}),C.set(x,1)):C.set(x,A+1)}}}};g(yi(Eu)),ko.add(g);var p=void 0,b=Uf(()=>{var w=r??e.appendChild(Dr());return Sf(w,{pending:()=>{}},k=>{Tt({});var x=qn;o&&(x.c=o),i&&(a.$$events=i),p=t(k,a)||{},Et()}),()=>{var C;for(var k of d)for(const A of[e,document]){var x=Js.get(A),N=x.get(k);--N==0?(A.removeEventListener(k,Xl),x.delete(k),x.size===0&&Js.delete(A)):x.set(k,N)}ko.delete(g),w!==r&&((C=w.parentNode)==null||C.removeChild(w))}});return ev.set(p,b),p}let ev=new WeakMap;var nr,mr,jn,ha,Cs,Ps,_i;class tv{constructor(e,r=!0){ot(this,"anchor");lt(this,nr,new Map);lt(this,mr,new Map);lt(this,jn,new Map);lt(this,ha,new Set);lt(this,Cs,!0);lt(this,Ps,()=>{var e=Ze;if(ie(this,nr).has(e)){var r=ie(this,nr).get(e),a=ie(this,mr).get(r);if(a)Vo(a),ie(this,ha).delete(r);else{var i=ie(this,jn).get(r);i&&(ie(this,mr).set(r,i.effect),ie(this,jn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of ie(this,nr)){if(ie(this,nr).delete(o),o===e)break;const d=ie(this,jn).get(u);d&&(An(d.effect),ie(this,jn).delete(u))}for(const[o,u]of ie(this,mr)){if(o===r||ie(this,ha).has(o))continue;const d=()=>{if(Array.from(ie(this,nr).values()).includes(o)){var p=document.createDocumentFragment();gu(u,p),p.append(Dr()),ie(this,jn).set(o,{effect:u,fragment:p})}else An(u);ie(this,ha).delete(o),ie(this,mr).delete(o)};ie(this,Cs)||!a?(ie(this,ha).add(o),ga(u,d,!1)):d()}}});lt(this,_i,e=>{ie(this,nr).delete(e);const r=Array.from(ie(this,nr).values());for(const[a,i]of ie(this,jn))r.includes(a)||(An(i.effect),ie(this,jn).delete(a))});this.anchor=e,nt(this,Cs,r)}ensure(e,r){var a=Ze,i=ou();if(r&&!ie(this,mr).has(e)&&!ie(this,jn).has(e))if(i){var o=document.createDocumentFragment(),u=Dr();o.append(u),ie(this,jn).set(e,{effect:Hn(()=>r(u)),fragment:o})}else ie(this,mr).set(e,Hn(()=>r(this.anchor)));if(ie(this,nr).set(a,e),i){for(const[d,g]of ie(this,mr))d===e?a.unskip_effect(g):a.skip_effect(g);for(const[d,g]of ie(this,jn))d===e?a.unskip_effect(g.effect):a.skip_effect(g.effect);a.oncommit(ie(this,Ps)),a.ondiscard(ie(this,_i))}else ie(this,Ps).call(this)}}nr=new WeakMap,mr=new WeakMap,jn=new WeakMap,ha=new WeakMap,Cs=new WeakMap,Ps=new WeakMap,_i=new WeakMap;function re(t,e,r=!1){var a=new tv(t),i=r?Wa:0;function o(u,d){a.ensure(u,d)}Wo(()=>{var u=!1;e((d,g=0)=>{u=!0,o(g,d)}),u||o(!1,null)},i)}function gn(t,e){return e}function nv(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let w=e[d];ga(w,()=>{if(o){if(o.pending.delete(w),o.done.add(w),o.pending.size===0){var k=t.outrogroups;xo(yi(o.done)),k.delete(o),k.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var g=a.length===0&&r!==null;if(g){var p=r,b=p.parentNode;qf(b),b.append(p),t.items.clear()}xo(e,!g)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function xo(t,e=!0){for(var r=0;r<t.length;r++)An(t[r],e)}var Zl;function Kt(t,e,r,a,i,o=null){var u=t,d=new Map,g=(e&qc)!==0;if(g){var p=t;u=p.appendChild(Dr())}var b=null,w=$c(()=>{var Q=r();return qo(Q)?Q:Q==null?[]:yi(Q)}),k,x=!0;function N(){A.fallback=b,rv(A,k,u,e,a),b!==null&&(k.length===0?(b.f&Rr)===0?Vo(b):(b.f^=Rr,ms(b,null,u)):ga(b,()=>{b=null}))}var C=Wo(()=>{k=v(w);for(var Q=k.length,de=new Set,H=Ze,q=ou(),X=0;X<Q;X+=1){var te=k[X],G=a(te,X),ce=x?null:d.get(G);ce?(ce.v&&Ya(ce.v,te),ce.i&&Ya(ce.i,X),q&&H.unskip_effect(ce.e)):(ce=av(d,x?u:Zl??(Zl=Dr()),te,G,X,i,e,r),x||(ce.e.f|=Rr),d.set(G,ce)),de.add(G)}if(Q===0&&o&&!b&&(x?b=Hn(()=>o(u)):(b=Hn(()=>o(Zl??(Zl=Dr()))),b.f|=Rr)),Q>de.size&&Yd(),!x)if(q){for(const[be,Ee]of d)de.has(be)||H.skip_effect(Ee.e);H.oncommit(N),H.ondiscard(()=>{})}else N();v(w)}),A={effect:C,items:d,outrogroups:null,fallback:b};x=!1}function ls(t){for(;t!==null&&(t.f&lr)===0;)t=t.next;return t}function rv(t,e,r,a,i){var Ee,fe,ne,oe,Te,ue,_e,ke,ae;var o=(a&of)!==0,u=e.length,d=t.items,g=ls(t.effect.first),p,b=null,w,k=[],x=[],N,C,A,Q;if(o)for(Q=0;Q<u;Q+=1)N=e[Q],C=i(N,Q),A=d.get(C).e,(A.f&Rr)===0&&((fe=(Ee=A.nodes)==null?void 0:Ee.a)==null||fe.measure(),(w??(w=new Set)).add(A));for(Q=0;Q<u;Q+=1){if(N=e[Q],C=i(N,Q),A=d.get(C).e,t.outrogroups!==null)for(const pe of t.outrogroups)pe.pending.delete(A),pe.done.delete(A);if((A.f&Rr)!==0)if(A.f^=Rr,A===g)ms(A,null,r);else{var de=b?b.next:g;A===t.effect.last&&(t.effect.last=A.prev),A.prev&&(A.prev.next=A.next),A.next&&(A.next.prev=A.prev),Fr(t,b,A),Fr(t,A,de),ms(A,de,r),b=A,k=[],x=[],g=ls(b.next);continue}if((A.f&Nn)!==0&&(Vo(A),o&&((oe=(ne=A.nodes)==null?void 0:ne.a)==null||oe.unfix(),(w??(w=new Set)).delete(A))),A!==g){if(p!==void 0&&p.has(A)){if(k.length<x.length){var H=x[0],q;b=H.prev;var X=k[0],te=k[k.length-1];for(q=0;q<k.length;q+=1)ms(k[q],H,r);for(q=0;q<x.length;q+=1)p.delete(x[q]);Fr(t,X.prev,te.next),Fr(t,b,X),Fr(t,te,H),g=H,b=te,Q-=1,k=[],x=[]}else p.delete(A),ms(A,g,r),Fr(t,A.prev,A.next),Fr(t,A,b===null?t.effect.first:b.next),Fr(t,b,A),b=A;continue}for(k=[],x=[];g!==null&&g!==A;)(p??(p=new Set)).add(g),x.push(g),g=ls(g.next);if(g===null)continue}(A.f&Rr)===0&&k.push(A),b=A,g=ls(A.next)}if(t.outrogroups!==null){for(const pe of t.outrogroups)pe.pending.size===0&&(xo(yi(pe.done)),(Te=t.outrogroups)==null||Te.delete(pe));t.outrogroups.size===0&&(t.outrogroups=null)}if(g!==null||p!==void 0){var G=[];if(p!==void 0)for(A of p)(A.f&Nn)===0&&G.push(A);for(;g!==null;)(g.f&Nn)===0&&g!==t.fallback&&G.push(g),g=ls(g.next);var ce=G.length;if(ce>0){var be=(a&qc)!==0&&u===0?r:null;if(o){for(Q=0;Q<ce;Q+=1)(_e=(ue=G[Q].nodes)==null?void 0:ue.a)==null||_e.measure();for(Q=0;Q<ce;Q+=1)(ae=(ke=G[Q].nodes)==null?void 0:ke.a)==null||ae.fix()}nv(t,G,be)}}o&&Hr(()=>{var pe,ve;if(w!==void 0)for(A of w)(ve=(pe=A.nodes)==null?void 0:pe.a)==null||ve.apply()})}function av(t,e,r,a,i,o,u,d){var g=(u&af)!==0?(u&lf)===0?Df(r,!1,!1):ba(r):null,p=(u&sf)!==0?ba(i):null;return{v:g,i:p,e:Hn(()=>(o(e,g??r,p??i,d),()=>{t.delete(a)}))}}function ms(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&Rr)===0?e.nodes.start:r;a!==null;){var u=Os(a);if(o.before(a),a===i)return;a=u}}function Fr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function sv(t,e,r=!1,a=!1,i=!1){var o=t,u="";ee(()=>{var d=kt;if(u!==(u=e()??"")&&(d.nodes!==null&&(vu(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var g=u+"";r?g=`<svg>${g}</svg>`:a&&(g=`<math>${g}</math>`);var p=Yo(g);if((r||a)&&(p=Ln(p)),wa(Ln(p),p.lastChild),r||a)for(;Ln(p);)o.before(Ln(p));else o.before(p)}})}const Jl=[...` 	
\r\fÂ \v\uFEFF`];function iv(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||Jl.includes(a[u-1]))&&(d===a.length||Jl.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function $l(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function eo(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function ov(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,g=[];a&&g.push(...Object.keys(a).map(eo)),i&&g.push(...Object.keys(i).map(eo));var p=0,b=-1;const C=t.length;for(var w=0;w<C;w++){var k=t[w];if(d?k==="/"&&t[w-1]==="*"&&(d=!1):o?o===k&&(o=!1):k==="/"&&t[w+1]==="*"?d=!0:k==='"'||k==="'"?o=k:k==="("?u++:k===")"&&u--,!d&&o===!1&&u===0){if(k===":"&&b===-1)b=w;else if(k===";"||w===C-1){if(b!==-1){var x=eo(t.substring(p,b).trim());if(!g.includes(x)){k!==";"&&w++;var N=t.substring(p,w).trim();r+=" "+N+";"}}p=w+1,b=-1}}}}return a&&(r+=$l(a)),i&&(r+=$l(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Mt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=iv(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var g in o){var p=!!o[g];(i==null||p!==!!i[g])&&t.classList.toggle(g,p)}return o}function to(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function Cn(t,e,r,a){var i=t.__style;if(i!==e){var o=ov(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(to(t,r==null?void 0:r[0],a[0]),to(t,r==null?void 0:r[1],a[1],"important")):to(t,r,a));return a}function Au(t,e,r=!1){if(t.multiple){if(e==null)return;if(!qo(e))return pf();for(var a of t.options)a.selected=e.includes(bs(a));return}for(a of t.options){var i=bs(a);if(Lf(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function lv(t){var e=new MutationObserver(()=>{Au(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),cu(()=>{e.disconnect()})}function xi(t,e,r=e){var a=new WeakSet,i=!0;lu(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),bs);else{var g=t.querySelector(u)??t.querySelector("option:not([disabled])");d=g&&bs(g)}r(d),Ze!==null&&a.add(Ze)}),du(()=>{var o=e();if(t===document.activeElement){var u=di??Ze;if(a.has(u))return}if(Au(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=bs(d),r(o))}t.__value=o,i=!1}),lv(t)}function bs(t){return"__value"in t?t.__value:t.value}const cv=Symbol("is custom element"),uv=Symbol("is html");function Xo(t,e,r,a){var i=dv(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Wd]=r),r==null?t.removeAttribute(e):typeof r!="string"&&fv(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function dv(t){return t.__attributes??(t.__attributes={[cv]:t.nodeName.includes("-"),[uv]:t.namespaceURI===zc})}var ec=new Map;function fv(t){var e=t.getAttribute("is")||t.nodeName,r=ec.get(e);if(r)return r;ec.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=qd(i);for(var u in a)a[u].set&&r.push(u);i=Mc(i)}return r}function Si(t,e,r=e){var a=new WeakSet;lu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=no(t)?ro(o):o,r(o),Ze!==null&&a.add(Ze),await xu(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,g=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;u===d&&d===g&&p>g?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=u,t.selectionEnd=Math.min(d,p))}}}),Ms(e)==null&&t.value&&(r(no(t)?ro(t.value):t.value),Ze!==null&&a.add(Ze)),Go(()=>{var i=e();if(t===document.activeElement){var o=di??Ze;if(a.has(o))return}no(t)&&i===ro(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function no(t){var e=t.type;return e==="number"||e==="range"}function ro(t){return t===""?null:+t}function tc(t,e){return t===e||(t==null?void 0:t[ma])===e}function Cu(t={},e,r,a){return du(()=>{var i,o;return Go(()=>{i=o,o=[],Ms(()=>{t!==r(...o)&&(e(t,...o),i&&tc(r(...i),t)&&e(null,...i))})}),()=>{Hr(()=>{o&&tc(r(...o),t)&&e(null,...o)})}}),t}let $s=!1;function vv(t){var e=$s;try{return $s=!1,[t(),$s]}finally{$s=e}}function De(t,e,r,a){var de;var i=(r&df)!==0,o=(r&ff)!==0,u=a,d=!0,g=()=>(d&&(d=!1,u=o?Ms(a):a),u),p;if(i){var b=ma in t||Gd in t;p=((de=La(t,e))==null?void 0:de.set)??(b&&e in t?H=>t[e]=H:void 0)}var w,k=!1;i?[w,k]=vv(()=>t[e]):w=t[e],w===void 0&&a!==void 0&&(w=g(),p&&($d(),p(w)));var x;if(x=()=>{var H=t[e];return H===void 0?g():(d=!0,H)},(r&uf)===0)return x;if(p){var N=t.$$legacy;return(function(H,q){return arguments.length>0?((!q||N||k)&&p(q?x():H),H):x()})}var C=!1,A=((r&cf)!==0?ki:$c)(()=>(C=!1,x()));i&&v(A);var Q=kt;return(function(H,q){if(arguments.length>0){const X=q?v(A):i?Ft(H):H;return I(A,X),C=!0,u!==void 0&&(u=X),H}return Xr&&C||(Q.f&Mr)!==0?A.v:v(A)})}function an(t){qn===null&&Hd(),Qa(()=>{const e=Ms(t);if(typeof e=="function")return e})}const pv="5";var Rc;typeof window<"u"&&((Rc=window.__svelte??(window.__svelte={})).v??(Rc.v=new Set)).add(pv);const gr=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",contextWindow:32768,maxEmailTokens:4e3,description:"Fastest, 32k context, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",contextWindow:32768,maxEmailTokens:6e3,description:"Balanced speed and quality, 32k context"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",contextWindow:32768,maxEmailTokens:12e3,description:"Best reasoning, 32k context, recommended for email",recommendedForEmailProcessing:!0},{id:"onnx-community/Phi-3.5-mini-instruct-onnx-web",name:"Phi-3.5 Mini",size:"~2.5 GB",contextWindow:131072,maxEmailTokens:16e3,description:"128k context, WebGPU-optimized, best for very long emails",recommendedForEmailProcessing:!0},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",contextWindow:32768,maxEmailTokens:5e3,description:"Strong reasoning, CoT focused, 32k context"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Microsoft, good at reasoning, 16k context"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",contextWindow:8192,maxEmailTokens:2e3,description:"Smallest, ultra fast, 8k context, not for long emails"}];function Zo(t){return gr.find(e=>e.id===t)}const hv=Object.freeze(Object.defineProperty({__proto__:null,MODELS:gr,getModelInfo:Zo},Symbol.toStringTag,{value:"Module"})),Qr=[{name:"qwen3:4b",displayName:"Qwen3 4B",params:"4B",contextWindow:131072,description:"Latest Qwen, 128k context, enhanced reasoning",tags:["multilingual","reasoning","general"],recommended:!0},{name:"qwen3:8b",displayName:"Qwen3 8B",params:"8B",contextWindow:131072,description:"Powerful reasoning, 128k context, 100+ languages",tags:["multilingual","reasoning","advanced"],recommended:!0},{name:"qwen3:14b",displayName:"Qwen3 14B",params:"14B",contextWindow:131072,description:"Most capable Qwen3, best for complex tasks",tags:["multilingual","reasoning","advanced"],recommended:!0},{name:"ministral-3:3b",displayName:"Ministral 3 3B",params:"3B",contextWindow:262144,description:"Mistral's smallest, 256k context, Apache 2.0",tags:["fast","long-context","efficient"],recommended:!0},{name:"ministral-3:8b",displayName:"Ministral 3 8B",params:"8B",contextWindow:262144,description:"Balanced performance, 256k context, vision capable",tags:["general","long-context","vision"],recommended:!0},{name:"ministral-3:14b",displayName:"Ministral 3 14B",params:"14B",contextWindow:262144,description:"Most capable Ministral, 256k context, function calling",tags:["advanced","long-context","vision"],recommended:!0},{name:"gpt-oss:20b",displayName:"GPT-OSS 20B",params:"20B",contextWindow:131072,description:"OpenAI's open model, strong reasoning, Apache 2.0",tags:["reasoning","cot","openai"],recommended:!0},{name:"gemma3:4b",displayName:"Gemma3 4B",params:"4B",contextWindow:131072,description:"Google, 128k context, multimodal (text + images)",tags:["multimodal","vision","multilingual"],recommended:!0},{name:"gemma3:12b",displayName:"Gemma3 12B",params:"12B",contextWindow:131072,description:"Powerful multimodal, 128k context, 140+ languages",tags:["multimodal","vision","multilingual","advanced"],recommended:!0},{name:"gemma3n:e2b",displayName:"Gemma3N E2B",params:"2B effective",contextWindow:32768,description:"Efficient 2B, multimodal, MatFormer architecture",tags:["efficient","multimodal","fast"]},{name:"gemma3n:e4b",displayName:"Gemma3N E4B",params:"4B effective",contextWindow:32768,description:"Efficient 4B, multimodal, selective parameter activation",tags:["efficient","multimodal","balanced"]},{name:"deepseek-r1:7b",displayName:"DeepSeek R1 7B",params:"7B",contextWindow:65536,description:"Strong chain-of-thought reasoning, research-focused",tags:["reasoning","cot"],recommended:!0},{name:"deepseek-r1:14b",displayName:"DeepSeek R1 14B",params:"14B",contextWindow:65536,description:"Advanced CoT reasoning, slower but thorough",tags:["reasoning","cot","advanced"],recommended:!0}];function mv(){return Qr.filter(t=>t.recommended)}function gv(t){return Qr.find(e=>e.name===t||e.name.startsWith(t+":"))}let Sn=null,Or="idle",li=null,ra=new Set;function ei(){return Sn||(Sn=new Worker(new URL("/me-ai/assets/worker-CV-t6G85.js",import.meta.url),{type:"module"}),Sn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Or="loading"),e.status==="ready"&&(Or="ready"),e.status==="start"&&(Or="generating"),(e.status==="complete"||e.status==="error")&&(Or=li?"ready":"idle");for(const r of ra)try{r(e)}catch{}})),Sn}function ao(){return{check(){ei().postMessage({type:"check"})},loadModel(t){li=t,Or="loading",ei().postMessage({type:"load",modelId:t})},generate(t,e){ei().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,g=0;const p=w=>{switch(w.status){case"start":g=w.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=w.output,u=w.tps??u,d=w.numTokens??d,r)try{r({tps:u,numTokens:d})}catch{}break;case"complete":b(),a({text:o,tps:u,numTokens:d,inputTokens:g});break;case"error":b(),i(new Error(w.data));break}},b=()=>{ra.delete(p)};ra.add(p),ei().postMessage({type:"generate",data:t,options:e})})},interrupt(){Sn==null||Sn.postMessage({type:"interrupt"})},reset(){Sn==null||Sn.postMessage({type:"reset"})},onMessage(t){return ra.add(t),()=>ra.delete(t)},offMessage(t){ra.delete(t)},get status(){return Or},get isReady(){return Or==="ready"},get isGenerating(){return Or==="generating"},get modelId(){return li},terminate(){Sn==null||Sn.terminate(),Sn=null,Or="idle",li=null,ra.clear()}}}const nc="http://localhost:11434";function Ds(){try{return localStorage.getItem("ollamaUrl")||nc}catch{return nc}}function _v(t){try{localStorage.setItem("ollamaUrl",t)}catch{}}async function So(t=Ds()){try{const e=await fetch(`${t}/api/version`,{method:"GET",signal:AbortSignal.timeout(5e3)});return e.ok?{connected:!0,version:(await e.json()).version}:{connected:!1,error:`HTTP ${e.status}`}}catch(e){return{connected:!1,error:e.name==="TimeoutError"?"Connection timeout":e.message}}}async function yv(t=Ds()){const e=await fetch(`${t}/api/tags`,{method:"GET",signal:AbortSignal.timeout(1e4)});if(!e.ok)throw new Error(`Failed to list models: HTTP ${e.status}`);return(await e.json()).models||[]}async function bv(t,e,{temperature:r=.7,maxTokens:a=4096}={},i=()=>{},o=Ds()){var b;const u=await fetch(`${o}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:e,stream:!0,options:{temperature:r,num_predict:a}})});if(!u.ok){const w=await u.text();throw new Error(`Ollama API error: ${w}`)}const d=u.body.getReader(),g=new TextDecoder;let p="";try{for(;;){const{done:w,value:k}=await d.read();if(w)break;const N=g.decode(k).split(`
`).filter(Boolean);for(const C of N)try{const A=JSON.parse(C);if((b=A.message)!=null&&b.content&&(p+=A.message.content,i({content:A.message.content,done:A.done||!1,total_duration:A.total_duration,eval_count:A.eval_count,eval_duration:A.eval_duration})),A.done)break}catch{}}}finally{d.releaseLock()}return p}let Mn="idle",ja=null,aa=new Set;function $n(t){for(const e of aa)try{e(t)}catch{}}function wv(){return{async check(){Mn="loading",$n({status:"loading",data:"Testing Ollama connection..."});const t=await So();t.connected?(Mn="idle",$n({status:"ready",data:{type:"ollama",version:t.version,url:Ds()}})):(Mn="idle",$n({status:"error",data:`Ollama not available: ${t.error}. Make sure Ollama is running.`}))},async loadModel(t){ja=t,Mn="loading",$n({status:"loading",data:`Connecting to Ollama model: ${t}...`});const e=await So();if(!e.connected){Mn="idle",ja=null,$n({status:"error",data:`Ollama not available: ${e.error}`});return}Mn="ready",$n({status:"ready"})},async generate(t,e={}){if(!ja){$n({status:"error",data:"No Ollama model selected"});return}Mn="generating",$n({status:"start",inputTokens:0});let r=0,a=performance.now();try{await bv(ja,t,{temperature:e.temperature??.7,maxTokens:e.maxTokens??4096},i=>{if(i.content){r++;const o=performance.now()-a,u=o>0?r/o*1e3:0;$n({status:"update",output:i.content,tps:Math.round(u*10)/10,numTokens:r})}i.done&&(Mn="ready",$n({status:"complete",tps:i.eval_duration?Math.round(i.eval_count/(i.eval_duration/1e9)*10)/10:null,numTokens:i.eval_count||r}))})}catch(i){Mn="ready",$n({status:"error",data:i.message})}},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,g=0;const p=w=>{switch(w.status){case"start":g=w.inputTokens||0;break;case"update":if(o+=w.output,u=w.tps??u,d=w.numTokens??d,r)try{r({tps:u,numTokens:d})}catch{}break;case"complete":b(),a({text:o,tps:u,numTokens:d,inputTokens:g});break;case"error":b(),i(new Error(w.data));break}},b=()=>{aa.delete(p)};aa.add(p),this.generate(t,e)})},interrupt(){console.warn("Ollama doesn't support generation interruption")},reset(){},onMessage(t){return aa.add(t),()=>aa.delete(t)},offMessage(t){aa.delete(t)},get status(){return Mn},get isReady(){return Mn==="ready"},get isGenerating(){return Mn==="generating"},get modelId(){return ja},get backend(){return"ollama"},terminate(){Mn="idle",ja=null,aa.clear()}}}let na=null,rt=null;function kv(t){return t.startsWith("onnx-community/")||t.startsWith("microsoft/")?"webgpu":"ollama"}function Pu(){return{loadModel(t){const e=kv(t);na!==e&&(rt&&rt.terminate(),na=e,rt=e==="webgpu"?ao():wv()),rt.loadModel(t)},check(){rt||(rt=ao(),na="webgpu"),rt.check()},generate(t,e){if(!rt)throw new Error("No engine loaded. Call loadModel() first.");return rt.generate(t,e)},generateFull(t,e,r){return rt?rt.generateFull(t,e,r):Promise.reject(new Error("No engine loaded. Call loadModel() first."))},interrupt(){rt==null||rt.interrupt()},reset(){rt==null||rt.reset()},onMessage(t){return rt||(rt=ao(),na="webgpu"),rt.onMessage(t)},offMessage(t){rt==null||rt.offMessage(t)},get status(){return(rt==null?void 0:rt.status)||"idle"},get isReady(){return(rt==null?void 0:rt.isReady)||!1},get isGenerating(){return(rt==null?void 0:rt.isGenerating)||!1},get modelId(){return(rt==null?void 0:rt.modelId)||null},get backend(){return na},getModelInfo(){const t=this.modelId;return t?na==="webgpu"?Zo(t):gv(t):null},terminate(){rt==null||rt.terminate(),rt=null,na=null}}}var xv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ci={exports:{}},Tv=ci.exports,rc;function Ev(){return rc||(rc=1,(function(t,e){((r,a)=>{t.exports=a()})(Tv,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,h=s.length;f<h;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:xv,u=Object.keys,d=Array.isArray;function g(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,b={}.hasOwnProperty;function w(n,s){return b.call(n,s)}function k(n,s){typeof s=="function"&&(s=s(p(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){N(n,l,s[l])})}var x=Object.defineProperty;function N(n,s,l,c){x(n,s,g(l&&w(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function C(n){return{from:function(s){return n.prototype=Object.create(s.prototype),N(n.prototype,"constructor",n),{extend:k.bind(null,n.prototype)}}}}var A=Object.getOwnPropertyDescriptor,Q=[].slice;function de(n,s,l){return Q.call(n,s,l)}function H(n,s){return s(n)}function q(n){if(!n)throw new Error("Assertion Failed")}function X(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function te(n,s){if(typeof s=="string"&&w(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var h=te(n,s[c]);l.push(h)}return l}var y,S=s.indexOf(".");return S===-1||(y=n[s.substr(0,S)])==null?void 0:te(y,s.substr(S+1))}function G(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){q(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)G(n,s[c],l[c])}else{var h,y,S=s.indexOf(".");S!==-1?(h=s.substr(0,S),(S=s.substr(S+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:G(y=(y=n[h])&&w(n,h)?y:n[h]={},S,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ce(n){var s,l={};for(s in n)w(n,s)&&(l[s]=n[s]);return l}var be=[].concat;function Ee(n){return be.apply([],n)}var J="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ee([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),fe=new Set(J.map(function(n){return o[n]})),ne=null;function oe(n){return ne=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=ne.get(l);if(c)return c;if(d(l)){c=[],ne.set(l,c);for(var f=0,h=l.length;f<h;++f)c.push(s(l[f]))}else if(fe.has(l.constructor))c=l;else{var y,S=p(l);for(y in c=S===Object.prototype?{}:Object.create(S),ne.set(l,c),l)w(l,y)&&(c[y]=s(l[y]))}return c})(n),ne=null,n}var Te={}.toString;function ue(n){return Te.call(n).slice(8,-1)}var _e=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ke=typeof _e=="symbol"?function(n){var s;return n!=null&&(s=n[_e])&&s.apply(n)}:function(){return null};function ae(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var pe={};function ve(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===pe&&typeof n=="string")return[n];if(f=ke(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var se=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ht=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),F={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function K(n,s){this.name=n,this.message=s}function $(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function Oe(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=$(n,s)}function ze(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=$(n,this.failures)}C(K).from(Error).extend({toString:function(){return this.name+": "+this.message}}),C(Oe).from(K),C(ze).from(K);var Ae=ht.reduce(function(n,s){return n[s]=s+"Error",n},{}),je=K,P=ht.reduce(function(n,s){var l=s+"Error";function c(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=F[s]||l,this.inner=null)}return C(c).from(je),n[s]=c,n},{}),me=(P.Syntax=SyntaxError,P.Type=TypeError,P.Range=RangeError,J.reduce(function(n,s){return n[s+"Error"]=P[s],n},{}));J=ht.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=P[s]),n},{});function xe(){}function Me(n){return n}function Xe(n,s){return n==null||n===Me?s:function(l){return s(n(l))}}function Je(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function it(n,s){return n===xe?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?Je(c,this.onsuccess):c),f&&(this.onerror=this.onerror?Je(f,this.onerror):f),h!==void 0?h:l}}function At(n,s){return n===xe?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?Je(l,this.onsuccess):l),c&&(this.onerror=this.onerror?Je(c,this.onerror):c)}}function He(n,s){return n===xe?s:function(f){var c=n.apply(this,arguments),f=(g(f,c),this.onsuccess),h=this.onerror,y=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?Je(f,this.onsuccess):f),h&&(this.onerror=this.onerror?Je(h,this.onerror):h),c===void 0?y===void 0?void 0:y:g(c,y)}}function Ve(n,s){return n===xe?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function $e(n,s){return n===xe?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return s.apply(c,h)})}return s.apply(this,arguments)}}J.ModifyError=Oe,J.DexieError=K,J.BulkError=ze;var et=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ke(n){et=n}var We={},Ct=100,mt=typeof Promise>"u"?[]:(ht=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[mt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(mt),ht]:[ht,p(ht),ht]),ht=mt[0],Ma=mt[1],Ma=Ma&&Ma.then,xt=ht&&ht.constructor,dn=!!mt[2],sn=function(n,s){zn.push([n,s]),Zt&&(queueMicrotask(Ut),Zt=!1)},bn=!0,Zt=!0,Wt=[],Ht=[],wn=Me,jt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:xe,pgp:!1,env:{},finalize:xe},Ne=jt,zn=[],Pn=0,Nr=[];function Ie(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Ne;if(typeof n!="function"){if(n!==We)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Zn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(h){if(c._state===null){if(h===c)throw new TypeError("A promise cannot be resolved with itself.");var y=c._lib&&Vt();h&&typeof h.then=="function"?l(c,function(S,M){h instanceof Ie?h._then(S,M):h.then(S,M)}):(c._state=!0,c._value=h,Aa(c)),y&&fn()}},Zn.bind(null,c))}catch(h){Zn(c,h)}})(this,n)}var cr={get:function(){var n=Ne,s=kr;function l(c,f){var h=this,y=!n.global&&(n!==Ne||s!==kr),S=y&&!kn(),M=new Ie(function(V,D){ut(h,new Ea(T(c,n,y,S),T(f,n,y,S),V,D,n))});return this._consoleTask&&(M._consoleTask=this._consoleTask),M}return l.prototype=We,l},set:function(n){N(this,"then",n&&n.prototype===We?cr:{get:function(){return n},set:cr.set})}};function Ea(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function Zn(n,s){var l,c;Ht.push(s),n._state===null&&(l=n._lib&&Vt(),s=wn(s),n._state=!1,n._value=s,c=n,Wt.some(function(f){return f._value===c._value})||Wt.push(c),Aa(n),l)&&fn()}function Aa(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)ut(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),Pn===0&&(++Pn,sn(function(){--Pn==0&&Jn()},[]))}function ut(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++Pn,sn(Ye,[l,n,s])}}function Ye(n,s,l){try{var c,f=s._value;!s._state&&Ht.length&&(Ht=[]),c=et&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||Ht.indexOf(f)!==-1||(h=>{for(var y=Wt.length;y;)if(Wt[--y]._value===h._value)return Wt.splice(y,1)})(s),l.resolve(c)}catch(h){l.reject(h)}finally{--Pn==0&&Jn(),--l.psd.ref||l.psd.finalize()}}function Ut(){Fe(jt,function(){Vt()&&fn()})}function Vt(){var n=bn;return Zt=bn=!1,n}function fn(){var n,s,l;do for(;0<zn.length;)for(n=zn,zn=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<zn.length);Zt=bn=!0}function Jn(){for(var n=Wt,s=(Wt=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),Nr.slice(0)),l=s.length;l;)s[--l]()}function Pt(n){return new Ie(We,!1,n)}function ft(n,s){var l=Ne;return function(){var c=Vt(),f=Ne;try{return On(l,!0),n.apply(this,arguments)}catch(h){s&&s(h)}finally{On(f,!1),c&&fn()}}}k(Ie.prototype,{then:cr,_then:function(n,s){ut(this,new Ea(null,null,n,s,Ne))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:Pt)(c)}):this.then(null,function(c){return(c&&c.name===s?l:Pt)(c)}))},finally:function(n){return this.then(function(s){return Ie.resolve(n()).then(function(){return s})},function(s){return Ie.resolve(n()).then(function(){return Pt(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ie(function(c,f){var h=setTimeout(function(){return f(new P.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&N(Ie.prototype,Symbol.toStringTag,"Dexie.Promise"),jt.env=Pa(),k(Ie,{all:function(){var n=ve.apply(null,arguments).map(xr);return new Ie(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,h){return Ie.resolve(f).then(function(y){n[h]=y,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ie?n:n&&typeof n.then=="function"?new Ie(function(s,l){n.then(s,l)}):new Ie(We,!0,n)},reject:Pt,race:function(){var n=ve.apply(null,arguments).map(xr);return new Ie(function(s,l){n.map(function(c){return Ie.resolve(c).then(s,l)})})},PSD:{get:function(){return Ne},set:function(n){return Ne=n}},totalEchoes:{get:function(){return kr}},newPSD:In,usePSD:Fe,scheduler:{get:function(){return sn},set:function(n){sn=n}},rejectionMapper:{get:function(){return wn},set:function(n){wn=n}},follow:function(n,s){return new Ie(function(l,c){return In(function(f,h){var y=Ne;y.unhandleds=[],y.onunhandled=h,y.finalize=Je(function(){var S,M=this;S=function(){M.unhandleds.length===0?f():h(M.unhandleds[0])},Nr.push(function V(){S(),Nr.splice(Nr.indexOf(V),1)}),++Pn,sn(function(){--Pn==0&&Jn()},[])},y.finalize),n()},s,l,c)})}}),xt&&(xt.allSettled&&N(Ie,"allSettled",function(){var n=ve.apply(null,arguments).map(xr);return new Ie(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,h){return Ie.resolve(f).then(function(y){return c[h]={status:"fulfilled",value:y}},function(y){return c[h]={status:"rejected",reason:y}}).then(function(){return--l||s(c)})})})}),xt.any&&typeof AggregateError<"u"&&N(Ie,"any",function(){var n=ve.apply(null,arguments).map(xr);return new Ie(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(h,y){return Ie.resolve(h).then(function(S){return s(S)},function(S){f[y]=S,--c||l(new AggregateError(f))})})})}),xt.withResolvers)&&(Ie.withResolvers=xt.withResolvers);var It={awaits:0,echoes:0,id:0},vn=0,pn=[],wr=0,kr=0,Jr=0;function In(n,y,l,c){var f=Ne,h=Object.create(f),y=(h.parent=f,h.ref=0,h.global=!1,h.id=++Jr,jt.env,h.env=dn?{Promise:Ie,PromiseProp:{value:Ie,configurable:!0,writable:!0},all:Ie.all,race:Ie.race,allSettled:Ie.allSettled,any:Ie.any,resolve:Ie.resolve,reject:Ie.reject}:{},y&&g(h,y),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Fe(h,n,l,c));return h.ref===0&&h.finalize(),y}function Gt(){return It.id||(It.id=++vn),++It.awaits,It.echoes+=Ct,It.id}function kn(){return!!It.awaits&&(--It.awaits==0&&(It.id=0),It.echoes=It.awaits*Ct,!0)}function xr(n){return It.echoes&&n&&n.constructor===xt?(Gt(),n.then(function(s){return kn(),s},function(s){return kn(),we(s)})):n}function Ca(){var n=pn[pn.length-1];pn.pop(),On(n,!1)}function On(n,s){var l,c,f=Ne;(s?!It.echoes||wr++&&n===Ne:!wr||--wr&&n===Ne)||queueMicrotask(s?(function(h){++kr,It.echoes&&--It.echoes!=0||(It.echoes=It.awaits=It.id=0),pn.push(Ne),On(h,!0)}).bind(null,n):Ca),n!==Ne&&(Ne=n,f===jt&&(jt.env=Pa()),dn)&&(l=jt.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function Pa(){var n=o.Promise;return dn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Fe(n,s,l,c,f){var h=Ne;try{return On(n,!0),s(l,c,f)}finally{On(h,!1)}}function T(n,s,l,c){return typeof n!="function"?n:function(){var f=Ne;l&&Gt(),On(s,!0);try{return n.apply(this,arguments)}finally{On(f,!1),c&&queueMicrotask(kn)}}}function he(n){Promise===xt&&It.echoes===0?wr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ma).indexOf("[native code]")===-1&&(Gt=kn=xe);var we=Ie.reject,at="ï¿¿",St="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ot="String expected.",Dt=[],on="__dbnames",Fn="readonly",Jt="readwrite";function yt(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Sr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Tr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=oe(s))[n],s}}function vl(){throw P.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function dt(n,s){try{var l=pl(n),c=pl(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=hl(n),h=hl(s),y=f.length,S=h.length,M=y<S?y:S,V=0;V<M;++V)if(f[V]!==h[V])return f[V]<h[V]?-1:1;return y===S?0:y<S?-1:1;case"Array":for(var D=n,O=s,B=D.length,z=O.length,j=B<z?B:z,R=0;R<j;++R){var Y=dt(D[R],O[R]);if(Y!==0)return Y}return B===z?0:B<z?-1:1}}catch{}return NaN}function pl(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=ue(n))==="ArrayBuffer")?"binary":s}function hl(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Ls(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,h){return!l.failures[h]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}ml.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var $a=ml;function ml(n){this["@@propmod"]=n}function gl(n,s){for(var l=u(s),c=l.length,f=!1,h=0;h<c;++h){var y=l[h],S=s[y],M=te(n,y);S instanceof $a?(G(n,y,S.execute(M)),f=!0):M!==S&&(G(n,y,S),f=!0)}return f}Rt.prototype._trans=function(n,s,l){var c=this._tx||Ne.trans,f=this.name,h=et&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function y(V,D,O){if(O.schema[f])return s(O.idbtrans,O);throw new P.NotFound("Table "+f+" not part of transaction")}var S=Vt();try{var M=c&&c.db._novip===this.db._novip?c===Ne.trans?c._promise(n,y,l):In(function(){return c._promise(n,y,l)},{trans:c,transless:Ne.transless||Ne}):(function V(D,O,B,z){if(D.idbdb&&(D._state.openComplete||Ne.letThrough||D._vip)){var j=D._createTransaction(O,B,D._dbSchema);try{j.create(),D._state.PR1398_maxLoop=3}catch(R){return R.name===Ae.InvalidState&&D.isOpen()&&0<--D._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),D.close({disableAutoOpen:!1}),D.open().then(function(){return V(D,O,B,z)})):we(R)}return j._promise(O,function(R,Y){return In(function(){return Ne.trans=j,z(R,Y,j)})}).then(function(R){if(O==="readwrite")try{j.idbtrans.commit()}catch{}return O==="readonly"?R:j._completion.then(function(){return R})})}if(D._state.openComplete)return we(new P.DatabaseClosed(D._state.dbOpenError));if(!D._state.isBeingOpened){if(!D._state.autoOpen)return we(new P.DatabaseClosed);D.open().catch(xe)}return D._state.dbReadyPromise.then(function(){return V(D,O,B,z)})})(this.db,n,[this.name],y);return h&&(M._consoleTask=h,M=M.catch(function(V){return console.trace(V),we(V)})),M}finally{S&&fn()}},Rt.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?we(new P.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},Rt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&s.every(function(V){return 0<=S.keyPath.indexOf(V)})){for(var M=0;M<s.length;++M)if(s.indexOf(S.keyPath[M])===-1)return!1;return!0}return!1}).sort(function(S,M){return S.keyPath.length-M.keyPath.length})[0];if(l&&this.db._maxKey!==at)return y=l.keyPath.slice(0,s.length),this.where(y).equals(y.map(function(S){return n[S]}));!l&&et&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(S,M){return dt(S,M)===0}var y=s.reduce(function(D,M){var V=D[0],D=D[1],O=c[M],B=n[M];return[V||O,V||!O?yt(D,O&&O.multi?function(z){return z=te(z,M),d(z)&&z.some(function(j){return f(B,j)})}:function(z){return f(B,te(z,M))}):D]},[null,null]),h=y[0],y=y[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(y):l?this.filter(y):this.where(s).equals("")},Rt.prototype.filter=function(n){return this.toCollection().and(n)},Rt.prototype.count=function(n){return this.toCollection().count(n)},Rt.prototype.offset=function(n){return this.toCollection().offset(n)},Rt.prototype.limit=function(n){return this.toCollection().limit(n)},Rt.prototype.each=function(n){return this.toCollection().each(n)},Rt.prototype.toArray=function(n){return this.toCollection().toArray(n)},Rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Rt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},Rt.prototype.reverse=function(){return this.toCollection().reverse()},Rt.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof vl&&(n=(y=>{var S=D,M=y;if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function V(){this.constructor=S}function D(){return y!==null&&y.apply(this,arguments)||this}return r(S,M),S.prototype=M===null?Object.create(M):(V.prototype=M.prototype,new V),Object.defineProperty(D.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),D.prototype.table=function(){return l},D})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(y){return c.add(y)});function h(y){if(!y)return y;var S,M=Object.create(n.prototype);for(S in y)if(!c.has(S))try{M[S]=y[S]}catch{}return M}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},Rt.prototype.defineClass=function(){return this.mapToClass(function(n){g(this,n)})},Rt.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,y=n;return h&&f&&(y=Tr(h)(n)),this._trans("readwrite",function(S){return l.core.mutate({trans:S,type:"add",keys:s!=null?[s]:null,values:[y]})}).then(function(S){return S.numFailures?Ie.reject(S.failures[0]):S.lastResult}).then(function(S){if(h)try{G(n,h,S)}catch{}return S})},Rt.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var y=h??{};return gl(y,s),c&&G(y,c,n),l.core.mutate({trans:f,type:"put",values:[y],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(S){return S.numFailures?Ie.reject(S.failures[0]):!!h})})})},Rt.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=te(n,this.schema.primKey.keyPath))===void 0?we(new P.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},Rt.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,y=n;return h&&f&&(y=Tr(h)(n)),this._trans("readwrite",function(S){return l.core.mutate({trans:S,type:"put",values:[y],keys:s!=null?[s]:null})}).then(function(S){return S.numFailures?Ie.reject(S.failures[0]):S.lastResult}).then(function(S){if(h)try{G(n,h,S)}catch{}return S})},Rt.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Ls(s,[n],c)}).then(function(c){return c.numFailures?Ie.reject(c.failures[0]):void 0})})},Rt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Sr}).then(function(l){return Ls(n,null,l)})}).then(function(s){return s.numFailures?Ie.reject(s.failures[0]):void 0})},Rt.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},Rt.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var S=c.schema.primKey,V=S.auto,S=S.keyPath;if(S&&f)throw new P.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new P.InvalidArgument("Arguments objects and keys must have the same length");var M=n.length,V=S&&V?n.map(Tr(S)):n;return c.core.mutate({trans:y,type:"add",keys:f,values:V,wantResults:h}).then(function(D){var O=D.numFailures,B=D.failures;if(O===0)return h?D.results:D.lastResult;throw new ze("".concat(c.name,".bulkAdd(): ").concat(O," of ").concat(M," operations failed"),B)})})},Rt.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var S=c.schema.primKey,V=S.auto,S=S.keyPath;if(S&&f)throw new P.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new P.InvalidArgument("Arguments objects and keys must have the same length");var M=n.length,V=S&&V?n.map(Tr(S)):n;return c.core.mutate({trans:y,type:"put",keys:f,values:V,wantResults:h}).then(function(D){var O=D.numFailures,B=D.failures;if(O===0)return h?D.results:D.lastResult;throw new ze("".concat(c.name,".bulkPut(): ").concat(O," of ").concat(M," operations failed"),B)})})},Rt.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(y){return y.key}),f=n.map(function(y){return y.changes}),h=[];return this._trans("readwrite",function(y){return l.getMany({trans:y,keys:c,cache:"clone"}).then(function(S){var M=[],V=[],D=(n.forEach(function(O,B){var z=O.key,j=O.changes,R=S[B];if(R){for(var Y=0,Z=Object.keys(j);Y<Z.length;Y++){var W=Z[Y],le=j[W];if(W===s.schema.primKey.keyPath){if(dt(le,z)!==0)throw new P.Constraint("Cannot update primary key in bulkUpdate()")}else G(R,W,le)}h.push(B),M.push(z),V.push(R)}}),M.length);return l.mutate({trans:y,type:"put",keys:M,values:V,updates:{keys:c,changeSpecs:f}}).then(function(O){var B=O.numFailures,z=O.failures;if(B===0)return D;for(var j=0,R=Object.keys(z);j<R.length;j++){var Y,Z=R[j],W=h[Number(Z)];W!=null&&(Y=z[Z],delete z[Z],z[W]=Y)}throw new ze("".concat(s.name,".bulkUpdate(): ").concat(B," of ").concat(D," operations failed"),z)})})})},Rt.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return Ls(s,n,f)})}).then(function(c){var f=c.numFailures,h=c.failures;if(f===0)return c.lastResult;throw new ze("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var _l=Rt;function Rt(){}function es(n){function s(y,S){if(S){for(var M=arguments.length,V=new Array(M-1);--M;)V[M-1]=arguments[M];return l[y].subscribe.apply(null,V),n}if(typeof y=="string")return l[y]}var l={};s.addEventType=h;for(var c=1,f=arguments.length;c<f;++c)h(arguments[c]);return s;function h(y,S,M){var V,D;if(typeof y!="object")return S=S||Ve,D={subscribers:[],fire:M=M||xe,subscribe:function(O){D.subscribers.indexOf(O)===-1&&(D.subscribers.push(O),D.fire=S(D.fire,O))},unsubscribe:function(O){D.subscribers=D.subscribers.filter(function(B){return B!==O}),D.fire=D.subscribers.reduce(S,M)}},l[y]=s[y]=D;u(V=y).forEach(function(O){var B=V[O];if(d(B))h(O,V[O][0],V[O][1]);else{if(B!=="asap")throw new P.InvalidArgument("Invalid event config");var z=h(O,Me,function(){for(var j=arguments.length,R=new Array(j);j--;)R[j]=arguments[j];z.subscribers.forEach(function(Y){X(function(){Y.apply(null,R)})})})}})}}function ts(n,s){return C(s).from({prototype:n}),s}function Ia(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function Ci(n,s){n.filter=yt(n.filter,s)}function Pi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return yt(c(),s())}:s,n.justLimit=l&&!c}function Ns(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new P.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function yl(n,s,l){var c=Ns(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function qs(n,s,l,c){var f,h,y=n.replayFilter?yt(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(S,M,V){var D,O;y&&!y(M,V,function(B){return M.stop(B)},function(B){return M.fail(B)})||((O=""+(D=M.primaryKey))=="[object ArrayBuffer]"&&(O=""+new Uint8Array(D)),w(f,O))||(f[O]=!0,s(S,M,V))},Promise.all([n.or._iterate(h,l),bl(yl(n,c,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):bl(yl(n,c,l),yt(n.algorithm,y),s,!n.keysOnly&&n.valueMapper)}function bl(n,s,l,c){var f=ft(c?function(h,y,S){return l(c(h),y,S)}:l);return n.then(function(h){if(h)return h.start(function(){var y=function(){return h.continue()};s&&!s(h,function(S){return y=S},function(S){h.stop(S),y=xe},function(S){h.fail(S),y=xe})||f(h.value,h,function(S){return y=S}),y()})})}gt.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,we.bind(null,l.error)):l.table._trans("readonly",n).then(s)},gt.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,we.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},gt.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=yt(s.algorithm,n)},gt.prototype._iterate=function(n,s){return qs(this._ctx,n,s,this._ctx.table.core)},gt.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&g(l,n),s._ctx=l,s},gt.prototype.raw=function(){return this._ctx.valueMapper=null,this},gt.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return qs(s,n,l,s.table.core)})},gt.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,h=f.table.core;return Ia(f,!0)?h.count({trans:l,query:{index:Ns(f,h.schema),range:f.range}}).then(function(y){return Math.min(y,f.limit)}):(c=0,qs(f,function(){return++c,!1},l,h).then(function(){return c}))}).then(n)},gt.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function h(M,V){return V?h(M[l[V]],V-1):M[c]}var y=this._ctx.dir==="next"?1:-1;function S(M,V){return dt(h(M,f),h(V,f))*y}return this.toArray(function(M){return M.sort(S)}).then(s)},gt.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,h,y=s._ctx;return y.dir==="next"&&Ia(y,!0)&&0<y.limit?(c=y.valueMapper,f=Ns(y,y.table.core.schema),y.table.core.query({trans:l,limit:y.limit,values:!0,query:{index:f,range:y.range}}).then(function(S){return S=S.result,c?S.map(c):S})):(h=[],qs(y,function(S){return h.push(S)},l,y.table.core).then(function(){return h}))},n)},gt.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,Ia(s)?Pi(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):Pi(s,function(){var l=n;return function(){return--l<0}})),this},gt.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Pi(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},gt.prototype.until=function(n,s){return Ci(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},gt.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},gt.prototype.last=function(n){return this.reverse().first(n)},gt.prototype.filter=function(n){var s;return Ci(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=yt(s.isMatch,n),this},gt.prototype.and=function(n){return this.filter(n)},gt.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},gt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},gt.prototype.desc=function(){return this.reverse()},gt.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},gt.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},gt.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},gt.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},gt.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&Ia(s,!0)&&0<s.limit)return this._read(function(c){var f=Ns(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},gt.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},gt.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},gt.prototype.lastKey=function(n){return this.reverse().firstKey(n)},gt.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},Ci(this._ctx,function(c){var c=c.primaryKey.toString(),f=w(n,c);return n[c]=!0,!f})),this},gt.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(R,Y){var Z=Y.failures;B+=R-Y.numFailures;for(var W=0,le=u(Z);W<le.length;W++){var ge=le[W];O.push(Z[ge])}}var h=typeof n=="function"?n:function(R){return gl(R,n)},y=l.table.core,D=y.schema.primaryKey,S=D.outbound,M=D.extractKey,V=200,D=s.db._options.modifyChunkSize,O=(D&&(V=typeof D=="object"?D[y.name]||D["*"]||200:D),[]),B=0,z=[],j=n===wl;return s.clone().primaryKeys().then(function(R){function Y(W){var le=Math.min(V,R.length-W),ge=R.slice(W,W+le);return(j?Promise.resolve([]):y.getMany({trans:c,keys:ge,cache:"immutable"})).then(function(Ce){var Pe=[],ye=[],qe=S?[]:null,Le=j?ge:[];if(!j)for(var Se=0;Se<le;++Se){var Be=Ce[Se],vt={value:oe(Be),primKey:R[W+Se]};h.call(vt,vt.value,vt)!==!1&&(vt.value==null?Le.push(R[W+Se]):S||dt(M(Be),M(vt.value))===0?(ye.push(vt.value),S&&qe.push(R[W+Se])):(Le.push(R[W+Se]),Pe.push(vt.value)))}return Promise.resolve(0<Pe.length&&y.mutate({trans:c,type:"add",values:Pe}).then(function(_t){for(var Ge in _t.failures)Le.splice(parseInt(Ge),1);f(Pe.length,_t)})).then(function(){return(0<ye.length||Z&&typeof n=="object")&&y.mutate({trans:c,type:"put",keys:qe,values:ye,criteria:Z,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<W}).then(function(_t){return f(ye.length,_t)})}).then(function(){return(0<Le.length||Z&&j)&&y.mutate({trans:c,type:"delete",keys:Le,criteria:Z,isAdditionalChunk:0<W}).then(function(_t){return Ls(l.table,Le,_t)}).then(function(_t){return f(Le.length,_t)})}).then(function(){return R.length>W+le&&Y(W+V)})})}var Z=Ia(l)&&l.limit===1/0&&(typeof n!="function"||j)&&{index:l.index,range:l.range};return Y(0).then(function(){if(0<O.length)throw new Oe("Error modifying one or more objects",O,B,z);return R.length})})})},gt.prototype.delete=function(){var n=this._ctx,s=n.range;return!Ia(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(wl):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(M){var S=M.failures,M=M.numFailures;if(M)throw new Oe("Could not delete some values",Object.keys(S).map(function(V){return S[V]}),h-M);return h-M})})})};var pd=gt;function gt(){}var wl=function(n,s){return s.value=null};function hd(n,s){return n<s?-1:n===s?0:1}function md(n,s){return s<n?-1:n===s?0:1}function Rn(n,s,l){return n=n instanceof xl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function Oa(n){return new n.Collection(n,function(){return kl("")}).limit(0)}function Bs(z,s,l,c){var f,h,y,S,M,V,D,O=l.length;if(!l.every(function(R){return typeof R=="string"}))return Rn(z,Ot);function B(R){f=R==="next"?function(Z){return Z.toUpperCase()}:function(Z){return Z.toLowerCase()},h=R==="next"?function(Z){return Z.toLowerCase()}:function(Z){return Z.toUpperCase()},y=R==="next"?hd:md;var Y=l.map(function(Z){return{lower:h(Z),upper:f(Z)}}).sort(function(Z,W){return y(Z.lower,W.lower)});S=Y.map(function(Z){return Z.upper}),M=Y.map(function(Z){return Z.lower}),D=(V=R)==="next"?"":c}B("next");var z=new z.Collection(z,function(){return qr(S[0],M[O-1]+c)}),j=(z._ondirectionchange=function(R){B(R)},0);return z._addAlgorithm(function(R,Y,Z){var W=R.key;if(typeof W=="string"){var le=h(W);if(s(le,M,j))return!0;for(var ge=null,Ce=j;Ce<O;++Ce){var Pe=((ye,qe,Le,Se,Be,vt)=>{for(var _t=Math.min(ye.length,Se.length),Ge=-1,tt=0;tt<_t;++tt){var Lt=qe[tt];if(Lt!==Se[tt])return Be(ye[tt],Le[tt])<0?ye.substr(0,tt)+Le[tt]+Le.substr(tt+1):Be(ye[tt],Se[tt])<0?ye.substr(0,tt)+Se[tt]+Le.substr(tt+1):0<=Ge?ye.substr(0,Ge)+qe[Ge]+Le.substr(Ge+1):null;Be(ye[tt],Lt)<0&&(Ge=tt)}return _t<Se.length&&vt==="next"?ye+Le.substr(ye.length):_t<ye.length&&vt==="prev"?ye.substr(0,Le.length):Ge<0?null:ye.substr(0,Ge)+Se[Ge]+Le.substr(Ge+1)})(W,le,S[Ce],M[Ce],y,V);Pe===null&&ge===null?j=Ce+1:(ge===null||0<y(ge,Pe))&&(ge=Pe)}Y(ge!==null?function(){R.continue(ge+D)}:Z)}return!1}),z}function qr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function kl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Yt.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?Oa(this):new this.Collection(this,function(){return qr(n,s,!l,!c)})}catch{return Rn(this,St)}},Yt.prototype.equals=function(n){return n==null?Rn(this,St):new this.Collection(this,function(){return kl(n)})},Yt.prototype.above=function(n){return n==null?Rn(this,St):new this.Collection(this,function(){return qr(n,void 0,!0)})},Yt.prototype.aboveOrEqual=function(n){return n==null?Rn(this,St):new this.Collection(this,function(){return qr(n,void 0,!1)})},Yt.prototype.below=function(n){return n==null?Rn(this,St):new this.Collection(this,function(){return qr(void 0,n,!1,!0)})},Yt.prototype.belowOrEqual=function(n){return n==null?Rn(this,St):new this.Collection(this,function(){return qr(void 0,n)})},Yt.prototype.startsWith=function(n){return typeof n!="string"?Rn(this,Ot):this.between(n,n+at,!0,!0)},Yt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Bs(this,function(s,l){return s.indexOf(l[0])===0},[n],at)},Yt.prototype.equalsIgnoreCase=function(n){return Bs(this,function(s,l){return s===l[0]},[n],"")},Yt.prototype.anyOfIgnoreCase=function(){var n=ve.apply(pe,arguments);return n.length===0?Oa(this):Bs(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Yt.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(pe,arguments);return n.length===0?Oa(this):Bs(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,at)},Yt.prototype.anyOf=function(){var n,s,l=this,c=ve.apply(pe,arguments),f=this._cmp;try{c.sort(f)}catch{return Rn(this,St)}return c.length===0?Oa(this):((n=new this.Collection(this,function(){return qr(c[0],c[c.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(h,y,S){for(var M=h.key;0<f(M,c[s]);)if(++s===c.length)return y(S),!1;return f(M,c[s])===0||(y(function(){h.continue(c[s])}),!1)}),n)},Yt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Yt.prototype.noneOf=function(){var n=ve.apply(pe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Rn(this,St)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Yt.prototype.inAnyRange=function(n,Z){var l=this,c=this._cmp,f=this._ascending,h=this._descending,y=this._min,S=this._max;if(n.length===0)return Oa(this);if(!n.every(function(W){return W[0]!==void 0&&W[1]!==void 0&&f(W[0],W[1])<=0}))return Rn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",P.InvalidArgument);var M=!Z||Z.includeLowers!==!1,V=Z&&Z.includeUppers===!0,D,O=f;function B(W,le){return O(W[0],le[0])}try{(D=n.reduce(function(W,le){for(var ge=0,Ce=W.length;ge<Ce;++ge){var Pe=W[ge];if(c(le[0],Pe[1])<0&&0<c(le[1],Pe[0])){Pe[0]=y(Pe[0],le[0]),Pe[1]=S(Pe[1],le[1]);break}}return ge===Ce&&W.push(le),W},[])).sort(B)}catch{return Rn(this,St)}var z=0,j=V?function(W){return 0<f(W,D[z][1])}:function(W){return 0<=f(W,D[z][1])},R=M?function(W){return 0<h(W,D[z][0])}:function(W){return 0<=h(W,D[z][0])},Y=j,Z=new this.Collection(this,function(){return qr(D[0][0],D[D.length-1][1],!M,!V)});return Z._ondirectionchange=function(W){O=W==="next"?(Y=j,f):(Y=R,h),D.sort(B)},Z._addAlgorithm(function(W,le,ge){for(var Ce,Pe=W.key;Y(Pe);)if(++z===D.length)return le(ge),!1;return!j(Ce=Pe)&&!R(Ce)||(l._cmp(Pe,D[z][1])===0||l._cmp(Pe,D[z][0])===0||le(function(){O===f?W.continue(D[z][0]):W.continue(D[z][1])}),!1)}),Z},Yt.prototype.startsWithAnyOf=function(){var n=ve.apply(pe,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?Oa(this):this.inAnyRange(n.map(function(s){return[s,s+at]})):Rn(this,"startsWithAnyOf() only works with strings")};var xl=Yt;function Yt(){}function ur(n){return ft(function(s){return ns(s),n(s.target.error),!1})}function ns(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var rs="storagemutated",Ii="x-storagemutated-1",Br=es(null,rs),gd=(dr.prototype._lock=function(){return q(!Ne.global),++this._reculock,this._reculock!==1||Ne.global||(Ne.lockOwnerFor=this),this},dr.prototype._unlock=function(){if(q(!Ne.global),--this._reculock==0)for(Ne.global||(Ne.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Fe(n[1],n[0])}catch{}}return this},dr.prototype._locked=function(){return this._reculock&&Ne.lockOwnerFor!==this},dr.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(q(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new P.DatabaseClosed(c);case"MissingAPIError":throw new P.MissingAPI(c.message,c);default:throw new P.OpenFailed(c)}if(!this.active)throw new P.TransactionInactive;q(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ft(function(f){ns(f),s._reject(n.error)}),n.onabort=ft(function(f){ns(f),s.active&&s._reject(new P.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=ft(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Br.storagemutated.fire(n.mutatedParts)})}return this},dr.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?we(new P.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ie(function(h,y){f._blockedFuncs.push([function(){f._promise(n,s,l).then(h,y)},Ne])}):l?In(function(){var h=new Ie(function(y,S){f._lock();var M=s(y,S,f);M&&M.then&&M.then(y,S)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((c=new Ie(function(h,y){var S=s(h,y,f);S&&S.then&&S.then(h,y)}))._lib=!0,c):we(new P.TransactionInactive)},dr.prototype._root=function(){return this.parent?this.parent._root():this},dr.prototype.waitFor=function(n){var s,l=this._root(),c=Ie.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=h)})()),l._waitingFor);return new Ie(function(h,y){c.then(function(S){return l._waitingQueue.push(ft(h.bind(null,S)))},function(S){return l._waitingQueue.push(ft(y.bind(null,S)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},dr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new P.Abort))},dr.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(w(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new P.NotFound("Table "+n+" not part of transaction")},dr);function dr(){}function Oi(n,s,l,c,f,h,y,S){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:h,src:(l&&!y?"&":"")+(c?"*":"")+(f?"++":"")+Sl(s),type:S}}function Sl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Ri(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,h,y){return h=c(h,y),h&&(f[h[0]]=h[1]),f},{}))};var c}var as=function(n){try{return n.only([[]]),as=function(){return[[]]},[[]]}catch{return as=function(){return at},at}};function Mi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return te(l,s)}:function(l){return te(l,n)};var s}function Tl(n){return[].slice.call(n)}var _d=0;function ss(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function yd(n,s,M){function c(j){if(j.type===3)return null;if(j.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var O=j.lower,B=j.upper,z=j.lowerOpen,j=j.upperOpen;return O===void 0?B===void 0?null:s.upperBound(B,!!j):B===void 0?s.lowerBound(O,!!z):s.bound(O,B,!!z,!!j)}function f(D){var O,B=D.name;return{name:B,schema:D,mutate:function(z){var j=z.trans,R=z.type,Y=z.keys,Z=z.values,W=z.range;return new Promise(function(le,ge){le=ft(le);var Ce=j.objectStore(B),Pe=Ce.keyPath==null,ye=R==="put"||R==="add";if(!ye&&R!=="delete"&&R!=="deleteRange")throw new Error("Invalid operation type: "+R);var qe,Le=(Y||Z||{length:1}).length;if(Y&&Z&&Y.length!==Z.length)throw new Error("Given keys array must have same length as given values array.");if(Le===0)return le({numFailures:0,failures:{},results:[],lastResult:void 0});function Se(Nt){++_t,ns(Nt)}var Be=[],vt=[],_t=0;if(R==="deleteRange"){if(W.type===4)return le({numFailures:_t,failures:vt,results:[],lastResult:void 0});W.type===3?Be.push(qe=Ce.clear()):Be.push(qe=Ce.delete(c(W)))}else{var Pe=ye?Pe?[Z,Y]:[Z,null]:[Y,null],Ge=Pe[0],tt=Pe[1];if(ye)for(var Lt=0;Lt<Le;++Lt)Be.push(qe=tt&&tt[Lt]!==void 0?Ce[R](Ge[Lt],tt[Lt]):Ce[R](Ge[Lt])),qe.onerror=Se;else for(Lt=0;Lt<Le;++Lt)Be.push(qe=Ce[R](Ge[Lt])),qe.onerror=Se}function Kn(Nt){Nt=Nt.target.result,Be.forEach(function(ta,Zi){return ta.error!=null&&(vt[Zi]=ta.error)}),le({numFailures:_t,failures:vt,results:R==="delete"?Y:Be.map(function(ta){return ta.result}),lastResult:Nt})}qe.onerror=function(Nt){Se(Nt),Kn(Nt)},qe.onsuccess=Kn})},getMany:function(z){var j=z.trans,R=z.keys;return new Promise(function(Y,Z){Y=ft(Y);for(var W,le=j.objectStore(B),ge=R.length,Ce=new Array(ge),Pe=0,ye=0,qe=function(Be){Be=Be.target,Ce[Be._pos]=Be.result,++ye===Pe&&Y(Ce)},Le=ur(Z),Se=0;Se<ge;++Se)R[Se]!=null&&((W=le.get(R[Se]))._pos=Se,W.onsuccess=qe,W.onerror=Le,++Pe);Pe===0&&Y(Ce)})},get:function(z){var j=z.trans,R=z.key;return new Promise(function(Y,Z){Y=ft(Y);var W=j.objectStore(B).get(R);W.onsuccess=function(le){return Y(le.target.result)},W.onerror=ur(Z)})},query:(O=S,function(z){return new Promise(function(j,R){j=ft(j);var Y,Z,W,ye=z.trans,le=z.values,ge=z.limit,Pe=z.query,Ce=ge===1/0?void 0:ge,qe=Pe.index,Pe=Pe.range,ye=ye.objectStore(B),ye=qe.isPrimaryKey?ye:ye.index(qe.name),qe=c(Pe);if(ge===0)return j({result:[]});O?((Pe=le?ye.getAll(qe,Ce):ye.getAllKeys(qe,Ce)).onsuccess=function(Le){return j({result:Le.target.result})},Pe.onerror=ur(R)):(Y=0,Z=!le&&"openKeyCursor"in ye?ye.openKeyCursor(qe):ye.openCursor(qe),W=[],Z.onsuccess=function(Le){var Se=Z.result;return!Se||(W.push(le?Se.value:Se.primaryKey),++Y===ge)?j({result:W}):void Se.continue()},Z.onerror=ur(R))})}),openCursor:function(z){var j=z.trans,R=z.values,Y=z.query,Z=z.reverse,W=z.unique;return new Promise(function(le,ge){le=ft(le);var ye=Y.index,Ce=Y.range,Pe=j.objectStore(B),Pe=ye.isPrimaryKey?Pe:Pe.index(ye.name),ye=Z?W?"prevunique":"prev":W?"nextunique":"next",qe=!R&&"openKeyCursor"in Pe?Pe.openKeyCursor(c(Ce),ye):Pe.openCursor(c(Ce),ye);qe.onerror=ur(ge),qe.onsuccess=ft(function(Le){var Se,Be,vt,_t,Ge=qe.result;Ge?(Ge.___id=++_d,Ge.done=!1,Se=Ge.continue.bind(Ge),Be=(Be=Ge.continuePrimaryKey)&&Be.bind(Ge),vt=Ge.advance.bind(Ge),_t=function(){throw new Error("Cursor not stopped")},Ge.trans=j,Ge.stop=Ge.continue=Ge.continuePrimaryKey=Ge.advance=function(){throw new Error("Cursor not started")},Ge.fail=ft(ge),Ge.next=function(){var tt=this,Lt=1;return this.start(function(){return Lt--?tt.continue():tt.stop()}).then(function(){return tt})},Ge.start=function(tt){function Lt(){if(qe.result)try{tt()}catch(Nt){Ge.fail(Nt)}else Ge.done=!0,Ge.start=function(){throw new Error("Cursor behind last entry")},Ge.stop()}var Kn=new Promise(function(Nt,ta){Nt=ft(Nt),qe.onerror=ur(ta),Ge.fail=ta,Ge.stop=function(Zi){Ge.stop=Ge.continue=Ge.continuePrimaryKey=Ge.advance=_t,Nt(Zi)}});return qe.onsuccess=ft(function(Nt){qe.onsuccess=Lt,Lt()}),Ge.continue=Se,Ge.continuePrimaryKey=Be,Ge.advance=vt,Lt(),Kn},le(Ge)):le(null)},ge)})},count:function(z){var j=z.query,R=z.trans,Y=j.index,Z=j.range;return new Promise(function(W,le){var ge=R.objectStore(B),ge=Y.isPrimaryKey?ge:ge.index(Y.name),Ce=c(Z),Ce=Ce?ge.count(Ce):ge.count();Ce.onsuccess=ft(function(Pe){return W(Pe.target.result)}),Ce.onerror=ur(le)})}}}h=M,y=Tl((M=n).objectStoreNames);var h,M={schema:{name:M.name,tables:y.map(function(D){return h.objectStore(D)}).map(function(D){var O=D.keyPath,B=D.autoIncrement,j=d(O),z={},j={name:D.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:O==null,compound:j,keyPath:O,autoIncrement:B,unique:!0,extractKey:Mi(O)},indexes:Tl(D.indexNames).map(function(R){return D.index(R)}).map(function(W){var le=W.name,Y=W.unique,Z=W.multiEntry,W=W.keyPath,le={name:le,compound:d(W),keyPath:W,unique:Y,multiEntry:Z,extractKey:Mi(W)};return z[ss(W)]=le}),getIndexByKeyPath:function(R){return z[ss(R)]}};return z[":id"]=j.primaryKey,O!=null&&(z[ss(O)]=j.primaryKey),j})},hasGetAll:0<y.length&&"getAll"in h.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},y=M.schema,S=M.hasGetAll,M=y.tables.map(f),V={};return M.forEach(function(D){return V[D.name]=D}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(D){if(V[D])return V[D];throw new Error("Table '".concat(D,"' not found"))},MIN_KEY:-1/0,MAX_KEY:as(s),schema:y}}function bd(n,s,l,c){return l=l.IDBKeyRange,s=yd(s,l,c),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,a(a({},f),h(f))},s)}}function zs(n,s){var l=s.db,l=bd(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(h){return h.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function Fs(n,s,l,c){l.forEach(function(f){var h=c[f];s.forEach(function(y){var S=(function M(V,D){return A(V,D)||(V=p(V))&&M(V,D)})(y,f);(!S||"value"in S&&S.value===void 0)&&(y===n.Transaction.prototype||y instanceof n.Transaction?N(y,f,{get:function(){return this.table(f)},set:function(M){x(this,f,{value:M,writable:!0,configurable:!0,enumerable:!0})}}):y[f]=new n.Table(f,h))})})}function Di(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function wd(n,s){return n._cfg.version-s._cfg.version}function kd(n,s,l,c){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=Ri("$meta",Al("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),y=(h.create(l),h._completion.catch(c),h._reject.bind(h)),S=Ne.transless||Ne;In(function(){if(Ne.trans=h,Ne.transless=S,s!==0)return zs(n,l),V=s,((M=h).storeNames.includes("$meta")?M.table("$meta").get("version").then(function(D){return D??V}):Ie.resolve(V)).then(function(Y){var O=n,B=Y,z=h,j=l,R=[],Y=O._versions,Z=O._dbSchema=Us(0,O.idbdb,j);return(Y=Y.filter(function(W){return W._cfg.version>=B})).length===0?Ie.resolve():(Y.forEach(function(W){R.push(function(){var le,ge,Ce,Pe=Z,ye=W._cfg.dbschema,qe=(Gs(O,Pe,j),Gs(O,ye,j),Z=O._dbSchema=ye,ji(Pe,ye)),Le=(qe.add.forEach(function(Se){Li(j,Se[0],Se[1].primKey,Se[1].indexes)}),qe.change.forEach(function(Se){if(Se.recreate)throw new P.Upgrade("Not yet support for changing primary key");var Be=j.objectStore(Se.name);Se.add.forEach(function(vt){return Ks(Be,vt)}),Se.change.forEach(function(vt){Be.deleteIndex(vt.name),Ks(Be,vt)}),Se.del.forEach(function(vt){return Be.deleteIndex(vt)})}),W._cfg.contentUpgrade);if(Le&&W._cfg.version>B)return zs(O,j),z._memoizedTables={},le=ce(ye),qe.del.forEach(function(Se){le[Se]=Pe[Se]}),Di(O,[O.Transaction.prototype]),Fs(O,[O.Transaction.prototype],u(le),le),z.schema=le,(ge=se(Le))&&Gt(),ye=Ie.follow(function(){var Se;(Ce=Le(z))&&ge&&(Se=kn.bind(null,null),Ce.then(Se,Se))}),Ce&&typeof Ce.then=="function"?Ie.resolve(Ce):ye.then(function(){return Ce})}),R.push(function(le){var ge,Ce,Pe=W._cfg.dbschema;ge=Pe,Ce=le,[].slice.call(Ce.db.objectStoreNames).forEach(function(ye){return ge[ye]==null&&Ce.db.deleteObjectStore(ye)}),Di(O,[O.Transaction.prototype]),Fs(O,[O.Transaction.prototype],O._storeNames,O._dbSchema),z.schema=O._dbSchema}),R.push(function(le){O.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(O.idbdb.version/10)===W._cfg.version?(O.idbdb.deleteObjectStore("$meta"),delete O._dbSchema.$meta,O._storeNames=O._storeNames.filter(function(ge){return ge!=="$meta"})):le.objectStore("$meta").put(W._cfg.version,"version"))})}),(function W(){return R.length?Ie.resolve(R.shift()(z.idbtrans)).then(W):Ie.resolve()})().then(function(){El(Z,j)}))}).catch(y);var M,V;u(f).forEach(function(D){Li(l,D,f[D].primKey,f[D].indexes)}),zs(n,l),Ie.follow(function(){return n.on.populate.fire(h)}).catch(y)})}function xd(n,s){El(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Us(0,n.idbdb,s);Gs(n,n._dbSchema,s);for(var c=0,f=ji(l,n._dbSchema).change;c<f.length;c++){var h=(y=>{if(y.change.length||y.recreate)return console.warn("Unable to patch indexes of table ".concat(y.name," because it has changes on the type of index or primary key.")),{value:void 0};var S=s.objectStore(y.name);y.add.forEach(function(M){et&&console.debug("Dexie upgrade patch: Creating missing index ".concat(y.name,".").concat(M.src)),Ks(S,M)})})(f[c]);if(typeof h=="object")return h.value}}function ji(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],h=s[l];if(f){var y={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)y.recreate=!0,c.change.push(y);else{var S=f.idxByName,M=h.idxByName,V=void 0;for(V in S)M[V]||y.del.push(V);for(V in M){var D=S[V],O=M[V];D?D.src!==O.src&&y.change.push(O):y.add.push(O)}(0<y.del.length||0<y.add.length||0<y.change.length)&&c.change.push(y)}}else c.add.push([l,h])}return c}function Li(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(h){return Ks(f,h)})}function El(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(et&&console.debug("Dexie: Creating missing table",l),Li(s,l,n[l].primKey,n[l].indexes))})}function Ks(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Us(n,s,l){var c={};return de(s.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),y=Oi(Sl(V=h.keyPath),V||"",!0,!1,!!h.autoIncrement,V&&typeof V!="string",!0),S=[],M=0;M<h.indexNames.length;++M){var D=h.index(h.indexNames[M]),V=D.keyPath,D=Oi(D.name,V,!!D.unique,!!D.multiEntry,!1,V&&typeof V!="string",!1);S.push(D)}c[f]=Ri(f,y,S)}),c}function Gs(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var h=c[f],y=l.objectStore(h);n._hasGetAll="getAll"in y;for(var S=0;S<y.indexNames.length;++S){var M,V=y.indexNames[S],D=y.index(V).keyPath,D=typeof D=="string"?D:"["+de(D).join("+")+"]";s[h]&&(M=s[h].idxByName[D])&&(M.name=V,delete s[h].idxByName[D],s[h].idxByName[V]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Al(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return Oi(f,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(h),l===0,c)})}Ra.prototype._createTableSchema=Ri,Ra.prototype._parseIndexSyntax=Al,Ra.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),h=f.shift();if(!h)throw new P.Schema("Invalid schema for table "+c+": "+n[c]);if(h.unique=!0,h.multi)throw new P.Schema("Primary key cannot be multiEntry*");f.forEach(function(y){if(y.auto)throw new P.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new P.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(c,h,f),s[c]=h}})},Ra.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(h){g(c,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(c,f)}),s._dbSchema=f,Di(s,[s._allTables,s,s.Transaction.prototype]),Fs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},Ra.prototype.upgrade=function(n){return this._cfg.contentUpgrade=$e(this._cfg.contentUpgrade||xe,n),this};var Sd=Ra;function Ra(){}function Ni(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new Er(on,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function qi(n){return n&&typeof n.databases=="function"}function Bi(n){return In(function(){return Ne.letThrough=!0,n()})}function zi(n){return!("from"in n)}var ln=function(n,s){var l;if(!this)return l=new ln,n&&"d"in n&&g(l,n),l;g(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function is(n,s,l){var c=dt(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(zi(n))return g(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(dt(l,n.from)<0)return c?is(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},Pl(n);if(0<dt(s,n.to))return f?is(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},Pl(n);dt(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<dt(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&os(n,c),f&&s&&os(n,f)}}function os(n,s){zi(s)||(function l(c,f){var h=f.from,y=f.l,S=f.r;is(c,h,f.to),y&&l(c,y),S&&l(c,S)})(n,s)}function Cl(n,s){var l=Ws(s),c=l.next();if(!c.done)for(var f=c.value,h=Ws(n),y=h.next(f.from),S=y.value;!c.done&&!y.done;){if(dt(S.from,f.to)<=0&&0<=dt(S.to,f.from))return!0;dt(f.from,S.from)<0?f=(c=l.next(S.from)).value:S=(y=h.next(f.from)).value}return!1}function Ws(n){var s=zi(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&dt(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||dt(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function Pl(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=Il(l)),n.d=Il(n)}function Il(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Hs(n,s){return u(s).forEach(function(l){n[l]?os(n[l],s[l]):n[l]=(function c(f){var h,y,S={};for(h in f)w(f,h)&&(y=f[h],S[h]=!y||typeof y!="object"||fe.has(y.constructor)?y:c(y));return S})(s[l])}),n}function Fi(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&Cl(s[l],n[l])})}k(ln.prototype,((ht={add:function(n){return os(this,n),this},addKey:function(n){return is(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return is(s,l,l)}),this},hasKey:function(n){var s=Ws(this).next(n).value;return s&&dt(s.from,n)<=0&&0<=dt(s.to,n)}})[_e]=function(){return Ws(this)},ht));var $r={},Ki={},Ui=!1;function Vs(n){Hs(Ki,n),Ui||(Ui=!0,setTimeout(function(){Ui=!1,Gi(Ki,!(Ki={}))},0))}function Gi(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values($r);c<f.length;c++)Ol(S=f[c],n,l,s);else for(var h in n){var y,S,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(y=h[1],h=h[2],S=$r["idb://".concat(y,"/").concat(h)])&&Ol(S,n,l,s)}l.forEach(function(M){return M()})}function Ol(n,s,l,c){for(var f=[],h=0,y=Object.entries(n.queries.query);h<y.length;h++){for(var S=y[h],M=S[0],V=[],D=0,O=S[1];D<O.length;D++){var B=O[D];Fi(s,B.obsSet)?B.subscribers.forEach(function(Y){return l.add(Y)}):c&&V.push(B)}c&&f.push([M,V])}if(c)for(var z=0,j=f;z<j.length;z++){var R=j[z],M=R[0],V=R[1];n.queries.query[M]=V}}function Td(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?we(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),h=!1;function y(){if(s.openCanceller!==c)throw new P.DatabaseClosed("db.open() was cancelled")}function S(){return new Ie(function(B,z){if(y(),!l)throw new P.MissingAPI;var j=n.name,R=s.autoSchema||!f?l.open(j):l.open(j,f);if(!R)throw new P.MissingAPI;R.onerror=ur(z),R.onblocked=ft(n._fireOnBlocked),R.onupgradeneeded=ft(function(Y){var Z;D=R.transaction,s.autoSchema&&!n._options.allowEmptyDB?(R.onerror=ns,D.abort(),R.result.close(),(Z=l.deleteDatabase(j)).onsuccess=Z.onerror=ft(function(){z(new P.NoSuchDatabase("Database ".concat(j," doesnt exist")))})):(D.onerror=ur(z),Z=Y.oldVersion>Math.pow(2,62)?0:Y.oldVersion,O=Z<1,n.idbdb=R.result,h&&xd(n,D),kd(n,Z/10,D,z))},z),R.onsuccess=ft(function(){D=null;var Y,Z,W,le,ge,Ce,Pe=n.idbdb=R.result,ye=de(Pe.objectStoreNames);if(0<ye.length)try{var qe=Pe.transaction((ge=ye).length===1?ge[0]:ge,"readonly");if(s.autoSchema)Ce=Pe,le=qe,(W=n).verno=Ce.version/10,le=W._dbSchema=Us(0,Ce,le),W._storeNames=de(Ce.objectStoreNames,0),Fs(W,[W._allTables],u(le),le);else if(Gs(n,n._dbSchema,qe),Z=qe,((Z=ji(Us(0,(Y=n).idbdb,Z),Y._dbSchema)).add.length||Z.change.some(function(Le){return Le.add.length||Le.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Pe.close(),f=Pe.version+1,h=!0,B(S());zs(n,qe)}catch{}Dt.push(n),Pe.onversionchange=ft(function(Le){s.vcFired=!0,n.on("versionchange").fire(Le)}),Pe.onclose=ft(function(){n.close({disableAutoOpen:!1})}),O&&(ye=n._deps,ge=j,qi(Ce=ye.indexedDB)||ge===on||Ni(Ce,ye.IDBKeyRange).put({name:ge}).catch(xe)),B()},z)}).catch(function(B){switch(B==null?void 0:B.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),S();break;case"VersionError":if(0<f)return f=0,S()}return Ie.reject(B)})}var M,V=s.dbReadyResolve,D=null,O=!1;return Ie.race([c,(typeof navigator>"u"?Ie.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(B){function z(){return indexedDB.databases().finally(B)}M=setInterval(z,100),z()}).finally(function(){return clearInterval(M)}):Promise.resolve()).then(S)]).then(function(){return y(),s.onReadyBeingFired=[],Ie.resolve(Bi(function(){return n.on.ready.fire(n.vip)})).then(function B(){var z;if(0<s.onReadyBeingFired.length)return z=s.onReadyBeingFired.reduce($e,xe),s.onReadyBeingFired=[],Ie.resolve(Bi(function(){return z(n.vip)})).then(B)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(B){s.dbOpenError=B;try{D&&D.abort()}catch{}return c===s.openCanceller&&n._close(),we(B)}).finally(function(){s.openComplete=!0,V()}).then(function(){var B;return O&&(B={},n.tables.forEach(function(z){z.schema.indexes.forEach(function(j){j.name&&(B["idb://".concat(n.name,"/").concat(z.name,"/").concat(j.name)]=new ln(-1/0,[[[]]]))}),B["idb://".concat(n.name,"/").concat(z.name,"/")]=B["idb://".concat(n.name,"/").concat(z.name,"/:dels")]=new ln(-1/0,[[[]]])}),Br(rs).fire(B),Gi(B,!0)),n})}function Wi(n){function s(h){return n.next(h)}var l=f(s),c=f(function(h){return n.throw(h)});function f(h){return function(S){var S=h(S),M=S.value;return S.done?M:M&&typeof M.then=="function"?M.then(l,c):d(M)?Promise.all(M).then(l,c):l(M)}}return f(s)()}function Ys(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var Ed={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},h=[];function y(B,z,j){var W=ss(B),R=f[W]=f[W]||[],Y=B==null?0:typeof B=="string"?1:B.length,Z=0<z,W=a(a({},j),{name:Z?"".concat(W,"(virtual-from:").concat(j.name,")"):j.name,lowLevelIndex:j,isVirtual:Z,keyTail:z,keyLength:Y,extractKey:Mi(B),unique:!Z&&j.unique});return R.push(W),W.isPrimaryKey||h.push(W),1<Y&&y(Y===2?B[0]:B.slice(0,Y-1),z+1,j),R.sort(function(le,ge){return le.keyTail-ge.keyTail}),W}var S=y(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[S];for(var M=0,V=c.indexes;M<V.length;M++){var D=V[M];y(D.keyPath,0,D)}function O(B){var z,j=B.query.index;return j.isVirtual?a(a({},B),{query:{index:j.lowLevelIndex,range:(z=B.query.range,j=j.keyTail,{type:z.type===1?2:z.type,lower:Ys(z.lower,z.lowerOpen?n.MAX_KEY:n.MIN_KEY,j),lowerOpen:!0,upper:Ys(z.upper,z.upperOpen?n.MIN_KEY:n.MAX_KEY,j),upperOpen:!0})}}):B}return a(a({},l),{schema:a(a({},c),{primaryKey:S,indexes:h,getIndexByKeyPath:function(B){return(B=f[ss(B)])&&B[0]}}),count:function(B){return l.count(O(B))},query:function(B){return l.query(O(B))},openCursor:function(B){var z=B.query.index,j=z.keyTail,R=z.keyLength;return z.isVirtual?l.openCursor(O(B)).then(function(Z){return Z&&Y(Z)}):l.openCursor(B);function Y(Z){return Object.create(Z,{continue:{value:function(W){W!=null?Z.continue(Ys(W,B.reverse?n.MAX_KEY:n.MIN_KEY,j)):B.unique?Z.continue(Z.key.slice(0,R).concat(B.reverse?n.MIN_KEY:n.MAX_KEY,j)):Z.continue()}},continuePrimaryKey:{value:function(W,le){Z.continuePrimaryKey(Ys(W,n.MAX_KEY,j),le)}},primaryKey:{get:function(){return Z.primaryKey}},key:{get:function(){var W=Z.key;return R===1?W[0]:W.slice(0,R)}},value:{get:function(){return Z.value}}})}}})}})}};function Hi(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var h,y,S;w(s,f)?(h=n[f],y=s[f],typeof h=="object"&&typeof y=="object"&&h&&y?(S=ue(h))!==ue(y)?l[c+f]=s[f]:S==="Object"?Hi(h,y,l,c+f+"."):h!==y&&(l[c+f]=s[f]):h!==y&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){w(n,f)||(l[c+f]=s[f])}),l}function Vi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var Ad={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var h=Ne.trans,y=h.table(s).hook,S=y.deleting,M=y.creating,V=y.updating;switch(f.type){case"add":if(M.fire===xe)break;return h._promise("readwrite",function(){return D(f)},!0);case"put":if(M.fire===xe&&V.fire===xe)break;return h._promise("readwrite",function(){return D(f)},!0);case"delete":if(S.fire===xe)break;return h._promise("readwrite",function(){return D(f)},!0);case"deleteRange":if(S.fire===xe)break;return h._promise("readwrite",function(){return(function O(B,z,j){return l.query({trans:B,values:!1,query:{index:c,range:z},limit:j}).then(function(R){var Y=R.result;return D({type:"delete",keys:Y,trans:B}).then(function(Z){return 0<Z.numFailures?Promise.reject(Z.failures[0]):Y.length<j?{failures:[],numFailures:0,lastResult:void 0}:O(B,a(a({},z),{lower:Y[Y.length-1],lowerOpen:!0}),j)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function D(O){var B,z,j,R=Ne.trans,Y=O.keys||Vi(c,O);if(Y)return(O=O.type==="add"||O.type==="put"?a(a({},O),{keys:Y}):a({},O)).type!=="delete"&&(O.values=i([],O.values)),O.keys&&(O.keys=i([],O.keys)),B=l,j=Y,((z=O).type==="add"?Promise.resolve([]):B.getMany({trans:z.trans,keys:j,cache:"immutable"})).then(function(Z){var W=Y.map(function(le,ge){var Ce,Pe,ye,qe=Z[ge],Le={onerror:null,onsuccess:null};return O.type==="delete"?S.fire.call(Le,le,qe,R):O.type==="add"||qe===void 0?(Ce=M.fire.call(Le,le,O.values[ge],R),le==null&&Ce!=null&&(O.keys[ge]=le=Ce,c.outbound||G(O.values[ge],c.keyPath,le))):(Ce=Hi(qe,O.values[ge]),(Pe=V.fire.call(Le,Ce,le,qe,R))&&(ye=O.values[ge],Object.keys(Pe).forEach(function(Se){w(ye,Se)?ye[Se]=Pe[Se]:G(ye,Se,Pe[Se])}))),Le});return l.mutate(O).then(function(le){for(var ge=le.failures,Ce=le.results,Pe=le.numFailures,le=le.lastResult,ye=0;ye<Y.length;++ye){var qe=(Ce||Y)[ye],Le=W[ye];qe==null?Le.onerror&&Le.onerror(ge[ye]):Le.onsuccess&&Le.onsuccess(O.type==="put"&&Z[ye]?O.values[ye]:qe)}return{failures:ge,results:Ce,numFailures:Pe,lastResult:le}}).catch(function(le){return W.forEach(function(ge){return ge.onerror&&ge.onerror(le)}),Promise.reject(le)})});throw new Error("Keys missing")}}})}})}};function Rl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,h=0;f<s.keys.length&&h<n.length;++f)dt(s.keys[f],n[h])===0&&(c.push(l?oe(s.values[f]):s.values[f]),++h);return c.length===n.length?c:null}catch{return null}}var Cd={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=Rl(c.keys,c.trans._cache,c.cache==="clone"))?Ie.resolve(f):l.getMany(c).then(function(h){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?oe(h):h},h}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function Ml(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function Dl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Pd={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new ln(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,h){if(Ne.subscr&&f!=="readonly")throw new P.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ne.querier));return n.transaction(c,f,h)},table:function(c){function f(Y){var R,Y=Y.query;return[R=Y.index,new ln((R=(Y=Y.range).lower)!=null?R:n.MIN_KEY,(R=Y.upper)!=null?R:n.MAX_KEY)]}var h=n.table(c),y=h.schema,S=y.primaryKey,M=y.indexes,V=S.extractKey,D=S.outbound,O=S.autoIncrement&&M.filter(function(j){return j.compound&&j.keyPath.includes(S.keyPath)}),B=a(a({},h),{mutate:function(j){function R(Be){return Be="idb://".concat(s,"/").concat(c,"/").concat(Be),ge[Be]||(ge[Be]=new ln)}var Y,Z,W,le=j.trans,ge=j.mutatedParts||(j.mutatedParts={}),Ce=R(""),Pe=R(":dels"),ye=j.type,Le=j.type==="deleteRange"?[j.range]:j.type==="delete"?[j.keys]:j.values.length<50?[Vi(S,j).filter(function(Be){return Be}),j.values]:[],qe=Le[0],Le=Le[1],Se=j.trans._cache;return d(qe)?(Ce.addKeys(qe),(ye=ye==="delete"||qe.length===Le.length?Rl(qe,Se):null)||Pe.addKeys(qe),(ye||Le)&&(Y=R,Z=ye,W=Le,y.indexes.forEach(function(Be){var vt=Y(Be.name||"");function _t(tt){return tt!=null?Be.extractKey(tt):null}function Ge(tt){Be.multiEntry&&d(tt)?tt.forEach(function(Lt){return vt.addKey(Lt)}):vt.addKey(tt)}(Z||W).forEach(function(tt,Nt){var Kn=Z&&_t(Z[Nt]),Nt=W&&_t(W[Nt]);dt(Kn,Nt)!==0&&(Kn!=null&&Ge(Kn),Nt!=null)&&Ge(Nt)})}))):qe?(Le={from:(Se=qe.lower)!=null?Se:n.MIN_KEY,to:(ye=qe.upper)!=null?ye:n.MAX_KEY},Pe.add(Le),Ce.add(Le)):(Ce.add(l),Pe.add(l),y.indexes.forEach(function(Be){return R(Be.name).add(l)})),h.mutate(j).then(function(Be){return!qe||j.type!=="add"&&j.type!=="put"||(Ce.addKeys(Be.results),O&&O.forEach(function(vt){for(var _t=j.values.map(function(Kn){return vt.extractKey(Kn)}),Ge=vt.keyPath.findIndex(function(Kn){return Kn===S.keyPath}),tt=0,Lt=Be.results.length;tt<Lt;++tt)_t[tt][Ge]=Be.results[tt];R(vt.name).addKeys(_t)})),le.mutatedParts=Hs(le.mutatedParts||{},ge),Be})}}),z={get:function(j){return[S,new ln(j.key)]},getMany:function(j){return[S,new ln().addKeys(j.keys)]},count:f,query:f,openCursor:f};return u(z).forEach(function(j){B[j]=function(R){var Y=Ne.subscr,Z=!!Y,W=Ml(Ne,h)&&Dl(j,R)?R.obsSet={}:Y;if(Z){var le,Y=function(Le){return Le="idb://".concat(s,"/").concat(c,"/").concat(Le),W[Le]||(W[Le]=new ln)},ge=Y(""),Ce=Y(":dels"),Z=z[j](R),Pe=Z[0],Z=Z[1];if((j==="query"&&Pe.isPrimaryKey&&!R.values?Ce:Y(Pe.name||"")).add(Z),!Pe.isPrimaryKey){if(j!=="count")return le=j==="query"&&D&&R.values&&h.query(a(a({},R),{values:!1})),h[j].apply(this,arguments).then(function(Le){if(j==="query"){if(D&&R.values)return le.then(function(_t){return _t=_t.result,ge.addKeys(_t),Le});var Se=R.values?Le.result.map(V):Le.result;(R.values?ge:Ce).addKeys(Se)}else{var Be,vt;if(j==="openCursor")return vt=R.values,(Be=Le)&&Object.create(Be,{key:{get:function(){return Ce.addKey(Be.primaryKey),Be.key}},primaryKey:{get:function(){var _t=Be.primaryKey;return Ce.addKey(_t),_t}},value:{get:function(){return vt&&ge.addKey(Be.primaryKey),Be.value}}})}return Le});Ce.add(l)}}return h[j].apply(this,arguments)}}),B}})}};function jl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,h){return!(h in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,h){return!(h in l.failures)})),c)}function Yi(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<dt(l,c.lower):0<=dt(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?dt(l,c.upper)<0:dt(l,c.upper)<=0));var l,c}function Ll(n,s,l,c,f,h){var y,S,M,V,D,O;return!l||l.length===0||(y=s.query.index,S=y.multiEntry,M=s.query.range,V=c.schema.primaryKey.extractKey,D=y.extractKey,O=(y.lowLevelIndex||y).extractKey,(c=l.reduce(function(B,z){var j=B,R=[];if(z.type==="add"||z.type==="put")for(var Y=new ln,Z=z.values.length-1;0<=Z;--Z){var W,le=z.values[Z],ge=V(le);!Y.hasKey(ge)&&(W=D(le),S&&d(W)?W.some(function(Le){return Yi(Le,M)}):Yi(W,M))&&(Y.addKey(ge),R.push(le))}switch(z.type){case"add":var Ce=new ln().addKeys(s.values?B.map(function(Se){return V(Se)}):B),j=B.concat(s.values?R.filter(function(Se){return Se=V(Se),!Ce.hasKey(Se)&&(Ce.addKey(Se),!0)}):R.map(function(Se){return V(Se)}).filter(function(Se){return!Ce.hasKey(Se)&&(Ce.addKey(Se),!0)}));break;case"put":var Pe=new ln().addKeys(z.values.map(function(Se){return V(Se)}));j=B.filter(function(Se){return!Pe.hasKey(s.values?V(Se):Se)}).concat(s.values?R:R.map(function(Se){return V(Se)}));break;case"delete":var ye=new ln().addKeys(z.keys);j=B.filter(function(Se){return!ye.hasKey(s.values?V(Se):Se)});break;case"deleteRange":var qe=z.range;j=B.filter(function(Se){return!Yi(V(Se),qe)})}return j},n))===n)?n:(c.sort(function(B,z){return dt(O(B),O(z))||dt(V(B),V(z))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),h?Object.freeze(c):c)}function Nl(n,s){return dt(n.lower,s.lower)===0&&dt(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function Id(n,s){return((l,c,f,h)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=dt(l,c))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,h)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=dt(l,c))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function Od(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=s,setTimeout(function(){f.subscribers.size===0&&ae(h,f)},3e3))})}var Rd={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var h,y,S=n.transaction(l,c,f);return c==="readwrite"&&(f=(h=new AbortController).signal,S.addEventListener("abort",(y=function(M){return function(){if(h.abort(),c==="readwrite"){for(var V=new Set,D=0,O=l;D<O.length;D++){var B=O[D],z=$r["idb://".concat(s,"/").concat(B)];if(z){var j=n.table(B),R=z.optimisticOps.filter(function(Be){return Be.trans===S});if(S._explicit&&M&&S.mutatedParts)for(var Y=0,Z=Object.values(z.queries.query);Y<Z.length;Y++)for(var W=0,le=(Pe=Z[Y]).slice();W<le.length;W++)Fi((ye=le[W]).obsSet,S.mutatedParts)&&(ae(Pe,ye),ye.subscribers.forEach(function(Be){return V.add(Be)}));else if(0<R.length){z.optimisticOps=z.optimisticOps.filter(function(Be){return Be.trans!==S});for(var ge=0,Ce=Object.values(z.queries.query);ge<Ce.length;ge++)for(var Pe,ye,qe,Le=0,Se=(Pe=Ce[ge]).slice();Le<Se.length;Le++)(ye=Se[Le]).res!=null&&S.mutatedParts&&(M&&!ye.dirty?(qe=Object.isFrozen(ye.res),qe=Ll(ye.res,ye.req,R,j,ye,qe),ye.dirty?(ae(Pe,ye),ye.subscribers.forEach(function(Be){return V.add(Be)})):qe!==ye.res&&(ye.res=qe,ye.promise=Ie.resolve({result:qe}))):(ye.dirty&&ae(Pe,ye),ye.subscribers.forEach(function(Be){return V.add(Be)})))}}}V.forEach(function(Be){return Be()})}}})(!1),{signal:f}),S.addEventListener("error",y(!1),{signal:f}),S.addEventListener("complete",y(!0),{signal:f})),S},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(h){var y,S=Ne.trans;return!f.outbound&&S.db._options.cache!=="disabled"&&!S.explicit&&S.idbtrans.mode==="readwrite"&&(y=$r["idb://".concat(s,"/").concat(l)])?(S=c.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Vi(f,h).some(function(M){return M==null}))?(y.optimisticOps.push(h),h.mutatedParts&&Vs(h.mutatedParts),S.then(function(M){0<M.numFailures&&(ae(y.optimisticOps,h),(M=jl(0,h,M))&&y.optimisticOps.push(M),h.mutatedParts)&&Vs(h.mutatedParts)}),S.catch(function(){ae(y.optimisticOps,h),h.mutatedParts&&Vs(h.mutatedParts)})):S.then(function(M){var V=jl(0,a(a({},h),{values:h.values.map(function(D,O){var B;return M.failures[O]?D:(G(B=(B=f.keyPath)!=null&&B.includes(".")?oe(D):a({},D),f.keyPath,M.results[O]),B)})}),M);y.optimisticOps.push(V),queueMicrotask(function(){return h.mutatedParts&&Vs(h.mutatedParts)})}),S):c.mutate(h)},query:function(h){var y,S,M,V,D,O,B;return Ml(Ne,c)&&Dl("query",h)?(y=((M=Ne.trans)==null?void 0:M.db._options.cache)==="immutable",S=(M=Ne).requery,M=M.signal,O=((z,j,R,Y)=>{var Z=$r["idb://".concat(z,"/").concat(j)];if(!Z)return[];if(!(z=Z.queries[R]))return[null,!1,Z,null];var W=z[(Y.query?Y.query.index.name:null)||""];if(!W)return[null,!1,Z,null];switch(R){case"query":var le=W.find(function(ge){return ge.req.limit===Y.limit&&ge.req.values===Y.values&&Nl(ge.req.query.range,Y.query.range)});return le?[le,!0,Z,W]:[W.find(function(ge){return("limit"in ge.req?ge.req.limit:1/0)>=Y.limit&&(!Y.values||ge.req.values)&&Id(ge.req.query.range,Y.query.range)}),!1,Z,W];case"count":return le=W.find(function(ge){return Nl(ge.req.query.range,Y.query.range)}),[le,!!le,Z,W]}})(s,l,"query",h),B=O[0],V=O[2],D=O[3],B&&O[1]?B.obsSet=h.obsSet:(O=c.query(h).then(function(z){var j=z.result;if(B&&(B.res=j),y){for(var R=0,Y=j.length;R<Y;++R)Object.freeze(j[R]);Object.freeze(j)}else z.result=oe(j);return z}).catch(function(z){return D&&B&&ae(D,B),Promise.reject(z)}),B={obsSet:h.obsSet,promise:O,subscribers:new Set,type:"query",req:h,dirty:!1},D?D.push(B):(D=[B],(V=V||($r["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=D)),Od(B,D,S,M),B.promise.then(function(z){return{result:Ll(z.result,h,V==null?void 0:V.optimisticOps,c,B,y)}})):c.query(h)}})}})}};function Qs(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}qt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new P.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new P.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(wd),l.stores({}),this._state.autoSchema=!1),l},qt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Ne.letThrough||this._vip)?n():new Ie(function(l,c){if(s._state.openComplete)return c(new P.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new P.DatabaseClosed);s.open().catch(xe)}s._state.dbReadyPromise.then(l,c)}).then(n)},qt.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,h=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return h.push({stack:s,create:l,level:c??10,name:f}),h.sort(function(y,S){return y.level-S.level}),this},qt.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},qt.prototype.open=function(){var n=this;return Fe(jt,function(){return Td(n)})},qt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=Dt.indexOf(this);if(0<=s&&Dt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ie(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ie(function(l,c){n.cancelOpen=c}))},qt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new P.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new P.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},qt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ie(function(f,h){function y(){s.close(n);var S=s._deps.indexedDB.deleteDatabase(s.name);S.onsuccess=ft(function(){var M,V,D;M=s._deps,V=s.name,qi(D=M.indexedDB)||V===on||Ni(D,M.IDBKeyRange).delete(V).catch(xe),f()}),S.onerror=ur(h),S.onblocked=s._fireOnBlocked}if(l)throw new P.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(y):y()})},qt.prototype.backendDB=function(){return this.idbdb},qt.prototype.isOpen=function(){return this.idbdb!==null},qt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qt.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),qt.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new P.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return c=h.pop(),[s,Ee(h),c]}).apply(this,arguments);return this._transaction.apply(this,n)},qt.prototype._transaction=function(n,s,l){var c,f,h=this,y=Ne.trans,S=(y&&y.db===this&&n.indexOf("!")===-1||(y=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(V){if(V=V instanceof h.Table?V.name:V,typeof V!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return V}),n=="r"||n===Fn)c=Fn;else{if(n!="rw"&&n!=Jt)throw new P.InvalidArgument("Invalid transaction mode: "+n);c=Jt}if(y){if(y.mode===Fn&&c===Jt){if(!S)throw new P.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");y=null}y&&f.forEach(function(V){if(y&&y.storeNames.indexOf(V)===-1){if(!S)throw new P.SubTransaction("Table "+V+" not included in parent transaction.");y=null}}),S&&y&&!y.active&&(y=null)}}catch(V){return y?y._promise(null,function(D,O){O(V)}):we(V)}var M=(function V(D,O,B,z,j){return Ie.resolve().then(function(){var W=Ne.transless||Ne,R=D._createTransaction(O,B,D._dbSchema,z),W=(R.explicit=!0,{trans:R,transless:W});if(z)R.idbtrans=z.idbtrans;else try{R.create(),R.idbtrans._explicit=!0,D._state.PR1398_maxLoop=3}catch(le){return le.name===Ae.InvalidState&&D.isOpen()&&0<--D._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),D.close({disableAutoOpen:!1}),D.open().then(function(){return V(D,O,B,null,j)})):we(le)}var Y,Z=se(j),W=(Z&&Gt(),Ie.follow(function(){var le;(Y=j.call(R,R))&&(Z?(le=kn.bind(null,null),Y.then(le,le)):typeof Y.next=="function"&&typeof Y.throw=="function"&&(Y=Wi(Y)))},W));return(Y&&typeof Y.then=="function"?Ie.resolve(Y).then(function(le){return R.active?le:we(new P.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):W.then(function(){return Y})).then(function(le){return z&&R._resolve(),R._completion.then(function(){return le})}).catch(function(le){return R._reject(le),we(le)})})}).bind(null,this,c,f,y,l);return y?y._promise(c,M,"lock"):Ne.trans?Fe(Ne.transless,function(){return h._whenReady(M)}):this._whenReady(M)},qt.prototype.table=function(n){if(w(this._allTables,n))return this._allTables[n];throw new P.InvalidTable("Table ".concat(n," does not exist"))};var Er=qt;function qt(n,s){var l,c,f,h,y,S=this,M=(this._middlewares={},this.verno=0,qt.dependencies),M=(this._options=s=a({addons:qt.addons,autoOpen:!0,indexedDB:M.indexedDB,IDBKeyRange:M.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),V=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:xe,dbReadyPromise:null,cancelOpen:xe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),D=(V.dbReadyPromise=new Ie(function(O){V.dbReadyResolve=O}),V.openCanceller=new Ie(function(O,B){V.cancelOpen=B}),this._state=V,this.name=n,this.on=es(this,"populate","blocked","versionchange","close",{ready:[$e,xe]}),this.once=function(O,B){var z=function(){for(var j=[],R=0;R<arguments.length;R++)j[R]=arguments[R];S.on(O).unsubscribe(z),B.apply(S,j)};return S.on(O,z)},this.on.ready.subscribe=H(this.on.ready.subscribe,function(O){return function(B,z){qt.vip(function(){var j,R=S._state;R.openComplete?(R.dbOpenError||Ie.resolve().then(B),z&&O(B)):R.onReadyBeingFired?(R.onReadyBeingFired.push(B),z&&O(B)):(O(B),j=S,z||O(function Y(){j.on.ready.unsubscribe(B),j.on.ready.unsubscribe(Y)}))})}}),this.Collection=(l=this,ts(pd.prototype,function(Y,R){this.db=l;var z=Sr,j=null;if(R)try{z=R()}catch(W){j=W}var R=Y._ctx,Y=R.table,Z=Y.hook.reading.fire;this._ctx={table:Y,index:R.index,isPrimKey:!R.index||Y.schema.primKey.keyPath&&R.index===Y.schema.primKey.name,range:z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:j,or:R.or,valueMapper:Z!==Me?Z:null}})),this.Table=(c=this,ts(_l.prototype,function(O,B,z){this.db=c,this._tx=z,this.name=O,this.schema=B,this.hook=c._allTables[O]?c._allTables[O].hook:es(null,{creating:[it,xe],reading:[Xe,Me],updating:[He,xe],deleting:[At,xe]})})),this.Transaction=(f=this,ts(gd.prototype,function(O,B,z,j,R){var Y=this;O!=="readonly"&&B.forEach(function(Z){Z=(Z=z[Z])==null?void 0:Z.yProps,Z&&(B=B.concat(Z.map(function(W){return W.updatesTable})))}),this.db=f,this.mode=O,this.storeNames=B,this.schema=z,this.chromeTransactionDurability=j,this.idbtrans=null,this.on=es(this,"complete","error","abort"),this.parent=R||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ie(function(Z,W){Y._resolve=Z,Y._reject=W}),this._completion.then(function(){Y.active=!1,Y.on.complete.fire()},function(Z){var W=Y.active;return Y.active=!1,Y.on.error.fire(Z),Y.parent?Y.parent._reject(Z):W&&Y.idbtrans&&Y.idbtrans.abort(),we(Z)})})),this.Version=(h=this,ts(Sd.prototype,function(O){this.db=h,this._cfg={version:O,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,ts(xl.prototype,function(O,B,z){if(this.db=y,this._ctx={table:O,index:B===":id"?null:B,or:z},this._cmp=this._ascending=dt,this._descending=function(j,R){return dt(R,j)},this._max=function(j,R){return 0<dt(j,R)?j:R},this._min=function(j,R){return dt(j,R)<0?j:R},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new P.MissingAPI})),this.on("versionchange",function(O){0<O.newVersion?console.warn("Another connection wants to upgrade database '".concat(S.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(S.name,"'. Closing db now to resume the delete request.")),S.close({disableAutoOpen:!1})}),this.on("blocked",function(O){!O.newVersion||O.newVersion<O.oldVersion?console.warn("Dexie.delete('".concat(S.name,"') was blocked")):console.warn("Upgrade '".concat(S.name,"' blocked by other connection holding version ").concat(O.oldVersion/10))}),this._maxKey=as(s.IDBKeyRange),this._createTransaction=function(O,B,z,j){return new S.Transaction(O,B,z,S._options.chromeTransactionDurability,j)},this._fireOnBlocked=function(O){S.on("blocked").fire(O),Dt.filter(function(B){return B.name===S.name&&B!==S&&!B._state.vcFired}).map(function(B){return B.on("versionchange").fire(O)})},this.use(Cd),this.use(Rd),this.use(Pd),this.use(Ed),this.use(Ad),new Proxy(this,{get:function(O,B,z){var j;return B==="_vip"||(B==="table"?function(R){return Qs(S.table(R),D)}:(j=Reflect.get(O,B,z))instanceof _l?Qs(j,D):B==="tables"?j.map(function(R){return Qs(R,D)}):B==="_createTransaction"?function(){return Qs(j.apply(this,arguments),D)}:j)}}));this.vip=D,M.forEach(function(O){return O(S)})}var Xs,Ma=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Md=(Qi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Qi.prototype[Ma]=function(){return this},Qi);function Qi(n){this._subscribe=n}try{Xs={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Xs={indexedDB:null,IDBKeyRange:null}}function ql(n){var s,l=!1,c=new Md(function(f){var h=se(n),y,S=!1,M={},V={},D={get closed(){return S},unsubscribe:function(){S||(S=!0,y&&y.abort(),O&&Br.storagemutated.unsubscribe(z))}},O=(f.start&&f.start(D),!1),B=function(){return he(j)},z=function(R){Hs(M,R),Fi(V,M)&&B()},j=function(){var R,Y,Z;!S&&Xs.indexedDB&&(M={},R={},y&&y.abort(),y=new AbortController,Z=(W=>{var le=Vt();try{h&&Gt();var ge=In(n,W);return ge=h?ge.finally(kn):ge}finally{le&&fn()}})(Y={subscr:R,signal:y.signal,requery:B,querier:n,trans:null}),Promise.resolve(Z).then(function(W){l=!0,s=W,S||Y.signal.aborted||(M={},(le=>{for(var ge in le)if(w(le,ge))return;return 1})(V=R)||O||(Br(rs,z),O=!0),he(function(){return!S&&f.next&&f.next(W)}))},function(W){l=!1,["DatabaseClosedError","AbortError"].includes(W==null?void 0:W.name)||S||he(function(){S||f.error&&f.error(W)})}))};return setTimeout(B,0),D});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var ea=Er;function Xi(n){var s=zr;try{zr=!0,Br.storagemutated.fire(n),Gi(n,!0)}finally{zr=s}}k(ea,a(a({},J),{delete:function(n){return new ea(n,{addons:[]}).delete()},exists:function(n){return new ea(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=ea.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(qi(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==on})}):Ni(l,s).toCollection().primaryKeys()).then(n)}catch{return we(new P.MissingAPI)}var s,l},defineClass:function(){return function(n){g(this,n)}},ignoreTransaction:function(n){return Ne.trans?Fe(Ne.transless,n):n()},vip:Bi,async:function(n){return function(){try{var s=Wi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ie.resolve(s)}catch(l){return we(l)}}},spawn:function(n,s,l){try{var c=Wi(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ie.resolve(c)}catch(f){return we(f)}},currentTransaction:{get:function(){return Ne.trans||null}},waitFor:function(n,s){return n=Ie.resolve(typeof n=="function"?ea.ignoreTransaction(n):n).timeout(s||6e4),Ne.trans?Ne.trans.waitFor(n):n},Promise:Ie,debug:{get:function(){return et},set:function(n){Ke(n)}},derive:C,extend:g,props:k,override:H,Events:es,on:Br,liveQuery:ql,extendObservabilitySet:Hs,getByKeyPath:te,setByKeyPath:G,delByKeyPath:function(n,s){typeof s=="string"?G(n,s,void 0):"length"in s&&[].map.call(s,function(l){G(n,l,void 0)})},shallowClone:ce,deepClone:oe,getObjectDiff:Hi,cmp:dt,asap:X,minKey:-1/0,addons:[],connections:Dt,errnames:Ae,dependencies:Xs,cache:$r,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),ea.maxKey=as(ea.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Br(rs,function(n){zr||(n=new CustomEvent(Ii,{detail:n}),zr=!0,dispatchEvent(n),zr=!1)}),addEventListener(Ii,function(n){n=n.detail,zr||Xi(n)}));var Da,zr=!1,Bl=function(){};return typeof BroadcastChannel<"u"&&((Bl=function(){(Da=new BroadcastChannel(Ii)).onmessage=function(n){return n.data&&Xi(n.data)}})(),typeof Da.unref=="function"&&Da.unref(),Br(rs,function(n){zr||Da.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Er.disableBfCache&&n.persisted){et&&console.debug("Dexie: handling persisted pagehide"),Da!=null&&Da.close();for(var s=0,l=Dt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Er.disableBfCache&&n.persisted&&(et&&console.debug("Dexie: handling persisted pageshow"),Bl(),Xi({all:new ln(-1/0,[[]])}))})),Ie.rejectionMapper=function(n,s){return!n||n instanceof K||n instanceof TypeError||n instanceof SyntaxError||!n.name||!me[n.name]?n:(s=new me[n.name](s||n.message,n),"stack"in n&&N(s,"stack",{get:function(){return this.inner.stack}}),s)},Ke(et),a(Er,Object.freeze({__proto__:null,Dexie:Er,Entity:vl,PropModification:$a,RangeSet:ln,add:function(n){return new $a({add:n})},cmp:dt,default:Er,liveQuery:ql,mergeRanges:os,rangesOverlap:Cl,remove:function(n){return new $a({remove:n})},replacePrefix:function(n,s){return new $a({replacePrefix:[n,s]})}}),{default:Er}),Er})})(ci)),ci.exports}var Av=Ev();const To=Sv(Av),ac=Symbol.for("Dexie"),un=globalThis[ac]||(globalThis[ac]=To);if(To.semVer!==un.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${To.semVer} and ${un.semVer}`);const{liveQuery:Qy,mergeRanges:Xy,rangesOverlap:Zy,RangeSet:Jy,cmp:$y,Entity:eb,PropModification:tb,replacePrefix:nb,add:rb,remove:ab,DexieYProvider:sb}=un,Ue=new un("me-ai-store");Ue.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Ue.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Ue.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Ue.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function Iu(t,e){return`${t}:${e}`}function Eo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function so(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function Cv(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function Pv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function Ou(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const Iv="https://gmail.googleapis.com/gmail/v1/users/me";class Jo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function Ov(t){return{Authorization:`Bearer ${t}`}}async function Ti(t,e){var a,i,o,u;const r=await fetch(`${Iv}${e}`,{headers:Ov(t)});if(!r.ok){const d=await r.json().catch(()=>({})),g=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,p=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new Jo(g,r.status,p)}return r.json()}function Ru(t){return Ti(t,"/profile")}function Mu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),Ti(t,`/messages?${i}`)}function Du(t,e,r="full"){return Ti(t,`/messages/${e}?format=${r}`)}function Rv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),Ti(t,`/history?${i}`)}function Kr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ws(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function Mv(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ws(e.body.data);const r=e.parts||[],a=fi(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return ws(a.body.data);const i=fi(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const g=ws(i.body.data);return jv(g)}return"(no body)"}function Dv(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ws(e.body.data);const r=e.parts||[],a=fi(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ws(a.body.data):null}function fi(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=fi(r.parts,e);if(a)return a}}return null}function jv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function $o(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function ju(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function Lu(t){return ju(t).charAt(0).toUpperCase()}function Lv(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function Nv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Nu(t,e){return`${Lv(t.date)}_${Nv(t.subject)}.${e}`}function qu(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function qv(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Bu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function Bv(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Bu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function zv(t=10){const e=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(zu).join(`

---

`)}async function Fv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Ue.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,g,p,b,w;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(g=o.from)!=null&&g.toLowerCase().includes(r)&&(u+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(u+=2),(b=o.snippet)!=null&&b.toLowerCase().includes(r)&&(u+=1),(w=o.body)!=null&&w.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>zu(o)).join(`

---

`)}async function sc(){const t=await Ue.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=qu(t);return{groups:e,order:r,total:t.length}}async function Kv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await Ue.items.where("sourceType").equals("gmail").filter(d=>{var g,p,b,w;return((g=d.subject)==null?void 0:g.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((b=d.to)==null?void 0:b.toLowerCase().includes(o))||((w=d.snippet)==null?void 0:w.toLowerCase().includes(o))}).toArray();return u.sort((d,g)=>(g.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await Ue.items.where("sourceType").equals("gmail").count();return{items:await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Bu(){const t=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).first(),e=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).last();return{oldest:t,newest:e}}function zu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Pv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function Uv(){const t=await qv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Gv(t){const e=[],r=await Bv();if(e.push(r),t){const a=await Fv(t,5);e.push("","## Relevant Emails",a)}else{const a=await zv(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Wv="modulepreload",Hv=function(t){return"/me-ai/"+t},ic={},Vv=function(e,r,a){let i=Promise.resolve();if(r&&r.length>0){let u=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=u(r.map(p=>{if(p=Hv(p),p in ic)return;ic[p]=!0;const b=p.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const k=document.createElement("link");if(k.rel=b?"stylesheet":Wv,b||(k.as="script"),k.crossOrigin="",k.href=p,g&&k.setAttribute("nonce",g),document.head.appendChild(k),b)return new Promise((x,N)=>{k.addEventListener("load",x),k.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return i.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})},Yv=20,Qv={maxTokens:512},ca=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Fu(t,{count:e=Yv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().limit(e).toArray();else{const H=new Set(await Ue.emailClassifications.toCollection().primaryKeys());u=0,o=[],await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().until(()=>o.length>=e).each(q=>{H.has(q.id)?u++:o.push(q)})}if(o.length===0){const H=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:H,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const d=Date.now(),g=performance.now();let p=0,b=0,w=0,k=0;const x=[],N=t.modelId,C=Zo(N);if(!C)throw new Error(`Unknown model: ${N}`);if(!C.recommendedForEmailProcessing&&o.length>0){const{MODELS:H}=await Vv(async()=>{const{MODELS:X}=await Promise.resolve().then(()=>hv);return{MODELS:X}},void 0),q=H.filter(X=>X.recommendedForEmailProcessing).map(X=>X.name);console.warn(`â ï¸ Current model (${C.name}) is not optimized for email processing. For best results with long emails, use: ${q.join(", ")}. Some emails may fail due to memory limits.`)}for(let H=0;H<o.length&&!(i!=null&&i.aborted);H++){const q=o[H],X=Uu(q),te=[{role:"system",content:ca},{role:"user",content:X}];a({phase:"scanning",current:H+1,total:o.length,classified:p,errors:b,email:{subject:q.subject,from:q.from,date:q.date},prompt:{system:ca,user:X},systemPromptLength:ca.length,live:null,lastResult:null,totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}});const G=performance.now();try{const{text:ce,tps:be,numTokens:Ee,inputTokens:fe}=await t.generateFull(te,{maxTokens:512,enableThinking:!1},Te=>{a({phase:"generating",current:H+1,total:o.length,classified:p,errors:b,email:{subject:q.subject,from:q.from,date:q.date},live:{tps:Te.tps,numTokens:Te.numTokens},totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}})});w+=Ee,k+=fe;const ne=Jv(ce),oe=performance.now()-G;if(ne){await Ue.emailClassifications.put({emailId:q.id,action:ne.action,reason:ne.reason,summary:ne.summary,tags:ne.tags,subject:q.subject||"(no subject)",from:q.from||"",date:q.date,scannedAt:d,status:"pending"}),p++;const Te={success:!0,email:{subject:q.subject,from:q.from,date:q.date},classification:ne,stats:{tps:be,numTokens:Ee,inputTokens:fe,elapsed:oe},promptSize:X.length};x.push(Te),a({phase:"classified",current:H+1,total:o.length,classified:p,errors:b,email:{subject:q.subject,from:q.from,date:q.date},result:ne,emailStats:{tps:be,numTokens:Ee,inputTokens:fe,elapsed:oe},totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}})}}catch(ce){console.error(`Triage email ${H+1} failed:`,ce),b++;const be=ce.message||String(ce),Ee=be.length>200?be.slice(0,200)+"...":be;x.push({success:!1,email:{subject:q.subject,from:q.from,date:q.date},error:Ee,promptSize:X.length})}}const A=performance.now()-g,Q=x.length>0?Math.round(x.reduce((H,q)=>H+q.promptSize,0)/x.length):0,de=x.filter(H=>{var q;return H.success&&((q=H.stats)==null?void 0:q.tps)}).length>0?Math.round(x.filter(H=>H.success).reduce((H,q)=>{var X;return H+(((X=q.stats)==null?void 0:X.tps)||0)},0)/x.filter(H=>{var q;return H.success&&((q=H.stats)==null?void 0:q.tps)}).length):null;return a({phase:"done",current:o.length,total:o.length,classified:p,errors:b,results:x,summary:{avgPromptSize:Q,avgTps:de,systemPromptSize:ca.length,processed:o.length,skipped:u,modelName:C.name,modelContextWindow:C.contextWindow,modelMaxEmailTokens:C.maxEmailTokens},totals:{outputTokens:w,inputTokens:k,elapsed:A}}),{scanned:o.length,classified:p,skipped:u,errors:b}}async function Xv(){const t=await Ue.emailClassifications.toArray();return qu(t)}async function Zv(){const t=await Ue.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function vi(t,e){await Ue.emailClassifications.update(t,{status:e})}async function oc(){await Ue.emailClassifications.clear()}async function el(t){await Ue.emailClassifications.where("action").equals(t).delete()}async function Ku(t){await Ue.emailClassifications.delete(t)}async function Ao(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Uu(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Jv(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=$v(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let g=[];return Array.isArray(u.tags)&&(g=u.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:g}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function $v(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function Co(t){return`hsl(${Ou(t)}, 55%, 55%)`}function ep(t){return`hsl(${Ou(t)}, 40%, 35%)`}var tp=L('<p class="warning svelte-1n2kfl0">WebGPU not available in this browser. Use Ollama or upgrade your browser.</p>'),np=L('<div class="backend-selector svelte-1n2kfl0"><div class="backend-label svelte-1n2kfl0">AI Backend:</div> <div class="backend-options svelte-1n2kfl0"><button><span class="backend-icon svelte-1n2kfl0">ð·</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">WebGPU</div> <div class="backend-desc svelte-1n2kfl0">Browser, private, no server</div></div></button> <button><span class="backend-icon svelte-1n2kfl0">ð¦</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">Ollama</div> <div class="backend-desc svelte-1n2kfl0">Local server, larger models</div></div></button></div> <!></div>');function rp(t,e){Tt(e,!0);let r=De(e,"backend",15,"webgpu"),a=De(e,"isWebGPUAvailable",3,!0);var i=np(),o=_(m(i),2),u=m(o);let d;u.__click=()=>r("webgpu");var g=_(u,2);let p;g.__click=()=>r("ollama");var b=_(o,2);{var w=k=>{var x=tp();E(k,x)};re(b,k=>{!a()&&r()==="webgpu"&&k(w)})}ee(()=>{d=Mt(u,1,"backend-btn svelte-1n2kfl0",null,d,{active:r()==="webgpu"}),u.disabled=!a(),p=Mt(g,1,"backend-btn svelte-1n2kfl0",null,p,{active:r()==="ollama"})}),E(t,i),Et()}zt(["click"]);const ap=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function lc(...t){ap&&console.log("[debug]",...t)}function Bn(t){return lc(`[MOUNT] ${t}`),()=>lc(`[DESTROY] ${t}`)}var sp=L("<option> </option>"),ip=L('<p class="model-description svelte-1p89qnn"> </p>'),op=L('<span class="current-badge svelte-1p89qnn">Current</span>'),lp=L('<span class="rec-badge rec-good svelte-1p89qnn">â Recommended</span>'),cp=L('<span class="rec-badge rec-ok svelte-1p89qnn">â ï¸ Limited</span>'),up=L('<span class="rec-badge rec-bad svelte-1p89qnn">â May fail on long emails</span>'),dp=L('<tr><td class="model-name svelte-1p89qnn"> <!></td><td class="context-col svelte-1p89qnn"><strong> </strong></td><td class="tokens-col svelte-1p89qnn"> </td><td class="rec-col svelte-1p89qnn"><!></td></tr>'),fp=L('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),vp=L('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),pp=L('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),hp=L('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),mp=L('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),gp=L('<p class="error svelte-1p89qnn"> </p>'),_p=L(`<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!> <details class="model-details svelte-1p89qnn" open=""><summary class="model-details-summary svelte-1p89qnn">Model Capabilities</summary> <div class="model-table-wrapper svelte-1p89qnn"><table class="model-table svelte-1p89qnn"><thead class="svelte-1p89qnn"><tr><th class="svelte-1p89qnn">Model</th><th class="svelte-1p89qnn">Context Window</th><th class="svelte-1p89qnn">Email Limit</th><th class="svelte-1p89qnn">Email Processing</th></tr></thead><tbody class="svelte-1p89qnn"></tbody></table></div> <p class="model-table-note svelte-1p89qnn"><strong class="svelte-1p89qnn">Context Window</strong> = model's maximum input capacity. <strong class="svelte-1p89qnn">Email Limit</strong> = WebGPU memory-safe limit (smaller models need more conservative limits to avoid memory errors).</p></details></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>`);function yp(t,e){Tt(e,!0);let r=De(e,"selectedModel",15),a=De(e,"gpuInfo",3,null),i=De(e,"error",3,null);an(()=>Bn("ModelSelector"));var o=_p(),u=_(m(o),2),d=_(m(u),2);Kt(d,21,()=>gr,gn,(H,q)=>{var X=sp(),te=m(X),G={};ee(()=>{U(te,`${v(q).name??""} â ${v(q).size??""}`),G!==(G=v(q).id)&&(X.value=(X.__value=v(q).id)??"")}),E(H,X)});var g=_(d,2);{var p=H=>{const q=bt(()=>gr.find(ce=>ce.id===r()));var X=yr(),te=Qe(X);{var G=ce=>{var be=ip(),Ee=m(be);ee(()=>U(Ee,v(q).description)),E(ce,be)};re(te,ce=>{v(q)&&ce(G)})}E(H,X)};re(g,H=>{r()&&H(p)})}var b=_(g,2),w=_(m(b),2),k=m(w),x=_(m(k));Kt(x,21,()=>gr,gn,(H,q)=>{var X=dp();let te;var G=m(X),ce=m(G),be=_(ce);{var Ee=se=>{var J=op();E(se,J)};re(be,se=>{v(q).id===r()&&se(Ee)})}var fe=_(G),ne=m(fe),oe=m(ne),Te=_(fe),ue=m(Te),_e=_(Te),ke=m(_e);{var ae=se=>{var J=lp();E(se,J)},pe=se=>{var J=cp();E(se,J)},ve=se=>{var J=up();E(se,J)};re(ke,se=>{v(q).recommendedForEmailProcessing?se(ae):v(q).maxEmailTokens>=6e3?se(pe,1):se(ve,!1)})}ee((se,J)=>{te=Mt(X,1,"svelte-1p89qnn",null,te,{selected:v(q).id===r()}),U(ce,`${v(q).name??""} `),U(oe,`${se??""}k`),U(ue,`~${J??""}k`)},[()=>(v(q).contextWindow/1024).toFixed(0),()=>(v(q).maxEmailTokens/1e3).toFixed(0)]),E(H,X)});var N=_(u,2);{var C=H=>{var q=mp(),X=_(m(q),2),te=m(X),G=_(m(te)),ce=m(G),be=_(te,2),Ee=_(m(be)),fe=m(Ee),ne=_(be,2);{var oe=ve=>{var se=fp(),J=_(m(se)),F=m(J);ee(()=>U(F,a().device)),E(ve,se)};re(ne,ve=>{a().device&&a().device!=="unknown"&&ve(oe)})}var Te=_(ne,2);{var ue=ve=>{var se=vp(),J=_(m(se)),F=m(J);ee(()=>U(F,a().description)),E(ve,se)};re(Te,ve=>{a().description&&a().description!=="unknown"&&ve(ue)})}var _e=_(Te,2);{var ke=ve=>{var se=pp(),J=_(m(se)),F=m(J);ee(K=>U(F,K),[()=>Eo(a().limits.maxBufferSize)]),E(ve,se)};re(_e,ve=>{var se;(se=a().limits)!=null&&se.maxBufferSize&&ve(ke)})}var ae=_(_e,2);{var pe=ve=>{var se=hp(),J=_(m(se)),F=m(J);ee(()=>U(F,`${a().features.length??""} supported`)),E(ve,se)};re(ae,ve=>{var se;(se=a().features)!=null&&se.length&&ve(pe)})}ee(()=>{U(ce,a().vendor),U(fe,a().architecture)}),E(H,q)};re(N,H=>{a()&&H(C)})}var A=_(N,2);{var Q=H=>{var q=gp(),X=m(q);ee(()=>U(X,i())),E(H,q)};re(A,H=>{i()&&H(Q)})}var de=_(A,2);de.__click=function(...H){var q;(q=e.onload)==null||q.apply(this,H)},ee(()=>de.disabled=i()),xi(d,r),E(t,o),Et()}zt(["click"]);var bp=L('<span class="status-dot connected svelte-1bvvk8o"></span> <span> </span>',1),wp=L('<span class="status-dot disconnected svelte-1bvvk8o"></span> <span> </span>',1),kp=L("<div><!></div>"),xp=L("<option> <!></option>"),Sp=L("<option> <!></option>"),Tp=L('<span class="sep svelte-1bvvk8o">Â·</span> <span> </span>',1),Ep=L('<div class="install-hint svelte-1bvvk8o"><strong>Not installed.</strong> Run: <code class="svelte-1bvvk8o"> </code></div>'),Ap=L('<div class="install-hint installed svelte-1bvvk8o">â Model installed and ready</div>'),Cp=L('<div class="model-info svelte-1bvvk8o"><p class="model-desc svelte-1bvvk8o"> </p> <div class="model-meta svelte-1bvvk8o"><span> </span> <span class="sep svelte-1bvvk8o">Â·</span> <span> </span> <!></div> <!></div>'),Pp=L('<span class="current-badge svelte-1bvvk8o">Current</span>'),Ip=L('<span class="installed-badge svelte-1bvvk8o">â</span>'),Op=L('<span class="rec-badge svelte-1bvvk8o">â</span>'),Rp=L('<tr><td class="model-name svelte-1bvvk8o"> <!> <!></td><td class="context-col svelte-1bvvk8o"><strong> </strong></td><td class="params-col svelte-1bvvk8o"> </td><td class="tags-col svelte-1bvvk8o"><!> </td></tr>'),Mp=L('<p class="error svelte-1bvvk8o"> </p>'),Dp=L('<div class="ollama-settings svelte-1bvvk8o"><div class="connection-section svelte-1bvvk8o"><label for="ollama-url" class="svelte-1bvvk8o">Ollama Server URL:</label> <div class="url-input-group svelte-1bvvk8o"><input id="ollama-url" type="text" placeholder="http://localhost:11434" class="svelte-1bvvk8o"/> <button class="btn-test svelte-1bvvk8o"> </button></div> <!></div> <div class="model-section svelte-1bvvk8o"><label for="ollama-model" class="svelte-1bvvk8o">Choose Model:</label> <select id="ollama-model" class="svelte-1bvvk8o"><optgroup></optgroup><optgroup label="Other Models"></optgroup></select> <!></div> <details class="model-details svelte-1bvvk8o"><summary class="model-details-summary svelte-1bvvk8o">Ollama Model Capabilities</summary> <div class="model-table-wrapper svelte-1bvvk8o"><table class="model-table svelte-1bvvk8o"><thead class="svelte-1bvvk8o"><tr><th class="svelte-1bvvk8o">Model</th><th class="svelte-1bvvk8o">Context Window</th><th class="svelte-1bvvk8o">Params</th><th class="svelte-1bvvk8o">Strengths</th></tr></thead><tbody class="svelte-1bvvk8o"></tbody></table></div> <p class="model-table-note svelte-1bvvk8o">â = installed on your Ollama server. To install: <code class="svelte-1bvvk8o"></code></p></details> <!> <button class="btn primary svelte-1bvvk8o">Load Model</button></div>');function jp(t,e){Tt(e,!0);let r=De(e,"selectedModel",15),a=De(e,"error",15),i=Re(Ft(Ds())),o=Re(!1),u=Re(null),d=Re(Ft([])),g=Re(!1);Qa(()=>{p()});async function p(){I(o,!0),I(u,null);const J=await So(v(i));I(u,J,!0),I(o,!1),J.connected&&b()}async function b(){I(g,!0);try{const J=await yv(v(i));I(d,J.map(F=>F.name),!0)}catch(J){console.error("Failed to load Ollama models:",J),I(d,[],!0)}I(g,!1)}function w(){_v(v(i)),p()}function k(){if(!r()){a("Please select a model");return}e.onload()}function x(J){return v(d).length?v(d).some(F=>F===J||F.startsWith(J.split(":")[0])):!1}const N=mv();var C=Dp(),A=m(C),Q=_(m(A),2),de=m(Q);de.__change=w;var H=_(de,2);H.__click=p;var q=m(H),X=_(Q,2);{var te=J=>{var F=kp();let K;var $=m(F);{var Oe=Ae=>{var je=bp(),P=_(Qe(je),2),me=m(P);ee(()=>U(me,`Connected â¢ v${v(u).version??""}`)),E(Ae,je)},ze=Ae=>{var je=wp(),P=_(Qe(je),2),me=m(P);ee(()=>U(me,`Disconnected: ${v(u).error??""}`)),E(Ae,je)};re($,Ae=>{v(u).connected?Ae(Oe):Ae(ze,!1)})}ee(()=>K=Mt(F,1,"connection-status svelte-1bvvk8o",null,K,{connected:v(u).connected})),E(J,F)};re(X,J=>{v(u)&&J(te)})}var G=_(A,2),ce=_(m(G),2),be=m(ce);Xo(be,"label",`Recommended (install via: ollama pull ${model??""})`),Kt(be,21,()=>N,gn,(J,F)=>{var K=xp(),$=m(K),Oe=_($);{var ze=P=>{var me=Za("â");E(P,me)},Ae=bt(()=>x(v(F).name));re(Oe,P=>{v(Ae)&&P(ze)})}var je={};ee(P=>{U($,`${v(F).displayName??""} (${v(F).params??""}) - ${P??""}k context `),je!==(je=v(F).name)&&(K.value=(K.__value=v(F).name)??"")},[()=>(v(F).contextWindow/1024).toFixed(0)]),E(J,K)});var Ee=_(be);Kt(Ee,21,()=>Qr.filter(J=>!J.recommended),gn,(J,F)=>{var K=Sp(),$=m(K),Oe=_($);{var ze=P=>{var me=Za("â");E(P,me)},Ae=bt(()=>x(v(F).name));re(Oe,P=>{v(Ae)&&P(ze)})}var je={};ee(P=>{U($,`${v(F).displayName??""} (${v(F).params??""}) - ${P??""}k context `),je!==(je=v(F).name)&&(K.value=(K.__value=v(F).name)??"")},[()=>(v(F).contextWindow/1024).toFixed(0)]),E(J,K)});var fe=_(ce,2);{var ne=J=>{const F=bt(()=>Qr.find(ze=>ze.name===r()));var K=yr(),$=Qe(K);{var Oe=ze=>{var Ae=Cp(),je=m(Ae),P=m(je),me=_(je,2),xe=m(me),Me=m(xe),Xe=_(xe,4),Je=m(Xe),it=_(Xe,2);{var At=Ke=>{var We=Tp(),Ct=_(Qe(We),2),mt=m(Ct);ee(ht=>U(mt,ht),[()=>v(F).tags.join(", ")]),E(Ke,We)};re(it,Ke=>{var We;(We=v(F).tags)!=null&&We.length&&Ke(At)})}var He=_(me,2);{var Ve=Ke=>{var We=Ep(),Ct=_(m(We),2),mt=m(Ct);ee(()=>U(mt,`ollama pull ${r()??""}`)),E(Ke,We)},$e=bt(()=>!x(r())),et=Ke=>{var We=Ap();E(Ke,We)};re(He,Ke=>{v($e)?Ke(Ve):Ke(et,!1)})}ee(Ke=>{U(P,v(F).description),U(Me,`${Ke??""}k context`),U(Je,`${v(F).params??""} params`)},[()=>(v(F).contextWindow/1024).toFixed(0)]),E(ze,Ae)};re($,ze=>{v(F)&&ze(Oe)})}E(J,K)};re(fe,J=>{r()&&J(ne)})}var oe=_(G,2),Te=_(m(oe),2),ue=m(Te),_e=_(m(ue));Kt(_e,21,()=>Qr,gn,(J,F)=>{var K=Rp();let $;var Oe=m(K),ze=m(Oe),Ae=_(ze);{var je=Ke=>{var We=Pp();E(Ke,We)};re(Ae,Ke=>{v(F).name===r()&&Ke(je)})}var P=_(Ae,2);{var me=Ke=>{var We=Ip();E(Ke,We)},xe=bt(()=>x(v(F).name));re(P,Ke=>{v(xe)&&Ke(me)})}var Me=_(Oe),Xe=m(Me),Je=m(Xe),it=_(Me),At=m(it),He=_(it),Ve=m(He);{var $e=Ke=>{var We=Op();E(Ke,We)};re(Ve,Ke=>{v(F).recommended&&Ke($e)})}var et=_(Ve);ee((Ke,We,Ct)=>{$=Mt(K,1,"svelte-1bvvk8o",null,$,Ke),U(ze,`${v(F).displayName??""} `),U(Je,`${We??""}k`),U(At,v(F).params),U(et,` ${Ct??""}`)},[()=>({selected:v(F).name===r(),installed:x(v(F).name)}),()=>(v(F).contextWindow/1024).toFixed(0),()=>v(F).tags.slice(0,2).join(", ")]),E(J,K)});var ke=_(Te,2),ae=_(m(ke));ae.textContent="ollama pull {model}";var pe=_(oe,2);{var ve=J=>{var F=Mp(),K=m(F);ee(()=>U(K,a())),E(J,F)};re(pe,J=>{a()&&J(ve)})}var se=_(pe,2);se.__click=k,ee(()=>{var J;H.disabled=v(o),U(q,v(o)?"Testing...":"Test"),se.disabled=!((J=v(u))!=null&&J.connected)||a()}),Si(de,()=>v(i),J=>I(i,J)),xi(ce,r),E(t,C),Et()}zt(["change","click"]);var Lp=L('<span class="progress-percent svelte-r5fnze"> </span>'),Np=L('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),qp=L('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Bp=L('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),zp=L('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Fp=L('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Kp=L('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Up(t,e){Tt(e,!0);let r=De(e,"message",3,""),a=De(e,"items",19,()=>[]);an(()=>Bn("LoadingProgress"));var i=Kp(),o=m(i),u=m(o),d=_(o,2);Kt(d,17,a,gn,(g,p)=>{const b=bt(()=>v(p).total?Cv(v(p).loaded||0,v(p).total):null);var w=Fp(),k=m(w),x=m(k),N=m(x),C=_(x,2);{var A=q=>{var X=Lp(),te=m(X);ee(G=>U(te,`${G??""}%`),[()=>v(b).toFixed(1)]),E(q,X)};re(C,q=>{v(b)!==null&&q(A)})}var Q=_(k,2);{var de=q=>{var X=Np(),te=Qe(X),G=m(te),ce=_(te,2),be=m(ce),Ee=m(be),fe=_(be,4),ne=m(fe),oe=_(fe,2),Te=m(oe);ee((ue,_e,ke,ae,pe)=>{Cn(G,`width: ${ue??""}%`),U(Ee,_e),U(ne,ke),U(Te,`(${ae??""} / ${pe??""} B)`)},[()=>Math.max(v(p).progress??0,.5).toFixed(1),()=>so(v(p).loaded||0),()=>so(v(p).total),()=>(v(p).loaded||0).toLocaleString(),()=>v(p).total.toLocaleString()]),E(q,X)},H=q=>{var X=zp(),te=_(Qe(X),2),G=m(te);{var ce=Ee=>{var fe=qp(),ne=Qe(fe),oe=m(ne),Te=_(ne,2),ue=m(Te);ee((_e,ke)=>{U(oe,_e),U(ue,`(${ke??""} B)`)},[()=>so(v(p).loaded),()=>v(p).loaded.toLocaleString()]),E(Ee,fe)},be=Ee=>{var fe=Bp();E(Ee,fe)};re(G,Ee=>{v(p).loaded?Ee(ce):Ee(be,!1)})}E(q,X)};re(Q,q=>{v(p).total?q(de):q(H,!1)})}ee(()=>{Xo(x,"title",v(p).file),U(N,v(p).file)}),E(g,w)}),ee(()=>U(u,r())),E(t,i),Et()}var Gp=L('<span class="thinking-tokens svelte-11gjw00"> </span>'),Wp=L('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Hp=L('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Vp=L('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Yp=L('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Qp=L('<span class="cursor svelte-11gjw00">|</span>'),Xp=L(" <!>",1),Zp=L('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Jp=L('<div class="content svelte-11gjw00"> </div>'),$p=L('<div><div class="role svelte-11gjw00"> </div> <!></div>');function eh(t,e){Tt(e,!0);let r=De(e,"isLast",3,!1),a=De(e,"isRunning",3,!1),i=De(e,"generationPhase",3,null),o=De(e,"numTokens",3,null);an(()=>Bn(`MessageBubble[${e.msg.role}]`));var u=$p(),d=m(u),g=m(d),p=_(d,2);{var b=k=>{var x=Zp(),N=Qe(x);{var C=G=>{var ce=Wp(),be=_(m(ce),4);{var Ee=fe=>{var ne=Gp(),oe=m(ne);ee(()=>U(oe,`${o()??""} tokens`)),E(fe,ne)};re(be,fe=>{o()&&fe(Ee)})}E(G,ce)},A=G=>{var ce=Hp();E(G,ce)};re(N,G=>{a()&&r()&&i()==="thinking"?G(C):a()&&r()&&i()==="preparing"&&G(A,1)})}var Q=_(N,2);{var de=G=>{var ce=Vp(),be=m(ce),Ee=_(m(be),2),fe=m(Ee),ne=_(be,2),oe=m(ne);ee(Te=>{U(fe,`${Te??""} words`),U(oe,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),E(G,ce)};re(Q,G=>{e.msg.thinking&&G(de)})}var H=_(Q,2),q=m(H);{var X=G=>{var ce=Yp();E(G,ce)},te=G=>{var ce=Xp(),be=Qe(ce,!0),Ee=_(be);{var fe=ne=>{var oe=Qp();E(ne,oe)};re(Ee,ne=>{a()&&r()&&ne(fe)})}ee(()=>U(be,e.msg.content)),E(G,ce)};re(q,G=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?G(X):G(te,!1)})}E(k,x)},w=k=>{var x=Jp(),N=m(x);ee(()=>U(N,e.msg.content)),E(k,x)};re(p,k=>{e.msg.role==="assistant"?k(b):k(w,!1)})}ee(()=>{Mt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),U(g,e.msg.role==="user"?"You":"AI")}),E(t,u),Et()}var th=L('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),nh=L('<span class="edate svelte-mt5nvh"> </span>'),rh=L('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),ah=L('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),sh=L('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),ih=L('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),oh=L('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function lh(t,e){Tt(e,!0);let r=De(e,"pendingData",3,null),a=Re(null),i=Re(null);function o(x){I(a,v(a)===x?null:x,!0),I(i,null)}function u(x){return x.split("_").map(N=>N.charAt(0)+N.slice(1).toLowerCase()).join(" ")}function d(x){if(!x)return"";try{return new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function g(x){if(!x)return"";const N=x.replace(/<.*>/,"").trim();return N.length>24?N.slice(0,22)+"â¦":N}var p={toggleGroup:o},b=yr(),w=Qe(b);{var k=x=>{var N=oh(),C=m(N),A=m(C),Q=_(C,2);Kt(Q,20,()=>r().order,q=>q,(q,X)=>{const te=bt(()=>r().groups[X]),G=bt(()=>Co(X)),ce=bt(()=>v(a)===X);var be=th();let Ee;be.__click=()=>o(X);let fe;var ne=m(be);let oe;var Te=_(ne),ue=_(Te),_e=m(ue);ee(ke=>{Ee=Mt(be,1,"chip svelte-mt5nvh",null,Ee,{active:v(ce)}),fe=Cn(be,"",fe,{"--c":v(G)}),oe=Cn(ne,"",oe,{background:v(G)}),U(Te,` ${ke??""} `),U(_e,v(te).length)},[()=>u(X)]),E(q,be)});var de=_(Q,2);{var H=q=>{const X=bt(()=>r().groups[v(a)]),te=bt(()=>Co(v(a)));var G=ih(),ce=m(G);let be;var Ee=m(ce);Ee.__click=()=>{I(a,null),I(i,null)};var fe=_(Ee,2),ne=m(fe),oe=_(fe,2),Te=m(oe),ue=_(ce,2);Kt(ue,21,()=>v(X),ve=>ve.emailId,(ve,se)=>{var J=rh(),F=m(J);F.__click=()=>{var Me;return(Me=e.onaskai)==null?void 0:Me.call(e,`Tell me about the email "${v(se).subject}" from ${v(se).from}`)};var K=m(F),$=m(K),Oe=_(K,2),ze=m(Oe),Ae=_(ze);{var je=Me=>{var Xe=nh(),Je=m(Xe);ee(it=>U(Je,it),[()=>d(v(se).date)]),E(Me,Xe)};re(Ae,Me=>{v(se).date&&Me(je)})}var P=_(F,2),me=m(P);me.__click=()=>{var Me;return(Me=e.onmarkacted)==null?void 0:Me.call(e,v(se).emailId)};var xe=_(me,2);xe.__click=()=>{var Me;return(Me=e.ondismiss)==null?void 0:Me.call(e,v(se).emailId)},ee(Me=>{U($,v(se).subject),U(ze,Me)},[()=>g(v(se).from)]),E(ve,J)});var _e=_(ue,2),ke=m(_e);{var ae=ve=>{var se=ah(),J=Qe(se);J.__click=()=>v(X).forEach(K=>{var $;return($=e.onmarkacted)==null?void 0:$.call(e,K.emailId)});var F=_(J,2);F.__click=()=>I(i,v(a),!0),E(ve,se)},pe=ve=>{var se=sh(),J=Qe(se),F=m(J),K=_(J,2);K.__click=()=>I(i,null);var $=_(K,2);$.__click=()=>{var Oe;(Oe=e.oncleargroup)==null||Oe.call(e,v(a)),I(i,null),I(a,null)},ee(()=>U(F,`Remove ${v(X).length??""}?`)),E(ve,se)};re(ke,ve=>{v(i)!==v(a)?ve(ae):ve(pe,!1)})}ee(ve=>{be=Cn(ce,"",be,{"border-color":v(te)}),U(ne,ve),U(Te,v(X).length)},[()=>u(v(a))]),E(q,G)};re(de,q=>{v(a)&&r().groups[v(a)]&&q(H)})}ee(()=>U(A,`${r().total??""} item${r().total!==1?"s":""} need attention`)),E(x,N)};re(w,x=>{r()&&r().total>0&&x(k)})}return E(t,b),Et(p)}zt(["click"]);var ch=L('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),uh=L('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),dh=L('<div class="strip svelte-1ed7zw1"><!></div>');function fh(t,e){let r=De(e,"hasScanData",3,!1),a=De(e,"engineReady",3,!1),i=De(e,"isScanning",3,!1),o=bt(()=>a()&&!r()&&!i()),u=bt(()=>v(o)||i());var d=yr(),g=Qe(d);{var p=b=>{var w=dh(),k=m(w);{var x=C=>{var A=ch();E(C,A)},N=C=>{var A=uh();A.__click=function(...Q){var de;(de=e.onscan)==null||de.apply(this,Q)},E(C,A)};re(k,C=>{i()?C(x):v(o)&&C(N,1)})}E(b,w)};re(g,b=>{v(u)&&b(p)})}E(t,d)}zt(["click"]);var vh=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),ph=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),hh=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mh=L('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),gh=L('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),_h=L('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),yh=L('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function bh(t,e){Tt(e,!0),an(()=>Bn("GpuPanel"));var r=yh(),a=m(r),i=_(m(a),2),o=_(m(i),2),u=m(o),d=_(i,2),g=_(m(d),2),p=m(g),b=_(d,2);{var w=q=>{var X=vh(),te=_(m(X),2),G=m(te);ee(()=>U(G,e.gpuInfo.device)),E(q,X)};re(b,q=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&q(w)})}var k=_(b,2);{var x=q=>{var X=ph(),te=_(m(X),2),G=m(te);ee(ce=>U(G,ce),[()=>Eo(e.gpuInfo.limits.maxBufferSize)]),E(q,X)};re(k,q=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxBufferSize&&q(x)})}var N=_(k,2);{var C=q=>{var X=hh(),te=_(m(X),2),G=m(te);ee(()=>U(G,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),E(q,X)};re(N,q=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeInvocationsPerWorkgroup&&q(C)})}var A=_(N,2);{var Q=q=>{var X=mh(),te=_(m(X),2),G=m(te);ee(ce=>U(G,ce),[()=>Eo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),E(q,X)};re(A,q=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeWorkgroupStorageSize&&q(Q)})}var de=_(A,2);{var H=q=>{var X=_h(),te=m(X),G=m(te),ce=_(te,2);Kt(ce,21,()=>e.gpuInfo.features,gn,(be,Ee)=>{var fe=gh(),ne=m(fe);ee(()=>U(ne,v(Ee))),E(be,fe)}),ee(()=>U(G,`Features (${e.gpuInfo.features.length??""})`)),E(q,X)};re(de,q=>{var X;(X=e.gpuInfo.features)!=null&&X.length&&q(H)})}ee(()=>{U(u,e.gpuInfo.vendor),U(p,e.gpuInfo.architecture)}),E(t,r),Et()}var wh=L('<button class="gpu-badge svelte-1ktw27c"> </button>'),kh=L('<span class="stats svelte-1ktw27c"> </span>'),xh=L('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Sh=L('<span class="stats preparing svelte-1ktw27c"> </span>'),Th=L('<span class="stats svelte-1ktw27c"> </span>'),Eh=L('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ah=L('<button class="btn svelte-1ktw27c">Stop</button>'),Ch=L('<button class="btn primary svelte-1ktw27c">Send</button>'),Ph=L('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Ih(t,e){Tt(e,!0),an(()=>Bn("ChatView"));let r=De(e,"messages",19,()=>[]),a=De(e,"pendingData",3,null),i=De(e,"hasScanData",3,!1),o=De(e,"engineReady",3,!1),u=De(e,"isScanning",3,!1),d=De(e,"isRunning",3,!1),g=De(e,"tps",3,null),p=De(e,"numTokens",3,null),b=De(e,"generationPhase",3,null),w=De(e,"gpuInfo",3,null),k=De(e,"chatContainer",15),x=Re(""),N=Re(!1);function C(K){K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),A())}function A(){const K=v(x).trim();!K||d()||(I(x,""),e.onsend(K))}function Q(K){K&&!d()&&e.onsend(K)}var de=Ph(),H=m(de),q=m(H);{var X=K=>{var $=wh();$.__click=()=>I(N,!v(N));var Oe=m($);ee(()=>U(Oe,`WebGPU ${v(N)?"â²":"â¼"}`)),E(K,$)};re(q,K=>{w()&&K(X)})}var te=_(q,2);{var G=K=>{var $=kh(),Oe=m($);ee((ze,Ae)=>U(Oe,`${p()??""} tokens in ${ze??""}s
        (${Ae??""} tok/s)`),[()=>(p()/g()).toFixed(1),()=>g().toFixed(1)]),E(K,$)},ce=K=>{var $=xh();E(K,$)},be=K=>{var $=Sh(),Oe=m($);ee(ze=>U(Oe,`thinking... ${ze??""}`),[()=>g()?`${g().toFixed(0)} tok/s`:""]),E(K,$)},Ee=K=>{var $=Th(),Oe=m($);ee(ze=>U(Oe,`${ze??""} tok/s`),[()=>g().toFixed(1)]),E(K,$)};re(te,K=>{g()&&!d()?K(G):d()&&b()==="preparing"?K(ce,1):d()&&b()==="thinking"?K(be,2):g()&&d()&&K(Ee,3)})}var fe=_(te,4);fe.__click=function(...K){var $;($=e.onreset)==null||$.apply(this,K)};var ne=_(H,2);{var oe=K=>{bh(K,{get gpuInfo(){return w()}})};re(ne,K=>{v(N)&&w()&&K(oe)})}var Te=_(ne,2),ue=m(Te);{var _e=K=>{var $=Eh();E(K,$)};re(ue,K=>{r().length===0&&!(a()&&a().total>0)&&K(_e)})}var ke=_(ue,2);Kt(ke,17,r,gn,(K,$,Oe)=>{var ze=yr(),Ae=Qe(ze);{var je=me=>{lh(me,{get pendingData(){return v($).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:Q})},P=me=>{{let xe=bt(()=>Oe===r().length-1);eh(me,{get msg(){return v($)},get isLast(){return v(xe)},get isRunning(){return d()},get generationPhase(){return b()},get numTokens(){return p()}})}};re(Ae,me=>{v($).type==="dashboard"?me(je):me(P,!1)})}E(K,ze)}),Cu(Te,K=>k(K),()=>k());var ae=_(Te,2);fh(ae,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var pe=_(ae,2),ve=m(pe);ve.__keydown=C;var se=_(ve,2);{var J=K=>{var $=Ah();$.__click=function(...Oe){var ze;(ze=e.onstop)==null||ze.apply(this,Oe)},E(K,$)},F=K=>{var $=Ch();$.__click=A,ee(Oe=>$.disabled=Oe,[()=>!v(x).trim()]),E(K,$)};re(se,K=>{d()?K(J):K(F,!1)})}ee(()=>{fe.disabled=d(),ve.disabled=d()}),Si(ve,()=>v(x),K=>I(x,K)),E(t,de),Et()}zt(["click","keydown"]);var Oh=L('<div class="container center svelte-1bi93vx"><!> <!></div>');function Rh(t,e){Tt(e,!0);const r=!!navigator.gpu,a=Pu();let i=Re(Ft(localStorage.getItem("aiBackend")||"webgpu"));function o(){const F=localStorage.getItem("selectedModel");return F||(v(i)==="webgpu"?gr[0].id:Qr[0].name)}let u=Re(Ft(o())),d=Re(null),g=Re(null),p=Re(""),b=Re(Ft([])),w=Re(Ft([])),k=Re(!1),x=Re(null),N=Re(null),C=Re(null),A=Re(null),Q=Re(null),de=Re(null),H=Re(!1),q=Re(!1),X=!1;an(()=>{a.check(),a.isReady&&te();const F=a.onMessage(K=>{switch(K.status){case"webgpu-info":I(A,K.data,!0);break;case"loading":I(d,"loading"),I(p,K.data,!0);break;case"initiate":I(b,[...v(b),K],!0);break;case"progress":I(b,v(b).map($=>$.file===K.file?{...$,...K}:$),!0);break;case"done":I(b,v(b).filter($=>$.file!==K.file),!0);break;case"ready":I(d,"ready"),te();break;case"start":if(!v(k))break;I(Q,K.phase||"preparing",!0),I(w,[...v(w),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!v(k))break;I(Q,K.phase,!0);break;case"thinking":{if(!v(k))break;I(x,K.tps,!0),I(N,K.numTokens,!0);const $=v(w)[v(w).length-1];I(w,[...v(w).slice(0,-1),{...$,thinking:($.thinking||"")+K.content}],!0),oe();break}case"thinking-done":{if(!v(k))break;I(x,K.tps,!0),I(N,K.numTokens,!0);const $=v(w)[v(w).length-1];I(w,[...v(w).slice(0,-1),{...$,thinking:K.content}],!0);break}case"update":{if(!v(k))break;I(x,K.tps,!0),I(N,K.numTokens,!0);const $=v(w)[v(w).length-1];I(w,[...v(w).slice(0,-1),{...$,content:$.content+K.output}],!0),oe();break}case"complete":if(!v(k))break;I(k,!1),I(Q,null),G();break;case"error":if(!v(k))break;I(g,K.data,!0),I(k,!1),I(Q,null);break}});return()=>F()});async function te(){if(!(X||v(w).length>0))try{const F=await sc();I(de,F,!0),F&&(X=!0,I(w,[{role:"assistant",type:"dashboard",pendingData:F}],!0),oe());const K=await Ao();I(H,K.classified>0)}catch{}}async function G(){try{const F=await sc();I(de,F,!0);const K=v(w).findIndex(Oe=>Oe.type==="dashboard");K!==-1&&(F&&F.total>0?I(w,v(w).map((Oe,ze)=>ze===K?{...Oe,pendingData:F}:Oe),!0):I(w,v(w).filter((Oe,ze)=>ze!==K),!0));const $=await Ao();I(H,$.classified>0)}catch{}}async function ce(F){await vi(F,"acted"),await G()}async function be(F){await vi(F,"dismissed"),await G()}async function Ee(F){await Ku(F),await G()}async function fe(F){await el(F),await G()}async function ne(){if(!(v(q)||!a.isReady)){I(q,!0);try{await Fu(a,{count:20}),await G(),v(de)&&!v(w).some(F=>F.type==="dashboard")&&(I(w,[{role:"assistant",type:"dashboard",pendingData:v(de)},...v(w)],!0),oe())}catch(F){console.error("Scan failed:",F)}finally{I(q,!1)}}}function oe(){xu().then(()=>{v(C)&&(v(C).scrollTop=v(C).scrollHeight)})}function Te(){I(d,"loading"),localStorage.setItem("selectedModel",v(u)),localStorage.setItem("aiBackend",v(i)),a.loadModel(v(u))}Qa(()=>{v(i)==="webgpu"&&!gr.find(F=>F.id===v(u))?I(u,gr[0].id,!0):v(i)==="ollama"&&!Qr.find(F=>F.name===v(u))&&I(u,Qr[0].name,!0)});async function ue(F){if(!F||v(k))return;I(w,[...v(w),{role:"user",content:F}],!0),I(x,null),I(k,!0);let K=[];try{const ze=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(F)?await Gv(F):await Uv();ze&&(K=[{role:"system",content:ze}])}catch{}const $=v(w).filter(Oe=>Oe.type!=="dashboard").map(Oe=>({role:Oe.role,content:Oe.content}));a.generate([...K,...$]),oe()}function _e(){a.interrupt()}function ke(){a.reset(),I(w,[],!0),I(x,null),I(N,null),X=!1,te()}var ae=yr(),pe=Qe(ae);{var ve=F=>{var K=Oh(),$=m(K);rp($,{get isWebGPUAvailable(){return r},get backend(){return v(i)},set backend(je){I(i,je,!0)}});var Oe=_($,2);{var ze=je=>{yp(je,{get gpuInfo(){return v(A)},get error(){return v(g)},onload:Te,get selectedModel(){return v(u)},set selectedModel(P){I(u,P,!0)}})},Ae=je=>{jp(je,{onload:Te,get selectedModel(){return v(u)},set selectedModel(P){I(u,P,!0)},get error(){return v(g)},set error(P){I(g,P,!0)}})};re(Oe,je=>{v(i)==="webgpu"?je(ze):v(i)==="ollama"&&je(Ae,1)})}E(F,K)},se=F=>{Up(F,{get message(){return v(p)},get items(){return v(b)}})},J=F=>{Ih(F,{get messages(){return v(w)},get pendingData(){return v(de)},get hasScanData(){return v(H)},get engineReady(){return a.isReady},get isScanning(){return v(q)},get isRunning(){return v(k)},get tps(){return v(x)},get numTokens(){return v(N)},get generationPhase(){return v(Q)},get gpuInfo(){return v(A)},onsend:ue,onstop:_e,onreset:ke,onmarkacted:ce,ondismiss:be,onremove:Ee,oncleargroup:fe,onscan:ne,get chatContainer(){return v(C)},set chatContainer(K){I(C,K,!0)}})};re(pe,F=>{v(d)===null?F(ve):v(d)==="loading"?F(se,1):F(J,!1)})}E(t,ae),Et()}const cc="https://accounts.google.com/gsi/client",Mh="https://www.googleapis.com/auth/gmail.readonly",tl="me-ai:oauth-token",nl=300*1e3;let Ts=null,ks=null,Zr=0;function Gu(t,e){Zr=Date.now()+e*1e3;try{sessionStorage.setItem(tl,JSON.stringify({access_token:t,expires_at:Zr}))}catch{}}function Po(){Zr=0;try{sessionStorage.removeItem(tl)}catch{}}function Dh(){try{const t=sessionStorage.getItem(tl);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-nl?(Po(),null):(Zr=r,{access_token:e})}catch{return Po(),null}}function jh(){return Zr>0&&Date.now()<Zr-nl}function Lh(){return Zr<=0?0:Math.max(0,Zr-nl-Date.now())}function uc(){return new Promise((t,e)=>{if(!Ts){e(new Error("Google Auth not initialized."));return}ks=r=>{r.error?e(new Error(r.error_description||r.error)):(Gu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},Ts.requestAccessToken({prompt:""})})}function Nh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${cc}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=cc,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function dc(t){await Nh(),Ts=google.accounts.oauth2.initTokenClient({client_id:t,scope:Mh,callback:e=>{ks&&(ks(e),ks=null)}})}function qh(){return new Promise((t,e)=>{if(!Ts){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}ks=r=>{r.error?e(new Error(r.error_description||r.error)):(Gu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},Ts.requestAccessToken()})}function Bh(t){return Po(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const tn="gmail",fc=8,Wu=50,Hu=100;async function zh(t,{limit:e=Wu,onProgress:r=()=>{},signal:a}={}){var u;const i=await Ue.syncState.get(tn);if(i!=null&&i.historyId)try{return await Wh(t,i,r,a)}catch(d){if(d instanceof Jo&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Ue.syncState.delete(tn);else throw d}return await Uh(t,e===0?1/0:e,r,a)}async function Fh(t,{limit:e=Wu,onProgress:r=()=>{},signal:a}={}){const i=await Ue.syncState.get(tn);return i!=null&&i.oldestPageToken?await Gh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Kh(){const t=await Ue.syncState.get(tn);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Vu(){await Ue.transaction("rw",[Ue.items,Ue.syncState],async()=>{await Ue.items.where("sourceType").equals(tn).delete(),await Ue.syncState.delete(tn)})}async function Uh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ka(a);const i=await Ru(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){ka(a);const w=e-o.length,k=await Mu(t,{maxResults:Math.min(Hu,w),pageToken:u}),x=(k.messages||[]).map(N=>N.id);if(o.push(...x),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=k.nextPageToken,!u||x.length===0)break}if(d=u||null,o.length===0)return await Ue.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:g,errors:p}=await Yu(t,o,r,a),b=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:b,oldestPageToken:d}),r({phase:"done",message:`Synced ${g} messages`,current:g,total:g}),{added:g,deleted:0,errors:p}}async function Gh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ka(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){ka(i);const w=r-o.length,k=await Mu(t,{maxResults:Math.min(Hu,w),pageToken:u}),x=(k.messages||[]).map(N=>N.id);if(o.push(...x),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=k.nextPageToken,!u||x.length===0)break}if(d=u||null,o.length===0)return await Ue.syncState.update(tn,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:g,errors:p}=await Yu(t,o,a,i),b=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.update(tn,{totalItems:b,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${g} more (more available)`:`Downloaded ${g} more (all synced)`,current:b,total:b}),{added:g,errors:p}}async function Wh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ka(a);let i=0,o=0,u=0,d,g=e.historyId;do{ka(a);const b=await Rv(t,{startHistoryId:e.historyId,pageToken:d});if(g=b.historyId||g,d=b.nextPageToken,!!b.history){for(const w of b.history){if(w.messagesAdded){const k=w.messagesAdded.map(N=>N.message.id),x=[...new Set(k.filter(N=>N))];if(x.length>0){const N=await Promise.allSettled(x.map(A=>Du(t,A))),C=[];for(const A of N)A.status==="fulfilled"?C.push(Qu(A.value)):u++;C.length>0&&(await Ue.items.bulkPut(C),await Xu(C),i+=C.length)}}if(w.messagesDeleted){const k=w.messagesDeleted.map(x=>Iu(tn,x.message.id)).filter(x=>x);k.length>0&&(await Ue.items.bulkDelete(k),o+=k.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.put({sourceType:tn,historyId:g,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:u}}async function Yu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=fc){ka(a);const d=e.slice(u,u+fc),g=await Promise.allSettled(d.map(b=>Du(t,b))),p=[];for(const b of g)b.status==="fulfilled"?p.push(Qu(b.value)):o++;p.length>0&&(await Ue.items.bulkPut(p),await Xu(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Qu(t){const e=Kr(t,"From"),r=Kr(t,"To"),a=Kr(t,"Cc"),i=Kr(t,"Subject")||"(no subject)",o=Kr(t,"Date"),u=Kr(t,"Message-ID"),d=Kr(t,"In-Reply-To"),g=Kr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:Iu(tn,t.id),sourceType:tn,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:Mv(t),htmlBody:Dv(t),date:p,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:g,raw:t,syncedAt:Date.now()}}async function Xu(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Hh(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Ue.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await Ue.contacts.update(o.id,u)}else await Ue.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Hh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ka(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Vh=L(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Yh(t,e){Tt(e,!0);let r=De(e,"clientIdInput",15);an(()=>Bn("SetupGuide"));let a=Re(null);async function i(K){try{await navigator.clipboard.writeText(K),I(a,K,!0),setTimeout(()=>{I(a,null)},1500)}catch{const $=document.createElement("input");$.value=K,document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($),I(a,K,!0),setTimeout(()=>{I(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var g=Vh(),p=m(g),b=_(m(p),4),w=_(m(b),6),k=_(m(w),2),x=_(m(k),2),N=_(m(x),2),C=m(N);C.__click=()=>i(o);var A=m(C);A.textContent="http://localhost:5173";var Q=_(A,2),de=m(Q),H=_(C,2);H.__click=()=>i(u);var q=m(H);q.textContent="https://cypherkitty.github.io";var X=_(q,2),te=m(X),G=_(x,2),ce=_(m(G),2),be=m(ce);be.__click=()=>i(o);var Ee=m(be);Ee.textContent="http://localhost:5173";var fe=_(Ee,2),ne=m(fe),oe=_(be,2);oe.__click=()=>i(u);var Te=m(oe);Te.textContent="https://cypherkitty.github.io";var ue=_(Te,2),_e=m(ue),ke=_(oe,2);ke.__click=()=>i(d);var ae=m(ke);ae.textContent="https://cypherkitty.github.io/me-ai/";var pe=_(ae,2),ve=m(pe),se=_(b,2),J=m(se);J.__keydown=K=>K.key==="Enter"&&e.onsave();var F=_(J,2);F.__click=function(...K){var $;($=e.onsave)==null||$.apply(this,K)},ee(K=>{U(de,v(a)===o?"â":"â§"),U(te,v(a)===u?"â":"â§"),U(ne,v(a)===o?"â":"â§"),U(_e,v(a)===u?"â":"â§"),U(ve,v(a)===d?"â":"â§"),F.disabled=K},[()=>!r().trim()]),Si(J,r),E(t,g),Et()}zt(["click","keydown"]);function Qh(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof Jo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Xh=L('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Zh=L('<div class="error-card-title svelte-14buhqq"> </div>'),Jh=L('<p class="error-card-fix svelte-14buhqq"> </p>'),$h=L('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),em=L('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),tm=L('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Zu(t,e){Tt(e,!0);let r=De(e,"ondismiss",3,null),a=De(e,"onsignout",3,null),i=bt(()=>Qh(e.error));an(()=>Bn("ErrorCard"));var o=tm(),u=m(o);{var d=Q=>{var de=Xh(),H=m(de),q=m(H),X=_(H,2);X.__click=function(...te){var G;(G=r())==null||G.apply(this,te)},ee(()=>U(q,v(i).title)),E(Q,de)},g=Q=>{var de=Zh(),H=m(de);ee(()=>U(H,v(i).title)),E(Q,de)};re(u,Q=>{r()?Q(d):Q(g,!1)})}var p=_(u,2),b=m(p),w=_(p,2);{var k=Q=>{var de=Jh(),H=m(de);ee(()=>U(H,v(i).fix)),E(Q,de)};re(w,Q=>{v(i).fix&&Q(k)})}var x=_(w,2);{var N=Q=>{var de=$h(),H=m(de);ee(()=>{Xo(de,"href",v(i).link.url),U(H,`${v(i).link.label??""} â`)}),E(Q,de)};re(x,Q=>{v(i).link&&Q(N)})}var C=_(x,2);{var A=Q=>{var de=em();de.__click=function(...H){var q;(q=a())==null||q.apply(this,H)},E(Q,de)};re(C,Q=>{v(i).action==="signout"&&a()&&Q(A)})}ee(()=>U(b,v(i).description)),E(t,o),Et()}zt(["click"]);var nm=L('<span class="spinner svelte-nyqevv"></span> Signing in...',1),rm=Qo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),am=L(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function sm(t,e){Tt(e,!0);let r=De(e,"error",3,null),a=De(e,"loadingAuth",3,!1);an(()=>Bn("AuthCard"));var i=am(),o=m(i),u=_(m(o),4);{var d=A=>{Zu(A,{get error(){return r()},get onsignout(){return e.onsignout}})};re(u,A=>{r()&&A(d)})}var g=_(u,2);g.__click=function(...A){var Q;(Q=e.onsignin)==null||Q.apply(this,A)};var p=m(g);{var b=A=>{var Q=nm();E(A,Q)},w=A=>{var Q=rm();E(A,Q)};re(p,A=>{a()?A(b):A(w,!1)})}var k=_(g,2),x=_(m(k),2),N=m(x),C=_(x,2);C.__click=function(...A){var Q;(Q=e.onclear)==null||Q.apply(this,A)},ee(A=>{g.disabled=a(),U(N,`${A??""}...`)},[()=>e.clientId.slice(0,20)]),E(t,i),Et()}zt(["click"]);var im=L('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),om=L('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),lm=L('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function cm(t,e){Tt(e,!0);let r=De(e,"profile",3,null),a=De(e,"loadingProfile",3,!1);an(()=>Bn("ProfileCard"));var i=lm(),o=m(i),u=m(o),d=_(o,2),g=m(d);{var p=k=>{var x=im();E(k,x)},b=k=>{var x=om(),N=Qe(x),C=m(N),A=_(N,2),Q=m(A);ee((de,H)=>{U(C,r().emailAddress),U(Q,`${de??""} messages
        Â· ${H??""} threads`)},[()=>{var de;return((de=r().messagesTotal)==null?void 0:de.toLocaleString())||"?"},()=>{var de;return((de=r().threadsTotal)==null?void 0:de.toLocaleString())||"?"}]),E(k,x)};re(g,k=>{a()?k(p):r()&&k(b,1)})}var w=_(d,2);w.__click=function(...k){var x;(x=e.onsignout)==null||x.apply(this,k)},ee(k=>U(u,k),[()=>r()?Lu(r().emailAddress):"?"]),E(t,i),Et()}zt(["click"]);var um=L('<span class="spinner svelte-1ds3j4k"></span>'),dm=Qo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),fm=L('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),vm=L('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),pm=L('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),hm=L('<option class="svelte-1ds3j4k"> </option>'),mm=L('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),gm=L('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),_m=L('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),ym=L('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),bm=L('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),wm=L('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function km(t,e){Tt(e,!0),an(()=>Bn("SyncStatus"));let r=De(e,"syncStatus",3,null),a=De(e,"syncProgress",3,null),i=De(e,"isSyncing",3,!1),o=Re(!1),u=Re(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function g(ae){if(!ae)return"never";const pe=Math.floor((Date.now()-ae)/1e3);if(pe<60)return"just now";const ve=Math.floor(pe/60);if(ve<60)return`${ve}m ago`;const se=Math.floor(ve/60);return se<24?`${se}h ago`:`${Math.floor(se/24)}d ago`}function p(){var ae,pe;return!((ae=a())!=null&&ae.total)||!((pe=a())!=null&&pe.current)?0:Math.round(a().current/a().total*100)}var b=wm(),w=m(b),k=m(w),x=m(k);{var N=ae=>{var pe=um();E(ae,pe)},C=ae=>{var pe=dm();E(ae,pe)};re(x,ae=>{i()?ae(N):ae(C,!1)})}var A=_(k,2),Q=_(m(A),2);{var de=ae=>{var pe=fm(),ve=m(pe),se=_(ve);{var J=K=>{var $=Za("Â· more available");E(K,$)},F=K=>{var $=Za("Â· all synced");E(K,$)};re(se,K=>{r().hasMore?K(J):K(F,!1)})}ee((K,$)=>U(ve,`${K??""} emails stored
          Â· synced ${$??""} `),[()=>r().totalItems.toLocaleString(),()=>g(r().lastSyncAt)]),E(ae,pe)},H=ae=>{var pe=vm();E(ae,pe)};re(Q,ae=>{var pe;(pe=r())!=null&&pe.synced?ae(de):ae(H,!1)})}var q=_(A,2),X=m(q);{var te=ae=>{var pe=pm();pe.__click=()=>I(o,!v(o)),E(ae,pe)};re(X,ae=>{var pe;(pe=r())!=null&&pe.synced&&!i()&&ae(te)})}var G=_(w,2),ce=m(G),be=_(m(ce),2);Kt(be,21,()=>d,gn,(ae,pe)=>{var ve=hm(),se=m(ve),J={};ee(()=>{U(se,v(pe).label),J!==(J=v(pe).value)&&(ve.value=(ve.__value=v(pe).value)??"")}),E(ae,ve)});var Ee=_(ce,2),fe=m(Ee);{var ne=ae=>{var pe=gm(),ve=Qe(pe);ve.__click=()=>e.onsync(v(u));var se=m(ve),J=_(ve,2);{var F=K=>{var $=mm();$.__click=()=>e.onsyncmore(v(u));var Oe=m($);ee(()=>{$.disabled=i(),U(Oe,i()?"Loading...":"Sync More")}),E(K,$)};re(J,K=>{r().hasMore&&K(F)})}ee(()=>{ve.disabled=i(),U(se,i()?"Syncing...":"Sync New")}),E(ae,pe)},oe=ae=>{var pe=_m();pe.__click=()=>e.onsync(v(u));var ve=m(pe);ee(()=>{pe.disabled=i(),U(ve,i()?"Syncing...":"Download Emails")}),E(ae,pe)};re(fe,ae=>{var pe;(pe=r())!=null&&pe.synced?ae(ne):ae(oe,!1)})}var Te=_(G,2);{var ue=ae=>{var pe=ym(),ve=m(pe),se=m(ve);let J,F;var K=_(ve,2),$=m(K);ee(Oe=>{J=Mt(se,1,"progress-fill svelte-1ds3j4k",null,J,{indeterminate:!a().total}),F=Cn(se,"",F,Oe),U($,a().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),E(ae,pe)};re(Te,ae=>{i()&&a()&&ae(ue)})}var _e=_(Te,2);{var ke=ae=>{var pe=bm(),ve=_(m(pe),2),se=m(ve);se.__click=()=>I(o,!1);var J=_(se,2);J.__click=()=>{e.onclear(),I(o,!1)},E(ae,pe)};re(_e,ae=>{v(o)&&ae(ke)})}ee(()=>be.disabled=i()),xi(be,()=>v(u),ae=>I(u,ae)),E(t,b),Et()}zt(["click"]);var xm=L('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Sm=L('<div class="message-list svelte-y2uamw"></div>');function Tm(t,e){Tt(e,!0);let r=De(e,"messages",19,()=>[]);an(()=>Bn("MessageList"));var a=Sm();Kt(a,21,r,gn,(i,o)=>{var u=xm();u.__click=()=>e.onselect(v(o));var d=m(u),g=m(d),p=_(d,2),b=m(p),w=m(b),k=m(w),x=_(w,2),N=m(x),C=_(b,2),A=m(C),Q=_(C,2),de=m(Q);ee((H,q,X)=>{U(g,H),U(k,q),U(N,X),U(A,v(o).subject),U(de,v(o).snippet)},[()=>Lu(v(o).from),()=>ju(v(o).from),()=>$o(v(o).date)]),E(i,u)}),E(t,a),Et()}zt(["click"]);function rl(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ta=rl();function Ju(t){Ta=t}var sa={exec:()=>null};function pt(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(mn.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Em=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),mn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Am=/^(?:[ \t]*(?:\n|$))+/,Cm=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Pm=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,js=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Im=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,al=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,$u=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ed=pt($u).replace(/bull/g,al).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Om=pt($u).replace(/bull/g,al).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),sl=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Rm=/^[^\n]+/,il=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Mm=pt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",il).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Dm=pt(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,al).getRegex(),Ei="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ol=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,jm=pt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ol).replace("tag",Ei).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),td=pt(sl).replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex(),Lm=pt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",td).getRegex(),ll={blockquote:Lm,code:Cm,def:Mm,fences:Pm,heading:Im,hr:js,html:jm,lheading:ed,list:Dm,newline:Am,paragraph:td,table:sa,text:Rm},vc=pt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex(),Nm={...ll,lheading:Om,table:vc,paragraph:pt(sl).replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",vc).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex()},qm={...ll,html:pt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ol).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:sa,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:pt(sl).replace("hr",js).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ed).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Bm=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,nd=/^( {2,}|\\)\n(?!\s*$)/,Fm=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ai=/[\p{P}\p{S}]/u,cl=/[\s\p{P}\p{S}]/u,rd=/[^\s\p{P}\p{S}]/u,Km=pt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,cl).getRegex(),ad=/(?!~)[\p{P}\p{S}]/u,Um=/(?!~)[\s\p{P}\p{S}]/u,Gm=/(?:[^\s\p{P}\p{S}]|~)/u,sd=/(?![*_])[\p{P}\p{S}]/u,Wm=/(?![*_])[\s\p{P}\p{S}]/u,Hm=/(?:[^\s\p{P}\p{S}]|[*_])/u,Vm=pt(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Em?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),id=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ym=pt(id,"u").replace(/punct/g,Ai).getRegex(),Qm=pt(id,"u").replace(/punct/g,ad).getRegex(),od="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xm=pt(od,"gu").replace(/notPunctSpace/g,rd).replace(/punctSpace/g,cl).replace(/punct/g,Ai).getRegex(),Zm=pt(od,"gu").replace(/notPunctSpace/g,Gm).replace(/punctSpace/g,Um).replace(/punct/g,ad).getRegex(),Jm=pt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,rd).replace(/punctSpace/g,cl).replace(/punct/g,Ai).getRegex(),$m=pt(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,sd).getRegex(),eg="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",tg=pt(eg,"gu").replace(/notPunctSpace/g,Hm).replace(/punctSpace/g,Wm).replace(/punct/g,sd).getRegex(),ng=pt(/\\(punct)/,"gu").replace(/punct/g,Ai).getRegex(),rg=pt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ag=pt(ol).replace("(?:-->|$)","-->").getRegex(),sg=pt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ag).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),pi=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ig=pt(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",pi).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ld=pt(/^!?\[(label)\]\[(ref)\]/).replace("label",pi).replace("ref",il).getRegex(),cd=pt(/^!?\[(ref)\](?:\[\])?/).replace("ref",il).getRegex(),og=pt("reflink|nolink(?!\\()","g").replace("reflink",ld).replace("nolink",cd).getRegex(),pc=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,ul={_backpedal:sa,anyPunctuation:ng,autolink:rg,blockSkip:Vm,br:nd,code:zm,del:sa,delLDelim:sa,delRDelim:sa,emStrongLDelim:Ym,emStrongRDelimAst:Xm,emStrongRDelimUnd:Jm,escape:Bm,link:ig,nolink:cd,punctuation:Km,reflink:ld,reflinkSearch:og,tag:sg,text:Fm,url:sa},lg={...ul,link:pt(/^!?\[(label)\]\((.*?)\)/).replace("label",pi).getRegex(),reflink:pt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pi).getRegex()},Io={...ul,emStrongRDelimAst:Zm,emStrongLDelim:Qm,delLDelim:$m,delRDelim:tg,url:pt(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",pc).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:pt(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",pc).getRegex()},cg={...Io,br:pt(nd).replace("{2,}","*").getRegex(),text:pt(Io.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ti={normal:ll,gfm:Nm,pedantic:qm},cs={normal:ul,gfm:Io,breaks:cg,pedantic:lg},ug={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hc=t=>ug[t];function Ar(t,e){if(e){if(mn.escapeTest.test(t))return t.replace(mn.escapeReplace,hc)}else if(mn.escapeTestNoEncode.test(t))return t.replace(mn.escapeReplaceNoEncode,hc);return t}function mc(t){try{t=encodeURI(t).replace(mn.percentDecode,"%")}catch{return null}return t}function gc(t,e){var o;let r=t.replace(mn.findPipe,(u,d,g)=>{let p=!1,b=d;for(;--b>=0&&g[b]==="\\";)p=!p;return p?"|":" |"}),a=r.split(mn.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(mn.slashPipe,"|");return a}function us(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function dg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function fg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function _c(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let g={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,g}function vg(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var hi=class{constructor(t){ot(this,"options");ot(this,"rules");ot(this,"lexer");this.options=t||Ta}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:us(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=vg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=us(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:us(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=us(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],g;for(g=0;g<r.length;g++)if(this.rules.other.blockquoteStart.test(r[g]))d.push(r[g]),u=!0;else if(!u)d.push(r[g]);else break;r=r.slice(g);let p=d.join(`
`),b=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,i=i?`${i}
${b}`:b;let w=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(b,o,!0),this.lexer.state.top=w,r.length===0)break;let k=o.at(-1);if((k==null?void 0:k.type)==="code")break;if((k==null?void 0:k.type)==="blockquote"){let x=k,N=x.raw+`
`+r.join(`
`),C=this.blockquote(N);o[o.length-1]=C,a=a.substring(0,a.length-x.raw.length)+C.raw,i=i.substring(0,i.length-x.text.length)+C.text;break}else if((k==null?void 0:k.type)==="list"){let x=k,N=x.raw+`
`+r.join(`
`),C=this.list(N);o[o.length-1]=C,a=a.substring(0,a.length-k.raw.length)+C.raw,i=i.substring(0,i.length-x.raw.length)+C.raw,r=N.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),g=!1;for(;t;){let b=!1,w="",k="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;w=e[0],t=t.substring(w.length);let x=fg(e[2].split(`
`,1)[0],e[1].length),N=t.split(`
`,1)[0],C=!x.trim(),A=0;if(this.options.pedantic?(A=2,k=x.trimStart()):C?A=e[1].length+1:(A=x.search(this.rules.other.nonSpaceChar),A=A>4?1:A,k=x.slice(A),A+=e[1].length),C&&this.rules.other.blankLine.test(N)&&(w+=N+`
`,t=t.substring(N.length+1),b=!0),!b){let Q=this.rules.other.nextBulletRegex(A),de=this.rules.other.hrRegex(A),H=this.rules.other.fencesBeginRegex(A),q=this.rules.other.headingBeginRegex(A),X=this.rules.other.htmlBeginRegex(A),te=this.rules.other.blockquoteBeginRegex(A);for(;t;){let G=t.split(`
`,1)[0],ce;if(N=G,this.options.pedantic?(N=N.replace(this.rules.other.listReplaceNesting,"  "),ce=N):ce=N.replace(this.rules.other.tabCharGlobal,"    "),H.test(N)||q.test(N)||X.test(N)||te.test(N)||Q.test(N)||de.test(N))break;if(ce.search(this.rules.other.nonSpaceChar)>=A||!N.trim())k+=`
`+ce.slice(A);else{if(C||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||H.test(x)||q.test(x)||de.test(x))break;k+=`
`+N}C=!N.trim(),w+=G+`
`,t=t.substring(G.length+1),x=ce.slice(A)}}u.loose||(g?u.loose=!0:this.rules.other.doubleBlankLine.test(w)&&(g=!0)),u.items.push({type:"list_item",raw:w,task:!!this.options.gfm&&this.rules.other.listIsTask.test(k),loose:!1,text:k,tokens:[]}),u.raw+=w}let p=u.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let b of u.items){if(this.lexer.state.top=!1,b.tokens=this.lexer.blockTokens(b.text,[]),b.task){if(b.text=b.text.replace(this.rules.other.listReplaceTask,""),((r=b.tokens[0])==null?void 0:r.type)==="text"||((a=b.tokens[0])==null?void 0:a.type)==="paragraph"){b.tokens[0].raw=b.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),b.tokens[0].text=b.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let k=this.lexer.inlineQueue.length-1;k>=0;k--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[k].src)){this.lexer.inlineQueue[k].src=this.lexer.inlineQueue[k].src.replace(this.rules.other.listReplaceTask,"");break}}let w=this.rules.other.listTaskCheckbox.exec(b.raw);if(w){let k={type:"checkbox",raw:w[0]+" ",checked:w[0]!=="[ ]"};b.checked=k.checked,u.loose?b.tokens[0]&&["paragraph","text"].includes(b.tokens[0].type)&&"tokens"in b.tokens[0]&&b.tokens[0].tokens?(b.tokens[0].raw=k.raw+b.tokens[0].raw,b.tokens[0].text=k.raw+b.tokens[0].text,b.tokens[0].tokens.unshift(k)):b.tokens.unshift({type:"paragraph",raw:k.raw,text:k.raw,tokens:[k]}):b.tokens.unshift(k)}}if(!u.loose){let w=b.tokens.filter(x=>x.type==="space"),k=w.length>0&&w.some(x=>this.rules.other.anyLine.test(x.raw));u.loose=k}}if(u.loose)for(let b of u.items){b.loose=!0;for(let w of b.tokens)w.type==="text"&&(w.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=gc(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(gc(d,o.header.length).map((g,p)=>({text:g,tokens:this.lexer.inline(g),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=us(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=dg(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),_c(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return _c(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,g=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(a=p.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){g+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+g);let b=[...a[0]][0].length,w=t.slice(0,i+a.index+b+u);if(Math.min(i,u)%2){let x=w.slice(1,-1);return{type:"em",raw:w,text:x,tokens:this.lexer.inlineTokens(x)}}let k=w.slice(2,-2);return{type:"strong",raw:w,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,g=this.rules.inline.delRDelim;for(g.lastIndex=0,e=e.slice(-1*t.length+i);(a=g.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let p=[...a[0]][0].length,b=t.slice(0,i+a.index+p+u),w=b.slice(i,-i);return{type:"del",raw:b,text:w,tokens:this.lexer.inlineTokens(w)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},rr=class Oo{constructor(e){ot(this,"tokens");ot(this,"options");ot(this,"state");ot(this,"inlineQueue");ot(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ta,this.options.tokenizer=this.options.tokenizer||new hi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:mn,block:ti.normal,inline:cs.normal};this.options.pedantic?(r.block=ti.pedantic,r.inline=cs.pedantic):this.options.gfm&&(r.block=ti.gfm,this.options.breaks?r.inline=cs.breaks:r.inline=cs.gfm),this.tokenizer.rules=r}static get rules(){return{block:ti,inline:cs}}static lex(e,r){return new Oo(r).lex(e)}static lexInline(e,r){return new Oo(r).inlineTokens(e)}lex(e){e=e.replace(mn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(mn.tabCharGlobal,"    ").replace(mn.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let g=e;if((u=this.options.extensions)!=null&&u.startBlock){let p=1/0,b=e.slice(1),w;this.options.extensions.startBlock.forEach(k=>{w=k.call({lexer:this},b),typeof w=="number"&&w>=0&&(p=Math.min(p,w))}),p<1/0&&p>=0&&(g=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(g))){let p=r.at(-1);a&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),a=g.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var g,p,b,w,k;let a=e,i=null;if(this.tokens.links){let x=Object.keys(this.tokens.links);if(x.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)x.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((p=(g=this.options.hooks)==null?void 0:g.emStrongMask)==null?void 0:p.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let x;if((w=(b=this.options.extensions)==null?void 0:b.inline)!=null&&w.some(C=>(x=C.call({lexer:this},e,r))?(e=e.substring(x.raw.length),r.push(x),!0):!1))continue;if(x=this.tokenizer.escape(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.tag(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.link(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(x.raw.length);let C=r.at(-1);x.type==="text"&&(C==null?void 0:C.type)==="text"?(C.raw+=x.raw,C.text+=x.text):r.push(x);continue}if(x=this.tokenizer.emStrong(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.codespan(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.br(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.del(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.autolink(e)){e=e.substring(x.raw.length),r.push(x);continue}if(!this.state.inLink&&(x=this.tokenizer.url(e))){e=e.substring(x.raw.length),r.push(x);continue}let N=e;if((k=this.options.extensions)!=null&&k.startInline){let C=1/0,A=e.slice(1),Q;this.options.extensions.startInline.forEach(de=>{Q=de.call({lexer:this},A),typeof Q=="number"&&Q>=0&&(C=Math.min(C,Q))}),C<1/0&&C>=0&&(N=e.substring(0,C+1))}if(x=this.tokenizer.inlineText(N)){e=e.substring(x.raw.length),x.raw.slice(-1)!=="_"&&(d=x.raw.slice(-1)),u=!0;let C=r.at(-1);(C==null?void 0:C.type)==="text"?(C.raw+=x.raw,C.text+=x.text):r.push(x);continue}if(e){let C="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(C);break}else throw new Error(C)}}return r}},mi=class{constructor(t){ot(this,"options");ot(this,"parser");this.options=t||Ta}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(mn.notSpaceStart))==null?void 0:o[0],i=t.replace(mn.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Ar(a)+'">'+(r?i:Ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=mc(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Ar(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=mc(t);if(i===null)return Ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Ar(t.text)}},dl=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},ar=class Ro{constructor(e){ot(this,"options");ot(this,"renderer");ot(this,"textRenderer");this.options=e||Ta,this.options.renderer=this.options.renderer||new mi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new dl}static parse(e,r){return new Ro(r).parse(e)}static parseInline(e,r){return new Ro(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let g=u,p=this.options.extensions.renderers[g.type].call({parser:this},g);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(g.type)){r+=p||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let g='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(g),"";throw new Error(g)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=p||"";continue}}let g=d;switch(g.type){case"escape":{a+=r.text(g);break}case"html":{a+=r.html(g);break}case"link":{a+=r.link(g);break}case"image":{a+=r.image(g);break}case"checkbox":{a+=r.checkbox(g);break}case"strong":{a+=r.strong(g);break}case"em":{a+=r.em(g);break}case"codespan":{a+=r.codespan(g);break}case"br":{a+=r.br(g);break}case"del":{a+=r.del(g);break}case"text":{a+=r.text(g);break}default:{let p='Token with "'+g.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return a}},ai,gs=(ai=class{constructor(t){ot(this,"options");ot(this,"block");this.options=t||Ta}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?rr.lex:rr.lexInline}provideParser(){return this.block?ar.parse:ar.parseInline}},ot(ai,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),ot(ai,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),ai),pg=class{constructor(...t){ot(this,"defaults",rl());ot(this,"options",this.setOptions);ot(this,"parse",this.parseMarkdown(!0));ot(this,"parseInline",this.parseMarkdown(!1));ot(this,"Parser",ar);ot(this,"Renderer",mi);ot(this,"TextRenderer",dl);ot(this,"Lexer",rr);ot(this,"Tokenizer",hi);ot(this,"Hooks",gs);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let g of d)r=r.concat(this.walkTokens(g.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let g=u[d].flat(1/0);r=r.concat(this.walkTokens(g,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new mi(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],g=i[u];i[u]=(...p)=>{let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new hi(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],g=i[u];i[u]=(...p)=>{let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new gs;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],g=i[u];gs.passThroughHooks.has(o)?i[u]=p=>{if(this.defaults.async&&gs.passThroughHooksRespectAsync.has(o))return(async()=>{let w=await d.call(i,p);return g.call(i,w)})();let b=d.call(i,p);return g.call(i,b)}:i[u]=(...p)=>{if(this.defaults.async)return(async()=>{let w=await d.apply(i,p);return w===!1&&(w=await g.apply(i,p)),w})();let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return rr.lex(t,e??this.defaults)}parser(t,e){return ar.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?rr.lex:rr.lexInline)(u,i),g=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(g,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?ar.parse:ar.parseInline)(g,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?rr.lex:rr.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?ar.parse:ar.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},xa=new pg;function wt(t,e){return xa.parse(t,e)}wt.options=wt.setOptions=function(t){return xa.setOptions(t),wt.defaults=xa.defaults,Ju(wt.defaults),wt};wt.getDefaults=rl;wt.defaults=Ta;wt.use=function(...t){return xa.use(...t),wt.defaults=xa.defaults,Ju(wt.defaults),wt};wt.walkTokens=function(t,e){return xa.walkTokens(t,e)};wt.parseInline=xa.parseInline;wt.Parser=ar;wt.parser=ar.parse;wt.Renderer=mi;wt.TextRenderer=dl;wt.Lexer=rr;wt.lexer=rr.lex;wt.Tokenizer=hi;wt.Hooks=gs;wt.parse=wt;wt.options;wt.setOptions;wt.use;wt.walkTokens;wt.parseInline;ar.parse;rr.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:ud,setPrototypeOf:yc,isFrozen:hg,getPrototypeOf:mg,getOwnPropertyDescriptor:gg}=Object;let{freeze:_n,seal:Xn,create:Mo}=Object,{apply:Do,construct:jo}=typeof Reflect<"u"&&Reflect;_n||(_n=function(e){return e});Xn||(Xn=function(e){return e});Do||(Do=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});jo||(jo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const ni=yn(Array.prototype.forEach),_g=yn(Array.prototype.lastIndexOf),bc=yn(Array.prototype.pop),ds=yn(Array.prototype.push),yg=yn(Array.prototype.splice),ui=yn(String.prototype.toLowerCase),io=yn(String.prototype.toString),oo=yn(String.prototype.match),fs=yn(String.prototype.replace),bg=yn(String.prototype.indexOf),wg=yn(String.prototype.trim),tr=yn(Object.prototype.hasOwnProperty),hn=yn(RegExp.prototype.test),vs=kg(TypeError);function yn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return Do(t,e,a)}}function kg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return jo(t,r)}}function st(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ui;yc&&yc(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(hg(e)||(e[a]=o),i=o)}t[i]=!0}return t}function xg(t){for(let e=0;e<t.length;e++)tr(t,e)||(t[e]=null);return t}function fr(t){const e=Mo(null);for(const[r,a]of ud(t))tr(t,r)&&(Array.isArray(a)?e[r]=xg(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=fr(a):e[r]=a);return e}function ps(t,e){for(;t!==null;){const a=gg(t,e);if(a){if(a.get)return yn(a.get);if(typeof a.value=="function")return yn(a.value)}t=mg(t)}function r(){return null}return r}const wc=_n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lo=_n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),co=_n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sg=_n(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uo=_n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Tg=_n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),kc=_n(["#text"]),xc=_n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),fo=_n(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Sc=_n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ri=_n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Eg=Xn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ag=Xn(/<%[\w\W]*|[\w\W]*%>/gm),Cg=Xn(/\$\{[\w\W]*/gm),Pg=Xn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ig=Xn(/^aria-[\-\w]+$/),dd=Xn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Og=Xn(/^(?:\w+script|data):/i),Rg=Xn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),fd=Xn(/^html$/i),Mg=Xn(/^[a-z][.\w]*(-[.\w]+)+$/i);var Tc=Object.freeze({__proto__:null,ARIA_ATTR:Ig,ATTR_WHITESPACE:Rg,CUSTOM_ELEMENT:Mg,DATA_ATTR:Pg,DOCTYPE_NAME:fd,ERB_EXPR:Ag,IS_ALLOWED_URI:dd,IS_SCRIPT_OR_DATA:Og,MUSTACHE_EXPR:Eg,TMPLIT_EXPR:Cg});const hs={element:1,text:3,progressingInstruction:7,comment:8,document:9},Dg=function(){return typeof window>"u"?null:window},jg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Ec=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function vd(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dg();const e=Fe=>vd(Fe);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==hs.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:g,NodeFilter:p,NamedNodeMap:b=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:w,DOMParser:k,trustedTypes:x}=t,N=g.prototype,C=ps(N,"cloneNode"),A=ps(N,"remove"),Q=ps(N,"nextSibling"),de=ps(N,"childNodes"),H=ps(N,"parentNode");if(typeof u=="function"){const Fe=r.createElement("template");Fe.content&&Fe.content.ownerDocument&&(r=Fe.content.ownerDocument)}let q,X="";const{implementation:te,createNodeIterator:G,createDocumentFragment:ce,getElementsByTagName:be}=r,{importNode:Ee}=a;let fe=Ec();e.isSupported=typeof ud=="function"&&typeof H=="function"&&te&&te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:oe,TMPLIT_EXPR:Te,DATA_ATTR:ue,ARIA_ATTR:_e,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:ae,CUSTOM_ELEMENT:pe}=Tc;let{IS_ALLOWED_URI:ve}=Tc,se=null;const J=st({},[...wc,...lo,...co,...uo,...kc]);let F=null;const K=st({},[...xc,...fo,...Sc,...ri]);let $=Object.seal(Mo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,ze=null;const Ae=Object.seal(Mo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let je=!0,P=!0,me=!1,xe=!0,Me=!1,Xe=!0,Je=!1,it=!1,At=!1,He=!1,Ve=!1,$e=!1,et=!0,Ke=!1;const We="user-content-";let Ct=!0,mt=!1,ht={},xt=null;const dn=st({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let sn=null;const bn=st({},["audio","video","img","source","image","track"]);let Zt=null;const Wt=st({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ht="http://www.w3.org/1998/Math/MathML",wn="http://www.w3.org/2000/svg",jt="http://www.w3.org/1999/xhtml";let Ne=jt,zn=!1,Pn=null;const Nr=st({},[Ht,wn,jt],io);let Ie=st({},["mi","mo","mn","ms","mtext"]),cr=st({},["annotation-xml"]);const Ea=st({},["title","style","font","a","script"]);let Zn=null;const Aa=["application/xhtml+xml","text/html"],ut="text/html";let Ye=null,Ut=null;const Vt=r.createElement("form"),fn=function(T){return T instanceof RegExp||T instanceof Function},Jn=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ut&&Ut===T)){if((!T||typeof T!="object")&&(T={}),T=fr(T),Zn=Aa.indexOf(T.PARSER_MEDIA_TYPE)===-1?ut:T.PARSER_MEDIA_TYPE,Ye=Zn==="application/xhtml+xml"?io:ui,se=tr(T,"ALLOWED_TAGS")?st({},T.ALLOWED_TAGS,Ye):J,F=tr(T,"ALLOWED_ATTR")?st({},T.ALLOWED_ATTR,Ye):K,Pn=tr(T,"ALLOWED_NAMESPACES")?st({},T.ALLOWED_NAMESPACES,io):Nr,Zt=tr(T,"ADD_URI_SAFE_ATTR")?st(fr(Wt),T.ADD_URI_SAFE_ATTR,Ye):Wt,sn=tr(T,"ADD_DATA_URI_TAGS")?st(fr(bn),T.ADD_DATA_URI_TAGS,Ye):bn,xt=tr(T,"FORBID_CONTENTS")?st({},T.FORBID_CONTENTS,Ye):dn,Oe=tr(T,"FORBID_TAGS")?st({},T.FORBID_TAGS,Ye):fr({}),ze=tr(T,"FORBID_ATTR")?st({},T.FORBID_ATTR,Ye):fr({}),ht=tr(T,"USE_PROFILES")?T.USE_PROFILES:!1,je=T.ALLOW_ARIA_ATTR!==!1,P=T.ALLOW_DATA_ATTR!==!1,me=T.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=T.SAFE_FOR_TEMPLATES||!1,Xe=T.SAFE_FOR_XML!==!1,Je=T.WHOLE_DOCUMENT||!1,He=T.RETURN_DOM||!1,Ve=T.RETURN_DOM_FRAGMENT||!1,$e=T.RETURN_TRUSTED_TYPE||!1,At=T.FORCE_BODY||!1,et=T.SANITIZE_DOM!==!1,Ke=T.SANITIZE_NAMED_PROPS||!1,Ct=T.KEEP_CONTENT!==!1,mt=T.IN_PLACE||!1,ve=T.ALLOWED_URI_REGEXP||dd,Ne=T.NAMESPACE||jt,Ie=T.MATHML_TEXT_INTEGRATION_POINTS||Ie,cr=T.HTML_INTEGRATION_POINTS||cr,$=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&fn(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&fn(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&(P=!1),Ve&&(He=!0),ht&&(se=st({},kc),F=[],ht.html===!0&&(st(se,wc),st(F,xc)),ht.svg===!0&&(st(se,lo),st(F,fo),st(F,ri)),ht.svgFilters===!0&&(st(se,co),st(F,fo),st(F,ri)),ht.mathMl===!0&&(st(se,uo),st(F,Sc),st(F,ri))),T.ADD_TAGS&&(typeof T.ADD_TAGS=="function"?Ae.tagCheck=T.ADD_TAGS:(se===J&&(se=fr(se)),st(se,T.ADD_TAGS,Ye))),T.ADD_ATTR&&(typeof T.ADD_ATTR=="function"?Ae.attributeCheck=T.ADD_ATTR:(F===K&&(F=fr(F)),st(F,T.ADD_ATTR,Ye))),T.ADD_URI_SAFE_ATTR&&st(Zt,T.ADD_URI_SAFE_ATTR,Ye),T.FORBID_CONTENTS&&(xt===dn&&(xt=fr(xt)),st(xt,T.FORBID_CONTENTS,Ye)),T.ADD_FORBID_CONTENTS&&(xt===dn&&(xt=fr(xt)),st(xt,T.ADD_FORBID_CONTENTS,Ye)),Ct&&(se["#text"]=!0),Je&&st(se,["html","head","body"]),se.table&&(st(se,["tbody"]),delete Oe.tbody),T.TRUSTED_TYPES_POLICY){if(typeof T.TRUSTED_TYPES_POLICY.createHTML!="function")throw vs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof T.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw vs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');q=T.TRUSTED_TYPES_POLICY,X=q.createHTML("")}else q===void 0&&(q=jg(x,i)),q!==null&&typeof X=="string"&&(X=q.createHTML(""));_n&&_n(T),Ut=T}},Pt=st({},[...lo,...co,...Sg]),ft=st({},[...uo,...Tg]),It=function(T){let he=H(T);(!he||!he.tagName)&&(he={namespaceURI:Ne,tagName:"template"});const we=ui(T.tagName),at=ui(he.tagName);return Pn[T.namespaceURI]?T.namespaceURI===wn?he.namespaceURI===jt?we==="svg":he.namespaceURI===Ht?we==="svg"&&(at==="annotation-xml"||Ie[at]):!!Pt[we]:T.namespaceURI===Ht?he.namespaceURI===jt?we==="math":he.namespaceURI===wn?we==="math"&&cr[at]:!!ft[we]:T.namespaceURI===jt?he.namespaceURI===wn&&!cr[at]||he.namespaceURI===Ht&&!Ie[at]?!1:!ft[we]&&(Ea[we]||!Pt[we]):!!(Zn==="application/xhtml+xml"&&Pn[T.namespaceURI]):!1},vn=function(T){ds(e.removed,{element:T});try{H(T).removeChild(T)}catch{A(T)}},pn=function(T,he){try{ds(e.removed,{attribute:he.getAttributeNode(T),from:he})}catch{ds(e.removed,{attribute:null,from:he})}if(he.removeAttribute(T),T==="is")if(He||Ve)try{vn(he)}catch{}else try{he.setAttribute(T,"")}catch{}},wr=function(T){let he=null,we=null;if(At)T="<remove></remove>"+T;else{const Ot=oo(T,/^[\r\n\t ]+/);we=Ot&&Ot[0]}Zn==="application/xhtml+xml"&&Ne===jt&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");const at=q?q.createHTML(T):T;if(Ne===jt)try{he=new k().parseFromString(at,Zn)}catch{}if(!he||!he.documentElement){he=te.createDocument(Ne,"template",null);try{he.documentElement.innerHTML=zn?X:at}catch{}}const St=he.body||he.documentElement;return T&&we&&St.insertBefore(r.createTextNode(we),St.childNodes[0]||null),Ne===jt?be.call(he,Je?"html":"body")[0]:Je?he.documentElement:St},kr=function(T){return G.call(T.ownerDocument||T,T,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},Jr=function(T){return T instanceof w&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof b)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},In=function(T){return typeof d=="function"&&T instanceof d};function Gt(Fe,T,he){ni(Fe,we=>{we.call(e,T,he,Ut)})}const kn=function(T){let he=null;if(Gt(fe.beforeSanitizeElements,T,null),Jr(T))return vn(T),!0;const we=Ye(T.nodeName);if(Gt(fe.uponSanitizeElement,T,{tagName:we,allowedTags:se}),Xe&&T.hasChildNodes()&&!In(T.firstElementChild)&&hn(/<[/\w!]/g,T.innerHTML)&&hn(/<[/\w!]/g,T.textContent)||T.nodeType===hs.progressingInstruction||Xe&&T.nodeType===hs.comment&&hn(/<[/\w]/g,T.data))return vn(T),!0;if(!(Ae.tagCheck instanceof Function&&Ae.tagCheck(we))&&(!se[we]||Oe[we])){if(!Oe[we]&&Ca(we)&&($.tagNameCheck instanceof RegExp&&hn($.tagNameCheck,we)||$.tagNameCheck instanceof Function&&$.tagNameCheck(we)))return!1;if(Ct&&!xt[we]){const at=H(T)||T.parentNode,St=de(T)||T.childNodes;if(St&&at){const Ot=St.length;for(let Dt=Ot-1;Dt>=0;--Dt){const on=C(St[Dt],!0);on.__removalCount=(T.__removalCount||0)+1,at.insertBefore(on,Q(T))}}}return vn(T),!0}return T instanceof g&&!It(T)||(we==="noscript"||we==="noembed"||we==="noframes")&&hn(/<\/no(script|embed|frames)/i,T.innerHTML)?(vn(T),!0):(Me&&T.nodeType===hs.text&&(he=T.textContent,ni([ne,oe,Te],at=>{he=fs(he,at," ")}),T.textContent!==he&&(ds(e.removed,{element:T.cloneNode()}),T.textContent=he)),Gt(fe.afterSanitizeElements,T,null),!1)},xr=function(T,he,we){if(et&&(he==="id"||he==="name")&&(we in r||we in Vt))return!1;if(!(P&&!ze[he]&&hn(ue,he))){if(!(je&&hn(_e,he))){if(!(Ae.attributeCheck instanceof Function&&Ae.attributeCheck(he,T))){if(!F[he]||ze[he]){if(!(Ca(T)&&($.tagNameCheck instanceof RegExp&&hn($.tagNameCheck,T)||$.tagNameCheck instanceof Function&&$.tagNameCheck(T))&&($.attributeNameCheck instanceof RegExp&&hn($.attributeNameCheck,he)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(he,T))||he==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&hn($.tagNameCheck,we)||$.tagNameCheck instanceof Function&&$.tagNameCheck(we))))return!1}else if(!Zt[he]){if(!hn(ve,fs(we,ae,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&T!=="script"&&bg(we,"data:")===0&&sn[T])){if(!(me&&!hn(ke,fs(we,ae,"")))){if(we)return!1}}}}}}}return!0},Ca=function(T){return T!=="annotation-xml"&&oo(T,pe)},On=function(T){Gt(fe.beforeSanitizeAttributes,T,null);const{attributes:he}=T;if(!he||Jr(T))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F,forceKeepAttr:void 0};let at=he.length;for(;at--;){const St=he[at],{name:Ot,namespaceURI:Dt,value:on}=St,Fn=Ye(Ot),Jt=on;let yt=Ot==="value"?Jt:wg(Jt);if(we.attrName=Fn,we.attrValue=yt,we.keepAttr=!0,we.forceKeepAttr=void 0,Gt(fe.uponSanitizeAttribute,T,we),yt=we.attrValue,Ke&&(Fn==="id"||Fn==="name")&&(pn(Ot,T),yt=We+yt),Xe&&hn(/((--!?|])>)|<\/(style|title|textarea)/i,yt)){pn(Ot,T);continue}if(Fn==="attributename"&&oo(yt,"href")){pn(Ot,T);continue}if(we.forceKeepAttr)continue;if(!we.keepAttr){pn(Ot,T);continue}if(!xe&&hn(/\/>/i,yt)){pn(Ot,T);continue}Me&&ni([ne,oe,Te],Tr=>{yt=fs(yt,Tr," ")});const Sr=Ye(T.nodeName);if(!xr(Sr,Fn,yt)){pn(Ot,T);continue}if(q&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!Dt)switch(x.getAttributeType(Sr,Fn)){case"TrustedHTML":{yt=q.createHTML(yt);break}case"TrustedScriptURL":{yt=q.createScriptURL(yt);break}}if(yt!==Jt)try{Dt?T.setAttributeNS(Dt,Ot,yt):T.setAttribute(Ot,yt),Jr(T)?vn(T):bc(e.removed)}catch{pn(Ot,T)}}Gt(fe.afterSanitizeAttributes,T,null)},Pa=function Fe(T){let he=null;const we=kr(T);for(Gt(fe.beforeSanitizeShadowDOM,T,null);he=we.nextNode();)Gt(fe.uponSanitizeShadowNode,he,null),kn(he),On(he),he.content instanceof o&&Fe(he.content);Gt(fe.afterSanitizeShadowDOM,T,null)};return e.sanitize=function(Fe){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,we=null,at=null,St=null;if(zn=!Fe,zn&&(Fe="<!-->"),typeof Fe!="string"&&!In(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw vs("dirty is not a string, aborting")}else throw vs("toString is not a function");if(!e.isSupported)return Fe;if(it||Jn(T),e.removed=[],typeof Fe=="string"&&(mt=!1),mt){if(Fe.nodeName){const on=Ye(Fe.nodeName);if(!se[on]||Oe[on])throw vs("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof d)he=wr("<!---->"),we=he.ownerDocument.importNode(Fe,!0),we.nodeType===hs.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?he=we:he.appendChild(we);else{if(!He&&!Me&&!Je&&Fe.indexOf("<")===-1)return q&&$e?q.createHTML(Fe):Fe;if(he=wr(Fe),!he)return He?null:$e?X:""}he&&At&&vn(he.firstChild);const Ot=kr(mt?Fe:he);for(;at=Ot.nextNode();)kn(at),On(at),at.content instanceof o&&Pa(at.content);if(mt)return Fe;if(He){if(Ve)for(St=ce.call(he.ownerDocument);he.firstChild;)St.appendChild(he.firstChild);else St=he;return(F.shadowroot||F.shadowrootmode)&&(St=Ee.call(a,St,!0)),St}let Dt=Je?he.outerHTML:he.innerHTML;return Je&&se["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&hn(fd,he.ownerDocument.doctype.name)&&(Dt="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+Dt),Me&&ni([ne,oe,Te],on=>{Dt=fs(Dt,on," ")}),q&&$e?q.createHTML(Dt):Dt},e.setConfig=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jn(Fe),it=!0},e.clearConfig=function(){Ut=null,it=!1},e.isValidAttribute=function(Fe,T,he){Ut||Jn({});const we=Ye(Fe),at=Ye(T);return xr(we,at,he)},e.addHook=function(Fe,T){typeof T=="function"&&ds(fe[Fe],T)},e.removeHook=function(Fe,T){if(T!==void 0){const he=_g(fe[Fe],T);return he===-1?void 0:yg(fe[Fe],he,1)[0]}return bc(fe[Fe])},e.removeHooks=function(Fe){fe[Fe]=[]},e.removeAllHooks=function(){fe=Ec()},e}var Lg=vd();function Ng(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${Ac(t.from)} |`),e.push(`| **To** | ${Ac(t.to)} |`),e.push(`| **Date** | ${$o(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?qg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function Ac(t){return(t||"").replace(/\|/g,"\\|")}function qg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return Lo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Bg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function Lo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Bg(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(Lo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>Lo(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function zg(t){return Nu(t,"md")}function Cc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Fg(t){return t.raw||null}function Kg(t){const e=Fg(t);return e?JSON.stringify(e,null,2):"null"}function Ug(t){return Nu(t,"json")}var Gg=L('<button title="View as Markdown">.md</button>'),Wg=L('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Hg=L('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Vg=L('<div class="md-preview svelte-1b0rzpb"><!></div>'),Yg=L('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Qg=L('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Xg=L('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Zg=L('<pre class="message-text svelte-1b0rzpb"> </pre>'),Jg=L('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),$g=L('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),e_=L('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function t_(t,e){Tt(e,!0);let r=De(e,"loading",3,!1);an(()=>Bn("MessageModal"));const a=new wt.Renderer;a.link=({href:ne,title:oe,text:Te})=>{const ue=oe?` title="${oe}"`:"";return`<a href="${ne}"${ue} target="_blank" rel="noopener">${Te}</a>`},wt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Re("email"),o=bt(()=>e.message.body?Ng(e.message):""),u=bt(()=>Kg(e.message)),d=Re("raw");function g(ne){I(i,v(i)===ne?"email":ne,!0),ne==="markdown"&&I(d,"raw")}function p(){Cc(v(o),zg(e.message))}function b(){Cc(v(u),Ug(e.message),"application/json;charset=utf-8")}function w(ne){const oe=wt.parse(ne);return Lg.sanitize(oe,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let k=Re(null);Qa(()=>{var ne;if(v(k)&&e.message.htmlBody&&!r()&&v(i)==="email"){const oe=v(k).contentDocument||((ne=v(k).contentWindow)==null?void 0:ne.document);oe&&(oe.open(),oe.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),oe.close())}});var x=e_();x.__click=function(...ne){var oe;(oe=e.onclose)==null||oe.apply(this,ne)};var N=m(x);N.__click=ne=>ne.stopPropagation();var C=m(N),A=m(C),Q=m(A),de=_(A,2),H=m(de);let q;H.__click=()=>g("json");var X=_(H,2);{var te=ne=>{var oe=Gg();let Te;oe.__click=()=>g("markdown"),ee(()=>Te=Mt(oe,1,"action-btn svelte-1b0rzpb",null,Te,{active:v(i)==="markdown"})),E(ne,oe)};re(X,ne=>{e.message.body&&ne(te)})}var G=_(X,2);G.__click=function(...ne){var oe;(oe=e.onclose)==null||oe.apply(this,ne)};var ce=_(C,2);{var be=ne=>{var oe=Wg(),Te=Qe(oe),ue=_(m(Te),2);ue.__click=b;var _e=_(Te,2),ke=m(_e),ae=m(ke);ee(()=>U(ae,v(u))),E(ne,oe)},Ee=ne=>{var oe=Yg(),Te=Qe(oe),ue=m(Te),_e=m(ue);let ke;_e.__click=()=>I(d,"raw");var ae=_(_e,2);let pe;ae.__click=()=>I(d,"preview");var ve=_(ue,2);ve.__click=p;var se=_(Te,2),J=m(se);{var F=$=>{var Oe=Hg(),ze=m(Oe);ee(()=>U(ze,v(o))),E($,Oe)},K=$=>{var Oe=Vg(),ze=m(Oe);sv(ze,()=>w(v(o))),E($,Oe)};re(J,$=>{v(d)==="raw"?$(F):$(K,!1)})}ee(()=>{ke=Mt(_e,1,"md-tab svelte-1b0rzpb",null,ke,{active:v(d)==="raw"}),pe=Mt(ae,1,"md-tab svelte-1b0rzpb",null,pe,{active:v(d)==="preview"})}),E(ne,oe)},fe=ne=>{var oe=$g(),Te=Qe(oe),ue=m(Te),_e=_(m(ue),2),ke=m(_e),ae=_(ue,2),pe=_(m(ae),2),ve=m(pe),se=_(ae,2),J=_(m(se),2),F=m(J),K=_(Te,2),$=m(K);{var Oe=P=>{var me=Qg();E(P,me)},ze=P=>{var me=Xg();Cu(me,xe=>I(k,xe),()=>v(k)),E(P,me)},Ae=P=>{var me=Zg(),xe=m(me);ee(()=>U(xe,e.message.body)),E(P,me)},je=P=>{var me=Jg();E(P,me)};re($,P=>{r()?P(Oe):e.message.htmlBody?P(ze,1):e.message.body?P(Ae,2):P(je,!1)})}ee(P=>{U(ke,e.message.from),U(ve,e.message.to),U(F,P)},[()=>$o(e.message.date)]),E(ne,oe)};re(ce,ne=>{v(i)==="json"?ne(be):v(i)==="markdown"?ne(Ee,1):ne(fe,!1)})}ee(()=>{U(Q,e.message.subject),q=Mt(H,1,"action-btn svelte-1b0rzpb",null,q,{active:v(i)==="json"})}),E(t,x),Et()}zt(["click"]);var n_=L('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),r_=L('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),a_=L('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),s_=L("<p> </p>"),i_=L('<p>No emails in local storage. Click "Sync New" to download.</p>'),o_=L('<div class="empty-state svelte-6ts5xm"><!></div>'),l_=L('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),c_=L('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function u_(t,e){Tt(e,!0),an(()=>Bn("DashboardView"));let r=De(e,"error",3,null),a=De(e,"profile",3,null),i=De(e,"loadingProfile",3,!1),o=De(e,"emailMessages",19,()=>[]),u=De(e,"totalLocalMessages",3,0),d=De(e,"hasMoreLocal",3,!1),g=De(e,"loadingMessages",3,!1),p=De(e,"selectedMessage",3,null),b=De(e,"syncStatus",3,null),w=De(e,"syncProgress",3,null),k=De(e,"isSyncing",3,!1),x=De(e,"searchQuery",15);var N=c_(),C=Qe(N),A=m(C);{var Q=ue=>{Zu(ue,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};re(A,ue=>{r()&&ue(Q)})}var de=_(A,2);cm(de,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var H=_(de,2);km(H,{get syncStatus(){return b()},get syncProgress(){return w()},get isSyncing(){return k()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var q=_(H,2),X=m(q);X.__keydown=ue=>ue.key==="Enter"&&e.onsearch();var te=_(X,2);te.__click=function(...ue){var _e;(_e=e.onsearch)==null||_e.apply(this,ue)};var G=m(te),ce=_(q,2);{var be=ue=>{var _e=r_(),ke=Qe(_e),ae=m(ke),pe=m(ae),ve=_(ke,2);Tm(ve,{get messages(){return o()},get onselect(){return e.onviewmessage}});var se=_(ve,2);{var J=F=>{var K=n_(),$=m(K);$.__click=function(...ze){var Ae;(Ae=e.onloadmore)==null||Ae.apply(this,ze)};var Oe=m($);ee(()=>{$.disabled=g(),U(Oe,g()?"Loading...":"Load More")}),E(F,K)};re(se,F=>{d()&&F(J)})}ee(F=>U(pe,`Showing ${o().length??""} of ${F??""}
        ${x()?" matching":""} emails`),[()=>u().toLocaleString()]),E(ue,_e)},Ee=ue=>{var _e=a_();E(ue,_e)},fe=ue=>{var _e=o_(),ke=m(_e);{var ae=ve=>{var se=s_(),J=m(se);ee(()=>U(J,`No emails match "${x()??""}".`)),E(ve,se)},pe=ve=>{var se=i_();E(ve,se)};re(ke,ve=>{x()?ve(ae):ve(pe,!1)})}E(ue,_e)},ne=ue=>{var _e=l_();E(ue,_e)};re(ce,ue=>{var _e;o().length>0?ue(be):g()?ue(Ee,1):(_e=b())!=null&&_e.synced?ue(fe,2):ue(ne,!1)})}var oe=_(C,2);{var Te=ue=>{t_(ue,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};re(oe,ue=>{p()&&ue(Te)})}ee(()=>{te.disabled=g(),U(G,g()?"Searching...":"Search")}),Si(X,x),E(t,N),Et()}zt(["keydown","click"]);var d_=L('<div class="dashboard svelte-1q5o2lv"><!></div>');function f_(t,e){Tt(e,!0);function r(P){P.key==="Escape"&&v(w)&&ve()}let a=null;an(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const P=Lh();if(P<=0)return;const me=Math.max(0,P-120*1e3);a=setTimeout(async()=>{try{const xe=await uc();I(p,xe.access_token,!0),i()}catch{I(p,null),I(b,null),I(H,"Session expired. Please sign in again.")}},me)}async function o(){if(jh())return v(p);try{const P=await uc();return I(p,P.access_token,!0),i(),v(p)}catch{return I(p,null),I(b,null),I(H,"Session expired. Please sign in again."),null}}let u=Re(Ft(localStorage.getItem("googleClientId")||"")),d=Re(Ft(localStorage.getItem("googleClientId")||"")),g=Re(!1),p=Re(null),b=Re(null),w=Re(null),k=Re(""),x=Re(Ft([])),N=Re(0),C=Re(0),A=Re(!1),Q=Re(!1),de=Re(!1),H=Re(null),q=Re(null),X=Re(null),te=Re(!1);const G=50;Qa(()=>{v(p)&&(se(),_e())});let ce=bt(()=>!v(u)),be=bt(()=>!!v(p)),Ee=bt(()=>v(x).length<v(N));Qa(()=>{v(u)&&!v(g)&&dc(v(u)).then(()=>{if(I(g,!0),!v(p)){const P=Dh();P&&(I(p,P.access_token,!0),i(),ue())}}).catch(P=>{I(H,`Auth init failed: ${P.message}`)})});function fe(){const P=v(d).trim();P&&(localStorage.setItem("googleClientId",P),I(u,P,!0),I(H,null))}function ne(){localStorage.removeItem("googleClientId"),I(u,""),I(d,""),I(g,!1),I(p,null),I(b,null),I(x,[],!0),I(N,0)}async function oe(){I(H,null),I(Q,!0);try{v(g)||(await dc(v(u)),I(g,!0));const P=await qh();I(p,P.access_token,!0),i(),await ue()}catch(P){I(H,P.message,!0)}finally{I(Q,!1)}}async function Te(){if(a&&clearTimeout(a),v(p))try{await Bh(v(p))}catch{}I(p,null),I(b,null),I(x,[],!0),I(N,0),I(w,null),I(H,null)}async function ue(){I(de,!0);try{const P=await Ru(v(p));if(!v(p))return;I(b,P,!0)}catch(P){if(!v(p))return;I(H,`Profile fetch failed: ${P.message}`)}finally{I(de,!1)}}async function _e(P=!1){I(A,!0);try{const me=P?v(C):0,xe=await Kv({query:v(k)||void 0,limit:G,offset:me});P?I(x,[...v(x),...xe.items],!0):I(x,xe.items,!0),I(N,xe.total,!0),I(C,v(x).length,!0)}catch(me){I(H,`Failed to load messages: ${me.message}`)}finally{I(A,!1)}}function ke(){I(C,0),_e(!1)}function ae(){_e(!0)}function pe(P){I(w,P,!0)}function ve(){I(w,null)}async function se(){try{I(q,await Kh(),!0)}catch{}}async function J(P){if(v(te)||!v(p))return;const me=await o();if(!me)return;I(H,null),I(te,!0),I(X,null);const xe=new AbortController;try{await zh(me,{limit:P,onProgress:Me=>{I(X,{...Me},!0)},signal:xe.signal}),await se(),await _e(!1)}catch(Me){if(Me.name!=="AbortError"){if(!v(p))return;I(H,`Sync failed: ${Me.message}`)}}finally{I(te,!1)}}async function F(P){if(v(te)||!v(p))return;const me=await o();if(!me)return;I(H,null),I(te,!0),I(X,null);const xe=new AbortController;try{await Fh(me,{limit:P,onProgress:Me=>{I(X,{...Me},!0)},signal:xe.signal}),await se(),await _e(!1)}catch(Me){if(Me.name!=="AbortError"){if(!v(p))return;I(H,`Sync more failed: ${Me.message}`)}}finally{I(te,!1)}}async function K(){try{await Vu(),await se(),I(x,[],!0),I(N,0),I(C,0)}catch(P){I(H,`Failed to clear data: ${P.message}`)}}var $=d_(),Oe=m($);{var ze=P=>{Yh(P,{onsave:fe,get clientIdInput(){return v(d)},set clientIdInput(me){I(d,me,!0)}})},Ae=P=>{sm(P,{get clientId(){return v(u)},get error(){return v(H)},get loadingAuth(){return v(Q)},onsignin:oe,onclear:ne,onsignout:Te})},je=P=>{u_(P,{get error(){return v(H)},get profile(){return v(b)},get loadingProfile(){return v(de)},get emailMessages(){return v(x)},get totalLocalMessages(){return v(N)},get hasMoreLocal(){return v(Ee)},get loadingMessages(){return v(A)},get selectedMessage(){return v(w)},get syncStatus(){return v(q)},get syncProgress(){return v(X)},get isSyncing(){return v(te)},onsignout:Te,onsearch:ke,onloadmore:ae,onviewmessage:pe,onclosedetail:ve,ondismisserror:()=>I(H,null),onsync:J,onsyncmore:F,oncleardata:K,get searchQuery(){return v(k)},set searchQuery(me){I(k,me,!0)}})};re(Oe,P=>{v(ce)?P(ze):v(be)?P(je,!1):P(Ae,1)})}E(t,$),Et()}var v_=L('<span class="sep svelte-t1ig66">Â·</span> ',1),p_=L('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),h_=L('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),m_=L('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),g_=L('<span class="result-summary svelte-t1ig66"> </span>'),__=L('<span class="result-tag svelte-t1ig66"> </span>'),y_=L('<div class="result-tags svelte-t1ig66"></div>'),b_=L('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),w_=L('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),k_=L('<div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">already classified</span></div>'),x_=L('<div class="summary-stat svelte-t1ig66"><span class="sstat-val err svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">errors</span></div>'),S_=L('<span class="ssec-item svelte-t1ig66">Avg speed: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span>',1),T_=L('<span class="ri-action svelte-t1ig66"> </span>'),E_=L('<span class="ri-error svelte-t1ig66">ERROR</span>'),A_=L('<span class="sep svelte-t1ig66">Â·</span> ',1),C_=L('<div class="ri-summary svelte-t1ig66"> </div>'),P_=L('<span class="sep svelte-t1ig66">Â·</span> ',1),I_=L('<!> <div class="ri-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <!></div>',1),O_=L('<details class="ri-err-details svelte-t1ig66"><summary class="ri-err-summary svelte-t1ig66">View error details</summary> <div class="ri-err-msg svelte-t1ig66"> </div></details>'),R_=L('<div><div class="ri-head svelte-t1ig66"><span class="ri-subj svelte-t1ig66"> </span> <!></div> <div class="ri-meta svelte-t1ig66"> <!></div> <!></div>'),M_=L('<details class="results-details svelte-t1ig66"><summary class="results-summary svelte-t1ig66"> </summary> <div class="results-list svelte-t1ig66"></div></details>'),D_=L('<div class="summary-card svelte-t1ig66"><div class="summary-head svelte-t1ig66"><span class="summary-title svelte-t1ig66">Scan Summary</span></div> <div class="summary-grid svelte-t1ig66"><div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">emails processed</span></div> <!> <div class="summary-stat svelte-t1ig66"><span class="sstat-val success svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">classified</span></div> <!></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">LLM Performance</div> <div class="ssec-items svelte-t1ig66"><!> <span class="ssec-item svelte-t1ig66">Total tokens: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Duration: <strong class="svelte-t1ig66"> </strong></span></div></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">Model & Prompts</div> <div class="ssec-items svelte-t1ig66"><span class="ssec-item svelte-t1ig66">Model: <strong class="svelte-t1ig66"> </strong> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">System prompt: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Avg email: <strong class="svelte-t1ig66"> </strong></span></div></div> <!></div>'),j_=L('<span class="err svelte-t1ig66"> </span>'),L_=L('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),N_=L('<button class="action-btn svelte-t1ig66">View Prompt Config</button>'),q_=L('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),B_=L('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),z_=L('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),F_=L('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),K_=L('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),U_=L('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function G_(t,e){Tt(e,!0);let r=De(e,"progress",3,null),a=Re(!1),i=Re("system");function o(C){return!C||C<0?"â":C<1e3?`${Math.round(C)}ms`:`${(C/1e3).toFixed(1)}s`}function u(C){return C?C>=1e3?`${(C/1e3).toFixed(1)}k`:String(C):"0"}function d(C){if(!C)return"â";const A=C.replace(/<.*>/,"").trim();return A.length>30?A.slice(0,28)+"â¦":A}function g(C){if(!C)return"";try{return new Date(C).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function p(C){var de;if(!((de=C==null?void 0:C.totals)!=null&&de.elapsed)||!(C!=null&&C.current)||C.current<2)return null;const A=C.totals.elapsed/C.current;return(C.total-C.current)*A}let b=bt(()=>{var C;return(C=r())!=null&&C.total?Math.round(r().current/r().total*100):0}),w=bt(()=>p(r()));var k=yr(),x=Qe(k);{var N=C=>{var A=U_(),Q=Qe(A),de=m(Q),H=m(de),q=m(H);{var X=Ae=>{var je=Za("Scan complete");E(Ae,je)},te=Ae=>{var je=Za();ee(()=>U(je,`Processing ${r().current??""} of ${r().total??""}`)),E(Ae,je)};re(q,Ae=>{r().phase==="done"?Ae(X):Ae(te,!1)})}var G=_(H,2),ce=m(G),be=_(de,2),Ee=m(be);let fe,ne;var oe=_(be,2);{var Te=Ae=>{var je=p_(),P=m(je),me=m(P),xe=_(P,2),Me=m(xe),Xe=_(Me);{var Je=it=>{var At=v_(),He=_(Qe(At),1,!0);ee(Ve=>U(He,Ve),[()=>g(r().email.date)]),E(it,At)};re(Xe,it=>{r().email.date&&it(Je)})}ee(it=>{U(me,r().email.subject||"(no subject)"),U(Me,`${it??""} `)},[()=>d(r().email.from)]),E(Ae,je)};re(oe,Ae=>{r().email&&r().phase!=="done"&&Ae(Te)})}var ue=_(oe,2);{var _e=Ae=>{var je=m_(),P=m(je),me=m(P),xe=m(me),Me=_(P,2),Xe=m(Me),Je=m(Xe),it=_(Me,2);{var At=He=>{var Ve=h_(),$e=m(Ve),et=m($e);ee(Ke=>U(et,`~${Ke??""}`),[()=>o(v(w))]),E(He,Ve)};re(it,He=>{v(w)&&He(At)})}ee(He=>{U(xe,He),U(Je,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),E(Ae,je)};re(ue,Ae=>{r().live&&r().phase==="generating"&&Ae(_e)})}var ke=_(ue,2);{var ae=Ae=>{var je=w_(),P=m(je),me=m(P),xe=_(P,2);{var Me=He=>{var Ve=g_(),$e=m(Ve);ee(()=>U($e,r().result.summary)),E(He,Ve)};re(xe,He=>{r().result.summary&&He(Me)})}var Xe=_(xe,2);{var Je=He=>{var Ve=y_();Kt(Ve,21,()=>r().result.tags,gn,($e,et)=>{var Ke=__(),We=m(Ke);ee(()=>U(We,v(et))),E($e,Ke)}),E(He,Ve)};re(Xe,He=>{var Ve;(Ve=r().result.tags)!=null&&Ve.length&&He(Je)})}var it=_(Xe,2);{var At=He=>{var Ve=b_(),$e=m(Ve),et=_($e,2),Ke=_(et,2);ee((We,Ct)=>{U($e,`${We??""} `),U(et,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),U(Ke,` ${Ct??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),E(He,Ve)};re(it,He=>{r().emailStats&&He(At)})}ee(()=>U(me,r().result.action)),E(Ae,je)};re(ke,Ae=>{r().result&&Ae(ae)})}var pe=_(ke,2);{var ve=Ae=>{var je=D_(),P=_(m(je),2),me=m(P),xe=m(me),Me=m(xe),Xe=_(me,2);{var Je=ut=>{var Ye=k_(),Ut=m(Ye),Vt=m(Ut);ee(()=>U(Vt,r().summary.skipped)),E(ut,Ye)};re(Xe,ut=>{var Ye;(Ye=r().summary)!=null&&Ye.skipped&&ut(Je)})}var it=_(Xe,2),At=m(it),He=m(At),Ve=_(it,2);{var $e=ut=>{var Ye=x_(),Ut=m(Ye),Vt=m(Ut);ee(()=>U(Vt,r().errors)),E(ut,Ye)};re(Ve,ut=>{r().errors>0&&ut($e)})}var et=_(P,2),Ke=_(m(et),2),We=m(Ke);{var Ct=ut=>{var Ye=S_(),Ut=Qe(Ye),Vt=_(m(Ut)),fn=m(Vt);ee(()=>U(fn,`${r().summary.avgTps??""} tok/s`)),E(ut,Ye)};re(We,ut=>{var Ye;(Ye=r().summary)!=null&&Ye.avgTps&&ut(Ct)})}var mt=_(We,2),ht=_(m(mt)),xt=m(ht),dn=_(mt,4),sn=_(m(dn)),bn=m(sn),Zt=_(et,2),Wt=_(m(Zt),2),Ht=m(Wt),wn=_(m(Ht)),jt=m(wn),Ne=_(wn),zn=_(Ht,4),Pn=_(m(zn)),Nr=m(Pn),Ie=_(zn,4),cr=_(m(Ie)),Ea=m(cr),Zn=_(Zt,2);{var Aa=ut=>{var Ye=M_(),Ut=m(Ye),Vt=m(Ut),fn=_(Ut,2);Kt(fn,21,()=>r().results,gn,(Jn,Pt)=>{var ft=R_();let It;var vn=m(ft),pn=m(vn),wr=m(pn),kr=_(pn,2);{var Jr=T=>{var he=T_(),we=m(he);ee(()=>U(we,v(Pt).classification.action)),E(T,he)},In=T=>{var he=E_();E(T,he)};re(kr,T=>{v(Pt).success?T(Jr):T(In,!1)})}var Gt=_(vn,2),kn=m(Gt),xr=_(kn);{var Ca=T=>{var he=A_(),we=_(Qe(he),1,!0);ee(at=>U(we,at),[()=>g(v(Pt).email.date)]),E(T,he)};re(xr,T=>{v(Pt).email.date&&T(Ca)})}var On=_(Gt,2);{var Pa=T=>{var he=I_(),we=Qe(he);{var at=Jt=>{var yt=C_(),Sr=m(yt);ee(()=>U(Sr,v(Pt).classification.summary)),E(Jt,yt)};re(we,Jt=>{v(Pt).classification.summary&&Jt(at)})}var St=_(we,2),Ot=m(St),Dt=_(Ot,2),on=_(Dt);{var Fn=Jt=>{var yt=P_(),Sr=_(Qe(yt));ee(Tr=>U(Sr,` ${Tr??""} tok/s`),[()=>v(Pt).stats.tps.toFixed(0)]),E(Jt,yt)};re(on,Jt=>{v(Pt).stats.tps&&Jt(Fn)})}ee(Jt=>{U(Ot,`${v(Pt).stats.inputTokens??""} in + ${v(Pt).stats.numTokens??""} out tokens `),U(Dt,` ${Jt??""} `)},[()=>o(v(Pt).stats.elapsed)]),E(T,he)},Fe=T=>{var he=O_(),we=_(m(he),2),at=m(we);ee(()=>U(at,v(Pt).error)),E(T,he)};re(On,T=>{v(Pt).success?T(Pa):T(Fe,!1)})}ee(T=>{It=Mt(ft,1,"result-item svelte-t1ig66",null,It,{failed:!v(Pt).success}),U(wr,v(Pt).email.subject||"(no subject)"),U(kn,`${T??""} `)},[()=>d(v(Pt).email.from)]),E(Jn,ft)}),ee(()=>U(Vt,`View ${r().results.length??""} email results`)),E(ut,Ye)};re(Zn,ut=>{var Ye;((Ye=r().results)==null?void 0:Ye.length)>0&&ut(Aa)})}ee((ut,Ye,Ut,Vt,fn,Jn,Pt)=>{var ft,It;U(Me,((ft=r().summary)==null?void 0:ft.processed)||r().total||0),U(He,r().classified||0),U(xt,`${ut??""} in + ${Ye??""} out`),U(bn,Ut),U(jt,((It=r().summary)==null?void 0:It.modelName)||"Unknown"),U(Ne,` (${Vt??""}k context, ~${fn??""}k email limit)`),U(Nr,`${Jn??""} chars`),U(Ea,`${Pt??""} chars`)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed),()=>{var ut;return Math.round((((ut=r().summary)==null?void 0:ut.modelContextWindow)||0)/1024)},()=>{var ut;return Math.round((((ut=r().summary)==null?void 0:ut.modelMaxEmailTokens)||0)/1e3)},()=>{var ut;return u(((ut=r().summary)==null?void 0:ut.systemPromptSize)||0)},()=>{var ut;return u(((ut=r().summary)==null?void 0:ut.avgPromptSize)||0)}]),E(Ae,je)},se=Ae=>{var je=yr(),P=Qe(je);{var me=xe=>{var Me=L_(),Xe=m(Me),Je=m(Xe),it=_(Xe,2);{var At=Ke=>{var We=j_(),Ct=m(We);ee(()=>U(Ct,`${r().errors??""} errors`)),E(Ke,We)};re(it,Ke=>{r().errors&&Ke(At)})}var He=_(it,4),Ve=m(He),$e=_(He,4),et=m($e);ee((Ke,We,Ct)=>{U(Je,`${(r().classified||0)??""} classified`),U(Ve,`${Ke??""} in + ${We??""} out tokens`),U(et,Ct)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),E(xe,Me)};re(P,xe=>{r().totals&&xe(me)})}E(Ae,je)};re(pe,Ae=>{r().phase==="done"?Ae(ve):Ae(se,!1)})}var J=_(pe,2),F=m(J);{var K=Ae=>{var je=N_();je.__click=()=>I(a,!0),E(Ae,je)},$=Ae=>{var je=q_(),P=Qe(je);P.__click=()=>I(a,!0);var me=_(P,2);me.__click=function(...xe){var Me;(Me=e.onstop)==null||Me.apply(this,xe)},E(Ae,je)};re(F,Ae=>{r().phase==="done"?Ae(K):Ae($,!1)})}var Oe=_(Q,2);{var ze=Ae=>{var je=K_();je.__click=()=>I(a,!1),je.__keydown=mt=>mt.key==="Escape"&&I(a,!1);var P=m(je);P.__click=mt=>mt.stopPropagation();var me=m(P),xe=_(m(me),2);xe.__click=()=>I(a,!1);var Me=_(me,2),Xe=m(Me);let Je;Xe.__click=()=>I(i,"system");var it=_(Xe,2);let At;it.__click=()=>I(i,"email");var He=_(it,2);let Ve;He.__click=()=>I(i,"full");var $e=_(Me,2),et=m($e);{var Ke=mt=>{var ht=B_(),xt=Qe(ht),dn=m(xt),sn=_(xt,2),bn=m(sn);ee(()=>{U(dn,ca),U(bn,`${ca.length??""} chars`)}),E(mt,ht)},We=mt=>{var ht=z_(),xt=Qe(ht),dn=m(xt),sn=_(xt,2),bn=m(sn);ee(()=>{var Zt,Wt,Ht;U(dn,((Zt=r().prompt)==null?void 0:Zt.user)||"(no email prompt)"),U(bn,`${(((Ht=(Wt=r().prompt)==null?void 0:Wt.user)==null?void 0:Ht.length)||0)??""} chars`)}),E(mt,ht)},Ct=mt=>{var ht=F_(),xt=Qe(ht),dn=m(xt),sn=_(xt,2),bn=m(sn);ee(()=>{var Zt,Wt,Ht,wn,jt,Ne;U(dn,`${(((Zt=r().prompt)==null?void 0:Zt.system)||"")??""}

---

${(((Wt=r().prompt)==null?void 0:Wt.user)||"")??""}`),U(bn,`${(((wn=(Ht=r().prompt)==null?void 0:Ht.system)==null?void 0:wn.length)||0)+(((Ne=(jt=r().prompt)==null?void 0:jt.user)==null?void 0:Ne.length)||0)} chars total`)}),E(mt,ht)};re(et,mt=>{v(i)==="system"?mt(Ke):v(i)==="email"?mt(We,1):mt(Ct,!1)})}ee(()=>{Je=Mt(Xe,1,"mtab svelte-t1ig66",null,Je,{active:v(i)==="system"}),At=Mt(it,1,"mtab svelte-t1ig66",null,At,{active:v(i)==="email"}),Ve=Mt(He,1,"mtab svelte-t1ig66",null,Ve,{active:v(i)==="full"})}),E(Ae,je)};re(Oe,Ae=>{v(a)&&Ae(ze)})}ee(()=>{U(ce,`${v(b)??""}%`),fe=Mt(Ee,1,"bar-fill svelte-t1ig66",null,fe,{done:r().phase==="done"}),ne=Cn(Ee,"",ne,{width:`${v(b)??""}%`})}),E(C,A)};re(x,C=>{r()&&C(N)})}E(t,k),Et()}zt(["click","keydown"]);var W_=L('<span class="spinner svelte-ois7em"></span>'),H_=Qo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),V_=L('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),Y_=L("<option> </option>"),Q_=L('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),X_=L('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function Z_(t,e){Tt(e,!0);let r=De(e,"engineStatus",3,"idle"),a=De(e,"modelName",3,""),i=De(e,"isScanning",3,!1),o=De(e,"scanProgress",3,null),u=De(e,"scanCount",15,20),d=De(e,"stats",3,null);const g=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function b(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function w(){return r()==="ready"&&!i()}var k=X_(),x=m(k),N=m(x),C=m(N);{var A=J=>{var F=W_();E(J,F)},Q=J=>{var F=H_();E(J,F)};re(C,J=>{i()?J(A):J(Q,!1)})}var de=_(N,2),H=m(de),q=_(m(H),2);q.__click=function(...J){var F;(F=e.oninspect)==null||F.apply(this,J)};var X=_(H,2),te=m(X);let G;var ce=_(te),be=_(x,2);{var Ee=J=>{var F=V_(),K=m(F),$=m(K),Oe=_(K,4),ze=m(Oe),Ae=_(Oe,4),je=m(Ae);ee(()=>{U($,`${d().totalEmails??""} emails in storage`),U(ze,`${d().classified??""} classified`),U(je,`${d().unclassified??""} new`)}),E(J,F)};re(be,J=>{d()&&J(Ee)})}var fe=_(be,2),ne=m(fe),oe=_(m(ne),2);Kt(oe,21,()=>g,gn,(J,F)=>{var K=Y_(),$=m(K),Oe={};ee(()=>{U($,v(F).label),Oe!==(Oe=v(F).value)&&(K.value=(K.__value=v(F).value)??"")}),E(J,K)});var Te=_(ne,2),ue=m(Te);ue.__click=function(...J){var F;(F=e.onscan)==null||F.apply(this,J)};var _e=m(ue),ke=_(ue,2);ke.__click=function(...J){var F;(F=e.onrescan)==null||F.apply(this,J)};var ae=_(fe,2);{var pe=J=>{var F=Q_();E(J,F)};re(ae,J=>{r()!=="ready"&&r()!=="loading"&&J(pe)})}var ve=_(ae,2);{var se=J=>{G_(J,{get progress(){return o()},get onstop(){return e.onstop}})};re(ve,J=>{var F;(i()||((F=o())==null?void 0:F.phase)==="done")&&J(se)})}ee((J,F,K,$)=>{G=Cn(te,"",G,J),U(ce,` ${F??""}`),oe.disabled=i(),ue.disabled=K,U(_e,i()?"Scanning...":"Scan New"),ke.disabled=$},[()=>({background:b()}),p,()=>!w(),()=>!w()]),xi(oe,u),E(t,k),Et()}zt(["click"]);var J_=L('<span class="row-date svelte-1czytqk"> </span>'),$_=L('<span class="tag svelte-1czytqk"> </span>'),ey=L('<span class="row-tags svelte-1czytqk"></span>'),ty=L('<span class="row-reason svelte-1czytqk"> </span>'),ny=L('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),ry=L('<span class="status-label svelte-1czytqk"> </span>'),ay=L('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),sy=L('<p class="summary-reason svelte-1czytqk"> </p>'),iy=L('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),oy=L('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function Pc(t,e){Tt(e,!0);let r=De(e,"actionColor",3,"#666"),a=De(e,"dimmed",3,!1);function i(ue){if(!ue)return"";try{return new Date(ue).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=bt(()=>e.item.status==="pending"),u=Re(!1);var d=oy(),g=Qe(d);let p;var b=m(g);b.__click=()=>I(u,!v(u));let w;var k=m(b),x=m(k),N=_(k,2),C=m(N),A=m(C),Q=_(C,2);{var de=ue=>{var _e=J_(),ke=m(_e);ee(ae=>U(ke,ae),[()=>i(e.item.date)]),E(ue,_e)};re(Q,ue=>{e.item.date&&ue(de)})}var H=_(N,2);{var q=ue=>{var _e=ey();Kt(_e,21,()=>e.item.tags,gn,(ke,ae)=>{var pe=$_();let ve;var se=m(pe);ee(J=>{ve=Cn(pe,"",ve,J),U(se,v(ae))},[()=>({background:ep(v(ae))})]),E(ke,pe)}),E(ue,_e)};re(H,ue=>{e.item.tags&&e.item.tags.length>0&&ue(q)})}var X=_(H,2);{var te=ue=>{var _e=ty(),ke=m(_e);ee(()=>U(ke,e.item.reason)),E(ue,_e)};re(X,ue=>{e.item.reason&&!v(u)&&ue(te)})}var G=_(b,2),ce=m(G);{var be=ue=>{var _e=ny(),ke=Qe(_e);ke.__click=()=>e.onmarkacted(e.item.emailId);var ae=_(ke,2);ae.__click=()=>e.ondismiss(e.item.emailId),E(ue,_e)},Ee=ue=>{var _e=ry(),ke=m(_e);ee(()=>U(ke,e.item.status)),E(ue,_e)};re(ce,ue=>{v(o)?ue(be):ue(Ee,!1)})}var fe=_(ce,2);{var ne=ue=>{var _e=ay();_e.__click=()=>e.onremove(e.item.emailId),E(ue,_e)};re(fe,ue=>{e.onremove&&ue(ne)})}var oe=_(g,2);{var Te=ue=>{var _e=iy();let ke;var ae=m(_e),pe=m(ae),ve=_(ae,2);{var se=J=>{var F=sy(),K=m(F);ee(()=>U(K,e.item.reason)),E(J,F)};re(ve,J=>{e.item.reason&&J(se)})}ee(()=>{ke=Cn(_e,"",ke,{"border-left-color":r()}),U(pe,e.item.summary)}),E(ue,_e)};re(oe,ue=>{v(u)&&e.item.summary&&ue(Te)})}ee(()=>{p=Mt(g,1,"email-row svelte-1czytqk",null,p,{dimmed:a()}),w=Cn(b,"",w,{"border-left-color":r()}),U(x,e.item.subject),U(A,e.item.from)}),E(t,d),Et()}zt(["click"]);var ly=L('<span class="group-acted svelte-tl1unp"> </span>'),cy=L('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),uy=L('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),dy=L('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),fy=L('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),vy=L('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),py=L('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function hy(t,e){Tt(e,!0);let r=De(e,"color",3,"#888");De(e,"count",3,0);let a=De(e,"items",19,()=>[]),i=De(e,"expanded",3,!1),o=bt(()=>a().filter(te=>te.status==="pending")),u=bt(()=>a().filter(te=>te.status!=="pending")),d=Re(!1);function g(te){return te.split("_").map(G=>G.charAt(0)+G.slice(1).toLowerCase()).join(" ")}var p=py(),b=m(p);b.__click=function(...te){var G;(G=e.ontoggle)==null||G.apply(this,te)};var w=m(b);let k;var x=m(w),N=_(w,2),C=m(N),A=_(N,2);{var Q=te=>{var G=ly(),ce=m(G);ee(()=>U(ce,`${v(u).length??""} handled`)),E(te,G)};re(A,te=>{v(u).length>0&&te(Q)})}var de=_(A,4);let H;var q=_(b,2);{var X=te=>{var G=vy(),ce=m(G);{var be=ke=>{var ae=cy();E(ke,ae)};re(ce,ke=>{v(o).length===0&&v(u).length===0&&ke(be)})}var Ee=_(ce,2);Kt(Ee,17,()=>v(o),ke=>ke.emailId,(ke,ae)=>{Pc(ke,{get item(){return v(ae)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var fe=_(Ee,2);{var ne=ke=>{var ae=uy(),pe=m(ae),ve=m(pe),se=_(pe,2);Kt(se,17,()=>v(u),J=>J.emailId,(J,F)=>{Pc(J,{get item(){return v(F)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ee(()=>U(ve,`${v(u).length??""} handled`)),E(ke,ae)};re(fe,ke=>{v(u).length>0&&ke(ne)})}var oe=_(fe,2),Te=m(oe);{var ue=ke=>{var ae=dy();ae.__click=()=>I(d,!0),E(ke,ae)},_e=ke=>{var ae=fy(),pe=m(ae),ve=_(pe);ve.__click=()=>I(d,!1);var se=_(ve,2);se.__click=()=>{e.oncleargroup(),I(d,!1)},ee(()=>U(pe,`Clear ${a().length??""} items? `)),E(ke,ae)};re(Te,ke=>{v(d)?ke(_e,!1):ke(ue)})}E(te,G)};re(q,te=>{i()&&te(X)})}ee(te=>{k=Cn(w,"",k,{background:r()}),U(x,te),U(C,v(o).length),H=Mt(de,0,"chevron svelte-tl1unp",null,H,{open:i()})},[()=>g(e.action)]),E(t,p),Et()}zt(["click"]);var my=L(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),gy=L(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),_y=L(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),yy=L('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function by(t,e){Tt(e,!0);let r=De(e,"open",15,!1),a=De(e,"sampleEmail",3,null),i=Re("system");function o(){return a()?Uu(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(w){w.target===w.currentTarget&&u()}var g=yr(),p=Qe(g);{var b=w=>{var k=yy();k.__click=d,k.__keydown=ne=>ne.key==="Escape"&&u();var x=m(k),N=m(x),C=_(m(N),2);C.__click=u;var A=_(N,2),Q=m(A);let de;Q.__click=()=>I(i,"system");var H=_(Q,2);let q;H.__click=()=>I(i,"email");var X=_(H,2);let te;X.__click=()=>I(i,"config");var G=_(A,2),ce=m(G);{var be=ne=>{var oe=my(),Te=_(Qe(oe),2),ue=m(Te);ee(()=>U(ue,ca)),E(ne,oe)},Ee=ne=>{var oe=gy(),Te=_(Qe(oe),2),ue=_(m(Te),2);ue.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var _e=_(Te,2),ke=_(m(_e),2),ae=m(ke);ee(pe=>U(ae,pe),[o]),E(ne,oe)},fe=ne=>{var oe=_y(),Te=_(Qe(oe),2),ue=m(Te),_e=_(m(ue),2),ke=m(_e),ae=_(ue,2),pe=_(m(ae),2),ve=m(pe),se=_(ae,2),J=_(m(se),2),F=m(J),K=_(Te,4);K.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,ee(()=>{U(ke,Qv.maxTokens),U(ve,"false"),U(F,"false")}),E(ne,oe)};re(ce,ne=>{v(i)==="system"?ne(be):v(i)==="email"?ne(Ee,1):v(i)==="config"&&ne(fe,2)})}ee(()=>{de=Mt(Q,1,"tab svelte-10pcy9j",null,de,{active:v(i)==="system"}),q=Mt(H,1,"tab svelte-10pcy9j",null,q,{active:v(i)==="email"}),te=Mt(X,1,"tab svelte-10pcy9j",null,te,{active:v(i)==="config"})}),E(w,k)};re(p,w=>{r()&&w(b)})}E(t,g),Et()}zt(["click","keydown"]);var wy=L('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),ky=L('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),xy=L('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),Sy=L('<button class="chip svelte-s2dwjj"> </button>'),Ty=L('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),Ey=L('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Ay=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),Cy=L('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Py=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),Iy=L('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Oy=L('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),Ry=L('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),My=L('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),Dy=L('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),jy=L('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),Ly=L('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Ny(t,e){Tt(e,!0);let r=De(e,"groupOrder",19,()=>[]),a=Re(!1),i=Re(null),o=Re(!1),u=Re(null);async function d(){var fe;const[G,ce,be]=await Promise.all([Ue.items.where("sourceType").equals("gmail").count(),Ue.emailClassifications.count(),Ue.contacts.count()]);let Ee=0;try{const ne=await((fe=navigator.storage)==null?void 0:fe.estimate());Ee=(ne==null?void 0:ne.usage)??0}catch{}I(u,{emailCount:G,classCount:ce,contactCount:be,totalBytes:Ee},!0)}function g(G){return G?G<1024?`${G} B`:G<1024*1024?`${(G/1024).toFixed(1)} KB`:`${(G/(1024*1024)).toFixed(1)} MB`:"â"}function p(){I(a,!v(a)),v(a)&&d()}async function b(G){var ce;I(o,!0),I(i,null);try{await G(),await d(),(ce=e.onrefresh)==null||ce.call(e)}finally{I(o,!1)}}async function w(){await b(()=>oc())}async function k(G){await b(()=>el(G))}async function x(){await b(async()=>{await Vu(),await oc()})}async function N(){await b(()=>Ue.contacts.clear())}async function C(){await b(async()=>{await Ue.delete(),window.location.reload()})}function A(G){return G.split("_").map(ce=>ce.charAt(0)+ce.slice(1).toLowerCase()).join(" ")}var Q=Ly(),de=m(Q);de.__click=p;var H=_(m(de),2);let q;var X=_(de,2);{var te=G=>{var ce=jy(),be=m(ce);{var Ee=P=>{var me=ky(),xe=m(me),Me=m(xe),Xe=_(xe,4),Je=m(Xe),it=_(Xe,4),At=m(it),He=_(it,2);{var Ve=$e=>{var et=wy(),Ke=_(Qe(et),2),We=m(Ke);ee(Ct=>U(We,`${Ct??""} used`),[()=>g(v(u).totalBytes)]),E($e,et)};re(He,$e=>{v(u).totalBytes&&$e(Ve)})}ee(()=>{U(Me,`${v(u).emailCount??""} emails`),U(Je,`${v(u).classCount??""} classifications`),U(At,`${v(u).contactCount??""} contacts`)}),E(P,me)};re(be,P=>{v(u)&&P(Ee)})}var fe=_(be,2);{var ne=P=>{var me=Ty(),xe=_(m(me),2);Kt(xe,21,r,gn,(Me,Xe)=>{var Je=yr(),it=Qe(Je);{var At=Ve=>{var $e=xy(),et=m($e),Ke=_(et);Ke.__click=()=>I(i,null);var We=_(Ke,2);We.__click=()=>k(v(Xe)),ee(Ct=>{U(et,`Delete ${Ct??""}? `),We.disabled=v(o)},[()=>A(v(Xe))]),E(Ve,$e)},He=Ve=>{var $e=Sy();$e.__click=()=>I(i,`group:${v(Xe)}`);var et=m($e);ee(Ke=>{$e.disabled=v(o),U(et,`${Ke??""} â`)},[()=>A(v(Xe))]),E(Ve,$e)};re(it,Ve=>{v(i)===`group:${v(Xe)}`?Ve(At):Ve(He,!1)})}E(Me,Je)}),E(P,me)};re(fe,P=>{r().length>0&&P(ne)})}var oe=_(fe,2),Te=_(m(oe),2),ue=m(Te);{var _e=P=>{var me=Ey(),xe=_(m(me),2);xe.__click=()=>I(i,null);var Me=_(xe,2);Me.__click=w,ee(()=>Me.disabled=v(o)),E(P,me)},ke=P=>{var me=Ay();me.__click=()=>I(i,"classifications"),ee(()=>me.disabled=v(o)),E(P,me)};re(ue,P=>{v(i)==="classifications"?P(_e):P(ke,!1)})}var ae=_(ue,2);{var pe=P=>{var me=Cy(),xe=_(m(me),2);xe.__click=()=>I(i,null);var Me=_(xe,2);Me.__click=x,ee(()=>Me.disabled=v(o)),E(P,me)},ve=P=>{var me=Py();me.__click=()=>I(i,"emails"),ee(()=>me.disabled=v(o)),E(P,me)};re(ae,P=>{v(i)==="emails"?P(pe):P(ve,!1)})}var se=_(ae,2);{var J=P=>{var me=Iy(),xe=_(m(me),2);xe.__click=()=>I(i,null);var Me=_(xe,2);Me.__click=N,ee(()=>Me.disabled=v(o)),E(P,me)},F=P=>{var me=Oy();me.__click=()=>I(i,"contacts"),ee(()=>me.disabled=v(o)),E(P,me)};re(se,P=>{v(i)==="contacts"?P(J):P(F,!1)})}var K=_(oe,2),$=m(K);{var Oe=P=>{var me=Ry(),xe=_(m(me),2);xe.__click=()=>I(i,null);var Me=_(xe,2);Me.__click=C,ee(()=>Me.disabled=v(o)),E(P,me)},ze=P=>{var me=My();me.__click=()=>I(i,"nuke"),ee(()=>me.disabled=v(o)),E(P,me)};re($,P=>{v(i)==="nuke"?P(Oe):P(ze,!1)})}var Ae=_(K,2);{var je=P=>{var me=Dy();E(P,me)};re(Ae,P=>{v(o)&&P(je)})}E(G,ce)};re(X,G=>{v(a)&&G(te)})}ee(()=>q=Mt(H,0,"chev svelte-s2dwjj",null,q,{open:v(a)})),E(t,Q),Et()}zt(["click"]);var qy=L('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),By=L('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),zy=L('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Fy=L('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function Ky(t,e){Tt(e,!0);let r=De(e,"groups",19,()=>({})),a=De(e,"groupOrder",19,()=>[]),i=De(e,"counts",19,()=>({})),o=De(e,"stats",3,null),u=De(e,"expandedGroup",3,null),d=De(e,"isScanning",3,!1),g=De(e,"scanProgress",3,null),p=De(e,"scanCount",15,20),b=De(e,"error",3,null),w=Re(!1),k=bt(()=>{for(const te of a()){const G=r()[te];if((G==null?void 0:G.length)>0)return G[0]}return null});var x=Fy(),N=m(x);Z_(N,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return g()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>I(w,!0),get scanCount(){return p()},set scanCount(te){p(te)}});var C=_(N,2);by(C,{get sampleEmail(){return v(k)},get open(){return v(w)},set open(te){I(w,te,!0)}});var A=_(C,2);{var Q=te=>{var G=qy(),ce=m(G),be=m(ce),Ee=_(ce,2);Ee.__click=function(...fe){var ne;(ne=e.ondismisserror)==null||ne.apply(this,fe)},ee(()=>U(be,b())),E(te,G)};re(A,te=>{b()&&te(Q)})}var de=_(A,2);{var H=te=>{var G=By(),ce=Qe(G);Kt(ce,20,a,ne=>ne,(ne,oe)=>{{let Te=bt(()=>Co(oe)),ue=bt(()=>{var ae;return((ae=r()[oe])==null?void 0:ae.length)||0}),_e=bt(()=>r()[oe]||[]),ke=bt(()=>u()===oe);hy(ne,{get action(){return oe},get color(){return v(Te)},get count(){return v(ue)},get items(){return v(_e)},get expanded(){return v(ke)},ontoggle:()=>e.ontogglegroup(oe),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(oe)})}});var be=_(ce,2),Ee=m(be),fe=m(Ee);ee(()=>U(fe,`${i().total??""} emails classified into ${a().length??""} groups`)),E(te,G)},q=te=>{var G=zy();E(te,G)};re(de,te=>{i().total>0?te(H):d()||te(q,1)})}var X=_(de,2);Ny(X,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),E(t,x),Et()}zt(["click"]);var Uy=L('<div class="actions-page svelte-3tch4q"><!></div>');function Gy(t,e){Tt(e,!0);const r=Pu();let a=Re(Ft(r.status)),i=Re(""),o=Re(Ft({})),u=Re(Ft([])),d=Re(Ft({total:0})),g=Re(null),p=Re(null),b=Re(!1),w=Re(null),k=Re(20),x=Re(null),N=Re(null);an(()=>{const fe=r.onMessage(ne=>{if(ne.status==="ready"){I(a,"ready");const oe=gr.find(Te=>Te.id===r.modelId);I(i,(oe==null?void 0:oe.name)||r.modelId||"",!0)}ne.status==="loading"&&I(a,"loading")});if(I(a,r.status,!0),r.modelId){const ne=gr.find(oe=>oe.id===r.modelId);I(i,(ne==null?void 0:ne.name)||r.modelId||"",!0)}return C(),()=>fe()});async function C(){try{const fe=await Xv();I(o,fe.groups,!0),I(u,fe.order,!0),I(d,await Zv(),!0),I(g,await Ao(),!0)}catch(fe){I(x,`Failed to load data: ${fe.message}`)}}async function A(){await de(!1)}async function Q(){await de(!0)}async function de(fe){if(v(b)||!r.isReady)return;I(x,null),I(b,!0),I(w,null);const ne=new AbortController;I(N,ne,!0);try{await Fu(r,{count:v(k),force:fe,signal:ne.signal,onProgress:oe=>{I(w,{...oe},!0)}}),await C()}catch(oe){ne.signal.aborted||I(x,`Scan failed: ${oe.message}`)}finally{I(b,!1),I(N,null)}}function H(){var fe;(fe=v(N))==null||fe.abort()}async function q(fe){await vi(fe,"acted"),await C()}async function X(fe){await vi(fe,"dismissed"),await C()}async function te(fe){await Ku(fe),await C()}async function G(fe){await el(fe),await C()}function ce(fe){I(p,v(p)===fe?null:fe,!0)}var be=Uy(),Ee=m(be);Ky(Ee,{get engineStatus(){return v(a)},get modelName(){return v(i)},get groups(){return v(o)},get groupOrder(){return v(u)},get counts(){return v(d)},get stats(){return v(g)},get expandedGroup(){return v(p)},get isScanning(){return v(b)},get scanProgress(){return v(w)},get error(){return v(x)},onscan:A,onrescan:Q,ontogglegroup:ce,onmarkacted:q,ondismiss:X,onremove:te,oncleargroup:G,ondismisserror:()=>I(x,null),onstop:H,onrefresh:C,get scanCount(){return v(k)},set scanCount(fe){I(k,fe,!0)}}),E(t,be),Et()}var Wy=L('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Hy(t,e){Tt(e,!0);function r(){const G=location.hash;return G==="#dashboard"?"dashboard":G==="#actions"?"actions":"chat"}let a=Re(Ft(r()));an(()=>{function G(){I(a,r(),!0)}return window.addEventListener("hashchange",G),()=>window.removeEventListener("hashchange",G)});var i=Wy(),o=m(i),u=_(m(o),2),d=m(u);let g;var p=_(d,2);let b;var w=_(p,2);let k;var x=_(o,2),N=m(x);let C;var A=m(N);Rh(A,{});var Q=_(N,2);let de;var H=m(Q);Gy(H,{});var q=_(Q,2);let X;var te=m(q);f_(te,{}),ee(()=>{g=Mt(d,1,"svelte-1n46o8q",null,g,{active:v(a)==="chat"}),b=Mt(p,1,"svelte-1n46o8q",null,b,{active:v(a)==="actions"}),k=Mt(w,1,"svelte-1n46o8q",null,k,{active:v(a)==="dashboard"}),C=Cn(N,"",C,{display:v(a)==="chat"?"flex":"none"}),de=Cn(Q,"",de,{display:v(a)==="actions"?"flex":"none"}),X=Cn(q,"",X,{display:v(a)==="dashboard"?"flex":"none"})}),E(t,i),Et()}Jf(Hy,{target:document.getElementById("app")});
