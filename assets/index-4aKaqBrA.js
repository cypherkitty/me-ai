var Sf=Object.defineProperty;var Cl=t=>{throw TypeError(t)};var Tf=(t,e,r)=>e in t?Sf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var $e=(t,e,r)=>Tf(t,typeof e!="symbol"?e+"":e,r),Ki=(t,e,r)=>e.has(t)||Cl("Cannot "+r);var ne=(t,e,r)=>(Ki(t,e,"read from private field"),r?r.call(t):e.get(t)),et=(t,e,r)=>e.has(t)?Cl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Qe=(t,e,r,a)=>(Ki(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),ln=(t,e,r)=>(Ki(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const to=!1;var Eo=Array.isArray,Ef=Array.prototype.indexOf,Na=Array.prototype.includes,fi=Array.from,Af=Object.defineProperty,Pa=Object.getOwnPropertyDescriptor,Cf=Object.getOwnPropertyDescriptors,Pf=Object.prototype,If=Array.prototype,bc=Object.getPrototypeOf,Pl=Object.isExtensible;const Rf=()=>{};function Of(t){for(var e=0;e<t.length;e++)t[e]()}function wc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const en=2,ps=4,di=8,kc=1<<24,Rr=16,sr=32,_a=64,xc=128,Gn=512,Wt=1024,tn=2048,ar=4096,jn=8192,Cr=16384,ws=32768,qa=65536,Il=1<<17,Sc=1<<18,Ua=1<<19,Df=1<<20,Ar=1<<25,va=65536,no=1<<21,Ao=1<<22,Fr=1<<23,ua=Symbol("$state"),jf=Symbol("legacy props"),Mf=Symbol(""),ea=new class extends Error{constructor(){super(...arguments);$e(this,"name","StaleReactionError");$e(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Lf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Nf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function qf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Bf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ff(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Kf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Uf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Gf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Hf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Wf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Vf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Yf=1,Xf=2,Tc=4,Qf=8,Zf=16,Jf=1,$f=4,ed=8,td=16,Ec=1,nd=2,Qt=Symbol(),Ac="http://www.w3.org/1999/xhtml";function rd(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ad(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Cc(t){return t===this.v}function sd(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Pc(t){return!sd(t,this.v)}let id=!1,Mn=null;function Ba(t){Mn=t}function Ct(t,e=!1,r){Mn={p:Mn,i:!1,c:null,e:null,s:t,x:null,l:null}}function Pt(t){var e=Mn,r=e.e;if(r!==null){e.e=null;for(var a of r)Zc(a)}return t!==void 0&&(e.x=t),e.i=!0,Mn=e.p,t??{}}function Ic(){return!0}let ta=[];function Rc(){var t=ta;ta=[],Of(t)}function Kr(t){if(ta.length===0&&!cs){var e=ta;queueMicrotask(()=>{e===ta&&Rc()})}ta.push(t)}function od(){for(;ta.length>0;)Rc()}function Oc(t){var e=gt;if(e===null)return tt.f|=Fr,t;if((e.f&ws)===0&&(e.f&ps)===0)throw t;za(t,e)}function za(t,e){for(;e!==null;){if((e.f&xc)!==0){if((e.f&ws)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const ld=-7169;function Nt(t,e){t.f=t.f&ld|e}function Co(t){(t.f&Gn)!==0||t.deps===null?Nt(t,Wt):Nt(t,ar)}function Dc(t){if(t!==null)for(const e of t)(e.f&en)===0||(e.f&va)===0||(e.f^=va,Dc(e.deps))}function jc(t,e,r){(t.f&tn)!==0?e.add(t):(t.f&ar)!==0&&r.add(t),Dc(t.deps),Nt(t,Wt)}const Fs=new Set;let We=null,ti=null,Zt=null,xn=[],vi=null,ro=!1,cs=!1;var Ia,Ra,aa,Oa,gs,_s,sa,xr,Da,hr,ao,so,Mc;const el=class el{constructor(){et(this,hr);$e(this,"committed",!1);$e(this,"current",new Map);$e(this,"previous",new Map);et(this,Ia,new Set);et(this,Ra,new Set);et(this,aa,0);et(this,Oa,0);et(this,gs,null);et(this,_s,new Set);et(this,sa,new Set);et(this,xr,new Map);$e(this,"is_fork",!1);et(this,Da,!1)}is_deferred(){return this.is_fork||ne(this,Oa)>0}skip_effect(e){ne(this,xr).has(e)||ne(this,xr).set(e,{d:[],m:[]})}unskip_effect(e){var r=ne(this,xr).get(e);if(r){ne(this,xr).delete(e);for(var a of r.d)Nt(a,tn),nr(a);for(a of r.m)Nt(a,ar),nr(a)}}process(e){var i;xn=[],this.apply();var r=[],a=[];for(const o of e)ln(this,hr,ao).call(this,o,r,a);if(this.is_deferred()){ln(this,hr,so).call(this,a),ln(this,hr,so).call(this,r);for(const[o,u]of ne(this,xr))Bc(o,u)}else{for(const o of ne(this,Ia))o();ne(this,Ia).clear(),ne(this,aa)===0&&ln(this,hr,Mc).call(this),ti=this,We=null,Rl(a),Rl(r),ti=null,(i=ne(this,gs))==null||i.resolve()}Zt=null}capture(e,r){r!==Qt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Fr)===0&&(this.current.set(e,e.v),Zt==null||Zt.set(e,e.v))}activate(){We=this,this.apply()}deactivate(){We===this&&(We=null,Zt=null)}flush(){if(this.activate(),xn.length>0){if(Lc(),We!==null&&We!==this)return}else ne(this,aa)===0&&this.process([]);this.deactivate()}discard(){for(const e of ne(this,Ra))e(this);ne(this,Ra).clear()}increment(e){Qe(this,aa,ne(this,aa)+1),e&&Qe(this,Oa,ne(this,Oa)+1)}decrement(e){Qe(this,aa,ne(this,aa)-1),e&&Qe(this,Oa,ne(this,Oa)-1),!ne(this,Da)&&(Qe(this,Da,!0),Kr(()=>{Qe(this,Da,!1),this.is_deferred()?xn.length>0&&this.flush():this.revive()}))}revive(){for(const e of ne(this,_s))ne(this,sa).delete(e),Nt(e,tn),nr(e);for(const e of ne(this,sa))Nt(e,ar),nr(e);this.flush()}oncommit(e){ne(this,Ia).add(e)}ondiscard(e){ne(this,Ra).add(e)}settled(){return(ne(this,gs)??Qe(this,gs,wc())).promise}static ensure(){if(We===null){const e=We=new el;Fs.add(We),cs||Kr(()=>{We===e&&e.flush()})}return We}apply(){}};Ia=new WeakMap,Ra=new WeakMap,aa=new WeakMap,Oa=new WeakMap,gs=new WeakMap,_s=new WeakMap,sa=new WeakMap,xr=new WeakMap,Da=new WeakMap,hr=new WeakSet,ao=function(e,r,a){e.f^=Wt;for(var i=e.first,o=null;i!==null;){var u=i.f,f=(u&(sr|_a))!==0,h=f&&(u&Wt)!==0,v=h||(u&jn)!==0||ne(this,xr).has(i);if(!v&&i.fn!==null){f?i.f^=Wt:o!==null&&(u&(ps|di|kc))!==0?o.b.defer_effect(i):(u&ps)!==0?r.push(i):xs(i)&&((u&Rr)!==0&&ne(this,sa).add(i),Ka(i));var y=i.first;if(y!==null){i=y;continue}}var S=i.parent;for(i=i.next;i===null&&S!==null;)S===o&&(o=null),i=S.next,S=S.parent}},so=function(e){for(var r=0;r<e.length;r+=1)jc(e[r],ne(this,_s),ne(this,sa))},Mc=function(){var i;if(Fs.size>1){this.previous.clear();var e=Zt,r=!0;for(const o of Fs){if(o===this){r=!1;continue}const u=[];for(const[h,v]of this.current){if(o.current.has(h))if(r&&v!==o.current.get(h))o.current.set(h,v);else continue;u.push(h)}if(u.length===0)continue;const f=[...o.current.keys()].filter(h=>!this.current.has(h));if(f.length>0){var a=xn;xn=[];const h=new Set,v=new Map;for(const y of u)Nc(y,f,h,v);if(xn.length>0){We=o,o.apply();for(const y of xn)ln(i=o,hr,ao).call(i,y,[],[]);o.deactivate()}xn=a}}We=null,Zt=e}this.committed=!0,Fs.delete(this)};let Ur=el;function cd(t){var e=cs;cs=!0;try{for(var r;;){if(od(),xn.length===0&&(We==null||We.flush(),xn.length===0))return vi=null,r;Lc()}}finally{cs=e}}function Lc(){ro=!0;var t=null;try{for(var e=0;xn.length>0;){var r=Ur.ensure();if(e++>1e3){var a,i;ud()}r.process(xn),Gr.clear()}}finally{xn=[],ro=!1,vi=null}}function ud(){try{Kf()}catch(t){za(t,vi)}}let Zn=null;function Rl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(Cr|jn))===0&&xs(a)&&(Zn=new Set,Ka(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&tu(a),(Zn==null?void 0:Zn.size)>0)){Gr.clear();for(const i of Zn){if((i.f&(Cr|jn))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)Zn.has(u)&&(Zn.delete(u),o.push(u)),u=u.parent;for(let f=o.length-1;f>=0;f--){const h=o[f];(h.f&(Cr|jn))===0&&Ka(h)}}Zn.clear()}}Zn=null}}function Nc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&en)!==0?Nc(i,e,r,a):(o&(Ao|Rr))!==0&&(o&tn)===0&&qc(i,e,a)&&(Nt(i,tn),nr(i))}}function qc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Na.call(e,i))return!0;if((i.f&en)!==0&&qc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function nr(t){for(var e=vi=t;e.parent!==null;){e=e.parent;var r=e.f;if(ro&&e===gt&&(r&Rr)!==0&&(r&Sc)===0)return;if((r&(_a|sr))!==0){if((r&Wt)===0)return;e.f^=Wt}}xn.push(e)}function Bc(t,e){if(!((t.f&sr)!==0&&(t.f&Wt)!==0)){(t.f&tn)!==0?e.d.push(t):(t.f&ar)!==0&&e.m.push(t),Nt(t,Wt);for(var r=t.first;r!==null;)Bc(r,e),r=r.next}}function fd(t){let e=0,r=pa(0),a;return()=>{Ro()&&(g(r),Oo(()=>(e===0&&(a=Ss(()=>t(()=>us(r)))),e+=1,()=>{Kr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,us(r))})})))}}var dd=qa|Ua|xc;function vd(t,e,r){new pd(t,e,r)}var Fn,To,ur,ia,fr,Kn,wn,dr,Sr,Br,oa,zr,ja,la,Ma,La,Tr,ci,Vt,hd,md,io,Xs,Qs,oo;class pd{constructor(e,r,a){et(this,Vt);$e(this,"parent");$e(this,"is_pending",!1);et(this,Fn);et(this,To,null);et(this,ur);et(this,ia);et(this,fr);et(this,Kn,null);et(this,wn,null);et(this,dr,null);et(this,Sr,null);et(this,Br,null);et(this,oa,0);et(this,zr,0);et(this,ja,!1);et(this,la,!1);et(this,Ma,new Set);et(this,La,new Set);et(this,Tr,null);et(this,ci,fd(()=>(Qe(this,Tr,pa(ne(this,oa))),()=>{Qe(this,Tr,null)})));Qe(this,Fn,e),Qe(this,ur,r),Qe(this,ia,a),this.parent=gt.b,this.is_pending=!!ne(this,ur).pending,Qe(this,fr,Do(()=>{gt.b=this;{var i=ln(this,Vt,io).call(this);try{Qe(this,Kn,Un(()=>a(i)))}catch(o){this.error(o)}ne(this,zr)>0?ln(this,Vt,Qs).call(this):this.is_pending=!1}return()=>{var o;(o=ne(this,Br))==null||o.remove()}},dd))}defer_effect(e){jc(e,ne(this,Ma),ne(this,La))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!ne(this,ur).pending}update_pending_count(e){ln(this,Vt,oo).call(this,e),Qe(this,oa,ne(this,oa)+e),!(!ne(this,Tr)||ne(this,ja))&&(Qe(this,ja,!0),Kr(()=>{Qe(this,ja,!1),ne(this,Tr)&&Fa(ne(this,Tr),ne(this,oa))}))}get_effect_pending(){return ne(this,ci).call(this),g(ne(this,Tr))}error(e){var r=ne(this,ur).onerror;let a=ne(this,ur).failed;if(ne(this,la)||!r&&!a)throw e;ne(this,Kn)&&(Tn(ne(this,Kn)),Qe(this,Kn,null)),ne(this,wn)&&(Tn(ne(this,wn)),Qe(this,wn,null)),ne(this,dr)&&(Tn(ne(this,dr)),Qe(this,dr,null));var i=!1,o=!1;const u=()=>{if(i){ad();return}i=!0,o&&Vf(),Ur.ensure(),Qe(this,oa,0),ne(this,dr)!==null&&fa(ne(this,dr),()=>{Qe(this,dr,null)}),this.is_pending=this.has_pending_snippet(),Qe(this,Kn,ln(this,Vt,Xs).call(this,()=>(Qe(this,la,!1),Un(()=>ne(this,ia).call(this,ne(this,Fn)))))),ne(this,zr)>0?ln(this,Vt,Qs).call(this):this.is_pending=!1};Kr(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(f){za(f,ne(this,fr)&&ne(this,fr).parent)}a&&Qe(this,dr,ln(this,Vt,Xs).call(this,()=>{Ur.ensure(),Qe(this,la,!0);try{return Un(()=>{a(ne(this,Fn),()=>e,()=>u)})}catch(f){return za(f,ne(this,fr).parent),null}finally{Qe(this,la,!1)}}))})}}Fn=new WeakMap,To=new WeakMap,ur=new WeakMap,ia=new WeakMap,fr=new WeakMap,Kn=new WeakMap,wn=new WeakMap,dr=new WeakMap,Sr=new WeakMap,Br=new WeakMap,oa=new WeakMap,zr=new WeakMap,ja=new WeakMap,la=new WeakMap,Ma=new WeakMap,La=new WeakMap,Tr=new WeakMap,ci=new WeakMap,Vt=new WeakSet,hd=function(){try{Qe(this,Kn,Un(()=>ne(this,ia).call(this,ne(this,Fn))))}catch(e){this.error(e)}},md=function(){const e=ne(this,ur).pending;e&&(Qe(this,wn,Un(()=>e(ne(this,Fn)))),Kr(()=>{var r=ln(this,Vt,io).call(this);Qe(this,Kn,ln(this,Vt,Xs).call(this,()=>(Ur.ensure(),Un(()=>ne(this,ia).call(this,r))))),ne(this,zr)>0?ln(this,Vt,Qs).call(this):(fa(ne(this,wn),()=>{Qe(this,wn,null)}),this.is_pending=!1)}))},io=function(){var e=ne(this,Fn);return this.is_pending&&(Qe(this,Br,Pr()),ne(this,Fn).before(ne(this,Br)),e=ne(this,Br)),e},Xs=function(e){var r=gt,a=tt,i=Mn;pr(ne(this,fr)),Wn(ne(this,fr)),Ba(ne(this,fr).ctx);try{return e()}catch(o){return Oc(o),null}finally{pr(r),Wn(a),Ba(i)}},Qs=function(){const e=ne(this,ur).pending;ne(this,Kn)!==null&&(Qe(this,Sr,document.createDocumentFragment()),ne(this,Sr).append(ne(this,Br)),au(ne(this,Kn),ne(this,Sr))),ne(this,wn)===null&&Qe(this,wn,Un(()=>e(ne(this,Fn))))},oo=function(e){var r;if(!this.has_pending_snippet()){this.parent&&ln(r=this.parent,Vt,oo).call(r,e);return}if(Qe(this,zr,ne(this,zr)+e),ne(this,zr)===0){this.is_pending=!1;for(const a of ne(this,Ma))Nt(a,tn),nr(a);for(const a of ne(this,La))Nt(a,ar),nr(a);ne(this,Ma).clear(),ne(this,La).clear(),ne(this,wn)&&fa(ne(this,wn),()=>{Qe(this,wn,null)}),ne(this,Sr)&&(ne(this,Fn).before(ne(this,Sr)),Qe(this,Sr,null))}};function gd(t,e,r,a){const i=pi;var o=t.filter(x=>!x.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=We,f=gt,h=_d(),v=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(x=>x.promise)):null;function y(x){h();try{a(x)}catch(k){(f.f&Cr)===0&&za(k,f)}u==null||u.deactivate(),lo()}if(r.length===0){v.then(()=>y(e.map(i)));return}function S(){h(),Promise.all(r.map(x=>yd(x))).then(x=>y([...e.map(i),...x])).catch(x=>za(x,f))}v?v.then(S):S()}function _d(){var t=gt,e=tt,r=Mn,a=We;return function(o=!0){pr(t),Wn(e),Ba(r),o&&(a==null||a.activate())}}function lo(){pr(null),Wn(null),Ba(null)}function pi(t){var e=en|tn,r=tt!==null&&(tt.f&en)!==0?tt:null;return gt!==null&&(gt.f|=Ua),{ctx:Mn,deps:null,effects:null,equals:Cc,f:e,fn:t,reactions:null,rv:0,v:Qt,wv:0,parent:r??gt,ac:null}}function yd(t,e,r){let a=gt;a===null&&Nf();var i=a.b,o=void 0,u=pa(Qt),f=!tt,h=new Map;return Dd(()=>{var k;var v=wc();o=v.promise;try{Promise.resolve(t()).then(v.resolve,v.reject).then(()=>{y===We&&y.committed&&y.deactivate(),lo()})}catch(N){v.reject(N),lo()}var y=We;if(f){var S=i.is_rendered();i.update_pending_count(1),y.increment(S),(k=h.get(y))==null||k.reject(ea),h.delete(y),h.set(y,v)}const x=(N,E=void 0)=>{if(y.activate(),E)E!==ea&&(u.f|=Fr,Fa(u,E));else{(u.f&Fr)!==0&&(u.f^=Fr),Fa(u,N);for(const[A,Q]of h){if(h.delete(A),A===y)break;Q.reject(ea)}}f&&(i.update_pending_count(-1),y.decrement(S))};v.promise.then(x,N=>x(null,N||"unknown"))}),Qc(()=>{for(const v of h.values())v.reject(ea)}),new Promise(v=>{function y(S){function x(){S===o?v(u):y(o)}S.then(x,x)}y(o)})}function At(t){const e=pi(t);return su(e),e}function zc(t){const e=pi(t);return e.equals=Pc,e}function bd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Tn(e[r])}}function wd(t){for(var e=t.parent;e!==null;){if((e.f&en)===0)return(e.f&Cr)===0?e:null;e=e.parent}return null}function Po(t){var e,r=gt;pr(wd(t));try{t.f&=~va,bd(t),e=cu(t)}finally{pr(r)}return e}function Fc(t){var e=Po(t);if(!t.equals(e)&&(t.wv=ou(),(!(We!=null&&We.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){Nt(t,Wt);return}Wr||(Zt!==null?(Ro()||We!=null&&We.is_fork)&&Zt.set(t,e):Co(t))}function kd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(ea),a.teardown=Rf,a.ac=null,hs(a,0),jo(a))}function Kc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ka(e)}let co=new Set;const Gr=new Map;let Uc=!1;function pa(t,e){var r={f:0,v:t,reactions:null,equals:Cc,rv:0,wv:0};return r}function Re(t,e){const r=pa(t);return su(r),r}function xd(t,e=!1,r=!0){const a=pa(t);return e||(a.equals=Pc),a}function M(t,e,r=!1){tt!==null&&(!rr||(tt.f&Il)!==0)&&Ic()&&(tt.f&(en|Rr|Ao|Il))!==0&&(Hn===null||!Na.call(Hn,t))&&Wf();let a=r?Jt(e):e;return Fa(t,a)}function Fa(t,e){if(!t.equals(e)){var r=t.v;Wr?Gr.set(t,e):Gr.set(t,r),t.v=e;var a=Ur.ensure();if(a.capture(t,r),(t.f&en)!==0){const i=t;(t.f&tn)!==0&&Po(i),Co(i)}t.wv=ou(),Gc(t,tn),gt!==null&&(gt.f&Wt)!==0&&(gt.f&(sr|_a))===0&&(zn===null?Md([t]):zn.push(t)),!a.is_fork&&co.size>0&&!Uc&&Sd()}return e}function Sd(){Uc=!1;for(const t of co)(t.f&Wt)!==0&&Nt(t,ar),xs(t)&&Ka(t);co.clear()}function us(t){M(t,t.v+1)}function Gc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,f=(u&tn)===0;if(f&&Nt(o,e),(u&en)!==0){var h=o;Zt==null||Zt.delete(h),(u&va)===0&&(u&Gn&&(o.f|=va),Gc(h,ar))}else f&&((u&Rr)!==0&&Zn!==null&&Zn.add(o),nr(o))}}function Jt(t){if(typeof t!="object"||t===null||ua in t)return t;const e=bc(t);if(e!==Pf&&e!==If)return t;var r=new Map,a=Eo(t),i=Re(0),o=da,u=f=>{if(da===o)return f();var h=tt,v=da;Wn(null),Ll(o);var y=f();return Wn(h),Ll(v),y};return a&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(f,h,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Gf();var y=r.get(h);return y===void 0?u(()=>{var S=Re(v.value);return r.set(h,S),S}):M(y,v.value,!0),!0},deleteProperty(f,h){var v=r.get(h);if(v===void 0){if(h in f){const y=u(()=>Re(Qt));r.set(h,y),us(i)}}else M(v,Qt),us(i);return!0},get(f,h,v){var k;if(h===ua)return t;var y=r.get(h),S=h in f;if(y===void 0&&(!S||(k=Pa(f,h))!=null&&k.writable)&&(y=u(()=>{var N=Jt(S?f[h]:Qt),E=Re(N);return E}),r.set(h,y)),y!==void 0){var x=g(y);return x===Qt?void 0:x}return Reflect.get(f,h,v)},getOwnPropertyDescriptor(f,h){var v=Reflect.getOwnPropertyDescriptor(f,h);if(v&&"value"in v){var y=r.get(h);y&&(v.value=g(y))}else if(v===void 0){var S=r.get(h),x=S==null?void 0:S.v;if(S!==void 0&&x!==Qt)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return v},has(f,h){var x;if(h===ua)return!0;var v=r.get(h),y=v!==void 0&&v.v!==Qt||Reflect.has(f,h);if(v!==void 0||gt!==null&&(!y||(x=Pa(f,h))!=null&&x.writable)){v===void 0&&(v=u(()=>{var k=y?Jt(f[h]):Qt,N=Re(k);return N}),r.set(h,v));var S=g(v);if(S===Qt)return!1}return y},set(f,h,v,y){var U;var S=r.get(h),x=h in f;if(a&&h==="length")for(var k=v;k<S.v;k+=1){var N=r.get(k+"");N!==void 0?M(N,Qt):k in f&&(N=u(()=>Re(Qt)),r.set(k+"",N))}if(S===void 0)(!x||(U=Pa(f,h))!=null&&U.writable)&&(S=u(()=>Re(void 0)),M(S,Jt(v)),r.set(h,S));else{x=S.v!==Qt;var E=u(()=>Jt(v));M(S,E)}var A=Reflect.getOwnPropertyDescriptor(f,h);if(A!=null&&A.set&&A.set.call(y,v),!x){if(a&&typeof h=="string"){var Q=r.get("length"),de=Number(h);Number.isInteger(de)&&de>=Q.v&&M(Q,de+1)}us(i)}return!0},ownKeys(f){g(i);var h=Reflect.ownKeys(f).filter(S=>{var x=r.get(S);return x===void 0||x.v!==Qt});for(var[v,y]of r)y.v!==Qt&&!(v in f)&&h.push(v);return h},setPrototypeOf(){Hf()}})}function Ol(t){try{if(t!==null&&typeof t=="object"&&ua in t)return t[ua]}catch{}return t}function Td(t,e){return Object.is(Ol(t),Ol(e))}var Dl,Hc,Wc,Vc;function Ed(){if(Dl===void 0){Dl=window,Hc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Wc=Pa(e,"firstChild").get,Vc=Pa(e,"nextSibling").get,Pl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Pl(r)&&(r.__t=void 0)}}function Pr(t=""){return document.createTextNode(t)}function Dn(t){return Wc.call(t)}function ks(t){return Vc.call(t)}function m(t,e){return Dn(t)}function Ve(t,e=!1){{var r=Dn(t);return r instanceof Comment&&r.data===""?ks(r):r}}function b(t,e=1,r=!1){let a=t;for(;e--;)a=ks(a);return a}function Ad(t){t.textContent=""}function Yc(){return!1}function Cd(t,e,r){return document.createElementNS(Ac,t,void 0)}let jl=!1;function Pd(){jl||(jl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Io(t){var e=tt,r=gt;Wn(null),pr(null);try{return t()}finally{Wn(e),pr(r)}}function Xc(t,e,r,a=r){t.addEventListener(e,()=>Io(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),Pd()}function Id(t){gt===null&&(tt===null&&Ff(),zf()),Wr&&Bf()}function Rd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Or(t,e,r){var a=gt;a!==null&&(a.f&jn)!==0&&(t|=jn);var i={ctx:Mn,deps:null,nodes:null,f:t|tn|Gn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ka(i)}catch(f){throw Tn(i),f}else e!==null&&nr(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ua)===0&&(o=o.first,(t&Rr)!==0&&(t&qa)!==0&&o!==null&&(o.f|=qa)),o!==null&&(o.parent=a,a!==null&&Rd(o,a),tt!==null&&(tt.f&en)!==0&&(t&_a)===0)){var u=tt;(u.effects??(u.effects=[])).push(o)}return i}function Ro(){return tt!==null&&!rr}function Qc(t){const e=Or(di,null,!1);return Nt(e,Wt),e.teardown=t,e}function ni(t){Id();var e=gt.f,r=!tt&&(e&sr)!==0&&(e&ws)===0;if(r){var a=Mn;(a.e??(a.e=[])).push(t)}else return Zc(t)}function Zc(t){return Or(ps|Df,t,!1)}function Od(t){Ur.ensure();const e=Or(_a|Ua,t,!0);return(r={})=>new Promise(a=>{r.outro?fa(e,()=>{Tn(e),a(void 0)}):(Tn(e),a(void 0))})}function Jc(t){return Or(ps,t,!1)}function Dd(t){return Or(Ao|Ua,t,!0)}function Oo(t,e=0){return Or(di|e,t,!0)}function te(t,e=[],r=[],a=[]){gd(a,e,r,i=>{Or(di,()=>t(...i.map(g)),!0)})}function Do(t,e=0){var r=Or(Rr|e,t,!0);return r}function Un(t){return Or(sr|Ua,t,!0)}function $c(t){var e=t.teardown;if(e!==null){const r=Wr,a=tt;Ml(!0),Wn(null);try{e.call(null)}finally{Ml(r),Wn(a)}}}function jo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Io(()=>{i.abort(ea)});var a=r.next;(r.f&_a)!==0?r.parent=null:Tn(r,e),r=a}}function jd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&sr)===0&&Tn(e),e=r}}function Tn(t,e=!0){var r=!1;(e||(t.f&Sc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(eu(t.nodes.start,t.nodes.end),r=!0),jo(t,e&&!r),hs(t,0),Nt(t,Cr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();$c(t);var i=t.parent;i!==null&&i.first!==null&&tu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function eu(t,e){for(;t!==null;){var r=t===e?null:ks(t);t.remove(),t=r}}function tu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function fa(t,e,r=!0){var a=[];nu(t,a,!0);var i=()=>{r&&Tn(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var f of a)f.out(u)}else i()}function nu(t,e,r){if((t.f&jn)===0){t.f^=jn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const f of a)(f.is_global||r)&&e.push(f);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&qa)!==0||(i.f&sr)!==0&&(t.f&Rr)!==0;nu(i,e,u?r:!1),i=o}}}function Mo(t){ru(t,!0)}function ru(t,e){if((t.f&jn)!==0){t.f^=jn,(t.f&Wt)===0&&(Nt(t,tn),nr(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&qa)!==0||(r.f&sr)!==0;ru(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function au(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:ks(r);e.append(r),r=i}}let Zs=!1,Wr=!1;function Ml(t){Wr=t}let tt=null,rr=!1;function Wn(t){tt=t}let gt=null;function pr(t){gt=t}let Hn=null;function su(t){tt!==null&&(Hn===null?Hn=[t]:Hn.push(t))}let Sn=null,Rn=0,zn=null;function Md(t){zn=t}let iu=1,na=0,da=na;function Ll(t){da=t}function ou(){return++iu}function xs(t){var e=t.f;if((e&tn)!==0)return!0;if(e&en&&(t.f&=~va),(e&ar)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(xs(o)&&Fc(o),o.wv>t.wv)return!0}(e&Gn)!==0&&Zt===null&&Nt(t,Wt)}return!1}function lu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Hn!==null&&Na.call(Hn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&en)!==0?lu(o,e,!1):e===o&&(r?Nt(o,tn):(o.f&Wt)!==0&&Nt(o,ar),nr(o))}}function cu(t){var E;var e=Sn,r=Rn,a=zn,i=tt,o=Hn,u=Mn,f=rr,h=da,v=t.f;Sn=null,Rn=0,zn=null,tt=(v&(sr|_a))===0?t:null,Hn=null,Ba(t.ctx),rr=!1,da=++na,t.ac!==null&&(Io(()=>{t.ac.abort(ea)}),t.ac=null);try{t.f|=no;var y=t.fn,S=y();t.f|=ws;var x=t.deps,k=We==null?void 0:We.is_fork;if(Sn!==null){var N;if(k||hs(t,Rn),x!==null&&Rn>0)for(x.length=Rn+Sn.length,N=0;N<Sn.length;N++)x[Rn+N]=Sn[N];else t.deps=x=Sn;if(Ro()&&(t.f&Gn)!==0)for(N=Rn;N<x.length;N++)((E=x[N]).reactions??(E.reactions=[])).push(t)}else!k&&x!==null&&Rn<x.length&&(hs(t,Rn),x.length=Rn);if(Ic()&&zn!==null&&!rr&&x!==null&&(t.f&(en|ar|tn))===0)for(N=0;N<zn.length;N++)lu(zn[N],t);if(i!==null&&i!==t){if(na++,i.deps!==null)for(let A=0;A<r;A+=1)i.deps[A].rv=na;if(e!==null)for(const A of e)A.rv=na;zn!==null&&(a===null?a=zn:a.push(...zn))}return(t.f&Fr)!==0&&(t.f^=Fr),S}catch(A){return Oc(A)}finally{t.f^=no,Sn=e,Rn=r,zn=a,tt=i,Hn=o,Ba(u),rr=f,da=h}}function Ld(t,e){let r=e.reactions;if(r!==null){var a=Ef.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&en)!==0&&(Sn===null||!Na.call(Sn,e))){var o=e;(o.f&Gn)!==0&&(o.f^=Gn,o.f&=~va),Co(o),kd(o),hs(o,0)}}function hs(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Ld(t,r[a])}function Ka(t){var e=t.f;if((e&Cr)===0){Nt(t,Wt);var r=gt,a=Zs;gt=t,Zs=!0;try{(e&(Rr|kc))!==0?jd(t):jo(t),$c(t);var i=cu(t);t.teardown=typeof i=="function"?i:null,t.wv=iu;var o;to&&id&&(t.f&tn)!==0&&t.deps}finally{Zs=a,gt=r}}}async function uu(){await Promise.resolve(),cd()}function g(t){var e=t.f,r=(e&en)!==0;if(tt!==null&&!rr){var a=gt!==null&&(gt.f&Cr)!==0;if(!a&&(Hn===null||!Na.call(Hn,t))){var i=tt.deps;if((tt.f&no)!==0)t.rv<na&&(t.rv=na,Sn===null&&i!==null&&i[Rn]===t?Rn++:Sn===null?Sn=[t]:Sn.push(t));else{(tt.deps??(tt.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[tt]:Na.call(o,tt)||o.push(tt)}}}if(Wr&&Gr.has(t))return Gr.get(t);if(r){var u=t;if(Wr){var f=u.v;return((u.f&Wt)===0&&u.reactions!==null||du(u))&&(f=Po(u)),Gr.set(u,f),f}var h=(u.f&Gn)===0&&!rr&&tt!==null&&(Zs||(tt.f&Gn)!==0),v=(u.f&ws)===0;xs(u)&&(h&&(u.f|=Gn),Fc(u)),h&&!v&&(Kc(u),fu(u))}if(Zt!=null&&Zt.has(t))return Zt.get(t);if((t.f&Fr)!==0)throw t.v;return t.v}function fu(t){if(t.f|=Gn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&en)!==0&&(e.f&Gn)===0&&(Kc(e),fu(e))}function du(t){if(t.v===Qt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Gr.has(e)||(e.f&en)!==0&&du(e))return!0;return!1}function Ss(t){var e=rr;try{return rr=!0,t()}finally{rr=e}}const Nd=["touchstart","touchmove"];function qd(t){return Nd.includes(t)}const vu=new Set,uo=new Set;function Ft(t){for(var e=0;e<t.length;e++)vu.add(t[e]);for(var r of uo)r(t)}let Nl=null;function ql(t){var A;var e=this,r=e.ownerDocument,a=t.type,i=((A=t.composedPath)==null?void 0:A.call(t))||[],o=i[0]||t.target;Nl=t;var u=0,f=Nl===t&&t.__root;if(f){var h=i.indexOf(f);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var v=i.indexOf(e);if(v===-1)return;h<=v&&(u=h)}if(o=i[u]||t.target,o!==e){Af(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=tt,S=gt;Wn(null),pr(null);try{for(var x,k=[];o!==null;){var N=o.assignedSlot||o.parentNode||o.host||null;try{var E=o["__"+a];E!=null&&(!o.disabled||t.target===o)&&E.call(o,t)}catch(Q){x?k.push(Q):x=Q}if(t.cancelBubble||N===e||N===null)break;o=N}if(x){for(let Q of k)queueMicrotask(()=>{throw Q});throw x}}finally{t.__root=e,delete t.currentTarget,Wn(y),pr(S)}}}var gc,_c;const Ui=(_c=(gc=globalThis==null?void 0:globalThis.window)==null?void 0:gc.trustedTypes)==null?void 0:_c.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Bd(t){return(Ui==null?void 0:Ui.createHTML(t))??t}function Lo(t,e=!1){var r=Cd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Bd(t):t,r.content}function ha(t,e){var r=gt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function z(t,e){var r=(e&Ec)!==0,a=(e&nd)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Lo(o?t:"<!>"+t,!0),r||(i=Dn(i)));var u=a||Hc?document.importNode(i,!0):i.cloneNode(!0);if(r){var f=Dn(u),h=u.lastChild;ha(f,h)}else ha(u,u);return u}}function zd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Ec)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var f=Lo(o,!0),h=Dn(f);if(i)for(u=document.createDocumentFragment();Dn(h);)u.appendChild(Dn(h));else u=Dn(h)}var v=u.cloneNode(!0);if(i){var y=Dn(v),S=v.lastChild;ha(y,S)}else ha(v,v);return v}}function No(t,e){return zd(t,e,"svg")}function ri(t=""){{var e=Pr(t+"");return ha(e,e),e}}function Ir(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Pr();return t.append(e,r),ha(e,r),t}function D(t,e){t!==null&&t.before(e)}function W(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Fd(t,e){return Kd(t,e)}const Ks=new Map;function Kd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Ed();var f=new Set,h=S=>{for(var x=0;x<S.length;x++){var k=S[x];if(!f.has(k)){f.add(k);var N=qd(k);for(const Q of[e,document]){var E=Ks.get(Q);E===void 0&&(E=new Map,Ks.set(Q,E));var A=E.get(k);A===void 0?(Q.addEventListener(k,ql,{passive:N}),E.set(k,1)):E.set(k,A+1)}}}};h(fi(vu)),uo.add(h);var v=void 0,y=Od(()=>{var S=r??e.appendChild(Pr());return vd(S,{pending:()=>{}},x=>{Ct({});var k=Mn;o&&(k.c=o),i&&(a.$$events=i),v=t(x,a)||{},Pt()}),()=>{var E;for(var x of f)for(const A of[e,document]){var k=Ks.get(A),N=k.get(x);--N==0?(A.removeEventListener(x,ql),k.delete(x),k.size===0&&Ks.delete(A)):k.set(x,N)}uo.delete(h),S!==r&&((E=S.parentNode)==null||E.removeChild(S))}});return Ud.set(v,y),v}let Ud=new WeakMap;var $n,vr,On,ca,ys,bs,ui;class Gd{constructor(e,r=!0){$e(this,"anchor");et(this,$n,new Map);et(this,vr,new Map);et(this,On,new Map);et(this,ca,new Set);et(this,ys,!0);et(this,bs,()=>{var e=We;if(ne(this,$n).has(e)){var r=ne(this,$n).get(e),a=ne(this,vr).get(r);if(a)Mo(a),ne(this,ca).delete(r);else{var i=ne(this,On).get(r);i&&(ne(this,vr).set(r,i.effect),ne(this,On).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of ne(this,$n)){if(ne(this,$n).delete(o),o===e)break;const f=ne(this,On).get(u);f&&(Tn(f.effect),ne(this,On).delete(u))}for(const[o,u]of ne(this,vr)){if(o===r||ne(this,ca).has(o))continue;const f=()=>{if(Array.from(ne(this,$n).values()).includes(o)){var v=document.createDocumentFragment();au(u,v),v.append(Pr()),ne(this,On).set(o,{effect:u,fragment:v})}else Tn(u);ne(this,ca).delete(o),ne(this,vr).delete(o)};ne(this,ys)||!a?(ne(this,ca).add(o),fa(u,f,!1)):f()}}});et(this,ui,e=>{ne(this,$n).delete(e);const r=Array.from(ne(this,$n).values());for(const[a,i]of ne(this,On))r.includes(a)||(Tn(i.effect),ne(this,On).delete(a))});this.anchor=e,Qe(this,ys,r)}ensure(e,r){var a=We,i=Yc();if(r&&!ne(this,vr).has(e)&&!ne(this,On).has(e))if(i){var o=document.createDocumentFragment(),u=Pr();o.append(u),ne(this,On).set(e,{effect:Un(()=>r(u)),fragment:o})}else ne(this,vr).set(e,Un(()=>r(this.anchor)));if(ne(this,$n).set(a,e),i){for(const[f,h]of ne(this,vr))f===e?a.unskip_effect(h):a.skip_effect(h);for(const[f,h]of ne(this,On))f===e?a.unskip_effect(h.effect):a.skip_effect(h.effect);a.oncommit(ne(this,bs)),a.ondiscard(ne(this,ui))}else ne(this,bs).call(this)}}$n=new WeakMap,vr=new WeakMap,On=new WeakMap,ca=new WeakMap,ys=new WeakMap,bs=new WeakMap,ui=new WeakMap;function fe(t,e,r=!1){var a=new Gd(t),i=r?qa:0;function o(u,f){a.ensure(u,f)}Do(()=>{var u=!1;e((f,h=0)=>{u=!0,o(h,f)}),u||o(!1,null)},i)}function Vn(t,e){return e}function Hd(t,e,r){for(var a=[],i=e.length,o,u=e.length,f=0;f<i;f++){let S=e[f];fa(S,()=>{if(o){if(o.pending.delete(S),o.done.add(S),o.pending.size===0){var x=t.outrogroups;fo(fi(o.done)),x.delete(o),x.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var h=a.length===0&&r!==null;if(h){var v=r,y=v.parentNode;Ad(y),y.append(v),t.items.clear()}fo(e,!h)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function fo(t,e=!0){for(var r=0;r<t.length;r++)Tn(t[r],e)}var Bl;function nn(t,e,r,a,i,o=null){var u=t,f=new Map,h=(e&Tc)!==0;if(h){var v=t;u=v.appendChild(Pr())}var y=null,S=zc(()=>{var Q=r();return Eo(Q)?Q:Q==null?[]:fi(Q)}),x,k=!0;function N(){A.fallback=y,Wd(A,x,u,e,a),y!==null&&(x.length===0?(y.f&Ar)===0?Mo(y):(y.f^=Ar,os(y,null,u)):fa(y,()=>{y=null}))}var E=Do(()=>{x=g(S);for(var Q=x.length,de=new Set,U=We,q=Yc(),Y=0;Y<Q;Y+=1){var $=x[Y],G=a($,Y),ue=k?null:f.get(G);ue?(ue.v&&Fa(ue.v,$),ue.i&&Fa(ue.i,Y),q&&U.unskip_effect(ue.e)):(ue=Vd(f,k?u:Bl??(Bl=Pr()),$,G,Y,i,e,r),k||(ue.e.f|=Ar),f.set(G,ue)),de.add(G)}if(Q===0&&o&&!y&&(k?y=Un(()=>o(u)):(y=Un(()=>o(Bl??(Bl=Pr()))),y.f|=Ar)),Q>de.size&&qf(),!k)if(q){for(const[we,Ee]of f)de.has(we)||U.skip_effect(Ee.e);U.oncommit(N),U.ondiscard(()=>{})}else N();g(S)}),A={effect:E,items:f,outrogroups:null,fallback:y};k=!1}function $a(t){for(;t!==null&&(t.f&sr)===0;)t=t.next;return t}function Wd(t,e,r,a,i){var Ee,ie,J,le,Se,ce,_e,ke,re;var o=(a&Qf)!==0,u=e.length,f=t.items,h=$a(t.effect.first),v,y=null,S,x=[],k=[],N,E,A,Q;if(o)for(Q=0;Q<u;Q+=1)N=e[Q],E=i(N,Q),A=f.get(E).e,(A.f&Ar)===0&&((ie=(Ee=A.nodes)==null?void 0:Ee.a)==null||ie.measure(),(S??(S=new Set)).add(A));for(Q=0;Q<u;Q+=1){if(N=e[Q],E=i(N,Q),A=f.get(E).e,t.outrogroups!==null)for(const pe of t.outrogroups)pe.pending.delete(A),pe.done.delete(A);if((A.f&Ar)!==0)if(A.f^=Ar,A===h)os(A,null,r);else{var de=y?y.next:h;A===t.effect.last&&(t.effect.last=A.prev),A.prev&&(A.prev.next=A.next),A.next&&(A.next.prev=A.prev),Nr(t,y,A),Nr(t,A,de),os(A,de,r),y=A,x=[],k=[],h=$a(y.next);continue}if((A.f&jn)!==0&&(Mo(A),o&&((le=(J=A.nodes)==null?void 0:J.a)==null||le.unfix(),(S??(S=new Set)).delete(A))),A!==h){if(v!==void 0&&v.has(A)){if(x.length<k.length){var U=k[0],q;y=U.prev;var Y=x[0],$=x[x.length-1];for(q=0;q<x.length;q+=1)os(x[q],U,r);for(q=0;q<k.length;q+=1)v.delete(k[q]);Nr(t,Y.prev,$.next),Nr(t,y,Y),Nr(t,$,U),h=U,y=$,Q-=1,x=[],k=[]}else v.delete(A),os(A,h,r),Nr(t,A.prev,A.next),Nr(t,A,y===null?t.effect.first:y.next),Nr(t,y,A),y=A;continue}for(x=[],k=[];h!==null&&h!==A;)(v??(v=new Set)).add(h),k.push(h),h=$a(h.next);if(h===null)continue}(A.f&Ar)===0&&x.push(A),y=A,h=$a(A.next)}if(t.outrogroups!==null){for(const pe of t.outrogroups)pe.pending.size===0&&(fo(fi(pe.done)),(Se=t.outrogroups)==null||Se.delete(pe));t.outrogroups.size===0&&(t.outrogroups=null)}if(h!==null||v!==void 0){var G=[];if(v!==void 0)for(A of v)(A.f&jn)===0&&G.push(A);for(;h!==null;)(h.f&jn)===0&&h!==t.fallback&&G.push(h),h=$a(h.next);var ue=G.length;if(ue>0){var we=(a&Tc)!==0&&u===0?r:null;if(o){for(Q=0;Q<ue;Q+=1)(_e=(ce=G[Q].nodes)==null?void 0:ce.a)==null||_e.measure();for(Q=0;Q<ue;Q+=1)(re=(ke=G[Q].nodes)==null?void 0:ke.a)==null||re.fix()}Hd(t,G,we)}}o&&Kr(()=>{var pe,ve;if(S!==void 0)for(A of S)(ve=(pe=A.nodes)==null?void 0:pe.a)==null||ve.apply()})}function Vd(t,e,r,a,i,o,u,f){var h=(u&Yf)!==0?(u&Zf)===0?xd(r,!1,!1):pa(r):null,v=(u&Xf)!==0?pa(i):null;return{v:h,i:v,e:Un(()=>(o(e,h??r,v??i,f),()=>{t.delete(a)}))}}function os(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&Ar)===0?e.nodes.start:r;a!==null;){var u=ks(a);if(o.before(a),a===i)return;a=u}}function Nr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Yd(t,e,r=!1,a=!1,i=!1){var o=t,u="";te(()=>{var f=gt;if(u!==(u=e()??"")&&(f.nodes!==null&&(eu(f.nodes.start,f.nodes.end),f.nodes=null),u!=="")){var h=u+"";r?h=`<svg>${h}</svg>`:a&&(h=`<math>${h}</math>`);var v=Lo(h);if((r||a)&&(v=Dn(v)),ha(Dn(v),v.lastChild),r||a)for(;Dn(v);)o.before(Dn(v));else o.before(v)}})}const zl=[...` 	
\r\fÂ \v\uFEFF`];function Xd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var f=u+o;(u===0||zl.includes(a[u-1]))&&(f===a.length||zl.includes(a[f]))?a=(u===0?"":a.substring(0,u))+a.substring(f+1):u=f}}return a===""?null:a}function Fl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Gi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Qd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,f=!1,h=[];a&&h.push(...Object.keys(a).map(Gi)),i&&h.push(...Object.keys(i).map(Gi));var v=0,y=-1;const E=t.length;for(var S=0;S<E;S++){var x=t[S];if(f?x==="/"&&t[S-1]==="*"&&(f=!1):o?o===x&&(o=!1):x==="/"&&t[S+1]==="*"?f=!0:x==='"'||x==="'"?o=x:x==="("?u++:x===")"&&u--,!f&&o===!1&&u===0){if(x===":"&&y===-1)y=S;else if(x===";"||S===E-1){if(y!==-1){var k=Gi(t.substring(v,y).trim());if(!h.includes(k)){x!==";"&&S++;var N=t.substring(v,S).trim();r+=" "+N+";"}}v=S+1,y=-1}}}}return a&&(r+=Fl(a)),i&&(r+=Fl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Mt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var f=Xd(r,a,o);f==null?t.removeAttribute("class"):e?t.className=f:t.setAttribute("class",f),t.__className=r}else if(o&&i!==o)for(var h in o){var v=!!o[h];(i==null||v!==!!i[h])&&t.classList.toggle(h,v)}return o}function Hi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function En(t,e,r,a){var i=t.__style;if(i!==e){var o=Qd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Hi(t,r==null?void 0:r[0],a[0]),Hi(t,r==null?void 0:r[1],a[1],"important")):Hi(t,r,a));return a}function pu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!Eo(e))return rd();for(var a of t.options)a.selected=e.includes(fs(a));return}for(a of t.options){var i=fs(a);if(Td(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Zd(t){var e=new MutationObserver(()=>{pu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Qc(()=>{e.disconnect()})}function qo(t,e,r=e){var a=new WeakSet,i=!0;Xc(t,"change",o=>{var u=o?"[selected]":":checked",f;if(t.multiple)f=[].map.call(t.querySelectorAll(u),fs);else{var h=t.querySelector(u)??t.querySelector("option:not([disabled])");f=h&&fs(h)}r(f),We!==null&&a.add(We)}),Jc(()=>{var o=e();if(t===document.activeElement){var u=ti??We;if(a.has(u))return}if(pu(t,o,i),i&&o===void 0){var f=t.querySelector(":checked");f!==null&&(o=fs(f),r(o))}t.__value=o,i=!1}),Zd(t)}function fs(t){return"__value"in t?t.__value:t.value}const Jd=Symbol("is custom element"),$d=Symbol("is html");function hu(t,e,r,a){var i=ev(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Mf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&tv(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function ev(t){return t.__attributes??(t.__attributes={[Jd]:t.nodeName.includes("-"),[$d]:t.namespaceURI===Ac})}var Kl=new Map;function tv(t){var e=t.getAttribute("is")||t.nodeName,r=Kl.get(e);if(r)return r;Kl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=Cf(i);for(var u in a)a[u].set&&r.push(u);i=bc(i)}return r}function Bo(t,e,r=e){var a=new WeakSet;Xc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Wi(t)?Vi(o):o,r(o),We!==null&&a.add(We),await uu(),o!==(o=e())){var u=t.selectionStart,f=t.selectionEnd,h=t.value.length;if(t.value=o??"",f!==null){var v=t.value.length;u===f&&f===h&&v>h?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=u,t.selectionEnd=Math.min(f,v))}}}),Ss(e)==null&&t.value&&(r(Wi(t)?Vi(t.value):t.value),We!==null&&a.add(We)),Oo(()=>{var i=e();if(t===document.activeElement){var o=ti??We;if(a.has(o))return}Wi(t)&&i===Vi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Wi(t){var e=t.type;return e==="number"||e==="range"}function Vi(t){return t===""?null:+t}function Ul(t,e){return t===e||(t==null?void 0:t[ua])===e}function mu(t={},e,r,a){return Jc(()=>{var i,o;return Oo(()=>{i=o,o=[],Ss(()=>{t!==r(...o)&&(e(t,...o),i&&Ul(r(...i),t)&&e(null,...i))})}),()=>{Kr(()=>{o&&Ul(r(...o),t)&&e(null,...o)})}}),t}let Us=!1;function nv(t){var e=Us;try{return Us=!1,[t(),Us]}finally{Us=e}}function Oe(t,e,r,a){var de;var i=(r&ed)!==0,o=(r&td)!==0,u=a,f=!0,h=()=>(f&&(f=!1,u=o?Ss(a):a),u),v;if(i){var y=ua in t||jf in t;v=((de=Pa(t,e))==null?void 0:de.set)??(y&&e in t?U=>t[e]=U:void 0)}var S,x=!1;i?[S,x]=nv(()=>t[e]):S=t[e],S===void 0&&a!==void 0&&(S=h(),v&&(Uf(),v(S)));var k;if(k=()=>{var U=t[e];return U===void 0?h():(f=!0,U)},(r&$f)===0)return k;if(v){var N=t.$$legacy;return(function(U,q){return arguments.length>0?((!q||N||x)&&v(q?k():U),U):k()})}var E=!1,A=((r&Jf)!==0?pi:zc)(()=>(E=!1,k()));i&&g(A);var Q=gt;return(function(U,q){if(arguments.length>0){const Y=q?g(A):i?Jt(U):U;return M(A,Y),E=!0,u!==void 0&&(u=Y),U}return Wr&&E||(Q.f&Cr)!==0?A.v:g(A)})}function rn(t){Mn===null&&Lf(),ni(()=>{const e=Ss(t);if(typeof e=="function")return e})}const rv="5";var yc;typeof window<"u"&&((yc=window.__svelte??(window.__svelte={})).v??(yc.v=new Set)).add(rv);const Hr=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",contextWindow:32768,maxEmailTokens:4e3,description:"Fastest, 32k context, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",contextWindow:32768,maxEmailTokens:6e3,description:"Balanced speed and quality, 32k context"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",contextWindow:32768,maxEmailTokens:12e3,description:"Best reasoning, 32k context, recommended for email",recommendedForEmailProcessing:!0},{id:"onnx-community/Phi-3.5-mini-instruct-onnx-web",name:"Phi-3.5 Mini",size:"~2.5 GB",contextWindow:131072,maxEmailTokens:16e3,description:"128k context, WebGPU-optimized, best for very long emails",recommendedForEmailProcessing:!0},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",contextWindow:32768,maxEmailTokens:5e3,description:"Strong reasoning, CoT focused, 32k context"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Microsoft, good at reasoning, 16k context"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",contextWindow:8192,maxEmailTokens:2e3,description:"Smallest, ultra fast, 8k context, not for long emails"}];function gu(t){return Hr.find(e=>e.id===t)}const av=Object.freeze(Object.defineProperty({__proto__:null,MODELS:Hr,getModelInfo:gu},Symbol.toStringTag,{value:"Module"}));let kn=null,Er="idle",Js=null,Jr=new Set;function Gs(){return kn||(kn=new Worker(new URL("/me-ai/assets/worker-CV-t6G85.js",import.meta.url),{type:"module"}),kn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Er="loading"),e.status==="ready"&&(Er="ready"),e.status==="start"&&(Er="generating"),(e.status==="complete"||e.status==="error")&&(Er=Js?"ready":"idle");for(const r of Jr)try{r(e)}catch{}})),kn}function _u(){return{check(){Gs().postMessage({type:"check"})},loadModel(t){Js=t,Er="loading",Gs().postMessage({type:"load",modelId:t})},generate(t,e){Gs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,f=0,h=0;const v=S=>{switch(S.status){case"start":h=S.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=S.output,u=S.tps??u,f=S.numTokens??f,r)try{r({tps:u,numTokens:f})}catch{}break;case"complete":y(),a({text:o,tps:u,numTokens:f,inputTokens:h});break;case"error":y(),i(new Error(S.data));break}},y=()=>{Jr.delete(v)};Jr.add(v),Gs().postMessage({type:"generate",data:t,options:e})})},interrupt(){kn==null||kn.postMessage({type:"interrupt"})},reset(){kn==null||kn.postMessage({type:"reset"})},onMessage(t){return Jr.add(t),()=>Jr.delete(t)},offMessage(t){Jr.delete(t)},get status(){return Er},get isReady(){return Er==="ready"},get isGenerating(){return Er==="generating"},get modelId(){return Js},terminate(){kn==null||kn.terminate(),kn=null,Er="idle",Js=null,Jr.clear()}}}var sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $s={exports:{}},ov=$s.exports,Gl;function lv(){return Gl||(Gl=1,(function(t,e){((r,a)=>{t.exports=a()})(ov,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(l[d]=c[d])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var d in s=arguments[l])Object.prototype.hasOwnProperty.call(s,d)&&(n[d]=s[d]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,d=0,p=s.length;d<p;d++)!c&&d in s||((c=c||Array.prototype.slice.call(s,0,d))[d]=s[d]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:sv,u=Object.keys,f=Array.isArray;function h(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var v=Object.getPrototypeOf,y={}.hasOwnProperty;function S(n,s){return y.call(n,s)}function x(n,s){typeof s=="function"&&(s=s(v(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){N(n,l,s[l])})}var k=Object.defineProperty;function N(n,s,l,c){k(n,s,h(l&&S(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function E(n){return{from:function(s){return n.prototype=Object.create(s.prototype),N(n.prototype,"constructor",n),{extend:x.bind(null,n.prototype)}}}}var A=Object.getOwnPropertyDescriptor,Q=[].slice;function de(n,s,l){return Q.call(n,s,l)}function U(n,s){return s(n)}function q(n){if(!n)throw new Error("Assertion Failed")}function Y(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function $(n,s){if(typeof s=="string"&&S(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,d=s.length;c<d;++c){var p=$(n,s[c]);l.push(p)}return l}var _,w=s.indexOf(".");return w===-1||(_=n[s.substr(0,w)])==null?void 0:$(_,s.substr(w+1))}function G(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){q(typeof l!="string"&&"length"in l);for(var c=0,d=s.length;c<d;++c)G(n,s[c],l[c])}else{var p,_,w=s.indexOf(".");w!==-1?(p=s.substr(0,w),(w=s.substr(w+1))===""?l===void 0?f(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:G(_=(_=n[p])&&S(n,p)?_:n[p]={},w,l)):l===void 0?f(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ue(n){var s,l={};for(s in n)S(n,s)&&(l[s]=n[s]);return l}var we=[].concat;function Ee(n){return we.apply([],n)}var V="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ee([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ie=new Set(V.map(function(n){return o[n]})),J=null;function le(n){return J=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=J.get(l);if(c)return c;if(f(l)){c=[],J.set(l,c);for(var d=0,p=l.length;d<p;++d)c.push(s(l[d]))}else if(ie.has(l.constructor))c=l;else{var _,w=v(l);for(_ in c=w===Object.prototype?{}:Object.create(w),J.set(l,c),l)S(l,_)&&(c[_]=s(l[_]))}return c})(n),J=null,n}var Se={}.toString;function ce(n){return Se.call(n).slice(8,-1)}var _e=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ke=typeof _e=="symbol"?function(n){var s;return n!=null&&(s=n[_e])&&s.apply(n)}:function(){return null};function re(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var pe={};function ve(n){var s,l,c,d;if(arguments.length===1){if(f(n))return n.slice();if(this===pe&&typeof n=="string")return[n];if(d=ke(n))for(l=[];!(c=d.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var ae=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},V=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],pt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(V),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Z(n,s){this.name=n,this.message=s}function oe(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,d){return d.indexOf(l)===c}).join(`
`)}function Be(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=oe(n,s)}function Ge(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=oe(n,this.failures)}E(Z).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(Be).from(Z),E(Ge).from(Z);var qe=pt.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ke=Z,B=pt.reduce(function(n,s){var l=s+"Error";function c(d,p){this.name=l,d?typeof d=="string"?(this.message="".concat(d).concat(p?`
 `+p:""),this.inner=p||null):typeof d=="object"&&(this.message="".concat(d.name," ").concat(d.message),this.inner=d):(this.message=ee[s]||l,this.inner=null)}return E(c).from(Ke),n[s]=c,n},{}),ye=(B.Syntax=SyntaxError,B.Type=TypeError,B.Range=RangeError,V.reduce(function(n,s){return n[s+"Error"]=B[s],n},{}));V=pt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=B[s]),n},{});function Te(){}function De(n){return n}function nt(n,s){return n==null||n===De?s:function(l){return s(n(l))}}function rt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function ft(n,s){return n===Te?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),d=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?rt(c,this.onsuccess):c),d&&(this.onerror=this.onerror?rt(d,this.onerror):d),p!==void 0?p:l}}function Rt(n,s){return n===Te?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?rt(l,this.onsuccess):l),c&&(this.onerror=this.onerror?rt(c,this.onerror):c)}}function He(n,s){return n===Te?s:function(d){var c=n.apply(this,arguments),d=(h(d,c),this.onsuccess),p=this.onerror,_=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return d&&(this.onsuccess=this.onsuccess?rt(d,this.onsuccess):d),p&&(this.onerror=this.onerror?rt(p,this.onerror):p),c===void 0?_===void 0?void 0:_:h(c,_)}}function Ye(n,s){return n===Te?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function at(n,s){return n===Te?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,d=arguments.length,p=new Array(d);d--;)p[d]=arguments[d];return l.then(function(){return s.apply(c,p)})}return s.apply(this,arguments)}}V.ModifyError=Be,V.DexieError=Z,V.BulkError=Ge;var st=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _t(n){st=n}var kt={},qt=100,bt=typeof Promise>"u"?[]:(pt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[bt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(bt),pt]:[pt,v(pt),pt]),pt=bt[0],Aa=bt[1],Aa=Aa&&Aa.then,yt=pt&&pt.constructor,un=!!bt[2],an=function(n,s){Nn.push([n,s]),Yt&&(queueMicrotask(Bt),Yt=!1)},_n=!0,Yt=!0,Kt=[],Ut=[],yn=De,Ot={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Te,pgp:!1,env:{},finalize:Te},je=Ot,Nn=[],An=0,Dr=[];function Pe(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=je;if(typeof n!="function"){if(n!==kt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,d){try{d(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var _=c._lib&&Gt();p&&typeof p.then=="function"?l(c,function(w,I){p instanceof Pe?p._then(w,I):p.then(w,I)}):(c._state=!0,c._value=p,wa(c)),_&&fn()}},Xn.bind(null,c))}catch(p){Xn(c,p)}})(this,n)}var ir={get:function(){var n=je,s=gr;function l(c,d){var p=this,_=!n.global&&(n!==je||s!==gr),w=_&&!bn(),I=new Pe(function(K,R){it(p,new ba(T(c,n,_,w),T(d,n,_,w),K,R,n))});return this._consoleTask&&(I._consoleTask=this._consoleTask),I}return l.prototype=kt,l},set:function(n){N(this,"then",n&&n.prototype===kt?ir:{get:function(){return n},set:ir.set})}};function ba(n,s,l,c,d){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=d}function Xn(n,s){var l,c;Ut.push(s),n._state===null&&(l=n._lib&&Gt(),s=yn(s),n._state=!1,n._value=s,c=n,Kt.some(function(d){return d._value===c._value})||Kt.push(c),wa(n),l)&&fn()}function wa(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)it(n,s[l]);var d=n._PSD;--d.ref||d.finalize(),An===0&&(++An,an(function(){--An==0&&Qn()},[]))}function it(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++An,an(Ue,[l,n,s])}}function Ue(n,s,l){try{var c,d=s._value;!s._state&&Ut.length&&(Ut=[]),c=st&&s._consoleTask?s._consoleTask.run(function(){return n(d)}):n(d),s._state||Ut.indexOf(d)!==-1||(p=>{for(var _=Kt.length;_;)if(Kt[--_]._value===p._value)return Kt.splice(_,1)})(s),l.resolve(c)}catch(p){l.reject(p)}finally{--An==0&&Qn(),--l.psd.ref||l.psd.finalize()}}function Bt(){Ne(Ot,function(){Gt()&&fn()})}function Gt(){var n=_n;return Yt=_n=!1,n}function fn(){var n,s,l;do for(;0<Nn.length;)for(n=Nn,Nn=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<Nn.length);Yt=_n=!0}function Qn(){for(var n=Kt,s=(Kt=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),Dr.slice(0)),l=s.length;l;)s[--l]()}function xt(n){return new Pe(kt,!1,n)}function lt(n,s){var l=je;return function(){var c=Gt(),d=je;try{return Pn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Pn(d,!1),c&&fn()}}}x(Pe.prototype,{then:ir,_then:function(n,s){it(this,new ba(null,null,n,s,je))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:xt)(c)}):this.then(null,function(c){return(c&&c.name===s?l:xt)(c)}))},finally:function(n){return this.then(function(s){return Pe.resolve(n()).then(function(){return s})},function(s){return Pe.resolve(n()).then(function(){return xt(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Pe(function(c,d){var p=setTimeout(function(){return d(new B.Timeout(s))},n);l.then(c,d).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&N(Pe.prototype,Symbol.toStringTag,"Dexie.Promise"),Ot.env=xa(),x(Pe,{all:function(){var n=ve.apply(null,arguments).map(_r);return new Pe(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(d,p){return Pe.resolve(d).then(function(_){n[p]=_,--c||s(n)},l)})})},resolve:function(n){return n instanceof Pe?n:n&&typeof n.then=="function"?new Pe(function(s,l){n.then(s,l)}):new Pe(kt,!0,n)},reject:xt,race:function(){var n=ve.apply(null,arguments).map(_r);return new Pe(function(s,l){n.map(function(c){return Pe.resolve(c).then(s,l)})})},PSD:{get:function(){return je},set:function(n){return je=n}},totalEchoes:{get:function(){return gr}},newPSD:Cn,usePSD:Ne,scheduler:{get:function(){return an},set:function(n){an=n}},rejectionMapper:{get:function(){return yn},set:function(n){yn=n}},follow:function(n,s){return new Pe(function(l,c){return Cn(function(d,p){var _=je;_.unhandleds=[],_.onunhandled=p,_.finalize=rt(function(){var w,I=this;w=function(){I.unhandleds.length===0?d():p(I.unhandleds[0])},Dr.push(function K(){w(),Dr.splice(Dr.indexOf(K),1)}),++An,an(function(){--An==0&&Qn()},[])},_.finalize),n()},s,l,c)})}}),yt&&(yt.allSettled&&N(Pe,"allSettled",function(){var n=ve.apply(null,arguments).map(_r);return new Pe(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(d,p){return Pe.resolve(d).then(function(_){return c[p]={status:"fulfilled",value:_}},function(_){return c[p]={status:"rejected",reason:_}}).then(function(){return--l||s(c)})})})}),yt.any&&typeof AggregateError<"u"&&N(Pe,"any",function(){var n=ve.apply(null,arguments).map(_r);return new Pe(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,d=new Array(c);n.forEach(function(p,_){return Pe.resolve(p).then(function(w){return s(w)},function(w){d[_]=w,--c||l(new AggregateError(d))})})})}),yt.withResolvers)&&(Pe.withResolvers=yt.withResolvers);var St={awaits:0,echoes:0,id:0},dn=0,vn=[],mr=0,gr=0,Yr=0;function Cn(n,_,l,c){var d=je,p=Object.create(d),_=(p.parent=d,p.ref=0,p.global=!1,p.id=++Yr,Ot.env,p.env=un?{Promise:Pe,PromiseProp:{value:Pe,configurable:!0,writable:!0},all:Pe.all,race:Pe.race,allSettled:Pe.allSettled,any:Pe.any,resolve:Pe.resolve,reject:Pe.reject}:{},_&&h(p,_),++d.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Ne(p,n,l,c));return p.ref===0&&p.finalize(),_}function zt(){return St.id||(St.id=++dn),++St.awaits,St.echoes+=qt,St.id}function bn(){return!!St.awaits&&(--St.awaits==0&&(St.id=0),St.echoes=St.awaits*qt,!0)}function _r(n){return St.echoes&&n&&n.constructor===yt?(zt(),n.then(function(s){return bn(),s},function(s){return bn(),be(s)})):n}function ka(){var n=vn[vn.length-1];vn.pop(),Pn(n,!1)}function Pn(n,s){var l,c,d=je;(s?!St.echoes||mr++&&n===je:!mr||--mr&&n===je)||queueMicrotask(s?(function(p){++gr,St.echoes&&--St.echoes!=0||(St.echoes=St.awaits=St.id=0),vn.push(je),Pn(p,!0)}).bind(null,n):ka),n!==je&&(je=n,d===Ot&&(Ot.env=xa()),un)&&(l=Ot.env.Promise,c=n.env,d.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function xa(){var n=o.Promise;return un?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ne(n,s,l,c,d){var p=je;try{return Pn(n,!0),s(l,c,d)}finally{Pn(p,!1)}}function T(n,s,l,c){return typeof n!="function"?n:function(){var d=je;l&&zt(),Pn(s,!0);try{return n.apply(this,arguments)}finally{Pn(d,!1),c&&queueMicrotask(bn)}}}function he(n){Promise===yt&&St.echoes===0?mr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Aa).indexOf("[native code]")===-1&&(zt=bn=Te);var be=Pe.reject,Ze="ï¿¿",wt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Tt="String expected.",It=[],sn="__dbnames",qn="readonly",Xt="readwrite";function ht(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var yr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function br(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=le(s))[n],s}}function tl(){throw B.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ot(n,s){try{var l=nl(n),c=nl(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var d=rl(n),p=rl(s),_=d.length,w=p.length,I=_<w?_:w,K=0;K<I;++K)if(d[K]!==p[K])return d[K]<p[K]?-1:1;return _===w?0:_<w?-1:1;case"Array":for(var R=n,C=s,j=R.length,L=C.length,O=j<L?j:L,P=0;P<O;++P){var H=ot(R[P],C[P]);if(H!==0)return H}return j===L?0:j<L?-1:1}}catch{}return NaN}function nl(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=ce(n))==="ArrayBuffer")?"binary":s}function rl(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Es(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(d,p){return!l.failures[p]})),Promise.all(c.map(function(d){return d=d.updatesTable,s?n.db.table(d).where("k").anyOf(s).delete():n.db.table(d).clear()})).then(function(){return l})):l}al.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(f(l))return i(i([],f(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(f(c))return f(n)?n.filter(function(d){return!c.includes(d)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Ga=al;function al(n){this["@@propmod"]=n}function sl(n,s){for(var l=u(s),c=l.length,d=!1,p=0;p<c;++p){var _=l[p],w=s[_],I=$(n,_);w instanceof Ga?(G(n,_,w.execute(I)),d=!0):I!==w&&(G(n,_,w),d=!0)}return d}Et.prototype._trans=function(n,s,l){var c=this._tx||je.trans,d=this.name,p=st&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function _(K,R,C){if(C.schema[d])return s(C.idbtrans,C);throw new B.NotFound("Table "+d+" not part of transaction")}var w=Gt();try{var I=c&&c.db._novip===this.db._novip?c===je.trans?c._promise(n,_,l):Cn(function(){return c._promise(n,_,l)},{trans:c,transless:je.transless||je}):(function K(R,C,j,L){if(R.idbdb&&(R._state.openComplete||je.letThrough||R._vip)){var O=R._createTransaction(C,j,R._dbSchema);try{O.create(),R._state.PR1398_maxLoop=3}catch(P){return P.name===qe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return K(R,C,j,L)})):be(P)}return O._promise(C,function(P,H){return Cn(function(){return je.trans=O,L(P,H,O)})}).then(function(P){if(C==="readwrite")try{O.idbtrans.commit()}catch{}return C==="readonly"?P:O._completion.then(function(){return P})})}if(R._state.openComplete)return be(new B.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return be(new B.DatabaseClosed);R.open().catch(Te)}return R._state.dbReadyPromise.then(function(){return K(R,C,j,L)})})(this.db,n,[this.name],_);return p&&(I._consoleTask=p,I=I.catch(function(K){return console.trace(K),be(K)})),I}finally{w&&fn()}},Et.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?be(new B.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(d){return l.hook.reading.fire(d)})}).then(s)},Et.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(f(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(w){if(w.compound&&s.every(function(K){return 0<=w.keyPath.indexOf(K)})){for(var I=0;I<s.length;++I)if(s.indexOf(w.keyPath[I])===-1)return!1;return!0}return!1}).sort(function(w,I){return w.keyPath.length-I.keyPath.length})[0];if(l&&this.db._maxKey!==Ze)return _=l.keyPath.slice(0,s.length),this.where(_).equals(_.map(function(w){return n[w]}));!l&&st&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function d(w,I){return ot(w,I)===0}var _=s.reduce(function(R,I){var K=R[0],R=R[1],C=c[I],j=n[I];return[K||C,K||!C?ht(R,C&&C.multi?function(L){return L=$(L,I),f(L)&&L.some(function(O){return d(j,O)})}:function(L){return d(j,$(L,I))}):R]},[null,null]),p=_[0],_=_[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(_):l?this.filter(_):this.where(s).equals("")},Et.prototype.filter=function(n){return this.toCollection().and(n)},Et.prototype.count=function(n){return this.toCollection().count(n)},Et.prototype.offset=function(n){return this.toCollection().offset(n)},Et.prototype.limit=function(n){return this.toCollection().limit(n)},Et.prototype.each=function(n){return this.toCollection().each(n)},Et.prototype.toArray=function(n){return this.toCollection().toArray(n)},Et.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Et.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,f(n)?"[".concat(n.join("+"),"]"):n))},Et.prototype.reverse=function(){return this.toCollection().reverse()},Et.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof tl&&(n=(_=>{var w=R,I=_;if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function K(){this.constructor=w}function R(){return _!==null&&_.apply(this,arguments)||this}return r(w,I),w.prototype=I===null?Object.create(I):(K.prototype=I.prototype,new K),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),d=n.prototype;d;d=v(d))Object.getOwnPropertyNames(d).forEach(function(_){return c.add(_)});function p(_){if(!_)return _;var w,I=Object.create(n.prototype);for(w in _)if(!c.has(w))try{I[w]=_[w]}catch{}return I}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},Et.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},Et.prototype.add=function(n,s){var l=this,c=this.schema.primKey,d=c.auto,p=c.keyPath,_=n;return p&&d&&(_=br(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"add",keys:s!=null?[s]:null,values:[_]})}).then(function(w){return w.numFailures?Pe.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{G(n,p,w)}catch{}return w})},Et.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(d){return l.core.get({trans:d,key:n}).then(function(p){var _=p??{};return sl(_,s),c&&G(_,c,n),l.core.mutate({trans:d,type:"put",values:[_],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(w){return w.numFailures?Pe.reject(w.failures[0]):!!p})})})},Et.prototype.update=function(n,s){return typeof n!="object"||f(n)?this.where(":id").equals(n).modify(s):(n=$(n,this.schema.primKey.keyPath))===void 0?be(new B.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},Et.prototype.put=function(n,s){var l=this,c=this.schema.primKey,d=c.auto,p=c.keyPath,_=n;return p&&d&&(_=br(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"put",values:[_],keys:s!=null?[s]:null})}).then(function(w){return w.numFailures?Pe.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{G(n,p,w)}catch{}return w})},Et.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Es(s,[n],c)}).then(function(c){return c.numFailures?Pe.reject(c.failures[0]):void 0})})},Et.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:yr}).then(function(l){return Es(n,null,l)})}).then(function(s){return s.numFailures?Pe.reject(s.failures[0]):void 0})},Et.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(d){return s.hook.reading.fire(d)})})})},Et.prototype.bulkAdd=function(n,s,l){var c=this,d=Array.isArray(s)?s:void 0,p=(l=l||(d?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(_){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&d)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,K=w&&K?n.map(br(w)):n;return c.core.mutate({trans:_,type:"add",keys:d,values:K,wantResults:p}).then(function(R){var C=R.numFailures,j=R.failures;if(C===0)return p?R.results:R.lastResult;throw new Ge("".concat(c.name,".bulkAdd(): ").concat(C," of ").concat(I," operations failed"),j)})})},Et.prototype.bulkPut=function(n,s,l){var c=this,d=Array.isArray(s)?s:void 0,p=(l=l||(d?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(_){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&d)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,K=w&&K?n.map(br(w)):n;return c.core.mutate({trans:_,type:"put",keys:d,values:K,wantResults:p}).then(function(R){var C=R.numFailures,j=R.failures;if(C===0)return p?R.results:R.lastResult;throw new Ge("".concat(c.name,".bulkPut(): ").concat(C," of ").concat(I," operations failed"),j)})})},Et.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(_){return _.key}),d=n.map(function(_){return _.changes}),p=[];return this._trans("readwrite",function(_){return l.getMany({trans:_,keys:c,cache:"clone"}).then(function(w){var I=[],K=[],R=(n.forEach(function(C,j){var L=C.key,O=C.changes,P=w[j];if(P){for(var H=0,X=Object.keys(O);H<X.length;H++){var F=X[H],se=O[F];if(F===s.schema.primKey.keyPath){if(ot(se,L)!==0)throw new B.Constraint("Cannot update primary key in bulkUpdate()")}else G(P,F,se)}p.push(j),I.push(L),K.push(P)}}),I.length);return l.mutate({trans:_,type:"put",keys:I,values:K,updates:{keys:c,changeSpecs:d}}).then(function(C){var j=C.numFailures,L=C.failures;if(j===0)return R;for(var O=0,P=Object.keys(L);O<P.length;O++){var H,X=P[O],F=p[Number(X)];F!=null&&(H=L[X],delete L[X],L[F]=H)}throw new Ge("".concat(s.name,".bulkUpdate(): ").concat(j," of ").concat(R," operations failed"),L)})})})},Et.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(d){return Es(s,n,d)})}).then(function(c){var d=c.numFailures,p=c.failures;if(d===0)return c.lastResult;throw new Ge("".concat(s.name,".bulkDelete(): ").concat(d," of ").concat(l," operations failed"),p)})};var il=Et;function Et(){}function Ha(n){function s(_,w){if(w){for(var I=arguments.length,K=new Array(I-1);--I;)K[I-1]=arguments[I];return l[_].subscribe.apply(null,K),n}if(typeof _=="string")return l[_]}var l={};s.addEventType=p;for(var c=1,d=arguments.length;c<d;++c)p(arguments[c]);return s;function p(_,w,I){var K,R;if(typeof _!="object")return w=w||Ye,R={subscribers:[],fire:I=I||Te,subscribe:function(C){R.subscribers.indexOf(C)===-1&&(R.subscribers.push(C),R.fire=w(R.fire,C))},unsubscribe:function(C){R.subscribers=R.subscribers.filter(function(j){return j!==C}),R.fire=R.subscribers.reduce(w,I)}},l[_]=s[_]=R;u(K=_).forEach(function(C){var j=K[C];if(f(j))p(C,K[C][0],K[C][1]);else{if(j!=="asap")throw new B.InvalidArgument("Invalid event config");var L=p(C,De,function(){for(var O=arguments.length,P=new Array(O);O--;)P[O]=arguments[O];L.subscribers.forEach(function(H){Y(function(){H.apply(null,P)})})})}})}}function Wa(n,s){return E(s).from({prototype:n}),s}function Sa(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function _i(n,s){n.filter=ht(n.filter,s)}function yi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return ht(c(),s())}:s,n.justLimit=l&&!c}function As(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new B.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function ol(n,s,l){var c=As(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function Cs(n,s,l,c){var d,p,_=n.replayFilter?ht(n.filter,n.replayFilter()):n.filter;return n.or?(d={},p=function(w,I,K){var R,C;_&&!_(I,K,function(j){return I.stop(j)},function(j){return I.fail(j)})||((C=""+(R=I.primaryKey))=="[object ArrayBuffer]"&&(C=""+new Uint8Array(R)),S(d,C))||(d[C]=!0,s(w,I,K))},Promise.all([n.or._iterate(p,l),ll(ol(n,c,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):ll(ol(n,c,l),ht(n.algorithm,_),s,!n.keysOnly&&n.valueMapper)}function ll(n,s,l,c){var d=lt(c?function(p,_,w){return l(c(p),_,w)}:l);return n.then(function(p){if(p)return p.start(function(){var _=function(){return p.continue()};s&&!s(p,function(w){return _=w},function(w){p.stop(w),_=Te},function(w){p.fail(w),_=Te})||d(p.value,p,function(w){return _=w}),_()})})}dt.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,be.bind(null,l.error)):l.table._trans("readonly",n).then(s)},dt.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,be.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},dt.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=ht(s.algorithm,n)},dt.prototype._iterate=function(n,s){return Cs(this._ctx,n,s,this._ctx.table.core)},dt.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&h(l,n),s._ctx=l,s},dt.prototype.raw=function(){return this._ctx.valueMapper=null,this},dt.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Cs(s,n,l,s.table.core)})},dt.prototype.count=function(n){var s=this;return this._read(function(l){var c,d=s._ctx,p=d.table.core;return Sa(d,!0)?p.count({trans:l,query:{index:As(d,p.schema),range:d.range}}).then(function(_){return Math.min(_,d.limit)}):(c=0,Cs(d,function(){return++c,!1},l,p).then(function(){return c}))}).then(n)},dt.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],d=l.length-1;function p(I,K){return K?p(I[l[K]],K-1):I[c]}var _=this._ctx.dir==="next"?1:-1;function w(I,K){return ot(p(I,d),p(K,d))*_}return this.toArray(function(I){return I.sort(w)}).then(s)},dt.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,d,p,_=s._ctx;return _.dir==="next"&&Sa(_,!0)&&0<_.limit?(c=_.valueMapper,d=As(_,_.table.core.schema),_.table.core.query({trans:l,limit:_.limit,values:!0,query:{index:d,range:_.range}}).then(function(w){return w=w.result,c?w.map(c):w})):(p=[],Cs(_,function(w){return p.push(w)},l,_.table.core).then(function(){return p}))},n)},dt.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,Sa(s)?yi(s,function(){var l=n;return function(c,d){return l===0||(l===1?--l:d(function(){c.advance(l),l=0}),!1)}}):yi(s,function(){var l=n;return function(){return--l<0}})),this},dt.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),yi(this._ctx,function(){var s=n;return function(l,c,d){return--s<=0&&c(d),0<=s}},!0),this},dt.prototype.until=function(n,s){return _i(this._ctx,function(l,c,d){return!n(l.value)||(c(d),s)}),this},dt.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},dt.prototype.last=function(n){return this.reverse().first(n)},dt.prototype.filter=function(n){var s;return _i(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=ht(s.isMatch,n),this},dt.prototype.and=function(n){return this.filter(n)},dt.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},dt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},dt.prototype.desc=function(){return this.reverse()},dt.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},dt.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},dt.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},dt.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,d){l.push(d.key)}).then(function(){return l}).then(n)},dt.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&Sa(s,!0)&&0<s.limit)return this._read(function(c){var d=As(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:d,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,d){l.push(d.primaryKey)}).then(function(){return l}).then(n)},dt.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},dt.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},dt.prototype.lastKey=function(n){return this.reverse().firstKey(n)},dt.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},_i(this._ctx,function(c){var c=c.primaryKey.toString(),d=S(n,c);return n[c]=!0,!d})),this},dt.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function d(P,H){var X=H.failures;j+=P-H.numFailures;for(var F=0,se=u(X);F<se.length;F++){var me=se[F];C.push(X[me])}}var p=typeof n=="function"?n:function(P){return sl(P,n)},_=l.table.core,R=_.schema.primaryKey,w=R.outbound,I=R.extractKey,K=200,R=s.db._options.modifyChunkSize,C=(R&&(K=typeof R=="object"?R[_.name]||R["*"]||200:R),[]),j=0,L=[],O=n===cl;return s.clone().primaryKeys().then(function(P){function H(F){var se=Math.min(K,P.length-F),me=P.slice(F,F+se);return(O?Promise.resolve([]):_.getMany({trans:c,keys:me,cache:"immutable"})).then(function(Ae){var Ce=[],ge=[],Me=w?[]:null,Ie=O?me:[];if(!O)for(var xe=0;xe<se;++xe){var Le=Ae[xe],ct={value:le(Le),primKey:P[F+xe]};p.call(ct,ct.value,ct)!==!1&&(ct.value==null?Ie.push(P[F+xe]):w||ot(I(Le),I(ct.value))===0?(ge.push(ct.value),w&&Me.push(P[F+xe])):(Ie.push(P[F+xe]),Ce.push(ct.value)))}return Promise.resolve(0<Ce.length&&_.mutate({trans:c,type:"add",values:Ce}).then(function(vt){for(var Fe in vt.failures)Ie.splice(parseInt(Fe),1);d(Ce.length,vt)})).then(function(){return(0<ge.length||X&&typeof n=="object")&&_.mutate({trans:c,type:"put",keys:Me,values:ge,criteria:X,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<F}).then(function(vt){return d(ge.length,vt)})}).then(function(){return(0<Ie.length||X&&O)&&_.mutate({trans:c,type:"delete",keys:Ie,criteria:X,isAdditionalChunk:0<F}).then(function(vt){return Es(l.table,Ie,vt)}).then(function(vt){return d(Ie.length,vt)})}).then(function(){return P.length>F+se&&H(F+K)})})}var X=Sa(l)&&l.limit===1/0&&(typeof n!="function"||O)&&{index:l.index,range:l.range};return H(0).then(function(){if(0<C.length)throw new Be("Error modifying one or more objects",C,j,L);return P.length})})})},dt.prototype.delete=function(){var n=this._ctx,s=n.range;return!Sa(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(cl):this._write(function(l){var c=n.table.core.schema.primaryKey,d=s;return n.table.core.count({trans:l,query:{index:c,range:d}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:d}).then(function(I){var w=I.failures,I=I.numFailures;if(I)throw new Be("Could not delete some values",Object.keys(w).map(function(K){return w[K]}),p-I);return p-I})})})};var rf=dt;function dt(){}var cl=function(n,s){return s.value=null};function af(n,s){return n<s?-1:n===s?0:1}function sf(n,s){return s<n?-1:n===s?0:1}function In(n,s,l){return n=n instanceof fl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function Ta(n){return new n.Collection(n,function(){return ul("")}).limit(0)}function Ps(L,s,l,c){var d,p,_,w,I,K,R,C=l.length;if(!l.every(function(P){return typeof P=="string"}))return In(L,Tt);function j(P){d=P==="next"?function(X){return X.toUpperCase()}:function(X){return X.toLowerCase()},p=P==="next"?function(X){return X.toLowerCase()}:function(X){return X.toUpperCase()},_=P==="next"?af:sf;var H=l.map(function(X){return{lower:p(X),upper:d(X)}}).sort(function(X,F){return _(X.lower,F.lower)});w=H.map(function(X){return X.upper}),I=H.map(function(X){return X.lower}),R=(K=P)==="next"?"":c}j("next");var L=new L.Collection(L,function(){return jr(w[0],I[C-1]+c)}),O=(L._ondirectionchange=function(P){j(P)},0);return L._addAlgorithm(function(P,H,X){var F=P.key;if(typeof F=="string"){var se=p(F);if(s(se,I,O))return!0;for(var me=null,Ae=O;Ae<C;++Ae){var Ce=((ge,Me,Ie,xe,Le,ct)=>{for(var vt=Math.min(ge.length,xe.length),Fe=-1,Xe=0;Xe<vt;++Xe){var Dt=Me[Xe];if(Dt!==xe[Xe])return Le(ge[Xe],Ie[Xe])<0?ge.substr(0,Xe)+Ie[Xe]+Ie.substr(Xe+1):Le(ge[Xe],xe[Xe])<0?ge.substr(0,Xe)+xe[Xe]+Ie.substr(Xe+1):0<=Fe?ge.substr(0,Fe)+Me[Fe]+Ie.substr(Fe+1):null;Le(ge[Xe],Dt)<0&&(Fe=Xe)}return vt<xe.length&&ct==="next"?ge+Ie.substr(ge.length):vt<ge.length&&ct==="prev"?ge.substr(0,Ie.length):Fe<0?null:ge.substr(0,Fe)+xe[Fe]+Ie.substr(Fe+1)})(F,se,w[Ae],I[Ae],_,K);Ce===null&&me===null?O=Ae+1:(me===null||0<_(me,Ce))&&(me=Ce)}H(me!==null?function(){P.continue(me+R)}:X)}return!1}),L}function jr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function ul(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Ht.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ht.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?Ta(this):new this.Collection(this,function(){return jr(n,s,!l,!c)})}catch{return In(this,wt)}},Ht.prototype.equals=function(n){return n==null?In(this,wt):new this.Collection(this,function(){return ul(n)})},Ht.prototype.above=function(n){return n==null?In(this,wt):new this.Collection(this,function(){return jr(n,void 0,!0)})},Ht.prototype.aboveOrEqual=function(n){return n==null?In(this,wt):new this.Collection(this,function(){return jr(n,void 0,!1)})},Ht.prototype.below=function(n){return n==null?In(this,wt):new this.Collection(this,function(){return jr(void 0,n,!1,!0)})},Ht.prototype.belowOrEqual=function(n){return n==null?In(this,wt):new this.Collection(this,function(){return jr(void 0,n)})},Ht.prototype.startsWith=function(n){return typeof n!="string"?In(this,Tt):this.between(n,n+Ze,!0,!0)},Ht.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ps(this,function(s,l){return s.indexOf(l[0])===0},[n],Ze)},Ht.prototype.equalsIgnoreCase=function(n){return Ps(this,function(s,l){return s===l[0]},[n],"")},Ht.prototype.anyOfIgnoreCase=function(){var n=ve.apply(pe,arguments);return n.length===0?Ta(this):Ps(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Ht.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(pe,arguments);return n.length===0?Ta(this):Ps(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,Ze)},Ht.prototype.anyOf=function(){var n,s,l=this,c=ve.apply(pe,arguments),d=this._cmp;try{c.sort(d)}catch{return In(this,wt)}return c.length===0?Ta(this):((n=new this.Collection(this,function(){return jr(c[0],c[c.length-1])}))._ondirectionchange=function(p){d=p==="next"?l._ascending:l._descending,c.sort(d)},s=0,n._addAlgorithm(function(p,_,w){for(var I=p.key;0<d(I,c[s]);)if(++s===c.length)return _(w),!1;return d(I,c[s])===0||(_(function(){p.continue(c[s])}),!1)}),n)},Ht.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ht.prototype.noneOf=function(){var n=ve.apply(pe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return In(this,wt)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Ht.prototype.inAnyRange=function(n,X){var l=this,c=this._cmp,d=this._ascending,p=this._descending,_=this._min,w=this._max;if(n.length===0)return Ta(this);if(!n.every(function(F){return F[0]!==void 0&&F[1]!==void 0&&d(F[0],F[1])<=0}))return In(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);var I=!X||X.includeLowers!==!1,K=X&&X.includeUppers===!0,R,C=d;function j(F,se){return C(F[0],se[0])}try{(R=n.reduce(function(F,se){for(var me=0,Ae=F.length;me<Ae;++me){var Ce=F[me];if(c(se[0],Ce[1])<0&&0<c(se[1],Ce[0])){Ce[0]=_(Ce[0],se[0]),Ce[1]=w(Ce[1],se[1]);break}}return me===Ae&&F.push(se),F},[])).sort(j)}catch{return In(this,wt)}var L=0,O=K?function(F){return 0<d(F,R[L][1])}:function(F){return 0<=d(F,R[L][1])},P=I?function(F){return 0<p(F,R[L][0])}:function(F){return 0<=p(F,R[L][0])},H=O,X=new this.Collection(this,function(){return jr(R[0][0],R[R.length-1][1],!I,!K)});return X._ondirectionchange=function(F){C=F==="next"?(H=O,d):(H=P,p),R.sort(j)},X._addAlgorithm(function(F,se,me){for(var Ae,Ce=F.key;H(Ce);)if(++L===R.length)return se(me),!1;return!O(Ae=Ce)&&!P(Ae)||(l._cmp(Ce,R[L][1])===0||l._cmp(Ce,R[L][0])===0||se(function(){C===d?F.continue(R[L][0]):F.continue(R[L][1])}),!1)}),X},Ht.prototype.startsWithAnyOf=function(){var n=ve.apply(pe,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?Ta(this):this.inAnyRange(n.map(function(s){return[s,s+Ze]})):In(this,"startsWithAnyOf() only works with strings")};var fl=Ht;function Ht(){}function or(n){return lt(function(s){return Va(s),n(s.target.error),!1})}function Va(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Ya="storagemutated",bi="x-storagemutated-1",Mr=Ha(null,Ya),of=(lr.prototype._lock=function(){return q(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},lr.prototype._unlock=function(){if(q(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ne(n[1],n[0])}catch{}}return this},lr.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},lr.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(q(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new B.DatabaseClosed(c);case"MissingAPIError":throw new B.MissingAPI(c.message,c);default:throw new B.OpenFailed(c)}if(!this.active)throw new B.TransactionInactive;q(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=lt(function(d){Va(d),s._reject(n.error)}),n.onabort=lt(function(d){Va(d),s.active&&s._reject(new B.Abort(n.error)),s.active=!1,s.on("abort").fire(d)}),n.oncomplete=lt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Mr.storagemutated.fire(n.mutatedParts)})}return this},lr.prototype._promise=function(n,s,l){var c,d=this;return n==="readwrite"&&this.mode!=="readwrite"?be(new B.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Pe(function(p,_){d._blockedFuncs.push([function(){d._promise(n,s,l).then(p,_)},je])}):l?Cn(function(){var p=new Pe(function(_,w){d._lock();var I=s(_,w,d);I&&I.then&&I.then(_,w)});return p.finally(function(){return d._unlock()}),p._lib=!0,p}):((c=new Pe(function(p,_){var w=s(p,_,d);w&&w.then&&w.then(p,_)}))._lib=!0,c):be(new B.TransactionInactive)},lr.prototype._root=function(){return this.parent?this.parent._root():this},lr.prototype.waitFor=function(n){var s,l=this._root(),c=Pe.resolve(n),d=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Pe(function(p,_){c.then(function(w){return l._waitingQueue.push(lt(p.bind(null,w)))},function(w){return l._waitingQueue.push(lt(_.bind(null,w)))}).finally(function(){l._waitingFor===d&&(l._waitingFor=null)})})},lr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))},lr.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(S(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new B.NotFound("Table "+n+" not part of transaction")},lr);function lr(){}function wi(n,s,l,c,d,p,_,w){return{name:n,keyPath:s,unique:l,multi:c,auto:d,compound:p,src:(l&&!_?"&":"")+(c?"*":"")+(d?"++":"")+dl(s),type:w}}function dl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function ki(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(d){return[d.name,d]},l.reduce(function(d,p,_){return p=c(p,_),p&&(d[p[0]]=p[1]),d},{}))};var c}var Xa=function(n){try{return n.only([[]]),Xa=function(){return[[]]},[[]]}catch{return Xa=function(){return Ze},Ze}};function xi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return $(l,s)}:function(l){return $(l,n)};var s}function vl(n){return[].slice.call(n)}var lf=0;function Qa(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function cf(n,s,I){function c(O){if(O.type===3)return null;if(O.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var C=O.lower,j=O.upper,L=O.lowerOpen,O=O.upperOpen;return C===void 0?j===void 0?null:s.upperBound(j,!!O):j===void 0?s.lowerBound(C,!!L):s.bound(C,j,!!L,!!O)}function d(R){var C,j=R.name;return{name:j,schema:R,mutate:function(L){var O=L.trans,P=L.type,H=L.keys,X=L.values,F=L.range;return new Promise(function(se,me){se=lt(se);var Ae=O.objectStore(j),Ce=Ae.keyPath==null,ge=P==="put"||P==="add";if(!ge&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var Me,Ie=(H||X||{length:1}).length;if(H&&X&&H.length!==X.length)throw new Error("Given keys array must have same length as given values array.");if(Ie===0)return se({numFailures:0,failures:{},results:[],lastResult:void 0});function xe(jt){++vt,Va(jt)}var Le=[],ct=[],vt=0;if(P==="deleteRange"){if(F.type===4)return se({numFailures:vt,failures:ct,results:[],lastResult:void 0});F.type===3?Le.push(Me=Ae.clear()):Le.push(Me=Ae.delete(c(F)))}else{var Ce=ge?Ce?[X,H]:[X,null]:[H,null],Fe=Ce[0],Xe=Ce[1];if(ge)for(var Dt=0;Dt<Ie;++Dt)Le.push(Me=Xe&&Xe[Dt]!==void 0?Ae[P](Fe[Dt],Xe[Dt]):Ae[P](Fe[Dt])),Me.onerror=xe;else for(Dt=0;Dt<Ie;++Dt)Le.push(Me=Ae[P](Fe[Dt])),Me.onerror=xe}function Bn(jt){jt=jt.target.result,Le.forEach(function(Zr,Fi){return Zr.error!=null&&(ct[Fi]=Zr.error)}),se({numFailures:vt,failures:ct,results:P==="delete"?H:Le.map(function(Zr){return Zr.result}),lastResult:jt})}Me.onerror=function(jt){xe(jt),Bn(jt)},Me.onsuccess=Bn})},getMany:function(L){var O=L.trans,P=L.keys;return new Promise(function(H,X){H=lt(H);for(var F,se=O.objectStore(j),me=P.length,Ae=new Array(me),Ce=0,ge=0,Me=function(Le){Le=Le.target,Ae[Le._pos]=Le.result,++ge===Ce&&H(Ae)},Ie=or(X),xe=0;xe<me;++xe)P[xe]!=null&&((F=se.get(P[xe]))._pos=xe,F.onsuccess=Me,F.onerror=Ie,++Ce);Ce===0&&H(Ae)})},get:function(L){var O=L.trans,P=L.key;return new Promise(function(H,X){H=lt(H);var F=O.objectStore(j).get(P);F.onsuccess=function(se){return H(se.target.result)},F.onerror=or(X)})},query:(C=w,function(L){return new Promise(function(O,P){O=lt(O);var H,X,F,ge=L.trans,se=L.values,me=L.limit,Ce=L.query,Ae=me===1/0?void 0:me,Me=Ce.index,Ce=Ce.range,ge=ge.objectStore(j),ge=Me.isPrimaryKey?ge:ge.index(Me.name),Me=c(Ce);if(me===0)return O({result:[]});C?((Ce=se?ge.getAll(Me,Ae):ge.getAllKeys(Me,Ae)).onsuccess=function(Ie){return O({result:Ie.target.result})},Ce.onerror=or(P)):(H=0,X=!se&&"openKeyCursor"in ge?ge.openKeyCursor(Me):ge.openCursor(Me),F=[],X.onsuccess=function(Ie){var xe=X.result;return!xe||(F.push(se?xe.value:xe.primaryKey),++H===me)?O({result:F}):void xe.continue()},X.onerror=or(P))})}),openCursor:function(L){var O=L.trans,P=L.values,H=L.query,X=L.reverse,F=L.unique;return new Promise(function(se,me){se=lt(se);var ge=H.index,Ae=H.range,Ce=O.objectStore(j),Ce=ge.isPrimaryKey?Ce:Ce.index(ge.name),ge=X?F?"prevunique":"prev":F?"nextunique":"next",Me=!P&&"openKeyCursor"in Ce?Ce.openKeyCursor(c(Ae),ge):Ce.openCursor(c(Ae),ge);Me.onerror=or(me),Me.onsuccess=lt(function(Ie){var xe,Le,ct,vt,Fe=Me.result;Fe?(Fe.___id=++lf,Fe.done=!1,xe=Fe.continue.bind(Fe),Le=(Le=Fe.continuePrimaryKey)&&Le.bind(Fe),ct=Fe.advance.bind(Fe),vt=function(){throw new Error("Cursor not stopped")},Fe.trans=O,Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=function(){throw new Error("Cursor not started")},Fe.fail=lt(me),Fe.next=function(){var Xe=this,Dt=1;return this.start(function(){return Dt--?Xe.continue():Xe.stop()}).then(function(){return Xe})},Fe.start=function(Xe){function Dt(){if(Me.result)try{Xe()}catch(jt){Fe.fail(jt)}else Fe.done=!0,Fe.start=function(){throw new Error("Cursor behind last entry")},Fe.stop()}var Bn=new Promise(function(jt,Zr){jt=lt(jt),Me.onerror=or(Zr),Fe.fail=Zr,Fe.stop=function(Fi){Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=vt,jt(Fi)}});return Me.onsuccess=lt(function(jt){Me.onsuccess=Dt,Dt()}),Fe.continue=xe,Fe.continuePrimaryKey=Le,Fe.advance=ct,Dt(),Bn},se(Fe)):se(null)},me)})},count:function(L){var O=L.query,P=L.trans,H=O.index,X=O.range;return new Promise(function(F,se){var me=P.objectStore(j),me=H.isPrimaryKey?me:me.index(H.name),Ae=c(X),Ae=Ae?me.count(Ae):me.count();Ae.onsuccess=lt(function(Ce){return F(Ce.target.result)}),Ae.onerror=or(se)})}}}p=I,_=vl((I=n).objectStoreNames);var p,I={schema:{name:I.name,tables:_.map(function(R){return p.objectStore(R)}).map(function(R){var C=R.keyPath,j=R.autoIncrement,O=f(C),L={},O={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:C==null,compound:O,keyPath:C,autoIncrement:j,unique:!0,extractKey:xi(C)},indexes:vl(R.indexNames).map(function(P){return R.index(P)}).map(function(F){var se=F.name,H=F.unique,X=F.multiEntry,F=F.keyPath,se={name:se,compound:f(F),keyPath:F,unique:H,multiEntry:X,extractKey:xi(F)};return L[Qa(F)]=se}),getIndexByKeyPath:function(P){return L[Qa(P)]}};return L[":id"]=O.primaryKey,C!=null&&(L[Qa(C)]=O.primaryKey),O})},hasGetAll:0<_.length&&"getAll"in p.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},_=I.schema,w=I.hasGetAll,I=_.tables.map(d),K={};return I.forEach(function(R){return K[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(K[R])return K[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Xa(s),schema:_}}function uf(n,s,l,c){return l=l.IDBKeyRange,s=cf(s,l,c),{dbcore:n.dbcore.reduce(function(d,p){return p=p.create,a(a({},d),p(d))},s)}}function Is(n,s){var l=s.db,l=uf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(p){return p.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table)&&(n[d].core=c.core)})}function Rs(n,s,l,c){l.forEach(function(d){var p=c[d];s.forEach(function(_){var w=(function I(K,R){return A(K,R)||(K=v(K))&&I(K,R)})(_,d);(!w||"value"in w&&w.value===void 0)&&(_===n.Transaction.prototype||_ instanceof n.Transaction?N(_,d,{get:function(){return this.table(d)},set:function(I){k(this,d,{value:I,writable:!0,configurable:!0,enumerable:!0})}}):_[d]=new n.Table(d,p))})})}function Si(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function ff(n,s){return n._cfg.version-s._cfg.version}function df(n,s,l,c){var d=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!d.$meta&&(d.$meta=ki("$meta",hl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,d)),_=(p.create(l),p._completion.catch(c),p._reject.bind(p)),w=je.transless||je;Cn(function(){if(je.trans=p,je.transless=w,s!==0)return Is(n,l),K=s,((I=p).storeNames.includes("$meta")?I.table("$meta").get("version").then(function(R){return R??K}):Pe.resolve(K)).then(function(H){var C=n,j=H,L=p,O=l,P=[],H=C._versions,X=C._dbSchema=Ds(0,C.idbdb,O);return(H=H.filter(function(F){return F._cfg.version>=j})).length===0?Pe.resolve():(H.forEach(function(F){P.push(function(){var se,me,Ae,Ce=X,ge=F._cfg.dbschema,Me=(js(C,Ce,O),js(C,ge,O),X=C._dbSchema=ge,Ti(Ce,ge)),Ie=(Me.add.forEach(function(xe){Ei(O,xe[0],xe[1].primKey,xe[1].indexes)}),Me.change.forEach(function(xe){if(xe.recreate)throw new B.Upgrade("Not yet support for changing primary key");var Le=O.objectStore(xe.name);xe.add.forEach(function(ct){return Os(Le,ct)}),xe.change.forEach(function(ct){Le.deleteIndex(ct.name),Os(Le,ct)}),xe.del.forEach(function(ct){return Le.deleteIndex(ct)})}),F._cfg.contentUpgrade);if(Ie&&F._cfg.version>j)return Is(C,O),L._memoizedTables={},se=ue(ge),Me.del.forEach(function(xe){se[xe]=Ce[xe]}),Si(C,[C.Transaction.prototype]),Rs(C,[C.Transaction.prototype],u(se),se),L.schema=se,(me=ae(Ie))&&zt(),ge=Pe.follow(function(){var xe;(Ae=Ie(L))&&me&&(xe=bn.bind(null,null),Ae.then(xe,xe))}),Ae&&typeof Ae.then=="function"?Pe.resolve(Ae):ge.then(function(){return Ae})}),P.push(function(se){var me,Ae,Ce=F._cfg.dbschema;me=Ce,Ae=se,[].slice.call(Ae.db.objectStoreNames).forEach(function(ge){return me[ge]==null&&Ae.db.deleteObjectStore(ge)}),Si(C,[C.Transaction.prototype]),Rs(C,[C.Transaction.prototype],C._storeNames,C._dbSchema),L.schema=C._dbSchema}),P.push(function(se){C.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(C.idbdb.version/10)===F._cfg.version?(C.idbdb.deleteObjectStore("$meta"),delete C._dbSchema.$meta,C._storeNames=C._storeNames.filter(function(me){return me!=="$meta"})):se.objectStore("$meta").put(F._cfg.version,"version"))})}),(function F(){return P.length?Pe.resolve(P.shift()(L.idbtrans)).then(F):Pe.resolve()})().then(function(){pl(X,O)}))}).catch(_);var I,K;u(d).forEach(function(R){Ei(l,R,d[R].primKey,d[R].indexes)}),Is(n,l),Pe.follow(function(){return n.on.populate.fire(p)}).catch(_)})}function vf(n,s){pl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Ds(0,n.idbdb,s);js(n,n._dbSchema,s);for(var c=0,d=Ti(l,n._dbSchema).change;c<d.length;c++){var p=(_=>{if(_.change.length||_.recreate)return console.warn("Unable to patch indexes of table ".concat(_.name," because it has changes on the type of index or primary key.")),{value:void 0};var w=s.objectStore(_.name);_.add.forEach(function(I){st&&console.debug("Dexie upgrade patch: Creating missing index ".concat(_.name,".").concat(I.src)),Os(w,I)})})(d[c]);if(typeof p=="object")return p.value}}function Ti(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var d=n[l],p=s[l];if(d){var _={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(d.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||d.primKey.auto!==p.primKey.auto)_.recreate=!0,c.change.push(_);else{var w=d.idxByName,I=p.idxByName,K=void 0;for(K in w)I[K]||_.del.push(K);for(K in I){var R=w[K],C=I[K];R?R.src!==C.src&&_.change.push(C):_.add.push(C)}(0<_.del.length||0<_.add.length||0<_.change.length)&&c.change.push(_)}}else c.add.push([l,p])}return c}function Ei(n,s,l,c){var d=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(p){return Os(d,p)})}function pl(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(st&&console.debug("Dexie: Creating missing table",l),Ei(s,l,n[l].primKey,n[l].indexes))})}function Os(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ds(n,s,l){var c={};return de(s.objectStoreNames,0).forEach(function(d){for(var p=l.objectStore(d),_=wi(dl(K=p.keyPath),K||"",!0,!1,!!p.autoIncrement,K&&typeof K!="string",!0),w=[],I=0;I<p.indexNames.length;++I){var R=p.index(p.indexNames[I]),K=R.keyPath,R=wi(R.name,K,!!R.unique,!!R.multiEntry,!1,K&&typeof K!="string",!1);w.push(R)}c[d]=ki(d,_,w)}),c}function js(n,s,l){for(var c=l.db.objectStoreNames,d=0;d<c.length;++d){var p=c[d],_=l.objectStore(p);n._hasGetAll="getAll"in _;for(var w=0;w<_.indexNames.length;++w){var I,K=_.indexNames[w],R=_.index(K).keyPath,R=typeof R=="string"?R:"["+de(R).join("+")+"]";s[p]&&(I=s[p].idxByName[R])&&(I.name=K,delete s[p].idxByName[R],s[p].idxByName[K]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function hl(n){return n.split(",").map(function(s,l){var d=s.split(":"),c=(c=d[1])==null?void 0:c.trim(),d=(s=d[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(d)?d.match(/^\[(.*)\]$/)[1].split("+"):d;return wi(d,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),f(p),l===0,c)})}Ea.prototype._createTableSchema=ki,Ea.prototype._parseIndexSyntax=hl,Ea.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var d=l._parseIndexSyntax(n[c]),p=d.shift();if(!p)throw new B.Schema("Invalid schema for table "+c+": "+n[c]);if(p.unique=!0,p.multi)throw new B.Schema("Primary key cannot be multiEntry*");d.forEach(function(_){if(_.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!_.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(c,p,d),s[c]=p}})},Ea.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,l):l,s._versions),c={},d={};return l.forEach(function(p){h(c,p._cfg.storesSource),d=p._cfg.dbschema={},p._parseStoresSpec(c,d)}),s._dbSchema=d,Si(s,[s._allTables,s,s.Transaction.prototype]),Rs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(d),d),s._storeNames=u(d),this},Ea.prototype.upgrade=function(n){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||Te,n),this};var pf=Ea;function Ea(){}function Ai(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new wr(sn,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ci(n){return n&&typeof n.databases=="function"}function Pi(n){return Cn(function(){return je.letThrough=!0,n()})}function Ii(n){return!("from"in n)}var on=function(n,s){var l;if(!this)return l=new on,n&&"d"in n&&h(l,n),l;h(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Za(n,s,l){var c=ot(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Ii(n))return h(n,{from:s,to:l,d:1});var c=n.l,d=n.r;if(ot(l,n.from)<0)return c?Za(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},gl(n);if(0<ot(s,n.to))return d?Za(d,s,l):n.r={from:s,to:l,d:1,l:null,r:null},gl(n);ot(s,n.from)<0&&(n.from=s,n.l=null,n.d=d?d.d+1:1),0<ot(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Ja(n,c),d&&s&&Ja(n,d)}}function Ja(n,s){Ii(s)||(function l(c,d){var p=d.from,_=d.l,w=d.r;Za(c,p,d.to),_&&l(c,_),w&&l(c,w)})(n,s)}function ml(n,s){var l=Ms(s),c=l.next();if(!c.done)for(var d=c.value,p=Ms(n),_=p.next(d.from),w=_.value;!c.done&&!_.done;){if(ot(w.from,d.to)<=0&&0<=ot(w.to,d.from))return!0;ot(d.from,w.from)<0?d=(c=l.next(w.from)).value:w=(_=p.next(d.from)).value}return!1}function Ms(n){var s=Ii(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&ot(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||ot(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function gl(n){var s,l,c,d=(((d=n.r)==null?void 0:d.d)||0)-(((d=n.l)==null?void 0:d.d)||0),d=1<d?"r":d<-1?"l":"";d&&(s=d=="r"?"l":"r",l=a({},n),c=n[d],n.from=c.from,n.to=c.to,n[d]=c[d],l[d]=c[s],(n[s]=l).d=_l(l)),n.d=_l(n)}function _l(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Ls(n,s){return u(s).forEach(function(l){n[l]?Ja(n[l],s[l]):n[l]=(function c(d){var p,_,w={};for(p in d)S(d,p)&&(_=d[p],w[p]=!_||typeof _!="object"||ie.has(_.constructor)?_:c(_));return w})(s[l])}),n}function Ri(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&ml(s[l],n[l])})}x(on.prototype,((pt={add:function(n){return Ja(this,n),this},addKey:function(n){return Za(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Za(s,l,l)}),this},hasKey:function(n){var s=Ms(this).next(n).value;return s&&ot(s.from,n)<=0&&0<=ot(s.to,n)}})[_e]=function(){return Ms(this)},pt));var Xr={},Oi={},Di=!1;function Ns(n){Ls(Oi,n),Di||(Di=!0,setTimeout(function(){Di=!1,ji(Oi,!(Oi={}))},0))}function ji(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,d=Object.values(Xr);c<d.length;c++)yl(w=d[c],n,l,s);else for(var p in n){var _,w,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(_=p[1],p=p[2],w=Xr["idb://".concat(_,"/").concat(p)])&&yl(w,n,l,s)}l.forEach(function(I){return I()})}function yl(n,s,l,c){for(var d=[],p=0,_=Object.entries(n.queries.query);p<_.length;p++){for(var w=_[p],I=w[0],K=[],R=0,C=w[1];R<C.length;R++){var j=C[R];Ri(s,j.obsSet)?j.subscribers.forEach(function(H){return l.add(H)}):c&&K.push(j)}c&&d.push([I,K])}if(c)for(var L=0,O=d;L<O.length;L++){var P=O[L],I=P[0],K=P[1];n.queries.query[I]=K}}function hf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?be(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,d=Math.round(10*n.verno),p=!1;function _(){if(s.openCanceller!==c)throw new B.DatabaseClosed("db.open() was cancelled")}function w(){return new Pe(function(j,L){if(_(),!l)throw new B.MissingAPI;var O=n.name,P=s.autoSchema||!d?l.open(O):l.open(O,d);if(!P)throw new B.MissingAPI;P.onerror=or(L),P.onblocked=lt(n._fireOnBlocked),P.onupgradeneeded=lt(function(H){var X;R=P.transaction,s.autoSchema&&!n._options.allowEmptyDB?(P.onerror=Va,R.abort(),P.result.close(),(X=l.deleteDatabase(O)).onsuccess=X.onerror=lt(function(){L(new B.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(R.onerror=or(L),X=H.oldVersion>Math.pow(2,62)?0:H.oldVersion,C=X<1,n.idbdb=P.result,p&&vf(n,R),df(n,X/10,R,L))},L),P.onsuccess=lt(function(){R=null;var H,X,F,se,me,Ae,Ce=n.idbdb=P.result,ge=de(Ce.objectStoreNames);if(0<ge.length)try{var Me=Ce.transaction((me=ge).length===1?me[0]:me,"readonly");if(s.autoSchema)Ae=Ce,se=Me,(F=n).verno=Ae.version/10,se=F._dbSchema=Ds(0,Ae,se),F._storeNames=de(Ae.objectStoreNames,0),Rs(F,[F._allTables],u(se),se);else if(js(n,n._dbSchema,Me),X=Me,((X=Ti(Ds(0,(H=n).idbdb,X),H._dbSchema)).add.length||X.change.some(function(Ie){return Ie.add.length||Ie.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ce.close(),d=Ce.version+1,p=!0,j(w());Is(n,Me)}catch{}It.push(n),Ce.onversionchange=lt(function(Ie){s.vcFired=!0,n.on("versionchange").fire(Ie)}),Ce.onclose=lt(function(){n.close({disableAutoOpen:!1})}),C&&(ge=n._deps,me=O,Ci(Ae=ge.indexedDB)||me===sn||Ai(Ae,ge.IDBKeyRange).put({name:me}).catch(Te)),j()},L)}).catch(function(j){switch(j==null?void 0:j.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),w();break;case"VersionError":if(0<d)return d=0,w()}return Pe.reject(j)})}var I,K=s.dbReadyResolve,R=null,C=!1;return Pe.race([c,(typeof navigator>"u"?Pe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(j){function L(){return indexedDB.databases().finally(j)}I=setInterval(L,100),L()}).finally(function(){return clearInterval(I)}):Promise.resolve()).then(w)]).then(function(){return _(),s.onReadyBeingFired=[],Pe.resolve(Pi(function(){return n.on.ready.fire(n.vip)})).then(function j(){var L;if(0<s.onReadyBeingFired.length)return L=s.onReadyBeingFired.reduce(at,Te),s.onReadyBeingFired=[],Pe.resolve(Pi(function(){return L(n.vip)})).then(j)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(j){s.dbOpenError=j;try{R&&R.abort()}catch{}return c===s.openCanceller&&n._close(),be(j)}).finally(function(){s.openComplete=!0,K()}).then(function(){var j;return C&&(j={},n.tables.forEach(function(L){L.schema.indexes.forEach(function(O){O.name&&(j["idb://".concat(n.name,"/").concat(L.name,"/").concat(O.name)]=new on(-1/0,[[[]]]))}),j["idb://".concat(n.name,"/").concat(L.name,"/")]=j["idb://".concat(n.name,"/").concat(L.name,"/:dels")]=new on(-1/0,[[[]]])}),Mr(Ya).fire(j),ji(j,!0)),n})}function Mi(n){function s(p){return n.next(p)}var l=d(s),c=d(function(p){return n.throw(p)});function d(p){return function(w){var w=p(w),I=w.value;return w.done?I:I&&typeof I.then=="function"?I.then(l,c):f(I)?Promise.all(I).then(l,c):l(I)}}return d(s)()}function qs(n,s,l){for(var c=f(n)?n.slice():[n],d=0;d<l;++d)c.push(s);return c}var mf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,d={},p=[];function _(j,L,O){var F=Qa(j),P=d[F]=d[F]||[],H=j==null?0:typeof j=="string"?1:j.length,X=0<L,F=a(a({},O),{name:X?"".concat(F,"(virtual-from:").concat(O.name,")"):O.name,lowLevelIndex:O,isVirtual:X,keyTail:L,keyLength:H,extractKey:xi(j),unique:!X&&O.unique});return P.push(F),F.isPrimaryKey||p.push(F),1<H&&_(H===2?j[0]:j.slice(0,H-1),L+1,O),P.sort(function(se,me){return se.keyTail-me.keyTail}),F}var w=_(c.primaryKey.keyPath,0,c.primaryKey);d[":id"]=[w];for(var I=0,K=c.indexes;I<K.length;I++){var R=K[I];_(R.keyPath,0,R)}function C(j){var L,O=j.query.index;return O.isVirtual?a(a({},j),{query:{index:O.lowLevelIndex,range:(L=j.query.range,O=O.keyTail,{type:L.type===1?2:L.type,lower:qs(L.lower,L.lowerOpen?n.MAX_KEY:n.MIN_KEY,O),lowerOpen:!0,upper:qs(L.upper,L.upperOpen?n.MIN_KEY:n.MAX_KEY,O),upperOpen:!0})}}):j}return a(a({},l),{schema:a(a({},c),{primaryKey:w,indexes:p,getIndexByKeyPath:function(j){return(j=d[Qa(j)])&&j[0]}}),count:function(j){return l.count(C(j))},query:function(j){return l.query(C(j))},openCursor:function(j){var L=j.query.index,O=L.keyTail,P=L.keyLength;return L.isVirtual?l.openCursor(C(j)).then(function(X){return X&&H(X)}):l.openCursor(j);function H(X){return Object.create(X,{continue:{value:function(F){F!=null?X.continue(qs(F,j.reverse?n.MAX_KEY:n.MIN_KEY,O)):j.unique?X.continue(X.key.slice(0,P).concat(j.reverse?n.MIN_KEY:n.MAX_KEY,O)):X.continue()}},continuePrimaryKey:{value:function(F,se){X.continuePrimaryKey(qs(F,n.MAX_KEY,O),se)}},primaryKey:{get:function(){return X.primaryKey}},key:{get:function(){var F=X.key;return P===1?F[0]:F.slice(0,P)}},value:{get:function(){return X.value}}})}}})}})}};function Li(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(d){var p,_,w;S(s,d)?(p=n[d],_=s[d],typeof p=="object"&&typeof _=="object"&&p&&_?(w=ce(p))!==ce(_)?l[c+d]=s[d]:w==="Object"?Li(p,_,l,c+d+"."):p!==_&&(l[c+d]=s[d]):p!==_&&(l[c+d]=s[d])):l[c+d]=void 0}),u(s).forEach(function(d){S(n,d)||(l[c+d]=s[d])}),l}function Ni(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var gf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(d){var p=je.trans,_=p.table(s).hook,w=_.deleting,I=_.creating,K=_.updating;switch(d.type){case"add":if(I.fire===Te)break;return p._promise("readwrite",function(){return R(d)},!0);case"put":if(I.fire===Te&&K.fire===Te)break;return p._promise("readwrite",function(){return R(d)},!0);case"delete":if(w.fire===Te)break;return p._promise("readwrite",function(){return R(d)},!0);case"deleteRange":if(w.fire===Te)break;return p._promise("readwrite",function(){return(function C(j,L,O){return l.query({trans:j,values:!1,query:{index:c,range:L},limit:O}).then(function(P){var H=P.result;return R({type:"delete",keys:H,trans:j}).then(function(X){return 0<X.numFailures?Promise.reject(X.failures[0]):H.length<O?{failures:[],numFailures:0,lastResult:void 0}:C(j,a(a({},L),{lower:H[H.length-1],lowerOpen:!0}),O)})})})(d.trans,d.range,1e4)},!0)}return l.mutate(d);function R(C){var j,L,O,P=je.trans,H=C.keys||Ni(c,C);if(H)return(C=C.type==="add"||C.type==="put"?a(a({},C),{keys:H}):a({},C)).type!=="delete"&&(C.values=i([],C.values)),C.keys&&(C.keys=i([],C.keys)),j=l,O=H,((L=C).type==="add"?Promise.resolve([]):j.getMany({trans:L.trans,keys:O,cache:"immutable"})).then(function(X){var F=H.map(function(se,me){var Ae,Ce,ge,Me=X[me],Ie={onerror:null,onsuccess:null};return C.type==="delete"?w.fire.call(Ie,se,Me,P):C.type==="add"||Me===void 0?(Ae=I.fire.call(Ie,se,C.values[me],P),se==null&&Ae!=null&&(C.keys[me]=se=Ae,c.outbound||G(C.values[me],c.keyPath,se))):(Ae=Li(Me,C.values[me]),(Ce=K.fire.call(Ie,Ae,se,Me,P))&&(ge=C.values[me],Object.keys(Ce).forEach(function(xe){S(ge,xe)?ge[xe]=Ce[xe]:G(ge,xe,Ce[xe])}))),Ie});return l.mutate(C).then(function(se){for(var me=se.failures,Ae=se.results,Ce=se.numFailures,se=se.lastResult,ge=0;ge<H.length;++ge){var Me=(Ae||H)[ge],Ie=F[ge];Me==null?Ie.onerror&&Ie.onerror(me[ge]):Ie.onsuccess&&Ie.onsuccess(C.type==="put"&&X[ge]?C.values[ge]:Me)}return{failures:me,results:Ae,numFailures:Ce,lastResult:se}}).catch(function(se){return F.forEach(function(me){return me.onerror&&me.onerror(se)}),Promise.reject(se)})});throw new Error("Keys missing")}}})}})}};function bl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],d=0,p=0;d<s.keys.length&&p<n.length;++d)ot(s.keys[d],n[p])===0&&(c.push(l?le(s.values[d]):s.values[d]),++p);return c.length===n.length?c:null}catch{return null}}var _f={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var d;return c.cache?(d=bl(c.keys,c.trans._cache,c.cache==="clone"))?Pe.resolve(d):l.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?le(p):p},p}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function wl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function kl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var yf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new on(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,d,p){if(je.subscr&&d!=="readonly")throw new B.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return n.transaction(c,d,p)},table:function(c){function d(H){var P,H=H.query;return[P=H.index,new on((P=(H=H.range).lower)!=null?P:n.MIN_KEY,(P=H.upper)!=null?P:n.MAX_KEY)]}var p=n.table(c),_=p.schema,w=_.primaryKey,I=_.indexes,K=w.extractKey,R=w.outbound,C=w.autoIncrement&&I.filter(function(O){return O.compound&&O.keyPath.includes(w.keyPath)}),j=a(a({},p),{mutate:function(O){function P(Le){return Le="idb://".concat(s,"/").concat(c,"/").concat(Le),me[Le]||(me[Le]=new on)}var H,X,F,se=O.trans,me=O.mutatedParts||(O.mutatedParts={}),Ae=P(""),Ce=P(":dels"),ge=O.type,Ie=O.type==="deleteRange"?[O.range]:O.type==="delete"?[O.keys]:O.values.length<50?[Ni(w,O).filter(function(Le){return Le}),O.values]:[],Me=Ie[0],Ie=Ie[1],xe=O.trans._cache;return f(Me)?(Ae.addKeys(Me),(ge=ge==="delete"||Me.length===Ie.length?bl(Me,xe):null)||Ce.addKeys(Me),(ge||Ie)&&(H=P,X=ge,F=Ie,_.indexes.forEach(function(Le){var ct=H(Le.name||"");function vt(Xe){return Xe!=null?Le.extractKey(Xe):null}function Fe(Xe){Le.multiEntry&&f(Xe)?Xe.forEach(function(Dt){return ct.addKey(Dt)}):ct.addKey(Xe)}(X||F).forEach(function(Xe,jt){var Bn=X&&vt(X[jt]),jt=F&&vt(F[jt]);ot(Bn,jt)!==0&&(Bn!=null&&Fe(Bn),jt!=null)&&Fe(jt)})}))):Me?(Ie={from:(xe=Me.lower)!=null?xe:n.MIN_KEY,to:(ge=Me.upper)!=null?ge:n.MAX_KEY},Ce.add(Ie),Ae.add(Ie)):(Ae.add(l),Ce.add(l),_.indexes.forEach(function(Le){return P(Le.name).add(l)})),p.mutate(O).then(function(Le){return!Me||O.type!=="add"&&O.type!=="put"||(Ae.addKeys(Le.results),C&&C.forEach(function(ct){for(var vt=O.values.map(function(Bn){return ct.extractKey(Bn)}),Fe=ct.keyPath.findIndex(function(Bn){return Bn===w.keyPath}),Xe=0,Dt=Le.results.length;Xe<Dt;++Xe)vt[Xe][Fe]=Le.results[Xe];P(ct.name).addKeys(vt)})),se.mutatedParts=Ls(se.mutatedParts||{},me),Le})}}),L={get:function(O){return[w,new on(O.key)]},getMany:function(O){return[w,new on().addKeys(O.keys)]},count:d,query:d,openCursor:d};return u(L).forEach(function(O){j[O]=function(P){var H=je.subscr,X=!!H,F=wl(je,p)&&kl(O,P)?P.obsSet={}:H;if(X){var se,H=function(Ie){return Ie="idb://".concat(s,"/").concat(c,"/").concat(Ie),F[Ie]||(F[Ie]=new on)},me=H(""),Ae=H(":dels"),X=L[O](P),Ce=X[0],X=X[1];if((O==="query"&&Ce.isPrimaryKey&&!P.values?Ae:H(Ce.name||"")).add(X),!Ce.isPrimaryKey){if(O!=="count")return se=O==="query"&&R&&P.values&&p.query(a(a({},P),{values:!1})),p[O].apply(this,arguments).then(function(Ie){if(O==="query"){if(R&&P.values)return se.then(function(vt){return vt=vt.result,me.addKeys(vt),Ie});var xe=P.values?Ie.result.map(K):Ie.result;(P.values?me:Ae).addKeys(xe)}else{var Le,ct;if(O==="openCursor")return ct=P.values,(Le=Ie)&&Object.create(Le,{key:{get:function(){return Ae.addKey(Le.primaryKey),Le.key}},primaryKey:{get:function(){var vt=Le.primaryKey;return Ae.addKey(vt),vt}},value:{get:function(){return ct&&me.addKey(Le.primaryKey),Le.value}}})}return Ie});Ae.add(l)}}return p[O].apply(this,arguments)}}),j}})}};function xl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),f(c.keys)&&(c.keys=c.keys.filter(function(d,p){return!(p in l.failures)})),"values"in c&&f(c.values)&&(c.values=c.values.filter(function(d,p){return!(p in l.failures)})),c)}function qi(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<ot(l,c.lower):0<=ot(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?ot(l,c.upper)<0:ot(l,c.upper)<=0));var l,c}function Sl(n,s,l,c,d,p){var _,w,I,K,R,C;return!l||l.length===0||(_=s.query.index,w=_.multiEntry,I=s.query.range,K=c.schema.primaryKey.extractKey,R=_.extractKey,C=(_.lowLevelIndex||_).extractKey,(c=l.reduce(function(j,L){var O=j,P=[];if(L.type==="add"||L.type==="put")for(var H=new on,X=L.values.length-1;0<=X;--X){var F,se=L.values[X],me=K(se);!H.hasKey(me)&&(F=R(se),w&&f(F)?F.some(function(Ie){return qi(Ie,I)}):qi(F,I))&&(H.addKey(me),P.push(se))}switch(L.type){case"add":var Ae=new on().addKeys(s.values?j.map(function(xe){return K(xe)}):j),O=j.concat(s.values?P.filter(function(xe){return xe=K(xe),!Ae.hasKey(xe)&&(Ae.addKey(xe),!0)}):P.map(function(xe){return K(xe)}).filter(function(xe){return!Ae.hasKey(xe)&&(Ae.addKey(xe),!0)}));break;case"put":var Ce=new on().addKeys(L.values.map(function(xe){return K(xe)}));O=j.filter(function(xe){return!Ce.hasKey(s.values?K(xe):xe)}).concat(s.values?P:P.map(function(xe){return K(xe)}));break;case"delete":var ge=new on().addKeys(L.keys);O=j.filter(function(xe){return!ge.hasKey(s.values?K(xe):xe)});break;case"deleteRange":var Me=L.range;O=j.filter(function(xe){return!qi(K(xe),Me)})}return O},n))===n)?n:(c.sort(function(j,L){return ot(C(j),C(L))||ot(K(j),K(L))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(d.dirty=!0)),p?Object.freeze(c):c)}function Tl(n,s){return ot(n.lower,s.lower)===0&&ot(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function bf(n,s){return((l,c,d,p)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=ot(l,c))===0){if(d&&p)return 0;if(d)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,d,p)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=ot(l,c))===0){if(d&&p)return 0;if(d)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function wf(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var d,p;n.subscribers.delete(l),n.subscribers.size===0&&(d=n,p=s,setTimeout(function(){d.subscribers.size===0&&re(p,d)},3e3))})}var kf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,d){var p,_,w=n.transaction(l,c,d);return c==="readwrite"&&(d=(p=new AbortController).signal,w.addEventListener("abort",(_=function(I){return function(){if(p.abort(),c==="readwrite"){for(var K=new Set,R=0,C=l;R<C.length;R++){var j=C[R],L=Xr["idb://".concat(s,"/").concat(j)];if(L){var O=n.table(j),P=L.optimisticOps.filter(function(Le){return Le.trans===w});if(w._explicit&&I&&w.mutatedParts)for(var H=0,X=Object.values(L.queries.query);H<X.length;H++)for(var F=0,se=(Ce=X[H]).slice();F<se.length;F++)Ri((ge=se[F]).obsSet,w.mutatedParts)&&(re(Ce,ge),ge.subscribers.forEach(function(Le){return K.add(Le)}));else if(0<P.length){L.optimisticOps=L.optimisticOps.filter(function(Le){return Le.trans!==w});for(var me=0,Ae=Object.values(L.queries.query);me<Ae.length;me++)for(var Ce,ge,Me,Ie=0,xe=(Ce=Ae[me]).slice();Ie<xe.length;Ie++)(ge=xe[Ie]).res!=null&&w.mutatedParts&&(I&&!ge.dirty?(Me=Object.isFrozen(ge.res),Me=Sl(ge.res,ge.req,P,O,ge,Me),ge.dirty?(re(Ce,ge),ge.subscribers.forEach(function(Le){return K.add(Le)})):Me!==ge.res&&(ge.res=Me,ge.promise=Pe.resolve({result:Me}))):(ge.dirty&&re(Ce,ge),ge.subscribers.forEach(function(Le){return K.add(Le)})))}}}K.forEach(function(Le){return Le()})}}})(!1),{signal:d}),w.addEventListener("error",_(!1),{signal:d}),w.addEventListener("complete",_(!0),{signal:d})),w},table:function(l){var c=n.table(l),d=c.schema.primaryKey;return a(a({},c),{mutate:function(p){var _,w=je.trans;return!d.outbound&&w.db._options.cache!=="disabled"&&!w.explicit&&w.idbtrans.mode==="readwrite"&&(_=Xr["idb://".concat(s,"/").concat(l)])?(w=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Ni(d,p).some(function(I){return I==null}))?(_.optimisticOps.push(p),p.mutatedParts&&Ns(p.mutatedParts),w.then(function(I){0<I.numFailures&&(re(_.optimisticOps,p),(I=xl(0,p,I))&&_.optimisticOps.push(I),p.mutatedParts)&&Ns(p.mutatedParts)}),w.catch(function(){re(_.optimisticOps,p),p.mutatedParts&&Ns(p.mutatedParts)})):w.then(function(I){var K=xl(0,a(a({},p),{values:p.values.map(function(R,C){var j;return I.failures[C]?R:(G(j=(j=d.keyPath)!=null&&j.includes(".")?le(R):a({},R),d.keyPath,I.results[C]),j)})}),I);_.optimisticOps.push(K),queueMicrotask(function(){return p.mutatedParts&&Ns(p.mutatedParts)})}),w):c.mutate(p)},query:function(p){var _,w,I,K,R,C,j;return wl(je,c)&&kl("query",p)?(_=((I=je.trans)==null?void 0:I.db._options.cache)==="immutable",w=(I=je).requery,I=I.signal,C=((L,O,P,H)=>{var X=Xr["idb://".concat(L,"/").concat(O)];if(!X)return[];if(!(L=X.queries[P]))return[null,!1,X,null];var F=L[(H.query?H.query.index.name:null)||""];if(!F)return[null,!1,X,null];switch(P){case"query":var se=F.find(function(me){return me.req.limit===H.limit&&me.req.values===H.values&&Tl(me.req.query.range,H.query.range)});return se?[se,!0,X,F]:[F.find(function(me){return("limit"in me.req?me.req.limit:1/0)>=H.limit&&(!H.values||me.req.values)&&bf(me.req.query.range,H.query.range)}),!1,X,F];case"count":return se=F.find(function(me){return Tl(me.req.query.range,H.query.range)}),[se,!!se,X,F]}})(s,l,"query",p),j=C[0],K=C[2],R=C[3],j&&C[1]?j.obsSet=p.obsSet:(C=c.query(p).then(function(L){var O=L.result;if(j&&(j.res=O),_){for(var P=0,H=O.length;P<H;++P)Object.freeze(O[P]);Object.freeze(O)}else L.result=le(O);return L}).catch(function(L){return R&&j&&re(R,j),Promise.reject(L)}),j={obsSet:p.obsSet,promise:C,subscribers:new Set,type:"query",req:p,dirty:!1},R?R.push(j):(R=[j],(K=K||(Xr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=R)),wf(j,R,w,I),j.promise.then(function(L){return{result:Sl(L.result,p,K==null?void 0:K.optimisticOps,c,j,_)}})):c.query(p)}})}})}};function Bs(n,s){return new Proxy(n,{get:function(l,c,d){return c==="db"?s:Reflect.get(l,c,d)}})}Lt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new B.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(ff),l.stores({}),this._state.autoSchema=!1),l},Lt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?n():new Pe(function(l,c){if(s._state.openComplete)return c(new B.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new B.DatabaseClosed);s.open().catch(Te)}s._state.dbReadyPromise.then(l,c)}).then(n)},Lt.prototype.use=function(d){var s=d.stack,l=d.create,c=d.level,d=d.name,p=(d&&this.unuse({stack:s,name:d}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:c??10,name:d}),p.sort(function(_,w){return _.level-w.level}),this},Lt.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(d){return c?d.create!==c:!!l&&d.name!==l})),this},Lt.prototype.open=function(){var n=this;return Ne(Ot,function(){return hf(n)})},Lt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=It.indexOf(this);if(0<=s&&It.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Pe(function(l){n.dbReadyResolve=l}),n.openCanceller=new Pe(function(l,c){n.cancelOpen=c}))},Lt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new B.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new B.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},Lt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Pe(function(d,p){function _(){s.close(n);var w=s._deps.indexedDB.deleteDatabase(s.name);w.onsuccess=lt(function(){var I,K,R;I=s._deps,K=s.name,Ci(R=I.indexedDB)||K===sn||Ai(R,I.IDBKeyRange).delete(K).catch(Te),d()}),w.onerror=or(p),w.onblocked=s._fireOnBlocked}if(l)throw new B.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(_):_()})},Lt.prototype.backendDB=function(){return this.idbdb},Lt.prototype.isOpen=function(){return this.idbdb!==null},Lt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Lt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Lt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Lt.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),Lt.prototype.transaction=function(){var n=(function(s,l,c){var d=arguments.length;if(d<2)throw new B.InvalidArgument("Too few arguments");for(var p=new Array(d-1);--d;)p[d-1]=arguments[d];return c=p.pop(),[s,Ee(p),c]}).apply(this,arguments);return this._transaction.apply(this,n)},Lt.prototype._transaction=function(n,s,l){var c,d,p=this,_=je.trans,w=(_&&_.db===this&&n.indexOf("!")===-1||(_=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(d=s.map(function(K){if(K=K instanceof p.Table?K.name:K,typeof K!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return K}),n=="r"||n===qn)c=qn;else{if(n!="rw"&&n!=Xt)throw new B.InvalidArgument("Invalid transaction mode: "+n);c=Xt}if(_){if(_.mode===qn&&c===Xt){if(!w)throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");_=null}_&&d.forEach(function(K){if(_&&_.storeNames.indexOf(K)===-1){if(!w)throw new B.SubTransaction("Table "+K+" not included in parent transaction.");_=null}}),w&&_&&!_.active&&(_=null)}}catch(K){return _?_._promise(null,function(R,C){C(K)}):be(K)}var I=(function K(R,C,j,L,O){return Pe.resolve().then(function(){var F=je.transless||je,P=R._createTransaction(C,j,R._dbSchema,L),F=(P.explicit=!0,{trans:P,transless:F});if(L)P.idbtrans=L.idbtrans;else try{P.create(),P.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(se){return se.name===qe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return K(R,C,j,null,O)})):be(se)}var H,X=ae(O),F=(X&&zt(),Pe.follow(function(){var se;(H=O.call(P,P))&&(X?(se=bn.bind(null,null),H.then(se,se)):typeof H.next=="function"&&typeof H.throw=="function"&&(H=Mi(H)))},F));return(H&&typeof H.then=="function"?Pe.resolve(H).then(function(se){return P.active?se:be(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):F.then(function(){return H})).then(function(se){return L&&P._resolve(),P._completion.then(function(){return se})}).catch(function(se){return P._reject(se),be(se)})})}).bind(null,this,c,d,_,l);return _?_._promise(c,I,"lock"):je.trans?Ne(je.transless,function(){return p._whenReady(I)}):this._whenReady(I)},Lt.prototype.table=function(n){if(S(this._allTables,n))return this._allTables[n];throw new B.InvalidTable("Table ".concat(n," does not exist"))};var wr=Lt;function Lt(n,s){var l,c,d,p,_,w=this,I=(this._middlewares={},this.verno=0,Lt.dependencies),I=(this._options=s=a({addons:Lt.addons,autoOpen:!0,indexedDB:I.indexedDB,IDBKeyRange:I.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),K=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Te,dbReadyPromise:null,cancelOpen:Te,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(K.dbReadyPromise=new Pe(function(C){K.dbReadyResolve=C}),K.openCanceller=new Pe(function(C,j){K.cancelOpen=j}),this._state=K,this.name=n,this.on=Ha(this,"populate","blocked","versionchange","close",{ready:[at,Te]}),this.once=function(C,j){var L=function(){for(var O=[],P=0;P<arguments.length;P++)O[P]=arguments[P];w.on(C).unsubscribe(L),j.apply(w,O)};return w.on(C,L)},this.on.ready.subscribe=U(this.on.ready.subscribe,function(C){return function(j,L){Lt.vip(function(){var O,P=w._state;P.openComplete?(P.dbOpenError||Pe.resolve().then(j),L&&C(j)):P.onReadyBeingFired?(P.onReadyBeingFired.push(j),L&&C(j)):(C(j),O=w,L||C(function H(){O.on.ready.unsubscribe(j),O.on.ready.unsubscribe(H)}))})}}),this.Collection=(l=this,Wa(rf.prototype,function(H,P){this.db=l;var L=yr,O=null;if(P)try{L=P()}catch(F){O=F}var P=H._ctx,H=P.table,X=H.hook.reading.fire;this._ctx={table:H,index:P.index,isPrimKey:!P.index||H.schema.primKey.keyPath&&P.index===H.schema.primKey.name,range:L,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:P.or,valueMapper:X!==De?X:null}})),this.Table=(c=this,Wa(il.prototype,function(C,j,L){this.db=c,this._tx=L,this.name=C,this.schema=j,this.hook=c._allTables[C]?c._allTables[C].hook:Ha(null,{creating:[ft,Te],reading:[nt,De],updating:[He,Te],deleting:[Rt,Te]})})),this.Transaction=(d=this,Wa(of.prototype,function(C,j,L,O,P){var H=this;C!=="readonly"&&j.forEach(function(X){X=(X=L[X])==null?void 0:X.yProps,X&&(j=j.concat(X.map(function(F){return F.updatesTable})))}),this.db=d,this.mode=C,this.storeNames=j,this.schema=L,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Ha(this,"complete","error","abort"),this.parent=P||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Pe(function(X,F){H._resolve=X,H._reject=F}),this._completion.then(function(){H.active=!1,H.on.complete.fire()},function(X){var F=H.active;return H.active=!1,H.on.error.fire(X),H.parent?H.parent._reject(X):F&&H.idbtrans&&H.idbtrans.abort(),be(X)})})),this.Version=(p=this,Wa(pf.prototype,function(C){this.db=p,this._cfg={version:C,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,Wa(fl.prototype,function(C,j,L){if(this.db=_,this._ctx={table:C,index:j===":id"?null:j,or:L},this._cmp=this._ascending=ot,this._descending=function(O,P){return ot(P,O)},this._max=function(O,P){return 0<ot(O,P)?O:P},this._min=function(O,P){return ot(O,P)<0?O:P},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new B.MissingAPI})),this.on("versionchange",function(C){0<C.newVersion?console.warn("Another connection wants to upgrade database '".concat(w.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(w.name,"'. Closing db now to resume the delete request.")),w.close({disableAutoOpen:!1})}),this.on("blocked",function(C){!C.newVersion||C.newVersion<C.oldVersion?console.warn("Dexie.delete('".concat(w.name,"') was blocked")):console.warn("Upgrade '".concat(w.name,"' blocked by other connection holding version ").concat(C.oldVersion/10))}),this._maxKey=Xa(s.IDBKeyRange),this._createTransaction=function(C,j,L,O){return new w.Transaction(C,j,L,w._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(C){w.on("blocked").fire(C),It.filter(function(j){return j.name===w.name&&j!==w&&!j._state.vcFired}).map(function(j){return j.on("versionchange").fire(C)})},this.use(_f),this.use(kf),this.use(yf),this.use(mf),this.use(gf),new Proxy(this,{get:function(C,j,L){var O;return j==="_vip"||(j==="table"?function(P){return Bs(w.table(P),R)}:(O=Reflect.get(C,j,L))instanceof il?Bs(O,R):j==="tables"?O.map(function(P){return Bs(P,R)}):j==="_createTransaction"?function(){return Bs(O.apply(this,arguments),R)}:O)}}));this.vip=R,I.forEach(function(C){return C(w)})}var zs,Aa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",xf=(Bi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Bi.prototype[Aa]=function(){return this},Bi);function Bi(n){this._subscribe=n}try{zs={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{zs={indexedDB:null,IDBKeyRange:null}}function El(n){var s,l=!1,c=new xf(function(d){var p=ae(n),_,w=!1,I={},K={},R={get closed(){return w},unsubscribe:function(){w||(w=!0,_&&_.abort(),C&&Mr.storagemutated.unsubscribe(L))}},C=(d.start&&d.start(R),!1),j=function(){return he(O)},L=function(P){Ls(I,P),Ri(K,I)&&j()},O=function(){var P,H,X;!w&&zs.indexedDB&&(I={},P={},_&&_.abort(),_=new AbortController,X=(F=>{var se=Gt();try{p&&zt();var me=Cn(n,F);return me=p?me.finally(bn):me}finally{se&&fn()}})(H={subscr:P,signal:_.signal,requery:j,querier:n,trans:null}),Promise.resolve(X).then(function(F){l=!0,s=F,w||H.signal.aborted||(I={},(se=>{for(var me in se)if(S(se,me))return;return 1})(K=P)||C||(Mr(Ya,L),C=!0),he(function(){return!w&&d.next&&d.next(F)}))},function(F){l=!1,["DatabaseClosedError","AbortError"].includes(F==null?void 0:F.name)||w||he(function(){w||d.error&&d.error(F)})}))};return setTimeout(j,0),R});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var Qr=wr;function zi(n){var s=Lr;try{Lr=!0,Mr.storagemutated.fire(n),ji(n,!0)}finally{Lr=s}}x(Qr,a(a({},V),{delete:function(n){return new Qr(n,{addons:[]}).delete()},exists:function(n){return new Qr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Qr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ci(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(d){return d.name}).filter(function(d){return d!==sn})}):Ai(l,s).toCollection().primaryKeys()).then(n)}catch{return be(new B.MissingAPI)}var s,l},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return je.trans?Ne(je.transless,n):n()},vip:Pi,async:function(n){return function(){try{var s=Mi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Pe.resolve(s)}catch(l){return be(l)}}},spawn:function(n,s,l){try{var c=Mi(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Pe.resolve(c)}catch(d){return be(d)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(n,s){return n=Pe.resolve(typeof n=="function"?Qr.ignoreTransaction(n):n).timeout(s||6e4),je.trans?je.trans.waitFor(n):n},Promise:Pe,debug:{get:function(){return st},set:function(n){_t(n)}},derive:E,extend:h,props:x,override:U,Events:Ha,on:Mr,liveQuery:El,extendObservabilitySet:Ls,getByKeyPath:$,setByKeyPath:G,delByKeyPath:function(n,s){typeof s=="string"?G(n,s,void 0):"length"in s&&[].map.call(s,function(l){G(n,l,void 0)})},shallowClone:ue,deepClone:le,getObjectDiff:Li,cmp:ot,asap:Y,minKey:-1/0,addons:[],connections:It,errnames:qe,dependencies:zs,cache:Xr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Qr.maxKey=Xa(Qr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Mr(Ya,function(n){Lr||(n=new CustomEvent(bi,{detail:n}),Lr=!0,dispatchEvent(n),Lr=!1)}),addEventListener(bi,function(n){n=n.detail,Lr||zi(n)}));var Ca,Lr=!1,Al=function(){};return typeof BroadcastChannel<"u"&&((Al=function(){(Ca=new BroadcastChannel(bi)).onmessage=function(n){return n.data&&zi(n.data)}})(),typeof Ca.unref=="function"&&Ca.unref(),Mr(Ya,function(n){Lr||Ca.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!wr.disableBfCache&&n.persisted){st&&console.debug("Dexie: handling persisted pagehide"),Ca!=null&&Ca.close();for(var s=0,l=It;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!wr.disableBfCache&&n.persisted&&(st&&console.debug("Dexie: handling persisted pageshow"),Al(),zi({all:new on(-1/0,[[]])}))})),Pe.rejectionMapper=function(n,s){return!n||n instanceof Z||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ye[n.name]?n:(s=new ye[n.name](s||n.message,n),"stack"in n&&N(s,"stack",{get:function(){return this.inner.stack}}),s)},_t(st),a(wr,Object.freeze({__proto__:null,Dexie:wr,Entity:tl,PropModification:Ga,RangeSet:on,add:function(n){return new Ga({add:n})},cmp:ot,default:wr,liveQuery:El,mergeRanges:Ja,rangesOverlap:ml,remove:function(n){return new Ga({remove:n})},replacePrefix:function(n,s){return new Ga({replacePrefix:[n,s]})}}),{default:wr}),wr})})($s)),$s.exports}var cv=lv();const vo=iv(cv),Hl=Symbol.for("Dexie"),cn=globalThis[Hl]||(globalThis[Hl]=vo);if(vo.semVer!==cn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${vo.semVer} and ${cn.semVer}`);const{liveQuery:dy,mergeRanges:vy,rangesOverlap:py,RangeSet:hy,cmp:my,Entity:gy,PropModification:_y,replacePrefix:yy,add:by,remove:wy,DexieYProvider:ky}=cn,ze=new cn("me-ai-store");ze.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});ze.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});ze.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});ze.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function yu(t,e){return`${t}:${e}`}function po(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Yi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function uv(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function fv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function bu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const dv="https://gmail.googleapis.com/gmail/v1/users/me";class zo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function vv(t){return{Authorization:`Bearer ${t}`}}async function hi(t,e){var a,i,o,u;const r=await fetch(`${dv}${e}`,{headers:vv(t)});if(!r.ok){const f=await r.json().catch(()=>({})),h=((a=f.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,v=((u=(o=(i=f.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new zo(h,r.status,v)}return r.json()}function wu(t){return hi(t,"/profile")}function ku(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),hi(t,`/messages?${i}`)}function xu(t,e,r="full"){return hi(t,`/messages/${e}?format=${r}`)}function pv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),hi(t,`/history?${i}`)}function qr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ds(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function hv(t){var o,u,f;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ds(e.body.data);const r=e.parts||[],a=ai(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return ds(a.body.data);const i=ai(r,"text/html");if((f=i==null?void 0:i.body)!=null&&f.data){const h=ds(i.body.data);return gv(h)}return"(no body)"}function mv(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ds(e.body.data);const r=e.parts||[],a=ai(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ds(a.body.data):null}function ai(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ai(r.parts,e);if(a)return a}}return null}function gv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Fo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Su(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function Tu(t){return Su(t).charAt(0).toUpperCase()}function _v(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function yv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Eu(t,e){return`${_v(t.date)}_${yv(t.subject)}.${e}`}function Au(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function bv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Cu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function wv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Cu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function kv(t=10){const e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Pu).join(`

---

`)}async function xv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await ze.items.where("sourceType").equals("gmail").toArray()).map(o=>{var f,h,v,y,S;let u=0;return(f=o.subject)!=null&&f.toLowerCase().includes(r)&&(u+=3),(h=o.from)!=null&&h.toLowerCase().includes(r)&&(u+=2),(v=o.to)!=null&&v.toLowerCase().includes(r)&&(u+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(u+=1),(S=o.body)!=null&&S.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>Pu(o)).join(`

---

`)}async function Wl(){const t=await ze.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=Au(t);return{groups:e,order:r,total:t.length}}async function Sv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await ze.items.where("sourceType").equals("gmail").filter(f=>{var h,v,y,S;return((h=f.subject)==null?void 0:h.toLowerCase().includes(o))||((v=f.from)==null?void 0:v.toLowerCase().includes(o))||((y=f.to)==null?void 0:y.toLowerCase().includes(o))||((S=f.snippet)==null?void 0:S.toLowerCase().includes(o))}).toArray();return u.sort((f,h)=>(h.date||0)-(f.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await ze.items.where("sourceType").equals("gmail").count();return{items:await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Cu(){const t=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).first(),e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).last();return{oldest:t,newest:e}}function Pu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=fv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function Tv(){const t=await bv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Ev(t){const e=[],r=await wv();if(e.push(r),t){const a=await xv(t,5);e.push("","## Relevant Emails",a)}else{const a=await kv(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Av="modulepreload",Cv=function(t){return"/me-ai/"+t},Vl={},Pv=function(e,r,a){let i=Promise.resolve();if(r&&r.length>0){let u=function(v){return Promise.all(v.map(y=>Promise.resolve(y).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),h=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));i=u(r.map(v=>{if(v=Cv(v),v in Vl)return;Vl[v]=!0;const y=v.endsWith(".css"),S=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const x=document.createElement("link");if(x.rel=y?"stylesheet":Av,y||(x.as="script"),x.crossOrigin="",x.href=v,h&&x.setAttribute("nonce",h),document.head.appendChild(x),y)return new Promise((k,N)=>{x.addEventListener("load",k),x.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${v}`)))})}))}function o(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return i.then(u=>{for(const f of u||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})},Iv=20,Rv={maxTokens:512},ra=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Iu(t,{count:e=Iv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(e).toArray();else{const U=new Set(await ze.emailClassifications.toCollection().primaryKeys());u=0,o=[],await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().until(()=>o.length>=e).each(q=>{U.has(q.id)?u++:o.push(q)})}if(o.length===0){const U=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:U,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const f=Date.now(),h=performance.now();let v=0,y=0,S=0,x=0;const k=[],N=t.modelId,E=gu(N);if(!E)throw new Error(`Unknown model: ${N}`);if(!E.recommendedForEmailProcessing&&o.length>0){const{MODELS:U}=await Pv(async()=>{const{MODELS:Y}=await Promise.resolve().then(()=>av);return{MODELS:Y}},void 0),q=U.filter(Y=>Y.recommendedForEmailProcessing).map(Y=>Y.name);console.warn(`â ï¸ Current model (${E.name}) is not optimized for email processing. For best results with long emails, use: ${q.join(", ")}. Some emails may fail due to memory limits.`)}for(let U=0;U<o.length&&!(i!=null&&i.aborted);U++){const q=o[U],Y=Ou(q),$=[{role:"system",content:ra},{role:"user",content:Y}];a({phase:"scanning",current:U+1,total:o.length,classified:v,errors:y,email:{subject:q.subject,from:q.from,date:q.date},prompt:{system:ra,user:Y},systemPromptLength:ra.length,live:null,lastResult:null,totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}});const G=performance.now();try{const{text:ue,tps:we,numTokens:Ee,inputTokens:ie}=await t.generateFull($,{maxTokens:512,enableThinking:!1},Se=>{a({phase:"generating",current:U+1,total:o.length,classified:v,errors:y,email:{subject:q.subject,from:q.from,date:q.date},live:{tps:Se.tps,numTokens:Se.numTokens},totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}})});S+=Ee,x+=ie;const J=jv(ue),le=performance.now()-G;if(J){await ze.emailClassifications.put({emailId:q.id,action:J.action,reason:J.reason,summary:J.summary,tags:J.tags,subject:q.subject||"(no subject)",from:q.from||"",date:q.date,scannedAt:f,status:"pending"}),v++;const Se={success:!0,email:{subject:q.subject,from:q.from,date:q.date},classification:J,stats:{tps:we,numTokens:Ee,inputTokens:ie,elapsed:le},promptSize:Y.length};k.push(Se),a({phase:"classified",current:U+1,total:o.length,classified:v,errors:y,email:{subject:q.subject,from:q.from,date:q.date},result:J,emailStats:{tps:we,numTokens:Ee,inputTokens:ie,elapsed:le},totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}})}}catch(ue){console.error(`Triage email ${U+1} failed:`,ue),y++;const we=ue.message||String(ue),Ee=we.length>200?we.slice(0,200)+"...":we;k.push({success:!1,email:{subject:q.subject,from:q.from,date:q.date},error:Ee,promptSize:Y.length})}}const A=performance.now()-h,Q=k.length>0?Math.round(k.reduce((U,q)=>U+q.promptSize,0)/k.length):0,de=k.filter(U=>{var q;return U.success&&((q=U.stats)==null?void 0:q.tps)}).length>0?Math.round(k.filter(U=>U.success).reduce((U,q)=>{var Y;return U+(((Y=q.stats)==null?void 0:Y.tps)||0)},0)/k.filter(U=>{var q;return U.success&&((q=U.stats)==null?void 0:q.tps)}).length):null;return a({phase:"done",current:o.length,total:o.length,classified:v,errors:y,results:k,summary:{avgPromptSize:Q,avgTps:de,systemPromptSize:ra.length,processed:o.length,skipped:u,modelName:E.name,modelContextWindow:E.contextWindow,modelMaxEmailTokens:E.maxEmailTokens},totals:{outputTokens:S,inputTokens:x,elapsed:A}}),{scanned:o.length,classified:v,skipped:u,errors:y}}async function Ov(){const t=await ze.emailClassifications.toArray();return Au(t)}async function Dv(){const t=await ze.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function si(t,e){await ze.emailClassifications.update(t,{status:e})}async function Yl(){await ze.emailClassifications.clear()}async function Ko(t){await ze.emailClassifications.where("action").equals(t).delete()}async function Ru(t){await ze.emailClassifications.delete(t)}async function ho(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Ou(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function jv(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const f=Mv(u.action);if(!f)return console.warn("Triage: missing or invalid action field"),null;let h=[];return Array.isArray(u.tags)&&(h=u.tags.filter(v=>typeof v=="string"&&v.trim()).map(v=>v.trim().toLowerCase()).slice(0,10)),{action:f,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:h}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function Mv(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function mo(t){return`hsl(${bu(t)}, 55%, 55%)`}function Lv(t){return`hsl(${bu(t)}, 40%, 35%)`}const Nv=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Xl(...t){Nv&&console.log("[debug]",...t)}function Ln(t){return Xl(`[MOUNT] ${t}`),()=>Xl(`[DESTROY] ${t}`)}var qv=z("<option> </option>"),Bv=z('<p class="model-description svelte-1p89qnn"> </p>'),zv=z('<span class="current-badge svelte-1p89qnn">Current</span>'),Fv=z('<span class="rec-badge rec-good svelte-1p89qnn">â Recommended</span>'),Kv=z('<span class="rec-badge rec-ok svelte-1p89qnn">â ï¸ Limited</span>'),Uv=z('<span class="rec-badge rec-bad svelte-1p89qnn">â May fail on long emails</span>'),Gv=z('<tr><td class="model-name svelte-1p89qnn"> <!></td><td class="context-col svelte-1p89qnn"><strong> </strong></td><td class="tokens-col svelte-1p89qnn"> </td><td class="rec-col svelte-1p89qnn"><!></td></tr>'),Hv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Wv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Vv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Yv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Xv=z('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Qv=z('<p class="error svelte-1p89qnn"> </p>'),Zv=z(`<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!> <details class="model-details svelte-1p89qnn" open=""><summary class="model-details-summary svelte-1p89qnn">Model Capabilities</summary> <div class="model-table-wrapper svelte-1p89qnn"><table class="model-table svelte-1p89qnn"><thead class="svelte-1p89qnn"><tr><th class="svelte-1p89qnn">Model</th><th class="svelte-1p89qnn">Context Window</th><th class="svelte-1p89qnn">Email Limit</th><th class="svelte-1p89qnn">Email Processing</th></tr></thead><tbody class="svelte-1p89qnn"></tbody></table></div> <p class="model-table-note svelte-1p89qnn"><strong class="svelte-1p89qnn">Context Window</strong> = model's maximum input capacity. <strong class="svelte-1p89qnn">Email Limit</strong> = WebGPU memory-safe limit (smaller models need more conservative limits to avoid memory errors).</p></details></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>`);function Jv(t,e){Ct(e,!0);let r=Oe(e,"selectedModel",15),a=Oe(e,"gpuInfo",3,null),i=Oe(e,"error",3,null);rn(()=>Ln("ModelSelector"));var o=Zv(),u=b(m(o),2),f=b(m(u),2);nn(f,21,()=>Hr,Vn,(U,q)=>{var Y=qv(),$=m(Y),G={};te(()=>{W($,`${g(q).name??""} â ${g(q).size??""}`),G!==(G=g(q).id)&&(Y.value=(Y.__value=g(q).id)??"")}),D(U,Y)});var h=b(f,2);{var v=U=>{const q=At(()=>Hr.find(ue=>ue.id===r()));var Y=Ir(),$=Ve(Y);{var G=ue=>{var we=Bv(),Ee=m(we);te(()=>W(Ee,g(q).description)),D(ue,we)};fe($,ue=>{g(q)&&ue(G)})}D(U,Y)};fe(h,U=>{r()&&U(v)})}var y=b(h,2),S=b(m(y),2),x=m(S),k=b(m(x));nn(k,21,()=>Hr,Vn,(U,q)=>{var Y=Gv();let $;var G=m(Y),ue=m(G),we=b(ue);{var Ee=ae=>{var V=zv();D(ae,V)};fe(we,ae=>{g(q).id===r()&&ae(Ee)})}var ie=b(G),J=m(ie),le=m(J),Se=b(ie),ce=m(Se),_e=b(Se),ke=m(_e);{var re=ae=>{var V=Fv();D(ae,V)},pe=ae=>{var V=Kv();D(ae,V)},ve=ae=>{var V=Uv();D(ae,V)};fe(ke,ae=>{g(q).recommendedForEmailProcessing?ae(re):g(q).maxEmailTokens>=6e3?ae(pe,1):ae(ve,!1)})}te((ae,V)=>{$=Mt(Y,1,"svelte-1p89qnn",null,$,{selected:g(q).id===r()}),W(ue,`${g(q).name??""} `),W(le,`${ae??""}k`),W(ce,`~${V??""}k`)},[()=>(g(q).contextWindow/1024).toFixed(0),()=>(g(q).maxEmailTokens/1e3).toFixed(0)]),D(U,Y)});var N=b(u,2);{var E=U=>{var q=Xv(),Y=b(m(q),2),$=m(Y),G=b(m($)),ue=m(G),we=b($,2),Ee=b(m(we)),ie=m(Ee),J=b(we,2);{var le=ve=>{var ae=Hv(),V=b(m(ae)),ee=m(V);te(()=>W(ee,a().device)),D(ve,ae)};fe(J,ve=>{a().device&&a().device!=="unknown"&&ve(le)})}var Se=b(J,2);{var ce=ve=>{var ae=Wv(),V=b(m(ae)),ee=m(V);te(()=>W(ee,a().description)),D(ve,ae)};fe(Se,ve=>{a().description&&a().description!=="unknown"&&ve(ce)})}var _e=b(Se,2);{var ke=ve=>{var ae=Vv(),V=b(m(ae)),ee=m(V);te(Z=>W(ee,Z),[()=>po(a().limits.maxBufferSize)]),D(ve,ae)};fe(_e,ve=>{var ae;(ae=a().limits)!=null&&ae.maxBufferSize&&ve(ke)})}var re=b(_e,2);{var pe=ve=>{var ae=Yv(),V=b(m(ae)),ee=m(V);te(()=>W(ee,`${a().features.length??""} supported`)),D(ve,ae)};fe(re,ve=>{var ae;(ae=a().features)!=null&&ae.length&&ve(pe)})}te(()=>{W(ue,a().vendor),W(ie,a().architecture)}),D(U,q)};fe(N,U=>{a()&&U(E)})}var A=b(N,2);{var Q=U=>{var q=Qv(),Y=m(q);te(()=>W(Y,i())),D(U,q)};fe(A,U=>{i()&&U(Q)})}var de=b(A,2);de.__click=function(...U){var q;(q=e.onload)==null||q.apply(this,U)},te(()=>de.disabled=i()),qo(f,r),D(t,o),Pt()}Ft(["click"]);var $v=z('<span class="progress-percent svelte-r5fnze"> </span>'),ep=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),tp=z('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),np=z('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),rp=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),ap=z('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),sp=z('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function ip(t,e){Ct(e,!0);let r=Oe(e,"message",3,""),a=Oe(e,"items",19,()=>[]);rn(()=>Ln("LoadingProgress"));var i=sp(),o=m(i),u=m(o),f=b(o,2);nn(f,17,a,Vn,(h,v)=>{const y=At(()=>g(v).total?uv(g(v).loaded||0,g(v).total):null);var S=ap(),x=m(S),k=m(x),N=m(k),E=b(k,2);{var A=q=>{var Y=$v(),$=m(Y);te(G=>W($,`${G??""}%`),[()=>g(y).toFixed(1)]),D(q,Y)};fe(E,q=>{g(y)!==null&&q(A)})}var Q=b(x,2);{var de=q=>{var Y=ep(),$=Ve(Y),G=m($),ue=b($,2),we=m(ue),Ee=m(we),ie=b(we,4),J=m(ie),le=b(ie,2),Se=m(le);te((ce,_e,ke,re,pe)=>{En(G,`width: ${ce??""}%`),W(Ee,_e),W(J,ke),W(Se,`(${re??""} / ${pe??""} B)`)},[()=>Math.max(g(v).progress??0,.5).toFixed(1),()=>Yi(g(v).loaded||0),()=>Yi(g(v).total),()=>(g(v).loaded||0).toLocaleString(),()=>g(v).total.toLocaleString()]),D(q,Y)},U=q=>{var Y=rp(),$=b(Ve(Y),2),G=m($);{var ue=Ee=>{var ie=tp(),J=Ve(ie),le=m(J),Se=b(J,2),ce=m(Se);te((_e,ke)=>{W(le,_e),W(ce,`(${ke??""} B)`)},[()=>Yi(g(v).loaded),()=>g(v).loaded.toLocaleString()]),D(Ee,ie)},we=Ee=>{var ie=np();D(Ee,ie)};fe(G,Ee=>{g(v).loaded?Ee(ue):Ee(we,!1)})}D(q,Y)};fe(Q,q=>{g(v).total?q(de):q(U,!1)})}te(()=>{hu(k,"title",g(v).file),W(N,g(v).file)}),D(h,S)}),te(()=>W(u,r())),D(t,i),Pt()}var op=z('<span class="thinking-tokens svelte-11gjw00"> </span>'),lp=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),cp=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),up=z('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),fp=z('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),dp=z('<span class="cursor svelte-11gjw00">|</span>'),vp=z(" <!>",1),pp=z('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),hp=z('<div class="content svelte-11gjw00"> </div>'),mp=z('<div><div class="role svelte-11gjw00"> </div> <!></div>');function gp(t,e){Ct(e,!0);let r=Oe(e,"isLast",3,!1),a=Oe(e,"isRunning",3,!1),i=Oe(e,"generationPhase",3,null),o=Oe(e,"numTokens",3,null);rn(()=>Ln(`MessageBubble[${e.msg.role}]`));var u=mp(),f=m(u),h=m(f),v=b(f,2);{var y=x=>{var k=pp(),N=Ve(k);{var E=G=>{var ue=lp(),we=b(m(ue),4);{var Ee=ie=>{var J=op(),le=m(J);te(()=>W(le,`${o()??""} tokens`)),D(ie,J)};fe(we,ie=>{o()&&ie(Ee)})}D(G,ue)},A=G=>{var ue=cp();D(G,ue)};fe(N,G=>{a()&&r()&&i()==="thinking"?G(E):a()&&r()&&i()==="preparing"&&G(A,1)})}var Q=b(N,2);{var de=G=>{var ue=up(),we=m(ue),Ee=b(m(we),2),ie=m(Ee),J=b(we,2),le=m(J);te(Se=>{W(ie,`${Se??""} words`),W(le,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),D(G,ue)};fe(Q,G=>{e.msg.thinking&&G(de)})}var U=b(Q,2),q=m(U);{var Y=G=>{var ue=fp();D(G,ue)},$=G=>{var ue=vp(),we=Ve(ue,!0),Ee=b(we);{var ie=J=>{var le=dp();D(J,le)};fe(Ee,J=>{a()&&r()&&J(ie)})}te(()=>W(we,e.msg.content)),D(G,ue)};fe(q,G=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?G(Y):G($,!1)})}D(x,k)},S=x=>{var k=hp(),N=m(k);te(()=>W(N,e.msg.content)),D(x,k)};fe(v,x=>{e.msg.role==="assistant"?x(y):x(S,!1)})}te(()=>{Mt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),W(h,e.msg.role==="user"?"You":"AI")}),D(t,u),Pt()}var _p=z('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),yp=z('<span class="edate svelte-mt5nvh"> </span>'),bp=z('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),wp=z('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),kp=z('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),xp=z('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),Sp=z('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function Tp(t,e){Ct(e,!0);let r=Oe(e,"pendingData",3,null),a=Re(null),i=Re(null);function o(k){M(a,g(a)===k?null:k,!0),M(i,null)}function u(k){return k.split("_").map(N=>N.charAt(0)+N.slice(1).toLowerCase()).join(" ")}function f(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function h(k){if(!k)return"";const N=k.replace(/<.*>/,"").trim();return N.length>24?N.slice(0,22)+"â¦":N}var v={toggleGroup:o},y=Ir(),S=Ve(y);{var x=k=>{var N=Sp(),E=m(N),A=m(E),Q=b(E,2);nn(Q,20,()=>r().order,q=>q,(q,Y)=>{const $=At(()=>r().groups[Y]),G=At(()=>mo(Y)),ue=At(()=>g(a)===Y);var we=_p();let Ee;we.__click=()=>o(Y);let ie;var J=m(we);let le;var Se=b(J),ce=b(Se),_e=m(ce);te(ke=>{Ee=Mt(we,1,"chip svelte-mt5nvh",null,Ee,{active:g(ue)}),ie=En(we,"",ie,{"--c":g(G)}),le=En(J,"",le,{background:g(G)}),W(Se,` ${ke??""} `),W(_e,g($).length)},[()=>u(Y)]),D(q,we)});var de=b(Q,2);{var U=q=>{const Y=At(()=>r().groups[g(a)]),$=At(()=>mo(g(a)));var G=xp(),ue=m(G);let we;var Ee=m(ue);Ee.__click=()=>{M(a,null),M(i,null)};var ie=b(Ee,2),J=m(ie),le=b(ie,2),Se=m(le),ce=b(ue,2);nn(ce,21,()=>g(Y),ve=>ve.emailId,(ve,ae)=>{var V=bp(),ee=m(V);ee.__click=()=>{var De;return(De=e.onaskai)==null?void 0:De.call(e,`Tell me about the email "${g(ae).subject}" from ${g(ae).from}`)};var Z=m(ee),oe=m(Z),Be=b(Z,2),Ge=m(Be),qe=b(Ge);{var Ke=De=>{var nt=yp(),rt=m(nt);te(ft=>W(rt,ft),[()=>f(g(ae).date)]),D(De,nt)};fe(qe,De=>{g(ae).date&&De(Ke)})}var B=b(ee,2),ye=m(B);ye.__click=()=>{var De;return(De=e.onmarkacted)==null?void 0:De.call(e,g(ae).emailId)};var Te=b(ye,2);Te.__click=()=>{var De;return(De=e.ondismiss)==null?void 0:De.call(e,g(ae).emailId)},te(De=>{W(oe,g(ae).subject),W(Ge,De)},[()=>h(g(ae).from)]),D(ve,V)});var _e=b(ce,2),ke=m(_e);{var re=ve=>{var ae=wp(),V=Ve(ae);V.__click=()=>g(Y).forEach(Z=>{var oe;return(oe=e.onmarkacted)==null?void 0:oe.call(e,Z.emailId)});var ee=b(V,2);ee.__click=()=>M(i,g(a),!0),D(ve,ae)},pe=ve=>{var ae=kp(),V=Ve(ae),ee=m(V),Z=b(V,2);Z.__click=()=>M(i,null);var oe=b(Z,2);oe.__click=()=>{var Be;(Be=e.oncleargroup)==null||Be.call(e,g(a)),M(i,null),M(a,null)},te(()=>W(ee,`Remove ${g(Y).length??""}?`)),D(ve,ae)};fe(ke,ve=>{g(i)!==g(a)?ve(re):ve(pe,!1)})}te(ve=>{we=En(ue,"",we,{"border-color":g($)}),W(J,ve),W(Se,g(Y).length)},[()=>u(g(a))]),D(q,G)};fe(de,q=>{g(a)&&r().groups[g(a)]&&q(U)})}te(()=>W(A,`${r().total??""} item${r().total!==1?"s":""} need attention`)),D(k,N)};fe(S,k=>{r()&&r().total>0&&k(x)})}return D(t,y),Pt(v)}Ft(["click"]);var Ep=z('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),Ap=z('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),Cp=z('<div class="strip svelte-1ed7zw1"><!></div>');function Pp(t,e){let r=Oe(e,"hasScanData",3,!1),a=Oe(e,"engineReady",3,!1),i=Oe(e,"isScanning",3,!1),o=At(()=>a()&&!r()&&!i()),u=At(()=>g(o)||i());var f=Ir(),h=Ve(f);{var v=y=>{var S=Cp(),x=m(S);{var k=E=>{var A=Ep();D(E,A)},N=E=>{var A=Ap();A.__click=function(...Q){var de;(de=e.onscan)==null||de.apply(this,Q)},D(E,A)};fe(x,E=>{i()?E(k):g(o)&&E(N,1)})}D(y,S)};fe(h,y=>{g(u)&&y(v)})}D(t,f)}Ft(["click"]);var Ip=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Rp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Op=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Dp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),jp=z('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Mp=z('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Lp=z('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Np(t,e){Ct(e,!0),rn(()=>Ln("GpuPanel"));var r=Lp(),a=m(r),i=b(m(a),2),o=b(m(i),2),u=m(o),f=b(i,2),h=b(m(f),2),v=m(h),y=b(f,2);{var S=q=>{var Y=Ip(),$=b(m(Y),2),G=m($);te(()=>W(G,e.gpuInfo.device)),D(q,Y)};fe(y,q=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&q(S)})}var x=b(y,2);{var k=q=>{var Y=Rp(),$=b(m(Y),2),G=m($);te(ue=>W(G,ue),[()=>po(e.gpuInfo.limits.maxBufferSize)]),D(q,Y)};fe(x,q=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxBufferSize&&q(k)})}var N=b(x,2);{var E=q=>{var Y=Op(),$=b(m(Y),2),G=m($);te(()=>W(G,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),D(q,Y)};fe(N,q=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxComputeInvocationsPerWorkgroup&&q(E)})}var A=b(N,2);{var Q=q=>{var Y=Dp(),$=b(m(Y),2),G=m($);te(ue=>W(G,ue),[()=>po(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),D(q,Y)};fe(A,q=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxComputeWorkgroupStorageSize&&q(Q)})}var de=b(A,2);{var U=q=>{var Y=Mp(),$=m(Y),G=m($),ue=b($,2);nn(ue,21,()=>e.gpuInfo.features,Vn,(we,Ee)=>{var ie=jp(),J=m(ie);te(()=>W(J,g(Ee))),D(we,ie)}),te(()=>W(G,`Features (${e.gpuInfo.features.length??""})`)),D(q,Y)};fe(de,q=>{var Y;(Y=e.gpuInfo.features)!=null&&Y.length&&q(U)})}te(()=>{W(u,e.gpuInfo.vendor),W(v,e.gpuInfo.architecture)}),D(t,r),Pt()}var qp=z('<button class="gpu-badge svelte-1ktw27c"> </button>'),Bp=z('<span class="stats svelte-1ktw27c"> </span>'),zp=z('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Fp=z('<span class="stats preparing svelte-1ktw27c"> </span>'),Kp=z('<span class="stats svelte-1ktw27c"> </span>'),Up=z('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Gp=z('<button class="btn svelte-1ktw27c">Stop</button>'),Hp=z('<button class="btn primary svelte-1ktw27c">Send</button>'),Wp=z('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Vp(t,e){Ct(e,!0),rn(()=>Ln("ChatView"));let r=Oe(e,"messages",19,()=>[]),a=Oe(e,"pendingData",3,null),i=Oe(e,"hasScanData",3,!1),o=Oe(e,"engineReady",3,!1),u=Oe(e,"isScanning",3,!1),f=Oe(e,"isRunning",3,!1),h=Oe(e,"tps",3,null),v=Oe(e,"numTokens",3,null),y=Oe(e,"generationPhase",3,null),S=Oe(e,"gpuInfo",3,null),x=Oe(e,"chatContainer",15),k=Re(""),N=Re(!1);function E(Z){Z.key==="Enter"&&!Z.shiftKey&&(Z.preventDefault(),A())}function A(){const Z=g(k).trim();!Z||f()||(M(k,""),e.onsend(Z))}function Q(Z){Z&&!f()&&e.onsend(Z)}var de=Wp(),U=m(de),q=m(U);{var Y=Z=>{var oe=qp();oe.__click=()=>M(N,!g(N));var Be=m(oe);te(()=>W(Be,`WebGPU ${g(N)?"â²":"â¼"}`)),D(Z,oe)};fe(q,Z=>{S()&&Z(Y)})}var $=b(q,2);{var G=Z=>{var oe=Bp(),Be=m(oe);te((Ge,qe)=>W(Be,`${v()??""} tokens in ${Ge??""}s
        (${qe??""} tok/s)`),[()=>(v()/h()).toFixed(1),()=>h().toFixed(1)]),D(Z,oe)},ue=Z=>{var oe=zp();D(Z,oe)},we=Z=>{var oe=Fp(),Be=m(oe);te(Ge=>W(Be,`thinking... ${Ge??""}`),[()=>h()?`${h().toFixed(0)} tok/s`:""]),D(Z,oe)},Ee=Z=>{var oe=Kp(),Be=m(oe);te(Ge=>W(Be,`${Ge??""} tok/s`),[()=>h().toFixed(1)]),D(Z,oe)};fe($,Z=>{h()&&!f()?Z(G):f()&&y()==="preparing"?Z(ue,1):f()&&y()==="thinking"?Z(we,2):h()&&f()&&Z(Ee,3)})}var ie=b($,4);ie.__click=function(...Z){var oe;(oe=e.onreset)==null||oe.apply(this,Z)};var J=b(U,2);{var le=Z=>{Np(Z,{get gpuInfo(){return S()}})};fe(J,Z=>{g(N)&&S()&&Z(le)})}var Se=b(J,2),ce=m(Se);{var _e=Z=>{var oe=Up();D(Z,oe)};fe(ce,Z=>{r().length===0&&!(a()&&a().total>0)&&Z(_e)})}var ke=b(ce,2);nn(ke,17,r,Vn,(Z,oe,Be)=>{var Ge=Ir(),qe=Ve(Ge);{var Ke=ye=>{Tp(ye,{get pendingData(){return g(oe).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:Q})},B=ye=>{{let Te=At(()=>Be===r().length-1);gp(ye,{get msg(){return g(oe)},get isLast(){return g(Te)},get isRunning(){return f()},get generationPhase(){return y()},get numTokens(){return v()}})}};fe(qe,ye=>{g(oe).type==="dashboard"?ye(Ke):ye(B,!1)})}D(Z,Ge)}),mu(Se,Z=>x(Z),()=>x());var re=b(Se,2);Pp(re,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var pe=b(re,2),ve=m(pe);ve.__keydown=E;var ae=b(ve,2);{var V=Z=>{var oe=Gp();oe.__click=function(...Be){var Ge;(Ge=e.onstop)==null||Ge.apply(this,Be)},D(Z,oe)},ee=Z=>{var oe=Hp();oe.__click=A,te(Be=>oe.disabled=Be,[()=>!g(k).trim()]),D(Z,oe)};fe(ae,Z=>{f()?Z(V):Z(ee,!1)})}te(()=>{ie.disabled=f(),ve.disabled=f()}),Bo(ve,()=>g(k),Z=>M(k,Z)),D(t,de),Pt()}Ft(["click","keydown"]);var Yp=z('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Xp(t,e){Ct(e,!0);const r=!!navigator.gpu,a=_u();let i=Re(Jt(localStorage.getItem("selectedModel")||Hr[0].id)),o=Re(null),u=Re(null),f=Re(""),h=Re(Jt([])),v=Re(Jt([])),y=Re(!1),S=Re(null),x=Re(null),k=Re(null),N=Re(null),E=Re(null),A=Re(null),Q=Re(!1),de=Re(!1),U=!1;rn(()=>{a.check(),a.isReady&&q();const V=a.onMessage(ee=>{switch(ee.status){case"webgpu-info":M(N,ee.data,!0);break;case"loading":M(o,"loading"),M(f,ee.data,!0);break;case"initiate":M(h,[...g(h),ee],!0);break;case"progress":M(h,g(h).map(Z=>Z.file===ee.file?{...Z,...ee}:Z),!0);break;case"done":M(h,g(h).filter(Z=>Z.file!==ee.file),!0);break;case"ready":M(o,"ready"),q();break;case"start":if(!g(y))break;M(E,ee.phase||"preparing",!0),M(v,[...g(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!g(y))break;M(E,ee.phase,!0);break;case"thinking":{if(!g(y))break;M(S,ee.tps,!0),M(x,ee.numTokens,!0);const Z=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Z,thinking:(Z.thinking||"")+ee.content}],!0),ie();break}case"thinking-done":{if(!g(y))break;M(S,ee.tps,!0),M(x,ee.numTokens,!0);const Z=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Z,thinking:ee.content}],!0);break}case"update":{if(!g(y))break;M(S,ee.tps,!0),M(x,ee.numTokens,!0);const Z=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Z,content:Z.content+ee.output}],!0),ie();break}case"complete":if(!g(y))break;M(y,!1),M(E,null),Y();break;case"error":if(!g(y))break;M(u,ee.data,!0),M(y,!1),M(E,null);break}});return()=>V()});async function q(){if(!(U||g(v).length>0))try{const V=await Wl();M(A,V,!0),V&&(U=!0,M(v,[{role:"assistant",type:"dashboard",pendingData:V}],!0),ie());const ee=await ho();M(Q,ee.classified>0)}catch{}}async function Y(){try{const V=await Wl();M(A,V,!0);const ee=g(v).findIndex(oe=>oe.type==="dashboard");ee!==-1&&(V&&V.total>0?M(v,g(v).map((oe,Be)=>Be===ee?{...oe,pendingData:V}:oe),!0):M(v,g(v).filter((oe,Be)=>Be!==ee),!0));const Z=await ho();M(Q,Z.classified>0)}catch{}}async function $(V){await si(V,"acted"),await Y()}async function G(V){await si(V,"dismissed"),await Y()}async function ue(V){await Ru(V),await Y()}async function we(V){await Ko(V),await Y()}async function Ee(){if(!(g(de)||!a.isReady)){M(de,!0);try{await Iu(a,{count:20}),await Y(),g(A)&&!g(v).some(V=>V.type==="dashboard")&&(M(v,[{role:"assistant",type:"dashboard",pendingData:g(A)},...g(v)],!0),ie())}catch(V){console.error("Scan failed:",V)}finally{M(de,!1)}}}function ie(){uu().then(()=>{g(k)&&(g(k).scrollTop=g(k).scrollHeight)})}function J(){M(o,"loading"),localStorage.setItem("selectedModel",g(i)),a.loadModel(g(i))}async function le(V){if(!V||g(y))return;M(v,[...g(v),{role:"user",content:V}],!0),M(S,null),M(y,!0);let ee=[];try{const Be=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(V)?await Ev(V):await Tv();Be&&(ee=[{role:"system",content:Be}])}catch{}const Z=g(v).filter(oe=>oe.type!=="dashboard").map(oe=>({role:oe.role,content:oe.content}));a.generate([...ee,...Z]),ie()}function Se(){a.interrupt()}function ce(){a.reset(),M(v,[],!0),M(S,null),M(x,null),U=!1,q()}var _e=Ir(),ke=Ve(_e);{var re=V=>{var ee=Yp();D(V,ee)},pe=V=>{Jv(V,{get gpuInfo(){return g(N)},get error(){return g(u)},onload:J,get selectedModel(){return g(i)},set selectedModel(ee){M(i,ee,!0)}})},ve=V=>{ip(V,{get message(){return g(f)},get items(){return g(h)}})},ae=V=>{Vp(V,{get messages(){return g(v)},get pendingData(){return g(A)},get hasScanData(){return g(Q)},get engineReady(){return a.isReady},get isScanning(){return g(de)},get isRunning(){return g(y)},get tps(){return g(S)},get numTokens(){return g(x)},get generationPhase(){return g(E)},get gpuInfo(){return g(N)},onsend:le,onstop:Se,onreset:ce,onmarkacted:$,ondismiss:G,onremove:ue,oncleargroup:we,onscan:Ee,get chatContainer(){return g(k)},set chatContainer(ee){M(k,ee,!0)}})};fe(ke,V=>{r?g(o)===null?V(pe,1):g(o)==="loading"?V(ve,2):V(ae,!1):V(re)})}D(t,_e),Pt()}const Ql="https://accounts.google.com/gsi/client",Qp="https://www.googleapis.com/auth/gmail.readonly",Uo="me-ai:oauth-token",Go=300*1e3;let ms=null,vs=null,Vr=0;function Du(t,e){Vr=Date.now()+e*1e3;try{sessionStorage.setItem(Uo,JSON.stringify({access_token:t,expires_at:Vr}))}catch{}}function go(){Vr=0;try{sessionStorage.removeItem(Uo)}catch{}}function Zp(){try{const t=sessionStorage.getItem(Uo);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-Go?(go(),null):(Vr=r,{access_token:e})}catch{return go(),null}}function Jp(){return Vr>0&&Date.now()<Vr-Go}function $p(){return Vr<=0?0:Math.max(0,Vr-Go-Date.now())}function Zl(){return new Promise((t,e)=>{if(!ms){e(new Error("Google Auth not initialized."));return}vs=r=>{r.error?e(new Error(r.error_description||r.error)):(Du(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},ms.requestAccessToken({prompt:""})})}function eh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Ql}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Ql,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Jl(t){await eh(),ms=google.accounts.oauth2.initTokenClient({client_id:t,scope:Qp,callback:e=>{vs&&(vs(e),vs=null)}})}function th(){return new Promise((t,e)=>{if(!ms){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}vs=r=>{r.error?e(new Error(r.error_description||r.error)):(Du(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},ms.requestAccessToken()})}function nh(t){return go(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const $t="gmail",$l=8,ju=50,Mu=100;async function rh(t,{limit:e=ju,onProgress:r=()=>{},signal:a}={}){var u;const i=await ze.syncState.get($t);if(i!=null&&i.historyId)try{return await lh(t,i,r,a)}catch(f){if(f instanceof zo&&(f.status===404||f.code==="notFound")||((u=f.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await ze.syncState.delete($t);else throw f}return await ih(t,e===0?1/0:e,r,a)}async function ah(t,{limit:e=ju,onProgress:r=()=>{},signal:a}={}){const i=await ze.syncState.get($t);return i!=null&&i.oldestPageToken?await oh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function sh(){const t=await ze.syncState.get($t);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Lu(){await ze.transaction("rw",[ze.items,ze.syncState],async()=>{await ze.items.where("sourceType").equals($t).delete(),await ze.syncState.delete($t)})}async function ih(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ma(a);const i=await wu(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,f=null;for(;o.length<e;){ma(a);const S=e-o.length,x=await ku(t,{maxResults:Math.min(Mu,S),pageToken:u}),k=(x.messages||[]).map(N=>N.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=x.nextPageToken,!u||k.length===0)break}if(f=u||null,o.length===0)return await ze.syncState.put({sourceType:$t,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:h,errors:v}=await Nu(t,o,r,a),y=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.put({sourceType:$t,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:f}),r({phase:"done",message:`Synced ${h} messages`,current:h,total:h}),{added:h,deleted:0,errors:v}}async function oh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ma(i);const o=[];let u=e.oldestPageToken,f=null;for(;o.length<r;){ma(i);const S=r-o.length,x=await ku(t,{maxResults:Math.min(Mu,S),pageToken:u}),k=(x.messages||[]).map(N=>N.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=x.nextPageToken,!u||k.length===0)break}if(f=u||null,o.length===0)return await ze.syncState.update($t,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:h,errors:v}=await Nu(t,o,a,i),y=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.update($t,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:f}),a({phase:"done",message:f?`Downloaded ${h} more (more available)`:`Downloaded ${h} more (all synced)`,current:y,total:y}),{added:h,errors:v}}async function lh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ma(a);let i=0,o=0,u=0,f,h=e.historyId;do{ma(a);const y=await pv(t,{startHistoryId:e.historyId,pageToken:f});if(h=y.historyId||h,f=y.nextPageToken,!!y.history){for(const S of y.history){if(S.messagesAdded){const x=S.messagesAdded.map(N=>N.message.id),k=[...new Set(x.filter(N=>N))];if(k.length>0){const N=await Promise.allSettled(k.map(A=>xu(t,A))),E=[];for(const A of N)A.status==="fulfilled"?E.push(qu(A.value)):u++;E.length>0&&(await ze.items.bulkPut(E),await Bu(E),i+=E.length)}}if(S.messagesDeleted){const x=S.messagesDeleted.map(k=>yu($t,k.message.id)).filter(k=>k);x.length>0&&(await ze.items.bulkDelete(x),o+=x.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(f);const v=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.put({sourceType:$t,historyId:h,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:v,total:v}),{added:i,deleted:o,errors:u}}async function Nu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=$l){ma(a);const f=e.slice(u,u+$l),h=await Promise.allSettled(f.map(y=>xu(t,y))),v=[];for(const y of h)y.status==="fulfilled"?v.push(qu(y.value)):o++;v.length>0&&(await ze.items.bulkPut(v),await Bu(v)),i+=v.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function qu(t){const e=qr(t,"From"),r=qr(t,"To"),a=qr(t,"Cc"),i=qr(t,"Subject")||"(no subject)",o=qr(t,"Date"),u=qr(t,"Message-ID"),f=qr(t,"In-Reply-To"),h=qr(t,"References");let v;try{v=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{v=Date.now()}return{id:yu($t,t.id),sourceType:$t,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:hv(t),htmlBody:mv(t),date:v,labels:t.labelIds||[],messageId:u,inReplyTo:f,references:h,raw:t,syncedAt:Date.now()}}async function Bu(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=ch(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await ze.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await ze.contacts.update(o.id,u)}else await ze.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function ch(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ma(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var uh=z(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function fh(t,e){Ct(e,!0);let r=Oe(e,"clientIdInput",15);rn(()=>Ln("SetupGuide"));let a=Re(null);async function i(Z){try{await navigator.clipboard.writeText(Z),M(a,Z,!0),setTimeout(()=>{M(a,null)},1500)}catch{const oe=document.createElement("input");oe.value=Z,document.body.appendChild(oe),oe.select(),document.execCommand("copy"),document.body.removeChild(oe),M(a,Z,!0),setTimeout(()=>{M(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",f="https://cypherkitty.github.io/me-ai/";var h=uh(),v=m(h),y=b(m(v),4),S=b(m(y),6),x=b(m(S),2),k=b(m(x),2),N=b(m(k),2),E=m(N);E.__click=()=>i(o);var A=m(E);A.textContent="http://localhost:5173";var Q=b(A,2),de=m(Q),U=b(E,2);U.__click=()=>i(u);var q=m(U);q.textContent="https://cypherkitty.github.io";var Y=b(q,2),$=m(Y),G=b(k,2),ue=b(m(G),2),we=m(ue);we.__click=()=>i(o);var Ee=m(we);Ee.textContent="http://localhost:5173";var ie=b(Ee,2),J=m(ie),le=b(we,2);le.__click=()=>i(u);var Se=m(le);Se.textContent="https://cypherkitty.github.io";var ce=b(Se,2),_e=m(ce),ke=b(le,2);ke.__click=()=>i(f);var re=m(ke);re.textContent="https://cypherkitty.github.io/me-ai/";var pe=b(re,2),ve=m(pe),ae=b(y,2),V=m(ae);V.__keydown=Z=>Z.key==="Enter"&&e.onsave();var ee=b(V,2);ee.__click=function(...Z){var oe;(oe=e.onsave)==null||oe.apply(this,Z)},te(Z=>{W(de,g(a)===o?"â":"â§"),W($,g(a)===u?"â":"â§"),W(J,g(a)===o?"â":"â§"),W(_e,g(a)===u?"â":"â§"),W(ve,g(a)===f?"â":"â§"),ee.disabled=Z},[()=>!r().trim()]),Bo(V,r),D(t,h),Pt()}Ft(["click","keydown"]);function dh(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof zo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var vh=z('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),ph=z('<div class="error-card-title svelte-14buhqq"> </div>'),hh=z('<p class="error-card-fix svelte-14buhqq"> </p>'),mh=z('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),gh=z('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),_h=z('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function zu(t,e){Ct(e,!0);let r=Oe(e,"ondismiss",3,null),a=Oe(e,"onsignout",3,null),i=At(()=>dh(e.error));rn(()=>Ln("ErrorCard"));var o=_h(),u=m(o);{var f=Q=>{var de=vh(),U=m(de),q=m(U),Y=b(U,2);Y.__click=function(...$){var G;(G=r())==null||G.apply(this,$)},te(()=>W(q,g(i).title)),D(Q,de)},h=Q=>{var de=ph(),U=m(de);te(()=>W(U,g(i).title)),D(Q,de)};fe(u,Q=>{r()?Q(f):Q(h,!1)})}var v=b(u,2),y=m(v),S=b(v,2);{var x=Q=>{var de=hh(),U=m(de);te(()=>W(U,g(i).fix)),D(Q,de)};fe(S,Q=>{g(i).fix&&Q(x)})}var k=b(S,2);{var N=Q=>{var de=mh(),U=m(de);te(()=>{hu(de,"href",g(i).link.url),W(U,`${g(i).link.label??""} â`)}),D(Q,de)};fe(k,Q=>{g(i).link&&Q(N)})}var E=b(k,2);{var A=Q=>{var de=gh();de.__click=function(...U){var q;(q=a())==null||q.apply(this,U)},D(Q,de)};fe(E,Q=>{g(i).action==="signout"&&a()&&Q(A)})}te(()=>W(y,g(i).description)),D(t,o),Pt()}Ft(["click"]);var yh=z('<span class="spinner svelte-nyqevv"></span> Signing in...',1),bh=No('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),wh=z(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function kh(t,e){Ct(e,!0);let r=Oe(e,"error",3,null),a=Oe(e,"loadingAuth",3,!1);rn(()=>Ln("AuthCard"));var i=wh(),o=m(i),u=b(m(o),4);{var f=A=>{zu(A,{get error(){return r()},get onsignout(){return e.onsignout}})};fe(u,A=>{r()&&A(f)})}var h=b(u,2);h.__click=function(...A){var Q;(Q=e.onsignin)==null||Q.apply(this,A)};var v=m(h);{var y=A=>{var Q=yh();D(A,Q)},S=A=>{var Q=bh();D(A,Q)};fe(v,A=>{a()?A(y):A(S,!1)})}var x=b(h,2),k=b(m(x),2),N=m(k),E=b(k,2);E.__click=function(...A){var Q;(Q=e.onclear)==null||Q.apply(this,A)},te(A=>{h.disabled=a(),W(N,`${A??""}...`)},[()=>e.clientId.slice(0,20)]),D(t,i),Pt()}Ft(["click"]);var xh=z('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Sh=z('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Th=z('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function Eh(t,e){Ct(e,!0);let r=Oe(e,"profile",3,null),a=Oe(e,"loadingProfile",3,!1);rn(()=>Ln("ProfileCard"));var i=Th(),o=m(i),u=m(o),f=b(o,2),h=m(f);{var v=x=>{var k=xh();D(x,k)},y=x=>{var k=Sh(),N=Ve(k),E=m(N),A=b(N,2),Q=m(A);te((de,U)=>{W(E,r().emailAddress),W(Q,`${de??""} messages
        Â· ${U??""} threads`)},[()=>{var de;return((de=r().messagesTotal)==null?void 0:de.toLocaleString())||"?"},()=>{var de;return((de=r().threadsTotal)==null?void 0:de.toLocaleString())||"?"}]),D(x,k)};fe(h,x=>{a()?x(v):r()&&x(y,1)})}var S=b(f,2);S.__click=function(...x){var k;(k=e.onsignout)==null||k.apply(this,x)},te(x=>W(u,x),[()=>r()?Tu(r().emailAddress):"?"]),D(t,i),Pt()}Ft(["click"]);var Ah=z('<span class="spinner svelte-1ds3j4k"></span>'),Ch=No('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Ph=z('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),Ih=z('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Rh=z('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Oh=z('<option class="svelte-1ds3j4k"> </option>'),Dh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),jh=z('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Mh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Lh=z('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Nh=z('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),qh=z('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Bh(t,e){Ct(e,!0),rn(()=>Ln("SyncStatus"));let r=Oe(e,"syncStatus",3,null),a=Oe(e,"syncProgress",3,null),i=Oe(e,"isSyncing",3,!1),o=Re(!1),u=Re(50);const f=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function h(re){if(!re)return"never";const pe=Math.floor((Date.now()-re)/1e3);if(pe<60)return"just now";const ve=Math.floor(pe/60);if(ve<60)return`${ve}m ago`;const ae=Math.floor(ve/60);return ae<24?`${ae}h ago`:`${Math.floor(ae/24)}d ago`}function v(){var re,pe;return!((re=a())!=null&&re.total)||!((pe=a())!=null&&pe.current)?0:Math.round(a().current/a().total*100)}var y=qh(),S=m(y),x=m(S),k=m(x);{var N=re=>{var pe=Ah();D(re,pe)},E=re=>{var pe=Ch();D(re,pe)};fe(k,re=>{i()?re(N):re(E,!1)})}var A=b(x,2),Q=b(m(A),2);{var de=re=>{var pe=Ph(),ve=m(pe),ae=b(ve);{var V=Z=>{var oe=ri("Â· more available");D(Z,oe)},ee=Z=>{var oe=ri("Â· all synced");D(Z,oe)};fe(ae,Z=>{r().hasMore?Z(V):Z(ee,!1)})}te((Z,oe)=>W(ve,`${Z??""} emails stored
          Â· synced ${oe??""} `),[()=>r().totalItems.toLocaleString(),()=>h(r().lastSyncAt)]),D(re,pe)},U=re=>{var pe=Ih();D(re,pe)};fe(Q,re=>{var pe;(pe=r())!=null&&pe.synced?re(de):re(U,!1)})}var q=b(A,2),Y=m(q);{var $=re=>{var pe=Rh();pe.__click=()=>M(o,!g(o)),D(re,pe)};fe(Y,re=>{var pe;(pe=r())!=null&&pe.synced&&!i()&&re($)})}var G=b(S,2),ue=m(G),we=b(m(ue),2);nn(we,21,()=>f,Vn,(re,pe)=>{var ve=Oh(),ae=m(ve),V={};te(()=>{W(ae,g(pe).label),V!==(V=g(pe).value)&&(ve.value=(ve.__value=g(pe).value)??"")}),D(re,ve)});var Ee=b(ue,2),ie=m(Ee);{var J=re=>{var pe=jh(),ve=Ve(pe);ve.__click=()=>e.onsync(g(u));var ae=m(ve),V=b(ve,2);{var ee=Z=>{var oe=Dh();oe.__click=()=>e.onsyncmore(g(u));var Be=m(oe);te(()=>{oe.disabled=i(),W(Be,i()?"Loading...":"Sync More")}),D(Z,oe)};fe(V,Z=>{r().hasMore&&Z(ee)})}te(()=>{ve.disabled=i(),W(ae,i()?"Syncing...":"Sync New")}),D(re,pe)},le=re=>{var pe=Mh();pe.__click=()=>e.onsync(g(u));var ve=m(pe);te(()=>{pe.disabled=i(),W(ve,i()?"Syncing...":"Download Emails")}),D(re,pe)};fe(ie,re=>{var pe;(pe=r())!=null&&pe.synced?re(J):re(le,!1)})}var Se=b(G,2);{var ce=re=>{var pe=Lh(),ve=m(pe),ae=m(ve);let V,ee;var Z=b(ve,2),oe=m(Z);te(Be=>{V=Mt(ae,1,"progress-fill svelte-1ds3j4k",null,V,{indeterminate:!a().total}),ee=En(ae,"",ee,Be),W(oe,a().message||"Syncing...")},[()=>({width:`${v()??""}%`})]),D(re,pe)};fe(Se,re=>{i()&&a()&&re(ce)})}var _e=b(Se,2);{var ke=re=>{var pe=Nh(),ve=b(m(pe),2),ae=m(ve);ae.__click=()=>M(o,!1);var V=b(ae,2);V.__click=()=>{e.onclear(),M(o,!1)},D(re,pe)};fe(_e,re=>{g(o)&&re(ke)})}te(()=>we.disabled=i()),qo(we,()=>g(u),re=>M(u,re)),D(t,y),Pt()}Ft(["click"]);var zh=z('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Fh=z('<div class="message-list svelte-y2uamw"></div>');function Kh(t,e){Ct(e,!0);let r=Oe(e,"messages",19,()=>[]);rn(()=>Ln("MessageList"));var a=Fh();nn(a,21,r,Vn,(i,o)=>{var u=zh();u.__click=()=>e.onselect(g(o));var f=m(u),h=m(f),v=b(f,2),y=m(v),S=m(y),x=m(S),k=b(S,2),N=m(k),E=b(y,2),A=m(E),Q=b(E,2),de=m(Q);te((U,q,Y)=>{W(h,U),W(x,q),W(N,Y),W(A,g(o).subject),W(de,g(o).snippet)},[()=>Tu(g(o).from),()=>Su(g(o).from),()=>Fo(g(o).date)]),D(i,u)}),D(t,a),Pt()}Ft(["click"]);function Ho(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ya=Ho();function Fu(t){ya=t}var $r={exec:()=>null};function ut(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(hn.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Uh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),hn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Gh=/^(?:[ \t]*(?:\n|$))+/,Hh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Wh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ts=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Vh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Wo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Ku=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Uu=ut(Ku).replace(/bull/g,Wo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Yh=ut(Ku).replace(/bull/g,Wo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Vo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Xh=/^[^\n]+/,Yo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Qh=ut(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Yo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Zh=ut(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Wo).getRegex(),mi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Xo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Jh=ut("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Xo).replace("tag",mi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Gu=ut(Vo).replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex(),$h=ut(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Gu).getRegex(),Qo={blockquote:$h,code:Hh,def:Qh,fences:Wh,heading:Vh,hr:Ts,html:Jh,lheading:Uu,list:Zh,newline:Gh,paragraph:Gu,table:$r,text:Xh},ec=ut("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex(),em={...Qo,lheading:Yh,table:ec,paragraph:ut(Vo).replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ec).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex()},tm={...Qo,html:ut(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Xo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:$r,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ut(Vo).replace("hr",Ts).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Uu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},nm=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,rm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Hu=/^( {2,}|\\)\n(?!\s*$)/,am=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,gi=/[\p{P}\p{S}]/u,Zo=/[\s\p{P}\p{S}]/u,Wu=/[^\s\p{P}\p{S}]/u,sm=ut(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Zo).getRegex(),Vu=/(?!~)[\p{P}\p{S}]/u,im=/(?!~)[\s\p{P}\p{S}]/u,om=/(?:[^\s\p{P}\p{S}]|~)/u,Yu=/(?![*_])[\p{P}\p{S}]/u,lm=/(?![*_])[\s\p{P}\p{S}]/u,cm=/(?:[^\s\p{P}\p{S}]|[*_])/u,um=ut(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Uh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Xu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,fm=ut(Xu,"u").replace(/punct/g,gi).getRegex(),dm=ut(Xu,"u").replace(/punct/g,Vu).getRegex(),Qu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",vm=ut(Qu,"gu").replace(/notPunctSpace/g,Wu).replace(/punctSpace/g,Zo).replace(/punct/g,gi).getRegex(),pm=ut(Qu,"gu").replace(/notPunctSpace/g,om).replace(/punctSpace/g,im).replace(/punct/g,Vu).getRegex(),hm=ut("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Wu).replace(/punctSpace/g,Zo).replace(/punct/g,gi).getRegex(),mm=ut(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Yu).getRegex(),gm="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",_m=ut(gm,"gu").replace(/notPunctSpace/g,cm).replace(/punctSpace/g,lm).replace(/punct/g,Yu).getRegex(),ym=ut(/\\(punct)/,"gu").replace(/punct/g,gi).getRegex(),bm=ut(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),wm=ut(Xo).replace("(?:-->|$)","-->").getRegex(),km=ut("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",wm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ii=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,xm=ut(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ii).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Zu=ut(/^!?\[(label)\]\[(ref)\]/).replace("label",ii).replace("ref",Yo).getRegex(),Ju=ut(/^!?\[(ref)\](?:\[\])?/).replace("ref",Yo).getRegex(),Sm=ut("reflink|nolink(?!\\()","g").replace("reflink",Zu).replace("nolink",Ju).getRegex(),tc=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Jo={_backpedal:$r,anyPunctuation:ym,autolink:bm,blockSkip:um,br:Hu,code:rm,del:$r,delLDelim:$r,delRDelim:$r,emStrongLDelim:fm,emStrongRDelimAst:vm,emStrongRDelimUnd:hm,escape:nm,link:xm,nolink:Ju,punctuation:sm,reflink:Zu,reflinkSearch:Sm,tag:km,text:am,url:$r},Tm={...Jo,link:ut(/^!?\[(label)\]\((.*?)\)/).replace("label",ii).getRegex(),reflink:ut(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ii).getRegex()},_o={...Jo,emStrongRDelimAst:pm,emStrongLDelim:dm,delLDelim:mm,delRDelim:_m,url:ut(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",tc).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ut(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",tc).getRegex()},Em={..._o,br:ut(Hu).replace("{2,}","*").getRegex(),text:ut(_o.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Hs={normal:Qo,gfm:em,pedantic:tm},es={normal:Jo,gfm:_o,breaks:Em,pedantic:Tm},Am={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},nc=t=>Am[t];function kr(t,e){if(e){if(hn.escapeTest.test(t))return t.replace(hn.escapeReplace,nc)}else if(hn.escapeTestNoEncode.test(t))return t.replace(hn.escapeReplaceNoEncode,nc);return t}function rc(t){try{t=encodeURI(t).replace(hn.percentDecode,"%")}catch{return null}return t}function ac(t,e){var o;let r=t.replace(hn.findPipe,(u,f,h)=>{let v=!1,y=f;for(;--y>=0&&h[y]==="\\";)v=!v;return v?"|":" |"}),a=r.split(hn.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(hn.slashPipe,"|");return a}function ts(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function Cm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function Pm(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function sc(t,e,r,a,i){let o=e.href,u=e.title||null,f=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:f,tokens:a.inlineTokens(f)};return a.state.inLink=!1,h}function Im(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[f]=u;return f.length>=i.length?o.slice(i.length):o}).join(`
`)}var oi=class{constructor(t){$e(this,"options");$e(this,"rules");$e(this,"lexer");this.options=t||ya}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:ts(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=Im(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=ts(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:ts(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=ts(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,f=[],h;for(h=0;h<r.length;h++)if(this.rules.other.blockquoteStart.test(r[h]))f.push(r[h]),u=!0;else if(!u)f.push(r[h]);else break;r=r.slice(h);let v=f.join(`
`),y=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,i=i?`${i}
${y}`:y;let S=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=S,r.length===0)break;let x=o.at(-1);if((x==null?void 0:x.type)==="code")break;if((x==null?void 0:x.type)==="blockquote"){let k=x,N=k.raw+`
`+r.join(`
`),E=this.blockquote(N);o[o.length-1]=E,a=a.substring(0,a.length-k.raw.length)+E.raw,i=i.substring(0,i.length-k.text.length)+E.text;break}else if((x==null?void 0:x.type)==="list"){let k=x,N=k.raw+`
`+r.join(`
`),E=this.list(N);o[o.length-1]=E,a=a.substring(0,a.length-x.raw.length)+E.raw,i=i.substring(0,i.length-k.raw.length)+E.raw,r=N.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let f=this.rules.other.listItemRegex(i),h=!1;for(;t;){let y=!1,S="",x="";if(!(e=f.exec(t))||this.rules.block.hr.test(t))break;S=e[0],t=t.substring(S.length);let k=Pm(e[2].split(`
`,1)[0],e[1].length),N=t.split(`
`,1)[0],E=!k.trim(),A=0;if(this.options.pedantic?(A=2,x=k.trimStart()):E?A=e[1].length+1:(A=k.search(this.rules.other.nonSpaceChar),A=A>4?1:A,x=k.slice(A),A+=e[1].length),E&&this.rules.other.blankLine.test(N)&&(S+=N+`
`,t=t.substring(N.length+1),y=!0),!y){let Q=this.rules.other.nextBulletRegex(A),de=this.rules.other.hrRegex(A),U=this.rules.other.fencesBeginRegex(A),q=this.rules.other.headingBeginRegex(A),Y=this.rules.other.htmlBeginRegex(A),$=this.rules.other.blockquoteBeginRegex(A);for(;t;){let G=t.split(`
`,1)[0],ue;if(N=G,this.options.pedantic?(N=N.replace(this.rules.other.listReplaceNesting,"  "),ue=N):ue=N.replace(this.rules.other.tabCharGlobal,"    "),U.test(N)||q.test(N)||Y.test(N)||$.test(N)||Q.test(N)||de.test(N))break;if(ue.search(this.rules.other.nonSpaceChar)>=A||!N.trim())x+=`
`+ue.slice(A);else{if(E||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||U.test(k)||q.test(k)||de.test(k))break;x+=`
`+N}E=!N.trim(),S+=G+`
`,t=t.substring(G.length+1),k=ue.slice(A)}}u.loose||(h?u.loose=!0:this.rules.other.doubleBlankLine.test(S)&&(h=!0)),u.items.push({type:"list_item",raw:S,task:!!this.options.gfm&&this.rules.other.listIsTask.test(x),loose:!1,text:x,tokens:[]}),u.raw+=S}let v=u.items.at(-1);if(v)v.raw=v.raw.trimEnd(),v.text=v.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let y of u.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let x=this.lexer.inlineQueue.length-1;x>=0;x--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[x].src)){this.lexer.inlineQueue[x].src=this.lexer.inlineQueue[x].src.replace(this.rules.other.listReplaceTask,"");break}}let S=this.rules.other.listTaskCheckbox.exec(y.raw);if(S){let x={type:"checkbox",raw:S[0]+" ",checked:S[0]!=="[ ]"};y.checked=x.checked,u.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=x.raw+y.tokens[0].raw,y.tokens[0].text=x.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(x)):y.tokens.unshift({type:"paragraph",raw:x.raw,text:x.raw,tokens:[x]}):y.tokens.unshift(x)}}if(!u.loose){let S=y.tokens.filter(k=>k.type==="space"),x=S.length>0&&S.some(k=>this.rules.other.anyLine.test(k.raw));u.loose=x}}if(u.loose)for(let y of u.items){y.loose=!0;for(let S of y.tokens)S.type==="text"&&(S.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=ac(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let f of a)this.rules.other.tableAlignRight.test(f)?o.align.push("right"):this.rules.other.tableAlignCenter.test(f)?o.align.push("center"):this.rules.other.tableAlignLeft.test(f)?o.align.push("left"):o.align.push(null);for(let f=0;f<r.length;f++)o.header.push({text:r[f],tokens:this.lexer.inline(r[f]),header:!0,align:o.align[f]});for(let f of i)o.rows.push(ac(f,o.header.length).map((h,v)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[v]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=ts(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=Cm(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),sc(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return sc(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,f=i,h=0,v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){f+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){h+=u;continue}if(f-=u,f>0)continue;u=Math.min(u,u+f+h);let y=[...a[0]][0].length,S=t.slice(0,i+a.index+y+u);if(Math.min(i,u)%2){let k=S.slice(1,-1);return{type:"em",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}let x=S.slice(2,-2);return{type:"strong",raw:S,text:x,tokens:this.lexer.inlineTokens(x)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,f=i,h=this.rules.inline.delRDelim;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){f+=u;continue}if(f-=u,f>0)continue;u=Math.min(u,u+f);let v=[...a[0]][0].length,y=t.slice(0,i+a.index+v+u),S=y.slice(i,-i);return{type:"del",raw:y,text:S,tokens:this.lexer.inlineTokens(S)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},er=class yo{constructor(e){$e(this,"tokens");$e(this,"options");$e(this,"state");$e(this,"inlineQueue");$e(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ya,this.options.tokenizer=this.options.tokenizer||new oi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:hn,block:Hs.normal,inline:es.normal};this.options.pedantic?(r.block=Hs.pedantic,r.inline=es.pedantic):this.options.gfm&&(r.block=Hs.gfm,this.options.breaks?r.inline=es.breaks:r.inline=es.gfm),this.tokenizer.rules=r}static get rules(){return{block:Hs,inline:es}}static lex(e,r){return new yo(r).lex(e)}static lexInline(e,r){return new yo(r).inlineTokens(e)}lex(e){e=e.replace(hn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(hn.tabCharGlobal,"    ").replace(hn.spaceLine,""));e;){let f;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(v=>(f=v.call({lexer:this},e,r))?(e=e.substring(f.raw.length),r.push(f),!0):!1))continue;if(f=this.tokenizer.space(e)){e=e.substring(f.raw.length);let v=r.at(-1);f.raw.length===1&&v!==void 0?v.raw+=`
`:r.push(f);continue}if(f=this.tokenizer.code(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.at(-1).src=v.text):r.push(f);continue}if(f=this.tokenizer.fences(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.heading(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.hr(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.blockquote(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.list(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.html(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.def(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.raw,this.inlineQueue.at(-1).src=v.text):this.tokens.links[f.tag]||(this.tokens.links[f.tag]={href:f.href,title:f.title},r.push(f));continue}if(f=this.tokenizer.table(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.lheading(e)){e=e.substring(f.raw.length),r.push(f);continue}let h=e;if((u=this.options.extensions)!=null&&u.startBlock){let v=1/0,y=e.slice(1),S;this.options.extensions.startBlock.forEach(x=>{S=x.call({lexer:this},y),typeof S=="number"&&S>=0&&(v=Math.min(v,S))}),v<1/0&&v>=0&&(h=e.substring(0,v+1))}if(this.state.top&&(f=this.tokenizer.paragraph(h))){let v=r.at(-1);a&&(v==null?void 0:v.type)==="paragraph"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(f),a=h.length!==e.length,e=e.substring(f.raw.length);continue}if(f=this.tokenizer.text(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(f);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var h,v,y,S,x;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((v=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:v.call({lexer:this},a))??a;let u=!1,f="";for(;e;){u||(f=""),u=!1;let k;if((S=(y=this.options.extensions)==null?void 0:y.inline)!=null&&S.some(E=>(k=E.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let E=r.at(-1);k.type==="text"&&(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,f)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,f)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let N=e;if((x=this.options.extensions)!=null&&x.startInline){let E=1/0,A=e.slice(1),Q;this.options.extensions.startInline.forEach(de=>{Q=de.call({lexer:this},A),typeof Q=="number"&&Q>=0&&(E=Math.min(E,Q))}),E<1/0&&E>=0&&(N=e.substring(0,E+1))}if(k=this.tokenizer.inlineText(N)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(f=k.raw.slice(-1)),u=!0;let E=r.at(-1);(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(e){let E="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(E);break}else throw new Error(E)}}return r}},li=class{constructor(t){$e(this,"options");$e(this,"parser");this.options=t||ya}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(hn.notSpaceStart))==null?void 0:o[0],i=t.replace(hn.endingNewline,"")+`
`;return a?'<pre><code class="language-'+kr(a)+'">'+(r?i:kr(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:kr(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let f=t.items[u];a+=this.listitem(f)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${kr(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=rc(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+kr(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=rc(t);if(i===null)return kr(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${kr(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:kr(t.text)}},$o=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},tr=class bo{constructor(e){$e(this,"options");$e(this,"renderer");$e(this,"textRenderer");this.options=e||ya,this.options.renderer=this.options.renderer||new li,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new $o}static parse(e,r){return new bo(r).parse(e)}static parseInline(e,r){return new bo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let h=u,v=this.options.extensions.renderers[h.type].call({parser:this},h);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){r+=v||"";continue}}let f=u;switch(f.type){case"space":{r+=this.renderer.space(f);break}case"hr":{r+=this.renderer.hr(f);break}case"heading":{r+=this.renderer.heading(f);break}case"code":{r+=this.renderer.code(f);break}case"table":{r+=this.renderer.table(f);break}case"blockquote":{r+=this.renderer.blockquote(f);break}case"list":{r+=this.renderer.list(f);break}case"checkbox":{r+=this.renderer.checkbox(f);break}case"html":{r+=this.renderer.html(f);break}case"def":{r+=this.renderer.def(f);break}case"paragraph":{r+=this.renderer.paragraph(f);break}case"text":{r+=this.renderer.text(f);break}default:{let h='Token with "'+f.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let f=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[f.type]){let v=this.options.extensions.renderers[f.type].call({parser:this},f);if(v!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(f.type)){a+=v||"";continue}}let h=f;switch(h.type){case"escape":{a+=r.text(h);break}case"html":{a+=r.html(h);break}case"link":{a+=r.link(h);break}case"image":{a+=r.image(h);break}case"checkbox":{a+=r.checkbox(h);break}case"strong":{a+=r.strong(h);break}case"em":{a+=r.em(h);break}case"codespan":{a+=r.codespan(h);break}case"br":{a+=r.br(h);break}case"del":{a+=r.del(h);break}case"text":{a+=r.text(h);break}default:{let v='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return a}},Ys,ls=(Ys=class{constructor(t){$e(this,"options");$e(this,"block");this.options=t||ya}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?er.lex:er.lexInline}provideParser(){return this.block?tr.parse:tr.parseInline}},$e(Ys,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),$e(Ys,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Ys),Rm=class{constructor(...t){$e(this,"defaults",Ho());$e(this,"options",this.setOptions);$e(this,"parse",this.parseMarkdown(!0));$e(this,"parseInline",this.parseMarkdown(!1));$e(this,"Parser",tr);$e(this,"Renderer",li);$e(this,"TextRenderer",$o);$e(this,"Lexer",er);$e(this,"Tokenizer",oi);$e(this,"Hooks",ls);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let f of u.header)r=r.concat(this.walkTokens(f.tokens,e));for(let f of u.rows)for(let h of f)r=r.concat(this.walkTokens(h.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(f=>{let h=u[f].flat(1/0);r=r.concat(this.walkTokens(h,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let f=i.renderer.apply(this,u);return f===!1&&(f=o.apply(this,u)),f}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new li(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,f=r.renderer[u],h=i[u];i[u]=(...v)=>{let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new oi(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,f=r.tokenizer[u],h=i[u];i[u]=(...v)=>{let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ls;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,f=r.hooks[u],h=i[u];ls.passThroughHooks.has(o)?i[u]=v=>{if(this.defaults.async&&ls.passThroughHooksRespectAsync.has(o))return(async()=>{let S=await f.call(i,v);return h.call(i,S)})();let y=f.call(i,v);return h.call(i,y)}:i[u]=(...v)=>{if(this.defaults.async)return(async()=>{let S=await f.apply(i,v);return S===!1&&(S=await h.apply(i,v)),S})();let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let f=[];return f.push(o.call(this,u)),i&&(f=f.concat(i.call(this,u))),f}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return er.lex(t,e??this.defaults)}parser(t,e){return tr.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,f=await(i.hooks?await i.hooks.provideLexer():t?er.lex:er.lexInline)(u,i),h=i.hooks?await i.hooks.processAllTokens(f):f;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let v=await(i.hooks?await i.hooks.provideParser():t?tr.parse:tr.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(v):v})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?er.lex:er.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let f=(i.hooks?i.hooks.provideParser():t?tr.parse:tr.parseInline)(u,i);return i.hooks&&(f=i.hooks.postprocess(f)),f}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+kr(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ga=new Rm;function mt(t,e){return ga.parse(t,e)}mt.options=mt.setOptions=function(t){return ga.setOptions(t),mt.defaults=ga.defaults,Fu(mt.defaults),mt};mt.getDefaults=Ho;mt.defaults=ya;mt.use=function(...t){return ga.use(...t),mt.defaults=ga.defaults,Fu(mt.defaults),mt};mt.walkTokens=function(t,e){return ga.walkTokens(t,e)};mt.parseInline=ga.parseInline;mt.Parser=tr;mt.parser=tr.parse;mt.Renderer=li;mt.TextRenderer=$o;mt.Lexer=er;mt.lexer=er.lex;mt.Tokenizer=oi;mt.Hooks=ls;mt.parse=mt;mt.options;mt.setOptions;mt.use;mt.walkTokens;mt.parseInline;tr.parse;er.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:$u,setPrototypeOf:ic,isFrozen:Om,getPrototypeOf:Dm,getOwnPropertyDescriptor:jm}=Object;let{freeze:mn,seal:Yn,create:wo}=Object,{apply:ko,construct:xo}=typeof Reflect<"u"&&Reflect;mn||(mn=function(e){return e});Yn||(Yn=function(e){return e});ko||(ko=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});xo||(xo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ws=gn(Array.prototype.forEach),Mm=gn(Array.prototype.lastIndexOf),oc=gn(Array.prototype.pop),ns=gn(Array.prototype.push),Lm=gn(Array.prototype.splice),ei=gn(String.prototype.toLowerCase),Xi=gn(String.prototype.toString),Qi=gn(String.prototype.match),rs=gn(String.prototype.replace),Nm=gn(String.prototype.indexOf),qm=gn(String.prototype.trim),Jn=gn(Object.prototype.hasOwnProperty),pn=gn(RegExp.prototype.test),as=Bm(TypeError);function gn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return ko(t,e,a)}}function Bm(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return xo(t,r)}}function Je(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ei;ic&&ic(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(Om(e)||(e[a]=o),i=o)}t[i]=!0}return t}function zm(t){for(let e=0;e<t.length;e++)Jn(t,e)||(t[e]=null);return t}function cr(t){const e=wo(null);for(const[r,a]of $u(t))Jn(t,r)&&(Array.isArray(a)?e[r]=zm(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=cr(a):e[r]=a);return e}function ss(t,e){for(;t!==null;){const a=jm(t,e);if(a){if(a.get)return gn(a.get);if(typeof a.value=="function")return gn(a.value)}t=Dm(t)}function r(){return null}return r}const lc=mn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zi=mn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ji=mn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Fm=mn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$i=mn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Km=mn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),cc=mn(["#text"]),uc=mn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),eo=mn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),fc=mn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vs=mn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Um=Yn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Gm=Yn(/<%[\w\W]*|[\w\W]*%>/gm),Hm=Yn(/\$\{[\w\W]*/gm),Wm=Yn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Vm=Yn(/^aria-[\-\w]+$/),ef=Yn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ym=Yn(/^(?:\w+script|data):/i),Xm=Yn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),tf=Yn(/^html$/i),Qm=Yn(/^[a-z][.\w]*(-[.\w]+)+$/i);var dc=Object.freeze({__proto__:null,ARIA_ATTR:Vm,ATTR_WHITESPACE:Xm,CUSTOM_ELEMENT:Qm,DATA_ATTR:Wm,DOCTYPE_NAME:tf,ERB_EXPR:Gm,IS_ALLOWED_URI:ef,IS_SCRIPT_OR_DATA:Ym,MUSTACHE_EXPR:Um,TMPLIT_EXPR:Hm});const is={element:1,text:3,progressingInstruction:7,comment:8,document:9},Zm=function(){return typeof window>"u"?null:window},Jm=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},vc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function nf(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zm();const e=Ne=>nf(Ne);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==is.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:f,Element:h,NodeFilter:v,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:S,DOMParser:x,trustedTypes:k}=t,N=h.prototype,E=ss(N,"cloneNode"),A=ss(N,"remove"),Q=ss(N,"nextSibling"),de=ss(N,"childNodes"),U=ss(N,"parentNode");if(typeof u=="function"){const Ne=r.createElement("template");Ne.content&&Ne.content.ownerDocument&&(r=Ne.content.ownerDocument)}let q,Y="";const{implementation:$,createNodeIterator:G,createDocumentFragment:ue,getElementsByTagName:we}=r,{importNode:Ee}=a;let ie=vc();e.isSupported=typeof $u=="function"&&typeof U=="function"&&$&&$.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:le,TMPLIT_EXPR:Se,DATA_ATTR:ce,ARIA_ATTR:_e,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:re,CUSTOM_ELEMENT:pe}=dc;let{IS_ALLOWED_URI:ve}=dc,ae=null;const V=Je({},[...lc,...Zi,...Ji,...$i,...cc]);let ee=null;const Z=Je({},[...uc,...eo,...fc,...Vs]);let oe=Object.seal(wo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Be=null,Ge=null;const qe=Object.seal(wo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ke=!0,B=!0,ye=!1,Te=!0,De=!1,nt=!0,rt=!1,ft=!1,Rt=!1,He=!1,Ye=!1,at=!1,st=!0,_t=!1;const kt="user-content-";let qt=!0,bt=!1,pt={},yt=null;const un=Je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let an=null;const _n=Je({},["audio","video","img","source","image","track"]);let Yt=null;const Kt=Je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ut="http://www.w3.org/1998/Math/MathML",yn="http://www.w3.org/2000/svg",Ot="http://www.w3.org/1999/xhtml";let je=Ot,Nn=!1,An=null;const Dr=Je({},[Ut,yn,Ot],Xi);let Pe=Je({},["mi","mo","mn","ms","mtext"]),ir=Je({},["annotation-xml"]);const ba=Je({},["title","style","font","a","script"]);let Xn=null;const wa=["application/xhtml+xml","text/html"],it="text/html";let Ue=null,Bt=null;const Gt=r.createElement("form"),fn=function(T){return T instanceof RegExp||T instanceof Function},Qn=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Bt&&Bt===T)){if((!T||typeof T!="object")&&(T={}),T=cr(T),Xn=wa.indexOf(T.PARSER_MEDIA_TYPE)===-1?it:T.PARSER_MEDIA_TYPE,Ue=Xn==="application/xhtml+xml"?Xi:ei,ae=Jn(T,"ALLOWED_TAGS")?Je({},T.ALLOWED_TAGS,Ue):V,ee=Jn(T,"ALLOWED_ATTR")?Je({},T.ALLOWED_ATTR,Ue):Z,An=Jn(T,"ALLOWED_NAMESPACES")?Je({},T.ALLOWED_NAMESPACES,Xi):Dr,Yt=Jn(T,"ADD_URI_SAFE_ATTR")?Je(cr(Kt),T.ADD_URI_SAFE_ATTR,Ue):Kt,an=Jn(T,"ADD_DATA_URI_TAGS")?Je(cr(_n),T.ADD_DATA_URI_TAGS,Ue):_n,yt=Jn(T,"FORBID_CONTENTS")?Je({},T.FORBID_CONTENTS,Ue):un,Be=Jn(T,"FORBID_TAGS")?Je({},T.FORBID_TAGS,Ue):cr({}),Ge=Jn(T,"FORBID_ATTR")?Je({},T.FORBID_ATTR,Ue):cr({}),pt=Jn(T,"USE_PROFILES")?T.USE_PROFILES:!1,Ke=T.ALLOW_ARIA_ATTR!==!1,B=T.ALLOW_DATA_ATTR!==!1,ye=T.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=T.SAFE_FOR_TEMPLATES||!1,nt=T.SAFE_FOR_XML!==!1,rt=T.WHOLE_DOCUMENT||!1,He=T.RETURN_DOM||!1,Ye=T.RETURN_DOM_FRAGMENT||!1,at=T.RETURN_TRUSTED_TYPE||!1,Rt=T.FORCE_BODY||!1,st=T.SANITIZE_DOM!==!1,_t=T.SANITIZE_NAMED_PROPS||!1,qt=T.KEEP_CONTENT!==!1,bt=T.IN_PLACE||!1,ve=T.ALLOWED_URI_REGEXP||ef,je=T.NAMESPACE||Ot,Pe=T.MATHML_TEXT_INTEGRATION_POINTS||Pe,ir=T.HTML_INTEGRATION_POINTS||ir,oe=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&fn(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(oe.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&fn(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(oe.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(oe.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(B=!1),Ye&&(He=!0),pt&&(ae=Je({},cc),ee=[],pt.html===!0&&(Je(ae,lc),Je(ee,uc)),pt.svg===!0&&(Je(ae,Zi),Je(ee,eo),Je(ee,Vs)),pt.svgFilters===!0&&(Je(ae,Ji),Je(ee,eo),Je(ee,Vs)),pt.mathMl===!0&&(Je(ae,$i),Je(ee,fc),Je(ee,Vs))),T.ADD_TAGS&&(typeof T.ADD_TAGS=="function"?qe.tagCheck=T.ADD_TAGS:(ae===V&&(ae=cr(ae)),Je(ae,T.ADD_TAGS,Ue))),T.ADD_ATTR&&(typeof T.ADD_ATTR=="function"?qe.attributeCheck=T.ADD_ATTR:(ee===Z&&(ee=cr(ee)),Je(ee,T.ADD_ATTR,Ue))),T.ADD_URI_SAFE_ATTR&&Je(Yt,T.ADD_URI_SAFE_ATTR,Ue),T.FORBID_CONTENTS&&(yt===un&&(yt=cr(yt)),Je(yt,T.FORBID_CONTENTS,Ue)),T.ADD_FORBID_CONTENTS&&(yt===un&&(yt=cr(yt)),Je(yt,T.ADD_FORBID_CONTENTS,Ue)),qt&&(ae["#text"]=!0),rt&&Je(ae,["html","head","body"]),ae.table&&(Je(ae,["tbody"]),delete Be.tbody),T.TRUSTED_TYPES_POLICY){if(typeof T.TRUSTED_TYPES_POLICY.createHTML!="function")throw as('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof T.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw as('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');q=T.TRUSTED_TYPES_POLICY,Y=q.createHTML("")}else q===void 0&&(q=Jm(k,i)),q!==null&&typeof Y=="string"&&(Y=q.createHTML(""));mn&&mn(T),Bt=T}},xt=Je({},[...Zi,...Ji,...Fm]),lt=Je({},[...$i,...Km]),St=function(T){let he=U(T);(!he||!he.tagName)&&(he={namespaceURI:je,tagName:"template"});const be=ei(T.tagName),Ze=ei(he.tagName);return An[T.namespaceURI]?T.namespaceURI===yn?he.namespaceURI===Ot?be==="svg":he.namespaceURI===Ut?be==="svg"&&(Ze==="annotation-xml"||Pe[Ze]):!!xt[be]:T.namespaceURI===Ut?he.namespaceURI===Ot?be==="math":he.namespaceURI===yn?be==="math"&&ir[Ze]:!!lt[be]:T.namespaceURI===Ot?he.namespaceURI===yn&&!ir[Ze]||he.namespaceURI===Ut&&!Pe[Ze]?!1:!lt[be]&&(ba[be]||!xt[be]):!!(Xn==="application/xhtml+xml"&&An[T.namespaceURI]):!1},dn=function(T){ns(e.removed,{element:T});try{U(T).removeChild(T)}catch{A(T)}},vn=function(T,he){try{ns(e.removed,{attribute:he.getAttributeNode(T),from:he})}catch{ns(e.removed,{attribute:null,from:he})}if(he.removeAttribute(T),T==="is")if(He||Ye)try{dn(he)}catch{}else try{he.setAttribute(T,"")}catch{}},mr=function(T){let he=null,be=null;if(Rt)T="<remove></remove>"+T;else{const Tt=Qi(T,/^[\r\n\t ]+/);be=Tt&&Tt[0]}Xn==="application/xhtml+xml"&&je===Ot&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");const Ze=q?q.createHTML(T):T;if(je===Ot)try{he=new x().parseFromString(Ze,Xn)}catch{}if(!he||!he.documentElement){he=$.createDocument(je,"template",null);try{he.documentElement.innerHTML=Nn?Y:Ze}catch{}}const wt=he.body||he.documentElement;return T&&be&&wt.insertBefore(r.createTextNode(be),wt.childNodes[0]||null),je===Ot?we.call(he,rt?"html":"body")[0]:rt?he.documentElement:wt},gr=function(T){return G.call(T.ownerDocument||T,T,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},Yr=function(T){return T instanceof S&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof y)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},Cn=function(T){return typeof f=="function"&&T instanceof f};function zt(Ne,T,he){Ws(Ne,be=>{be.call(e,T,he,Bt)})}const bn=function(T){let he=null;if(zt(ie.beforeSanitizeElements,T,null),Yr(T))return dn(T),!0;const be=Ue(T.nodeName);if(zt(ie.uponSanitizeElement,T,{tagName:be,allowedTags:ae}),nt&&T.hasChildNodes()&&!Cn(T.firstElementChild)&&pn(/<[/\w!]/g,T.innerHTML)&&pn(/<[/\w!]/g,T.textContent)||T.nodeType===is.progressingInstruction||nt&&T.nodeType===is.comment&&pn(/<[/\w]/g,T.data))return dn(T),!0;if(!(qe.tagCheck instanceof Function&&qe.tagCheck(be))&&(!ae[be]||Be[be])){if(!Be[be]&&ka(be)&&(oe.tagNameCheck instanceof RegExp&&pn(oe.tagNameCheck,be)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck(be)))return!1;if(qt&&!yt[be]){const Ze=U(T)||T.parentNode,wt=de(T)||T.childNodes;if(wt&&Ze){const Tt=wt.length;for(let It=Tt-1;It>=0;--It){const sn=E(wt[It],!0);sn.__removalCount=(T.__removalCount||0)+1,Ze.insertBefore(sn,Q(T))}}}return dn(T),!0}return T instanceof h&&!St(T)||(be==="noscript"||be==="noembed"||be==="noframes")&&pn(/<\/no(script|embed|frames)/i,T.innerHTML)?(dn(T),!0):(De&&T.nodeType===is.text&&(he=T.textContent,Ws([J,le,Se],Ze=>{he=rs(he,Ze," ")}),T.textContent!==he&&(ns(e.removed,{element:T.cloneNode()}),T.textContent=he)),zt(ie.afterSanitizeElements,T,null),!1)},_r=function(T,he,be){if(st&&(he==="id"||he==="name")&&(be in r||be in Gt))return!1;if(!(B&&!Ge[he]&&pn(ce,he))){if(!(Ke&&pn(_e,he))){if(!(qe.attributeCheck instanceof Function&&qe.attributeCheck(he,T))){if(!ee[he]||Ge[he]){if(!(ka(T)&&(oe.tagNameCheck instanceof RegExp&&pn(oe.tagNameCheck,T)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck(T))&&(oe.attributeNameCheck instanceof RegExp&&pn(oe.attributeNameCheck,he)||oe.attributeNameCheck instanceof Function&&oe.attributeNameCheck(he,T))||he==="is"&&oe.allowCustomizedBuiltInElements&&(oe.tagNameCheck instanceof RegExp&&pn(oe.tagNameCheck,be)||oe.tagNameCheck instanceof Function&&oe.tagNameCheck(be))))return!1}else if(!Yt[he]){if(!pn(ve,rs(be,re,""))){if(!((he==="src"||he==="xlink:href"||he==="href")&&T!=="script"&&Nm(be,"data:")===0&&an[T])){if(!(ye&&!pn(ke,rs(be,re,"")))){if(be)return!1}}}}}}}return!0},ka=function(T){return T!=="annotation-xml"&&Qi(T,pe)},Pn=function(T){zt(ie.beforeSanitizeAttributes,T,null);const{attributes:he}=T;if(!he||Yr(T))return;const be={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ee,forceKeepAttr:void 0};let Ze=he.length;for(;Ze--;){const wt=he[Ze],{name:Tt,namespaceURI:It,value:sn}=wt,qn=Ue(Tt),Xt=sn;let ht=Tt==="value"?Xt:qm(Xt);if(be.attrName=qn,be.attrValue=ht,be.keepAttr=!0,be.forceKeepAttr=void 0,zt(ie.uponSanitizeAttribute,T,be),ht=be.attrValue,_t&&(qn==="id"||qn==="name")&&(vn(Tt,T),ht=kt+ht),nt&&pn(/((--!?|])>)|<\/(style|title|textarea)/i,ht)){vn(Tt,T);continue}if(qn==="attributename"&&Qi(ht,"href")){vn(Tt,T);continue}if(be.forceKeepAttr)continue;if(!be.keepAttr){vn(Tt,T);continue}if(!Te&&pn(/\/>/i,ht)){vn(Tt,T);continue}De&&Ws([J,le,Se],br=>{ht=rs(ht,br," ")});const yr=Ue(T.nodeName);if(!_r(yr,qn,ht)){vn(Tt,T);continue}if(q&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!It)switch(k.getAttributeType(yr,qn)){case"TrustedHTML":{ht=q.createHTML(ht);break}case"TrustedScriptURL":{ht=q.createScriptURL(ht);break}}if(ht!==Xt)try{It?T.setAttributeNS(It,Tt,ht):T.setAttribute(Tt,ht),Yr(T)?dn(T):oc(e.removed)}catch{vn(Tt,T)}}zt(ie.afterSanitizeAttributes,T,null)},xa=function Ne(T){let he=null;const be=gr(T);for(zt(ie.beforeSanitizeShadowDOM,T,null);he=be.nextNode();)zt(ie.uponSanitizeShadowNode,he,null),bn(he),Pn(he),he.content instanceof o&&Ne(he.content);zt(ie.afterSanitizeShadowDOM,T,null)};return e.sanitize=function(Ne){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},he=null,be=null,Ze=null,wt=null;if(Nn=!Ne,Nn&&(Ne="<!-->"),typeof Ne!="string"&&!Cn(Ne))if(typeof Ne.toString=="function"){if(Ne=Ne.toString(),typeof Ne!="string")throw as("dirty is not a string, aborting")}else throw as("toString is not a function");if(!e.isSupported)return Ne;if(ft||Qn(T),e.removed=[],typeof Ne=="string"&&(bt=!1),bt){if(Ne.nodeName){const sn=Ue(Ne.nodeName);if(!ae[sn]||Be[sn])throw as("root node is forbidden and cannot be sanitized in-place")}}else if(Ne instanceof f)he=mr("<!---->"),be=he.ownerDocument.importNode(Ne,!0),be.nodeType===is.element&&be.nodeName==="BODY"||be.nodeName==="HTML"?he=be:he.appendChild(be);else{if(!He&&!De&&!rt&&Ne.indexOf("<")===-1)return q&&at?q.createHTML(Ne):Ne;if(he=mr(Ne),!he)return He?null:at?Y:""}he&&Rt&&dn(he.firstChild);const Tt=gr(bt?Ne:he);for(;Ze=Tt.nextNode();)bn(Ze),Pn(Ze),Ze.content instanceof o&&xa(Ze.content);if(bt)return Ne;if(He){if(Ye)for(wt=ue.call(he.ownerDocument);he.firstChild;)wt.appendChild(he.firstChild);else wt=he;return(ee.shadowroot||ee.shadowrootmode)&&(wt=Ee.call(a,wt,!0)),wt}let It=rt?he.outerHTML:he.innerHTML;return rt&&ae["!doctype"]&&he.ownerDocument&&he.ownerDocument.doctype&&he.ownerDocument.doctype.name&&pn(tf,he.ownerDocument.doctype.name)&&(It="<!DOCTYPE "+he.ownerDocument.doctype.name+`>
`+It),De&&Ws([J,le,Se],sn=>{It=rs(It,sn," ")}),q&&at?q.createHTML(It):It},e.setConfig=function(){let Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Qn(Ne),ft=!0},e.clearConfig=function(){Bt=null,ft=!1},e.isValidAttribute=function(Ne,T,he){Bt||Qn({});const be=Ue(Ne),Ze=Ue(T);return _r(be,Ze,he)},e.addHook=function(Ne,T){typeof T=="function"&&ns(ie[Ne],T)},e.removeHook=function(Ne,T){if(T!==void 0){const he=Mm(ie[Ne],T);return he===-1?void 0:Lm(ie[Ne],he,1)[0]}return oc(ie[Ne])},e.removeHooks=function(Ne){ie[Ne]=[]},e.removeAllHooks=function(){ie=vc()},e}var $m=nf();function eg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${pc(t.from)} |`),e.push(`| **To** | ${pc(t.to)} |`),e.push(`| **Date** | ${Fo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?tg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function pc(t){return(t||"").replace(/\|/g,"\\|")}function tg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return So(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function ng(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function So(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return ng(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(So).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>So(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,f="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${f}
`}return r}function rg(t){return Eu(t,"md")}function hc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function ag(t){return t.raw||null}function sg(t){const e=ag(t);return e?JSON.stringify(e,null,2):"null"}function ig(t){return Eu(t,"json")}var og=z('<button title="View as Markdown">.md</button>'),lg=z('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),cg=z('<pre class="md-raw svelte-1b0rzpb"> </pre>'),ug=z('<div class="md-preview svelte-1b0rzpb"><!></div>'),fg=z('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),dg=z('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),vg=z('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),pg=z('<pre class="message-text svelte-1b0rzpb"> </pre>'),hg=z('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),mg=z('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),gg=z('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function _g(t,e){Ct(e,!0);let r=Oe(e,"loading",3,!1);rn(()=>Ln("MessageModal"));const a=new mt.Renderer;a.link=({href:J,title:le,text:Se})=>{const ce=le?` title="${le}"`:"";return`<a href="${J}"${ce} target="_blank" rel="noopener">${Se}</a>`},mt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Re("email"),o=At(()=>e.message.body?eg(e.message):""),u=At(()=>sg(e.message)),f=Re("raw");function h(J){M(i,g(i)===J?"email":J,!0),J==="markdown"&&M(f,"raw")}function v(){hc(g(o),rg(e.message))}function y(){hc(g(u),ig(e.message),"application/json;charset=utf-8")}function S(J){const le=mt.parse(J);return $m.sanitize(le,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let x=Re(null);ni(()=>{var J;if(g(x)&&e.message.htmlBody&&!r()&&g(i)==="email"){const le=g(x).contentDocument||((J=g(x).contentWindow)==null?void 0:J.document);le&&(le.open(),le.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),le.close())}});var k=gg();k.__click=function(...J){var le;(le=e.onclose)==null||le.apply(this,J)};var N=m(k);N.__click=J=>J.stopPropagation();var E=m(N),A=m(E),Q=m(A),de=b(A,2),U=m(de);let q;U.__click=()=>h("json");var Y=b(U,2);{var $=J=>{var le=og();let Se;le.__click=()=>h("markdown"),te(()=>Se=Mt(le,1,"action-btn svelte-1b0rzpb",null,Se,{active:g(i)==="markdown"})),D(J,le)};fe(Y,J=>{e.message.body&&J($)})}var G=b(Y,2);G.__click=function(...J){var le;(le=e.onclose)==null||le.apply(this,J)};var ue=b(E,2);{var we=J=>{var le=lg(),Se=Ve(le),ce=b(m(Se),2);ce.__click=y;var _e=b(Se,2),ke=m(_e),re=m(ke);te(()=>W(re,g(u))),D(J,le)},Ee=J=>{var le=fg(),Se=Ve(le),ce=m(Se),_e=m(ce);let ke;_e.__click=()=>M(f,"raw");var re=b(_e,2);let pe;re.__click=()=>M(f,"preview");var ve=b(ce,2);ve.__click=v;var ae=b(Se,2),V=m(ae);{var ee=oe=>{var Be=cg(),Ge=m(Be);te(()=>W(Ge,g(o))),D(oe,Be)},Z=oe=>{var Be=ug(),Ge=m(Be);Yd(Ge,()=>S(g(o))),D(oe,Be)};fe(V,oe=>{g(f)==="raw"?oe(ee):oe(Z,!1)})}te(()=>{ke=Mt(_e,1,"md-tab svelte-1b0rzpb",null,ke,{active:g(f)==="raw"}),pe=Mt(re,1,"md-tab svelte-1b0rzpb",null,pe,{active:g(f)==="preview"})}),D(J,le)},ie=J=>{var le=mg(),Se=Ve(le),ce=m(Se),_e=b(m(ce),2),ke=m(_e),re=b(ce,2),pe=b(m(re),2),ve=m(pe),ae=b(re,2),V=b(m(ae),2),ee=m(V),Z=b(Se,2),oe=m(Z);{var Be=B=>{var ye=dg();D(B,ye)},Ge=B=>{var ye=vg();mu(ye,Te=>M(x,Te),()=>g(x)),D(B,ye)},qe=B=>{var ye=pg(),Te=m(ye);te(()=>W(Te,e.message.body)),D(B,ye)},Ke=B=>{var ye=hg();D(B,ye)};fe(oe,B=>{r()?B(Be):e.message.htmlBody?B(Ge,1):e.message.body?B(qe,2):B(Ke,!1)})}te(B=>{W(ke,e.message.from),W(ve,e.message.to),W(ee,B)},[()=>Fo(e.message.date)]),D(J,le)};fe(ue,J=>{g(i)==="json"?J(we):g(i)==="markdown"?J(Ee,1):J(ie,!1)})}te(()=>{W(Q,e.message.subject),q=Mt(U,1,"action-btn svelte-1b0rzpb",null,q,{active:g(i)==="json"})}),D(t,k),Pt()}Ft(["click"]);var yg=z('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),bg=z('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),wg=z('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),kg=z("<p> </p>"),xg=z('<p>No emails in local storage. Click "Sync New" to download.</p>'),Sg=z('<div class="empty-state svelte-6ts5xm"><!></div>'),Tg=z('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),Eg=z('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Ag(t,e){Ct(e,!0),rn(()=>Ln("DashboardView"));let r=Oe(e,"error",3,null),a=Oe(e,"profile",3,null),i=Oe(e,"loadingProfile",3,!1),o=Oe(e,"emailMessages",19,()=>[]),u=Oe(e,"totalLocalMessages",3,0),f=Oe(e,"hasMoreLocal",3,!1),h=Oe(e,"loadingMessages",3,!1),v=Oe(e,"selectedMessage",3,null),y=Oe(e,"syncStatus",3,null),S=Oe(e,"syncProgress",3,null),x=Oe(e,"isSyncing",3,!1),k=Oe(e,"searchQuery",15);var N=Eg(),E=Ve(N),A=m(E);{var Q=ce=>{zu(ce,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};fe(A,ce=>{r()&&ce(Q)})}var de=b(A,2);Eh(de,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var U=b(de,2);Bh(U,{get syncStatus(){return y()},get syncProgress(){return S()},get isSyncing(){return x()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var q=b(U,2),Y=m(q);Y.__keydown=ce=>ce.key==="Enter"&&e.onsearch();var $=b(Y,2);$.__click=function(...ce){var _e;(_e=e.onsearch)==null||_e.apply(this,ce)};var G=m($),ue=b(q,2);{var we=ce=>{var _e=bg(),ke=Ve(_e),re=m(ke),pe=m(re),ve=b(ke,2);Kh(ve,{get messages(){return o()},get onselect(){return e.onviewmessage}});var ae=b(ve,2);{var V=ee=>{var Z=yg(),oe=m(Z);oe.__click=function(...Ge){var qe;(qe=e.onloadmore)==null||qe.apply(this,Ge)};var Be=m(oe);te(()=>{oe.disabled=h(),W(Be,h()?"Loading...":"Load More")}),D(ee,Z)};fe(ae,ee=>{f()&&ee(V)})}te(ee=>W(pe,`Showing ${o().length??""} of ${ee??""}
        ${k()?" matching":""} emails`),[()=>u().toLocaleString()]),D(ce,_e)},Ee=ce=>{var _e=wg();D(ce,_e)},ie=ce=>{var _e=Sg(),ke=m(_e);{var re=ve=>{var ae=kg(),V=m(ae);te(()=>W(V,`No emails match "${k()??""}".`)),D(ve,ae)},pe=ve=>{var ae=xg();D(ve,ae)};fe(ke,ve=>{k()?ve(re):ve(pe,!1)})}D(ce,_e)},J=ce=>{var _e=Tg();D(ce,_e)};fe(ue,ce=>{var _e;o().length>0?ce(we):h()?ce(Ee,1):(_e=y())!=null&&_e.synced?ce(ie,2):ce(J,!1)})}var le=b(E,2);{var Se=ce=>{_g(ce,{get message(){return v()},loading:!1,get onclose(){return e.onclosedetail}})};fe(le,ce=>{v()&&ce(Se)})}te(()=>{$.disabled=h(),W(G,h()?"Searching...":"Search")}),Bo(Y,k),D(t,N),Pt()}Ft(["keydown","click"]);var Cg=z('<div class="dashboard svelte-1q5o2lv"><!></div>');function Pg(t,e){Ct(e,!0);function r(B){B.key==="Escape"&&g(S)&&ve()}let a=null;rn(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const B=$p();if(B<=0)return;const ye=Math.max(0,B-120*1e3);a=setTimeout(async()=>{try{const Te=await Zl();M(v,Te.access_token,!0),i()}catch{M(v,null),M(y,null),M(U,"Session expired. Please sign in again.")}},ye)}async function o(){if(Jp())return g(v);try{const B=await Zl();return M(v,B.access_token,!0),i(),g(v)}catch{return M(v,null),M(y,null),M(U,"Session expired. Please sign in again."),null}}let u=Re(Jt(localStorage.getItem("googleClientId")||"")),f=Re(Jt(localStorage.getItem("googleClientId")||"")),h=Re(!1),v=Re(null),y=Re(null),S=Re(null),x=Re(""),k=Re(Jt([])),N=Re(0),E=Re(0),A=Re(!1),Q=Re(!1),de=Re(!1),U=Re(null),q=Re(null),Y=Re(null),$=Re(!1);const G=50;ni(()=>{g(v)&&(ae(),_e())});let ue=At(()=>!g(u)),we=At(()=>!!g(v)),Ee=At(()=>g(k).length<g(N));ni(()=>{g(u)&&!g(h)&&Jl(g(u)).then(()=>{if(M(h,!0),!g(v)){const B=Zp();B&&(M(v,B.access_token,!0),i(),ce())}}).catch(B=>{M(U,`Auth init failed: ${B.message}`)})});function ie(){const B=g(f).trim();B&&(localStorage.setItem("googleClientId",B),M(u,B,!0),M(U,null))}function J(){localStorage.removeItem("googleClientId"),M(u,""),M(f,""),M(h,!1),M(v,null),M(y,null),M(k,[],!0),M(N,0)}async function le(){M(U,null),M(Q,!0);try{g(h)||(await Jl(g(u)),M(h,!0));const B=await th();M(v,B.access_token,!0),i(),await ce()}catch(B){M(U,B.message,!0)}finally{M(Q,!1)}}async function Se(){if(a&&clearTimeout(a),g(v))try{await nh(g(v))}catch{}M(v,null),M(y,null),M(k,[],!0),M(N,0),M(S,null),M(U,null)}async function ce(){M(de,!0);try{const B=await wu(g(v));if(!g(v))return;M(y,B,!0)}catch(B){if(!g(v))return;M(U,`Profile fetch failed: ${B.message}`)}finally{M(de,!1)}}async function _e(B=!1){M(A,!0);try{const ye=B?g(E):0,Te=await Sv({query:g(x)||void 0,limit:G,offset:ye});B?M(k,[...g(k),...Te.items],!0):M(k,Te.items,!0),M(N,Te.total,!0),M(E,g(k).length,!0)}catch(ye){M(U,`Failed to load messages: ${ye.message}`)}finally{M(A,!1)}}function ke(){M(E,0),_e(!1)}function re(){_e(!0)}function pe(B){M(S,B,!0)}function ve(){M(S,null)}async function ae(){try{M(q,await sh(),!0)}catch{}}async function V(B){if(g($)||!g(v))return;const ye=await o();if(!ye)return;M(U,null),M($,!0),M(Y,null);const Te=new AbortController;try{await rh(ye,{limit:B,onProgress:De=>{M(Y,{...De},!0)},signal:Te.signal}),await ae(),await _e(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;M(U,`Sync failed: ${De.message}`)}}finally{M($,!1)}}async function ee(B){if(g($)||!g(v))return;const ye=await o();if(!ye)return;M(U,null),M($,!0),M(Y,null);const Te=new AbortController;try{await ah(ye,{limit:B,onProgress:De=>{M(Y,{...De},!0)},signal:Te.signal}),await ae(),await _e(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;M(U,`Sync more failed: ${De.message}`)}}finally{M($,!1)}}async function Z(){try{await Lu(),await ae(),M(k,[],!0),M(N,0),M(E,0)}catch(B){M(U,`Failed to clear data: ${B.message}`)}}var oe=Cg(),Be=m(oe);{var Ge=B=>{fh(B,{onsave:ie,get clientIdInput(){return g(f)},set clientIdInput(ye){M(f,ye,!0)}})},qe=B=>{kh(B,{get clientId(){return g(u)},get error(){return g(U)},get loadingAuth(){return g(Q)},onsignin:le,onclear:J,onsignout:Se})},Ke=B=>{Ag(B,{get error(){return g(U)},get profile(){return g(y)},get loadingProfile(){return g(de)},get emailMessages(){return g(k)},get totalLocalMessages(){return g(N)},get hasMoreLocal(){return g(Ee)},get loadingMessages(){return g(A)},get selectedMessage(){return g(S)},get syncStatus(){return g(q)},get syncProgress(){return g(Y)},get isSyncing(){return g($)},onsignout:Se,onsearch:ke,onloadmore:re,onviewmessage:pe,onclosedetail:ve,ondismisserror:()=>M(U,null),onsync:V,onsyncmore:ee,oncleardata:Z,get searchQuery(){return g(x)},set searchQuery(ye){M(x,ye,!0)}})};fe(Be,B=>{g(ue)?B(Ge):g(we)?B(Ke,!1):B(qe,1)})}D(t,oe),Pt()}var Ig=z('<span class="sep svelte-t1ig66">Â·</span> ',1),Rg=z('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),Og=z('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),Dg=z('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),jg=z('<span class="result-summary svelte-t1ig66"> </span>'),Mg=z('<span class="result-tag svelte-t1ig66"> </span>'),Lg=z('<div class="result-tags svelte-t1ig66"></div>'),Ng=z('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),qg=z('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),Bg=z('<div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">already classified</span></div>'),zg=z('<div class="summary-stat svelte-t1ig66"><span class="sstat-val err svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">errors</span></div>'),Fg=z('<span class="ssec-item svelte-t1ig66">Avg speed: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span>',1),Kg=z('<span class="ri-action svelte-t1ig66"> </span>'),Ug=z('<span class="ri-error svelte-t1ig66">ERROR</span>'),Gg=z('<span class="sep svelte-t1ig66">Â·</span> ',1),Hg=z('<div class="ri-summary svelte-t1ig66"> </div>'),Wg=z('<span class="sep svelte-t1ig66">Â·</span> ',1),Vg=z('<!> <div class="ri-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <!></div>',1),Yg=z('<details class="ri-err-details svelte-t1ig66"><summary class="ri-err-summary svelte-t1ig66">View error details</summary> <div class="ri-err-msg svelte-t1ig66"> </div></details>'),Xg=z('<div><div class="ri-head svelte-t1ig66"><span class="ri-subj svelte-t1ig66"> </span> <!></div> <div class="ri-meta svelte-t1ig66"> <!></div> <!></div>'),Qg=z('<details class="results-details svelte-t1ig66"><summary class="results-summary svelte-t1ig66"> </summary> <div class="results-list svelte-t1ig66"></div></details>'),Zg=z('<div class="summary-card svelte-t1ig66"><div class="summary-head svelte-t1ig66"><span class="summary-title svelte-t1ig66">Scan Summary</span></div> <div class="summary-grid svelte-t1ig66"><div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">emails processed</span></div> <!> <div class="summary-stat svelte-t1ig66"><span class="sstat-val success svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">classified</span></div> <!></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">LLM Performance</div> <div class="ssec-items svelte-t1ig66"><!> <span class="ssec-item svelte-t1ig66">Total tokens: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Duration: <strong class="svelte-t1ig66"> </strong></span></div></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">Model & Prompts</div> <div class="ssec-items svelte-t1ig66"><span class="ssec-item svelte-t1ig66">Model: <strong class="svelte-t1ig66"> </strong> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">System prompt: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Avg email: <strong class="svelte-t1ig66"> </strong></span></div></div> <!></div>'),Jg=z('<span class="err svelte-t1ig66"> </span>'),$g=z('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),e_=z('<button class="action-btn svelte-t1ig66">View Prompt Config</button>'),t_=z('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),n_=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),r_=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),a_=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),s_=z('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),i_=z('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function o_(t,e){Ct(e,!0);let r=Oe(e,"progress",3,null),a=Re(!1),i=Re("system");function o(E){return!E||E<0?"â":E<1e3?`${Math.round(E)}ms`:`${(E/1e3).toFixed(1)}s`}function u(E){return E?E>=1e3?`${(E/1e3).toFixed(1)}k`:String(E):"0"}function f(E){if(!E)return"â";const A=E.replace(/<.*>/,"").trim();return A.length>30?A.slice(0,28)+"â¦":A}function h(E){if(!E)return"";try{return new Date(E).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(E){var de;if(!((de=E==null?void 0:E.totals)!=null&&de.elapsed)||!(E!=null&&E.current)||E.current<2)return null;const A=E.totals.elapsed/E.current;return(E.total-E.current)*A}let y=At(()=>{var E;return(E=r())!=null&&E.total?Math.round(r().current/r().total*100):0}),S=At(()=>v(r()));var x=Ir(),k=Ve(x);{var N=E=>{var A=i_(),Q=Ve(A),de=m(Q),U=m(de),q=m(U);{var Y=qe=>{var Ke=ri("Scan complete");D(qe,Ke)},$=qe=>{var Ke=ri();te(()=>W(Ke,`Processing ${r().current??""} of ${r().total??""}`)),D(qe,Ke)};fe(q,qe=>{r().phase==="done"?qe(Y):qe($,!1)})}var G=b(U,2),ue=m(G),we=b(de,2),Ee=m(we);let ie,J;var le=b(we,2);{var Se=qe=>{var Ke=Rg(),B=m(Ke),ye=m(B),Te=b(B,2),De=m(Te),nt=b(De);{var rt=ft=>{var Rt=Ig(),He=b(Ve(Rt),1,!0);te(Ye=>W(He,Ye),[()=>h(r().email.date)]),D(ft,Rt)};fe(nt,ft=>{r().email.date&&ft(rt)})}te(ft=>{W(ye,r().email.subject||"(no subject)"),W(De,`${ft??""} `)},[()=>f(r().email.from)]),D(qe,Ke)};fe(le,qe=>{r().email&&r().phase!=="done"&&qe(Se)})}var ce=b(le,2);{var _e=qe=>{var Ke=Dg(),B=m(Ke),ye=m(B),Te=m(ye),De=b(B,2),nt=m(De),rt=m(nt),ft=b(De,2);{var Rt=He=>{var Ye=Og(),at=m(Ye),st=m(at);te(_t=>W(st,`~${_t??""}`),[()=>o(g(S))]),D(He,Ye)};fe(ft,He=>{g(S)&&He(Rt)})}te(He=>{W(Te,He),W(rt,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),D(qe,Ke)};fe(ce,qe=>{r().live&&r().phase==="generating"&&qe(_e)})}var ke=b(ce,2);{var re=qe=>{var Ke=qg(),B=m(Ke),ye=m(B),Te=b(B,2);{var De=He=>{var Ye=jg(),at=m(Ye);te(()=>W(at,r().result.summary)),D(He,Ye)};fe(Te,He=>{r().result.summary&&He(De)})}var nt=b(Te,2);{var rt=He=>{var Ye=Lg();nn(Ye,21,()=>r().result.tags,Vn,(at,st)=>{var _t=Mg(),kt=m(_t);te(()=>W(kt,g(st))),D(at,_t)}),D(He,Ye)};fe(nt,He=>{var Ye;(Ye=r().result.tags)!=null&&Ye.length&&He(rt)})}var ft=b(nt,2);{var Rt=He=>{var Ye=Ng(),at=m(Ye),st=b(at,2),_t=b(st,2);te((kt,qt)=>{W(at,`${kt??""} `),W(st,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),W(_t,` ${qt??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),D(He,Ye)};fe(ft,He=>{r().emailStats&&He(Rt)})}te(()=>W(ye,r().result.action)),D(qe,Ke)};fe(ke,qe=>{r().result&&qe(re)})}var pe=b(ke,2);{var ve=qe=>{var Ke=Zg(),B=b(m(Ke),2),ye=m(B),Te=m(ye),De=m(Te),nt=b(ye,2);{var rt=it=>{var Ue=Bg(),Bt=m(Ue),Gt=m(Bt);te(()=>W(Gt,r().summary.skipped)),D(it,Ue)};fe(nt,it=>{var Ue;(Ue=r().summary)!=null&&Ue.skipped&&it(rt)})}var ft=b(nt,2),Rt=m(ft),He=m(Rt),Ye=b(ft,2);{var at=it=>{var Ue=zg(),Bt=m(Ue),Gt=m(Bt);te(()=>W(Gt,r().errors)),D(it,Ue)};fe(Ye,it=>{r().errors>0&&it(at)})}var st=b(B,2),_t=b(m(st),2),kt=m(_t);{var qt=it=>{var Ue=Fg(),Bt=Ve(Ue),Gt=b(m(Bt)),fn=m(Gt);te(()=>W(fn,`${r().summary.avgTps??""} tok/s`)),D(it,Ue)};fe(kt,it=>{var Ue;(Ue=r().summary)!=null&&Ue.avgTps&&it(qt)})}var bt=b(kt,2),pt=b(m(bt)),yt=m(pt),un=b(bt,4),an=b(m(un)),_n=m(an),Yt=b(st,2),Kt=b(m(Yt),2),Ut=m(Kt),yn=b(m(Ut)),Ot=m(yn),je=b(yn),Nn=b(Ut,4),An=b(m(Nn)),Dr=m(An),Pe=b(Nn,4),ir=b(m(Pe)),ba=m(ir),Xn=b(Yt,2);{var wa=it=>{var Ue=Qg(),Bt=m(Ue),Gt=m(Bt),fn=b(Bt,2);nn(fn,21,()=>r().results,Vn,(Qn,xt)=>{var lt=Xg();let St;var dn=m(lt),vn=m(dn),mr=m(vn),gr=b(vn,2);{var Yr=T=>{var he=Kg(),be=m(he);te(()=>W(be,g(xt).classification.action)),D(T,he)},Cn=T=>{var he=Ug();D(T,he)};fe(gr,T=>{g(xt).success?T(Yr):T(Cn,!1)})}var zt=b(dn,2),bn=m(zt),_r=b(bn);{var ka=T=>{var he=Gg(),be=b(Ve(he),1,!0);te(Ze=>W(be,Ze),[()=>h(g(xt).email.date)]),D(T,he)};fe(_r,T=>{g(xt).email.date&&T(ka)})}var Pn=b(zt,2);{var xa=T=>{var he=Vg(),be=Ve(he);{var Ze=Xt=>{var ht=Hg(),yr=m(ht);te(()=>W(yr,g(xt).classification.summary)),D(Xt,ht)};fe(be,Xt=>{g(xt).classification.summary&&Xt(Ze)})}var wt=b(be,2),Tt=m(wt),It=b(Tt,2),sn=b(It);{var qn=Xt=>{var ht=Wg(),yr=b(Ve(ht));te(br=>W(yr,` ${br??""} tok/s`),[()=>g(xt).stats.tps.toFixed(0)]),D(Xt,ht)};fe(sn,Xt=>{g(xt).stats.tps&&Xt(qn)})}te(Xt=>{W(Tt,`${g(xt).stats.inputTokens??""} in + ${g(xt).stats.numTokens??""} out tokens `),W(It,` ${Xt??""} `)},[()=>o(g(xt).stats.elapsed)]),D(T,he)},Ne=T=>{var he=Yg(),be=b(m(he),2),Ze=m(be);te(()=>W(Ze,g(xt).error)),D(T,he)};fe(Pn,T=>{g(xt).success?T(xa):T(Ne,!1)})}te(T=>{St=Mt(lt,1,"result-item svelte-t1ig66",null,St,{failed:!g(xt).success}),W(mr,g(xt).email.subject||"(no subject)"),W(bn,`${T??""} `)},[()=>f(g(xt).email.from)]),D(Qn,lt)}),te(()=>W(Gt,`View ${r().results.length??""} email results`)),D(it,Ue)};fe(Xn,it=>{var Ue;((Ue=r().results)==null?void 0:Ue.length)>0&&it(wa)})}te((it,Ue,Bt,Gt,fn,Qn,xt)=>{var lt,St;W(De,((lt=r().summary)==null?void 0:lt.processed)||r().total||0),W(He,r().classified||0),W(yt,`${it??""} in + ${Ue??""} out`),W(_n,Bt),W(Ot,((St=r().summary)==null?void 0:St.modelName)||"Unknown"),W(je,` (${Gt??""}k context, ~${fn??""}k email limit)`),W(Dr,`${Qn??""} chars`),W(ba,`${xt??""} chars`)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed),()=>{var it;return Math.round((((it=r().summary)==null?void 0:it.modelContextWindow)||0)/1024)},()=>{var it;return Math.round((((it=r().summary)==null?void 0:it.modelMaxEmailTokens)||0)/1e3)},()=>{var it;return u(((it=r().summary)==null?void 0:it.systemPromptSize)||0)},()=>{var it;return u(((it=r().summary)==null?void 0:it.avgPromptSize)||0)}]),D(qe,Ke)},ae=qe=>{var Ke=Ir(),B=Ve(Ke);{var ye=Te=>{var De=$g(),nt=m(De),rt=m(nt),ft=b(nt,2);{var Rt=_t=>{var kt=Jg(),qt=m(kt);te(()=>W(qt,`${r().errors??""} errors`)),D(_t,kt)};fe(ft,_t=>{r().errors&&_t(Rt)})}var He=b(ft,4),Ye=m(He),at=b(He,4),st=m(at);te((_t,kt,qt)=>{W(rt,`${(r().classified||0)??""} classified`),W(Ye,`${_t??""} in + ${kt??""} out tokens`),W(st,qt)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),D(Te,De)};fe(B,Te=>{r().totals&&Te(ye)})}D(qe,Ke)};fe(pe,qe=>{r().phase==="done"?qe(ve):qe(ae,!1)})}var V=b(pe,2),ee=m(V);{var Z=qe=>{var Ke=e_();Ke.__click=()=>M(a,!0),D(qe,Ke)},oe=qe=>{var Ke=t_(),B=Ve(Ke);B.__click=()=>M(a,!0);var ye=b(B,2);ye.__click=function(...Te){var De;(De=e.onstop)==null||De.apply(this,Te)},D(qe,Ke)};fe(ee,qe=>{r().phase==="done"?qe(Z):qe(oe,!1)})}var Be=b(Q,2);{var Ge=qe=>{var Ke=s_();Ke.__click=()=>M(a,!1),Ke.__keydown=bt=>bt.key==="Escape"&&M(a,!1);var B=m(Ke);B.__click=bt=>bt.stopPropagation();var ye=m(B),Te=b(m(ye),2);Te.__click=()=>M(a,!1);var De=b(ye,2),nt=m(De);let rt;nt.__click=()=>M(i,"system");var ft=b(nt,2);let Rt;ft.__click=()=>M(i,"email");var He=b(ft,2);let Ye;He.__click=()=>M(i,"full");var at=b(De,2),st=m(at);{var _t=bt=>{var pt=n_(),yt=Ve(pt),un=m(yt),an=b(yt,2),_n=m(an);te(()=>{W(un,ra),W(_n,`${ra.length??""} chars`)}),D(bt,pt)},kt=bt=>{var pt=r_(),yt=Ve(pt),un=m(yt),an=b(yt,2),_n=m(an);te(()=>{var Yt,Kt,Ut;W(un,((Yt=r().prompt)==null?void 0:Yt.user)||"(no email prompt)"),W(_n,`${(((Ut=(Kt=r().prompt)==null?void 0:Kt.user)==null?void 0:Ut.length)||0)??""} chars`)}),D(bt,pt)},qt=bt=>{var pt=a_(),yt=Ve(pt),un=m(yt),an=b(yt,2),_n=m(an);te(()=>{var Yt,Kt,Ut,yn,Ot,je;W(un,`${(((Yt=r().prompt)==null?void 0:Yt.system)||"")??""}

---

${(((Kt=r().prompt)==null?void 0:Kt.user)||"")??""}`),W(_n,`${(((yn=(Ut=r().prompt)==null?void 0:Ut.system)==null?void 0:yn.length)||0)+(((je=(Ot=r().prompt)==null?void 0:Ot.user)==null?void 0:je.length)||0)} chars total`)}),D(bt,pt)};fe(st,bt=>{g(i)==="system"?bt(_t):g(i)==="email"?bt(kt,1):bt(qt,!1)})}te(()=>{rt=Mt(nt,1,"mtab svelte-t1ig66",null,rt,{active:g(i)==="system"}),Rt=Mt(ft,1,"mtab svelte-t1ig66",null,Rt,{active:g(i)==="email"}),Ye=Mt(He,1,"mtab svelte-t1ig66",null,Ye,{active:g(i)==="full"})}),D(qe,Ke)};fe(Be,qe=>{g(a)&&qe(Ge)})}te(()=>{W(ue,`${g(y)??""}%`),ie=Mt(Ee,1,"bar-fill svelte-t1ig66",null,ie,{done:r().phase==="done"}),J=En(Ee,"",J,{width:`${g(y)??""}%`})}),D(E,A)};fe(k,E=>{r()&&E(N)})}D(t,x),Pt()}Ft(["click","keydown"]);var l_=z('<span class="spinner svelte-ois7em"></span>'),c_=No('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),u_=z('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),f_=z("<option> </option>"),d_=z('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),v_=z('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function p_(t,e){Ct(e,!0);let r=Oe(e,"engineStatus",3,"idle"),a=Oe(e,"modelName",3,""),i=Oe(e,"isScanning",3,!1),o=Oe(e,"scanProgress",3,null),u=Oe(e,"scanCount",15,20),f=Oe(e,"stats",3,null);const h=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function v(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function S(){return r()==="ready"&&!i()}var x=v_(),k=m(x),N=m(k),E=m(N);{var A=V=>{var ee=l_();D(V,ee)},Q=V=>{var ee=c_();D(V,ee)};fe(E,V=>{i()?V(A):V(Q,!1)})}var de=b(N,2),U=m(de),q=b(m(U),2);q.__click=function(...V){var ee;(ee=e.oninspect)==null||ee.apply(this,V)};var Y=b(U,2),$=m(Y);let G;var ue=b($),we=b(k,2);{var Ee=V=>{var ee=u_(),Z=m(ee),oe=m(Z),Be=b(Z,4),Ge=m(Be),qe=b(Be,4),Ke=m(qe);te(()=>{W(oe,`${f().totalEmails??""} emails in storage`),W(Ge,`${f().classified??""} classified`),W(Ke,`${f().unclassified??""} new`)}),D(V,ee)};fe(we,V=>{f()&&V(Ee)})}var ie=b(we,2),J=m(ie),le=b(m(J),2);nn(le,21,()=>h,Vn,(V,ee)=>{var Z=f_(),oe=m(Z),Be={};te(()=>{W(oe,g(ee).label),Be!==(Be=g(ee).value)&&(Z.value=(Z.__value=g(ee).value)??"")}),D(V,Z)});var Se=b(J,2),ce=m(Se);ce.__click=function(...V){var ee;(ee=e.onscan)==null||ee.apply(this,V)};var _e=m(ce),ke=b(ce,2);ke.__click=function(...V){var ee;(ee=e.onrescan)==null||ee.apply(this,V)};var re=b(ie,2);{var pe=V=>{var ee=d_();D(V,ee)};fe(re,V=>{r()!=="ready"&&r()!=="loading"&&V(pe)})}var ve=b(re,2);{var ae=V=>{o_(V,{get progress(){return o()},get onstop(){return e.onstop}})};fe(ve,V=>{var ee;(i()||((ee=o())==null?void 0:ee.phase)==="done")&&V(ae)})}te((V,ee,Z,oe)=>{G=En($,"",G,V),W(ue,` ${ee??""}`),le.disabled=i(),ce.disabled=Z,W(_e,i()?"Scanning...":"Scan New"),ke.disabled=oe},[()=>({background:y()}),v,()=>!S(),()=>!S()]),qo(le,u),D(t,x),Pt()}Ft(["click"]);var h_=z('<span class="row-date svelte-1czytqk"> </span>'),m_=z('<span class="tag svelte-1czytqk"> </span>'),g_=z('<span class="row-tags svelte-1czytqk"></span>'),__=z('<span class="row-reason svelte-1czytqk"> </span>'),y_=z('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),b_=z('<span class="status-label svelte-1czytqk"> </span>'),w_=z('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),k_=z('<p class="summary-reason svelte-1czytqk"> </p>'),x_=z('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),S_=z('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function mc(t,e){Ct(e,!0);let r=Oe(e,"actionColor",3,"#666"),a=Oe(e,"dimmed",3,!1);function i(ce){if(!ce)return"";try{return new Date(ce).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=At(()=>e.item.status==="pending"),u=Re(!1);var f=S_(),h=Ve(f);let v;var y=m(h);y.__click=()=>M(u,!g(u));let S;var x=m(y),k=m(x),N=b(x,2),E=m(N),A=m(E),Q=b(E,2);{var de=ce=>{var _e=h_(),ke=m(_e);te(re=>W(ke,re),[()=>i(e.item.date)]),D(ce,_e)};fe(Q,ce=>{e.item.date&&ce(de)})}var U=b(N,2);{var q=ce=>{var _e=g_();nn(_e,21,()=>e.item.tags,Vn,(ke,re)=>{var pe=m_();let ve;var ae=m(pe);te(V=>{ve=En(pe,"",ve,V),W(ae,g(re))},[()=>({background:Lv(g(re))})]),D(ke,pe)}),D(ce,_e)};fe(U,ce=>{e.item.tags&&e.item.tags.length>0&&ce(q)})}var Y=b(U,2);{var $=ce=>{var _e=__(),ke=m(_e);te(()=>W(ke,e.item.reason)),D(ce,_e)};fe(Y,ce=>{e.item.reason&&!g(u)&&ce($)})}var G=b(y,2),ue=m(G);{var we=ce=>{var _e=y_(),ke=Ve(_e);ke.__click=()=>e.onmarkacted(e.item.emailId);var re=b(ke,2);re.__click=()=>e.ondismiss(e.item.emailId),D(ce,_e)},Ee=ce=>{var _e=b_(),ke=m(_e);te(()=>W(ke,e.item.status)),D(ce,_e)};fe(ue,ce=>{g(o)?ce(we):ce(Ee,!1)})}var ie=b(ue,2);{var J=ce=>{var _e=w_();_e.__click=()=>e.onremove(e.item.emailId),D(ce,_e)};fe(ie,ce=>{e.onremove&&ce(J)})}var le=b(h,2);{var Se=ce=>{var _e=x_();let ke;var re=m(_e),pe=m(re),ve=b(re,2);{var ae=V=>{var ee=k_(),Z=m(ee);te(()=>W(Z,e.item.reason)),D(V,ee)};fe(ve,V=>{e.item.reason&&V(ae)})}te(()=>{ke=En(_e,"",ke,{"border-left-color":r()}),W(pe,e.item.summary)}),D(ce,_e)};fe(le,ce=>{g(u)&&e.item.summary&&ce(Se)})}te(()=>{v=Mt(h,1,"email-row svelte-1czytqk",null,v,{dimmed:a()}),S=En(y,"",S,{"border-left-color":r()}),W(k,e.item.subject),W(A,e.item.from)}),D(t,f),Pt()}Ft(["click"]);var T_=z('<span class="group-acted svelte-tl1unp"> </span>'),E_=z('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),A_=z('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),C_=z('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),P_=z('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),I_=z('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),R_=z('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function O_(t,e){Ct(e,!0);let r=Oe(e,"color",3,"#888");Oe(e,"count",3,0);let a=Oe(e,"items",19,()=>[]),i=Oe(e,"expanded",3,!1),o=At(()=>a().filter($=>$.status==="pending")),u=At(()=>a().filter($=>$.status!=="pending")),f=Re(!1);function h($){return $.split("_").map(G=>G.charAt(0)+G.slice(1).toLowerCase()).join(" ")}var v=R_(),y=m(v);y.__click=function(...$){var G;(G=e.ontoggle)==null||G.apply(this,$)};var S=m(y);let x;var k=m(S),N=b(S,2),E=m(N),A=b(N,2);{var Q=$=>{var G=T_(),ue=m(G);te(()=>W(ue,`${g(u).length??""} handled`)),D($,G)};fe(A,$=>{g(u).length>0&&$(Q)})}var de=b(A,4);let U;var q=b(y,2);{var Y=$=>{var G=I_(),ue=m(G);{var we=ke=>{var re=E_();D(ke,re)};fe(ue,ke=>{g(o).length===0&&g(u).length===0&&ke(we)})}var Ee=b(ue,2);nn(Ee,17,()=>g(o),ke=>ke.emailId,(ke,re)=>{mc(ke,{get item(){return g(re)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ie=b(Ee,2);{var J=ke=>{var re=A_(),pe=m(re),ve=m(pe),ae=b(pe,2);nn(ae,17,()=>g(u),V=>V.emailId,(V,ee)=>{mc(V,{get item(){return g(ee)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),te(()=>W(ve,`${g(u).length??""} handled`)),D(ke,re)};fe(ie,ke=>{g(u).length>0&&ke(J)})}var le=b(ie,2),Se=m(le);{var ce=ke=>{var re=C_();re.__click=()=>M(f,!0),D(ke,re)},_e=ke=>{var re=P_(),pe=m(re),ve=b(pe);ve.__click=()=>M(f,!1);var ae=b(ve,2);ae.__click=()=>{e.oncleargroup(),M(f,!1)},te(()=>W(pe,`Clear ${a().length??""} items? `)),D(ke,re)};fe(Se,ke=>{g(f)?ke(_e,!1):ke(ce)})}D($,G)};fe(q,$=>{i()&&$(Y)})}te($=>{x=En(S,"",x,{background:r()}),W(k,$),W(E,g(o).length),U=Mt(de,0,"chevron svelte-tl1unp",null,U,{open:i()})},[()=>h(e.action)]),D(t,v),Pt()}Ft(["click"]);var D_=z(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),j_=z(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),M_=z(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),L_=z('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function N_(t,e){Ct(e,!0);let r=Oe(e,"open",15,!1),a=Oe(e,"sampleEmail",3,null),i=Re("system");function o(){return a()?Ou(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function f(S){S.target===S.currentTarget&&u()}var h=Ir(),v=Ve(h);{var y=S=>{var x=L_();x.__click=f,x.__keydown=J=>J.key==="Escape"&&u();var k=m(x),N=m(k),E=b(m(N),2);E.__click=u;var A=b(N,2),Q=m(A);let de;Q.__click=()=>M(i,"system");var U=b(Q,2);let q;U.__click=()=>M(i,"email");var Y=b(U,2);let $;Y.__click=()=>M(i,"config");var G=b(A,2),ue=m(G);{var we=J=>{var le=D_(),Se=b(Ve(le),2),ce=m(Se);te(()=>W(ce,ra)),D(J,le)},Ee=J=>{var le=j_(),Se=b(Ve(le),2),ce=b(m(Se),2);ce.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var _e=b(Se,2),ke=b(m(_e),2),re=m(ke);te(pe=>W(re,pe),[o]),D(J,le)},ie=J=>{var le=M_(),Se=b(Ve(le),2),ce=m(Se),_e=b(m(ce),2),ke=m(_e),re=b(ce,2),pe=b(m(re),2),ve=m(pe),ae=b(re,2),V=b(m(ae),2),ee=m(V),Z=b(Se,4);Z.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,te(()=>{W(ke,Rv.maxTokens),W(ve,"false"),W(ee,"false")}),D(J,le)};fe(ue,J=>{g(i)==="system"?J(we):g(i)==="email"?J(Ee,1):g(i)==="config"&&J(ie,2)})}te(()=>{de=Mt(Q,1,"tab svelte-10pcy9j",null,de,{active:g(i)==="system"}),q=Mt(U,1,"tab svelte-10pcy9j",null,q,{active:g(i)==="email"}),$=Mt(Y,1,"tab svelte-10pcy9j",null,$,{active:g(i)==="config"})}),D(S,x)};fe(v,S=>{r()&&S(y)})}D(t,h),Pt()}Ft(["click","keydown"]);var q_=z('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),B_=z('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),z_=z('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),F_=z('<button class="chip svelte-s2dwjj"> </button>'),K_=z('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),U_=z('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),G_=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),H_=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),W_=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),V_=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Y_=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),X_=z('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),Q_=z('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),Z_=z('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),J_=z('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),$_=z('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function ey(t,e){Ct(e,!0);let r=Oe(e,"groupOrder",19,()=>[]),a=Re(!1),i=Re(null),o=Re(!1),u=Re(null);async function f(){var ie;const[G,ue,we]=await Promise.all([ze.items.where("sourceType").equals("gmail").count(),ze.emailClassifications.count(),ze.contacts.count()]);let Ee=0;try{const J=await((ie=navigator.storage)==null?void 0:ie.estimate());Ee=(J==null?void 0:J.usage)??0}catch{}M(u,{emailCount:G,classCount:ue,contactCount:we,totalBytes:Ee},!0)}function h(G){return G?G<1024?`${G} B`:G<1024*1024?`${(G/1024).toFixed(1)} KB`:`${(G/(1024*1024)).toFixed(1)} MB`:"â"}function v(){M(a,!g(a)),g(a)&&f()}async function y(G){var ue;M(o,!0),M(i,null);try{await G(),await f(),(ue=e.onrefresh)==null||ue.call(e)}finally{M(o,!1)}}async function S(){await y(()=>Yl())}async function x(G){await y(()=>Ko(G))}async function k(){await y(async()=>{await Lu(),await Yl()})}async function N(){await y(()=>ze.contacts.clear())}async function E(){await y(async()=>{await ze.delete(),window.location.reload()})}function A(G){return G.split("_").map(ue=>ue.charAt(0)+ue.slice(1).toLowerCase()).join(" ")}var Q=$_(),de=m(Q);de.__click=v;var U=b(m(de),2);let q;var Y=b(de,2);{var $=G=>{var ue=J_(),we=m(ue);{var Ee=B=>{var ye=B_(),Te=m(ye),De=m(Te),nt=b(Te,4),rt=m(nt),ft=b(nt,4),Rt=m(ft),He=b(ft,2);{var Ye=at=>{var st=q_(),_t=b(Ve(st),2),kt=m(_t);te(qt=>W(kt,`${qt??""} used`),[()=>h(g(u).totalBytes)]),D(at,st)};fe(He,at=>{g(u).totalBytes&&at(Ye)})}te(()=>{W(De,`${g(u).emailCount??""} emails`),W(rt,`${g(u).classCount??""} classifications`),W(Rt,`${g(u).contactCount??""} contacts`)}),D(B,ye)};fe(we,B=>{g(u)&&B(Ee)})}var ie=b(we,2);{var J=B=>{var ye=K_(),Te=b(m(ye),2);nn(Te,21,r,Vn,(De,nt)=>{var rt=Ir(),ft=Ve(rt);{var Rt=Ye=>{var at=z_(),st=m(at),_t=b(st);_t.__click=()=>M(i,null);var kt=b(_t,2);kt.__click=()=>x(g(nt)),te(qt=>{W(st,`Delete ${qt??""}? `),kt.disabled=g(o)},[()=>A(g(nt))]),D(Ye,at)},He=Ye=>{var at=F_();at.__click=()=>M(i,`group:${g(nt)}`);var st=m(at);te(_t=>{at.disabled=g(o),W(st,`${_t??""} â`)},[()=>A(g(nt))]),D(Ye,at)};fe(ft,Ye=>{g(i)===`group:${g(nt)}`?Ye(Rt):Ye(He,!1)})}D(De,rt)}),D(B,ye)};fe(ie,B=>{r().length>0&&B(J)})}var le=b(ie,2),Se=b(m(le),2),ce=m(Se);{var _e=B=>{var ye=U_(),Te=b(m(ye),2);Te.__click=()=>M(i,null);var De=b(Te,2);De.__click=S,te(()=>De.disabled=g(o)),D(B,ye)},ke=B=>{var ye=G_();ye.__click=()=>M(i,"classifications"),te(()=>ye.disabled=g(o)),D(B,ye)};fe(ce,B=>{g(i)==="classifications"?B(_e):B(ke,!1)})}var re=b(ce,2);{var pe=B=>{var ye=H_(),Te=b(m(ye),2);Te.__click=()=>M(i,null);var De=b(Te,2);De.__click=k,te(()=>De.disabled=g(o)),D(B,ye)},ve=B=>{var ye=W_();ye.__click=()=>M(i,"emails"),te(()=>ye.disabled=g(o)),D(B,ye)};fe(re,B=>{g(i)==="emails"?B(pe):B(ve,!1)})}var ae=b(re,2);{var V=B=>{var ye=V_(),Te=b(m(ye),2);Te.__click=()=>M(i,null);var De=b(Te,2);De.__click=N,te(()=>De.disabled=g(o)),D(B,ye)},ee=B=>{var ye=Y_();ye.__click=()=>M(i,"contacts"),te(()=>ye.disabled=g(o)),D(B,ye)};fe(ae,B=>{g(i)==="contacts"?B(V):B(ee,!1)})}var Z=b(le,2),oe=m(Z);{var Be=B=>{var ye=X_(),Te=b(m(ye),2);Te.__click=()=>M(i,null);var De=b(Te,2);De.__click=E,te(()=>De.disabled=g(o)),D(B,ye)},Ge=B=>{var ye=Q_();ye.__click=()=>M(i,"nuke"),te(()=>ye.disabled=g(o)),D(B,ye)};fe(oe,B=>{g(i)==="nuke"?B(Be):B(Ge,!1)})}var qe=b(Z,2);{var Ke=B=>{var ye=Z_();D(B,ye)};fe(qe,B=>{g(o)&&B(Ke)})}D(G,ue)};fe(Y,G=>{g(a)&&G($)})}te(()=>q=Mt(U,0,"chev svelte-s2dwjj",null,q,{open:g(a)})),D(t,Q),Pt()}Ft(["click"]);var ty=z('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),ny=z('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),ry=z('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),ay=z('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function sy(t,e){Ct(e,!0);let r=Oe(e,"groups",19,()=>({})),a=Oe(e,"groupOrder",19,()=>[]),i=Oe(e,"counts",19,()=>({})),o=Oe(e,"stats",3,null),u=Oe(e,"expandedGroup",3,null),f=Oe(e,"isScanning",3,!1),h=Oe(e,"scanProgress",3,null),v=Oe(e,"scanCount",15,20),y=Oe(e,"error",3,null),S=Re(!1),x=At(()=>{for(const $ of a()){const G=r()[$];if((G==null?void 0:G.length)>0)return G[0]}return null});var k=ay(),N=m(k);p_(N,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return f()},get scanProgress(){return h()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>M(S,!0),get scanCount(){return v()},set scanCount($){v($)}});var E=b(N,2);N_(E,{get sampleEmail(){return g(x)},get open(){return g(S)},set open($){M(S,$,!0)}});var A=b(E,2);{var Q=$=>{var G=ty(),ue=m(G),we=m(ue),Ee=b(ue,2);Ee.__click=function(...ie){var J;(J=e.ondismisserror)==null||J.apply(this,ie)},te(()=>W(we,y())),D($,G)};fe(A,$=>{y()&&$(Q)})}var de=b(A,2);{var U=$=>{var G=ny(),ue=Ve(G);nn(ue,20,a,J=>J,(J,le)=>{{let Se=At(()=>mo(le)),ce=At(()=>{var re;return((re=r()[le])==null?void 0:re.length)||0}),_e=At(()=>r()[le]||[]),ke=At(()=>u()===le);O_(J,{get action(){return le},get color(){return g(Se)},get count(){return g(ce)},get items(){return g(_e)},get expanded(){return g(ke)},ontoggle:()=>e.ontogglegroup(le),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(le)})}});var we=b(ue,2),Ee=m(we),ie=m(Ee);te(()=>W(ie,`${i().total??""} emails classified into ${a().length??""} groups`)),D($,G)},q=$=>{var G=ry();D($,G)};fe(de,$=>{i().total>0?$(U):f()||$(q,1)})}var Y=b(de,2);ey(Y,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),D(t,k),Pt()}Ft(["click"]);var iy=z('<div class="actions-page svelte-3tch4q"><!></div>');function oy(t,e){Ct(e,!0);const r=_u();let a=Re(Jt(r.status)),i=Re(""),o=Re(Jt({})),u=Re(Jt([])),f=Re(Jt({total:0})),h=Re(null),v=Re(null),y=Re(!1),S=Re(null),x=Re(20),k=Re(null),N=Re(null);rn(()=>{const ie=r.onMessage(J=>{if(J.status==="ready"){M(a,"ready");const le=Hr.find(Se=>Se.id===r.modelId);M(i,(le==null?void 0:le.name)||r.modelId||"",!0)}J.status==="loading"&&M(a,"loading")});if(M(a,r.status,!0),r.modelId){const J=Hr.find(le=>le.id===r.modelId);M(i,(J==null?void 0:J.name)||r.modelId||"",!0)}return E(),()=>ie()});async function E(){try{const ie=await Ov();M(o,ie.groups,!0),M(u,ie.order,!0),M(f,await Dv(),!0),M(h,await ho(),!0)}catch(ie){M(k,`Failed to load data: ${ie.message}`)}}async function A(){await de(!1)}async function Q(){await de(!0)}async function de(ie){if(g(y)||!r.isReady)return;M(k,null),M(y,!0),M(S,null);const J=new AbortController;M(N,J,!0);try{await Iu(r,{count:g(x),force:ie,signal:J.signal,onProgress:le=>{M(S,{...le},!0)}}),await E()}catch(le){J.signal.aborted||M(k,`Scan failed: ${le.message}`)}finally{M(y,!1),M(N,null)}}function U(){var ie;(ie=g(N))==null||ie.abort()}async function q(ie){await si(ie,"acted"),await E()}async function Y(ie){await si(ie,"dismissed"),await E()}async function $(ie){await Ru(ie),await E()}async function G(ie){await Ko(ie),await E()}function ue(ie){M(v,g(v)===ie?null:ie,!0)}var we=iy(),Ee=m(we);sy(Ee,{get engineStatus(){return g(a)},get modelName(){return g(i)},get groups(){return g(o)},get groupOrder(){return g(u)},get counts(){return g(f)},get stats(){return g(h)},get expandedGroup(){return g(v)},get isScanning(){return g(y)},get scanProgress(){return g(S)},get error(){return g(k)},onscan:A,onrescan:Q,ontogglegroup:ue,onmarkacted:q,ondismiss:Y,onremove:$,oncleargroup:G,ondismisserror:()=>M(k,null),onstop:U,onrefresh:E,get scanCount(){return g(x)},set scanCount(ie){M(x,ie,!0)}}),D(t,we),Pt()}var ly=z('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function cy(t,e){Ct(e,!0);function r(){const G=location.hash;return G==="#dashboard"?"dashboard":G==="#actions"?"actions":"chat"}let a=Re(Jt(r()));rn(()=>{function G(){M(a,r(),!0)}return window.addEventListener("hashchange",G),()=>window.removeEventListener("hashchange",G)});var i=ly(),o=m(i),u=b(m(o),2),f=m(u);let h;var v=b(f,2);let y;var S=b(v,2);let x;var k=b(o,2),N=m(k);let E;var A=m(N);Xp(A,{});var Q=b(N,2);let de;var U=m(Q);oy(U,{});var q=b(Q,2);let Y;var $=m(q);Pg($,{}),te(()=>{h=Mt(f,1,"svelte-1n46o8q",null,h,{active:g(a)==="chat"}),y=Mt(v,1,"svelte-1n46o8q",null,y,{active:g(a)==="actions"}),x=Mt(S,1,"svelte-1n46o8q",null,x,{active:g(a)==="dashboard"}),E=En(N,"",E,{display:g(a)==="chat"?"flex":"none"}),de=En(Q,"",de,{display:g(a)==="actions"?"flex":"none"}),Y=En(q,"",Y,{display:g(a)==="dashboard"?"flex":"none"})}),D(t,i),Pt()}Fd(cy,{target:document.getElementById("app")});
