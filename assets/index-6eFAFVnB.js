var cf=Object.defineProperty;var _l=t=>{throw TypeError(t)};var ff=(t,e,r)=>e in t?cf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ke=(t,e,r)=>ff(t,typeof e!="symbol"?e+"":e,r),Ni=(t,e,r)=>e.has(t)||_l("Cannot "+r);var H=(t,e,r)=>(Ni(t,e,"read from private field"),r?r.call(t):e.get(t)),Ue=(t,e,r)=>e.has(t)?_l("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ze=(t,e,r,s)=>(Ni(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),Dt=(t,e,r)=>(Ni(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Xi=!1;var bo=Array.isArray,df=Array.prototype.indexOf,xa=Array.prototype.includes,si=Array.from,pf=Object.defineProperty,va=Object.getOwnPropertyDescriptor,hf=Object.getOwnPropertyDescriptors,vf=Object.prototype,gf=Array.prototype,fu=Object.getPrototypeOf,wl=Object.isExtensible;const mf=()=>{};function yf(t){for(var e=0;e<t.length;e++)t[e]()}function du(){var t,e,r=new Promise((s,i)=>{t=s,e=i});return{promise:r,resolve:t,reject:e}}const Ct=2,ss=4,ii=8,pu=1<<24,rr=16,On=32,ra=64,hu=128,pn=512,kt=1024,It=2048,Pn=4096,en=8192,tr=16384,ds=32768,Sa=65536,kl=1<<17,vu=1<<18,Ia=1<<19,bf=1<<20,er=1<<25,Jr=65536,Qi=1<<21,_o=1<<22,_r=1<<23,Xr=Symbol("$state"),_f=Symbol("legacy props"),wf=Symbol(""),zr=new class extends Error{constructor(){super(...arguments);Ke(this,"name","StaleReactionError");Ke(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function kf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Sf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Ef(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Tf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Af(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Cf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function If(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Rf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Pf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Of(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Df(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Mf=1,Lf=2,gu=4,Nf=8,qf=16,jf=1,Bf=4,zf=8,Ff=16,mu=1,Kf=2,Et=Symbol(),yu="http://www.w3.org/1999/xhtml";function Uf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Gf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function bu(t){return t===this.v}function Hf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function _u(t){return!Hf(t,this.v)}let Wf=!1,tn=null;function Ea(t){tn=t}function lt(t,e=!1,r){tn={p:tn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ut(t){var e=tn,r=e.e;if(r!==null){e.e=null;for(var s of r)Ku(s)}return e.i=!0,tn=e.p,{}}function wu(){return!0}let Fr=[];function ku(){var t=Fr;Fr=[],yf(t)}function wr(t){if(Fr.length===0&&!ts){var e=Fr;queueMicrotask(()=>{e===Fr&&ku()})}Fr.push(t)}function Yf(){for(;Fr.length>0;)ku()}function xu(t){var e=et;if(e===null)return Ge.f|=_r,t;if((e.f&ds)===0&&(e.f&ss)===0)throw t;Ta(t,e)}function Ta(t,e){for(;e!==null;){if((e.f&hu)!==0){if((e.f&ds)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Vf=-7169;function ht(t,e){t.f=t.f&Vf|e}function wo(t){(t.f&pn)!==0||t.deps===null?ht(t,kt):ht(t,Pn)}function Su(t){if(t!==null)for(const e of t)(e.f&Ct)===0||(e.f&Jr)===0||(e.f^=Jr,Su(e.deps))}function Eu(t,e,r){(t.f&It)!==0?e.add(t):(t.f&Pn)!==0&&r.add(t),Su(t.deps),ht(t,kt)}const Ns=new Set;let je=null,Zs=null,Tt=null,Wt=[],oi=null,Zi=!1,ts=!1;var ga,ma,Ur,ya,ls,us,Gr,Qn,ba,Un,Ji,$i,Tu;const Wo=class Wo{constructor(){Ue(this,Un);Ke(this,"committed",!1);Ke(this,"current",new Map);Ke(this,"previous",new Map);Ue(this,ga,new Set);Ue(this,ma,new Set);Ue(this,Ur,0);Ue(this,ya,0);Ue(this,ls,null);Ue(this,us,new Set);Ue(this,Gr,new Set);Ue(this,Qn,new Map);Ke(this,"is_fork",!1);Ue(this,ba,!1)}is_deferred(){return this.is_fork||H(this,ya)>0}skip_effect(e){H(this,Qn).has(e)||H(this,Qn).set(e,{d:[],m:[]})}unskip_effect(e){var r=H(this,Qn).get(e);if(r){H(this,Qn).delete(e);for(var s of r.d)ht(s,It),Cn(s);for(s of r.m)ht(s,Pn),Cn(s)}}process(e){var i;Wt=[],this.apply();var r=[],s=[];for(const o of e)Dt(this,Un,Ji).call(this,o,r,s);if(this.is_deferred()){Dt(this,Un,$i).call(this,s),Dt(this,Un,$i).call(this,r);for(const[o,c]of H(this,Qn))Ru(o,c)}else{for(const o of H(this,ga))o();H(this,ga).clear(),H(this,Ur)===0&&Dt(this,Un,Tu).call(this),Zs=this,je=null,xl(s),xl(r),Zs=null,(i=H(this,ls))==null||i.resolve()}Tt=null}capture(e,r){r!==Et&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&_r)===0&&(this.current.set(e,e.v),Tt==null||Tt.set(e,e.v))}activate(){je=this,this.apply()}deactivate(){je===this&&(je=null,Tt=null)}flush(){if(this.activate(),Wt.length>0){if(Au(),je!==null&&je!==this)return}else H(this,Ur)===0&&this.process([]);this.deactivate()}discard(){for(const e of H(this,ma))e(this);H(this,ma).clear()}increment(e){ze(this,Ur,H(this,Ur)+1),e&&ze(this,ya,H(this,ya)+1)}decrement(e){ze(this,Ur,H(this,Ur)-1),e&&ze(this,ya,H(this,ya)-1),!H(this,ba)&&(ze(this,ba,!0),wr(()=>{ze(this,ba,!1),this.is_deferred()?Wt.length>0&&this.flush():this.revive()}))}revive(){for(const e of H(this,us))H(this,Gr).delete(e),ht(e,It),Cn(e);for(const e of H(this,Gr))ht(e,Pn),Cn(e);this.flush()}oncommit(e){H(this,ga).add(e)}ondiscard(e){H(this,ma).add(e)}settled(){return(H(this,ls)??ze(this,ls,du())).promise}static ensure(){if(je===null){const e=je=new Wo;Ns.add(je),ts||wr(()=>{je===e&&e.flush()})}return je}apply(){}};ga=new WeakMap,ma=new WeakMap,Ur=new WeakMap,ya=new WeakMap,ls=new WeakMap,us=new WeakMap,Gr=new WeakMap,Qn=new WeakMap,ba=new WeakMap,Un=new WeakSet,Ji=function(e,r,s){e.f^=kt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(On|ra))!==0,v=d&&(c&kt)!==0,h=v||(c&en)!==0||H(this,Qn).has(i);if(!h&&i.fn!==null){d?i.f^=kt:o!==null&&(c&(ss|ii|pu))!==0?o.b.defer_effect(i):(c&ss)!==0?r.push(i):hs(i)&&((c&rr)!==0&&H(this,Gr).add(i),Ca(i));var y=i.first;if(y!==null){i=y;continue}}var _=i.parent;for(i=i.next;i===null&&_!==null;)_===o&&(o=null),i=_.next,_=_.parent}},$i=function(e){for(var r=0;r<e.length;r+=1)Eu(e[r],H(this,us),H(this,Gr))},Tu=function(){var i;if(Ns.size>1){this.previous.clear();var e=Tt,r=!0;for(const o of Ns){if(o===this){r=!1;continue}const c=[];for(const[v,h]of this.current){if(o.current.has(v))if(r&&h!==o.current.get(v))o.current.set(v,h);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var s=Wt;Wt=[];const v=new Set,h=new Map;for(const y of c)Cu(y,d,v,h);if(Wt.length>0){je=o,o.apply();for(const y of Wt)Dt(i=o,Un,Ji).call(i,y,[],[]);o.deactivate()}Wt=s}}je=null,Tt=e}this.committed=!0,Ns.delete(this)};let kr=Wo;function Xf(t){var e=ts;ts=!0;try{for(var r;;){if(Yf(),Wt.length===0&&(je==null||je.flush(),Wt.length===0))return oi=null,r;Au()}}finally{ts=e}}function Au(){Zi=!0;var t=null;try{for(var e=0;Wt.length>0;){var r=kr.ensure();if(e++>1e3){var s,i;Qf()}r.process(Wt),xr.clear()}}finally{Wt=[],Zi=!1,oi=null}}function Qf(){try{Cf()}catch(t){Ta(t,oi)}}let xn=null;function xl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var s=t[r++];if((s.f&(tr|en))===0&&hs(s)&&(xn=new Set,Ca(s),s.deps===null&&s.first===null&&s.nodes===null&&s.teardown===null&&s.ac===null&&Wu(s),(xn==null?void 0:xn.size)>0)){xr.clear();for(const i of xn){if((i.f&(tr|en))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)xn.has(c)&&(xn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(tr|en))===0&&Ca(v)}}xn.clear()}}xn=null}}function Cu(t,e,r,s){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ct)!==0?Cu(i,e,r,s):(o&(_o|rr))!==0&&(o&It)===0&&Iu(i,e,s)&&(ht(i,It),Cn(i))}}function Iu(t,e,r){const s=r.get(t);if(s!==void 0)return s;if(t.deps!==null)for(const i of t.deps){if(xa.call(e,i))return!0;if((i.f&Ct)!==0&&Iu(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Cn(t){for(var e=oi=t;e.parent!==null;){e=e.parent;var r=e.f;if(Zi&&e===et&&(r&rr)!==0&&(r&vu)===0)return;if((r&(ra|On))!==0){if((r&kt)===0)return;e.f^=kt}}Wt.push(e)}function Ru(t,e){if(!((t.f&On)!==0&&(t.f&kt)!==0)){(t.f&It)!==0?e.d.push(t):(t.f&Pn)!==0&&e.m.push(t),ht(t,kt);for(var r=t.first;r!==null;)Ru(r,e),r=r.next}}function Zf(t){let e=0,r=$r(0),s;return()=>{So()&&(k(r),Eo(()=>(e===0&&(s=vs(()=>t(()=>ns(r)))),e+=1,()=>{wr(()=>{e-=1,e===0&&(s==null||s(),s=void 0,ns(r))})})))}}var Jf=Sa|Ia|hu;function $f(t,e,r){new ed(t,e,r)}var un,yo,jn,Hr,Bn,cn,Gt,zn,Zn,yr,Wr,br,_a,Yr,wa,ka,Jn,ri,St,td,nd,eo,Gs,Hs,to;class ed{constructor(e,r,s){Ue(this,St);Ke(this,"parent");Ke(this,"is_pending",!1);Ue(this,un);Ue(this,yo,null);Ue(this,jn);Ue(this,Hr);Ue(this,Bn);Ue(this,cn,null);Ue(this,Gt,null);Ue(this,zn,null);Ue(this,Zn,null);Ue(this,yr,null);Ue(this,Wr,0);Ue(this,br,0);Ue(this,_a,!1);Ue(this,Yr,!1);Ue(this,wa,new Set);Ue(this,ka,new Set);Ue(this,Jn,null);Ue(this,ri,Zf(()=>(ze(this,Jn,$r(H(this,Wr))),()=>{ze(this,Jn,null)})));ze(this,un,e),ze(this,jn,r),ze(this,Hr,s),this.parent=et.b,this.is_pending=!!H(this,jn).pending,ze(this,Bn,To(()=>{et.b=this;{var i=Dt(this,St,eo).call(this);try{ze(this,cn,fn(()=>s(i)))}catch(o){this.error(o)}H(this,br)>0?Dt(this,St,Hs).call(this):this.is_pending=!1}return()=>{var o;(o=H(this,yr))==null||o.remove()}},Jf))}defer_effect(e){Eu(e,H(this,wa),H(this,ka))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!H(this,jn).pending}update_pending_count(e){Dt(this,St,to).call(this,e),ze(this,Wr,H(this,Wr)+e),!(!H(this,Jn)||H(this,_a))&&(ze(this,_a,!0),wr(()=>{ze(this,_a,!1),H(this,Jn)&&Aa(H(this,Jn),H(this,Wr))}))}get_effect_pending(){return H(this,ri).call(this),k(H(this,Jn))}error(e){var r=H(this,jn).onerror;let s=H(this,jn).failed;if(H(this,Yr)||!r&&!s)throw e;H(this,cn)&&(Vt(H(this,cn)),ze(this,cn,null)),H(this,Gt)&&(Vt(H(this,Gt)),ze(this,Gt,null)),H(this,zn)&&(Vt(H(this,zn)),ze(this,zn,null));var i=!1,o=!1;const c=()=>{if(i){Gf();return}i=!0,o&&Df(),kr.ensure(),ze(this,Wr,0),H(this,zn)!==null&&Qr(H(this,zn),()=>{ze(this,zn,null)}),this.is_pending=this.has_pending_snippet(),ze(this,cn,Dt(this,St,Gs).call(this,()=>(ze(this,Yr,!1),fn(()=>H(this,Hr).call(this,H(this,un)))))),H(this,br)>0?Dt(this,St,Hs).call(this):this.is_pending=!1};wr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Ta(d,H(this,Bn)&&H(this,Bn).parent)}s&&ze(this,zn,Dt(this,St,Gs).call(this,()=>{kr.ensure(),ze(this,Yr,!0);try{return fn(()=>{s(H(this,un),()=>e,()=>c)})}catch(d){return Ta(d,H(this,Bn).parent),null}finally{ze(this,Yr,!1)}}))})}}un=new WeakMap,yo=new WeakMap,jn=new WeakMap,Hr=new WeakMap,Bn=new WeakMap,cn=new WeakMap,Gt=new WeakMap,zn=new WeakMap,Zn=new WeakMap,yr=new WeakMap,Wr=new WeakMap,br=new WeakMap,_a=new WeakMap,Yr=new WeakMap,wa=new WeakMap,ka=new WeakMap,Jn=new WeakMap,ri=new WeakMap,St=new WeakSet,td=function(){try{ze(this,cn,fn(()=>H(this,Hr).call(this,H(this,un))))}catch(e){this.error(e)}},nd=function(){const e=H(this,jn).pending;e&&(ze(this,Gt,fn(()=>e(H(this,un)))),wr(()=>{var r=Dt(this,St,eo).call(this);ze(this,cn,Dt(this,St,Gs).call(this,()=>(kr.ensure(),fn(()=>H(this,Hr).call(this,r))))),H(this,br)>0?Dt(this,St,Hs).call(this):(Qr(H(this,Gt),()=>{ze(this,Gt,null)}),this.is_pending=!1)}))},eo=function(){var e=H(this,un);return this.is_pending&&(ze(this,yr,nr()),H(this,un).before(H(this,yr)),e=H(this,yr)),e},Gs=function(e){var r=et,s=Ge,i=tn;Kn(H(this,Bn)),vn(H(this,Bn)),Ea(H(this,Bn).ctx);try{return e()}catch(o){return xu(o),null}finally{Kn(r),vn(s),Ea(i)}},Hs=function(){const e=H(this,jn).pending;H(this,cn)!==null&&(ze(this,Zn,document.createDocumentFragment()),H(this,Zn).append(H(this,yr)),Xu(H(this,cn),H(this,Zn))),H(this,Gt)===null&&ze(this,Gt,fn(()=>e(H(this,un))))},to=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Dt(r=this.parent,St,to).call(r,e);return}if(ze(this,br,H(this,br)+e),H(this,br)===0){this.is_pending=!1;for(const s of H(this,wa))ht(s,It),Cn(s);for(const s of H(this,ka))ht(s,Pn),Cn(s);H(this,wa).clear(),H(this,ka).clear(),H(this,Gt)&&Qr(H(this,Gt),()=>{ze(this,Gt,null)}),H(this,Zn)&&(H(this,un).before(H(this,Zn)),ze(this,Zn,null))}};function rd(t,e,r,s){const i=li;var o=t.filter(b=>!b.settled);if(r.length===0&&o.length===0){s(e.map(i));return}var c=je,d=et,v=ad(),h=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(b=>b.promise)):null;function y(b){v();try{s(b)}catch(w){(d.f&tr)===0&&Ta(w,d)}c==null||c.deactivate(),no()}if(r.length===0){h.then(()=>y(e.map(i)));return}function _(){v(),Promise.all(r.map(b=>sd(b))).then(b=>y([...e.map(i),...b])).catch(b=>Ta(b,d))}h?h.then(_):_()}function ad(){var t=et,e=Ge,r=tn,s=je;return function(o=!0){Kn(t),vn(e),Ea(r),o&&(s==null||s.activate())}}function no(){Kn(null),vn(null),Ea(null)}function li(t){var e=Ct|It,r=Ge!==null&&(Ge.f&Ct)!==0?Ge:null;return et!==null&&(et.f|=Ia),{ctx:tn,deps:null,effects:null,equals:bu,f:e,fn:t,reactions:null,rv:0,v:Et,wv:0,parent:r??et,ac:null}}function sd(t,e,r){let s=et;s===null&&xf();var i=s.b,o=void 0,c=$r(Et),d=!Ge,v=new Map;return bd(()=>{var w;var h=du();o=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{y===je&&y.committed&&y.deactivate(),no()})}catch(D){h.reject(D),no()}var y=je;if(d){var _=i.is_rendered();i.update_pending_count(1),y.increment(_),(w=v.get(y))==null||w.reject(zr),v.delete(y),v.set(y,h)}const b=(D,j=void 0)=>{if(y.activate(),j)j!==zr&&(c.f|=_r,Aa(c,j));else{(c.f&_r)!==0&&(c.f^=_r),Aa(c,D);for(const[S,F]of v){if(v.delete(S),S===y)break;F.reject(zr)}}d&&(i.update_pending_count(-1),y.decrement(_))};h.promise.then(b,D=>b(null,D||"unknown"))}),Fu(()=>{for(const h of v.values())h.reject(zr)}),new Promise(h=>{function y(_){function b(){_===o?h(c):y(o)}_.then(b,b)}y(o)})}function Mt(t){const e=li(t);return Qu(e),e}function Pu(t){const e=li(t);return e.equals=_u,e}function id(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Vt(e[r])}}function od(t){for(var e=t.parent;e!==null;){if((e.f&Ct)===0)return(e.f&tr)===0?e:null;e=e.parent}return null}function ko(t){var e,r=et;Kn(od(t));try{t.f&=~Jr,id(t),e=ec(t)}finally{Kn(r)}return e}function Ou(t){var e=ko(t);if(!t.equals(e)&&(t.wv=Ju(),(!(je!=null&&je.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){ht(t,kt);return}Sr||(Tt!==null?(So()||je!=null&&je.is_fork)&&Tt.set(t,e):wo(t))}function ld(t){var e,r;if(t.effects!==null)for(const s of t.effects)(s.teardown||s.ac)&&((e=s.teardown)==null||e.call(s),(r=s.ac)==null||r.abort(zr),s.teardown=mf,s.ac=null,is(s,0),Ao(s))}function Du(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ca(e)}let ro=new Set;const xr=new Map;let Mu=!1;function $r(t,e){var r={f:0,v:t,reactions:null,equals:bu,rv:0,wv:0};return r}function Oe(t,e){const r=$r(t);return Qu(r),r}function ud(t,e=!1,r=!0){const s=$r(t);return e||(s.equals=_u),s}function z(t,e,r=!1){Ge!==null&&(!In||(Ge.f&kl)!==0)&&wu()&&(Ge.f&(Ct|rr|_o|kl))!==0&&(hn===null||!xa.call(hn,t))&&Of();let s=r?wt(e):e;return Aa(t,s)}function Aa(t,e){if(!t.equals(e)){var r=t.v;Sr?xr.set(t,e):xr.set(t,r),t.v=e;var s=kr.ensure();if(s.capture(t,r),(t.f&Ct)!==0){const i=t;(t.f&It)!==0&&ko(i),wo(i)}t.wv=Ju(),Lu(t,It),et!==null&&(et.f&kt)!==0&&(et.f&(On|ra))===0&&(ln===null?wd([t]):ln.push(t)),!s.is_fork&&ro.size>0&&!Mu&&cd()}return e}function cd(){Mu=!1;for(const t of ro)(t.f&kt)!==0&&ht(t,Pn),hs(t)&&Ca(t);ro.clear()}function ns(t){z(t,t.v+1)}function Lu(t,e){var r=t.reactions;if(r!==null)for(var s=r.length,i=0;i<s;i++){var o=r[i],c=o.f,d=(c&It)===0;if(d&&ht(o,e),(c&Ct)!==0){var v=o;Tt==null||Tt.delete(v),(c&Jr)===0&&(c&pn&&(o.f|=Jr),Lu(v,Pn))}else d&&((c&rr)!==0&&xn!==null&&xn.add(o),Cn(o))}}function wt(t){if(typeof t!="object"||t===null||Xr in t)return t;const e=fu(t);if(e!==vf&&e!==gf)return t;var r=new Map,s=bo(t),i=Oe(0),o=Zr,c=d=>{if(Zr===o)return d();var v=Ge,h=Zr;vn(null),Cl(o);var y=d();return vn(v),Cl(h),y};return s&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Rf();var y=r.get(v);return y===void 0?c(()=>{var _=Oe(h.value);return r.set(v,_),_}):z(y,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const y=c(()=>Oe(Et));r.set(v,y),ns(i)}}else z(h,Et),ns(i);return!0},get(d,v,h){var w;if(v===Xr)return t;var y=r.get(v),_=v in d;if(y===void 0&&(!_||(w=va(d,v))!=null&&w.writable)&&(y=c(()=>{var D=wt(_?d[v]:Et),j=Oe(D);return j}),r.set(v,y)),y!==void 0){var b=k(y);return b===Et?void 0:b}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var y=r.get(v);y&&(h.value=k(y))}else if(h===void 0){var _=r.get(v),b=_==null?void 0:_.v;if(_!==void 0&&b!==Et)return{enumerable:!0,configurable:!0,value:b,writable:!0}}return h},has(d,v){var b;if(v===Xr)return!0;var h=r.get(v),y=h!==void 0&&h.v!==Et||Reflect.has(d,v);if(h!==void 0||et!==null&&(!y||(b=va(d,v))!=null&&b.writable)){h===void 0&&(h=c(()=>{var w=y?wt(d[v]):Et,D=Oe(w);return D}),r.set(v,h));var _=k(h);if(_===Et)return!1}return y},set(d,v,h,y){var J;var _=r.get(v),b=v in d;if(s&&v==="length")for(var w=h;w<_.v;w+=1){var D=r.get(w+"");D!==void 0?z(D,Et):w in d&&(D=c(()=>Oe(Et)),r.set(w+"",D))}if(_===void 0)(!b||(J=va(d,v))!=null&&J.writable)&&(_=c(()=>Oe(void 0)),z(_,wt(h)),r.set(v,_));else{b=_.v!==Et;var j=c(()=>wt(h));z(_,j)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(y,h),!b){if(s&&typeof v=="string"){var F=r.get("length"),re=Number(v);Number.isInteger(re)&&re>=F.v&&z(F,re+1)}ns(i)}return!0},ownKeys(d){k(i);var v=Reflect.ownKeys(d).filter(_=>{var b=r.get(_);return b===void 0||b.v!==Et});for(var[h,y]of r)y.v!==Et&&!(h in d)&&v.push(h);return v},setPrototypeOf(){Pf()}})}function Sl(t){try{if(t!==null&&typeof t=="object"&&Xr in t)return t[Xr]}catch{}return t}function fd(t,e){return Object.is(Sl(t),Sl(e))}var El,Nu,qu,ju;function dd(){if(El===void 0){El=window,Nu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;qu=va(e,"firstChild").get,ju=va(e,"nextSibling").get,wl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),wl(r)&&(r.__t=void 0)}}function nr(t=""){return document.createTextNode(t)}function $t(t){return qu.call(t)}function ps(t){return ju.call(t)}function x(t,e){return $t(t)}function xt(t,e=!1){{var r=$t(t);return r instanceof Comment&&r.data===""?ps(r):r}}function M(t,e=1,r=!1){let s=t;for(;e--;)s=ps(s);return s}function pd(t){t.textContent=""}function Bu(){return!1}function hd(t,e,r){return document.createElementNS(yu,t,void 0)}let Tl=!1;function vd(){Tl||(Tl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function xo(t){var e=Ge,r=et;vn(null),Kn(null);try{return t()}finally{vn(e),Kn(r)}}function zu(t,e,r,s=r){t.addEventListener(e,()=>xo(r));const i=t.__on_r;i?t.__on_r=()=>{i(),s(!0)}:t.__on_r=()=>s(!0),vd()}function gd(t){et===null&&(Ge===null&&Af(),Tf()),Sr&&Ef()}function md(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ar(t,e,r){var s=et;s!==null&&(s.f&en)!==0&&(t|=en);var i={ctx:tn,deps:null,nodes:null,f:t|It|pn,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ca(i)}catch(d){throw Vt(i),d}else e!==null&&Cn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ia)===0&&(o=o.first,(t&rr)!==0&&(t&Sa)!==0&&o!==null&&(o.f|=Sa)),o!==null&&(o.parent=s,s!==null&&md(o,s),Ge!==null&&(Ge.f&Ct)!==0&&(t&ra)===0)){var c=Ge;(c.effects??(c.effects=[])).push(o)}return i}function So(){return Ge!==null&&!In}function Fu(t){const e=ar(ii,null,!1);return ht(e,kt),e.teardown=t,e}function Js(t){gd();var e=et.f,r=!Ge&&(e&On)!==0&&(e&ds)===0;if(r){var s=tn;(s.e??(s.e=[])).push(t)}else return Ku(t)}function Ku(t){return ar(ss|bf,t,!1)}function yd(t){kr.ensure();const e=ar(ra|Ia,t,!0);return(r={})=>new Promise(s=>{r.outro?Qr(e,()=>{Vt(e),s(void 0)}):(Vt(e),s(void 0))})}function Uu(t){return ar(ss,t,!1)}function bd(t){return ar(_o|Ia,t,!0)}function Eo(t,e=0){return ar(ii|e,t,!0)}function ye(t,e=[],r=[],s=[]){rd(s,e,r,i=>{ar(ii,()=>t(...i.map(k)),!0)})}function To(t,e=0){var r=ar(rr|e,t,!0);return r}function fn(t){return ar(On|Ia,t,!0)}function Gu(t){var e=t.teardown;if(e!==null){const r=Sr,s=Ge;Al(!0),vn(null);try{e.call(null)}finally{Al(r),vn(s)}}}function Ao(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&xo(()=>{i.abort(zr)});var s=r.next;(r.f&ra)!==0?r.parent=null:Vt(r,e),r=s}}function _d(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&On)===0&&Vt(e),e=r}}function Vt(t,e=!0){var r=!1;(e||(t.f&vu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Hu(t.nodes.start,t.nodes.end),r=!0),Ao(t,e&&!r),is(t,0),ht(t,tr);var s=t.nodes&&t.nodes.t;if(s!==null)for(const o of s)o.stop();Gu(t);var i=t.parent;i!==null&&i.first!==null&&Wu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Hu(t,e){for(;t!==null;){var r=t===e?null:ps(t);t.remove(),t=r}}function Wu(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function Qr(t,e,r=!0){var s=[];Yu(t,s,!0);var i=()=>{r&&Vt(t),e&&e()},o=s.length;if(o>0){var c=()=>--o||i();for(var d of s)d.out(c)}else i()}function Yu(t,e,r){if((t.f&en)===0){t.f^=en;var s=t.nodes&&t.nodes.t;if(s!==null)for(const d of s)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Sa)!==0||(i.f&On)!==0&&(t.f&rr)!==0;Yu(i,e,c?r:!1),i=o}}}function Co(t){Vu(t,!0)}function Vu(t,e){if((t.f&en)!==0){t.f^=en,(t.f&kt)===0&&(ht(t,It),Cn(t));for(var r=t.first;r!==null;){var s=r.next,i=(r.f&Sa)!==0||(r.f&On)!==0;Vu(r,i?e:!1),r=s}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Xu(t,e){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end;r!==null;){var i=r===s?null:ps(r);e.append(r),r=i}}let Ws=!1,Sr=!1;function Al(t){Sr=t}let Ge=null,In=!1;function vn(t){Ge=t}let et=null;function Kn(t){et=t}let hn=null;function Qu(t){Ge!==null&&(hn===null?hn=[t]:hn.push(t))}let Yt=null,Zt=0,ln=null;function wd(t){ln=t}let Zu=1,Kr=0,Zr=Kr;function Cl(t){Zr=t}function Ju(){return++Zu}function hs(t){var e=t.f;if((e&It)!==0)return!0;if(e&Ct&&(t.f&=~Jr),(e&Pn)!==0){for(var r=t.deps,s=r.length,i=0;i<s;i++){var o=r[i];if(hs(o)&&Ou(o),o.wv>t.wv)return!0}(e&pn)!==0&&Tt===null&&ht(t,kt)}return!1}function $u(t,e,r=!0){var s=t.reactions;if(s!==null&&!(hn!==null&&xa.call(hn,t)))for(var i=0;i<s.length;i++){var o=s[i];(o.f&Ct)!==0?$u(o,e,!1):e===o&&(r?ht(o,It):(o.f&kt)!==0&&ht(o,Pn),Cn(o))}}function ec(t){var j;var e=Yt,r=Zt,s=ln,i=Ge,o=hn,c=tn,d=In,v=Zr,h=t.f;Yt=null,Zt=0,ln=null,Ge=(h&(On|ra))===0?t:null,hn=null,Ea(t.ctx),In=!1,Zr=++Kr,t.ac!==null&&(xo(()=>{t.ac.abort(zr)}),t.ac=null);try{t.f|=Qi;var y=t.fn,_=y();t.f|=ds;var b=t.deps,w=je==null?void 0:je.is_fork;if(Yt!==null){var D;if(w||is(t,Zt),b!==null&&Zt>0)for(b.length=Zt+Yt.length,D=0;D<Yt.length;D++)b[Zt+D]=Yt[D];else t.deps=b=Yt;if(So()&&(t.f&pn)!==0)for(D=Zt;D<b.length;D++)((j=b[D]).reactions??(j.reactions=[])).push(t)}else!w&&b!==null&&Zt<b.length&&(is(t,Zt),b.length=Zt);if(wu()&&ln!==null&&!In&&b!==null&&(t.f&(Ct|Pn|It))===0)for(D=0;D<ln.length;D++)$u(ln[D],t);if(i!==null&&i!==t){if(Kr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Kr;if(e!==null)for(const S of e)S.rv=Kr;ln!==null&&(s===null?s=ln:s.push(...ln))}return(t.f&_r)!==0&&(t.f^=_r),_}catch(S){return xu(S)}finally{t.f^=Qi,Yt=e,Zt=r,ln=s,Ge=i,hn=o,Ea(c),In=d,Zr=v}}function kd(t,e){let r=e.reactions;if(r!==null){var s=df.call(r,t);if(s!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[s]=r[i],r.pop())}}if(r===null&&(e.f&Ct)!==0&&(Yt===null||!xa.call(Yt,e))){var o=e;(o.f&pn)!==0&&(o.f^=pn,o.f&=~Jr),wo(o),ld(o),is(o,0)}}function is(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)kd(t,r[s])}function Ca(t){var e=t.f;if((e&tr)===0){ht(t,kt);var r=et,s=Ws;et=t,Ws=!0;try{(e&(rr|pu))!==0?_d(t):Ao(t),Gu(t);var i=ec(t);t.teardown=typeof i=="function"?i:null,t.wv=Zu;var o;Xi&&Wf&&(t.f&It)!==0&&t.deps}finally{Ws=s,et=r}}}async function tc(){await Promise.resolve(),Xf()}function k(t){var e=t.f,r=(e&Ct)!==0;if(Ge!==null&&!In){var s=et!==null&&(et.f&tr)!==0;if(!s&&(hn===null||!xa.call(hn,t))){var i=Ge.deps;if((Ge.f&Qi)!==0)t.rv<Kr&&(t.rv=Kr,Yt===null&&i!==null&&i[Zt]===t?Zt++:Yt===null?Yt=[t]:Yt.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ge]:xa.call(o,Ge)||o.push(Ge)}}}if(Sr&&xr.has(t))return xr.get(t);if(r){var c=t;if(Sr){var d=c.v;return((c.f&kt)===0&&c.reactions!==null||rc(c))&&(d=ko(c)),xr.set(c,d),d}var v=(c.f&pn)===0&&!In&&Ge!==null&&(Ws||(Ge.f&pn)!==0),h=(c.f&ds)===0;hs(c)&&(v&&(c.f|=pn),Ou(c)),v&&!h&&(Du(c),nc(c))}if(Tt!=null&&Tt.has(t))return Tt.get(t);if((t.f&_r)!==0)throw t.v;return t.v}function nc(t){if(t.f|=pn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ct)!==0&&(e.f&pn)===0&&(Du(e),nc(e))}function rc(t){if(t.v===Et)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Ct)!==0&&rc(e))return!0;return!1}function vs(t){var e=In;try{return In=!0,t()}finally{In=e}}const xd=["touchstart","touchmove"];function Sd(t){return xd.includes(t)}const ac=new Set,ao=new Set;function Kt(t){for(var e=0;e<t.length;e++)ac.add(t[e]);for(var r of ao)r(t)}let Il=null;function Rl(t){var S;var e=this,r=e.ownerDocument,s=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;Il=t;var c=0,d=Il===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=i.indexOf(e);if(h===-1)return;v<=h&&(c=v)}if(o=i[c]||t.target,o!==e){pf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Ge,_=et;vn(null),Kn(null);try{for(var b,w=[];o!==null;){var D=o.assignedSlot||o.parentNode||o.host||null;try{var j=o["__"+s];j!=null&&(!o.disabled||t.target===o)&&j.call(o,t)}catch(F){b?w.push(F):b=F}if(t.cancelBubble||D===e||D===null)break;o=D}if(b){for(let F of w)queueMicrotask(()=>{throw F});throw b}}finally{t.__root=e,delete t.currentTarget,vn(y),Kn(_)}}}var lu,uu;const qi=(uu=(lu=globalThis==null?void 0:globalThis.window)==null?void 0:lu.trustedTypes)==null?void 0:uu.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Ed(t){return(qi==null?void 0:qi.createHTML(t))??t}function Io(t,e=!1){var r=hd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Ed(t):t,r.content}function ea(t,e){var r=et;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function X(t,e){var r=(e&mu)!==0,s=(e&Kf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Io(o?t:"<!>"+t,!0),r||(i=$t(i)));var c=s||Nu?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=$t(c),v=c.lastChild;ea(d,v)}else ea(c,c);return c}}function Td(t,e,r="svg"){var s=!t.startsWith("<!>"),i=(e&mu)!==0,o=`<${r}>${s?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Io(o,!0),v=$t(d);if(i)for(c=document.createDocumentFragment();$t(v);)c.appendChild($t(v));else c=$t(v)}var h=c.cloneNode(!0);if(i){var y=$t(h),_=h.lastChild;ea(y,_)}else ea(h,h);return h}}function Ro(t,e){return Td(t,e,"svg")}function Pl(t=""){{var e=nr(t+"");return ea(e,e),e}}function Po(){var t=document.createDocumentFragment(),e=document.createComment(""),r=nr();return t.append(e,r),ea(e,r),t}function G(t,e){t!==null&&t.before(e)}function ce(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Ad(t,e){return Cd(t,e)}const qs=new Map;function Cd(t,{target:e,anchor:r,props:s={},events:i,context:o,intro:c=!0}){dd();var d=new Set,v=_=>{for(var b=0;b<_.length;b++){var w=_[b];if(!d.has(w)){d.add(w);var D=Sd(w);for(const F of[e,document]){var j=qs.get(F);j===void 0&&(j=new Map,qs.set(F,j));var S=j.get(w);S===void 0?(F.addEventListener(w,Rl,{passive:D}),j.set(w,1)):j.set(w,S+1)}}}};v(si(ac)),ao.add(v);var h=void 0,y=yd(()=>{var _=r??e.appendChild(nr());return $f(_,{pending:()=>{}},b=>{lt({});var w=tn;o&&(w.c=o),i&&(s.$$events=i),h=t(b,s)||{},ut()}),()=>{var j;for(var b of d)for(const S of[e,document]){var w=qs.get(S),D=w.get(b);--D==0?(S.removeEventListener(b,Rl),w.delete(b),w.size===0&&qs.delete(S)):w.set(b,D)}ao.delete(v),_!==r&&((j=_.parentNode)==null||j.removeChild(_))}});return Id.set(h,y),h}let Id=new WeakMap;var En,Fn,Jt,Vr,cs,fs,ai;class Rd{constructor(e,r=!0){Ke(this,"anchor");Ue(this,En,new Map);Ue(this,Fn,new Map);Ue(this,Jt,new Map);Ue(this,Vr,new Set);Ue(this,cs,!0);Ue(this,fs,()=>{var e=je;if(H(this,En).has(e)){var r=H(this,En).get(e),s=H(this,Fn).get(r);if(s)Co(s),H(this,Vr).delete(r);else{var i=H(this,Jt).get(r);i&&(H(this,Fn).set(r,i.effect),H(this,Jt).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),s=i.effect)}for(const[o,c]of H(this,En)){if(H(this,En).delete(o),o===e)break;const d=H(this,Jt).get(c);d&&(Vt(d.effect),H(this,Jt).delete(c))}for(const[o,c]of H(this,Fn)){if(o===r||H(this,Vr).has(o))continue;const d=()=>{if(Array.from(H(this,En).values()).includes(o)){var h=document.createDocumentFragment();Xu(c,h),h.append(nr()),H(this,Jt).set(o,{effect:c,fragment:h})}else Vt(c);H(this,Vr).delete(o),H(this,Fn).delete(o)};H(this,cs)||!s?(H(this,Vr).add(o),Qr(c,d,!1)):d()}}});Ue(this,ai,e=>{H(this,En).delete(e);const r=Array.from(H(this,En).values());for(const[s,i]of H(this,Jt))r.includes(s)||(Vt(i.effect),H(this,Jt).delete(s))});this.anchor=e,ze(this,cs,r)}ensure(e,r){var s=je,i=Bu();if(r&&!H(this,Fn).has(e)&&!H(this,Jt).has(e))if(i){var o=document.createDocumentFragment(),c=nr();o.append(c),H(this,Jt).set(e,{effect:fn(()=>r(c)),fragment:o})}else H(this,Fn).set(e,fn(()=>r(this.anchor)));if(H(this,En).set(s,e),i){for(const[d,v]of H(this,Fn))d===e?s.unskip_effect(v):s.skip_effect(v);for(const[d,v]of H(this,Jt))d===e?s.unskip_effect(v.effect):s.skip_effect(v.effect);s.oncommit(H(this,fs)),s.ondiscard(H(this,ai))}else H(this,fs).call(this)}}En=new WeakMap,Fn=new WeakMap,Jt=new WeakMap,Vr=new WeakMap,cs=new WeakMap,fs=new WeakMap,ai=new WeakMap;function we(t,e,r=!1){var s=new Rd(t),i=r?Sa:0;function o(c,d){s.ensure(c,d)}To(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function Er(t,e){return e}function Pd(t,e,r){for(var s=[],i=e.length,o,c=e.length,d=0;d<i;d++){let _=e[d];Qr(_,()=>{if(o){if(o.pending.delete(_),o.done.add(_),o.pending.size===0){var b=t.outrogroups;so(si(o.done)),b.delete(o),b.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=s.length===0&&r!==null;if(v){var h=r,y=h.parentNode;pd(y),y.append(h),t.items.clear()}so(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function so(t,e=!0){for(var r=0;r<t.length;r++)Vt(t[r],e)}var Ol;function gn(t,e,r,s,i,o=null){var c=t,d=new Map,v=(e&gu)!==0;if(v){var h=t;c=h.appendChild(nr())}var y=null,_=Pu(()=>{var F=r();return bo(F)?F:F==null?[]:si(F)}),b,w=!0;function D(){S.fallback=y,Od(S,b,c,e,s),y!==null&&(b.length===0?(y.f&er)===0?Co(y):(y.f^=er,$a(y,null,c)):Qr(y,()=>{y=null}))}var j=To(()=>{b=k(_);for(var F=b.length,re=new Set,J=je,U=Bu(),$=0;$<F;$+=1){var le=b[$],Z=s(le,$),pe=w?null:d.get(Z);pe?(pe.v&&Aa(pe.v,le),pe.i&&Aa(pe.i,$),U&&J.unskip_effect(pe.e)):(pe=Dd(d,w?c:Ol??(Ol=nr()),le,Z,$,i,e,r),w||(pe.e.f|=er),d.set(Z,pe)),re.add(Z)}if(F===0&&o&&!y&&(w?y=fn(()=>o(c)):(y=fn(()=>o(Ol??(Ol=nr()))),y.f|=er)),F>re.size&&Sf(),!w)if(U){for(const[Me,_e]of d)re.has(Me)||J.skip_effect(_e.e);J.oncommit(D),J.ondiscard(()=>{})}else D();k(_)}),S={effect:j,items:d,outrogroups:null,fallback:y};w=!1}function Ha(t){for(;t!==null&&(t.f&On)===0;)t=t.next;return t}function Od(t,e,r,s,i){var _e,me,ie,ae,Le,W,Q,ee,Y;var o=(s&Nf)!==0,c=e.length,d=t.items,v=Ha(t.effect.first),h,y=null,_,b=[],w=[],D,j,S,F;if(o)for(F=0;F<c;F+=1)D=e[F],j=i(D,F),S=d.get(j).e,(S.f&er)===0&&((me=(_e=S.nodes)==null?void 0:_e.a)==null||me.measure(),(_??(_=new Set)).add(S));for(F=0;F<c;F+=1){if(D=e[F],j=i(D,F),S=d.get(j).e,t.outrogroups!==null)for(const ne of t.outrogroups)ne.pending.delete(S),ne.done.delete(S);if((S.f&er)!==0)if(S.f^=er,S===v)$a(S,null,r);else{var re=y?y.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),gr(t,y,S),gr(t,S,re),$a(S,re,r),y=S,b=[],w=[],v=Ha(y.next);continue}if((S.f&en)!==0&&(Co(S),o&&((ae=(ie=S.nodes)==null?void 0:ie.a)==null||ae.unfix(),(_??(_=new Set)).delete(S))),S!==v){if(h!==void 0&&h.has(S)){if(b.length<w.length){var J=w[0],U;y=J.prev;var $=b[0],le=b[b.length-1];for(U=0;U<b.length;U+=1)$a(b[U],J,r);for(U=0;U<w.length;U+=1)h.delete(w[U]);gr(t,$.prev,le.next),gr(t,y,$),gr(t,le,J),v=J,y=le,F-=1,b=[],w=[]}else h.delete(S),$a(S,v,r),gr(t,S.prev,S.next),gr(t,S,y===null?t.effect.first:y.next),gr(t,y,S),y=S;continue}for(b=[],w=[];v!==null&&v!==S;)(h??(h=new Set)).add(v),w.push(v),v=Ha(v.next);if(v===null)continue}(S.f&er)===0&&b.push(S),y=S,v=Ha(S.next)}if(t.outrogroups!==null){for(const ne of t.outrogroups)ne.pending.size===0&&(so(si(ne.done)),(Le=t.outrogroups)==null||Le.delete(ne));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var Z=[];if(h!==void 0)for(S of h)(S.f&en)===0&&Z.push(S);for(;v!==null;)(v.f&en)===0&&v!==t.fallback&&Z.push(v),v=Ha(v.next);var pe=Z.length;if(pe>0){var Me=(s&gu)!==0&&c===0?r:null;if(o){for(F=0;F<pe;F+=1)(Q=(W=Z[F].nodes)==null?void 0:W.a)==null||Q.measure();for(F=0;F<pe;F+=1)(Y=(ee=Z[F].nodes)==null?void 0:ee.a)==null||Y.fix()}Pd(t,Z,Me)}}o&&wr(()=>{var ne,te;if(_!==void 0)for(S of _)(te=(ne=S.nodes)==null?void 0:ne.a)==null||te.apply()})}function Dd(t,e,r,s,i,o,c,d){var v=(c&Mf)!==0?(c&qf)===0?ud(r,!1,!1):$r(r):null,h=(c&Lf)!==0?$r(i):null;return{v,i:h,e:fn(()=>(o(e,v??r,h??i,d),()=>{t.delete(s)}))}}function $a(t,e,r){if(t.nodes)for(var s=t.nodes.start,i=t.nodes.end,o=e&&(e.f&er)===0?e.nodes.start:r;s!==null;){var c=ps(s);if(o.before(s),s===i)return;s=c}}function gr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Md(t,e,r=!1,s=!1,i=!1){var o=t,c="";ye(()=>{var d=et;if(c!==(c=e()??"")&&(d.nodes!==null&&(Hu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:s&&(v=`<math>${v}</math>`);var h=Io(v);if((r||s)&&(h=$t(h)),ea($t(h),h.lastChild),r||s)for(;$t(h);)o.before($t(h));else o.before(h)}})}const Dl=[...` 	
\r\fÂ \v\uFEFF`];function Ld(t,e,r){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),r){for(var i in r)if(r[i])s=s?s+" "+i:i;else if(s.length)for(var o=i.length,c=0;(c=s.indexOf(i,c))>=0;){var d=c+o;(c===0||Dl.includes(s[c-1]))&&(d===s.length||Dl.includes(s[d]))?s=(c===0?"":s.substring(0,c))+s.substring(d+1):c=d}}return s===""?null:s}function Ml(t,e=!1){var r=e?" !important;":";",s="";for(var i in t){var o=t[i];o!=null&&o!==""&&(s+=" "+i+": "+o+r)}return s}function ji(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Nd(t,e){if(e){var r="",s,i;if(Array.isArray(e)?(s=e[0],i=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];s&&v.push(...Object.keys(s).map(ji)),i&&v.push(...Object.keys(i).map(ji));var h=0,y=-1;const j=t.length;for(var _=0;_<j;_++){var b=t[_];if(d?b==="/"&&t[_-1]==="*"&&(d=!1):o?o===b&&(o=!1):b==="/"&&t[_+1]==="*"?d=!0:b==='"'||b==="'"?o=b:b==="("?c++:b===")"&&c--,!d&&o===!1&&c===0){if(b===":"&&y===-1)y=_;else if(b===";"||_===j-1){if(y!==-1){var w=ji(t.substring(h,y).trim());if(!v.includes(w)){b!==";"&&_++;var D=t.substring(h,_).trim();r+=" "+D+";"}}h=_+1,y=-1}}}}return s&&(r+=Ml(s)),i&&(r+=Ml(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function dn(t,e,r,s,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Ld(r,s,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var h=!!o[v];(i==null||h!==!!i[v])&&t.classList.toggle(v,h)}return o}function Bi(t,e={},r,s){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,s))}}function Rn(t,e,r,s){var i=t.__style;if(i!==e){var o=Nd(e,s);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else s&&(Array.isArray(s)?(Bi(t,r==null?void 0:r[0],s[0]),Bi(t,r==null?void 0:r[1],s[1],"important")):Bi(t,r,s));return s}function sc(t,e,r=!1){if(t.multiple){if(e==null)return;if(!bo(e))return Uf();for(var s of t.options)s.selected=e.includes(rs(s));return}for(s of t.options){var i=rs(s);if(fd(i,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function qd(t){var e=new MutationObserver(()=>{sc(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Fu(()=>{e.disconnect()})}function Oo(t,e,r=e){var s=new WeakSet,i=!0;zu(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),rs);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&rs(v)}r(d),je!==null&&s.add(je)}),Uu(()=>{var o=e();if(t===document.activeElement){var c=Zs??je;if(s.has(c))return}if(sc(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=rs(d),r(o))}t.__value=o,i=!1}),qd(t)}function rs(t){return"__value"in t?t.__value:t.value}const jd=Symbol("is custom element"),Bd=Symbol("is html");function ic(t,e,r,s){var i=zd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[wf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Fd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function zd(t){return t.__attributes??(t.__attributes={[jd]:t.nodeName.includes("-"),[Bd]:t.namespaceURI===yu})}var Ll=new Map;function Fd(t){var e=t.getAttribute("is")||t.nodeName,r=Ll.get(e);if(r)return r;Ll.set(e,r=[]);for(var s,i=t,o=Element.prototype;o!==i;){s=hf(i);for(var c in s)s[c].set&&r.push(c);i=fu(i)}return r}function Do(t,e,r=e){var s=new WeakSet;zu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=zi(t)?Fi(o):o,r(o),je!==null&&s.add(je),await tc(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var h=t.value.length;c===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=c,t.selectionEnd=Math.min(d,h))}}}),vs(e)==null&&t.value&&(r(zi(t)?Fi(t.value):t.value),je!==null&&s.add(je)),Eo(()=>{var i=e();if(t===document.activeElement){var o=Zs??je;if(s.has(o))return}zi(t)&&i===Fi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function zi(t){var e=t.type;return e==="number"||e==="range"}function Fi(t){return t===""?null:+t}function Nl(t,e){return t===e||(t==null?void 0:t[Xr])===e}function oc(t={},e,r,s){return Uu(()=>{var i,o;return Eo(()=>{i=o,o=[],vs(()=>{t!==r(...o)&&(e(t,...o),i&&Nl(r(...i),t)&&e(null,...i))})}),()=>{wr(()=>{o&&Nl(r(...o),t)&&e(null,...o)})}}),t}let js=!1;function Kd(t){var e=js;try{return js=!1,[t(),js]}finally{js=e}}function Pe(t,e,r,s){var re;var i=(r&zf)!==0,o=(r&Ff)!==0,c=s,d=!0,v=()=>(d&&(d=!1,c=o?vs(s):s),c),h;if(i){var y=Xr in t||_f in t;h=((re=va(t,e))==null?void 0:re.set)??(y&&e in t?J=>t[e]=J:void 0)}var _,b=!1;i?[_,b]=Kd(()=>t[e]):_=t[e],_===void 0&&s!==void 0&&(_=v(),h&&(If(),h(_)));var w;if(w=()=>{var J=t[e];return J===void 0?v():(d=!0,J)},(r&Bf)===0)return w;if(h){var D=t.$$legacy;return(function(J,U){return arguments.length>0?((!U||D||b)&&h(U?w():J),J):w()})}var j=!1,S=((r&jf)!==0?li:Pu)(()=>(j=!1,w()));i&&k(S);var F=et;return(function(J,U){if(arguments.length>0){const $=U?k(S):i?wt(J):J;return z(S,$),j=!0,c!==void 0&&(c=$),J}return Sr&&j||(F.f&tr)!==0?S.v:k(S)})}function Rt(t){tn===null&&kf(),Js(()=>{const e=vs(t);if(typeof e=="function")return e})}const Ud="5";var cu;typeof window<"u"&&((cu=window.__svelte??(window.__svelte={})).v??(cu.v=new Set)).add(Ud);const os=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Ht=null,$n="idle",Ys=null,jr=new Set;function Bs(){return Ht||(Ht=new Worker(new URL("/me-ai/assets/worker-CsGlDG0A.js",import.meta.url),{type:"module"}),Ht.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&($n="loading"),e.status==="ready"&&($n="ready"),e.status==="start"&&($n="generating"),(e.status==="complete"||e.status==="error")&&($n=Ys?"ready":"idle");for(const r of jr)try{r(e)}catch{}})),Ht}function lc(){return{check(){Bs().postMessage({type:"check"})},loadModel(t){Ys=t,$n="loading",Bs().postMessage({type:"load",modelId:t})},generate(t){Bs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let s="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":s+=c.output;break;case"complete":o(),e(s);break;case"error":o(),r(new Error(c.data));break}},o=()=>{jr.delete(i)};jr.add(i),Bs().postMessage({type:"generate",data:t})})},interrupt(){Ht==null||Ht.postMessage({type:"interrupt"})},reset(){Ht==null||Ht.postMessage({type:"reset"})},onMessage(t){return jr.add(t),()=>jr.delete(t)},offMessage(t){jr.delete(t)},get status(){return $n},get isReady(){return $n==="ready"},get isGenerating(){return $n==="generating"},get modelId(){return Ys},terminate(){Ht==null||Ht.terminate(),Ht=null,$n="idle",Ys=null,jr.clear()}}}var Gd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vs={exports:{}},Wd=Vs.exports,ql;function Yd(){return ql||(ql=1,(function(t,e){((r,s)=>{t.exports=s()})(Wd,function(){var r=function(n,a){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,a)},s=function(){return(s=Object.assign||function(n){for(var a,l=1,u=arguments.length;l<u;l++)for(var f in a=arguments[l])Object.prototype.hasOwnProperty.call(a,f)&&(n[f]=a[f]);return n}).apply(this,arguments)};function i(n,a,l){for(var u,f=0,p=a.length;f<p;f++)!u&&f in a||((u=u||Array.prototype.slice.call(a,0,f))[f]=a[f]);return n.concat(u||Array.prototype.slice.call(a))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Gd,c=Object.keys,d=Array.isArray;function v(n,a){return typeof a=="object"&&c(a).forEach(function(l){n[l]=a[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function _(n,a){return y.call(n,a)}function b(n,a){typeof a=="function"&&(a=a(h(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(a).forEach(function(l){D(n,l,a[l])})}var w=Object.defineProperty;function D(n,a,l,u){w(n,a,v(l&&_(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function j(n){return{from:function(a){return n.prototype=Object.create(a.prototype),D(n.prototype,"constructor",n),{extend:b.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,F=[].slice;function re(n,a,l){return F.call(n,a,l)}function J(n,a){return a(n)}function U(n){if(!n)throw new Error("Assertion Failed")}function $(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function le(n,a){if(typeof a=="string"&&_(n,a))return n[a];if(!a)return n;if(typeof a!="string"){for(var l=[],u=0,f=a.length;u<f;++u){var p=le(n,a[u]);l.push(p)}return l}var g,m=a.indexOf(".");return m===-1||(g=n[a.substr(0,m)])==null?void 0:le(g,a.substr(m+1))}function Z(n,a,l){if(n&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof a!="string"&&"length"in a){U(typeof l!="string"&&"length"in l);for(var u=0,f=a.length;u<f;++u)Z(n,a[u],l[u])}else{var p,g,m=a.indexOf(".");m!==-1?(p=a.substr(0,m),(m=a.substr(m+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:Z(g=(g=n[p])&&_(n,p)?g:n[p]={},m,l)):l===void 0?d(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=l}}function pe(n){var a,l={};for(a in n)_(n,a)&&(l[a]=n[a]);return l}var Me=[].concat;function _e(n){return Me.apply([],n)}var fe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_e([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(a){return a+n+"Array"})}))).filter(function(n){return o[n]}),me=new Set(fe.map(function(n){return o[n]})),ie=null;function ae(n){return ie=new WeakMap,n=(function a(l){if(!l||typeof l!="object")return l;var u=ie.get(l);if(u)return u;if(d(l)){u=[],ie.set(l,u);for(var f=0,p=l.length;f<p;++f)u.push(a(l[f]))}else if(me.has(l.constructor))u=l;else{var g,m=h(l);for(g in u=m===Object.prototype?{}:Object.create(m),ie.set(l,u),l)_(l,g)&&(u[g]=a(l[g]))}return u})(n),ie=null,n}var Le={}.toString;function W(n){return Le.call(n).slice(8,-1)}var Q=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ee=typeof Q=="symbol"?function(n){var a;return n!=null&&(a=n[Q])&&a.apply(n)}:function(){return null};function Y(n,a){a=n.indexOf(a),0<=a&&n.splice(a,1)}var ne={};function te(n){var a,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ne&&typeof n=="string")return[n];if(f=ee(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(a=n.length)!="number")return[n];for(l=new Array(a);a--;)l[a]=n[a]}}else for(a=arguments.length,l=new Array(a);a--;)l[a]=arguments[a];return l}var K=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(fe),Se={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ae(n,a){this.name=n,this.message=a}function Te(n,a){return n+". Errors: "+Object.keys(a).map(function(l){return a[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function $e(n,a,l,u){this.failures=a,this.failedKeys=u,this.successCount=l,this.message=Te(n,a)}function De(n,a){this.name="BulkError",this.failures=Object.keys(a).map(function(l){return a[l]}),this.failuresByPos=a,this.message=Te(n,this.failures)}j(Ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j($e).from(Ae),j(De).from(Ae);var tt=gt.reduce(function(n,a){return n[a]=a+"Error",n},{}),vt=Ae,ke=gt.reduce(function(n,a){var l=a+"Error";function u(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=Se[a]||l,this.inner=null)}return j(u).from(vt),n[a]=u,n},{}),Nt=(ke.Syntax=SyntaxError,ke.Type=TypeError,ke.Range=RangeError,fe.reduce(function(n,a){return n[a+"Error"]=ke[a],n},{}));fe=gt.reduce(function(n,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(n[a+"Error"]=ke[a]),n},{});function He(){}function rn(n){return n}function sa(n,a){return n==null||n===rn?a:function(l){return a(n(l))}}function qt(n,a){return function(){n.apply(this,arguments),a.apply(this,arguments)}}function Ra(n,a){return n===He?a:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?qt(u,this.onsuccess):u),f&&(this.onerror=this.onerror?qt(f,this.onerror):f),p!==void 0?p:l}}function Pa(n,a){return n===He?a:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?qt(l,this.onsuccess):l),u&&(this.onerror=this.onerror?qt(u,this.onerror):u)}}function sr(n,a){return n===He?a:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?qt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?qt(p,this.onerror):p),u===void 0?g===void 0?void 0:g:v(u,g)}}function ia(n,a){return n===He?a:function(){return a.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function ir(n,a){return n===He?a:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return a.apply(u,p)})}return a.apply(this,arguments)}}fe.ModifyError=$e,fe.DexieError=Ae,fe.BulkError=De;var Xt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Oa(n){Xt=n}var Tr={},oa=100,yn=typeof Promise>"u"?[]:(gt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[yn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(yn),gt]:[gt,h(gt),gt]),gt=yn[0],pa=yn[1],pa=pa&&pa.then,yt=gt&&gt.constructor,Ar=!!yn[2],or=function(n,a){Hn.push([n,a]),lr&&(queueMicrotask(fr),lr=!1)},la=!0,lr=!0,Dn=[],Gn=[],ur=rn,bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:He,pgp:!1,env:{},finalize:He},Ie=bt,Hn=[],bn=0,ua=[];function be(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=Ie;if(typeof n!="function"){if(n!==Tr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Wn(this,this._value)}else this._state=null,this._value=null,++a.ref,(function l(u,f){try{f(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&dr();p&&typeof p.then=="function"?l(u,function(m,C){p instanceof be?p._then(m,C):p.then(m,C)}):(u._state=!0,u._value=p,ys(u)),g&&Yn()}},Wn.bind(null,u))}catch(p){Wn(u,p)}})(this,n)}var cr={get:function(){var n=Ie,a=Pr;function l(u,f){var p=this,g=!n.global&&(n!==Ie||a!==Pr),m=g&&!wn(),C=new be(function(N,I){Da(p,new ms(T(u,n,g,m),T(f,n,g,m),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return l.prototype=Tr,l},set:function(n){D(this,"then",n&&n.prototype===Tr?cr:{get:function(){return n},set:cr.set})}};function ms(n,a,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof a=="function"?a:null,this.resolve=l,this.reject=u,this.psd=f}function Wn(n,a){var l,u;Gn.push(a),n._state===null&&(l=n._lib&&dr(),a=ur(a),n._state=!1,n._value=a,u=n,Dn.some(function(f){return f._value===u._value})||Dn.push(u),ys(n),l)&&Yn()}function ys(n){var a=n._listeners;n._listeners=[];for(var l=0,u=a.length;l<u;++l)Da(n,a[l]);var f=n._PSD;--f.ref||f.finalize(),bn===0&&(++bn,or(function(){--bn==0&&Cr()},[]))}function Da(n,a){if(n._state===null)n._listeners.push(a);else{var l=n._state?a.onFulfilled:a.onRejected;if(l===null)return(n._state?a.resolve:a.reject)(n._value);++a.psd.ref,++bn,or(ft,[l,n,a])}}function ft(n,a,l){try{var u,f=a._value;!a._state&&Gn.length&&(Gn=[]),u=Xt&&a._consoleTask?a._consoleTask.run(function(){return n(f)}):n(f),a._state||Gn.indexOf(f)!==-1||(p=>{for(var g=Dn.length;g;)if(Dn[--g]._value===p._value)return Dn.splice(g,1)})(a),l.resolve(u)}catch(p){l.reject(p)}finally{--bn==0&&Cr(),--l.psd.ref||l.psd.finalize()}}function fr(){Re(bt,function(){dr()&&Yn()})}function dr(){var n=la;return lr=la=!1,n}function Yn(){var n,a,l;do for(;0<Hn.length;)for(n=Hn,Hn=[],l=n.length,a=0;a<l;++a){var u=n[a];u[0].apply(null,u[1])}while(0<Hn.length);lr=la=!0}function Cr(){for(var n=Dn,a=(Dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),ua.slice(0)),l=a.length;l;)a[--l]()}function Ir(n){return new be(Tr,!1,n)}function nt(n,a){var l=Ie;return function(){var u=dr(),f=Ie;try{return kn(l,!0),n.apply(this,arguments)}catch(p){a&&a(p)}finally{kn(f,!1),u&&Yn()}}}b(be.prototype,{then:cr,_then:function(n,a){Da(this,new ms(null,null,n,a,Ie))},catch:function(n){var a,l;return arguments.length===1?this.then(null,n):(a=n,l=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?l:Ir)(u)}):this.then(null,function(u){return(u&&u.name===a?l:Ir)(u)}))},finally:function(n){return this.then(function(a){return be.resolve(n()).then(function(){return a})},function(a){return be.resolve(n()).then(function(){return Ir(a)})})},timeout:function(n,a){var l=this;return n<1/0?new be(function(u,f){var p=setTimeout(function(){return f(new ke.Timeout(a))},n);l.then(u,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&D(be.prototype,Symbol.toStringTag,"Dexie.Promise"),bt.env=_s(),b(be,{all:function(){var n=te.apply(null,arguments).map(Or);return new be(function(a,l){n.length===0&&a([]);var u=n.length;n.forEach(function(f,p){return be.resolve(f).then(function(g){n[p]=g,--u||a(n)},l)})})},resolve:function(n){return n instanceof be?n:n&&typeof n.then=="function"?new be(function(a,l){n.then(a,l)}):new be(Tr,!0,n)},reject:Ir,race:function(){var n=te.apply(null,arguments).map(Or);return new be(function(a,l){n.map(function(u){return be.resolve(u).then(a,l)})})},PSD:{get:function(){return Ie},set:function(n){return Ie=n}},totalEchoes:{get:function(){return Pr}},newPSD:_n,usePSD:Re,scheduler:{get:function(){return or},set:function(n){or=n}},rejectionMapper:{get:function(){return ur},set:function(n){ur=n}},follow:function(n,a){return new be(function(l,u){return _n(function(f,p){var g=Ie;g.unhandleds=[],g.onunhandled=p,g.finalize=qt(function(){var m,C=this;m=function(){C.unhandleds.length===0?f():p(C.unhandleds[0])},ua.push(function N(){m(),ua.splice(ua.indexOf(N),1)}),++bn,or(function(){--bn==0&&Cr()},[])},g.finalize),n()},a,l,u)})}}),yt&&(yt.allSettled&&D(be,"allSettled",function(){var n=te.apply(null,arguments).map(Or);return new be(function(a){n.length===0&&a([]);var l=n.length,u=new Array(l);n.forEach(function(f,p){return be.resolve(f).then(function(g){return u[p]={status:"fulfilled",value:g}},function(g){return u[p]={status:"rejected",reason:g}}).then(function(){return--l||a(u)})})})}),yt.any&&typeof AggregateError<"u"&&D(be,"any",function(){var n=te.apply(null,arguments).map(Or);return new be(function(a,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(p,g){return be.resolve(p).then(function(m){return a(m)},function(m){f[g]=m,--u||l(new AggregateError(f))})})})}),yt.withResolvers)&&(be.withResolvers=yt.withResolvers);var mt={awaits:0,echoes:0,id:0},an=0,sn=[],Rr=0,Pr=0,Ma=0;function _n(n,g,l,u){var f=Ie,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++Ma,bt.env,p.env=Ar?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},g&&v(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Re(p,n,l,u));return p.ref===0&&p.finalize(),g}function Pt(){return mt.id||(mt.id=++an),++mt.awaits,mt.echoes+=oa,mt.id}function wn(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*oa,!0)}function Or(n){return mt.echoes&&n&&n.constructor===yt?(Pt(),n.then(function(a){return wn(),a},function(a){return wn(),he(a)})):n}function bs(){var n=sn[sn.length-1];sn.pop(),kn(n,!1)}function kn(n,a){var l,u,f=Ie;(a?!mt.echoes||Rr++&&n===Ie:!Rr||--Rr&&n===Ie)||queueMicrotask(a?(function(p){++Pr,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),sn.push(Ie),kn(p,!0)}).bind(null,n):bs),n!==Ie&&(Ie=n,f===bt&&(bt.env=_s()),Ar)&&(l=bt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function _s(){var n=o.Promise;return Ar?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Re(n,a,l,u,f){var p=Ie;try{return kn(n,!0),a(l,u,f)}finally{kn(p,!1)}}function T(n,a,l,u){return typeof n!="function"?n:function(){var f=Ie;l&&Pt(),kn(a,!0);try{return n.apply(this,arguments)}finally{kn(f,!1),u&&queueMicrotask(wn)}}}function ue(n){Promise===yt&&mt.echoes===0?Rr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+pa).indexOf("[native code]")===-1&&(Pt=wn=He);var he=be.reject,Xe="ï¿¿",rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",it="String expected.",dt=[],Ut="__dbnames",Mn="readonly",Dr="readwrite";function st(n,a){return n?a?function(){return n.apply(this,arguments)&&a.apply(this,arguments)}:n:a}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mr(n){return typeof n!="string"||/\./.test(n)?function(a){return a}:function(a){return a[n]===void 0&&n in a&&delete(a=ae(a))[n],a}}function Yo(){throw ke.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function We(n,a){try{var l=Vo(n),u=Vo(a);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return a<n?1:n<a?-1:0;case"binary":for(var f=Xo(n),p=Xo(a),g=f.length,m=p.length,C=g<m?g:m,N=0;N<C;++N)if(f[N]!==p[N])return f[N]<p[N]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var I=n,E=a,P=I.length,O=E.length,R=P<O?P:O,A=0;A<R;++A){var q=We(I[A],E[A]);if(q!==0)return q}return P===O?0:P<O?-1:1}}catch{}return NaN}function Vo(n){var a=typeof n;return a=="object"&&(ArrayBuffer.isView(n)||(a=W(n))==="ArrayBuffer")?"binary":a}function Xo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ws(n,a,l){var u=n.schema.yProps;return u?(a&&0<l.numFailures&&(a=a.filter(function(f,p){return!l.failures[p]})),Promise.all(u.map(function(f){return f=f.updatesTable,a?n.db.table(f).where("k").anyOf(a).delete():n.db.table(f).clear()})).then(function(){return l})):l}Qo.prototype.execute=function(n){var a=this["@@propmod"];if(a.add!==void 0){var l=a.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(a.remove!==void 0){var u=a.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=a.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?a.replacePrefix[1]+n.substring(l.length):n};var Na=Qo;function Qo(n){this["@@propmod"]=n}function Zo(n,a){for(var l=c(a),u=l.length,f=!1,p=0;p<u;++p){var g=l[p],m=a[g],C=le(n,g);m instanceof Na?(Z(n,g,m.execute(C)),f=!0):C!==m&&(Z(n,g,m),f=!0)}return f}at.prototype._trans=function(n,a,l){var u=this._tx||Ie.trans,f=this.name,p=Xt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,E){if(E.schema[f])return a(E.idbtrans,E);throw new ke.NotFound("Table "+f+" not part of transaction")}var m=dr();try{var C=u&&u.db._novip===this.db._novip?u===Ie.trans?u._promise(n,g,l):_n(function(){return u._promise(n,g,l)},{trans:u,transless:Ie.transless||Ie}):(function N(I,E,P,O){if(I.idbdb&&(I._state.openComplete||Ie.letThrough||I._vip)){var R=I._createTransaction(E,P,I._dbSchema);try{R.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,O)})):he(A)}return R._promise(E,function(A,q){return _n(function(){return Ie.trans=R,O(A,q,R)})}).then(function(A){if(E==="readwrite")try{R.idbtrans.commit()}catch{}return E==="readonly"?A:R._completion.then(function(){return A})})}if(I._state.openComplete)return he(new ke.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return he(new ke.DatabaseClosed);I.open().catch(He)}return I._state.dbReadyPromise.then(function(){return N(I,E,P,O)})})(this.db,n,[this.name],g);return p&&(C._consoleTask=p,C=C.catch(function(N){return console.trace(N),he(N)})),C}finally{m&&Yn()}},at.prototype.get=function(n,a){var l=this;return n&&n.constructor===Object?this.where(n).first(a):n==null?he(new ke.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(a)},at.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var a=c(n);if(a.length===1)return this.where(a[0]).equals(n[a[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(N){return 0<=m.keyPath.indexOf(N)})){for(var C=0;C<a.length;++C)if(a.indexOf(m.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(m,C){return m.keyPath.length-C.keyPath.length})[0];if(l&&this.db._maxKey!==Xe)return g=l.keyPath.slice(0,a.length),this.where(g).equals(g.map(function(m){return n[m]}));!l&&Xt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function f(m,C){return We(m,C)===0}var g=a.reduce(function(I,C){var N=I[0],I=I[1],E=u[C],P=n[C];return[N||E,N||!E?st(I,E&&E.multi?function(O){return O=le(O,C),d(O)&&O.some(function(R){return f(P,R)})}:function(O){return f(P,le(O,C))}):I]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):l?this.filter(g):this.where(a).equals("")},at.prototype.filter=function(n){return this.toCollection().and(n)},at.prototype.count=function(n){return this.toCollection().count(n)},at.prototype.offset=function(n){return this.toCollection().offset(n)},at.prototype.limit=function(n){return this.toCollection().limit(n)},at.prototype.each=function(n){return this.toCollection().each(n)},at.prototype.toArray=function(n){return this.toCollection().toArray(n)},at.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},at.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},at.prototype.reverse=function(){return this.toCollection().reverse()},at.prototype.mapToClass=function(n){for(var a=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Yo&&(n=(g=>{var m=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=m}function I(){return g!==null&&g.apply(this,arguments)||this}return r(m,C),m.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),I.prototype.table=function(){return l},I})(n)),new Set),f=n.prototype;f;f=h(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function p(g){if(!g)return g;var m,C=Object.create(n.prototype);for(m in g)if(!u.has(m))try{C[m]=g[m]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},at.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},at.prototype.add=function(n,a){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Mr(p)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[g]})}).then(function(m){return m.numFailures?be.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Z(n,p,m)}catch{}return m})},at.prototype.upsert=function(n,a){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var g=p??{};return Zo(g,a),u&&Z(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[a]}}).then(function(m){return m.numFailures?be.reject(m.failures[0]):!!p})})})},at.prototype.update=function(n,a){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(a):(n=le(n,this.schema.primKey.keyPath))===void 0?he(new ke.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(a)},at.prototype.put=function(n,a){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Mr(p)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"put",values:[g],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?be.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Z(n,p,m)}catch{}return m})},at.prototype.delete=function(n){var a=this;return this._trans("readwrite",function(l){return a.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ws(a,[n],u)}).then(function(u){return u.numFailures?be.reject(u.failures[0]):void 0})})},at.prototype.clear=function(){var n=this;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"deleteRange",range:La}).then(function(l){return ws(n,null,l)})}).then(function(a){return a.numFailures?be.reject(a.failures[0]):void 0})},at.prototype.bulkGet=function(n){var a=this;return this._trans("readonly",function(l){return a.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return a.hook.reading.fire(f)})})})},at.prototype.bulkAdd=function(n,a,l){var u=this,f=Array.isArray(a)?a:void 0,p=(l=l||(f?void 0:a))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new ke.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:p}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return p?I.results:I.lastResult;throw new De("".concat(u.name,".bulkAdd(): ").concat(E," of ").concat(C," operations failed"),P)})})},at.prototype.bulkPut=function(n,a,l){var u=this,f=Array.isArray(a)?a:void 0,p=(l=l||(f?void 0:a))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new ke.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:p}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return p?I.results:I.lastResult;throw new De("".concat(u.name,".bulkPut(): ").concat(E," of ").concat(C," operations failed"),P)})})},at.prototype.bulkUpdate=function(n){var a=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var C=[],N=[],I=(n.forEach(function(E,P){var O=E.key,R=E.changes,A=m[P];if(A){for(var q=0,B=Object.keys(R);q<B.length;q++){var L=B[q],V=R[L];if(L===a.schema.primKey.keyPath){if(We(V,O)!==0)throw new ke.Constraint("Cannot update primary key in bulkUpdate()")}else Z(A,L,V)}p.push(P),C.push(O),N.push(A)}}),C.length);return l.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(E){var P=E.numFailures,O=E.failures;if(P===0)return I;for(var R=0,A=Object.keys(O);R<A.length;R++){var q,B=A[R],L=p[Number(B)];L!=null&&(q=O[B],delete O[B],O[L]=q)}throw new De("".concat(a.name,".bulkUpdate(): ").concat(P," of ").concat(I," operations failed"),O)})})})},at.prototype.bulkDelete=function(n){var a=this,l=n.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ws(a,n,f)})}).then(function(u){var f=u.numFailures,p=u.failures;if(f===0)return u.lastResult;throw new De("".concat(a.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var Jo=at;function at(){}function qa(n){function a(g,m){if(m){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return l[g].subscribe.apply(null,N),n}if(typeof g=="string")return l[g]}var l={};a.addEventType=p;for(var u=1,f=arguments.length;u<f;++u)p(arguments[u]);return a;function p(g,m,C){var N,I;if(typeof g!="object")return m=m||ia,I={subscribers:[],fire:C=C||He,subscribe:function(E){I.subscribers.indexOf(E)===-1&&(I.subscribers.push(E),I.fire=m(I.fire,E))},unsubscribe:function(E){I.subscribers=I.subscribers.filter(function(P){return P!==E}),I.fire=I.subscribers.reduce(m,C)}},l[g]=a[g]=I;c(N=g).forEach(function(E){var P=N[E];if(d(P))p(E,N[E][0],N[E][1]);else{if(P!=="asap")throw new ke.InvalidArgument("Invalid event config");var O=p(E,rn,function(){for(var R=arguments.length,A=new Array(R);R--;)A[R]=arguments[R];O.subscribers.forEach(function(q){$(function(){q.apply(null,A)})})})}})}}function ja(n,a){return j(a).from({prototype:n}),a}function ca(n,a){return!(n.filter||n.algorithm||n.or)&&(a?n.justLimit:!n.replayFilter)}function di(n,a){n.filter=st(n.filter,a)}function pi(n,a,l){var u=n.replayFilter;n.replayFilter=u?function(){return st(u(),a())}:a,n.justLimit=l&&!u}function ks(n,a){if(n.isPrimKey)return a.primaryKey;var l=a.getIndexByKeyPath(n.index);if(l)return l;throw new ke.Schema("KeyPath "+n.index+" on object store "+a.name+" is not indexed")}function $o(n,a,l){var u=ks(n,a.schema);return a.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function xs(n,a,l,u){var f,p,g=n.replayFilter?st(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(m,C,N){var I,E;g&&!g(C,N,function(P){return C.stop(P)},function(P){return C.fail(P)})||((E=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(I)),_(f,E))||(f[E]=!0,a(m,C,N))},Promise.all([n.or._iterate(p,l),el($o(n,u,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):el($o(n,u,l),st(n.algorithm,g),a,!n.keysOnly&&n.valueMapper)}function el(n,a,l,u){var f=nt(u?function(p,g,m){return l(u(p),g,m)}:l);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};a&&!a(p,function(m){return g=m},function(m){p.stop(m),g=He},function(m){p.fail(m),g=He})||f(p.value,p,function(m){return g=m}),g()})})}Qe.prototype._read=function(n,a){var l=this._ctx;return l.error?l.table._trans(null,he.bind(null,l.error)):l.table._trans("readonly",n).then(a)},Qe.prototype._write=function(n){var a=this._ctx;return a.error?a.table._trans(null,he.bind(null,a.error)):a.table._trans("readwrite",n,"locked")},Qe.prototype._addAlgorithm=function(n){var a=this._ctx;a.algorithm=st(a.algorithm,n)},Qe.prototype._iterate=function(n,a){return xs(this._ctx,n,a,this._ctx.table.core)},Qe.prototype.clone=function(n){var a=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),a._ctx=l,a},Qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Qe.prototype.each=function(n){var a=this._ctx;return this._read(function(l){return xs(a,n,l,a.table.core)})},Qe.prototype.count=function(n){var a=this;return this._read(function(l){var u,f=a._ctx,p=f.table.core;return ca(f,!0)?p.count({trans:l,query:{index:ks(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,xs(f,function(){return++u,!1},l,p).then(function(){return u}))}).then(n)},Qe.prototype.sortBy=function(n,a){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function p(C,N){return N?p(C[l[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function m(C,N){return We(p(C,f),p(N,f))*g}return this.toArray(function(C){return C.sort(m)}).then(a)},Qe.prototype.toArray=function(n){var a=this;return this._read(function(l){var u,f,p,g=a._ctx;return g.dir==="next"&&ca(g,!0)&&0<g.limit?(u=g.valueMapper,f=ks(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(p=[],xs(g,function(m){return p.push(m)},l,g.table.core).then(function(){return p}))},n)},Qe.prototype.offset=function(n){var a=this._ctx;return n<=0||(a.offset+=n,ca(a)?pi(a,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):pi(a,function(){var l=n;return function(){return--l<0}})),this},Qe.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),pi(this._ctx,function(){var a=n;return function(l,u,f){return--a<=0&&u(f),0<=a}},!0),this},Qe.prototype.until=function(n,a){return di(this._ctx,function(l,u,f){return!n(l.value)||(u(f),a)}),this},Qe.prototype.first=function(n){return this.limit(1).toArray(function(a){return a[0]}).then(n)},Qe.prototype.last=function(n){return this.reverse().first(n)},Qe.prototype.filter=function(n){var a;return di(this._ctx,function(l){return n(l.value)}),(a=this._ctx).isMatch=st(a.isMatch,n),this},Qe.prototype.and=function(n){return this.filter(n)},Qe.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Qe.prototype.desc=function(){return this.reverse()},Qe.prototype.eachKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(l,u){n(u.key,u)})},Qe.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Qe.prototype.eachPrimaryKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},Qe.prototype.keys=function(n){var a=this._ctx,l=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},Qe.prototype.primaryKeys=function(n){var a=this._ctx;if(a.dir==="next"&&ca(a,!0)&&0<a.limit)return this._read(function(u){var f=ks(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:f,range:a.range}})}).then(function(u){return u.result}).then(n);a.keysOnly=!a.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},Qe.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Qe.prototype.firstKey=function(n){return this.limit(1).keys(function(a){return a[0]}).then(n)},Qe.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Qe.prototype.distinct=function(){var n,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(n={},di(this._ctx,function(u){var u=u.primaryKey.toString(),f=_(n,u);return n[u]=!0,!f})),this},Qe.prototype.modify=function(n){var a=this,l=this._ctx;return this._write(function(u){function f(A,q){var B=q.failures;P+=A-q.numFailures;for(var L=0,V=c(B);L<V.length;L++){var se=V[L];E.push(B[se])}}var p=typeof n=="function"?n:function(A){return Zo(A,n)},g=l.table.core,I=g.schema.primaryKey,m=I.outbound,C=I.extractKey,N=200,I=a.db._options.modifyChunkSize,E=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),P=0,O=[],R=n===tl;return a.clone().primaryKeys().then(function(A){function q(L){var V=Math.min(N,A.length-L),se=A.slice(L,L+V);return(R?Promise.resolve([]):g.getMany({trans:u,keys:se,cache:"immutable"})).then(function(ve){var ge=[],oe=[],Ee=m?[]:null,xe=R?se:[];if(!R)for(var de=0;de<V;++de){var Ce=ve[de],Ye={value:ae(Ce),primKey:A[L+de]};p.call(Ye,Ye.value,Ye)!==!1&&(Ye.value==null?xe.push(A[L+de]):m||We(C(Ce),C(Ye.value))===0?(oe.push(Ye.value),m&&Ee.push(A[L+de])):(xe.push(A[L+de]),ge.push(Ye.value)))}return Promise.resolve(0<ge.length&&g.mutate({trans:u,type:"add",values:ge}).then(function(Ze){for(var qe in Ze.failures)xe.splice(parseInt(qe),1);f(ge.length,Ze)})).then(function(){return(0<oe.length||B&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Ee,values:oe,criteria:B,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<L}).then(function(Ze){return f(oe.length,Ze)})}).then(function(){return(0<xe.length||B&&R)&&g.mutate({trans:u,type:"delete",keys:xe,criteria:B,isAdditionalChunk:0<L}).then(function(Ze){return ws(l.table,xe,Ze)}).then(function(Ze){return f(xe.length,Ze)})}).then(function(){return A.length>L+V&&q(L+N)})})}var B=ca(l)&&l.limit===1/0&&(typeof n!="function"||R)&&{index:l.index,range:l.range};return q(0).then(function(){if(0<E.length)throw new $e("Error modifying one or more objects",E,P,O);return A.length})})})},Qe.prototype.delete=function(){var n=this._ctx,a=n.range;return!ca(n)||n.table.schema.yProps||!n.isPrimKey&&a.type!==3?this.modify(tl):this._write(function(l){var u=n.table.core.schema.primaryKey,f=a;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(C){var m=C.failures,C=C.numFailures;if(C)throw new $e("Could not delete some values",Object.keys(m).map(function(N){return m[N]}),p-C);return p-C})})})};var Uc=Qe;function Qe(){}var tl=function(n,a){return a.value=null};function Gc(n,a){return n<a?-1:n===a?0:1}function Hc(n,a){return a<n?-1:n===a?0:1}function Qt(n,a,l){return n=n instanceof rl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(a),n}function fa(n){return new n.Collection(n,function(){return nl("")}).limit(0)}function Ss(O,a,l,u){var f,p,g,m,C,N,I,E=l.length;if(!l.every(function(A){return typeof A=="string"}))return Qt(O,it);function P(A){f=A==="next"?function(B){return B.toUpperCase()}:function(B){return B.toLowerCase()},p=A==="next"?function(B){return B.toLowerCase()}:function(B){return B.toUpperCase()},g=A==="next"?Gc:Hc;var q=l.map(function(B){return{lower:p(B),upper:f(B)}}).sort(function(B,L){return g(B.lower,L.lower)});m=q.map(function(B){return B.upper}),C=q.map(function(B){return B.lower}),I=(N=A)==="next"?"":u}P("next");var O=new O.Collection(O,function(){return pr(m[0],C[E-1]+u)}),R=(O._ondirectionchange=function(A){P(A)},0);return O._addAlgorithm(function(A,q,B){var L=A.key;if(typeof L=="string"){var V=p(L);if(a(V,C,R))return!0;for(var se=null,ve=R;ve<E;++ve){var ge=((oe,Ee,xe,de,Ce,Ye)=>{for(var Ze=Math.min(oe.length,de.length),qe=-1,Be=0;Be<Ze;++Be){var ot=Ee[Be];if(ot!==de[Be])return Ce(oe[Be],xe[Be])<0?oe.substr(0,Be)+xe[Be]+xe.substr(Be+1):Ce(oe[Be],de[Be])<0?oe.substr(0,Be)+de[Be]+xe.substr(Be+1):0<=qe?oe.substr(0,qe)+Ee[qe]+xe.substr(qe+1):null;Ce(oe[Be],ot)<0&&(qe=Be)}return Ze<de.length&&Ye==="next"?oe+xe.substr(oe.length):Ze<oe.length&&Ye==="prev"?oe.substr(0,xe.length):qe<0?null:oe.substr(0,qe)+de[qe]+xe.substr(qe+1)})(L,V,m[ve],C[ve],g,N);ge===null&&se===null?R=ve+1:(se===null||0<g(se,ge))&&(se=ge)}q(se!==null?function(){A.continue(se+I)}:B)}return!1}),O}function pr(n,a,l,u){return{type:2,lower:n,upper:a,lowerOpen:l,upperOpen:u}}function nl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(_t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_t.prototype.between=function(n,a,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,a)||this._cmp(n,a)===0&&(l||u)&&(!l||!u)?fa(this):new this.Collection(this,function(){return pr(n,a,!l,!u)})}catch{return Qt(this,rt)}},_t.prototype.equals=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return nl(n)})},_t.prototype.above=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(n,void 0,!0)})},_t.prototype.aboveOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(n,void 0,!1)})},_t.prototype.below=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(void 0,n,!1,!0)})},_t.prototype.belowOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(void 0,n)})},_t.prototype.startsWith=function(n){return typeof n!="string"?Qt(this,it):this.between(n,n+Xe,!0,!0)},_t.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ss(this,function(a,l){return a.indexOf(l[0])===0},[n],Xe)},_t.prototype.equalsIgnoreCase=function(n){return Ss(this,function(a,l){return a===l[0]},[n],"")},_t.prototype.anyOfIgnoreCase=function(){var n=te.apply(ne,arguments);return n.length===0?fa(this):Ss(this,function(a,l){return l.indexOf(a)!==-1},n,"")},_t.prototype.startsWithAnyOfIgnoreCase=function(){var n=te.apply(ne,arguments);return n.length===0?fa(this):Ss(this,function(a,l){return l.some(function(u){return a.indexOf(u)===0})},n,Xe)},_t.prototype.anyOf=function(){var n,a,l=this,u=te.apply(ne,arguments),f=this._cmp;try{u.sort(f)}catch{return Qt(this,rt)}return u.length===0?fa(this):((n=new this.Collection(this,function(){return pr(u[0],u[u.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,u.sort(f)},a=0,n._addAlgorithm(function(p,g,m){for(var C=p.key;0<f(C,u[a]);)if(++a===u.length)return g(m),!1;return f(C,u[a])===0||(g(function(){p.continue(u[a])}),!1)}),n)},_t.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_t.prototype.noneOf=function(){var n=te.apply(ne,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Qt(this,rt)}var a=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return a.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},_t.prototype.inAnyRange=function(n,B){var l=this,u=this._cmp,f=this._ascending,p=this._descending,g=this._min,m=this._max;if(n.length===0)return fa(this);if(!n.every(function(L){return L[0]!==void 0&&L[1]!==void 0&&f(L[0],L[1])<=0}))return Qt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ke.InvalidArgument);var C=!B||B.includeLowers!==!1,N=B&&B.includeUppers===!0,I,E=f;function P(L,V){return E(L[0],V[0])}try{(I=n.reduce(function(L,V){for(var se=0,ve=L.length;se<ve;++se){var ge=L[se];if(u(V[0],ge[1])<0&&0<u(V[1],ge[0])){ge[0]=g(ge[0],V[0]),ge[1]=m(ge[1],V[1]);break}}return se===ve&&L.push(V),L},[])).sort(P)}catch{return Qt(this,rt)}var O=0,R=N?function(L){return 0<f(L,I[O][1])}:function(L){return 0<=f(L,I[O][1])},A=C?function(L){return 0<p(L,I[O][0])}:function(L){return 0<=p(L,I[O][0])},q=R,B=new this.Collection(this,function(){return pr(I[0][0],I[I.length-1][1],!C,!N)});return B._ondirectionchange=function(L){E=L==="next"?(q=R,f):(q=A,p),I.sort(P)},B._addAlgorithm(function(L,V,se){for(var ve,ge=L.key;q(ge);)if(++O===I.length)return V(se),!1;return!R(ve=ge)&&!A(ve)||(l._cmp(ge,I[O][1])===0||l._cmp(ge,I[O][0])===0||V(function(){E===f?L.continue(I[O][0]):L.continue(I[O][1])}),!1)}),B},_t.prototype.startsWithAnyOf=function(){var n=te.apply(ne,arguments);return n.every(function(a){return typeof a=="string"})?n.length===0?fa(this):this.inAnyRange(n.map(function(a){return[a,a+Xe]})):Qt(this,"startsWithAnyOf() only works with strings")};var rl=_t;function _t(){}function Ln(n){return nt(function(a){return Ba(a),n(a.target.error),!1})}function Ba(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var za="storagemutated",hi="x-storagemutated-1",hr=qa(null,za),Wc=(Nn.prototype._lock=function(){return U(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},Nn.prototype._unlock=function(){if(U(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Re(n[1],n[0])}catch{}}return this},Nn.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},Nn.prototype.create=function(n){var a=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(U(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new ke.DatabaseClosed(u);case"MissingAPIError":throw new ke.MissingAPI(u.message,u);default:throw new ke.OpenFailed(u)}if(!this.active)throw new ke.TransactionInactive;U(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=nt(function(f){Ba(f),a._reject(n.error)}),n.onabort=nt(function(f){Ba(f),a.active&&a._reject(new ke.Abort(n.error)),a.active=!1,a.on("abort").fire(f)}),n.oncomplete=nt(function(){a.active=!1,a._resolve(),"mutatedParts"in n&&hr.storagemutated.fire(n.mutatedParts)})}return this},Nn.prototype._promise=function(n,a,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?he(new ke.ReadOnly("Transaction is readonly")):this.active?this._locked()?new be(function(p,g){f._blockedFuncs.push([function(){f._promise(n,a,l).then(p,g)},Ie])}):l?_n(function(){var p=new be(function(g,m){f._lock();var C=a(g,m,f);C&&C.then&&C.then(g,m)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((u=new be(function(p,g){var m=a(p,g,f);m&&m.then&&m.then(p,g)}))._lib=!0,u):he(new ke.TransactionInactive)},Nn.prototype._root=function(){return this.parent?this.parent._root():this},Nn.prototype.waitFor=function(n){var a,l=this._root(),u=be.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],a=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(a.get(-1/0).onsuccess=p)})()),l._waitingFor);return new be(function(p,g){u.then(function(m){return l._waitingQueue.push(nt(p.bind(null,m)))},function(m){return l._waitingQueue.push(nt(g.bind(null,m)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Nn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ke.Abort))},Nn.prototype.table=function(n){var a=this._memoizedTables||(this._memoizedTables={});if(_(a,n))return a[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),a[n]=l;throw new ke.NotFound("Table "+n+" not part of transaction")},Nn);function Nn(){}function vi(n,a,l,u,f,p,g,m){return{name:n,keyPath:a,unique:l,multi:u,auto:f,compound:p,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+al(a),type:m}}function al(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function gi(n,a,l){return{name:n,primKey:a,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,p,g){return p=u(p,g),p&&(f[p[0]]=p[1]),f},{}))};var u}var Fa=function(n){try{return n.only([[]]),Fa=function(){return[[]]},[[]]}catch{return Fa=function(){return Xe},Xe}};function mi(n){return n==null?function(){}:typeof n=="string"?(a=n).split(".").length===1?function(l){return l[a]}:function(l){return le(l,a)}:function(l){return le(l,n)};var a}function sl(n){return[].slice.call(n)}var Yc=0;function Ka(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Vc(n,a,C){function u(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=R.lower,P=R.upper,O=R.lowerOpen,R=R.upperOpen;return E===void 0?P===void 0?null:a.upperBound(P,!!R):P===void 0?a.lowerBound(E,!!O):a.bound(E,P,!!O,!!R)}function f(I){var E,P=I.name;return{name:P,schema:I,mutate:function(O){var R=O.trans,A=O.type,q=O.keys,B=O.values,L=O.range;return new Promise(function(V,se){V=nt(V);var ve=R.objectStore(P),ge=ve.keyPath==null,oe=A==="put"||A==="add";if(!oe&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var Ee,xe=(q||B||{length:1}).length;if(q&&B&&q.length!==B.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function de(ct){++Ze,Ba(ct)}var Ce=[],Ye=[],Ze=0;if(A==="deleteRange"){if(L.type===4)return V({numFailures:Ze,failures:Ye,results:[],lastResult:void 0});L.type===3?Ce.push(Ee=ve.clear()):Ce.push(Ee=ve.delete(u(L)))}else{var ge=oe?ge?[B,q]:[B,null]:[q,null],qe=ge[0],Be=ge[1];if(oe)for(var ot=0;ot<xe;++ot)Ce.push(Ee=Be&&Be[ot]!==void 0?ve[A](qe[ot],Be[ot]):ve[A](qe[ot])),Ee.onerror=de;else for(ot=0;ot<xe;++ot)Ce.push(Ee=ve[A](qe[ot])),Ee.onerror=de}function on(ct){ct=ct.target.result,Ce.forEach(function(qr,Li){return qr.error!=null&&(Ye[Li]=qr.error)}),V({numFailures:Ze,failures:Ye,results:A==="delete"?q:Ce.map(function(qr){return qr.result}),lastResult:ct})}Ee.onerror=function(ct){de(ct),on(ct)},Ee.onsuccess=on})},getMany:function(O){var R=O.trans,A=O.keys;return new Promise(function(q,B){q=nt(q);for(var L,V=R.objectStore(P),se=A.length,ve=new Array(se),ge=0,oe=0,Ee=function(Ce){Ce=Ce.target,ve[Ce._pos]=Ce.result,++oe===ge&&q(ve)},xe=Ln(B),de=0;de<se;++de)A[de]!=null&&((L=V.get(A[de]))._pos=de,L.onsuccess=Ee,L.onerror=xe,++ge);ge===0&&q(ve)})},get:function(O){var R=O.trans,A=O.key;return new Promise(function(q,B){q=nt(q);var L=R.objectStore(P).get(A);L.onsuccess=function(V){return q(V.target.result)},L.onerror=Ln(B)})},query:(E=m,function(O){return new Promise(function(R,A){R=nt(R);var q,B,L,oe=O.trans,V=O.values,se=O.limit,ge=O.query,ve=se===1/0?void 0:se,Ee=ge.index,ge=ge.range,oe=oe.objectStore(P),oe=Ee.isPrimaryKey?oe:oe.index(Ee.name),Ee=u(ge);if(se===0)return R({result:[]});E?((ge=V?oe.getAll(Ee,ve):oe.getAllKeys(Ee,ve)).onsuccess=function(xe){return R({result:xe.target.result})},ge.onerror=Ln(A)):(q=0,B=!V&&"openKeyCursor"in oe?oe.openKeyCursor(Ee):oe.openCursor(Ee),L=[],B.onsuccess=function(xe){var de=B.result;return!de||(L.push(V?de.value:de.primaryKey),++q===se)?R({result:L}):void de.continue()},B.onerror=Ln(A))})}),openCursor:function(O){var R=O.trans,A=O.values,q=O.query,B=O.reverse,L=O.unique;return new Promise(function(V,se){V=nt(V);var oe=q.index,ve=q.range,ge=R.objectStore(P),ge=oe.isPrimaryKey?ge:ge.index(oe.name),oe=B?L?"prevunique":"prev":L?"nextunique":"next",Ee=!A&&"openKeyCursor"in ge?ge.openKeyCursor(u(ve),oe):ge.openCursor(u(ve),oe);Ee.onerror=Ln(se),Ee.onsuccess=nt(function(xe){var de,Ce,Ye,Ze,qe=Ee.result;qe?(qe.___id=++Yc,qe.done=!1,de=qe.continue.bind(qe),Ce=(Ce=qe.continuePrimaryKey)&&Ce.bind(qe),Ye=qe.advance.bind(qe),Ze=function(){throw new Error("Cursor not stopped")},qe.trans=R,qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=function(){throw new Error("Cursor not started")},qe.fail=nt(se),qe.next=function(){var Be=this,ot=1;return this.start(function(){return ot--?Be.continue():Be.stop()}).then(function(){return Be})},qe.start=function(Be){function ot(){if(Ee.result)try{Be()}catch(ct){qe.fail(ct)}else qe.done=!0,qe.start=function(){throw new Error("Cursor behind last entry")},qe.stop()}var on=new Promise(function(ct,qr){ct=nt(ct),Ee.onerror=Ln(qr),qe.fail=qr,qe.stop=function(Li){qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=Ze,ct(Li)}});return Ee.onsuccess=nt(function(ct){Ee.onsuccess=ot,ot()}),qe.continue=de,qe.continuePrimaryKey=Ce,qe.advance=Ye,ot(),on},V(qe)):V(null)},se)})},count:function(O){var R=O.query,A=O.trans,q=R.index,B=R.range;return new Promise(function(L,V){var se=A.objectStore(P),se=q.isPrimaryKey?se:se.index(q.name),ve=u(B),ve=ve?se.count(ve):se.count();ve.onsuccess=nt(function(ge){return L(ge.target.result)}),ve.onerror=Ln(V)})}}}p=C,g=sl((C=n).objectStoreNames);var p,C={schema:{name:C.name,tables:g.map(function(I){return p.objectStore(I)}).map(function(I){var E=I.keyPath,P=I.autoIncrement,R=d(E),O={},R={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:R,keyPath:E,autoIncrement:P,unique:!0,extractKey:mi(E)},indexes:sl(I.indexNames).map(function(A){return I.index(A)}).map(function(L){var V=L.name,q=L.unique,B=L.multiEntry,L=L.keyPath,V={name:V,compound:d(L),keyPath:L,unique:q,multiEntry:B,extractKey:mi(L)};return O[Ka(L)]=V}),getIndexByKeyPath:function(A){return O[Ka(A)]}};return O[":id"]=R.primaryKey,E!=null&&(O[Ka(E)]=R.primaryKey),R})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,m=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Fa(a),schema:g}}function Xc(n,a,l,u){return l=l.IDBKeyRange,a=Vc(a,l,u),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,s(s({},f),p(f))},a)}}function Es(n,a){var l=a.db,l=Xc(n._middlewares,l,n._deps,a);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(p){return p.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function Ts(n,a,l,u){l.forEach(function(f){var p=u[f];a.forEach(function(g){var m=(function C(N,I){return S(N,I)||(N=h(N))&&C(N,I)})(g,f);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?D(g,f,{get:function(){return this.table(f)},set:function(C){w(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function yi(n,a){a.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function Qc(n,a){return n._cfg.version-a._cfg.version}function Zc(n,a,l,u){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=gi("$meta",ol("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(l),p._completion.catch(u),p._reject.bind(p)),m=Ie.transless||Ie;_n(function(){if(Ie.trans=p,Ie.transless=m,a!==0)return Es(n,l),N=a,((C=p).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):be.resolve(N)).then(function(q){var E=n,P=q,O=p,R=l,A=[],q=E._versions,B=E._dbSchema=Cs(0,E.idbdb,R);return(q=q.filter(function(L){return L._cfg.version>=P})).length===0?be.resolve():(q.forEach(function(L){A.push(function(){var V,se,ve,ge=B,oe=L._cfg.dbschema,Ee=(Is(E,ge,R),Is(E,oe,R),B=E._dbSchema=oe,bi(ge,oe)),xe=(Ee.add.forEach(function(de){_i(R,de[0],de[1].primKey,de[1].indexes)}),Ee.change.forEach(function(de){if(de.recreate)throw new ke.Upgrade("Not yet support for changing primary key");var Ce=R.objectStore(de.name);de.add.forEach(function(Ye){return As(Ce,Ye)}),de.change.forEach(function(Ye){Ce.deleteIndex(Ye.name),As(Ce,Ye)}),de.del.forEach(function(Ye){return Ce.deleteIndex(Ye)})}),L._cfg.contentUpgrade);if(xe&&L._cfg.version>P)return Es(E,R),O._memoizedTables={},V=pe(oe),Ee.del.forEach(function(de){V[de]=ge[de]}),yi(E,[E.Transaction.prototype]),Ts(E,[E.Transaction.prototype],c(V),V),O.schema=V,(se=K(xe))&&Pt(),oe=be.follow(function(){var de;(ve=xe(O))&&se&&(de=wn.bind(null,null),ve.then(de,de))}),ve&&typeof ve.then=="function"?be.resolve(ve):oe.then(function(){return ve})}),A.push(function(V){var se,ve,ge=L._cfg.dbschema;se=ge,ve=V,[].slice.call(ve.db.objectStoreNames).forEach(function(oe){return se[oe]==null&&ve.db.deleteObjectStore(oe)}),yi(E,[E.Transaction.prototype]),Ts(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),O.schema=E._dbSchema}),A.push(function(V){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===L._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(se){return se!=="$meta"})):V.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return A.length?be.resolve(A.shift()(O.idbtrans)).then(L):be.resolve()})().then(function(){il(B,R)}))}).catch(g);var C,N;c(f).forEach(function(I){_i(l,I,f[I].primKey,f[I].indexes)}),Es(n,l),be.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function Jc(n,a){il(n._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var l=Cs(0,n.idbdb,a);Is(n,n._dbSchema,a);for(var u=0,f=bi(l,n._dbSchema).change;u<f.length;u++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(g.name);g.add.forEach(function(C){Xt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),As(m,C)})})(f[u]);if(typeof p=="object")return p.value}}function bi(n,a){var l,u={del:[],add:[],change:[]};for(l in n)a[l]||u.del.push(l);for(l in a){var f=n[l],p=a[l];if(f){var g={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=f.idxByName,C=p.idxByName,N=void 0;for(N in m)C[N]||g.del.push(N);for(N in C){var I=m[N],E=C[N];I?I.src!==E.src&&g.change.push(E):g.add.push(E)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,p])}return u}function _i(n,a,l,u){var f=n.db.createObjectStore(a,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(p){return As(f,p)})}function il(n,a){c(n).forEach(function(l){a.db.objectStoreNames.contains(l)||(Xt&&console.debug("Dexie: Creating missing table",l),_i(a,l,n[l].primKey,n[l].indexes))})}function As(n,a){n.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function Cs(n,a,l){var u={};return re(a.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),g=vi(al(N=p.keyPath),N||"",!0,!1,!!p.autoIncrement,N&&typeof N!="string",!0),m=[],C=0;C<p.indexNames.length;++C){var I=p.index(p.indexNames[C]),N=I.keyPath,I=vi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);m.push(I)}u[f]=gi(f,g,m)}),u}function Is(n,a,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var p=u[f],g=l.objectStore(p);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var C,N=g.indexNames[m],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+re(I).join("+")+"]";a[p]&&(C=a[p].idxByName[I])&&(C.name=N,delete a[p].idxByName[I],a[p].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ol(n){return n.split(",").map(function(a,l){var f=a.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(a=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return vi(f,p||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),d(p),l===0,u)})}da.prototype._createTableSchema=gi,da.prototype._parseIndexSyntax=ol,da.prototype._parseStoresSpec=function(n,a){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),p=f.shift();if(!p)throw new ke.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new ke.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new ke.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ke.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(u,p,f),a[u]=p}})},da.prototype.stores=function(l){var a=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,a._versions),u={},f={};return l.forEach(function(p){v(u,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(u,f)}),a._dbSchema=f,yi(a,[a._allTables,a,a.Transaction.prototype]),Ts(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],c(f),f),a._storeNames=c(f),this},da.prototype.upgrade=function(n){return this._cfg.contentUpgrade=ir(this._cfg.contentUpgrade||He,n),this};var $c=da;function da(){}function wi(n,a){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new Vn(Ut,{addons:[],indexedDB:n,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function ki(n){return n&&typeof n.databases=="function"}function xi(n){return _n(function(){return Ie.letThrough=!0,n()})}function Si(n){return!("from"in n)}var Ot=function(n,a){var l;if(!this)return l=new Ot,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?a:n}:{d:0})};function Ua(n,a,l){var u=We(a,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Si(n))return v(n,{from:a,to:l,d:1});var u=n.l,f=n.r;if(We(l,n.from)<0)return u?Ua(u,a,l):n.l={from:a,to:l,d:1,l:null,r:null},ul(n);if(0<We(a,n.to))return f?Ua(f,a,l):n.r={from:a,to:l,d:1,l:null,r:null},ul(n);We(a,n.from)<0&&(n.from=a,n.l=null,n.d=f?f.d+1:1),0<We(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,u&&!n.l&&Ga(n,u),f&&a&&Ga(n,f)}}function Ga(n,a){Si(a)||(function l(u,f){var p=f.from,g=f.l,m=f.r;Ua(u,p,f.to),g&&l(u,g),m&&l(u,m)})(n,a)}function ll(n,a){var l=Rs(a),u=l.next();if(!u.done)for(var f=u.value,p=Rs(n),g=p.next(f.from),m=g.value;!u.done&&!g.done;){if(We(m.from,f.to)<=0&&0<=We(m.to,f.from))return!0;We(f.from,m.from)<0?f=(u=l.next(m.from)).value:m=(g=p.next(f.from)).value}return!1}function Rs(n){var a=Si(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&We(l,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||We(l,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function ul(n){var a,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(a=f=="r"?"l":"r",l=s({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[a],(n[a]=l).d=cl(l)),n.d=cl(n)}function cl(l){var a=l.r,l=l.l;return(a?l?Math.max(a.d,l.d):a.d:l?l.d:0)+1}function Ps(n,a){return c(a).forEach(function(l){n[l]?Ga(n[l],a[l]):n[l]=(function u(f){var p,g,m={};for(p in f)_(f,p)&&(g=f[p],m[p]=!g||typeof g!="object"||me.has(g.constructor)?g:u(g));return m})(a[l])}),n}function Ei(n,a){return n.all||a.all||Object.keys(n).some(function(l){return a[l]&&ll(a[l],n[l])})}b(Ot.prototype,((gt={add:function(n){return Ga(this,n),this},addKey:function(n){return Ua(this,n,n),this},addKeys:function(n){var a=this;return n.forEach(function(l){return Ua(a,l,l)}),this},hasKey:function(n){var a=Rs(this).next(n).value;return a&&We(a.from,n)<=0&&0<=We(a.to,n)}})[Q]=function(){return Rs(this)},gt));var Lr={},Ti={},Ai=!1;function Os(n){Ps(Ti,n),Ai||(Ai=!0,setTimeout(function(){Ai=!1,Ci(Ti,!(Ti={}))},0))}function Ci(n,a){a===void 0&&(a=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Lr);u<f.length;u++)fl(m=f[u],n,l,a);else for(var p in n){var g,m,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],m=Lr["idb://".concat(g,"/").concat(p)])&&fl(m,n,l,a)}l.forEach(function(C){return C()})}function fl(n,a,l,u){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var m=g[p],C=m[0],N=[],I=0,E=m[1];I<E.length;I++){var P=E[I];Ei(a,P.obsSet)?P.subscribers.forEach(function(q){return l.add(q)}):u&&N.push(P)}u&&f.push([C,N])}if(u)for(var O=0,R=f;O<R.length;O++){var A=R[O],C=A[0],N=A[1];n.queries.query[C]=N}}function ef(n){var a=n._state,l=n._deps.indexedDB;if(a.isBeingOpened||n.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?he(a.dbOpenError):n});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(a.openCanceller!==u)throw new ke.DatabaseClosed("db.open() was cancelled")}function m(){return new be(function(P,O){if(g(),!l)throw new ke.MissingAPI;var R=n.name,A=a.autoSchema||!f?l.open(R):l.open(R,f);if(!A)throw new ke.MissingAPI;A.onerror=Ln(O),A.onblocked=nt(n._fireOnBlocked),A.onupgradeneeded=nt(function(q){var B;I=A.transaction,a.autoSchema&&!n._options.allowEmptyDB?(A.onerror=Ba,I.abort(),A.result.close(),(B=l.deleteDatabase(R)).onsuccess=B.onerror=nt(function(){O(new ke.NoSuchDatabase("Database ".concat(R," doesnt exist")))})):(I.onerror=Ln(O),B=q.oldVersion>Math.pow(2,62)?0:q.oldVersion,E=B<1,n.idbdb=A.result,p&&Jc(n,I),Zc(n,B/10,I,O))},O),A.onsuccess=nt(function(){I=null;var q,B,L,V,se,ve,ge=n.idbdb=A.result,oe=re(ge.objectStoreNames);if(0<oe.length)try{var Ee=ge.transaction((se=oe).length===1?se[0]:se,"readonly");if(a.autoSchema)ve=ge,V=Ee,(L=n).verno=ve.version/10,V=L._dbSchema=Cs(0,ve,V),L._storeNames=re(ve.objectStoreNames,0),Ts(L,[L._allTables],c(V),V);else if(Is(n,n._dbSchema,Ee),B=Ee,((B=bi(Cs(0,(q=n).idbdb,B),q._dbSchema)).add.length||B.change.some(function(xe){return xe.add.length||xe.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ge.close(),f=ge.version+1,p=!0,P(m());Es(n,Ee)}catch{}dt.push(n),ge.onversionchange=nt(function(xe){a.vcFired=!0,n.on("versionchange").fire(xe)}),ge.onclose=nt(function(){n.close({disableAutoOpen:!1})}),E&&(oe=n._deps,se=R,ki(ve=oe.indexedDB)||se===Ut||wi(ve,oe.IDBKeyRange).put({name:se}).catch(He)),P()},O)}).catch(function(P){switch(P==null?void 0:P.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<f)return f=0,m()}return be.reject(P)})}var C,N=a.dbReadyResolve,I=null,E=!1;return be.race([u,(typeof navigator>"u"?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function O(){return indexedDB.databases().finally(P)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(m)]).then(function(){return g(),a.onReadyBeingFired=[],be.resolve(xi(function(){return n.on.ready.fire(n.vip)})).then(function P(){var O;if(0<a.onReadyBeingFired.length)return O=a.onReadyBeingFired.reduce(ir,He),a.onReadyBeingFired=[],be.resolve(xi(function(){return O(n.vip)})).then(P)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(P){a.dbOpenError=P;try{I&&I.abort()}catch{}return u===a.openCanceller&&n._close(),he(P)}).finally(function(){a.openComplete=!0,N()}).then(function(){var P;return E&&(P={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(R){R.name&&(P["idb://".concat(n.name,"/").concat(O.name,"/").concat(R.name)]=new Ot(-1/0,[[[]]]))}),P["idb://".concat(n.name,"/").concat(O.name,"/")]=P["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Ot(-1/0,[[[]]])}),hr(za).fire(P),Ci(P,!0)),n})}function Ii(n){function a(p){return n.next(p)}var l=f(a),u=f(function(p){return n.throw(p)});function f(p){return function(m){var m=p(m),C=m.value;return m.done?C:C&&typeof C.then=="function"?C.then(l,u):d(C)?Promise.all(C).then(l,u):l(C)}}return f(a)()}function Ds(n,a,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(a);return u}var tf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return s(s({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},p=[];function g(P,O,R){var L=Ka(P),A=f[L]=f[L]||[],q=P==null?0:typeof P=="string"?1:P.length,B=0<O,L=s(s({},R),{name:B?"".concat(L,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:B,keyTail:O,keyLength:q,extractKey:mi(P),unique:!B&&R.unique});return A.push(L),L.isPrimaryKey||p.push(L),1<q&&g(q===2?P[0]:P.slice(0,q-1),O+1,R),A.sort(function(V,se){return V.keyTail-se.keyTail}),L}var m=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[m];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function E(P){var O,R=P.query.index;return R.isVirtual?s(s({},P),{query:{index:R.lowLevelIndex,range:(O=P.query.range,R=R.keyTail,{type:O.type===1?2:O.type,lower:Ds(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,R),lowerOpen:!0,upper:Ds(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,R),upperOpen:!0})}}):P}return s(s({},l),{schema:s(s({},u),{primaryKey:m,indexes:p,getIndexByKeyPath:function(P){return(P=f[Ka(P)])&&P[0]}}),count:function(P){return l.count(E(P))},query:function(P){return l.query(E(P))},openCursor:function(P){var O=P.query.index,R=O.keyTail,A=O.keyLength;return O.isVirtual?l.openCursor(E(P)).then(function(B){return B&&q(B)}):l.openCursor(P);function q(B){return Object.create(B,{continue:{value:function(L){L!=null?B.continue(Ds(L,P.reverse?n.MAX_KEY:n.MIN_KEY,R)):P.unique?B.continue(B.key.slice(0,A).concat(P.reverse?n.MIN_KEY:n.MAX_KEY,R)):B.continue()}},continuePrimaryKey:{value:function(L,V){B.continuePrimaryKey(Ds(L,n.MAX_KEY,R),V)}},primaryKey:{get:function(){return B.primaryKey}},key:{get:function(){var L=B.key;return A===1?L[0]:L.slice(0,A)}},value:{get:function(){return B.value}}})}}})}})}};function Ri(n,a,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var p,g,m;_(a,f)?(p=n[f],g=a[f],typeof p=="object"&&typeof g=="object"&&p&&g?(m=W(p))!==W(g)?l[u+f]=a[f]:m==="Object"?Ri(p,g,l,u+f+"."):p!==g&&(l[u+f]=a[f]):p!==g&&(l[u+f]=a[f])):l[u+f]=void 0}),c(a).forEach(function(f){_(n,f)||(l[u+f]=a[f])}),l}function Pi(n,a){return a.type==="delete"?a.keys:a.keys||a.values.map(n.extractKey)}var nf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return s(s({},n),{table:function(a){var l=n.table(a),u=l.schema.primaryKey;return s(s({},l),{mutate:function(f){var p=Ie.trans,g=p.table(a).hook,m=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===He&&N.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"delete":if(m.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(m.fire===He)break;return p._promise("readwrite",function(){return(function E(P,O,R){return l.query({trans:P,values:!1,query:{index:u,range:O},limit:R}).then(function(A){var q=A.result;return I({type:"delete",keys:q,trans:P}).then(function(B){return 0<B.numFailures?Promise.reject(B.failures[0]):q.length<R?{failures:[],numFailures:0,lastResult:void 0}:E(P,s(s({},O),{lower:q[q.length-1],lowerOpen:!0}),R)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function I(E){var P,O,R,A=Ie.trans,q=E.keys||Pi(u,E);if(q)return(E=E.type==="add"||E.type==="put"?s(s({},E),{keys:q}):s({},E)).type!=="delete"&&(E.values=i([],E.values)),E.keys&&(E.keys=i([],E.keys)),P=l,R=q,((O=E).type==="add"?Promise.resolve([]):P.getMany({trans:O.trans,keys:R,cache:"immutable"})).then(function(B){var L=q.map(function(V,se){var ve,ge,oe,Ee=B[se],xe={onerror:null,onsuccess:null};return E.type==="delete"?m.fire.call(xe,V,Ee,A):E.type==="add"||Ee===void 0?(ve=C.fire.call(xe,V,E.values[se],A),V==null&&ve!=null&&(E.keys[se]=V=ve,u.outbound||Z(E.values[se],u.keyPath,V))):(ve=Ri(Ee,E.values[se]),(ge=N.fire.call(xe,ve,V,Ee,A))&&(oe=E.values[se],Object.keys(ge).forEach(function(de){_(oe,de)?oe[de]=ge[de]:Z(oe,de,ge[de])}))),xe});return l.mutate(E).then(function(V){for(var se=V.failures,ve=V.results,ge=V.numFailures,V=V.lastResult,oe=0;oe<q.length;++oe){var Ee=(ve||q)[oe],xe=L[oe];Ee==null?xe.onerror&&xe.onerror(se[oe]):xe.onsuccess&&xe.onsuccess(E.type==="put"&&B[oe]?E.values[oe]:Ee)}return{failures:se,results:ve,numFailures:ge,lastResult:V}}).catch(function(V){return L.forEach(function(se){return se.onerror&&se.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function dl(n,a,l){try{if(!a||a.keys.length<n.length)return null;for(var u=[],f=0,p=0;f<a.keys.length&&p<n.length;++f)We(a.keys[f],n[p])===0&&(u.push(l?ae(a.values[f]):a.values[f]),++p);return u.length===n.length?u:null}catch{return null}}var rf={stack:"dbcore",level:-1,create:function(n){return{table:function(a){var l=n.table(a);return s(s({},l),{getMany:function(u){var f;return u.cache?(f=dl(u.keys,u.trans._cache,u.cache==="clone"))?be.resolve(f):l.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ae(p):p},p}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function pl(n,a){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function hl(n,a){switch(n){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var af={stack:"dbcore",level:0,name:"Observability",create:function(n){var a=n.schema.name,l=new Ot(n.MIN_KEY,n.MAX_KEY);return s(s({},n),{transaction:function(u,f,p){if(Ie.subscr&&f!=="readonly")throw new ke.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return n.transaction(u,f,p)},table:function(u){function f(q){var A,q=q.query;return[A=q.index,new Ot((A=(q=q.range).lower)!=null?A:n.MIN_KEY,(A=q.upper)!=null?A:n.MAX_KEY)]}var p=n.table(u),g=p.schema,m=g.primaryKey,C=g.indexes,N=m.extractKey,I=m.outbound,E=m.autoIncrement&&C.filter(function(R){return R.compound&&R.keyPath.includes(m.keyPath)}),P=s(s({},p),{mutate:function(R){function A(Ce){return Ce="idb://".concat(a,"/").concat(u,"/").concat(Ce),se[Ce]||(se[Ce]=new Ot)}var q,B,L,V=R.trans,se=R.mutatedParts||(R.mutatedParts={}),ve=A(""),ge=A(":dels"),oe=R.type,xe=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Pi(m,R).filter(function(Ce){return Ce}),R.values]:[],Ee=xe[0],xe=xe[1],de=R.trans._cache;return d(Ee)?(ve.addKeys(Ee),(oe=oe==="delete"||Ee.length===xe.length?dl(Ee,de):null)||ge.addKeys(Ee),(oe||xe)&&(q=A,B=oe,L=xe,g.indexes.forEach(function(Ce){var Ye=q(Ce.name||"");function Ze(Be){return Be!=null?Ce.extractKey(Be):null}function qe(Be){Ce.multiEntry&&d(Be)?Be.forEach(function(ot){return Ye.addKey(ot)}):Ye.addKey(Be)}(B||L).forEach(function(Be,ct){var on=B&&Ze(B[ct]),ct=L&&Ze(L[ct]);We(on,ct)!==0&&(on!=null&&qe(on),ct!=null)&&qe(ct)})}))):Ee?(xe={from:(de=Ee.lower)!=null?de:n.MIN_KEY,to:(oe=Ee.upper)!=null?oe:n.MAX_KEY},ge.add(xe),ve.add(xe)):(ve.add(l),ge.add(l),g.indexes.forEach(function(Ce){return A(Ce.name).add(l)})),p.mutate(R).then(function(Ce){return!Ee||R.type!=="add"&&R.type!=="put"||(ve.addKeys(Ce.results),E&&E.forEach(function(Ye){for(var Ze=R.values.map(function(on){return Ye.extractKey(on)}),qe=Ye.keyPath.findIndex(function(on){return on===m.keyPath}),Be=0,ot=Ce.results.length;Be<ot;++Be)Ze[Be][qe]=Ce.results[Be];A(Ye.name).addKeys(Ze)})),V.mutatedParts=Ps(V.mutatedParts||{},se),Ce})}}),O={get:function(R){return[m,new Ot(R.key)]},getMany:function(R){return[m,new Ot().addKeys(R.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(R){P[R]=function(A){var q=Ie.subscr,B=!!q,L=pl(Ie,p)&&hl(R,A)?A.obsSet={}:q;if(B){var V,q=function(xe){return xe="idb://".concat(a,"/").concat(u,"/").concat(xe),L[xe]||(L[xe]=new Ot)},se=q(""),ve=q(":dels"),B=O[R](A),ge=B[0],B=B[1];if((R==="query"&&ge.isPrimaryKey&&!A.values?ve:q(ge.name||"")).add(B),!ge.isPrimaryKey){if(R!=="count")return V=R==="query"&&I&&A.values&&p.query(s(s({},A),{values:!1})),p[R].apply(this,arguments).then(function(xe){if(R==="query"){if(I&&A.values)return V.then(function(Ze){return Ze=Ze.result,se.addKeys(Ze),xe});var de=A.values?xe.result.map(N):xe.result;(A.values?se:ve).addKeys(de)}else{var Ce,Ye;if(R==="openCursor")return Ye=A.values,(Ce=xe)&&Object.create(Ce,{key:{get:function(){return ve.addKey(Ce.primaryKey),Ce.key}},primaryKey:{get:function(){var Ze=Ce.primaryKey;return ve.addKey(Ze),Ze}},value:{get:function(){return Ye&&se.addKey(Ce.primaryKey),Ce.value}}})}return xe});ve.add(l)}}return p[R].apply(this,arguments)}}),P}})}};function vl(n,a,l){var u;return l.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,l.numFailures===u)?null:(u=s({},a),d(u.keys)&&(u.keys=u.keys.filter(function(f,p){return!(p in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,p){return!(p in l.failures)})),u)}function Oi(n,a){return l=n,((u=a).lower===void 0||(u.lowerOpen?0<We(l,u.lower):0<=We(l,u.lower)))&&(l=n,(u=a).upper===void 0||(u.upperOpen?We(l,u.upper)<0:We(l,u.upper)<=0));var l,u}function gl(n,a,l,u,f,p){var g,m,C,N,I,E;return!l||l.length===0||(g=a.query.index,m=g.multiEntry,C=a.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,E=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(P,O){var R=P,A=[];if(O.type==="add"||O.type==="put")for(var q=new Ot,B=O.values.length-1;0<=B;--B){var L,V=O.values[B],se=N(V);!q.hasKey(se)&&(L=I(V),m&&d(L)?L.some(function(xe){return Oi(xe,C)}):Oi(L,C))&&(q.addKey(se),A.push(V))}switch(O.type){case"add":var ve=new Ot().addKeys(a.values?P.map(function(de){return N(de)}):P),R=P.concat(a.values?A.filter(function(de){return de=N(de),!ve.hasKey(de)&&(ve.addKey(de),!0)}):A.map(function(de){return N(de)}).filter(function(de){return!ve.hasKey(de)&&(ve.addKey(de),!0)}));break;case"put":var ge=new Ot().addKeys(O.values.map(function(de){return N(de)}));R=P.filter(function(de){return!ge.hasKey(a.values?N(de):de)}).concat(a.values?A:A.map(function(de){return N(de)}));break;case"delete":var oe=new Ot().addKeys(O.keys);R=P.filter(function(de){return!oe.hasKey(a.values?N(de):de)});break;case"deleteRange":var Ee=O.range;R=P.filter(function(de){return!Oi(N(de),Ee)})}return R},n))===n)?n:(u.sort(function(P,O){return We(E(P),E(O))||We(N(P),N(O))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:n.length===a.limit&&u.length<a.limit&&(f.dirty=!0)),p?Object.freeze(u):u)}function ml(n,a){return We(n.lower,a.lower)===0&&We(n.upper,a.upper)===0&&!!n.lowerOpen==!!a.lowerOpen&&!!n.upperOpen==!!a.upperOpen}function sf(n,a){return((l,u,f,p)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=We(l,u))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,a.lower,n.lowerOpen,a.lowerOpen)<=0&&0<=((l,u,f,p)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=We(l,u))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,a.upper,n.upperOpen,a.upperOpen)}function of(n,a,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=a,setTimeout(function(){f.subscribers.size===0&&Y(p,f)},3e3))})}var lf={stack:"dbcore",level:0,name:"Cache",create:function(n){var a=n.schema.name;return s(s({},n),{transaction:function(l,u,f){var p,g,m=n.transaction(l,u,f);return u==="readwrite"&&(f=(p=new AbortController).signal,m.addEventListener("abort",(g=function(C){return function(){if(p.abort(),u==="readwrite"){for(var N=new Set,I=0,E=l;I<E.length;I++){var P=E[I],O=Lr["idb://".concat(a,"/").concat(P)];if(O){var R=n.table(P),A=O.optimisticOps.filter(function(Ce){return Ce.trans===m});if(m._explicit&&C&&m.mutatedParts)for(var q=0,B=Object.values(O.queries.query);q<B.length;q++)for(var L=0,V=(ge=B[q]).slice();L<V.length;L++)Ei((oe=V[L]).obsSet,m.mutatedParts)&&(Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Ce){return Ce.trans!==m});for(var se=0,ve=Object.values(O.queries.query);se<ve.length;se++)for(var ge,oe,Ee,xe=0,de=(ge=ve[se]).slice();xe<de.length;xe++)(oe=de[xe]).res!=null&&m.mutatedParts&&(C&&!oe.dirty?(Ee=Object.isFrozen(oe.res),Ee=gl(oe.res,oe.req,A,R,oe,Ee),oe.dirty?(Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)})):Ee!==oe.res&&(oe.res=Ee,oe.promise=be.resolve({result:Ee}))):(oe.dirty&&Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)})))}}}N.forEach(function(Ce){return Ce()})}}})(!1),{signal:f}),m.addEventListener("error",g(!1),{signal:f}),m.addEventListener("complete",g(!0),{signal:f})),m},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return s(s({},u),{mutate:function(p){var g,m=Ie.trans;return!f.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Lr["idb://".concat(a,"/").concat(l)])?(m=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Pi(f,p).some(function(C){return C==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Os(p.mutatedParts),m.then(function(C){0<C.numFailures&&(Y(g.optimisticOps,p),(C=vl(0,p,C))&&g.optimisticOps.push(C),p.mutatedParts)&&Os(p.mutatedParts)}),m.catch(function(){Y(g.optimisticOps,p),p.mutatedParts&&Os(p.mutatedParts)})):m.then(function(C){var N=vl(0,s(s({},p),{values:p.values.map(function(I,E){var P;return C.failures[E]?I:(Z(P=(P=f.keyPath)!=null&&P.includes(".")?ae(I):s({},I),f.keyPath,C.results[E]),P)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return p.mutatedParts&&Os(p.mutatedParts)})}),m):u.mutate(p)},query:function(p){var g,m,C,N,I,E,P;return pl(Ie,u)&&hl("query",p)?(g=((C=Ie.trans)==null?void 0:C.db._options.cache)==="immutable",m=(C=Ie).requery,C=C.signal,E=((O,R,A,q)=>{var B=Lr["idb://".concat(O,"/").concat(R)];if(!B)return[];if(!(O=B.queries[A]))return[null,!1,B,null];var L=O[(q.query?q.query.index.name:null)||""];if(!L)return[null,!1,B,null];switch(A){case"query":var V=L.find(function(se){return se.req.limit===q.limit&&se.req.values===q.values&&ml(se.req.query.range,q.query.range)});return V?[V,!0,B,L]:[L.find(function(se){return("limit"in se.req?se.req.limit:1/0)>=q.limit&&(!q.values||se.req.values)&&sf(se.req.query.range,q.query.range)}),!1,B,L];case"count":return V=L.find(function(se){return ml(se.req.query.range,q.query.range)}),[V,!!V,B,L]}})(a,l,"query",p),P=E[0],N=E[2],I=E[3],P&&E[1]?P.obsSet=p.obsSet:(E=u.query(p).then(function(O){var R=O.result;if(P&&(P.res=R),g){for(var A=0,q=R.length;A<q;++A)Object.freeze(R[A]);Object.freeze(R)}else O.result=ae(R);return O}).catch(function(O){return I&&P&&Y(I,P),Promise.reject(O)}),P={obsSet:p.obsSet,promise:E,subscribers:new Set,type:"query",req:p,dirty:!1},I?I.push(P):(I=[P],(N=N||(Lr["idb://".concat(a,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=I)),of(P,I,m,C),P.promise.then(function(O){return{result:gl(O.result,p,N==null?void 0:N.optimisticOps,u,P,g)}})):u.query(p)}})}})}};function Ms(n,a){return new Proxy(n,{get:function(l,u,f){return u==="db"?a:Reflect.get(l,u,f)}})}pt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ke.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ke.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var a=this._versions,l=a.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),a.push(l),a.sort(Qc),l.stores({}),this._state.autoSchema=!1),l},pt.prototype._whenReady=function(n){var a=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?n():new be(function(l,u){if(a._state.openComplete)return u(new ke.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new ke.DatabaseClosed);a.open().catch(He)}a._state.dbReadyPromise.then(l,u)}).then(n)},pt.prototype.use=function(f){var a=f.stack,l=f.create,u=f.level,f=f.name,p=(f&&this.unuse({stack:a,name:f}),this._middlewares[a]||(this._middlewares[a]=[]));return p.push({stack:a,create:l,level:u??10,name:f}),p.sort(function(g,m){return g.level-m.level}),this},pt.prototype.unuse=function(n){var a=n.stack,l=n.name,u=n.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},pt.prototype.open=function(){var n=this;return Re(bt,function(){return ef(n)})},pt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,a=dt.indexOf(this);if(0<=a&&dt.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new be(function(l){n.dbReadyResolve=l}),n.openCanceller=new be(function(l,u){n.cancelOpen=u}))},pt.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,l=this._state;a?(l.isBeingOpened&&l.cancelOpen(new ke.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new ke.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},pt.prototype.delete=function(n){var a=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new be(function(f,p){function g(){a.close(n);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=nt(function(){var C,N,I;C=a._deps,N=a.name,ki(I=C.indexedDB)||N===Ut||wi(I,C.IDBKeyRange).delete(N).catch(He),f()}),m.onerror=Ln(p),m.onblocked=a._fireOnBlocked}if(l)throw new ke.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},pt.prototype.backendDB=function(){return this.idbdb},pt.prototype.isOpen=function(){return this.idbdb!==null},pt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},pt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pt.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(a){return n._allTables[a]})},enumerable:!1,configurable:!0}),pt.prototype.transaction=function(){var n=(function(a,l,u){var f=arguments.length;if(f<2)throw new ke.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return u=p.pop(),[a,_e(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},pt.prototype._transaction=function(n,a,l){var u,f,p=this,g=Ie.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=a.map(function(N){if(N=N instanceof p.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===Mn)u=Mn;else{if(n!="rw"&&n!=Dr)throw new ke.InvalidArgument("Invalid transaction mode: "+n);u=Dr}if(g){if(g.mode===Mn&&u===Dr){if(!m)throw new ke.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!m)throw new ke.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,E){E(N)}):he(N)}var C=(function N(I,E,P,O,R){return be.resolve().then(function(){var L=Ie.transless||Ie,A=I._createTransaction(E,P,I._dbSchema,O),L=(A.explicit=!0,{trans:A,transless:L});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,null,R)})):he(V)}var q,B=K(R),L=(B&&Pt(),be.follow(function(){var V;(q=R.call(A,A))&&(B?(V=wn.bind(null,null),q.then(V,V)):typeof q.next=="function"&&typeof q.throw=="function"&&(q=Ii(q)))},L));return(q&&typeof q.then=="function"?be.resolve(q).then(function(V){return A.active?V:he(new ke.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return q})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),he(V)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,C,"lock"):Ie.trans?Re(Ie.transless,function(){return p._whenReady(C)}):this._whenReady(C)},pt.prototype.table=function(n){if(_(this._allTables,n))return this._allTables[n];throw new ke.InvalidTable("Table ".concat(n," does not exist"))};var Vn=pt;function pt(n,a){var l,u,f,p,g,m=this,C=(this._middlewares={},this.verno=0,pt.dependencies),C=(this._options=a=s({addons:pt.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:He,dbReadyPromise:null,cancelOpen:He,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),I=(N.dbReadyPromise=new be(function(E){N.dbReadyResolve=E}),N.openCanceller=new be(function(E,P){N.cancelOpen=P}),this._state=N,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[ir,He]}),this.once=function(E,P){var O=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];m.on(E).unsubscribe(O),P.apply(m,R)};return m.on(E,O)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(E){return function(P,O){pt.vip(function(){var R,A=m._state;A.openComplete?(A.dbOpenError||be.resolve().then(P),O&&E(P)):A.onReadyBeingFired?(A.onReadyBeingFired.push(P),O&&E(P)):(E(P),R=m,O||E(function q(){R.on.ready.unsubscribe(P),R.on.ready.unsubscribe(q)}))})}}),this.Collection=(l=this,ja(Uc.prototype,function(q,A){this.db=l;var O=La,R=null;if(A)try{O=A()}catch(L){R=L}var A=q._ctx,q=A.table,B=q.hook.reading.fire;this._ctx={table:q,index:A.index,isPrimKey:!A.index||q.schema.primKey.keyPath&&A.index===q.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:R,or:A.or,valueMapper:B!==rn?B:null}})),this.Table=(u=this,ja(Jo.prototype,function(E,P,O){this.db=u,this._tx=O,this.name=E,this.schema=P,this.hook=u._allTables[E]?u._allTables[E].hook:qa(null,{creating:[Ra,He],reading:[sa,rn],updating:[sr,He],deleting:[Pa,He]})})),this.Transaction=(f=this,ja(Wc.prototype,function(E,P,O,R,A){var q=this;E!=="readonly"&&P.forEach(function(B){B=(B=O[B])==null?void 0:B.yProps,B&&(P=P.concat(B.map(function(L){return L.updatesTable})))}),this.db=f,this.mode=E,this.storeNames=P,this.schema=O,this.chromeTransactionDurability=R,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be(function(B,L){q._resolve=B,q._reject=L}),this._completion.then(function(){q.active=!1,q.on.complete.fire()},function(B){var L=q.active;return q.active=!1,q.on.error.fire(B),q.parent?q.parent._reject(B):L&&q.idbtrans&&q.idbtrans.abort(),he(B)})})),this.Version=(p=this,ja($c.prototype,function(E){this.db=p,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,ja(rl.prototype,function(E,P,O){if(this.db=g,this._ctx={table:E,index:P===":id"?null:P,or:O},this._cmp=this._ascending=We,this._descending=function(R,A){return We(A,R)},this._max=function(R,A){return 0<We(R,A)?R:A},this._min=function(R,A){return We(R,A)<0?R:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ke.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=Fa(a.IDBKeyRange),this._createTransaction=function(E,P,O,R){return new m.Transaction(E,P,O,m._options.chromeTransactionDurability,R)},this._fireOnBlocked=function(E){m.on("blocked").fire(E),dt.filter(function(P){return P.name===m.name&&P!==m&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(E)})},this.use(rf),this.use(lf),this.use(af),this.use(tf),this.use(nf),new Proxy(this,{get:function(E,P,O){var R;return P==="_vip"||(P==="table"?function(A){return Ms(m.table(A),I)}:(R=Reflect.get(E,P,O))instanceof Jo?Ms(R,I):P==="tables"?R.map(function(A){return Ms(A,I)}):P==="_createTransaction"?function(){return Ms(R.apply(this,arguments),I)}:R)}}));this.vip=I,C.forEach(function(E){return E(m)})}var Ls,pa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",uf=(Di.prototype.subscribe=function(n,a,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:a,complete:l})},Di.prototype[pa]=function(){return this},Di);function Di(n){this._subscribe=n}try{Ls={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ls={indexedDB:null,IDBKeyRange:null}}function yl(n){var a,l=!1,u=new uf(function(f){var p=K(n),g,m=!1,C={},N={},I={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),E&&hr.storagemutated.unsubscribe(O))}},E=(f.start&&f.start(I),!1),P=function(){return ue(R)},O=function(A){Ps(C,A),Ei(N,C)&&P()},R=function(){var A,q,B;!m&&Ls.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,B=(L=>{var V=dr();try{p&&Pt();var se=_n(n,L);return se=p?se.finally(wn):se}finally{V&&Yn()}})(q={subscr:A,signal:g.signal,requery:P,querier:n,trans:null}),Promise.resolve(B).then(function(L){l=!0,a=L,m||q.signal.aborted||(C={},(V=>{for(var se in V)if(_(V,se))return;return 1})(N=A)||E||(hr(za,O),E=!0),ue(function(){return!m&&f.next&&f.next(L)}))},function(L){l=!1,["DatabaseClosedError","AbortError"].includes(L==null?void 0:L.name)||m||ue(function(){m||f.error&&f.error(L)})}))};return setTimeout(P,0),I});return u.hasValue=function(){return l},u.getValue=function(){return a},u}var Nr=Vn;function Mi(n){var a=vr;try{vr=!0,hr.storagemutated.fire(n),Ci(n,!0)}finally{vr=a}}b(Nr,s(s({},fe),{delete:function(n){return new Nr(n,{addons:[]}).delete()},exists:function(n){return new Nr(n,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return a=Nr.dependencies,l=a.indexedDB,a=a.IDBKeyRange,(ki(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Ut})}):wi(l,a).toCollection().primaryKeys()).then(n)}catch{return he(new ke.MissingAPI)}var a,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Ie.trans?Re(Ie.transless,n):n()},vip:xi,async:function(n){return function(){try{var a=Ii(n.apply(this,arguments));return a&&typeof a.then=="function"?a:be.resolve(a)}catch(l){return he(l)}}},spawn:function(n,a,l){try{var u=Ii(n.apply(l,a||[]));return u&&typeof u.then=="function"?u:be.resolve(u)}catch(f){return he(f)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(n,a){return n=be.resolve(typeof n=="function"?Nr.ignoreTransaction(n):n).timeout(a||6e4),Ie.trans?Ie.trans.waitFor(n):n},Promise:be,debug:{get:function(){return Xt},set:function(n){Oa(n)}},derive:j,extend:v,props:b,override:J,Events:qa,on:hr,liveQuery:yl,extendObservabilitySet:Ps,getByKeyPath:le,setByKeyPath:Z,delByKeyPath:function(n,a){typeof a=="string"?Z(n,a,void 0):"length"in a&&[].map.call(a,function(l){Z(n,l,void 0)})},shallowClone:pe,deepClone:ae,getObjectDiff:Ri,cmp:We,asap:$,minKey:-1/0,addons:[],connections:dt,errnames:tt,dependencies:Ls,cache:Lr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,a,l){return n+a/Math.pow(10,2*l)})})),Nr.maxKey=Fa(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(hr(za,function(n){vr||(n=new CustomEvent(hi,{detail:n}),vr=!0,dispatchEvent(n),vr=!1)}),addEventListener(hi,function(n){n=n.detail,vr||Mi(n)}));var ha,vr=!1,bl=function(){};return typeof BroadcastChannel<"u"&&((bl=function(){(ha=new BroadcastChannel(hi)).onmessage=function(n){return n.data&&Mi(n.data)}})(),typeof ha.unref=="function"&&ha.unref(),hr(za,function(n){vr||ha.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Vn.disableBfCache&&n.persisted){Xt&&console.debug("Dexie: handling persisted pagehide"),ha!=null&&ha.close();for(var a=0,l=dt;a<l.length;a++)l[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Vn.disableBfCache&&n.persisted&&(Xt&&console.debug("Dexie: handling persisted pageshow"),bl(),Mi({all:new Ot(-1/0,[[]])}))})),be.rejectionMapper=function(n,a){return!n||n instanceof Ae||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Nt[n.name]?n:(a=new Nt[n.name](a||n.message,n),"stack"in n&&D(a,"stack",{get:function(){return this.inner.stack}}),a)},Oa(Xt),s(Vn,Object.freeze({__proto__:null,Dexie:Vn,Entity:Yo,PropModification:Na,RangeSet:Ot,add:function(n){return new Na({add:n})},cmp:We,default:Vn,liveQuery:yl,mergeRanges:Ga,rangesOverlap:ll,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,a){return new Na({replacePrefix:[n,a]})}}),{default:Vn}),Vn})})(Vs)),Vs.exports}var Vd=Yd();const io=Hd(Vd),jl=Symbol.for("Dexie"),Lt=globalThis[jl]||(globalThis[jl]=io);if(io.semVer!==Lt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${io.semVer} and ${Lt.semVer}`);const{liveQuery:Wm,mergeRanges:Ym,rangesOverlap:Vm,RangeSet:Xm,cmp:Qm,Entity:Zm,PropModification:Jm,replacePrefix:$m,add:ey,remove:ty,DexieYProvider:ny}=Lt,Ne=new Lt("me-ai-store");Ne.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Ne.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Ne.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Ne.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function uc(t,e){return`${t}:${e}`}function oo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,s)).toFixed(1)+" "+r[s]}function Ki(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,s),o=s>=2?2:s>=1?1:0;return i.toFixed(o)+" "+r[s]}function Xd(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function cc(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function fc(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const Qd="https://gmail.googleapis.com/gmail/v1/users/me";class Mo extends Error{constructor(e,r,s){super(e),this.name="GmailApiError",this.status=r,this.code=s||null}}function Zd(t){return{Authorization:`Bearer ${t}`}}async function ui(t,e){var s,i,o,c;const r=await fetch(`${Qd}${e}`,{headers:Zd(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((s=d.error)==null?void 0:s.message)||`Gmail API error: ${r.status}`,h=((c=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:c.reason)||void 0;throw new Mo(v,r.status,h)}return r.json()}function dc(t){return ui(t,"/profile")}function pc(t,{maxResults:e=20,pageToken:r,q:s}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),s&&i.set("q",s),ui(t,`/messages?${i}`)}function hc(t,e,r="full"){return ui(t,`/messages/${e}?format=${r}`)}function Jd(t,{startHistoryId:e,pageToken:r,maxResults:s=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(s)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),ui(t,`/history?${i}`)}function mr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],s=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===s);return(i==null?void 0:i.value)||""}function as(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const s=atob(e),i=Uint8Array.from(s,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function $d(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return as(e.body.data);const r=e.parts||[],s=$s(r,"text/plain");if((c=s==null?void 0:s.body)!=null&&c.data)return as(s.body.data);const i=$s(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=as(i.body.data);return tp(v)}return"(no body)"}function ep(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return as(e.body.data);const r=e.parts||[],s=$s(r,"text/html");return(o=s==null?void 0:s.body)!=null&&o.data?as(s.body.data):null}function $s(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const s=$s(r.parts,e);if(s)return s}}return null}function tp(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Lo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function No(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function vc(t){return No(t).charAt(0).toUpperCase()}function np(t){try{const e=new Date(t),r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${i}`}catch{return"email"}}function rp(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function gc(t,e){return`${np(t.date)}_${rp(t.subject)}.${e}`}function mc(t){const e={};for(const s of t){const i=s.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(s)}for(const s of Object.keys(e))e[s].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((s,i)=>e[i].length-e[s].length);return{groups:e,order:r}}async function ap(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:s,newest:i}=await yc();if(s&&i){const c=new Date(s.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const o=await up(5);return o.length>0&&r.push("Top senders: "+o.map(([c,d])=>`${No(c)} (${d})`).join(", ")+"."),r.join(" ")}async function sp(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:s,newest:i}=await yc();if(s&&i){const v=new Date(s.date).toLocaleDateString(),h=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${v} â ${h}`)}const o=await Ne.items.where("sourceType").equals("gmail").toArray(),c=bc(o,10),d=cp(o,10);if(c.length>0){r.push("","### Top Senders");for(const[v,h]of c)r.push(`- ${v}: ${h}`)}if(d.length>0){r.push("","### Labels");for(const[v,h]of d)r.push(`- ${v}: ${h}`)}return r.join(`
`)}async function ip(t=10){const e=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(_c).join(`

---

`)}async function op(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Ne.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,h,y,_;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(h=o.to)!=null&&h.toLowerCase().includes(r)&&(c+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(_=o.body)!=null&&_.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>_c(o)).join(`

---

`)}async function lo(){const t=await Ne.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=mc(t);return{groups:e,order:r,total:t.length}}async function lp({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await Ne.items.where("sourceType").equals("gmail").filter(d=>{var v,h,y,_;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((h=d.from)==null?void 0:h.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((_=d.snippet)==null?void 0:_.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const s=await Ne.items.where("sourceType").equals("gmail").count();return{items:await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().offset(r).limit(e).toArray(),total:s}}async function yc(){const t=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).first(),e=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).last();return{oldest:t,newest:e}}async function up(t){const e=await Ne.items.where("sourceType").equals("gmail").toArray();return bc(e,t)}function bc(t,e){const r={};for(const s of t){const i=s.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((s,i)=>i[1]-s[1]).slice(0,e)}function cp(t,e){const r={};for(const s of t)for(const i of s.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((s,i)=>i[1]-s[1]).slice(0,e)}function _c(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=cc(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function fp(){const t=await ap();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function dp(t){const e=[],r=await sp();if(e.push(r),t){const s=await op(t,5);e.push("","## Relevant Emails",s)}else{const s=await ip(5);e.push("","## Recent Emails",s)}return e.join(`
`)}async function pp(){const t=await lo();if(!t)return null;const e=["## Pending Action Items",`You have ${t.total} pending email action items that need attention:`,""];for(const r of t.order){const s=t.groups[r],i=r.replace(/_/g," ");e.push(`### ${i} (${s.length})`);for(const o of s.slice(0,5)){const c=o.date?new Date(o.date).toLocaleDateString():"unknown date";e.push(`- **${o.subject}** from ${o.from} (${c})`),o.summary&&e.push(`  ${o.summary}`)}s.length>5&&e.push(`  ...and ${s.length-5} more`),e.push("")}return e.push("The user is seeing these pending items in their chat. Help them decide what to do with these items. You can suggest specific actions like archiving, replying, following up, etc."),e.join(`
`)}function hp(t){const e=[`You have ${t.total} pending email action${t.total!==1?"s":""}:`];for(const r of t.order){const s=t.groups[r].length,i=vp(r);e.push(`- ${s} ${i}`)}return e.push("","What would you like to focus on?"),e.join(`
`)}function Bl(t){const e=[],r=new Set(t.order);return(r.has("REPLY")||r.has("FOLLOW_UP"))&&e.push("Which emails need an urgent reply?"),r.has("TRACK_DELIVERY")&&e.push("What deliveries am I waiting for?"),(r.has("PAY_BILL")||r.has("SAVE_RECEIPT"))&&e.push("Show me bills or receipts that need attention"),(r.has("DELETE")||r.has("ARCHIVE")||r.has("UNSUBSCRIBE"))&&e.push("What can I safely archive or delete?"),e.length===0&&e.push("Show me the most important emails"),e.push("Help me prioritize these items"),e.slice(0,5)}function vp(t){return t.toLowerCase().replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}const gp=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function zl(...t){gp&&console.log("[debug]",...t)}function nn(t){return zl(`[MOUNT] ${t}`),()=>zl(`[DESTROY] ${t}`)}var mp=X("<option> </option>"),yp=X('<p class="model-description svelte-1p89qnn"> </p>'),bp=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),_p=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),wp=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),kp=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),xp=X('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Sp=X('<p class="error svelte-1p89qnn"> </p>'),Ep=X('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Tp(t,e){lt(e,!0);let r=Pe(e,"selectedModel",15),s=Pe(e,"gpuInfo",3,null),i=Pe(e,"error",3,null);Rt(()=>nn("ModelSelector"));var o=Ep(),c=M(x(o),2),d=M(x(c),2);gn(d,21,()=>os,Er,(j,S)=>{var F=mp(),re=x(F),J={};ye(()=>{ce(re,`${k(S).name??""} â ${k(S).size??""}`),J!==(J=k(S).id)&&(F.value=(F.__value=k(S).id)??"")}),G(j,F)});var v=M(d,2);{var h=j=>{const S=Mt(()=>os.find(U=>U.id===r()));var F=Po(),re=xt(F);{var J=U=>{var $=yp(),le=x($);ye(()=>ce(le,k(S).description)),G(U,$)};we(re,U=>{k(S)&&U(J)})}G(j,F)};we(v,j=>{r()&&j(h)})}var y=M(c,2);{var _=j=>{var S=xp(),F=M(x(S),2),re=x(F),J=M(x(re)),U=x(J),$=M(re,2),le=M(x($)),Z=x(le),pe=M($,2);{var Me=Q=>{var ee=bp(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,s().device)),G(Q,ee)};we(pe,Q=>{s().device&&s().device!=="unknown"&&Q(Me)})}var _e=M(pe,2);{var me=Q=>{var ee=_p(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,s().description)),G(Q,ee)};we(_e,Q=>{s().description&&s().description!=="unknown"&&Q(me)})}var ie=M(_e,2);{var ae=Q=>{var ee=wp(),Y=M(x(ee)),ne=x(Y);ye(te=>ce(ne,te),[()=>oo(s().limits.maxBufferSize)]),G(Q,ee)};we(ie,Q=>{var ee;(ee=s().limits)!=null&&ee.maxBufferSize&&Q(ae)})}var Le=M(ie,2);{var W=Q=>{var ee=kp(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,`${s().features.length??""} supported`)),G(Q,ee)};we(Le,Q=>{var ee;(ee=s().features)!=null&&ee.length&&Q(W)})}ye(()=>{ce(U,s().vendor),ce(Z,s().architecture)}),G(j,S)};we(y,j=>{s()&&j(_)})}var b=M(y,2);{var w=j=>{var S=Sp(),F=x(S);ye(()=>ce(F,i())),G(j,S)};we(b,j=>{i()&&j(w)})}var D=M(b,2);D.__click=function(...j){var S;(S=e.onload)==null||S.apply(this,j)},ye(()=>D.disabled=i()),Oo(d,r),G(t,o),ut()}Kt(["click"]);var Ap=X('<span class="progress-percent svelte-r5fnze"> </span>'),Cp=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Ip=X('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Rp=X('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Pp=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Op=X('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Dp=X('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Mp(t,e){lt(e,!0);let r=Pe(e,"message",3,""),s=Pe(e,"items",19,()=>[]);Rt(()=>nn("LoadingProgress"));var i=Dp(),o=x(i),c=x(o),d=M(o,2);gn(d,17,s,Er,(v,h)=>{const y=Mt(()=>k(h).total?Xd(k(h).loaded||0,k(h).total):null);var _=Op(),b=x(_),w=x(b),D=x(w),j=M(w,2);{var S=U=>{var $=Ap(),le=x($);ye(Z=>ce(le,`${Z??""}%`),[()=>k(y).toFixed(1)]),G(U,$)};we(j,U=>{k(y)!==null&&U(S)})}var F=M(b,2);{var re=U=>{var $=Cp(),le=xt($),Z=x(le),pe=M(le,2),Me=x(pe),_e=x(Me),me=M(Me,4),ie=x(me),ae=M(me,2),Le=x(ae);ye((W,Q,ee,Y,ne)=>{Rn(Z,`width: ${W??""}%`),ce(_e,Q),ce(ie,ee),ce(Le,`(${Y??""} / ${ne??""} B)`)},[()=>Math.max(k(h).progress??0,.5).toFixed(1),()=>Ki(k(h).loaded||0),()=>Ki(k(h).total),()=>(k(h).loaded||0).toLocaleString(),()=>k(h).total.toLocaleString()]),G(U,$)},J=U=>{var $=Pp(),le=M(xt($),2),Z=x(le);{var pe=_e=>{var me=Ip(),ie=xt(me),ae=x(ie),Le=M(ie,2),W=x(Le);ye((Q,ee)=>{ce(ae,Q),ce(W,`(${ee??""} B)`)},[()=>Ki(k(h).loaded),()=>k(h).loaded.toLocaleString()]),G(_e,me)},Me=_e=>{var me=Rp();G(_e,me)};we(Z,_e=>{k(h).loaded?_e(pe):_e(Me,!1)})}G(U,$)};we(F,U=>{k(h).total?U(re):U(J,!1)})}ye(()=>{ic(w,"title",k(h).file),ce(D,k(h).file)}),G(v,_)}),ye(()=>ce(c,r())),G(t,i),ut()}var Lp=X('<span class="thinking-tokens svelte-11gjw00"> </span>'),Np=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),qp=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),jp=X('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Bp=X('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),zp=X('<span class="cursor svelte-11gjw00">|</span>'),Fp=X(" <!>",1),Kp=X('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Up=X('<div class="content svelte-11gjw00"> </div>'),Gp=X('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Hp(t,e){lt(e,!0);let r=Pe(e,"isLast",3,!1),s=Pe(e,"isRunning",3,!1),i=Pe(e,"generationPhase",3,null),o=Pe(e,"numTokens",3,null);Rt(()=>nn(`MessageBubble[${e.msg.role}]`));var c=Gp(),d=x(c),v=x(d),h=M(d,2);{var y=b=>{var w=Kp(),D=xt(w);{var j=Z=>{var pe=Np(),Me=M(x(pe),4);{var _e=me=>{var ie=Lp(),ae=x(ie);ye(()=>ce(ae,`${o()??""} tokens`)),G(me,ie)};we(Me,me=>{o()&&me(_e)})}G(Z,pe)},S=Z=>{var pe=qp();G(Z,pe)};we(D,Z=>{s()&&r()&&i()==="thinking"?Z(j):s()&&r()&&i()==="preparing"&&Z(S,1)})}var F=M(D,2);{var re=Z=>{var pe=jp(),Me=x(pe),_e=M(x(Me),2),me=x(_e),ie=M(Me,2),ae=x(ie);ye(Le=>{ce(me,`${Le??""} words`),ce(ae,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),G(Z,pe)};we(F,Z=>{e.msg.thinking&&Z(re)})}var J=M(F,2),U=x(J);{var $=Z=>{var pe=Bp();G(Z,pe)},le=Z=>{var pe=Fp(),Me=xt(pe,!0),_e=M(Me);{var me=ie=>{var ae=zp();G(ie,ae)};we(_e,ie=>{s()&&r()&&ie(me)})}ye(()=>ce(Me,e.msg.content)),G(Z,pe)};we(U,Z=>{s()&&r()&&!e.msg.content&&i()!=="thinking"?Z($):Z(le,!1)})}G(b,w)},_=b=>{var w=Up(),D=x(w);ye(()=>ce(D,e.msg.content)),G(b,w)};we(h,b=>{e.msg.role==="assistant"?b(y):b(_,!1)})}ye(()=>{dn(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ce(v,e.msg.role==="user"?"You":"AI")}),G(t,c),ut()}var Wp=X('<button class="suggestion svelte-1wrqu74"><span class="arrow svelte-1wrqu74">&#8618;</span> <span class="text svelte-1wrqu74"> </span></button>'),Yp=X('<div class="follow-ups svelte-1wrqu74"><span class="label svelte-1wrqu74">Follow-ups</span> <!></div>');function Vp(t,e){lt(e,!0);let r=Pe(e,"suggestions",19,()=>[]);var s=Po(),i=xt(s);{var o=c=>{var d=Yp(),v=M(x(d),2);gn(v,16,r,h=>h,(h,y)=>{var _=Wp();_.__click=()=>e.onsend(y);var b=M(x(_),2),w=x(b);ye(()=>ce(w,y)),G(h,_)}),G(c,d)};we(i,c=>{r().length>0&&c(o)})}G(t,s),ut()}Kt(["click"]);var Xp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Qp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Zp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Jp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),$p=X('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),eh=X('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),th=X('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function nh(t,e){lt(e,!0),Rt(()=>nn("GpuPanel"));var r=th(),s=x(r),i=M(x(s),2),o=M(x(i),2),c=x(o),d=M(i,2),v=M(x(d),2),h=x(v),y=M(d,2);{var _=U=>{var $=Xp(),le=M(x($),2),Z=x(le);ye(()=>ce(Z,e.gpuInfo.device)),G(U,$)};we(y,U=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&U(_)})}var b=M(y,2);{var w=U=>{var $=Qp(),le=M(x($),2),Z=x(le);ye(pe=>ce(Z,pe),[()=>oo(e.gpuInfo.limits.maxBufferSize)]),G(U,$)};we(b,U=>{var $;($=e.gpuInfo.limits)!=null&&$.maxBufferSize&&U(w)})}var D=M(b,2);{var j=U=>{var $=Zp(),le=M(x($),2),Z=x(le);ye(()=>ce(Z,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),G(U,$)};we(D,U=>{var $;($=e.gpuInfo.limits)!=null&&$.maxComputeInvocationsPerWorkgroup&&U(j)})}var S=M(D,2);{var F=U=>{var $=Jp(),le=M(x($),2),Z=x(le);ye(pe=>ce(Z,pe),[()=>oo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),G(U,$)};we(S,U=>{var $;($=e.gpuInfo.limits)!=null&&$.maxComputeWorkgroupStorageSize&&U(F)})}var re=M(S,2);{var J=U=>{var $=eh(),le=x($),Z=x(le),pe=M(le,2);gn(pe,21,()=>e.gpuInfo.features,Er,(Me,_e)=>{var me=$p(),ie=x(me);ye(()=>ce(ie,k(_e))),G(Me,me)}),ye(()=>ce(Z,`Features (${e.gpuInfo.features.length??""})`)),G(U,$)};we(re,U=>{var $;($=e.gpuInfo.features)!=null&&$.length&&U(J)})}ye(()=>{ce(c,e.gpuInfo.vendor),ce(h,e.gpuInfo.architecture)}),G(t,r),ut()}var rh=X('<button class="gpu-badge svelte-1ktw27c"> </button>'),ah=X('<span class="stats svelte-1ktw27c"> </span>'),sh=X('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),ih=X('<span class="stats preparing svelte-1ktw27c"> </span>'),oh=X('<span class="stats svelte-1ktw27c"> </span>'),lh=X('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),uh=X('<button class="btn svelte-1ktw27c">Stop</button>'),ch=X('<button class="btn primary svelte-1ktw27c">Send</button>'),fh=X('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function dh(t,e){lt(e,!0),Rt(()=>nn("ChatView"));let r=Pe(e,"messages",19,()=>[]),s=Pe(e,"suggestions",19,()=>[]),i=Pe(e,"isRunning",3,!1),o=Pe(e,"tps",3,null),c=Pe(e,"numTokens",3,null),d=Pe(e,"generationPhase",3,null),v=Pe(e,"gpuInfo",3,null),h=Pe(e,"chatContainer",15),y=Oe(""),_=Oe(!1);function b(K){K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),w())}function w(){const K=k(y).trim();!K||i()||(z(y,""),e.onsend(K))}var D=fh(),j=x(D),S=x(j);{var F=K=>{var fe=rh();fe.__click=()=>z(_,!k(_));var Se=x(fe);ye(()=>ce(Se,`WebGPU ${k(_)?"â²":"â¼"}`)),G(K,fe)};we(S,K=>{v()&&K(F)})}var re=M(S,2);{var J=K=>{var fe=ah(),Se=x(fe);ye((Ae,Te)=>ce(Se,`${c()??""} tokens in ${Ae??""}s
        (${Te??""} tok/s)`),[()=>(c()/o()).toFixed(1),()=>o().toFixed(1)]),G(K,fe)},U=K=>{var fe=sh();G(K,fe)},$=K=>{var fe=ih(),Se=x(fe);ye(Ae=>ce(Se,`thinking... ${Ae??""}`),[()=>o()?`${o().toFixed(0)} tok/s`:""]),G(K,fe)},le=K=>{var fe=oh(),Se=x(fe);ye(Ae=>ce(Se,`${Ae??""} tok/s`),[()=>o().toFixed(1)]),G(K,fe)};we(re,K=>{o()&&!i()?K(J):i()&&d()==="preparing"?K(U,1):i()&&d()==="thinking"?K($,2):o()&&i()&&K(le,3)})}var Z=M(re,4);Z.__click=function(...K){var fe;(fe=e.onreset)==null||fe.apply(this,K)};var pe=M(j,2);{var Me=K=>{nh(K,{get gpuInfo(){return v()}})};we(pe,K=>{k(_)&&v()&&K(Me)})}var _e=M(pe,2),me=x(_e);{var ie=K=>{var fe=lh();G(K,fe)};we(me,K=>{r().length===0&&K(ie)})}var ae=M(me,2);gn(ae,17,r,Er,(K,fe,Se)=>{{let Ae=Mt(()=>Se===r().length-1);Hp(K,{get msg(){return k(fe)},get isLast(){return k(Ae)},get isRunning(){return i()},get generationPhase(){return d()},get numTokens(){return c()}})}});var Le=M(ae,2);{var W=K=>{Vp(K,{get suggestions(){return s()},get onsend(){return e.onsend}})};we(Le,K=>{s().length>0&&!i()&&K(W)})}oc(_e,K=>h(K),()=>h());var Q=M(_e,2),ee=x(Q);ee.__keydown=b;var Y=M(ee,2);{var ne=K=>{var fe=uh();fe.__click=function(...Se){var Ae;(Ae=e.onstop)==null||Ae.apply(this,Se)},G(K,fe)},te=K=>{var fe=ch();fe.__click=w,ye(Se=>fe.disabled=Se,[()=>!k(y).trim()]),G(K,fe)};we(Y,K=>{i()?K(ne):K(te,!1)})}ye(()=>{Z.disabled=i(),ee.disabled=i()}),Do(ee,()=>k(y),K=>z(y,K)),G(t,D),ut()}Kt(["click","keydown"]);var ph=X('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function hh(t,e){lt(e,!0);const r=!!navigator.gpu,s=lc();let i=Oe(wt(localStorage.getItem("selectedModel")||os[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),v=Oe(wt([])),h=Oe(wt([])),y=Oe(wt([])),_=Oe(!1),b=Oe(null),w=Oe(null),D=Oe(null),j=Oe(null),S=Oe(null),F=!1;Rt(()=>{s.check(),s.isReady&&re();const W=s.onMessage(Q=>{switch(Q.status){case"webgpu-info":z(j,Q.data,!0);break;case"loading":z(o,"loading"),z(d,Q.data,!0);break;case"initiate":z(v,[...k(v),Q],!0);break;case"progress":z(v,k(v).map(ee=>ee.file===Q.file?{...ee,...Q}:ee),!0);break;case"done":z(v,k(v).filter(ee=>ee.file!==Q.file),!0);break;case"ready":z(o,"ready"),re();break;case"start":if(!k(_))break;z(S,Q.phase||"preparing",!0),z(h,[...k(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!k(_))break;z(S,Q.phase,!0);break;case"thinking":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(h)[k(h).length-1];z(h,[...k(h).slice(0,-1),{...ee,thinking:(ee.thinking||"")+Q.content}],!0),U();break}case"thinking-done":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(h)[k(h).length-1];z(h,[...k(h).slice(0,-1),{...ee,thinking:Q.content}],!0);break}case"update":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(h)[k(h).length-1];z(h,[...k(h).slice(0,-1),{...ee,content:ee.content+Q.output}],!0),U();break}case"complete":if(!k(_))break;z(_,!1),z(S,null),J();break;case"error":if(!k(_))break;z(c,Q.data,!0),z(_,!1),z(S,null);break}});return()=>W()});async function re(){if(!(F||k(h).length>0))try{const W=await lo();if(W){F=!0;const Q=hp(W);z(h,[{role:"assistant",content:Q}],!0),z(y,Bl(W),!0),U()}}catch{}}async function J(){try{const W=await lo();W&&W.total>0?z(y,Bl(W),!0):z(y,[],!0)}catch{z(y,[],!0)}}function U(){tc().then(()=>{k(D)&&(k(D).scrollTop=k(D).scrollHeight)})}function $(){z(o,"loading"),localStorage.setItem("selectedModel",k(i)),s.loadModel(k(i))}async function le(W){if(!W||k(_))return;z(y,[],!0),z(h,[...k(h),{role:"user",content:W}],!0),z(b,null),z(_,!0);let Q=[];try{const Y=await pp(),ne=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i;let te;ne.test(W)||Y?(te=await dp(W),Y&&(te=(te||"")+`

`+Y)):te=await fp(),te&&(Q=[{role:"system",content:te}])}catch{}const ee=k(h).map(Y=>({role:Y.role,content:Y.content}));s.generate([...Q,...ee]),U()}function Z(){s.interrupt()}function pe(){s.reset(),z(h,[],!0),z(y,[],!0),z(b,null),z(w,null),F=!1,re()}var Me=Po(),_e=xt(Me);{var me=W=>{var Q=ph();G(W,Q)},ie=W=>{Tp(W,{get gpuInfo(){return k(j)},get error(){return k(c)},onload:$,get selectedModel(){return k(i)},set selectedModel(Q){z(i,Q,!0)}})},ae=W=>{Mp(W,{get message(){return k(d)},get items(){return k(v)}})},Le=W=>{dh(W,{get messages(){return k(h)},get suggestions(){return k(y)},get isRunning(){return k(_)},get tps(){return k(b)},get numTokens(){return k(w)},get generationPhase(){return k(S)},get gpuInfo(){return k(j)},onsend:le,onstop:Z,onreset:pe,get chatContainer(){return k(D)},set chatContainer(Q){z(D,Q,!0)}})};we(_e,W=>{r?k(o)===null?W(ie,1):k(o)==="loading"?W(ae,2):W(Le,!1):W(me)})}G(t,Me),ut()}const Fl="https://accounts.google.com/gsi/client",vh="https://www.googleapis.com/auth/gmail.readonly";let uo=null,Xs=null;function gh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Fl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const s=document.createElement("script");s.src=Fl,s.async=!0,s.defer=!0,s.onload=()=>t(),s.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(s)})}async function Kl(t){await gh(),uo=google.accounts.oauth2.initTokenClient({client_id:t,scope:vh,callback:e=>{Xs&&(Xs(e),Xs=null)}})}function mh(){return new Promise((t,e)=>{if(!uo){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Xs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},uo.requestAccessToken()})}function yh(t){return new Promise(e=>{var r,s;(s=(r=window.google)==null?void 0:r.accounts)!=null&&s.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const At="gmail",Ul=8,wc=50,kc=100;async function bh(t,{limit:e=wc,onProgress:r=()=>{},signal:s}={}){var c;const i=await Ne.syncState.get(At);if(i!=null&&i.historyId)try{return await Eh(t,i,r,s)}catch(d){if(d instanceof Mo&&(d.status===404||d.code==="notFound")||((c=d.message)==null?void 0:c.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Ne.syncState.delete(At);else throw d}return await xh(t,e===0?1/0:e,r,s)}async function _h(t,{limit:e=wc,onProgress:r=()=>{},signal:s}={}){const i=await Ne.syncState.get(At);return i!=null&&i.oldestPageToken?await Sh(t,i,e===0?1/0:e,r,s):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function wh(){const t=await Ne.syncState.get(At);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function kh(){await Ne.transaction("rw",[Ne.items,Ne.syncState],async()=>{await Ne.items.where("sourceType").equals(At).delete(),await Ne.syncState.delete(At)})}async function xh(t,e,r,s){r({phase:"counting",message:"Getting mailbox info..."}),ta(s);const i=await dc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){ta(s);const _=e-o.length,b=await pc(t,{maxResults:Math.min(kc,_),pageToken:c}),w=(b.messages||[]).map(D=>D.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await xc(t,o,r,s),y=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function Sh(t,e,r,s,i){s({phase:"listing",message:"Loading more messages...",current:0}),ta(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){ta(i);const _=r-o.length,b=await pc(t,{maxResults:Math.min(kc,_),pageToken:c}),w=(b.messages||[]).map(D=>D.id);if(o.push(...w),s({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.update(At,{oldestPageToken:null,lastSyncAt:Date.now()}),s({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await xc(t,o,s,i),y=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.update(At,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),s({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:h}}async function Eh(t,e,r,s){r({phase:"syncing",message:"Checking for changes..."}),ta(s);let i=0,o=0,c=0,d,v=e.historyId;do{ta(s);const y=await Jd(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const _ of y.history){if(_.messagesAdded){const b=_.messagesAdded.map(D=>D.message.id),w=[...new Set(b.filter(D=>D))];if(w.length>0){const D=await Promise.allSettled(w.map(S=>hc(t,S))),j=[];for(const S of D)S.status==="fulfilled"?j.push(Sc(S.value)):c++;j.length>0&&(await Ne.items.bulkPut(j),await Ec(j),i+=j.length)}}if(_.messagesDeleted){const b=_.messagesDeleted.map(w=>uc(At,w.message.id)).filter(w=>w);b.length>0&&(await Ne.items.bulkDelete(b),o+=b.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const h=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.put({sourceType:At,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:h,total:h}),{added:i,deleted:o,errors:c}}async function xc(t,e,r,s){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Ul){ta(s);const d=e.slice(c,c+Ul),v=await Promise.allSettled(d.map(y=>hc(t,y))),h=[];for(const y of v)y.status==="fulfilled"?h.push(Sc(y.value)):o++;h.length>0&&(await Ne.items.bulkPut(h),await Ec(h)),i+=h.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Sc(t){const e=mr(t,"From"),r=mr(t,"To"),s=mr(t,"Cc"),i=mr(t,"Subject")||"(no subject)",o=mr(t,"Date"),c=mr(t,"Message-ID"),d=mr(t,"In-Reply-To"),v=mr(t,"References");let h;try{h=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:uc(At,t.id),sourceType:At,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:s,subject:i,snippet:t.snippet||"",body:$d(t),htmlBody:ep(t),date:h,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Ec(t){const e=new Map;for(const r of t)for(const s of[r.from,r.to,r.cc]){if(!s)continue;const i=s.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Th(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:s,date:i}]of e)try{const o=await Ne.contacts.where("email").equals(r).first();if(o){const c={};s&&!o.name&&(c.name=s),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await Ne.contacts.update(o.id,c)}else await Ne.contacts.add({email:r,name:s||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Th(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const s=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:s,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ta(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Ah=X(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Ch(t,e){lt(e,!0);let r=Pe(e,"clientIdInput",15);Rt(()=>nn("SetupGuide"));let s=Oe(null);async function i(Ae){try{await navigator.clipboard.writeText(Ae),z(s,Ae,!0),setTimeout(()=>{z(s,null)},1500)}catch{const Te=document.createElement("input");Te.value=Ae,document.body.appendChild(Te),Te.select(),document.execCommand("copy"),document.body.removeChild(Te),z(s,Ae,!0),setTimeout(()=>{z(s,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Ah(),h=x(v),y=M(x(h),4),_=M(x(y),6),b=M(x(_),2),w=M(x(b),2),D=M(x(w),2),j=x(D);j.__click=()=>i(o);var S=x(j);S.textContent="http://localhost:5173";var F=M(S,2),re=x(F),J=M(j,2);J.__click=()=>i(c);var U=x(J);U.textContent="https://cypherkitty.github.io";var $=M(U,2),le=x($),Z=M(w,2),pe=M(x(Z),2),Me=x(pe);Me.__click=()=>i(o);var _e=x(Me);_e.textContent="http://localhost:5173";var me=M(_e,2),ie=x(me),ae=M(Me,2);ae.__click=()=>i(c);var Le=x(ae);Le.textContent="https://cypherkitty.github.io";var W=M(Le,2),Q=x(W),ee=M(ae,2);ee.__click=()=>i(d);var Y=x(ee);Y.textContent="https://cypherkitty.github.io/me-ai/";var ne=M(Y,2),te=x(ne),K=M(y,2),fe=x(K);fe.__keydown=Ae=>Ae.key==="Enter"&&e.onsave();var Se=M(fe,2);Se.__click=function(...Ae){var Te;(Te=e.onsave)==null||Te.apply(this,Ae)},ye(Ae=>{ce(re,k(s)===o?"â":"â§"),ce(le,k(s)===c?"â":"â§"),ce(ie,k(s)===o?"â":"â§"),ce(Q,k(s)===c?"â":"â§"),ce(te,k(s)===d?"â":"â§"),Se.disabled=Ae},[()=>!r().trim()]),Do(fe,r),G(t,v),ut()}Kt(["click","keydown"]);function Ih(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),s=e instanceof Mo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return s===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:s===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:s===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Rh=X('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Ph=X('<div class="error-card-title svelte-14buhqq"> </div>'),Oh=X('<p class="error-card-fix svelte-14buhqq"> </p>'),Dh=X('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),Mh=X('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),Lh=X('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Tc(t,e){lt(e,!0);let r=Pe(e,"ondismiss",3,null),s=Pe(e,"onsignout",3,null),i=Mt(()=>Ih(e.error));Rt(()=>nn("ErrorCard"));var o=Lh(),c=x(o);{var d=F=>{var re=Rh(),J=x(re),U=x(J),$=M(J,2);$.__click=function(...le){var Z;(Z=r())==null||Z.apply(this,le)},ye(()=>ce(U,k(i).title)),G(F,re)},v=F=>{var re=Ph(),J=x(re);ye(()=>ce(J,k(i).title)),G(F,re)};we(c,F=>{r()?F(d):F(v,!1)})}var h=M(c,2),y=x(h),_=M(h,2);{var b=F=>{var re=Oh(),J=x(re);ye(()=>ce(J,k(i).fix)),G(F,re)};we(_,F=>{k(i).fix&&F(b)})}var w=M(_,2);{var D=F=>{var re=Dh(),J=x(re);ye(()=>{ic(re,"href",k(i).link.url),ce(J,`${k(i).link.label??""} â`)}),G(F,re)};we(w,F=>{k(i).link&&F(D)})}var j=M(w,2);{var S=F=>{var re=Mh();re.__click=function(...J){var U;(U=s())==null||U.apply(this,J)},G(F,re)};we(j,F=>{k(i).action==="signout"&&s()&&F(S)})}ye(()=>ce(y,k(i).description)),G(t,o),ut()}Kt(["click"]);var Nh=X('<span class="spinner svelte-nyqevv"></span> Signing in...',1),qh=Ro('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),jh=X(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function Bh(t,e){lt(e,!0);let r=Pe(e,"error",3,null),s=Pe(e,"loadingAuth",3,!1);Rt(()=>nn("AuthCard"));var i=jh(),o=x(i),c=M(x(o),4);{var d=S=>{Tc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};we(c,S=>{r()&&S(d)})}var v=M(c,2);v.__click=function(...S){var F;(F=e.onsignin)==null||F.apply(this,S)};var h=x(v);{var y=S=>{var F=Nh();G(S,F)},_=S=>{var F=qh();G(S,F)};we(h,S=>{s()?S(y):S(_,!1)})}var b=M(v,2),w=M(x(b),2),D=x(w),j=M(w,2);j.__click=function(...S){var F;(F=e.onclear)==null||F.apply(this,S)},ye(S=>{v.disabled=s(),ce(D,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),G(t,i),ut()}Kt(["click"]);var zh=X('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Fh=X('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Kh=X('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function Uh(t,e){lt(e,!0);let r=Pe(e,"profile",3,null),s=Pe(e,"loadingProfile",3,!1);Rt(()=>nn("ProfileCard"));var i=Kh(),o=x(i),c=x(o),d=M(o,2),v=x(d);{var h=b=>{var w=zh();G(b,w)},y=b=>{var w=Fh(),D=xt(w),j=x(D),S=M(D,2),F=x(S);ye((re,J)=>{ce(j,r().emailAddress),ce(F,`${re??""} messages
        Â· ${J??""} threads`)},[()=>{var re;return((re=r().messagesTotal)==null?void 0:re.toLocaleString())||"?"},()=>{var re;return((re=r().threadsTotal)==null?void 0:re.toLocaleString())||"?"}]),G(b,w)};we(v,b=>{s()?b(h):r()&&b(y,1)})}var _=M(d,2);_.__click=function(...b){var w;(w=e.onsignout)==null||w.apply(this,b)},ye(b=>ce(c,b),[()=>r()?vc(r().emailAddress):"?"]),G(t,i),ut()}Kt(["click"]);var Gh=X('<span class="spinner svelte-1ds3j4k"></span>'),Hh=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Wh=X('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),Yh=X('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Vh=X('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Xh=X('<option class="svelte-1ds3j4k"> </option>'),Qh=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Zh=X('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Jh=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),$h=X('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),ev=X('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),tv=X('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function nv(t,e){lt(e,!0),Rt(()=>nn("SyncStatus"));let r=Pe(e,"syncStatus",3,null),s=Pe(e,"syncProgress",3,null),i=Pe(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(Y){if(!Y)return"never";const ne=Math.floor((Date.now()-Y)/1e3);if(ne<60)return"just now";const te=Math.floor(ne/60);if(te<60)return`${te}m ago`;const K=Math.floor(te/60);return K<24?`${K}h ago`:`${Math.floor(K/24)}d ago`}function h(){var Y,ne;return!((Y=s())!=null&&Y.total)||!((ne=s())!=null&&ne.current)?0:Math.round(s().current/s().total*100)}var y=tv(),_=x(y),b=x(_),w=x(b);{var D=Y=>{var ne=Gh();G(Y,ne)},j=Y=>{var ne=Hh();G(Y,ne)};we(w,Y=>{i()?Y(D):Y(j,!1)})}var S=M(b,2),F=M(x(S),2);{var re=Y=>{var ne=Wh(),te=x(ne),K=M(te);{var fe=Ae=>{var Te=Pl("Â· more available");G(Ae,Te)},Se=Ae=>{var Te=Pl("Â· all synced");G(Ae,Te)};we(K,Ae=>{r().hasMore?Ae(fe):Ae(Se,!1)})}ye((Ae,Te)=>ce(te,`${Ae??""} emails stored
          Â· synced ${Te??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),G(Y,ne)},J=Y=>{var ne=Yh();G(Y,ne)};we(F,Y=>{var ne;(ne=r())!=null&&ne.synced?Y(re):Y(J,!1)})}var U=M(S,2),$=x(U);{var le=Y=>{var ne=Vh();ne.__click=()=>z(o,!k(o)),G(Y,ne)};we($,Y=>{var ne;(ne=r())!=null&&ne.synced&&!i()&&Y(le)})}var Z=M(_,2),pe=x(Z),Me=M(x(pe),2);gn(Me,21,()=>d,Er,(Y,ne)=>{var te=Xh(),K=x(te),fe={};ye(()=>{ce(K,k(ne).label),fe!==(fe=k(ne).value)&&(te.value=(te.__value=k(ne).value)??"")}),G(Y,te)});var _e=M(pe,2),me=x(_e);{var ie=Y=>{var ne=Zh(),te=xt(ne);te.__click=()=>e.onsync(k(c));var K=x(te),fe=M(te,2);{var Se=Ae=>{var Te=Qh();Te.__click=()=>e.onsyncmore(k(c));var $e=x(Te);ye(()=>{Te.disabled=i(),ce($e,i()?"Loading...":"Sync More")}),G(Ae,Te)};we(fe,Ae=>{r().hasMore&&Ae(Se)})}ye(()=>{te.disabled=i(),ce(K,i()?"Syncing...":"Sync New")}),G(Y,ne)},ae=Y=>{var ne=Jh();ne.__click=()=>e.onsync(k(c));var te=x(ne);ye(()=>{ne.disabled=i(),ce(te,i()?"Syncing...":"Download Emails")}),G(Y,ne)};we(me,Y=>{var ne;(ne=r())!=null&&ne.synced?Y(ie):Y(ae,!1)})}var Le=M(Z,2);{var W=Y=>{var ne=$h(),te=x(ne),K=x(te);let fe,Se;var Ae=M(te,2),Te=x(Ae);ye($e=>{fe=dn(K,1,"progress-fill svelte-1ds3j4k",null,fe,{indeterminate:!s().total}),Se=Rn(K,"",Se,$e),ce(Te,s().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),G(Y,ne)};we(Le,Y=>{i()&&s()&&Y(W)})}var Q=M(Le,2);{var ee=Y=>{var ne=ev(),te=M(x(ne),2),K=x(te);K.__click=()=>z(o,!1);var fe=M(K,2);fe.__click=()=>{e.onclear(),z(o,!1)},G(Y,ne)};we(Q,Y=>{k(o)&&Y(ee)})}ye(()=>Me.disabled=i()),Oo(Me,()=>k(c),Y=>z(c,Y)),G(t,y),ut()}Kt(["click"]);var rv=X('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),av=X('<div class="message-list svelte-y2uamw"></div>');function sv(t,e){lt(e,!0);let r=Pe(e,"messages",19,()=>[]);Rt(()=>nn("MessageList"));var s=av();gn(s,21,r,Er,(i,o)=>{var c=rv();c.__click=()=>e.onselect(k(o));var d=x(c),v=x(d),h=M(d,2),y=x(h),_=x(y),b=x(_),w=M(_,2),D=x(w),j=M(y,2),S=x(j),F=M(j,2),re=x(F);ye((J,U,$)=>{ce(v,J),ce(b,U),ce(D,$),ce(S,k(o).subject),ce(re,k(o).snippet)},[()=>vc(k(o).from),()=>No(k(o).from),()=>Lo(k(o).date)]),G(i,c)}),G(t,s),ut()}Kt(["click"]);function qo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var aa=qo();function Ac(t){aa=t}var Br={exec:()=>null};function Ve(t,e=""){let r=typeof t=="string"?t:t.source,s={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Bt.caret,"$1"),r=r.replace(i,c),s},getRegex:()=>new RegExp(r,e)};return s}var iv=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Bt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},ov=/^(?:[ \t]*(?:\n|$))+/,lv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,uv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,gs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,cv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,jo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Cc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Ic=Ve(Cc).replace(/bull/g,jo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),fv=Ve(Cc).replace(/bull/g,jo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Bo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,dv=/^[^\n]+/,zo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,pv=Ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",zo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),hv=Ve(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,jo).getRegex(),ci="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Fo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,vv=Ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Fo).replace("tag",ci).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Rc=Ve(Bo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),gv=Ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Rc).getRegex(),Ko={blockquote:gv,code:lv,def:pv,fences:uv,heading:cv,hr:gs,html:vv,lheading:Ic,list:hv,newline:ov,paragraph:Rc,table:Br,text:dv},Gl=Ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),mv={...Ko,lheading:fv,table:Gl,paragraph:Ve(Bo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Gl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex()},yv={...Ko,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Fo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Br,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(Bo).replace("hr",gs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ic).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},bv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,_v=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Pc=/^( {2,}|\\)\n(?!\s*$)/,wv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fi=/[\p{P}\p{S}]/u,Uo=/[\s\p{P}\p{S}]/u,Oc=/[^\s\p{P}\p{S}]/u,kv=Ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Uo).getRegex(),Dc=/(?!~)[\p{P}\p{S}]/u,xv=/(?!~)[\s\p{P}\p{S}]/u,Sv=/(?:[^\s\p{P}\p{S}]|~)/u,Mc=/(?![*_])[\p{P}\p{S}]/u,Ev=/(?![*_])[\s\p{P}\p{S}]/u,Tv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Av=Ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",iv?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Lc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Cv=Ve(Lc,"u").replace(/punct/g,fi).getRegex(),Iv=Ve(Lc,"u").replace(/punct/g,Dc).getRegex(),Nc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Rv=Ve(Nc,"gu").replace(/notPunctSpace/g,Oc).replace(/punctSpace/g,Uo).replace(/punct/g,fi).getRegex(),Pv=Ve(Nc,"gu").replace(/notPunctSpace/g,Sv).replace(/punctSpace/g,xv).replace(/punct/g,Dc).getRegex(),Ov=Ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Oc).replace(/punctSpace/g,Uo).replace(/punct/g,fi).getRegex(),Dv=Ve(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Mc).getRegex(),Mv="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Lv=Ve(Mv,"gu").replace(/notPunctSpace/g,Tv).replace(/punctSpace/g,Ev).replace(/punct/g,Mc).getRegex(),Nv=Ve(/\\(punct)/,"gu").replace(/punct/g,fi).getRegex(),qv=Ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),jv=Ve(Fo).replace("(?:-->|$)","-->").getRegex(),Bv=Ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",jv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ei=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,zv=Ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ei).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),qc=Ve(/^!?\[(label)\]\[(ref)\]/).replace("label",ei).replace("ref",zo).getRegex(),jc=Ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",zo).getRegex(),Fv=Ve("reflink|nolink(?!\\()","g").replace("reflink",qc).replace("nolink",jc).getRegex(),Hl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Go={_backpedal:Br,anyPunctuation:Nv,autolink:qv,blockSkip:Av,br:Pc,code:_v,del:Br,delLDelim:Br,delRDelim:Br,emStrongLDelim:Cv,emStrongRDelimAst:Rv,emStrongRDelimUnd:Ov,escape:bv,link:zv,nolink:jc,punctuation:kv,reflink:qc,reflinkSearch:Fv,tag:Bv,text:wv,url:Br},Kv={...Go,link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",ei).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ei).getRegex()},co={...Go,emStrongRDelimAst:Pv,emStrongLDelim:Iv,delLDelim:Dv,delRDelim:Lv,url:Ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Hl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Hl).getRegex()},Uv={...co,br:Ve(Pc).replace("{2,}","*").getRegex(),text:Ve(co.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:Ko,gfm:mv,pedantic:yv},Wa={normal:Go,gfm:co,breaks:Uv,pedantic:Kv},Gv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wl=t=>Gv[t];function Xn(t,e){if(e){if(Bt.escapeTest.test(t))return t.replace(Bt.escapeReplace,Wl)}else if(Bt.escapeTestNoEncode.test(t))return t.replace(Bt.escapeReplaceNoEncode,Wl);return t}function Yl(t){try{t=encodeURI(t).replace(Bt.percentDecode,"%")}catch{return null}return t}function Vl(t,e){var o;let r=t.replace(Bt.findPipe,(c,d,v)=>{let h=!1,y=d;for(;--y>=0&&v[y]==="\\";)h=!h;return h?"|":" |"}),s=r.split(Bt.splitPipe),i=0;if(s[0].trim()||s.shift(),s.length>0&&!((o=s.at(-1))!=null&&o.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(Bt.slashPipe,"|");return s}function Ya(t,e,r){let s=t.length;if(s===0)return"";let i=0;for(;i<s&&t.charAt(s-i-1)===e;)i++;return t.slice(0,s-i)}function Hv(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let s=0;s<t.length;s++)if(t[s]==="\\")s++;else if(t[s]===e[0])r++;else if(t[s]===e[1]&&(r--,r<0))return s;return r>0?-2:-1}function Wv(t,e=0){let r=e,s="";for(let i of t)if(i==="	"){let o=4-r%4;s+=" ".repeat(o),r+=o}else s+=i,r++;return s}function Xl(t,e,r,s,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");s.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:s.inlineTokens(d)};return s.state.inLink=!1,v}function Yv(t,e,r){let s=t.match(r.other.indentCodeCompensation);if(s===null)return e;let i=s[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ti=class{constructor(t){Ke(this,"options");Ke(this,"rules");Ke(this,"lexer");this.options=t||aa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ya(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],s=Yv(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let s=Ya(r,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(r=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ya(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ya(e[0],`
`).split(`
`),s="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),y=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${h}`:h,i=i?`${i}
${y}`:y;let _=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=_,r.length===0)break;let b=o.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let w=b,D=w.raw+`
`+r.join(`
`),j=this.blockquote(D);o[o.length-1]=j,s=s.substring(0,s.length-w.raw.length)+j.raw,i=i.substring(0,i.length-w.text.length)+j.text;break}else if((b==null?void 0:b.type)==="list"){let w=b,D=w.raw+`
`+r.join(`
`),j=this.list(D);o[o.length-1]=j,s=s.substring(0,s.length-b.raw.length)+j.raw,i=i.substring(0,i.length-w.raw.length)+j.raw,r=D.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:o,text:i}}}list(t){var r,s;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,_="",b="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;_=e[0],t=t.substring(_.length);let w=Wv(e[2].split(`
`,1)[0],e[1].length),D=t.split(`
`,1)[0],j=!w.trim(),S=0;if(this.options.pedantic?(S=2,b=w.trimStart()):j?S=e[1].length+1:(S=w.search(this.rules.other.nonSpaceChar),S=S>4?1:S,b=w.slice(S),S+=e[1].length),j&&this.rules.other.blankLine.test(D)&&(_+=D+`
`,t=t.substring(D.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(S),re=this.rules.other.hrRegex(S),J=this.rules.other.fencesBeginRegex(S),U=this.rules.other.headingBeginRegex(S),$=this.rules.other.htmlBeginRegex(S),le=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Z=t.split(`
`,1)[0],pe;if(D=Z,this.options.pedantic?(D=D.replace(this.rules.other.listReplaceNesting,"  "),pe=D):pe=D.replace(this.rules.other.tabCharGlobal,"    "),J.test(D)||U.test(D)||$.test(D)||le.test(D)||F.test(D)||re.test(D))break;if(pe.search(this.rules.other.nonSpaceChar)>=S||!D.trim())b+=`
`+pe.slice(S);else{if(j||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||J.test(w)||U.test(w)||re.test(w))break;b+=`
`+D}j=!D.trim(),_+=Z+`
`,t=t.substring(Z.length+1),w=pe.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(_)&&(v=!0)),c.items.push({type:"list_item",raw:_,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),c.raw+=_}let h=c.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((s=y.tokens[0])==null?void 0:s.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let _=this.rules.other.listTaskCheckbox.exec(y.raw);if(_){let b={type:"checkbox",raw:_[0]+" ",checked:_[0]!=="[ ]"};y.checked=b.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=b.raw+y.tokens[0].raw,y.tokens[0].text=b.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(b)):y.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):y.tokens.unshift(b)}}if(!c.loose){let _=y.tokens.filter(w=>w.type==="space"),b=_.length>0&&_.some(w=>this.rules.other.anyLine.test(w.raw));c.loose=b}}if(c.loose)for(let y of c.items){y.loose=!0;for(let _ of y.tokens)_.type==="text"&&(_.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:s,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Vl(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===s.length){for(let d of s)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Vl(d,o.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[h]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Ya(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=Hv(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let s=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(s);o&&(s=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?s=s.slice(1):s=s.slice(1,-1)),Xl(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let s=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[s.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Xl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let s=this.rules.inline.emStrongLDelim.exec(t);if(!(!s||s[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,o,c,d=i,v=0,h=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(s=h.exec(e))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(c=[...o].length,s[3]||s[4]){d+=c;continue}else if((s[5]||s[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let y=[...s[0]][0].length,_=t.slice(0,i+s.index+y+c);if(Math.min(i,c)%2){let w=_.slice(1,-1);return{type:"em",raw:_,text:w,tokens:this.lexer.inlineTokens(w)}}let b=_.slice(2,-2);return{type:"strong",raw:_,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return s&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let s=this.rules.inline.delLDelim.exec(t);if(s&&(!s[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(s=v.exec(e))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o||(c=[...o].length,c!==i))continue;if(s[3]||s[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let h=[...s[0]][0].length,y=t.slice(0,i+s.index+h+c),_=y.slice(i,-i);return{type:"del",raw:y,text:_,tokens:this.lexer.inlineTokens(_)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,s;return e[2]==="@"?(r=e[1],s="mailto:"+r):(r=e[1],s=r),{type:"link",raw:e[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let s,i;if(e[2]==="@")s=e[0],i="mailto:"+s;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);s=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Tn=class fo{constructor(e){Ke(this,"tokens");Ke(this,"options");Ke(this,"state");Ke(this,"inlineQueue");Ke(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||aa,this.options.tokenizer=this.options.tokenizer||new ti,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Bt,block:zs.normal,inline:Wa.normal};this.options.pedantic?(r.block=zs.pedantic,r.inline=Wa.pedantic):this.options.gfm&&(r.block=zs.gfm,this.options.breaks?r.inline=Wa.breaks:r.inline=Wa.gfm),this.tokenizer.rules=r}static get rules(){return{block:zs,inline:Wa}}static lex(e,r){return new fo(r).lex(e)}static lexInline(e,r){return new fo(r).inlineTokens(e)}lex(e){e=e.replace(Bt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let s=this.inlineQueue[r];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],s=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Bt.tabCharGlobal,"    ").replace(Bt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let h=1/0,y=e.slice(1),_;this.options.extensions.startBlock.forEach(b=>{_=b.call({lexer:this},y),typeof _=="number"&&_>=0&&(h=Math.min(h,_))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);s&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),s=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,y,_,b;let s=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)o=i[2]?i[2].length:0,s=s.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},s))??s;let c=!1,d="";for(;e;){c||(d=""),c=!1;let w;if((_=(y=this.options.extensions)==null?void 0:y.inline)!=null&&_.some(j=>(w=j.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let j=r.at(-1);w.type==="text"&&(j==null?void 0:j.type)==="text"?(j.raw+=w.raw,j.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let D=e;if((b=this.options.extensions)!=null&&b.startInline){let j=1/0,S=e.slice(1),F;this.options.extensions.startInline.forEach(re=>{F=re.call({lexer:this},S),typeof F=="number"&&F>=0&&(j=Math.min(j,F))}),j<1/0&&j>=0&&(D=e.substring(0,j+1))}if(w=this.tokenizer.inlineText(D)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),c=!0;let j=r.at(-1);(j==null?void 0:j.type)==="text"?(j.raw+=w.raw,j.text+=w.text):r.push(w);continue}if(e){let j="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(j);break}else throw new Error(j)}}return r}},ni=class{constructor(t){Ke(this,"options");Ke(this,"parser");this.options=t||aa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let s=(o=(e||"").match(Bt.notSpaceStart))==null?void 0:o[0],i=t.replace(Bt.endingNewline,"")+`
`;return s?'<pre><code class="language-'+Xn(s)+'">'+(r?i:Xn(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Xn(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,s="";for(let c=0;c<t.items.length;c++){let d=t.items[c];s+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+s+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let s="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Xn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let s=this.parser.parseInline(r),i=Yl(t);if(i===null)return s;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Xn(e)+'"'),o+=">"+s+"</a>",o}image({href:t,title:e,text:r,tokens:s}){s&&(r=this.parser.parseInline(s,this.parser.textRenderer));let i=Yl(t);if(i===null)return Xn(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Xn(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Xn(t.text)}},Ho=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},An=class po{constructor(e){Ke(this,"options");Ke(this,"renderer");Ke(this,"textRenderer");this.options=e||aa,this.options.renderer=this.options.renderer||new ni,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ho}static parse(e,r){return new po(r).parse(e)}static parseInline(e,r){return new po(r).parseInline(e)}parse(e){var s,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[c.type]){let v=c,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let s="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){s+=h||"";continue}}let v=d;switch(v.type){case"escape":{s+=r.text(v);break}case"html":{s+=r.html(v);break}case"link":{s+=r.link(v);break}case"image":{s+=r.image(v);break}case"checkbox":{s+=r.checkbox(v);break}case"strong":{s+=r.strong(v);break}case"em":{s+=r.em(v);break}case"codespan":{s+=r.codespan(v);break}case"br":{s+=r.br(v);break}case"del":{s+=r.del(v);break}case"text":{s+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return s}},Us,es=(Us=class{constructor(t){Ke(this,"options");Ke(this,"block");this.options=t||aa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Tn.lex:Tn.lexInline}provideParser(){return this.block?An.parse:An.parseInline}},Ke(Us,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ke(Us,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Us),Vv=class{constructor(...t){Ke(this,"defaults",qo());Ke(this,"options",this.setOptions);Ke(this,"parse",this.parseMarkdown(!0));Ke(this,"parseInline",this.parseMarkdown(!1));Ke(this,"Parser",An);Ke(this,"Renderer",ni);Ke(this,"TextRenderer",Ho);Ke(this,"Lexer",Tn);Ke(this,"Tokenizer",ti);Ke(this,"Hooks",es);this.use(...t)}walkTokens(t,e){var s,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),s.extensions=e),r.renderer){let i=this.defaults.renderer||new ni(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y||""}}s.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ti(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}s.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new es;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];es.passThroughHooks.has(o)?i[c]=h=>{if(this.defaults.async&&es.passThroughHooksRespectAsync.has(o))return(async()=>{let _=await d.call(i,h);return v.call(i,_)})();let y=d.call(i,h);return v.call(i,y)}:i[c]=(...h)=>{if(this.defaults.async)return(async()=>{let _=await d.apply(i,h);return _===!1&&(_=await v.apply(i,h)),_})();let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}s.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;s.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...s}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Tn.lex(t,e??this.defaults)}parser(t,e){return An.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let s={...r},i={...this.defaults,...s},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let h=await(i.hooks?await i.hooks.provideParser():t?An.parse:An.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(h):h})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?An.parse:An.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let s="<p>An error occurred:</p><pre>"+Xn(r.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(r);throw r}}},na=new Vv;function Je(t,e){return na.parse(t,e)}Je.options=Je.setOptions=function(t){return na.setOptions(t),Je.defaults=na.defaults,Ac(Je.defaults),Je};Je.getDefaults=qo;Je.defaults=aa;Je.use=function(...t){return na.use(...t),Je.defaults=na.defaults,Ac(Je.defaults),Je};Je.walkTokens=function(t,e){return na.walkTokens(t,e)};Je.parseInline=na.parseInline;Je.Parser=An;Je.parser=An.parse;Je.Renderer=ni;Je.TextRenderer=Ho;Je.Lexer=Tn;Je.lexer=Tn.lex;Je.Tokenizer=ti;Je.Hooks=es;Je.parse=Je;Je.options;Je.setOptions;Je.use;Je.walkTokens;Je.parseInline;An.parse;Tn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Bc,setPrototypeOf:Ql,isFrozen:Xv,getPrototypeOf:Qv,getOwnPropertyDescriptor:Zv}=Object;let{freeze:zt,seal:mn,create:ho}=Object,{apply:vo,construct:go}=typeof Reflect<"u"&&Reflect;zt||(zt=function(e){return e});mn||(mn=function(e){return e});vo||(vo=function(e,r){for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o];return e.apply(r,i)});go||(go=function(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return new e(...s)});const Fs=Ft(Array.prototype.forEach),Jv=Ft(Array.prototype.lastIndexOf),Zl=Ft(Array.prototype.pop),Va=Ft(Array.prototype.push),$v=Ft(Array.prototype.splice),Qs=Ft(String.prototype.toLowerCase),Ui=Ft(String.prototype.toString),Gi=Ft(String.prototype.match),Xa=Ft(String.prototype.replace),eg=Ft(String.prototype.indexOf),tg=Ft(String.prototype.trim),Sn=Ft(Object.prototype.hasOwnProperty),jt=Ft(RegExp.prototype.test),Qa=ng(TypeError);function Ft(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return vo(t,e,s)}}function ng(t){return function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return go(t,r)}}function Fe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qs;Ql&&Ql(t,null);let s=e.length;for(;s--;){let i=e[s];if(typeof i=="string"){const o=r(i);o!==i&&(Xv(e)||(e[s]=o),i=o)}t[i]=!0}return t}function rg(t){for(let e=0;e<t.length;e++)Sn(t,e)||(t[e]=null);return t}function qn(t){const e=ho(null);for(const[r,s]of Bc(t))Sn(t,r)&&(Array.isArray(s)?e[r]=rg(s):s&&typeof s=="object"&&s.constructor===Object?e[r]=qn(s):e[r]=s);return e}function Za(t,e){for(;t!==null;){const s=Zv(t,e);if(s){if(s.get)return Ft(s.get);if(typeof s.value=="function")return Ft(s.value)}t=Qv(t)}function r(){return null}return r}const Jl=zt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hi=zt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wi=zt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ag=zt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yi=zt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),sg=zt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$l=zt(["#text"]),eu=zt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vi=zt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),tu=zt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ks=zt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ig=mn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),og=mn(/<%[\w\W]*|[\w\W]*%>/gm),lg=mn(/\$\{[\w\W]*/gm),ug=mn(/^data-[\-\w.\u00B7-\uFFFF]+$/),cg=mn(/^aria-[\-\w]+$/),zc=mn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fg=mn(/^(?:\w+script|data):/i),dg=mn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Fc=mn(/^html$/i),pg=mn(/^[a-z][.\w]*(-[.\w]+)+$/i);var nu=Object.freeze({__proto__:null,ARIA_ATTR:cg,ATTR_WHITESPACE:dg,CUSTOM_ELEMENT:pg,DATA_ATTR:ug,DOCTYPE_NAME:Fc,ERB_EXPR:og,IS_ALLOWED_URI:zc,IS_SCRIPT_OR_DATA:fg,MUSTACHE_EXPR:ig,TMPLIT_EXPR:lg});const Ja={element:1,text:3,progressingInstruction:7,comment:8,document:9},hg=function(){return typeof window>"u"?null:window},vg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(s=r.getAttribute(i));const o="dompurify"+(s?"#"+s:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},ru=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Kc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hg();const e=Re=>Kc(Re);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==Ja.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const s=r,i=s.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:h,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:_,DOMParser:b,trustedTypes:w}=t,D=v.prototype,j=Za(D,"cloneNode"),S=Za(D,"remove"),F=Za(D,"nextSibling"),re=Za(D,"childNodes"),J=Za(D,"parentNode");if(typeof c=="function"){const Re=r.createElement("template");Re.content&&Re.content.ownerDocument&&(r=Re.content.ownerDocument)}let U,$="";const{implementation:le,createNodeIterator:Z,createDocumentFragment:pe,getElementsByTagName:Me}=r,{importNode:_e}=s;let me=ru();e.isSupported=typeof Bc=="function"&&typeof J=="function"&&le&&le.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ie,ERB_EXPR:ae,TMPLIT_EXPR:Le,DATA_ATTR:W,ARIA_ATTR:Q,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:ne}=nu;let{IS_ALLOWED_URI:te}=nu,K=null;const fe=Fe({},[...Jl,...Hi,...Wi,...Yi,...$l]);let Se=null;const Ae=Fe({},[...eu,...Vi,...tu,...Ks]);let Te=Object.seal(ho(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$e=null,De=null;const tt=Object.seal(ho(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let vt=!0,ke=!0,Nt=!1,He=!0,rn=!1,sa=!0,qt=!1,Ra=!1,Pa=!1,sr=!1,ia=!1,ir=!1,Xt=!0,Oa=!1;const Tr="user-content-";let oa=!0,yn=!1,gt={},yt=null;const Ar=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let or=null;const la=Fe({},["audio","video","img","source","image","track"]);let lr=null;const Dn=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gn="http://www.w3.org/1998/Math/MathML",ur="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Ie=bt,Hn=!1,bn=null;const ua=Fe({},[Gn,ur,bt],Ui);let be=Fe({},["mi","mo","mn","ms","mtext"]),cr=Fe({},["annotation-xml"]);const ms=Fe({},["title","style","font","a","script"]);let Wn=null;const ys=["application/xhtml+xml","text/html"],Da="text/html";let ft=null,fr=null;const dr=r.createElement("form"),Yn=function(T){return T instanceof RegExp||T instanceof Function},Cr=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fr&&fr===T)){if((!T||typeof T!="object")&&(T={}),T=qn(T),Wn=ys.indexOf(T.PARSER_MEDIA_TYPE)===-1?Da:T.PARSER_MEDIA_TYPE,ft=Wn==="application/xhtml+xml"?Ui:Qs,K=Sn(T,"ALLOWED_TAGS")?Fe({},T.ALLOWED_TAGS,ft):fe,Se=Sn(T,"ALLOWED_ATTR")?Fe({},T.ALLOWED_ATTR,ft):Ae,bn=Sn(T,"ALLOWED_NAMESPACES")?Fe({},T.ALLOWED_NAMESPACES,Ui):ua,lr=Sn(T,"ADD_URI_SAFE_ATTR")?Fe(qn(Dn),T.ADD_URI_SAFE_ATTR,ft):Dn,or=Sn(T,"ADD_DATA_URI_TAGS")?Fe(qn(la),T.ADD_DATA_URI_TAGS,ft):la,yt=Sn(T,"FORBID_CONTENTS")?Fe({},T.FORBID_CONTENTS,ft):Ar,$e=Sn(T,"FORBID_TAGS")?Fe({},T.FORBID_TAGS,ft):qn({}),De=Sn(T,"FORBID_ATTR")?Fe({},T.FORBID_ATTR,ft):qn({}),gt=Sn(T,"USE_PROFILES")?T.USE_PROFILES:!1,vt=T.ALLOW_ARIA_ATTR!==!1,ke=T.ALLOW_DATA_ATTR!==!1,Nt=T.ALLOW_UNKNOWN_PROTOCOLS||!1,He=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,rn=T.SAFE_FOR_TEMPLATES||!1,sa=T.SAFE_FOR_XML!==!1,qt=T.WHOLE_DOCUMENT||!1,sr=T.RETURN_DOM||!1,ia=T.RETURN_DOM_FRAGMENT||!1,ir=T.RETURN_TRUSTED_TYPE||!1,Pa=T.FORCE_BODY||!1,Xt=T.SANITIZE_DOM!==!1,Oa=T.SANITIZE_NAMED_PROPS||!1,oa=T.KEEP_CONTENT!==!1,yn=T.IN_PLACE||!1,te=T.ALLOWED_URI_REGEXP||zc,Ie=T.NAMESPACE||bt,be=T.MATHML_TEXT_INTEGRATION_POINTS||be,cr=T.HTML_INTEGRATION_POINTS||cr,Te=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&Yn(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&Yn(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Te.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),rn&&(ke=!1),ia&&(sr=!0),gt&&(K=Fe({},$l),Se=[],gt.html===!0&&(Fe(K,Jl),Fe(Se,eu)),gt.svg===!0&&(Fe(K,Hi),Fe(Se,Vi),Fe(Se,Ks)),gt.svgFilters===!0&&(Fe(K,Wi),Fe(Se,Vi),Fe(Se,Ks)),gt.mathMl===!0&&(Fe(K,Yi),Fe(Se,tu),Fe(Se,Ks))),T.ADD_TAGS&&(typeof T.ADD_TAGS=="function"?tt.tagCheck=T.ADD_TAGS:(K===fe&&(K=qn(K)),Fe(K,T.ADD_TAGS,ft))),T.ADD_ATTR&&(typeof T.ADD_ATTR=="function"?tt.attributeCheck=T.ADD_ATTR:(Se===Ae&&(Se=qn(Se)),Fe(Se,T.ADD_ATTR,ft))),T.ADD_URI_SAFE_ATTR&&Fe(lr,T.ADD_URI_SAFE_ATTR,ft),T.FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,T.FORBID_CONTENTS,ft)),T.ADD_FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,T.ADD_FORBID_CONTENTS,ft)),oa&&(K["#text"]=!0),qt&&Fe(K,["html","head","body"]),K.table&&(Fe(K,["tbody"]),delete $e.tbody),T.TRUSTED_TYPES_POLICY){if(typeof T.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof T.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=T.TRUSTED_TYPES_POLICY,$=U.createHTML("")}else U===void 0&&(U=vg(w,i)),U!==null&&typeof $=="string"&&($=U.createHTML(""));zt&&zt(T),fr=T}},Ir=Fe({},[...Hi,...Wi,...ag]),nt=Fe({},[...Yi,...sg]),mt=function(T){let ue=J(T);(!ue||!ue.tagName)&&(ue={namespaceURI:Ie,tagName:"template"});const he=Qs(T.tagName),Xe=Qs(ue.tagName);return bn[T.namespaceURI]?T.namespaceURI===ur?ue.namespaceURI===bt?he==="svg":ue.namespaceURI===Gn?he==="svg"&&(Xe==="annotation-xml"||be[Xe]):!!Ir[he]:T.namespaceURI===Gn?ue.namespaceURI===bt?he==="math":ue.namespaceURI===ur?he==="math"&&cr[Xe]:!!nt[he]:T.namespaceURI===bt?ue.namespaceURI===ur&&!cr[Xe]||ue.namespaceURI===Gn&&!be[Xe]?!1:!nt[he]&&(ms[he]||!Ir[he]):!!(Wn==="application/xhtml+xml"&&bn[T.namespaceURI]):!1},an=function(T){Va(e.removed,{element:T});try{J(T).removeChild(T)}catch{S(T)}},sn=function(T,ue){try{Va(e.removed,{attribute:ue.getAttributeNode(T),from:ue})}catch{Va(e.removed,{attribute:null,from:ue})}if(ue.removeAttribute(T),T==="is")if(sr||ia)try{an(ue)}catch{}else try{ue.setAttribute(T,"")}catch{}},Rr=function(T){let ue=null,he=null;if(Pa)T="<remove></remove>"+T;else{const it=Gi(T,/^[\r\n\t ]+/);he=it&&it[0]}Wn==="application/xhtml+xml"&&Ie===bt&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");const Xe=U?U.createHTML(T):T;if(Ie===bt)try{ue=new b().parseFromString(Xe,Wn)}catch{}if(!ue||!ue.documentElement){ue=le.createDocument(Ie,"template",null);try{ue.documentElement.innerHTML=Hn?$:Xe}catch{}}const rt=ue.body||ue.documentElement;return T&&he&&rt.insertBefore(r.createTextNode(he),rt.childNodes[0]||null),Ie===bt?Me.call(ue,qt?"html":"body")[0]:qt?ue.documentElement:rt},Pr=function(T){return Z.call(T.ownerDocument||T,T,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Ma=function(T){return T instanceof _&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof y)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},_n=function(T){return typeof d=="function"&&T instanceof d};function Pt(Re,T,ue){Fs(Re,he=>{he.call(e,T,ue,fr)})}const wn=function(T){let ue=null;if(Pt(me.beforeSanitizeElements,T,null),Ma(T))return an(T),!0;const he=ft(T.nodeName);if(Pt(me.uponSanitizeElement,T,{tagName:he,allowedTags:K}),sa&&T.hasChildNodes()&&!_n(T.firstElementChild)&&jt(/<[/\w!]/g,T.innerHTML)&&jt(/<[/\w!]/g,T.textContent)||T.nodeType===Ja.progressingInstruction||sa&&T.nodeType===Ja.comment&&jt(/<[/\w]/g,T.data))return an(T),!0;if(!(tt.tagCheck instanceof Function&&tt.tagCheck(he))&&(!K[he]||$e[he])){if(!$e[he]&&bs(he)&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,he)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(he)))return!1;if(oa&&!yt[he]){const Xe=J(T)||T.parentNode,rt=re(T)||T.childNodes;if(rt&&Xe){const it=rt.length;for(let dt=it-1;dt>=0;--dt){const Ut=j(rt[dt],!0);Ut.__removalCount=(T.__removalCount||0)+1,Xe.insertBefore(Ut,F(T))}}}return an(T),!0}return T instanceof v&&!mt(T)||(he==="noscript"||he==="noembed"||he==="noframes")&&jt(/<\/no(script|embed|frames)/i,T.innerHTML)?(an(T),!0):(rn&&T.nodeType===Ja.text&&(ue=T.textContent,Fs([ie,ae,Le],Xe=>{ue=Xa(ue,Xe," ")}),T.textContent!==ue&&(Va(e.removed,{element:T.cloneNode()}),T.textContent=ue)),Pt(me.afterSanitizeElements,T,null),!1)},Or=function(T,ue,he){if(Xt&&(ue==="id"||ue==="name")&&(he in r||he in dr))return!1;if(!(ke&&!De[ue]&&jt(W,ue))){if(!(vt&&jt(Q,ue))){if(!(tt.attributeCheck instanceof Function&&tt.attributeCheck(ue,T))){if(!Se[ue]||De[ue]){if(!(bs(T)&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,T)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(T))&&(Te.attributeNameCheck instanceof RegExp&&jt(Te.attributeNameCheck,ue)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(ue,T))||ue==="is"&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,he)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(he))))return!1}else if(!lr[ue]){if(!jt(te,Xa(he,Y,""))){if(!((ue==="src"||ue==="xlink:href"||ue==="href")&&T!=="script"&&eg(he,"data:")===0&&or[T])){if(!(Nt&&!jt(ee,Xa(he,Y,"")))){if(he)return!1}}}}}}}return!0},bs=function(T){return T!=="annotation-xml"&&Gi(T,ne)},kn=function(T){Pt(me.beforeSanitizeAttributes,T,null);const{attributes:ue}=T;if(!ue||Ma(T))return;const he={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se,forceKeepAttr:void 0};let Xe=ue.length;for(;Xe--;){const rt=ue[Xe],{name:it,namespaceURI:dt,value:Ut}=rt,Mn=ft(it),Dr=Ut;let st=it==="value"?Dr:tg(Dr);if(he.attrName=Mn,he.attrValue=st,he.keepAttr=!0,he.forceKeepAttr=void 0,Pt(me.uponSanitizeAttribute,T,he),st=he.attrValue,Oa&&(Mn==="id"||Mn==="name")&&(sn(it,T),st=Tr+st),sa&&jt(/((--!?|])>)|<\/(style|title|textarea)/i,st)){sn(it,T);continue}if(Mn==="attributename"&&Gi(st,"href")){sn(it,T);continue}if(he.forceKeepAttr)continue;if(!he.keepAttr){sn(it,T);continue}if(!He&&jt(/\/>/i,st)){sn(it,T);continue}rn&&Fs([ie,ae,Le],Mr=>{st=Xa(st,Mr," ")});const La=ft(T.nodeName);if(!Or(La,Mn,st)){sn(it,T);continue}if(U&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!dt)switch(w.getAttributeType(La,Mn)){case"TrustedHTML":{st=U.createHTML(st);break}case"TrustedScriptURL":{st=U.createScriptURL(st);break}}if(st!==Dr)try{dt?T.setAttributeNS(dt,it,st):T.setAttribute(it,st),Ma(T)?an(T):Zl(e.removed)}catch{sn(it,T)}}Pt(me.afterSanitizeAttributes,T,null)},_s=function Re(T){let ue=null;const he=Pr(T);for(Pt(me.beforeSanitizeShadowDOM,T,null);ue=he.nextNode();)Pt(me.uponSanitizeShadowNode,ue,null),wn(ue),kn(ue),ue.content instanceof o&&Re(ue.content);Pt(me.afterSanitizeShadowDOM,T,null)};return e.sanitize=function(Re){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=null,he=null,Xe=null,rt=null;if(Hn=!Re,Hn&&(Re="<!-->"),typeof Re!="string"&&!_n(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Qa("dirty is not a string, aborting")}else throw Qa("toString is not a function");if(!e.isSupported)return Re;if(Ra||Cr(T),e.removed=[],typeof Re=="string"&&(yn=!1),yn){if(Re.nodeName){const Ut=ft(Re.nodeName);if(!K[Ut]||$e[Ut])throw Qa("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof d)ue=Rr("<!---->"),he=ue.ownerDocument.importNode(Re,!0),he.nodeType===Ja.element&&he.nodeName==="BODY"||he.nodeName==="HTML"?ue=he:ue.appendChild(he);else{if(!sr&&!rn&&!qt&&Re.indexOf("<")===-1)return U&&ir?U.createHTML(Re):Re;if(ue=Rr(Re),!ue)return sr?null:ir?$:""}ue&&Pa&&an(ue.firstChild);const it=Pr(yn?Re:ue);for(;Xe=it.nextNode();)wn(Xe),kn(Xe),Xe.content instanceof o&&_s(Xe.content);if(yn)return Re;if(sr){if(ia)for(rt=pe.call(ue.ownerDocument);ue.firstChild;)rt.appendChild(ue.firstChild);else rt=ue;return(Se.shadowroot||Se.shadowrootmode)&&(rt=_e.call(s,rt,!0)),rt}let dt=qt?ue.outerHTML:ue.innerHTML;return qt&&K["!doctype"]&&ue.ownerDocument&&ue.ownerDocument.doctype&&ue.ownerDocument.doctype.name&&jt(Fc,ue.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+ue.ownerDocument.doctype.name+`>
`+dt),rn&&Fs([ie,ae,Le],Ut=>{dt=Xa(dt,Ut," ")}),U&&ir?U.createHTML(dt):dt},e.setConfig=function(){let Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cr(Re),Ra=!0},e.clearConfig=function(){fr=null,Ra=!1},e.isValidAttribute=function(Re,T,ue){fr||Cr({});const he=ft(Re),Xe=ft(T);return Or(he,Xe,ue)},e.addHook=function(Re,T){typeof T=="function"&&Va(me[Re],T)},e.removeHook=function(Re,T){if(T!==void 0){const ue=Jv(me[Re],T);return ue===-1?void 0:$v(me[Re],ue,1)[0]}return Zl(me[Re])},e.removeHooks=function(Re){me[Re]=[]},e.removeAllHooks=function(){me=ru()},e}var gg=Kc();function mg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${au(t.from)} |`),e.push(`| **To** | ${au(t.to)} |`),e.push(`| **Date** | ${Lo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?yg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function au(t){return(t||"").replace(/\|/g,"\\|")}function yg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return mo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function bg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),s=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||s>0&&s<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function mo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return bg(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(mo).join(""),s=r.trim();if(!s&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${s}

`;if(e==="blockquote")return`

> ${s.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${s}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${s}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?s:s===o?o:`[${s}](${o})`}if(e==="strong"||e==="b")return`**${s}**`;if(e==="em"||e==="i")return`*${s}*`;if(e==="code")return`\`${s}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>mo(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function _g(t){return gc(t,"md")}function su(t,e,r="text/markdown;charset=utf-8"){const s=new Blob([t],{type:r}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function wg(t){return t.raw||null}function kg(t){const e=wg(t);return e?JSON.stringify(e,null,2):"null"}function xg(t){return gc(t,"json")}var Sg=X('<button title="View as Markdown">.md</button>'),Eg=X('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Tg=X('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Ag=X('<div class="md-preview svelte-1b0rzpb"><!></div>'),Cg=X('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Ig=X('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Rg=X('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Pg=X('<pre class="message-text svelte-1b0rzpb"> </pre>'),Og=X('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),Dg=X('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Mg=X('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Lg(t,e){lt(e,!0);let r=Pe(e,"loading",3,!1);Rt(()=>nn("MessageModal"));const s=new Je.Renderer;s.link=({href:ie,title:ae,text:Le})=>{const W=ae?` title="${ae}"`:"";return`<a href="${ie}"${W} target="_blank" rel="noopener">${Le}</a>`},Je.setOptions({breaks:!0,gfm:!0,renderer:s});let i=Oe("email"),o=Mt(()=>e.message.body?mg(e.message):""),c=Mt(()=>kg(e.message)),d=Oe("raw");function v(ie){z(i,k(i)===ie?"email":ie,!0),ie==="markdown"&&z(d,"raw")}function h(){su(k(o),_g(e.message))}function y(){su(k(c),xg(e.message),"application/json;charset=utf-8")}function _(ie){const ae=Je.parse(ie);return gg.sanitize(ae,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let b=Oe(null);Js(()=>{var ie;if(k(b)&&e.message.htmlBody&&!r()&&k(i)==="email"){const ae=k(b).contentDocument||((ie=k(b).contentWindow)==null?void 0:ie.document);ae&&(ae.open(),ae.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ae.close())}});var w=Mg();w.__click=function(...ie){var ae;(ae=e.onclose)==null||ae.apply(this,ie)};var D=x(w);D.__click=ie=>ie.stopPropagation();var j=x(D),S=x(j),F=x(S),re=M(S,2),J=x(re);let U;J.__click=()=>v("json");var $=M(J,2);{var le=ie=>{var ae=Sg();let Le;ae.__click=()=>v("markdown"),ye(()=>Le=dn(ae,1,"action-btn svelte-1b0rzpb",null,Le,{active:k(i)==="markdown"})),G(ie,ae)};we($,ie=>{e.message.body&&ie(le)})}var Z=M($,2);Z.__click=function(...ie){var ae;(ae=e.onclose)==null||ae.apply(this,ie)};var pe=M(j,2);{var Me=ie=>{var ae=Eg(),Le=xt(ae),W=M(x(Le),2);W.__click=y;var Q=M(Le,2),ee=x(Q),Y=x(ee);ye(()=>ce(Y,k(c))),G(ie,ae)},_e=ie=>{var ae=Cg(),Le=xt(ae),W=x(Le),Q=x(W);let ee;Q.__click=()=>z(d,"raw");var Y=M(Q,2);let ne;Y.__click=()=>z(d,"preview");var te=M(W,2);te.__click=h;var K=M(Le,2),fe=x(K);{var Se=Te=>{var $e=Tg(),De=x($e);ye(()=>ce(De,k(o))),G(Te,$e)},Ae=Te=>{var $e=Ag(),De=x($e);Md(De,()=>_(k(o))),G(Te,$e)};we(fe,Te=>{k(d)==="raw"?Te(Se):Te(Ae,!1)})}ye(()=>{ee=dn(Q,1,"md-tab svelte-1b0rzpb",null,ee,{active:k(d)==="raw"}),ne=dn(Y,1,"md-tab svelte-1b0rzpb",null,ne,{active:k(d)==="preview"})}),G(ie,ae)},me=ie=>{var ae=Dg(),Le=xt(ae),W=x(Le),Q=M(x(W),2),ee=x(Q),Y=M(W,2),ne=M(x(Y),2),te=x(ne),K=M(Y,2),fe=M(x(K),2),Se=x(fe),Ae=M(Le,2),Te=x(Ae);{var $e=ke=>{var Nt=Ig();G(ke,Nt)},De=ke=>{var Nt=Rg();oc(Nt,He=>z(b,He),()=>k(b)),G(ke,Nt)},tt=ke=>{var Nt=Pg(),He=x(Nt);ye(()=>ce(He,e.message.body)),G(ke,Nt)},vt=ke=>{var Nt=Og();G(ke,Nt)};we(Te,ke=>{r()?ke($e):e.message.htmlBody?ke(De,1):e.message.body?ke(tt,2):ke(vt,!1)})}ye(ke=>{ce(ee,e.message.from),ce(te,e.message.to),ce(Se,ke)},[()=>Lo(e.message.date)]),G(ie,ae)};we(pe,ie=>{k(i)==="json"?ie(Me):k(i)==="markdown"?ie(_e,1):ie(me,!1)})}ye(()=>{ce(F,e.message.subject),U=dn(J,1,"action-btn svelte-1b0rzpb",null,U,{active:k(i)==="json"})}),G(t,w),ut()}Kt(["click"]);var Ng=X('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),qg=X('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),jg=X('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Bg=X("<p> </p>"),zg=X('<p>No emails in local storage. Click "Sync New" to download.</p>'),Fg=X('<div class="empty-state svelte-6ts5xm"><!></div>'),Kg=X('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),Ug=X('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Gg(t,e){lt(e,!0),Rt(()=>nn("DashboardView"));let r=Pe(e,"error",3,null),s=Pe(e,"profile",3,null),i=Pe(e,"loadingProfile",3,!1),o=Pe(e,"emailMessages",19,()=>[]),c=Pe(e,"totalLocalMessages",3,0),d=Pe(e,"hasMoreLocal",3,!1),v=Pe(e,"loadingMessages",3,!1),h=Pe(e,"selectedMessage",3,null),y=Pe(e,"syncStatus",3,null),_=Pe(e,"syncProgress",3,null),b=Pe(e,"isSyncing",3,!1),w=Pe(e,"searchQuery",15);var D=Ug(),j=xt(D),S=x(j);{var F=W=>{Tc(W,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};we(S,W=>{r()&&W(F)})}var re=M(S,2);Uh(re,{get profile(){return s()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var J=M(re,2);nv(J,{get syncStatus(){return y()},get syncProgress(){return _()},get isSyncing(){return b()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var U=M(J,2),$=x(U);$.__keydown=W=>W.key==="Enter"&&e.onsearch();var le=M($,2);le.__click=function(...W){var Q;(Q=e.onsearch)==null||Q.apply(this,W)};var Z=x(le),pe=M(U,2);{var Me=W=>{var Q=qg(),ee=xt(Q),Y=x(ee),ne=x(Y),te=M(ee,2);sv(te,{get messages(){return o()},get onselect(){return e.onviewmessage}});var K=M(te,2);{var fe=Se=>{var Ae=Ng(),Te=x(Ae);Te.__click=function(...De){var tt;(tt=e.onloadmore)==null||tt.apply(this,De)};var $e=x(Te);ye(()=>{Te.disabled=v(),ce($e,v()?"Loading...":"Load More")}),G(Se,Ae)};we(K,Se=>{d()&&Se(fe)})}ye(Se=>ce(ne,`Showing ${o().length??""} of ${Se??""}
        ${w()?" matching":""} emails`),[()=>c().toLocaleString()]),G(W,Q)},_e=W=>{var Q=jg();G(W,Q)},me=W=>{var Q=Fg(),ee=x(Q);{var Y=te=>{var K=Bg(),fe=x(K);ye(()=>ce(fe,`No emails match "${w()??""}".`)),G(te,K)},ne=te=>{var K=zg();G(te,K)};we(ee,te=>{w()?te(Y):te(ne,!1)})}G(W,Q)},ie=W=>{var Q=Kg();G(W,Q)};we(pe,W=>{var Q;o().length>0?W(Me):v()?W(_e,1):(Q=y())!=null&&Q.synced?W(me,2):W(ie,!1)})}var ae=M(j,2);{var Le=W=>{Lg(W,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};we(ae,W=>{h()&&W(Le)})}ye(()=>{le.disabled=v(),ce(Z,v()?"Searching...":"Search")}),Do($,w),G(t,D),ut()}Kt(["keydown","click"]);var Hg=X('<div class="dashboard svelte-1q5o2lv"><!></div>');function Wg(t,e){lt(e,!0);function r(De){De.key==="Escape"&&k(v)&&ee()}Rt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let s=Oe(wt(localStorage.getItem("googleClientId")||"")),i=Oe(wt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),h=Oe(""),y=Oe(wt([])),_=Oe(0),b=Oe(0),w=Oe(!1),D=Oe(!1),j=Oe(!1),S=Oe(null),F=Oe(null),re=Oe(null),J=Oe(!1);const U=50;Js(()=>{k(c)&&(Y(),ae())});let $=Mt(()=>!k(s)),le=Mt(()=>!!k(c)),Z=Mt(()=>k(y).length<k(_));Js(()=>{k(s)&&!k(o)&&Kl(k(s)).then(()=>{z(o,!0)}).catch(De=>{z(S,`Auth init failed: ${De.message}`)})});function pe(){const De=k(i).trim();De&&(localStorage.setItem("googleClientId",De),z(s,De,!0),z(S,null))}function Me(){localStorage.removeItem("googleClientId"),z(s,""),z(i,""),z(o,!1),z(c,null),z(d,null),z(y,[],!0),z(_,0)}async function _e(){z(S,null),z(D,!0);try{k(o)||(await Kl(k(s)),z(o,!0));const De=await mh();z(c,De.access_token,!0),await ie()}catch(De){z(S,De.message,!0)}finally{z(D,!1)}}async function me(){if(k(c))try{await yh(k(c))}catch{}z(c,null),z(d,null),z(y,[],!0),z(_,0),z(v,null),z(S,null)}async function ie(){z(j,!0);try{const De=await dc(k(c));if(!k(c))return;z(d,De,!0)}catch(De){if(!k(c))return;z(S,`Profile fetch failed: ${De.message}`)}finally{z(j,!1)}}async function ae(De=!1){z(w,!0);try{const tt=De?k(b):0,vt=await lp({query:k(h)||void 0,limit:U,offset:tt});De?z(y,[...k(y),...vt.items],!0):z(y,vt.items,!0),z(_,vt.total,!0),z(b,k(y).length,!0)}catch(tt){z(S,`Failed to load messages: ${tt.message}`)}finally{z(w,!1)}}function Le(){z(b,0),ae(!1)}function W(){ae(!0)}function Q(De){z(v,De,!0)}function ee(){z(v,null)}async function Y(){try{z(F,await wh(),!0)}catch{}}async function ne(De){if(k(J)||!k(c))return;z(S,null),z(J,!0),z(re,null);const tt=new AbortController;try{await bh(k(c),{limit:De,onProgress:vt=>{z(re,{...vt},!0)},signal:tt.signal}),await Y(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;z(S,`Sync failed: ${vt.message}`)}}finally{z(J,!1)}}async function te(De){if(k(J)||!k(c))return;z(S,null),z(J,!0),z(re,null);const tt=new AbortController;try{await _h(k(c),{limit:De,onProgress:vt=>{z(re,{...vt},!0)},signal:tt.signal}),await Y(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;z(S,`Sync more failed: ${vt.message}`)}}finally{z(J,!1)}}async function K(){try{await kh(),await Y(),z(y,[],!0),z(_,0),z(b,0)}catch(De){z(S,`Failed to clear data: ${De.message}`)}}var fe=Hg(),Se=x(fe);{var Ae=De=>{Ch(De,{onsave:pe,get clientIdInput(){return k(i)},set clientIdInput(tt){z(i,tt,!0)}})},Te=De=>{Bh(De,{get clientId(){return k(s)},get error(){return k(S)},get loadingAuth(){return k(D)},onsignin:_e,onclear:Me,onsignout:me})},$e=De=>{Gg(De,{get error(){return k(S)},get profile(){return k(d)},get loadingProfile(){return k(j)},get emailMessages(){return k(y)},get totalLocalMessages(){return k(_)},get hasMoreLocal(){return k(Z)},get loadingMessages(){return k(w)},get selectedMessage(){return k(v)},get syncStatus(){return k(F)},get syncProgress(){return k(re)},get isSyncing(){return k(J)},onsignout:me,onsearch:Le,onloadmore:W,onviewmessage:Q,onclosedetail:ee,ondismisserror:()=>z(S,null),onsync:ne,onsyncmore:te,oncleardata:K,get searchQuery(){return k(h)},set searchQuery(tt){z(h,tt,!0)}})};we(Se,De=>{k($)?De(Ae):k(le)?De($e,!1):De(Te,1)})}G(t,fe),ut()}const Yg=20,Vg=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Xg(t,{count:e=Yg,force:r=!1,onProgress:s=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");s({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().limit(e).toArray();else{const h=new Set((await Ne.emailClassifications.toArray()).map(_=>_.emailId)),y=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().toArray();o=0,i=[];for(const _ of y)if(h.has(_.id))o++;else if(i.push(_),i.length>=e)break}if(i.length===0){const h=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return s({phase:"done",message:h,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let h=0;h<i.length;h++){const y=i[h];s({phase:"scanning",message:`Classifying email ${h+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:h+1,total:i.length,classified:d});try{const _=nm(y),b=[{role:"system",content:Vg},{role:"user",content:_}],w=await t.generateFull(b),D=rm(w);D&&(await Ne.emailClassifications.put({emailId:y.id,action:D.action,reason:D.reason,summary:D.summary,tags:D.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:c,status:"pending"}),d++)}catch(_){console.error(`Triage email ${h+1} failed:`,_),v++}}return s({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function Qg(){const t=await Ne.emailClassifications.toArray();return mc(t)}async function Zg(){const t=await Ne.emailClassifications.toArray(),e={total:t.length};for(const r of t){const s=r.action||"UNKNOWN";e[s]=(e[s]||0)+1}return e}async function iu(t,e){await Ne.emailClassifications.update(t,{status:e})}async function Jg(){await Ne.emailClassifications.clear()}async function $g(t){await Ne.emailClassifications.where("action").equals(t).delete()}async function em(t){await Ne.emailClassifications.delete(t)}async function tm(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function nm(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=cc(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function rm(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),s=e.lastIndexOf("}");if(r===-1||s===-1||s<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,s+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=am(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(h=>typeof h=="string"&&h.trim()).map(h=>h.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function am(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function sm(t){return`hsl(${fc(t)}, 55%, 55%)`}function im(t){return`hsl(${fc(t)}, 40%, 35%)`}var om=X('<span class="spinner svelte-ois7em"></span>'),lm=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),um=X('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),cm=X('<option class="svelte-ois7em"> </option>'),fm=X('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),dm=X('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),pm=X('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function hm(t,e){lt(e,!0);let r=Pe(e,"engineStatus",3,"idle"),s=Pe(e,"modelName",3,""),i=Pe(e,"isScanning",3,!1),o=Pe(e,"scanProgress",3,null),c=Pe(e,"scanCount",15,20),d=Pe(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function h(){return r()==="ready"?`${s()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function _(){return r()==="ready"&&!i()}var b=pm(),w=x(b),D=x(w),j=x(D);{var S=te=>{var K=om();G(te,K)},F=te=>{var K=lm();G(te,K)};we(j,te=>{i()?te(S):te(F,!1)})}var re=M(D,2),J=M(x(re),2),U=x(J);let $;var le=M(U),Z=M(w,2);{var pe=te=>{var K=um(),fe=x(K),Se=x(fe),Ae=M(fe,4),Te=x(Ae),$e=M(Ae,4),De=x($e);ye(()=>{ce(Se,`${d().totalEmails??""} emails in storage`),ce(Te,`${d().classified??""} classified`),ce(De,`${d().unclassified??""} new`)}),G(te,K)};we(Z,te=>{d()&&te(pe)})}var Me=M(Z,2),_e=x(Me),me=M(x(_e),2);gn(me,21,()=>v,Er,(te,K)=>{var fe=cm(),Se=x(fe),Ae={};ye(()=>{ce(Se,k(K).label),Ae!==(Ae=k(K).value)&&(fe.value=(fe.__value=k(K).value)??"")}),G(te,fe)});var ie=M(_e,2),ae=x(ie);ae.__click=function(...te){var K;(K=e.onscan)==null||K.apply(this,te)};var Le=x(ae),W=M(ae,2);W.__click=function(...te){var K;(K=e.onrescan)==null||K.apply(this,te)};var Q=M(Me,2);{var ee=te=>{var K=fm();G(te,K)};we(Q,te=>{r()!=="ready"&&r()!=="loading"&&te(ee)})}var Y=M(Q,2);{var ne=te=>{var K=dm(),fe=x(K),Se=x(fe);let Ae,Te;var $e=M(fe,2),De=x($e);ye(()=>{Ae=dn(Se,1,"progress-fill svelte-ois7em",null,Ae,{indeterminate:!o().total}),Te=Rn(Se,"",Te,{width:`${o().total?o().current/o().total*100:0}%`}),ce(De,o().message||"Scanning...")}),G(te,K)};we(Y,te=>{i()&&o()&&te(ne)})}ye((te,K,fe,Se)=>{$=Rn(U,"",$,te),ce(le,` ${K??""}`),me.disabled=i(),ae.disabled=fe,ce(Le,i()?"Scanning...":"Scan New"),W.disabled=Se},[()=>({background:y()}),h,()=>!_(),()=>!_()]),Oo(me,c),G(t,b),ut()}Kt(["click"]);var vm=X('<span class="row-date svelte-1czytqk"> </span>'),gm=X('<span class="tag svelte-1czytqk"> </span>'),mm=X('<span class="row-tags svelte-1czytqk"></span>'),ym=X('<span class="row-reason svelte-1czytqk"> </span>'),bm=X('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),_m=X('<span class="status-label svelte-1czytqk"> </span>'),wm=X('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),km=X('<p class="summary-reason svelte-1czytqk"> </p>'),xm=X('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Sm=X('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function ou(t,e){lt(e,!0);let r=Pe(e,"actionColor",3,"#666"),s=Pe(e,"dimmed",3,!1);function i(W){if(!W)return"";try{return new Date(W).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=Mt(()=>e.item.status==="pending"),c=Oe(!1);var d=Sm(),v=xt(d);let h;var y=x(v);y.__click=()=>z(c,!k(c));let _;var b=x(y),w=x(b),D=M(b,2),j=x(D),S=x(j),F=M(j,2);{var re=W=>{var Q=vm(),ee=x(Q);ye(Y=>ce(ee,Y),[()=>i(e.item.date)]),G(W,Q)};we(F,W=>{e.item.date&&W(re)})}var J=M(D,2);{var U=W=>{var Q=mm();gn(Q,21,()=>e.item.tags,Er,(ee,Y)=>{var ne=gm();let te;var K=x(ne);ye(fe=>{te=Rn(ne,"",te,fe),ce(K,k(Y))},[()=>({background:im(k(Y))})]),G(ee,ne)}),G(W,Q)};we(J,W=>{e.item.tags&&e.item.tags.length>0&&W(U)})}var $=M(J,2);{var le=W=>{var Q=ym(),ee=x(Q);ye(()=>ce(ee,e.item.reason)),G(W,Q)};we($,W=>{e.item.reason&&!k(c)&&W(le)})}var Z=M(y,2),pe=x(Z);{var Me=W=>{var Q=bm(),ee=xt(Q);ee.__click=()=>e.onmarkacted(e.item.emailId);var Y=M(ee,2);Y.__click=()=>e.ondismiss(e.item.emailId),G(W,Q)},_e=W=>{var Q=_m(),ee=x(Q);ye(()=>ce(ee,e.item.status)),G(W,Q)};we(pe,W=>{k(o)?W(Me):W(_e,!1)})}var me=M(pe,2);{var ie=W=>{var Q=wm();Q.__click=()=>e.onremove(e.item.emailId),G(W,Q)};we(me,W=>{e.onremove&&W(ie)})}var ae=M(v,2);{var Le=W=>{var Q=xm();let ee;var Y=x(Q),ne=x(Y),te=M(Y,2);{var K=fe=>{var Se=km(),Ae=x(Se);ye(()=>ce(Ae,e.item.reason)),G(fe,Se)};we(te,fe=>{e.item.reason&&fe(K)})}ye(()=>{ee=Rn(Q,"",ee,{"border-left-color":r()}),ce(ne,e.item.summary)}),G(W,Q)};we(ae,W=>{k(c)&&e.item.summary&&W(Le)})}ye(()=>{h=dn(v,1,"email-row svelte-1czytqk",null,h,{dimmed:s()}),_=Rn(y,"",_,{"border-left-color":r()}),ce(w,e.item.subject),ce(S,e.item.from)}),G(t,d),ut()}Kt(["click"]);var Em=X('<span class="group-acted svelte-tl1unp"> </span>'),Tm=X('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Am=X('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Cm=X('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Im=X('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Rm=X('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Pm=X('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Om(t,e){lt(e,!0);let r=Pe(e,"color",3,"#888");Pe(e,"count",3,0);let s=Pe(e,"items",19,()=>[]),i=Pe(e,"expanded",3,!1),o=Mt(()=>s().filter(le=>le.status==="pending")),c=Mt(()=>s().filter(le=>le.status!=="pending")),d=Oe(!1);function v(le){return le.split("_").map(Z=>Z.charAt(0)+Z.slice(1).toLowerCase()).join(" ")}var h=Pm(),y=x(h);y.__click=function(...le){var Z;(Z=e.ontoggle)==null||Z.apply(this,le)};var _=x(y);let b;var w=x(_),D=M(_,2),j=x(D),S=M(D,2);{var F=le=>{var Z=Em(),pe=x(Z);ye(()=>ce(pe,`${k(c).length??""} handled`)),G(le,Z)};we(S,le=>{k(c).length>0&&le(F)})}var re=M(S,4);let J;var U=M(y,2);{var $=le=>{var Z=Rm(),pe=x(Z);{var Me=ee=>{var Y=Tm();G(ee,Y)};we(pe,ee=>{k(o).length===0&&k(c).length===0&&ee(Me)})}var _e=M(pe,2);gn(_e,17,()=>k(o),ee=>ee.emailId,(ee,Y)=>{ou(ee,{get item(){return k(Y)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var me=M(_e,2);{var ie=ee=>{var Y=Am(),ne=x(Y),te=x(ne),K=M(ne,2);gn(K,17,()=>k(c),fe=>fe.emailId,(fe,Se)=>{ou(fe,{get item(){return k(Se)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ye(()=>ce(te,`${k(c).length??""} handled`)),G(ee,Y)};we(me,ee=>{k(c).length>0&&ee(ie)})}var ae=M(me,2),Le=x(ae);{var W=ee=>{var Y=Cm();Y.__click=()=>z(d,!0),G(ee,Y)},Q=ee=>{var Y=Im(),ne=x(Y),te=M(ne);te.__click=()=>z(d,!1);var K=M(te,2);K.__click=()=>{e.oncleargroup(),z(d,!1)},ye(()=>ce(ne,`Clear ${s().length??""} items? `)),G(ee,Y)};we(Le,ee=>{k(d)?ee(Q,!1):ee(W)})}G(le,Z)};we(U,le=>{i()&&le($)})}ye(le=>{b=Rn(_,"",b,{background:r()}),ce(w,le),ce(j,k(o).length),J=dn(re,0,"chevron svelte-tl1unp",null,J,{open:i()})},[()=>v(e.action)]),G(t,h),ut()}Kt(["click"]);var Dm=X('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Mm=X('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Lm=X('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Nm=X('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),qm=X('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),jm=X('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Bm(t,e){lt(e,!0);let r=Pe(e,"groups",19,()=>({})),s=Pe(e,"groupOrder",19,()=>[]),i=Pe(e,"counts",19,()=>({})),o=Pe(e,"stats",3,null),c=Pe(e,"expandedGroup",3,null),d=Pe(e,"isScanning",3,!1),v=Pe(e,"scanProgress",3,null),h=Pe(e,"scanCount",15,20),y=Pe(e,"error",3,null),_=Oe(!1);var b=jm(),w=x(b);hm(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return h()},set scanCount(J){h(J)}});var D=M(w,2);{var j=J=>{var U=Dm(),$=x(U),le=x($),Z=M($,2);Z.__click=function(...pe){var Me;(Me=e.ondismisserror)==null||Me.apply(this,pe)},ye(()=>ce(le,y())),G(J,U)};we(D,J=>{y()&&J(j)})}var S=M(D,2);{var F=J=>{var U=Nm(),$=xt(U);gn($,20,s,ie=>ie,(ie,ae)=>{{let Le=Mt(()=>sm(ae)),W=Mt(()=>{var Y;return((Y=r()[ae])==null?void 0:Y.length)||0}),Q=Mt(()=>r()[ae]||[]),ee=Mt(()=>c()===ae);Om(ie,{get action(){return ae},get color(){return k(Le)},get count(){return k(W)},get items(){return k(Q)},get expanded(){return k(ee)},ontoggle:()=>e.ontogglegroup(ae),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ae)})}});var le=M($,2),Z=x(le),pe=x(Z),Me=M(Z,2);{var _e=ie=>{var ae=Mm();ae.__click=()=>z(_,!0),G(ie,ae)},me=ie=>{var ae=Lm(),Le=M(x(ae));Le.__click=()=>z(_,!1);var W=M(Le,2);W.__click=()=>{e.onclear(),z(_,!1)},G(ie,ae)};we(Me,ie=>{k(_)?ie(me,!1):ie(_e)})}ye(()=>ce(pe,`${i().total??""} emails classified into ${s().length??""} groups`)),G(J,U)},re=J=>{var U=qm();G(J,U)};we(S,J=>{i().total>0?J(F):d()||J(re,1)})}G(t,b),ut()}Kt(["click"]);var zm=X('<div class="actions-page svelte-3tch4q"><!></div>');function Fm(t,e){lt(e,!0);const r=lc();let s=Oe(wt(r.status)),i=Oe(""),o=Oe(wt({})),c=Oe(wt([])),d=Oe(wt({total:0})),v=Oe(null),h=Oe(null),y=Oe(!1),_=Oe(null),b=Oe(20),w=Oe(null);Rt(()=>{const _e=r.onMessage(me=>{if(me.status==="ready"){z(s,"ready");const ie=os.find(ae=>ae.id===r.modelId);z(i,(ie==null?void 0:ie.name)||r.modelId||"",!0)}me.status==="loading"&&z(s,"loading")});if(z(s,r.status,!0),r.modelId){const me=os.find(ie=>ie.id===r.modelId);z(i,(me==null?void 0:me.name)||r.modelId||"",!0)}return D(),()=>_e()});async function D(){try{const _e=await Qg();z(o,_e.groups,!0),z(c,_e.order,!0),z(d,await Zg(),!0),z(v,await tm(),!0)}catch(_e){z(w,`Failed to load data: ${_e.message}`)}}async function j(){await F(!1)}async function S(){await F(!0)}async function F(_e){if(!(k(y)||!r.isReady)){z(w,null),z(y,!0),z(_,null);try{await Xg(r,{count:k(b),force:_e,onProgress:me=>{z(_,{...me},!0)}}),await D()}catch(me){z(w,`Scan failed: ${me.message}`)}finally{z(y,!1)}}}async function re(_e){await iu(_e,"acted"),await D()}async function J(_e){await iu(_e,"dismissed"),await D()}async function U(_e){await em(_e),await D()}async function $(_e){await $g(_e),await D()}async function le(){await Jg(),await D()}function Z(_e){z(h,k(h)===_e?null:_e,!0)}var pe=zm(),Me=x(pe);Bm(Me,{get engineStatus(){return k(s)},get modelName(){return k(i)},get groups(){return k(o)},get groupOrder(){return k(c)},get counts(){return k(d)},get stats(){return k(v)},get expandedGroup(){return k(h)},get isScanning(){return k(y)},get scanProgress(){return k(_)},get error(){return k(w)},onscan:j,onrescan:S,ontogglegroup:Z,onmarkacted:re,ondismiss:J,onremove:U,oncleargroup:$,onclear:le,ondismisserror:()=>z(w,null),get scanCount(){return k(b)},set scanCount(_e){z(b,_e,!0)}}),G(t,pe),ut()}var Km=X('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Um(t,e){lt(e,!0);function r(){const Z=location.hash;return Z==="#dashboard"?"dashboard":Z==="#actions"?"actions":"chat"}let s=Oe(wt(r()));Rt(()=>{function Z(){z(s,r(),!0)}return window.addEventListener("hashchange",Z),()=>window.removeEventListener("hashchange",Z)});var i=Km(),o=x(i),c=M(x(o),2),d=x(c);let v;var h=M(d,2);let y;var _=M(h,2);let b;var w=M(o,2),D=x(w);let j;var S=x(D);hh(S,{});var F=M(D,2);let re;var J=x(F);Fm(J,{});var U=M(F,2);let $;var le=x(U);Wg(le,{}),ye(()=>{v=dn(d,1,"svelte-1n46o8q",null,v,{active:k(s)==="chat"}),y=dn(h,1,"svelte-1n46o8q",null,y,{active:k(s)==="actions"}),b=dn(_,1,"svelte-1n46o8q",null,b,{active:k(s)==="dashboard"}),j=Rn(D,"",j,{display:k(s)==="chat"?"flex":"none"}),re=Rn(F,"",re,{display:k(s)==="actions"?"flex":"none"}),$=Rn(U,"",$,{display:k(s)==="dashboard"?"flex":"none"})}),G(t,i),ut()}Ad(Um,{target:document.getElementById("app")});
