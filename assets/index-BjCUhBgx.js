var qd=Object.defineProperty;var Fl=t=>{throw TypeError(t)};var Bd=(t,e,r)=>e in t?qd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var it=(t,e,r)=>Bd(t,typeof e!="symbol"?e+"":e,r),Ji=(t,e,r)=>e.has(t)||Fl("Cannot "+r);var ie=(t,e,r)=>(Ji(t,e,"read from private field"),r?r.call(t):e.get(t)),ot=(t,e,r)=>e.has(t)?Fl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),tt=(t,e,r,a)=>(Ji(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),cn=(t,e,r)=>(Ji(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const po=!1;var Bo=Array.isArray,zd=Array.prototype.indexOf,Wa=Array.prototype.includes,yi=Array.from,Fd=Object.defineProperty,Na=Object.getOwnPropertyDescriptor,Kd=Object.getOwnPropertyDescriptors,Ud=Object.prototype,Gd=Array.prototype,jc=Object.getPrototypeOf,Kl=Object.isExtensible;const Wd=()=>{};function Hd(t){for(var e=0;e<t.length;e++)t[e]()}function Lc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const nn=2,xs=4,bi=8,Nc=1<<24,Lr=16,lr=32,Ca=64,qc=128,Vn=512,Zt=1024,rn=2048,or=4096,Bn=8192,Dr=16384,Is=32768,Ha=65536,Ul=1<<17,Bc=1<<18,Za=1<<19,Vd=1<<20,Mr=1<<25,ka=65536,ho=1<<21,zo=1<<22,Wr=1<<23,ya=Symbol("$state"),Yd=Symbol("legacy props"),Qd=Symbol(""),ua=new class extends Error{constructor(){super(...arguments);it(this,"name","StaleReactionError");it(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Xd(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Zd(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Jd(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function $d(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ef(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function tf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function nf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function rf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function af(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function sf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function of(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function lf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const cf=1,uf=2,zc=4,df=8,ff=16,vf=1,pf=4,hf=8,mf=16,Fc=1,gf=2,$t=Symbol(),Kc="http://www.w3.org/1999/xhtml";function _f(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function yf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Uc(t){return t===this.v}function bf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Gc(t){return!bf(t,this.v)}let wf=!1,zn=null;function Va(t){zn=t}function Tt(t,e=!1,r){zn={p:zn,i:!1,c:null,e:null,s:t,x:null,l:null}}function Et(t){var e=zn,r=e.e;if(r!==null){e.e=null;for(var a of r)fu(a)}return t!==void 0&&(e.x=t),e.i=!0,zn=e.p,t??{}}function Wc(){return!0}let da=[];function Hc(){var t=da;da=[],Hd(t)}function Hr(t){if(da.length===0&&!_s){var e=da;queueMicrotask(()=>{e===da&&Hc()})}da.push(t)}function kf(){for(;da.length>0;)Hc()}function Vc(t){var e=kt;if(e===null)return lt.f|=Wr,t;if((e.f&Is)===0&&(e.f&xs)===0)throw t;Ya(t,e)}function Ya(t,e){for(;e!==null;){if((e.f&qc)!==0){if((e.f&Is)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const xf=-7169;function Ft(t,e){t.f=t.f&xf|e}function Fo(t){(t.f&Vn)!==0||t.deps===null?Ft(t,Zt):Ft(t,or)}function Yc(t){if(t!==null)for(const e of t)(e.f&nn)===0||(e.f&ka)===0||(e.f^=ka,Yc(e.deps))}function Qc(t,e,r){(t.f&rn)!==0?e.add(t):(t.f&or)!==0&&r.add(t),Yc(t.deps),Ft(t,Zt)}const Zs=new Set;let $e=null,di=null,en=null,xn=[],wi=null,mo=!1,_s=!1;var qa,Ba,va,za,Es,As,pa,Cr,Fa,kr,go,_o,Xc;const vl=class vl{constructor(){ot(this,kr);it(this,"committed",!1);it(this,"current",new Map);it(this,"previous",new Map);ot(this,qa,new Set);ot(this,Ba,new Set);ot(this,va,0);ot(this,za,0);ot(this,Es,null);ot(this,As,new Set);ot(this,pa,new Set);ot(this,Cr,new Map);it(this,"is_fork",!1);ot(this,Fa,!1)}is_deferred(){return this.is_fork||ie(this,za)>0}skip_effect(e){ie(this,Cr).has(e)||ie(this,Cr).set(e,{d:[],m:[]})}unskip_effect(e){var r=ie(this,Cr).get(e);if(r){ie(this,Cr).delete(e);for(var a of r.d)Ft(a,rn),ar(a);for(a of r.m)Ft(a,or),ar(a)}}process(e){var i;xn=[],this.apply();var r=[],a=[];for(const o of e)cn(this,kr,go).call(this,o,r,a);if(this.is_deferred()){cn(this,kr,_o).call(this,a),cn(this,kr,_o).call(this,r);for(const[o,u]of ie(this,Cr))eu(o,u)}else{for(const o of ie(this,qa))o();ie(this,qa).clear(),ie(this,va)===0&&cn(this,kr,Xc).call(this),di=this,$e=null,Gl(a),Gl(r),di=null,(i=ie(this,Es))==null||i.resolve()}en=null}capture(e,r){r!==$t&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Wr)===0&&(this.current.set(e,e.v),en==null||en.set(e,e.v))}activate(){$e=this,this.apply()}deactivate(){$e===this&&($e=null,en=null)}flush(){if(this.activate(),xn.length>0){if(Zc(),$e!==null&&$e!==this)return}else ie(this,va)===0&&this.process([]);this.deactivate()}discard(){for(const e of ie(this,Ba))e(this);ie(this,Ba).clear()}increment(e){tt(this,va,ie(this,va)+1),e&&tt(this,za,ie(this,za)+1)}decrement(e){tt(this,va,ie(this,va)-1),e&&tt(this,za,ie(this,za)-1),!ie(this,Fa)&&(tt(this,Fa,!0),Hr(()=>{tt(this,Fa,!1),this.is_deferred()?xn.length>0&&this.flush():this.revive()}))}revive(){for(const e of ie(this,As))ie(this,pa).delete(e),Ft(e,rn),ar(e);for(const e of ie(this,pa))Ft(e,or),ar(e);this.flush()}oncommit(e){ie(this,qa).add(e)}ondiscard(e){ie(this,Ba).add(e)}settled(){return(ie(this,Es)??tt(this,Es,Lc())).promise}static ensure(){if($e===null){const e=$e=new vl;Zs.add($e),_s||Hr(()=>{$e===e&&e.flush()})}return $e}apply(){}};qa=new WeakMap,Ba=new WeakMap,va=new WeakMap,za=new WeakMap,Es=new WeakMap,As=new WeakMap,pa=new WeakMap,Cr=new WeakMap,Fa=new WeakMap,kr=new WeakSet,go=function(e,r,a){e.f^=Zt;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(lr|Ca))!==0,g=d&&(u&Zt)!==0,p=g||(u&Bn)!==0||ie(this,Cr).has(i);if(!p&&i.fn!==null){d?i.f^=Zt:o!==null&&(u&(xs|bi|Nc))!==0?o.b.defer_effect(i):(u&xs)!==0?r.push(i):Rs(i)&&((u&Lr)!==0&&ie(this,pa).add(i),Xa(i));var b=i.first;if(b!==null){i=b;continue}}var w=i.parent;for(i=i.next;i===null&&w!==null;)w===o&&(o=null),i=w.next,w=w.parent}},_o=function(e){for(var r=0;r<e.length;r+=1)Qc(e[r],ie(this,As),ie(this,pa))},Xc=function(){var i;if(Zs.size>1){this.previous.clear();var e=en,r=!0;for(const o of Zs){if(o===this){r=!1;continue}const u=[];for(const[g,p]of this.current){if(o.current.has(g))if(r&&p!==o.current.get(g))o.current.set(g,p);else continue;u.push(g)}if(u.length===0)continue;const d=[...o.current.keys()].filter(g=>!this.current.has(g));if(d.length>0){var a=xn;xn=[];const g=new Set,p=new Map;for(const b of u)Jc(b,d,g,p);if(xn.length>0){$e=o,o.apply();for(const b of xn)cn(i=o,kr,go).call(i,b,[],[]);o.deactivate()}xn=a}}$e=null,en=e}this.committed=!0,Zs.delete(this)};let Vr=vl;function Sf(t){var e=_s;_s=!0;try{for(var r;;){if(kf(),xn.length===0&&($e==null||$e.flush(),xn.length===0))return wi=null,r;Zc()}}finally{_s=e}}function Zc(){mo=!0;var t=null;try{for(var e=0;xn.length>0;){var r=Vr.ensure();if(e++>1e3){var a,i;Tf()}r.process(xn),Yr.clear()}}finally{xn=[],mo=!1,wi=null}}function Tf(){try{nf()}catch(t){Ya(t,wi)}}let $n=null;function Gl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(Dr|Bn))===0&&Rs(a)&&($n=new Set,Xa(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&mu(a),($n==null?void 0:$n.size)>0)){Yr.clear();for(const i of $n){if((i.f&(Dr|Bn))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)$n.has(u)&&($n.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const g=o[d];(g.f&(Dr|Bn))===0&&Xa(g)}}$n.clear()}}$n=null}}function Jc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&nn)!==0?Jc(i,e,r,a):(o&(zo|Lr))!==0&&(o&rn)===0&&$c(i,e,a)&&(Ft(i,rn),ar(i))}}function $c(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Wa.call(e,i))return!0;if((i.f&nn)!==0&&$c(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function ar(t){for(var e=wi=t;e.parent!==null;){e=e.parent;var r=e.f;if(mo&&e===kt&&(r&Lr)!==0&&(r&Bc)===0)return;if((r&(Ca|lr))!==0){if((r&Zt)===0)return;e.f^=Zt}}xn.push(e)}function eu(t,e){if(!((t.f&lr)!==0&&(t.f&Zt)!==0)){(t.f&rn)!==0?e.d.push(t):(t.f&or)!==0&&e.m.push(t),Ft(t,Zt);for(var r=t.first;r!==null;)eu(r,e),r=r.next}}function Ef(t){let e=0,r=xa(0),a;return()=>{Go()&&(v(r),Wo(()=>(e===0&&(a=Ms(()=>t(()=>ys(r)))),e+=1,()=>{Hr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,ys(r))})})))}}var Af=Ha|Za|qc;function Cf(t,e,r){new Pf(t,e,r)}var Gn,qo,hr,ha,mr,Wn,wn,gr,Pr,Ur,ma,Gr,Ka,ga,Ua,Ga,Ir,gi,Jt,If,Of,yo,si,ii,bo;class Pf{constructor(e,r,a){ot(this,Jt);it(this,"parent");it(this,"is_pending",!1);ot(this,Gn);ot(this,qo,null);ot(this,hr);ot(this,ha);ot(this,mr);ot(this,Wn,null);ot(this,wn,null);ot(this,gr,null);ot(this,Pr,null);ot(this,Ur,null);ot(this,ma,0);ot(this,Gr,0);ot(this,Ka,!1);ot(this,ga,!1);ot(this,Ua,new Set);ot(this,Ga,new Set);ot(this,Ir,null);ot(this,gi,Ef(()=>(tt(this,Ir,xa(ie(this,ma))),()=>{tt(this,Ir,null)})));tt(this,Gn,e),tt(this,hr,r),tt(this,ha,a),this.parent=kt.b,this.is_pending=!!ie(this,hr).pending,tt(this,mr,Ho(()=>{kt.b=this;{var i=cn(this,Jt,yo).call(this);try{tt(this,Wn,Hn(()=>a(i)))}catch(o){this.error(o)}ie(this,Gr)>0?cn(this,Jt,ii).call(this):this.is_pending=!1}return()=>{var o;(o=ie(this,Ur))==null||o.remove()}},Af))}defer_effect(e){Qc(e,ie(this,Ua),ie(this,Ga))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!ie(this,hr).pending}update_pending_count(e){cn(this,Jt,bo).call(this,e),tt(this,ma,ie(this,ma)+e),!(!ie(this,Ir)||ie(this,Ka))&&(tt(this,Ka,!0),Hr(()=>{tt(this,Ka,!1),ie(this,Ir)&&Qa(ie(this,Ir),ie(this,ma))}))}get_effect_pending(){return ie(this,gi).call(this),v(ie(this,Ir))}error(e){var r=ie(this,hr).onerror;let a=ie(this,hr).failed;if(ie(this,ga)||!r&&!a)throw e;ie(this,Wn)&&(Tn(ie(this,Wn)),tt(this,Wn,null)),ie(this,wn)&&(Tn(ie(this,wn)),tt(this,wn,null)),ie(this,gr)&&(Tn(ie(this,gr)),tt(this,gr,null));var i=!1,o=!1;const u=()=>{if(i){yf();return}i=!0,o&&lf(),Vr.ensure(),tt(this,ma,0),ie(this,gr)!==null&&ba(ie(this,gr),()=>{tt(this,gr,null)}),this.is_pending=this.has_pending_snippet(),tt(this,Wn,cn(this,Jt,si).call(this,()=>(tt(this,ga,!1),Hn(()=>ie(this,ha).call(this,ie(this,Gn)))))),ie(this,Gr)>0?cn(this,Jt,ii).call(this):this.is_pending=!1};Hr(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){Ya(d,ie(this,mr)&&ie(this,mr).parent)}a&&tt(this,gr,cn(this,Jt,si).call(this,()=>{Vr.ensure(),tt(this,ga,!0);try{return Hn(()=>{a(ie(this,Gn),()=>e,()=>u)})}catch(d){return Ya(d,ie(this,mr).parent),null}finally{tt(this,ga,!1)}}))})}}Gn=new WeakMap,qo=new WeakMap,hr=new WeakMap,ha=new WeakMap,mr=new WeakMap,Wn=new WeakMap,wn=new WeakMap,gr=new WeakMap,Pr=new WeakMap,Ur=new WeakMap,ma=new WeakMap,Gr=new WeakMap,Ka=new WeakMap,ga=new WeakMap,Ua=new WeakMap,Ga=new WeakMap,Ir=new WeakMap,gi=new WeakMap,Jt=new WeakSet,If=function(){try{tt(this,Wn,Hn(()=>ie(this,ha).call(this,ie(this,Gn))))}catch(e){this.error(e)}},Of=function(){const e=ie(this,hr).pending;e&&(tt(this,wn,Hn(()=>e(ie(this,Gn)))),Hr(()=>{var r=cn(this,Jt,yo).call(this);tt(this,Wn,cn(this,Jt,si).call(this,()=>(Vr.ensure(),Hn(()=>ie(this,ha).call(this,r))))),ie(this,Gr)>0?cn(this,Jt,ii).call(this):(ba(ie(this,wn),()=>{tt(this,wn,null)}),this.is_pending=!1)}))},yo=function(){var e=ie(this,Gn);return this.is_pending&&(tt(this,Ur,jr()),ie(this,Gn).before(ie(this,Ur)),e=ie(this,Ur)),e},si=function(e){var r=kt,a=lt,i=zn;br(ie(this,mr)),Qn(ie(this,mr)),Va(ie(this,mr).ctx);try{return e()}catch(o){return Vc(o),null}finally{br(r),Qn(a),Va(i)}},ii=function(){const e=ie(this,hr).pending;ie(this,Wn)!==null&&(tt(this,Pr,document.createDocumentFragment()),ie(this,Pr).append(ie(this,Ur)),yu(ie(this,Wn),ie(this,Pr))),ie(this,wn)===null&&tt(this,wn,Hn(()=>e(ie(this,Gn))))},bo=function(e){var r;if(!this.has_pending_snippet()){this.parent&&cn(r=this.parent,Jt,bo).call(r,e);return}if(tt(this,Gr,ie(this,Gr)+e),ie(this,Gr)===0){this.is_pending=!1;for(const a of ie(this,Ua))Ft(a,rn),ar(a);for(const a of ie(this,Ga))Ft(a,or),ar(a);ie(this,Ua).clear(),ie(this,Ga).clear(),ie(this,wn)&&ba(ie(this,wn),()=>{tt(this,wn,null)}),ie(this,Pr)&&(ie(this,Gn).before(ie(this,Pr)),tt(this,Pr,null))}};function Rf(t,e,r,a){const i=ki;var o=t.filter(k=>!k.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=$e,d=kt,g=Mf(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(k=>k.promise)):null;function b(k){g();try{a(k)}catch(x){(d.f&Dr)===0&&Ya(x,d)}u==null||u.deactivate(),wo()}if(r.length===0){p.then(()=>b(e.map(i)));return}function w(){g(),Promise.all(r.map(k=>Df(k))).then(k=>b([...e.map(i),...k])).catch(k=>Ya(k,d))}p?p.then(w):w()}function Mf(){var t=kt,e=lt,r=zn,a=$e;return function(o=!0){br(t),Qn(e),Va(r),o&&(a==null||a.activate())}}function wo(){br(null),Qn(null),Va(null)}function ki(t){var e=nn|rn,r=lt!==null&&(lt.f&nn)!==0?lt:null;return kt!==null&&(kt.f|=Za),{ctx:zn,deps:null,effects:null,equals:Uc,f:e,fn:t,reactions:null,rv:0,v:$t,wv:0,parent:r??kt,ac:null}}function Df(t,e,r){let a=kt;a===null&&Zd();var i=a.b,o=void 0,u=xa($t),d=!lt,g=new Map;return Yf(()=>{var x;var p=Lc();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{b===$e&&b.committed&&b.deactivate(),wo()})}catch(O){p.reject(O),wo()}var b=$e;if(d){var w=i.is_rendered();i.update_pending_count(1),b.increment(w),(x=g.get(b))==null||x.reject(ua),g.delete(b),g.set(b,p)}const k=(O,z=void 0)=>{if(b.activate(),z)z!==ua&&(u.f|=Wr,Qa(u,z));else{(u.f&Wr)!==0&&(u.f^=Wr),Qa(u,O);for(const[T,H]of g){if(g.delete(T),T===b)break;H.reject(ua)}}d&&(i.update_pending_count(-1),b.decrement(w))};p.promise.then(k,O=>k(null,O||"unknown"))}),du(()=>{for(const p of g.values())p.reject(ua)}),new Promise(p=>{function b(w){function k(){w===o?p(u):b(o)}w.then(k,k)}b(o)})}function pt(t){const e=ki(t);return bu(e),e}function tu(t){const e=ki(t);return e.equals=Gc,e}function jf(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Tn(e[r])}}function Lf(t){for(var e=t.parent;e!==null;){if((e.f&nn)===0)return(e.f&Dr)===0?e:null;e=e.parent}return null}function Ko(t){var e,r=kt;br(Lf(t));try{t.f&=~ka,jf(t),e=Su(t)}finally{br(r)}return e}function nu(t){var e=Ko(t);if(!t.equals(e)&&(t.wv=ku(),(!($e!=null&&$e.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){Ft(t,Zt);return}Qr||(en!==null?(Go()||$e!=null&&$e.is_fork)&&en.set(t,e):Fo(t))}function Nf(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(ua),a.teardown=Wd,a.ac=null,Ss(a,0),Vo(a))}function ru(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Xa(e)}let ko=new Set;const Yr=new Map;let au=!1;function xa(t,e){var r={f:0,v:t,reactions:null,equals:Uc,rv:0,wv:0};return r}function De(t,e){const r=xa(t);return bu(r),r}function qf(t,e=!1,r=!0){const a=xa(t);return e||(a.equals=Gc),a}function A(t,e,r=!1){lt!==null&&(!sr||(lt.f&Ul)!==0)&&Wc()&&(lt.f&(nn|Lr|zo|Ul))!==0&&(Yn===null||!Wa.call(Yn,t))&&of();let a=r?Kt(e):e;return Qa(t,a)}function Qa(t,e){if(!t.equals(e)){var r=t.v;Qr?Yr.set(t,e):Yr.set(t,r),t.v=e;var a=Vr.ensure();if(a.capture(t,r),(t.f&nn)!==0){const i=t;(t.f&rn)!==0&&Ko(i),Fo(i)}t.wv=ku(),su(t,rn),kt!==null&&(kt.f&Zt)!==0&&(kt.f&(lr|Ca))===0&&(Un===null?Xf([t]):Un.push(t)),!a.is_fork&&ko.size>0&&!au&&Bf()}return e}function Bf(){au=!1;for(const t of ko)(t.f&Zt)!==0&&Ft(t,or),Rs(t)&&Xa(t);ko.clear()}function ys(t){A(t,t.v+1)}function su(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&rn)===0;if(d&&Ft(o,e),(u&nn)!==0){var g=o;en==null||en.delete(g),(u&ka)===0&&(u&Vn&&(o.f|=ka),su(g,or))}else d&&((u&Lr)!==0&&$n!==null&&$n.add(o),ar(o))}}function Kt(t){if(typeof t!="object"||t===null||ya in t)return t;const e=jc(t);if(e!==Ud&&e!==Gd)return t;var r=new Map,a=Bo(t),i=De(0),o=wa,u=d=>{if(wa===o)return d();var g=lt,p=wa;Qn(null),Ql(o);var b=d();return Qn(g),Ql(p),b};return a&&r.set("length",De(t.length)),new Proxy(t,{defineProperty(d,g,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&af();var b=r.get(g);return b===void 0?u(()=>{var w=De(p.value);return r.set(g,w),w}):A(b,p.value,!0),!0},deleteProperty(d,g){var p=r.get(g);if(p===void 0){if(g in d){const b=u(()=>De($t));r.set(g,b),ys(i)}}else A(p,$t),ys(i);return!0},get(d,g,p){var x;if(g===ya)return t;var b=r.get(g),w=g in d;if(b===void 0&&(!w||(x=Na(d,g))!=null&&x.writable)&&(b=u(()=>{var O=Kt(w?d[g]:$t),z=De(O);return z}),r.set(g,b)),b!==void 0){var k=v(b);return k===$t?void 0:k}return Reflect.get(d,g,p)},getOwnPropertyDescriptor(d,g){var p=Reflect.getOwnPropertyDescriptor(d,g);if(p&&"value"in p){var b=r.get(g);b&&(p.value=v(b))}else if(p===void 0){var w=r.get(g),k=w==null?void 0:w.v;if(w!==void 0&&k!==$t)return{enumerable:!0,configurable:!0,value:k,writable:!0}}return p},has(d,g){var k;if(g===ya)return!0;var p=r.get(g),b=p!==void 0&&p.v!==$t||Reflect.has(d,g);if(p!==void 0||kt!==null&&(!b||(k=Na(d,g))!=null&&k.writable)){p===void 0&&(p=u(()=>{var x=b?Kt(d[g]):$t,O=De(x);return O}),r.set(g,p));var w=v(p);if(w===$t)return!1}return b},set(d,g,p,b){var Q;var w=r.get(g),k=g in d;if(a&&g==="length")for(var x=p;x<w.v;x+=1){var O=r.get(x+"");O!==void 0?A(O,$t):x in d&&(O=u(()=>De($t)),r.set(x+"",O))}if(w===void 0)(!k||(Q=Na(d,g))!=null&&Q.writable)&&(w=u(()=>De(void 0)),A(w,Kt(p)),r.set(g,w));else{k=w.v!==$t;var z=u(()=>Kt(p));A(w,z)}var T=Reflect.getOwnPropertyDescriptor(d,g);if(T!=null&&T.set&&T.set.call(b,p),!k){if(a&&typeof g=="string"){var H=r.get("length"),fe=Number(g);Number.isInteger(fe)&&fe>=H.v&&A(H,fe+1)}ys(i)}return!0},ownKeys(d){v(i);var g=Reflect.ownKeys(d).filter(w=>{var k=r.get(w);return k===void 0||k.v!==$t});for(var[p,b]of r)b.v!==$t&&!(p in d)&&g.push(p);return g},setPrototypeOf(){sf()}})}function Wl(t){try{if(t!==null&&typeof t=="object"&&ya in t)return t[ya]}catch{}return t}function zf(t,e){return Object.is(Wl(t),Wl(e))}var Hl,iu,ou,lu;function Ff(){if(Hl===void 0){Hl=window,iu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;ou=Na(e,"firstChild").get,lu=Na(e,"nextSibling").get,Kl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Kl(r)&&(r.__t=void 0)}}function jr(t=""){return document.createTextNode(t)}function qn(t){return ou.call(t)}function Os(t){return lu.call(t)}function m(t,e){return qn(t)}function Xe(t,e=!1){{var r=qn(t);return r instanceof Comment&&r.data===""?Os(r):r}}function _(t,e=1,r=!1){let a=t;for(;e--;)a=Os(a);return a}function Kf(t){t.textContent=""}function cu(){return!1}function Uf(t,e,r){return document.createElementNS(Kc,t,void 0)}let Vl=!1;function Gf(){Vl||(Vl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Uo(t){var e=lt,r=kt;Qn(null),br(null);try{return t()}finally{Qn(e),br(r)}}function uu(t,e,r,a=r){t.addEventListener(e,()=>Uo(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),Gf()}function Wf(t){kt===null&&(lt===null&&tf(),ef()),Qr&&$d()}function Hf(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Nr(t,e,r){var a=kt;a!==null&&(a.f&Bn)!==0&&(t|=Bn);var i={ctx:zn,deps:null,nodes:null,f:t|rn|Vn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Xa(i)}catch(d){throw Tn(i),d}else e!==null&&ar(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Za)===0&&(o=o.first,(t&Lr)!==0&&(t&Ha)!==0&&o!==null&&(o.f|=Ha)),o!==null&&(o.parent=a,a!==null&&Hf(o,a),lt!==null&&(lt.f&nn)!==0&&(t&Ca)===0)){var u=lt;(u.effects??(u.effects=[])).push(o)}return i}function Go(){return lt!==null&&!sr}function du(t){const e=Nr(bi,null,!1);return Ft(e,Zt),e.teardown=t,e}function Sa(t){Wf();var e=kt.f,r=!lt&&(e&lr)!==0&&(e&Is)===0;if(r){var a=zn;(a.e??(a.e=[])).push(t)}else return fu(t)}function fu(t){return Nr(xs|Vd,t,!1)}function Vf(t){Vr.ensure();const e=Nr(Ca|Za,t,!0);return(r={})=>new Promise(a=>{r.outro?ba(e,()=>{Tn(e),a(void 0)}):(Tn(e),a(void 0))})}function vu(t){return Nr(xs,t,!1)}function Yf(t){return Nr(zo|Za,t,!0)}function Wo(t,e=0){return Nr(bi|e,t,!0)}function $(t,e=[],r=[],a=[]){Rf(a,e,r,i=>{Nr(bi,()=>t(...i.map(v)),!0)})}function Ho(t,e=0){var r=Nr(Lr|e,t,!0);return r}function Hn(t){return Nr(lr|Za,t,!0)}function pu(t){var e=t.teardown;if(e!==null){const r=Qr,a=lt;Yl(!0),Qn(null);try{e.call(null)}finally{Yl(r),Qn(a)}}}function Vo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Uo(()=>{i.abort(ua)});var a=r.next;(r.f&Ca)!==0?r.parent=null:Tn(r,e),r=a}}function Qf(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&lr)===0&&Tn(e),e=r}}function Tn(t,e=!0){var r=!1;(e||(t.f&Bc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(hu(t.nodes.start,t.nodes.end),r=!0),Vo(t,e&&!r),Ss(t,0),Ft(t,Dr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();pu(t);var i=t.parent;i!==null&&i.first!==null&&mu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function hu(t,e){for(;t!==null;){var r=t===e?null:Os(t);t.remove(),t=r}}function mu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ba(t,e,r=!0){var a=[];gu(t,a,!0);var i=()=>{r&&Tn(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function gu(t,e,r){if((t.f&Bn)===0){t.f^=Bn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Ha)!==0||(i.f&lr)!==0&&(t.f&Lr)!==0;gu(i,e,u?r:!1),i=o}}}function Yo(t){_u(t,!0)}function _u(t,e){if((t.f&Bn)!==0){t.f^=Bn,(t.f&Zt)===0&&(Ft(t,rn),ar(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ha)!==0||(r.f&lr)!==0;_u(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function yu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:Os(r);e.append(r),r=i}}let oi=!1,Qr=!1;function Yl(t){Qr=t}let lt=null,sr=!1;function Qn(t){lt=t}let kt=null;function br(t){kt=t}let Yn=null;function bu(t){lt!==null&&(Yn===null?Yn=[t]:Yn.push(t))}let Sn=null,Ln=0,Un=null;function Xf(t){Un=t}let wu=1,fa=0,wa=fa;function Ql(t){wa=t}function ku(){return++wu}function Rs(t){var e=t.f;if((e&rn)!==0)return!0;if(e&nn&&(t.f&=~ka),(e&or)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(Rs(o)&&nu(o),o.wv>t.wv)return!0}(e&Vn)!==0&&en===null&&Ft(t,Zt)}return!1}function xu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Yn!==null&&Wa.call(Yn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&nn)!==0?xu(o,e,!1):e===o&&(r?Ft(o,rn):(o.f&Zt)!==0&&Ft(o,or),ar(o))}}function Su(t){var z;var e=Sn,r=Ln,a=Un,i=lt,o=Yn,u=zn,d=sr,g=wa,p=t.f;Sn=null,Ln=0,Un=null,lt=(p&(lr|Ca))===0?t:null,Yn=null,Va(t.ctx),sr=!1,wa=++fa,t.ac!==null&&(Uo(()=>{t.ac.abort(ua)}),t.ac=null);try{t.f|=ho;var b=t.fn,w=b();t.f|=Is;var k=t.deps,x=$e==null?void 0:$e.is_fork;if(Sn!==null){var O;if(x||Ss(t,Ln),k!==null&&Ln>0)for(k.length=Ln+Sn.length,O=0;O<Sn.length;O++)k[Ln+O]=Sn[O];else t.deps=k=Sn;if(Go()&&(t.f&Vn)!==0)for(O=Ln;O<k.length;O++)((z=k[O]).reactions??(z.reactions=[])).push(t)}else!x&&k!==null&&Ln<k.length&&(Ss(t,Ln),k.length=Ln);if(Wc()&&Un!==null&&!sr&&k!==null&&(t.f&(nn|or|rn))===0)for(O=0;O<Un.length;O++)xu(Un[O],t);if(i!==null&&i!==t){if(fa++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=fa;if(e!==null)for(const T of e)T.rv=fa;Un!==null&&(a===null?a=Un:a.push(...Un))}return(t.f&Wr)!==0&&(t.f^=Wr),w}catch(T){return Vc(T)}finally{t.f^=ho,Sn=e,Ln=r,Un=a,lt=i,Yn=o,Va(u),sr=d,wa=g}}function Zf(t,e){let r=e.reactions;if(r!==null){var a=zd.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&nn)!==0&&(Sn===null||!Wa.call(Sn,e))){var o=e;(o.f&Vn)!==0&&(o.f^=Vn,o.f&=~ka),Fo(o),Nf(o),Ss(o,0)}}function Ss(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Zf(t,r[a])}function Xa(t){var e=t.f;if((e&Dr)===0){Ft(t,Zt);var r=kt,a=oi;kt=t,oi=!0;try{(e&(Lr|Nc))!==0?Qf(t):Vo(t),pu(t);var i=Su(t);t.teardown=typeof i=="function"?i:null,t.wv=wu;var o;po&&wf&&(t.f&rn)!==0&&t.deps}finally{oi=a,kt=r}}}async function Tu(){await Promise.resolve(),Sf()}function v(t){var e=t.f,r=(e&nn)!==0;if(lt!==null&&!sr){var a=kt!==null&&(kt.f&Dr)!==0;if(!a&&(Yn===null||!Wa.call(Yn,t))){var i=lt.deps;if((lt.f&ho)!==0)t.rv<fa&&(t.rv=fa,Sn===null&&i!==null&&i[Ln]===t?Ln++:Sn===null?Sn=[t]:Sn.push(t));else{(lt.deps??(lt.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[lt]:Wa.call(o,lt)||o.push(lt)}}}if(Qr&&Yr.has(t))return Yr.get(t);if(r){var u=t;if(Qr){var d=u.v;return((u.f&Zt)===0&&u.reactions!==null||Au(u))&&(d=Ko(u)),Yr.set(u,d),d}var g=(u.f&Vn)===0&&!sr&&lt!==null&&(oi||(lt.f&Vn)!==0),p=(u.f&Is)===0;Rs(u)&&(g&&(u.f|=Vn),nu(u)),g&&!p&&(ru(u),Eu(u))}if(en!=null&&en.has(t))return en.get(t);if((t.f&Wr)!==0)throw t.v;return t.v}function Eu(t){if(t.f|=Vn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&nn)!==0&&(e.f&Vn)===0&&(ru(e),Eu(e))}function Au(t){if(t.v===$t)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Yr.has(e)||(e.f&nn)!==0&&Au(e))return!0;return!1}function Ms(t){var e=sr;try{return sr=!0,t()}finally{sr=e}}const Jf=["touchstart","touchmove"];function $f(t){return Jf.includes(t)}const Cu=new Set,xo=new Set;function Gt(t){for(var e=0;e<t.length;e++)Cu.add(t[e]);for(var r of xo)r(t)}let Xl=null;function Zl(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;Xl=t;var u=0,d=Xl===t&&t.__root;if(d){var g=i.indexOf(d);if(g!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;g<=p&&(u=g)}if(o=i[u]||t.target,o!==e){Fd(t,"currentTarget",{configurable:!0,get(){return o||r}});var b=lt,w=kt;Qn(null),br(null);try{for(var k,x=[];o!==null;){var O=o.assignedSlot||o.parentNode||o.host||null;try{var z=o["__"+a];z!=null&&(!o.disabled||t.target===o)&&z.call(o,t)}catch(H){k?x.push(H):k=H}if(t.cancelBubble||O===e||O===null)break;o=O}if(k){for(let H of x)queueMicrotask(()=>{throw H});throw k}}finally{t.__root=e,delete t.currentTarget,Qn(b),br(w)}}}var Rc,Mc;const $i=(Mc=(Rc=globalThis==null?void 0:globalThis.window)==null?void 0:Rc.trustedTypes)==null?void 0:Mc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function ev(t){return($i==null?void 0:$i.createHTML(t))??t}function Qo(t,e=!1){var r=Uf("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?ev(t):t,r.content}function Ta(t,e){var r=kt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function N(t,e){var r=(e&Fc)!==0,a=(e&gf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Qo(o?t:"<!>"+t,!0),r||(i=qn(i)));var u=a||iu?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=qn(u),g=u.lastChild;Ta(d,g)}else Ta(u,u);return u}}function tv(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Fc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=Qo(o,!0),g=qn(d);if(i)for(u=document.createDocumentFragment();qn(g);)u.appendChild(qn(g));else u=qn(g)}var p=u.cloneNode(!0);if(i){var b=qn(p),w=p.lastChild;Ta(b,w)}else Ta(p,p);return p}}function Xo(t,e){return tv(t,e,"svg")}function Or(t=""){{var e=jr(t+"");return Ta(e,e),e}}function wr(){var t=document.createDocumentFragment(),e=document.createComment(""),r=jr();return t.append(e,r),Ta(e,r),t}function E(t,e){t!==null&&t.before(e)}function K(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function nv(t,e){return rv(t,e)}const Js=new Map;function rv(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Ff();var d=new Set,g=w=>{for(var k=0;k<w.length;k++){var x=w[k];if(!d.has(x)){d.add(x);var O=$f(x);for(const H of[e,document]){var z=Js.get(H);z===void 0&&(z=new Map,Js.set(H,z));var T=z.get(x);T===void 0?(H.addEventListener(x,Zl,{passive:O}),z.set(x,1)):z.set(x,T+1)}}}};g(yi(Cu)),xo.add(g);var p=void 0,b=Vf(()=>{var w=r??e.appendChild(jr());return Cf(w,{pending:()=>{}},k=>{Tt({});var x=zn;o&&(x.c=o),i&&(a.$$events=i),p=t(k,a)||{},Et()}),()=>{var z;for(var k of d)for(const T of[e,document]){var x=Js.get(T),O=x.get(k);--O==0?(T.removeEventListener(k,Zl),x.delete(k),x.size===0&&Js.delete(T)):x.set(k,O)}xo.delete(g),w!==r&&((z=w.parentNode)==null||z.removeChild(w))}});return av.set(p,b),p}let av=new WeakMap;var tr,_r,Nn,_a,Cs,Ps,_i;class sv{constructor(e,r=!0){it(this,"anchor");ot(this,tr,new Map);ot(this,_r,new Map);ot(this,Nn,new Map);ot(this,_a,new Set);ot(this,Cs,!0);ot(this,Ps,()=>{var e=$e;if(ie(this,tr).has(e)){var r=ie(this,tr).get(e),a=ie(this,_r).get(r);if(a)Yo(a),ie(this,_a).delete(r);else{var i=ie(this,Nn).get(r);i&&(ie(this,_r).set(r,i.effect),ie(this,Nn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of ie(this,tr)){if(ie(this,tr).delete(o),o===e)break;const d=ie(this,Nn).get(u);d&&(Tn(d.effect),ie(this,Nn).delete(u))}for(const[o,u]of ie(this,_r)){if(o===r||ie(this,_a).has(o))continue;const d=()=>{if(Array.from(ie(this,tr).values()).includes(o)){var p=document.createDocumentFragment();yu(u,p),p.append(jr()),ie(this,Nn).set(o,{effect:u,fragment:p})}else Tn(u);ie(this,_a).delete(o),ie(this,_r).delete(o)};ie(this,Cs)||!a?(ie(this,_a).add(o),ba(u,d,!1)):d()}}});ot(this,_i,e=>{ie(this,tr).delete(e);const r=Array.from(ie(this,tr).values());for(const[a,i]of ie(this,Nn))r.includes(a)||(Tn(i.effect),ie(this,Nn).delete(a))});this.anchor=e,tt(this,Cs,r)}ensure(e,r){var a=$e,i=cu();if(r&&!ie(this,_r).has(e)&&!ie(this,Nn).has(e))if(i){var o=document.createDocumentFragment(),u=jr();o.append(u),ie(this,Nn).set(e,{effect:Hn(()=>r(u)),fragment:o})}else ie(this,_r).set(e,Hn(()=>r(this.anchor)));if(ie(this,tr).set(a,e),i){for(const[d,g]of ie(this,_r))d===e?a.unskip_effect(g):a.skip_effect(g);for(const[d,g]of ie(this,Nn))d===e?a.unskip_effect(g.effect):a.skip_effect(g.effect);a.oncommit(ie(this,Ps)),a.ondiscard(ie(this,_i))}else ie(this,Ps).call(this)}}tr=new WeakMap,_r=new WeakMap,Nn=new WeakMap,_a=new WeakMap,Cs=new WeakMap,Ps=new WeakMap,_i=new WeakMap;function ne(t,e,r=!1){var a=new sv(t),i=r?Ha:0;function o(u,d){a.ensure(u,d)}Ho(()=>{var u=!1;e((d,g=0)=>{u=!0,o(g,d)}),u||o(!1,null)},i)}function dn(t,e){return e}function iv(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let w=e[d];ba(w,()=>{if(o){if(o.pending.delete(w),o.done.add(w),o.pending.size===0){var k=t.outrogroups;So(yi(o.done)),k.delete(o),k.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var g=a.length===0&&r!==null;if(g){var p=r,b=p.parentNode;Kf(b),b.append(p),t.items.clear()}So(e,!g)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function So(t,e=!0){for(var r=0;r<t.length;r++)Tn(t[r],e)}var Jl;function Ut(t,e,r,a,i,o=null){var u=t,d=new Map,g=(e&zc)!==0;if(g){var p=t;u=p.appendChild(jr())}var b=null,w=tu(()=>{var H=r();return Bo(H)?H:H==null?[]:yi(H)}),k,x=!0;function O(){T.fallback=b,ov(T,k,u,e,a),b!==null&&(k.length===0?(b.f&Mr)===0?Yo(b):(b.f^=Mr,hs(b,null,u)):ba(b,()=>{b=null}))}var z=Ho(()=>{k=v(w);for(var H=k.length,fe=new Set,Q=$e,M=cu(),Y=0;Y<H;Y+=1){var Z=k[Y],F=a(Z,Y),oe=x?null:d.get(F);oe?(oe.v&&Qa(oe.v,Z),oe.i&&Qa(oe.i,Y),M&&Q.unskip_effect(oe.e)):(oe=lv(d,x?u:Jl??(Jl=jr()),Z,F,Y,i,e,r),x||(oe.e.f|=Mr),d.set(F,oe)),fe.add(F)}if(H===0&&o&&!b&&(x?b=Hn(()=>o(u)):(b=Hn(()=>o(Jl??(Jl=jr()))),b.f|=Mr)),H>fe.size&&Jd(),!x)if(M){for(const[xe,Ie]of d)fe.has(xe)||Q.skip_effect(Ie.e);Q.oncommit(O),Q.ondiscard(()=>{})}else O();v(w)}),T={effect:z,items:d,outrogroups:null,fallback:b};x=!1}function os(t){for(;t!==null&&(t.f&lr)===0;)t=t.next;return t}function ov(t,e,r,a,i){var Ie,ve,ee,le,ke,re,me,Te,se;var o=(a&df)!==0,u=e.length,d=t.items,g=os(t.effect.first),p,b=null,w,k=[],x=[],O,z,T,H;if(o)for(H=0;H<u;H+=1)O=e[H],z=i(O,H),T=d.get(z).e,(T.f&Mr)===0&&((ve=(Ie=T.nodes)==null?void 0:Ie.a)==null||ve.measure(),(w??(w=new Set)).add(T));for(H=0;H<u;H+=1){if(O=e[H],z=i(O,H),T=d.get(z).e,t.outrogroups!==null)for(const pe of t.outrogroups)pe.pending.delete(T),pe.done.delete(T);if((T.f&Mr)!==0)if(T.f^=Mr,T===g)hs(T,null,r);else{var fe=b?b.next:g;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),Fr(t,b,T),Fr(t,T,fe),hs(T,fe,r),b=T,k=[],x=[],g=os(b.next);continue}if((T.f&Bn)!==0&&(Yo(T),o&&((le=(ee=T.nodes)==null?void 0:ee.a)==null||le.unfix(),(w??(w=new Set)).delete(T))),T!==g){if(p!==void 0&&p.has(T)){if(k.length<x.length){var Q=x[0],M;b=Q.prev;var Y=k[0],Z=k[k.length-1];for(M=0;M<k.length;M+=1)hs(k[M],Q,r);for(M=0;M<x.length;M+=1)p.delete(x[M]);Fr(t,Y.prev,Z.next),Fr(t,b,Y),Fr(t,Z,Q),g=Q,b=Z,H-=1,k=[],x=[]}else p.delete(T),hs(T,g,r),Fr(t,T.prev,T.next),Fr(t,T,b===null?t.effect.first:b.next),Fr(t,b,T),b=T;continue}for(k=[],x=[];g!==null&&g!==T;)(p??(p=new Set)).add(g),x.push(g),g=os(g.next);if(g===null)continue}(T.f&Mr)===0&&k.push(T),b=T,g=os(T.next)}if(t.outrogroups!==null){for(const pe of t.outrogroups)pe.pending.size===0&&(So(yi(pe.done)),(ke=t.outrogroups)==null||ke.delete(pe));t.outrogroups.size===0&&(t.outrogroups=null)}if(g!==null||p!==void 0){var F=[];if(p!==void 0)for(T of p)(T.f&Bn)===0&&F.push(T);for(;g!==null;)(g.f&Bn)===0&&g!==t.fallback&&F.push(g),g=os(g.next);var oe=F.length;if(oe>0){var xe=(a&zc)!==0&&u===0?r:null;if(o){for(H=0;H<oe;H+=1)(me=(re=F[H].nodes)==null?void 0:re.a)==null||me.measure();for(H=0;H<oe;H+=1)(se=(Te=F[H].nodes)==null?void 0:Te.a)==null||se.fix()}iv(t,F,xe)}}o&&Hr(()=>{var pe,ae;if(w!==void 0)for(T of w)(ae=(pe=T.nodes)==null?void 0:pe.a)==null||ae.apply()})}function lv(t,e,r,a,i,o,u,d){var g=(u&cf)!==0?(u&ff)===0?qf(r,!1,!1):xa(r):null,p=(u&uf)!==0?xa(i):null;return{v:g,i:p,e:Hn(()=>(o(e,g??r,p??i,d),()=>{t.delete(a)}))}}function hs(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&Mr)===0?e.nodes.start:r;a!==null;){var u=Os(a);if(o.before(a),a===i)return;a=u}}function Fr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function cv(t,e,r=!1,a=!1,i=!1){var o=t,u="";$(()=>{var d=kt;if(u!==(u=e()??"")&&(d.nodes!==null&&(hu(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var g=u+"";r?g=`<svg>${g}</svg>`:a&&(g=`<math>${g}</math>`);var p=Qo(g);if((r||a)&&(p=qn(p)),Ta(qn(p),p.lastChild),r||a)for(;qn(p);)o.before(qn(p));else o.before(p)}})}const $l=[...` 	
\r\fÂ \v\uFEFF`];function uv(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||$l.includes(a[u-1]))&&(d===a.length||$l.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function ec(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function eo(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function dv(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,g=[];a&&g.push(...Object.keys(a).map(eo)),i&&g.push(...Object.keys(i).map(eo));var p=0,b=-1;const z=t.length;for(var w=0;w<z;w++){var k=t[w];if(d?k==="/"&&t[w-1]==="*"&&(d=!1):o?o===k&&(o=!1):k==="/"&&t[w+1]==="*"?d=!0:k==='"'||k==="'"?o=k:k==="("?u++:k===")"&&u--,!d&&o===!1&&u===0){if(k===":"&&b===-1)b=w;else if(k===";"||w===z-1){if(b!==-1){var x=eo(t.substring(p,b).trim());if(!g.includes(x)){k!==";"&&w++;var O=t.substring(p,w).trim();r+=" "+O+";"}}p=w+1,b=-1}}}}return a&&(r+=ec(a)),i&&(r+=ec(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function jt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=uv(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var g in o){var p=!!o[g];(i==null||p!==!!i[g])&&t.classList.toggle(g,p)}return o}function to(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function En(t,e,r,a){var i=t.__style;if(i!==e){var o=dv(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(to(t,r==null?void 0:r[0],a[0]),to(t,r==null?void 0:r[1],a[1],"important")):to(t,r,a));return a}function Pu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!Bo(e))return _f();for(var a of t.options)a.selected=e.includes(bs(a));return}for(a of t.options){var i=bs(a);if(zf(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function fv(t){var e=new MutationObserver(()=>{Pu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),du(()=>{e.disconnect()})}function xi(t,e,r=e){var a=new WeakSet,i=!0;uu(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),bs);else{var g=t.querySelector(u)??t.querySelector("option:not([disabled])");d=g&&bs(g)}r(d),$e!==null&&a.add($e)}),vu(()=>{var o=e();if(t===document.activeElement){var u=di??$e;if(a.has(u))return}if(Pu(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=bs(d),r(o))}t.__value=o,i=!1}),fv(t)}function bs(t){return"__value"in t?t.__value:t.value}const vv=Symbol("is custom element"),pv=Symbol("is html");function Iu(t,e,r,a){var i=hv(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Qd]=r),r==null?t.removeAttribute(e):typeof r!="string"&&mv(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function hv(t){return t.__attributes??(t.__attributes={[vv]:t.nodeName.includes("-"),[pv]:t.namespaceURI===Kc})}var tc=new Map;function mv(t){var e=t.getAttribute("is")||t.nodeName,r=tc.get(e);if(r)return r;tc.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=Kd(i);for(var u in a)a[u].set&&r.push(u);i=jc(i)}return r}function Si(t,e,r=e){var a=new WeakSet;uu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=no(t)?ro(o):o,r(o),$e!==null&&a.add($e),await Tu(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,g=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;u===d&&d===g&&p>g?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=u,t.selectionEnd=Math.min(d,p))}}}),Ms(e)==null&&t.value&&(r(no(t)?ro(t.value):t.value),$e!==null&&a.add($e)),Wo(()=>{var i=e();if(t===document.activeElement){var o=di??$e;if(a.has(o))return}no(t)&&i===ro(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function no(t){var e=t.type;return e==="number"||e==="range"}function ro(t){return t===""?null:+t}function nc(t,e){return t===e||(t==null?void 0:t[ya])===e}function Ou(t={},e,r,a){return vu(()=>{var i,o;return Wo(()=>{i=o,o=[],Ms(()=>{t!==r(...o)&&(e(t,...o),i&&nc(r(...i),t)&&e(null,...i))})}),()=>{Hr(()=>{o&&nc(r(...o),t)&&e(null,...o)})}}),t}let $s=!1;function gv(t){var e=$s;try{return $s=!1,[t(),$s]}finally{$s=e}}function je(t,e,r,a){var fe;var i=(r&hf)!==0,o=(r&mf)!==0,u=a,d=!0,g=()=>(d&&(d=!1,u=o?Ms(a):a),u),p;if(i){var b=ya in t||Yd in t;p=((fe=Na(t,e))==null?void 0:fe.set)??(b&&e in t?Q=>t[e]=Q:void 0)}var w,k=!1;i?[w,k]=gv(()=>t[e]):w=t[e],w===void 0&&a!==void 0&&(w=g(),p&&(rf(),p(w)));var x;if(x=()=>{var Q=t[e];return Q===void 0?g():(d=!0,Q)},(r&pf)===0)return x;if(p){var O=t.$$legacy;return(function(Q,M){return arguments.length>0?((!M||O||k)&&p(M?x():Q),Q):x()})}var z=!1,T=((r&vf)!==0?ki:tu)(()=>(z=!1,x()));i&&v(T);var H=kt;return(function(Q,M){if(arguments.length>0){const Y=M?v(T):i?Kt(Q):Q;return A(T,Y),z=!0,u!==void 0&&(u=Y),Q}return Qr&&z||(H.f&Dr)!==0?T.v:v(T)})}function an(t){zn===null&&Xd(),Sa(()=>{const e=Ms(t);if(typeof e=="function")return e})}const _v="5";var Dc;typeof window<"u"&&((Dc=window.__svelte??(window.__svelte={})).v??(Dc.v=new Set)).add(_v);const yr=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",contextWindow:32768,maxEmailTokens:4e3,description:"Fastest, 32k context, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",contextWindow:32768,maxEmailTokens:6e3,description:"Balanced speed and quality, 32k context"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",contextWindow:32768,maxEmailTokens:12e3,description:"Best reasoning, 32k context, recommended for email",recommendedForEmailProcessing:!0},{id:"onnx-community/Phi-3.5-mini-instruct-onnx-web",name:"Phi-3.5 Mini",size:"~2.5 GB",contextWindow:131072,maxEmailTokens:16e3,description:"128k context, WebGPU-optimized, best for very long emails",recommendedForEmailProcessing:!0},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",contextWindow:32768,maxEmailTokens:5e3,description:"Strong reasoning, CoT focused, 32k context"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Microsoft, good at reasoning, 16k context",requiresV4:!0,gpuWarning:"Requires good GPU (8GB+ VRAM recommended)"},{id:"onnx-community/Phi-4-mini-instruct-ONNX-GQA",name:"Phi-4 Mini GQA",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Phi-4 with Grouped Query Attention, faster inference",requiresV4:!0,gpuWarning:"Requires good GPU (8GB+ VRAM recommended)",isExperimental:!0},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",contextWindow:8192,maxEmailTokens:2e3,description:"Smallest, ultra fast, 8k context, not for long emails"}];function Zo(t){return yr.find(e=>e.id===t)}const yv=Object.freeze(Object.defineProperty({__proto__:null,MODELS:yr,getModelInfo:Zo},Symbol.toStringTag,{value:"Module"})),ir=[{name:"qwen3:4b",displayName:"Qwen3 4B",params:"4B",contextWindow:131072,maxEmailTokens:1e5,description:"Latest Qwen, 128k context, enhanced reasoning",tags:["multilingual","reasoning","general"],recommended:!0,recommendedForEmailProcessing:!0},{name:"qwen3:8b",displayName:"Qwen3 8B",params:"8B",contextWindow:131072,maxEmailTokens:1e5,description:"Powerful reasoning, 128k context, 100+ languages",tags:["multilingual","reasoning","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"qwen3:14b",displayName:"Qwen3 14B",params:"14B",contextWindow:131072,maxEmailTokens:1e5,description:"Most capable Qwen3, best for complex tasks",tags:["multilingual","reasoning","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:3b",displayName:"Ministral 3 3B",params:"3B",contextWindow:262144,maxEmailTokens:2e5,description:"Mistral's smallest, 256k context, Apache 2.0",tags:["fast","long-context","efficient"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:8b",displayName:"Ministral 3 8B",params:"8B",contextWindow:262144,maxEmailTokens:2e5,description:"Balanced performance, 256k context, vision capable",tags:["general","long-context","vision"],recommended:!0,recommendedForEmailProcessing:!0},{name:"ministral-3:14b",displayName:"Ministral 3 14B",params:"14B",contextWindow:262144,maxEmailTokens:2e5,description:"Most capable Ministral, 256k context, function calling",tags:["advanced","long-context","vision"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gpt-oss:20b",displayName:"GPT-OSS 20B",params:"20B",contextWindow:131072,maxEmailTokens:1e5,description:"OpenAI's open model, strong reasoning, Apache 2.0",tags:["reasoning","cot","openai"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3:4b",displayName:"Gemma3 4B",params:"4B",contextWindow:131072,maxEmailTokens:1e5,description:"Google, 128k context, multimodal (text + images)",tags:["multimodal","vision","multilingual"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3:12b",displayName:"Gemma3 12B",params:"12B",contextWindow:131072,maxEmailTokens:1e5,description:"Powerful multimodal, 128k context, 140+ languages",tags:["multimodal","vision","multilingual","advanced"],recommended:!0,recommendedForEmailProcessing:!0},{name:"gemma3n:e2b",displayName:"Gemma3N E2B",params:"2B effective",contextWindow:32768,maxEmailTokens:25e3,description:"Efficient 2B, multimodal, MatFormer architecture",tags:["efficient","multimodal","fast"],recommendedForEmailProcessing:!1},{name:"gemma3n:e4b",displayName:"Gemma3N E4B",params:"4B effective",contextWindow:32768,maxEmailTokens:25e3,description:"Efficient 4B, multimodal, selective parameter activation",tags:["efficient","multimodal","balanced"],recommendedForEmailProcessing:!1},{name:"deepseek-r1:7b",displayName:"DeepSeek R1 7B",params:"7B",contextWindow:65536,maxEmailTokens:5e4,description:"Strong chain-of-thought reasoning, research-focused",tags:["reasoning","cot"],recommended:!0,recommendedForEmailProcessing:!0},{name:"deepseek-r1:14b",displayName:"DeepSeek R1 14B",params:"14B",contextWindow:65536,maxEmailTokens:5e4,description:"Advanced CoT reasoning, slower but thorough",tags:["reasoning","cot","advanced"],recommended:!0,recommendedForEmailProcessing:!0}];function Ru(){return ir.filter(t=>t.recommended)}function Jo(t){return ir.find(e=>e.name===t||e.name.startsWith(t+":"))}const bv=Object.freeze(Object.defineProperty({__proto__:null,OLLAMA_MODELS:ir,getOllamaModelInfo:Jo,getRecommendedOllamaModels:Ru},Symbol.toStringTag,{value:"Module"}));let kn=null,Rr="idle",li=null,oa=new Set;function ei(){return kn||(kn=new Worker(new URL("/me-ai/assets/worker-Svid4Xkn.js",import.meta.url),{type:"module"}),kn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Rr="loading"),e.status==="ready"&&(Rr="ready"),e.status==="start"&&(Rr="generating"),(e.status==="complete"||e.status==="error")&&(Rr=li?"ready":"idle");for(const r of oa)try{r(e)}catch{}})),kn}function ao(){return{check(){ei().postMessage({type:"check"})},loadModel(t){li=t,Rr="loading",ei().postMessage({type:"load",modelId:t})},generate(t,e){ei().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,g=0;const p=w=>{switch(w.status){case"start":g=w.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=w.output,u=w.tps??u,d=w.numTokens??d,r)try{r({tps:u,numTokens:d,text:o})}catch{}break;case"complete":b(),a({text:o,tps:u,numTokens:d,inputTokens:g});break;case"error":b(),i(new Error(w.data));break}},b=()=>{oa.delete(p)};oa.add(p),ei().postMessage({type:"generate",data:t,options:e})})},interrupt(){kn==null||kn.postMessage({type:"interrupt"})},reset(){kn==null||kn.postMessage({type:"reset"})},onMessage(t){return oa.add(t),()=>oa.delete(t)},offMessage(t){oa.delete(t)},get status(){return Rr},get isReady(){return Rr==="ready"},get isGenerating(){return Rr==="generating"},get modelId(){return li},terminate(){kn==null||kn.terminate(),kn=null,Rr="idle",li=null,oa.clear()}}}const rc="http://localhost:11434";function Ds(){try{return localStorage.getItem("ollamaUrl")||rc}catch{return rc}}function wv(t){try{localStorage.setItem("ollamaUrl",t)}catch{}}async function To(t=Ds()){try{const e=await fetch(`${t}/api/version`,{method:"GET",signal:AbortSignal.timeout(5e3)});return e.ok?{connected:!0,version:(await e.json()).version}:{connected:!1,error:`HTTP ${e.status}`}}catch(e){return{connected:!1,error:e.name==="TimeoutError"?"Connection timeout":e.message}}}async function kv(t=Ds()){const e=await fetch(`${t}/api/tags`,{method:"GET",signal:AbortSignal.timeout(1e4)});if(!e.ok)throw new Error(`Failed to list models: HTTP ${e.status}`);return(await e.json()).models||[]}async function xv(t,e,{temperature:r=.7,maxTokens:a=4096,keepAlive:i}={},o=()=>{},u=Ds()){var O;const d={model:t,messages:e,stream:!0,options:{temperature:r,num_predict:a}};i!==void 0?d.keep_alive=i:d.keep_alive="10m";const g=new AbortController,p=setTimeout(()=>g.abort(),3e5),b=await fetch(`${u}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),signal:g.signal});if(clearTimeout(p),!b.ok){const z=await b.text();throw new Error(`Ollama API error: ${z}`)}const w=b.body.getReader(),k=new TextDecoder;let x="";try{for(;;){const{done:z,value:T}=await w.read();if(z)break;const fe=k.decode(T).split(`
`).filter(Boolean);for(const Q of fe)try{const M=JSON.parse(Q);if((O=M.message)!=null&&O.content&&(x+=M.message.content,o({content:M.message.content,done:!1,total_duration:M.total_duration,eval_count:M.eval_count,eval_duration:M.eval_duration})),M.done){o({content:"",done:!0,total_duration:M.total_duration,eval_count:M.eval_count,eval_duration:M.eval_duration});break}}catch{}}}finally{w.releaseLock()}return x}let jn="idle",La=null,la=new Set;function Jn(t){for(const e of la)try{e(t)}catch{}}function Sv(){return{async check(){jn="loading",Jn({status:"loading",data:"Testing Ollama connection..."});const t=await To();t.connected?(jn="idle",Jn({status:"ready",data:{type:"ollama",version:t.version,url:Ds()}})):(jn="idle",Jn({status:"error",data:`Ollama not available: ${t.error}. Make sure Ollama is running.`}))},async loadModel(t){La=t,jn="loading",Jn({status:"loading",data:`Connecting to Ollama model: ${t}...`});const e=await To();if(!e.connected){jn="idle",La=null,Jn({status:"error",data:`Ollama not available: ${e.error}`});return}jn="ready",Jn({status:"ready"})},async generate(t,e={}){if(!La){Jn({status:"error",data:"No Ollama model selected"});return}jn="generating",Jn({status:"start",inputTokens:0});let r=0,a=performance.now();try{await xv(La,t,{temperature:e.temperature??.7,maxTokens:e.maxTokens??4096},i=>{if(i.content){r++;const o=performance.now()-a,u=o>0?r/o*1e3:0;Jn({status:"update",output:i.content,tps:Math.round(u*10)/10,numTokens:r})}i.done&&(jn="ready",Jn({status:"complete",tps:i.eval_duration?Math.round(i.eval_count/(i.eval_duration/1e9)*10)/10:null,numTokens:i.eval_count||r}))})}catch(i){jn="ready",Jn({status:"error",data:i.message})}},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,g=0;const p=w=>{switch(w.status){case"start":g=w.inputTokens||0;break;case"update":if(o+=w.output,u=w.tps??u,d=w.numTokens??d,r)try{r({tps:u,numTokens:d,text:o})}catch{}break;case"complete":b(),a({text:o,tps:u,numTokens:d,inputTokens:g});break;case"error":b(),i(new Error(w.data));break}},b=()=>{la.delete(p)};la.add(p),this.generate(t,e)})},interrupt(){console.warn("Ollama doesn't support generation interruption")},reset(){},onMessage(t){return la.add(t),()=>la.delete(t)},offMessage(t){la.delete(t)},get status(){return jn},get isReady(){return jn==="ready"},get isGenerating(){return jn==="generating"},get modelId(){return La},get backend(){return"ollama"},terminate(){jn="idle",La=null,la.clear()}}}let ia=null,Je=null,so=new Set;function Tv(t){return t.startsWith("onnx-community/")||t.startsWith("microsoft/")?"webgpu":"ollama"}function Mu(){return{loadModel(t){const e=Tv(t);if(ia!==e){Je&&Je.terminate(),ia=e,Je=e==="webgpu"?ao():Sv();for(const r of so)Je.onMessage(r)}Je.loadModel(t)},check(){Je||(Je=ao(),ia="webgpu"),Je.check()},generate(t,e){if(!Je)throw new Error("No engine loaded. Call loadModel() first.");return Je.generate(t,e)},generateFull(t,e,r){return Je?Je.generateFull(t,e,r):Promise.reject(new Error("No engine loaded. Call loadModel() first."))},interrupt(){Je==null||Je.interrupt()},reset(){Je==null||Je.reset()},onMessage(t){return Je||(Je=ao(),ia="webgpu"),so.add(t),Je.onMessage(t)},offMessage(t){so.delete(t),Je==null||Je.offMessage(t)},get status(){return(Je==null?void 0:Je.status)||"idle"},get isReady(){return(Je==null?void 0:Je.isReady)||!1},get isGenerating(){return(Je==null?void 0:Je.isGenerating)||!1},get modelId(){return(Je==null?void 0:Je.modelId)||null},get backend(){return ia},getModelInfo(){const t=this.modelId;return t?ia==="webgpu"?Zo(t):Jo(t):null},terminate(){Je==null||Je.terminate(),Je=null,ia=null}}}var Ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Av(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ci={exports:{}},Cv=ci.exports,ac;function Pv(){return ac||(ac=1,(function(t,e){((r,a)=>{t.exports=a()})(Cv,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,h=s.length;f<h;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ev,u=Object.keys,d=Array.isArray;function g(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,b={}.hasOwnProperty;function w(n,s){return b.call(n,s)}function k(n,s){typeof s=="function"&&(s=s(p(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){O(n,l,s[l])})}var x=Object.defineProperty;function O(n,s,l,c){x(n,s,g(l&&w(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function z(n){return{from:function(s){return n.prototype=Object.create(s.prototype),O(n.prototype,"constructor",n),{extend:k.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,H=[].slice;function fe(n,s,l){return H.call(n,s,l)}function Q(n,s){return s(n)}function M(n){if(!n)throw new Error("Assertion Failed")}function Y(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function Z(n,s){if(typeof s=="string"&&w(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var h=Z(n,s[c]);l.push(h)}return l}var y,S=s.indexOf(".");return S===-1||(y=n[s.substr(0,S)])==null?void 0:Z(y,s.substr(S+1))}function F(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){M(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)F(n,s[c],l[c])}else{var h,y,S=s.indexOf(".");S!==-1?(h=s.substr(0,S),(S=s.substr(S+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:F(y=(y=n[h])&&w(n,h)?y:n[h]={},S,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function oe(n){var s,l={};for(s in n)w(n,s)&&(l[s]=n[s]);return l}var xe=[].concat;function Ie(n){return xe.apply([],n)}var he="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ie([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ve=new Set(he.map(function(n){return o[n]})),ee=null;function le(n){return ee=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=ee.get(l);if(c)return c;if(d(l)){c=[],ee.set(l,c);for(var f=0,h=l.length;f<h;++f)c.push(s(l[f]))}else if(ve.has(l.constructor))c=l;else{var y,S=p(l);for(y in c=S===Object.prototype?{}:Object.create(S),ee.set(l,c),l)w(l,y)&&(c[y]=s(l[y]))}return c})(n),ee=null,n}var ke={}.toString;function re(n){return ke.call(n).slice(8,-1)}var me=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Te=typeof me=="symbol"?function(n){var s;return n!=null&&(s=n[me])&&s.apply(n)}:function(){return null};function se(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var pe={};function ae(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===pe&&typeof n=="string")return[n];if(f=Te(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var te=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},he=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Pt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(he),W={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function J(n,s){this.name=n,this.message=s}function de(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function ce(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=de(n,s)}function Se(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=de(n,this.failures)}z(J).from(Error).extend({toString:function(){return this.name+": "+this.message}}),z(ce).from(J),z(Se).from(J);var Ke=Pt.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ce=J,C=Pt.reduce(function(n,s){var l=s+"Error";function c(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=W[s]||l,this.inner=null)}return z(c).from(Ce),n[s]=c,n},{}),_e=(C.Syntax=SyntaxError,C.Type=TypeError,C.Range=RangeError,he.reduce(function(n,s){return n[s+"Error"]=C[s],n},{}));he=Pt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=C[s]),n},{});function Ae(){}function Oe(n){return n}function We(n,s){return n==null||n===Oe?s:function(l){return s(n(l))}}function Ze(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Qe(n,s){return n===Ae?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?Ze(c,this.onsuccess):c),f&&(this.onerror=this.onerror?Ze(f,this.onerror):f),h!==void 0?h:l}}function ft(n,s){return n===Ae?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?Ze(l,this.onsuccess):l),c&&(this.onerror=this.onerror?Ze(c,this.onerror):c)}}function wt(n,s){return n===Ae?s:function(f){var c=n.apply(this,arguments),f=(g(f,c),this.onsuccess),h=this.onerror,y=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?Ze(f,this.onsuccess):f),h&&(this.onerror=this.onerror?Ze(h,this.onerror):h),c===void 0?y===void 0?void 0:y:g(c,y)}}function at(n,s){return n===Ae?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function Ne(n,s){return n===Ae?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return s.apply(c,h)})}return s.apply(this,arguments)}}he.ModifyError=ce,he.DexieError=J,he.BulkError=Se;var Ge=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function At(n){Ge=n}var xt={},Lt=100,Wt=typeof Promise>"u"?[]:(Pt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Wt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(Wt),Pt]:[Pt,p(Pt),Pt]),Pt=Wt[0],Da=Wt[1],Da=Da&&Da.then,Nt=Pt&&Pt.constructor,Zn=!!Wt[2],An=function(n,s){vt.push([n,s]),Cn&&(queueMicrotask(_t),Cn=!1)},cr=!0,Cn=!0,fn=[],_n=[],Pn=Oe,Rt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ae,pgp:!1,env:{},finalize:Ae},qe=Rt,vt=[],nt=0,qt=[];function Ee(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=qe;if(typeof n!="function"){if(n!==xt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&In(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(h){if(c._state===null){if(h===c)throw new TypeError("A promise cannot be resolved with itself.");var y=c._lib&&Yt();h&&typeof h.then=="function"?l(c,function(S,D){h instanceof Ee?h._then(S,D):h.then(S,D)}):(c._state=!0,c._value=h,Ia(c)),y&&Ht()}},In.bind(null,c))}catch(h){In(c,h)}})(this,n)}var vn={get:function(){var n=qe,s=Sr;function l(c,f){var h=this,y=!n.global&&(n!==qe||s!==Sr),S=y&&!Rn(),D=new Ee(function(G,j){Zr(h,new ur(P(c,n,y,S),P(f,n,y,S),G,j,n))});return this._consoleTask&&(D._consoleTask=this._consoleTask),D}return l.prototype=xt,l},set:function(n){O(this,"then",n&&n.prototype===xt?vn:{get:function(){return n},set:vn.set})}};function ur(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function In(n,s){var l,c;_n.push(s),n._state===null&&(l=n._lib&&Yt(),s=Pn(s),n._state=!1,n._value=s,c=n,fn.some(function(f){return f._value===c._value})||fn.push(c),Ia(n),l)&&Ht()}function Ia(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)Zr(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),nt===0&&(++nt,An(function(){--nt==0&&yt()},[]))}function Zr(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++nt,An(Ve,[l,n,s])}}function Ve(n,s,l){try{var c,f=s._value;!s._state&&_n.length&&(_n=[]),c=Ge&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||_n.indexOf(f)!==-1||(h=>{for(var y=fn.length;y;)if(fn[--y]._value===h._value)return fn.splice(y,1)})(s),l.resolve(c)}catch(h){l.reject(h)}finally{--nt==0&&yt(),--l.psd.ref||l.psd.finalize()}}function _t(){Fe(Rt,function(){Yt()&&Ht()})}function Yt(){var n=cr;return Cn=cr=!1,n}function Ht(){var n,s,l;do for(;0<vt.length;)for(n=vt,vt=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<vt.length);Cn=cr=!0}function yt(){for(var n=fn,s=(fn=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),qt.slice(0)),l=s.length;l;)s[--l]()}function On(n){return new Ee(xt,!1,n)}function ht(n,s){var l=qe;return function(){var c=Yt(),f=qe;try{return Mn(l,!0),n.apply(this,arguments)}catch(h){s&&s(h)}finally{Mn(f,!1),c&&Ht()}}}k(Ee.prototype,{then:vn,_then:function(n,s){Zr(this,new ur(null,null,n,s,qe))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:On)(c)}):this.then(null,function(c){return(c&&c.name===s?l:On)(c)}))},finally:function(n){return this.then(function(s){return Ee.resolve(n()).then(function(){return s})},function(s){return Ee.resolve(n()).then(function(){return On(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ee(function(c,f){var h=setTimeout(function(){return f(new C.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&O(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),Rt.env=ea(),k(Ee,{all:function(){var n=ae.apply(null,arguments).map(Tr);return new Ee(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,h){return Ee.resolve(f).then(function(y){n[h]=y,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ee?n:n&&typeof n.then=="function"?new Ee(function(s,l){n.then(s,l)}):new Ee(xt,!0,n)},reject:On,race:function(){var n=ae.apply(null,arguments).map(Tr);return new Ee(function(s,l){n.map(function(c){return Ee.resolve(c).then(s,l)})})},PSD:{get:function(){return qe},set:function(n){return qe=n}},totalEchoes:{get:function(){return Sr}},newPSD:bn,usePSD:Fe,scheduler:{get:function(){return An},set:function(n){An=n}},rejectionMapper:{get:function(){return Pn},set:function(n){Pn=n}},follow:function(n,s){return new Ee(function(l,c){return bn(function(f,h){var y=qe;y.unhandleds=[],y.onunhandled=h,y.finalize=Ze(function(){var S,D=this;S=function(){D.unhandleds.length===0?f():h(D.unhandleds[0])},qt.push(function G(){S(),qt.splice(qt.indexOf(G),1)}),++nt,An(function(){--nt==0&&yt()},[])},y.finalize),n()},s,l,c)})}}),Nt&&(Nt.allSettled&&O(Ee,"allSettled",function(){var n=ae.apply(null,arguments).map(Tr);return new Ee(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,h){return Ee.resolve(f).then(function(y){return c[h]={status:"fulfilled",value:y}},function(y){return c[h]={status:"rejected",reason:y}}).then(function(){return--l||s(c)})})})}),Nt.any&&typeof AggregateError<"u"&&O(Ee,"any",function(){var n=ae.apply(null,arguments).map(Tr);return new Ee(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(h,y){return Ee.resolve(h).then(function(S){return s(S)},function(S){f[y]=S,--c||l(new AggregateError(f))})})})}),Nt.withResolvers)&&(Ee.withResolvers=Nt.withResolvers);var It={awaits:0,echoes:0,id:0},Qt=0,yn=[],xr=0,Sr=0,Jr=0;function bn(n,y,l,c){var f=qe,h=Object.create(f),y=(h.parent=f,h.ref=0,h.global=!1,h.id=++Jr,Rt.env,h.env=Zn?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},y&&g(h,y),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Fe(h,n,l,c));return h.ref===0&&h.finalize(),y}function Vt(){return It.id||(It.id=++Qt),++It.awaits,It.echoes+=Lt,It.id}function Rn(){return!!It.awaits&&(--It.awaits==0&&(It.id=0),It.echoes=It.awaits*Lt,!0)}function Tr(n){return It.echoes&&n&&n.constructor===Nt?(Vt(),n.then(function(s){return Rn(),s},function(s){return Rn(),ge(s)})):n}function $r(){var n=yn[yn.length-1];yn.pop(),Mn(n,!1)}function Mn(n,s){var l,c,f=qe;(s?!It.echoes||xr++&&n===qe:!xr||--xr&&n===qe)||queueMicrotask(s?(function(h){++Sr,It.echoes&&--It.echoes!=0||(It.echoes=It.awaits=It.id=0),yn.push(qe),Mn(h,!0)}).bind(null,n):$r),n!==qe&&(qe=n,f===Rt&&(Rt.env=ea()),Zn)&&(l=Rt.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function ea(){var n=o.Promise;return Zn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Fe(n,s,l,c,f){var h=qe;try{return Mn(n,!0),s(l,c,f)}finally{Mn(h,!1)}}function P(n,s,l,c){return typeof n!="function"?n:function(){var f=qe;l&&Vt(),Mn(s,!0);try{return n.apply(this,arguments)}finally{Mn(f,!1),c&&queueMicrotask(Rn)}}}function we(n){Promise===Nt&&It.echoes===0?xr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Da).indexOf("[native code]")===-1&&(Vt=Rn=Ae);var ge=Ee.reject,Ye="ï¿¿",st="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",St="String expected.",Mt=[],sn="__dbnames",on="readonly",dr="readwrite";function Ct(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var ta={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function na(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=le(s))[n],s}}function pl(){throw C.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ct(n,s){try{var l=hl(n),c=hl(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=ml(n),h=ml(s),y=f.length,S=h.length,D=y<S?y:S,G=0;G<D;++G)if(f[G]!==h[G])return f[G]<h[G]?-1:1;return y===S?0:y<S?-1:1;case"Array":for(var j=n,I=s,q=j.length,B=I.length,L=q<B?q:B,R=0;R<L;++R){var V=ct(j[R],I[R]);if(V!==0)return V}return q===B?0:q<B?-1:1}}catch{}return NaN}function hl(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=re(n))==="ArrayBuffer")?"binary":s}function ml(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Ls(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,h){return!l.failures[h]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}gl.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Ja=gl;function gl(n){this["@@propmod"]=n}function _l(n,s){for(var l=u(s),c=l.length,f=!1,h=0;h<c;++h){var y=l[h],S=s[y],D=Z(n,y);S instanceof Ja?(F(n,y,S.execute(D)),f=!0):D!==S&&(F(n,y,S),f=!0)}return f}Ot.prototype._trans=function(n,s,l){var c=this._tx||qe.trans,f=this.name,h=Ge&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function y(G,j,I){if(I.schema[f])return s(I.idbtrans,I);throw new C.NotFound("Table "+f+" not part of transaction")}var S=Yt();try{var D=c&&c.db._novip===this.db._novip?c===qe.trans?c._promise(n,y,l):bn(function(){return c._promise(n,y,l)},{trans:c,transless:qe.transless||qe}):(function G(j,I,q,B){if(j.idbdb&&(j._state.openComplete||qe.letThrough||j._vip)){var L=j._createTransaction(I,q,j._dbSchema);try{L.create(),j._state.PR1398_maxLoop=3}catch(R){return R.name===Ke.InvalidState&&j.isOpen()&&0<--j._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),j.close({disableAutoOpen:!1}),j.open().then(function(){return G(j,I,q,B)})):ge(R)}return L._promise(I,function(R,V){return bn(function(){return qe.trans=L,B(R,V,L)})}).then(function(R){if(I==="readwrite")try{L.idbtrans.commit()}catch{}return I==="readonly"?R:L._completion.then(function(){return R})})}if(j._state.openComplete)return ge(new C.DatabaseClosed(j._state.dbOpenError));if(!j._state.isBeingOpened){if(!j._state.autoOpen)return ge(new C.DatabaseClosed);j.open().catch(Ae)}return j._state.dbReadyPromise.then(function(){return G(j,I,q,B)})})(this.db,n,[this.name],y);return h&&(D._consoleTask=h,D=D.catch(function(G){return console.trace(G),ge(G)})),D}finally{S&&Ht()}},Ot.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ge(new C.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},Ot.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&s.every(function(G){return 0<=S.keyPath.indexOf(G)})){for(var D=0;D<s.length;++D)if(s.indexOf(S.keyPath[D])===-1)return!1;return!0}return!1}).sort(function(S,D){return S.keyPath.length-D.keyPath.length})[0];if(l&&this.db._maxKey!==Ye)return y=l.keyPath.slice(0,s.length),this.where(y).equals(y.map(function(S){return n[S]}));!l&&Ge&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(S,D){return ct(S,D)===0}var y=s.reduce(function(j,D){var G=j[0],j=j[1],I=c[D],q=n[D];return[G||I,G||!I?Ct(j,I&&I.multi?function(B){return B=Z(B,D),d(B)&&B.some(function(L){return f(q,L)})}:function(B){return f(q,Z(B,D))}):j]},[null,null]),h=y[0],y=y[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(y):l?this.filter(y):this.where(s).equals("")},Ot.prototype.filter=function(n){return this.toCollection().and(n)},Ot.prototype.count=function(n){return this.toCollection().count(n)},Ot.prototype.offset=function(n){return this.toCollection().offset(n)},Ot.prototype.limit=function(n){return this.toCollection().limit(n)},Ot.prototype.each=function(n){return this.toCollection().each(n)},Ot.prototype.toArray=function(n){return this.toCollection().toArray(n)},Ot.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ot.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},Ot.prototype.reverse=function(){return this.toCollection().reverse()},Ot.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof pl&&(n=(y=>{var S=j,D=y;if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function G(){this.constructor=S}function j(){return y!==null&&y.apply(this,arguments)||this}return r(S,D),S.prototype=D===null?Object.create(D):(G.prototype=D.prototype,new G),Object.defineProperty(j.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),j.prototype.table=function(){return l},j})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(y){return c.add(y)});function h(y){if(!y)return y;var S,D=Object.create(n.prototype);for(S in y)if(!c.has(S))try{D[S]=y[S]}catch{}return D}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},Ot.prototype.defineClass=function(){return this.mapToClass(function(n){g(this,n)})},Ot.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,y=n;return h&&f&&(y=na(h)(n)),this._trans("readwrite",function(S){return l.core.mutate({trans:S,type:"add",keys:s!=null?[s]:null,values:[y]})}).then(function(S){return S.numFailures?Ee.reject(S.failures[0]):S.lastResult}).then(function(S){if(h)try{F(n,h,S)}catch{}return S})},Ot.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var y=h??{};return _l(y,s),c&&F(y,c,n),l.core.mutate({trans:f,type:"put",values:[y],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(S){return S.numFailures?Ee.reject(S.failures[0]):!!h})})})},Ot.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=Z(n,this.schema.primKey.keyPath))===void 0?ge(new C.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},Ot.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,y=n;return h&&f&&(y=na(h)(n)),this._trans("readwrite",function(S){return l.core.mutate({trans:S,type:"put",values:[y],keys:s!=null?[s]:null})}).then(function(S){return S.numFailures?Ee.reject(S.failures[0]):S.lastResult}).then(function(S){if(h)try{F(n,h,S)}catch{}return S})},Ot.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Ls(s,[n],c)}).then(function(c){return c.numFailures?Ee.reject(c.failures[0]):void 0})})},Ot.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:ta}).then(function(l){return Ls(n,null,l)})}).then(function(s){return s.numFailures?Ee.reject(s.failures[0]):void 0})},Ot.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},Ot.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var S=c.schema.primKey,G=S.auto,S=S.keyPath;if(S&&f)throw new C.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new C.InvalidArgument("Arguments objects and keys must have the same length");var D=n.length,G=S&&G?n.map(na(S)):n;return c.core.mutate({trans:y,type:"add",keys:f,values:G,wantResults:h}).then(function(j){var I=j.numFailures,q=j.failures;if(I===0)return h?j.results:j.lastResult;throw new Se("".concat(c.name,".bulkAdd(): ").concat(I," of ").concat(D," operations failed"),q)})})},Ot.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var S=c.schema.primKey,G=S.auto,S=S.keyPath;if(S&&f)throw new C.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new C.InvalidArgument("Arguments objects and keys must have the same length");var D=n.length,G=S&&G?n.map(na(S)):n;return c.core.mutate({trans:y,type:"put",keys:f,values:G,wantResults:h}).then(function(j){var I=j.numFailures,q=j.failures;if(I===0)return h?j.results:j.lastResult;throw new Se("".concat(c.name,".bulkPut(): ").concat(I," of ").concat(D," operations failed"),q)})})},Ot.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(y){return y.key}),f=n.map(function(y){return y.changes}),h=[];return this._trans("readwrite",function(y){return l.getMany({trans:y,keys:c,cache:"clone"}).then(function(S){var D=[],G=[],j=(n.forEach(function(I,q){var B=I.key,L=I.changes,R=S[q];if(R){for(var V=0,X=Object.keys(L);V<X.length;V++){var U=X[V],ue=L[U];if(U===s.schema.primKey.keyPath){if(ct(ue,B)!==0)throw new C.Constraint("Cannot update primary key in bulkUpdate()")}else F(R,U,ue)}h.push(q),D.push(B),G.push(R)}}),D.length);return l.mutate({trans:y,type:"put",keys:D,values:G,updates:{keys:c,changeSpecs:f}}).then(function(I){var q=I.numFailures,B=I.failures;if(q===0)return j;for(var L=0,R=Object.keys(B);L<R.length;L++){var V,X=R[L],U=h[Number(X)];U!=null&&(V=B[X],delete B[X],B[U]=V)}throw new Se("".concat(s.name,".bulkUpdate(): ").concat(q," of ").concat(j," operations failed"),B)})})})},Ot.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return Ls(s,n,f)})}).then(function(c){var f=c.numFailures,h=c.failures;if(f===0)return c.lastResult;throw new Se("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var yl=Ot;function Ot(){}function $a(n){function s(y,S){if(S){for(var D=arguments.length,G=new Array(D-1);--D;)G[D-1]=arguments[D];return l[y].subscribe.apply(null,G),n}if(typeof y=="string")return l[y]}var l={};s.addEventType=h;for(var c=1,f=arguments.length;c<f;++c)h(arguments[c]);return s;function h(y,S,D){var G,j;if(typeof y!="object")return S=S||at,j={subscribers:[],fire:D=D||Ae,subscribe:function(I){j.subscribers.indexOf(I)===-1&&(j.subscribers.push(I),j.fire=S(j.fire,I))},unsubscribe:function(I){j.subscribers=j.subscribers.filter(function(q){return q!==I}),j.fire=j.subscribers.reduce(S,D)}},l[y]=s[y]=j;u(G=y).forEach(function(I){var q=G[I];if(d(q))h(I,G[I][0],G[I][1]);else{if(q!=="asap")throw new C.InvalidArgument("Invalid event config");var B=h(I,Oe,function(){for(var L=arguments.length,R=new Array(L);L--;)R[L]=arguments[L];B.subscribers.forEach(function(V){Y(function(){V.apply(null,R)})})})}})}}function es(n,s){return z(s).from({prototype:n}),s}function Oa(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function Ci(n,s){n.filter=Ct(n.filter,s)}function Pi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return Ct(c(),s())}:s,n.justLimit=l&&!c}function Ns(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new C.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function bl(n,s,l){var c=Ns(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function qs(n,s,l,c){var f,h,y=n.replayFilter?Ct(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(S,D,G){var j,I;y&&!y(D,G,function(q){return D.stop(q)},function(q){return D.fail(q)})||((I=""+(j=D.primaryKey))=="[object ArrayBuffer]"&&(I=""+new Uint8Array(j)),w(f,I))||(f[I]=!0,s(S,D,G))},Promise.all([n.or._iterate(h,l),wl(bl(n,c,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):wl(bl(n,c,l),Ct(n.algorithm,y),s,!n.keysOnly&&n.valueMapper)}function wl(n,s,l,c){var f=ht(c?function(h,y,S){return l(c(h),y,S)}:l);return n.then(function(h){if(h)return h.start(function(){var y=function(){return h.continue()};s&&!s(h,function(S){return y=S},function(S){h.stop(S),y=Ae},function(S){h.fail(S),y=Ae})||f(h.value,h,function(S){return y=S}),y()})})}mt.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ge.bind(null,l.error)):l.table._trans("readonly",n).then(s)},mt.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ge.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},mt.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=Ct(s.algorithm,n)},mt.prototype._iterate=function(n,s){return qs(this._ctx,n,s,this._ctx.table.core)},mt.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&g(l,n),s._ctx=l,s},mt.prototype.raw=function(){return this._ctx.valueMapper=null,this},mt.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return qs(s,n,l,s.table.core)})},mt.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,h=f.table.core;return Oa(f,!0)?h.count({trans:l,query:{index:Ns(f,h.schema),range:f.range}}).then(function(y){return Math.min(y,f.limit)}):(c=0,qs(f,function(){return++c,!1},l,h).then(function(){return c}))}).then(n)},mt.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function h(D,G){return G?h(D[l[G]],G-1):D[c]}var y=this._ctx.dir==="next"?1:-1;function S(D,G){return ct(h(D,f),h(G,f))*y}return this.toArray(function(D){return D.sort(S)}).then(s)},mt.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,h,y=s._ctx;return y.dir==="next"&&Oa(y,!0)&&0<y.limit?(c=y.valueMapper,f=Ns(y,y.table.core.schema),y.table.core.query({trans:l,limit:y.limit,values:!0,query:{index:f,range:y.range}}).then(function(S){return S=S.result,c?S.map(c):S})):(h=[],qs(y,function(S){return h.push(S)},l,y.table.core).then(function(){return h}))},n)},mt.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,Oa(s)?Pi(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):Pi(s,function(){var l=n;return function(){return--l<0}})),this},mt.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Pi(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},mt.prototype.until=function(n,s){return Ci(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},mt.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},mt.prototype.last=function(n){return this.reverse().first(n)},mt.prototype.filter=function(n){var s;return Ci(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=Ct(s.isMatch,n),this},mt.prototype.and=function(n){return this.filter(n)},mt.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},mt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},mt.prototype.desc=function(){return this.reverse()},mt.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},mt.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},mt.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},mt.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},mt.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&Oa(s,!0)&&0<s.limit)return this._read(function(c){var f=Ns(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},mt.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},mt.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},mt.prototype.lastKey=function(n){return this.reverse().firstKey(n)},mt.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},Ci(this._ctx,function(c){var c=c.primaryKey.toString(),f=w(n,c);return n[c]=!0,!f})),this},mt.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(R,V){var X=V.failures;q+=R-V.numFailures;for(var U=0,ue=u(X);U<ue.length;U++){var ye=ue[U];I.push(X[ye])}}var h=typeof n=="function"?n:function(R){return _l(R,n)},y=l.table.core,j=y.schema.primaryKey,S=j.outbound,D=j.extractKey,G=200,j=s.db._options.modifyChunkSize,I=(j&&(G=typeof j=="object"?j[y.name]||j["*"]||200:j),[]),q=0,B=[],L=n===kl;return s.clone().primaryKeys().then(function(R){function V(U){var ue=Math.min(G,R.length-U),ye=R.slice(U,U+ue);return(L?Promise.resolve([]):y.getMany({trans:c,keys:ye,cache:"immutable"})).then(function(Re){var Me=[],be=[],Be=S?[]:null,Le=L?ye:[];if(!L)for(var Pe=0;Pe<ue;++Pe){var ze=Re[Pe],ut={value:le(ze),primKey:R[U+Pe]};h.call(ut,ut.value,ut)!==!1&&(ut.value==null?Le.push(R[U+Pe]):S||ct(D(ze),D(ut.value))===0?(be.push(ut.value),S&&Be.push(R[U+Pe])):(Le.push(R[U+Pe]),Me.push(ut.value)))}return Promise.resolve(0<Me.length&&y.mutate({trans:c,type:"add",values:Me}).then(function(gt){for(var He in gt.failures)Le.splice(parseInt(He),1);f(Me.length,gt)})).then(function(){return(0<be.length||X&&typeof n=="object")&&y.mutate({trans:c,type:"put",keys:Be,values:be,criteria:X,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<U}).then(function(gt){return f(be.length,gt)})}).then(function(){return(0<Le.length||X&&L)&&y.mutate({trans:c,type:"delete",keys:Le,criteria:X,isAdditionalChunk:0<U}).then(function(gt){return Ls(l.table,Le,gt)}).then(function(gt){return f(Le.length,gt)})}).then(function(){return R.length>U+ue&&V(U+G)})})}var X=Oa(l)&&l.limit===1/0&&(typeof n!="function"||L)&&{index:l.index,range:l.range};return V(0).then(function(){if(0<I.length)throw new ce("Error modifying one or more objects",I,q,B);return R.length})})})},mt.prototype.delete=function(){var n=this._ctx,s=n.range;return!Oa(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(kl):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(D){var S=D.failures,D=D.numFailures;if(D)throw new ce("Could not delete some values",Object.keys(S).map(function(G){return S[G]}),h-D);return h-D})})})};var _d=mt;function mt(){}var kl=function(n,s){return s.value=null};function yd(n,s){return n<s?-1:n===s?0:1}function bd(n,s){return s<n?-1:n===s?0:1}function Dn(n,s,l){return n=n instanceof Sl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function Ra(n){return new n.Collection(n,function(){return xl("")}).limit(0)}function Bs(B,s,l,c){var f,h,y,S,D,G,j,I=l.length;if(!l.every(function(R){return typeof R=="string"}))return Dn(B,St);function q(R){f=R==="next"?function(X){return X.toUpperCase()}:function(X){return X.toLowerCase()},h=R==="next"?function(X){return X.toLowerCase()}:function(X){return X.toUpperCase()},y=R==="next"?yd:bd;var V=l.map(function(X){return{lower:h(X),upper:f(X)}}).sort(function(X,U){return y(X.lower,U.lower)});S=V.map(function(X){return X.upper}),D=V.map(function(X){return X.lower}),j=(G=R)==="next"?"":c}q("next");var B=new B.Collection(B,function(){return qr(S[0],D[I-1]+c)}),L=(B._ondirectionchange=function(R){q(R)},0);return B._addAlgorithm(function(R,V,X){var U=R.key;if(typeof U=="string"){var ue=h(U);if(s(ue,D,L))return!0;for(var ye=null,Re=L;Re<I;++Re){var Me=((be,Be,Le,Pe,ze,ut)=>{for(var gt=Math.min(be.length,Pe.length),He=-1,et=0;et<gt;++et){var Dt=Be[et];if(Dt!==Pe[et])return ze(be[et],Le[et])<0?be.substr(0,et)+Le[et]+Le.substr(et+1):ze(be[et],Pe[et])<0?be.substr(0,et)+Pe[et]+Le.substr(et+1):0<=He?be.substr(0,He)+Be[He]+Le.substr(He+1):null;ze(be[et],Dt)<0&&(He=et)}return gt<Pe.length&&ut==="next"?be+Le.substr(be.length):gt<be.length&&ut==="prev"?be.substr(0,Le.length):He<0?null:be.substr(0,He)+Pe[He]+Le.substr(He+1)})(U,ue,S[Re],D[Re],y,G);Me===null&&ye===null?L=Re+1:(ye===null||0<y(ye,Me))&&(ye=Me)}V(ye!==null?function(){R.continue(ye+j)}:X)}return!1}),B}function qr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function xl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Xt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Xt.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?Ra(this):new this.Collection(this,function(){return qr(n,s,!l,!c)})}catch{return Dn(this,st)}},Xt.prototype.equals=function(n){return n==null?Dn(this,st):new this.Collection(this,function(){return xl(n)})},Xt.prototype.above=function(n){return n==null?Dn(this,st):new this.Collection(this,function(){return qr(n,void 0,!0)})},Xt.prototype.aboveOrEqual=function(n){return n==null?Dn(this,st):new this.Collection(this,function(){return qr(n,void 0,!1)})},Xt.prototype.below=function(n){return n==null?Dn(this,st):new this.Collection(this,function(){return qr(void 0,n,!1,!0)})},Xt.prototype.belowOrEqual=function(n){return n==null?Dn(this,st):new this.Collection(this,function(){return qr(void 0,n)})},Xt.prototype.startsWith=function(n){return typeof n!="string"?Dn(this,St):this.between(n,n+Ye,!0,!0)},Xt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Bs(this,function(s,l){return s.indexOf(l[0])===0},[n],Ye)},Xt.prototype.equalsIgnoreCase=function(n){return Bs(this,function(s,l){return s===l[0]},[n],"")},Xt.prototype.anyOfIgnoreCase=function(){var n=ae.apply(pe,arguments);return n.length===0?Ra(this):Bs(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Xt.prototype.startsWithAnyOfIgnoreCase=function(){var n=ae.apply(pe,arguments);return n.length===0?Ra(this):Bs(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,Ye)},Xt.prototype.anyOf=function(){var n,s,l=this,c=ae.apply(pe,arguments),f=this._cmp;try{c.sort(f)}catch{return Dn(this,st)}return c.length===0?Ra(this):((n=new this.Collection(this,function(){return qr(c[0],c[c.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(h,y,S){for(var D=h.key;0<f(D,c[s]);)if(++s===c.length)return y(S),!1;return f(D,c[s])===0||(y(function(){h.continue(c[s])}),!1)}),n)},Xt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Xt.prototype.noneOf=function(){var n=ae.apply(pe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Dn(this,st)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Xt.prototype.inAnyRange=function(n,X){var l=this,c=this._cmp,f=this._ascending,h=this._descending,y=this._min,S=this._max;if(n.length===0)return Ra(this);if(!n.every(function(U){return U[0]!==void 0&&U[1]!==void 0&&f(U[0],U[1])<=0}))return Dn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",C.InvalidArgument);var D=!X||X.includeLowers!==!1,G=X&&X.includeUppers===!0,j,I=f;function q(U,ue){return I(U[0],ue[0])}try{(j=n.reduce(function(U,ue){for(var ye=0,Re=U.length;ye<Re;++ye){var Me=U[ye];if(c(ue[0],Me[1])<0&&0<c(ue[1],Me[0])){Me[0]=y(Me[0],ue[0]),Me[1]=S(Me[1],ue[1]);break}}return ye===Re&&U.push(ue),U},[])).sort(q)}catch{return Dn(this,st)}var B=0,L=G?function(U){return 0<f(U,j[B][1])}:function(U){return 0<=f(U,j[B][1])},R=D?function(U){return 0<h(U,j[B][0])}:function(U){return 0<=h(U,j[B][0])},V=L,X=new this.Collection(this,function(){return qr(j[0][0],j[j.length-1][1],!D,!G)});return X._ondirectionchange=function(U){I=U==="next"?(V=L,f):(V=R,h),j.sort(q)},X._addAlgorithm(function(U,ue,ye){for(var Re,Me=U.key;V(Me);)if(++B===j.length)return ue(ye),!1;return!L(Re=Me)&&!R(Re)||(l._cmp(Me,j[B][1])===0||l._cmp(Me,j[B][0])===0||ue(function(){I===f?U.continue(j[B][0]):U.continue(j[B][1])}),!1)}),X},Xt.prototype.startsWithAnyOf=function(){var n=ae.apply(pe,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?Ra(this):this.inAnyRange(n.map(function(s){return[s,s+Ye]})):Dn(this,"startsWithAnyOf() only works with strings")};var Sl=Xt;function Xt(){}function fr(n){return ht(function(s){return ts(s),n(s.target.error),!1})}function ts(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ns="storagemutated",Ii="x-storagemutated-1",Br=$a(null,ns),wd=(vr.prototype._lock=function(){return M(!qe.global),++this._reculock,this._reculock!==1||qe.global||(qe.lockOwnerFor=this),this},vr.prototype._unlock=function(){if(M(!qe.global),--this._reculock==0)for(qe.global||(qe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Fe(n[1],n[0])}catch{}}return this},vr.prototype._locked=function(){return this._reculock&&qe.lockOwnerFor!==this},vr.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(M(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new C.DatabaseClosed(c);case"MissingAPIError":throw new C.MissingAPI(c.message,c);default:throw new C.OpenFailed(c)}if(!this.active)throw new C.TransactionInactive;M(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ht(function(f){ts(f),s._reject(n.error)}),n.onabort=ht(function(f){ts(f),s.active&&s._reject(new C.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=ht(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Br.storagemutated.fire(n.mutatedParts)})}return this},vr.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?ge(new C.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ee(function(h,y){f._blockedFuncs.push([function(){f._promise(n,s,l).then(h,y)},qe])}):l?bn(function(){var h=new Ee(function(y,S){f._lock();var D=s(y,S,f);D&&D.then&&D.then(y,S)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((c=new Ee(function(h,y){var S=s(h,y,f);S&&S.then&&S.then(h,y)}))._lib=!0,c):ge(new C.TransactionInactive)},vr.prototype._root=function(){return this.parent?this.parent._root():this},vr.prototype.waitFor=function(n){var s,l=this._root(),c=Ee.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=h)})()),l._waitingFor);return new Ee(function(h,y){c.then(function(S){return l._waitingQueue.push(ht(h.bind(null,S)))},function(S){return l._waitingQueue.push(ht(y.bind(null,S)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},vr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new C.Abort))},vr.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(w(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new C.NotFound("Table "+n+" not part of transaction")},vr);function vr(){}function Oi(n,s,l,c,f,h,y,S){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:h,src:(l&&!y?"&":"")+(c?"*":"")+(f?"++":"")+Tl(s),type:S}}function Tl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Ri(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,h,y){return h=c(h,y),h&&(f[h[0]]=h[1]),f},{}))};var c}var rs=function(n){try{return n.only([[]]),rs=function(){return[[]]},[[]]}catch{return rs=function(){return Ye},Ye}};function Mi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return Z(l,s)}:function(l){return Z(l,n)};var s}function El(n){return[].slice.call(n)}var kd=0;function as(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function xd(n,s,D){function c(L){if(L.type===3)return null;if(L.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var I=L.lower,q=L.upper,B=L.lowerOpen,L=L.upperOpen;return I===void 0?q===void 0?null:s.upperBound(q,!!L):q===void 0?s.lowerBound(I,!!B):s.bound(I,q,!!B,!!L)}function f(j){var I,q=j.name;return{name:q,schema:j,mutate:function(B){var L=B.trans,R=B.type,V=B.keys,X=B.values,U=B.range;return new Promise(function(ue,ye){ue=ht(ue);var Re=L.objectStore(q),Me=Re.keyPath==null,be=R==="put"||R==="add";if(!be&&R!=="delete"&&R!=="deleteRange")throw new Error("Invalid operation type: "+R);var Be,Le=(V||X||{length:1}).length;if(V&&X&&V.length!==X.length)throw new Error("Given keys array must have same length as given values array.");if(Le===0)return ue({numFailures:0,failures:{},results:[],lastResult:void 0});function Pe(Bt){++gt,ts(Bt)}var ze=[],ut=[],gt=0;if(R==="deleteRange"){if(U.type===4)return ue({numFailures:gt,failures:ut,results:[],lastResult:void 0});U.type===3?ze.push(Be=Re.clear()):ze.push(Be=Re.delete(c(U)))}else{var Me=be?Me?[X,V]:[X,null]:[V,null],He=Me[0],et=Me[1];if(be)for(var Dt=0;Dt<Le;++Dt)ze.push(Be=et&&et[Dt]!==void 0?Re[R](He[Dt],et[Dt]):Re[R](He[Dt])),Be.onerror=Pe;else for(Dt=0;Dt<Le;++Dt)ze.push(Be=Re[R](He[Dt])),Be.onerror=Pe}function Kn(Bt){Bt=Bt.target.result,ze.forEach(function(sa,Zi){return sa.error!=null&&(ut[Zi]=sa.error)}),ue({numFailures:gt,failures:ut,results:R==="delete"?V:ze.map(function(sa){return sa.result}),lastResult:Bt})}Be.onerror=function(Bt){Pe(Bt),Kn(Bt)},Be.onsuccess=Kn})},getMany:function(B){var L=B.trans,R=B.keys;return new Promise(function(V,X){V=ht(V);for(var U,ue=L.objectStore(q),ye=R.length,Re=new Array(ye),Me=0,be=0,Be=function(ze){ze=ze.target,Re[ze._pos]=ze.result,++be===Me&&V(Re)},Le=fr(X),Pe=0;Pe<ye;++Pe)R[Pe]!=null&&((U=ue.get(R[Pe]))._pos=Pe,U.onsuccess=Be,U.onerror=Le,++Me);Me===0&&V(Re)})},get:function(B){var L=B.trans,R=B.key;return new Promise(function(V,X){V=ht(V);var U=L.objectStore(q).get(R);U.onsuccess=function(ue){return V(ue.target.result)},U.onerror=fr(X)})},query:(I=S,function(B){return new Promise(function(L,R){L=ht(L);var V,X,U,be=B.trans,ue=B.values,ye=B.limit,Me=B.query,Re=ye===1/0?void 0:ye,Be=Me.index,Me=Me.range,be=be.objectStore(q),be=Be.isPrimaryKey?be:be.index(Be.name),Be=c(Me);if(ye===0)return L({result:[]});I?((Me=ue?be.getAll(Be,Re):be.getAllKeys(Be,Re)).onsuccess=function(Le){return L({result:Le.target.result})},Me.onerror=fr(R)):(V=0,X=!ue&&"openKeyCursor"in be?be.openKeyCursor(Be):be.openCursor(Be),U=[],X.onsuccess=function(Le){var Pe=X.result;return!Pe||(U.push(ue?Pe.value:Pe.primaryKey),++V===ye)?L({result:U}):void Pe.continue()},X.onerror=fr(R))})}),openCursor:function(B){var L=B.trans,R=B.values,V=B.query,X=B.reverse,U=B.unique;return new Promise(function(ue,ye){ue=ht(ue);var be=V.index,Re=V.range,Me=L.objectStore(q),Me=be.isPrimaryKey?Me:Me.index(be.name),be=X?U?"prevunique":"prev":U?"nextunique":"next",Be=!R&&"openKeyCursor"in Me?Me.openKeyCursor(c(Re),be):Me.openCursor(c(Re),be);Be.onerror=fr(ye),Be.onsuccess=ht(function(Le){var Pe,ze,ut,gt,He=Be.result;He?(He.___id=++kd,He.done=!1,Pe=He.continue.bind(He),ze=(ze=He.continuePrimaryKey)&&ze.bind(He),ut=He.advance.bind(He),gt=function(){throw new Error("Cursor not stopped")},He.trans=L,He.stop=He.continue=He.continuePrimaryKey=He.advance=function(){throw new Error("Cursor not started")},He.fail=ht(ye),He.next=function(){var et=this,Dt=1;return this.start(function(){return Dt--?et.continue():et.stop()}).then(function(){return et})},He.start=function(et){function Dt(){if(Be.result)try{et()}catch(Bt){He.fail(Bt)}else He.done=!0,He.start=function(){throw new Error("Cursor behind last entry")},He.stop()}var Kn=new Promise(function(Bt,sa){Bt=ht(Bt),Be.onerror=fr(sa),He.fail=sa,He.stop=function(Zi){He.stop=He.continue=He.continuePrimaryKey=He.advance=gt,Bt(Zi)}});return Be.onsuccess=ht(function(Bt){Be.onsuccess=Dt,Dt()}),He.continue=Pe,He.continuePrimaryKey=ze,He.advance=ut,Dt(),Kn},ue(He)):ue(null)},ye)})},count:function(B){var L=B.query,R=B.trans,V=L.index,X=L.range;return new Promise(function(U,ue){var ye=R.objectStore(q),ye=V.isPrimaryKey?ye:ye.index(V.name),Re=c(X),Re=Re?ye.count(Re):ye.count();Re.onsuccess=ht(function(Me){return U(Me.target.result)}),Re.onerror=fr(ue)})}}}h=D,y=El((D=n).objectStoreNames);var h,D={schema:{name:D.name,tables:y.map(function(j){return h.objectStore(j)}).map(function(j){var I=j.keyPath,q=j.autoIncrement,L=d(I),B={},L={name:j.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:I==null,compound:L,keyPath:I,autoIncrement:q,unique:!0,extractKey:Mi(I)},indexes:El(j.indexNames).map(function(R){return j.index(R)}).map(function(U){var ue=U.name,V=U.unique,X=U.multiEntry,U=U.keyPath,ue={name:ue,compound:d(U),keyPath:U,unique:V,multiEntry:X,extractKey:Mi(U)};return B[as(U)]=ue}),getIndexByKeyPath:function(R){return B[as(R)]}};return B[":id"]=L.primaryKey,I!=null&&(B[as(I)]=L.primaryKey),L})},hasGetAll:0<y.length&&"getAll"in h.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},y=D.schema,S=D.hasGetAll,D=y.tables.map(f),G={};return D.forEach(function(j){return G[j.name]=j}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(j){if(G[j])return G[j];throw new Error("Table '".concat(j,"' not found"))},MIN_KEY:-1/0,MAX_KEY:rs(s),schema:y}}function Sd(n,s,l,c){return l=l.IDBKeyRange,s=xd(s,l,c),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,a(a({},f),h(f))},s)}}function zs(n,s){var l=s.db,l=Sd(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(h){return h.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function Fs(n,s,l,c){l.forEach(function(f){var h=c[f];s.forEach(function(y){var S=(function D(G,j){return T(G,j)||(G=p(G))&&D(G,j)})(y,f);(!S||"value"in S&&S.value===void 0)&&(y===n.Transaction.prototype||y instanceof n.Transaction?O(y,f,{get:function(){return this.table(f)},set:function(D){x(this,f,{value:D,writable:!0,configurable:!0,enumerable:!0})}}):y[f]=new n.Table(f,h))})})}function Di(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function Td(n,s){return n._cfg.version-s._cfg.version}function Ed(n,s,l,c){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=Ri("$meta",Cl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),y=(h.create(l),h._completion.catch(c),h._reject.bind(h)),S=qe.transless||qe;bn(function(){if(qe.trans=h,qe.transless=S,s!==0)return zs(n,l),G=s,((D=h).storeNames.includes("$meta")?D.table("$meta").get("version").then(function(j){return j??G}):Ee.resolve(G)).then(function(V){var I=n,q=V,B=h,L=l,R=[],V=I._versions,X=I._dbSchema=Us(0,I.idbdb,L);return(V=V.filter(function(U){return U._cfg.version>=q})).length===0?Ee.resolve():(V.forEach(function(U){R.push(function(){var ue,ye,Re,Me=X,be=U._cfg.dbschema,Be=(Gs(I,Me,L),Gs(I,be,L),X=I._dbSchema=be,ji(Me,be)),Le=(Be.add.forEach(function(Pe){Li(L,Pe[0],Pe[1].primKey,Pe[1].indexes)}),Be.change.forEach(function(Pe){if(Pe.recreate)throw new C.Upgrade("Not yet support for changing primary key");var ze=L.objectStore(Pe.name);Pe.add.forEach(function(ut){return Ks(ze,ut)}),Pe.change.forEach(function(ut){ze.deleteIndex(ut.name),Ks(ze,ut)}),Pe.del.forEach(function(ut){return ze.deleteIndex(ut)})}),U._cfg.contentUpgrade);if(Le&&U._cfg.version>q)return zs(I,L),B._memoizedTables={},ue=oe(be),Be.del.forEach(function(Pe){ue[Pe]=Me[Pe]}),Di(I,[I.Transaction.prototype]),Fs(I,[I.Transaction.prototype],u(ue),ue),B.schema=ue,(ye=te(Le))&&Vt(),be=Ee.follow(function(){var Pe;(Re=Le(B))&&ye&&(Pe=Rn.bind(null,null),Re.then(Pe,Pe))}),Re&&typeof Re.then=="function"?Ee.resolve(Re):be.then(function(){return Re})}),R.push(function(ue){var ye,Re,Me=U._cfg.dbschema;ye=Me,Re=ue,[].slice.call(Re.db.objectStoreNames).forEach(function(be){return ye[be]==null&&Re.db.deleteObjectStore(be)}),Di(I,[I.Transaction.prototype]),Fs(I,[I.Transaction.prototype],I._storeNames,I._dbSchema),B.schema=I._dbSchema}),R.push(function(ue){I.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(I.idbdb.version/10)===U._cfg.version?(I.idbdb.deleteObjectStore("$meta"),delete I._dbSchema.$meta,I._storeNames=I._storeNames.filter(function(ye){return ye!=="$meta"})):ue.objectStore("$meta").put(U._cfg.version,"version"))})}),(function U(){return R.length?Ee.resolve(R.shift()(B.idbtrans)).then(U):Ee.resolve()})().then(function(){Al(X,L)}))}).catch(y);var D,G;u(f).forEach(function(j){Li(l,j,f[j].primKey,f[j].indexes)}),zs(n,l),Ee.follow(function(){return n.on.populate.fire(h)}).catch(y)})}function Ad(n,s){Al(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Us(0,n.idbdb,s);Gs(n,n._dbSchema,s);for(var c=0,f=ji(l,n._dbSchema).change;c<f.length;c++){var h=(y=>{if(y.change.length||y.recreate)return console.warn("Unable to patch indexes of table ".concat(y.name," because it has changes on the type of index or primary key.")),{value:void 0};var S=s.objectStore(y.name);y.add.forEach(function(D){Ge&&console.debug("Dexie upgrade patch: Creating missing index ".concat(y.name,".").concat(D.src)),Ks(S,D)})})(f[c]);if(typeof h=="object")return h.value}}function ji(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],h=s[l];if(f){var y={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)y.recreate=!0,c.change.push(y);else{var S=f.idxByName,D=h.idxByName,G=void 0;for(G in S)D[G]||y.del.push(G);for(G in D){var j=S[G],I=D[G];j?j.src!==I.src&&y.change.push(I):y.add.push(I)}(0<y.del.length||0<y.add.length||0<y.change.length)&&c.change.push(y)}}else c.add.push([l,h])}return c}function Li(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(h){return Ks(f,h)})}function Al(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(Ge&&console.debug("Dexie: Creating missing table",l),Li(s,l,n[l].primKey,n[l].indexes))})}function Ks(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Us(n,s,l){var c={};return fe(s.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),y=Oi(Tl(G=h.keyPath),G||"",!0,!1,!!h.autoIncrement,G&&typeof G!="string",!0),S=[],D=0;D<h.indexNames.length;++D){var j=h.index(h.indexNames[D]),G=j.keyPath,j=Oi(j.name,G,!!j.unique,!!j.multiEntry,!1,G&&typeof G!="string",!1);S.push(j)}c[f]=Ri(f,y,S)}),c}function Gs(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var h=c[f],y=l.objectStore(h);n._hasGetAll="getAll"in y;for(var S=0;S<y.indexNames.length;++S){var D,G=y.indexNames[S],j=y.index(G).keyPath,j=typeof j=="string"?j:"["+fe(j).join("+")+"]";s[h]&&(D=s[h].idxByName[j])&&(D.name=G,delete s[h].idxByName[j],s[h].idxByName[G]=D)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Cl(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return Oi(f,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(h),l===0,c)})}Ma.prototype._createTableSchema=Ri,Ma.prototype._parseIndexSyntax=Cl,Ma.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),h=f.shift();if(!h)throw new C.Schema("Invalid schema for table "+c+": "+n[c]);if(h.unique=!0,h.multi)throw new C.Schema("Primary key cannot be multiEntry*");f.forEach(function(y){if(y.auto)throw new C.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new C.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(c,h,f),s[c]=h}})},Ma.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(h){g(c,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(c,f)}),s._dbSchema=f,Di(s,[s._allTables,s,s.Transaction.prototype]),Fs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},Ma.prototype.upgrade=function(n){return this._cfg.contentUpgrade=Ne(this._cfg.contentUpgrade||Ae,n),this};var Cd=Ma;function Ma(){}function Ni(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new Er(sn,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function qi(n){return n&&typeof n.databases=="function"}function Bi(n){return bn(function(){return qe.letThrough=!0,n()})}function zi(n){return!("from"in n)}var ln=function(n,s){var l;if(!this)return l=new ln,n&&"d"in n&&g(l,n),l;g(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function ss(n,s,l){var c=ct(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(zi(n))return g(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(ct(l,n.from)<0)return c?ss(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},Il(n);if(0<ct(s,n.to))return f?ss(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},Il(n);ct(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<ct(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&is(n,c),f&&s&&is(n,f)}}function is(n,s){zi(s)||(function l(c,f){var h=f.from,y=f.l,S=f.r;ss(c,h,f.to),y&&l(c,y),S&&l(c,S)})(n,s)}function Pl(n,s){var l=Ws(s),c=l.next();if(!c.done)for(var f=c.value,h=Ws(n),y=h.next(f.from),S=y.value;!c.done&&!y.done;){if(ct(S.from,f.to)<=0&&0<=ct(S.to,f.from))return!0;ct(f.from,S.from)<0?f=(c=l.next(S.from)).value:S=(y=h.next(f.from)).value}return!1}function Ws(n){var s=zi(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&ct(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||ct(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function Il(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=Ol(l)),n.d=Ol(n)}function Ol(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Hs(n,s){return u(s).forEach(function(l){n[l]?is(n[l],s[l]):n[l]=(function c(f){var h,y,S={};for(h in f)w(f,h)&&(y=f[h],S[h]=!y||typeof y!="object"||ve.has(y.constructor)?y:c(y));return S})(s[l])}),n}function Fi(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&Pl(s[l],n[l])})}k(ln.prototype,((Pt={add:function(n){return is(this,n),this},addKey:function(n){return ss(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return ss(s,l,l)}),this},hasKey:function(n){var s=Ws(this).next(n).value;return s&&ct(s.from,n)<=0&&0<=ct(s.to,n)}})[me]=function(){return Ws(this)},Pt));var ra={},Ki={},Ui=!1;function Vs(n){Hs(Ki,n),Ui||(Ui=!0,setTimeout(function(){Ui=!1,Gi(Ki,!(Ki={}))},0))}function Gi(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values(ra);c<f.length;c++)Rl(S=f[c],n,l,s);else for(var h in n){var y,S,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(y=h[1],h=h[2],S=ra["idb://".concat(y,"/").concat(h)])&&Rl(S,n,l,s)}l.forEach(function(D){return D()})}function Rl(n,s,l,c){for(var f=[],h=0,y=Object.entries(n.queries.query);h<y.length;h++){for(var S=y[h],D=S[0],G=[],j=0,I=S[1];j<I.length;j++){var q=I[j];Fi(s,q.obsSet)?q.subscribers.forEach(function(V){return l.add(V)}):c&&G.push(q)}c&&f.push([D,G])}if(c)for(var B=0,L=f;B<L.length;B++){var R=L[B],D=R[0],G=R[1];n.queries.query[D]=G}}function Pd(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ge(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),h=!1;function y(){if(s.openCanceller!==c)throw new C.DatabaseClosed("db.open() was cancelled")}function S(){return new Ee(function(q,B){if(y(),!l)throw new C.MissingAPI;var L=n.name,R=s.autoSchema||!f?l.open(L):l.open(L,f);if(!R)throw new C.MissingAPI;R.onerror=fr(B),R.onblocked=ht(n._fireOnBlocked),R.onupgradeneeded=ht(function(V){var X;j=R.transaction,s.autoSchema&&!n._options.allowEmptyDB?(R.onerror=ts,j.abort(),R.result.close(),(X=l.deleteDatabase(L)).onsuccess=X.onerror=ht(function(){B(new C.NoSuchDatabase("Database ".concat(L," doesnt exist")))})):(j.onerror=fr(B),X=V.oldVersion>Math.pow(2,62)?0:V.oldVersion,I=X<1,n.idbdb=R.result,h&&Ad(n,j),Ed(n,X/10,j,B))},B),R.onsuccess=ht(function(){j=null;var V,X,U,ue,ye,Re,Me=n.idbdb=R.result,be=fe(Me.objectStoreNames);if(0<be.length)try{var Be=Me.transaction((ye=be).length===1?ye[0]:ye,"readonly");if(s.autoSchema)Re=Me,ue=Be,(U=n).verno=Re.version/10,ue=U._dbSchema=Us(0,Re,ue),U._storeNames=fe(Re.objectStoreNames,0),Fs(U,[U._allTables],u(ue),ue);else if(Gs(n,n._dbSchema,Be),X=Be,((X=ji(Us(0,(V=n).idbdb,X),V._dbSchema)).add.length||X.change.some(function(Le){return Le.add.length||Le.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Me.close(),f=Me.version+1,h=!0,q(S());zs(n,Be)}catch{}Mt.push(n),Me.onversionchange=ht(function(Le){s.vcFired=!0,n.on("versionchange").fire(Le)}),Me.onclose=ht(function(){n.close({disableAutoOpen:!1})}),I&&(be=n._deps,ye=L,qi(Re=be.indexedDB)||ye===sn||Ni(Re,be.IDBKeyRange).put({name:ye}).catch(Ae)),q()},B)}).catch(function(q){switch(q==null?void 0:q.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),S();break;case"VersionError":if(0<f)return f=0,S()}return Ee.reject(q)})}var D,G=s.dbReadyResolve,j=null,I=!1;return Ee.race([c,(typeof navigator>"u"?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(q){function B(){return indexedDB.databases().finally(q)}D=setInterval(B,100),B()}).finally(function(){return clearInterval(D)}):Promise.resolve()).then(S)]).then(function(){return y(),s.onReadyBeingFired=[],Ee.resolve(Bi(function(){return n.on.ready.fire(n.vip)})).then(function q(){var B;if(0<s.onReadyBeingFired.length)return B=s.onReadyBeingFired.reduce(Ne,Ae),s.onReadyBeingFired=[],Ee.resolve(Bi(function(){return B(n.vip)})).then(q)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(q){s.dbOpenError=q;try{j&&j.abort()}catch{}return c===s.openCanceller&&n._close(),ge(q)}).finally(function(){s.openComplete=!0,G()}).then(function(){var q;return I&&(q={},n.tables.forEach(function(B){B.schema.indexes.forEach(function(L){L.name&&(q["idb://".concat(n.name,"/").concat(B.name,"/").concat(L.name)]=new ln(-1/0,[[[]]]))}),q["idb://".concat(n.name,"/").concat(B.name,"/")]=q["idb://".concat(n.name,"/").concat(B.name,"/:dels")]=new ln(-1/0,[[[]]])}),Br(ns).fire(q),Gi(q,!0)),n})}function Wi(n){function s(h){return n.next(h)}var l=f(s),c=f(function(h){return n.throw(h)});function f(h){return function(S){var S=h(S),D=S.value;return S.done?D:D&&typeof D.then=="function"?D.then(l,c):d(D)?Promise.all(D).then(l,c):l(D)}}return f(s)()}function Ys(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var Id={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},h=[];function y(q,B,L){var U=as(q),R=f[U]=f[U]||[],V=q==null?0:typeof q=="string"?1:q.length,X=0<B,U=a(a({},L),{name:X?"".concat(U,"(virtual-from:").concat(L.name,")"):L.name,lowLevelIndex:L,isVirtual:X,keyTail:B,keyLength:V,extractKey:Mi(q),unique:!X&&L.unique});return R.push(U),U.isPrimaryKey||h.push(U),1<V&&y(V===2?q[0]:q.slice(0,V-1),B+1,L),R.sort(function(ue,ye){return ue.keyTail-ye.keyTail}),U}var S=y(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[S];for(var D=0,G=c.indexes;D<G.length;D++){var j=G[D];y(j.keyPath,0,j)}function I(q){var B,L=q.query.index;return L.isVirtual?a(a({},q),{query:{index:L.lowLevelIndex,range:(B=q.query.range,L=L.keyTail,{type:B.type===1?2:B.type,lower:Ys(B.lower,B.lowerOpen?n.MAX_KEY:n.MIN_KEY,L),lowerOpen:!0,upper:Ys(B.upper,B.upperOpen?n.MIN_KEY:n.MAX_KEY,L),upperOpen:!0})}}):q}return a(a({},l),{schema:a(a({},c),{primaryKey:S,indexes:h,getIndexByKeyPath:function(q){return(q=f[as(q)])&&q[0]}}),count:function(q){return l.count(I(q))},query:function(q){return l.query(I(q))},openCursor:function(q){var B=q.query.index,L=B.keyTail,R=B.keyLength;return B.isVirtual?l.openCursor(I(q)).then(function(X){return X&&V(X)}):l.openCursor(q);function V(X){return Object.create(X,{continue:{value:function(U){U!=null?X.continue(Ys(U,q.reverse?n.MAX_KEY:n.MIN_KEY,L)):q.unique?X.continue(X.key.slice(0,R).concat(q.reverse?n.MIN_KEY:n.MAX_KEY,L)):X.continue()}},continuePrimaryKey:{value:function(U,ue){X.continuePrimaryKey(Ys(U,n.MAX_KEY,L),ue)}},primaryKey:{get:function(){return X.primaryKey}},key:{get:function(){var U=X.key;return R===1?U[0]:U.slice(0,R)}},value:{get:function(){return X.value}}})}}})}})}};function Hi(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var h,y,S;w(s,f)?(h=n[f],y=s[f],typeof h=="object"&&typeof y=="object"&&h&&y?(S=re(h))!==re(y)?l[c+f]=s[f]:S==="Object"?Hi(h,y,l,c+f+"."):h!==y&&(l[c+f]=s[f]):h!==y&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){w(n,f)||(l[c+f]=s[f])}),l}function Vi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var Od={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var h=qe.trans,y=h.table(s).hook,S=y.deleting,D=y.creating,G=y.updating;switch(f.type){case"add":if(D.fire===Ae)break;return h._promise("readwrite",function(){return j(f)},!0);case"put":if(D.fire===Ae&&G.fire===Ae)break;return h._promise("readwrite",function(){return j(f)},!0);case"delete":if(S.fire===Ae)break;return h._promise("readwrite",function(){return j(f)},!0);case"deleteRange":if(S.fire===Ae)break;return h._promise("readwrite",function(){return(function I(q,B,L){return l.query({trans:q,values:!1,query:{index:c,range:B},limit:L}).then(function(R){var V=R.result;return j({type:"delete",keys:V,trans:q}).then(function(X){return 0<X.numFailures?Promise.reject(X.failures[0]):V.length<L?{failures:[],numFailures:0,lastResult:void 0}:I(q,a(a({},B),{lower:V[V.length-1],lowerOpen:!0}),L)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function j(I){var q,B,L,R=qe.trans,V=I.keys||Vi(c,I);if(V)return(I=I.type==="add"||I.type==="put"?a(a({},I),{keys:V}):a({},I)).type!=="delete"&&(I.values=i([],I.values)),I.keys&&(I.keys=i([],I.keys)),q=l,L=V,((B=I).type==="add"?Promise.resolve([]):q.getMany({trans:B.trans,keys:L,cache:"immutable"})).then(function(X){var U=V.map(function(ue,ye){var Re,Me,be,Be=X[ye],Le={onerror:null,onsuccess:null};return I.type==="delete"?S.fire.call(Le,ue,Be,R):I.type==="add"||Be===void 0?(Re=D.fire.call(Le,ue,I.values[ye],R),ue==null&&Re!=null&&(I.keys[ye]=ue=Re,c.outbound||F(I.values[ye],c.keyPath,ue))):(Re=Hi(Be,I.values[ye]),(Me=G.fire.call(Le,Re,ue,Be,R))&&(be=I.values[ye],Object.keys(Me).forEach(function(Pe){w(be,Pe)?be[Pe]=Me[Pe]:F(be,Pe,Me[Pe])}))),Le});return l.mutate(I).then(function(ue){for(var ye=ue.failures,Re=ue.results,Me=ue.numFailures,ue=ue.lastResult,be=0;be<V.length;++be){var Be=(Re||V)[be],Le=U[be];Be==null?Le.onerror&&Le.onerror(ye[be]):Le.onsuccess&&Le.onsuccess(I.type==="put"&&X[be]?I.values[be]:Be)}return{failures:ye,results:Re,numFailures:Me,lastResult:ue}}).catch(function(ue){return U.forEach(function(ye){return ye.onerror&&ye.onerror(ue)}),Promise.reject(ue)})});throw new Error("Keys missing")}}})}})}};function Ml(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,h=0;f<s.keys.length&&h<n.length;++f)ct(s.keys[f],n[h])===0&&(c.push(l?le(s.values[f]):s.values[f]),++h);return c.length===n.length?c:null}catch{return null}}var Rd={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=Ml(c.keys,c.trans._cache,c.cache==="clone"))?Ee.resolve(f):l.getMany(c).then(function(h){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?le(h):h},h}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function Dl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function jl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Md={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new ln(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,h){if(qe.subscr&&f!=="readonly")throw new C.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(qe.querier));return n.transaction(c,f,h)},table:function(c){function f(V){var R,V=V.query;return[R=V.index,new ln((R=(V=V.range).lower)!=null?R:n.MIN_KEY,(R=V.upper)!=null?R:n.MAX_KEY)]}var h=n.table(c),y=h.schema,S=y.primaryKey,D=y.indexes,G=S.extractKey,j=S.outbound,I=S.autoIncrement&&D.filter(function(L){return L.compound&&L.keyPath.includes(S.keyPath)}),q=a(a({},h),{mutate:function(L){function R(ze){return ze="idb://".concat(s,"/").concat(c,"/").concat(ze),ye[ze]||(ye[ze]=new ln)}var V,X,U,ue=L.trans,ye=L.mutatedParts||(L.mutatedParts={}),Re=R(""),Me=R(":dels"),be=L.type,Le=L.type==="deleteRange"?[L.range]:L.type==="delete"?[L.keys]:L.values.length<50?[Vi(S,L).filter(function(ze){return ze}),L.values]:[],Be=Le[0],Le=Le[1],Pe=L.trans._cache;return d(Be)?(Re.addKeys(Be),(be=be==="delete"||Be.length===Le.length?Ml(Be,Pe):null)||Me.addKeys(Be),(be||Le)&&(V=R,X=be,U=Le,y.indexes.forEach(function(ze){var ut=V(ze.name||"");function gt(et){return et!=null?ze.extractKey(et):null}function He(et){ze.multiEntry&&d(et)?et.forEach(function(Dt){return ut.addKey(Dt)}):ut.addKey(et)}(X||U).forEach(function(et,Bt){var Kn=X&&gt(X[Bt]),Bt=U&&gt(U[Bt]);ct(Kn,Bt)!==0&&(Kn!=null&&He(Kn),Bt!=null)&&He(Bt)})}))):Be?(Le={from:(Pe=Be.lower)!=null?Pe:n.MIN_KEY,to:(be=Be.upper)!=null?be:n.MAX_KEY},Me.add(Le),Re.add(Le)):(Re.add(l),Me.add(l),y.indexes.forEach(function(ze){return R(ze.name).add(l)})),h.mutate(L).then(function(ze){return!Be||L.type!=="add"&&L.type!=="put"||(Re.addKeys(ze.results),I&&I.forEach(function(ut){for(var gt=L.values.map(function(Kn){return ut.extractKey(Kn)}),He=ut.keyPath.findIndex(function(Kn){return Kn===S.keyPath}),et=0,Dt=ze.results.length;et<Dt;++et)gt[et][He]=ze.results[et];R(ut.name).addKeys(gt)})),ue.mutatedParts=Hs(ue.mutatedParts||{},ye),ze})}}),B={get:function(L){return[S,new ln(L.key)]},getMany:function(L){return[S,new ln().addKeys(L.keys)]},count:f,query:f,openCursor:f};return u(B).forEach(function(L){q[L]=function(R){var V=qe.subscr,X=!!V,U=Dl(qe,h)&&jl(L,R)?R.obsSet={}:V;if(X){var ue,V=function(Le){return Le="idb://".concat(s,"/").concat(c,"/").concat(Le),U[Le]||(U[Le]=new ln)},ye=V(""),Re=V(":dels"),X=B[L](R),Me=X[0],X=X[1];if((L==="query"&&Me.isPrimaryKey&&!R.values?Re:V(Me.name||"")).add(X),!Me.isPrimaryKey){if(L!=="count")return ue=L==="query"&&j&&R.values&&h.query(a(a({},R),{values:!1})),h[L].apply(this,arguments).then(function(Le){if(L==="query"){if(j&&R.values)return ue.then(function(gt){return gt=gt.result,ye.addKeys(gt),Le});var Pe=R.values?Le.result.map(G):Le.result;(R.values?ye:Re).addKeys(Pe)}else{var ze,ut;if(L==="openCursor")return ut=R.values,(ze=Le)&&Object.create(ze,{key:{get:function(){return Re.addKey(ze.primaryKey),ze.key}},primaryKey:{get:function(){var gt=ze.primaryKey;return Re.addKey(gt),gt}},value:{get:function(){return ut&&ye.addKey(ze.primaryKey),ze.value}}})}return Le});Re.add(l)}}return h[L].apply(this,arguments)}}),q}})}};function Ll(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,h){return!(h in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,h){return!(h in l.failures)})),c)}function Yi(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<ct(l,c.lower):0<=ct(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?ct(l,c.upper)<0:ct(l,c.upper)<=0));var l,c}function Nl(n,s,l,c,f,h){var y,S,D,G,j,I;return!l||l.length===0||(y=s.query.index,S=y.multiEntry,D=s.query.range,G=c.schema.primaryKey.extractKey,j=y.extractKey,I=(y.lowLevelIndex||y).extractKey,(c=l.reduce(function(q,B){var L=q,R=[];if(B.type==="add"||B.type==="put")for(var V=new ln,X=B.values.length-1;0<=X;--X){var U,ue=B.values[X],ye=G(ue);!V.hasKey(ye)&&(U=j(ue),S&&d(U)?U.some(function(Le){return Yi(Le,D)}):Yi(U,D))&&(V.addKey(ye),R.push(ue))}switch(B.type){case"add":var Re=new ln().addKeys(s.values?q.map(function(Pe){return G(Pe)}):q),L=q.concat(s.values?R.filter(function(Pe){return Pe=G(Pe),!Re.hasKey(Pe)&&(Re.addKey(Pe),!0)}):R.map(function(Pe){return G(Pe)}).filter(function(Pe){return!Re.hasKey(Pe)&&(Re.addKey(Pe),!0)}));break;case"put":var Me=new ln().addKeys(B.values.map(function(Pe){return G(Pe)}));L=q.filter(function(Pe){return!Me.hasKey(s.values?G(Pe):Pe)}).concat(s.values?R:R.map(function(Pe){return G(Pe)}));break;case"delete":var be=new ln().addKeys(B.keys);L=q.filter(function(Pe){return!be.hasKey(s.values?G(Pe):Pe)});break;case"deleteRange":var Be=B.range;L=q.filter(function(Pe){return!Yi(G(Pe),Be)})}return L},n))===n)?n:(c.sort(function(q,B){return ct(I(q),I(B))||ct(G(q),G(B))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),h?Object.freeze(c):c)}function ql(n,s){return ct(n.lower,s.lower)===0&&ct(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function Dd(n,s){return((l,c,f,h)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=ct(l,c))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,h)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=ct(l,c))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function jd(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=s,setTimeout(function(){f.subscribers.size===0&&se(h,f)},3e3))})}var Ld={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var h,y,S=n.transaction(l,c,f);return c==="readwrite"&&(f=(h=new AbortController).signal,S.addEventListener("abort",(y=function(D){return function(){if(h.abort(),c==="readwrite"){for(var G=new Set,j=0,I=l;j<I.length;j++){var q=I[j],B=ra["idb://".concat(s,"/").concat(q)];if(B){var L=n.table(q),R=B.optimisticOps.filter(function(ze){return ze.trans===S});if(S._explicit&&D&&S.mutatedParts)for(var V=0,X=Object.values(B.queries.query);V<X.length;V++)for(var U=0,ue=(Me=X[V]).slice();U<ue.length;U++)Fi((be=ue[U]).obsSet,S.mutatedParts)&&(se(Me,be),be.subscribers.forEach(function(ze){return G.add(ze)}));else if(0<R.length){B.optimisticOps=B.optimisticOps.filter(function(ze){return ze.trans!==S});for(var ye=0,Re=Object.values(B.queries.query);ye<Re.length;ye++)for(var Me,be,Be,Le=0,Pe=(Me=Re[ye]).slice();Le<Pe.length;Le++)(be=Pe[Le]).res!=null&&S.mutatedParts&&(D&&!be.dirty?(Be=Object.isFrozen(be.res),Be=Nl(be.res,be.req,R,L,be,Be),be.dirty?(se(Me,be),be.subscribers.forEach(function(ze){return G.add(ze)})):Be!==be.res&&(be.res=Be,be.promise=Ee.resolve({result:Be}))):(be.dirty&&se(Me,be),be.subscribers.forEach(function(ze){return G.add(ze)})))}}}G.forEach(function(ze){return ze()})}}})(!1),{signal:f}),S.addEventListener("error",y(!1),{signal:f}),S.addEventListener("complete",y(!0),{signal:f})),S},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(h){var y,S=qe.trans;return!f.outbound&&S.db._options.cache!=="disabled"&&!S.explicit&&S.idbtrans.mode==="readwrite"&&(y=ra["idb://".concat(s,"/").concat(l)])?(S=c.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Vi(f,h).some(function(D){return D==null}))?(y.optimisticOps.push(h),h.mutatedParts&&Vs(h.mutatedParts),S.then(function(D){0<D.numFailures&&(se(y.optimisticOps,h),(D=Ll(0,h,D))&&y.optimisticOps.push(D),h.mutatedParts)&&Vs(h.mutatedParts)}),S.catch(function(){se(y.optimisticOps,h),h.mutatedParts&&Vs(h.mutatedParts)})):S.then(function(D){var G=Ll(0,a(a({},h),{values:h.values.map(function(j,I){var q;return D.failures[I]?j:(F(q=(q=f.keyPath)!=null&&q.includes(".")?le(j):a({},j),f.keyPath,D.results[I]),q)})}),D);y.optimisticOps.push(G),queueMicrotask(function(){return h.mutatedParts&&Vs(h.mutatedParts)})}),S):c.mutate(h)},query:function(h){var y,S,D,G,j,I,q;return Dl(qe,c)&&jl("query",h)?(y=((D=qe.trans)==null?void 0:D.db._options.cache)==="immutable",S=(D=qe).requery,D=D.signal,I=((B,L,R,V)=>{var X=ra["idb://".concat(B,"/").concat(L)];if(!X)return[];if(!(B=X.queries[R]))return[null,!1,X,null];var U=B[(V.query?V.query.index.name:null)||""];if(!U)return[null,!1,X,null];switch(R){case"query":var ue=U.find(function(ye){return ye.req.limit===V.limit&&ye.req.values===V.values&&ql(ye.req.query.range,V.query.range)});return ue?[ue,!0,X,U]:[U.find(function(ye){return("limit"in ye.req?ye.req.limit:1/0)>=V.limit&&(!V.values||ye.req.values)&&Dd(ye.req.query.range,V.query.range)}),!1,X,U];case"count":return ue=U.find(function(ye){return ql(ye.req.query.range,V.query.range)}),[ue,!!ue,X,U]}})(s,l,"query",h),q=I[0],G=I[2],j=I[3],q&&I[1]?q.obsSet=h.obsSet:(I=c.query(h).then(function(B){var L=B.result;if(q&&(q.res=L),y){for(var R=0,V=L.length;R<V;++R)Object.freeze(L[R]);Object.freeze(L)}else B.result=le(L);return B}).catch(function(B){return j&&q&&se(j,q),Promise.reject(B)}),q={obsSet:h.obsSet,promise:I,subscribers:new Set,type:"query",req:h,dirty:!1},j?j.push(q):(j=[q],(G=G||(ra["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=j)),jd(q,j,S,D),q.promise.then(function(B){return{result:Nl(B.result,h,G==null?void 0:G.optimisticOps,c,q,y)}})):c.query(h)}})}})}};function Qs(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}zt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new C.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new C.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(Td),l.stores({}),this._state.autoSchema=!1),l},zt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||qe.letThrough||this._vip)?n():new Ee(function(l,c){if(s._state.openComplete)return c(new C.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new C.DatabaseClosed);s.open().catch(Ae)}s._state.dbReadyPromise.then(l,c)}).then(n)},zt.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,h=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return h.push({stack:s,create:l,level:c??10,name:f}),h.sort(function(y,S){return y.level-S.level}),this},zt.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},zt.prototype.open=function(){var n=this;return Fe(Rt,function(){return Pd(n)})},zt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=Mt.indexOf(this);if(0<=s&&Mt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ee(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ee(function(l,c){n.cancelOpen=c}))},zt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new C.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new C.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},zt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ee(function(f,h){function y(){s.close(n);var S=s._deps.indexedDB.deleteDatabase(s.name);S.onsuccess=ht(function(){var D,G,j;D=s._deps,G=s.name,qi(j=D.indexedDB)||G===sn||Ni(j,D.IDBKeyRange).delete(G).catch(Ae),f()}),S.onerror=fr(h),S.onblocked=s._fireOnBlocked}if(l)throw new C.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(y):y()})},zt.prototype.backendDB=function(){return this.idbdb},zt.prototype.isOpen=function(){return this.idbdb!==null},zt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},zt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},zt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(zt.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),zt.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new C.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return c=h.pop(),[s,Ie(h),c]}).apply(this,arguments);return this._transaction.apply(this,n)},zt.prototype._transaction=function(n,s,l){var c,f,h=this,y=qe.trans,S=(y&&y.db===this&&n.indexOf("!")===-1||(y=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(G){if(G=G instanceof h.Table?G.name:G,typeof G!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return G}),n=="r"||n===on)c=on;else{if(n!="rw"&&n!=dr)throw new C.InvalidArgument("Invalid transaction mode: "+n);c=dr}if(y){if(y.mode===on&&c===dr){if(!S)throw new C.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");y=null}y&&f.forEach(function(G){if(y&&y.storeNames.indexOf(G)===-1){if(!S)throw new C.SubTransaction("Table "+G+" not included in parent transaction.");y=null}}),S&&y&&!y.active&&(y=null)}}catch(G){return y?y._promise(null,function(j,I){I(G)}):ge(G)}var D=(function G(j,I,q,B,L){return Ee.resolve().then(function(){var U=qe.transless||qe,R=j._createTransaction(I,q,j._dbSchema,B),U=(R.explicit=!0,{trans:R,transless:U});if(B)R.idbtrans=B.idbtrans;else try{R.create(),R.idbtrans._explicit=!0,j._state.PR1398_maxLoop=3}catch(ue){return ue.name===Ke.InvalidState&&j.isOpen()&&0<--j._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),j.close({disableAutoOpen:!1}),j.open().then(function(){return G(j,I,q,null,L)})):ge(ue)}var V,X=te(L),U=(X&&Vt(),Ee.follow(function(){var ue;(V=L.call(R,R))&&(X?(ue=Rn.bind(null,null),V.then(ue,ue)):typeof V.next=="function"&&typeof V.throw=="function"&&(V=Wi(V)))},U));return(V&&typeof V.then=="function"?Ee.resolve(V).then(function(ue){return R.active?ue:ge(new C.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):U.then(function(){return V})).then(function(ue){return B&&R._resolve(),R._completion.then(function(){return ue})}).catch(function(ue){return R._reject(ue),ge(ue)})})}).bind(null,this,c,f,y,l);return y?y._promise(c,D,"lock"):qe.trans?Fe(qe.transless,function(){return h._whenReady(D)}):this._whenReady(D)},zt.prototype.table=function(n){if(w(this._allTables,n))return this._allTables[n];throw new C.InvalidTable("Table ".concat(n," does not exist"))};var Er=zt;function zt(n,s){var l,c,f,h,y,S=this,D=(this._middlewares={},this.verno=0,zt.dependencies),D=(this._options=s=a({addons:zt.addons,autoOpen:!0,indexedDB:D.indexedDB,IDBKeyRange:D.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),G=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ae,dbReadyPromise:null,cancelOpen:Ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),j=(G.dbReadyPromise=new Ee(function(I){G.dbReadyResolve=I}),G.openCanceller=new Ee(function(I,q){G.cancelOpen=q}),this._state=G,this.name=n,this.on=$a(this,"populate","blocked","versionchange","close",{ready:[Ne,Ae]}),this.once=function(I,q){var B=function(){for(var L=[],R=0;R<arguments.length;R++)L[R]=arguments[R];S.on(I).unsubscribe(B),q.apply(S,L)};return S.on(I,B)},this.on.ready.subscribe=Q(this.on.ready.subscribe,function(I){return function(q,B){zt.vip(function(){var L,R=S._state;R.openComplete?(R.dbOpenError||Ee.resolve().then(q),B&&I(q)):R.onReadyBeingFired?(R.onReadyBeingFired.push(q),B&&I(q)):(I(q),L=S,B||I(function V(){L.on.ready.unsubscribe(q),L.on.ready.unsubscribe(V)}))})}}),this.Collection=(l=this,es(_d.prototype,function(V,R){this.db=l;var B=ta,L=null;if(R)try{B=R()}catch(U){L=U}var R=V._ctx,V=R.table,X=V.hook.reading.fire;this._ctx={table:V,index:R.index,isPrimKey:!R.index||V.schema.primKey.keyPath&&R.index===V.schema.primKey.name,range:B,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:L,or:R.or,valueMapper:X!==Oe?X:null}})),this.Table=(c=this,es(yl.prototype,function(I,q,B){this.db=c,this._tx=B,this.name=I,this.schema=q,this.hook=c._allTables[I]?c._allTables[I].hook:$a(null,{creating:[Qe,Ae],reading:[We,Oe],updating:[wt,Ae],deleting:[ft,Ae]})})),this.Transaction=(f=this,es(wd.prototype,function(I,q,B,L,R){var V=this;I!=="readonly"&&q.forEach(function(X){X=(X=B[X])==null?void 0:X.yProps,X&&(q=q.concat(X.map(function(U){return U.updatesTable})))}),this.db=f,this.mode=I,this.storeNames=q,this.schema=B,this.chromeTransactionDurability=L,this.idbtrans=null,this.on=$a(this,"complete","error","abort"),this.parent=R||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee(function(X,U){V._resolve=X,V._reject=U}),this._completion.then(function(){V.active=!1,V.on.complete.fire()},function(X){var U=V.active;return V.active=!1,V.on.error.fire(X),V.parent?V.parent._reject(X):U&&V.idbtrans&&V.idbtrans.abort(),ge(X)})})),this.Version=(h=this,es(Cd.prototype,function(I){this.db=h,this._cfg={version:I,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,es(Sl.prototype,function(I,q,B){if(this.db=y,this._ctx={table:I,index:q===":id"?null:q,or:B},this._cmp=this._ascending=ct,this._descending=function(L,R){return ct(R,L)},this._max=function(L,R){return 0<ct(L,R)?L:R},this._min=function(L,R){return ct(L,R)<0?L:R},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new C.MissingAPI})),this.on("versionchange",function(I){0<I.newVersion?console.warn("Another connection wants to upgrade database '".concat(S.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(S.name,"'. Closing db now to resume the delete request.")),S.close({disableAutoOpen:!1})}),this.on("blocked",function(I){!I.newVersion||I.newVersion<I.oldVersion?console.warn("Dexie.delete('".concat(S.name,"') was blocked")):console.warn("Upgrade '".concat(S.name,"' blocked by other connection holding version ").concat(I.oldVersion/10))}),this._maxKey=rs(s.IDBKeyRange),this._createTransaction=function(I,q,B,L){return new S.Transaction(I,q,B,S._options.chromeTransactionDurability,L)},this._fireOnBlocked=function(I){S.on("blocked").fire(I),Mt.filter(function(q){return q.name===S.name&&q!==S&&!q._state.vcFired}).map(function(q){return q.on("versionchange").fire(I)})},this.use(Rd),this.use(Ld),this.use(Md),this.use(Id),this.use(Od),new Proxy(this,{get:function(I,q,B){var L;return q==="_vip"||(q==="table"?function(R){return Qs(S.table(R),j)}:(L=Reflect.get(I,q,B))instanceof yl?Qs(L,j):q==="tables"?L.map(function(R){return Qs(R,j)}):q==="_createTransaction"?function(){return Qs(L.apply(this,arguments),j)}:L)}}));this.vip=j,D.forEach(function(I){return I(S)})}var Xs,Da=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Nd=(Qi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Qi.prototype[Da]=function(){return this},Qi);function Qi(n){this._subscribe=n}try{Xs={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Xs={indexedDB:null,IDBKeyRange:null}}function Bl(n){var s,l=!1,c=new Nd(function(f){var h=te(n),y,S=!1,D={},G={},j={get closed(){return S},unsubscribe:function(){S||(S=!0,y&&y.abort(),I&&Br.storagemutated.unsubscribe(B))}},I=(f.start&&f.start(j),!1),q=function(){return we(L)},B=function(R){Hs(D,R),Fi(G,D)&&q()},L=function(){var R,V,X;!S&&Xs.indexedDB&&(D={},R={},y&&y.abort(),y=new AbortController,X=(U=>{var ue=Yt();try{h&&Vt();var ye=bn(n,U);return ye=h?ye.finally(Rn):ye}finally{ue&&Ht()}})(V={subscr:R,signal:y.signal,requery:q,querier:n,trans:null}),Promise.resolve(X).then(function(U){l=!0,s=U,S||V.signal.aborted||(D={},(ue=>{for(var ye in ue)if(w(ue,ye))return;return 1})(G=R)||I||(Br(ns,B),I=!0),we(function(){return!S&&f.next&&f.next(U)}))},function(U){l=!1,["DatabaseClosedError","AbortError"].includes(U==null?void 0:U.name)||S||we(function(){S||f.error&&f.error(U)})}))};return setTimeout(q,0),j});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var aa=Er;function Xi(n){var s=zr;try{zr=!0,Br.storagemutated.fire(n),Gi(n,!0)}finally{zr=s}}k(aa,a(a({},he),{delete:function(n){return new aa(n,{addons:[]}).delete()},exists:function(n){return new aa(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=aa.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(qi(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==sn})}):Ni(l,s).toCollection().primaryKeys()).then(n)}catch{return ge(new C.MissingAPI)}var s,l},defineClass:function(){return function(n){g(this,n)}},ignoreTransaction:function(n){return qe.trans?Fe(qe.transless,n):n()},vip:Bi,async:function(n){return function(){try{var s=Wi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ee.resolve(s)}catch(l){return ge(l)}}},spawn:function(n,s,l){try{var c=Wi(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ee.resolve(c)}catch(f){return ge(f)}},currentTransaction:{get:function(){return qe.trans||null}},waitFor:function(n,s){return n=Ee.resolve(typeof n=="function"?aa.ignoreTransaction(n):n).timeout(s||6e4),qe.trans?qe.trans.waitFor(n):n},Promise:Ee,debug:{get:function(){return Ge},set:function(n){At(n)}},derive:z,extend:g,props:k,override:Q,Events:$a,on:Br,liveQuery:Bl,extendObservabilitySet:Hs,getByKeyPath:Z,setByKeyPath:F,delByKeyPath:function(n,s){typeof s=="string"?F(n,s,void 0):"length"in s&&[].map.call(s,function(l){F(n,l,void 0)})},shallowClone:oe,deepClone:le,getObjectDiff:Hi,cmp:ct,asap:Y,minKey:-1/0,addons:[],connections:Mt,errnames:Ke,dependencies:Xs,cache:ra,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),aa.maxKey=rs(aa.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Br(ns,function(n){zr||(n=new CustomEvent(Ii,{detail:n}),zr=!0,dispatchEvent(n),zr=!1)}),addEventListener(Ii,function(n){n=n.detail,zr||Xi(n)}));var ja,zr=!1,zl=function(){};return typeof BroadcastChannel<"u"&&((zl=function(){(ja=new BroadcastChannel(Ii)).onmessage=function(n){return n.data&&Xi(n.data)}})(),typeof ja.unref=="function"&&ja.unref(),Br(ns,function(n){zr||ja.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Er.disableBfCache&&n.persisted){Ge&&console.debug("Dexie: handling persisted pagehide"),ja!=null&&ja.close();for(var s=0,l=Mt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Er.disableBfCache&&n.persisted&&(Ge&&console.debug("Dexie: handling persisted pageshow"),zl(),Xi({all:new ln(-1/0,[[]])}))})),Ee.rejectionMapper=function(n,s){return!n||n instanceof J||n instanceof TypeError||n instanceof SyntaxError||!n.name||!_e[n.name]?n:(s=new _e[n.name](s||n.message,n),"stack"in n&&O(s,"stack",{get:function(){return this.inner.stack}}),s)},At(Ge),a(Er,Object.freeze({__proto__:null,Dexie:Er,Entity:pl,PropModification:Ja,RangeSet:ln,add:function(n){return new Ja({add:n})},cmp:ct,default:Er,liveQuery:Bl,mergeRanges:is,rangesOverlap:Pl,remove:function(n){return new Ja({remove:n})},replacePrefix:function(n,s){return new Ja({replacePrefix:[n,s]})}}),{default:Er}),Er})})(ci)),ci.exports}var Iv=Pv();const Eo=Av(Iv),sc=Symbol.for("Dexie"),un=globalThis[sc]||(globalThis[sc]=Eo);if(Eo.semVer!==un.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Eo.semVer} and ${un.semVer}`);const{liveQuery:Xy,mergeRanges:Zy,rangesOverlap:Jy,RangeSet:$y,cmp:eb,Entity:tb,PropModification:nb,replacePrefix:rb,add:ab,remove:sb,DexieYProvider:ib}=un,Ue=new un("me-ai-store");Ue.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Ue.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Ue.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Ue.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function Du(t,e){return`${t}:${e}`}function Ao(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function io(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function Ov(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function Rv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function ju(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const Mv="https://gmail.googleapis.com/gmail/v1/users/me";class $o extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function Dv(t){return{Authorization:`Bearer ${t}`}}async function Ti(t,e){var a,i,o,u;const r=await fetch(`${Mv}${e}`,{headers:Dv(t)});if(!r.ok){const d=await r.json().catch(()=>({})),g=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,p=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new $o(g,r.status,p)}return r.json()}function Lu(t){return Ti(t,"/profile")}function Nu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),Ti(t,`/messages?${i}`)}function qu(t,e,r="full"){return Ti(t,`/messages/${e}?format=${r}`)}function jv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),Ti(t,`/history?${i}`)}function Kr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ws(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function Lv(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ws(e.body.data);const r=e.parts||[],a=fi(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return ws(a.body.data);const i=fi(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const g=ws(i.body.data);return qv(g)}return"(no body)"}function Nv(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ws(e.body.data);const r=e.parts||[],a=fi(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ws(a.body.data):null}function fi(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=fi(r.parts,e);if(a)return a}}return null}function qv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function el(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Bu(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function zu(t){return Bu(t).charAt(0).toUpperCase()}function Bv(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function zv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Fu(t,e){return`${Bv(t.date)}_${zv(t.subject)}.${e}`}function Ku(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function Fv(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Uu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function Kv(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Uu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function Uv(t=10){const e=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Gu).join(`

---

`)}async function Gv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Ue.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,g,p,b,w;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(g=o.from)!=null&&g.toLowerCase().includes(r)&&(u+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(u+=2),(b=o.snippet)!=null&&b.toLowerCase().includes(r)&&(u+=1),(w=o.body)!=null&&w.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>Gu(o)).join(`

---

`)}async function ic(){const t=await Ue.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=Ku(t);return{groups:e,order:r,total:t.length}}async function Wv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await Ue.items.where("sourceType").equals("gmail").filter(d=>{var g,p,b,w;return((g=d.subject)==null?void 0:g.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((b=d.to)==null?void 0:b.toLowerCase().includes(o))||((w=d.snippet)==null?void 0:w.toLowerCase().includes(o))}).toArray();return u.sort((d,g)=>(g.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await Ue.items.where("sourceType").equals("gmail").count();return{items:await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Uu(){const t=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).first(),e=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).last();return{oldest:t,newest:e}}function Gu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Rv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function Hv(){const t=await Fv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Vv(t){const e=[],r=await Kv();if(e.push(r),t){const a=await Gv(t,5);e.push("","## Relevant Emails",a)}else{const a=await Uv(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Yv="modulepreload",Qv=function(t){return"/me-ai/"+t},oc={},lc=function(e,r,a){let i=Promise.resolve();if(r&&r.length>0){let u=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=u(r.map(p=>{if(p=Qv(p),p in oc)return;oc[p]=!0;const b=p.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const k=document.createElement("link");if(k.rel=b?"stylesheet":Yv,b||(k.as="script"),k.crossOrigin="",k.href=p,g&&k.setAttribute("nonce",g),document.head.appendChild(k),b)return new Promise((x,O)=>{k.addEventListener("load",x),k.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return i.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})},Xv=20,Zv={maxTokens:512},ms=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Wu(t,{count:e=Xv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().limit(e).toArray();else{const Q=new Set(await Ue.emailClassifications.toCollection().primaryKeys());u=0,o=[],await Ue.items.where("[sourceType+date]").between(["gmail",un.minKey],["gmail",un.maxKey]).reverse().until(()=>o.length>=e).each(M=>{Q.has(M.id)?u++:o.push(M)})}if(o.length===0){const Q=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:Q,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const d=Date.now(),g=performance.now();let p=0,b=0,w=0,k=0;const x=[],O=t.modelId,z=Zo(O)||Jo(O);if(!z)throw new Error(`Unknown model: ${O}`);if(!z.recommendedForEmailProcessing&&o.length>0){const{MODELS:Q}=await lc(async()=>{const{MODELS:F}=await Promise.resolve().then(()=>yv);return{MODELS:F}},void 0),{OLLAMA_MODELS:M}=await lc(async()=>{const{OLLAMA_MODELS:F}=await Promise.resolve().then(()=>bv);return{OLLAMA_MODELS:F}},void 0),Y=[...Q.filter(F=>F.recommendedForEmailProcessing).map(F=>F.name),...M.filter(F=>F.recommendedForEmailProcessing).map(F=>F.displayName)],Z=z.displayName||z.name;console.warn(`â ï¸ Current model (${Z}) is not optimized for email processing. For best results with long emails, use: ${Y.join(", ")}. Some emails may fail due to memory limits.`)}for(let Q=0;Q<o.length&&!(i!=null&&i.aborted);Q++){const M=o[Q],Y=Vu(M),Z=[{role:"system",content:ms},{role:"user",content:Y}];a({phase:"scanning",current:Q+1,total:o.length,classified:p,errors:b,email:{subject:M.subject,from:M.from,date:M.date},prompt:{system:ms,user:Y},systemPromptLength:ms.length,live:null,lastResult:null,totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}});const F=performance.now();try{const{text:oe,tps:xe,numTokens:Ie,inputTokens:ve}=await t.generateFull(Z,{maxTokens:512,enableThinking:!1,temperature:0},ke=>{a({phase:"generating",current:Q+1,total:o.length,classified:p,errors:b,email:{subject:M.subject,from:M.from,date:M.date},live:{tps:ke.tps,numTokens:ke.numTokens},streamingText:ke.text||"",totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}})});w+=Ie,k+=ve;const ee=ep(oe),le=performance.now()-F;if(ee){await Ue.emailClassifications.put({emailId:M.id,action:ee.action,reason:ee.reason,summary:ee.summary,tags:ee.tags,subject:M.subject||"(no subject)",from:M.from||"",date:M.date,scannedAt:d,status:"pending"}),p++;const ke={success:!0,email:{subject:M.subject,from:M.from,date:M.date},classification:ee,rawResponse:oe,stats:{tps:xe,numTokens:Ie,inputTokens:ve,elapsed:le},promptSize:Y.length};x.push(ke),a({phase:"classified",current:Q+1,total:o.length,classified:p,errors:b,email:{subject:M.subject,from:M.from,date:M.date},result:ee,rawResponse:oe,emailStats:{tps:xe,numTokens:Ie,inputTokens:ve,elapsed:le},totals:{outputTokens:w,inputTokens:k,elapsed:performance.now()-g}})}}catch(oe){console.error(`Triage email ${Q+1} failed:`,oe),b++;const xe=oe.message||String(oe),Ie=xe.length>200?xe.slice(0,200)+"...":xe;x.push({success:!1,email:{subject:M.subject,from:M.from,date:M.date},error:Ie,promptSize:Y.length})}}const T=performance.now()-g,H=x.length>0?Math.round(x.reduce((Q,M)=>Q+M.promptSize,0)/x.length):0,fe=x.filter(Q=>{var M;return Q.success&&((M=Q.stats)==null?void 0:M.tps)}).length>0?Math.round(x.filter(Q=>Q.success).reduce((Q,M)=>{var Y;return Q+(((Y=M.stats)==null?void 0:Y.tps)||0)},0)/x.filter(Q=>{var M;return Q.success&&((M=Q.stats)==null?void 0:M.tps)}).length):null;return a({phase:"done",current:o.length,total:o.length,classified:p,errors:b,results:x,summary:{avgPromptSize:H,avgTps:fe,systemPromptSize:ms.length,processed:o.length,skipped:u,modelName:z.displayName||z.name,modelContextWindow:z.contextWindow,modelMaxEmailTokens:z.maxEmailTokens},totals:{outputTokens:w,inputTokens:k,elapsed:T}}),{scanned:o.length,classified:p,skipped:u,errors:b}}async function Jv(){const t=await Ue.emailClassifications.toArray();return Ku(t)}async function $v(){const t=await Ue.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function vi(t,e){await Ue.emailClassifications.update(t,{status:e})}async function cc(){await Ue.emailClassifications.clear()}async function tl(t){await Ue.emailClassifications.where("action").equals(t).delete()}async function Hu(t){await Ue.emailClassifications.delete(t)}async function Co(){const t=await Ue.items.where("sourceType").equals("gmail").count(),e=await Ue.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Vu(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function ep(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=tp(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let g=[];return Array.isArray(u.tags)&&(g=u.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:g}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function tp(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function Po(t){return`hsl(${ju(t)}, 55%, 55%)`}function np(t){return`hsl(${ju(t)}, 40%, 35%)`}var rp=N('<p class="warning svelte-1n2kfl0">WebGPU not available in this browser. Use Ollama or upgrade your browser.</p>'),ap=N('<div class="backend-selector svelte-1n2kfl0"><div class="backend-label svelte-1n2kfl0">AI Backend:</div> <div class="backend-options svelte-1n2kfl0"><button><span class="backend-icon svelte-1n2kfl0">ð·</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">WebGPU</div> <div class="backend-desc svelte-1n2kfl0">Browser, private, no server</div></div></button> <button><span class="backend-icon svelte-1n2kfl0">ð¦</span> <div class="backend-info svelte-1n2kfl0"><div class="backend-name svelte-1n2kfl0">Ollama</div> <div class="backend-desc svelte-1n2kfl0">Local server, larger models</div></div></button></div> <!></div>');function sp(t,e){Tt(e,!0);let r=je(e,"backend",15,"webgpu"),a=je(e,"isWebGPUAvailable",3,!0);var i=ap(),o=_(m(i),2),u=m(o);let d;u.__click=()=>r("webgpu");var g=_(u,2);let p;g.__click=()=>r("ollama");var b=_(o,2);{var w=k=>{var x=rp();E(k,x)};ne(b,k=>{!a()&&r()==="webgpu"&&k(w)})}$(()=>{d=jt(u,1,"backend-btn svelte-1n2kfl0",null,d,{active:r()==="webgpu"}),u.disabled=!a(),p=jt(g,1,"backend-btn svelte-1n2kfl0",null,p,{active:r()==="ollama"})}),E(t,i),Et()}Gt(["click"]);const ip=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function uc(...t){ip&&console.log("[debug]",...t)}function Fn(t){return uc(`[MOUNT] ${t}`),()=>uc(`[DESTROY] ${t}`)}var op=N("<option> </option>"),lp=N('<p class="model-description svelte-1p89qnn"> </p>'),cp=N('<span class="current-badge svelte-1p89qnn">Current</span>'),up=N('<span class="rec-badge rec-good svelte-1p89qnn">â</span>'),dp=N('<span class="rec-badge rec-ok svelte-1p89qnn">â ï¸</span>'),fp=N('<span class="rec-badge rec-bad svelte-1p89qnn">â</span>'),vp=N('<tr><td class="model-name svelte-1p89qnn"> <!></td><td class="context-col svelte-1p89qnn"><strong> </strong></td><td class="tokens-col svelte-1p89qnn"> </td><td class="rec-col svelte-1p89qnn"><!></td></tr>'),pp=N('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),hp=N('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!></div></div>'),mp=N('<p class="error svelte-1p89qnn"> </p>'),gp=N('<div class="container svelte-1p89qnn"><div class="content-wrapper svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <details class="model-details svelte-1p89qnn"><summary class="model-details-summary svelte-1p89qnn">Model Capabilities</summary> <div class="model-table-wrapper svelte-1p89qnn"><table class="model-table svelte-1p89qnn"><thead class="svelte-1p89qnn"><tr><th class="svelte-1p89qnn">Model</th><th class="svelte-1p89qnn">Context</th><th class="svelte-1p89qnn">Email Limit</th><th class="svelte-1p89qnn">Status</th></tr></thead><tbody class="svelte-1p89qnn"></tbody></table></div> <p class="model-table-note svelte-1p89qnn"><strong class="svelte-1p89qnn">Context</strong> = max input capacity. <strong class="svelte-1p89qnn">Email Limit</strong> = WebGPU safe limit. â = Recommended, â ï¸ = Limited, â = May fail.</p></details> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div></div>');function _p(t,e){Tt(e,!0);let r=je(e,"selectedModel",15),a=je(e,"gpuInfo",3,null),i=je(e,"error",3,null);an(()=>Fn("ModelSelector"));var o=gp(),u=m(o),d=_(m(u),2),g=_(m(d),2);Ut(g,21,()=>yr,dn,(M,Y)=>{var Z=op(),F=m(Z),oe={};$(()=>{K(F,`${v(Y).name??""} â ${v(Y).size??""}`),oe!==(oe=v(Y).id)&&(Z.value=(Z.__value=v(Y).id)??"")}),E(M,Z)});var p=_(g,2);{var b=M=>{const Y=pt(()=>yr.find(xe=>xe.id===r()));var Z=wr(),F=Xe(Z);{var oe=xe=>{var Ie=lp(),ve=m(Ie);$(()=>K(ve,v(Y).description)),E(xe,Ie)};ne(F,xe=>{v(Y)&&xe(oe)})}E(M,Z)};ne(p,M=>{r()&&M(b)})}var w=_(d,2),k=_(m(w),2),x=m(k),O=_(m(x));Ut(O,21,()=>yr,dn,(M,Y)=>{var Z=vp();let F;var oe=m(Z),xe=m(oe),Ie=_(xe);{var ve=he=>{var W=cp();E(he,W)};ne(Ie,he=>{v(Y).id===r()&&he(ve)})}var ee=_(oe),le=m(ee),ke=m(le),re=_(ee),me=m(re),Te=_(re),se=m(Te);{var pe=he=>{var W=up();E(he,W)},ae=he=>{var W=dp();E(he,W)},te=he=>{var W=fp();E(he,W)};ne(se,he=>{v(Y).recommendedForEmailProcessing?he(pe):v(Y).maxEmailTokens>=6e3?he(ae,1):he(te,!1)})}$((he,W)=>{F=jt(Z,1,"svelte-1p89qnn",null,F,{selected:v(Y).id===r()}),K(xe,`${v(Y).name??""} `),K(ke,`${he??""}k`),K(me,`~${W??""}k`)},[()=>(v(Y).contextWindow/1024).toFixed(0),()=>(v(Y).maxEmailTokens/1e3).toFixed(0)]),E(M,Z)});var z=_(w,2);{var T=M=>{var Y=hp(),Z=_(m(Y),2),F=m(Z),oe=_(m(F)),xe=m(oe),Ie=_(F,2),ve=_(m(Ie)),ee=m(ve),le=_(Ie,2);{var ke=re=>{var me=pp(),Te=_(m(me)),se=m(Te);$(pe=>K(se,pe),[()=>Ao(a().limits.maxBufferSize)]),E(re,me)};ne(le,re=>{var me;(me=a().limits)!=null&&me.maxBufferSize&&re(ke)})}$(()=>{K(xe,a().vendor),K(ee,a().architecture)}),E(M,Y)};ne(z,M=>{a()&&M(T)})}var H=_(z,2);{var fe=M=>{var Y=mp(),Z=m(Y);$(()=>K(Z,i())),E(M,Y)};ne(H,M=>{i()&&M(fe)})}var Q=_(H,2);Q.__click=function(...M){var Y;(Y=e.onload)==null||Y.apply(this,M)},$(()=>Q.disabled=i()),xi(g,r),E(t,o),Et()}Gt(["click"]);var yp=N('<span class="status-dot connected svelte-1bvvk8o"></span> <span> </span>',1),bp=N('<span class="status-dot disconnected svelte-1bvvk8o"></span> <span> </span>',1),wp=N("<div><!></div>"),kp=N("<option> <!></option>"),xp=N("<option> <!></option>"),Sp=N('<span class="sep svelte-1bvvk8o">Â·</span> <span> </span>',1),Tp=N('<div class="install-hint svelte-1bvvk8o"><strong>Not installed.</strong> Run: <code class="svelte-1bvvk8o"> </code></div>'),Ep=N('<div class="install-hint installed svelte-1bvvk8o">â Model installed and ready</div>'),Ap=N('<div class="model-info svelte-1bvvk8o"><p class="model-desc svelte-1bvvk8o"> </p> <div class="model-meta svelte-1bvvk8o"><span> </span> <span class="sep svelte-1bvvk8o">Â·</span> <span> </span> <!></div> <!></div>'),Cp=N('<span class="current-badge svelte-1bvvk8o">Current</span>'),Pp=N('<span class="installed-badge svelte-1bvvk8o">â</span>'),Ip=N('<span class="rec-badge svelte-1bvvk8o">â</span>'),Op=N('<tr><td class="model-name svelte-1bvvk8o"> <!> <!></td><td class="context-col svelte-1bvvk8o"><strong> </strong></td><td class="params-col svelte-1bvvk8o"> </td><td class="tags-col svelte-1bvvk8o"><!> </td></tr>'),Rp=N('<p class="error svelte-1bvvk8o"> </p>'),Mp=N('<div class="ollama-settings svelte-1bvvk8o"><div class="connection-section svelte-1bvvk8o"><label for="ollama-url" class="svelte-1bvvk8o">Ollama Server URL:</label> <div class="url-input-group svelte-1bvvk8o"><input id="ollama-url" type="text" placeholder="http://localhost:11434" class="svelte-1bvvk8o"/> <button class="btn-test svelte-1bvvk8o"> </button></div> <!></div> <div class="model-section svelte-1bvvk8o"><label for="ollama-model" class="svelte-1bvvk8o">Choose Model:</label> <select id="ollama-model" class="svelte-1bvvk8o"><optgroup label="Recommended (install via: ollama pull MODEL_NAME)"></optgroup><optgroup label="Other Models"></optgroup></select> <!></div> <details class="model-details svelte-1bvvk8o"><summary class="model-details-summary svelte-1bvvk8o">Ollama Model Capabilities</summary> <div class="model-table-wrapper svelte-1bvvk8o"><table class="model-table svelte-1bvvk8o"><thead class="svelte-1bvvk8o"><tr><th class="svelte-1bvvk8o">Model</th><th class="svelte-1bvvk8o">Context Window</th><th class="svelte-1bvvk8o">Params</th><th class="svelte-1bvvk8o">Strengths</th></tr></thead><tbody class="svelte-1bvvk8o"></tbody></table></div> <p class="model-table-note svelte-1bvvk8o">â = installed on your Ollama server. To install: <code class="svelte-1bvvk8o">ollama pull MODEL_NAME</code></p></details> <!> <button class="btn primary svelte-1bvvk8o">Load Model</button></div>');function Dp(t,e){Tt(e,!0);let r=je(e,"selectedModel",15),a=je(e,"error",15),i=De(Kt(Ds())),o=De(!1),u=De(null),d=De(Kt([])),g=De(!1);Sa(()=>{p()});async function p(){A(o,!0),A(u,null);const ae=await To(v(i));A(u,ae,!0),A(o,!1),ae.connected&&b()}async function b(){A(g,!0);try{const ae=await kv(v(i));A(d,ae.map(te=>te.name),!0)}catch(ae){console.error("Failed to load Ollama models:",ae),A(d,[],!0)}A(g,!1)}function w(){wv(v(i)),p()}function k(){if(!r()){a("Please select a model");return}e.onload()}function x(ae){return v(d).length?v(d).includes(ae):!1}const O=Ru();var z=Mp(),T=m(z),H=_(m(T),2),fe=m(H);fe.__change=w;var Q=_(fe,2);Q.__click=p;var M=m(Q),Y=_(H,2);{var Z=ae=>{var te=wp();let he;var W=m(te);{var J=ce=>{var Se=yp(),Ke=_(Xe(Se),2),Ce=m(Ke);$(()=>K(Ce,`Connected â¢ v${v(u).version??""}`)),E(ce,Se)},de=ce=>{var Se=bp(),Ke=_(Xe(Se),2),Ce=m(Ke);$(()=>K(Ce,`Disconnected: ${v(u).error??""}`)),E(ce,Se)};ne(W,ce=>{v(u).connected?ce(J):ce(de,!1)})}$(()=>he=jt(te,1,"connection-status svelte-1bvvk8o",null,he,{connected:v(u).connected})),E(ae,te)};ne(Y,ae=>{v(u)&&ae(Z)})}var F=_(T,2),oe=_(m(F),2),xe=m(oe);Ut(xe,21,()=>O,dn,(ae,te)=>{var he=kp(),W=m(he),J=_(W);{var de=Ke=>{var Ce=Or("â");E(Ke,Ce)},ce=pt(()=>x(v(te).name));ne(J,Ke=>{v(ce)&&Ke(de)})}var Se={};$(Ke=>{K(W,`${v(te).displayName??""} (${v(te).params??""}) - ${Ke??""}k context `),Se!==(Se=v(te).name)&&(he.value=(he.__value=v(te).name)??"")},[()=>(v(te).contextWindow/1024).toFixed(0)]),E(ae,he)});var Ie=_(xe);Ut(Ie,21,()=>ir.filter(ae=>!ae.recommended),dn,(ae,te)=>{var he=xp(),W=m(he),J=_(W);{var de=Ke=>{var Ce=Or("â");E(Ke,Ce)},ce=pt(()=>x(v(te).name));ne(J,Ke=>{v(ce)&&Ke(de)})}var Se={};$(Ke=>{K(W,`${v(te).displayName??""} (${v(te).params??""}) - ${Ke??""}k context `),Se!==(Se=v(te).name)&&(he.value=(he.__value=v(te).name)??"")},[()=>(v(te).contextWindow/1024).toFixed(0)]),E(ae,he)});var ve=_(oe,2);{var ee=ae=>{const te=pt(()=>ir.find(de=>de.name===r()));var he=wr(),W=Xe(he);{var J=de=>{var ce=Ap(),Se=m(ce),Ke=m(Se),Ce=_(Se,2),C=m(Ce),_e=m(C),Ae=_(C,4),Oe=m(Ae),We=_(Ae,2);{var Ze=Ne=>{var Ge=Sp(),At=_(Xe(Ge),2),xt=m(At);$(Lt=>K(xt,Lt),[()=>v(te).tags.join(", ")]),E(Ne,Ge)};ne(We,Ne=>{var Ge;(Ge=v(te).tags)!=null&&Ge.length&&Ne(Ze)})}var Qe=_(Ce,2);{var ft=Ne=>{var Ge=Tp(),At=_(m(Ge),2),xt=m(At);$(()=>K(xt,`ollama pull ${r()??""}`)),E(Ne,Ge)},wt=pt(()=>!x(r())),at=Ne=>{var Ge=Ep();E(Ne,Ge)};ne(Qe,Ne=>{v(wt)?Ne(ft):Ne(at,!1)})}$(Ne=>{K(Ke,v(te).description),K(_e,`${Ne??""}k context`),K(Oe,`${v(te).params??""} params`)},[()=>(v(te).contextWindow/1024).toFixed(0)]),E(de,ce)};ne(W,de=>{v(te)&&de(J)})}E(ae,he)};ne(ve,ae=>{r()&&ae(ee)})}var le=_(F,2),ke=_(m(le),2),re=m(ke),me=_(m(re));Ut(me,21,()=>ir,dn,(ae,te)=>{var he=Op();let W;var J=m(he),de=m(J),ce=_(de);{var Se=Ne=>{var Ge=Cp();E(Ne,Ge)};ne(ce,Ne=>{v(te).name===r()&&Ne(Se)})}var Ke=_(ce,2);{var Ce=Ne=>{var Ge=Pp();E(Ne,Ge)},C=pt(()=>x(v(te).name));ne(Ke,Ne=>{v(C)&&Ne(Ce)})}var _e=_(J),Ae=m(_e),Oe=m(Ae),We=_(_e),Ze=m(We),Qe=_(We),ft=m(Qe);{var wt=Ne=>{var Ge=Ip();E(Ne,Ge)};ne(ft,Ne=>{v(te).recommended&&Ne(wt)})}var at=_(ft);$((Ne,Ge,At)=>{W=jt(he,1,"svelte-1bvvk8o",null,W,Ne),K(de,`${v(te).displayName??""} `),K(Oe,`${Ge??""}k`),K(Ze,v(te).params),K(at,` ${At??""}`)},[()=>({selected:v(te).name===r(),installed:x(v(te).name)}),()=>(v(te).contextWindow/1024).toFixed(0),()=>v(te).tags.slice(0,2).join(", ")]),E(ae,he)});var Te=_(le,2);{var se=ae=>{var te=Rp(),he=m(te);$(()=>K(he,a())),E(ae,te)};ne(Te,ae=>{a()&&ae(se)})}var pe=_(Te,2);pe.__click=k,$(()=>{var ae;Q.disabled=v(o),K(M,v(o)?"Testing...":"Test"),pe.disabled=!((ae=v(u))!=null&&ae.connected)||a()}),Si(fe,()=>v(i),ae=>A(i,ae)),xi(oe,r),E(t,z),Et()}Gt(["change","click"]);var jp=N('<span class="progress-percent svelte-r5fnze"> </span>'),Lp=N('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Np=N('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),qp=N('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Bp=N('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),zp=N('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Fp=N('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Kp(t,e){Tt(e,!0);let r=je(e,"message",3,""),a=je(e,"items",19,()=>[]);an(()=>Fn("LoadingProgress"));var i=Fp(),o=m(i),u=m(o),d=_(o,2);Ut(d,17,a,dn,(g,p)=>{const b=pt(()=>v(p).total?Ov(v(p).loaded||0,v(p).total):null);var w=zp(),k=m(w),x=m(k),O=m(x),z=_(x,2);{var T=M=>{var Y=jp(),Z=m(Y);$(F=>K(Z,`${F??""}%`),[()=>v(b).toFixed(1)]),E(M,Y)};ne(z,M=>{v(b)!==null&&M(T)})}var H=_(k,2);{var fe=M=>{var Y=Lp(),Z=Xe(Y),F=m(Z),oe=_(Z,2),xe=m(oe),Ie=m(xe),ve=_(xe,4),ee=m(ve),le=_(ve,2),ke=m(le);$((re,me,Te,se,pe)=>{En(F,`width: ${re??""}%`),K(Ie,me),K(ee,Te),K(ke,`(${se??""} / ${pe??""} B)`)},[()=>Math.max(v(p).progress??0,.5).toFixed(1),()=>io(v(p).loaded||0),()=>io(v(p).total),()=>(v(p).loaded||0).toLocaleString(),()=>v(p).total.toLocaleString()]),E(M,Y)},Q=M=>{var Y=Bp(),Z=_(Xe(Y),2),F=m(Z);{var oe=Ie=>{var ve=Np(),ee=Xe(ve),le=m(ee),ke=_(ee,2),re=m(ke);$((me,Te)=>{K(le,me),K(re,`(${Te??""} B)`)},[()=>io(v(p).loaded),()=>v(p).loaded.toLocaleString()]),E(Ie,ve)},xe=Ie=>{var ve=qp();E(Ie,ve)};ne(F,Ie=>{v(p).loaded?Ie(oe):Ie(xe,!1)})}E(M,Y)};ne(H,M=>{v(p).total?M(fe):M(Q,!1)})}$(()=>{Iu(x,"title",v(p).file),K(O,v(p).file)}),E(g,w)}),$(()=>K(u,r())),E(t,i),Et()}var Up=N('<span class="thinking-tokens svelte-11gjw00"> </span>'),Gp=N('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Wp=N('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Hp=N('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Vp=N('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Yp=N('<span class="cursor svelte-11gjw00">|</span>'),Qp=N(" <!>",1),Xp=N('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Zp=N('<div class="content svelte-11gjw00"> </div>'),Jp=N('<div><div class="role svelte-11gjw00"> </div> <!></div>');function $p(t,e){Tt(e,!0);let r=je(e,"isLast",3,!1),a=je(e,"isRunning",3,!1),i=je(e,"generationPhase",3,null),o=je(e,"numTokens",3,null);an(()=>Fn(`MessageBubble[${e.msg.role}]`));var u=Jp(),d=m(u),g=m(d),p=_(d,2);{var b=k=>{var x=Xp(),O=Xe(x);{var z=F=>{var oe=Gp(),xe=_(m(oe),4);{var Ie=ve=>{var ee=Up(),le=m(ee);$(()=>K(le,`${o()??""} tokens`)),E(ve,ee)};ne(xe,ve=>{o()&&ve(Ie)})}E(F,oe)},T=F=>{var oe=Wp();E(F,oe)};ne(O,F=>{a()&&r()&&i()==="thinking"?F(z):a()&&r()&&i()==="preparing"&&F(T,1)})}var H=_(O,2);{var fe=F=>{var oe=Hp(),xe=m(oe),Ie=_(m(xe),2),ve=m(Ie),ee=_(xe,2),le=m(ee);$(ke=>{K(ve,`${ke??""} words`),K(le,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),E(F,oe)};ne(H,F=>{e.msg.thinking&&F(fe)})}var Q=_(H,2),M=m(Q);{var Y=F=>{var oe=Vp();E(F,oe)},Z=F=>{var oe=Qp(),xe=Xe(oe,!0),Ie=_(xe);{var ve=ee=>{var le=Yp();E(ee,le)};ne(Ie,ee=>{a()&&r()&&ee(ve)})}$(()=>K(xe,e.msg.content)),E(F,oe)};ne(M,F=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?F(Y):F(Z,!1)})}E(k,x)},w=k=>{var x=Zp(),O=m(x);$(()=>K(O,e.msg.content)),E(k,x)};ne(p,k=>{e.msg.role==="assistant"?k(b):k(w,!1)})}$(()=>{jt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),K(g,e.msg.role==="user"?"You":"AI")}),E(t,u),Et()}var eh=N('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),th=N('<span class="edate svelte-mt5nvh"> </span>'),nh=N('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),rh=N('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),ah=N('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),sh=N('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),ih=N('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function oh(t,e){Tt(e,!0);let r=je(e,"pendingData",3,null),a=De(null),i=De(null);function o(x){A(a,v(a)===x?null:x,!0),A(i,null)}function u(x){return x.split("_").map(O=>O.charAt(0)+O.slice(1).toLowerCase()).join(" ")}function d(x){if(!x)return"";try{return new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function g(x){if(!x)return"";const O=x.replace(/<.*>/,"").trim();return O.length>24?O.slice(0,22)+"â¦":O}var p={toggleGroup:o},b=wr(),w=Xe(b);{var k=x=>{var O=ih(),z=m(O),T=m(z),H=_(z,2);Ut(H,20,()=>r().order,M=>M,(M,Y)=>{const Z=pt(()=>r().groups[Y]),F=pt(()=>Po(Y)),oe=pt(()=>v(a)===Y);var xe=eh();let Ie;xe.__click=()=>o(Y);let ve;var ee=m(xe);let le;var ke=_(ee),re=_(ke),me=m(re);$(Te=>{Ie=jt(xe,1,"chip svelte-mt5nvh",null,Ie,{active:v(oe)}),ve=En(xe,"",ve,{"--c":v(F)}),le=En(ee,"",le,{background:v(F)}),K(ke,` ${Te??""} `),K(me,v(Z).length)},[()=>u(Y)]),E(M,xe)});var fe=_(H,2);{var Q=M=>{const Y=pt(()=>r().groups[v(a)]),Z=pt(()=>Po(v(a)));var F=sh(),oe=m(F);let xe;var Ie=m(oe);Ie.__click=()=>{A(a,null),A(i,null)};var ve=_(Ie,2),ee=m(ve),le=_(ve,2),ke=m(le),re=_(oe,2);Ut(re,21,()=>v(Y),ae=>ae.emailId,(ae,te)=>{var he=nh(),W=m(he);W.__click=()=>{var Oe;return(Oe=e.onaskai)==null?void 0:Oe.call(e,`Tell me about the email "${v(te).subject}" from ${v(te).from}`)};var J=m(W),de=m(J),ce=_(J,2),Se=m(ce),Ke=_(Se);{var Ce=Oe=>{var We=th(),Ze=m(We);$(Qe=>K(Ze,Qe),[()=>d(v(te).date)]),E(Oe,We)};ne(Ke,Oe=>{v(te).date&&Oe(Ce)})}var C=_(W,2),_e=m(C);_e.__click=()=>{var Oe;return(Oe=e.onmarkacted)==null?void 0:Oe.call(e,v(te).emailId)};var Ae=_(_e,2);Ae.__click=()=>{var Oe;return(Oe=e.ondismiss)==null?void 0:Oe.call(e,v(te).emailId)},$(Oe=>{K(de,v(te).subject),K(Se,Oe)},[()=>g(v(te).from)]),E(ae,he)});var me=_(re,2),Te=m(me);{var se=ae=>{var te=rh(),he=Xe(te);he.__click=()=>v(Y).forEach(J=>{var de;return(de=e.onmarkacted)==null?void 0:de.call(e,J.emailId)});var W=_(he,2);W.__click=()=>A(i,v(a),!0),E(ae,te)},pe=ae=>{var te=ah(),he=Xe(te),W=m(he),J=_(he,2);J.__click=()=>A(i,null);var de=_(J,2);de.__click=()=>{var ce;(ce=e.oncleargroup)==null||ce.call(e,v(a)),A(i,null),A(a,null)},$(()=>K(W,`Remove ${v(Y).length??""}?`)),E(ae,te)};ne(Te,ae=>{v(i)!==v(a)?ae(se):ae(pe,!1)})}$(ae=>{xe=En(oe,"",xe,{"border-color":v(Z)}),K(ee,ae),K(ke,v(Y).length)},[()=>u(v(a))]),E(M,F)};ne(fe,M=>{v(a)&&r().groups[v(a)]&&M(Q)})}$(()=>K(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),E(x,O)};ne(w,x=>{r()&&r().total>0&&x(k)})}return E(t,b),Et(p)}Gt(["click"]);var lh=N('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),ch=N('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),uh=N('<div class="strip svelte-1ed7zw1"><!></div>');function dh(t,e){let r=je(e,"hasScanData",3,!1),a=je(e,"engineReady",3,!1),i=je(e,"isScanning",3,!1),o=pt(()=>a()&&!r()&&!i()),u=pt(()=>v(o)||i());var d=wr(),g=Xe(d);{var p=b=>{var w=uh(),k=m(w);{var x=z=>{var T=lh();E(z,T)},O=z=>{var T=ch();T.__click=function(...H){var fe;(fe=e.onscan)==null||fe.apply(this,H)},E(z,T)};ne(k,z=>{i()?z(x):v(o)&&z(O,1)})}E(b,w)};ne(g,b=>{v(u)&&b(p)})}E(t,d)}Gt(["click"]);var fh=N('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),vh=N('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),ph=N('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),hh=N('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mh=N('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),gh=N('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),_h=N('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function yh(t,e){Tt(e,!0),an(()=>Fn("GpuPanel"));var r=_h(),a=m(r),i=_(m(a),2),o=_(m(i),2),u=m(o),d=_(i,2),g=_(m(d),2),p=m(g),b=_(d,2);{var w=M=>{var Y=fh(),Z=_(m(Y),2),F=m(Z);$(()=>K(F,e.gpuInfo.device)),E(M,Y)};ne(b,M=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&M(w)})}var k=_(b,2);{var x=M=>{var Y=vh(),Z=_(m(Y),2),F=m(Z);$(oe=>K(F,oe),[()=>Ao(e.gpuInfo.limits.maxBufferSize)]),E(M,Y)};ne(k,M=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxBufferSize&&M(x)})}var O=_(k,2);{var z=M=>{var Y=ph(),Z=_(m(Y),2),F=m(Z);$(()=>K(F,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),E(M,Y)};ne(O,M=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxComputeInvocationsPerWorkgroup&&M(z)})}var T=_(O,2);{var H=M=>{var Y=hh(),Z=_(m(Y),2),F=m(Z);$(oe=>K(F,oe),[()=>Ao(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),E(M,Y)};ne(T,M=>{var Y;(Y=e.gpuInfo.limits)!=null&&Y.maxComputeWorkgroupStorageSize&&M(H)})}var fe=_(T,2);{var Q=M=>{var Y=gh(),Z=m(Y),F=m(Z),oe=_(Z,2);Ut(oe,21,()=>e.gpuInfo.features,dn,(xe,Ie)=>{var ve=mh(),ee=m(ve);$(()=>K(ee,v(Ie))),E(xe,ve)}),$(()=>K(F,`Features (${e.gpuInfo.features.length??""})`)),E(M,Y)};ne(fe,M=>{var Y;(Y=e.gpuInfo.features)!=null&&Y.length&&M(Q)})}$(()=>{K(u,e.gpuInfo.vendor),K(p,e.gpuInfo.architecture)}),E(t,r),Et()}var bh=N('<button class="gpu-badge svelte-1ktw27c"> </button>'),wh=N('<span class="backend-badge svelte-1ktw27c">ð¦ Ollama</span>'),kh=N('<span class="stats svelte-1ktw27c"> </span>'),xh=N('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Sh=N('<span class="stats preparing svelte-1ktw27c"> </span>'),Th=N('<span class="stats svelte-1ktw27c"> </span>'),Eh=N('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ah=N('<button class="btn svelte-1ktw27c">Stop</button>'),Ch=N('<button class="btn primary svelte-1ktw27c">Send</button>'),Ph=N('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Ih(t,e){Tt(e,!0),an(()=>Fn("ChatView"));let r=je(e,"messages",19,()=>[]),a=je(e,"pendingData",3,null),i=je(e,"hasScanData",3,!1),o=je(e,"engineReady",3,!1),u=je(e,"isScanning",3,!1),d=je(e,"isRunning",3,!1),g=je(e,"tps",3,null),p=je(e,"numTokens",3,null),b=je(e,"generationPhase",3,null),w=je(e,"gpuInfo",3,null),k=je(e,"backend",3,"webgpu"),x=je(e,"chatContainer",15),O=De(""),z=De(!1);function T(ce){ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),H())}function H(){const ce=v(O).trim();!ce||d()||(A(O,""),e.onsend(ce))}function fe(ce){ce&&!d()&&e.onsend(ce)}var Q=Ph(),M=m(Q),Y=m(M);{var Z=ce=>{var Se=bh();Se.__click=()=>A(z,!v(z));var Ke=m(Se);$(()=>K(Ke,`WebGPU ${v(z)?"â²":"â¼"}`)),E(ce,Se)},F=ce=>{var Se=wh();E(ce,Se)};ne(Y,ce=>{w()?ce(Z):k()==="ollama"&&ce(F,1)})}var oe=_(Y,2);{var xe=ce=>{var Se=kh(),Ke=m(Se);$((Ce,C)=>K(Ke,`${p()??""} tokens in ${Ce??""}s
        (${C??""} tok/s)`),[()=>(p()/g()).toFixed(1),()=>g().toFixed(1)]),E(ce,Se)},Ie=ce=>{var Se=xh();E(ce,Se)},ve=ce=>{var Se=Sh(),Ke=m(Se);$(Ce=>K(Ke,`thinking... ${Ce??""}`),[()=>g()?`${g().toFixed(0)} tok/s`:""]),E(ce,Se)},ee=ce=>{var Se=Th(),Ke=m(Se);$(Ce=>K(Ke,`${Ce??""} tok/s`),[()=>g().toFixed(1)]),E(ce,Se)};ne(oe,ce=>{g()&&!d()?ce(xe):d()&&b()==="preparing"?ce(Ie,1):d()&&b()==="thinking"?ce(ve,2):g()&&d()&&ce(ee,3)})}var le=_(oe,4);le.__click=function(...ce){var Se;(Se=e.onreset)==null||Se.apply(this,ce)};var ke=_(M,2);{var re=ce=>{yh(ce,{get gpuInfo(){return w()}})};ne(ke,ce=>{v(z)&&w()&&ce(re)})}var me=_(ke,2),Te=m(me);{var se=ce=>{var Se=Eh();E(ce,Se)};ne(Te,ce=>{r().length===0&&!(a()&&a().total>0)&&ce(se)})}var pe=_(Te,2);Ut(pe,17,r,dn,(ce,Se,Ke)=>{var Ce=wr(),C=Xe(Ce);{var _e=Oe=>{oh(Oe,{get pendingData(){return v(Se).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:fe})},Ae=Oe=>{{let We=pt(()=>Ke===r().length-1);$p(Oe,{get msg(){return v(Se)},get isLast(){return v(We)},get isRunning(){return d()},get generationPhase(){return b()},get numTokens(){return p()}})}};ne(C,Oe=>{v(Se).type==="dashboard"?Oe(_e):Oe(Ae,!1)})}E(ce,Ce)}),Ou(me,ce=>x(ce),()=>x());var ae=_(me,2);dh(ae,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var te=_(ae,2),he=m(te);he.__keydown=T;var W=_(he,2);{var J=ce=>{var Se=Ah();Se.__click=function(...Ke){var Ce;(Ce=e.onstop)==null||Ce.apply(this,Ke)},E(ce,Se)},de=ce=>{var Se=Ch();Se.__click=H,$(Ke=>Se.disabled=Ke,[()=>!v(O).trim()]),E(ce,Se)};ne(W,ce=>{d()?ce(J):ce(de,!1)})}$(()=>{le.disabled=d(),he.disabled=d()}),Si(he,()=>v(O),ce=>A(O,ce)),E(t,Q),Et()}Gt(["click","keydown"]);var Oh=N('<div class="container center svelte-1bi93vx"><!> <!></div>');function Rh(t,e){Tt(e,!0);const r=!!navigator.gpu,a=Mu();let i=De(Kt(localStorage.getItem("aiBackend")||"webgpu"));function o(){const W=localStorage.getItem("selectedModel");return W||(v(i)==="webgpu"?yr[0].id:ir[0].name)}let u=De(Kt(o())),d=De(null),g=De(null),p=De(""),b=De(Kt([])),w=De(Kt([])),k=De(!1),x=De(null),O=De(null),z=De(null),T=De(null),H=De(null),fe=De(null),Q=De(!1),M=De(!1),Y=!1;an(()=>{a.check(),a.isReady&&Z();const W=a.onMessage(J=>{switch(J.status){case"webgpu-info":A(T,J.data,!0);break;case"loading":A(d,"loading"),A(p,J.data,!0);break;case"initiate":A(b,[...v(b),J],!0);break;case"progress":A(b,v(b).map(de=>de.file===J.file?{...de,...J}:de),!0);break;case"done":A(b,v(b).filter(de=>de.file!==J.file),!0);break;case"ready":A(d,"ready"),Z();break;case"start":if(!v(k))break;A(H,J.phase||"preparing",!0),A(w,[...v(w),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!v(k))break;A(H,J.phase,!0);break;case"thinking":{if(!v(k))break;A(x,J.tps,!0),A(O,J.numTokens,!0);const de=v(w)[v(w).length-1];A(w,[...v(w).slice(0,-1),{...de,thinking:(de.thinking||"")+J.content}],!0),le();break}case"thinking-done":{if(!v(k))break;A(x,J.tps,!0),A(O,J.numTokens,!0);const de=v(w)[v(w).length-1];A(w,[...v(w).slice(0,-1),{...de,thinking:J.content}],!0);break}case"update":{if(!v(k))break;A(x,J.tps,!0),A(O,J.numTokens,!0);const de=v(w)[v(w).length-1];A(w,[...v(w).slice(0,-1),{...de,content:de.content+J.output}],!0),le();break}case"complete":if(!v(k))break;J.tps!==void 0&&A(x,J.tps,!0),J.numTokens!==void 0&&A(O,J.numTokens,!0),A(k,!1),A(H,null),F();break;case"error":A(g,J.data,!0),v(d)==="loading"&&A(d,null),v(k)&&(A(k,!1),A(H,null));break}});return()=>W()});async function Z(){if(!(Y||v(w).length>0))try{const W=await ic();A(fe,W,!0),W&&(Y=!0,A(w,[{role:"assistant",type:"dashboard",pendingData:W}],!0),le());const J=await Co();A(Q,J.classified>0)}catch{}}async function F(){try{const W=await ic();A(fe,W,!0);const J=v(w).findIndex(ce=>ce.type==="dashboard");J!==-1&&(W&&W.total>0?A(w,v(w).map((ce,Se)=>Se===J?{...ce,pendingData:W}:ce),!0):A(w,v(w).filter((ce,Se)=>Se!==J),!0));const de=await Co();A(Q,de.classified>0)}catch{}}async function oe(W){await vi(W,"acted"),await F()}async function xe(W){await vi(W,"dismissed"),await F()}async function Ie(W){await Hu(W),await F()}async function ve(W){await tl(W),await F()}async function ee(){if(!(v(M)||!a.isReady)){A(M,!0);try{await Wu(a,{count:20}),await F(),v(fe)&&!v(w).some(W=>W.type==="dashboard")&&(A(w,[{role:"assistant",type:"dashboard",pendingData:v(fe)},...v(w)],!0),le())}catch(W){console.error("Scan failed:",W)}finally{A(M,!1)}}}function le(){Tu().then(()=>{v(z)&&(v(z).scrollTop=v(z).scrollHeight)})}function ke(){A(d,"loading"),localStorage.setItem("selectedModel",v(u)),localStorage.setItem("aiBackend",v(i)),v(i)==="ollama"&&A(T,null),a.loadModel(v(u))}Sa(()=>{v(i)==="webgpu"&&!yr.find(W=>W.id===v(u))?A(u,yr[0].id,!0):v(i)==="ollama"&&!ir.find(W=>W.name===v(u))&&A(u,ir[0].name,!0)});async function re(W){if(!W||v(k))return;A(w,[...v(w),{role:"user",content:W}],!0),A(x,null),A(k,!0);let J=[];try{const Se=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(W)?await Vv(W):await Hv();Se&&(J=[{role:"system",content:Se}])}catch{}const de=v(w).filter(ce=>ce.type!=="dashboard").map(ce=>({role:ce.role,content:ce.content}));a.generate([...J,...de]),le()}function me(){a.interrupt()}function Te(){a.reset(),A(w,[],!0),A(x,null),A(O,null),Y=!1,Z()}var se=wr(),pe=Xe(se);{var ae=W=>{var J=Oh(),de=m(J);sp(de,{get isWebGPUAvailable(){return r},get backend(){return v(i)},set backend(Ce){A(i,Ce,!0)}});var ce=_(de,2);{var Se=Ce=>{_p(Ce,{get gpuInfo(){return v(T)},get error(){return v(g)},onload:ke,get selectedModel(){return v(u)},set selectedModel(C){A(u,C,!0)}})},Ke=Ce=>{Dp(Ce,{onload:ke,get selectedModel(){return v(u)},set selectedModel(C){A(u,C,!0)},get error(){return v(g)},set error(C){A(g,C,!0)}})};ne(ce,Ce=>{v(i)==="webgpu"?Ce(Se):v(i)==="ollama"&&Ce(Ke,1)})}E(W,J)},te=W=>{Kp(W,{get message(){return v(p)},get items(){return v(b)}})},he=W=>{Ih(W,{get messages(){return v(w)},get pendingData(){return v(fe)},get hasScanData(){return v(Q)},get engineReady(){return a.isReady},get isScanning(){return v(M)},get isRunning(){return v(k)},get tps(){return v(x)},get numTokens(){return v(O)},get generationPhase(){return v(H)},get gpuInfo(){return v(T)},get backend(){return v(i)},onsend:re,onstop:me,onreset:Te,onmarkacted:oe,ondismiss:xe,onremove:Ie,oncleargroup:ve,onscan:ee,get chatContainer(){return v(z)},set chatContainer(J){A(z,J,!0)}})};ne(pe,W=>{v(d)===null?W(ae):v(d)==="loading"?W(te,1):W(he,!1)})}E(t,se),Et()}const dc="https://accounts.google.com/gsi/client",Mh="https://www.googleapis.com/auth/gmail.readonly",nl="me-ai:oauth-token",rl=300*1e3;let Ts=null,ks=null,Xr=0;function Yu(t,e){Xr=Date.now()+e*1e3;try{sessionStorage.setItem(nl,JSON.stringify({access_token:t,expires_at:Xr}))}catch{}}function Io(){Xr=0;try{sessionStorage.removeItem(nl)}catch{}}function Dh(){try{const t=sessionStorage.getItem(nl);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-rl?(Io(),null):(Xr=r,{access_token:e})}catch{return Io(),null}}function jh(){return Xr>0&&Date.now()<Xr-rl}function Lh(){return Xr<=0?0:Math.max(0,Xr-rl-Date.now())}function fc(){return new Promise((t,e)=>{if(!Ts){e(new Error("Google Auth not initialized."));return}ks=r=>{r.error?e(new Error(r.error_description||r.error)):(Yu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},Ts.requestAccessToken({prompt:""})})}function Nh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${dc}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=dc,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function vc(t){await Nh(),Ts=google.accounts.oauth2.initTokenClient({client_id:t,scope:Mh,callback:e=>{ks&&(ks(e),ks=null)}})}function qh(){return new Promise((t,e)=>{if(!Ts){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}ks=r=>{r.error?e(new Error(r.error_description||r.error)):(Yu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},Ts.requestAccessToken()})}function Bh(t){return Io(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const tn="gmail",pc=8,Qu=50,Xu=100;async function zh(t,{limit:e=Qu,onProgress:r=()=>{},signal:a}={}){var u;const i=await Ue.syncState.get(tn);if(i!=null&&i.historyId)try{return await Wh(t,i,r,a)}catch(d){if(d instanceof $o&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Ue.syncState.delete(tn);else throw d}return await Uh(t,e===0?1/0:e,r,a)}async function Fh(t,{limit:e=Qu,onProgress:r=()=>{},signal:a}={}){const i=await Ue.syncState.get(tn);return i!=null&&i.oldestPageToken?await Gh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Kh(){const t=await Ue.syncState.get(tn);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Zu(){await Ue.transaction("rw",[Ue.items,Ue.syncState],async()=>{await Ue.items.where("sourceType").equals(tn).delete(),await Ue.syncState.delete(tn)})}async function Uh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),Ea(a);const i=await Lu(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){Ea(a);const w=e-o.length,k=await Nu(t,{maxResults:Math.min(Xu,w),pageToken:u}),x=(k.messages||[]).map(O=>O.id);if(o.push(...x),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=k.nextPageToken,!u||x.length===0)break}if(d=u||null,o.length===0)return await Ue.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:g,errors:p}=await Ju(t,o,r,a),b=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:b,oldestPageToken:d}),r({phase:"done",message:`Synced ${g} messages`,current:g,total:g}),{added:g,deleted:0,errors:p}}async function Gh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),Ea(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){Ea(i);const w=r-o.length,k=await Nu(t,{maxResults:Math.min(Xu,w),pageToken:u}),x=(k.messages||[]).map(O=>O.id);if(o.push(...x),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=k.nextPageToken,!u||x.length===0)break}if(d=u||null,o.length===0)return await Ue.syncState.update(tn,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:g,errors:p}=await Ju(t,o,a,i),b=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.update(tn,{totalItems:b,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${g} more (more available)`:`Downloaded ${g} more (all synced)`,current:b,total:b}),{added:g,errors:p}}async function Wh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),Ea(a);let i=0,o=0,u=0,d,g=e.historyId;do{Ea(a);const b=await jv(t,{startHistoryId:e.historyId,pageToken:d});if(g=b.historyId||g,d=b.nextPageToken,!!b.history){for(const w of b.history){if(w.messagesAdded){const k=w.messagesAdded.map(O=>O.message.id),x=[...new Set(k.filter(O=>O))];if(x.length>0){const O=await Promise.allSettled(x.map(T=>qu(t,T))),z=[];for(const T of O)T.status==="fulfilled"?z.push($u(T.value)):u++;z.length>0&&(await Ue.items.bulkPut(z),await ed(z),i+=z.length)}}if(w.messagesDeleted){const k=w.messagesDeleted.map(x=>Du(tn,x.message.id)).filter(x=>x);k.length>0&&(await Ue.items.bulkDelete(k),o+=k.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await Ue.items.where("sourceType").equals(tn).count();return await Ue.syncState.put({sourceType:tn,historyId:g,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:u}}async function Ju(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=pc){Ea(a);const d=e.slice(u,u+pc),g=await Promise.allSettled(d.map(b=>qu(t,b))),p=[];for(const b of g)b.status==="fulfilled"?p.push($u(b.value)):o++;p.length>0&&(await Ue.items.bulkPut(p),await ed(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function $u(t){const e=Kr(t,"From"),r=Kr(t,"To"),a=Kr(t,"Cc"),i=Kr(t,"Subject")||"(no subject)",o=Kr(t,"Date"),u=Kr(t,"Message-ID"),d=Kr(t,"In-Reply-To"),g=Kr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:Du(tn,t.id),sourceType:tn,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:Lv(t),htmlBody:Nv(t),date:p,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:g,raw:t,syncedAt:Date.now()}}async function ed(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Hh(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Ue.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await Ue.contacts.update(o.id,u)}else await Ue.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Hh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function Ea(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Vh=N(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Yh(t,e){Tt(e,!0);let r=je(e,"clientIdInput",15);an(()=>Fn("SetupGuide"));let a=De(null);async function i(J){try{await navigator.clipboard.writeText(J),A(a,J,!0),setTimeout(()=>{A(a,null)},1500)}catch{const de=document.createElement("input");de.value=J,document.body.appendChild(de),de.select(),document.execCommand("copy"),document.body.removeChild(de),A(a,J,!0),setTimeout(()=>{A(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var g=Vh(),p=m(g),b=_(m(p),4),w=_(m(b),6),k=_(m(w),2),x=_(m(k),2),O=_(m(x),2),z=m(O);z.__click=()=>i(o);var T=m(z);T.textContent="http://localhost:5173";var H=_(T,2),fe=m(H),Q=_(z,2);Q.__click=()=>i(u);var M=m(Q);M.textContent="https://cypherkitty.github.io";var Y=_(M,2),Z=m(Y),F=_(x,2),oe=_(m(F),2),xe=m(oe);xe.__click=()=>i(o);var Ie=m(xe);Ie.textContent="http://localhost:5173";var ve=_(Ie,2),ee=m(ve),le=_(xe,2);le.__click=()=>i(u);var ke=m(le);ke.textContent="https://cypherkitty.github.io";var re=_(ke,2),me=m(re),Te=_(le,2);Te.__click=()=>i(d);var se=m(Te);se.textContent="https://cypherkitty.github.io/me-ai/";var pe=_(se,2),ae=m(pe),te=_(b,2),he=m(te);he.__keydown=J=>J.key==="Enter"&&e.onsave();var W=_(he,2);W.__click=function(...J){var de;(de=e.onsave)==null||de.apply(this,J)},$(J=>{K(fe,v(a)===o?"â":"â§"),K(Z,v(a)===u?"â":"â§"),K(ee,v(a)===o?"â":"â§"),K(me,v(a)===u?"â":"â§"),K(ae,v(a)===d?"â":"â§"),W.disabled=J},[()=>!r().trim()]),Si(he,r),E(t,g),Et()}Gt(["click","keydown"]);function Qh(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof $o?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Xh=N('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Zh=N('<div class="error-card-title svelte-14buhqq"> </div>'),Jh=N('<p class="error-card-fix svelte-14buhqq"> </p>'),$h=N('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),em=N('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),tm=N('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function td(t,e){Tt(e,!0);let r=je(e,"ondismiss",3,null),a=je(e,"onsignout",3,null),i=pt(()=>Qh(e.error));an(()=>Fn("ErrorCard"));var o=tm(),u=m(o);{var d=H=>{var fe=Xh(),Q=m(fe),M=m(Q),Y=_(Q,2);Y.__click=function(...Z){var F;(F=r())==null||F.apply(this,Z)},$(()=>K(M,v(i).title)),E(H,fe)},g=H=>{var fe=Zh(),Q=m(fe);$(()=>K(Q,v(i).title)),E(H,fe)};ne(u,H=>{r()?H(d):H(g,!1)})}var p=_(u,2),b=m(p),w=_(p,2);{var k=H=>{var fe=Jh(),Q=m(fe);$(()=>K(Q,v(i).fix)),E(H,fe)};ne(w,H=>{v(i).fix&&H(k)})}var x=_(w,2);{var O=H=>{var fe=$h(),Q=m(fe);$(()=>{Iu(fe,"href",v(i).link.url),K(Q,`${v(i).link.label??""} â`)}),E(H,fe)};ne(x,H=>{v(i).link&&H(O)})}var z=_(x,2);{var T=H=>{var fe=em();fe.__click=function(...Q){var M;(M=a())==null||M.apply(this,Q)},E(H,fe)};ne(z,H=>{v(i).action==="signout"&&a()&&H(T)})}$(()=>K(b,v(i).description)),E(t,o),Et()}Gt(["click"]);var nm=N('<span class="spinner svelte-nyqevv"></span> Signing in...',1),rm=Xo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),am=N(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <p class="auth-hint svelte-nyqevv">Popup blocked? Use <a href="/oauth-redirect.html" class="auth-link svelte-nyqevv">Sign in with Google (redirect)</a> â works in Cursor and other environments without popups.</p> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function sm(t,e){Tt(e,!0);let r=je(e,"error",3,null),a=je(e,"loadingAuth",3,!1);an(()=>Fn("AuthCard"));var i=am(),o=m(i),u=_(m(o),4);{var d=T=>{td(T,{get error(){return r()},get onsignout(){return e.onsignout}})};ne(u,T=>{r()&&T(d)})}var g=_(u,2);g.__click=function(...T){var H;(H=e.onsignin)==null||H.apply(this,T)};var p=m(g);{var b=T=>{var H=nm();E(T,H)},w=T=>{var H=rm();E(T,H)};ne(p,T=>{a()?T(b):T(w,!1)})}var k=_(g,4),x=_(m(k),2),O=m(x),z=_(x,2);z.__click=function(...T){var H;(H=e.onclear)==null||H.apply(this,T)},$(T=>{g.disabled=a(),K(O,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),E(t,i),Et()}Gt(["click"]);var im=N('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),om=N('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),lm=N('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function cm(t,e){Tt(e,!0);let r=je(e,"profile",3,null),a=je(e,"loadingProfile",3,!1);an(()=>Fn("ProfileCard"));var i=lm(),o=m(i),u=m(o),d=_(o,2),g=m(d);{var p=k=>{var x=im();E(k,x)},b=k=>{var x=om(),O=Xe(x),z=m(O),T=_(O,2),H=m(T);$((fe,Q)=>{K(z,r().emailAddress),K(H,`${fe??""} messages
        Â· ${Q??""} threads`)},[()=>{var fe;return((fe=r().messagesTotal)==null?void 0:fe.toLocaleString())||"?"},()=>{var fe;return((fe=r().threadsTotal)==null?void 0:fe.toLocaleString())||"?"}]),E(k,x)};ne(g,k=>{a()?k(p):r()&&k(b,1)})}var w=_(d,2);w.__click=function(...k){var x;(x=e.onsignout)==null||x.apply(this,k)},$(k=>K(u,k),[()=>r()?zu(r().emailAddress):"?"]),E(t,i),Et()}Gt(["click"]);var um=N('<span class="spinner svelte-1ds3j4k"></span>'),dm=Xo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),fm=N('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),vm=N('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),pm=N('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),hm=N('<option class="svelte-1ds3j4k"> </option>'),mm=N('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),gm=N('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),_m=N('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),ym=N('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),bm=N('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),wm=N('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function km(t,e){Tt(e,!0),an(()=>Fn("SyncStatus"));let r=je(e,"syncStatus",3,null),a=je(e,"syncProgress",3,null),i=je(e,"isSyncing",3,!1),o=De(!1),u=De(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function g(se){if(!se)return"never";const pe=Math.floor((Date.now()-se)/1e3);if(pe<60)return"just now";const ae=Math.floor(pe/60);if(ae<60)return`${ae}m ago`;const te=Math.floor(ae/60);return te<24?`${te}h ago`:`${Math.floor(te/24)}d ago`}function p(){var se,pe;return!((se=a())!=null&&se.total)||!((pe=a())!=null&&pe.current)?0:Math.round(a().current/a().total*100)}var b=wm(),w=m(b),k=m(w),x=m(k);{var O=se=>{var pe=um();E(se,pe)},z=se=>{var pe=dm();E(se,pe)};ne(x,se=>{i()?se(O):se(z,!1)})}var T=_(k,2),H=_(m(T),2);{var fe=se=>{var pe=fm(),ae=m(pe),te=_(ae);{var he=J=>{var de=Or("Â· more available");E(J,de)},W=J=>{var de=Or("Â· all synced");E(J,de)};ne(te,J=>{r().hasMore?J(he):J(W,!1)})}$((J,de)=>K(ae,`${J??""} emails stored
          Â· synced ${de??""} `),[()=>r().totalItems.toLocaleString(),()=>g(r().lastSyncAt)]),E(se,pe)},Q=se=>{var pe=vm();E(se,pe)};ne(H,se=>{var pe;(pe=r())!=null&&pe.synced?se(fe):se(Q,!1)})}var M=_(T,2),Y=m(M);{var Z=se=>{var pe=pm();pe.__click=()=>A(o,!v(o)),E(se,pe)};ne(Y,se=>{var pe;(pe=r())!=null&&pe.synced&&!i()&&se(Z)})}var F=_(w,2),oe=m(F),xe=_(m(oe),2);Ut(xe,21,()=>d,dn,(se,pe)=>{var ae=hm(),te=m(ae),he={};$(()=>{K(te,v(pe).label),he!==(he=v(pe).value)&&(ae.value=(ae.__value=v(pe).value)??"")}),E(se,ae)});var Ie=_(oe,2),ve=m(Ie);{var ee=se=>{var pe=gm(),ae=Xe(pe);ae.__click=()=>e.onsync(v(u));var te=m(ae),he=_(ae,2);{var W=J=>{var de=mm();de.__click=()=>e.onsyncmore(v(u));var ce=m(de);$(()=>{de.disabled=i(),K(ce,i()?"Loading...":"Sync More")}),E(J,de)};ne(he,J=>{r().hasMore&&J(W)})}$(()=>{ae.disabled=i(),K(te,i()?"Syncing...":"Sync New")}),E(se,pe)},le=se=>{var pe=_m();pe.__click=()=>e.onsync(v(u));var ae=m(pe);$(()=>{pe.disabled=i(),K(ae,i()?"Syncing...":"Download Emails")}),E(se,pe)};ne(ve,se=>{var pe;(pe=r())!=null&&pe.synced?se(ee):se(le,!1)})}var ke=_(F,2);{var re=se=>{var pe=ym(),ae=m(pe),te=m(ae);let he,W;var J=_(ae,2),de=m(J);$(ce=>{he=jt(te,1,"progress-fill svelte-1ds3j4k",null,he,{indeterminate:!a().total}),W=En(te,"",W,ce),K(de,a().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),E(se,pe)};ne(ke,se=>{i()&&a()&&se(re)})}var me=_(ke,2);{var Te=se=>{var pe=bm(),ae=_(m(pe),2),te=m(ae);te.__click=()=>A(o,!1);var he=_(te,2);he.__click=()=>{e.onclear(),A(o,!1)},E(se,pe)};ne(me,se=>{v(o)&&se(Te)})}$(()=>xe.disabled=i()),xi(xe,()=>v(u),se=>A(u,se)),E(t,b),Et()}Gt(["click"]);var xm=N('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Sm=N('<div class="message-list svelte-y2uamw"></div>');function Tm(t,e){Tt(e,!0);let r=je(e,"messages",19,()=>[]);an(()=>Fn("MessageList"));var a=Sm();Ut(a,21,r,dn,(i,o)=>{var u=xm();u.__click=()=>e.onselect(v(o));var d=m(u),g=m(d),p=_(d,2),b=m(p),w=m(b),k=m(w),x=_(w,2),O=m(x),z=_(b,2),T=m(z),H=_(z,2),fe=m(H);$((Q,M,Y)=>{K(g,Q),K(k,M),K(O,Y),K(T,v(o).subject),K(fe,v(o).snippet)},[()=>zu(v(o).from),()=>Bu(v(o).from),()=>el(v(o).date)]),E(i,u)}),E(t,a),Et()}Gt(["click"]);function al(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Pa=al();function nd(t){Pa=t}var ca={exec:()=>null};function dt(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(hn.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Em=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),hn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Am=/^(?:[ \t]*(?:\n|$))+/,Cm=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Pm=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,js=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Im=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,sl=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,rd=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ad=dt(rd).replace(/bull/g,sl).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Om=dt(rd).replace(/bull/g,sl).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),il=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Rm=/^[^\n]+/,ol=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Mm=dt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ol).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Dm=dt(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,sl).getRegex(),Ei="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ll=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,jm=dt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ll).replace("tag",Ei).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),sd=dt(il).replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex(),Lm=dt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",sd).getRegex(),cl={blockquote:Lm,code:Cm,def:Mm,fences:Pm,heading:Im,hr:js,html:jm,lheading:ad,list:Dm,newline:Am,paragraph:sd,table:ca,text:Rm},hc=dt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex(),Nm={...cl,lheading:Om,table:hc,paragraph:dt(il).replace("hr",js).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",hc).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ei).getRegex()},qm={...cl,html:dt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ll).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ca,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:dt(il).replace("hr",js).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ad).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Bm=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,id=/^( {2,}|\\)\n(?!\s*$)/,Fm=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ai=/[\p{P}\p{S}]/u,ul=/[\s\p{P}\p{S}]/u,od=/[^\s\p{P}\p{S}]/u,Km=dt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ul).getRegex(),ld=/(?!~)[\p{P}\p{S}]/u,Um=/(?!~)[\s\p{P}\p{S}]/u,Gm=/(?:[^\s\p{P}\p{S}]|~)/u,cd=/(?![*_])[\p{P}\p{S}]/u,Wm=/(?![*_])[\s\p{P}\p{S}]/u,Hm=/(?:[^\s\p{P}\p{S}]|[*_])/u,Vm=dt(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Em?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),ud=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ym=dt(ud,"u").replace(/punct/g,Ai).getRegex(),Qm=dt(ud,"u").replace(/punct/g,ld).getRegex(),dd="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xm=dt(dd,"gu").replace(/notPunctSpace/g,od).replace(/punctSpace/g,ul).replace(/punct/g,Ai).getRegex(),Zm=dt(dd,"gu").replace(/notPunctSpace/g,Gm).replace(/punctSpace/g,Um).replace(/punct/g,ld).getRegex(),Jm=dt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,od).replace(/punctSpace/g,ul).replace(/punct/g,Ai).getRegex(),$m=dt(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,cd).getRegex(),eg="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",tg=dt(eg,"gu").replace(/notPunctSpace/g,Hm).replace(/punctSpace/g,Wm).replace(/punct/g,cd).getRegex(),ng=dt(/\\(punct)/,"gu").replace(/punct/g,Ai).getRegex(),rg=dt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ag=dt(ll).replace("(?:-->|$)","-->").getRegex(),sg=dt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ag).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),pi=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ig=dt(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",pi).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),fd=dt(/^!?\[(label)\]\[(ref)\]/).replace("label",pi).replace("ref",ol).getRegex(),vd=dt(/^!?\[(ref)\](?:\[\])?/).replace("ref",ol).getRegex(),og=dt("reflink|nolink(?!\\()","g").replace("reflink",fd).replace("nolink",vd).getRegex(),mc=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,dl={_backpedal:ca,anyPunctuation:ng,autolink:rg,blockSkip:Vm,br:id,code:zm,del:ca,delLDelim:ca,delRDelim:ca,emStrongLDelim:Ym,emStrongRDelimAst:Xm,emStrongRDelimUnd:Jm,escape:Bm,link:ig,nolink:vd,punctuation:Km,reflink:fd,reflinkSearch:og,tag:sg,text:Fm,url:ca},lg={...dl,link:dt(/^!?\[(label)\]\((.*?)\)/).replace("label",pi).getRegex(),reflink:dt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pi).getRegex()},Oo={...dl,emStrongRDelimAst:Zm,emStrongLDelim:Qm,delLDelim:$m,delRDelim:tg,url:dt(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",mc).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:dt(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",mc).getRegex()},cg={...Oo,br:dt(id).replace("{2,}","*").getRegex(),text:dt(Oo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ti={normal:cl,gfm:Nm,pedantic:qm},ls={normal:dl,gfm:Oo,breaks:cg,pedantic:lg},ug={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gc=t=>ug[t];function Ar(t,e){if(e){if(hn.escapeTest.test(t))return t.replace(hn.escapeReplace,gc)}else if(hn.escapeTestNoEncode.test(t))return t.replace(hn.escapeReplaceNoEncode,gc);return t}function _c(t){try{t=encodeURI(t).replace(hn.percentDecode,"%")}catch{return null}return t}function yc(t,e){var o;let r=t.replace(hn.findPipe,(u,d,g)=>{let p=!1,b=d;for(;--b>=0&&g[b]==="\\";)p=!p;return p?"|":" |"}),a=r.split(hn.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(hn.slashPipe,"|");return a}function cs(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function dg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function fg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function bc(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let g={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,g}function vg(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var hi=class{constructor(t){it(this,"options");it(this,"rules");it(this,"lexer");this.options=t||Pa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:cs(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=vg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=cs(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:cs(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=cs(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],g;for(g=0;g<r.length;g++)if(this.rules.other.blockquoteStart.test(r[g]))d.push(r[g]),u=!0;else if(!u)d.push(r[g]);else break;r=r.slice(g);let p=d.join(`
`),b=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,i=i?`${i}
${b}`:b;let w=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(b,o,!0),this.lexer.state.top=w,r.length===0)break;let k=o.at(-1);if((k==null?void 0:k.type)==="code")break;if((k==null?void 0:k.type)==="blockquote"){let x=k,O=x.raw+`
`+r.join(`
`),z=this.blockquote(O);o[o.length-1]=z,a=a.substring(0,a.length-x.raw.length)+z.raw,i=i.substring(0,i.length-x.text.length)+z.text;break}else if((k==null?void 0:k.type)==="list"){let x=k,O=x.raw+`
`+r.join(`
`),z=this.list(O);o[o.length-1]=z,a=a.substring(0,a.length-k.raw.length)+z.raw,i=i.substring(0,i.length-x.raw.length)+z.raw,r=O.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),g=!1;for(;t;){let b=!1,w="",k="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;w=e[0],t=t.substring(w.length);let x=fg(e[2].split(`
`,1)[0],e[1].length),O=t.split(`
`,1)[0],z=!x.trim(),T=0;if(this.options.pedantic?(T=2,k=x.trimStart()):z?T=e[1].length+1:(T=x.search(this.rules.other.nonSpaceChar),T=T>4?1:T,k=x.slice(T),T+=e[1].length),z&&this.rules.other.blankLine.test(O)&&(w+=O+`
`,t=t.substring(O.length+1),b=!0),!b){let H=this.rules.other.nextBulletRegex(T),fe=this.rules.other.hrRegex(T),Q=this.rules.other.fencesBeginRegex(T),M=this.rules.other.headingBeginRegex(T),Y=this.rules.other.htmlBeginRegex(T),Z=this.rules.other.blockquoteBeginRegex(T);for(;t;){let F=t.split(`
`,1)[0],oe;if(O=F,this.options.pedantic?(O=O.replace(this.rules.other.listReplaceNesting,"  "),oe=O):oe=O.replace(this.rules.other.tabCharGlobal,"    "),Q.test(O)||M.test(O)||Y.test(O)||Z.test(O)||H.test(O)||fe.test(O))break;if(oe.search(this.rules.other.nonSpaceChar)>=T||!O.trim())k+=`
`+oe.slice(T);else{if(z||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||Q.test(x)||M.test(x)||fe.test(x))break;k+=`
`+O}z=!O.trim(),w+=F+`
`,t=t.substring(F.length+1),x=oe.slice(T)}}u.loose||(g?u.loose=!0:this.rules.other.doubleBlankLine.test(w)&&(g=!0)),u.items.push({type:"list_item",raw:w,task:!!this.options.gfm&&this.rules.other.listIsTask.test(k),loose:!1,text:k,tokens:[]}),u.raw+=w}let p=u.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let b of u.items){if(this.lexer.state.top=!1,b.tokens=this.lexer.blockTokens(b.text,[]),b.task){if(b.text=b.text.replace(this.rules.other.listReplaceTask,""),((r=b.tokens[0])==null?void 0:r.type)==="text"||((a=b.tokens[0])==null?void 0:a.type)==="paragraph"){b.tokens[0].raw=b.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),b.tokens[0].text=b.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let k=this.lexer.inlineQueue.length-1;k>=0;k--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[k].src)){this.lexer.inlineQueue[k].src=this.lexer.inlineQueue[k].src.replace(this.rules.other.listReplaceTask,"");break}}let w=this.rules.other.listTaskCheckbox.exec(b.raw);if(w){let k={type:"checkbox",raw:w[0]+" ",checked:w[0]!=="[ ]"};b.checked=k.checked,u.loose?b.tokens[0]&&["paragraph","text"].includes(b.tokens[0].type)&&"tokens"in b.tokens[0]&&b.tokens[0].tokens?(b.tokens[0].raw=k.raw+b.tokens[0].raw,b.tokens[0].text=k.raw+b.tokens[0].text,b.tokens[0].tokens.unshift(k)):b.tokens.unshift({type:"paragraph",raw:k.raw,text:k.raw,tokens:[k]}):b.tokens.unshift(k)}}if(!u.loose){let w=b.tokens.filter(x=>x.type==="space"),k=w.length>0&&w.some(x=>this.rules.other.anyLine.test(x.raw));u.loose=k}}if(u.loose)for(let b of u.items){b.loose=!0;for(let w of b.tokens)w.type==="text"&&(w.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=yc(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(yc(d,o.header.length).map((g,p)=>({text:g,tokens:this.lexer.inline(g),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=cs(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=dg(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),bc(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return bc(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,g=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(a=p.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){g+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+g);let b=[...a[0]][0].length,w=t.slice(0,i+a.index+b+u);if(Math.min(i,u)%2){let x=w.slice(1,-1);return{type:"em",raw:w,text:x,tokens:this.lexer.inlineTokens(x)}}let k=w.slice(2,-2);return{type:"strong",raw:w,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,g=this.rules.inline.delRDelim;for(g.lastIndex=0,e=e.slice(-1*t.length+i);(a=g.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let p=[...a[0]][0].length,b=t.slice(0,i+a.index+p+u),w=b.slice(i,-i);return{type:"del",raw:b,text:w,tokens:this.lexer.inlineTokens(w)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},nr=class Ro{constructor(e){it(this,"tokens");it(this,"options");it(this,"state");it(this,"inlineQueue");it(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Pa,this.options.tokenizer=this.options.tokenizer||new hi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:hn,block:ti.normal,inline:ls.normal};this.options.pedantic?(r.block=ti.pedantic,r.inline=ls.pedantic):this.options.gfm&&(r.block=ti.gfm,this.options.breaks?r.inline=ls.breaks:r.inline=ls.gfm),this.tokenizer.rules=r}static get rules(){return{block:ti,inline:ls}}static lex(e,r){return new Ro(r).lex(e)}static lexInline(e,r){return new Ro(r).inlineTokens(e)}lex(e){e=e.replace(hn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(hn.tabCharGlobal,"    ").replace(hn.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let g=e;if((u=this.options.extensions)!=null&&u.startBlock){let p=1/0,b=e.slice(1),w;this.options.extensions.startBlock.forEach(k=>{w=k.call({lexer:this},b),typeof w=="number"&&w>=0&&(p=Math.min(p,w))}),p<1/0&&p>=0&&(g=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(g))){let p=r.at(-1);a&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),a=g.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var g,p,b,w,k;let a=e,i=null;if(this.tokens.links){let x=Object.keys(this.tokens.links);if(x.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)x.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((p=(g=this.options.hooks)==null?void 0:g.emStrongMask)==null?void 0:p.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let x;if((w=(b=this.options.extensions)==null?void 0:b.inline)!=null&&w.some(z=>(x=z.call({lexer:this},e,r))?(e=e.substring(x.raw.length),r.push(x),!0):!1))continue;if(x=this.tokenizer.escape(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.tag(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.link(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(x.raw.length);let z=r.at(-1);x.type==="text"&&(z==null?void 0:z.type)==="text"?(z.raw+=x.raw,z.text+=x.text):r.push(x);continue}if(x=this.tokenizer.emStrong(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.codespan(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.br(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.del(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.autolink(e)){e=e.substring(x.raw.length),r.push(x);continue}if(!this.state.inLink&&(x=this.tokenizer.url(e))){e=e.substring(x.raw.length),r.push(x);continue}let O=e;if((k=this.options.extensions)!=null&&k.startInline){let z=1/0,T=e.slice(1),H;this.options.extensions.startInline.forEach(fe=>{H=fe.call({lexer:this},T),typeof H=="number"&&H>=0&&(z=Math.min(z,H))}),z<1/0&&z>=0&&(O=e.substring(0,z+1))}if(x=this.tokenizer.inlineText(O)){e=e.substring(x.raw.length),x.raw.slice(-1)!=="_"&&(d=x.raw.slice(-1)),u=!0;let z=r.at(-1);(z==null?void 0:z.type)==="text"?(z.raw+=x.raw,z.text+=x.text):r.push(x);continue}if(e){let z="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(z);break}else throw new Error(z)}}return r}},mi=class{constructor(t){it(this,"options");it(this,"parser");this.options=t||Pa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(hn.notSpaceStart))==null?void 0:o[0],i=t.replace(hn.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Ar(a)+'">'+(r?i:Ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=_c(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Ar(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=_c(t);if(i===null)return Ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Ar(t.text)}},fl=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},rr=class Mo{constructor(e){it(this,"options");it(this,"renderer");it(this,"textRenderer");this.options=e||Pa,this.options.renderer=this.options.renderer||new mi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new fl}static parse(e,r){return new Mo(r).parse(e)}static parseInline(e,r){return new Mo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let g=u,p=this.options.extensions.renderers[g.type].call({parser:this},g);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(g.type)){r+=p||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let g='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(g),"";throw new Error(g)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=p||"";continue}}let g=d;switch(g.type){case"escape":{a+=r.text(g);break}case"html":{a+=r.html(g);break}case"link":{a+=r.link(g);break}case"image":{a+=r.image(g);break}case"checkbox":{a+=r.checkbox(g);break}case"strong":{a+=r.strong(g);break}case"em":{a+=r.em(g);break}case"codespan":{a+=r.codespan(g);break}case"br":{a+=r.br(g);break}case"del":{a+=r.del(g);break}case"text":{a+=r.text(g);break}default:{let p='Token with "'+g.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return a}},ai,gs=(ai=class{constructor(t){it(this,"options");it(this,"block");this.options=t||Pa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?nr.lex:nr.lexInline}provideParser(){return this.block?rr.parse:rr.parseInline}},it(ai,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),it(ai,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),ai),pg=class{constructor(...t){it(this,"defaults",al());it(this,"options",this.setOptions);it(this,"parse",this.parseMarkdown(!0));it(this,"parseInline",this.parseMarkdown(!1));it(this,"Parser",rr);it(this,"Renderer",mi);it(this,"TextRenderer",fl);it(this,"Lexer",nr);it(this,"Tokenizer",hi);it(this,"Hooks",gs);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let g of d)r=r.concat(this.walkTokens(g.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let g=u[d].flat(1/0);r=r.concat(this.walkTokens(g,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new mi(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],g=i[u];i[u]=(...p)=>{let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new hi(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],g=i[u];i[u]=(...p)=>{let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new gs;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],g=i[u];gs.passThroughHooks.has(o)?i[u]=p=>{if(this.defaults.async&&gs.passThroughHooksRespectAsync.has(o))return(async()=>{let w=await d.call(i,p);return g.call(i,w)})();let b=d.call(i,p);return g.call(i,b)}:i[u]=(...p)=>{if(this.defaults.async)return(async()=>{let w=await d.apply(i,p);return w===!1&&(w=await g.apply(i,p)),w})();let b=d.apply(i,p);return b===!1&&(b=g.apply(i,p)),b}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return nr.lex(t,e??this.defaults)}parser(t,e){return rr.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?nr.lex:nr.lexInline)(u,i),g=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(g,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?rr.parse:rr.parseInline)(g,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?nr.lex:nr.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?rr.parse:rr.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},Aa=new pg;function bt(t,e){return Aa.parse(t,e)}bt.options=bt.setOptions=function(t){return Aa.setOptions(t),bt.defaults=Aa.defaults,nd(bt.defaults),bt};bt.getDefaults=al;bt.defaults=Pa;bt.use=function(...t){return Aa.use(...t),bt.defaults=Aa.defaults,nd(bt.defaults),bt};bt.walkTokens=function(t,e){return Aa.walkTokens(t,e)};bt.parseInline=Aa.parseInline;bt.Parser=rr;bt.parser=rr.parse;bt.Renderer=mi;bt.TextRenderer=fl;bt.Lexer=nr;bt.lexer=nr.lex;bt.Tokenizer=hi;bt.Hooks=gs;bt.parse=bt;bt.options;bt.setOptions;bt.use;bt.walkTokens;bt.parseInline;rr.parse;nr.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:pd,setPrototypeOf:wc,isFrozen:hg,getPrototypeOf:mg,getOwnPropertyDescriptor:gg}=Object;let{freeze:mn,seal:Xn,create:Do}=Object,{apply:jo,construct:Lo}=typeof Reflect<"u"&&Reflect;mn||(mn=function(e){return e});Xn||(Xn=function(e){return e});jo||(jo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});Lo||(Lo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const ni=gn(Array.prototype.forEach),_g=gn(Array.prototype.lastIndexOf),kc=gn(Array.prototype.pop),us=gn(Array.prototype.push),yg=gn(Array.prototype.splice),ui=gn(String.prototype.toLowerCase),oo=gn(String.prototype.toString),lo=gn(String.prototype.match),ds=gn(String.prototype.replace),bg=gn(String.prototype.indexOf),wg=gn(String.prototype.trim),er=gn(Object.prototype.hasOwnProperty),pn=gn(RegExp.prototype.test),fs=kg(TypeError);function gn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return jo(t,e,a)}}function kg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return Lo(t,r)}}function rt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ui;wc&&wc(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(hg(e)||(e[a]=o),i=o)}t[i]=!0}return t}function xg(t){for(let e=0;e<t.length;e++)er(t,e)||(t[e]=null);return t}function pr(t){const e=Do(null);for(const[r,a]of pd(t))er(t,r)&&(Array.isArray(a)?e[r]=xg(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=pr(a):e[r]=a);return e}function vs(t,e){for(;t!==null;){const a=gg(t,e);if(a){if(a.get)return gn(a.get);if(typeof a.value=="function")return gn(a.value)}t=mg(t)}function r(){return null}return r}const xc=mn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),co=mn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),uo=mn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sg=mn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fo=mn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Tg=mn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Sc=mn(["#text"]),Tc=mn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),vo=mn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ec=mn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ri=mn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Eg=Xn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ag=Xn(/<%[\w\W]*|[\w\W]*%>/gm),Cg=Xn(/\$\{[\w\W]*/gm),Pg=Xn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ig=Xn(/^aria-[\-\w]+$/),hd=Xn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Og=Xn(/^(?:\w+script|data):/i),Rg=Xn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),md=Xn(/^html$/i),Mg=Xn(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ac=Object.freeze({__proto__:null,ARIA_ATTR:Ig,ATTR_WHITESPACE:Rg,CUSTOM_ELEMENT:Mg,DATA_ATTR:Pg,DOCTYPE_NAME:md,ERB_EXPR:Ag,IS_ALLOWED_URI:hd,IS_SCRIPT_OR_DATA:Og,MUSTACHE_EXPR:Eg,TMPLIT_EXPR:Cg});const ps={element:1,text:3,progressingInstruction:7,comment:8,document:9},Dg=function(){return typeof window>"u"?null:window},jg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Cc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function gd(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dg();const e=Fe=>gd(Fe);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==ps.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:g,NodeFilter:p,NamedNodeMap:b=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:w,DOMParser:k,trustedTypes:x}=t,O=g.prototype,z=vs(O,"cloneNode"),T=vs(O,"remove"),H=vs(O,"nextSibling"),fe=vs(O,"childNodes"),Q=vs(O,"parentNode");if(typeof u=="function"){const Fe=r.createElement("template");Fe.content&&Fe.content.ownerDocument&&(r=Fe.content.ownerDocument)}let M,Y="";const{implementation:Z,createNodeIterator:F,createDocumentFragment:oe,getElementsByTagName:xe}=r,{importNode:Ie}=a;let ve=Cc();e.isSupported=typeof pd=="function"&&typeof Q=="function"&&Z&&Z.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ee,ERB_EXPR:le,TMPLIT_EXPR:ke,DATA_ATTR:re,ARIA_ATTR:me,IS_SCRIPT_OR_DATA:Te,ATTR_WHITESPACE:se,CUSTOM_ELEMENT:pe}=Ac;let{IS_ALLOWED_URI:ae}=Ac,te=null;const he=rt({},[...xc,...co,...uo,...fo,...Sc]);let W=null;const J=rt({},[...Tc,...vo,...Ec,...ri]);let de=Object.seal(Do(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ce=null,Se=null;const Ke=Object.seal(Do(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ce=!0,C=!0,_e=!1,Ae=!0,Oe=!1,We=!0,Ze=!1,Qe=!1,ft=!1,wt=!1,at=!1,Ne=!1,Ge=!0,At=!1;const xt="user-content-";let Lt=!0,Wt=!1,Pt={},Nt=null;const Zn=rt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let An=null;const cr=rt({},["audio","video","img","source","image","track"]);let Cn=null;const fn=rt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_n="http://www.w3.org/1998/Math/MathML",Pn="http://www.w3.org/2000/svg",Rt="http://www.w3.org/1999/xhtml";let qe=Rt,vt=!1,nt=null;const qt=rt({},[_n,Pn,Rt],oo);let Ee=rt({},["mi","mo","mn","ms","mtext"]),vn=rt({},["annotation-xml"]);const ur=rt({},["title","style","font","a","script"]);let In=null;const Ia=["application/xhtml+xml","text/html"],Zr="text/html";let Ve=null,_t=null;const Yt=r.createElement("form"),Ht=function(P){return P instanceof RegExp||P instanceof Function},yt=function(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(_t&&_t===P)){if((!P||typeof P!="object")&&(P={}),P=pr(P),In=Ia.indexOf(P.PARSER_MEDIA_TYPE)===-1?Zr:P.PARSER_MEDIA_TYPE,Ve=In==="application/xhtml+xml"?oo:ui,te=er(P,"ALLOWED_TAGS")?rt({},P.ALLOWED_TAGS,Ve):he,W=er(P,"ALLOWED_ATTR")?rt({},P.ALLOWED_ATTR,Ve):J,nt=er(P,"ALLOWED_NAMESPACES")?rt({},P.ALLOWED_NAMESPACES,oo):qt,Cn=er(P,"ADD_URI_SAFE_ATTR")?rt(pr(fn),P.ADD_URI_SAFE_ATTR,Ve):fn,An=er(P,"ADD_DATA_URI_TAGS")?rt(pr(cr),P.ADD_DATA_URI_TAGS,Ve):cr,Nt=er(P,"FORBID_CONTENTS")?rt({},P.FORBID_CONTENTS,Ve):Zn,ce=er(P,"FORBID_TAGS")?rt({},P.FORBID_TAGS,Ve):pr({}),Se=er(P,"FORBID_ATTR")?rt({},P.FORBID_ATTR,Ve):pr({}),Pt=er(P,"USE_PROFILES")?P.USE_PROFILES:!1,Ce=P.ALLOW_ARIA_ATTR!==!1,C=P.ALLOW_DATA_ATTR!==!1,_e=P.ALLOW_UNKNOWN_PROTOCOLS||!1,Ae=P.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=P.SAFE_FOR_TEMPLATES||!1,We=P.SAFE_FOR_XML!==!1,Ze=P.WHOLE_DOCUMENT||!1,wt=P.RETURN_DOM||!1,at=P.RETURN_DOM_FRAGMENT||!1,Ne=P.RETURN_TRUSTED_TYPE||!1,ft=P.FORCE_BODY||!1,Ge=P.SANITIZE_DOM!==!1,At=P.SANITIZE_NAMED_PROPS||!1,Lt=P.KEEP_CONTENT!==!1,Wt=P.IN_PLACE||!1,ae=P.ALLOWED_URI_REGEXP||hd,qe=P.NAMESPACE||Rt,Ee=P.MATHML_TEXT_INTEGRATION_POINTS||Ee,vn=P.HTML_INTEGRATION_POINTS||vn,de=P.CUSTOM_ELEMENT_HANDLING||{},P.CUSTOM_ELEMENT_HANDLING&&Ht(P.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=P.CUSTOM_ELEMENT_HANDLING.tagNameCheck),P.CUSTOM_ELEMENT_HANDLING&&Ht(P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),P.CUSTOM_ELEMENT_HANDLING&&typeof P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(C=!1),at&&(wt=!0),Pt&&(te=rt({},Sc),W=[],Pt.html===!0&&(rt(te,xc),rt(W,Tc)),Pt.svg===!0&&(rt(te,co),rt(W,vo),rt(W,ri)),Pt.svgFilters===!0&&(rt(te,uo),rt(W,vo),rt(W,ri)),Pt.mathMl===!0&&(rt(te,fo),rt(W,Ec),rt(W,ri))),P.ADD_TAGS&&(typeof P.ADD_TAGS=="function"?Ke.tagCheck=P.ADD_TAGS:(te===he&&(te=pr(te)),rt(te,P.ADD_TAGS,Ve))),P.ADD_ATTR&&(typeof P.ADD_ATTR=="function"?Ke.attributeCheck=P.ADD_ATTR:(W===J&&(W=pr(W)),rt(W,P.ADD_ATTR,Ve))),P.ADD_URI_SAFE_ATTR&&rt(Cn,P.ADD_URI_SAFE_ATTR,Ve),P.FORBID_CONTENTS&&(Nt===Zn&&(Nt=pr(Nt)),rt(Nt,P.FORBID_CONTENTS,Ve)),P.ADD_FORBID_CONTENTS&&(Nt===Zn&&(Nt=pr(Nt)),rt(Nt,P.ADD_FORBID_CONTENTS,Ve)),Lt&&(te["#text"]=!0),Ze&&rt(te,["html","head","body"]),te.table&&(rt(te,["tbody"]),delete ce.tbody),P.TRUSTED_TYPES_POLICY){if(typeof P.TRUSTED_TYPES_POLICY.createHTML!="function")throw fs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof P.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw fs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');M=P.TRUSTED_TYPES_POLICY,Y=M.createHTML("")}else M===void 0&&(M=jg(x,i)),M!==null&&typeof Y=="string"&&(Y=M.createHTML(""));mn&&mn(P),_t=P}},On=rt({},[...co,...uo,...Sg]),ht=rt({},[...fo,...Tg]),It=function(P){let we=Q(P);(!we||!we.tagName)&&(we={namespaceURI:qe,tagName:"template"});const ge=ui(P.tagName),Ye=ui(we.tagName);return nt[P.namespaceURI]?P.namespaceURI===Pn?we.namespaceURI===Rt?ge==="svg":we.namespaceURI===_n?ge==="svg"&&(Ye==="annotation-xml"||Ee[Ye]):!!On[ge]:P.namespaceURI===_n?we.namespaceURI===Rt?ge==="math":we.namespaceURI===Pn?ge==="math"&&vn[Ye]:!!ht[ge]:P.namespaceURI===Rt?we.namespaceURI===Pn&&!vn[Ye]||we.namespaceURI===_n&&!Ee[Ye]?!1:!ht[ge]&&(ur[ge]||!On[ge]):!!(In==="application/xhtml+xml"&&nt[P.namespaceURI]):!1},Qt=function(P){us(e.removed,{element:P});try{Q(P).removeChild(P)}catch{T(P)}},yn=function(P,we){try{us(e.removed,{attribute:we.getAttributeNode(P),from:we})}catch{us(e.removed,{attribute:null,from:we})}if(we.removeAttribute(P),P==="is")if(wt||at)try{Qt(we)}catch{}else try{we.setAttribute(P,"")}catch{}},xr=function(P){let we=null,ge=null;if(ft)P="<remove></remove>"+P;else{const St=lo(P,/^[\r\n\t ]+/);ge=St&&St[0]}In==="application/xhtml+xml"&&qe===Rt&&(P='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+P+"</body></html>");const Ye=M?M.createHTML(P):P;if(qe===Rt)try{we=new k().parseFromString(Ye,In)}catch{}if(!we||!we.documentElement){we=Z.createDocument(qe,"template",null);try{we.documentElement.innerHTML=vt?Y:Ye}catch{}}const st=we.body||we.documentElement;return P&&ge&&st.insertBefore(r.createTextNode(ge),st.childNodes[0]||null),qe===Rt?xe.call(we,Ze?"html":"body")[0]:Ze?we.documentElement:st},Sr=function(P){return F.call(P.ownerDocument||P,P,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},Jr=function(P){return P instanceof w&&(typeof P.nodeName!="string"||typeof P.textContent!="string"||typeof P.removeChild!="function"||!(P.attributes instanceof b)||typeof P.removeAttribute!="function"||typeof P.setAttribute!="function"||typeof P.namespaceURI!="string"||typeof P.insertBefore!="function"||typeof P.hasChildNodes!="function")},bn=function(P){return typeof d=="function"&&P instanceof d};function Vt(Fe,P,we){ni(Fe,ge=>{ge.call(e,P,we,_t)})}const Rn=function(P){let we=null;if(Vt(ve.beforeSanitizeElements,P,null),Jr(P))return Qt(P),!0;const ge=Ve(P.nodeName);if(Vt(ve.uponSanitizeElement,P,{tagName:ge,allowedTags:te}),We&&P.hasChildNodes()&&!bn(P.firstElementChild)&&pn(/<[/\w!]/g,P.innerHTML)&&pn(/<[/\w!]/g,P.textContent)||P.nodeType===ps.progressingInstruction||We&&P.nodeType===ps.comment&&pn(/<[/\w]/g,P.data))return Qt(P),!0;if(!(Ke.tagCheck instanceof Function&&Ke.tagCheck(ge))&&(!te[ge]||ce[ge])){if(!ce[ge]&&$r(ge)&&(de.tagNameCheck instanceof RegExp&&pn(de.tagNameCheck,ge)||de.tagNameCheck instanceof Function&&de.tagNameCheck(ge)))return!1;if(Lt&&!Nt[ge]){const Ye=Q(P)||P.parentNode,st=fe(P)||P.childNodes;if(st&&Ye){const St=st.length;for(let Mt=St-1;Mt>=0;--Mt){const sn=z(st[Mt],!0);sn.__removalCount=(P.__removalCount||0)+1,Ye.insertBefore(sn,H(P))}}}return Qt(P),!0}return P instanceof g&&!It(P)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&pn(/<\/no(script|embed|frames)/i,P.innerHTML)?(Qt(P),!0):(Oe&&P.nodeType===ps.text&&(we=P.textContent,ni([ee,le,ke],Ye=>{we=ds(we,Ye," ")}),P.textContent!==we&&(us(e.removed,{element:P.cloneNode()}),P.textContent=we)),Vt(ve.afterSanitizeElements,P,null),!1)},Tr=function(P,we,ge){if(Ge&&(we==="id"||we==="name")&&(ge in r||ge in Yt))return!1;if(!(C&&!Se[we]&&pn(re,we))){if(!(Ce&&pn(me,we))){if(!(Ke.attributeCheck instanceof Function&&Ke.attributeCheck(we,P))){if(!W[we]||Se[we]){if(!($r(P)&&(de.tagNameCheck instanceof RegExp&&pn(de.tagNameCheck,P)||de.tagNameCheck instanceof Function&&de.tagNameCheck(P))&&(de.attributeNameCheck instanceof RegExp&&pn(de.attributeNameCheck,we)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(we,P))||we==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&pn(de.tagNameCheck,ge)||de.tagNameCheck instanceof Function&&de.tagNameCheck(ge))))return!1}else if(!Cn[we]){if(!pn(ae,ds(ge,se,""))){if(!((we==="src"||we==="xlink:href"||we==="href")&&P!=="script"&&bg(ge,"data:")===0&&An[P])){if(!(_e&&!pn(Te,ds(ge,se,"")))){if(ge)return!1}}}}}}}return!0},$r=function(P){return P!=="annotation-xml"&&lo(P,pe)},Mn=function(P){Vt(ve.beforeSanitizeAttributes,P,null);const{attributes:we}=P;if(!we||Jr(P))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W,forceKeepAttr:void 0};let Ye=we.length;for(;Ye--;){const st=we[Ye],{name:St,namespaceURI:Mt,value:sn}=st,on=Ve(St),dr=sn;let Ct=St==="value"?dr:wg(dr);if(ge.attrName=on,ge.attrValue=Ct,ge.keepAttr=!0,ge.forceKeepAttr=void 0,Vt(ve.uponSanitizeAttribute,P,ge),Ct=ge.attrValue,At&&(on==="id"||on==="name")&&(yn(St,P),Ct=xt+Ct),We&&pn(/((--!?|])>)|<\/(style|title|textarea)/i,Ct)){yn(St,P);continue}if(on==="attributename"&&lo(Ct,"href")){yn(St,P);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){yn(St,P);continue}if(!Ae&&pn(/\/>/i,Ct)){yn(St,P);continue}Oe&&ni([ee,le,ke],na=>{Ct=ds(Ct,na," ")});const ta=Ve(P.nodeName);if(!Tr(ta,on,Ct)){yn(St,P);continue}if(M&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!Mt)switch(x.getAttributeType(ta,on)){case"TrustedHTML":{Ct=M.createHTML(Ct);break}case"TrustedScriptURL":{Ct=M.createScriptURL(Ct);break}}if(Ct!==dr)try{Mt?P.setAttributeNS(Mt,St,Ct):P.setAttribute(St,Ct),Jr(P)?Qt(P):kc(e.removed)}catch{yn(St,P)}}Vt(ve.afterSanitizeAttributes,P,null)},ea=function Fe(P){let we=null;const ge=Sr(P);for(Vt(ve.beforeSanitizeShadowDOM,P,null);we=ge.nextNode();)Vt(ve.uponSanitizeShadowNode,we,null),Rn(we),Mn(we),we.content instanceof o&&Fe(we.content);Vt(ve.afterSanitizeShadowDOM,P,null)};return e.sanitize=function(Fe){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we=null,ge=null,Ye=null,st=null;if(vt=!Fe,vt&&(Fe="<!-->"),typeof Fe!="string"&&!bn(Fe))if(typeof Fe.toString=="function"){if(Fe=Fe.toString(),typeof Fe!="string")throw fs("dirty is not a string, aborting")}else throw fs("toString is not a function");if(!e.isSupported)return Fe;if(Qe||yt(P),e.removed=[],typeof Fe=="string"&&(Wt=!1),Wt){if(Fe.nodeName){const sn=Ve(Fe.nodeName);if(!te[sn]||ce[sn])throw fs("root node is forbidden and cannot be sanitized in-place")}}else if(Fe instanceof d)we=xr("<!---->"),ge=we.ownerDocument.importNode(Fe,!0),ge.nodeType===ps.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?we=ge:we.appendChild(ge);else{if(!wt&&!Oe&&!Ze&&Fe.indexOf("<")===-1)return M&&Ne?M.createHTML(Fe):Fe;if(we=xr(Fe),!we)return wt?null:Ne?Y:""}we&&ft&&Qt(we.firstChild);const St=Sr(Wt?Fe:we);for(;Ye=St.nextNode();)Rn(Ye),Mn(Ye),Ye.content instanceof o&&ea(Ye.content);if(Wt)return Fe;if(wt){if(at)for(st=oe.call(we.ownerDocument);we.firstChild;)st.appendChild(we.firstChild);else st=we;return(W.shadowroot||W.shadowrootmode)&&(st=Ie.call(a,st,!0)),st}let Mt=Ze?we.outerHTML:we.innerHTML;return Ze&&te["!doctype"]&&we.ownerDocument&&we.ownerDocument.doctype&&we.ownerDocument.doctype.name&&pn(md,we.ownerDocument.doctype.name)&&(Mt="<!DOCTYPE "+we.ownerDocument.doctype.name+`>
`+Mt),Oe&&ni([ee,le,ke],sn=>{Mt=ds(Mt,sn," ")}),M&&Ne?M.createHTML(Mt):Mt},e.setConfig=function(){let Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yt(Fe),Qe=!0},e.clearConfig=function(){_t=null,Qe=!1},e.isValidAttribute=function(Fe,P,we){_t||yt({});const ge=Ve(Fe),Ye=Ve(P);return Tr(ge,Ye,we)},e.addHook=function(Fe,P){typeof P=="function"&&us(ve[Fe],P)},e.removeHook=function(Fe,P){if(P!==void 0){const we=_g(ve[Fe],P);return we===-1?void 0:yg(ve[Fe],we,1)[0]}return kc(ve[Fe])},e.removeHooks=function(Fe){ve[Fe]=[]},e.removeAllHooks=function(){ve=Cc()},e}var Lg=gd();function Ng(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${Pc(t.from)} |`),e.push(`| **To** | ${Pc(t.to)} |`),e.push(`| **Date** | ${el(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?qg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function Pc(t){return(t||"").replace(/\|/g,"\\|")}function qg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return No(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Bg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function No(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Bg(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(No).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>No(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function zg(t){return Fu(t,"md")}function Ic(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Fg(t){return t.raw||null}function Kg(t){const e=Fg(t);return e?JSON.stringify(e,null,2):"null"}function Ug(t){return Fu(t,"json")}var Gg=N('<button title="View as Markdown">.md</button>'),Wg=N('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Hg=N('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Vg=N('<div class="md-preview svelte-1b0rzpb"><!></div>'),Yg=N('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Qg=N('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Xg=N('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Zg=N('<pre class="message-text svelte-1b0rzpb"> </pre>'),Jg=N('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),$g=N('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),e_=N('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function t_(t,e){Tt(e,!0);let r=je(e,"loading",3,!1);an(()=>Fn("MessageModal"));const a=new bt.Renderer;a.link=({href:ee,title:le,text:ke})=>{const re=le?` title="${le}"`:"";return`<a href="${ee}"${re} target="_blank" rel="noopener">${ke}</a>`},bt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=De("email"),o=pt(()=>e.message.body?Ng(e.message):""),u=pt(()=>Kg(e.message)),d=De("raw");function g(ee){A(i,v(i)===ee?"email":ee,!0),ee==="markdown"&&A(d,"raw")}function p(){Ic(v(o),zg(e.message))}function b(){Ic(v(u),Ug(e.message),"application/json;charset=utf-8")}function w(ee){const le=bt.parse(ee);return Lg.sanitize(le,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let k=De(null);Sa(()=>{var ee;if(v(k)&&e.message.htmlBody&&!r()&&v(i)==="email"){const le=v(k).contentDocument||((ee=v(k).contentWindow)==null?void 0:ee.document);le&&(le.open(),le.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),le.close())}});var x=e_();x.__click=function(...ee){var le;(le=e.onclose)==null||le.apply(this,ee)};var O=m(x);O.__click=ee=>ee.stopPropagation();var z=m(O),T=m(z),H=m(T),fe=_(T,2),Q=m(fe);let M;Q.__click=()=>g("json");var Y=_(Q,2);{var Z=ee=>{var le=Gg();let ke;le.__click=()=>g("markdown"),$(()=>ke=jt(le,1,"action-btn svelte-1b0rzpb",null,ke,{active:v(i)==="markdown"})),E(ee,le)};ne(Y,ee=>{e.message.body&&ee(Z)})}var F=_(Y,2);F.__click=function(...ee){var le;(le=e.onclose)==null||le.apply(this,ee)};var oe=_(z,2);{var xe=ee=>{var le=Wg(),ke=Xe(le),re=_(m(ke),2);re.__click=b;var me=_(ke,2),Te=m(me),se=m(Te);$(()=>K(se,v(u))),E(ee,le)},Ie=ee=>{var le=Yg(),ke=Xe(le),re=m(ke),me=m(re);let Te;me.__click=()=>A(d,"raw");var se=_(me,2);let pe;se.__click=()=>A(d,"preview");var ae=_(re,2);ae.__click=p;var te=_(ke,2),he=m(te);{var W=de=>{var ce=Hg(),Se=m(ce);$(()=>K(Se,v(o))),E(de,ce)},J=de=>{var ce=Vg(),Se=m(ce);cv(Se,()=>w(v(o))),E(de,ce)};ne(he,de=>{v(d)==="raw"?de(W):de(J,!1)})}$(()=>{Te=jt(me,1,"md-tab svelte-1b0rzpb",null,Te,{active:v(d)==="raw"}),pe=jt(se,1,"md-tab svelte-1b0rzpb",null,pe,{active:v(d)==="preview"})}),E(ee,le)},ve=ee=>{var le=$g(),ke=Xe(le),re=m(ke),me=_(m(re),2),Te=m(me),se=_(re,2),pe=_(m(se),2),ae=m(pe),te=_(se,2),he=_(m(te),2),W=m(he),J=_(ke,2),de=m(J);{var ce=C=>{var _e=Qg();E(C,_e)},Se=C=>{var _e=Xg();Ou(_e,Ae=>A(k,Ae),()=>v(k)),E(C,_e)},Ke=C=>{var _e=Zg(),Ae=m(_e);$(()=>K(Ae,e.message.body)),E(C,_e)},Ce=C=>{var _e=Jg();E(C,_e)};ne(de,C=>{r()?C(ce):e.message.htmlBody?C(Se,1):e.message.body?C(Ke,2):C(Ce,!1)})}$(C=>{K(Te,e.message.from),K(ae,e.message.to),K(W,C)},[()=>el(e.message.date)]),E(ee,le)};ne(oe,ee=>{v(i)==="json"?ee(xe):v(i)==="markdown"?ee(Ie,1):ee(ve,!1)})}$(()=>{K(H,e.message.subject),M=jt(Q,1,"action-btn svelte-1b0rzpb",null,M,{active:v(i)==="json"})}),E(t,x),Et()}Gt(["click"]);var n_=N('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),r_=N('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),a_=N('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),s_=N("<p> </p>"),i_=N('<p>No emails in local storage. Click "Sync New" to download.</p>'),o_=N('<div class="empty-state svelte-6ts5xm"><!></div>'),l_=N('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),c_=N('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function u_(t,e){Tt(e,!0),an(()=>Fn("DashboardView"));let r=je(e,"error",3,null),a=je(e,"profile",3,null),i=je(e,"loadingProfile",3,!1),o=je(e,"emailMessages",19,()=>[]),u=je(e,"totalLocalMessages",3,0),d=je(e,"hasMoreLocal",3,!1),g=je(e,"loadingMessages",3,!1),p=je(e,"selectedMessage",3,null),b=je(e,"syncStatus",3,null),w=je(e,"syncProgress",3,null),k=je(e,"isSyncing",3,!1),x=je(e,"searchQuery",15);var O=c_(),z=Xe(O),T=m(z);{var H=re=>{td(re,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};ne(T,re=>{r()&&re(H)})}var fe=_(T,2);cm(fe,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var Q=_(fe,2);km(Q,{get syncStatus(){return b()},get syncProgress(){return w()},get isSyncing(){return k()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var M=_(Q,2),Y=m(M);Y.__keydown=re=>re.key==="Enter"&&e.onsearch();var Z=_(Y,2);Z.__click=function(...re){var me;(me=e.onsearch)==null||me.apply(this,re)};var F=m(Z),oe=_(M,2);{var xe=re=>{var me=r_(),Te=Xe(me),se=m(Te),pe=m(se),ae=_(Te,2);Tm(ae,{get messages(){return o()},get onselect(){return e.onviewmessage}});var te=_(ae,2);{var he=W=>{var J=n_(),de=m(J);de.__click=function(...Se){var Ke;(Ke=e.onloadmore)==null||Ke.apply(this,Se)};var ce=m(de);$(()=>{de.disabled=g(),K(ce,g()?"Loading...":"Load More")}),E(W,J)};ne(te,W=>{d()&&W(he)})}$(W=>K(pe,`Showing ${o().length??""} of ${W??""}
        ${x()?" matching":""} emails`),[()=>u().toLocaleString()]),E(re,me)},Ie=re=>{var me=a_();E(re,me)},ve=re=>{var me=o_(),Te=m(me);{var se=ae=>{var te=s_(),he=m(te);$(()=>K(he,`No emails match "${x()??""}".`)),E(ae,te)},pe=ae=>{var te=i_();E(ae,te)};ne(Te,ae=>{x()?ae(se):ae(pe,!1)})}E(re,me)},ee=re=>{var me=l_();E(re,me)};ne(oe,re=>{var me;o().length>0?re(xe):g()?re(Ie,1):(me=b())!=null&&me.synced?re(ve,2):re(ee,!1)})}var le=_(z,2);{var ke=re=>{t_(re,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};ne(le,re=>{p()&&re(ke)})}$(()=>{Z.disabled=g(),K(F,g()?"Searching...":"Search")}),Si(Y,x),E(t,O),Et()}Gt(["keydown","click"]);var d_=N('<div class="dashboard svelte-1q5o2lv"><!></div>');function f_(t,e){Tt(e,!0);function r(C){C.key==="Escape"&&v(w)&&ae()}let a=null;an(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const C=Lh();if(C<=0)return;const _e=Math.max(0,C-120*1e3);a=setTimeout(async()=>{try{const Ae=await fc();A(p,Ae.access_token,!0),i()}catch{A(p,null),A(b,null),A(Q,"Session expired. Please sign in again.")}},_e)}async function o(){if(jh())return v(p);try{const C=await fc();return A(p,C.access_token,!0),i(),v(p)}catch{return A(p,null),A(b,null),A(Q,"Session expired. Please sign in again."),null}}let u=De(Kt(localStorage.getItem("googleClientId")||"")),d=De(Kt(localStorage.getItem("googleClientId")||"")),g=De(!1),p=De(null),b=De(null),w=De(null),k=De(""),x=De(Kt([])),O=De(0),z=De(0),T=De(!1),H=De(!1),fe=De(!1),Q=De(null),M=De(null),Y=De(null),Z=De(!1);const F=50;Sa(()=>{v(p)&&(te(),me())});let oe=pt(()=>!v(u)),xe=pt(()=>!!v(p)),Ie=pt(()=>v(x).length<v(O));Sa(()=>{v(u)&&!v(g)&&vc(v(u)).then(()=>{if(A(g,!0),!v(p)){const C=Dh();C&&(A(p,C.access_token,!0),i(),re())}}).catch(C=>{A(Q,`Auth init failed: ${C.message}`)})});function ve(){const C=v(d).trim();C&&(localStorage.setItem("googleClientId",C),A(u,C,!0),A(Q,null))}function ee(){localStorage.removeItem("googleClientId"),A(u,""),A(d,""),A(g,!1),A(p,null),A(b,null),A(x,[],!0),A(O,0)}async function le(){A(Q,null),A(H,!0);try{v(g)||(await vc(v(u)),A(g,!0));const C=await qh();A(p,C.access_token,!0),i(),await re()}catch(C){A(Q,C.message,!0)}finally{A(H,!1)}}async function ke(){if(a&&clearTimeout(a),v(p))try{await Bh(v(p))}catch{}A(p,null),A(b,null),A(x,[],!0),A(O,0),A(w,null),A(Q,null)}async function re(){A(fe,!0);try{const C=await Lu(v(p));if(!v(p))return;A(b,C,!0)}catch(C){if(!v(p))return;A(Q,`Profile fetch failed: ${C.message}`)}finally{A(fe,!1)}}async function me(C=!1){A(T,!0);try{const _e=C?v(z):0,Ae=await Wv({query:v(k)||void 0,limit:F,offset:_e});C?A(x,[...v(x),...Ae.items],!0):A(x,Ae.items,!0),A(O,Ae.total,!0),A(z,v(x).length,!0)}catch(_e){A(Q,`Failed to load messages: ${_e.message}`)}finally{A(T,!1)}}function Te(){A(z,0),me(!1)}function se(){me(!0)}function pe(C){A(w,C,!0)}function ae(){A(w,null)}async function te(){try{A(M,await Kh(),!0)}catch{}}async function he(C){if(v(Z)||!v(p))return;const _e=await o();if(!_e)return;A(Q,null),A(Z,!0),A(Y,null);const Ae=new AbortController;try{await zh(_e,{limit:C,onProgress:Oe=>{A(Y,{...Oe},!0)},signal:Ae.signal}),await te(),await me(!1)}catch(Oe){if(Oe.name!=="AbortError"){if(!v(p))return;A(Q,`Sync failed: ${Oe.message}`)}}finally{A(Z,!1)}}async function W(C){if(v(Z)||!v(p))return;const _e=await o();if(!_e)return;A(Q,null),A(Z,!0),A(Y,null);const Ae=new AbortController;try{await Fh(_e,{limit:C,onProgress:Oe=>{A(Y,{...Oe},!0)},signal:Ae.signal}),await te(),await me(!1)}catch(Oe){if(Oe.name!=="AbortError"){if(!v(p))return;A(Q,`Sync more failed: ${Oe.message}`)}}finally{A(Z,!1)}}async function J(){try{await Zu(),await te(),A(x,[],!0),A(O,0),A(z,0)}catch(C){A(Q,`Failed to clear data: ${C.message}`)}}var de=d_(),ce=m(de);{var Se=C=>{Yh(C,{onsave:ve,get clientIdInput(){return v(d)},set clientIdInput(_e){A(d,_e,!0)}})},Ke=C=>{sm(C,{get clientId(){return v(u)},get error(){return v(Q)},get loadingAuth(){return v(H)},onsignin:le,onclear:ee,onsignout:ke})},Ce=C=>{u_(C,{get error(){return v(Q)},get profile(){return v(b)},get loadingProfile(){return v(fe)},get emailMessages(){return v(x)},get totalLocalMessages(){return v(O)},get hasMoreLocal(){return v(Ie)},get loadingMessages(){return v(T)},get selectedMessage(){return v(w)},get syncStatus(){return v(M)},get syncProgress(){return v(Y)},get isSyncing(){return v(Z)},onsignout:ke,onsearch:Te,onloadmore:se,onviewmessage:pe,onclosedetail:ae,ondismisserror:()=>A(Q,null),onsync:he,onsyncmore:W,oncleardata:J,get searchQuery(){return v(k)},set searchQuery(_e){A(k,_e,!0)}})};ne(ce,C=>{v(oe)?C(Se):v(xe)?C(Ce,!1):C(Ke,1)})}E(t,de),Et()}var v_=N('<span class="sep svelte-t1ig66">Â·</span> ',1),p_=N('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),h_=N('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),m_=N('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),g_=N('<span class="llm-stream-badge svelte-t1ig66">Live</span>'),__=N('<div class="llm-stream-box svelte-t1ig66"><div class="llm-stream-header svelte-t1ig66"><span class="llm-stream-label svelte-t1ig66"><!></span> <!></div> <div class="llm-output-content svelte-t1ig66"> </div></div>'),y_=N('<span class="sep svelte-t1ig66">Â·</span> ',1),b_=N('<div class="pi-summary svelte-t1ig66"> </div>'),w_=N('<span class="pi-tag svelte-t1ig66"> </span>'),k_=N('<div class="pi-tags svelte-t1ig66"></div>'),x_=N('<div class="pi-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),S_=N('<details class="pi-llm-details svelte-t1ig66"><summary class="pi-llm-toggle svelte-t1ig66">View raw LLM output</summary> <div class="llm-output-content svelte-t1ig66"> </div></details>'),T_=N('<div class="processed-item svelte-t1ig66"><div class="pi-head svelte-t1ig66"><span class="pi-index svelte-t1ig66"> </span> <span class="pi-subj svelte-t1ig66"> </span> <span class="pi-action svelte-t1ig66"> </span></div> <div class="pi-meta svelte-t1ig66"> <!></div> <!> <!> <!> <!></div>'),E_=N('<div class="processed-list svelte-t1ig66"><div class="processed-header svelte-t1ig66"><span class="processed-title svelte-t1ig66">Processed Emails</span> <span class="processed-count svelte-t1ig66"> </span></div> <!></div>'),A_=N('<div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">already classified</span></div>'),C_=N('<div class="summary-stat svelte-t1ig66"><span class="sstat-val err svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">errors</span></div>'),P_=N('<span class="ssec-item svelte-t1ig66">Avg speed: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span>',1),I_=N('<span class="pi-action svelte-t1ig66"> </span>'),O_=N('<span class="pi-action error svelte-t1ig66">ERROR</span>'),R_=N('<span class="sep svelte-t1ig66">Â·</span> ',1),M_=N('<div class="pi-summary svelte-t1ig66"> </div>'),D_=N('<span class="sep svelte-t1ig66">Â·</span> ',1),j_=N('<div class="pi-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <!></div>'),L_=N('<div class="pi-error-msg svelte-t1ig66"> </div>'),N_=N('<div><div class="pi-head svelte-t1ig66"><span class="pi-subj svelte-t1ig66"> </span> <!></div> <div class="pi-meta svelte-t1ig66"> <!></div> <!> <!> <!></div>'),q_=N('<div class="results-section svelte-t1ig66"><div class="results-section-title svelte-t1ig66">Email results</div> <div class="results-list svelte-t1ig66"></div></div>'),B_=N('<div class="summary-card svelte-t1ig66"><div class="summary-head svelte-t1ig66"><span class="summary-title svelte-t1ig66">Scan Summary</span></div> <div class="summary-grid svelte-t1ig66"><div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">emails processed</span></div> <!> <div class="summary-stat svelte-t1ig66"><span class="sstat-val success svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">classified</span></div> <!></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">LLM Performance</div> <div class="ssec-items svelte-t1ig66"><!> <span class="ssec-item svelte-t1ig66">Total tokens: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Duration: <strong class="svelte-t1ig66"> </strong></span></div></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">Model & Prompts</div> <div class="ssec-items svelte-t1ig66"><span class="ssec-item svelte-t1ig66">Model: <strong class="svelte-t1ig66"> </strong> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">System prompt: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Avg email: <strong class="svelte-t1ig66"> </strong></span></div></div> <!></div>'),z_=N('<span class="err svelte-t1ig66"> </span>'),F_=N('<div class="totals svelte-t1ig66"><span class="svelte-t1ig66"> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span class="svelte-t1ig66"> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="svelte-t1ig66"> </span></div>'),K_=N('<button class="action-btn svelte-t1ig66">View Prompt Config</button> <button class="action-btn primary svelte-t1ig66">Close</button>',1),U_=N('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),G_=N('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div>');function W_(t,e){Tt(e,!0);let r=je(e,"progress",3,null),a=De(Kt([])),i=De(-1);Sa(()=>{if(!r()){A(a,[],!0),A(i,-1);return}r().phase==="loading"&&(A(a,[],!0),A(i,-1)),r().phase==="classified"&&r().current!==v(i)&&(A(a,[...v(a),{index:r().current,email:r().email,result:r().result,rawResponse:r().rawResponse||"",stats:r().emailStats}],!0),A(i,r().current,!0))});function o(T){return!T||T<0?"â":T<1e3?`${Math.round(T)}ms`:`${(T/1e3).toFixed(1)}s`}function u(T){return T?T>=1e3?`${(T/1e3).toFixed(1)}k`:String(T):"0"}function d(T){if(!T)return"â";const H=T.replace(/<.*>/,"").trim();return H.length>30?H.slice(0,28)+"â¦":H}function g(T){if(!T)return"";try{return new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function p(T){var Q;if(!((Q=T==null?void 0:T.totals)!=null&&Q.elapsed)||!(T!=null&&T.current)||T.current<2)return null;const H=T.totals.elapsed/T.current;return(T.total-T.current)*H}let b=pt(()=>{var T;return(T=r())!=null&&T.total?Math.round(r().current/r().total*100):0}),w=pt(()=>p(r())),k=pt(()=>{var T;return((T=r())==null?void 0:T.phase)==="done"});var x=wr(),O=Xe(x);{var z=T=>{var H=G_(),fe=m(H),Q=m(fe),M=m(Q);{var Y=Ce=>{var C=Or("Scan complete");E(Ce,C)},Z=Ce=>{var C=Or("Loading emails...");E(Ce,C)},F=Ce=>{var C=Or();$(()=>K(C,`Processing ${r().current??0??""} of ${r().total??0??""}`)),E(Ce,C)};ne(M,Ce=>{v(k)?Ce(Y):r().phase==="loading"?Ce(Z,1):Ce(F,!1)})}var oe=_(Q,2),xe=m(oe),Ie=_(fe,2),ve=m(Ie);let ee,le;var ke=_(Ie,2);{var re=Ce=>{var C=p_(),_e=m(C),Ae=m(_e),Oe=_(_e,2),We=m(Oe),Ze=_(We);{var Qe=ft=>{var wt=v_(),at=_(Xe(wt),1,!0);$(Ne=>K(at,Ne),[()=>g(r().email.date)]),E(ft,wt)};ne(Ze,ft=>{r().email.date&&ft(Qe)})}$(ft=>{K(Ae,r().email.subject||"(no subject)"),K(We,`${ft??""} `)},[()=>d(r().email.from)]),E(Ce,C)};ne(ke,Ce=>{r().email&&!v(k)&&Ce(re)})}var me=_(ke,2);{var Te=Ce=>{var C=m_(),_e=m(C),Ae=m(_e),Oe=m(Ae),We=_(_e,2),Ze=m(We),Qe=m(Ze),ft=_(We,2);{var wt=at=>{var Ne=h_(),Ge=m(Ne),At=m(Ge);$(xt=>K(At,`~${xt??""}`),[()=>o(v(w))]),E(at,Ne)};ne(ft,at=>{v(w)&&at(wt)})}$(at=>{K(Oe,at),K(Qe,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),E(Ce,C)};ne(me,Ce=>{r().live&&r().phase==="generating"&&Ce(Te)})}var se=_(me,2);{var pe=Ce=>{var C=__(),_e=m(C),Ae=m(_e),Oe=m(Ae);{var We=Ne=>{var Ge=Or("LLM Output");E(Ne,Ge)},Ze=Ne=>{var Ge=Or("Sending to modelâ¦");E(Ne,Ge)};ne(Oe,Ne=>{r().phase==="generating"?Ne(We):Ne(Ze,!1)})}var Qe=_(Ae,2);{var ft=Ne=>{var Ge=g_();E(Ne,Ge)};ne(Qe,Ne=>{r().phase==="generating"&&Ne(ft)})}var wt=_(_e,2),at=m(wt);$(()=>K(at,r().streamingText||"Waiting for modelâ¦")),E(Ce,C)};ne(se,Ce=>{!v(k)&&(r().phase==="generating"||r().phase==="scanning")&&r().email&&Ce(pe)})}var ae=_(se,2);{var te=Ce=>{var C=E_(),_e=m(C),Ae=_(m(_e),2),Oe=m(Ae),We=_(_e,2);Ut(We,17,()=>v(a),dn,(Ze,Qe)=>{var ft=T_(),wt=m(ft),at=m(wt),Ne=m(at),Ge=_(at,2),At=m(Ge),xt=_(Ge,2),Lt=m(xt),Wt=_(wt,2),Pt=m(Wt),Nt=_(Pt);{var Zn=vt=>{var nt=y_(),qt=_(Xe(nt),1,!0);$(Ee=>K(qt,Ee),[()=>g(v(Qe).email.date)]),E(vt,nt)};ne(Nt,vt=>{v(Qe).email.date&&vt(Zn)})}var An=_(Wt,2);{var cr=vt=>{var nt=b_(),qt=m(nt);$(()=>K(qt,v(Qe).result.summary)),E(vt,nt)};ne(An,vt=>{var nt;(nt=v(Qe).result)!=null&&nt.summary&&vt(cr)})}var Cn=_(An,2);{var fn=vt=>{var nt=k_();Ut(nt,21,()=>v(Qe).result.tags,dn,(qt,Ee)=>{var vn=w_(),ur=m(vn);$(()=>K(ur,v(Ee))),E(qt,vn)}),E(vt,nt)};ne(Cn,vt=>{var nt,qt;(qt=(nt=v(Qe).result)==null?void 0:nt.tags)!=null&&qt.length&&vt(fn)})}var _n=_(Cn,2);{var Pn=vt=>{var nt=x_(),qt=m(nt),Ee=_(qt,2),vn=_(Ee,2);$((ur,In)=>{K(qt,`${ur??""} `),K(Ee,` ${(v(Qe).stats.inputTokens||0)??""} in + ${(v(Qe).stats.numTokens||0)??""} out tokens `),K(vn,` ${In??""}`)},[()=>v(Qe).stats.tps?`${v(Qe).stats.tps.toFixed(0)} tok/s`:"",()=>o(v(Qe).stats.elapsed)]),E(vt,nt)};ne(_n,vt=>{v(Qe).stats&&vt(Pn)})}var Rt=_(_n,2);{var qe=vt=>{var nt=S_(),qt=_(m(nt),2),Ee=m(qt);$(()=>K(Ee,v(Qe).rawResponse)),E(vt,nt)};ne(Rt,vt=>{v(Qe).rawResponse&&vt(qe)})}$(vt=>{var nt;K(Ne,`#${v(Qe).index??""}`),K(At,v(Qe).email.subject||"(no subject)"),K(Lt,((nt=v(Qe).result)==null?void 0:nt.action)||"â"),K(Pt,`${vt??""} `)},[()=>d(v(Qe).email.from)]),E(Ze,ft)}),$(()=>K(Oe,`${v(a).length??""}${r().total?` / ${r().total}`:""}`)),E(Ce,C)};ne(ae,Ce=>{v(a).length>0&&Ce(te)})}var he=_(ae,2);{var W=Ce=>{var C=B_(),_e=_(m(C),2),Ae=m(_e),Oe=m(Ae),We=m(Oe),Ze=_(Ae,2);{var Qe=Ve=>{var _t=A_(),Yt=m(_t),Ht=m(Yt);$(()=>K(Ht,r().summary.skipped)),E(Ve,_t)};ne(Ze,Ve=>{var _t;(_t=r().summary)!=null&&_t.skipped&&Ve(Qe)})}var ft=_(Ze,2),wt=m(ft),at=m(wt),Ne=_(ft,2);{var Ge=Ve=>{var _t=C_(),Yt=m(_t),Ht=m(Yt);$(()=>K(Ht,r().errors)),E(Ve,_t)};ne(Ne,Ve=>{r().errors>0&&Ve(Ge)})}var At=_(_e,2),xt=_(m(At),2),Lt=m(xt);{var Wt=Ve=>{var _t=P_(),Yt=Xe(_t),Ht=_(m(Yt)),yt=m(Ht);$(()=>K(yt,`${r().summary.avgTps??""} tok/s`)),E(Ve,_t)};ne(Lt,Ve=>{var _t;(_t=r().summary)!=null&&_t.avgTps&&Ve(Wt)})}var Pt=_(Lt,2),Nt=_(m(Pt)),Zn=m(Nt),An=_(Pt,4),cr=_(m(An)),Cn=m(cr),fn=_(At,2),_n=_(m(fn),2),Pn=m(_n),Rt=_(m(Pn)),qe=m(Rt),vt=_(Rt),nt=_(Pn,4),qt=_(m(nt)),Ee=m(qt),vn=_(nt,4),ur=_(m(vn)),In=m(ur),Ia=_(fn,2);{var Zr=Ve=>{var _t=q_(),Yt=_(m(_t),2);Ut(Yt,21,()=>r().results,dn,(Ht,yt)=>{var On=N_();let ht;var It=m(On),Qt=m(It),yn=m(Qt),xr=_(Qt,2);{var Sr=ge=>{var Ye=I_(),st=m(Ye);$(()=>K(st,v(yt).classification.action)),E(ge,Ye)},Jr=ge=>{var Ye=O_();E(ge,Ye)};ne(xr,ge=>{v(yt).success?ge(Sr):ge(Jr,!1)})}var bn=_(It,2),Vt=m(bn),Rn=_(Vt);{var Tr=ge=>{var Ye=R_(),st=_(Xe(Ye),1,!0);$(St=>K(st,St),[()=>g(v(yt).email.date)]),E(ge,Ye)};ne(Rn,ge=>{v(yt).email.date&&ge(Tr)})}var $r=_(bn,2);{var Mn=ge=>{var Ye=M_(),st=m(Ye);$(()=>K(st,v(yt).classification.summary)),E(ge,Ye)};ne($r,ge=>{v(yt).success&&v(yt).classification.summary&&ge(Mn)})}var ea=_($r,2);{var Fe=ge=>{var Ye=j_(),st=m(Ye),St=_(st,2),Mt=_(St);{var sn=on=>{var dr=D_(),Ct=_(Xe(dr));$(ta=>K(Ct,` ${ta??""} tok/s`),[()=>v(yt).stats.tps.toFixed(0)]),E(on,dr)};ne(Mt,on=>{v(yt).stats.tps&&on(sn)})}$(on=>{K(st,`${v(yt).stats.inputTokens??""} in + ${v(yt).stats.numTokens??""} out tokens `),K(St,` ${on??""} `)},[()=>o(v(yt).stats.elapsed)]),E(ge,Ye)};ne(ea,ge=>{v(yt).success&&v(yt).stats&&ge(Fe)})}var P=_(ea,2);{var we=ge=>{var Ye=L_(),st=m(Ye);$(()=>K(st,v(yt).error)),E(ge,Ye)};ne(P,ge=>{v(yt).success||ge(we)})}$(ge=>{ht=jt(On,1,"processed-item svelte-t1ig66",null,ht,{failed:!v(yt).success}),K(yn,v(yt).email.subject||"(no subject)"),K(Vt,`${ge??""} `)},[()=>d(v(yt).email.from)]),E(Ht,On)}),E(Ve,_t)};ne(Ia,Ve=>{var _t;((_t=r().results)==null?void 0:_t.length)>0&&v(a).length===0&&Ve(Zr)})}$((Ve,_t,Yt,Ht,yt,On,ht)=>{var It,Qt;K(We,((It=r().summary)==null?void 0:It.processed)||r().total||0),K(at,r().classified||0),K(Zn,`${Ve??""} in + ${_t??""} out`),K(Cn,Yt),K(qe,((Qt=r().summary)==null?void 0:Qt.modelName)||"Unknown"),K(vt,` (${Ht??""}k context, ~${yt??""}k email limit)`),K(Ee,`${On??""} chars`),K(In,`${ht??""} chars`)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed),()=>{var Ve;return Math.round((((Ve=r().summary)==null?void 0:Ve.modelContextWindow)||0)/1024)},()=>{var Ve;return Math.round((((Ve=r().summary)==null?void 0:Ve.modelMaxEmailTokens)||0)/1e3)},()=>{var Ve;return u(((Ve=r().summary)==null?void 0:Ve.systemPromptSize)||0)},()=>{var Ve;return u(((Ve=r().summary)==null?void 0:Ve.avgPromptSize)||0)}]),E(Ce,C)},J=Ce=>{var C=wr(),_e=Xe(C);{var Ae=Oe=>{var We=F_(),Ze=m(We),Qe=m(Ze),ft=_(Ze,2);{var wt=xt=>{var Lt=z_(),Wt=m(Lt);$(()=>K(Wt,`${r().errors??""} errors`)),E(xt,Lt)};ne(ft,xt=>{r().errors&&xt(wt)})}var at=_(ft,4),Ne=m(at),Ge=_(at,4),At=m(Ge);$((xt,Lt,Wt)=>{K(Qe,`${(r().classified||0)??""} classified`),K(Ne,`${xt??""} in + ${Lt??""} out tokens`),K(At,Wt)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),E(Oe,We)};ne(_e,Oe=>{r().totals&&Oe(Ae)})}E(Ce,C)};ne(he,Ce=>{v(k)?Ce(W):Ce(J,!1)})}var de=_(he,2),ce=m(de);{var Se=Ce=>{var C=K_(),_e=Xe(C);_e.__click=function(...Oe){var We;(We=e.oninspect)==null||We.apply(this,Oe)};var Ae=_(_e,2);Ae.__click=function(...Oe){var We;(We=e.onclose)==null||We.apply(this,Oe)},E(Ce,C)},Ke=Ce=>{var C=U_(),_e=Xe(C);_e.__click=function(...Oe){var We;(We=e.oninspect)==null||We.apply(this,Oe)};var Ae=_(_e,2);Ae.__click=function(...Oe){var We;(We=e.onstop)==null||We.apply(this,Oe)},E(Ce,C)};ne(ce,Ce=>{v(k)?Ce(Se):Ce(Ke,!1)})}$(()=>{K(xe,`${v(b)??""}%`),ee=jt(ve,1,"bar-fill svelte-t1ig66",null,ee,{done:v(k)}),le=En(ve,"",le,{width:`${v(b)??""}%`})}),E(T,H)};ne(O,T=>{r()&&T(z)})}E(t,x),Et()}Gt(["click"]);var H_=N('<span class="spinner svelte-ois7em"></span>'),V_=Xo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),Y_=N('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),Q_=N("<option> </option>"),X_=N('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),Z_=N('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function J_(t,e){Tt(e,!0);let r=je(e,"engineStatus",3,"idle"),a=je(e,"modelName",3,""),i=je(e,"isScanning",3,!1),o=je(e,"scanProgress",3,null),u=je(e,"scanCount",15,20),d=je(e,"stats",3,null);const g=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function b(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function w(){return r()==="ready"&&!i()}let k=pt(()=>{var W;return i()&&((W=o())==null?void 0:W.phase)!=="done"});var x=Z_(),O=m(x),z=m(O),T=m(z);{var H=W=>{var J=H_();E(W,J)},fe=W=>{var J=V_();E(W,J)};ne(T,W=>{v(k)?W(H):W(fe,!1)})}var Q=_(z,2),M=m(Q),Y=_(m(M),2);Y.__click=function(...W){var J;(J=e.oninspect)==null||J.apply(this,W)};var Z=_(M,2),F=m(Z);let oe;var xe=_(F),Ie=_(O,2);{var ve=W=>{var J=Y_(),de=m(J),ce=m(de),Se=_(de,4),Ke=m(Se),Ce=_(Se,4),C=m(Ce);$(()=>{K(ce,`${d().totalEmails??""} emails in storage`),K(Ke,`${d().classified??""} classified`),K(C,`${d().unclassified??""} new`)}),E(W,J)};ne(Ie,W=>{d()&&W(ve)})}var ee=_(Ie,2),le=m(ee),ke=_(m(le),2);Ut(ke,21,()=>g,dn,(W,J)=>{var de=Q_(),ce=m(de),Se={};$(()=>{K(ce,v(J).label),Se!==(Se=v(J).value)&&(de.value=(de.__value=v(J).value)??"")}),E(W,de)});var re=_(le,2),me=m(re);me.__click=function(...W){var J;(J=e.onscan)==null||J.apply(this,W)};var Te=m(me),se=_(me,2);se.__click=function(...W){var J;(J=e.onrescan)==null||J.apply(this,W)};var pe=_(ee,2);{var ae=W=>{var J=X_();E(W,J)};ne(pe,W=>{r()!=="ready"&&r()!=="loading"&&W(ae)})}var te=_(pe,2);{var he=W=>{W_(W,{get progress(){return o()},get onstop(){return e.onstop},get oninspect(){return e.oninspect},get onclose(){return e.oncloseprogress}})};ne(te,W=>{var J;(i()||((J=o())==null?void 0:J.phase)==="done")&&W(he)})}$((W,J,de,ce)=>{oe=En(F,"",oe,W),K(xe,` ${J??""}`),ke.disabled=i(),me.disabled=de,K(Te,v(k)?"Scanning...":i()?"Finalizing...":"Scan New"),se.disabled=ce},[()=>({background:b()}),p,()=>!w(),()=>!w()]),xi(ke,u),E(t,x),Et()}Gt(["click"]);var $_=N('<span class="row-date svelte-1czytqk"> </span>'),ey=N('<span class="tag svelte-1czytqk"> </span>'),ty=N('<span class="row-tags svelte-1czytqk"></span>'),ny=N('<span class="row-reason svelte-1czytqk"> </span>'),ry=N('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),ay=N('<span class="status-label svelte-1czytqk"> </span>'),sy=N('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),iy=N('<p class="summary-reason svelte-1czytqk"> </p>'),oy=N('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),ly=N('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function Oc(t,e){Tt(e,!0);let r=je(e,"actionColor",3,"#666"),a=je(e,"dimmed",3,!1);function i(re){if(!re)return"";try{return new Date(re).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=pt(()=>e.item.status==="pending"),u=De(!1);var d=ly(),g=Xe(d);let p;var b=m(g);b.__click=()=>A(u,!v(u));let w;var k=m(b),x=m(k),O=_(k,2),z=m(O),T=m(z),H=_(z,2);{var fe=re=>{var me=$_(),Te=m(me);$(se=>K(Te,se),[()=>i(e.item.date)]),E(re,me)};ne(H,re=>{e.item.date&&re(fe)})}var Q=_(O,2);{var M=re=>{var me=ty();Ut(me,21,()=>e.item.tags,dn,(Te,se)=>{var pe=ey();let ae;var te=m(pe);$(he=>{ae=En(pe,"",ae,he),K(te,v(se))},[()=>({background:np(v(se))})]),E(Te,pe)}),E(re,me)};ne(Q,re=>{e.item.tags&&e.item.tags.length>0&&re(M)})}var Y=_(Q,2);{var Z=re=>{var me=ny(),Te=m(me);$(()=>K(Te,e.item.reason)),E(re,me)};ne(Y,re=>{e.item.reason&&!v(u)&&re(Z)})}var F=_(b,2),oe=m(F);{var xe=re=>{var me=ry(),Te=Xe(me);Te.__click=()=>e.onmarkacted(e.item.emailId);var se=_(Te,2);se.__click=()=>e.ondismiss(e.item.emailId),E(re,me)},Ie=re=>{var me=ay(),Te=m(me);$(()=>K(Te,e.item.status)),E(re,me)};ne(oe,re=>{v(o)?re(xe):re(Ie,!1)})}var ve=_(oe,2);{var ee=re=>{var me=sy();me.__click=()=>e.onremove(e.item.emailId),E(re,me)};ne(ve,re=>{e.onremove&&re(ee)})}var le=_(g,2);{var ke=re=>{var me=oy();let Te;var se=m(me),pe=m(se),ae=_(se,2);{var te=he=>{var W=iy(),J=m(W);$(()=>K(J,e.item.reason)),E(he,W)};ne(ae,he=>{e.item.reason&&he(te)})}$(()=>{Te=En(me,"",Te,{"border-left-color":r()}),K(pe,e.item.summary)}),E(re,me)};ne(le,re=>{v(u)&&e.item.summary&&re(ke)})}$(()=>{p=jt(g,1,"email-row svelte-1czytqk",null,p,{dimmed:a()}),w=En(b,"",w,{"border-left-color":r()}),K(x,e.item.subject),K(T,e.item.from)}),E(t,d),Et()}Gt(["click"]);var cy=N('<span class="group-acted svelte-tl1unp"> </span>'),uy=N('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),dy=N('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),fy=N('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),vy=N('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),py=N('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),hy=N('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function my(t,e){Tt(e,!0);let r=je(e,"color",3,"#888");je(e,"count",3,0);let a=je(e,"items",19,()=>[]),i=je(e,"expanded",3,!1),o=pt(()=>a().filter(Z=>Z.status==="pending")),u=pt(()=>a().filter(Z=>Z.status!=="pending")),d=De(!1);function g(Z){return Z.split("_").map(F=>F.charAt(0)+F.slice(1).toLowerCase()).join(" ")}var p=hy(),b=m(p);b.__click=function(...Z){var F;(F=e.ontoggle)==null||F.apply(this,Z)};var w=m(b);let k;var x=m(w),O=_(w,2),z=m(O),T=_(O,2);{var H=Z=>{var F=cy(),oe=m(F);$(()=>K(oe,`${v(u).length??""} handled`)),E(Z,F)};ne(T,Z=>{v(u).length>0&&Z(H)})}var fe=_(T,4);let Q;var M=_(b,2);{var Y=Z=>{var F=py(),oe=m(F);{var xe=Te=>{var se=uy();E(Te,se)};ne(oe,Te=>{v(o).length===0&&v(u).length===0&&Te(xe)})}var Ie=_(oe,2);Ut(Ie,17,()=>v(o),Te=>Te.emailId,(Te,se)=>{Oc(Te,{get item(){return v(se)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ve=_(Ie,2);{var ee=Te=>{var se=dy(),pe=m(se),ae=m(pe),te=_(pe,2);Ut(te,17,()=>v(u),he=>he.emailId,(he,W)=>{Oc(he,{get item(){return v(W)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),$(()=>K(ae,`${v(u).length??""} handled`)),E(Te,se)};ne(ve,Te=>{v(u).length>0&&Te(ee)})}var le=_(ve,2),ke=m(le);{var re=Te=>{var se=fy();se.__click=()=>A(d,!0),E(Te,se)},me=Te=>{var se=vy(),pe=m(se),ae=_(pe);ae.__click=()=>A(d,!1);var te=_(ae,2);te.__click=()=>{e.oncleargroup(),A(d,!1)},$(()=>K(pe,`Clear ${a().length??""} items? `)),E(Te,se)};ne(ke,Te=>{v(d)?Te(me,!1):Te(re)})}E(Z,F)};ne(M,Z=>{i()&&Z(Y)})}$(Z=>{k=En(w,"",k,{background:r()}),K(x,Z),K(z,v(o).length),Q=jt(fe,0,"chevron svelte-tl1unp",null,Q,{open:i()})},[()=>g(e.action)]),E(t,p),Et()}Gt(["click"]);var gy=N(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),_y=N(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),yy=N(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),by=N('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function wy(t,e){Tt(e,!0);let r=je(e,"open",15,!1),a=je(e,"sampleEmail",3,null),i=De("system");function o(){return a()?Vu(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(w){w.target===w.currentTarget&&u()}var g=wr(),p=Xe(g);{var b=w=>{var k=by();k.__click=d,k.__keydown=ee=>ee.key==="Escape"&&u();var x=m(k),O=m(x),z=_(m(O),2);z.__click=u;var T=_(O,2),H=m(T);let fe;H.__click=()=>A(i,"system");var Q=_(H,2);let M;Q.__click=()=>A(i,"email");var Y=_(Q,2);let Z;Y.__click=()=>A(i,"config");var F=_(T,2),oe=m(F);{var xe=ee=>{var le=gy(),ke=_(Xe(le),2),re=m(ke);$(()=>K(re,ms)),E(ee,le)},Ie=ee=>{var le=_y(),ke=_(Xe(le),2),re=_(m(ke),2);re.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var me=_(ke,2),Te=_(m(me),2),se=m(Te);$(pe=>K(se,pe),[o]),E(ee,le)},ve=ee=>{var le=yy(),ke=_(Xe(le),2),re=m(ke),me=_(m(re),2),Te=m(me),se=_(re,2),pe=_(m(se),2),ae=m(pe),te=_(se,2),he=_(m(te),2),W=m(he),J=_(ke,4);J.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,$(()=>{K(Te,Zv.maxTokens),K(ae,"false"),K(W,"false")}),E(ee,le)};ne(oe,ee=>{v(i)==="system"?ee(xe):v(i)==="email"?ee(Ie,1):v(i)==="config"&&ee(ve,2)})}$(()=>{fe=jt(H,1,"tab svelte-10pcy9j",null,fe,{active:v(i)==="system"}),M=jt(Q,1,"tab svelte-10pcy9j",null,M,{active:v(i)==="email"}),Z=jt(Y,1,"tab svelte-10pcy9j",null,Z,{active:v(i)==="config"})}),E(w,k)};ne(p,w=>{r()&&w(b)})}E(t,g),Et()}Gt(["click","keydown"]);var ky=N('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),xy=N('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),Sy=N('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),Ty=N('<button class="chip svelte-s2dwjj"> </button>'),Ey=N('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),Ay=N('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Cy=N('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),Py=N('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Iy=N('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),Oy=N('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Ry=N('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),My=N('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),Dy=N('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),jy=N('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),Ly=N('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),Ny=N('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function qy(t,e){Tt(e,!0);let r=je(e,"groupOrder",19,()=>[]),a=De(!1),i=De(null),o=De(!1),u=De(null);async function d(){var ve;const[F,oe,xe]=await Promise.all([Ue.items.where("sourceType").equals("gmail").count(),Ue.emailClassifications.count(),Ue.contacts.count()]);let Ie=0;try{const ee=await((ve=navigator.storage)==null?void 0:ve.estimate());Ie=(ee==null?void 0:ee.usage)??0}catch{}A(u,{emailCount:F,classCount:oe,contactCount:xe,totalBytes:Ie},!0)}function g(F){return F?F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(1)} MB`:"â"}function p(){A(a,!v(a)),v(a)&&d()}async function b(F){var oe;A(o,!0),A(i,null);try{await F(),await d(),(oe=e.onrefresh)==null||oe.call(e)}finally{A(o,!1)}}async function w(){await b(()=>cc())}async function k(F){await b(()=>tl(F))}async function x(){await b(async()=>{await Zu(),await cc()})}async function O(){await b(()=>Ue.contacts.clear())}async function z(){await b(async()=>{await Ue.delete(),window.location.reload()})}function T(F){return F.split("_").map(oe=>oe.charAt(0)+oe.slice(1).toLowerCase()).join(" ")}var H=Ny(),fe=m(H);fe.__click=p;var Q=_(m(fe),2);let M;var Y=_(fe,2);{var Z=F=>{var oe=Ly(),xe=m(oe);{var Ie=C=>{var _e=xy(),Ae=m(_e),Oe=m(Ae),We=_(Ae,4),Ze=m(We),Qe=_(We,4),ft=m(Qe),wt=_(Qe,2);{var at=Ne=>{var Ge=ky(),At=_(Xe(Ge),2),xt=m(At);$(Lt=>K(xt,`${Lt??""} used`),[()=>g(v(u).totalBytes)]),E(Ne,Ge)};ne(wt,Ne=>{v(u).totalBytes&&Ne(at)})}$(()=>{K(Oe,`${v(u).emailCount??""} emails`),K(Ze,`${v(u).classCount??""} classifications`),K(ft,`${v(u).contactCount??""} contacts`)}),E(C,_e)};ne(xe,C=>{v(u)&&C(Ie)})}var ve=_(xe,2);{var ee=C=>{var _e=Ey(),Ae=_(m(_e),2);Ut(Ae,21,r,dn,(Oe,We)=>{var Ze=wr(),Qe=Xe(Ze);{var ft=at=>{var Ne=Sy(),Ge=m(Ne),At=_(Ge);At.__click=()=>A(i,null);var xt=_(At,2);xt.__click=()=>k(v(We)),$(Lt=>{K(Ge,`Delete ${Lt??""}? `),xt.disabled=v(o)},[()=>T(v(We))]),E(at,Ne)},wt=at=>{var Ne=Ty();Ne.__click=()=>A(i,`group:${v(We)}`);var Ge=m(Ne);$(At=>{Ne.disabled=v(o),K(Ge,`${At??""} â`)},[()=>T(v(We))]),E(at,Ne)};ne(Qe,at=>{v(i)===`group:${v(We)}`?at(ft):at(wt,!1)})}E(Oe,Ze)}),E(C,_e)};ne(ve,C=>{r().length>0&&C(ee)})}var le=_(ve,2),ke=_(m(le),2),re=m(ke);{var me=C=>{var _e=Ay(),Ae=_(m(_e),2);Ae.__click=()=>A(i,null);var Oe=_(Ae,2);Oe.__click=w,$(()=>Oe.disabled=v(o)),E(C,_e)},Te=C=>{var _e=Cy();_e.__click=()=>A(i,"classifications"),$(()=>_e.disabled=v(o)),E(C,_e)};ne(re,C=>{v(i)==="classifications"?C(me):C(Te,!1)})}var se=_(re,2);{var pe=C=>{var _e=Py(),Ae=_(m(_e),2);Ae.__click=()=>A(i,null);var Oe=_(Ae,2);Oe.__click=x,$(()=>Oe.disabled=v(o)),E(C,_e)},ae=C=>{var _e=Iy();_e.__click=()=>A(i,"emails"),$(()=>_e.disabled=v(o)),E(C,_e)};ne(se,C=>{v(i)==="emails"?C(pe):C(ae,!1)})}var te=_(se,2);{var he=C=>{var _e=Oy(),Ae=_(m(_e),2);Ae.__click=()=>A(i,null);var Oe=_(Ae,2);Oe.__click=O,$(()=>Oe.disabled=v(o)),E(C,_e)},W=C=>{var _e=Ry();_e.__click=()=>A(i,"contacts"),$(()=>_e.disabled=v(o)),E(C,_e)};ne(te,C=>{v(i)==="contacts"?C(he):C(W,!1)})}var J=_(le,2),de=m(J);{var ce=C=>{var _e=My(),Ae=_(m(_e),2);Ae.__click=()=>A(i,null);var Oe=_(Ae,2);Oe.__click=z,$(()=>Oe.disabled=v(o)),E(C,_e)},Se=C=>{var _e=Dy();_e.__click=()=>A(i,"nuke"),$(()=>_e.disabled=v(o)),E(C,_e)};ne(de,C=>{v(i)==="nuke"?C(ce):C(Se,!1)})}var Ke=_(J,2);{var Ce=C=>{var _e=jy();E(C,_e)};ne(Ke,C=>{v(o)&&C(Ce)})}E(F,oe)};ne(Y,F=>{v(a)&&F(Z)})}$(()=>M=jt(Q,0,"chev svelte-s2dwjj",null,M,{open:v(a)})),E(t,H),Et()}Gt(["click"]);var By=N('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),zy=N('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),Fy=N('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Ky=N('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function Uy(t,e){Tt(e,!0);let r=je(e,"groups",19,()=>({})),a=je(e,"groupOrder",19,()=>[]),i=je(e,"counts",19,()=>({})),o=je(e,"stats",3,null),u=je(e,"expandedGroup",3,null),d=je(e,"isScanning",3,!1),g=je(e,"scanProgress",3,null),p=je(e,"scanCount",15,20),b=je(e,"error",3,null),w=De(!1),k=pt(()=>{for(const Z of a()){const F=r()[Z];if((F==null?void 0:F.length)>0)return F[0]}return null});var x=Ky(),O=m(x);J_(O,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return g()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},get oncloseprogress(){return e.oncloseprogress},oninspect:()=>A(w,!0),get scanCount(){return p()},set scanCount(Z){p(Z)}});var z=_(O,2);wy(z,{get sampleEmail(){return v(k)},get open(){return v(w)},set open(Z){A(w,Z,!0)}});var T=_(z,2);{var H=Z=>{var F=By(),oe=m(F),xe=m(oe),Ie=_(oe,2);Ie.__click=function(...ve){var ee;(ee=e.ondismisserror)==null||ee.apply(this,ve)},$(()=>K(xe,b())),E(Z,F)};ne(T,Z=>{b()&&Z(H)})}var fe=_(T,2);{var Q=Z=>{var F=zy(),oe=Xe(F);Ut(oe,20,a,ee=>ee,(ee,le)=>{{let ke=pt(()=>Po(le)),re=pt(()=>{var se;return((se=r()[le])==null?void 0:se.length)||0}),me=pt(()=>r()[le]||[]),Te=pt(()=>u()===le);my(ee,{get action(){return le},get color(){return v(ke)},get count(){return v(re)},get items(){return v(me)},get expanded(){return v(Te)},ontoggle:()=>e.ontogglegroup(le),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(le)})}});var xe=_(oe,2),Ie=m(xe),ve=m(Ie);$(()=>K(ve,`${i().total??""} emails classified into ${a().length??""} groups`)),E(Z,F)},M=Z=>{var F=Fy();E(Z,F)};ne(fe,Z=>{i().total>0?Z(Q):d()||Z(M,1)})}var Y=_(fe,2);qy(Y,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),E(t,x),Et()}Gt(["click"]);var Gy=N('<div class="actions-page svelte-3tch4q"><!></div>');function Wy(t,e){Tt(e,!0);const r=Mu();let a=De(Kt(r.status)),i=De(""),o=De(Kt({})),u=De(Kt([])),d=De(Kt({total:0})),g=De(null),p=De(null),b=De(!1),w=De(null),k=De(3),x=De(null),O=De(null);an(()=>{const ve=r.onMessage(ee=>{if(ee.status==="ready"){A(a,"ready");const le=yr.find(me=>me.id===r.modelId),ke=ir.find(me=>me.name===r.modelId),re=le||ke;A(i,(re==null?void 0:re.name)||(re==null?void 0:re.displayName)||r.modelId||"",!0)}ee.status==="loading"&&A(a,"loading")});if(A(a,r.status,!0),r.modelId){const ee=yr.find(re=>re.id===r.modelId),le=ir.find(re=>re.name===r.modelId),ke=ee||le;A(i,(ke==null?void 0:ke.name)||(ke==null?void 0:ke.displayName)||r.modelId||"",!0)}return z(),()=>ve()});async function z(){try{const ve=await Jv();A(o,ve.groups,!0),A(u,ve.order,!0),A(d,await $v(),!0),A(g,await Co(),!0)}catch(ve){A(x,`Failed to load data: ${ve.message}`)}}async function T(){await fe(!1)}async function H(){await fe(!0)}async function fe(ve){if(v(b)||!r.isReady)return;A(x,null),A(b,!0),A(w,null);const ee=new AbortController;A(O,ee,!0);try{await Wu(r,{count:v(k),force:ve,signal:ee.signal,onProgress:le=>{A(w,{...le},!0)}}),await z()}catch(le){ee.signal.aborted||A(x,`Scan failed: ${le.message}`)}finally{A(b,!1),A(O,null)}}function Q(){var ve;(ve=v(O))==null||ve.abort()}async function M(ve){await vi(ve,"acted"),await z()}async function Y(ve){await vi(ve,"dismissed"),await z()}async function Z(ve){await Hu(ve),await z()}async function F(ve){await tl(ve),await z()}function oe(ve){A(p,v(p)===ve?null:ve,!0)}var xe=Gy(),Ie=m(xe);Uy(Ie,{get engineStatus(){return v(a)},get modelName(){return v(i)},get groups(){return v(o)},get groupOrder(){return v(u)},get counts(){return v(d)},get stats(){return v(g)},get expandedGroup(){return v(p)},get isScanning(){return v(b)},get scanProgress(){return v(w)},get error(){return v(x)},onscan:T,onrescan:H,ontogglegroup:oe,onmarkacted:M,ondismiss:Y,onremove:Z,oncleargroup:F,ondismisserror:()=>A(x,null),onstop:Q,onrefresh:z,oncloseprogress:()=>A(w,null),get scanCount(){return v(k)},set scanCount(ve){A(k,ve,!0)}}),E(t,xe),Et()}var Hy=N('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Vy(t,e){Tt(e,!0);function r(){const F=location.hash;return F==="#dashboard"?"dashboard":F==="#actions"?"actions":"chat"}let a=De(Kt(r()));an(()=>{function F(){A(a,r(),!0)}return window.addEventListener("hashchange",F),()=>window.removeEventListener("hashchange",F)});var i=Hy(),o=m(i),u=_(m(o),2),d=m(u);let g;var p=_(d,2);let b;var w=_(p,2);let k;var x=_(o,2),O=m(x);let z;var T=m(O);Rh(T,{});var H=_(O,2);let fe;var Q=m(H);Wy(Q,{});var M=_(H,2);let Y;var Z=m(M);f_(Z,{}),$(()=>{g=jt(d,1,"svelte-1n46o8q",null,g,{active:v(a)==="chat"}),b=jt(p,1,"svelte-1n46o8q",null,b,{active:v(a)==="actions"}),k=jt(w,1,"svelte-1n46o8q",null,k,{active:v(a)==="dashboard"}),z=En(O,"",z,{display:v(a)==="chat"?"flex":"none"}),fe=En(H,"",fe,{display:v(a)==="actions"?"flex":"none"}),Y=En(M,"",Y,{display:v(a)==="dashboard"?"flex":"none"})}),E(t,i),Et()}nv(Vy,{target:document.getElementById("app")});
