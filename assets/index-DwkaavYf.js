var rf=Object.defineProperty;var yl=t=>{throw TypeError(t)};var af=(t,e,r)=>e in t?rf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ke=(t,e,r)=>af(t,typeof e!="symbol"?e+"":e,r),Ni=(t,e,r)=>e.has(t)||yl("Cannot "+r);var H=(t,e,r)=>(Ni(t,e,"read from private field"),r?r.call(t):e.get(t)),Ue=(t,e,r)=>e.has(t)?yl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ze=(t,e,r,a)=>(Ni(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Dt=(t,e,r)=>(Ni(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Xi=!1;var bo=Array.isArray,sf=Array.prototype.indexOf,xa=Array.prototype.includes,si=Array.from,of=Object.defineProperty,va=Object.getOwnPropertyDescriptor,lf=Object.getOwnPropertyDescriptors,uf=Object.prototype,cf=Array.prototype,uu=Object.getPrototypeOf,bl=Object.isExtensible;const ff=()=>{};function df(t){for(var e=0;e<t.length;e++)t[e]()}function cu(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Ct=2,ss=4,ii=8,fu=1<<24,rr=16,On=32,ra=64,du=128,hn=512,kt=1024,It=2048,Pn=4096,en=8192,tr=16384,ds=32768,Sa=65536,_l=1<<17,hu=1<<18,Ia=1<<19,hf=1<<20,er=1<<25,$r=65536,Qi=1<<21,_o=1<<22,_r=1<<23,Xr=Symbol("$state"),pf=Symbol("legacy props"),vf=Symbol(""),zr=new class extends Error{constructor(){super(...arguments);Ke(this,"name","StaleReactionError");Ke(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function gf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function mf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function yf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function bf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function _f(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function wf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function kf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function xf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Sf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ef(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Tf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Af(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Cf=1,If=2,pu=4,Rf=8,Pf=16,Of=1,Df=4,Mf=8,Lf=16,vu=1,Nf=2,Et=Symbol(),gu="http://www.w3.org/1999/xhtml";function qf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function jf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function mu(t){return t===this.v}function Bf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function yu(t){return!Bf(t,this.v)}let zf=!1,tn=null;function Ea(t){tn=t}function lt(t,e=!1,r){tn={p:tn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ut(t){var e=tn,r=e.e;if(r!==null){e.e=null;for(var a of r)zu(a)}return e.i=!0,tn=e.p,{}}function bu(){return!0}let Fr=[];function _u(){var t=Fr;Fr=[],df(t)}function wr(t){if(Fr.length===0&&!ts){var e=Fr;queueMicrotask(()=>{e===Fr&&_u()})}Fr.push(t)}function Ff(){for(;Fr.length>0;)_u()}function wu(t){var e=et;if(e===null)return Ge.f|=_r,t;if((e.f&ds)===0&&(e.f&ss)===0)throw t;Ta(t,e)}function Ta(t,e){for(;e!==null;){if((e.f&du)!==0){if((e.f&ds)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Kf=-7169;function pt(t,e){t.f=t.f&Kf|e}function wo(t){(t.f&hn)!==0||t.deps===null?pt(t,kt):pt(t,Pn)}function ku(t){if(t!==null)for(const e of t)(e.f&Ct)===0||(e.f&$r)===0||(e.f^=$r,ku(e.deps))}function xu(t,e,r){(t.f&It)!==0?e.add(t):(t.f&Pn)!==0&&r.add(t),ku(t.deps),pt(t,kt)}const Ns=new Set;let je=null,Zs=null,Tt=null,Wt=[],oi=null,Zi=!1,ts=!1;var ga,ma,Ur,ya,ls,us,Gr,Qn,ba,Un,$i,Ji,Su;const Go=class Go{constructor(){Ue(this,Un);Ke(this,"committed",!1);Ke(this,"current",new Map);Ke(this,"previous",new Map);Ue(this,ga,new Set);Ue(this,ma,new Set);Ue(this,Ur,0);Ue(this,ya,0);Ue(this,ls,null);Ue(this,us,new Set);Ue(this,Gr,new Set);Ue(this,Qn,new Map);Ke(this,"is_fork",!1);Ue(this,ba,!1)}is_deferred(){return this.is_fork||H(this,ya)>0}skip_effect(e){H(this,Qn).has(e)||H(this,Qn).set(e,{d:[],m:[]})}unskip_effect(e){var r=H(this,Qn).get(e);if(r){H(this,Qn).delete(e);for(var a of r.d)pt(a,It),Cn(a);for(a of r.m)pt(a,Pn),Cn(a)}}process(e){var i;Wt=[],this.apply();var r=[],a=[];for(const o of e)Dt(this,Un,$i).call(this,o,r,a);if(this.is_deferred()){Dt(this,Un,Ji).call(this,a),Dt(this,Un,Ji).call(this,r);for(const[o,c]of H(this,Qn))Cu(o,c)}else{for(const o of H(this,ga))o();H(this,ga).clear(),H(this,Ur)===0&&Dt(this,Un,Su).call(this),Zs=this,je=null,wl(a),wl(r),Zs=null,(i=H(this,ls))==null||i.resolve()}Tt=null}capture(e,r){r!==Et&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&_r)===0&&(this.current.set(e,e.v),Tt==null||Tt.set(e,e.v))}activate(){je=this,this.apply()}deactivate(){je===this&&(je=null,Tt=null)}flush(){if(this.activate(),Wt.length>0){if(Eu(),je!==null&&je!==this)return}else H(this,Ur)===0&&this.process([]);this.deactivate()}discard(){for(const e of H(this,ma))e(this);H(this,ma).clear()}increment(e){ze(this,Ur,H(this,Ur)+1),e&&ze(this,ya,H(this,ya)+1)}decrement(e){ze(this,Ur,H(this,Ur)-1),e&&ze(this,ya,H(this,ya)-1),!H(this,ba)&&(ze(this,ba,!0),wr(()=>{ze(this,ba,!1),this.is_deferred()?Wt.length>0&&this.flush():this.revive()}))}revive(){for(const e of H(this,us))H(this,Gr).delete(e),pt(e,It),Cn(e);for(const e of H(this,Gr))pt(e,Pn),Cn(e);this.flush()}oncommit(e){H(this,ga).add(e)}ondiscard(e){H(this,ma).add(e)}settled(){return(H(this,ls)??ze(this,ls,cu())).promise}static ensure(){if(je===null){const e=je=new Go;Ns.add(je),ts||wr(()=>{je===e&&e.flush()})}return je}apply(){}};ga=new WeakMap,ma=new WeakMap,Ur=new WeakMap,ya=new WeakMap,ls=new WeakMap,us=new WeakMap,Gr=new WeakMap,Qn=new WeakMap,ba=new WeakMap,Un=new WeakSet,$i=function(e,r,a){e.f^=kt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(On|ra))!==0,v=d&&(c&kt)!==0,p=v||(c&en)!==0||H(this,Qn).has(i);if(!p&&i.fn!==null){d?i.f^=kt:o!==null&&(c&(ss|ii|fu))!==0?o.b.defer_effect(i):(c&ss)!==0?r.push(i):ps(i)&&((c&rr)!==0&&H(this,Gr).add(i),Ca(i));var y=i.first;if(y!==null){i=y;continue}}var _=i.parent;for(i=i.next;i===null&&_!==null;)_===o&&(o=null),i=_.next,_=_.parent}},Ji=function(e){for(var r=0;r<e.length;r+=1)xu(e[r],H(this,us),H(this,Gr))},Su=function(){var i;if(Ns.size>1){this.previous.clear();var e=Tt,r=!0;for(const o of Ns){if(o===this){r=!1;continue}const c=[];for(const[v,p]of this.current){if(o.current.has(v))if(r&&p!==o.current.get(v))o.current.set(v,p);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Wt;Wt=[];const v=new Set,p=new Map;for(const y of c)Tu(y,d,v,p);if(Wt.length>0){je=o,o.apply();for(const y of Wt)Dt(i=o,Un,$i).call(i,y,[],[]);o.deactivate()}Wt=a}}je=null,Tt=e}this.committed=!0,Ns.delete(this)};let kr=Go;function Uf(t){var e=ts;ts=!0;try{for(var r;;){if(Ff(),Wt.length===0&&(je==null||je.flush(),Wt.length===0))return oi=null,r;Eu()}}finally{ts=e}}function Eu(){Zi=!0;var t=null;try{for(var e=0;Wt.length>0;){var r=kr.ensure();if(e++>1e3){var a,i;Gf()}r.process(Wt),xr.clear()}}finally{Wt=[],Zi=!1,oi=null}}function Gf(){try{kf()}catch(t){Ta(t,oi)}}let xn=null;function wl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(tr|en))===0&&ps(a)&&(xn=new Set,Ca(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Gu(a),(xn==null?void 0:xn.size)>0)){xr.clear();for(const i of xn){if((i.f&(tr|en))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)xn.has(c)&&(xn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(tr|en))===0&&Ca(v)}}xn.clear()}}xn=null}}function Tu(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ct)!==0?Tu(i,e,r,a):(o&(_o|rr))!==0&&(o&It)===0&&Au(i,e,a)&&(pt(i,It),Cn(i))}}function Au(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(xa.call(e,i))return!0;if((i.f&Ct)!==0&&Au(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Cn(t){for(var e=oi=t;e.parent!==null;){e=e.parent;var r=e.f;if(Zi&&e===et&&(r&rr)!==0&&(r&hu)===0)return;if((r&(ra|On))!==0){if((r&kt)===0)return;e.f^=kt}}Wt.push(e)}function Cu(t,e){if(!((t.f&On)!==0&&(t.f&kt)!==0)){(t.f&It)!==0?e.d.push(t):(t.f&Pn)!==0&&e.m.push(t),pt(t,kt);for(var r=t.first;r!==null;)Cu(r,e),r=r.next}}function Hf(t){let e=0,r=Jr(0),a;return()=>{So()&&(k(r),Eo(()=>(e===0&&(a=vs(()=>t(()=>ns(r)))),e+=1,()=>{wr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,ns(r))})})))}}var Wf=Sa|Ia|du;function Yf(t,e,r){new Vf(t,e,r)}var un,yo,jn,Hr,Bn,cn,Gt,zn,Zn,yr,Wr,br,_a,Yr,wa,ka,$n,ri,St,Xf,Qf,eo,Gs,Hs,to;class Vf{constructor(e,r,a){Ue(this,St);Ke(this,"parent");Ke(this,"is_pending",!1);Ue(this,un);Ue(this,yo,null);Ue(this,jn);Ue(this,Hr);Ue(this,Bn);Ue(this,cn,null);Ue(this,Gt,null);Ue(this,zn,null);Ue(this,Zn,null);Ue(this,yr,null);Ue(this,Wr,0);Ue(this,br,0);Ue(this,_a,!1);Ue(this,Yr,!1);Ue(this,wa,new Set);Ue(this,ka,new Set);Ue(this,$n,null);Ue(this,ri,Hf(()=>(ze(this,$n,Jr(H(this,Wr))),()=>{ze(this,$n,null)})));ze(this,un,e),ze(this,jn,r),ze(this,Hr,a),this.parent=et.b,this.is_pending=!!H(this,jn).pending,ze(this,Bn,To(()=>{et.b=this;{var i=Dt(this,St,eo).call(this);try{ze(this,cn,fn(()=>a(i)))}catch(o){this.error(o)}H(this,br)>0?Dt(this,St,Hs).call(this):this.is_pending=!1}return()=>{var o;(o=H(this,yr))==null||o.remove()}},Wf))}defer_effect(e){xu(e,H(this,wa),H(this,ka))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!H(this,jn).pending}update_pending_count(e){Dt(this,St,to).call(this,e),ze(this,Wr,H(this,Wr)+e),!(!H(this,$n)||H(this,_a))&&(ze(this,_a,!0),wr(()=>{ze(this,_a,!1),H(this,$n)&&Aa(H(this,$n),H(this,Wr))}))}get_effect_pending(){return H(this,ri).call(this),k(H(this,$n))}error(e){var r=H(this,jn).onerror;let a=H(this,jn).failed;if(H(this,Yr)||!r&&!a)throw e;H(this,cn)&&(Vt(H(this,cn)),ze(this,cn,null)),H(this,Gt)&&(Vt(H(this,Gt)),ze(this,Gt,null)),H(this,zn)&&(Vt(H(this,zn)),ze(this,zn,null));var i=!1,o=!1;const c=()=>{if(i){jf();return}i=!0,o&&Af(),kr.ensure(),ze(this,Wr,0),H(this,zn)!==null&&Qr(H(this,zn),()=>{ze(this,zn,null)}),this.is_pending=this.has_pending_snippet(),ze(this,cn,Dt(this,St,Gs).call(this,()=>(ze(this,Yr,!1),fn(()=>H(this,Hr).call(this,H(this,un)))))),H(this,br)>0?Dt(this,St,Hs).call(this):this.is_pending=!1};wr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Ta(d,H(this,Bn)&&H(this,Bn).parent)}a&&ze(this,zn,Dt(this,St,Gs).call(this,()=>{kr.ensure(),ze(this,Yr,!0);try{return fn(()=>{a(H(this,un),()=>e,()=>c)})}catch(d){return Ta(d,H(this,Bn).parent),null}finally{ze(this,Yr,!1)}}))})}}un=new WeakMap,yo=new WeakMap,jn=new WeakMap,Hr=new WeakMap,Bn=new WeakMap,cn=new WeakMap,Gt=new WeakMap,zn=new WeakMap,Zn=new WeakMap,yr=new WeakMap,Wr=new WeakMap,br=new WeakMap,_a=new WeakMap,Yr=new WeakMap,wa=new WeakMap,ka=new WeakMap,$n=new WeakMap,ri=new WeakMap,St=new WeakSet,Xf=function(){try{ze(this,cn,fn(()=>H(this,Hr).call(this,H(this,un))))}catch(e){this.error(e)}},Qf=function(){const e=H(this,jn).pending;e&&(ze(this,Gt,fn(()=>e(H(this,un)))),wr(()=>{var r=Dt(this,St,eo).call(this);ze(this,cn,Dt(this,St,Gs).call(this,()=>(kr.ensure(),fn(()=>H(this,Hr).call(this,r))))),H(this,br)>0?Dt(this,St,Hs).call(this):(Qr(H(this,Gt),()=>{ze(this,Gt,null)}),this.is_pending=!1)}))},eo=function(){var e=H(this,un);return this.is_pending&&(ze(this,yr,nr()),H(this,un).before(H(this,yr)),e=H(this,yr)),e},Gs=function(e){var r=et,a=Ge,i=tn;Kn(H(this,Bn)),vn(H(this,Bn)),Ea(H(this,Bn).ctx);try{return e()}catch(o){return wu(o),null}finally{Kn(r),vn(a),Ea(i)}},Hs=function(){const e=H(this,jn).pending;H(this,cn)!==null&&(ze(this,Zn,document.createDocumentFragment()),H(this,Zn).append(H(this,yr)),Yu(H(this,cn),H(this,Zn))),H(this,Gt)===null&&ze(this,Gt,fn(()=>e(H(this,un))))},to=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Dt(r=this.parent,St,to).call(r,e);return}if(ze(this,br,H(this,br)+e),H(this,br)===0){this.is_pending=!1;for(const a of H(this,wa))pt(a,It),Cn(a);for(const a of H(this,ka))pt(a,Pn),Cn(a);H(this,wa).clear(),H(this,ka).clear(),H(this,Gt)&&Qr(H(this,Gt),()=>{ze(this,Gt,null)}),H(this,Zn)&&(H(this,un).before(H(this,Zn)),ze(this,Zn,null))}};function Zf(t,e,r,a){const i=li;var o=t.filter(b=>!b.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var c=je,d=et,v=$f(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(b=>b.promise)):null;function y(b){v();try{a(b)}catch(w){(d.f&tr)===0&&Ta(w,d)}c==null||c.deactivate(),no()}if(r.length===0){p.then(()=>y(e.map(i)));return}function _(){v(),Promise.all(r.map(b=>Jf(b))).then(b=>y([...e.map(i),...b])).catch(b=>Ta(b,d))}p?p.then(_):_()}function $f(){var t=et,e=Ge,r=tn,a=je;return function(o=!0){Kn(t),vn(e),Ea(r),o&&(a==null||a.activate())}}function no(){Kn(null),vn(null),Ea(null)}function li(t){var e=Ct|It,r=Ge!==null&&(Ge.f&Ct)!==0?Ge:null;return et!==null&&(et.f|=Ia),{ctx:tn,deps:null,effects:null,equals:mu,f:e,fn:t,reactions:null,rv:0,v:Et,wv:0,parent:r??et,ac:null}}function Jf(t,e,r){let a=et;a===null&&mf();var i=a.b,o=void 0,c=Jr(Et),d=!Ge,v=new Map;return hd(()=>{var w;var p=cu();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{y===je&&y.committed&&y.deactivate(),no()})}catch(D){p.reject(D),no()}var y=je;if(d){var _=i.is_rendered();i.update_pending_count(1),y.increment(_),(w=v.get(y))==null||w.reject(zr),v.delete(y),v.set(y,p)}const b=(D,j=void 0)=>{if(y.activate(),j)j!==zr&&(c.f|=_r,Aa(c,j));else{(c.f&_r)!==0&&(c.f^=_r),Aa(c,D);for(const[S,F]of v){if(v.delete(S),S===y)break;F.reject(zr)}}d&&(i.update_pending_count(-1),y.decrement(_))};p.promise.then(b,D=>b(null,D||"unknown"))}),Bu(()=>{for(const p of v.values())p.reject(zr)}),new Promise(p=>{function y(_){function b(){_===o?p(c):y(o)}_.then(b,b)}y(o)})}function Mt(t){const e=li(t);return Vu(e),e}function Iu(t){const e=li(t);return e.equals=yu,e}function ed(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Vt(e[r])}}function td(t){for(var e=t.parent;e!==null;){if((e.f&Ct)===0)return(e.f&tr)===0?e:null;e=e.parent}return null}function ko(t){var e,r=et;Kn(td(t));try{t.f&=~$r,ed(t),e=$u(t)}finally{Kn(r)}return e}function Ru(t){var e=ko(t);if(!t.equals(e)&&(t.wv=Qu(),(!(je!=null&&je.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){pt(t,kt);return}Sr||(Tt!==null?(So()||je!=null&&je.is_fork)&&Tt.set(t,e):wo(t))}function nd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(zr),a.teardown=ff,a.ac=null,is(a,0),Ao(a))}function Pu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ca(e)}let ro=new Set;const xr=new Map;let Ou=!1;function Jr(t,e){var r={f:0,v:t,reactions:null,equals:mu,rv:0,wv:0};return r}function Oe(t,e){const r=Jr(t);return Vu(r),r}function rd(t,e=!1,r=!0){const a=Jr(t);return e||(a.equals=yu),a}function z(t,e,r=!1){Ge!==null&&(!In||(Ge.f&_l)!==0)&&bu()&&(Ge.f&(Ct|rr|_o|_l))!==0&&(pn===null||!xa.call(pn,t))&&Tf();let a=r?wt(e):e;return Aa(t,a)}function Aa(t,e){if(!t.equals(e)){var r=t.v;Sr?xr.set(t,e):xr.set(t,r),t.v=e;var a=kr.ensure();if(a.capture(t,r),(t.f&Ct)!==0){const i=t;(t.f&It)!==0&&ko(i),wo(i)}t.wv=Qu(),Du(t,It),et!==null&&(et.f&kt)!==0&&(et.f&(On|ra))===0&&(ln===null?vd([t]):ln.push(t)),!a.is_fork&&ro.size>0&&!Ou&&ad()}return e}function ad(){Ou=!1;for(const t of ro)(t.f&kt)!==0&&pt(t,Pn),ps(t)&&Ca(t);ro.clear()}function ns(t){z(t,t.v+1)}function Du(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],c=o.f,d=(c&It)===0;if(d&&pt(o,e),(c&Ct)!==0){var v=o;Tt==null||Tt.delete(v),(c&$r)===0&&(c&hn&&(o.f|=$r),Du(v,Pn))}else d&&((c&rr)!==0&&xn!==null&&xn.add(o),Cn(o))}}function wt(t){if(typeof t!="object"||t===null||Xr in t)return t;const e=uu(t);if(e!==uf&&e!==cf)return t;var r=new Map,a=bo(t),i=Oe(0),o=Zr,c=d=>{if(Zr===o)return d();var v=Ge,p=Zr;vn(null),Tl(o);var y=d();return vn(v),Tl(p),y};return a&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Sf();var y=r.get(v);return y===void 0?c(()=>{var _=Oe(p.value);return r.set(v,_),_}):z(y,p.value,!0),!0},deleteProperty(d,v){var p=r.get(v);if(p===void 0){if(v in d){const y=c(()=>Oe(Et));r.set(v,y),ns(i)}}else z(p,Et),ns(i);return!0},get(d,v,p){var w;if(v===Xr)return t;var y=r.get(v),_=v in d;if(y===void 0&&(!_||(w=va(d,v))!=null&&w.writable)&&(y=c(()=>{var D=wt(_?d[v]:Et),j=Oe(D);return j}),r.set(v,y)),y!==void 0){var b=k(y);return b===Et?void 0:b}return Reflect.get(d,v,p)},getOwnPropertyDescriptor(d,v){var p=Reflect.getOwnPropertyDescriptor(d,v);if(p&&"value"in p){var y=r.get(v);y&&(p.value=k(y))}else if(p===void 0){var _=r.get(v),b=_==null?void 0:_.v;if(_!==void 0&&b!==Et)return{enumerable:!0,configurable:!0,value:b,writable:!0}}return p},has(d,v){var b;if(v===Xr)return!0;var p=r.get(v),y=p!==void 0&&p.v!==Et||Reflect.has(d,v);if(p!==void 0||et!==null&&(!y||(b=va(d,v))!=null&&b.writable)){p===void 0&&(p=c(()=>{var w=y?wt(d[v]):Et,D=Oe(w);return D}),r.set(v,p));var _=k(p);if(_===Et)return!1}return y},set(d,v,p,y){var $;var _=r.get(v),b=v in d;if(a&&v==="length")for(var w=p;w<_.v;w+=1){var D=r.get(w+"");D!==void 0?z(D,Et):w in d&&(D=c(()=>Oe(Et)),r.set(w+"",D))}if(_===void 0)(!b||($=va(d,v))!=null&&$.writable)&&(_=c(()=>Oe(void 0)),z(_,wt(p)),r.set(v,_));else{b=_.v!==Et;var j=c(()=>wt(p));z(_,j)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(y,p),!b){if(a&&typeof v=="string"){var F=r.get("length"),re=Number(v);Number.isInteger(re)&&re>=F.v&&z(F,re+1)}ns(i)}return!0},ownKeys(d){k(i);var v=Reflect.ownKeys(d).filter(_=>{var b=r.get(_);return b===void 0||b.v!==Et});for(var[p,y]of r)y.v!==Et&&!(p in d)&&v.push(p);return v},setPrototypeOf(){Ef()}})}function kl(t){try{if(t!==null&&typeof t=="object"&&Xr in t)return t[Xr]}catch{}return t}function sd(t,e){return Object.is(kl(t),kl(e))}var xl,Mu,Lu,Nu;function id(){if(xl===void 0){xl=window,Mu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Lu=va(e,"firstChild").get,Nu=va(e,"nextSibling").get,bl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),bl(r)&&(r.__t=void 0)}}function nr(t=""){return document.createTextNode(t)}function Jt(t){return Lu.call(t)}function hs(t){return Nu.call(t)}function x(t,e){return Jt(t)}function xt(t,e=!1){{var r=Jt(t);return r instanceof Comment&&r.data===""?hs(r):r}}function M(t,e=1,r=!1){let a=t;for(;e--;)a=hs(a);return a}function od(t){t.textContent=""}function qu(){return!1}function ld(t,e,r){return document.createElementNS(gu,t,void 0)}let Sl=!1;function ud(){Sl||(Sl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function xo(t){var e=Ge,r=et;vn(null),Kn(null);try{return t()}finally{vn(e),Kn(r)}}function ju(t,e,r,a=r){t.addEventListener(e,()=>xo(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),ud()}function cd(t){et===null&&(Ge===null&&wf(),_f()),Sr&&bf()}function fd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ar(t,e,r){var a=et;a!==null&&(a.f&en)!==0&&(t|=en);var i={ctx:tn,deps:null,nodes:null,f:t|It|hn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ca(i)}catch(d){throw Vt(i),d}else e!==null&&Cn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ia)===0&&(o=o.first,(t&rr)!==0&&(t&Sa)!==0&&o!==null&&(o.f|=Sa)),o!==null&&(o.parent=a,a!==null&&fd(o,a),Ge!==null&&(Ge.f&Ct)!==0&&(t&ra)===0)){var c=Ge;(c.effects??(c.effects=[])).push(o)}return i}function So(){return Ge!==null&&!In}function Bu(t){const e=ar(ii,null,!1);return pt(e,kt),e.teardown=t,e}function $s(t){cd();var e=et.f,r=!Ge&&(e&On)!==0&&(e&ds)===0;if(r){var a=tn;(a.e??(a.e=[])).push(t)}else return zu(t)}function zu(t){return ar(ss|hf,t,!1)}function dd(t){kr.ensure();const e=ar(ra|Ia,t,!0);return(r={})=>new Promise(a=>{r.outro?Qr(e,()=>{Vt(e),a(void 0)}):(Vt(e),a(void 0))})}function Fu(t){return ar(ss,t,!1)}function hd(t){return ar(_o|Ia,t,!0)}function Eo(t,e=0){return ar(ii|e,t,!0)}function ye(t,e=[],r=[],a=[]){Zf(a,e,r,i=>{ar(ii,()=>t(...i.map(k)),!0)})}function To(t,e=0){var r=ar(rr|e,t,!0);return r}function fn(t){return ar(On|Ia,t,!0)}function Ku(t){var e=t.teardown;if(e!==null){const r=Sr,a=Ge;El(!0),vn(null);try{e.call(null)}finally{El(r),vn(a)}}}function Ao(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&xo(()=>{i.abort(zr)});var a=r.next;(r.f&ra)!==0?r.parent=null:Vt(r,e),r=a}}function pd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&On)===0&&Vt(e),e=r}}function Vt(t,e=!0){var r=!1;(e||(t.f&hu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Uu(t.nodes.start,t.nodes.end),r=!0),Ao(t,e&&!r),is(t,0),pt(t,tr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Ku(t);var i=t.parent;i!==null&&i.first!==null&&Gu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Uu(t,e){for(;t!==null;){var r=t===e?null:hs(t);t.remove(),t=r}}function Gu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function Qr(t,e,r=!0){var a=[];Hu(t,a,!0);var i=()=>{r&&Vt(t),e&&e()},o=a.length;if(o>0){var c=()=>--o||i();for(var d of a)d.out(c)}else i()}function Hu(t,e,r){if((t.f&en)===0){t.f^=en;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Sa)!==0||(i.f&On)!==0&&(t.f&rr)!==0;Hu(i,e,c?r:!1),i=o}}}function Co(t){Wu(t,!0)}function Wu(t,e){if((t.f&en)!==0){t.f^=en,(t.f&kt)===0&&(pt(t,It),Cn(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Sa)!==0||(r.f&On)!==0;Wu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Yu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:hs(r);e.append(r),r=i}}let Ws=!1,Sr=!1;function El(t){Sr=t}let Ge=null,In=!1;function vn(t){Ge=t}let et=null;function Kn(t){et=t}let pn=null;function Vu(t){Ge!==null&&(pn===null?pn=[t]:pn.push(t))}let Yt=null,Zt=0,ln=null;function vd(t){ln=t}let Xu=1,Kr=0,Zr=Kr;function Tl(t){Zr=t}function Qu(){return++Xu}function ps(t){var e=t.f;if((e&It)!==0)return!0;if(e&Ct&&(t.f&=~$r),(e&Pn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(ps(o)&&Ru(o),o.wv>t.wv)return!0}(e&hn)!==0&&Tt===null&&pt(t,kt)}return!1}function Zu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(pn!==null&&xa.call(pn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Ct)!==0?Zu(o,e,!1):e===o&&(r?pt(o,It):(o.f&kt)!==0&&pt(o,Pn),Cn(o))}}function $u(t){var j;var e=Yt,r=Zt,a=ln,i=Ge,o=pn,c=tn,d=In,v=Zr,p=t.f;Yt=null,Zt=0,ln=null,Ge=(p&(On|ra))===0?t:null,pn=null,Ea(t.ctx),In=!1,Zr=++Kr,t.ac!==null&&(xo(()=>{t.ac.abort(zr)}),t.ac=null);try{t.f|=Qi;var y=t.fn,_=y();t.f|=ds;var b=t.deps,w=je==null?void 0:je.is_fork;if(Yt!==null){var D;if(w||is(t,Zt),b!==null&&Zt>0)for(b.length=Zt+Yt.length,D=0;D<Yt.length;D++)b[Zt+D]=Yt[D];else t.deps=b=Yt;if(So()&&(t.f&hn)!==0)for(D=Zt;D<b.length;D++)((j=b[D]).reactions??(j.reactions=[])).push(t)}else!w&&b!==null&&Zt<b.length&&(is(t,Zt),b.length=Zt);if(bu()&&ln!==null&&!In&&b!==null&&(t.f&(Ct|Pn|It))===0)for(D=0;D<ln.length;D++)Zu(ln[D],t);if(i!==null&&i!==t){if(Kr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Kr;if(e!==null)for(const S of e)S.rv=Kr;ln!==null&&(a===null?a=ln:a.push(...ln))}return(t.f&_r)!==0&&(t.f^=_r),_}catch(S){return wu(S)}finally{t.f^=Qi,Yt=e,Zt=r,ln=a,Ge=i,pn=o,Ea(c),In=d,Zr=v}}function gd(t,e){let r=e.reactions;if(r!==null){var a=sf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Ct)!==0&&(Yt===null||!xa.call(Yt,e))){var o=e;(o.f&hn)!==0&&(o.f^=hn,o.f&=~$r),wo(o),nd(o),is(o,0)}}function is(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)gd(t,r[a])}function Ca(t){var e=t.f;if((e&tr)===0){pt(t,kt);var r=et,a=Ws;et=t,Ws=!0;try{(e&(rr|fu))!==0?pd(t):Ao(t),Ku(t);var i=$u(t);t.teardown=typeof i=="function"?i:null,t.wv=Xu;var o;Xi&&zf&&(t.f&It)!==0&&t.deps}finally{Ws=a,et=r}}}async function Ju(){await Promise.resolve(),Uf()}function k(t){var e=t.f,r=(e&Ct)!==0;if(Ge!==null&&!In){var a=et!==null&&(et.f&tr)!==0;if(!a&&(pn===null||!xa.call(pn,t))){var i=Ge.deps;if((Ge.f&Qi)!==0)t.rv<Kr&&(t.rv=Kr,Yt===null&&i!==null&&i[Zt]===t?Zt++:Yt===null?Yt=[t]:Yt.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ge]:xa.call(o,Ge)||o.push(Ge)}}}if(Sr&&xr.has(t))return xr.get(t);if(r){var c=t;if(Sr){var d=c.v;return((c.f&kt)===0&&c.reactions!==null||tc(c))&&(d=ko(c)),xr.set(c,d),d}var v=(c.f&hn)===0&&!In&&Ge!==null&&(Ws||(Ge.f&hn)!==0),p=(c.f&ds)===0;ps(c)&&(v&&(c.f|=hn),Ru(c)),v&&!p&&(Pu(c),ec(c))}if(Tt!=null&&Tt.has(t))return Tt.get(t);if((t.f&_r)!==0)throw t.v;return t.v}function ec(t){if(t.f|=hn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ct)!==0&&(e.f&hn)===0&&(Pu(e),ec(e))}function tc(t){if(t.v===Et)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Ct)!==0&&tc(e))return!0;return!1}function vs(t){var e=In;try{return In=!0,t()}finally{In=e}}const md=["touchstart","touchmove"];function yd(t){return md.includes(t)}const nc=new Set,ao=new Set;function Kt(t){for(var e=0;e<t.length;e++)nc.add(t[e]);for(var r of ao)r(t)}let Al=null;function Cl(t){var S;var e=this,r=e.ownerDocument,a=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;Al=t;var c=0,d=Al===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;v<=p&&(c=v)}if(o=i[c]||t.target,o!==e){of(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Ge,_=et;vn(null),Kn(null);try{for(var b,w=[];o!==null;){var D=o.assignedSlot||o.parentNode||o.host||null;try{var j=o["__"+a];j!=null&&(!o.disabled||t.target===o)&&j.call(o,t)}catch(F){b?w.push(F):b=F}if(t.cancelBubble||D===e||D===null)break;o=D}if(b){for(let F of w)queueMicrotask(()=>{throw F});throw b}}finally{t.__root=e,delete t.currentTarget,vn(y),Kn(_)}}}var iu,ou;const qi=(ou=(iu=globalThis==null?void 0:globalThis.window)==null?void 0:iu.trustedTypes)==null?void 0:ou.createPolicy("svelte-trusted-html",{createHTML:t=>t});function bd(t){return(qi==null?void 0:qi.createHTML(t))??t}function Io(t,e=!1){var r=ld("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?bd(t):t,r.content}function ea(t,e){var r=et;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function X(t,e){var r=(e&vu)!==0,a=(e&Nf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Io(o?t:"<!>"+t,!0),r||(i=Jt(i)));var c=a||Mu?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=Jt(c),v=c.lastChild;ea(d,v)}else ea(c,c);return c}}function _d(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&vu)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Io(o,!0),v=Jt(d);if(i)for(c=document.createDocumentFragment();Jt(v);)c.appendChild(Jt(v));else c=Jt(v)}var p=c.cloneNode(!0);if(i){var y=Jt(p),_=p.lastChild;ea(y,_)}else ea(p,p);return p}}function Ro(t,e){return _d(t,e,"svg")}function Il(t=""){{var e=nr(t+"");return ea(e,e),e}}function Po(){var t=document.createDocumentFragment(),e=document.createComment(""),r=nr();return t.append(e,r),ea(e,r),t}function G(t,e){t!==null&&t.before(e)}function ce(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function wd(t,e){return kd(t,e)}const qs=new Map;function kd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:c=!0}){id();var d=new Set,v=_=>{for(var b=0;b<_.length;b++){var w=_[b];if(!d.has(w)){d.add(w);var D=yd(w);for(const F of[e,document]){var j=qs.get(F);j===void 0&&(j=new Map,qs.set(F,j));var S=j.get(w);S===void 0?(F.addEventListener(w,Cl,{passive:D}),j.set(w,1)):j.set(w,S+1)}}}};v(si(nc)),ao.add(v);var p=void 0,y=dd(()=>{var _=r??e.appendChild(nr());return Yf(_,{pending:()=>{}},b=>{lt({});var w=tn;o&&(w.c=o),i&&(a.$$events=i),p=t(b,a)||{},ut()}),()=>{var j;for(var b of d)for(const S of[e,document]){var w=qs.get(S),D=w.get(b);--D==0?(S.removeEventListener(b,Cl),w.delete(b),w.size===0&&qs.delete(S)):w.set(b,D)}ao.delete(v),_!==r&&((j=_.parentNode)==null||j.removeChild(_))}});return xd.set(p,y),p}let xd=new WeakMap;var En,Fn,$t,Vr,cs,fs,ai;class Sd{constructor(e,r=!0){Ke(this,"anchor");Ue(this,En,new Map);Ue(this,Fn,new Map);Ue(this,$t,new Map);Ue(this,Vr,new Set);Ue(this,cs,!0);Ue(this,fs,()=>{var e=je;if(H(this,En).has(e)){var r=H(this,En).get(e),a=H(this,Fn).get(r);if(a)Co(a),H(this,Vr).delete(r);else{var i=H(this,$t).get(r);i&&(H(this,Fn).set(r,i.effect),H(this,$t).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,c]of H(this,En)){if(H(this,En).delete(o),o===e)break;const d=H(this,$t).get(c);d&&(Vt(d.effect),H(this,$t).delete(c))}for(const[o,c]of H(this,Fn)){if(o===r||H(this,Vr).has(o))continue;const d=()=>{if(Array.from(H(this,En).values()).includes(o)){var p=document.createDocumentFragment();Yu(c,p),p.append(nr()),H(this,$t).set(o,{effect:c,fragment:p})}else Vt(c);H(this,Vr).delete(o),H(this,Fn).delete(o)};H(this,cs)||!a?(H(this,Vr).add(o),Qr(c,d,!1)):d()}}});Ue(this,ai,e=>{H(this,En).delete(e);const r=Array.from(H(this,En).values());for(const[a,i]of H(this,$t))r.includes(a)||(Vt(i.effect),H(this,$t).delete(a))});this.anchor=e,ze(this,cs,r)}ensure(e,r){var a=je,i=qu();if(r&&!H(this,Fn).has(e)&&!H(this,$t).has(e))if(i){var o=document.createDocumentFragment(),c=nr();o.append(c),H(this,$t).set(e,{effect:fn(()=>r(c)),fragment:o})}else H(this,Fn).set(e,fn(()=>r(this.anchor)));if(H(this,En).set(a,e),i){for(const[d,v]of H(this,Fn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of H(this,$t))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(H(this,fs)),a.ondiscard(H(this,ai))}else H(this,fs).call(this)}}En=new WeakMap,Fn=new WeakMap,$t=new WeakMap,Vr=new WeakMap,cs=new WeakMap,fs=new WeakMap,ai=new WeakMap;function we(t,e,r=!1){var a=new Sd(t),i=r?Sa:0;function o(c,d){a.ensure(c,d)}To(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function Er(t,e){return e}function Ed(t,e,r){for(var a=[],i=e.length,o,c=e.length,d=0;d<i;d++){let _=e[d];Qr(_,()=>{if(o){if(o.pending.delete(_),o.done.add(_),o.pending.size===0){var b=t.outrogroups;so(si(o.done)),b.delete(o),b.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=a.length===0&&r!==null;if(v){var p=r,y=p.parentNode;od(y),y.append(p),t.items.clear()}so(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function so(t,e=!0){for(var r=0;r<t.length;r++)Vt(t[r],e)}var Rl;function gn(t,e,r,a,i,o=null){var c=t,d=new Map,v=(e&pu)!==0;if(v){var p=t;c=p.appendChild(nr())}var y=null,_=Iu(()=>{var F=r();return bo(F)?F:F==null?[]:si(F)}),b,w=!0;function D(){S.fallback=y,Td(S,b,c,e,a),y!==null&&(b.length===0?(y.f&er)===0?Co(y):(y.f^=er,Ja(y,null,c)):Qr(y,()=>{y=null}))}var j=To(()=>{b=k(_);for(var F=b.length,re=new Set,$=je,U=qu(),J=0;J<F;J+=1){var le=b[J],Z=a(le,J),he=w?null:d.get(Z);he?(he.v&&Aa(he.v,le),he.i&&Aa(he.i,J),U&&$.unskip_effect(he.e)):(he=Ad(d,w?c:Rl??(Rl=nr()),le,Z,J,i,e,r),w||(he.e.f|=er),d.set(Z,he)),re.add(Z)}if(F===0&&o&&!y&&(w?y=fn(()=>o(c)):(y=fn(()=>o(Rl??(Rl=nr()))),y.f|=er)),F>re.size&&yf(),!w)if(U){for(const[Me,_e]of d)re.has(Me)||$.skip_effect(_e.e);$.oncommit(D),$.ondiscard(()=>{})}else D();k(_)}),S={effect:j,items:d,outrogroups:null,fallback:y};w=!1}function Ha(t){for(;t!==null&&(t.f&On)===0;)t=t.next;return t}function Td(t,e,r,a,i){var _e,me,ie,ae,Le,W,Q,ee,Y;var o=(a&Rf)!==0,c=e.length,d=t.items,v=Ha(t.effect.first),p,y=null,_,b=[],w=[],D,j,S,F;if(o)for(F=0;F<c;F+=1)D=e[F],j=i(D,F),S=d.get(j).e,(S.f&er)===0&&((me=(_e=S.nodes)==null?void 0:_e.a)==null||me.measure(),(_??(_=new Set)).add(S));for(F=0;F<c;F+=1){if(D=e[F],j=i(D,F),S=d.get(j).e,t.outrogroups!==null)for(const ne of t.outrogroups)ne.pending.delete(S),ne.done.delete(S);if((S.f&er)!==0)if(S.f^=er,S===v)Ja(S,null,r);else{var re=y?y.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),gr(t,y,S),gr(t,S,re),Ja(S,re,r),y=S,b=[],w=[],v=Ha(y.next);continue}if((S.f&en)!==0&&(Co(S),o&&((ae=(ie=S.nodes)==null?void 0:ie.a)==null||ae.unfix(),(_??(_=new Set)).delete(S))),S!==v){if(p!==void 0&&p.has(S)){if(b.length<w.length){var $=w[0],U;y=$.prev;var J=b[0],le=b[b.length-1];for(U=0;U<b.length;U+=1)Ja(b[U],$,r);for(U=0;U<w.length;U+=1)p.delete(w[U]);gr(t,J.prev,le.next),gr(t,y,J),gr(t,le,$),v=$,y=le,F-=1,b=[],w=[]}else p.delete(S),Ja(S,v,r),gr(t,S.prev,S.next),gr(t,S,y===null?t.effect.first:y.next),gr(t,y,S),y=S;continue}for(b=[],w=[];v!==null&&v!==S;)(p??(p=new Set)).add(v),w.push(v),v=Ha(v.next);if(v===null)continue}(S.f&er)===0&&b.push(S),y=S,v=Ha(S.next)}if(t.outrogroups!==null){for(const ne of t.outrogroups)ne.pending.size===0&&(so(si(ne.done)),(Le=t.outrogroups)==null||Le.delete(ne));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||p!==void 0){var Z=[];if(p!==void 0)for(S of p)(S.f&en)===0&&Z.push(S);for(;v!==null;)(v.f&en)===0&&v!==t.fallback&&Z.push(v),v=Ha(v.next);var he=Z.length;if(he>0){var Me=(a&pu)!==0&&c===0?r:null;if(o){for(F=0;F<he;F+=1)(Q=(W=Z[F].nodes)==null?void 0:W.a)==null||Q.measure();for(F=0;F<he;F+=1)(Y=(ee=Z[F].nodes)==null?void 0:ee.a)==null||Y.fix()}Ed(t,Z,Me)}}o&&wr(()=>{var ne,te;if(_!==void 0)for(S of _)(te=(ne=S.nodes)==null?void 0:ne.a)==null||te.apply()})}function Ad(t,e,r,a,i,o,c,d){var v=(c&Cf)!==0?(c&Pf)===0?rd(r,!1,!1):Jr(r):null,p=(c&If)!==0?Jr(i):null;return{v,i:p,e:fn(()=>(o(e,v??r,p??i,d),()=>{t.delete(a)}))}}function Ja(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&er)===0?e.nodes.start:r;a!==null;){var c=hs(a);if(o.before(a),a===i)return;a=c}}function gr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Cd(t,e,r=!1,a=!1,i=!1){var o=t,c="";ye(()=>{var d=et;if(c!==(c=e()??"")&&(d.nodes!==null&&(Uu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var p=Io(v);if((r||a)&&(p=Jt(p)),ea(Jt(p),p.lastChild),r||a)for(;Jt(p);)o.before(Jt(p));else o.before(p)}})}const Pl=[...` 	
\r\fÂ \v\uFEFF`];function Id(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,c=0;(c=a.indexOf(i,c))>=0;){var d=c+o;(c===0||Pl.includes(a[c-1]))&&(d===a.length||Pl.includes(a[d]))?a=(c===0?"":a.substring(0,c))+a.substring(d+1):c=d}}return a===""?null:a}function Ol(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function ji(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Rd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(ji)),i&&v.push(...Object.keys(i).map(ji));var p=0,y=-1;const j=t.length;for(var _=0;_<j;_++){var b=t[_];if(d?b==="/"&&t[_-1]==="*"&&(d=!1):o?o===b&&(o=!1):b==="/"&&t[_+1]==="*"?d=!0:b==='"'||b==="'"?o=b:b==="("?c++:b===")"&&c--,!d&&o===!1&&c===0){if(b===":"&&y===-1)y=_;else if(b===";"||_===j-1){if(y!==-1){var w=ji(t.substring(p,y).trim());if(!v.includes(w)){b!==";"&&_++;var D=t.substring(p,_).trim();r+=" "+D+";"}}p=_+1,y=-1}}}}return a&&(r+=Ol(a)),i&&(r+=Ol(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function dn(t,e,r,a,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Id(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var p=!!o[v];(i==null||p!==!!i[v])&&t.classList.toggle(v,p)}return o}function Bi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function Rn(t,e,r,a){var i=t.__style;if(i!==e){var o=Rd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Bi(t,r==null?void 0:r[0],a[0]),Bi(t,r==null?void 0:r[1],a[1],"important")):Bi(t,r,a));return a}function rc(t,e,r=!1){if(t.multiple){if(e==null)return;if(!bo(e))return qf();for(var a of t.options)a.selected=e.includes(rs(a));return}for(a of t.options){var i=rs(a);if(sd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Pd(t){var e=new MutationObserver(()=>{rc(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Bu(()=>{e.disconnect()})}function Oo(t,e,r=e){var a=new WeakSet,i=!0;ju(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),rs);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&rs(v)}r(d),je!==null&&a.add(je)}),Fu(()=>{var o=e();if(t===document.activeElement){var c=Zs??je;if(a.has(c))return}if(rc(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=rs(d),r(o))}t.__value=o,i=!1}),Pd(t)}function rs(t){return"__value"in t?t.__value:t.value}const Od=Symbol("is custom element"),Dd=Symbol("is html");function ac(t,e,r,a){var i=Md(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[vf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Ld(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Md(t){return t.__attributes??(t.__attributes={[Od]:t.nodeName.includes("-"),[Dd]:t.namespaceURI===gu})}var Dl=new Map;function Ld(t){var e=t.getAttribute("is")||t.nodeName,r=Dl.get(e);if(r)return r;Dl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=lf(i);for(var c in a)a[c].set&&r.push(c);i=uu(i)}return r}function Do(t,e,r=e){var a=new WeakSet;ju(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=zi(t)?Fi(o):o,r(o),je!==null&&a.add(je),await Ju(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;c===d&&d===v&&p>v?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=c,t.selectionEnd=Math.min(d,p))}}}),vs(e)==null&&t.value&&(r(zi(t)?Fi(t.value):t.value),je!==null&&a.add(je)),Eo(()=>{var i=e();if(t===document.activeElement){var o=Zs??je;if(a.has(o))return}zi(t)&&i===Fi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function zi(t){var e=t.type;return e==="number"||e==="range"}function Fi(t){return t===""?null:+t}function Ml(t,e){return t===e||(t==null?void 0:t[Xr])===e}function sc(t={},e,r,a){return Fu(()=>{var i,o;return Eo(()=>{i=o,o=[],vs(()=>{t!==r(...o)&&(e(t,...o),i&&Ml(r(...i),t)&&e(null,...i))})}),()=>{wr(()=>{o&&Ml(r(...o),t)&&e(null,...o)})}}),t}let js=!1;function Nd(t){var e=js;try{return js=!1,[t(),js]}finally{js=e}}function Pe(t,e,r,a){var re;var i=(r&Mf)!==0,o=(r&Lf)!==0,c=a,d=!0,v=()=>(d&&(d=!1,c=o?vs(a):a),c),p;if(i){var y=Xr in t||pf in t;p=((re=va(t,e))==null?void 0:re.set)??(y&&e in t?$=>t[e]=$:void 0)}var _,b=!1;i?[_,b]=Nd(()=>t[e]):_=t[e],_===void 0&&a!==void 0&&(_=v(),p&&(xf(),p(_)));var w;if(w=()=>{var $=t[e];return $===void 0?v():(d=!0,$)},(r&Df)===0)return w;if(p){var D=t.$$legacy;return(function($,U){return arguments.length>0?((!U||D||b)&&p(U?w():$),$):w()})}var j=!1,S=((r&Of)!==0?li:Iu)(()=>(j=!1,w()));i&&k(S);var F=et;return(function($,U){if(arguments.length>0){const J=U?k(S):i?wt($):$;return z(S,J),j=!0,c!==void 0&&(c=J),$}return Sr&&j||(F.f&tr)!==0?S.v:k(S)})}function Rt(t){tn===null&&gf(),$s(()=>{const e=vs(t);if(typeof e=="function")return e})}const qd="5";var lu;typeof window<"u"&&((lu=window.__svelte??(window.__svelte={})).v??(lu.v=new Set)).add(qd);const os=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Ht=null,Jn="idle",Ys=null,jr=new Set;function Bs(){return Ht||(Ht=new Worker(new URL("/me-ai/assets/worker-CsGlDG0A.js",import.meta.url),{type:"module"}),Ht.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Jn="loading"),e.status==="ready"&&(Jn="ready"),e.status==="start"&&(Jn="generating"),(e.status==="complete"||e.status==="error")&&(Jn=Ys?"ready":"idle");for(const r of jr)try{r(e)}catch{}})),Ht}function ic(){return{check(){Bs().postMessage({type:"check"})},loadModel(t){Ys=t,Jn="loading",Bs().postMessage({type:"load",modelId:t})},generate(t){Bs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let a="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":a+=c.output;break;case"complete":o(),e(a);break;case"error":o(),r(new Error(c.data));break}},o=()=>{jr.delete(i)};jr.add(i),Bs().postMessage({type:"generate",data:t})})},interrupt(){Ht==null||Ht.postMessage({type:"interrupt"})},reset(){Ht==null||Ht.postMessage({type:"reset"})},onMessage(t){return jr.add(t),()=>jr.delete(t)},offMessage(t){jr.delete(t)},get status(){return Jn},get isReady(){return Jn==="ready"},get isGenerating(){return Jn==="generating"},get modelId(){return Ys},terminate(){Ht==null||Ht.terminate(),Ht=null,Jn="idle",Ys=null,jr.clear()}}}var jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vs={exports:{}},zd=Vs.exports,Ll;function Fd(){return Ll||(Ll=1,(function(t,e){((r,a)=>{t.exports=a()})(zd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,u=arguments.length;l<u;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var u,f=0,h=s.length;f<h;f++)!u&&f in s||((u=u||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(u||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:jd,c=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&c(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,y={}.hasOwnProperty;function _(n,s){return y.call(n,s)}function b(n,s){typeof s=="function"&&(s=s(p(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(s).forEach(function(l){D(n,l,s[l])})}var w=Object.defineProperty;function D(n,s,l,u){w(n,s,v(l&&_(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function j(n){return{from:function(s){return n.prototype=Object.create(s.prototype),D(n.prototype,"constructor",n),{extend:b.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,F=[].slice;function re(n,s,l){return F.call(n,s,l)}function $(n,s){return s(n)}function U(n){if(!n)throw new Error("Assertion Failed")}function J(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function le(n,s){if(typeof s=="string"&&_(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],u=0,f=s.length;u<f;++u){var h=le(n,s[u]);l.push(h)}return l}var g,m=s.indexOf(".");return m===-1||(g=n[s.substr(0,m)])==null?void 0:le(g,s.substr(m+1))}function Z(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){U(typeof l!="string"&&"length"in l);for(var u=0,f=s.length;u<f;++u)Z(n,s[u],l[u])}else{var h,g,m=s.indexOf(".");m!==-1?(h=s.substr(0,m),(m=s.substr(m+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:Z(g=(g=n[h])&&_(n,h)?g:n[h]={},m,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function he(n){var s,l={};for(s in n)_(n,s)&&(l[s]=n[s]);return l}var Me=[].concat;function _e(n){return Me.apply([],n)}var fe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_e([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),me=new Set(fe.map(function(n){return o[n]})),ie=null;function ae(n){return ie=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var u=ie.get(l);if(u)return u;if(d(l)){u=[],ie.set(l,u);for(var f=0,h=l.length;f<h;++f)u.push(s(l[f]))}else if(me.has(l.constructor))u=l;else{var g,m=p(l);for(g in u=m===Object.prototype?{}:Object.create(m),ie.set(l,u),l)_(l,g)&&(u[g]=s(l[g]))}return u})(n),ie=null,n}var Le={}.toString;function W(n){return Le.call(n).slice(8,-1)}var Q=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ee=typeof Q=="symbol"?function(n){var s;return n!=null&&(s=n[Q])&&s.apply(n)}:function(){return null};function Y(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ne={};function te(n){var s,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ne&&typeof n=="string")return[n];if(f=ee(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var K=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(fe),Se={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ae(n,s){this.name=n,this.message=s}function Te(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function Je(n,s,l,u){this.failures=s,this.failedKeys=u,this.successCount=l,this.message=Te(n,s)}function De(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=Te(n,this.failures)}j(Ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j(Je).from(Ae),j(De).from(Ae);var tt=gt.reduce(function(n,s){return n[s]=s+"Error",n},{}),vt=Ae,ke=gt.reduce(function(n,s){var l=s+"Error";function u(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=Se[s]||l,this.inner=null)}return j(u).from(vt),n[s]=u,n},{}),Nt=(ke.Syntax=SyntaxError,ke.Type=TypeError,ke.Range=RangeError,fe.reduce(function(n,s){return n[s+"Error"]=ke[s],n},{}));fe=gt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=ke[s]),n},{});function He(){}function rn(n){return n}function sa(n,s){return n==null||n===rn?s:function(l){return s(n(l))}}function qt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Ra(n,s){return n===He?s:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?qt(u,this.onsuccess):u),f&&(this.onerror=this.onerror?qt(f,this.onerror):f),h!==void 0?h:l}}function Pa(n,s){return n===He?s:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?qt(l,this.onsuccess):l),u&&(this.onerror=this.onerror?qt(u,this.onerror):u)}}function sr(n,s){return n===He?s:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),h=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?qt(f,this.onsuccess):f),h&&(this.onerror=this.onerror?qt(h,this.onerror):h),u===void 0?g===void 0?void 0:g:v(u,g)}}function ia(n,s){return n===He?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function ir(n,s){return n===He?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return s.apply(u,h)})}return s.apply(this,arguments)}}fe.ModifyError=Je,fe.DexieError=Ae,fe.BulkError=De;var Xt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Oa(n){Xt=n}var Tr={},oa=100,yn=typeof Promise>"u"?[]:(gt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[yn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(yn),gt]:[gt,p(gt),gt]),gt=yn[0],ha=yn[1],ha=ha&&ha.then,yt=gt&&gt.constructor,Ar=!!yn[2],or=function(n,s){Hn.push([n,s]),lr&&(queueMicrotask(fr),lr=!1)},la=!0,lr=!0,Dn=[],Gn=[],ur=rn,bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:He,pgp:!1,env:{},finalize:He},Ie=bt,Hn=[],bn=0,ua=[];function be(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Ie;if(typeof n!="function"){if(n!==Tr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Wn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(u,f){try{f(function(h){if(u._state===null){if(h===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&dr();h&&typeof h.then=="function"?l(u,function(m,C){h instanceof be?h._then(m,C):h.then(m,C)}):(u._state=!0,u._value=h,ys(u)),g&&Yn()}},Wn.bind(null,u))}catch(h){Wn(u,h)}})(this,n)}var cr={get:function(){var n=Ie,s=Pr;function l(u,f){var h=this,g=!n.global&&(n!==Ie||s!==Pr),m=g&&!wn(),C=new be(function(N,I){Da(h,new ms(T(u,n,g,m),T(f,n,g,m),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return l.prototype=Tr,l},set:function(n){D(this,"then",n&&n.prototype===Tr?cr:{get:function(){return n},set:cr.set})}};function ms(n,s,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=u,this.psd=f}function Wn(n,s){var l,u;Gn.push(s),n._state===null&&(l=n._lib&&dr(),s=ur(s),n._state=!1,n._value=s,u=n,Dn.some(function(f){return f._value===u._value})||Dn.push(u),ys(n),l)&&Yn()}function ys(n){var s=n._listeners;n._listeners=[];for(var l=0,u=s.length;l<u;++l)Da(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),bn===0&&(++bn,or(function(){--bn==0&&Cr()},[]))}function Da(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++bn,or(ft,[l,n,s])}}function ft(n,s,l){try{var u,f=s._value;!s._state&&Gn.length&&(Gn=[]),u=Xt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||Gn.indexOf(f)!==-1||(h=>{for(var g=Dn.length;g;)if(Dn[--g]._value===h._value)return Dn.splice(g,1)})(s),l.resolve(u)}catch(h){l.reject(h)}finally{--bn==0&&Cr(),--l.psd.ref||l.psd.finalize()}}function fr(){Re(bt,function(){dr()&&Yn()})}function dr(){var n=la;return lr=la=!1,n}function Yn(){var n,s,l;do for(;0<Hn.length;)for(n=Hn,Hn=[],l=n.length,s=0;s<l;++s){var u=n[s];u[0].apply(null,u[1])}while(0<Hn.length);lr=la=!0}function Cr(){for(var n=Dn,s=(Dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),ua.slice(0)),l=s.length;l;)s[--l]()}function Ir(n){return new be(Tr,!1,n)}function nt(n,s){var l=Ie;return function(){var u=dr(),f=Ie;try{return kn(l,!0),n.apply(this,arguments)}catch(h){s&&s(h)}finally{kn(f,!1),u&&Yn()}}}b(be.prototype,{then:cr,_then:function(n,s){Da(this,new ms(null,null,n,s,Ie))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(u){return(u instanceof s?l:Ir)(u)}):this.then(null,function(u){return(u&&u.name===s?l:Ir)(u)}))},finally:function(n){return this.then(function(s){return be.resolve(n()).then(function(){return s})},function(s){return be.resolve(n()).then(function(){return Ir(s)})})},timeout:function(n,s){var l=this;return n<1/0?new be(function(u,f){var h=setTimeout(function(){return f(new ke.Timeout(s))},n);l.then(u,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&D(be.prototype,Symbol.toStringTag,"Dexie.Promise"),bt.env=_s(),b(be,{all:function(){var n=te.apply(null,arguments).map(Or);return new be(function(s,l){n.length===0&&s([]);var u=n.length;n.forEach(function(f,h){return be.resolve(f).then(function(g){n[h]=g,--u||s(n)},l)})})},resolve:function(n){return n instanceof be?n:n&&typeof n.then=="function"?new be(function(s,l){n.then(s,l)}):new be(Tr,!0,n)},reject:Ir,race:function(){var n=te.apply(null,arguments).map(Or);return new be(function(s,l){n.map(function(u){return be.resolve(u).then(s,l)})})},PSD:{get:function(){return Ie},set:function(n){return Ie=n}},totalEchoes:{get:function(){return Pr}},newPSD:_n,usePSD:Re,scheduler:{get:function(){return or},set:function(n){or=n}},rejectionMapper:{get:function(){return ur},set:function(n){ur=n}},follow:function(n,s){return new be(function(l,u){return _n(function(f,h){var g=Ie;g.unhandleds=[],g.onunhandled=h,g.finalize=qt(function(){var m,C=this;m=function(){C.unhandleds.length===0?f():h(C.unhandleds[0])},ua.push(function N(){m(),ua.splice(ua.indexOf(N),1)}),++bn,or(function(){--bn==0&&Cr()},[])},g.finalize),n()},s,l,u)})}}),yt&&(yt.allSettled&&D(be,"allSettled",function(){var n=te.apply(null,arguments).map(Or);return new be(function(s){n.length===0&&s([]);var l=n.length,u=new Array(l);n.forEach(function(f,h){return be.resolve(f).then(function(g){return u[h]={status:"fulfilled",value:g}},function(g){return u[h]={status:"rejected",reason:g}}).then(function(){return--l||s(u)})})})}),yt.any&&typeof AggregateError<"u"&&D(be,"any",function(){var n=te.apply(null,arguments).map(Or);return new be(function(s,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(h,g){return be.resolve(h).then(function(m){return s(m)},function(m){f[g]=m,--u||l(new AggregateError(f))})})})}),yt.withResolvers)&&(be.withResolvers=yt.withResolvers);var mt={awaits:0,echoes:0,id:0},an=0,sn=[],Rr=0,Pr=0,Ma=0;function _n(n,g,l,u){var f=Ie,h=Object.create(f),g=(h.parent=f,h.ref=0,h.global=!1,h.id=++Ma,bt.env,h.env=Ar?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},g&&v(h,g),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Re(h,n,l,u));return h.ref===0&&h.finalize(),g}function Pt(){return mt.id||(mt.id=++an),++mt.awaits,mt.echoes+=oa,mt.id}function wn(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*oa,!0)}function Or(n){return mt.echoes&&n&&n.constructor===yt?(Pt(),n.then(function(s){return wn(),s},function(s){return wn(),pe(s)})):n}function bs(){var n=sn[sn.length-1];sn.pop(),kn(n,!1)}function kn(n,s){var l,u,f=Ie;(s?!mt.echoes||Rr++&&n===Ie:!Rr||--Rr&&n===Ie)||queueMicrotask(s?(function(h){++Pr,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),sn.push(Ie),kn(h,!0)}).bind(null,n):bs),n!==Ie&&(Ie=n,f===bt&&(bt.env=_s()),Ar)&&(l=bt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function _s(){var n=o.Promise;return Ar?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Re(n,s,l,u,f){var h=Ie;try{return kn(n,!0),s(l,u,f)}finally{kn(h,!1)}}function T(n,s,l,u){return typeof n!="function"?n:function(){var f=Ie;l&&Pt(),kn(s,!0);try{return n.apply(this,arguments)}finally{kn(f,!1),u&&queueMicrotask(wn)}}}function ue(n){Promise===yt&&mt.echoes===0?Rr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ha).indexOf("[native code]")===-1&&(Pt=wn=He);var pe=be.reject,Xe="ï¿¿",rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",it="String expected.",dt=[],Ut="__dbnames",Mn="readonly",Dr="readwrite";function st(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=ae(s))[n],s}}function Ho(){throw ke.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function We(n,s){try{var l=Wo(n),u=Wo(s);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=Yo(n),h=Yo(s),g=f.length,m=h.length,C=g<m?g:m,N=0;N<C;++N)if(f[N]!==h[N])return f[N]<h[N]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var I=n,E=s,P=I.length,O=E.length,R=P<O?P:O,A=0;A<R;++A){var q=We(I[A],E[A]);if(q!==0)return q}return P===O?0:P<O?-1:1}}catch{}return NaN}function Wo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=W(n))==="ArrayBuffer")?"binary":s}function Yo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ws(n,s,l){var u=n.schema.yProps;return u?(s&&0<l.numFailures&&(s=s.filter(function(f,h){return!l.failures[h]})),Promise.all(u.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}Vo.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var u=s.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Na=Vo;function Vo(n){this["@@propmod"]=n}function Xo(n,s){for(var l=c(s),u=l.length,f=!1,h=0;h<u;++h){var g=l[h],m=s[g],C=le(n,g);m instanceof Na?(Z(n,g,m.execute(C)),f=!0):C!==m&&(Z(n,g,m),f=!0)}return f}at.prototype._trans=function(n,s,l){var u=this._tx||Ie.trans,f=this.name,h=Xt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,E){if(E.schema[f])return s(E.idbtrans,E);throw new ke.NotFound("Table "+f+" not part of transaction")}var m=dr();try{var C=u&&u.db._novip===this.db._novip?u===Ie.trans?u._promise(n,g,l):_n(function(){return u._promise(n,g,l)},{trans:u,transless:Ie.transless||Ie}):(function N(I,E,P,O){if(I.idbdb&&(I._state.openComplete||Ie.letThrough||I._vip)){var R=I._createTransaction(E,P,I._dbSchema);try{R.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,O)})):pe(A)}return R._promise(E,function(A,q){return _n(function(){return Ie.trans=R,O(A,q,R)})}).then(function(A){if(E==="readwrite")try{R.idbtrans.commit()}catch{}return E==="readonly"?A:R._completion.then(function(){return A})})}if(I._state.openComplete)return pe(new ke.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return pe(new ke.DatabaseClosed);I.open().catch(He)}return I._state.dbReadyPromise.then(function(){return N(I,E,P,O)})})(this.db,n,[this.name],g);return h&&(C._consoleTask=h,C=C.catch(function(N){return console.trace(N),pe(N)})),C}finally{m&&Yn()}},at.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?pe(new ke.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},at.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=c(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&s.every(function(N){return 0<=m.keyPath.indexOf(N)})){for(var C=0;C<s.length;++C)if(s.indexOf(m.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(m,C){return m.keyPath.length-C.keyPath.length})[0];if(l&&this.db._maxKey!==Xe)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(m){return n[m]}));!l&&Xt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var u=this.schema.idxByName;function f(m,C){return We(m,C)===0}var g=s.reduce(function(I,C){var N=I[0],I=I[1],E=u[C],P=n[C];return[N||E,N||!E?st(I,E&&E.multi?function(O){return O=le(O,C),d(O)&&O.some(function(R){return f(P,R)})}:function(O){return f(P,le(O,C))}):I]},[null,null]),h=g[0],g=g[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},at.prototype.filter=function(n){return this.toCollection().and(n)},at.prototype.count=function(n){return this.toCollection().count(n)},at.prototype.offset=function(n){return this.toCollection().offset(n)},at.prototype.limit=function(n){return this.toCollection().limit(n)},at.prototype.each=function(n){return this.toCollection().each(n)},at.prototype.toArray=function(n){return this.toCollection().toArray(n)},at.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},at.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},at.prototype.reverse=function(){return this.toCollection().reverse()},at.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Ho&&(n=(g=>{var m=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=m}function I(){return g!==null&&g.apply(this,arguments)||this}return r(m,C),m.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),I.prototype.table=function(){return l},I})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function h(g){if(!g)return g;var m,C=Object.create(n.prototype);for(m in g)if(!u.has(m))try{C[m]=g[m]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},at.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},at.prototype.add=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Mr(h)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(m){return m.numFailures?be.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Z(n,h,m)}catch{}return m})},at.prototype.upsert=function(n,s){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var g=h??{};return Xo(g,s),u&&Z(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(m){return m.numFailures?be.reject(m.failures[0]):!!h})})})},at.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=le(n,this.schema.primKey.keyPath))===void 0?pe(new ke.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},at.prototype.put=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Mr(h)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(m){return m.numFailures?be.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Z(n,h,m)}catch{}return m})},at.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ws(s,[n],u)}).then(function(u){return u.numFailures?be.reject(u.failures[0]):void 0})})},at.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:La}).then(function(l){return ws(n,null,l)})}).then(function(s){return s.numFailures?be.reject(s.failures[0]):void 0})},at.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return s.hook.reading.fire(f)})})})},at.prototype.bulkAdd=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new ke.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:h}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return h?I.results:I.lastResult;throw new De("".concat(u.name,".bulkAdd(): ").concat(E," of ").concat(C," operations failed"),P)})})},at.prototype.bulkPut=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new ke.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:h}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return h?I.results:I.lastResult;throw new De("".concat(u.name,".bulkPut(): ").concat(E," of ").concat(C," operations failed"),P)})})},at.prototype.bulkUpdate=function(n){var s=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),h=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var C=[],N=[],I=(n.forEach(function(E,P){var O=E.key,R=E.changes,A=m[P];if(A){for(var q=0,B=Object.keys(R);q<B.length;q++){var L=B[q],V=R[L];if(L===s.schema.primKey.keyPath){if(We(V,O)!==0)throw new ke.Constraint("Cannot update primary key in bulkUpdate()")}else Z(A,L,V)}h.push(P),C.push(O),N.push(A)}}),C.length);return l.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(E){var P=E.numFailures,O=E.failures;if(P===0)return I;for(var R=0,A=Object.keys(O);R<A.length;R++){var q,B=A[R],L=h[Number(B)];L!=null&&(q=O[B],delete O[B],O[L]=q)}throw new De("".concat(s.name,".bulkUpdate(): ").concat(P," of ").concat(I," operations failed"),O)})})})},at.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ws(s,n,f)})}).then(function(u){var f=u.numFailures,h=u.failures;if(f===0)return u.lastResult;throw new De("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var Qo=at;function at(){}function qa(n){function s(g,m){if(m){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return l[g].subscribe.apply(null,N),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=h;for(var u=1,f=arguments.length;u<f;++u)h(arguments[u]);return s;function h(g,m,C){var N,I;if(typeof g!="object")return m=m||ia,I={subscribers:[],fire:C=C||He,subscribe:function(E){I.subscribers.indexOf(E)===-1&&(I.subscribers.push(E),I.fire=m(I.fire,E))},unsubscribe:function(E){I.subscribers=I.subscribers.filter(function(P){return P!==E}),I.fire=I.subscribers.reduce(m,C)}},l[g]=s[g]=I;c(N=g).forEach(function(E){var P=N[E];if(d(P))h(E,N[E][0],N[E][1]);else{if(P!=="asap")throw new ke.InvalidArgument("Invalid event config");var O=h(E,rn,function(){for(var R=arguments.length,A=new Array(R);R--;)A[R]=arguments[R];O.subscribers.forEach(function(q){J(function(){q.apply(null,A)})})})}})}}function ja(n,s){return j(s).from({prototype:n}),s}function ca(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function di(n,s){n.filter=st(n.filter,s)}function hi(n,s,l){var u=n.replayFilter;n.replayFilter=u?function(){return st(u(),s())}:s,n.justLimit=l&&!u}function ks(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new ke.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function Zo(n,s,l){var u=ks(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function xs(n,s,l,u){var f,h,g=n.replayFilter?st(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(m,C,N){var I,E;g&&!g(C,N,function(P){return C.stop(P)},function(P){return C.fail(P)})||((E=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(I)),_(f,E))||(f[E]=!0,s(m,C,N))},Promise.all([n.or._iterate(h,l),$o(Zo(n,u,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):$o(Zo(n,u,l),st(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function $o(n,s,l,u){var f=nt(u?function(h,g,m){return l(u(h),g,m)}:l);return n.then(function(h){if(h)return h.start(function(){var g=function(){return h.continue()};s&&!s(h,function(m){return g=m},function(m){h.stop(m),g=He},function(m){h.fail(m),g=He})||f(h.value,h,function(m){return g=m}),g()})})}Qe.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,pe.bind(null,l.error)):l.table._trans("readonly",n).then(s)},Qe.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,pe.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},Qe.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=st(s.algorithm,n)},Qe.prototype._iterate=function(n,s){return xs(this._ctx,n,s,this._ctx.table.core)},Qe.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},Qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Qe.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return xs(s,n,l,s.table.core)})},Qe.prototype.count=function(n){var s=this;return this._read(function(l){var u,f=s._ctx,h=f.table.core;return ca(f,!0)?h.count({trans:l,query:{index:ks(f,h.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,xs(f,function(){return++u,!1},l,h).then(function(){return u}))}).then(n)},Qe.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function h(C,N){return N?h(C[l[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function m(C,N){return We(h(C,f),h(N,f))*g}return this.toArray(function(C){return C.sort(m)}).then(s)},Qe.prototype.toArray=function(n){var s=this;return this._read(function(l){var u,f,h,g=s._ctx;return g.dir==="next"&&ca(g,!0)&&0<g.limit?(u=g.valueMapper,f=ks(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(h=[],xs(g,function(m){return h.push(m)},l,g.table.core).then(function(){return h}))},n)},Qe.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,ca(s)?hi(s,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):hi(s,function(){var l=n;return function(){return--l<0}})),this},Qe.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),hi(this._ctx,function(){var s=n;return function(l,u,f){return--s<=0&&u(f),0<=s}},!0),this},Qe.prototype.until=function(n,s){return di(this._ctx,function(l,u,f){return!n(l.value)||(u(f),s)}),this},Qe.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},Qe.prototype.last=function(n){return this.reverse().first(n)},Qe.prototype.filter=function(n){var s;return di(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=st(s.isMatch,n),this},Qe.prototype.and=function(n){return this.filter(n)},Qe.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Qe.prototype.desc=function(){return this.reverse()},Qe.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.key,u)})},Qe.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Qe.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},Qe.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},Qe.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&ca(s,!0)&&0<s.limit)return this._read(function(u){var f=ks(s,s.table.core.schema);return s.table.core.query({trans:u,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(u){return u.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},Qe.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Qe.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},Qe.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Qe.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},di(this._ctx,function(u){var u=u.primaryKey.toString(),f=_(n,u);return n[u]=!0,!f})),this},Qe.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(u){function f(A,q){var B=q.failures;P+=A-q.numFailures;for(var L=0,V=c(B);L<V.length;L++){var se=V[L];E.push(B[se])}}var h=typeof n=="function"?n:function(A){return Xo(A,n)},g=l.table.core,I=g.schema.primaryKey,m=I.outbound,C=I.extractKey,N=200,I=s.db._options.modifyChunkSize,E=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),P=0,O=[],R=n===Jo;return s.clone().primaryKeys().then(function(A){function q(L){var V=Math.min(N,A.length-L),se=A.slice(L,L+V);return(R?Promise.resolve([]):g.getMany({trans:u,keys:se,cache:"immutable"})).then(function(ve){var ge=[],oe=[],Ee=m?[]:null,xe=R?se:[];if(!R)for(var de=0;de<V;++de){var Ce=ve[de],Ye={value:ae(Ce),primKey:A[L+de]};h.call(Ye,Ye.value,Ye)!==!1&&(Ye.value==null?xe.push(A[L+de]):m||We(C(Ce),C(Ye.value))===0?(oe.push(Ye.value),m&&Ee.push(A[L+de])):(xe.push(A[L+de]),ge.push(Ye.value)))}return Promise.resolve(0<ge.length&&g.mutate({trans:u,type:"add",values:ge}).then(function(Ze){for(var qe in Ze.failures)xe.splice(parseInt(qe),1);f(ge.length,Ze)})).then(function(){return(0<oe.length||B&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Ee,values:oe,criteria:B,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<L}).then(function(Ze){return f(oe.length,Ze)})}).then(function(){return(0<xe.length||B&&R)&&g.mutate({trans:u,type:"delete",keys:xe,criteria:B,isAdditionalChunk:0<L}).then(function(Ze){return ws(l.table,xe,Ze)}).then(function(Ze){return f(xe.length,Ze)})}).then(function(){return A.length>L+V&&q(L+N)})})}var B=ca(l)&&l.limit===1/0&&(typeof n!="function"||R)&&{index:l.index,range:l.range};return q(0).then(function(){if(0<E.length)throw new Je("Error modifying one or more objects",E,P,O);return A.length})})})},Qe.prototype.delete=function(){var n=this._ctx,s=n.range;return!ca(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(Jo):this._write(function(l){var u=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(C){var m=C.failures,C=C.numFailures;if(C)throw new Je("Could not delete some values",Object.keys(m).map(function(N){return m[N]}),h-C);return h-C})})})};var qc=Qe;function Qe(){}var Jo=function(n,s){return s.value=null};function jc(n,s){return n<s?-1:n===s?0:1}function Bc(n,s){return s<n?-1:n===s?0:1}function Qt(n,s,l){return n=n instanceof tl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function fa(n){return new n.Collection(n,function(){return el("")}).limit(0)}function Ss(O,s,l,u){var f,h,g,m,C,N,I,E=l.length;if(!l.every(function(A){return typeof A=="string"}))return Qt(O,it);function P(A){f=A==="next"?function(B){return B.toUpperCase()}:function(B){return B.toLowerCase()},h=A==="next"?function(B){return B.toLowerCase()}:function(B){return B.toUpperCase()},g=A==="next"?jc:Bc;var q=l.map(function(B){return{lower:h(B),upper:f(B)}}).sort(function(B,L){return g(B.lower,L.lower)});m=q.map(function(B){return B.upper}),C=q.map(function(B){return B.lower}),I=(N=A)==="next"?"":u}P("next");var O=new O.Collection(O,function(){return hr(m[0],C[E-1]+u)}),R=(O._ondirectionchange=function(A){P(A)},0);return O._addAlgorithm(function(A,q,B){var L=A.key;if(typeof L=="string"){var V=h(L);if(s(V,C,R))return!0;for(var se=null,ve=R;ve<E;++ve){var ge=((oe,Ee,xe,de,Ce,Ye)=>{for(var Ze=Math.min(oe.length,de.length),qe=-1,Be=0;Be<Ze;++Be){var ot=Ee[Be];if(ot!==de[Be])return Ce(oe[Be],xe[Be])<0?oe.substr(0,Be)+xe[Be]+xe.substr(Be+1):Ce(oe[Be],de[Be])<0?oe.substr(0,Be)+de[Be]+xe.substr(Be+1):0<=qe?oe.substr(0,qe)+Ee[qe]+xe.substr(qe+1):null;Ce(oe[Be],ot)<0&&(qe=Be)}return Ze<de.length&&Ye==="next"?oe+xe.substr(oe.length):Ze<oe.length&&Ye==="prev"?oe.substr(0,xe.length):qe<0?null:oe.substr(0,qe)+de[qe]+xe.substr(qe+1)})(L,V,m[ve],C[ve],g,N);ge===null&&se===null?R=ve+1:(se===null||0<g(se,ge))&&(se=ge)}q(se!==null?function(){A.continue(se+I)}:B)}return!1}),O}function hr(n,s,l,u){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:u}}function el(n){return{type:1,lower:n,upper:n}}Object.defineProperty(_t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_t.prototype.between=function(n,s,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||u)&&(!l||!u)?fa(this):new this.Collection(this,function(){return hr(n,s,!l,!u)})}catch{return Qt(this,rt)}},_t.prototype.equals=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return el(n)})},_t.prototype.above=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return hr(n,void 0,!0)})},_t.prototype.aboveOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return hr(n,void 0,!1)})},_t.prototype.below=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return hr(void 0,n,!1,!0)})},_t.prototype.belowOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return hr(void 0,n)})},_t.prototype.startsWith=function(n){return typeof n!="string"?Qt(this,it):this.between(n,n+Xe,!0,!0)},_t.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ss(this,function(s,l){return s.indexOf(l[0])===0},[n],Xe)},_t.prototype.equalsIgnoreCase=function(n){return Ss(this,function(s,l){return s===l[0]},[n],"")},_t.prototype.anyOfIgnoreCase=function(){var n=te.apply(ne,arguments);return n.length===0?fa(this):Ss(this,function(s,l){return l.indexOf(s)!==-1},n,"")},_t.prototype.startsWithAnyOfIgnoreCase=function(){var n=te.apply(ne,arguments);return n.length===0?fa(this):Ss(this,function(s,l){return l.some(function(u){return s.indexOf(u)===0})},n,Xe)},_t.prototype.anyOf=function(){var n,s,l=this,u=te.apply(ne,arguments),f=this._cmp;try{u.sort(f)}catch{return Qt(this,rt)}return u.length===0?fa(this):((n=new this.Collection(this,function(){return hr(u[0],u[u.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,u.sort(f)},s=0,n._addAlgorithm(function(h,g,m){for(var C=h.key;0<f(C,u[s]);)if(++s===u.length)return g(m),!1;return f(C,u[s])===0||(g(function(){h.continue(u[s])}),!1)}),n)},_t.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_t.prototype.noneOf=function(){var n=te.apply(ne,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Qt(this,rt)}var s=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},_t.prototype.inAnyRange=function(n,B){var l=this,u=this._cmp,f=this._ascending,h=this._descending,g=this._min,m=this._max;if(n.length===0)return fa(this);if(!n.every(function(L){return L[0]!==void 0&&L[1]!==void 0&&f(L[0],L[1])<=0}))return Qt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ke.InvalidArgument);var C=!B||B.includeLowers!==!1,N=B&&B.includeUppers===!0,I,E=f;function P(L,V){return E(L[0],V[0])}try{(I=n.reduce(function(L,V){for(var se=0,ve=L.length;se<ve;++se){var ge=L[se];if(u(V[0],ge[1])<0&&0<u(V[1],ge[0])){ge[0]=g(ge[0],V[0]),ge[1]=m(ge[1],V[1]);break}}return se===ve&&L.push(V),L},[])).sort(P)}catch{return Qt(this,rt)}var O=0,R=N?function(L){return 0<f(L,I[O][1])}:function(L){return 0<=f(L,I[O][1])},A=C?function(L){return 0<h(L,I[O][0])}:function(L){return 0<=h(L,I[O][0])},q=R,B=new this.Collection(this,function(){return hr(I[0][0],I[I.length-1][1],!C,!N)});return B._ondirectionchange=function(L){E=L==="next"?(q=R,f):(q=A,h),I.sort(P)},B._addAlgorithm(function(L,V,se){for(var ve,ge=L.key;q(ge);)if(++O===I.length)return V(se),!1;return!R(ve=ge)&&!A(ve)||(l._cmp(ge,I[O][1])===0||l._cmp(ge,I[O][0])===0||V(function(){E===f?L.continue(I[O][0]):L.continue(I[O][1])}),!1)}),B},_t.prototype.startsWithAnyOf=function(){var n=te.apply(ne,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?fa(this):this.inAnyRange(n.map(function(s){return[s,s+Xe]})):Qt(this,"startsWithAnyOf() only works with strings")};var tl=_t;function _t(){}function Ln(n){return nt(function(s){return Ba(s),n(s.target.error),!1})}function Ba(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var za="storagemutated",pi="x-storagemutated-1",pr=qa(null,za),zc=(Nn.prototype._lock=function(){return U(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},Nn.prototype._unlock=function(){if(U(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Re(n[1],n[0])}catch{}}return this},Nn.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},Nn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(U(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new ke.DatabaseClosed(u);case"MissingAPIError":throw new ke.MissingAPI(u.message,u);default:throw new ke.OpenFailed(u)}if(!this.active)throw new ke.TransactionInactive;U(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=nt(function(f){Ba(f),s._reject(n.error)}),n.onabort=nt(function(f){Ba(f),s.active&&s._reject(new ke.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=nt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&pr.storagemutated.fire(n.mutatedParts)})}return this},Nn.prototype._promise=function(n,s,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?pe(new ke.ReadOnly("Transaction is readonly")):this.active?this._locked()?new be(function(h,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(h,g)},Ie])}):l?_n(function(){var h=new be(function(g,m){f._lock();var C=s(g,m,f);C&&C.then&&C.then(g,m)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((u=new be(function(h,g){var m=s(h,g,f);m&&m.then&&m.then(h,g)}))._lib=!0,u):pe(new ke.TransactionInactive)},Nn.prototype._root=function(){return this.parent?this.parent._root():this},Nn.prototype.waitFor=function(n){var s,l=this._root(),u=be.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=h)})()),l._waitingFor);return new be(function(h,g){u.then(function(m){return l._waitingQueue.push(nt(h.bind(null,m)))},function(m){return l._waitingQueue.push(nt(g.bind(null,m)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Nn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ke.Abort))},Nn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(_(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new ke.NotFound("Table "+n+" not part of transaction")},Nn);function Nn(){}function vi(n,s,l,u,f,h,g,m){return{name:n,keyPath:s,unique:l,multi:u,auto:f,compound:h,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+nl(s),type:m}}function nl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function gi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,h,g){return h=u(h,g),h&&(f[h[0]]=h[1]),f},{}))};var u}var Fa=function(n){try{return n.only([[]]),Fa=function(){return[[]]},[[]]}catch{return Fa=function(){return Xe},Xe}};function mi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return le(l,s)}:function(l){return le(l,n)};var s}function rl(n){return[].slice.call(n)}var Fc=0;function Ka(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Kc(n,s,C){function u(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=R.lower,P=R.upper,O=R.lowerOpen,R=R.upperOpen;return E===void 0?P===void 0?null:s.upperBound(P,!!R):P===void 0?s.lowerBound(E,!!O):s.bound(E,P,!!O,!!R)}function f(I){var E,P=I.name;return{name:P,schema:I,mutate:function(O){var R=O.trans,A=O.type,q=O.keys,B=O.values,L=O.range;return new Promise(function(V,se){V=nt(V);var ve=R.objectStore(P),ge=ve.keyPath==null,oe=A==="put"||A==="add";if(!oe&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var Ee,xe=(q||B||{length:1}).length;if(q&&B&&q.length!==B.length)throw new Error("Given keys array must have same length as given values array.");if(xe===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function de(ct){++Ze,Ba(ct)}var Ce=[],Ye=[],Ze=0;if(A==="deleteRange"){if(L.type===4)return V({numFailures:Ze,failures:Ye,results:[],lastResult:void 0});L.type===3?Ce.push(Ee=ve.clear()):Ce.push(Ee=ve.delete(u(L)))}else{var ge=oe?ge?[B,q]:[B,null]:[q,null],qe=ge[0],Be=ge[1];if(oe)for(var ot=0;ot<xe;++ot)Ce.push(Ee=Be&&Be[ot]!==void 0?ve[A](qe[ot],Be[ot]):ve[A](qe[ot])),Ee.onerror=de;else for(ot=0;ot<xe;++ot)Ce.push(Ee=ve[A](qe[ot])),Ee.onerror=de}function on(ct){ct=ct.target.result,Ce.forEach(function(qr,Li){return qr.error!=null&&(Ye[Li]=qr.error)}),V({numFailures:Ze,failures:Ye,results:A==="delete"?q:Ce.map(function(qr){return qr.result}),lastResult:ct})}Ee.onerror=function(ct){de(ct),on(ct)},Ee.onsuccess=on})},getMany:function(O){var R=O.trans,A=O.keys;return new Promise(function(q,B){q=nt(q);for(var L,V=R.objectStore(P),se=A.length,ve=new Array(se),ge=0,oe=0,Ee=function(Ce){Ce=Ce.target,ve[Ce._pos]=Ce.result,++oe===ge&&q(ve)},xe=Ln(B),de=0;de<se;++de)A[de]!=null&&((L=V.get(A[de]))._pos=de,L.onsuccess=Ee,L.onerror=xe,++ge);ge===0&&q(ve)})},get:function(O){var R=O.trans,A=O.key;return new Promise(function(q,B){q=nt(q);var L=R.objectStore(P).get(A);L.onsuccess=function(V){return q(V.target.result)},L.onerror=Ln(B)})},query:(E=m,function(O){return new Promise(function(R,A){R=nt(R);var q,B,L,oe=O.trans,V=O.values,se=O.limit,ge=O.query,ve=se===1/0?void 0:se,Ee=ge.index,ge=ge.range,oe=oe.objectStore(P),oe=Ee.isPrimaryKey?oe:oe.index(Ee.name),Ee=u(ge);if(se===0)return R({result:[]});E?((ge=V?oe.getAll(Ee,ve):oe.getAllKeys(Ee,ve)).onsuccess=function(xe){return R({result:xe.target.result})},ge.onerror=Ln(A)):(q=0,B=!V&&"openKeyCursor"in oe?oe.openKeyCursor(Ee):oe.openCursor(Ee),L=[],B.onsuccess=function(xe){var de=B.result;return!de||(L.push(V?de.value:de.primaryKey),++q===se)?R({result:L}):void de.continue()},B.onerror=Ln(A))})}),openCursor:function(O){var R=O.trans,A=O.values,q=O.query,B=O.reverse,L=O.unique;return new Promise(function(V,se){V=nt(V);var oe=q.index,ve=q.range,ge=R.objectStore(P),ge=oe.isPrimaryKey?ge:ge.index(oe.name),oe=B?L?"prevunique":"prev":L?"nextunique":"next",Ee=!A&&"openKeyCursor"in ge?ge.openKeyCursor(u(ve),oe):ge.openCursor(u(ve),oe);Ee.onerror=Ln(se),Ee.onsuccess=nt(function(xe){var de,Ce,Ye,Ze,qe=Ee.result;qe?(qe.___id=++Fc,qe.done=!1,de=qe.continue.bind(qe),Ce=(Ce=qe.continuePrimaryKey)&&Ce.bind(qe),Ye=qe.advance.bind(qe),Ze=function(){throw new Error("Cursor not stopped")},qe.trans=R,qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=function(){throw new Error("Cursor not started")},qe.fail=nt(se),qe.next=function(){var Be=this,ot=1;return this.start(function(){return ot--?Be.continue():Be.stop()}).then(function(){return Be})},qe.start=function(Be){function ot(){if(Ee.result)try{Be()}catch(ct){qe.fail(ct)}else qe.done=!0,qe.start=function(){throw new Error("Cursor behind last entry")},qe.stop()}var on=new Promise(function(ct,qr){ct=nt(ct),Ee.onerror=Ln(qr),qe.fail=qr,qe.stop=function(Li){qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=Ze,ct(Li)}});return Ee.onsuccess=nt(function(ct){Ee.onsuccess=ot,ot()}),qe.continue=de,qe.continuePrimaryKey=Ce,qe.advance=Ye,ot(),on},V(qe)):V(null)},se)})},count:function(O){var R=O.query,A=O.trans,q=R.index,B=R.range;return new Promise(function(L,V){var se=A.objectStore(P),se=q.isPrimaryKey?se:se.index(q.name),ve=u(B),ve=ve?se.count(ve):se.count();ve.onsuccess=nt(function(ge){return L(ge.target.result)}),ve.onerror=Ln(V)})}}}h=C,g=rl((C=n).objectStoreNames);var h,C={schema:{name:C.name,tables:g.map(function(I){return h.objectStore(I)}).map(function(I){var E=I.keyPath,P=I.autoIncrement,R=d(E),O={},R={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:R,keyPath:E,autoIncrement:P,unique:!0,extractKey:mi(E)},indexes:rl(I.indexNames).map(function(A){return I.index(A)}).map(function(L){var V=L.name,q=L.unique,B=L.multiEntry,L=L.keyPath,V={name:V,compound:d(L),keyPath:L,unique:q,multiEntry:B,extractKey:mi(L)};return O[Ka(L)]=V}),getIndexByKeyPath:function(A){return O[Ka(A)]}};return O[":id"]=R.primaryKey,E!=null&&(O[Ka(E)]=R.primaryKey),R})},hasGetAll:0<g.length&&"getAll"in h.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,m=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Fa(s),schema:g}}function Uc(n,s,l,u){return l=l.IDBKeyRange,s=Kc(s,l,u),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,a(a({},f),h(f))},s)}}function Es(n,s){var l=s.db,l=Uc(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(h){return h.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function Ts(n,s,l,u){l.forEach(function(f){var h=u[f];s.forEach(function(g){var m=(function C(N,I){return S(N,I)||(N=p(N))&&C(N,I)})(g,f);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?D(g,f,{get:function(){return this.table(f)},set:function(C){w(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,h))})})}function yi(n,s){s.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function Gc(n,s){return n._cfg.version-s._cfg.version}function Hc(n,s,l,u){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=gi("$meta",sl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(h.create(l),h._completion.catch(u),h._reject.bind(h)),m=Ie.transless||Ie;_n(function(){if(Ie.trans=h,Ie.transless=m,s!==0)return Es(n,l),N=s,((C=h).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):be.resolve(N)).then(function(q){var E=n,P=q,O=h,R=l,A=[],q=E._versions,B=E._dbSchema=Cs(0,E.idbdb,R);return(q=q.filter(function(L){return L._cfg.version>=P})).length===0?be.resolve():(q.forEach(function(L){A.push(function(){var V,se,ve,ge=B,oe=L._cfg.dbschema,Ee=(Is(E,ge,R),Is(E,oe,R),B=E._dbSchema=oe,bi(ge,oe)),xe=(Ee.add.forEach(function(de){_i(R,de[0],de[1].primKey,de[1].indexes)}),Ee.change.forEach(function(de){if(de.recreate)throw new ke.Upgrade("Not yet support for changing primary key");var Ce=R.objectStore(de.name);de.add.forEach(function(Ye){return As(Ce,Ye)}),de.change.forEach(function(Ye){Ce.deleteIndex(Ye.name),As(Ce,Ye)}),de.del.forEach(function(Ye){return Ce.deleteIndex(Ye)})}),L._cfg.contentUpgrade);if(xe&&L._cfg.version>P)return Es(E,R),O._memoizedTables={},V=he(oe),Ee.del.forEach(function(de){V[de]=ge[de]}),yi(E,[E.Transaction.prototype]),Ts(E,[E.Transaction.prototype],c(V),V),O.schema=V,(se=K(xe))&&Pt(),oe=be.follow(function(){var de;(ve=xe(O))&&se&&(de=wn.bind(null,null),ve.then(de,de))}),ve&&typeof ve.then=="function"?be.resolve(ve):oe.then(function(){return ve})}),A.push(function(V){var se,ve,ge=L._cfg.dbschema;se=ge,ve=V,[].slice.call(ve.db.objectStoreNames).forEach(function(oe){return se[oe]==null&&ve.db.deleteObjectStore(oe)}),yi(E,[E.Transaction.prototype]),Ts(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),O.schema=E._dbSchema}),A.push(function(V){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===L._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(se){return se!=="$meta"})):V.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return A.length?be.resolve(A.shift()(O.idbtrans)).then(L):be.resolve()})().then(function(){al(B,R)}))}).catch(g);var C,N;c(f).forEach(function(I){_i(l,I,f[I].primKey,f[I].indexes)}),Es(n,l),be.follow(function(){return n.on.populate.fire(h)}).catch(g)})}function Wc(n,s){al(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Cs(0,n.idbdb,s);Is(n,n._dbSchema,s);for(var u=0,f=bi(l,n._dbSchema).change;u<f.length;u++){var h=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=s.objectStore(g.name);g.add.forEach(function(C){Xt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),As(m,C)})})(f[u]);if(typeof h=="object")return h.value}}function bi(n,s){var l,u={del:[],add:[],change:[]};for(l in n)s[l]||u.del.push(l);for(l in s){var f=n[l],h=s[l];if(f){var g={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=f.idxByName,C=h.idxByName,N=void 0;for(N in m)C[N]||g.del.push(N);for(N in C){var I=m[N],E=C[N];I?I.src!==E.src&&g.change.push(E):g.add.push(E)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,h])}return u}function _i(n,s,l,u){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(h){return As(f,h)})}function al(n,s){c(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(Xt&&console.debug("Dexie: Creating missing table",l),_i(s,l,n[l].primKey,n[l].indexes))})}function As(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Cs(n,s,l){var u={};return re(s.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),g=vi(nl(N=h.keyPath),N||"",!0,!1,!!h.autoIncrement,N&&typeof N!="string",!0),m=[],C=0;C<h.indexNames.length;++C){var I=h.index(h.indexNames[C]),N=I.keyPath,I=vi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);m.push(I)}u[f]=gi(f,g,m)}),u}function Is(n,s,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var h=u[f],g=l.objectStore(h);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var C,N=g.indexNames[m],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+re(I).join("+")+"]";s[h]&&(C=s[h].idxByName[I])&&(C.name=N,delete s[h].idxByName[I],s[h].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function sl(n){return n.split(",").map(function(s,l){var f=s.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return vi(f,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(h),l===0,u)})}da.prototype._createTableSchema=gi,da.prototype._parseIndexSyntax=sl,da.prototype._parseStoresSpec=function(n,s){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),h=f.shift();if(!h)throw new ke.Schema("Invalid schema for table "+u+": "+n[u]);if(h.unique=!0,h.multi)throw new ke.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new ke.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ke.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(u,h,f),s[u]=h}})},da.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),u={},f={};return l.forEach(function(h){v(u,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(u,f)}),s._dbSchema=f,yi(s,[s._allTables,s,s.Transaction.prototype]),Ts(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],c(f),f),s._storeNames=c(f),this},da.prototype.upgrade=function(n){return this._cfg.contentUpgrade=ir(this._cfg.contentUpgrade||He,n),this};var Yc=da;function da(){}function wi(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new Vn(Ut,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function ki(n){return n&&typeof n.databases=="function"}function xi(n){return _n(function(){return Ie.letThrough=!0,n()})}function Si(n){return!("from"in n)}var Ot=function(n,s){var l;if(!this)return l=new Ot,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ua(n,s,l){var u=We(s,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Si(n))return v(n,{from:s,to:l,d:1});var u=n.l,f=n.r;if(We(l,n.from)<0)return u?Ua(u,s,l):n.l={from:s,to:l,d:1,l:null,r:null},ol(n);if(0<We(s,n.to))return f?Ua(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},ol(n);We(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<We(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,u&&!n.l&&Ga(n,u),f&&s&&Ga(n,f)}}function Ga(n,s){Si(s)||(function l(u,f){var h=f.from,g=f.l,m=f.r;Ua(u,h,f.to),g&&l(u,g),m&&l(u,m)})(n,s)}function il(n,s){var l=Rs(s),u=l.next();if(!u.done)for(var f=u.value,h=Rs(n),g=h.next(f.from),m=g.value;!u.done&&!g.done;){if(We(m.from,f.to)<=0&&0<=We(m.to,f.from))return!0;We(f.from,m.from)<0?f=(u=l.next(m.from)).value:m=(g=h.next(f.from)).value}return!1}function Rs(n){var s=Si(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,u)for(;s.n.l&&We(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!u||We(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function ol(n){var s,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[s],(n[s]=l).d=ll(l)),n.d=ll(n)}function ll(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Ps(n,s){return c(s).forEach(function(l){n[l]?Ga(n[l],s[l]):n[l]=(function u(f){var h,g,m={};for(h in f)_(f,h)&&(g=f[h],m[h]=!g||typeof g!="object"||me.has(g.constructor)?g:u(g));return m})(s[l])}),n}function Ei(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&il(s[l],n[l])})}b(Ot.prototype,((gt={add:function(n){return Ga(this,n),this},addKey:function(n){return Ua(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ua(s,l,l)}),this},hasKey:function(n){var s=Rs(this).next(n).value;return s&&We(s.from,n)<=0&&0<=We(s.to,n)}})[Q]=function(){return Rs(this)},gt));var Lr={},Ti={},Ai=!1;function Os(n){Ps(Ti,n),Ai||(Ai=!0,setTimeout(function(){Ai=!1,Ci(Ti,!(Ti={}))},0))}function Ci(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Lr);u<f.length;u++)ul(m=f[u],n,l,s);else for(var h in n){var g,m,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(g=h[1],h=h[2],m=Lr["idb://".concat(g,"/").concat(h)])&&ul(m,n,l,s)}l.forEach(function(C){return C()})}function ul(n,s,l,u){for(var f=[],h=0,g=Object.entries(n.queries.query);h<g.length;h++){for(var m=g[h],C=m[0],N=[],I=0,E=m[1];I<E.length;I++){var P=E[I];Ei(s,P.obsSet)?P.subscribers.forEach(function(q){return l.add(q)}):u&&N.push(P)}u&&f.push([C,N])}if(u)for(var O=0,R=f;O<R.length;O++){var A=R[O],C=A[0],N=A[1];n.queries.query[C]=N}}function Vc(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?pe(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var u=s.openCanceller,f=Math.round(10*n.verno),h=!1;function g(){if(s.openCanceller!==u)throw new ke.DatabaseClosed("db.open() was cancelled")}function m(){return new be(function(P,O){if(g(),!l)throw new ke.MissingAPI;var R=n.name,A=s.autoSchema||!f?l.open(R):l.open(R,f);if(!A)throw new ke.MissingAPI;A.onerror=Ln(O),A.onblocked=nt(n._fireOnBlocked),A.onupgradeneeded=nt(function(q){var B;I=A.transaction,s.autoSchema&&!n._options.allowEmptyDB?(A.onerror=Ba,I.abort(),A.result.close(),(B=l.deleteDatabase(R)).onsuccess=B.onerror=nt(function(){O(new ke.NoSuchDatabase("Database ".concat(R," doesnt exist")))})):(I.onerror=Ln(O),B=q.oldVersion>Math.pow(2,62)?0:q.oldVersion,E=B<1,n.idbdb=A.result,h&&Wc(n,I),Hc(n,B/10,I,O))},O),A.onsuccess=nt(function(){I=null;var q,B,L,V,se,ve,ge=n.idbdb=A.result,oe=re(ge.objectStoreNames);if(0<oe.length)try{var Ee=ge.transaction((se=oe).length===1?se[0]:se,"readonly");if(s.autoSchema)ve=ge,V=Ee,(L=n).verno=ve.version/10,V=L._dbSchema=Cs(0,ve,V),L._storeNames=re(ve.objectStoreNames,0),Ts(L,[L._allTables],c(V),V);else if(Is(n,n._dbSchema,Ee),B=Ee,((B=bi(Cs(0,(q=n).idbdb,B),q._dbSchema)).add.length||B.change.some(function(xe){return xe.add.length||xe.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ge.close(),f=ge.version+1,h=!0,P(m());Es(n,Ee)}catch{}dt.push(n),ge.onversionchange=nt(function(xe){s.vcFired=!0,n.on("versionchange").fire(xe)}),ge.onclose=nt(function(){n.close({disableAutoOpen:!1})}),E&&(oe=n._deps,se=R,ki(ve=oe.indexedDB)||se===Ut||wi(ve,oe.IDBKeyRange).put({name:se}).catch(He)),P()},O)}).catch(function(P){switch(P==null?void 0:P.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<f)return f=0,m()}return be.reject(P)})}var C,N=s.dbReadyResolve,I=null,E=!1;return be.race([u,(typeof navigator>"u"?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function O(){return indexedDB.databases().finally(P)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(m)]).then(function(){return g(),s.onReadyBeingFired=[],be.resolve(xi(function(){return n.on.ready.fire(n.vip)})).then(function P(){var O;if(0<s.onReadyBeingFired.length)return O=s.onReadyBeingFired.reduce(ir,He),s.onReadyBeingFired=[],be.resolve(xi(function(){return O(n.vip)})).then(P)})}).finally(function(){s.openCanceller===u&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(P){s.dbOpenError=P;try{I&&I.abort()}catch{}return u===s.openCanceller&&n._close(),pe(P)}).finally(function(){s.openComplete=!0,N()}).then(function(){var P;return E&&(P={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(R){R.name&&(P["idb://".concat(n.name,"/").concat(O.name,"/").concat(R.name)]=new Ot(-1/0,[[[]]]))}),P["idb://".concat(n.name,"/").concat(O.name,"/")]=P["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Ot(-1/0,[[[]]])}),pr(za).fire(P),Ci(P,!0)),n})}function Ii(n){function s(h){return n.next(h)}var l=f(s),u=f(function(h){return n.throw(h)});function f(h){return function(m){var m=h(m),C=m.value;return m.done?C:C&&typeof C.then=="function"?C.then(l,u):d(C)?Promise.all(C).then(l,u):l(C)}}return f(s)()}function Ds(n,s,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(s);return u}var Xc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},h=[];function g(P,O,R){var L=Ka(P),A=f[L]=f[L]||[],q=P==null?0:typeof P=="string"?1:P.length,B=0<O,L=a(a({},R),{name:B?"".concat(L,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:B,keyTail:O,keyLength:q,extractKey:mi(P),unique:!B&&R.unique});return A.push(L),L.isPrimaryKey||h.push(L),1<q&&g(q===2?P[0]:P.slice(0,q-1),O+1,R),A.sort(function(V,se){return V.keyTail-se.keyTail}),L}var m=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[m];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function E(P){var O,R=P.query.index;return R.isVirtual?a(a({},P),{query:{index:R.lowLevelIndex,range:(O=P.query.range,R=R.keyTail,{type:O.type===1?2:O.type,lower:Ds(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,R),lowerOpen:!0,upper:Ds(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,R),upperOpen:!0})}}):P}return a(a({},l),{schema:a(a({},u),{primaryKey:m,indexes:h,getIndexByKeyPath:function(P){return(P=f[Ka(P)])&&P[0]}}),count:function(P){return l.count(E(P))},query:function(P){return l.query(E(P))},openCursor:function(P){var O=P.query.index,R=O.keyTail,A=O.keyLength;return O.isVirtual?l.openCursor(E(P)).then(function(B){return B&&q(B)}):l.openCursor(P);function q(B){return Object.create(B,{continue:{value:function(L){L!=null?B.continue(Ds(L,P.reverse?n.MAX_KEY:n.MIN_KEY,R)):P.unique?B.continue(B.key.slice(0,A).concat(P.reverse?n.MIN_KEY:n.MAX_KEY,R)):B.continue()}},continuePrimaryKey:{value:function(L,V){B.continuePrimaryKey(Ds(L,n.MAX_KEY,R),V)}},primaryKey:{get:function(){return B.primaryKey}},key:{get:function(){var L=B.key;return A===1?L[0]:L.slice(0,A)}},value:{get:function(){return B.value}}})}}})}})}};function Ri(n,s,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var h,g,m;_(s,f)?(h=n[f],g=s[f],typeof h=="object"&&typeof g=="object"&&h&&g?(m=W(h))!==W(g)?l[u+f]=s[f]:m==="Object"?Ri(h,g,l,u+f+"."):h!==g&&(l[u+f]=s[f]):h!==g&&(l[u+f]=s[f])):l[u+f]=void 0}),c(s).forEach(function(f){_(n,f)||(l[u+f]=s[f])}),l}function Pi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var Qc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),u=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var h=Ie.trans,g=h.table(s).hook,m=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===He)break;return h._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===He&&N.fire===He)break;return h._promise("readwrite",function(){return I(f)},!0);case"delete":if(m.fire===He)break;return h._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(m.fire===He)break;return h._promise("readwrite",function(){return(function E(P,O,R){return l.query({trans:P,values:!1,query:{index:u,range:O},limit:R}).then(function(A){var q=A.result;return I({type:"delete",keys:q,trans:P}).then(function(B){return 0<B.numFailures?Promise.reject(B.failures[0]):q.length<R?{failures:[],numFailures:0,lastResult:void 0}:E(P,a(a({},O),{lower:q[q.length-1],lowerOpen:!0}),R)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function I(E){var P,O,R,A=Ie.trans,q=E.keys||Pi(u,E);if(q)return(E=E.type==="add"||E.type==="put"?a(a({},E),{keys:q}):a({},E)).type!=="delete"&&(E.values=i([],E.values)),E.keys&&(E.keys=i([],E.keys)),P=l,R=q,((O=E).type==="add"?Promise.resolve([]):P.getMany({trans:O.trans,keys:R,cache:"immutable"})).then(function(B){var L=q.map(function(V,se){var ve,ge,oe,Ee=B[se],xe={onerror:null,onsuccess:null};return E.type==="delete"?m.fire.call(xe,V,Ee,A):E.type==="add"||Ee===void 0?(ve=C.fire.call(xe,V,E.values[se],A),V==null&&ve!=null&&(E.keys[se]=V=ve,u.outbound||Z(E.values[se],u.keyPath,V))):(ve=Ri(Ee,E.values[se]),(ge=N.fire.call(xe,ve,V,Ee,A))&&(oe=E.values[se],Object.keys(ge).forEach(function(de){_(oe,de)?oe[de]=ge[de]:Z(oe,de,ge[de])}))),xe});return l.mutate(E).then(function(V){for(var se=V.failures,ve=V.results,ge=V.numFailures,V=V.lastResult,oe=0;oe<q.length;++oe){var Ee=(ve||q)[oe],xe=L[oe];Ee==null?xe.onerror&&xe.onerror(se[oe]):xe.onsuccess&&xe.onsuccess(E.type==="put"&&B[oe]?E.values[oe]:Ee)}return{failures:se,results:ve,numFailures:ge,lastResult:V}}).catch(function(V){return L.forEach(function(se){return se.onerror&&se.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function cl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var u=[],f=0,h=0;f<s.keys.length&&h<n.length;++f)We(s.keys[f],n[h])===0&&(u.push(l?ae(s.values[f]):s.values[f]),++h);return u.length===n.length?u:null}catch{return null}}var Zc={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(u){var f;return u.cache?(f=cl(u.keys,u.trans._cache,u.cache==="clone"))?be.resolve(f):l.getMany(u).then(function(h){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ae(h):h},h}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function fl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function dl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var $c={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Ot(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,f,h){if(Ie.subscr&&f!=="readonly")throw new ke.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return n.transaction(u,f,h)},table:function(u){function f(q){var A,q=q.query;return[A=q.index,new Ot((A=(q=q.range).lower)!=null?A:n.MIN_KEY,(A=q.upper)!=null?A:n.MAX_KEY)]}var h=n.table(u),g=h.schema,m=g.primaryKey,C=g.indexes,N=m.extractKey,I=m.outbound,E=m.autoIncrement&&C.filter(function(R){return R.compound&&R.keyPath.includes(m.keyPath)}),P=a(a({},h),{mutate:function(R){function A(Ce){return Ce="idb://".concat(s,"/").concat(u,"/").concat(Ce),se[Ce]||(se[Ce]=new Ot)}var q,B,L,V=R.trans,se=R.mutatedParts||(R.mutatedParts={}),ve=A(""),ge=A(":dels"),oe=R.type,xe=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Pi(m,R).filter(function(Ce){return Ce}),R.values]:[],Ee=xe[0],xe=xe[1],de=R.trans._cache;return d(Ee)?(ve.addKeys(Ee),(oe=oe==="delete"||Ee.length===xe.length?cl(Ee,de):null)||ge.addKeys(Ee),(oe||xe)&&(q=A,B=oe,L=xe,g.indexes.forEach(function(Ce){var Ye=q(Ce.name||"");function Ze(Be){return Be!=null?Ce.extractKey(Be):null}function qe(Be){Ce.multiEntry&&d(Be)?Be.forEach(function(ot){return Ye.addKey(ot)}):Ye.addKey(Be)}(B||L).forEach(function(Be,ct){var on=B&&Ze(B[ct]),ct=L&&Ze(L[ct]);We(on,ct)!==0&&(on!=null&&qe(on),ct!=null)&&qe(ct)})}))):Ee?(xe={from:(de=Ee.lower)!=null?de:n.MIN_KEY,to:(oe=Ee.upper)!=null?oe:n.MAX_KEY},ge.add(xe),ve.add(xe)):(ve.add(l),ge.add(l),g.indexes.forEach(function(Ce){return A(Ce.name).add(l)})),h.mutate(R).then(function(Ce){return!Ee||R.type!=="add"&&R.type!=="put"||(ve.addKeys(Ce.results),E&&E.forEach(function(Ye){for(var Ze=R.values.map(function(on){return Ye.extractKey(on)}),qe=Ye.keyPath.findIndex(function(on){return on===m.keyPath}),Be=0,ot=Ce.results.length;Be<ot;++Be)Ze[Be][qe]=Ce.results[Be];A(Ye.name).addKeys(Ze)})),V.mutatedParts=Ps(V.mutatedParts||{},se),Ce})}}),O={get:function(R){return[m,new Ot(R.key)]},getMany:function(R){return[m,new Ot().addKeys(R.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(R){P[R]=function(A){var q=Ie.subscr,B=!!q,L=fl(Ie,h)&&dl(R,A)?A.obsSet={}:q;if(B){var V,q=function(xe){return xe="idb://".concat(s,"/").concat(u,"/").concat(xe),L[xe]||(L[xe]=new Ot)},se=q(""),ve=q(":dels"),B=O[R](A),ge=B[0],B=B[1];if((R==="query"&&ge.isPrimaryKey&&!A.values?ve:q(ge.name||"")).add(B),!ge.isPrimaryKey){if(R!=="count")return V=R==="query"&&I&&A.values&&h.query(a(a({},A),{values:!1})),h[R].apply(this,arguments).then(function(xe){if(R==="query"){if(I&&A.values)return V.then(function(Ze){return Ze=Ze.result,se.addKeys(Ze),xe});var de=A.values?xe.result.map(N):xe.result;(A.values?se:ve).addKeys(de)}else{var Ce,Ye;if(R==="openCursor")return Ye=A.values,(Ce=xe)&&Object.create(Ce,{key:{get:function(){return ve.addKey(Ce.primaryKey),Ce.key}},primaryKey:{get:function(){var Ze=Ce.primaryKey;return ve.addKey(Ze),Ze}},value:{get:function(){return Ye&&se.addKey(Ce.primaryKey),Ce.value}}})}return xe});ve.add(l)}}return h[R].apply(this,arguments)}}),P}})}};function hl(n,s,l){var u;return l.numFailures===0?s:s.type==="deleteRange"||(u=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===u)?null:(u=a({},s),d(u.keys)&&(u.keys=u.keys.filter(function(f,h){return!(h in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,h){return!(h in l.failures)})),u)}function Oi(n,s){return l=n,((u=s).lower===void 0||(u.lowerOpen?0<We(l,u.lower):0<=We(l,u.lower)))&&(l=n,(u=s).upper===void 0||(u.upperOpen?We(l,u.upper)<0:We(l,u.upper)<=0));var l,u}function pl(n,s,l,u,f,h){var g,m,C,N,I,E;return!l||l.length===0||(g=s.query.index,m=g.multiEntry,C=s.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,E=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(P,O){var R=P,A=[];if(O.type==="add"||O.type==="put")for(var q=new Ot,B=O.values.length-1;0<=B;--B){var L,V=O.values[B],se=N(V);!q.hasKey(se)&&(L=I(V),m&&d(L)?L.some(function(xe){return Oi(xe,C)}):Oi(L,C))&&(q.addKey(se),A.push(V))}switch(O.type){case"add":var ve=new Ot().addKeys(s.values?P.map(function(de){return N(de)}):P),R=P.concat(s.values?A.filter(function(de){return de=N(de),!ve.hasKey(de)&&(ve.addKey(de),!0)}):A.map(function(de){return N(de)}).filter(function(de){return!ve.hasKey(de)&&(ve.addKey(de),!0)}));break;case"put":var ge=new Ot().addKeys(O.values.map(function(de){return N(de)}));R=P.filter(function(de){return!ge.hasKey(s.values?N(de):de)}).concat(s.values?A:A.map(function(de){return N(de)}));break;case"delete":var oe=new Ot().addKeys(O.keys);R=P.filter(function(de){return!oe.hasKey(s.values?N(de):de)});break;case"deleteRange":var Ee=O.range;R=P.filter(function(de){return!Oi(N(de),Ee)})}return R},n))===n)?n:(u.sort(function(P,O){return We(E(P),E(O))||We(N(P),N(O))}),s.limit&&s.limit<1/0&&(u.length>s.limit?u.length=s.limit:n.length===s.limit&&u.length<s.limit&&(f.dirty=!0)),h?Object.freeze(u):u)}function vl(n,s){return We(n.lower,s.lower)===0&&We(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function Jc(n,s){return((l,u,f,h)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=We(l,u))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,u,f,h)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=We(l,u))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function ef(n,s,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=s,setTimeout(function(){f.subscribers.size===0&&Y(h,f)},3e3))})}var tf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,u,f){var h,g,m=n.transaction(l,u,f);return u==="readwrite"&&(f=(h=new AbortController).signal,m.addEventListener("abort",(g=function(C){return function(){if(h.abort(),u==="readwrite"){for(var N=new Set,I=0,E=l;I<E.length;I++){var P=E[I],O=Lr["idb://".concat(s,"/").concat(P)];if(O){var R=n.table(P),A=O.optimisticOps.filter(function(Ce){return Ce.trans===m});if(m._explicit&&C&&m.mutatedParts)for(var q=0,B=Object.values(O.queries.query);q<B.length;q++)for(var L=0,V=(ge=B[q]).slice();L<V.length;L++)Ei((oe=V[L]).obsSet,m.mutatedParts)&&(Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Ce){return Ce.trans!==m});for(var se=0,ve=Object.values(O.queries.query);se<ve.length;se++)for(var ge,oe,Ee,xe=0,de=(ge=ve[se]).slice();xe<de.length;xe++)(oe=de[xe]).res!=null&&m.mutatedParts&&(C&&!oe.dirty?(Ee=Object.isFrozen(oe.res),Ee=pl(oe.res,oe.req,A,R,oe,Ee),oe.dirty?(Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)})):Ee!==oe.res&&(oe.res=Ee,oe.promise=be.resolve({result:Ee}))):(oe.dirty&&Y(ge,oe),oe.subscribers.forEach(function(Ce){return N.add(Ce)})))}}}N.forEach(function(Ce){return Ce()})}}})(!1),{signal:f}),m.addEventListener("error",g(!1),{signal:f}),m.addEventListener("complete",g(!0),{signal:f})),m},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return a(a({},u),{mutate:function(h){var g,m=Ie.trans;return!f.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Lr["idb://".concat(s,"/").concat(l)])?(m=u.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Pi(f,h).some(function(C){return C==null}))?(g.optimisticOps.push(h),h.mutatedParts&&Os(h.mutatedParts),m.then(function(C){0<C.numFailures&&(Y(g.optimisticOps,h),(C=hl(0,h,C))&&g.optimisticOps.push(C),h.mutatedParts)&&Os(h.mutatedParts)}),m.catch(function(){Y(g.optimisticOps,h),h.mutatedParts&&Os(h.mutatedParts)})):m.then(function(C){var N=hl(0,a(a({},h),{values:h.values.map(function(I,E){var P;return C.failures[E]?I:(Z(P=(P=f.keyPath)!=null&&P.includes(".")?ae(I):a({},I),f.keyPath,C.results[E]),P)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return h.mutatedParts&&Os(h.mutatedParts)})}),m):u.mutate(h)},query:function(h){var g,m,C,N,I,E,P;return fl(Ie,u)&&dl("query",h)?(g=((C=Ie.trans)==null?void 0:C.db._options.cache)==="immutable",m=(C=Ie).requery,C=C.signal,E=((O,R,A,q)=>{var B=Lr["idb://".concat(O,"/").concat(R)];if(!B)return[];if(!(O=B.queries[A]))return[null,!1,B,null];var L=O[(q.query?q.query.index.name:null)||""];if(!L)return[null,!1,B,null];switch(A){case"query":var V=L.find(function(se){return se.req.limit===q.limit&&se.req.values===q.values&&vl(se.req.query.range,q.query.range)});return V?[V,!0,B,L]:[L.find(function(se){return("limit"in se.req?se.req.limit:1/0)>=q.limit&&(!q.values||se.req.values)&&Jc(se.req.query.range,q.query.range)}),!1,B,L];case"count":return V=L.find(function(se){return vl(se.req.query.range,q.query.range)}),[V,!!V,B,L]}})(s,l,"query",h),P=E[0],N=E[2],I=E[3],P&&E[1]?P.obsSet=h.obsSet:(E=u.query(h).then(function(O){var R=O.result;if(P&&(P.res=R),g){for(var A=0,q=R.length;A<q;++A)Object.freeze(R[A]);Object.freeze(R)}else O.result=ae(R);return O}).catch(function(O){return I&&P&&Y(I,P),Promise.reject(O)}),P={obsSet:h.obsSet,promise:E,subscribers:new Set,type:"query",req:h,dirty:!1},I?I.push(P):(I=[P],(N=N||(Lr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=I)),ef(P,I,m,C),P.promise.then(function(O){return{result:pl(O.result,h,N==null?void 0:N.optimisticOps,u,P,g)}})):u.query(h)}})}})}};function Ms(n,s){return new Proxy(n,{get:function(l,u,f){return u==="db"?s:Reflect.get(l,u,f)}})}ht.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ke.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ke.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(Gc),l.stores({}),this._state.autoSchema=!1),l},ht.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?n():new be(function(l,u){if(s._state.openComplete)return u(new ke.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void u(new ke.DatabaseClosed);s.open().catch(He)}s._state.dbReadyPromise.then(l,u)}).then(n)},ht.prototype.use=function(f){var s=f.stack,l=f.create,u=f.level,f=f.name,h=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return h.push({stack:s,create:l,level:u??10,name:f}),h.sort(function(g,m){return g.level-m.level}),this},ht.prototype.unuse=function(n){var s=n.stack,l=n.name,u=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},ht.prototype.open=function(){var n=this;return Re(bt,function(){return Vc(n)})},ht.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=dt.indexOf(this);if(0<=s&&dt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new be(function(l){n.dbReadyResolve=l}),n.openCanceller=new be(function(l,u){n.cancelOpen=u}))},ht.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new ke.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new ke.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},ht.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new be(function(f,h){function g(){s.close(n);var m=s._deps.indexedDB.deleteDatabase(s.name);m.onsuccess=nt(function(){var C,N,I;C=s._deps,N=s.name,ki(I=C.indexedDB)||N===Ut||wi(I,C.IDBKeyRange).delete(N).catch(He),f()}),m.onerror=Ln(h),m.onblocked=s._fireOnBlocked}if(l)throw new ke.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},ht.prototype.backendDB=function(){return this.idbdb},ht.prototype.isOpen=function(){return this.idbdb!==null},ht.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},ht.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ht.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ht.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),ht.prototype.transaction=function(){var n=(function(s,l,u){var f=arguments.length;if(f<2)throw new ke.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return u=h.pop(),[s,_e(h),u]}).apply(this,arguments);return this._transaction.apply(this,n)},ht.prototype._transaction=function(n,s,l){var u,f,h=this,g=Ie.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(N){if(N=N instanceof h.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===Mn)u=Mn;else{if(n!="rw"&&n!=Dr)throw new ke.InvalidArgument("Invalid transaction mode: "+n);u=Dr}if(g){if(g.mode===Mn&&u===Dr){if(!m)throw new ke.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!m)throw new ke.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,E){E(N)}):pe(N)}var C=(function N(I,E,P,O,R){return be.resolve().then(function(){var L=Ie.transless||Ie,A=I._createTransaction(E,P,I._dbSchema,O),L=(A.explicit=!0,{trans:A,transless:L});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,null,R)})):pe(V)}var q,B=K(R),L=(B&&Pt(),be.follow(function(){var V;(q=R.call(A,A))&&(B?(V=wn.bind(null,null),q.then(V,V)):typeof q.next=="function"&&typeof q.throw=="function"&&(q=Ii(q)))},L));return(q&&typeof q.then=="function"?be.resolve(q).then(function(V){return A.active?V:pe(new ke.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return q})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),pe(V)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,C,"lock"):Ie.trans?Re(Ie.transless,function(){return h._whenReady(C)}):this._whenReady(C)},ht.prototype.table=function(n){if(_(this._allTables,n))return this._allTables[n];throw new ke.InvalidTable("Table ".concat(n," does not exist"))};var Vn=ht;function ht(n,s){var l,u,f,h,g,m=this,C=(this._middlewares={},this.verno=0,ht.dependencies),C=(this._options=s=a({addons:ht.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:He,dbReadyPromise:null,cancelOpen:He,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),I=(N.dbReadyPromise=new be(function(E){N.dbReadyResolve=E}),N.openCanceller=new be(function(E,P){N.cancelOpen=P}),this._state=N,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[ir,He]}),this.once=function(E,P){var O=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];m.on(E).unsubscribe(O),P.apply(m,R)};return m.on(E,O)},this.on.ready.subscribe=$(this.on.ready.subscribe,function(E){return function(P,O){ht.vip(function(){var R,A=m._state;A.openComplete?(A.dbOpenError||be.resolve().then(P),O&&E(P)):A.onReadyBeingFired?(A.onReadyBeingFired.push(P),O&&E(P)):(E(P),R=m,O||E(function q(){R.on.ready.unsubscribe(P),R.on.ready.unsubscribe(q)}))})}}),this.Collection=(l=this,ja(qc.prototype,function(q,A){this.db=l;var O=La,R=null;if(A)try{O=A()}catch(L){R=L}var A=q._ctx,q=A.table,B=q.hook.reading.fire;this._ctx={table:q,index:A.index,isPrimKey:!A.index||q.schema.primKey.keyPath&&A.index===q.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:R,or:A.or,valueMapper:B!==rn?B:null}})),this.Table=(u=this,ja(Qo.prototype,function(E,P,O){this.db=u,this._tx=O,this.name=E,this.schema=P,this.hook=u._allTables[E]?u._allTables[E].hook:qa(null,{creating:[Ra,He],reading:[sa,rn],updating:[sr,He],deleting:[Pa,He]})})),this.Transaction=(f=this,ja(zc.prototype,function(E,P,O,R,A){var q=this;E!=="readonly"&&P.forEach(function(B){B=(B=O[B])==null?void 0:B.yProps,B&&(P=P.concat(B.map(function(L){return L.updatesTable})))}),this.db=f,this.mode=E,this.storeNames=P,this.schema=O,this.chromeTransactionDurability=R,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be(function(B,L){q._resolve=B,q._reject=L}),this._completion.then(function(){q.active=!1,q.on.complete.fire()},function(B){var L=q.active;return q.active=!1,q.on.error.fire(B),q.parent?q.parent._reject(B):L&&q.idbtrans&&q.idbtrans.abort(),pe(B)})})),this.Version=(h=this,ja(Yc.prototype,function(E){this.db=h,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,ja(tl.prototype,function(E,P,O){if(this.db=g,this._ctx={table:E,index:P===":id"?null:P,or:O},this._cmp=this._ascending=We,this._descending=function(R,A){return We(A,R)},this._max=function(R,A){return 0<We(R,A)?R:A},this._min=function(R,A){return We(R,A)<0?R:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ke.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=Fa(s.IDBKeyRange),this._createTransaction=function(E,P,O,R){return new m.Transaction(E,P,O,m._options.chromeTransactionDurability,R)},this._fireOnBlocked=function(E){m.on("blocked").fire(E),dt.filter(function(P){return P.name===m.name&&P!==m&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(E)})},this.use(Zc),this.use(tf),this.use($c),this.use(Xc),this.use(Qc),new Proxy(this,{get:function(E,P,O){var R;return P==="_vip"||(P==="table"?function(A){return Ms(m.table(A),I)}:(R=Reflect.get(E,P,O))instanceof Qo?Ms(R,I):P==="tables"?R.map(function(A){return Ms(A,I)}):P==="_createTransaction"?function(){return Ms(R.apply(this,arguments),I)}:R)}}));this.vip=I,C.forEach(function(E){return E(m)})}var Ls,ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",nf=(Di.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Di.prototype[ha]=function(){return this},Di);function Di(n){this._subscribe=n}try{Ls={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ls={indexedDB:null,IDBKeyRange:null}}function gl(n){var s,l=!1,u=new nf(function(f){var h=K(n),g,m=!1,C={},N={},I={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),E&&pr.storagemutated.unsubscribe(O))}},E=(f.start&&f.start(I),!1),P=function(){return ue(R)},O=function(A){Ps(C,A),Ei(N,C)&&P()},R=function(){var A,q,B;!m&&Ls.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,B=(L=>{var V=dr();try{h&&Pt();var se=_n(n,L);return se=h?se.finally(wn):se}finally{V&&Yn()}})(q={subscr:A,signal:g.signal,requery:P,querier:n,trans:null}),Promise.resolve(B).then(function(L){l=!0,s=L,m||q.signal.aborted||(C={},(V=>{for(var se in V)if(_(V,se))return;return 1})(N=A)||E||(pr(za,O),E=!0),ue(function(){return!m&&f.next&&f.next(L)}))},function(L){l=!1,["DatabaseClosedError","AbortError"].includes(L==null?void 0:L.name)||m||ue(function(){m||f.error&&f.error(L)})}))};return setTimeout(P,0),I});return u.hasValue=function(){return l},u.getValue=function(){return s},u}var Nr=Vn;function Mi(n){var s=vr;try{vr=!0,pr.storagemutated.fire(n),Ci(n,!0)}finally{vr=s}}b(Nr,a(a({},fe),{delete:function(n){return new Nr(n,{addons:[]}).delete()},exists:function(n){return new Nr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Nr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(ki(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Ut})}):wi(l,s).toCollection().primaryKeys()).then(n)}catch{return pe(new ke.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Ie.trans?Re(Ie.transless,n):n()},vip:xi,async:function(n){return function(){try{var s=Ii(n.apply(this,arguments));return s&&typeof s.then=="function"?s:be.resolve(s)}catch(l){return pe(l)}}},spawn:function(n,s,l){try{var u=Ii(n.apply(l,s||[]));return u&&typeof u.then=="function"?u:be.resolve(u)}catch(f){return pe(f)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(n,s){return n=be.resolve(typeof n=="function"?Nr.ignoreTransaction(n):n).timeout(s||6e4),Ie.trans?Ie.trans.waitFor(n):n},Promise:be,debug:{get:function(){return Xt},set:function(n){Oa(n)}},derive:j,extend:v,props:b,override:$,Events:qa,on:pr,liveQuery:gl,extendObservabilitySet:Ps,getByKeyPath:le,setByKeyPath:Z,delByKeyPath:function(n,s){typeof s=="string"?Z(n,s,void 0):"length"in s&&[].map.call(s,function(l){Z(n,l,void 0)})},shallowClone:he,deepClone:ae,getObjectDiff:Ri,cmp:We,asap:J,minKey:-1/0,addons:[],connections:dt,errnames:tt,dependencies:Ls,cache:Lr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Nr.maxKey=Fa(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pr(za,function(n){vr||(n=new CustomEvent(pi,{detail:n}),vr=!0,dispatchEvent(n),vr=!1)}),addEventListener(pi,function(n){n=n.detail,vr||Mi(n)}));var pa,vr=!1,ml=function(){};return typeof BroadcastChannel<"u"&&((ml=function(){(pa=new BroadcastChannel(pi)).onmessage=function(n){return n.data&&Mi(n.data)}})(),typeof pa.unref=="function"&&pa.unref(),pr(za,function(n){vr||pa.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Vn.disableBfCache&&n.persisted){Xt&&console.debug("Dexie: handling persisted pagehide"),pa!=null&&pa.close();for(var s=0,l=dt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Vn.disableBfCache&&n.persisted&&(Xt&&console.debug("Dexie: handling persisted pageshow"),ml(),Mi({all:new Ot(-1/0,[[]])}))})),be.rejectionMapper=function(n,s){return!n||n instanceof Ae||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Nt[n.name]?n:(s=new Nt[n.name](s||n.message,n),"stack"in n&&D(s,"stack",{get:function(){return this.inner.stack}}),s)},Oa(Xt),a(Vn,Object.freeze({__proto__:null,Dexie:Vn,Entity:Ho,PropModification:Na,RangeSet:Ot,add:function(n){return new Na({add:n})},cmp:We,default:Vn,liveQuery:gl,mergeRanges:Ga,rangesOverlap:il,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,s){return new Na({replacePrefix:[n,s]})}}),{default:Vn}),Vn})})(Vs)),Vs.exports}var Kd=Fd();const io=Bd(Kd),Nl=Symbol.for("Dexie"),Lt=globalThis[Nl]||(globalThis[Nl]=io);if(io.semVer!==Lt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${io.semVer} and ${Lt.semVer}`);const{liveQuery:Km,mergeRanges:Um,rangesOverlap:Gm,RangeSet:Hm,cmp:Wm,Entity:Ym,PropModification:Vm,replacePrefix:Xm,add:Qm,remove:Zm,DexieYProvider:$m}=Lt,Ne=new Lt("me-ai-store");Ne.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Ne.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Ne.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Ne.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function oc(t,e){return`${t}:${e}`}async function Ud(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],a=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).first(),i=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).last();if(a&&i){const c=new Date(a.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const o=await lc(5);return o.length>0&&r.push("Top senders: "+o.map(([c,d])=>`${eh(c)} (${d})`).join(", ")+"."),r.join(" ")}async function Gd(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return"No emails stored locally.";const r=await lc(10),a=await $d(10),i=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],o=await Ne.items.where("sourceType").equals("gmail").sortBy("date");if(o.length>0){const c=new Date(o[0].date).toLocaleDateString(),d=new Date(o[o.length-1].date).toLocaleDateString();i.push(`- **Date range:** ${c} â ${d}`)}if(r.length>0){i.push("","### Top Senders");for(const[c,d]of r)i.push(`- ${c}: ${d}`)}if(a.length>0){i.push("","### Labels");for(const[c,d]of a)i.push(`- ${c}: ${d}`)}return i.join(`
`)}async function Hd(t=10){const e=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(uc).join(`

---

`)}async function Wd(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Ne.items.toArray()).map(o=>{var d,v,p,y,_;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(c+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(_=o.body)!=null&&_.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>uc(o)).join(`

---

`)}async function oo(){const t=await Ne.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r,total:t.length}}async function Yd(){const t=await oo();if(!t)return null;const e=["## Pending Action Items",`You have ${t.total} pending email action items that need attention:`,""];for(const r of t.order){const a=t.groups[r],i=r.replace(/_/g," ");e.push(`### ${i} (${a.length})`);for(const o of a.slice(0,5)){const c=o.date?new Date(o.date).toLocaleDateString():"unknown date";e.push(`- **${o.subject}** from ${o.from} (${c})`),o.summary&&e.push(`  ${o.summary}`)}a.length>5&&e.push(`  ...and ${a.length-5} more`),e.push("")}return e.push("The user is seeing these pending items in their chat. Help them decide what to do with these items. You can suggest specific actions like archiving, replying, following up, etc."),e.join(`
`)}function Vd(t){const e=[`You have ${t.total} pending email action${t.total!==1?"s":""}:`];for(const r of t.order){const a=t.groups[r].length,i=Xd(r);e.push(`- ${a} ${i}`)}return e.push("","What would you like to focus on?"),e.join(`
`)}function ql(t){const e=[],r=new Set(t.order);return(r.has("REPLY")||r.has("FOLLOW_UP"))&&e.push("Which emails need an urgent reply?"),r.has("TRACK_DELIVERY")&&e.push("What deliveries am I waiting for?"),(r.has("PAY_BILL")||r.has("SAVE_RECEIPT"))&&e.push("Show me bills or receipts that need attention"),(r.has("DELETE")||r.has("ARCHIVE")||r.has("UNSUBSCRIBE"))&&e.push("What can I safely archive or delete?"),e.length===0&&e.push("Show me the most important emails"),e.push("Help me prioritize these items"),e.slice(0,5)}function Xd(t){return t.toLowerCase().replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}async function Qd(){const t=await Ud();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Zd(t){const e=[],r=await Gd();if(e.push(r),t){const a=await Wd(t,5);e.push("","## Relevant Emails",a)}else{const a=await Hd(5);e.push("","## Recent Emails",a)}return e.join(`
`)}async function lc(t){const e=await Ne.items.where("sourceType").equals("gmail").toArray(),r={};for(const a of e){const i=a.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,t)}async function $d(t){const e=await Ne.items.where("sourceType").equals("gmail").toArray(),r={};for(const a of e)for(const i of a.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,t)}function uc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Jd(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}function Jd(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function eh(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}async function th({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await Ne.items.where("sourceType").equals("gmail").filter(d=>{var v,p,y,_;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((_=d.snippet)==null?void 0:_.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const a=await Ne.items.where("sourceType").equals("gmail").count();return{items:await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}function lo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Ki(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function nh(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}const rh=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function jl(...t){rh&&console.log("[debug]",...t)}function nn(t){return jl(`[MOUNT] ${t}`),()=>jl(`[DESTROY] ${t}`)}var ah=X("<option> </option>"),sh=X('<p class="model-description svelte-1p89qnn"> </p>'),ih=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),oh=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),lh=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),uh=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),ch=X('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),fh=X('<p class="error svelte-1p89qnn"> </p>'),dh=X('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function hh(t,e){lt(e,!0);let r=Pe(e,"selectedModel",15),a=Pe(e,"gpuInfo",3,null),i=Pe(e,"error",3,null);Rt(()=>nn("ModelSelector"));var o=dh(),c=M(x(o),2),d=M(x(c),2);gn(d,21,()=>os,Er,(j,S)=>{var F=ah(),re=x(F),$={};ye(()=>{ce(re,`${k(S).name??""} â ${k(S).size??""}`),$!==($=k(S).id)&&(F.value=(F.__value=k(S).id)??"")}),G(j,F)});var v=M(d,2);{var p=j=>{const S=Mt(()=>os.find(U=>U.id===r()));var F=Po(),re=xt(F);{var $=U=>{var J=sh(),le=x(J);ye(()=>ce(le,k(S).description)),G(U,J)};we(re,U=>{k(S)&&U($)})}G(j,F)};we(v,j=>{r()&&j(p)})}var y=M(c,2);{var _=j=>{var S=ch(),F=M(x(S),2),re=x(F),$=M(x(re)),U=x($),J=M(re,2),le=M(x(J)),Z=x(le),he=M(J,2);{var Me=Q=>{var ee=ih(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,a().device)),G(Q,ee)};we(he,Q=>{a().device&&a().device!=="unknown"&&Q(Me)})}var _e=M(he,2);{var me=Q=>{var ee=oh(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,a().description)),G(Q,ee)};we(_e,Q=>{a().description&&a().description!=="unknown"&&Q(me)})}var ie=M(_e,2);{var ae=Q=>{var ee=lh(),Y=M(x(ee)),ne=x(Y);ye(te=>ce(ne,te),[()=>lo(a().limits.maxBufferSize)]),G(Q,ee)};we(ie,Q=>{var ee;(ee=a().limits)!=null&&ee.maxBufferSize&&Q(ae)})}var Le=M(ie,2);{var W=Q=>{var ee=uh(),Y=M(x(ee)),ne=x(Y);ye(()=>ce(ne,`${a().features.length??""} supported`)),G(Q,ee)};we(Le,Q=>{var ee;(ee=a().features)!=null&&ee.length&&Q(W)})}ye(()=>{ce(U,a().vendor),ce(Z,a().architecture)}),G(j,S)};we(y,j=>{a()&&j(_)})}var b=M(y,2);{var w=j=>{var S=fh(),F=x(S);ye(()=>ce(F,i())),G(j,S)};we(b,j=>{i()&&j(w)})}var D=M(b,2);D.__click=function(...j){var S;(S=e.onload)==null||S.apply(this,j)},ye(()=>D.disabled=i()),Oo(d,r),G(t,o),ut()}Kt(["click"]);var ph=X('<span class="progress-percent svelte-r5fnze"> </span>'),vh=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),gh=X('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),mh=X('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),yh=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),bh=X('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),_h=X('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function wh(t,e){lt(e,!0);let r=Pe(e,"message",3,""),a=Pe(e,"items",19,()=>[]);Rt(()=>nn("LoadingProgress"));var i=_h(),o=x(i),c=x(o),d=M(o,2);gn(d,17,a,Er,(v,p)=>{const y=Mt(()=>k(p).total?nh(k(p).loaded||0,k(p).total):null);var _=bh(),b=x(_),w=x(b),D=x(w),j=M(w,2);{var S=U=>{var J=ph(),le=x(J);ye(Z=>ce(le,`${Z??""}%`),[()=>k(y).toFixed(1)]),G(U,J)};we(j,U=>{k(y)!==null&&U(S)})}var F=M(b,2);{var re=U=>{var J=vh(),le=xt(J),Z=x(le),he=M(le,2),Me=x(he),_e=x(Me),me=M(Me,4),ie=x(me),ae=M(me,2),Le=x(ae);ye((W,Q,ee,Y,ne)=>{Rn(Z,`width: ${W??""}%`),ce(_e,Q),ce(ie,ee),ce(Le,`(${Y??""} / ${ne??""} B)`)},[()=>Math.max(k(p).progress??0,.5).toFixed(1),()=>Ki(k(p).loaded||0),()=>Ki(k(p).total),()=>(k(p).loaded||0).toLocaleString(),()=>k(p).total.toLocaleString()]),G(U,J)},$=U=>{var J=yh(),le=M(xt(J),2),Z=x(le);{var he=_e=>{var me=gh(),ie=xt(me),ae=x(ie),Le=M(ie,2),W=x(Le);ye((Q,ee)=>{ce(ae,Q),ce(W,`(${ee??""} B)`)},[()=>Ki(k(p).loaded),()=>k(p).loaded.toLocaleString()]),G(_e,me)},Me=_e=>{var me=mh();G(_e,me)};we(Z,_e=>{k(p).loaded?_e(he):_e(Me,!1)})}G(U,J)};we(F,U=>{k(p).total?U(re):U($,!1)})}ye(()=>{ac(w,"title",k(p).file),ce(D,k(p).file)}),G(v,_)}),ye(()=>ce(c,r())),G(t,i),ut()}var kh=X('<span class="thinking-tokens svelte-11gjw00"> </span>'),xh=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Sh=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Eh=X('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Th=X('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Ah=X('<span class="cursor svelte-11gjw00">|</span>'),Ch=X(" <!>",1),Ih=X('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Rh=X('<div class="content svelte-11gjw00"> </div>'),Ph=X('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Oh(t,e){lt(e,!0);let r=Pe(e,"isLast",3,!1),a=Pe(e,"isRunning",3,!1),i=Pe(e,"generationPhase",3,null),o=Pe(e,"numTokens",3,null);Rt(()=>nn(`MessageBubble[${e.msg.role}]`));var c=Ph(),d=x(c),v=x(d),p=M(d,2);{var y=b=>{var w=Ih(),D=xt(w);{var j=Z=>{var he=xh(),Me=M(x(he),4);{var _e=me=>{var ie=kh(),ae=x(ie);ye(()=>ce(ae,`${o()??""} tokens`)),G(me,ie)};we(Me,me=>{o()&&me(_e)})}G(Z,he)},S=Z=>{var he=Sh();G(Z,he)};we(D,Z=>{a()&&r()&&i()==="thinking"?Z(j):a()&&r()&&i()==="preparing"&&Z(S,1)})}var F=M(D,2);{var re=Z=>{var he=Eh(),Me=x(he),_e=M(x(Me),2),me=x(_e),ie=M(Me,2),ae=x(ie);ye(Le=>{ce(me,`${Le??""} words`),ce(ae,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),G(Z,he)};we(F,Z=>{e.msg.thinking&&Z(re)})}var $=M(F,2),U=x($);{var J=Z=>{var he=Th();G(Z,he)},le=Z=>{var he=Ch(),Me=xt(he,!0),_e=M(Me);{var me=ie=>{var ae=Ah();G(ie,ae)};we(_e,ie=>{a()&&r()&&ie(me)})}ye(()=>ce(Me,e.msg.content)),G(Z,he)};we(U,Z=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?Z(J):Z(le,!1)})}G(b,w)},_=b=>{var w=Rh(),D=x(w);ye(()=>ce(D,e.msg.content)),G(b,w)};we(p,b=>{e.msg.role==="assistant"?b(y):b(_,!1)})}ye(()=>{dn(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ce(v,e.msg.role==="user"?"You":"AI")}),G(t,c),ut()}var Dh=X('<button class="suggestion svelte-1wrqu74"><span class="arrow svelte-1wrqu74">&#8618;</span> <span class="text svelte-1wrqu74"> </span></button>'),Mh=X('<div class="follow-ups svelte-1wrqu74"><span class="label svelte-1wrqu74">Follow-ups</span> <!></div>');function Lh(t,e){lt(e,!0);let r=Pe(e,"suggestions",19,()=>[]);var a=Po(),i=xt(a);{var o=c=>{var d=Mh(),v=M(x(d),2);gn(v,16,r,p=>p,(p,y)=>{var _=Dh();_.__click=()=>e.onsend(y);var b=M(x(_),2),w=x(b);ye(()=>ce(w,y)),G(p,_)}),G(c,d)};we(i,c=>{r().length>0&&c(o)})}G(t,a),ut()}Kt(["click"]);var Nh=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),qh=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),jh=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Bh=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),zh=X('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Fh=X('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Kh=X('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Uh(t,e){lt(e,!0),Rt(()=>nn("GpuPanel"));var r=Kh(),a=x(r),i=M(x(a),2),o=M(x(i),2),c=x(o),d=M(i,2),v=M(x(d),2),p=x(v),y=M(d,2);{var _=U=>{var J=Nh(),le=M(x(J),2),Z=x(le);ye(()=>ce(Z,e.gpuInfo.device)),G(U,J)};we(y,U=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&U(_)})}var b=M(y,2);{var w=U=>{var J=qh(),le=M(x(J),2),Z=x(le);ye(he=>ce(Z,he),[()=>lo(e.gpuInfo.limits.maxBufferSize)]),G(U,J)};we(b,U=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxBufferSize&&U(w)})}var D=M(b,2);{var j=U=>{var J=jh(),le=M(x(J),2),Z=x(le);ye(()=>ce(Z,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),G(U,J)};we(D,U=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeInvocationsPerWorkgroup&&U(j)})}var S=M(D,2);{var F=U=>{var J=Bh(),le=M(x(J),2),Z=x(le);ye(he=>ce(Z,he),[()=>lo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),G(U,J)};we(S,U=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeWorkgroupStorageSize&&U(F)})}var re=M(S,2);{var $=U=>{var J=Fh(),le=x(J),Z=x(le),he=M(le,2);gn(he,21,()=>e.gpuInfo.features,Er,(Me,_e)=>{var me=zh(),ie=x(me);ye(()=>ce(ie,k(_e))),G(Me,me)}),ye(()=>ce(Z,`Features (${e.gpuInfo.features.length??""})`)),G(U,J)};we(re,U=>{var J;(J=e.gpuInfo.features)!=null&&J.length&&U($)})}ye(()=>{ce(c,e.gpuInfo.vendor),ce(p,e.gpuInfo.architecture)}),G(t,r),ut()}var Gh=X('<button class="gpu-badge svelte-1ktw27c"> </button>'),Hh=X('<span class="stats svelte-1ktw27c"> </span>'),Wh=X('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Yh=X('<span class="stats preparing svelte-1ktw27c"> </span>'),Vh=X('<span class="stats svelte-1ktw27c"> </span>'),Xh=X('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Qh=X('<button class="btn svelte-1ktw27c">Stop</button>'),Zh=X('<button class="btn primary svelte-1ktw27c">Send</button>'),$h=X('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Jh(t,e){lt(e,!0),Rt(()=>nn("ChatView"));let r=Pe(e,"messages",19,()=>[]),a=Pe(e,"suggestions",19,()=>[]),i=Pe(e,"isRunning",3,!1),o=Pe(e,"tps",3,null),c=Pe(e,"numTokens",3,null),d=Pe(e,"generationPhase",3,null),v=Pe(e,"gpuInfo",3,null),p=Pe(e,"chatContainer",15),y=Oe(""),_=Oe(!1);function b(K){K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),w())}function w(){const K=k(y).trim();!K||i()||(z(y,""),e.onsend(K))}var D=$h(),j=x(D),S=x(j);{var F=K=>{var fe=Gh();fe.__click=()=>z(_,!k(_));var Se=x(fe);ye(()=>ce(Se,`WebGPU ${k(_)?"â²":"â¼"}`)),G(K,fe)};we(S,K=>{v()&&K(F)})}var re=M(S,2);{var $=K=>{var fe=Hh(),Se=x(fe);ye((Ae,Te)=>ce(Se,`${c()??""} tokens in ${Ae??""}s
        (${Te??""} tok/s)`),[()=>(c()/o()).toFixed(1),()=>o().toFixed(1)]),G(K,fe)},U=K=>{var fe=Wh();G(K,fe)},J=K=>{var fe=Yh(),Se=x(fe);ye(Ae=>ce(Se,`thinking... ${Ae??""}`),[()=>o()?`${o().toFixed(0)} tok/s`:""]),G(K,fe)},le=K=>{var fe=Vh(),Se=x(fe);ye(Ae=>ce(Se,`${Ae??""} tok/s`),[()=>o().toFixed(1)]),G(K,fe)};we(re,K=>{o()&&!i()?K($):i()&&d()==="preparing"?K(U,1):i()&&d()==="thinking"?K(J,2):o()&&i()&&K(le,3)})}var Z=M(re,4);Z.__click=function(...K){var fe;(fe=e.onreset)==null||fe.apply(this,K)};var he=M(j,2);{var Me=K=>{Uh(K,{get gpuInfo(){return v()}})};we(he,K=>{k(_)&&v()&&K(Me)})}var _e=M(he,2),me=x(_e);{var ie=K=>{var fe=Xh();G(K,fe)};we(me,K=>{r().length===0&&K(ie)})}var ae=M(me,2);gn(ae,17,r,Er,(K,fe,Se)=>{{let Ae=Mt(()=>Se===r().length-1);Oh(K,{get msg(){return k(fe)},get isLast(){return k(Ae)},get isRunning(){return i()},get generationPhase(){return d()},get numTokens(){return c()}})}});var Le=M(ae,2);{var W=K=>{Lh(K,{get suggestions(){return a()},get onsend(){return e.onsend}})};we(Le,K=>{a().length>0&&!i()&&K(W)})}sc(_e,K=>p(K),()=>p());var Q=M(_e,2),ee=x(Q);ee.__keydown=b;var Y=M(ee,2);{var ne=K=>{var fe=Qh();fe.__click=function(...Se){var Ae;(Ae=e.onstop)==null||Ae.apply(this,Se)},G(K,fe)},te=K=>{var fe=Zh();fe.__click=w,ye(Se=>fe.disabled=Se,[()=>!k(y).trim()]),G(K,fe)};we(Y,K=>{i()?K(ne):K(te,!1)})}ye(()=>{Z.disabled=i(),ee.disabled=i()}),Do(ee,()=>k(y),K=>z(y,K)),G(t,D),ut()}Kt(["click","keydown"]);var ep=X('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function tp(t,e){lt(e,!0);const r=!!navigator.gpu,a=ic();let i=Oe(wt(localStorage.getItem("selectedModel")||os[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),v=Oe(wt([])),p=Oe(wt([])),y=Oe(wt([])),_=Oe(!1),b=Oe(null),w=Oe(null),D=Oe(null),j=Oe(null),S=Oe(null),F=!1;Rt(()=>{a.check(),a.isReady&&re();const W=a.onMessage(Q=>{switch(Q.status){case"webgpu-info":z(j,Q.data,!0);break;case"loading":z(o,"loading"),z(d,Q.data,!0);break;case"initiate":z(v,[...k(v),Q],!0);break;case"progress":z(v,k(v).map(ee=>ee.file===Q.file?{...ee,...Q}:ee),!0);break;case"done":z(v,k(v).filter(ee=>ee.file!==Q.file),!0);break;case"ready":z(o,"ready"),re();break;case"start":if(!k(_))break;z(S,Q.phase||"preparing",!0),z(p,[...k(p),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!k(_))break;z(S,Q.phase,!0);break;case"thinking":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(p)[k(p).length-1];z(p,[...k(p).slice(0,-1),{...ee,thinking:(ee.thinking||"")+Q.content}],!0),U();break}case"thinking-done":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(p)[k(p).length-1];z(p,[...k(p).slice(0,-1),{...ee,thinking:Q.content}],!0);break}case"update":{if(!k(_))break;z(b,Q.tps,!0),z(w,Q.numTokens,!0);const ee=k(p)[k(p).length-1];z(p,[...k(p).slice(0,-1),{...ee,content:ee.content+Q.output}],!0),U();break}case"complete":if(!k(_))break;z(_,!1),z(S,null),$();break;case"error":if(!k(_))break;z(c,Q.data,!0),z(_,!1),z(S,null);break}});return()=>W()});async function re(){if(!(F||k(p).length>0))try{const W=await oo();if(W){F=!0;const Q=Vd(W);z(p,[{role:"assistant",content:Q}],!0),z(y,ql(W),!0),U()}}catch{}}async function $(){try{const W=await oo();W&&W.total>0?z(y,ql(W),!0):z(y,[],!0)}catch{z(y,[],!0)}}function U(){Ju().then(()=>{k(D)&&(k(D).scrollTop=k(D).scrollHeight)})}function J(){z(o,"loading"),localStorage.setItem("selectedModel",k(i)),a.loadModel(k(i))}async function le(W){if(!W||k(_))return;z(y,[],!0),z(p,[...k(p),{role:"user",content:W}],!0),z(b,null),z(_,!0);let Q=[];try{const Y=await Yd(),ne=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i;let te;ne.test(W)||Y?(te=await Zd(W),Y&&(te=(te||"")+`

`+Y)):te=await Qd(),te&&(Q=[{role:"system",content:te}])}catch{}const ee=k(p).map(Y=>({role:Y.role,content:Y.content}));a.generate([...Q,...ee]),U()}function Z(){a.interrupt()}function he(){a.reset(),z(p,[],!0),z(y,[],!0),z(b,null),z(w,null),F=!1,re()}var Me=Po(),_e=xt(Me);{var me=W=>{var Q=ep();G(W,Q)},ie=W=>{hh(W,{get gpuInfo(){return k(j)},get error(){return k(c)},onload:J,get selectedModel(){return k(i)},set selectedModel(Q){z(i,Q,!0)}})},ae=W=>{wh(W,{get message(){return k(d)},get items(){return k(v)}})},Le=W=>{Jh(W,{get messages(){return k(p)},get suggestions(){return k(y)},get isRunning(){return k(_)},get tps(){return k(b)},get numTokens(){return k(w)},get generationPhase(){return k(S)},get gpuInfo(){return k(j)},onsend:le,onstop:Z,onreset:he,get chatContainer(){return k(D)},set chatContainer(Q){z(D,Q,!0)}})};we(_e,W=>{r?k(o)===null?W(ie,1):k(o)==="loading"?W(ae,2):W(Le,!1):W(me)})}G(t,Me),ut()}const Bl="https://accounts.google.com/gsi/client",np="https://www.googleapis.com/auth/gmail.readonly";let uo=null,Xs=null;function rp(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Bl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Bl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function zl(t){await rp(),uo=google.accounts.oauth2.initTokenClient({client_id:t,scope:np,callback:e=>{Xs&&(Xs(e),Xs=null)}})}function ap(){return new Promise((t,e)=>{if(!uo){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Xs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},uo.requestAccessToken()})}function sp(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const ip="https://gmail.googleapis.com/gmail/v1/users/me";function op(t){return{Authorization:`Bearer ${t}`}}async function ui(t,e){var a;const r=await fetch(`${ip}${e}`,{headers:op(t)});if(!r.ok){const i=await r.json().catch(()=>({}));throw new Error(((a=i.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`)}return r.json()}function cc(t){return ui(t,"/profile")}function fc(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),ui(t,`/messages?${i}`)}function dc(t,e,r="full"){return ui(t,`/messages/${e}?format=${r}`)}function lp(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),ui(t,`/history?${i}`)}function mr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function as(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function up(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return as(e.body.data);const r=e.parts||[],a=Js(r,"text/plain");if((c=a==null?void 0:a.body)!=null&&c.data)return as(a.body.data);const i=Js(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=as(i.body.data);return fp(v)}return"(no body)"}function cp(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return as(e.body.data);const r=e.parts||[],a=Js(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?as(a.body.data):null}function Js(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=Js(r.parts,e);if(a)return a}}return null}function fp(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}const At="gmail",Fl=8,hc=50,pc=100;async function dp(t,{limit:e=hc,onProgress:r=()=>{},signal:a}={}){var c,d,v,p;const i=await Ne.syncState.get(At);if(i!=null&&i.historyId)try{return await yp(t,i,r,a)}catch(y){if((c=y.message)!=null&&c.includes("404")||(d=y.message)!=null&&d.includes("notFound")||(v=y.message)!=null&&v.includes("Start history id")||(p=y.message)!=null&&p.includes("history_types"))r({phase:"info",message:"History expired, performing full re-sync..."}),await Ne.syncState.delete(At);else throw y}return await gp(t,e===0?1/0:e,r,a)}async function hp(t,{limit:e=hc,onProgress:r=()=>{},signal:a}={}){const i=await Ne.syncState.get(At);return i!=null&&i.oldestPageToken?await mp(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function pp(){const t=await Ne.syncState.get(At);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function vp(){await Ne.transaction("rw",[Ne.items,Ne.syncState],async()=>{await Ne.items.where("sourceType").equals(At).delete(),await Ne.syncState.delete(At)})}async function gp(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ta(a);const i=await cc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){ta(a);const _=e-o.length,b=await fc(t,{maxResults:Math.min(pc,_),pageToken:c}),w=(b.messages||[]).map(D=>D.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:p}=await vc(t,o,r,a),y=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:p}}async function mp(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ta(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){ta(i);const _=r-o.length,b=await fc(t,{maxResults:Math.min(pc,_),pageToken:c}),w=(b.messages||[]).map(D=>D.id);if(o.push(...w),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.update(At,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:p}=await vc(t,o,a,i),y=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.update(At,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:p}}async function yp(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ta(a);let i=0,o=0,c=0,d,v=e.historyId;do{ta(a);const y=await lp(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const _ of y.history){if(_.messagesAdded){const b=_.messagesAdded.map(D=>D.message.id),w=[...new Set(b.filter(D=>D))];if(w.length>0){const D=await Promise.allSettled(w.map(S=>dc(t,S))),j=[];for(const S of D)S.status==="fulfilled"?j.push(gc(S.value)):c++;j.length>0&&(await Ne.items.bulkPut(j),await mc(j),i+=j.length)}}if(_.messagesDeleted){const b=_.messagesDeleted.map(w=>oc(At,w.message.id)).filter(w=>w);b.length>0&&(await Ne.items.bulkDelete(b),o+=b.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await Ne.items.where("sourceType").equals(At).count();return await Ne.syncState.put({sourceType:At,historyId:v,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:c}}async function vc(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Fl){ta(a);const d=e.slice(c,c+Fl),v=await Promise.allSettled(d.map(y=>dc(t,y))),p=[];for(const y of v)y.status==="fulfilled"?p.push(gc(y.value)):o++;p.length>0&&(await Ne.items.bulkPut(p),await mc(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function gc(t){const e=mr(t,"From"),r=mr(t,"To"),a=mr(t,"Cc"),i=mr(t,"Subject")||"(no subject)",o=mr(t,"Date"),c=mr(t,"Message-ID"),d=mr(t,"In-Reply-To"),v=mr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:oc(At,t.id),sourceType:At,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:up(t),htmlBody:cp(t),date:p,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function mc(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=bp(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Ne.contacts.where("email").equals(r).first();if(o){const c={};a&&!o.name&&(c.name=a),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await Ne.contacts.update(o.id,c)}else await Ne.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch{}}function bp(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ta(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var _p=X(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function wp(t,e){lt(e,!0);let r=Pe(e,"clientIdInput",15);Rt(()=>nn("SetupGuide"));let a=Oe(null);async function i(Ae){try{await navigator.clipboard.writeText(Ae),z(a,Ae,!0),setTimeout(()=>{z(a,null)},1500)}catch{const Te=document.createElement("input");Te.value=Ae,document.body.appendChild(Te),Te.select(),document.execCommand("copy"),document.body.removeChild(Te),z(a,Ae,!0),setTimeout(()=>{z(a,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=_p(),p=x(v),y=M(x(p),4),_=M(x(y),6),b=M(x(_),2),w=M(x(b),2),D=M(x(w),2),j=x(D);j.__click=()=>i(o);var S=x(j);S.textContent="http://localhost:5173";var F=M(S,2),re=x(F),$=M(j,2);$.__click=()=>i(c);var U=x($);U.textContent="https://cypherkitty.github.io";var J=M(U,2),le=x(J),Z=M(w,2),he=M(x(Z),2),Me=x(he);Me.__click=()=>i(o);var _e=x(Me);_e.textContent="http://localhost:5173";var me=M(_e,2),ie=x(me),ae=M(Me,2);ae.__click=()=>i(c);var Le=x(ae);Le.textContent="https://cypherkitty.github.io";var W=M(Le,2),Q=x(W),ee=M(ae,2);ee.__click=()=>i(d);var Y=x(ee);Y.textContent="https://cypherkitty.github.io/me-ai/";var ne=M(Y,2),te=x(ne),K=M(y,2),fe=x(K);fe.__keydown=Ae=>Ae.key==="Enter"&&e.onsave();var Se=M(fe,2);Se.__click=function(...Ae){var Te;(Te=e.onsave)==null||Te.apply(this,Ae)},ye(Ae=>{ce(re,k(a)===o?"â":"â§"),ce(le,k(a)===c?"â":"â§"),ce(ie,k(a)===o?"â":"â§"),ce(Q,k(a)===c?"â":"â§"),ce(te,k(a)===d?"â":"â§"),Se.disabled=Ae},[()=>!r().trim()]),Do(fe,r),G(t,v),ut()}Kt(["click","keydown"]);function kp(t){const e=t||"";if(e.includes("has not been used in project")||e.includes("is disabled")){const r=e.match(/project\s+(\d+)/),a=r==null?void 0:r[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:a?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${a}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return e.includes("Invalid Credentials")||e.includes("401")||e.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:e.includes("insufficient")&&e.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:e.includes("access_denied")||e.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:e.includes("popup")||e.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:e.includes("Rate Limit")||e.includes("429")||e.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:e,fix:null}}var xp=X('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Sp=X('<div class="error-card-title svelte-14buhqq"> </div>'),Ep=X('<p class="error-card-fix svelte-14buhqq"> </p>'),Tp=X('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),Ap=X('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),Cp=X('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function yc(t,e){lt(e,!0);let r=Pe(e,"ondismiss",3,null),a=Pe(e,"onsignout",3,null),i=Mt(()=>kp(e.error));Rt(()=>nn("ErrorCard"));var o=Cp(),c=x(o);{var d=F=>{var re=xp(),$=x(re),U=x($),J=M($,2);J.__click=function(...le){var Z;(Z=r())==null||Z.apply(this,le)},ye(()=>ce(U,k(i).title)),G(F,re)},v=F=>{var re=Sp(),$=x(re);ye(()=>ce($,k(i).title)),G(F,re)};we(c,F=>{r()?F(d):F(v,!1)})}var p=M(c,2),y=x(p),_=M(p,2);{var b=F=>{var re=Ep(),$=x(re);ye(()=>ce($,k(i).fix)),G(F,re)};we(_,F=>{k(i).fix&&F(b)})}var w=M(_,2);{var D=F=>{var re=Tp(),$=x(re);ye(()=>{ac(re,"href",k(i).link.url),ce($,`${k(i).link.label??""} â`)}),G(F,re)};we(w,F=>{k(i).link&&F(D)})}var j=M(w,2);{var S=F=>{var re=Ap();re.__click=function(...$){var U;(U=a())==null||U.apply(this,$)},G(F,re)};we(j,F=>{k(i).action==="signout"&&a()&&F(S)})}ye(()=>ce(y,k(i).description)),G(t,o),ut()}Kt(["click"]);var Ip=X('<span class="spinner svelte-nyqevv"></span> Signing in...',1),Rp=Ro('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),Pp=X(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function Op(t,e){lt(e,!0);let r=Pe(e,"error",3,null),a=Pe(e,"loadingAuth",3,!1);Rt(()=>nn("AuthCard"));var i=Pp(),o=x(i),c=M(x(o),4);{var d=S=>{yc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};we(c,S=>{r()&&S(d)})}var v=M(c,2);v.__click=function(...S){var F;(F=e.onsignin)==null||F.apply(this,S)};var p=x(v);{var y=S=>{var F=Ip();G(S,F)},_=S=>{var F=Rp();G(S,F)};we(p,S=>{a()?S(y):S(_,!1)})}var b=M(v,2),w=M(x(b),2),D=x(w),j=M(w,2);j.__click=function(...S){var F;(F=e.onclear)==null||F.apply(this,S)},ye(S=>{v.disabled=a(),ce(D,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),G(t,i),ut()}Kt(["click"]);function Mo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function bc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function _c(t){return bc(t).charAt(0).toUpperCase()}var Dp=X('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Mp=X('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Lp=X('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function Np(t,e){lt(e,!0);let r=Pe(e,"profile",3,null),a=Pe(e,"loadingProfile",3,!1);Rt(()=>nn("ProfileCard"));var i=Lp(),o=x(i),c=x(o),d=M(o,2),v=x(d);{var p=b=>{var w=Dp();G(b,w)},y=b=>{var w=Mp(),D=xt(w),j=x(D),S=M(D,2),F=x(S);ye((re,$)=>{ce(j,r().emailAddress),ce(F,`${re??""} messages
        Â· ${$??""} threads`)},[()=>{var re;return((re=r().messagesTotal)==null?void 0:re.toLocaleString())||"?"},()=>{var re;return((re=r().threadsTotal)==null?void 0:re.toLocaleString())||"?"}]),G(b,w)};we(v,b=>{a()?b(p):r()&&b(y,1)})}var _=M(d,2);_.__click=function(...b){var w;(w=e.onsignout)==null||w.apply(this,b)},ye(b=>ce(c,b),[()=>r()?_c(r().emailAddress):"?"]),G(t,i),ut()}Kt(["click"]);var qp=X('<span class="spinner svelte-1ds3j4k"></span>'),jp=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Bp=X('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),zp=X('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Fp=X('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Kp=X('<option class="svelte-1ds3j4k"> </option>'),Up=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Gp=X('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Hp=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Wp=X('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Yp=X('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Vp=X('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Xp(t,e){lt(e,!0),Rt(()=>nn("SyncStatus"));let r=Pe(e,"syncStatus",3,null),a=Pe(e,"syncProgress",3,null),i=Pe(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(Y){if(!Y)return"never";const ne=Math.floor((Date.now()-Y)/1e3);if(ne<60)return"just now";const te=Math.floor(ne/60);if(te<60)return`${te}m ago`;const K=Math.floor(te/60);return K<24?`${K}h ago`:`${Math.floor(K/24)}d ago`}function p(){var Y,ne;return!((Y=a())!=null&&Y.total)||!((ne=a())!=null&&ne.current)?0:Math.round(a().current/a().total*100)}var y=Vp(),_=x(y),b=x(_),w=x(b);{var D=Y=>{var ne=qp();G(Y,ne)},j=Y=>{var ne=jp();G(Y,ne)};we(w,Y=>{i()?Y(D):Y(j,!1)})}var S=M(b,2),F=M(x(S),2);{var re=Y=>{var ne=Bp(),te=x(ne),K=M(te);{var fe=Ae=>{var Te=Il("Â· more available");G(Ae,Te)},Se=Ae=>{var Te=Il("Â· all synced");G(Ae,Te)};we(K,Ae=>{r().hasMore?Ae(fe):Ae(Se,!1)})}ye((Ae,Te)=>ce(te,`${Ae??""} emails stored
          Â· synced ${Te??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),G(Y,ne)},$=Y=>{var ne=zp();G(Y,ne)};we(F,Y=>{var ne;(ne=r())!=null&&ne.synced?Y(re):Y($,!1)})}var U=M(S,2),J=x(U);{var le=Y=>{var ne=Fp();ne.__click=()=>z(o,!k(o)),G(Y,ne)};we(J,Y=>{var ne;(ne=r())!=null&&ne.synced&&!i()&&Y(le)})}var Z=M(_,2),he=x(Z),Me=M(x(he),2);gn(Me,21,()=>d,Er,(Y,ne)=>{var te=Kp(),K=x(te),fe={};ye(()=>{ce(K,k(ne).label),fe!==(fe=k(ne).value)&&(te.value=(te.__value=k(ne).value)??"")}),G(Y,te)});var _e=M(he,2),me=x(_e);{var ie=Y=>{var ne=Gp(),te=xt(ne);te.__click=()=>e.onsync(k(c));var K=x(te),fe=M(te,2);{var Se=Ae=>{var Te=Up();Te.__click=()=>e.onsyncmore(k(c));var Je=x(Te);ye(()=>{Te.disabled=i(),ce(Je,i()?"Loading...":"Sync More")}),G(Ae,Te)};we(fe,Ae=>{r().hasMore&&Ae(Se)})}ye(()=>{te.disabled=i(),ce(K,i()?"Syncing...":"Sync New")}),G(Y,ne)},ae=Y=>{var ne=Hp();ne.__click=()=>e.onsync(k(c));var te=x(ne);ye(()=>{ne.disabled=i(),ce(te,i()?"Syncing...":"Download Emails")}),G(Y,ne)};we(me,Y=>{var ne;(ne=r())!=null&&ne.synced?Y(ie):Y(ae,!1)})}var Le=M(Z,2);{var W=Y=>{var ne=Wp(),te=x(ne),K=x(te);let fe,Se;var Ae=M(te,2),Te=x(Ae);ye(Je=>{fe=dn(K,1,"progress-fill svelte-1ds3j4k",null,fe,{indeterminate:!a().total}),Se=Rn(K,"",Se,Je),ce(Te,a().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),G(Y,ne)};we(Le,Y=>{i()&&a()&&Y(W)})}var Q=M(Le,2);{var ee=Y=>{var ne=Yp(),te=M(x(ne),2),K=x(te);K.__click=()=>z(o,!1);var fe=M(K,2);fe.__click=()=>{e.onclear(),z(o,!1)},G(Y,ne)};we(Q,Y=>{k(o)&&Y(ee)})}ye(()=>Me.disabled=i()),Oo(Me,()=>k(c),Y=>z(c,Y)),G(t,y),ut()}Kt(["click"]);var Qp=X('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Zp=X('<div class="message-list svelte-y2uamw"></div>');function $p(t,e){lt(e,!0);let r=Pe(e,"messages",19,()=>[]);Rt(()=>nn("MessageList"));var a=Zp();gn(a,21,r,Er,(i,o)=>{var c=Qp();c.__click=()=>e.onselect(k(o));var d=x(c),v=x(d),p=M(d,2),y=x(p),_=x(y),b=x(_),w=M(_,2),D=x(w),j=M(y,2),S=x(j),F=M(j,2),re=x(F);ye(($,U,J)=>{ce(v,$),ce(b,U),ce(D,J),ce(S,k(o).subject),ce(re,k(o).snippet)},[()=>_c(k(o).from),()=>bc(k(o).from),()=>Mo(k(o).date)]),G(i,c)}),G(t,a),ut()}Kt(["click"]);function Lo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var aa=Lo();function wc(t){aa=t}var Br={exec:()=>null};function Ve(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Bt.caret,"$1"),r=r.replace(i,c),a},getRegex:()=>new RegExp(r,e)};return a}var Jp=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Bt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},ev=/^(?:[ \t]*(?:\n|$))+/,tv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,nv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,gs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,rv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,No=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,kc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,xc=Ve(kc).replace(/bull/g,No).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),av=Ve(kc).replace(/bull/g,No).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),qo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,sv=/^[^\n]+/,jo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,iv=Ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",jo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ov=Ve(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,No).getRegex(),ci="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Bo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,lv=Ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Bo).replace("tag",ci).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Sc=Ve(qo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),uv=Ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Sc).getRegex(),zo={blockquote:uv,code:tv,def:iv,fences:nv,heading:rv,hr:gs,html:lv,lheading:xc,list:ov,newline:ev,paragraph:Sc,table:Br,text:sv},Kl=Ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),cv={...zo,lheading:av,table:Kl,paragraph:Ve(qo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex()},fv={...zo,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Bo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Br,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(qo).replace("hr",gs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},dv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,hv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ec=/^( {2,}|\\)\n(?!\s*$)/,pv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fi=/[\p{P}\p{S}]/u,Fo=/[\s\p{P}\p{S}]/u,Tc=/[^\s\p{P}\p{S}]/u,vv=Ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Fo).getRegex(),Ac=/(?!~)[\p{P}\p{S}]/u,gv=/(?!~)[\s\p{P}\p{S}]/u,mv=/(?:[^\s\p{P}\p{S}]|~)/u,Cc=/(?![*_])[\p{P}\p{S}]/u,yv=/(?![*_])[\s\p{P}\p{S}]/u,bv=/(?:[^\s\p{P}\p{S}]|[*_])/u,_v=Ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Jp?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ic=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,wv=Ve(Ic,"u").replace(/punct/g,fi).getRegex(),kv=Ve(Ic,"u").replace(/punct/g,Ac).getRegex(),Rc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",xv=Ve(Rc,"gu").replace(/notPunctSpace/g,Tc).replace(/punctSpace/g,Fo).replace(/punct/g,fi).getRegex(),Sv=Ve(Rc,"gu").replace(/notPunctSpace/g,mv).replace(/punctSpace/g,gv).replace(/punct/g,Ac).getRegex(),Ev=Ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Tc).replace(/punctSpace/g,Fo).replace(/punct/g,fi).getRegex(),Tv=Ve(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Cc).getRegex(),Av="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Cv=Ve(Av,"gu").replace(/notPunctSpace/g,bv).replace(/punctSpace/g,yv).replace(/punct/g,Cc).getRegex(),Iv=Ve(/\\(punct)/,"gu").replace(/punct/g,fi).getRegex(),Rv=Ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Pv=Ve(Bo).replace("(?:-->|$)","-->").getRegex(),Ov=Ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Pv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ei=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Dv=Ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ei).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Pc=Ve(/^!?\[(label)\]\[(ref)\]/).replace("label",ei).replace("ref",jo).getRegex(),Oc=Ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",jo).getRegex(),Mv=Ve("reflink|nolink(?!\\()","g").replace("reflink",Pc).replace("nolink",Oc).getRegex(),Ul=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Ko={_backpedal:Br,anyPunctuation:Iv,autolink:Rv,blockSkip:_v,br:Ec,code:hv,del:Br,delLDelim:Br,delRDelim:Br,emStrongLDelim:wv,emStrongRDelimAst:xv,emStrongRDelimUnd:Ev,escape:dv,link:Dv,nolink:Oc,punctuation:vv,reflink:Pc,reflinkSearch:Mv,tag:Ov,text:pv,url:Br},Lv={...Ko,link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",ei).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ei).getRegex()},co={...Ko,emStrongRDelimAst:Sv,emStrongLDelim:kv,delLDelim:Tv,delRDelim:Cv,url:Ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Ul).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Ul).getRegex()},Nv={...co,br:Ve(Ec).replace("{2,}","*").getRegex(),text:Ve(co.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:zo,gfm:cv,pedantic:fv},Wa={normal:Ko,gfm:co,breaks:Nv,pedantic:Lv},qv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gl=t=>qv[t];function Xn(t,e){if(e){if(Bt.escapeTest.test(t))return t.replace(Bt.escapeReplace,Gl)}else if(Bt.escapeTestNoEncode.test(t))return t.replace(Bt.escapeReplaceNoEncode,Gl);return t}function Hl(t){try{t=encodeURI(t).replace(Bt.percentDecode,"%")}catch{return null}return t}function Wl(t,e){var o;let r=t.replace(Bt.findPipe,(c,d,v)=>{let p=!1,y=d;for(;--y>=0&&v[y]==="\\";)p=!p;return p?"|":" |"}),a=r.split(Bt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Bt.slashPipe,"|");return a}function Ya(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function jv(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function Bv(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function Yl(t,e,r,a,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function zv(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ti=class{constructor(t){Ke(this,"options");Ke(this,"rules");Ke(this,"lexer");this.options=t||aa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ya(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=zv(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Ya(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ya(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ya(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let p=d.join(`
`),y=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,i=i?`${i}
${y}`:y;let _=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=_,r.length===0)break;let b=o.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let w=b,D=w.raw+`
`+r.join(`
`),j=this.blockquote(D);o[o.length-1]=j,a=a.substring(0,a.length-w.raw.length)+j.raw,i=i.substring(0,i.length-w.text.length)+j.text;break}else if((b==null?void 0:b.type)==="list"){let w=b,D=w.raw+`
`+r.join(`
`),j=this.list(D);o[o.length-1]=j,a=a.substring(0,a.length-b.raw.length)+j.raw,i=i.substring(0,i.length-w.raw.length)+j.raw,r=D.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,_="",b="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;_=e[0],t=t.substring(_.length);let w=Bv(e[2].split(`
`,1)[0],e[1].length),D=t.split(`
`,1)[0],j=!w.trim(),S=0;if(this.options.pedantic?(S=2,b=w.trimStart()):j?S=e[1].length+1:(S=w.search(this.rules.other.nonSpaceChar),S=S>4?1:S,b=w.slice(S),S+=e[1].length),j&&this.rules.other.blankLine.test(D)&&(_+=D+`
`,t=t.substring(D.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(S),re=this.rules.other.hrRegex(S),$=this.rules.other.fencesBeginRegex(S),U=this.rules.other.headingBeginRegex(S),J=this.rules.other.htmlBeginRegex(S),le=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Z=t.split(`
`,1)[0],he;if(D=Z,this.options.pedantic?(D=D.replace(this.rules.other.listReplaceNesting,"  "),he=D):he=D.replace(this.rules.other.tabCharGlobal,"    "),$.test(D)||U.test(D)||J.test(D)||le.test(D)||F.test(D)||re.test(D))break;if(he.search(this.rules.other.nonSpaceChar)>=S||!D.trim())b+=`
`+he.slice(S);else{if(j||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||$.test(w)||U.test(w)||re.test(w))break;b+=`
`+D}j=!D.trim(),_+=Z+`
`,t=t.substring(Z.length+1),w=he.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(_)&&(v=!0)),c.items.push({type:"list_item",raw:_,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),c.raw+=_}let p=c.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let _=this.rules.other.listTaskCheckbox.exec(y.raw);if(_){let b={type:"checkbox",raw:_[0]+" ",checked:_[0]!=="[ ]"};y.checked=b.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=b.raw+y.tokens[0].raw,y.tokens[0].text=b.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(b)):y.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):y.tokens.unshift(b)}}if(!c.loose){let _=y.tokens.filter(w=>w.type==="space"),b=_.length>0&&_.some(w=>this.rules.other.anyLine.test(w.raw));c.loose=b}}if(c.loose)for(let y of c.items){y.loose=!0;for(let _ of y.tokens)_.type==="text"&&(_.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Wl(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Wl(d,o.header.length).map((v,p)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Ya(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=jv(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Yl(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Yl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(a=p.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(c=[...o].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let y=[...a[0]][0].length,_=t.slice(0,i+a.index+y+c);if(Math.min(i,c)%2){let w=_.slice(1,-1);return{type:"em",raw:_,text:w,tokens:this.lexer.inlineTokens(w)}}let b=_.slice(2,-2);return{type:"strong",raw:_,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(c=[...o].length,c!==i))continue;if(a[3]||a[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let p=[...a[0]][0].length,y=t.slice(0,i+a.index+p+c),_=y.slice(i,-i);return{type:"del",raw:y,text:_,tokens:this.lexer.inlineTokens(_)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Tn=class fo{constructor(e){Ke(this,"tokens");Ke(this,"options");Ke(this,"state");Ke(this,"inlineQueue");Ke(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||aa,this.options.tokenizer=this.options.tokenizer||new ti,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Bt,block:zs.normal,inline:Wa.normal};this.options.pedantic?(r.block=zs.pedantic,r.inline=Wa.pedantic):this.options.gfm&&(r.block=zs.gfm,this.options.breaks?r.inline=Wa.breaks:r.inline=Wa.gfm),this.tokenizer.rules=r}static get rules(){return{block:zs,inline:Wa}}static lex(e,r){return new fo(r).lex(e)}static lexInline(e,r){return new fo(r).inlineTokens(e)}lex(e){e=e.replace(Bt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Bt.tabCharGlobal,"    ").replace(Bt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let p=1/0,y=e.slice(1),_;this.options.extensions.startBlock.forEach(b=>{_=b.call({lexer:this},y),typeof _=="number"&&_>=0&&(p=Math.min(p,_))}),p<1/0&&p>=0&&(v=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let p=r.at(-1);a&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,p,y,_,b;let a=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((p=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:p.call({lexer:this},a))??a;let c=!1,d="";for(;e;){c||(d=""),c=!1;let w;if((_=(y=this.options.extensions)==null?void 0:y.inline)!=null&&_.some(j=>(w=j.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let j=r.at(-1);w.type==="text"&&(j==null?void 0:j.type)==="text"?(j.raw+=w.raw,j.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let D=e;if((b=this.options.extensions)!=null&&b.startInline){let j=1/0,S=e.slice(1),F;this.options.extensions.startInline.forEach(re=>{F=re.call({lexer:this},S),typeof F=="number"&&F>=0&&(j=Math.min(j,F))}),j<1/0&&j>=0&&(D=e.substring(0,j+1))}if(w=this.tokenizer.inlineText(D)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),c=!0;let j=r.at(-1);(j==null?void 0:j.type)==="text"?(j.raw+=w.raw,j.text+=w.text):r.push(w);continue}if(e){let j="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(j);break}else throw new Error(j)}}return r}},ni=class{constructor(t){Ke(this,"options");Ke(this,"parser");this.options=t||aa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Bt.notSpaceStart))==null?void 0:o[0],i=t.replace(Bt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Xn(a)+'">'+(r?i:Xn(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Xn(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let c=0;c<t.items.length;c++){let d=t.items[c];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Xn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Hl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Xn(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Hl(t);if(i===null)return Xn(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Xn(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Xn(t.text)}},Uo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},An=class ho{constructor(e){Ke(this,"options");Ke(this,"renderer");Ke(this,"textRenderer");this.options=e||aa,this.options.renderer=this.options.renderer||new ni,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Uo}static parse(e,r){return new ho(r).parse(e)}static parseInline(e,r){return new ho(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[c.type]){let v=c,p=this.options.extensions.renderers[v.type].call({parser:this},v);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=p||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=p||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let p='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return a}},Us,es=(Us=class{constructor(t){Ke(this,"options");Ke(this,"block");this.options=t||aa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Tn.lex:Tn.lexInline}provideParser(){return this.block?An.parse:An.parseInline}},Ke(Us,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ke(Us,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Us),Fv=class{constructor(...t){Ke(this,"defaults",Lo());Ke(this,"options",this.setOptions);Ke(this,"parse",this.parseMarkdown(!0));Ke(this,"parseInline",this.parseMarkdown(!1));Ke(this,"Parser",An);Ke(this,"Renderer",ni);Ke(this,"TextRenderer",Uo);Ke(this,"Lexer",Tn);Ke(this,"Tokenizer",ti);Ke(this,"Hooks",es);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ni(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ti(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new es;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];es.passThroughHooks.has(o)?i[c]=p=>{if(this.defaults.async&&es.passThroughHooksRespectAsync.has(o))return(async()=>{let _=await d.call(i,p);return v.call(i,_)})();let y=d.call(i,p);return v.call(i,y)}:i[c]=(...p)=>{if(this.defaults.async)return(async()=>{let _=await d.apply(i,p);return _===!1&&(_=await v.apply(i,p)),_})();let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Tn.lex(t,e??this.defaults)}parser(t,e){return An.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?An.parse:An.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?An.parse:An.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Xn(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},na=new Fv;function $e(t,e){return na.parse(t,e)}$e.options=$e.setOptions=function(t){return na.setOptions(t),$e.defaults=na.defaults,wc($e.defaults),$e};$e.getDefaults=Lo;$e.defaults=aa;$e.use=function(...t){return na.use(...t),$e.defaults=na.defaults,wc($e.defaults),$e};$e.walkTokens=function(t,e){return na.walkTokens(t,e)};$e.parseInline=na.parseInline;$e.Parser=An;$e.parser=An.parse;$e.Renderer=ni;$e.TextRenderer=Uo;$e.Lexer=Tn;$e.lexer=Tn.lex;$e.Tokenizer=ti;$e.Hooks=es;$e.parse=$e;$e.options;$e.setOptions;$e.use;$e.walkTokens;$e.parseInline;An.parse;Tn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Dc,setPrototypeOf:Vl,isFrozen:Kv,getPrototypeOf:Uv,getOwnPropertyDescriptor:Gv}=Object;let{freeze:zt,seal:mn,create:po}=Object,{apply:vo,construct:go}=typeof Reflect<"u"&&Reflect;zt||(zt=function(e){return e});mn||(mn=function(e){return e});vo||(vo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});go||(go=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Fs=Ft(Array.prototype.forEach),Hv=Ft(Array.prototype.lastIndexOf),Xl=Ft(Array.prototype.pop),Va=Ft(Array.prototype.push),Wv=Ft(Array.prototype.splice),Qs=Ft(String.prototype.toLowerCase),Ui=Ft(String.prototype.toString),Gi=Ft(String.prototype.match),Xa=Ft(String.prototype.replace),Yv=Ft(String.prototype.indexOf),Vv=Ft(String.prototype.trim),Sn=Ft(Object.prototype.hasOwnProperty),jt=Ft(RegExp.prototype.test),Qa=Xv(TypeError);function Ft(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return vo(t,e,a)}}function Xv(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return go(t,r)}}function Fe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qs;Vl&&Vl(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(Kv(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Qv(t){for(let e=0;e<t.length;e++)Sn(t,e)||(t[e]=null);return t}function qn(t){const e=po(null);for(const[r,a]of Dc(t))Sn(t,r)&&(Array.isArray(a)?e[r]=Qv(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=qn(a):e[r]=a);return e}function Za(t,e){for(;t!==null;){const a=Gv(t,e);if(a){if(a.get)return Ft(a.get);if(typeof a.value=="function")return Ft(a.value)}t=Uv(t)}function r(){return null}return r}const Ql=zt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hi=zt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wi=zt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Zv=zt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yi=zt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$v=zt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Zl=zt(["#text"]),$l=zt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vi=zt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Jl=zt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ks=zt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Jv=mn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),eg=mn(/<%[\w\W]*|[\w\W]*%>/gm),tg=mn(/\$\{[\w\W]*/gm),ng=mn(/^data-[\-\w.\u00B7-\uFFFF]+$/),rg=mn(/^aria-[\-\w]+$/),Mc=mn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ag=mn(/^(?:\w+script|data):/i),sg=mn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Lc=mn(/^html$/i),ig=mn(/^[a-z][.\w]*(-[.\w]+)+$/i);var eu=Object.freeze({__proto__:null,ARIA_ATTR:rg,ATTR_WHITESPACE:sg,CUSTOM_ELEMENT:ig,DATA_ATTR:ng,DOCTYPE_NAME:Lc,ERB_EXPR:eg,IS_ALLOWED_URI:Mc,IS_SCRIPT_OR_DATA:ag,MUSTACHE_EXPR:Jv,TMPLIT_EXPR:tg});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},og=function(){return typeof window>"u"?null:window},lg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},tu=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Nc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:og();const e=Re=>Nc(Re);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:p,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:_,DOMParser:b,trustedTypes:w}=t,D=v.prototype,j=Za(D,"cloneNode"),S=Za(D,"remove"),F=Za(D,"nextSibling"),re=Za(D,"childNodes"),$=Za(D,"parentNode");if(typeof c=="function"){const Re=r.createElement("template");Re.content&&Re.content.ownerDocument&&(r=Re.content.ownerDocument)}let U,J="";const{implementation:le,createNodeIterator:Z,createDocumentFragment:he,getElementsByTagName:Me}=r,{importNode:_e}=a;let me=tu();e.isSupported=typeof Dc=="function"&&typeof $=="function"&&le&&le.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ie,ERB_EXPR:ae,TMPLIT_EXPR:Le,DATA_ATTR:W,ARIA_ATTR:Q,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:ne}=eu;let{IS_ALLOWED_URI:te}=eu,K=null;const fe=Fe({},[...Ql,...Hi,...Wi,...Yi,...Zl]);let Se=null;const Ae=Fe({},[...$l,...Vi,...Jl,...Ks]);let Te=Object.seal(po(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Je=null,De=null;const tt=Object.seal(po(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let vt=!0,ke=!0,Nt=!1,He=!0,rn=!1,sa=!0,qt=!1,Ra=!1,Pa=!1,sr=!1,ia=!1,ir=!1,Xt=!0,Oa=!1;const Tr="user-content-";let oa=!0,yn=!1,gt={},yt=null;const Ar=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let or=null;const la=Fe({},["audio","video","img","source","image","track"]);let lr=null;const Dn=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gn="http://www.w3.org/1998/Math/MathML",ur="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Ie=bt,Hn=!1,bn=null;const ua=Fe({},[Gn,ur,bt],Ui);let be=Fe({},["mi","mo","mn","ms","mtext"]),cr=Fe({},["annotation-xml"]);const ms=Fe({},["title","style","font","a","script"]);let Wn=null;const ys=["application/xhtml+xml","text/html"],Da="text/html";let ft=null,fr=null;const dr=r.createElement("form"),Yn=function(T){return T instanceof RegExp||T instanceof Function},Cr=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fr&&fr===T)){if((!T||typeof T!="object")&&(T={}),T=qn(T),Wn=ys.indexOf(T.PARSER_MEDIA_TYPE)===-1?Da:T.PARSER_MEDIA_TYPE,ft=Wn==="application/xhtml+xml"?Ui:Qs,K=Sn(T,"ALLOWED_TAGS")?Fe({},T.ALLOWED_TAGS,ft):fe,Se=Sn(T,"ALLOWED_ATTR")?Fe({},T.ALLOWED_ATTR,ft):Ae,bn=Sn(T,"ALLOWED_NAMESPACES")?Fe({},T.ALLOWED_NAMESPACES,Ui):ua,lr=Sn(T,"ADD_URI_SAFE_ATTR")?Fe(qn(Dn),T.ADD_URI_SAFE_ATTR,ft):Dn,or=Sn(T,"ADD_DATA_URI_TAGS")?Fe(qn(la),T.ADD_DATA_URI_TAGS,ft):la,yt=Sn(T,"FORBID_CONTENTS")?Fe({},T.FORBID_CONTENTS,ft):Ar,Je=Sn(T,"FORBID_TAGS")?Fe({},T.FORBID_TAGS,ft):qn({}),De=Sn(T,"FORBID_ATTR")?Fe({},T.FORBID_ATTR,ft):qn({}),gt=Sn(T,"USE_PROFILES")?T.USE_PROFILES:!1,vt=T.ALLOW_ARIA_ATTR!==!1,ke=T.ALLOW_DATA_ATTR!==!1,Nt=T.ALLOW_UNKNOWN_PROTOCOLS||!1,He=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,rn=T.SAFE_FOR_TEMPLATES||!1,sa=T.SAFE_FOR_XML!==!1,qt=T.WHOLE_DOCUMENT||!1,sr=T.RETURN_DOM||!1,ia=T.RETURN_DOM_FRAGMENT||!1,ir=T.RETURN_TRUSTED_TYPE||!1,Pa=T.FORCE_BODY||!1,Xt=T.SANITIZE_DOM!==!1,Oa=T.SANITIZE_NAMED_PROPS||!1,oa=T.KEEP_CONTENT!==!1,yn=T.IN_PLACE||!1,te=T.ALLOWED_URI_REGEXP||Mc,Ie=T.NAMESPACE||bt,be=T.MATHML_TEXT_INTEGRATION_POINTS||be,cr=T.HTML_INTEGRATION_POINTS||cr,Te=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&Yn(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&Yn(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Te.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),rn&&(ke=!1),ia&&(sr=!0),gt&&(K=Fe({},Zl),Se=[],gt.html===!0&&(Fe(K,Ql),Fe(Se,$l)),gt.svg===!0&&(Fe(K,Hi),Fe(Se,Vi),Fe(Se,Ks)),gt.svgFilters===!0&&(Fe(K,Wi),Fe(Se,Vi),Fe(Se,Ks)),gt.mathMl===!0&&(Fe(K,Yi),Fe(Se,Jl),Fe(Se,Ks))),T.ADD_TAGS&&(typeof T.ADD_TAGS=="function"?tt.tagCheck=T.ADD_TAGS:(K===fe&&(K=qn(K)),Fe(K,T.ADD_TAGS,ft))),T.ADD_ATTR&&(typeof T.ADD_ATTR=="function"?tt.attributeCheck=T.ADD_ATTR:(Se===Ae&&(Se=qn(Se)),Fe(Se,T.ADD_ATTR,ft))),T.ADD_URI_SAFE_ATTR&&Fe(lr,T.ADD_URI_SAFE_ATTR,ft),T.FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,T.FORBID_CONTENTS,ft)),T.ADD_FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,T.ADD_FORBID_CONTENTS,ft)),oa&&(K["#text"]=!0),qt&&Fe(K,["html","head","body"]),K.table&&(Fe(K,["tbody"]),delete Je.tbody),T.TRUSTED_TYPES_POLICY){if(typeof T.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof T.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=T.TRUSTED_TYPES_POLICY,J=U.createHTML("")}else U===void 0&&(U=lg(w,i)),U!==null&&typeof J=="string"&&(J=U.createHTML(""));zt&&zt(T),fr=T}},Ir=Fe({},[...Hi,...Wi,...Zv]),nt=Fe({},[...Yi,...$v]),mt=function(T){let ue=$(T);(!ue||!ue.tagName)&&(ue={namespaceURI:Ie,tagName:"template"});const pe=Qs(T.tagName),Xe=Qs(ue.tagName);return bn[T.namespaceURI]?T.namespaceURI===ur?ue.namespaceURI===bt?pe==="svg":ue.namespaceURI===Gn?pe==="svg"&&(Xe==="annotation-xml"||be[Xe]):!!Ir[pe]:T.namespaceURI===Gn?ue.namespaceURI===bt?pe==="math":ue.namespaceURI===ur?pe==="math"&&cr[Xe]:!!nt[pe]:T.namespaceURI===bt?ue.namespaceURI===ur&&!cr[Xe]||ue.namespaceURI===Gn&&!be[Xe]?!1:!nt[pe]&&(ms[pe]||!Ir[pe]):!!(Wn==="application/xhtml+xml"&&bn[T.namespaceURI]):!1},an=function(T){Va(e.removed,{element:T});try{$(T).removeChild(T)}catch{S(T)}},sn=function(T,ue){try{Va(e.removed,{attribute:ue.getAttributeNode(T),from:ue})}catch{Va(e.removed,{attribute:null,from:ue})}if(ue.removeAttribute(T),T==="is")if(sr||ia)try{an(ue)}catch{}else try{ue.setAttribute(T,"")}catch{}},Rr=function(T){let ue=null,pe=null;if(Pa)T="<remove></remove>"+T;else{const it=Gi(T,/^[\r\n\t ]+/);pe=it&&it[0]}Wn==="application/xhtml+xml"&&Ie===bt&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");const Xe=U?U.createHTML(T):T;if(Ie===bt)try{ue=new b().parseFromString(Xe,Wn)}catch{}if(!ue||!ue.documentElement){ue=le.createDocument(Ie,"template",null);try{ue.documentElement.innerHTML=Hn?J:Xe}catch{}}const rt=ue.body||ue.documentElement;return T&&pe&&rt.insertBefore(r.createTextNode(pe),rt.childNodes[0]||null),Ie===bt?Me.call(ue,qt?"html":"body")[0]:qt?ue.documentElement:rt},Pr=function(T){return Z.call(T.ownerDocument||T,T,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},Ma=function(T){return T instanceof _&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof y)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},_n=function(T){return typeof d=="function"&&T instanceof d};function Pt(Re,T,ue){Fs(Re,pe=>{pe.call(e,T,ue,fr)})}const wn=function(T){let ue=null;if(Pt(me.beforeSanitizeElements,T,null),Ma(T))return an(T),!0;const pe=ft(T.nodeName);if(Pt(me.uponSanitizeElement,T,{tagName:pe,allowedTags:K}),sa&&T.hasChildNodes()&&!_n(T.firstElementChild)&&jt(/<[/\w!]/g,T.innerHTML)&&jt(/<[/\w!]/g,T.textContent)||T.nodeType===$a.progressingInstruction||sa&&T.nodeType===$a.comment&&jt(/<[/\w]/g,T.data))return an(T),!0;if(!(tt.tagCheck instanceof Function&&tt.tagCheck(pe))&&(!K[pe]||Je[pe])){if(!Je[pe]&&bs(pe)&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,pe)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(pe)))return!1;if(oa&&!yt[pe]){const Xe=$(T)||T.parentNode,rt=re(T)||T.childNodes;if(rt&&Xe){const it=rt.length;for(let dt=it-1;dt>=0;--dt){const Ut=j(rt[dt],!0);Ut.__removalCount=(T.__removalCount||0)+1,Xe.insertBefore(Ut,F(T))}}}return an(T),!0}return T instanceof v&&!mt(T)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&jt(/<\/no(script|embed|frames)/i,T.innerHTML)?(an(T),!0):(rn&&T.nodeType===$a.text&&(ue=T.textContent,Fs([ie,ae,Le],Xe=>{ue=Xa(ue,Xe," ")}),T.textContent!==ue&&(Va(e.removed,{element:T.cloneNode()}),T.textContent=ue)),Pt(me.afterSanitizeElements,T,null),!1)},Or=function(T,ue,pe){if(Xt&&(ue==="id"||ue==="name")&&(pe in r||pe in dr))return!1;if(!(ke&&!De[ue]&&jt(W,ue))){if(!(vt&&jt(Q,ue))){if(!(tt.attributeCheck instanceof Function&&tt.attributeCheck(ue,T))){if(!Se[ue]||De[ue]){if(!(bs(T)&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,T)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(T))&&(Te.attributeNameCheck instanceof RegExp&&jt(Te.attributeNameCheck,ue)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(ue,T))||ue==="is"&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&jt(Te.tagNameCheck,pe)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(pe))))return!1}else if(!lr[ue]){if(!jt(te,Xa(pe,Y,""))){if(!((ue==="src"||ue==="xlink:href"||ue==="href")&&T!=="script"&&Yv(pe,"data:")===0&&or[T])){if(!(Nt&&!jt(ee,Xa(pe,Y,"")))){if(pe)return!1}}}}}}}return!0},bs=function(T){return T!=="annotation-xml"&&Gi(T,ne)},kn=function(T){Pt(me.beforeSanitizeAttributes,T,null);const{attributes:ue}=T;if(!ue||Ma(T))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se,forceKeepAttr:void 0};let Xe=ue.length;for(;Xe--;){const rt=ue[Xe],{name:it,namespaceURI:dt,value:Ut}=rt,Mn=ft(it),Dr=Ut;let st=it==="value"?Dr:Vv(Dr);if(pe.attrName=Mn,pe.attrValue=st,pe.keepAttr=!0,pe.forceKeepAttr=void 0,Pt(me.uponSanitizeAttribute,T,pe),st=pe.attrValue,Oa&&(Mn==="id"||Mn==="name")&&(sn(it,T),st=Tr+st),sa&&jt(/((--!?|])>)|<\/(style|title|textarea)/i,st)){sn(it,T);continue}if(Mn==="attributename"&&Gi(st,"href")){sn(it,T);continue}if(pe.forceKeepAttr)continue;if(!pe.keepAttr){sn(it,T);continue}if(!He&&jt(/\/>/i,st)){sn(it,T);continue}rn&&Fs([ie,ae,Le],Mr=>{st=Xa(st,Mr," ")});const La=ft(T.nodeName);if(!Or(La,Mn,st)){sn(it,T);continue}if(U&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!dt)switch(w.getAttributeType(La,Mn)){case"TrustedHTML":{st=U.createHTML(st);break}case"TrustedScriptURL":{st=U.createScriptURL(st);break}}if(st!==Dr)try{dt?T.setAttributeNS(dt,it,st):T.setAttribute(it,st),Ma(T)?an(T):Xl(e.removed)}catch{sn(it,T)}}Pt(me.afterSanitizeAttributes,T,null)},_s=function Re(T){let ue=null;const pe=Pr(T);for(Pt(me.beforeSanitizeShadowDOM,T,null);ue=pe.nextNode();)Pt(me.uponSanitizeShadowNode,ue,null),wn(ue),kn(ue),ue.content instanceof o&&Re(ue.content);Pt(me.afterSanitizeShadowDOM,T,null)};return e.sanitize=function(Re){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=null,pe=null,Xe=null,rt=null;if(Hn=!Re,Hn&&(Re="<!-->"),typeof Re!="string"&&!_n(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Qa("dirty is not a string, aborting")}else throw Qa("toString is not a function");if(!e.isSupported)return Re;if(Ra||Cr(T),e.removed=[],typeof Re=="string"&&(yn=!1),yn){if(Re.nodeName){const Ut=ft(Re.nodeName);if(!K[Ut]||Je[Ut])throw Qa("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof d)ue=Rr("<!---->"),pe=ue.ownerDocument.importNode(Re,!0),pe.nodeType===$a.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?ue=pe:ue.appendChild(pe);else{if(!sr&&!rn&&!qt&&Re.indexOf("<")===-1)return U&&ir?U.createHTML(Re):Re;if(ue=Rr(Re),!ue)return sr?null:ir?J:""}ue&&Pa&&an(ue.firstChild);const it=Pr(yn?Re:ue);for(;Xe=it.nextNode();)wn(Xe),kn(Xe),Xe.content instanceof o&&_s(Xe.content);if(yn)return Re;if(sr){if(ia)for(rt=he.call(ue.ownerDocument);ue.firstChild;)rt.appendChild(ue.firstChild);else rt=ue;return(Se.shadowroot||Se.shadowrootmode)&&(rt=_e.call(a,rt,!0)),rt}let dt=qt?ue.outerHTML:ue.innerHTML;return qt&&K["!doctype"]&&ue.ownerDocument&&ue.ownerDocument.doctype&&ue.ownerDocument.doctype.name&&jt(Lc,ue.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+ue.ownerDocument.doctype.name+`>
`+dt),rn&&Fs([ie,ae,Le],Ut=>{dt=Xa(dt,Ut," ")}),U&&ir?U.createHTML(dt):dt},e.setConfig=function(){let Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cr(Re),Ra=!0},e.clearConfig=function(){fr=null,Ra=!1},e.isValidAttribute=function(Re,T,ue){fr||Cr({});const pe=ft(Re),Xe=ft(T);return Or(pe,Xe,ue)},e.addHook=function(Re,T){typeof T=="function"&&Va(me[Re],T)},e.removeHook=function(Re,T){if(T!==void 0){const ue=Hv(me[Re],T);return ue===-1?void 0:Wv(me[Re],ue,1)[0]}return Xl(me[Re])},e.removeHooks=function(Re){me[Re]=[]},e.removeAllHooks=function(){me=tu()},e}var ug=Nc();function cg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${nu(t.from)} |`),e.push(`| **To** | ${nu(t.to)} |`),e.push(`| **Date** | ${Mo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?fg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function nu(t){return(t||"").replace(/\|/g,"\\|")}function fg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return mo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function dg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function mo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return dg(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(mo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>mo(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function hg(t){const e=pg(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.md`}function pg(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function ru(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function vg(t){return t.raw||null}function gg(t){const e=vg(t);return e?JSON.stringify(e,null,2):"null"}function mg(t){const e=yg(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.json`}function yg(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}var bg=X('<button title="View as Markdown">.md</button>'),_g=X('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),wg=X('<pre class="md-raw svelte-1b0rzpb"> </pre>'),kg=X('<div class="md-preview svelte-1b0rzpb"><!></div>'),xg=X('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Sg=X('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Eg=X('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Tg=X('<pre class="message-text svelte-1b0rzpb"> </pre>'),Ag=X('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),Cg=X('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Ig=X('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Rg(t,e){lt(e,!0);let r=Pe(e,"loading",3,!1);Rt(()=>nn("MessageModal"));const a=new $e.Renderer;a.link=({href:ie,title:ae,text:Le})=>{const W=ae?` title="${ae}"`:"";return`<a href="${ie}"${W} target="_blank" rel="noopener">${Le}</a>`},$e.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Oe("email"),o=Mt(()=>e.message.body?cg(e.message):""),c=Mt(()=>gg(e.message)),d=Oe("raw");function v(ie){z(i,k(i)===ie?"email":ie,!0),ie==="markdown"&&z(d,"raw")}function p(){ru(k(o),hg(e.message))}function y(){ru(k(c),mg(e.message),"application/json;charset=utf-8")}function _(ie){const ae=$e.parse(ie);return ug.sanitize(ae,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let b=Oe(null);$s(()=>{var ie;if(k(b)&&e.message.htmlBody&&!r()&&k(i)==="email"){const ae=k(b).contentDocument||((ie=k(b).contentWindow)==null?void 0:ie.document);ae&&(ae.open(),ae.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ae.close())}});var w=Ig();w.__click=function(...ie){var ae;(ae=e.onclose)==null||ae.apply(this,ie)};var D=x(w);D.__click=ie=>ie.stopPropagation();var j=x(D),S=x(j),F=x(S),re=M(S,2),$=x(re);let U;$.__click=()=>v("json");var J=M($,2);{var le=ie=>{var ae=bg();let Le;ae.__click=()=>v("markdown"),ye(()=>Le=dn(ae,1,"action-btn svelte-1b0rzpb",null,Le,{active:k(i)==="markdown"})),G(ie,ae)};we(J,ie=>{e.message.body&&ie(le)})}var Z=M(J,2);Z.__click=function(...ie){var ae;(ae=e.onclose)==null||ae.apply(this,ie)};var he=M(j,2);{var Me=ie=>{var ae=_g(),Le=xt(ae),W=M(x(Le),2);W.__click=y;var Q=M(Le,2),ee=x(Q),Y=x(ee);ye(()=>ce(Y,k(c))),G(ie,ae)},_e=ie=>{var ae=xg(),Le=xt(ae),W=x(Le),Q=x(W);let ee;Q.__click=()=>z(d,"raw");var Y=M(Q,2);let ne;Y.__click=()=>z(d,"preview");var te=M(W,2);te.__click=p;var K=M(Le,2),fe=x(K);{var Se=Te=>{var Je=wg(),De=x(Je);ye(()=>ce(De,k(o))),G(Te,Je)},Ae=Te=>{var Je=kg(),De=x(Je);Cd(De,()=>_(k(o))),G(Te,Je)};we(fe,Te=>{k(d)==="raw"?Te(Se):Te(Ae,!1)})}ye(()=>{ee=dn(Q,1,"md-tab svelte-1b0rzpb",null,ee,{active:k(d)==="raw"}),ne=dn(Y,1,"md-tab svelte-1b0rzpb",null,ne,{active:k(d)==="preview"})}),G(ie,ae)},me=ie=>{var ae=Cg(),Le=xt(ae),W=x(Le),Q=M(x(W),2),ee=x(Q),Y=M(W,2),ne=M(x(Y),2),te=x(ne),K=M(Y,2),fe=M(x(K),2),Se=x(fe),Ae=M(Le,2),Te=x(Ae);{var Je=ke=>{var Nt=Sg();G(ke,Nt)},De=ke=>{var Nt=Eg();sc(Nt,He=>z(b,He),()=>k(b)),G(ke,Nt)},tt=ke=>{var Nt=Tg(),He=x(Nt);ye(()=>ce(He,e.message.body)),G(ke,Nt)},vt=ke=>{var Nt=Ag();G(ke,Nt)};we(Te,ke=>{r()?ke(Je):e.message.htmlBody?ke(De,1):e.message.body?ke(tt,2):ke(vt,!1)})}ye(ke=>{ce(ee,e.message.from),ce(te,e.message.to),ce(Se,ke)},[()=>Mo(e.message.date)]),G(ie,ae)};we(he,ie=>{k(i)==="json"?ie(Me):k(i)==="markdown"?ie(_e,1):ie(me,!1)})}ye(()=>{ce(F,e.message.subject),U=dn($,1,"action-btn svelte-1b0rzpb",null,U,{active:k(i)==="json"})}),G(t,w),ut()}Kt(["click"]);var Pg=X('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),Og=X('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),Dg=X('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Mg=X("<p> </p>"),Lg=X('<p>No emails in local storage. Click "Sync New" to download.</p>'),Ng=X('<div class="empty-state svelte-6ts5xm"><!></div>'),qg=X('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),jg=X('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Bg(t,e){lt(e,!0),Rt(()=>nn("DashboardView"));let r=Pe(e,"error",3,null),a=Pe(e,"profile",3,null),i=Pe(e,"loadingProfile",3,!1),o=Pe(e,"emailMessages",19,()=>[]),c=Pe(e,"totalLocalMessages",3,0),d=Pe(e,"hasMoreLocal",3,!1),v=Pe(e,"loadingMessages",3,!1),p=Pe(e,"selectedMessage",3,null),y=Pe(e,"syncStatus",3,null),_=Pe(e,"syncProgress",3,null),b=Pe(e,"isSyncing",3,!1),w=Pe(e,"searchQuery",15);var D=jg(),j=xt(D),S=x(j);{var F=W=>{yc(W,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};we(S,W=>{r()&&W(F)})}var re=M(S,2);Np(re,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var $=M(re,2);Xp($,{get syncStatus(){return y()},get syncProgress(){return _()},get isSyncing(){return b()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var U=M($,2),J=x(U);J.__keydown=W=>W.key==="Enter"&&e.onsearch();var le=M(J,2);le.__click=function(...W){var Q;(Q=e.onsearch)==null||Q.apply(this,W)};var Z=x(le),he=M(U,2);{var Me=W=>{var Q=Og(),ee=xt(Q),Y=x(ee),ne=x(Y),te=M(ee,2);$p(te,{get messages(){return o()},get onselect(){return e.onviewmessage}});var K=M(te,2);{var fe=Se=>{var Ae=Pg(),Te=x(Ae);Te.__click=function(...De){var tt;(tt=e.onloadmore)==null||tt.apply(this,De)};var Je=x(Te);ye(()=>{Te.disabled=v(),ce(Je,v()?"Loading...":"Load More")}),G(Se,Ae)};we(K,Se=>{d()&&Se(fe)})}ye(Se=>ce(ne,`Showing ${o().length??""} of ${Se??""}
        ${w()?" matching":""} emails`),[()=>c().toLocaleString()]),G(W,Q)},_e=W=>{var Q=Dg();G(W,Q)},me=W=>{var Q=Ng(),ee=x(Q);{var Y=te=>{var K=Mg(),fe=x(K);ye(()=>ce(fe,`No emails match "${w()??""}".`)),G(te,K)},ne=te=>{var K=Lg();G(te,K)};we(ee,te=>{w()?te(Y):te(ne,!1)})}G(W,Q)},ie=W=>{var Q=qg();G(W,Q)};we(he,W=>{var Q;o().length>0?W(Me):v()?W(_e,1):(Q=y())!=null&&Q.synced?W(me,2):W(ie,!1)})}var ae=M(j,2);{var Le=W=>{Rg(W,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};we(ae,W=>{p()&&W(Le)})}ye(()=>{le.disabled=v(),ce(Z,v()?"Searching...":"Search")}),Do(J,w),G(t,D),ut()}Kt(["keydown","click"]);var zg=X('<div class="dashboard svelte-1q5o2lv"><!></div>');function Fg(t,e){lt(e,!0);function r(De){De.key==="Escape"&&k(v)&&ee()}Rt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Oe(wt(localStorage.getItem("googleClientId")||"")),i=Oe(wt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),p=Oe(""),y=Oe(wt([])),_=Oe(0),b=Oe(0),w=Oe(!1),D=Oe(!1),j=Oe(!1),S=Oe(null),F=Oe(null),re=Oe(null),$=Oe(!1);const U=50;$s(()=>{k(c)&&(Y(),ae())});let J=Mt(()=>!k(a)),le=Mt(()=>!!k(c)),Z=Mt(()=>k(y).length<k(_));$s(()=>{k(a)&&!k(o)&&zl(k(a)).then(()=>{z(o,!0)}).catch(De=>{z(S,`Auth init failed: ${De.message}`)})});function he(){const De=k(i).trim();De&&(localStorage.setItem("googleClientId",De),z(a,De,!0),z(S,null))}function Me(){localStorage.removeItem("googleClientId"),z(a,""),z(i,""),z(o,!1),z(c,null),z(d,null),z(y,[],!0),z(_,0)}async function _e(){z(S,null),z(D,!0);try{k(o)||(await zl(k(a)),z(o,!0));const De=await ap();z(c,De.access_token,!0),await ie()}catch(De){z(S,De.message,!0)}finally{z(D,!1)}}async function me(){if(k(c))try{await sp(k(c))}catch{}z(c,null),z(d,null),z(y,[],!0),z(_,0),z(v,null),z(S,null)}async function ie(){z(j,!0);try{const De=await cc(k(c));if(!k(c))return;z(d,De,!0)}catch(De){if(!k(c))return;z(S,`Profile fetch failed: ${De.message}`)}finally{z(j,!1)}}async function ae(De=!1){z(w,!0);try{const tt=De?k(b):0,vt=await th({query:k(p)||void 0,limit:U,offset:tt});De?z(y,[...k(y),...vt.items],!0):z(y,vt.items,!0),z(_,vt.total,!0),z(b,k(y).length,!0)}catch(tt){z(S,`Failed to load messages: ${tt.message}`)}finally{z(w,!1)}}function Le(){z(b,0),ae(!1)}function W(){ae(!0)}function Q(De){z(v,De,!0)}function ee(){z(v,null)}async function Y(){try{z(F,await pp(),!0)}catch{}}async function ne(De){if(k($)||!k(c))return;z(S,null),z($,!0),z(re,null);const tt=new AbortController;try{await dp(k(c),{limit:De,onProgress:vt=>{z(re,{...vt},!0)},signal:tt.signal}),await Y(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;z(S,`Sync failed: ${vt.message}`)}}finally{z($,!1)}}async function te(De){if(k($)||!k(c))return;z(S,null),z($,!0),z(re,null);const tt=new AbortController;try{await hp(k(c),{limit:De,onProgress:vt=>{z(re,{...vt},!0)},signal:tt.signal}),await Y(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;z(S,`Sync more failed: ${vt.message}`)}}finally{z($,!1)}}async function K(){try{await vp(),await Y(),z(y,[],!0),z(_,0),z(b,0)}catch(De){z(S,`Failed to clear data: ${De.message}`)}}var fe=zg(),Se=x(fe);{var Ae=De=>{wp(De,{onsave:he,get clientIdInput(){return k(i)},set clientIdInput(tt){z(i,tt,!0)}})},Te=De=>{Op(De,{get clientId(){return k(a)},get error(){return k(S)},get loadingAuth(){return k(D)},onsignin:_e,onclear:Me,onsignout:me})},Je=De=>{Bg(De,{get error(){return k(S)},get profile(){return k(d)},get loadingProfile(){return k(j)},get emailMessages(){return k(y)},get totalLocalMessages(){return k(_)},get hasMoreLocal(){return k(Z)},get loadingMessages(){return k(w)},get selectedMessage(){return k(v)},get syncStatus(){return k(F)},get syncProgress(){return k(re)},get isSyncing(){return k($)},onsignout:me,onsearch:Le,onloadmore:W,onviewmessage:Q,onclosedetail:ee,ondismisserror:()=>z(S,null),onsync:ne,onsyncmore:te,oncleardata:K,get searchQuery(){return k(p)},set searchQuery(tt){z(p,tt,!0)}})};we(Se,De=>{k(J)?De(Ae):k(le)?De(Je,!1):De(Te,1)})}G(t,fe),ut()}const Kg=20,Ug=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Gg(t,{count:e=Kg,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().limit(e).toArray();else{const p=new Set((await Ne.emailClassifications.toArray()).map(_=>_.emailId)),y=await Ne.items.where("[sourceType+date]").between(["gmail",Lt.minKey],["gmail",Lt.maxKey]).reverse().toArray();o=0,i=[];for(const _ of y)if(p.has(_.id))o++;else if(i.push(_),i.length>=e)break}if(i.length===0){const p=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:p,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let p=0;p<i.length;p++){const y=i[p];a({phase:"scanning",message:`Classifying email ${p+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:p+1,total:i.length,classified:d});try{const _=Zg(y),b=[{role:"system",content:Ug},{role:"user",content:_}],w=await t.generateFull(b),D=Jg(w);D&&(await Ne.emailClassifications.put({emailId:y.id,action:D.action,reason:D.reason,summary:D.summary,tags:D.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:c,status:"pending"}),d++)}catch(_){console.error(`Triage email ${p+1} failed:`,_),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function Hg(){const t=await Ne.emailClassifications.toArray(),e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function Wg(){const t=await Ne.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function au(t,e){await Ne.emailClassifications.update(t,{status:e})}async function Yg(){await Ne.emailClassifications.clear()}async function Vg(t){await Ne.emailClassifications.where("action").equals(t).delete()}async function Xg(t){await Ne.emailClassifications.delete(t)}async function Qg(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Zg(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=$g(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function $g(t,e){return!t||t.length<=e?t:t.slice(0,e)+"..."}function Jg(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=em(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function em(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function tm(t){let e=0;for(let a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 55%, 55%)`}function nm(t){let e=0;for(let a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 40%, 35%)`}var rm=X('<span class="spinner svelte-ois7em"></span>'),am=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),sm=X('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),im=X('<option class="svelte-ois7em"> </option>'),om=X('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),lm=X('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),um=X('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function cm(t,e){lt(e,!0);let r=Pe(e,"engineStatus",3,"idle"),a=Pe(e,"modelName",3,""),i=Pe(e,"isScanning",3,!1),o=Pe(e,"scanProgress",3,null),c=Pe(e,"scanCount",15,20),d=Pe(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function _(){return r()==="ready"&&!i()}var b=um(),w=x(b),D=x(w),j=x(D);{var S=te=>{var K=rm();G(te,K)},F=te=>{var K=am();G(te,K)};we(j,te=>{i()?te(S):te(F,!1)})}var re=M(D,2),$=M(x(re),2),U=x($);let J;var le=M(U),Z=M(w,2);{var he=te=>{var K=sm(),fe=x(K),Se=x(fe),Ae=M(fe,4),Te=x(Ae),Je=M(Ae,4),De=x(Je);ye(()=>{ce(Se,`${d().totalEmails??""} emails in storage`),ce(Te,`${d().classified??""} classified`),ce(De,`${d().unclassified??""} new`)}),G(te,K)};we(Z,te=>{d()&&te(he)})}var Me=M(Z,2),_e=x(Me),me=M(x(_e),2);gn(me,21,()=>v,Er,(te,K)=>{var fe=im(),Se=x(fe),Ae={};ye(()=>{ce(Se,k(K).label),Ae!==(Ae=k(K).value)&&(fe.value=(fe.__value=k(K).value)??"")}),G(te,fe)});var ie=M(_e,2),ae=x(ie);ae.__click=function(...te){var K;(K=e.onscan)==null||K.apply(this,te)};var Le=x(ae),W=M(ae,2);W.__click=function(...te){var K;(K=e.onrescan)==null||K.apply(this,te)};var Q=M(Me,2);{var ee=te=>{var K=om();G(te,K)};we(Q,te=>{r()!=="ready"&&r()!=="loading"&&te(ee)})}var Y=M(Q,2);{var ne=te=>{var K=lm(),fe=x(K),Se=x(fe);let Ae,Te;var Je=M(fe,2),De=x(Je);ye(()=>{Ae=dn(Se,1,"progress-fill svelte-ois7em",null,Ae,{indeterminate:!o().total}),Te=Rn(Se,"",Te,{width:`${o().total?o().current/o().total*100:0}%`}),ce(De,o().message||"Scanning...")}),G(te,K)};we(Y,te=>{i()&&o()&&te(ne)})}ye((te,K,fe,Se)=>{J=Rn(U,"",J,te),ce(le,` ${K??""}`),me.disabled=i(),ae.disabled=fe,ce(Le,i()?"Scanning...":"Scan New"),W.disabled=Se},[()=>({background:y()}),p,()=>!_(),()=>!_()]),Oo(me,c),G(t,b),ut()}Kt(["click"]);var fm=X('<span class="row-date svelte-1czytqk"> </span>'),dm=X('<span class="tag svelte-1czytqk"> </span>'),hm=X('<span class="row-tags svelte-1czytqk"></span>'),pm=X('<span class="row-reason svelte-1czytqk"> </span>'),vm=X('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),gm=X('<span class="status-label svelte-1czytqk"> </span>'),mm=X('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),ym=X('<p class="summary-reason svelte-1czytqk"> </p>'),bm=X('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),_m=X('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function su(t,e){lt(e,!0);let r=Pe(e,"actionColor",3,"#666"),a=Pe(e,"dimmed",3,!1);function i(W){if(!W)return"";try{return new Date(W).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=Mt(()=>e.item.status==="pending"),c=Oe(!1);var d=_m(),v=xt(d);let p;var y=x(v);y.__click=()=>z(c,!k(c));let _;var b=x(y),w=x(b),D=M(b,2),j=x(D),S=x(j),F=M(j,2);{var re=W=>{var Q=fm(),ee=x(Q);ye(Y=>ce(ee,Y),[()=>i(e.item.date)]),G(W,Q)};we(F,W=>{e.item.date&&W(re)})}var $=M(D,2);{var U=W=>{var Q=hm();gn(Q,21,()=>e.item.tags,Er,(ee,Y)=>{var ne=dm();let te;var K=x(ne);ye(fe=>{te=Rn(ne,"",te,fe),ce(K,k(Y))},[()=>({background:nm(k(Y))})]),G(ee,ne)}),G(W,Q)};we($,W=>{e.item.tags&&e.item.tags.length>0&&W(U)})}var J=M($,2);{var le=W=>{var Q=pm(),ee=x(Q);ye(()=>ce(ee,e.item.reason)),G(W,Q)};we(J,W=>{e.item.reason&&!k(c)&&W(le)})}var Z=M(y,2),he=x(Z);{var Me=W=>{var Q=vm(),ee=xt(Q);ee.__click=()=>e.onmarkacted(e.item.emailId);var Y=M(ee,2);Y.__click=()=>e.ondismiss(e.item.emailId),G(W,Q)},_e=W=>{var Q=gm(),ee=x(Q);ye(()=>ce(ee,e.item.status)),G(W,Q)};we(he,W=>{k(o)?W(Me):W(_e,!1)})}var me=M(he,2);{var ie=W=>{var Q=mm();Q.__click=()=>e.onremove(e.item.emailId),G(W,Q)};we(me,W=>{e.onremove&&W(ie)})}var ae=M(v,2);{var Le=W=>{var Q=bm();let ee;var Y=x(Q),ne=x(Y),te=M(Y,2);{var K=fe=>{var Se=ym(),Ae=x(Se);ye(()=>ce(Ae,e.item.reason)),G(fe,Se)};we(te,fe=>{e.item.reason&&fe(K)})}ye(()=>{ee=Rn(Q,"",ee,{"border-left-color":r()}),ce(ne,e.item.summary)}),G(W,Q)};we(ae,W=>{k(c)&&e.item.summary&&W(Le)})}ye(()=>{p=dn(v,1,"email-row svelte-1czytqk",null,p,{dimmed:a()}),_=Rn(y,"",_,{"border-left-color":r()}),ce(w,e.item.subject),ce(S,e.item.from)}),G(t,d),ut()}Kt(["click"]);var wm=X('<span class="group-acted svelte-tl1unp"> </span>'),km=X('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),xm=X('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Sm=X('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Em=X('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Tm=X('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Am=X('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Cm(t,e){lt(e,!0);let r=Pe(e,"color",3,"#888");Pe(e,"count",3,0);let a=Pe(e,"items",19,()=>[]),i=Pe(e,"expanded",3,!1),o=Mt(()=>a().filter(le=>le.status==="pending")),c=Mt(()=>a().filter(le=>le.status!=="pending")),d=Oe(!1);function v(le){return le.split("_").map(Z=>Z.charAt(0)+Z.slice(1).toLowerCase()).join(" ")}var p=Am(),y=x(p);y.__click=function(...le){var Z;(Z=e.ontoggle)==null||Z.apply(this,le)};var _=x(y);let b;var w=x(_),D=M(_,2),j=x(D),S=M(D,2);{var F=le=>{var Z=wm(),he=x(Z);ye(()=>ce(he,`${k(c).length??""} handled`)),G(le,Z)};we(S,le=>{k(c).length>0&&le(F)})}var re=M(S,4);let $;var U=M(y,2);{var J=le=>{var Z=Tm(),he=x(Z);{var Me=ee=>{var Y=km();G(ee,Y)};we(he,ee=>{k(o).length===0&&k(c).length===0&&ee(Me)})}var _e=M(he,2);gn(_e,17,()=>k(o),ee=>ee.emailId,(ee,Y)=>{su(ee,{get item(){return k(Y)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var me=M(_e,2);{var ie=ee=>{var Y=xm(),ne=x(Y),te=x(ne),K=M(ne,2);gn(K,17,()=>k(c),fe=>fe.emailId,(fe,Se)=>{su(fe,{get item(){return k(Se)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ye(()=>ce(te,`${k(c).length??""} handled`)),G(ee,Y)};we(me,ee=>{k(c).length>0&&ee(ie)})}var ae=M(me,2),Le=x(ae);{var W=ee=>{var Y=Sm();Y.__click=()=>z(d,!0),G(ee,Y)},Q=ee=>{var Y=Em(),ne=x(Y),te=M(ne);te.__click=()=>z(d,!1);var K=M(te,2);K.__click=()=>{e.oncleargroup(),z(d,!1)},ye(()=>ce(ne,`Clear ${a().length??""} items? `)),G(ee,Y)};we(Le,ee=>{k(d)?ee(Q,!1):ee(W)})}G(le,Z)};we(U,le=>{i()&&le(J)})}ye(le=>{b=Rn(_,"",b,{background:r()}),ce(w,le),ce(j,k(o).length),$=dn(re,0,"chevron svelte-tl1unp",null,$,{open:i()})},[()=>v(e.action)]),G(t,p),ut()}Kt(["click"]);var Im=X('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Rm=X('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Pm=X('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Om=X('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Dm=X('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Mm=X('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Lm(t,e){lt(e,!0);let r=Pe(e,"groups",19,()=>({})),a=Pe(e,"groupOrder",19,()=>[]),i=Pe(e,"counts",19,()=>({})),o=Pe(e,"stats",3,null),c=Pe(e,"expandedGroup",3,null),d=Pe(e,"isScanning",3,!1),v=Pe(e,"scanProgress",3,null),p=Pe(e,"scanCount",15,20),y=Pe(e,"error",3,null),_=Oe(!1);var b=Mm(),w=x(b);cm(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return p()},set scanCount($){p($)}});var D=M(w,2);{var j=$=>{var U=Im(),J=x(U),le=x(J),Z=M(J,2);Z.__click=function(...he){var Me;(Me=e.ondismisserror)==null||Me.apply(this,he)},ye(()=>ce(le,y())),G($,U)};we(D,$=>{y()&&$(j)})}var S=M(D,2);{var F=$=>{var U=Om(),J=xt(U);gn(J,20,a,ie=>ie,(ie,ae)=>{{let Le=Mt(()=>tm(ae)),W=Mt(()=>{var Y;return((Y=r()[ae])==null?void 0:Y.length)||0}),Q=Mt(()=>r()[ae]||[]),ee=Mt(()=>c()===ae);Cm(ie,{get action(){return ae},get color(){return k(Le)},get count(){return k(W)},get items(){return k(Q)},get expanded(){return k(ee)},ontoggle:()=>e.ontogglegroup(ae),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ae)})}});var le=M(J,2),Z=x(le),he=x(Z),Me=M(Z,2);{var _e=ie=>{var ae=Rm();ae.__click=()=>z(_,!0),G(ie,ae)},me=ie=>{var ae=Pm(),Le=M(x(ae));Le.__click=()=>z(_,!1);var W=M(Le,2);W.__click=()=>{e.onclear(),z(_,!1)},G(ie,ae)};we(Me,ie=>{k(_)?ie(me,!1):ie(_e)})}ye(()=>ce(he,`${i().total??""} emails classified into ${a().length??""} groups`)),G($,U)},re=$=>{var U=Dm();G($,U)};we(S,$=>{i().total>0?$(F):d()||$(re,1)})}G(t,b),ut()}Kt(["click"]);var Nm=X('<div class="actions-page svelte-3tch4q"><!></div>');function qm(t,e){lt(e,!0);const r=ic();let a=Oe(wt(r.status)),i=Oe(""),o=Oe(wt({})),c=Oe(wt([])),d=Oe(wt({total:0})),v=Oe(null),p=Oe(null),y=Oe(!1),_=Oe(null),b=Oe(20),w=Oe(null);Rt(()=>{const _e=r.onMessage(me=>{if(me.status==="ready"){z(a,"ready");const ie=os.find(ae=>ae.id===r.modelId);z(i,(ie==null?void 0:ie.name)||r.modelId||"",!0)}me.status==="loading"&&z(a,"loading")});if(z(a,r.status,!0),r.modelId){const me=os.find(ie=>ie.id===r.modelId);z(i,(me==null?void 0:me.name)||r.modelId||"",!0)}return D(),()=>_e()});async function D(){try{const _e=await Hg();z(o,_e.groups,!0),z(c,_e.order,!0),z(d,await Wg(),!0),z(v,await Qg(),!0)}catch(_e){z(w,`Failed to load data: ${_e.message}`)}}async function j(){await F(!1)}async function S(){await F(!0)}async function F(_e){if(!(k(y)||!r.isReady)){z(w,null),z(y,!0),z(_,null);try{await Gg(r,{count:k(b),force:_e,onProgress:me=>{z(_,{...me},!0)}}),await D()}catch(me){z(w,`Scan failed: ${me.message}`)}finally{z(y,!1)}}}async function re(_e){await au(_e,"acted"),await D()}async function $(_e){await au(_e,"dismissed"),await D()}async function U(_e){await Xg(_e),await D()}async function J(_e){await Vg(_e),await D()}async function le(){await Yg(),await D()}function Z(_e){z(p,k(p)===_e?null:_e,!0)}var he=Nm(),Me=x(he);Lm(Me,{get engineStatus(){return k(a)},get modelName(){return k(i)},get groups(){return k(o)},get groupOrder(){return k(c)},get counts(){return k(d)},get stats(){return k(v)},get expandedGroup(){return k(p)},get isScanning(){return k(y)},get scanProgress(){return k(_)},get error(){return k(w)},onscan:j,onrescan:S,ontogglegroup:Z,onmarkacted:re,ondismiss:$,onremove:U,oncleargroup:J,onclear:le,ondismisserror:()=>z(w,null),get scanCount(){return k(b)},set scanCount(_e){z(b,_e,!0)}}),G(t,he),ut()}var jm=X('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Bm(t,e){lt(e,!0);function r(){const Z=location.hash;return Z==="#dashboard"?"dashboard":Z==="#actions"?"actions":"chat"}let a=Oe(wt(r()));Rt(()=>{function Z(){z(a,r(),!0)}return window.addEventListener("hashchange",Z),()=>window.removeEventListener("hashchange",Z)});var i=jm(),o=x(i),c=M(x(o),2),d=x(c);let v;var p=M(d,2);let y;var _=M(p,2);let b;var w=M(o,2),D=x(w);let j;var S=x(D);tp(S,{});var F=M(D,2);let re;var $=x(F);qm($,{});var U=M(F,2);let J;var le=x(U);Fg(le,{}),ye(()=>{v=dn(d,1,"svelte-1n46o8q",null,v,{active:k(a)==="chat"}),y=dn(p,1,"svelte-1n46o8q",null,y,{active:k(a)==="actions"}),b=dn(_,1,"svelte-1n46o8q",null,b,{active:k(a)==="dashboard"}),j=Rn(D,"",j,{display:k(a)==="chat"?"flex":"none"}),re=Rn(F,"",re,{display:k(a)==="actions"?"flex":"none"}),J=Rn(U,"",J,{display:k(a)==="dashboard"?"flex":"none"})}),G(t,i),ut()}wd(Bm,{target:document.getElementById("app")});
