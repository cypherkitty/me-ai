var vf=Object.defineProperty;var Sl=t=>{throw TypeError(t)};var gf=(t,e,r)=>e in t?vf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ye=(t,e,r)=>gf(t,typeof e!="symbol"?e+"":e,r),ji=(t,e,r)=>e.has(t)||Sl("Cannot "+r);var W=(t,e,r)=>(ji(t,e,"read from private field"),r?r.call(t):e.get(t)),Ve=(t,e,r)=>e.has(t)?Sl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,a)=>(ji(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),qt=(t,e,r)=>(ji(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Zi=!1;var xo=Array.isArray,mf=Array.prototype.indexOf,Ea=Array.prototype.includes,oi=Array.from,yf=Object.defineProperty,ya=Object.getOwnPropertyDescriptor,bf=Object.getOwnPropertyDescriptors,_f=Object.prototype,wf=Array.prototype,hu=Object.getPrototypeOf,Tl=Object.isExtensible;const kf=()=>{};function xf(t){for(var e=0;e<t.length;e++)t[e]()}function pu(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Ot=2,is=4,li=8,vu=1<<24,dr=16,Bn=32,ca=64,gu=128,_n=512,Tt=1024,Dt=2048,jn=4096,un=8192,cr=16384,hs=32768,Aa=65536,El=1<<17,mu=1<<18,Da=1<<19,Sf=1<<20,ur=1<<25,sa=65536,Ji=1<<21,So=1<<22,Ar=1<<23,na=Symbol("$state"),Tf=Symbol("legacy props"),Ef=Symbol(""),Yr=new class extends Error{constructor(){super(...arguments);Ye(this,"name","StaleReactionError");Ye(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Af(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Cf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function If(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Rf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Pf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Of(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Df(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Lf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Nf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function jf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Bf=1,zf=2,yu=4,Ff=8,Kf=16,Uf=1,Gf=4,Hf=8,Wf=16,bu=1,Yf=2,Ct=Symbol(),_u="http://www.w3.org/1999/xhtml";function Vf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Qf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function wu(t){return t===this.v}function Xf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function ku(t){return!Xf(t,this.v)}let Zf=!1,cn=null;function Ca(t){cn=t}function ft(t,e=!1,r){cn={p:cn,i:!1,c:null,e:null,s:t,x:null,l:null}}function dt(t){var e=cn,r=e.e;if(r!==null){e.e=null;for(var a of r)Gu(a)}return t!==void 0&&(e.x=t),e.i=!0,cn=e.p,t??{}}function xu(){return!0}let Vr=[];function Su(){var t=Vr;Vr=[],xf(t)}function Cr(t){if(Vr.length===0&&!ns){var e=Vr;queueMicrotask(()=>{e===Vr&&Su()})}Vr.push(t)}function Jf(){for(;Vr.length>0;)Su()}function Tu(t){var e=rt;if(e===null)return Qe.f|=Ar,t;if((e.f&hs)===0&&(e.f&is)===0)throw t;Ia(t,e)}function Ia(t,e){for(;e!==null;){if((e.f&gu)!==0){if((e.f&hs)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const $f=-7169;function wt(t,e){t.f=t.f&$f|e}function To(t){(t.f&_n)!==0||t.deps===null?wt(t,Tt):wt(t,jn)}function Eu(t){if(t!==null)for(const e of t)(e.f&Ot)===0||(e.f&sa)===0||(e.f^=sa,Eu(e.deps))}function Au(t,e,r){(t.f&Dt)!==0?e.add(t):(t.f&jn)!==0&&r.add(t),Eu(t.deps),wt(t,Tt)}const qs=new Set;let Ue=null,Js=null,It=null,Qt=[],ui=null,$i=!1,ns=!1;var ba,_a,Xr,wa,us,cs,Zr,sr,ka,Jn,eo,to,Cu;const Xo=class Xo{constructor(){Ve(this,Jn);Ye(this,"committed",!1);Ye(this,"current",new Map);Ye(this,"previous",new Map);Ve(this,ba,new Set);Ve(this,_a,new Set);Ve(this,Xr,0);Ve(this,wa,0);Ve(this,us,null);Ve(this,cs,new Set);Ve(this,Zr,new Set);Ve(this,sr,new Map);Ye(this,"is_fork",!1);Ve(this,ka,!1)}is_deferred(){return this.is_fork||W(this,wa)>0}skip_effect(e){W(this,sr).has(e)||W(this,sr).set(e,{d:[],m:[]})}unskip_effect(e){var r=W(this,sr).get(e);if(r){W(this,sr).delete(e);for(var a of r.d)wt(a,Dt),Nn(a);for(a of r.m)wt(a,jn),Nn(a)}}process(e){var i;Qt=[],this.apply();var r=[],a=[];for(const o of e)qt(this,Jn,eo).call(this,o,r,a);if(this.is_deferred()){qt(this,Jn,to).call(this,a),qt(this,Jn,to).call(this,r);for(const[o,c]of W(this,sr))Ou(o,c)}else{for(const o of W(this,ba))o();W(this,ba).clear(),W(this,Xr)===0&&qt(this,Jn,Cu).call(this),Js=this,Ue=null,Al(a),Al(r),Js=null,(i=W(this,us))==null||i.resolve()}It=null}capture(e,r){r!==Ct&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Ar)===0&&(this.current.set(e,e.v),It==null||It.set(e,e.v))}activate(){Ue=this,this.apply()}deactivate(){Ue===this&&(Ue=null,It=null)}flush(){if(this.activate(),Qt.length>0){if(Iu(),Ue!==null&&Ue!==this)return}else W(this,Xr)===0&&this.process([]);this.deactivate()}discard(){for(const e of W(this,_a))e(this);W(this,_a).clear()}increment(e){He(this,Xr,W(this,Xr)+1),e&&He(this,wa,W(this,wa)+1)}decrement(e){He(this,Xr,W(this,Xr)-1),e&&He(this,wa,W(this,wa)-1),!W(this,ka)&&(He(this,ka,!0),Cr(()=>{He(this,ka,!1),this.is_deferred()?Qt.length>0&&this.flush():this.revive()}))}revive(){for(const e of W(this,cs))W(this,Zr).delete(e),wt(e,Dt),Nn(e);for(const e of W(this,Zr))wt(e,jn),Nn(e);this.flush()}oncommit(e){W(this,ba).add(e)}ondiscard(e){W(this,_a).add(e)}settled(){return(W(this,us)??He(this,us,pu())).promise}static ensure(){if(Ue===null){const e=Ue=new Xo;qs.add(Ue),ns||Cr(()=>{Ue===e&&e.flush()})}return Ue}apply(){}};ba=new WeakMap,_a=new WeakMap,Xr=new WeakMap,wa=new WeakMap,us=new WeakMap,cs=new WeakMap,Zr=new WeakMap,sr=new WeakMap,ka=new WeakMap,Jn=new WeakSet,eo=function(e,r,a){e.f^=Tt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(Bn|ca))!==0,v=d&&(c&Tt)!==0,h=v||(c&un)!==0||W(this,sr).has(i);if(!h&&i.fn!==null){d?i.f^=Tt:o!==null&&(c&(is|li|vu))!==0?o.b.defer_effect(i):(c&is)!==0?r.push(i):vs(i)&&((c&dr)!==0&&W(this,Zr).add(i),Pa(i));var y=i.first;if(y!==null){i=y;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},to=function(e){for(var r=0;r<e.length;r+=1)Au(e[r],W(this,cs),W(this,Zr))},Cu=function(){var i;if(qs.size>1){this.previous.clear();var e=It,r=!0;for(const o of qs){if(o===this){r=!1;continue}const c=[];for(const[v,h]of this.current){if(o.current.has(v))if(r&&h!==o.current.get(v))o.current.set(v,h);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Qt;Qt=[];const v=new Set,h=new Map;for(const y of c)Ru(y,d,v,h);if(Qt.length>0){Ue=o,o.apply();for(const y of Qt)qt(i=o,Jn,eo).call(i,y,[],[]);o.deactivate()}Qt=a}}Ue=null,It=e}this.committed=!0,qs.delete(this)};let Ir=Xo;function ed(t){var e=ns;ns=!0;try{for(var r;;){if(Jf(),Qt.length===0&&(Ue==null||Ue.flush(),Qt.length===0))return ui=null,r;Iu()}}finally{ns=e}}function Iu(){$i=!0;var t=null;try{for(var e=0;Qt.length>0;){var r=Ir.ensure();if(e++>1e3){var a,i;td()}r.process(Qt),Rr.clear()}}finally{Qt=[],$i=!1,ui=null}}function td(){try{Df()}catch(t){Ia(t,ui)}}let Pn=null;function Al(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(cr|un))===0&&vs(a)&&(Pn=new Set,Pa(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Vu(a),(Pn==null?void 0:Pn.size)>0)){Rr.clear();for(const i of Pn){if((i.f&(cr|un))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)Pn.has(c)&&(Pn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(cr|un))===0&&Pa(v)}}Pn.clear()}}Pn=null}}function Ru(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ot)!==0?Ru(i,e,r,a):(o&(So|dr))!==0&&(o&Dt)===0&&Pu(i,e,a)&&(wt(i,Dt),Nn(i))}}function Pu(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ea.call(e,i))return!0;if((i.f&Ot)!==0&&Pu(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Nn(t){for(var e=ui=t;e.parent!==null;){e=e.parent;var r=e.f;if($i&&e===rt&&(r&dr)!==0&&(r&mu)===0)return;if((r&(ca|Bn))!==0){if((r&Tt)===0)return;e.f^=Tt}}Qt.push(e)}function Ou(t,e){if(!((t.f&Bn)!==0&&(t.f&Tt)!==0)){(t.f&Dt)!==0?e.d.push(t):(t.f&jn)!==0&&e.m.push(t),wt(t,Tt);for(var r=t.first;r!==null;)Ou(r,e),r=r.next}}function nd(t){let e=0,r=ia(0),a;return()=>{Co()&&(b(r),Io(()=>(e===0&&(a=gs(()=>t(()=>rs(r)))),e+=1,()=>{Cr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,rs(r))})})))}}var rd=Aa|Da|gu;function ad(t,e,r){new sd(t,e,r)}var mn,ko,Yn,Jr,Vn,yn,Yt,Qn,ir,Tr,$r,Er,xa,ea,Sa,Ta,or,si,Et,id,od,no,Hs,Ws,ro;class sd{constructor(e,r,a){Ve(this,Et);Ye(this,"parent");Ye(this,"is_pending",!1);Ve(this,mn);Ve(this,ko,null);Ve(this,Yn);Ve(this,Jr);Ve(this,Vn);Ve(this,yn,null);Ve(this,Yt,null);Ve(this,Qn,null);Ve(this,ir,null);Ve(this,Tr,null);Ve(this,$r,0);Ve(this,Er,0);Ve(this,xa,!1);Ve(this,ea,!1);Ve(this,Sa,new Set);Ve(this,Ta,new Set);Ve(this,or,null);Ve(this,si,nd(()=>(He(this,or,ia(W(this,$r))),()=>{He(this,or,null)})));He(this,mn,e),He(this,Yn,r),He(this,Jr,a),this.parent=rt.b,this.is_pending=!!W(this,Yn).pending,He(this,Vn,Ro(()=>{rt.b=this;{var i=qt(this,Et,no).call(this);try{He(this,yn,bn(()=>a(i)))}catch(o){this.error(o)}W(this,Er)>0?qt(this,Et,Ws).call(this):this.is_pending=!1}return()=>{var o;(o=W(this,Tr))==null||o.remove()}},rd))}defer_effect(e){Au(e,W(this,Sa),W(this,Ta))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!W(this,Yn).pending}update_pending_count(e){qt(this,Et,ro).call(this,e),He(this,$r,W(this,$r)+e),!(!W(this,or)||W(this,xa))&&(He(this,xa,!0),Cr(()=>{He(this,xa,!1),W(this,or)&&Ra(W(this,or),W(this,$r))}))}get_effect_pending(){return W(this,si).call(this),b(W(this,or))}error(e){var r=W(this,Yn).onerror;let a=W(this,Yn).failed;if(W(this,ea)||!r&&!a)throw e;W(this,yn)&&(Jt(W(this,yn)),He(this,yn,null)),W(this,Yt)&&(Jt(W(this,Yt)),He(this,Yt,null)),W(this,Qn)&&(Jt(W(this,Qn)),He(this,Qn,null));var i=!1,o=!1;const c=()=>{if(i){Qf();return}i=!0,o&&jf(),Ir.ensure(),He(this,$r,0),W(this,Qn)!==null&&ra(W(this,Qn),()=>{He(this,Qn,null)}),this.is_pending=this.has_pending_snippet(),He(this,yn,qt(this,Et,Hs).call(this,()=>(He(this,ea,!1),bn(()=>W(this,Jr).call(this,W(this,mn)))))),W(this,Er)>0?qt(this,Et,Ws).call(this):this.is_pending=!1};Cr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Ia(d,W(this,Vn)&&W(this,Vn).parent)}a&&He(this,Qn,qt(this,Et,Hs).call(this,()=>{Ir.ensure(),He(this,ea,!0);try{return bn(()=>{a(W(this,mn),()=>e,()=>c)})}catch(d){return Ia(d,W(this,Vn).parent),null}finally{He(this,ea,!1)}}))})}}mn=new WeakMap,ko=new WeakMap,Yn=new WeakMap,Jr=new WeakMap,Vn=new WeakMap,yn=new WeakMap,Yt=new WeakMap,Qn=new WeakMap,ir=new WeakMap,Tr=new WeakMap,$r=new WeakMap,Er=new WeakMap,xa=new WeakMap,ea=new WeakMap,Sa=new WeakMap,Ta=new WeakMap,or=new WeakMap,si=new WeakMap,Et=new WeakSet,id=function(){try{He(this,yn,bn(()=>W(this,Jr).call(this,W(this,mn))))}catch(e){this.error(e)}},od=function(){const e=W(this,Yn).pending;e&&(He(this,Yt,bn(()=>e(W(this,mn)))),Cr(()=>{var r=qt(this,Et,no).call(this);He(this,yn,qt(this,Et,Hs).call(this,()=>(Ir.ensure(),bn(()=>W(this,Jr).call(this,r))))),W(this,Er)>0?qt(this,Et,Ws).call(this):(ra(W(this,Yt),()=>{He(this,Yt,null)}),this.is_pending=!1)}))},no=function(){var e=W(this,mn);return this.is_pending&&(He(this,Tr,fr()),W(this,mn).before(W(this,Tr)),e=W(this,Tr)),e},Hs=function(e){var r=rt,a=Qe,i=cn;Zn(W(this,Vn)),kn(W(this,Vn)),Ca(W(this,Vn).ctx);try{return e()}catch(o){return Tu(o),null}finally{Zn(r),kn(a),Ca(i)}},Ws=function(){const e=W(this,Yn).pending;W(this,yn)!==null&&(He(this,ir,document.createDocumentFragment()),W(this,ir).append(W(this,Tr)),Zu(W(this,yn),W(this,ir))),W(this,Yt)===null&&He(this,Yt,bn(()=>e(W(this,mn))))},ro=function(e){var r;if(!this.has_pending_snippet()){this.parent&&qt(r=this.parent,Et,ro).call(r,e);return}if(He(this,Er,W(this,Er)+e),W(this,Er)===0){this.is_pending=!1;for(const a of W(this,Sa))wt(a,Dt),Nn(a);for(const a of W(this,Ta))wt(a,jn),Nn(a);W(this,Sa).clear(),W(this,Ta).clear(),W(this,Yt)&&ra(W(this,Yt),()=>{He(this,Yt,null)}),W(this,ir)&&(W(this,mn).before(W(this,ir)),He(this,ir,null))}};function ld(t,e,r,a){const i=ci;var o=t.filter(_=>!_.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var c=Ue,d=rt,v=ud(),h=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(_=>_.promise)):null;function y(_){v();try{a(_)}catch(w){(d.f&cr)===0&&Ia(w,d)}c==null||c.deactivate(),ao()}if(r.length===0){h.then(()=>y(e.map(i)));return}function x(){v(),Promise.all(r.map(_=>cd(_))).then(_=>y([...e.map(i),..._])).catch(_=>Ia(_,d))}h?h.then(x):x()}function ud(){var t=rt,e=Qe,r=cn,a=Ue;return function(o=!0){Zn(t),kn(e),Ca(r),o&&(a==null||a.activate())}}function ao(){Zn(null),kn(null),Ca(null)}function ci(t){var e=Ot|Dt,r=Qe!==null&&(Qe.f&Ot)!==0?Qe:null;return rt!==null&&(rt.f|=Da),{ctx:cn,deps:null,effects:null,equals:wu,f:e,fn:t,reactions:null,rv:0,v:Ct,wv:0,parent:r??rt,ac:null}}function cd(t,e,r){let a=rt;a===null&&Cf();var i=a.b,o=void 0,c=ia(Ct),d=!Qe,v=new Map;return Sd(()=>{var w;var h=pu();o=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{y===Ue&&y.committed&&y.deactivate(),ao()})}catch(M){h.reject(M),ao()}var y=Ue;if(d){var x=i.is_rendered();i.update_pending_count(1),y.increment(x),(w=v.get(y))==null||w.reject(Yr),v.delete(y),v.set(y,h)}const _=(M,q=void 0)=>{if(y.activate(),q)q!==Yr&&(c.f|=Ar,Ra(c,q));else{(c.f&Ar)!==0&&(c.f^=Ar),Ra(c,M);for(const[S,F]of v){if(v.delete(S),S===y)break;F.reject(Yr)}}d&&(i.update_pending_count(-1),y.decrement(x))};h.promise.then(_,M=>_(null,M||"unknown"))}),Uu(()=>{for(const h of v.values())h.reject(Yr)}),new Promise(h=>{function y(x){function _(){x===o?h(c):y(o)}x.then(_,_)}y(o)})}function vt(t){const e=ci(t);return Ju(e),e}function Du(t){const e=ci(t);return e.equals=ku,e}function fd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Jt(e[r])}}function dd(t){for(var e=t.parent;e!==null;){if((e.f&Ot)===0)return(e.f&cr)===0?e:null;e=e.parent}return null}function Eo(t){var e,r=rt;Zn(dd(t));try{t.f&=~sa,fd(t),e=nc(t)}finally{Zn(r)}return e}function Mu(t){var e=Eo(t);if(!t.equals(e)&&(t.wv=ec(),(!(Ue!=null&&Ue.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){wt(t,Tt);return}Pr||(It!==null?(Co()||Ue!=null&&Ue.is_fork)&&It.set(t,e):To(t))}function hd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Yr),a.teardown=kf,a.ac=null,os(a,0),Po(a))}function Lu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Pa(e)}let so=new Set;const Rr=new Map;let Nu=!1;function ia(t,e){var r={f:0,v:t,reactions:null,equals:wu,rv:0,wv:0};return r}function Oe(t,e){const r=ia(t);return Ju(r),r}function pd(t,e=!1,r=!0){const a=ia(t);return e||(a.equals=ku),a}function B(t,e,r=!1){Qe!==null&&(!qn||(Qe.f&El)!==0)&&xu()&&(Qe.f&(Ot|dr|So|El))!==0&&(wn===null||!Ea.call(wn,t))&&qf();let a=r?Rt(e):e;return Ra(t,a)}function Ra(t,e){if(!t.equals(e)){var r=t.v;Pr?Rr.set(t,e):Rr.set(t,r),t.v=e;var a=Ir.ensure();if(a.capture(t,r),(t.f&Ot)!==0){const i=t;(t.f&Dt)!==0&&Eo(i),To(i)}t.wv=ec(),qu(t,Dt),rt!==null&&(rt.f&Tt)!==0&&(rt.f&(Bn|ca))===0&&(gn===null?Ed([t]):gn.push(t)),!a.is_fork&&so.size>0&&!Nu&&vd()}return e}function vd(){Nu=!1;for(const t of so)(t.f&Tt)!==0&&wt(t,jn),vs(t)&&Pa(t);so.clear()}function rs(t){B(t,t.v+1)}function qu(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],c=o.f,d=(c&Dt)===0;if(d&&wt(o,e),(c&Ot)!==0){var v=o;It==null||It.delete(v),(c&sa)===0&&(c&_n&&(o.f|=sa),qu(v,jn))}else d&&((c&dr)!==0&&Pn!==null&&Pn.add(o),Nn(o))}}function Rt(t){if(typeof t!="object"||t===null||na in t)return t;const e=hu(t);if(e!==_f&&e!==wf)return t;var r=new Map,a=xo(t),i=Oe(0),o=aa,c=d=>{if(aa===o)return d();var v=Qe,h=aa;kn(null),Ol(o);var y=d();return kn(v),Ol(h),y};return a&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Lf();var y=r.get(v);return y===void 0?c(()=>{var x=Oe(h.value);return r.set(v,x),x}):B(y,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const y=c(()=>Oe(Ct));r.set(v,y),rs(i)}}else B(h,Ct),rs(i);return!0},get(d,v,h){var w;if(v===na)return t;var y=r.get(v),x=v in d;if(y===void 0&&(!x||(w=ya(d,v))!=null&&w.writable)&&(y=c(()=>{var M=Rt(x?d[v]:Ct),q=Oe(M);return q}),r.set(v,y)),y!==void 0){var _=b(y);return _===Ct?void 0:_}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var y=r.get(v);y&&(h.value=b(y))}else if(h===void 0){var x=r.get(v),_=x==null?void 0:x.v;if(x!==void 0&&_!==Ct)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return h},has(d,v){var _;if(v===na)return!0;var h=r.get(v),y=h!==void 0&&h.v!==Ct||Reflect.has(d,v);if(h!==void 0||rt!==null&&(!y||(_=ya(d,v))!=null&&_.writable)){h===void 0&&(h=c(()=>{var w=y?Rt(d[v]):Ct,M=Oe(w);return M}),r.set(v,h));var x=b(h);if(x===Ct)return!1}return y},set(d,v,h,y){var G;var x=r.get(v),_=v in d;if(a&&v==="length")for(var w=h;w<x.v;w+=1){var M=r.get(w+"");M!==void 0?B(M,Ct):w in d&&(M=c(()=>Oe(Ct)),r.set(w+"",M))}if(x===void 0)(!_||(G=ya(d,v))!=null&&G.writable)&&(x=c(()=>Oe(void 0)),B(x,Rt(h)),r.set(v,x));else{_=x.v!==Ct;var q=c(()=>Rt(h));B(x,q)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(y,h),!_){if(a&&typeof v=="string"){var F=r.get("length"),ne=Number(v);Number.isInteger(ne)&&ne>=F.v&&B(F,ne+1)}rs(i)}return!0},ownKeys(d){b(i);var v=Reflect.ownKeys(d).filter(x=>{var _=r.get(x);return _===void 0||_.v!==Ct});for(var[h,y]of r)y.v!==Ct&&!(h in d)&&v.push(h);return v},setPrototypeOf(){Nf()}})}function Cl(t){try{if(t!==null&&typeof t=="object"&&na in t)return t[na]}catch{}return t}function gd(t,e){return Object.is(Cl(t),Cl(e))}var Il,ju,Bu,zu;function md(){if(Il===void 0){Il=window,ju=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Bu=ya(e,"firstChild").get,zu=ya(e,"nextSibling").get,Tl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Tl(r)&&(r.__t=void 0)}}function fr(t=""){return document.createTextNode(t)}function ln(t){return Bu.call(t)}function ps(t){return zu.call(t)}function k(t,e){return ln(t)}function gt(t,e=!1){{var r=ln(t);return r instanceof Comment&&r.data===""?ps(r):r}}function D(t,e=1,r=!1){let a=t;for(;e--;)a=ps(a);return a}function yd(t){t.textContent=""}function Fu(){return!1}function bd(t,e,r){return document.createElementNS(_u,t,void 0)}let Rl=!1;function _d(){Rl||(Rl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Ao(t){var e=Qe,r=rt;kn(null),Zn(null);try{return t()}finally{kn(e),Zn(r)}}function Ku(t,e,r,a=r){t.addEventListener(e,()=>Ao(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),_d()}function wd(t){rt===null&&(Qe===null&&Of(),Pf()),Pr&&Rf()}function kd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function hr(t,e,r){var a=rt;a!==null&&(a.f&un)!==0&&(t|=un);var i={ctx:cn,deps:null,nodes:null,f:t|Dt|_n,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Pa(i)}catch(d){throw Jt(i),d}else e!==null&&Nn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Da)===0&&(o=o.first,(t&dr)!==0&&(t&Aa)!==0&&o!==null&&(o.f|=Aa)),o!==null&&(o.parent=a,a!==null&&kd(o,a),Qe!==null&&(Qe.f&Ot)!==0&&(t&ca)===0)){var c=Qe;(c.effects??(c.effects=[])).push(o)}return i}function Co(){return Qe!==null&&!qn}function Uu(t){const e=hr(li,null,!1);return wt(e,Tt),e.teardown=t,e}function $s(t){wd();var e=rt.f,r=!Qe&&(e&Bn)!==0&&(e&hs)===0;if(r){var a=cn;(a.e??(a.e=[])).push(t)}else return Gu(t)}function Gu(t){return hr(is|Sf,t,!1)}function xd(t){Ir.ensure();const e=hr(ca|Da,t,!0);return(r={})=>new Promise(a=>{r.outro?ra(e,()=>{Jt(e),a(void 0)}):(Jt(e),a(void 0))})}function Hu(t){return hr(is,t,!1)}function Sd(t){return hr(So|Da,t,!0)}function Io(t,e=0){return hr(li|e,t,!0)}function ye(t,e=[],r=[],a=[]){ld(a,e,r,i=>{hr(li,()=>t(...i.map(b)),!0)})}function Ro(t,e=0){var r=hr(dr|e,t,!0);return r}function bn(t){return hr(Bn|Da,t,!0)}function Wu(t){var e=t.teardown;if(e!==null){const r=Pr,a=Qe;Pl(!0),kn(null);try{e.call(null)}finally{Pl(r),kn(a)}}}function Po(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Ao(()=>{i.abort(Yr)});var a=r.next;(r.f&ca)!==0?r.parent=null:Jt(r,e),r=a}}function Td(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Bn)===0&&Jt(e),e=r}}function Jt(t,e=!0){var r=!1;(e||(t.f&mu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Yu(t.nodes.start,t.nodes.end),r=!0),Po(t,e&&!r),os(t,0),wt(t,cr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Wu(t);var i=t.parent;i!==null&&i.first!==null&&Vu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Yu(t,e){for(;t!==null;){var r=t===e?null:ps(t);t.remove(),t=r}}function Vu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ra(t,e,r=!0){var a=[];Qu(t,a,!0);var i=()=>{r&&Jt(t),e&&e()},o=a.length;if(o>0){var c=()=>--o||i();for(var d of a)d.out(c)}else i()}function Qu(t,e,r){if((t.f&un)===0){t.f^=un;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Aa)!==0||(i.f&Bn)!==0&&(t.f&dr)!==0;Qu(i,e,c?r:!1),i=o}}}function Oo(t){Xu(t,!0)}function Xu(t,e){if((t.f&un)!==0){t.f^=un,(t.f&Tt)===0&&(wt(t,Dt),Nn(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Aa)!==0||(r.f&Bn)!==0;Xu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Zu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:ps(r);e.append(r),r=i}}let Ys=!1,Pr=!1;function Pl(t){Pr=t}let Qe=null,qn=!1;function kn(t){Qe=t}let rt=null;function Zn(t){rt=t}let wn=null;function Ju(t){Qe!==null&&(wn===null?wn=[t]:wn.push(t))}let Xt=null,sn=0,gn=null;function Ed(t){gn=t}let $u=1,Qr=0,aa=Qr;function Ol(t){aa=t}function ec(){return++$u}function vs(t){var e=t.f;if((e&Dt)!==0)return!0;if(e&Ot&&(t.f&=~sa),(e&jn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(vs(o)&&Mu(o),o.wv>t.wv)return!0}(e&_n)!==0&&It===null&&wt(t,Tt)}return!1}function tc(t,e,r=!0){var a=t.reactions;if(a!==null&&!(wn!==null&&Ea.call(wn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Ot)!==0?tc(o,e,!1):e===o&&(r?wt(o,Dt):(o.f&Tt)!==0&&wt(o,jn),Nn(o))}}function nc(t){var q;var e=Xt,r=sn,a=gn,i=Qe,o=wn,c=cn,d=qn,v=aa,h=t.f;Xt=null,sn=0,gn=null,Qe=(h&(Bn|ca))===0?t:null,wn=null,Ca(t.ctx),qn=!1,aa=++Qr,t.ac!==null&&(Ao(()=>{t.ac.abort(Yr)}),t.ac=null);try{t.f|=Ji;var y=t.fn,x=y();t.f|=hs;var _=t.deps,w=Ue==null?void 0:Ue.is_fork;if(Xt!==null){var M;if(w||os(t,sn),_!==null&&sn>0)for(_.length=sn+Xt.length,M=0;M<Xt.length;M++)_[sn+M]=Xt[M];else t.deps=_=Xt;if(Co()&&(t.f&_n)!==0)for(M=sn;M<_.length;M++)((q=_[M]).reactions??(q.reactions=[])).push(t)}else!w&&_!==null&&sn<_.length&&(os(t,sn),_.length=sn);if(xu()&&gn!==null&&!qn&&_!==null&&(t.f&(Ot|jn|Dt))===0)for(M=0;M<gn.length;M++)tc(gn[M],t);if(i!==null&&i!==t){if(Qr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Qr;if(e!==null)for(const S of e)S.rv=Qr;gn!==null&&(a===null?a=gn:a.push(...gn))}return(t.f&Ar)!==0&&(t.f^=Ar),x}catch(S){return Tu(S)}finally{t.f^=Ji,Xt=e,sn=r,gn=a,Qe=i,wn=o,Ca(c),qn=d,aa=v}}function Ad(t,e){let r=e.reactions;if(r!==null){var a=mf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Ot)!==0&&(Xt===null||!Ea.call(Xt,e))){var o=e;(o.f&_n)!==0&&(o.f^=_n,o.f&=~sa),To(o),hd(o),os(o,0)}}function os(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Ad(t,r[a])}function Pa(t){var e=t.f;if((e&cr)===0){wt(t,Tt);var r=rt,a=Ys;rt=t,Ys=!0;try{(e&(dr|vu))!==0?Td(t):Po(t),Wu(t);var i=nc(t);t.teardown=typeof i=="function"?i:null,t.wv=$u;var o;Zi&&Zf&&(t.f&Dt)!==0&&t.deps}finally{Ys=a,rt=r}}}async function rc(){await Promise.resolve(),ed()}function b(t){var e=t.f,r=(e&Ot)!==0;if(Qe!==null&&!qn){var a=rt!==null&&(rt.f&cr)!==0;if(!a&&(wn===null||!Ea.call(wn,t))){var i=Qe.deps;if((Qe.f&Ji)!==0)t.rv<Qr&&(t.rv=Qr,Xt===null&&i!==null&&i[sn]===t?sn++:Xt===null?Xt=[t]:Xt.push(t));else{(Qe.deps??(Qe.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Qe]:Ea.call(o,Qe)||o.push(Qe)}}}if(Pr&&Rr.has(t))return Rr.get(t);if(r){var c=t;if(Pr){var d=c.v;return((c.f&Tt)===0&&c.reactions!==null||sc(c))&&(d=Eo(c)),Rr.set(c,d),d}var v=(c.f&_n)===0&&!qn&&Qe!==null&&(Ys||(Qe.f&_n)!==0),h=(c.f&hs)===0;vs(c)&&(v&&(c.f|=_n),Mu(c)),v&&!h&&(Lu(c),ac(c))}if(It!=null&&It.has(t))return It.get(t);if((t.f&Ar)!==0)throw t.v;return t.v}function ac(t){if(t.f|=_n,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ot)!==0&&(e.f&_n)===0&&(Lu(e),ac(e))}function sc(t){if(t.v===Ct)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Rr.has(e)||(e.f&Ot)!==0&&sc(e))return!0;return!1}function gs(t){var e=qn;try{return qn=!0,t()}finally{qn=e}}const Cd=["touchstart","touchmove"];function Id(t){return Cd.includes(t)}const ic=new Set,io=new Set;function Bt(t){for(var e=0;e<t.length;e++)ic.add(t[e]);for(var r of io)r(t)}let Dl=null;function Ml(t){var S;var e=this,r=e.ownerDocument,a=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;Dl=t;var c=0,d=Dl===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=i.indexOf(e);if(h===-1)return;v<=h&&(c=v)}if(o=i[c]||t.target,o!==e){yf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Qe,x=rt;kn(null),Zn(null);try{for(var _,w=[];o!==null;){var M=o.assignedSlot||o.parentNode||o.host||null;try{var q=o["__"+a];q!=null&&(!o.disabled||t.target===o)&&q.call(o,t)}catch(F){_?w.push(F):_=F}if(t.cancelBubble||M===e||M===null)break;o=M}if(_){for(let F of w)queueMicrotask(()=>{throw F});throw _}}finally{t.__root=e,delete t.currentTarget,kn(y),Zn(x)}}}var cu,fu;const Bi=(fu=(cu=globalThis==null?void 0:globalThis.window)==null?void 0:cu.trustedTypes)==null?void 0:fu.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Rd(t){return(Bi==null?void 0:Bi.createHTML(t))??t}function Do(t,e=!1){var r=bd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Rd(t):t,r.content}function oa(t,e){var r=rt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function H(t,e){var r=(e&bu)!==0,a=(e&Yf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Do(o?t:"<!>"+t,!0),r||(i=ln(i)));var c=a||ju?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=ln(c),v=c.lastChild;oa(d,v)}else oa(c,c);return c}}function Pd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&bu)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Do(o,!0),v=ln(d);if(i)for(c=document.createDocumentFragment();ln(v);)c.appendChild(ln(v));else c=ln(v)}var h=c.cloneNode(!0);if(i){var y=ln(h),x=h.lastChild;oa(y,x)}else oa(h,h);return h}}function Mo(t,e){return Pd(t,e,"svg")}function Ll(t=""){{var e=fr(t+"");return oa(e,e),e}}function Oa(){var t=document.createDocumentFragment(),e=document.createComment(""),r=fr();return t.append(e,r),oa(e,r),t}function K(t,e){t!==null&&t.before(e)}function ae(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Od(t,e){return Dd(t,e)}const js=new Map;function Dd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:c=!0}){md();var d=new Set,v=x=>{for(var _=0;_<x.length;_++){var w=x[_];if(!d.has(w)){d.add(w);var M=Id(w);for(const F of[e,document]){var q=js.get(F);q===void 0&&(q=new Map,js.set(F,q));var S=q.get(w);S===void 0?(F.addEventListener(w,Ml,{passive:M}),q.set(w,1)):q.set(w,S+1)}}}};v(oi(ic)),io.add(v);var h=void 0,y=xd(()=>{var x=r??e.appendChild(fr());return ad(x,{pending:()=>{}},_=>{ft({});var w=cn;o&&(w.c=o),i&&(a.$$events=i),h=t(_,a)||{},dt()}),()=>{var q;for(var _ of d)for(const S of[e,document]){var w=js.get(S),M=w.get(_);--M==0?(S.removeEventListener(_,Ml),w.delete(_),w.size===0&&js.delete(S)):w.set(_,M)}io.delete(v),x!==r&&((q=x.parentNode)==null||q.removeChild(x))}});return Md.set(h,y),h}let Md=new WeakMap;var Dn,Xn,on,ta,fs,ds,ii;class Ld{constructor(e,r=!0){Ye(this,"anchor");Ve(this,Dn,new Map);Ve(this,Xn,new Map);Ve(this,on,new Map);Ve(this,ta,new Set);Ve(this,fs,!0);Ve(this,ds,()=>{var e=Ue;if(W(this,Dn).has(e)){var r=W(this,Dn).get(e),a=W(this,Xn).get(r);if(a)Oo(a),W(this,ta).delete(r);else{var i=W(this,on).get(r);i&&(W(this,Xn).set(r,i.effect),W(this,on).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,c]of W(this,Dn)){if(W(this,Dn).delete(o),o===e)break;const d=W(this,on).get(c);d&&(Jt(d.effect),W(this,on).delete(c))}for(const[o,c]of W(this,Xn)){if(o===r||W(this,ta).has(o))continue;const d=()=>{if(Array.from(W(this,Dn).values()).includes(o)){var h=document.createDocumentFragment();Zu(c,h),h.append(fr()),W(this,on).set(o,{effect:c,fragment:h})}else Jt(c);W(this,ta).delete(o),W(this,Xn).delete(o)};W(this,fs)||!a?(W(this,ta).add(o),ra(c,d,!1)):d()}}});Ve(this,ii,e=>{W(this,Dn).delete(e);const r=Array.from(W(this,Dn).values());for(const[a,i]of W(this,on))r.includes(a)||(Jt(i.effect),W(this,on).delete(a))});this.anchor=e,He(this,fs,r)}ensure(e,r){var a=Ue,i=Fu();if(r&&!W(this,Xn).has(e)&&!W(this,on).has(e))if(i){var o=document.createDocumentFragment(),c=fr();o.append(c),W(this,on).set(e,{effect:bn(()=>r(c)),fragment:o})}else W(this,Xn).set(e,bn(()=>r(this.anchor)));if(W(this,Dn).set(a,e),i){for(const[d,v]of W(this,Xn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of W(this,on))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(W(this,ds)),a.ondiscard(W(this,ii))}else W(this,ds).call(this)}}Dn=new WeakMap,Xn=new WeakMap,on=new WeakMap,ta=new WeakMap,fs=new WeakMap,ds=new WeakMap,ii=new WeakMap;function Te(t,e,r=!1){var a=new Ld(t),i=r?Aa:0;function o(c,d){a.ensure(c,d)}Ro(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function pr(t,e){return e}function Nd(t,e,r){for(var a=[],i=e.length,o,c=e.length,d=0;d<i;d++){let x=e[d];ra(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var _=t.outrogroups;oo(oi(o.done)),_.delete(o),_.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=a.length===0&&r!==null;if(v){var h=r,y=h.parentNode;yd(y),y.append(h),t.items.clear()}oo(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function oo(t,e=!0){for(var r=0;r<t.length;r++)Jt(t[r],e)}var Nl;function Ut(t,e,r,a,i,o=null){var c=t,d=new Map,v=(e&yu)!==0;if(v){var h=t;c=h.appendChild(fr())}var y=null,x=Du(()=>{var F=r();return xo(F)?F:F==null?[]:oi(F)}),_,w=!0;function M(){S.fallback=y,qd(S,_,c,e,a),y!==null&&(_.length===0?(y.f&ur)===0?Oo(y):(y.f^=ur,es(y,null,c)):ra(y,()=>{y=null}))}var q=Ro(()=>{_=b(x);for(var F=_.length,ne=new Set,G=Ue,U=Fu(),X=0;X<F;X+=1){var $=_[X],Y=a($,X),ge=w?null:d.get(Y);ge?(ge.v&&Ra(ge.v,$),ge.i&&Ra(ge.i,X),U&&G.unskip_effect(ge.e)):(ge=jd(d,w?c:Nl??(Nl=fr()),$,Y,X,i,e,r),w||(ge.e.f|=ur),d.set(Y,ge)),ne.add(Y)}if(F===0&&o&&!y&&(w?y=bn(()=>o(c)):(y=bn(()=>o(Nl??(Nl=fr()))),y.f|=ur)),F>ne.size&&If(),!w)if(U){for(const[Le,we]of d)ne.has(Le)||G.skip_effect(we.e);G.oncommit(M),G.ondiscard(()=>{})}else M();b(x)}),S={effect:q,items:d,outrogroups:null,fallback:y};w=!1}function Wa(t){for(;t!==null&&(t.f&Bn)===0;)t=t.next;return t}function qd(t,e,r,a,i){var we,ve,se,re,qe,ie,le,ue,Q;var o=(a&Ff)!==0,c=e.length,d=t.items,v=Wa(t.effect.first),h,y=null,x,_=[],w=[],M,q,S,F;if(o)for(F=0;F<c;F+=1)M=e[F],q=i(M,F),S=d.get(q).e,(S.f&ur)===0&&((ve=(we=S.nodes)==null?void 0:we.a)==null||ve.measure(),(x??(x=new Set)).add(S));for(F=0;F<c;F+=1){if(M=e[F],q=i(M,F),S=d.get(q).e,t.outrogroups!==null)for(const te of t.outrogroups)te.pending.delete(S),te.done.delete(S);if((S.f&ur)!==0)if(S.f^=ur,S===v)es(S,null,r);else{var ne=y?y.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),xr(t,y,S),xr(t,S,ne),es(S,ne,r),y=S,_=[],w=[],v=Wa(y.next);continue}if((S.f&un)!==0&&(Oo(S),o&&((re=(se=S.nodes)==null?void 0:se.a)==null||re.unfix(),(x??(x=new Set)).delete(S))),S!==v){if(h!==void 0&&h.has(S)){if(_.length<w.length){var G=w[0],U;y=G.prev;var X=_[0],$=_[_.length-1];for(U=0;U<_.length;U+=1)es(_[U],G,r);for(U=0;U<w.length;U+=1)h.delete(w[U]);xr(t,X.prev,$.next),xr(t,y,X),xr(t,$,G),v=G,y=$,F-=1,_=[],w=[]}else h.delete(S),es(S,v,r),xr(t,S.prev,S.next),xr(t,S,y===null?t.effect.first:y.next),xr(t,y,S),y=S;continue}for(_=[],w=[];v!==null&&v!==S;)(h??(h=new Set)).add(v),w.push(v),v=Wa(v.next);if(v===null)continue}(S.f&ur)===0&&_.push(S),y=S,v=Wa(S.next)}if(t.outrogroups!==null){for(const te of t.outrogroups)te.pending.size===0&&(oo(oi(te.done)),(qe=t.outrogroups)==null||qe.delete(te));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var Y=[];if(h!==void 0)for(S of h)(S.f&un)===0&&Y.push(S);for(;v!==null;)(v.f&un)===0&&v!==t.fallback&&Y.push(v),v=Wa(v.next);var ge=Y.length;if(ge>0){var Le=(a&yu)!==0&&c===0?r:null;if(o){for(F=0;F<ge;F+=1)(le=(ie=Y[F].nodes)==null?void 0:ie.a)==null||le.measure();for(F=0;F<ge;F+=1)(Q=(ue=Y[F].nodes)==null?void 0:ue.a)==null||Q.fix()}Nd(t,Y,Le)}}o&&Cr(()=>{var te,ee;if(x!==void 0)for(S of x)(ee=(te=S.nodes)==null?void 0:te.a)==null||ee.apply()})}function jd(t,e,r,a,i,o,c,d){var v=(c&Bf)!==0?(c&Kf)===0?pd(r,!1,!1):ia(r):null,h=(c&zf)!==0?ia(i):null;return{v,i:h,e:bn(()=>(o(e,v??r,h??i,d),()=>{t.delete(a)}))}}function es(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&ur)===0?e.nodes.start:r;a!==null;){var c=ps(a);if(o.before(a),a===i)return;a=c}}function xr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Bd(t,e,r=!1,a=!1,i=!1){var o=t,c="";ye(()=>{var d=rt;if(c!==(c=e()??"")&&(d.nodes!==null&&(Yu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var h=Do(v);if((r||a)&&(h=ln(h)),oa(ln(h),h.lastChild),r||a)for(;ln(h);)o.before(ln(h));else o.before(h)}})}const ql=[...` 	
\r\fÂ \v\uFEFF`];function zd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,c=0;(c=a.indexOf(i,c))>=0;){var d=c+o;(c===0||ql.includes(a[c-1]))&&(d===a.length||ql.includes(a[d]))?a=(c===0?"":a.substring(0,c))+a.substring(d+1):c=d}}return a===""?null:a}function jl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function zi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Fd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(zi)),i&&v.push(...Object.keys(i).map(zi));var h=0,y=-1;const q=t.length;for(var x=0;x<q;x++){var _=t[x];if(d?_==="/"&&t[x-1]==="*"&&(d=!1):o?o===_&&(o=!1):_==="/"&&t[x+1]==="*"?d=!0:_==='"'||_==="'"?o=_:_==="("?c++:_===")"&&c--,!d&&o===!1&&c===0){if(_===":"&&y===-1)y=x;else if(_===";"||x===q-1){if(y!==-1){var w=zi(t.substring(h,y).trim());if(!v.includes(w)){_!==";"&&x++;var M=t.substring(h,x).trim();r+=" "+M+";"}}h=x+1,y=-1}}}}return a&&(r+=jl(a)),i&&(r+=jl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Zt(t,e,r,a,i,o){var c=t.__className;if(c!==r||c===void 0){var d=zd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var h=!!o[v];(i==null||h!==!!i[v])&&t.classList.toggle(v,h)}return o}function Fi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function $t(t,e,r,a){var i=t.__style;if(i!==e){var o=Fd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Fi(t,r==null?void 0:r[0],a[0]),Fi(t,r==null?void 0:r[1],a[1],"important")):Fi(t,r,a));return a}function oc(t,e,r=!1){if(t.multiple){if(e==null)return;if(!xo(e))return Vf();for(var a of t.options)a.selected=e.includes(as(a));return}for(a of t.options){var i=as(a);if(gd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Kd(t){var e=new MutationObserver(()=>{oc(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Uu(()=>{e.disconnect()})}function Lo(t,e,r=e){var a=new WeakSet,i=!0;Ku(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),as);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&as(v)}r(d),Ue!==null&&a.add(Ue)}),Hu(()=>{var o=e();if(t===document.activeElement){var c=Js??Ue;if(a.has(c))return}if(oc(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=as(d),r(o))}t.__value=o,i=!1}),Kd(t)}function as(t){return"__value"in t?t.__value:t.value}const Ud=Symbol("is custom element"),Gd=Symbol("is html");function lc(t,e,r,a){var i=Hd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Ef]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Wd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Hd(t){return t.__attributes??(t.__attributes={[Ud]:t.nodeName.includes("-"),[Gd]:t.namespaceURI===_u})}var Bl=new Map;function Wd(t){var e=t.getAttribute("is")||t.nodeName,r=Bl.get(e);if(r)return r;Bl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=bf(i);for(var c in a)a[c].set&&r.push(c);i=hu(i)}return r}function No(t,e,r=e){var a=new WeakSet;Ku(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Ki(t)?Ui(o):o,r(o),Ue!==null&&a.add(Ue),await rc(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var h=t.value.length;c===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=c,t.selectionEnd=Math.min(d,h))}}}),gs(e)==null&&t.value&&(r(Ki(t)?Ui(t.value):t.value),Ue!==null&&a.add(Ue)),Io(()=>{var i=e();if(t===document.activeElement){var o=Js??Ue;if(a.has(o))return}Ki(t)&&i===Ui(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Ki(t){var e=t.type;return e==="number"||e==="range"}function Ui(t){return t===""?null:+t}function zl(t,e){return t===e||(t==null?void 0:t[na])===e}function lo(t={},e,r,a){return Hu(()=>{var i,o;return Io(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&zl(r(...i),t)&&e(null,...i))})}),()=>{Cr(()=>{o&&zl(r(...o),t)&&e(null,...o)})}}),t}let Bs=!1;function Yd(t){var e=Bs;try{return Bs=!1,[t(),Bs]}finally{Bs=e}}function Ie(t,e,r,a){var ne;var i=(r&Hf)!==0,o=(r&Wf)!==0,c=a,d=!0,v=()=>(d&&(d=!1,c=o?gs(a):a),c),h;if(i){var y=na in t||Tf in t;h=((ne=ya(t,e))==null?void 0:ne.set)??(y&&e in t?G=>t[e]=G:void 0)}var x,_=!1;i?[x,_]=Yd(()=>t[e]):x=t[e],x===void 0&&a!==void 0&&(x=v(),h&&(Mf(),h(x)));var w;if(w=()=>{var G=t[e];return G===void 0?v():(d=!0,G)},(r&Gf)===0)return w;if(h){var M=t.$$legacy;return(function(G,U){return arguments.length>0?((!U||M||_)&&h(U?w():G),G):w()})}var q=!1,S=((r&Uf)!==0?ci:Du)(()=>(q=!1,w()));i&&b(S);var F=rt;return(function(G,U){if(arguments.length>0){const X=U?b(S):i?Rt(G):G;return B(S,X),q=!0,c!==void 0&&(c=X),G}return Pr&&q||(F.f&cr)!==0?S.v:b(S)})}function Mt(t){cn===null&&Af(),$s(()=>{const e=gs(t);if(typeof e=="function")return e})}const Vd="5";var du;typeof window<"u"&&((du=window.__svelte??(window.__svelte={})).v??(du.v=new Set)).add(Vd);const ls=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Vt=null,lr="idle",Vs=null,Hr=new Set;function zs(){return Vt||(Vt=new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),Vt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(lr="loading"),e.status==="ready"&&(lr="ready"),e.status==="start"&&(lr="generating"),(e.status==="complete"||e.status==="error")&&(lr=Vs?"ready":"idle");for(const r of Hr)try{r(e)}catch{}})),Vt}function uc(){return{check(){zs().postMessage({type:"check"})},loadModel(t){Vs=t,lr="loading",zs().postMessage({type:"load",modelId:t})},generate(t){zs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let a="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":a+=c.output;break;case"complete":o(),e(a);break;case"error":o(),r(new Error(c.data));break}},o=()=>{Hr.delete(i)};Hr.add(i),zs().postMessage({type:"generate",data:t})})},interrupt(){Vt==null||Vt.postMessage({type:"interrupt"})},reset(){Vt==null||Vt.postMessage({type:"reset"})},onMessage(t){return Hr.add(t),()=>Hr.delete(t)},offMessage(t){Hr.delete(t)},get status(){return lr},get isReady(){return lr==="ready"},get isGenerating(){return lr==="generating"},get modelId(){return Vs},terminate(){Vt==null||Vt.terminate(),Vt=null,lr="idle",Vs=null,Hr.clear()}}}var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qs={exports:{}},Zd=Qs.exports,Fl;function Jd(){return Fl||(Fl=1,(function(t,e){((r,a)=>{t.exports=a()})(Zd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,u=arguments.length;l<u;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var u,f=0,p=s.length;f<p;f++)!u&&f in s||((u=u||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(u||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qd,c=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&c(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function x(n,s){return y.call(n,s)}function _(n,s){typeof s=="function"&&(s=s(h(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(s).forEach(function(l){M(n,l,s[l])})}var w=Object.defineProperty;function M(n,s,l,u){w(n,s,v(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function q(n){return{from:function(s){return n.prototype=Object.create(s.prototype),M(n.prototype,"constructor",n),{extend:_.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,F=[].slice;function ne(n,s,l){return F.call(n,s,l)}function G(n,s){return s(n)}function U(n){if(!n)throw new Error("Assertion Failed")}function X(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function $(n,s){if(typeof s=="string"&&x(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],u=0,f=s.length;u<f;++u){var p=$(n,s[u]);l.push(p)}return l}var g,m=s.indexOf(".");return m===-1||(g=n[s.substr(0,m)])==null?void 0:$(g,s.substr(m+1))}function Y(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){U(typeof l!="string"&&"length"in l);for(var u=0,f=s.length;u<f;++u)Y(n,s[u],l[u])}else{var p,g,m=s.indexOf(".");m!==-1?(p=s.substr(0,m),(m=s.substr(m+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:Y(g=(g=n[p])&&x(n,p)?g:n[p]={},m,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ge(n){var s,l={};for(s in n)x(n,s)&&(l[s]=n[s]);return l}var Le=[].concat;function we(n){return Le.apply([],n)}var Z="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(we([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ve=new Set(Z.map(function(n){return o[n]})),se=null;function re(n){return se=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var u=se.get(l);if(u)return u;if(d(l)){u=[],se.set(l,u);for(var f=0,p=l.length;f<p;++f)u.push(s(l[f]))}else if(ve.has(l.constructor))u=l;else{var g,m=h(l);for(g in u=m===Object.prototype?{}:Object.create(m),se.set(l,u),l)x(l,g)&&(u[g]=s(l[g]))}return u})(n),se=null,n}var qe={}.toString;function ie(n){return qe.call(n).slice(8,-1)}var le=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ue=typeof le=="symbol"?function(n){var s;return n!=null&&(s=n[le])&&s.apply(n)}:function(){return null};function Q(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var te={};function ee(n){var s,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===te&&typeof n=="string")return[n];if(f=ue(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var he=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ze=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Z),fe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ae(n,s){this.name=n,this.message=s}function _e(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function pe(n,s,l,u){this.failures=s,this.failedKeys=u,this.successCount=l,this.message=_e(n,s)}function J(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=_e(n,this.failures)}q(Ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(pe).from(Ae),q(J).from(Ae);var Ne=ze.reduce(function(n,s){return n[s]=s+"Error",n},{}),Fe=Ae,be=ze.reduce(function(n,s){var l=s+"Error";function u(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=fe[s]||l,this.inner=null)}return q(u).from(Fe),n[s]=u,n},{}),lt=(be.Syntax=SyntaxError,be.Type=TypeError,be.Range=RangeError,Z.reduce(function(n,s){return n[s+"Error"]=be[s],n},{}));Z=ze.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=be[s]),n},{});function Ke(){}function ut(n){return n}function en(n,s){return n==null||n===ut?s:function(l){return s(n(l))}}function At(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Or(n,s){return n===Ke?s:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?At(u,this.onsuccess):u),f&&(this.onerror=this.onerror?At(f,this.onerror):f),p!==void 0?p:l}}function Dr(n,s){return n===Ke?s:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?At(l,this.onsuccess):l),u&&(this.onerror=this.onerror?At(u,this.onerror):u)}}function Sn(n,s){return n===Ke?s:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?At(f,this.onsuccess):f),p&&(this.onerror=this.onerror?At(p,this.onerror):p),u===void 0?g===void 0?void 0:g:v(u,g)}}function vr(n,s){return n===Ke?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function zn(n,s){return n===Ke?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(u,p)})}return s.apply(this,arguments)}}Z.ModifyError=pe,Z.DexieError=Ae,Z.BulkError=J;var zt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Mr(n){zt=n}var Fn={},$n=100,tn=typeof Promise>"u"?[]:(ze=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[tn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(tn),ze]:[ze,h(ze),ze]),ze=tn[0],ga=tn[1],ga=ga&&ga.then,at=ze&&ze.constructor,nn=!!tn[2],rn=function(n,s){er.push([n,s]),Tn&&(queueMicrotask(yr),Tn=!1)},Kn=!0,Tn=!0,dn=[],En=[],gr=ut,xt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ke,pgp:!1,env:{},finalize:Ke},De=xt,er=[],An=0,da=[];function Ee(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=De;if(typeof n!="function"){if(n!==Fn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&tr(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(u,f){try{f(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&br();p&&typeof p.then=="function"?l(u,function(m,C){p instanceof Ee?p._then(m,C):p.then(m,C)}):(u._state=!0,u._value=p,bs(u)),g&&nr()}},tr.bind(null,u))}catch(p){tr(u,p)}})(this,n)}var mr={get:function(){var n=De,s=jr;function l(u,f){var p=this,g=!n.global&&(n!==De||s!==jr),m=g&&!In(),C=new Ee(function(N,I){Ma(p,new ys(E(u,n,g,m),E(f,n,g,m),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return l.prototype=Fn,l},set:function(n){M(this,"then",n&&n.prototype===Fn?mr:{get:function(){return n},set:mr.set})}};function ys(n,s,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=u,this.psd=f}function tr(n,s){var l,u;En.push(s),n._state===null&&(l=n._lib&&br(),s=gr(s),n._state=!1,n._value=s,u=n,dn.some(function(f){return f._value===u._value})||dn.push(u),bs(n),l)&&nr()}function bs(n){var s=n._listeners;n._listeners=[];for(var l=0,u=s.length;l<u;++l)Ma(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),An===0&&(++An,rn(function(){--An==0&&Lr()},[]))}function Ma(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++An,rn(yt,[l,n,s])}}function yt(n,s,l){try{var u,f=s._value;!s._state&&En.length&&(En=[]),u=zt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||En.indexOf(f)!==-1||(p=>{for(var g=dn.length;g;)if(dn[--g]._value===p._value)return dn.splice(g,1)})(s),l.resolve(u)}catch(p){l.reject(p)}finally{--An==0&&Lr(),--l.psd.ref||l.psd.finalize()}}function yr(){Me(xt,function(){br()&&nr()})}function br(){var n=Kn;return Tn=Kn=!1,n}function nr(){var n,s,l;do for(;0<er.length;)for(n=er,er=[],l=n.length,s=0;s<l;++s){var u=n[s];u[0].apply(null,u[1])}while(0<er.length);Tn=Kn=!0}function Lr(){for(var n=dn,s=(dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),da.slice(0)),l=s.length;l;)s[--l]()}function Nr(n){return new Ee(Fn,!1,n)}function st(n,s){var l=De;return function(){var u=br(),f=De;try{return Rn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Rn(f,!1),u&&nr()}}}_(Ee.prototype,{then:mr,_then:function(n,s){Ma(this,new ys(null,null,n,s,De))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(u){return(u instanceof s?l:Nr)(u)}):this.then(null,function(u){return(u&&u.name===s?l:Nr)(u)}))},finally:function(n){return this.then(function(s){return Ee.resolve(n()).then(function(){return s})},function(s){return Ee.resolve(n()).then(function(){return Nr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ee(function(u,f){var p=setTimeout(function(){return f(new be.Timeout(s))},n);l.then(u,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),xt.env=ws(),_(Ee,{all:function(){var n=ee.apply(null,arguments).map(Br);return new Ee(function(s,l){n.length===0&&s([]);var u=n.length;n.forEach(function(f,p){return Ee.resolve(f).then(function(g){n[p]=g,--u||s(n)},l)})})},resolve:function(n){return n instanceof Ee?n:n&&typeof n.then=="function"?new Ee(function(s,l){n.then(s,l)}):new Ee(Fn,!0,n)},reject:Nr,race:function(){var n=ee.apply(null,arguments).map(Br);return new Ee(function(s,l){n.map(function(u){return Ee.resolve(u).then(s,l)})})},PSD:{get:function(){return De},set:function(n){return De=n}},totalEchoes:{get:function(){return jr}},newPSD:Cn,usePSD:Me,scheduler:{get:function(){return rn},set:function(n){rn=n}},rejectionMapper:{get:function(){return gr},set:function(n){gr=n}},follow:function(n,s){return new Ee(function(l,u){return Cn(function(f,p){var g=De;g.unhandleds=[],g.onunhandled=p,g.finalize=At(function(){var m,C=this;m=function(){C.unhandleds.length===0?f():p(C.unhandleds[0])},da.push(function N(){m(),da.splice(da.indexOf(N),1)}),++An,rn(function(){--An==0&&Lr()},[])},g.finalize),n()},s,l,u)})}}),at&&(at.allSettled&&M(Ee,"allSettled",function(){var n=ee.apply(null,arguments).map(Br);return new Ee(function(s){n.length===0&&s([]);var l=n.length,u=new Array(l);n.forEach(function(f,p){return Ee.resolve(f).then(function(g){return u[p]={status:"fulfilled",value:g}},function(g){return u[p]={status:"rejected",reason:g}}).then(function(){return--l||s(u)})})})}),at.any&&typeof AggregateError<"u"&&M(Ee,"any",function(){var n=ee.apply(null,arguments).map(Br);return new Ee(function(s,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(p,g){return Ee.resolve(p).then(function(m){return s(m)},function(m){f[g]=m,--u||l(new AggregateError(f))})})})}),at.withResolvers)&&(Ee.withResolvers=at.withResolvers);var kt={awaits:0,echoes:0,id:0},hn=0,pn=[],qr=0,jr=0,La=0;function Cn(n,g,l,u){var f=De,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++La,xt.env,p.env=nn?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},g&&v(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Me(p,n,l,u));return p.ref===0&&p.finalize(),g}function Lt(){return kt.id||(kt.id=++hn),++kt.awaits,kt.echoes+=$n,kt.id}function In(){return!!kt.awaits&&(--kt.awaits==0&&(kt.id=0),kt.echoes=kt.awaits*$n,!0)}function Br(n){return kt.echoes&&n&&n.constructor===at?(Lt(),n.then(function(s){return In(),s},function(s){return In(),ke(s)})):n}function _s(){var n=pn[pn.length-1];pn.pop(),Rn(n,!1)}function Rn(n,s){var l,u,f=De;(s?!kt.echoes||qr++&&n===De:!qr||--qr&&n===De)||queueMicrotask(s?(function(p){++jr,kt.echoes&&--kt.echoes!=0||(kt.echoes=kt.awaits=kt.id=0),pn.push(De),Rn(p,!0)}).bind(null,n):_s),n!==De&&(De=n,f===xt&&(xt.env=ws()),nn)&&(l=xt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function ws(){var n=o.Promise;return nn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Me(n,s,l,u,f){var p=De;try{return Rn(n,!0),s(l,u,f)}finally{Rn(p,!1)}}function E(n,s,l,u){return typeof n!="function"?n:function(){var f=De;l&&Lt(),Rn(s,!0);try{return n.apply(this,arguments)}finally{Rn(f,!1),u&&queueMicrotask(In)}}}function de(n){Promise===at&&kt.echoes===0?qr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ga).indexOf("[native code]")===-1&&(Lt=In=Ke);var ke=Ee.reject,$e="ï¿¿",it="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ht="String expected.",bt=[],Wt="__dbnames",Un="readonly",zr="readwrite";function ct(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Na={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Fr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=re(s))[n],s}}function Zo(){throw be.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Xe(n,s){try{var l=Jo(n),u=Jo(s);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=$o(n),p=$o(s),g=f.length,m=p.length,C=g<m?g:m,N=0;N<C;++N)if(f[N]!==p[N])return f[N]<p[N]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var I=n,T=s,P=I.length,O=T.length,R=P<O?P:O,A=0;A<R;++A){var j=Xe(I[A],T[A]);if(j!==0)return j}return P===O?0:P<O?-1:1}}catch{}return NaN}function Jo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=ie(n))==="ArrayBuffer")?"binary":s}function $o(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ks(n,s,l){var u=n.schema.yProps;return u?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(u.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}el.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var u=s.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var qa=el;function el(n){this["@@propmod"]=n}function tl(n,s){for(var l=c(s),u=l.length,f=!1,p=0;p<u;++p){var g=l[p],m=s[g],C=$(n,g);m instanceof qa?(Y(n,g,m.execute(C)),f=!0):C!==m&&(Y(n,g,m),f=!0)}return f}ot.prototype._trans=function(n,s,l){var u=this._tx||De.trans,f=this.name,p=zt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,T){if(T.schema[f])return s(T.idbtrans,T);throw new be.NotFound("Table "+f+" not part of transaction")}var m=br();try{var C=u&&u.db._novip===this.db._novip?u===De.trans?u._promise(n,g,l):Cn(function(){return u._promise(n,g,l)},{trans:u,transless:De.transless||De}):(function N(I,T,P,O){if(I.idbdb&&(I._state.openComplete||De.letThrough||I._vip)){var R=I._createTransaction(T,P,I._dbSchema);try{R.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===Ne.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,T,P,O)})):ke(A)}return R._promise(T,function(A,j){return Cn(function(){return De.trans=R,O(A,j,R)})}).then(function(A){if(T==="readwrite")try{R.idbtrans.commit()}catch{}return T==="readonly"?A:R._completion.then(function(){return A})})}if(I._state.openComplete)return ke(new be.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return ke(new be.DatabaseClosed);I.open().catch(Ke)}return I._state.dbReadyPromise.then(function(){return N(I,T,P,O)})})(this.db,n,[this.name],g);return p&&(C._consoleTask=p,C=C.catch(function(N){return console.trace(N),ke(N)})),C}finally{m&&nr()}},ot.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ke(new be.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},ot.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=c(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&s.every(function(N){return 0<=m.keyPath.indexOf(N)})){for(var C=0;C<s.length;++C)if(s.indexOf(m.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(m,C){return m.keyPath.length-C.keyPath.length})[0];if(l&&this.db._maxKey!==$e)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(m){return n[m]}));!l&&zt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var u=this.schema.idxByName;function f(m,C){return Xe(m,C)===0}var g=s.reduce(function(I,C){var N=I[0],I=I[1],T=u[C],P=n[C];return[N||T,N||!T?ct(I,T&&T.multi?function(O){return O=$(O,C),d(O)&&O.some(function(R){return f(P,R)})}:function(O){return f(P,$(O,C))}):I]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},ot.prototype.filter=function(n){return this.toCollection().and(n)},ot.prototype.count=function(n){return this.toCollection().count(n)},ot.prototype.offset=function(n){return this.toCollection().offset(n)},ot.prototype.limit=function(n){return this.toCollection().limit(n)},ot.prototype.each=function(n){return this.toCollection().each(n)},ot.prototype.toArray=function(n){return this.toCollection().toArray(n)},ot.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ot.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},ot.prototype.reverse=function(){return this.toCollection().reverse()},ot.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Zo&&(n=(g=>{var m=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=m}function I(){return g!==null&&g.apply(this,arguments)||this}return r(m,C),m.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),I.prototype.table=function(){return l},I})(n)),new Set),f=n.prototype;f;f=h(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function p(g){if(!g)return g;var m,C=Object.create(n.prototype);for(m in g)if(!u.has(m))try{C[m]=g[m]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},ot.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},ot.prototype.add=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Fr(p)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(m){return m.numFailures?Ee.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Y(n,p,m)}catch{}return m})},ot.prototype.upsert=function(n,s){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var g=p??{};return tl(g,s),u&&Y(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(m){return m.numFailures?Ee.reject(m.failures[0]):!!p})})})},ot.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=$(n,this.schema.primKey.keyPath))===void 0?ke(new be.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},ot.prototype.put=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Fr(p)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(m){return m.numFailures?Ee.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Y(n,p,m)}catch{}return m})},ot.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ks(s,[n],u)}).then(function(u){return u.numFailures?Ee.reject(u.failures[0]):void 0})})},ot.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Na}).then(function(l){return ks(n,null,l)})}).then(function(s){return s.numFailures?Ee.reject(s.failures[0]):void 0})},ot.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return s.hook.reading.fire(f)})})})},ot.prototype.bulkAdd=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new be.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new be.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Fr(m)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:p}).then(function(I){var T=I.numFailures,P=I.failures;if(T===0)return p?I.results:I.lastResult;throw new J("".concat(u.name,".bulkAdd(): ").concat(T," of ").concat(C," operations failed"),P)})})},ot.prototype.bulkPut=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new be.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new be.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Fr(m)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:p}).then(function(I){var T=I.numFailures,P=I.failures;if(T===0)return p?I.results:I.lastResult;throw new J("".concat(u.name,".bulkPut(): ").concat(T," of ").concat(C," operations failed"),P)})})},ot.prototype.bulkUpdate=function(n){var s=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var C=[],N=[],I=(n.forEach(function(T,P){var O=T.key,R=T.changes,A=m[P];if(A){for(var j=0,z=Object.keys(R);j<z.length;j++){var L=z[j],V=R[L];if(L===s.schema.primKey.keyPath){if(Xe(V,O)!==0)throw new be.Constraint("Cannot update primary key in bulkUpdate()")}else Y(A,L,V)}p.push(P),C.push(O),N.push(A)}}),C.length);return l.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(T){var P=T.numFailures,O=T.failures;if(P===0)return I;for(var R=0,A=Object.keys(O);R<A.length;R++){var j,z=A[R],L=p[Number(z)];L!=null&&(j=O[z],delete O[z],O[L]=j)}throw new J("".concat(s.name,".bulkUpdate(): ").concat(P," of ").concat(I," operations failed"),O)})})})},ot.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ks(s,n,f)})}).then(function(u){var f=u.numFailures,p=u.failures;if(f===0)return u.lastResult;throw new J("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var nl=ot;function ot(){}function ja(n){function s(g,m){if(m){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return l[g].subscribe.apply(null,N),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=p;for(var u=1,f=arguments.length;u<f;++u)p(arguments[u]);return s;function p(g,m,C){var N,I;if(typeof g!="object")return m=m||vr,I={subscribers:[],fire:C=C||Ke,subscribe:function(T){I.subscribers.indexOf(T)===-1&&(I.subscribers.push(T),I.fire=m(I.fire,T))},unsubscribe:function(T){I.subscribers=I.subscribers.filter(function(P){return P!==T}),I.fire=I.subscribers.reduce(m,C)}},l[g]=s[g]=I;c(N=g).forEach(function(T){var P=N[T];if(d(P))p(T,N[T][0],N[T][1]);else{if(P!=="asap")throw new be.InvalidArgument("Invalid event config");var O=p(T,ut,function(){for(var R=arguments.length,A=new Array(R);R--;)A[R]=arguments[R];O.subscribers.forEach(function(j){X(function(){j.apply(null,A)})})})}})}}function Ba(n,s){return q(s).from({prototype:n}),s}function ha(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function pi(n,s){n.filter=ct(n.filter,s)}function vi(n,s,l){var u=n.replayFilter;n.replayFilter=u?function(){return ct(u(),s())}:s,n.justLimit=l&&!u}function xs(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new be.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function rl(n,s,l){var u=xs(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function Ss(n,s,l,u){var f,p,g=n.replayFilter?ct(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(m,C,N){var I,T;g&&!g(C,N,function(P){return C.stop(P)},function(P){return C.fail(P)})||((T=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(T=""+new Uint8Array(I)),x(f,T))||(f[T]=!0,s(m,C,N))},Promise.all([n.or._iterate(p,l),al(rl(n,u,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):al(rl(n,u,l),ct(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function al(n,s,l,u){var f=st(u?function(p,g,m){return l(u(p),g,m)}:l);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};s&&!s(p,function(m){return g=m},function(m){p.stop(m),g=Ke},function(m){p.fail(m),g=Ke})||f(p.value,p,function(m){return g=m}),g()})})}et.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ke.bind(null,l.error)):l.table._trans("readonly",n).then(s)},et.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ke.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},et.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=ct(s.algorithm,n)},et.prototype._iterate=function(n,s){return Ss(this._ctx,n,s,this._ctx.table.core)},et.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},et.prototype.raw=function(){return this._ctx.valueMapper=null,this},et.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Ss(s,n,l,s.table.core)})},et.prototype.count=function(n){var s=this;return this._read(function(l){var u,f=s._ctx,p=f.table.core;return ha(f,!0)?p.count({trans:l,query:{index:xs(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,Ss(f,function(){return++u,!1},l,p).then(function(){return u}))}).then(n)},et.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function p(C,N){return N?p(C[l[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function m(C,N){return Xe(p(C,f),p(N,f))*g}return this.toArray(function(C){return C.sort(m)}).then(s)},et.prototype.toArray=function(n){var s=this;return this._read(function(l){var u,f,p,g=s._ctx;return g.dir==="next"&&ha(g,!0)&&0<g.limit?(u=g.valueMapper,f=xs(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(p=[],Ss(g,function(m){return p.push(m)},l,g.table.core).then(function(){return p}))},n)},et.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,ha(s)?vi(s,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):vi(s,function(){var l=n;return function(){return--l<0}})),this},et.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),vi(this._ctx,function(){var s=n;return function(l,u,f){return--s<=0&&u(f),0<=s}},!0),this},et.prototype.until=function(n,s){return pi(this._ctx,function(l,u,f){return!n(l.value)||(u(f),s)}),this},et.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},et.prototype.last=function(n){return this.reverse().first(n)},et.prototype.filter=function(n){var s;return pi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=ct(s.isMatch,n),this},et.prototype.and=function(n){return this.filter(n)},et.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},et.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},et.prototype.desc=function(){return this.reverse()},et.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.key,u)})},et.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},et.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},et.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},et.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&ha(s,!0)&&0<s.limit)return this._read(function(u){var f=xs(s,s.table.core.schema);return s.table.core.query({trans:u,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(u){return u.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},et.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},et.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},et.prototype.lastKey=function(n){return this.reverse().firstKey(n)},et.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},pi(this._ctx,function(u){var u=u.primaryKey.toString(),f=x(n,u);return n[u]=!0,!f})),this},et.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(u){function f(A,j){var z=j.failures;P+=A-j.numFailures;for(var L=0,V=c(z);L<V.length;L++){var oe=V[L];T.push(z[oe])}}var p=typeof n=="function"?n:function(A){return tl(A,n)},g=l.table.core,I=g.schema.primaryKey,m=I.outbound,C=I.extractKey,N=200,I=s.db._options.modifyChunkSize,T=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),P=0,O=[],R=n===sl;return s.clone().primaryKeys().then(function(A){function j(L){var V=Math.min(N,A.length-L),oe=A.slice(L,L+V);return(R?Promise.resolve([]):g.getMany({trans:u,keys:oe,cache:"immutable"})).then(function(xe){var Se=[],ce=[],Re=m?[]:null,Ce=R?oe:[];if(!R)for(var me=0;me<V;++me){var Pe=xe[me],Ze={value:re(Pe),primKey:A[L+me]};p.call(Ze,Ze.value,Ze)!==!1&&(Ze.value==null?Ce.push(A[L+me]):m||Xe(C(Pe),C(Ze.value))===0?(ce.push(Ze.value),m&&Re.push(A[L+me])):(Ce.push(A[L+me]),Se.push(Ze.value)))}return Promise.resolve(0<Se.length&&g.mutate({trans:u,type:"add",values:Se}).then(function(tt){for(var Be in tt.failures)Ce.splice(parseInt(Be),1);f(Se.length,tt)})).then(function(){return(0<ce.length||z&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Re,values:ce,criteria:z,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<L}).then(function(tt){return f(ce.length,tt)})}).then(function(){return(0<Ce.length||z&&R)&&g.mutate({trans:u,type:"delete",keys:Ce,criteria:z,isAdditionalChunk:0<L}).then(function(tt){return ks(l.table,Ce,tt)}).then(function(tt){return f(Ce.length,tt)})}).then(function(){return A.length>L+V&&j(L+N)})})}var z=ha(l)&&l.limit===1/0&&(typeof n!="function"||R)&&{index:l.index,range:l.range};return j(0).then(function(){if(0<T.length)throw new pe("Error modifying one or more objects",T,P,O);return A.length})})})},et.prototype.delete=function(){var n=this._ctx,s=n.range;return!ha(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(sl):this._write(function(l){var u=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(C){var m=C.failures,C=C.numFailures;if(C)throw new pe("Could not delete some values",Object.keys(m).map(function(N){return m[N]}),p-C);return p-C})})})};var Vc=et;function et(){}var sl=function(n,s){return s.value=null};function Qc(n,s){return n<s?-1:n===s?0:1}function Xc(n,s){return s<n?-1:n===s?0:1}function an(n,s,l){return n=n instanceof ol?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function pa(n){return new n.Collection(n,function(){return il("")}).limit(0)}function Ts(O,s,l,u){var f,p,g,m,C,N,I,T=l.length;if(!l.every(function(A){return typeof A=="string"}))return an(O,ht);function P(A){f=A==="next"?function(z){return z.toUpperCase()}:function(z){return z.toLowerCase()},p=A==="next"?function(z){return z.toLowerCase()}:function(z){return z.toUpperCase()},g=A==="next"?Qc:Xc;var j=l.map(function(z){return{lower:p(z),upper:f(z)}}).sort(function(z,L){return g(z.lower,L.lower)});m=j.map(function(z){return z.upper}),C=j.map(function(z){return z.lower}),I=(N=A)==="next"?"":u}P("next");var O=new O.Collection(O,function(){return _r(m[0],C[T-1]+u)}),R=(O._ondirectionchange=function(A){P(A)},0);return O._addAlgorithm(function(A,j,z){var L=A.key;if(typeof L=="string"){var V=p(L);if(s(V,C,R))return!0;for(var oe=null,xe=R;xe<T;++xe){var Se=((ce,Re,Ce,me,Pe,Ze)=>{for(var tt=Math.min(ce.length,me.length),Be=-1,Ge=0;Ge<tt;++Ge){var pt=Re[Ge];if(pt!==me[Ge])return Pe(ce[Ge],Ce[Ge])<0?ce.substr(0,Ge)+Ce[Ge]+Ce.substr(Ge+1):Pe(ce[Ge],me[Ge])<0?ce.substr(0,Ge)+me[Ge]+Ce.substr(Ge+1):0<=Be?ce.substr(0,Be)+Re[Be]+Ce.substr(Be+1):null;Pe(ce[Ge],pt)<0&&(Be=Ge)}return tt<me.length&&Ze==="next"?ce+Ce.substr(ce.length):tt<ce.length&&Ze==="prev"?ce.substr(0,Ce.length):Be<0?null:ce.substr(0,Be)+me[Be]+Ce.substr(Be+1)})(L,V,m[xe],C[xe],g,N);Se===null&&oe===null?R=xe+1:(oe===null||0<g(oe,Se))&&(oe=Se)}j(oe!==null?function(){A.continue(oe+I)}:z)}return!1}),O}function _r(n,s,l,u){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:u}}function il(n){return{type:1,lower:n,upper:n}}Object.defineProperty(St.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),St.prototype.between=function(n,s,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||u)&&(!l||!u)?pa(this):new this.Collection(this,function(){return _r(n,s,!l,!u)})}catch{return an(this,it)}},St.prototype.equals=function(n){return n==null?an(this,it):new this.Collection(this,function(){return il(n)})},St.prototype.above=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(n,void 0,!0)})},St.prototype.aboveOrEqual=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(n,void 0,!1)})},St.prototype.below=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(void 0,n,!1,!0)})},St.prototype.belowOrEqual=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(void 0,n)})},St.prototype.startsWith=function(n){return typeof n!="string"?an(this,ht):this.between(n,n+$e,!0,!0)},St.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ts(this,function(s,l){return s.indexOf(l[0])===0},[n],$e)},St.prototype.equalsIgnoreCase=function(n){return Ts(this,function(s,l){return s===l[0]},[n],"")},St.prototype.anyOfIgnoreCase=function(){var n=ee.apply(te,arguments);return n.length===0?pa(this):Ts(this,function(s,l){return l.indexOf(s)!==-1},n,"")},St.prototype.startsWithAnyOfIgnoreCase=function(){var n=ee.apply(te,arguments);return n.length===0?pa(this):Ts(this,function(s,l){return l.some(function(u){return s.indexOf(u)===0})},n,$e)},St.prototype.anyOf=function(){var n,s,l=this,u=ee.apply(te,arguments),f=this._cmp;try{u.sort(f)}catch{return an(this,it)}return u.length===0?pa(this):((n=new this.Collection(this,function(){return _r(u[0],u[u.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,u.sort(f)},s=0,n._addAlgorithm(function(p,g,m){for(var C=p.key;0<f(C,u[s]);)if(++s===u.length)return g(m),!1;return f(C,u[s])===0||(g(function(){p.continue(u[s])}),!1)}),n)},St.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},St.prototype.noneOf=function(){var n=ee.apply(te,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return an(this,it)}var s=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},St.prototype.inAnyRange=function(n,z){var l=this,u=this._cmp,f=this._ascending,p=this._descending,g=this._min,m=this._max;if(n.length===0)return pa(this);if(!n.every(function(L){return L[0]!==void 0&&L[1]!==void 0&&f(L[0],L[1])<=0}))return an(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",be.InvalidArgument);var C=!z||z.includeLowers!==!1,N=z&&z.includeUppers===!0,I,T=f;function P(L,V){return T(L[0],V[0])}try{(I=n.reduce(function(L,V){for(var oe=0,xe=L.length;oe<xe;++oe){var Se=L[oe];if(u(V[0],Se[1])<0&&0<u(V[1],Se[0])){Se[0]=g(Se[0],V[0]),Se[1]=m(Se[1],V[1]);break}}return oe===xe&&L.push(V),L},[])).sort(P)}catch{return an(this,it)}var O=0,R=N?function(L){return 0<f(L,I[O][1])}:function(L){return 0<=f(L,I[O][1])},A=C?function(L){return 0<p(L,I[O][0])}:function(L){return 0<=p(L,I[O][0])},j=R,z=new this.Collection(this,function(){return _r(I[0][0],I[I.length-1][1],!C,!N)});return z._ondirectionchange=function(L){T=L==="next"?(j=R,f):(j=A,p),I.sort(P)},z._addAlgorithm(function(L,V,oe){for(var xe,Se=L.key;j(Se);)if(++O===I.length)return V(oe),!1;return!R(xe=Se)&&!A(xe)||(l._cmp(Se,I[O][1])===0||l._cmp(Se,I[O][0])===0||V(function(){T===f?L.continue(I[O][0]):L.continue(I[O][1])}),!1)}),z},St.prototype.startsWithAnyOf=function(){var n=ee.apply(te,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?pa(this):this.inAnyRange(n.map(function(s){return[s,s+$e]})):an(this,"startsWithAnyOf() only works with strings")};var ol=St;function St(){}function Gn(n){return st(function(s){return za(s),n(s.target.error),!1})}function za(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Fa="storagemutated",gi="x-storagemutated-1",wr=ja(null,Fa),Zc=(Hn.prototype._lock=function(){return U(!De.global),++this._reculock,this._reculock!==1||De.global||(De.lockOwnerFor=this),this},Hn.prototype._unlock=function(){if(U(!De.global),--this._reculock==0)for(De.global||(De.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Me(n[1],n[0])}catch{}}return this},Hn.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},Hn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(U(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new be.DatabaseClosed(u);case"MissingAPIError":throw new be.MissingAPI(u.message,u);default:throw new be.OpenFailed(u)}if(!this.active)throw new be.TransactionInactive;U(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=st(function(f){za(f),s._reject(n.error)}),n.onabort=st(function(f){za(f),s.active&&s._reject(new be.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=st(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&wr.storagemutated.fire(n.mutatedParts)})}return this},Hn.prototype._promise=function(n,s,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?ke(new be.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ee(function(p,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,g)},De])}):l?Cn(function(){var p=new Ee(function(g,m){f._lock();var C=s(g,m,f);C&&C.then&&C.then(g,m)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((u=new Ee(function(p,g){var m=s(p,g,f);m&&m.then&&m.then(p,g)}))._lib=!0,u):ke(new be.TransactionInactive)},Hn.prototype._root=function(){return this.parent?this.parent._root():this},Hn.prototype.waitFor=function(n){var s,l=this._root(),u=Ee.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ee(function(p,g){u.then(function(m){return l._waitingQueue.push(st(p.bind(null,m)))},function(m){return l._waitingQueue.push(st(g.bind(null,m)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Hn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new be.Abort))},Hn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(x(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new be.NotFound("Table "+n+" not part of transaction")},Hn);function Hn(){}function mi(n,s,l,u,f,p,g,m){return{name:n,keyPath:s,unique:l,multi:u,auto:f,compound:p,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+ll(s),type:m}}function ll(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function yi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,p,g){return p=u(p,g),p&&(f[p[0]]=p[1]),f},{}))};var u}var Ka=function(n){try{return n.only([[]]),Ka=function(){return[[]]},[[]]}catch{return Ka=function(){return $e},$e}};function bi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return $(l,s)}:function(l){return $(l,n)};var s}function ul(n){return[].slice.call(n)}var Jc=0;function Ua(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function $c(n,s,C){function u(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=R.lower,P=R.upper,O=R.lowerOpen,R=R.upperOpen;return T===void 0?P===void 0?null:s.upperBound(P,!!R):P===void 0?s.lowerBound(T,!!O):s.bound(T,P,!!O,!!R)}function f(I){var T,P=I.name;return{name:P,schema:I,mutate:function(O){var R=O.trans,A=O.type,j=O.keys,z=O.values,L=O.range;return new Promise(function(V,oe){V=st(V);var xe=R.objectStore(P),Se=xe.keyPath==null,ce=A==="put"||A==="add";if(!ce&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var Re,Ce=(j||z||{length:1}).length;if(j&&z&&j.length!==z.length)throw new Error("Given keys array must have same length as given values array.");if(Ce===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function me(mt){++tt,za(mt)}var Pe=[],Ze=[],tt=0;if(A==="deleteRange"){if(L.type===4)return V({numFailures:tt,failures:Ze,results:[],lastResult:void 0});L.type===3?Pe.push(Re=xe.clear()):Pe.push(Re=xe.delete(u(L)))}else{var Se=ce?Se?[z,j]:[z,null]:[j,null],Be=Se[0],Ge=Se[1];if(ce)for(var pt=0;pt<Ce;++pt)Pe.push(Re=Ge&&Ge[pt]!==void 0?xe[A](Be[pt],Ge[pt]):xe[A](Be[pt])),Re.onerror=me;else for(pt=0;pt<Ce;++pt)Pe.push(Re=xe[A](Be[pt])),Re.onerror=me}function vn(mt){mt=mt.target.result,Pe.forEach(function(Gr,qi){return Gr.error!=null&&(Ze[qi]=Gr.error)}),V({numFailures:tt,failures:Ze,results:A==="delete"?j:Pe.map(function(Gr){return Gr.result}),lastResult:mt})}Re.onerror=function(mt){me(mt),vn(mt)},Re.onsuccess=vn})},getMany:function(O){var R=O.trans,A=O.keys;return new Promise(function(j,z){j=st(j);for(var L,V=R.objectStore(P),oe=A.length,xe=new Array(oe),Se=0,ce=0,Re=function(Pe){Pe=Pe.target,xe[Pe._pos]=Pe.result,++ce===Se&&j(xe)},Ce=Gn(z),me=0;me<oe;++me)A[me]!=null&&((L=V.get(A[me]))._pos=me,L.onsuccess=Re,L.onerror=Ce,++Se);Se===0&&j(xe)})},get:function(O){var R=O.trans,A=O.key;return new Promise(function(j,z){j=st(j);var L=R.objectStore(P).get(A);L.onsuccess=function(V){return j(V.target.result)},L.onerror=Gn(z)})},query:(T=m,function(O){return new Promise(function(R,A){R=st(R);var j,z,L,ce=O.trans,V=O.values,oe=O.limit,Se=O.query,xe=oe===1/0?void 0:oe,Re=Se.index,Se=Se.range,ce=ce.objectStore(P),ce=Re.isPrimaryKey?ce:ce.index(Re.name),Re=u(Se);if(oe===0)return R({result:[]});T?((Se=V?ce.getAll(Re,xe):ce.getAllKeys(Re,xe)).onsuccess=function(Ce){return R({result:Ce.target.result})},Se.onerror=Gn(A)):(j=0,z=!V&&"openKeyCursor"in ce?ce.openKeyCursor(Re):ce.openCursor(Re),L=[],z.onsuccess=function(Ce){var me=z.result;return!me||(L.push(V?me.value:me.primaryKey),++j===oe)?R({result:L}):void me.continue()},z.onerror=Gn(A))})}),openCursor:function(O){var R=O.trans,A=O.values,j=O.query,z=O.reverse,L=O.unique;return new Promise(function(V,oe){V=st(V);var ce=j.index,xe=j.range,Se=R.objectStore(P),Se=ce.isPrimaryKey?Se:Se.index(ce.name),ce=z?L?"prevunique":"prev":L?"nextunique":"next",Re=!A&&"openKeyCursor"in Se?Se.openKeyCursor(u(xe),ce):Se.openCursor(u(xe),ce);Re.onerror=Gn(oe),Re.onsuccess=st(function(Ce){var me,Pe,Ze,tt,Be=Re.result;Be?(Be.___id=++Jc,Be.done=!1,me=Be.continue.bind(Be),Pe=(Pe=Be.continuePrimaryKey)&&Pe.bind(Be),Ze=Be.advance.bind(Be),tt=function(){throw new Error("Cursor not stopped")},Be.trans=R,Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=function(){throw new Error("Cursor not started")},Be.fail=st(oe),Be.next=function(){var Ge=this,pt=1;return this.start(function(){return pt--?Ge.continue():Ge.stop()}).then(function(){return Ge})},Be.start=function(Ge){function pt(){if(Re.result)try{Ge()}catch(mt){Be.fail(mt)}else Be.done=!0,Be.start=function(){throw new Error("Cursor behind last entry")},Be.stop()}var vn=new Promise(function(mt,Gr){mt=st(mt),Re.onerror=Gn(Gr),Be.fail=Gr,Be.stop=function(qi){Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=tt,mt(qi)}});return Re.onsuccess=st(function(mt){Re.onsuccess=pt,pt()}),Be.continue=me,Be.continuePrimaryKey=Pe,Be.advance=Ze,pt(),vn},V(Be)):V(null)},oe)})},count:function(O){var R=O.query,A=O.trans,j=R.index,z=R.range;return new Promise(function(L,V){var oe=A.objectStore(P),oe=j.isPrimaryKey?oe:oe.index(j.name),xe=u(z),xe=xe?oe.count(xe):oe.count();xe.onsuccess=st(function(Se){return L(Se.target.result)}),xe.onerror=Gn(V)})}}}p=C,g=ul((C=n).objectStoreNames);var p,C={schema:{name:C.name,tables:g.map(function(I){return p.objectStore(I)}).map(function(I){var T=I.keyPath,P=I.autoIncrement,R=d(T),O={},R={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T==null,compound:R,keyPath:T,autoIncrement:P,unique:!0,extractKey:bi(T)},indexes:ul(I.indexNames).map(function(A){return I.index(A)}).map(function(L){var V=L.name,j=L.unique,z=L.multiEntry,L=L.keyPath,V={name:V,compound:d(L),keyPath:L,unique:j,multiEntry:z,extractKey:bi(L)};return O[Ua(L)]=V}),getIndexByKeyPath:function(A){return O[Ua(A)]}};return O[":id"]=R.primaryKey,T!=null&&(O[Ua(T)]=R.primaryKey),R})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,m=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ka(s),schema:g}}function ef(n,s,l,u){return l=l.IDBKeyRange,s=$c(s,l,u),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function Es(n,s){var l=s.db,l=ef(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(p){return p.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function As(n,s,l,u){l.forEach(function(f){var p=u[f];s.forEach(function(g){var m=(function C(N,I){return S(N,I)||(N=h(N))&&C(N,I)})(g,f);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?M(g,f,{get:function(){return this.table(f)},set:function(C){w(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function _i(n,s){s.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function tf(n,s){return n._cfg.version-s._cfg.version}function nf(n,s,l,u){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=yi("$meta",fl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(l),p._completion.catch(u),p._reject.bind(p)),m=De.transless||De;Cn(function(){if(De.trans=p,De.transless=m,s!==0)return Es(n,l),N=s,((C=p).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):Ee.resolve(N)).then(function(j){var T=n,P=j,O=p,R=l,A=[],j=T._versions,z=T._dbSchema=Is(0,T.idbdb,R);return(j=j.filter(function(L){return L._cfg.version>=P})).length===0?Ee.resolve():(j.forEach(function(L){A.push(function(){var V,oe,xe,Se=z,ce=L._cfg.dbschema,Re=(Rs(T,Se,R),Rs(T,ce,R),z=T._dbSchema=ce,wi(Se,ce)),Ce=(Re.add.forEach(function(me){ki(R,me[0],me[1].primKey,me[1].indexes)}),Re.change.forEach(function(me){if(me.recreate)throw new be.Upgrade("Not yet support for changing primary key");var Pe=R.objectStore(me.name);me.add.forEach(function(Ze){return Cs(Pe,Ze)}),me.change.forEach(function(Ze){Pe.deleteIndex(Ze.name),Cs(Pe,Ze)}),me.del.forEach(function(Ze){return Pe.deleteIndex(Ze)})}),L._cfg.contentUpgrade);if(Ce&&L._cfg.version>P)return Es(T,R),O._memoizedTables={},V=ge(ce),Re.del.forEach(function(me){V[me]=Se[me]}),_i(T,[T.Transaction.prototype]),As(T,[T.Transaction.prototype],c(V),V),O.schema=V,(oe=he(Ce))&&Lt(),ce=Ee.follow(function(){var me;(xe=Ce(O))&&oe&&(me=In.bind(null,null),xe.then(me,me))}),xe&&typeof xe.then=="function"?Ee.resolve(xe):ce.then(function(){return xe})}),A.push(function(V){var oe,xe,Se=L._cfg.dbschema;oe=Se,xe=V,[].slice.call(xe.db.objectStoreNames).forEach(function(ce){return oe[ce]==null&&xe.db.deleteObjectStore(ce)}),_i(T,[T.Transaction.prototype]),As(T,[T.Transaction.prototype],T._storeNames,T._dbSchema),O.schema=T._dbSchema}),A.push(function(V){T.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(T.idbdb.version/10)===L._cfg.version?(T.idbdb.deleteObjectStore("$meta"),delete T._dbSchema.$meta,T._storeNames=T._storeNames.filter(function(oe){return oe!=="$meta"})):V.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return A.length?Ee.resolve(A.shift()(O.idbtrans)).then(L):Ee.resolve()})().then(function(){cl(z,R)}))}).catch(g);var C,N;c(f).forEach(function(I){ki(l,I,f[I].primKey,f[I].indexes)}),Es(n,l),Ee.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function rf(n,s){cl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Is(0,n.idbdb,s);Rs(n,n._dbSchema,s);for(var u=0,f=wi(l,n._dbSchema).change;u<f.length;u++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=s.objectStore(g.name);g.add.forEach(function(C){zt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),Cs(m,C)})})(f[u]);if(typeof p=="object")return p.value}}function wi(n,s){var l,u={del:[],add:[],change:[]};for(l in n)s[l]||u.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var g={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=f.idxByName,C=p.idxByName,N=void 0;for(N in m)C[N]||g.del.push(N);for(N in C){var I=m[N],T=C[N];I?I.src!==T.src&&g.change.push(T):g.add.push(T)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,p])}return u}function ki(n,s,l,u){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(p){return Cs(f,p)})}function cl(n,s){c(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(zt&&console.debug("Dexie: Creating missing table",l),ki(s,l,n[l].primKey,n[l].indexes))})}function Cs(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Is(n,s,l){var u={};return ne(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),g=mi(ll(N=p.keyPath),N||"",!0,!1,!!p.autoIncrement,N&&typeof N!="string",!0),m=[],C=0;C<p.indexNames.length;++C){var I=p.index(p.indexNames[C]),N=I.keyPath,I=mi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);m.push(I)}u[f]=yi(f,g,m)}),u}function Rs(n,s,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var p=u[f],g=l.objectStore(p);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var C,N=g.indexNames[m],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+ne(I).join("+")+"]";s[p]&&(C=s[p].idxByName[I])&&(C.name=N,delete s[p].idxByName[I],s[p].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function fl(n){return n.split(",").map(function(s,l){var f=s.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return mi(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,u)})}va.prototype._createTableSchema=yi,va.prototype._parseIndexSyntax=fl,va.prototype._parseStoresSpec=function(n,s){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),p=f.shift();if(!p)throw new be.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new be.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new be.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new be.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(u,p,f),s[u]=p}})},va.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),u={},f={};return l.forEach(function(p){v(u,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(u,f)}),s._dbSchema=f,_i(s,[s._allTables,s,s.Transaction.prototype]),As(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],c(f),f),s._storeNames=c(f),this},va.prototype.upgrade=function(n){return this._cfg.contentUpgrade=zn(this._cfg.contentUpgrade||Ke,n),this};var af=va;function va(){}function xi(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new rr(Wt,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Si(n){return n&&typeof n.databases=="function"}function Ti(n){return Cn(function(){return De.letThrough=!0,n()})}function Ei(n){return!("from"in n)}var Nt=function(n,s){var l;if(!this)return l=new Nt,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ga(n,s,l){var u=Xe(s,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Ei(n))return v(n,{from:s,to:l,d:1});var u=n.l,f=n.r;if(Xe(l,n.from)<0)return u?Ga(u,s,l):n.l={from:s,to:l,d:1,l:null,r:null},hl(n);if(0<Xe(s,n.to))return f?Ga(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},hl(n);Xe(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Xe(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,u&&!n.l&&Ha(n,u),f&&s&&Ha(n,f)}}function Ha(n,s){Ei(s)||(function l(u,f){var p=f.from,g=f.l,m=f.r;Ga(u,p,f.to),g&&l(u,g),m&&l(u,m)})(n,s)}function dl(n,s){var l=Ps(s),u=l.next();if(!u.done)for(var f=u.value,p=Ps(n),g=p.next(f.from),m=g.value;!u.done&&!g.done;){if(Xe(m.from,f.to)<=0&&0<=Xe(m.to,f.from))return!0;Xe(f.from,m.from)<0?f=(u=l.next(m.from)).value:m=(g=p.next(f.from)).value}return!1}function Ps(n){var s=Ei(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,u)for(;s.n.l&&Xe(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!u||Xe(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function hl(n){var s,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[s],(n[s]=l).d=pl(l)),n.d=pl(n)}function pl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Os(n,s){return c(s).forEach(function(l){n[l]?Ha(n[l],s[l]):n[l]=(function u(f){var p,g,m={};for(p in f)x(f,p)&&(g=f[p],m[p]=!g||typeof g!="object"||ve.has(g.constructor)?g:u(g));return m})(s[l])}),n}function Ai(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&dl(s[l],n[l])})}_(Nt.prototype,((ze={add:function(n){return Ha(this,n),this},addKey:function(n){return Ga(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ga(s,l,l)}),this},hasKey:function(n){var s=Ps(this).next(n).value;return s&&Xe(s.from,n)<=0&&0<=Xe(s.to,n)}})[le]=function(){return Ps(this)},ze));var Kr={},Ci={},Ii=!1;function Ds(n){Os(Ci,n),Ii||(Ii=!0,setTimeout(function(){Ii=!1,Ri(Ci,!(Ci={}))},0))}function Ri(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Kr);u<f.length;u++)vl(m=f[u],n,l,s);else for(var p in n){var g,m,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],m=Kr["idb://".concat(g,"/").concat(p)])&&vl(m,n,l,s)}l.forEach(function(C){return C()})}function vl(n,s,l,u){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var m=g[p],C=m[0],N=[],I=0,T=m[1];I<T.length;I++){var P=T[I];Ai(s,P.obsSet)?P.subscribers.forEach(function(j){return l.add(j)}):u&&N.push(P)}u&&f.push([C,N])}if(u)for(var O=0,R=f;O<R.length;O++){var A=R[O],C=A[0],N=A[1];n.queries.query[C]=N}}function sf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ke(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var u=s.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(s.openCanceller!==u)throw new be.DatabaseClosed("db.open() was cancelled")}function m(){return new Ee(function(P,O){if(g(),!l)throw new be.MissingAPI;var R=n.name,A=s.autoSchema||!f?l.open(R):l.open(R,f);if(!A)throw new be.MissingAPI;A.onerror=Gn(O),A.onblocked=st(n._fireOnBlocked),A.onupgradeneeded=st(function(j){var z;I=A.transaction,s.autoSchema&&!n._options.allowEmptyDB?(A.onerror=za,I.abort(),A.result.close(),(z=l.deleteDatabase(R)).onsuccess=z.onerror=st(function(){O(new be.NoSuchDatabase("Database ".concat(R," doesnt exist")))})):(I.onerror=Gn(O),z=j.oldVersion>Math.pow(2,62)?0:j.oldVersion,T=z<1,n.idbdb=A.result,p&&rf(n,I),nf(n,z/10,I,O))},O),A.onsuccess=st(function(){I=null;var j,z,L,V,oe,xe,Se=n.idbdb=A.result,ce=ne(Se.objectStoreNames);if(0<ce.length)try{var Re=Se.transaction((oe=ce).length===1?oe[0]:oe,"readonly");if(s.autoSchema)xe=Se,V=Re,(L=n).verno=xe.version/10,V=L._dbSchema=Is(0,xe,V),L._storeNames=ne(xe.objectStoreNames,0),As(L,[L._allTables],c(V),V);else if(Rs(n,n._dbSchema,Re),z=Re,((z=wi(Is(0,(j=n).idbdb,z),j._dbSchema)).add.length||z.change.some(function(Ce){return Ce.add.length||Ce.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Se.close(),f=Se.version+1,p=!0,P(m());Es(n,Re)}catch{}bt.push(n),Se.onversionchange=st(function(Ce){s.vcFired=!0,n.on("versionchange").fire(Ce)}),Se.onclose=st(function(){n.close({disableAutoOpen:!1})}),T&&(ce=n._deps,oe=R,Si(xe=ce.indexedDB)||oe===Wt||xi(xe,ce.IDBKeyRange).put({name:oe}).catch(Ke)),P()},O)}).catch(function(P){switch(P==null?void 0:P.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<f)return f=0,m()}return Ee.reject(P)})}var C,N=s.dbReadyResolve,I=null,T=!1;return Ee.race([u,(typeof navigator>"u"?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function O(){return indexedDB.databases().finally(P)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(m)]).then(function(){return g(),s.onReadyBeingFired=[],Ee.resolve(Ti(function(){return n.on.ready.fire(n.vip)})).then(function P(){var O;if(0<s.onReadyBeingFired.length)return O=s.onReadyBeingFired.reduce(zn,Ke),s.onReadyBeingFired=[],Ee.resolve(Ti(function(){return O(n.vip)})).then(P)})}).finally(function(){s.openCanceller===u&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(P){s.dbOpenError=P;try{I&&I.abort()}catch{}return u===s.openCanceller&&n._close(),ke(P)}).finally(function(){s.openComplete=!0,N()}).then(function(){var P;return T&&(P={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(R){R.name&&(P["idb://".concat(n.name,"/").concat(O.name,"/").concat(R.name)]=new Nt(-1/0,[[[]]]))}),P["idb://".concat(n.name,"/").concat(O.name,"/")]=P["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Nt(-1/0,[[[]]])}),wr(Fa).fire(P),Ri(P,!0)),n})}function Pi(n){function s(p){return n.next(p)}var l=f(s),u=f(function(p){return n.throw(p)});function f(p){return function(m){var m=p(m),C=m.value;return m.done?C:C&&typeof C.then=="function"?C.then(l,u):d(C)?Promise.all(C).then(l,u):l(C)}}return f(s)()}function Ms(n,s,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(s);return u}var of={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},p=[];function g(P,O,R){var L=Ua(P),A=f[L]=f[L]||[],j=P==null?0:typeof P=="string"?1:P.length,z=0<O,L=a(a({},R),{name:z?"".concat(L,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:z,keyTail:O,keyLength:j,extractKey:bi(P),unique:!z&&R.unique});return A.push(L),L.isPrimaryKey||p.push(L),1<j&&g(j===2?P[0]:P.slice(0,j-1),O+1,R),A.sort(function(V,oe){return V.keyTail-oe.keyTail}),L}var m=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[m];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function T(P){var O,R=P.query.index;return R.isVirtual?a(a({},P),{query:{index:R.lowLevelIndex,range:(O=P.query.range,R=R.keyTail,{type:O.type===1?2:O.type,lower:Ms(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,R),lowerOpen:!0,upper:Ms(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,R),upperOpen:!0})}}):P}return a(a({},l),{schema:a(a({},u),{primaryKey:m,indexes:p,getIndexByKeyPath:function(P){return(P=f[Ua(P)])&&P[0]}}),count:function(P){return l.count(T(P))},query:function(P){return l.query(T(P))},openCursor:function(P){var O=P.query.index,R=O.keyTail,A=O.keyLength;return O.isVirtual?l.openCursor(T(P)).then(function(z){return z&&j(z)}):l.openCursor(P);function j(z){return Object.create(z,{continue:{value:function(L){L!=null?z.continue(Ms(L,P.reverse?n.MAX_KEY:n.MIN_KEY,R)):P.unique?z.continue(z.key.slice(0,A).concat(P.reverse?n.MIN_KEY:n.MAX_KEY,R)):z.continue()}},continuePrimaryKey:{value:function(L,V){z.continuePrimaryKey(Ms(L,n.MAX_KEY,R),V)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var L=z.key;return A===1?L[0]:L.slice(0,A)}},value:{get:function(){return z.value}}})}}})}})}};function Oi(n,s,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var p,g,m;x(s,f)?(p=n[f],g=s[f],typeof p=="object"&&typeof g=="object"&&p&&g?(m=ie(p))!==ie(g)?l[u+f]=s[f]:m==="Object"?Oi(p,g,l,u+f+"."):p!==g&&(l[u+f]=s[f]):p!==g&&(l[u+f]=s[f])):l[u+f]=void 0}),c(s).forEach(function(f){x(n,f)||(l[u+f]=s[f])}),l}function Di(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var lf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),u=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=De.trans,g=p.table(s).hook,m=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===Ke&&N.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"delete":if(m.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(m.fire===Ke)break;return p._promise("readwrite",function(){return(function T(P,O,R){return l.query({trans:P,values:!1,query:{index:u,range:O},limit:R}).then(function(A){var j=A.result;return I({type:"delete",keys:j,trans:P}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):j.length<R?{failures:[],numFailures:0,lastResult:void 0}:T(P,a(a({},O),{lower:j[j.length-1],lowerOpen:!0}),R)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function I(T){var P,O,R,A=De.trans,j=T.keys||Di(u,T);if(j)return(T=T.type==="add"||T.type==="put"?a(a({},T),{keys:j}):a({},T)).type!=="delete"&&(T.values=i([],T.values)),T.keys&&(T.keys=i([],T.keys)),P=l,R=j,((O=T).type==="add"?Promise.resolve([]):P.getMany({trans:O.trans,keys:R,cache:"immutable"})).then(function(z){var L=j.map(function(V,oe){var xe,Se,ce,Re=z[oe],Ce={onerror:null,onsuccess:null};return T.type==="delete"?m.fire.call(Ce,V,Re,A):T.type==="add"||Re===void 0?(xe=C.fire.call(Ce,V,T.values[oe],A),V==null&&xe!=null&&(T.keys[oe]=V=xe,u.outbound||Y(T.values[oe],u.keyPath,V))):(xe=Oi(Re,T.values[oe]),(Se=N.fire.call(Ce,xe,V,Re,A))&&(ce=T.values[oe],Object.keys(Se).forEach(function(me){x(ce,me)?ce[me]=Se[me]:Y(ce,me,Se[me])}))),Ce});return l.mutate(T).then(function(V){for(var oe=V.failures,xe=V.results,Se=V.numFailures,V=V.lastResult,ce=0;ce<j.length;++ce){var Re=(xe||j)[ce],Ce=L[ce];Re==null?Ce.onerror&&Ce.onerror(oe[ce]):Ce.onsuccess&&Ce.onsuccess(T.type==="put"&&z[ce]?T.values[ce]:Re)}return{failures:oe,results:xe,numFailures:Se,lastResult:V}}).catch(function(V){return L.forEach(function(oe){return oe.onerror&&oe.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function gl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var u=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)Xe(s.keys[f],n[p])===0&&(u.push(l?re(s.values[f]):s.values[f]),++p);return u.length===n.length?u:null}catch{return null}}var uf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(u){var f;return u.cache?(f=gl(u.keys,u.trans._cache,u.cache==="clone"))?Ee.resolve(f):l.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?re(p):p},p}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function ml(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function yl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var cf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Nt(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,f,p){if(De.subscr&&f!=="readonly")throw new be.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(De.querier));return n.transaction(u,f,p)},table:function(u){function f(j){var A,j=j.query;return[A=j.index,new Nt((A=(j=j.range).lower)!=null?A:n.MIN_KEY,(A=j.upper)!=null?A:n.MAX_KEY)]}var p=n.table(u),g=p.schema,m=g.primaryKey,C=g.indexes,N=m.extractKey,I=m.outbound,T=m.autoIncrement&&C.filter(function(R){return R.compound&&R.keyPath.includes(m.keyPath)}),P=a(a({},p),{mutate:function(R){function A(Pe){return Pe="idb://".concat(s,"/").concat(u,"/").concat(Pe),oe[Pe]||(oe[Pe]=new Nt)}var j,z,L,V=R.trans,oe=R.mutatedParts||(R.mutatedParts={}),xe=A(""),Se=A(":dels"),ce=R.type,Ce=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Di(m,R).filter(function(Pe){return Pe}),R.values]:[],Re=Ce[0],Ce=Ce[1],me=R.trans._cache;return d(Re)?(xe.addKeys(Re),(ce=ce==="delete"||Re.length===Ce.length?gl(Re,me):null)||Se.addKeys(Re),(ce||Ce)&&(j=A,z=ce,L=Ce,g.indexes.forEach(function(Pe){var Ze=j(Pe.name||"");function tt(Ge){return Ge!=null?Pe.extractKey(Ge):null}function Be(Ge){Pe.multiEntry&&d(Ge)?Ge.forEach(function(pt){return Ze.addKey(pt)}):Ze.addKey(Ge)}(z||L).forEach(function(Ge,mt){var vn=z&&tt(z[mt]),mt=L&&tt(L[mt]);Xe(vn,mt)!==0&&(vn!=null&&Be(vn),mt!=null)&&Be(mt)})}))):Re?(Ce={from:(me=Re.lower)!=null?me:n.MIN_KEY,to:(ce=Re.upper)!=null?ce:n.MAX_KEY},Se.add(Ce),xe.add(Ce)):(xe.add(l),Se.add(l),g.indexes.forEach(function(Pe){return A(Pe.name).add(l)})),p.mutate(R).then(function(Pe){return!Re||R.type!=="add"&&R.type!=="put"||(xe.addKeys(Pe.results),T&&T.forEach(function(Ze){for(var tt=R.values.map(function(vn){return Ze.extractKey(vn)}),Be=Ze.keyPath.findIndex(function(vn){return vn===m.keyPath}),Ge=0,pt=Pe.results.length;Ge<pt;++Ge)tt[Ge][Be]=Pe.results[Ge];A(Ze.name).addKeys(tt)})),V.mutatedParts=Os(V.mutatedParts||{},oe),Pe})}}),O={get:function(R){return[m,new Nt(R.key)]},getMany:function(R){return[m,new Nt().addKeys(R.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(R){P[R]=function(A){var j=De.subscr,z=!!j,L=ml(De,p)&&yl(R,A)?A.obsSet={}:j;if(z){var V,j=function(Ce){return Ce="idb://".concat(s,"/").concat(u,"/").concat(Ce),L[Ce]||(L[Ce]=new Nt)},oe=j(""),xe=j(":dels"),z=O[R](A),Se=z[0],z=z[1];if((R==="query"&&Se.isPrimaryKey&&!A.values?xe:j(Se.name||"")).add(z),!Se.isPrimaryKey){if(R!=="count")return V=R==="query"&&I&&A.values&&p.query(a(a({},A),{values:!1})),p[R].apply(this,arguments).then(function(Ce){if(R==="query"){if(I&&A.values)return V.then(function(tt){return tt=tt.result,oe.addKeys(tt),Ce});var me=A.values?Ce.result.map(N):Ce.result;(A.values?oe:xe).addKeys(me)}else{var Pe,Ze;if(R==="openCursor")return Ze=A.values,(Pe=Ce)&&Object.create(Pe,{key:{get:function(){return xe.addKey(Pe.primaryKey),Pe.key}},primaryKey:{get:function(){var tt=Pe.primaryKey;return xe.addKey(tt),tt}},value:{get:function(){return Ze&&oe.addKey(Pe.primaryKey),Pe.value}}})}return Ce});xe.add(l)}}return p[R].apply(this,arguments)}}),P}})}};function bl(n,s,l){var u;return l.numFailures===0?s:s.type==="deleteRange"||(u=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===u)?null:(u=a({},s),d(u.keys)&&(u.keys=u.keys.filter(function(f,p){return!(p in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,p){return!(p in l.failures)})),u)}function Mi(n,s){return l=n,((u=s).lower===void 0||(u.lowerOpen?0<Xe(l,u.lower):0<=Xe(l,u.lower)))&&(l=n,(u=s).upper===void 0||(u.upperOpen?Xe(l,u.upper)<0:Xe(l,u.upper)<=0));var l,u}function _l(n,s,l,u,f,p){var g,m,C,N,I,T;return!l||l.length===0||(g=s.query.index,m=g.multiEntry,C=s.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,T=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(P,O){var R=P,A=[];if(O.type==="add"||O.type==="put")for(var j=new Nt,z=O.values.length-1;0<=z;--z){var L,V=O.values[z],oe=N(V);!j.hasKey(oe)&&(L=I(V),m&&d(L)?L.some(function(Ce){return Mi(Ce,C)}):Mi(L,C))&&(j.addKey(oe),A.push(V))}switch(O.type){case"add":var xe=new Nt().addKeys(s.values?P.map(function(me){return N(me)}):P),R=P.concat(s.values?A.filter(function(me){return me=N(me),!xe.hasKey(me)&&(xe.addKey(me),!0)}):A.map(function(me){return N(me)}).filter(function(me){return!xe.hasKey(me)&&(xe.addKey(me),!0)}));break;case"put":var Se=new Nt().addKeys(O.values.map(function(me){return N(me)}));R=P.filter(function(me){return!Se.hasKey(s.values?N(me):me)}).concat(s.values?A:A.map(function(me){return N(me)}));break;case"delete":var ce=new Nt().addKeys(O.keys);R=P.filter(function(me){return!ce.hasKey(s.values?N(me):me)});break;case"deleteRange":var Re=O.range;R=P.filter(function(me){return!Mi(N(me),Re)})}return R},n))===n)?n:(u.sort(function(P,O){return Xe(T(P),T(O))||Xe(N(P),N(O))}),s.limit&&s.limit<1/0&&(u.length>s.limit?u.length=s.limit:n.length===s.limit&&u.length<s.limit&&(f.dirty=!0)),p?Object.freeze(u):u)}function wl(n,s){return Xe(n.lower,s.lower)===0&&Xe(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function ff(n,s){return((l,u,f,p)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=Xe(l,u))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,u,f,p)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=Xe(l,u))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function df(n,s,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&Q(p,f)},3e3))})}var hf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,u,f){var p,g,m=n.transaction(l,u,f);return u==="readwrite"&&(f=(p=new AbortController).signal,m.addEventListener("abort",(g=function(C){return function(){if(p.abort(),u==="readwrite"){for(var N=new Set,I=0,T=l;I<T.length;I++){var P=T[I],O=Kr["idb://".concat(s,"/").concat(P)];if(O){var R=n.table(P),A=O.optimisticOps.filter(function(Pe){return Pe.trans===m});if(m._explicit&&C&&m.mutatedParts)for(var j=0,z=Object.values(O.queries.query);j<z.length;j++)for(var L=0,V=(Se=z[j]).slice();L<V.length;L++)Ai((ce=V[L]).obsSet,m.mutatedParts)&&(Q(Se,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Pe){return Pe.trans!==m});for(var oe=0,xe=Object.values(O.queries.query);oe<xe.length;oe++)for(var Se,ce,Re,Ce=0,me=(Se=xe[oe]).slice();Ce<me.length;Ce++)(ce=me[Ce]).res!=null&&m.mutatedParts&&(C&&!ce.dirty?(Re=Object.isFrozen(ce.res),Re=_l(ce.res,ce.req,A,R,ce,Re),ce.dirty?(Q(Se,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)})):Re!==ce.res&&(ce.res=Re,ce.promise=Ee.resolve({result:Re}))):(ce.dirty&&Q(Se,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)})))}}}N.forEach(function(Pe){return Pe()})}}})(!1),{signal:f}),m.addEventListener("error",g(!1),{signal:f}),m.addEventListener("complete",g(!0),{signal:f})),m},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return a(a({},u),{mutate:function(p){var g,m=De.trans;return!f.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Kr["idb://".concat(s,"/").concat(l)])?(m=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Di(f,p).some(function(C){return C==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Ds(p.mutatedParts),m.then(function(C){0<C.numFailures&&(Q(g.optimisticOps,p),(C=bl(0,p,C))&&g.optimisticOps.push(C),p.mutatedParts)&&Ds(p.mutatedParts)}),m.catch(function(){Q(g.optimisticOps,p),p.mutatedParts&&Ds(p.mutatedParts)})):m.then(function(C){var N=bl(0,a(a({},p),{values:p.values.map(function(I,T){var P;return C.failures[T]?I:(Y(P=(P=f.keyPath)!=null&&P.includes(".")?re(I):a({},I),f.keyPath,C.results[T]),P)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return p.mutatedParts&&Ds(p.mutatedParts)})}),m):u.mutate(p)},query:function(p){var g,m,C,N,I,T,P;return ml(De,u)&&yl("query",p)?(g=((C=De.trans)==null?void 0:C.db._options.cache)==="immutable",m=(C=De).requery,C=C.signal,T=((O,R,A,j)=>{var z=Kr["idb://".concat(O,"/").concat(R)];if(!z)return[];if(!(O=z.queries[A]))return[null,!1,z,null];var L=O[(j.query?j.query.index.name:null)||""];if(!L)return[null,!1,z,null];switch(A){case"query":var V=L.find(function(oe){return oe.req.limit===j.limit&&oe.req.values===j.values&&wl(oe.req.query.range,j.query.range)});return V?[V,!0,z,L]:[L.find(function(oe){return("limit"in oe.req?oe.req.limit:1/0)>=j.limit&&(!j.values||oe.req.values)&&ff(oe.req.query.range,j.query.range)}),!1,z,L];case"count":return V=L.find(function(oe){return wl(oe.req.query.range,j.query.range)}),[V,!!V,z,L]}})(s,l,"query",p),P=T[0],N=T[2],I=T[3],P&&T[1]?P.obsSet=p.obsSet:(T=u.query(p).then(function(O){var R=O.result;if(P&&(P.res=R),g){for(var A=0,j=R.length;A<j;++A)Object.freeze(R[A]);Object.freeze(R)}else O.result=re(R);return O}).catch(function(O){return I&&P&&Q(I,P),Promise.reject(O)}),P={obsSet:p.obsSet,promise:T,subscribers:new Set,type:"query",req:p,dirty:!1},I?I.push(P):(I=[P],(N=N||(Kr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=I)),df(P,I,m,C),P.promise.then(function(O){return{result:_l(O.result,p,N==null?void 0:N.optimisticOps,u,P,g)}})):u.query(p)}})}})}};function Ls(n,s){return new Proxy(n,{get:function(l,u,f){return u==="db"?s:Reflect.get(l,u,f)}})}_t.prototype.version=function(n){if(isNaN(n)||n<.1)throw new be.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new be.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(tf),l.stores({}),this._state.autoSchema=!1),l},_t.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||De.letThrough||this._vip)?n():new Ee(function(l,u){if(s._state.openComplete)return u(new be.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void u(new be.DatabaseClosed);s.open().catch(Ke)}s._state.dbReadyPromise.then(l,u)}).then(n)},_t.prototype.use=function(f){var s=f.stack,l=f.create,u=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:u??10,name:f}),p.sort(function(g,m){return g.level-m.level}),this},_t.prototype.unuse=function(n){var s=n.stack,l=n.name,u=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},_t.prototype.open=function(){var n=this;return Me(xt,function(){return sf(n)})},_t.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=bt.indexOf(this);if(0<=s&&bt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ee(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ee(function(l,u){n.cancelOpen=u}))},_t.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new be.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new be.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},_t.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new Ee(function(f,p){function g(){s.close(n);var m=s._deps.indexedDB.deleteDatabase(s.name);m.onsuccess=st(function(){var C,N,I;C=s._deps,N=s.name,Si(I=C.indexedDB)||N===Wt||xi(I,C.IDBKeyRange).delete(N).catch(Ke),f()}),m.onerror=Gn(p),m.onblocked=s._fireOnBlocked}if(l)throw new be.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},_t.prototype.backendDB=function(){return this.idbdb},_t.prototype.isOpen=function(){return this.idbdb!==null},_t.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},_t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_t.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),_t.prototype.transaction=function(){var n=(function(s,l,u){var f=arguments.length;if(f<2)throw new be.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return u=p.pop(),[s,we(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},_t.prototype._transaction=function(n,s,l){var u,f,p=this,g=De.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(N){if(N=N instanceof p.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===Un)u=Un;else{if(n!="rw"&&n!=zr)throw new be.InvalidArgument("Invalid transaction mode: "+n);u=zr}if(g){if(g.mode===Un&&u===zr){if(!m)throw new be.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!m)throw new be.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,T){T(N)}):ke(N)}var C=(function N(I,T,P,O,R){return Ee.resolve().then(function(){var L=De.transless||De,A=I._createTransaction(T,P,I._dbSchema,O),L=(A.explicit=!0,{trans:A,transless:L});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===Ne.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,T,P,null,R)})):ke(V)}var j,z=he(R),L=(z&&Lt(),Ee.follow(function(){var V;(j=R.call(A,A))&&(z?(V=In.bind(null,null),j.then(V,V)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=Pi(j)))},L));return(j&&typeof j.then=="function"?Ee.resolve(j).then(function(V){return A.active?V:ke(new be.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return j})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),ke(V)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,C,"lock"):De.trans?Me(De.transless,function(){return p._whenReady(C)}):this._whenReady(C)},_t.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new be.InvalidTable("Table ".concat(n," does not exist"))};var rr=_t;function _t(n,s){var l,u,f,p,g,m=this,C=(this._middlewares={},this.verno=0,_t.dependencies),C=(this._options=s=a({addons:_t.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ke,dbReadyPromise:null,cancelOpen:Ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),I=(N.dbReadyPromise=new Ee(function(T){N.dbReadyResolve=T}),N.openCanceller=new Ee(function(T,P){N.cancelOpen=P}),this._state=N,this.name=n,this.on=ja(this,"populate","blocked","versionchange","close",{ready:[zn,Ke]}),this.once=function(T,P){var O=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];m.on(T).unsubscribe(O),P.apply(m,R)};return m.on(T,O)},this.on.ready.subscribe=G(this.on.ready.subscribe,function(T){return function(P,O){_t.vip(function(){var R,A=m._state;A.openComplete?(A.dbOpenError||Ee.resolve().then(P),O&&T(P)):A.onReadyBeingFired?(A.onReadyBeingFired.push(P),O&&T(P)):(T(P),R=m,O||T(function j(){R.on.ready.unsubscribe(P),R.on.ready.unsubscribe(j)}))})}}),this.Collection=(l=this,Ba(Vc.prototype,function(j,A){this.db=l;var O=Na,R=null;if(A)try{O=A()}catch(L){R=L}var A=j._ctx,j=A.table,z=j.hook.reading.fire;this._ctx={table:j,index:A.index,isPrimKey:!A.index||j.schema.primKey.keyPath&&A.index===j.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:R,or:A.or,valueMapper:z!==ut?z:null}})),this.Table=(u=this,Ba(nl.prototype,function(T,P,O){this.db=u,this._tx=O,this.name=T,this.schema=P,this.hook=u._allTables[T]?u._allTables[T].hook:ja(null,{creating:[Or,Ke],reading:[en,ut],updating:[Sn,Ke],deleting:[Dr,Ke]})})),this.Transaction=(f=this,Ba(Zc.prototype,function(T,P,O,R,A){var j=this;T!=="readonly"&&P.forEach(function(z){z=(z=O[z])==null?void 0:z.yProps,z&&(P=P.concat(z.map(function(L){return L.updatesTable})))}),this.db=f,this.mode=T,this.storeNames=P,this.schema=O,this.chromeTransactionDurability=R,this.idbtrans=null,this.on=ja(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee(function(z,L){j._resolve=z,j._reject=L}),this._completion.then(function(){j.active=!1,j.on.complete.fire()},function(z){var L=j.active;return j.active=!1,j.on.error.fire(z),j.parent?j.parent._reject(z):L&&j.idbtrans&&j.idbtrans.abort(),ke(z)})})),this.Version=(p=this,Ba(af.prototype,function(T){this.db=p,this._cfg={version:T,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Ba(ol.prototype,function(T,P,O){if(this.db=g,this._ctx={table:T,index:P===":id"?null:P,or:O},this._cmp=this._ascending=Xe,this._descending=function(R,A){return Xe(A,R)},this._max=function(R,A){return 0<Xe(R,A)?R:A},this._min=function(R,A){return Xe(R,A)<0?R:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new be.MissingAPI})),this.on("versionchange",function(T){0<T.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(T){!T.newVersion||T.newVersion<T.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(T.oldVersion/10))}),this._maxKey=Ka(s.IDBKeyRange),this._createTransaction=function(T,P,O,R){return new m.Transaction(T,P,O,m._options.chromeTransactionDurability,R)},this._fireOnBlocked=function(T){m.on("blocked").fire(T),bt.filter(function(P){return P.name===m.name&&P!==m&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(T)})},this.use(uf),this.use(hf),this.use(cf),this.use(of),this.use(lf),new Proxy(this,{get:function(T,P,O){var R;return P==="_vip"||(P==="table"?function(A){return Ls(m.table(A),I)}:(R=Reflect.get(T,P,O))instanceof nl?Ls(R,I):P==="tables"?R.map(function(A){return Ls(A,I)}):P==="_createTransaction"?function(){return Ls(R.apply(this,arguments),I)}:R)}}));this.vip=I,C.forEach(function(T){return T(m)})}var Ns,ga=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",pf=(Li.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Li.prototype[ga]=function(){return this},Li);function Li(n){this._subscribe=n}try{Ns={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ns={indexedDB:null,IDBKeyRange:null}}function kl(n){var s,l=!1,u=new pf(function(f){var p=he(n),g,m=!1,C={},N={},I={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),T&&wr.storagemutated.unsubscribe(O))}},T=(f.start&&f.start(I),!1),P=function(){return de(R)},O=function(A){Os(C,A),Ai(N,C)&&P()},R=function(){var A,j,z;!m&&Ns.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,z=(L=>{var V=br();try{p&&Lt();var oe=Cn(n,L);return oe=p?oe.finally(In):oe}finally{V&&nr()}})(j={subscr:A,signal:g.signal,requery:P,querier:n,trans:null}),Promise.resolve(z).then(function(L){l=!0,s=L,m||j.signal.aborted||(C={},(V=>{for(var oe in V)if(x(V,oe))return;return 1})(N=A)||T||(wr(Fa,O),T=!0),de(function(){return!m&&f.next&&f.next(L)}))},function(L){l=!1,["DatabaseClosedError","AbortError"].includes(L==null?void 0:L.name)||m||de(function(){m||f.error&&f.error(L)})}))};return setTimeout(P,0),I});return u.hasValue=function(){return l},u.getValue=function(){return s},u}var Ur=rr;function Ni(n){var s=kr;try{kr=!0,wr.storagemutated.fire(n),Ri(n,!0)}finally{kr=s}}_(Ur,a(a({},Z),{delete:function(n){return new Ur(n,{addons:[]}).delete()},exists:function(n){return new Ur(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Ur.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Si(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Wt})}):xi(l,s).toCollection().primaryKeys()).then(n)}catch{return ke(new be.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return De.trans?Me(De.transless,n):n()},vip:Ti,async:function(n){return function(){try{var s=Pi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ee.resolve(s)}catch(l){return ke(l)}}},spawn:function(n,s,l){try{var u=Pi(n.apply(l,s||[]));return u&&typeof u.then=="function"?u:Ee.resolve(u)}catch(f){return ke(f)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(n,s){return n=Ee.resolve(typeof n=="function"?Ur.ignoreTransaction(n):n).timeout(s||6e4),De.trans?De.trans.waitFor(n):n},Promise:Ee,debug:{get:function(){return zt},set:function(n){Mr(n)}},derive:q,extend:v,props:_,override:G,Events:ja,on:wr,liveQuery:kl,extendObservabilitySet:Os,getByKeyPath:$,setByKeyPath:Y,delByKeyPath:function(n,s){typeof s=="string"?Y(n,s,void 0):"length"in s&&[].map.call(s,function(l){Y(n,l,void 0)})},shallowClone:ge,deepClone:re,getObjectDiff:Oi,cmp:Xe,asap:X,minKey:-1/0,addons:[],connections:bt,errnames:Ne,dependencies:Ns,cache:Kr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Ur.maxKey=Ka(Ur.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(wr(Fa,function(n){kr||(n=new CustomEvent(gi,{detail:n}),kr=!0,dispatchEvent(n),kr=!1)}),addEventListener(gi,function(n){n=n.detail,kr||Ni(n)}));var ma,kr=!1,xl=function(){};return typeof BroadcastChannel<"u"&&((xl=function(){(ma=new BroadcastChannel(gi)).onmessage=function(n){return n.data&&Ni(n.data)}})(),typeof ma.unref=="function"&&ma.unref(),wr(Fa,function(n){kr||ma.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!rr.disableBfCache&&n.persisted){zt&&console.debug("Dexie: handling persisted pagehide"),ma!=null&&ma.close();for(var s=0,l=bt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!rr.disableBfCache&&n.persisted&&(zt&&console.debug("Dexie: handling persisted pageshow"),xl(),Ni({all:new Nt(-1/0,[[]])}))})),Ee.rejectionMapper=function(n,s){return!n||n instanceof Ae||n instanceof TypeError||n instanceof SyntaxError||!n.name||!lt[n.name]?n:(s=new lt[n.name](s||n.message,n),"stack"in n&&M(s,"stack",{get:function(){return this.inner.stack}}),s)},Mr(zt),a(rr,Object.freeze({__proto__:null,Dexie:rr,Entity:Zo,PropModification:qa,RangeSet:Nt,add:function(n){return new qa({add:n})},cmp:Xe,default:rr,liveQuery:kl,mergeRanges:Ha,rangesOverlap:dl,remove:function(n){return new qa({remove:n})},replacePrefix:function(n,s){return new qa({replacePrefix:[n,s]})}}),{default:rr}),rr})})(Qs)),Qs.exports}var $d=Jd();const uo=Xd($d),Kl=Symbol.for("Dexie"),jt=globalThis[Kl]||(globalThis[Kl]=uo);if(uo.semVer!==jt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${uo.semVer} and ${jt.semVer}`);const{liveQuery:ny,mergeRanges:ry,rangesOverlap:ay,RangeSet:sy,cmp:iy,Entity:oy,PropModification:ly,replacePrefix:uy,add:cy,remove:fy,DexieYProvider:dy}=jt,je=new jt("me-ai-store");je.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});je.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});je.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});je.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function cc(t,e){return`${t}:${e}`}function co(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Gi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function eh(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function fc(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function dc(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const th="https://gmail.googleapis.com/gmail/v1/users/me";class qo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function nh(t){return{Authorization:`Bearer ${t}`}}async function fi(t,e){var a,i,o,c;const r=await fetch(`${th}${e}`,{headers:nh(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,h=((c=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:c.reason)||void 0;throw new qo(v,r.status,h)}return r.json()}function hc(t){return fi(t,"/profile")}function pc(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),fi(t,`/messages?${i}`)}function vc(t,e,r="full"){return fi(t,`/messages/${e}?format=${r}`)}function rh(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),fi(t,`/history?${i}`)}function Sr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ss(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function ah(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/plain");if((c=a==null?void 0:a.body)!=null&&c.data)return ss(a.body.data);const i=ei(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=ss(i.body.data);return ih(v)}return"(no body)"}function sh(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ss(a.body.data):null}function ei(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ei(r.parts,e);if(a)return a}}return null}function ih(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function jo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Bo(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function gc(t){return Bo(t).charAt(0).toUpperCase()}function oh(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function lh(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function mc(t,e){return`${oh(t.date)}_${lh(t.subject)}.${e}`}function yc(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function uh(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await bc();if(a&&i){const c=new Date(a.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const o=await ph(5);return o.length>0&&r.push("Top senders: "+o.map(([c,d])=>`${Bo(c)} (${d})`).join(", ")+"."),r.join(" ")}async function ch(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await bc();if(a&&i){const v=new Date(a.date).toLocaleDateString(),h=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${v} â ${h}`)}const o=await je.items.where("sourceType").equals("gmail").toArray(),c=_c(o,10),d=vh(o,10);if(c.length>0){r.push("","### Top Senders");for(const[v,h]of c)r.push(`- ${v}: ${h}`)}if(d.length>0){r.push("","### Labels");for(const[v,h]of d)r.push(`- ${v}: ${h}`)}return r.join(`
`)}async function fh(t=10){const e=await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(wc).join(`

---

`)}async function dh(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await je.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,h,y,x;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(h=o.to)!=null&&h.toLowerCase().includes(r)&&(c+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>wc(o)).join(`

---

`)}async function fo(){const t=await je.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=yc(t);return{groups:e,order:r,total:t.length}}async function hh({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await je.items.where("sourceType").equals("gmail").filter(d=>{var v,h,y,x;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((h=d.from)==null?void 0:h.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const a=await je.items.where("sourceType").equals("gmail").count();return{items:await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function bc(){const t=await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).first(),e=await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).last();return{oldest:t,newest:e}}async function ph(t){const e=await je.items.where("sourceType").equals("gmail").toArray();return _c(e,t)}function _c(t,e){const r={};for(const a of t){const i=a.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,e)}function vh(t,e){const r={};for(const a of t)for(const i of a.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,e)}function wc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=fc(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function gh(){const t=await uh();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function mh(t){const e=[],r=await ch();if(e.push(r),t){const a=await dh(t,5);e.push("","## Relevant Emails",a)}else{const a=await fh(5);e.push("","## Recent Emails",a)}return e.join(`
`)}async function yh(){const t=await fo();if(!t)return null;const e=["## Pending Action Items",`You have ${t.total} pending email action items that need attention:`,""];for(const r of t.order){const a=t.groups[r],i=r.replace(/_/g," ");e.push(`### ${i} (${a.length})`);for(const o of a.slice(0,5)){const c=o.date?new Date(o.date).toLocaleDateString():"unknown date";e.push(`- **${o.subject}** from ${o.from} (${c})`),o.summary&&e.push(`  ${o.summary}`)}a.length>5&&e.push(`  ...and ${a.length-5} more`),e.push("")}return e.push("The user is seeing these pending items in their chat. Help them decide what to do with these items. You can suggest specific actions like archiving, replying, following up, etc."),e.join(`
`)}const bh=20,_h=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function kc(t,{count:e=bh,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(e).toArray();else{const h=new Set((await je.emailClassifications.toArray()).map(x=>x.emailId)),y=await je.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().toArray();o=0,i=[];for(const x of y)if(h.has(x.id))o++;else if(i.push(x),i.length>=e)break}if(i.length===0){const h=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:h,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let h=0;h<i.length;h++){const y=i[h];a({phase:"scanning",message:`Classifying email ${h+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:h+1,total:i.length,classified:d});try{const x=Sh(y),_=[{role:"system",content:_h},{role:"user",content:x}],w=await t.generateFull(_),M=Th(w);M&&(await je.emailClassifications.put({emailId:y.id,action:M.action,reason:M.reason,summary:M.summary,tags:M.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:c,status:"pending"}),d++)}catch(x){console.error(`Triage email ${h+1} failed:`,x),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function wh(){const t=await je.emailClassifications.toArray();return yc(t)}async function kh(){const t=await je.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ti(t,e){await je.emailClassifications.update(t,{status:e})}async function xh(){await je.emailClassifications.clear()}async function xc(t){await je.emailClassifications.where("action").equals(t).delete()}async function Sc(t){await je.emailClassifications.delete(t)}async function ho(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Sh(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=fc(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Th(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=Eh(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(h=>typeof h=="string"&&h.trim()).map(h=>h.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function Eh(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function zo(t){return`hsl(${dc(t)}, 55%, 55%)`}function Tc(t){return`hsl(${dc(t)}, 40%, 35%)`}const Ah=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Ul(...t){Ah&&console.log("[debug]",...t)}function fn(t){return Ul(`[MOUNT] ${t}`),()=>Ul(`[DESTROY] ${t}`)}var Ch=H("<option> </option>"),Ih=H('<p class="model-description svelte-1p89qnn"> </p>'),Rh=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Ph=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Oh=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Dh=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Mh=H('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Lh=H('<p class="error svelte-1p89qnn"> </p>'),Nh=H('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function qh(t,e){ft(e,!0);let r=Ie(e,"selectedModel",15),a=Ie(e,"gpuInfo",3,null),i=Ie(e,"error",3,null);Mt(()=>fn("ModelSelector"));var o=Nh(),c=D(k(o),2),d=D(k(c),2);Ut(d,21,()=>ls,pr,(q,S)=>{var F=Ch(),ne=k(F),G={};ye(()=>{ae(ne,`${b(S).name??""} â ${b(S).size??""}`),G!==(G=b(S).id)&&(F.value=(F.__value=b(S).id)??"")}),K(q,F)});var v=D(d,2);{var h=q=>{const S=vt(()=>ls.find(U=>U.id===r()));var F=Oa(),ne=gt(F);{var G=U=>{var X=Ih(),$=k(X);ye(()=>ae($,b(S).description)),K(U,X)};Te(ne,U=>{b(S)&&U(G)})}K(q,F)};Te(v,q=>{r()&&q(h)})}var y=D(c,2);{var x=q=>{var S=Mh(),F=D(k(S),2),ne=k(F),G=D(k(ne)),U=k(G),X=D(ne,2),$=D(k(X)),Y=k($),ge=D(X,2);{var Le=le=>{var ue=Rh(),Q=D(k(ue)),te=k(Q);ye(()=>ae(te,a().device)),K(le,ue)};Te(ge,le=>{a().device&&a().device!=="unknown"&&le(Le)})}var we=D(ge,2);{var ve=le=>{var ue=Ph(),Q=D(k(ue)),te=k(Q);ye(()=>ae(te,a().description)),K(le,ue)};Te(we,le=>{a().description&&a().description!=="unknown"&&le(ve)})}var se=D(we,2);{var re=le=>{var ue=Oh(),Q=D(k(ue)),te=k(Q);ye(ee=>ae(te,ee),[()=>co(a().limits.maxBufferSize)]),K(le,ue)};Te(se,le=>{var ue;(ue=a().limits)!=null&&ue.maxBufferSize&&le(re)})}var qe=D(se,2);{var ie=le=>{var ue=Dh(),Q=D(k(ue)),te=k(Q);ye(()=>ae(te,`${a().features.length??""} supported`)),K(le,ue)};Te(qe,le=>{var ue;(ue=a().features)!=null&&ue.length&&le(ie)})}ye(()=>{ae(U,a().vendor),ae(Y,a().architecture)}),K(q,S)};Te(y,q=>{a()&&q(x)})}var _=D(y,2);{var w=q=>{var S=Lh(),F=k(S);ye(()=>ae(F,i())),K(q,S)};Te(_,q=>{i()&&q(w)})}var M=D(_,2);M.__click=function(...q){var S;(S=e.onload)==null||S.apply(this,q)},ye(()=>M.disabled=i()),Lo(d,r),K(t,o),dt()}Bt(["click"]);var jh=H('<span class="progress-percent svelte-r5fnze"> </span>'),Bh=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),zh=H('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Fh=H('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Kh=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Uh=H('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Gh=H('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Hh(t,e){ft(e,!0);let r=Ie(e,"message",3,""),a=Ie(e,"items",19,()=>[]);Mt(()=>fn("LoadingProgress"));var i=Gh(),o=k(i),c=k(o),d=D(o,2);Ut(d,17,a,pr,(v,h)=>{const y=vt(()=>b(h).total?eh(b(h).loaded||0,b(h).total):null);var x=Uh(),_=k(x),w=k(_),M=k(w),q=D(w,2);{var S=U=>{var X=jh(),$=k(X);ye(Y=>ae($,`${Y??""}%`),[()=>b(y).toFixed(1)]),K(U,X)};Te(q,U=>{b(y)!==null&&U(S)})}var F=D(_,2);{var ne=U=>{var X=Bh(),$=gt(X),Y=k($),ge=D($,2),Le=k(ge),we=k(Le),ve=D(Le,4),se=k(ve),re=D(ve,2),qe=k(re);ye((ie,le,ue,Q,te)=>{$t(Y,`width: ${ie??""}%`),ae(we,le),ae(se,ue),ae(qe,`(${Q??""} / ${te??""} B)`)},[()=>Math.max(b(h).progress??0,.5).toFixed(1),()=>Gi(b(h).loaded||0),()=>Gi(b(h).total),()=>(b(h).loaded||0).toLocaleString(),()=>b(h).total.toLocaleString()]),K(U,X)},G=U=>{var X=Kh(),$=D(gt(X),2),Y=k($);{var ge=we=>{var ve=zh(),se=gt(ve),re=k(se),qe=D(se,2),ie=k(qe);ye((le,ue)=>{ae(re,le),ae(ie,`(${ue??""} B)`)},[()=>Gi(b(h).loaded),()=>b(h).loaded.toLocaleString()]),K(we,ve)},Le=we=>{var ve=Fh();K(we,ve)};Te(Y,we=>{b(h).loaded?we(ge):we(Le,!1)})}K(U,X)};Te(F,U=>{b(h).total?U(ne):U(G,!1)})}ye(()=>{lc(w,"title",b(h).file),ae(M,b(h).file)}),K(v,x)}),ye(()=>ae(c,r())),K(t,i),dt()}var Wh=H('<span class="thinking-tokens svelte-11gjw00"> </span>'),Yh=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Vh=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Qh=H('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Xh=H('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Zh=H('<span class="cursor svelte-11gjw00">|</span>'),Jh=H(" <!>",1),$h=H('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),ep=H('<div class="content svelte-11gjw00"> </div>'),tp=H('<div><div class="role svelte-11gjw00"> </div> <!></div>');function np(t,e){ft(e,!0);let r=Ie(e,"isLast",3,!1),a=Ie(e,"isRunning",3,!1),i=Ie(e,"generationPhase",3,null),o=Ie(e,"numTokens",3,null);Mt(()=>fn(`MessageBubble[${e.msg.role}]`));var c=tp(),d=k(c),v=k(d),h=D(d,2);{var y=_=>{var w=$h(),M=gt(w);{var q=Y=>{var ge=Yh(),Le=D(k(ge),4);{var we=ve=>{var se=Wh(),re=k(se);ye(()=>ae(re,`${o()??""} tokens`)),K(ve,se)};Te(Le,ve=>{o()&&ve(we)})}K(Y,ge)},S=Y=>{var ge=Vh();K(Y,ge)};Te(M,Y=>{a()&&r()&&i()==="thinking"?Y(q):a()&&r()&&i()==="preparing"&&Y(S,1)})}var F=D(M,2);{var ne=Y=>{var ge=Qh(),Le=k(ge),we=D(k(Le),2),ve=k(we),se=D(Le,2),re=k(se);ye(qe=>{ae(ve,`${qe??""} words`),ae(re,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),K(Y,ge)};Te(F,Y=>{e.msg.thinking&&Y(ne)})}var G=D(F,2),U=k(G);{var X=Y=>{var ge=Xh();K(Y,ge)},$=Y=>{var ge=Jh(),Le=gt(ge,!0),we=D(Le);{var ve=se=>{var re=Zh();K(se,re)};Te(we,se=>{a()&&r()&&se(ve)})}ye(()=>ae(Le,e.msg.content)),K(Y,ge)};Te(U,Y=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?Y(X):Y($,!1)})}K(_,w)},x=_=>{var w=ep(),M=k(w);ye(()=>ae(M,e.msg.content)),K(_,w)};Te(h,_=>{e.msg.role==="assistant"?_(y):_(x,!1)})}ye(()=>{Zt(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ae(v,e.msg.role==="user"?"You":"AI")}),K(t,c),dt()}var rp=H('<span class="email-date svelte-mt5nvh"> </span>'),ap=H('<span class="email-summary svelte-mt5nvh"> </span>'),sp=H('<span class="tag svelte-mt5nvh"> </span>'),ip=H('<span class="email-tags svelte-mt5nvh"></span>'),op=H('<div class="email-row svelte-mt5nvh"><button class="email-info svelte-mt5nvh"><span class="email-subject svelte-mt5nvh"> </span> <span class="email-meta svelte-mt5nvh"><span class="email-from svelte-mt5nvh"> </span> <!></span> <!> <!></button> <div class="email-actions svelte-mt5nvh"><button class="icon-btn done-btn svelte-mt5nvh" title="Mark handled"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-mt5nvh" title="Dismiss"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <button class="icon-btn remove-btn svelte-mt5nvh" title="Remove"><svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button></div></div>'),lp=H('<button class="batch-btn svelte-mt5nvh"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg> Mark All Handled</button> <button class="batch-btn danger svelte-mt5nvh">Clear Group</button>',1),up=H('<span class="confirm-text svelte-mt5nvh"> </span> <button class="batch-btn svelte-mt5nvh">Cancel</button> <button class="batch-btn danger svelte-mt5nvh">Delete</button>',1),cp=H('<div class="group-body svelte-mt5nvh"><!> <div class="batch-bar svelte-mt5nvh"><!></div></div>'),fp=H('<div><button class="group-btn svelte-mt5nvh"><span class="group-dot svelte-mt5nvh"></span> <span class="group-label svelte-mt5nvh"> </span> <span class="group-count svelte-mt5nvh"> </span> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>'),dp=H('<div class="dashboard svelte-mt5nvh"><div class="dash-header svelte-mt5nvh"><svg class="dash-icon svelte-mt5nvh" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"></rect><rect x="14" y="3" width="7" height="7" rx="1"></rect><rect x="3" y="14" width="7" height="7" rx="1"></rect><rect x="14" y="14" width="7" height="7" rx="1"></rect></svg> <span class="dash-title svelte-mt5nvh"> </span></div> <div class="group-grid svelte-mt5nvh"></div></div>');function hp(t,e){ft(e,!0);let r=Ie(e,"pendingData",3,null),a=Oe(null),i=Oe(null);function o(_){B(a,b(a)===_?null:_,!0)}function c(_){return _.split("_").map(w=>w.charAt(0)+w.slice(1).toLowerCase()).join(" ")}function d(_){if(!_)return"";try{return new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}var v={toggleGroup:o},h=Oa(),y=gt(h);{var x=_=>{var w=dp(),M=k(w),q=D(k(M),2),S=k(q),F=D(M,2);Ut(F,20,()=>r().order,ne=>ne,(ne,G)=>{const U=vt(()=>r().groups[G]),X=vt(()=>zo(G)),$=vt(()=>b(a)===G);var Y=fp();let ge;var Le=k(Y);Le.__click=()=>o(G);var we=k(Le);let ve;var se=D(we,2),re=k(se),qe=D(se,2),ie=k(qe),le=D(qe,2);let ue;var Q=D(Le,2);{var te=ee=>{var he=cp(),Z=k(he);Ut(Z,17,()=>b(U),J=>J.emailId,(J,Ne)=>{var Fe=op(),be=k(Fe);be.__click=()=>{var ze;return(ze=e.onaskai)==null?void 0:ze.call(e,`Tell me about the email "${b(Ne).subject}" from ${b(Ne).from}`)};var lt=k(be),Ke=k(lt),ut=D(lt,2),en=k(ut),At=k(en),Or=D(en,2);{var Dr=ze=>{var at=rp(),nn=k(at);ye(rn=>ae(nn,rn),[()=>d(b(Ne).date)]),K(ze,at)};Te(Or,ze=>{b(Ne).date&&ze(Dr)})}var Sn=D(ut,2);{var vr=ze=>{var at=ap(),nn=k(at);ye(()=>ae(nn,b(Ne).summary)),K(ze,at)};Te(Sn,ze=>{b(Ne).summary&&ze(vr)})}var zn=D(Sn,2);{var zt=ze=>{var at=ip();Ut(at,21,()=>b(Ne).tags,pr,(nn,rn)=>{var Kn=sp();let Tn;var dn=k(Kn);ye(En=>{Tn=$t(Kn,"",Tn,En),ae(dn,b(rn))},[()=>({background:Tc(b(rn))})]),K(nn,Kn)}),K(ze,at)};Te(zn,ze=>{b(Ne).tags&&b(Ne).tags.length>0&&ze(zt)})}var Mr=D(be,2),Fn=k(Mr);Fn.__click=()=>{var ze;return(ze=e.onmarkacted)==null?void 0:ze.call(e,b(Ne).emailId)};var $n=D(Fn,2);$n.__click=()=>{var ze;return(ze=e.ondismiss)==null?void 0:ze.call(e,b(Ne).emailId)};var tn=D($n,2);tn.__click=()=>{var ze;return(ze=e.onremove)==null?void 0:ze.call(e,b(Ne).emailId)},ye(()=>{ae(Ke,b(Ne).subject),ae(At,b(Ne).from)}),K(J,Fe)});var fe=D(Z,2),Ae=k(fe);{var _e=J=>{var Ne=lp(),Fe=gt(Ne);Fe.__click=()=>e.onmarkacted&&b(U).forEach(lt=>e.onmarkacted(lt.emailId));var be=D(Fe,2);be.__click=()=>B(i,G,!0),K(J,Ne)},pe=J=>{var Ne=up(),Fe=gt(Ne),be=k(Fe),lt=D(Fe,2);lt.__click=()=>B(i,null);var Ke=D(lt,2);Ke.__click=()=>{var ut;(ut=e.oncleargroup)==null||ut.call(e,G),B(i,null)},ye(()=>ae(be,`Clear ${b(U).length??""} items?`)),K(J,Ne)};Te(Ae,J=>{b(i)!==G?J(_e):J(pe,!1)})}K(ee,he)};Te(Q,ee=>{b($)&&ee(te)})}ye(ee=>{ge=Zt(Y,1,"group-card svelte-mt5nvh",null,ge,{expanded:b($)}),ve=$t(we,"",ve,{background:b(X)}),ae(re,ee),ae(ie,b(U).length),ue=Zt(le,0,"group-chevron svelte-mt5nvh",null,ue,{open:b($)})},[()=>c(G)]),K(ne,Y)}),ye(()=>ae(S,`${r().total??""} pending action${r().total!==1?"s":""}`)),K(_,w)};Te(y,_=>{r()&&r().total>0&&_(x)})}return K(t,h),dt(v)}Bt(["click"]);var pp=H('<div class="chip scanning svelte-1ed7zw1"><span class="scan-spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),vp=H('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),gp=H('<button class="chip action-chip svelte-1ed7zw1"><span class="chip-dot svelte-1ed7zw1"></span> <span class="chip-label svelte-1ed7zw1"> </span> <span class="chip-count svelte-1ed7zw1"> </span></button>'),mp=H('<div class="quick-strip svelte-1ed7zw1"><!> <!></div>');function yp(t,e){ft(e,!0);let r=Ie(e,"pendingData",3,null),a=Ie(e,"hasScanData",3,!1),i=Ie(e,"engineReady",3,!1),o=Ie(e,"isScanning",3,!1);function c(_){return _.split("_").map(w=>w.charAt(0)+w.slice(1).toLowerCase()).join(" ")}let d=vt(()=>i()&&!a()&&!o()),v=vt(()=>r()&&r().total>0||b(d)||o());var h=Oa(),y=gt(h);{var x=_=>{var w=mp(),M=k(w);{var q=G=>{var U=pp();K(G,U)},S=G=>{var U=vp();U.__click=function(...X){var $;($=e.onscan)==null||$.apply(this,X)},K(G,U)};Te(M,G=>{o()?G(q):b(d)&&G(S,1)})}var F=D(M,2);{var ne=G=>{var U=Oa(),X=gt(U);Ut(X,16,()=>r().order,$=>$,($,Y)=>{const ge=vt(()=>r().groups[Y]),Le=vt(()=>zo(Y));var we=gp();we.__click=()=>{var ue;return(ue=e.ontogglegroup)==null?void 0:ue.call(e,Y)};var ve=k(we);let se;var re=D(ve,2),qe=k(re),ie=D(re,2),le=k(ie);ye(ue=>{se=$t(ve,"",se,{background:b(Le)}),ae(qe,ue),ae(le,b(ge).length)},[()=>c(Y)]),K($,we)}),K(G,U)};Te(F,G=>{r()&&r().total>0&&G(ne)})}K(_,w)};Te(y,_=>{b(v)&&_(x)})}K(t,h),dt()}Bt(["click"]);var bp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),_p=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),wp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),kp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),xp=H('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Sp=H('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Tp=H('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Ep(t,e){ft(e,!0),Mt(()=>fn("GpuPanel"));var r=Tp(),a=k(r),i=D(k(a),2),o=D(k(i),2),c=k(o),d=D(i,2),v=D(k(d),2),h=k(v),y=D(d,2);{var x=U=>{var X=bp(),$=D(k(X),2),Y=k($);ye(()=>ae(Y,e.gpuInfo.device)),K(U,X)};Te(y,U=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&U(x)})}var _=D(y,2);{var w=U=>{var X=_p(),$=D(k(X),2),Y=k($);ye(ge=>ae(Y,ge),[()=>co(e.gpuInfo.limits.maxBufferSize)]),K(U,X)};Te(_,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxBufferSize&&U(w)})}var M=D(_,2);{var q=U=>{var X=wp(),$=D(k(X),2),Y=k($);ye(()=>ae(Y,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),K(U,X)};Te(M,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeInvocationsPerWorkgroup&&U(q)})}var S=D(M,2);{var F=U=>{var X=kp(),$=D(k(X),2),Y=k($);ye(ge=>ae(Y,ge),[()=>co(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),K(U,X)};Te(S,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeWorkgroupStorageSize&&U(F)})}var ne=D(S,2);{var G=U=>{var X=Sp(),$=k(X),Y=k($),ge=D($,2);Ut(ge,21,()=>e.gpuInfo.features,pr,(Le,we)=>{var ve=xp(),se=k(ve);ye(()=>ae(se,b(we))),K(Le,ve)}),ye(()=>ae(Y,`Features (${e.gpuInfo.features.length??""})`)),K(U,X)};Te(ne,U=>{var X;(X=e.gpuInfo.features)!=null&&X.length&&U(G)})}ye(()=>{ae(c,e.gpuInfo.vendor),ae(h,e.gpuInfo.architecture)}),K(t,r),dt()}var Ap=H('<button class="gpu-badge svelte-1ktw27c"> </button>'),Cp=H('<span class="stats svelte-1ktw27c"> </span>'),Ip=H('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Rp=H('<span class="stats preparing svelte-1ktw27c"> </span>'),Pp=H('<span class="stats svelte-1ktw27c"> </span>'),Op=H('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Dp=H('<button class="btn svelte-1ktw27c">Stop</button>'),Mp=H('<button class="btn primary svelte-1ktw27c">Send</button>'),Lp=H('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Np(t,e){ft(e,!0),Mt(()=>fn("ChatView"));let r=Ie(e,"messages",19,()=>[]),a=Ie(e,"pendingData",3,null),i=Ie(e,"hasScanData",3,!1),o=Ie(e,"engineReady",3,!1),c=Ie(e,"isScanning",3,!1),d=Ie(e,"isRunning",3,!1),v=Ie(e,"tps",3,null),h=Ie(e,"numTokens",3,null),y=Ie(e,"generationPhase",3,null),x=Ie(e,"gpuInfo",3,null),_=Ie(e,"chatContainer",15),w=Oe(""),M=Oe(!1),q=Oe(null);function S(pe){pe.key==="Enter"&&!pe.shiftKey&&(pe.preventDefault(),F())}function F(){const pe=b(w).trim();!pe||d()||(B(w,""),e.onsend(pe))}function ne(pe){b(q)&&b(q).toggleGroup(pe)}function G(pe){pe&&!d()&&e.onsend(pe)}var U=Lp(),X=k(U),$=k(X);{var Y=pe=>{var J=Ap();J.__click=()=>B(M,!b(M));var Ne=k(J);ye(()=>ae(Ne,`WebGPU ${b(M)?"â²":"â¼"}`)),K(pe,J)};Te($,pe=>{x()&&pe(Y)})}var ge=D($,2);{var Le=pe=>{var J=Cp(),Ne=k(J);ye((Fe,be)=>ae(Ne,`${h()??""} tokens in ${Fe??""}s
        (${be??""} tok/s)`),[()=>(h()/v()).toFixed(1),()=>v().toFixed(1)]),K(pe,J)},we=pe=>{var J=Ip();K(pe,J)},ve=pe=>{var J=Rp(),Ne=k(J);ye(Fe=>ae(Ne,`thinking... ${Fe??""}`),[()=>v()?`${v().toFixed(0)} tok/s`:""]),K(pe,J)},se=pe=>{var J=Pp(),Ne=k(J);ye(Fe=>ae(Ne,`${Fe??""} tok/s`),[()=>v().toFixed(1)]),K(pe,J)};Te(ge,pe=>{v()&&!d()?pe(Le):d()&&y()==="preparing"?pe(we,1):d()&&y()==="thinking"?pe(ve,2):v()&&d()&&pe(se,3)})}var re=D(ge,4);re.__click=function(...pe){var J;(J=e.onreset)==null||J.apply(this,pe)};var qe=D(X,2);{var ie=pe=>{Ep(pe,{get gpuInfo(){return x()}})};Te(qe,pe=>{b(M)&&x()&&pe(ie)})}var le=D(qe,2),ue=k(le);{var Q=pe=>{var J=Op();K(pe,J)};Te(ue,pe=>{r().length===0&&!(a()&&a().total>0)&&pe(Q)})}var te=D(ue,2);Ut(te,17,r,pr,(pe,J,Ne)=>{var Fe=Oa(),be=gt(Fe);{var lt=ut=>{lo(hp(ut,{get pendingData(){return b(J).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:G}),en=>B(q,en,!0),()=>b(q))},Ke=ut=>{{let en=vt(()=>Ne===r().length-1);np(ut,{get msg(){return b(J)},get isLast(){return b(en)},get isRunning(){return d()},get generationPhase(){return y()},get numTokens(){return h()}})}};Te(be,ut=>{b(J).type==="dashboard"?ut(lt):ut(Ke,!1)})}K(pe,Fe)}),lo(le,pe=>_(pe),()=>_());var ee=D(le,2);yp(ee,{get pendingData(){return a()},get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return c()},ontogglegroup:ne,get onscan(){return e.onscan}});var he=D(ee,2),Z=k(he);Z.__keydown=S;var fe=D(Z,2);{var Ae=pe=>{var J=Dp();J.__click=function(...Ne){var Fe;(Fe=e.onstop)==null||Fe.apply(this,Ne)},K(pe,J)},_e=pe=>{var J=Mp();J.__click=F,ye(Ne=>J.disabled=Ne,[()=>!b(w).trim()]),K(pe,J)};Te(fe,pe=>{d()?pe(Ae):pe(_e,!1)})}ye(()=>{re.disabled=d(),Z.disabled=d()}),No(Z,()=>b(w),pe=>B(w,pe)),K(t,U),dt()}Bt(["click","keydown"]);var qp=H('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function jp(t,e){ft(e,!0);const r=!!navigator.gpu,a=uc();let i=Oe(Rt(localStorage.getItem("selectedModel")||ls[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),v=Oe(Rt([])),h=Oe(Rt([])),y=Oe(!1),x=Oe(null),_=Oe(null),w=Oe(null),M=Oe(null),q=Oe(null),S=Oe(null),F=Oe(!1),ne=Oe(!1),G=!1;Mt(()=>{a.check(),a.isReady&&U();const Z=a.onMessage(fe=>{switch(fe.status){case"webgpu-info":B(M,fe.data,!0);break;case"loading":B(o,"loading"),B(d,fe.data,!0);break;case"initiate":B(v,[...b(v),fe],!0);break;case"progress":B(v,b(v).map(Ae=>Ae.file===fe.file?{...Ae,...fe}:Ae),!0);break;case"done":B(v,b(v).filter(Ae=>Ae.file!==fe.file),!0);break;case"ready":B(o,"ready"),U();break;case"start":if(!b(y))break;B(q,fe.phase||"preparing",!0),B(h,[...b(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!b(y))break;B(q,fe.phase,!0);break;case"thinking":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(h)[b(h).length-1];B(h,[...b(h).slice(0,-1),{...Ae,thinking:(Ae.thinking||"")+fe.content}],!0),ve();break}case"thinking-done":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(h)[b(h).length-1];B(h,[...b(h).slice(0,-1),{...Ae,thinking:fe.content}],!0);break}case"update":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(h)[b(h).length-1];B(h,[...b(h).slice(0,-1),{...Ae,content:Ae.content+fe.output}],!0),ve();break}case"complete":if(!b(y))break;B(y,!1),B(q,null),X();break;case"error":if(!b(y))break;B(c,fe.data,!0),B(y,!1),B(q,null);break}});return()=>Z()});async function U(){if(!(G||b(h).length>0))try{const Z=await fo();B(S,Z,!0),Z&&(G=!0,B(h,[{role:"assistant",type:"dashboard",pendingData:Z}],!0),ve());const fe=await ho();B(F,fe.classified>0)}catch{}}async function X(){try{const Z=await fo();B(S,Z,!0);const fe=b(h).findIndex(_e=>_e.type==="dashboard");fe!==-1&&(Z&&Z.total>0?B(h,b(h).map((_e,pe)=>pe===fe?{..._e,pendingData:Z}:_e),!0):B(h,b(h).filter((_e,pe)=>pe!==fe),!0));const Ae=await ho();B(F,Ae.classified>0)}catch{}}async function $(Z){await ti(Z,"acted"),await X()}async function Y(Z){await ti(Z,"dismissed"),await X()}async function ge(Z){await Sc(Z),await X()}async function Le(Z){await xc(Z),await X()}async function we(){if(!(b(ne)||!a.isReady)){B(ne,!0);try{await kc(a,{count:20}),await X(),b(S)&&!b(h).some(Z=>Z.type==="dashboard")&&(B(h,[{role:"assistant",type:"dashboard",pendingData:b(S)},...b(h)],!0),ve())}catch(Z){console.error("Scan failed:",Z)}finally{B(ne,!1)}}}function ve(){rc().then(()=>{b(w)&&(b(w).scrollTop=b(w).scrollHeight)})}function se(){B(o,"loading"),localStorage.setItem("selectedModel",b(i)),a.loadModel(b(i))}async function re(Z){if(!Z||b(y))return;B(h,[...b(h),{role:"user",content:Z}],!0),B(x,null),B(y,!0);let fe=[];try{const _e=await yh(),pe=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i;let J;pe.test(Z)||_e?(J=await mh(Z),_e&&(J=(J||"")+`

`+_e)):J=await gh(),J&&(fe=[{role:"system",content:J}])}catch{}const Ae=b(h).filter(_e=>_e.type!=="dashboard").map(_e=>({role:_e.role,content:_e.content}));a.generate([...fe,...Ae]),ve()}function qe(){a.interrupt()}function ie(){a.reset(),B(h,[],!0),B(x,null),B(_,null),G=!1,U()}var le=Oa(),ue=gt(le);{var Q=Z=>{var fe=qp();K(Z,fe)},te=Z=>{qh(Z,{get gpuInfo(){return b(M)},get error(){return b(c)},onload:se,get selectedModel(){return b(i)},set selectedModel(fe){B(i,fe,!0)}})},ee=Z=>{Hh(Z,{get message(){return b(d)},get items(){return b(v)}})},he=Z=>{Np(Z,{get messages(){return b(h)},get pendingData(){return b(S)},get hasScanData(){return b(F)},get engineReady(){return a.isReady},get isScanning(){return b(ne)},get isRunning(){return b(y)},get tps(){return b(x)},get numTokens(){return b(_)},get generationPhase(){return b(q)},get gpuInfo(){return b(M)},onsend:re,onstop:qe,onreset:ie,onmarkacted:$,ondismiss:Y,onremove:ge,oncleargroup:Le,onscan:we,get chatContainer(){return b(w)},set chatContainer(fe){B(w,fe,!0)}})};Te(ue,Z=>{r?b(o)===null?Z(te,1):b(o)==="loading"?Z(ee,2):Z(he,!1):Z(Q)})}K(t,le),dt()}const Gl="https://accounts.google.com/gsi/client",Bp="https://www.googleapis.com/auth/gmail.readonly";let po=null,Xs=null;function zp(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Gl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Gl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Hl(t){await zp(),po=google.accounts.oauth2.initTokenClient({client_id:t,scope:Bp,callback:e=>{Xs&&(Xs(e),Xs=null)}})}function Fp(){return new Promise((t,e)=>{if(!po){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Xs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},po.requestAccessToken()})}function Kp(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Pt="gmail",Wl=8,Ec=50,Ac=100;async function Up(t,{limit:e=Ec,onProgress:r=()=>{},signal:a}={}){var c;const i=await je.syncState.get(Pt);if(i!=null&&i.historyId)try{return await Qp(t,i,r,a)}catch(d){if(d instanceof qo&&(d.status===404||d.code==="notFound")||((c=d.message)==null?void 0:c.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await je.syncState.delete(Pt);else throw d}return await Yp(t,e===0?1/0:e,r,a)}async function Gp(t,{limit:e=Ec,onProgress:r=()=>{},signal:a}={}){const i=await je.syncState.get(Pt);return i!=null&&i.oldestPageToken?await Vp(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Hp(){const t=await je.syncState.get(Pt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Wp(){await je.transaction("rw",[je.items,je.syncState],async()=>{await je.items.where("sourceType").equals(Pt).delete(),await je.syncState.delete(Pt)})}async function Yp(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),la(a);const i=await hc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){la(a);const x=e-o.length,_=await pc(t,{maxResults:Math.min(Ac,x),pageToken:c}),w=(_.messages||[]).map(M=>M.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=_.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await je.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await Cc(t,o,r,a),y=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function Vp(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),la(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){la(i);const x=r-o.length,_=await pc(t,{maxResults:Math.min(Ac,x),pageToken:c}),w=(_.messages||[]).map(M=>M.id);if(o.push(...w),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=_.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await je.syncState.update(Pt,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await Cc(t,o,a,i),y=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.update(Pt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:h}}async function Qp(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),la(a);let i=0,o=0,c=0,d,v=e.historyId;do{la(a);const y=await rh(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const x of y.history){if(x.messagesAdded){const _=x.messagesAdded.map(M=>M.message.id),w=[...new Set(_.filter(M=>M))];if(w.length>0){const M=await Promise.allSettled(w.map(S=>vc(t,S))),q=[];for(const S of M)S.status==="fulfilled"?q.push(Ic(S.value)):c++;q.length>0&&(await je.items.bulkPut(q),await Rc(q),i+=q.length)}}if(x.messagesDeleted){const _=x.messagesDeleted.map(w=>cc(Pt,w.message.id)).filter(w=>w);_.length>0&&(await je.items.bulkDelete(_),o+=_.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const h=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.put({sourceType:Pt,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:h,total:h}),{added:i,deleted:o,errors:c}}async function Cc(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Wl){la(a);const d=e.slice(c,c+Wl),v=await Promise.allSettled(d.map(y=>vc(t,y))),h=[];for(const y of v)y.status==="fulfilled"?h.push(Ic(y.value)):o++;h.length>0&&(await je.items.bulkPut(h),await Rc(h)),i+=h.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Ic(t){const e=Sr(t,"From"),r=Sr(t,"To"),a=Sr(t,"Cc"),i=Sr(t,"Subject")||"(no subject)",o=Sr(t,"Date"),c=Sr(t,"Message-ID"),d=Sr(t,"In-Reply-To"),v=Sr(t,"References");let h;try{h=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:cc(Pt,t.id),sourceType:Pt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:ah(t),htmlBody:sh(t),date:h,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Rc(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Xp(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await je.contacts.where("email").equals(r).first();if(o){const c={};a&&!o.name&&(c.name=a),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await je.contacts.update(o.id,c)}else await je.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Xp(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function la(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Zp=H(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Jp(t,e){ft(e,!0);let r=Ie(e,"clientIdInput",15);Mt(()=>fn("SetupGuide"));let a=Oe(null);async function i(Ae){try{await navigator.clipboard.writeText(Ae),B(a,Ae,!0),setTimeout(()=>{B(a,null)},1500)}catch{const _e=document.createElement("input");_e.value=Ae,document.body.appendChild(_e),_e.select(),document.execCommand("copy"),document.body.removeChild(_e),B(a,Ae,!0),setTimeout(()=>{B(a,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Zp(),h=k(v),y=D(k(h),4),x=D(k(y),6),_=D(k(x),2),w=D(k(_),2),M=D(k(w),2),q=k(M);q.__click=()=>i(o);var S=k(q);S.textContent="http://localhost:5173";var F=D(S,2),ne=k(F),G=D(q,2);G.__click=()=>i(c);var U=k(G);U.textContent="https://cypherkitty.github.io";var X=D(U,2),$=k(X),Y=D(w,2),ge=D(k(Y),2),Le=k(ge);Le.__click=()=>i(o);var we=k(Le);we.textContent="http://localhost:5173";var ve=D(we,2),se=k(ve),re=D(Le,2);re.__click=()=>i(c);var qe=k(re);qe.textContent="https://cypherkitty.github.io";var ie=D(qe,2),le=k(ie),ue=D(re,2);ue.__click=()=>i(d);var Q=k(ue);Q.textContent="https://cypherkitty.github.io/me-ai/";var te=D(Q,2),ee=k(te),he=D(y,2),Z=k(he);Z.__keydown=Ae=>Ae.key==="Enter"&&e.onsave();var fe=D(Z,2);fe.__click=function(...Ae){var _e;(_e=e.onsave)==null||_e.apply(this,Ae)},ye(Ae=>{ae(ne,b(a)===o?"â":"â§"),ae($,b(a)===c?"â":"â§"),ae(se,b(a)===o?"â":"â§"),ae(le,b(a)===c?"â":"â§"),ae(ee,b(a)===d?"â":"â§"),fe.disabled=Ae},[()=>!r().trim()]),No(Z,r),K(t,v),dt()}Bt(["click","keydown"]);function $p(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof qo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var ev=H('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),tv=H('<div class="error-card-title svelte-14buhqq"> </div>'),nv=H('<p class="error-card-fix svelte-14buhqq"> </p>'),rv=H('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),av=H('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),sv=H('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Pc(t,e){ft(e,!0);let r=Ie(e,"ondismiss",3,null),a=Ie(e,"onsignout",3,null),i=vt(()=>$p(e.error));Mt(()=>fn("ErrorCard"));var o=sv(),c=k(o);{var d=F=>{var ne=ev(),G=k(ne),U=k(G),X=D(G,2);X.__click=function(...$){var Y;(Y=r())==null||Y.apply(this,$)},ye(()=>ae(U,b(i).title)),K(F,ne)},v=F=>{var ne=tv(),G=k(ne);ye(()=>ae(G,b(i).title)),K(F,ne)};Te(c,F=>{r()?F(d):F(v,!1)})}var h=D(c,2),y=k(h),x=D(h,2);{var _=F=>{var ne=nv(),G=k(ne);ye(()=>ae(G,b(i).fix)),K(F,ne)};Te(x,F=>{b(i).fix&&F(_)})}var w=D(x,2);{var M=F=>{var ne=rv(),G=k(ne);ye(()=>{lc(ne,"href",b(i).link.url),ae(G,`${b(i).link.label??""} â`)}),K(F,ne)};Te(w,F=>{b(i).link&&F(M)})}var q=D(w,2);{var S=F=>{var ne=av();ne.__click=function(...G){var U;(U=a())==null||U.apply(this,G)},K(F,ne)};Te(q,F=>{b(i).action==="signout"&&a()&&F(S)})}ye(()=>ae(y,b(i).description)),K(t,o),dt()}Bt(["click"]);var iv=H('<span class="spinner svelte-nyqevv"></span> Signing in...',1),ov=Mo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),lv=H(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function uv(t,e){ft(e,!0);let r=Ie(e,"error",3,null),a=Ie(e,"loadingAuth",3,!1);Mt(()=>fn("AuthCard"));var i=lv(),o=k(i),c=D(k(o),4);{var d=S=>{Pc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};Te(c,S=>{r()&&S(d)})}var v=D(c,2);v.__click=function(...S){var F;(F=e.onsignin)==null||F.apply(this,S)};var h=k(v);{var y=S=>{var F=iv();K(S,F)},x=S=>{var F=ov();K(S,F)};Te(h,S=>{a()?S(y):S(x,!1)})}var _=D(v,2),w=D(k(_),2),M=k(w),q=D(w,2);q.__click=function(...S){var F;(F=e.onclear)==null||F.apply(this,S)},ye(S=>{v.disabled=a(),ae(M,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),K(t,i),dt()}Bt(["click"]);var cv=H('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),fv=H('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),dv=H('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function hv(t,e){ft(e,!0);let r=Ie(e,"profile",3,null),a=Ie(e,"loadingProfile",3,!1);Mt(()=>fn("ProfileCard"));var i=dv(),o=k(i),c=k(o),d=D(o,2),v=k(d);{var h=_=>{var w=cv();K(_,w)},y=_=>{var w=fv(),M=gt(w),q=k(M),S=D(M,2),F=k(S);ye((ne,G)=>{ae(q,r().emailAddress),ae(F,`${ne??""} messages
        Â· ${G??""} threads`)},[()=>{var ne;return((ne=r().messagesTotal)==null?void 0:ne.toLocaleString())||"?"},()=>{var ne;return((ne=r().threadsTotal)==null?void 0:ne.toLocaleString())||"?"}]),K(_,w)};Te(v,_=>{a()?_(h):r()&&_(y,1)})}var x=D(d,2);x.__click=function(..._){var w;(w=e.onsignout)==null||w.apply(this,_)},ye(_=>ae(c,_),[()=>r()?gc(r().emailAddress):"?"]),K(t,i),dt()}Bt(["click"]);var pv=H('<span class="spinner svelte-1ds3j4k"></span>'),vv=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),gv=H('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),mv=H('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),yv=H('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),bv=H('<option class="svelte-1ds3j4k"> </option>'),_v=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),wv=H('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),kv=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),xv=H('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Sv=H('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Tv=H('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Ev(t,e){ft(e,!0),Mt(()=>fn("SyncStatus"));let r=Ie(e,"syncStatus",3,null),a=Ie(e,"syncProgress",3,null),i=Ie(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(Q){if(!Q)return"never";const te=Math.floor((Date.now()-Q)/1e3);if(te<60)return"just now";const ee=Math.floor(te/60);if(ee<60)return`${ee}m ago`;const he=Math.floor(ee/60);return he<24?`${he}h ago`:`${Math.floor(he/24)}d ago`}function h(){var Q,te;return!((Q=a())!=null&&Q.total)||!((te=a())!=null&&te.current)?0:Math.round(a().current/a().total*100)}var y=Tv(),x=k(y),_=k(x),w=k(_);{var M=Q=>{var te=pv();K(Q,te)},q=Q=>{var te=vv();K(Q,te)};Te(w,Q=>{i()?Q(M):Q(q,!1)})}var S=D(_,2),F=D(k(S),2);{var ne=Q=>{var te=gv(),ee=k(te),he=D(ee);{var Z=Ae=>{var _e=Ll("Â· more available");K(Ae,_e)},fe=Ae=>{var _e=Ll("Â· all synced");K(Ae,_e)};Te(he,Ae=>{r().hasMore?Ae(Z):Ae(fe,!1)})}ye((Ae,_e)=>ae(ee,`${Ae??""} emails stored
          Â· synced ${_e??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),K(Q,te)},G=Q=>{var te=mv();K(Q,te)};Te(F,Q=>{var te;(te=r())!=null&&te.synced?Q(ne):Q(G,!1)})}var U=D(S,2),X=k(U);{var $=Q=>{var te=yv();te.__click=()=>B(o,!b(o)),K(Q,te)};Te(X,Q=>{var te;(te=r())!=null&&te.synced&&!i()&&Q($)})}var Y=D(x,2),ge=k(Y),Le=D(k(ge),2);Ut(Le,21,()=>d,pr,(Q,te)=>{var ee=bv(),he=k(ee),Z={};ye(()=>{ae(he,b(te).label),Z!==(Z=b(te).value)&&(ee.value=(ee.__value=b(te).value)??"")}),K(Q,ee)});var we=D(ge,2),ve=k(we);{var se=Q=>{var te=wv(),ee=gt(te);ee.__click=()=>e.onsync(b(c));var he=k(ee),Z=D(ee,2);{var fe=Ae=>{var _e=_v();_e.__click=()=>e.onsyncmore(b(c));var pe=k(_e);ye(()=>{_e.disabled=i(),ae(pe,i()?"Loading...":"Sync More")}),K(Ae,_e)};Te(Z,Ae=>{r().hasMore&&Ae(fe)})}ye(()=>{ee.disabled=i(),ae(he,i()?"Syncing...":"Sync New")}),K(Q,te)},re=Q=>{var te=kv();te.__click=()=>e.onsync(b(c));var ee=k(te);ye(()=>{te.disabled=i(),ae(ee,i()?"Syncing...":"Download Emails")}),K(Q,te)};Te(ve,Q=>{var te;(te=r())!=null&&te.synced?Q(se):Q(re,!1)})}var qe=D(Y,2);{var ie=Q=>{var te=xv(),ee=k(te),he=k(ee);let Z,fe;var Ae=D(ee,2),_e=k(Ae);ye(pe=>{Z=Zt(he,1,"progress-fill svelte-1ds3j4k",null,Z,{indeterminate:!a().total}),fe=$t(he,"",fe,pe),ae(_e,a().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),K(Q,te)};Te(qe,Q=>{i()&&a()&&Q(ie)})}var le=D(qe,2);{var ue=Q=>{var te=Sv(),ee=D(k(te),2),he=k(ee);he.__click=()=>B(o,!1);var Z=D(he,2);Z.__click=()=>{e.onclear(),B(o,!1)},K(Q,te)};Te(le,Q=>{b(o)&&Q(ue)})}ye(()=>Le.disabled=i()),Lo(Le,()=>b(c),Q=>B(c,Q)),K(t,y),dt()}Bt(["click"]);var Av=H('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Cv=H('<div class="message-list svelte-y2uamw"></div>');function Iv(t,e){ft(e,!0);let r=Ie(e,"messages",19,()=>[]);Mt(()=>fn("MessageList"));var a=Cv();Ut(a,21,r,pr,(i,o)=>{var c=Av();c.__click=()=>e.onselect(b(o));var d=k(c),v=k(d),h=D(d,2),y=k(h),x=k(y),_=k(x),w=D(x,2),M=k(w),q=D(y,2),S=k(q),F=D(q,2),ne=k(F);ye((G,U,X)=>{ae(v,G),ae(_,U),ae(M,X),ae(S,b(o).subject),ae(ne,b(o).snippet)},[()=>gc(b(o).from),()=>Bo(b(o).from),()=>jo(b(o).date)]),K(i,c)}),K(t,a),dt()}Bt(["click"]);function Fo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var fa=Fo();function Oc(t){fa=t}var Wr={exec:()=>null};function Je(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Kt.caret,"$1"),r=r.replace(i,c),a},getRegex:()=>new RegExp(r,e)};return a}var Rv=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Kt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Pv=/^(?:[ \t]*(?:\n|$))+/,Ov=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Dv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ms=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Mv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ko=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Dc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Mc=Je(Dc).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Lv=Je(Dc).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Uo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Nv=/^[^\n]+/,Go=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,qv=Je(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Go).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),jv=Je(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ko).getRegex(),di="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ho=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Bv=Je("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ho).replace("tag",di).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Lc=Je(Uo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),zv=Je(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Lc).getRegex(),Wo={blockquote:zv,code:Ov,def:qv,fences:Dv,heading:Mv,hr:ms,html:Bv,lheading:Mc,list:jv,newline:Pv,paragraph:Lc,table:Wr,text:Nv},Yl=Je("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),Fv={...Wo,lheading:Lv,table:Yl,paragraph:Je(Uo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Yl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex()},Kv={...Wo,html:Je(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ho).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Je(Uo).replace("hr",ms).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Mc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Uv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Gv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Nc=/^( {2,}|\\)\n(?!\s*$)/,Hv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,hi=/[\p{P}\p{S}]/u,Yo=/[\s\p{P}\p{S}]/u,qc=/[^\s\p{P}\p{S}]/u,Wv=Je(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Yo).getRegex(),jc=/(?!~)[\p{P}\p{S}]/u,Yv=/(?!~)[\s\p{P}\p{S}]/u,Vv=/(?:[^\s\p{P}\p{S}]|~)/u,Bc=/(?![*_])[\p{P}\p{S}]/u,Qv=/(?![*_])[\s\p{P}\p{S}]/u,Xv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Zv=Je(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Rv?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),zc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Jv=Je(zc,"u").replace(/punct/g,hi).getRegex(),$v=Je(zc,"u").replace(/punct/g,jc).getRegex(),Fc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",eg=Je(Fc,"gu").replace(/notPunctSpace/g,qc).replace(/punctSpace/g,Yo).replace(/punct/g,hi).getRegex(),tg=Je(Fc,"gu").replace(/notPunctSpace/g,Vv).replace(/punctSpace/g,Yv).replace(/punct/g,jc).getRegex(),ng=Je("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,qc).replace(/punctSpace/g,Yo).replace(/punct/g,hi).getRegex(),rg=Je(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Bc).getRegex(),ag="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",sg=Je(ag,"gu").replace(/notPunctSpace/g,Xv).replace(/punctSpace/g,Qv).replace(/punct/g,Bc).getRegex(),ig=Je(/\\(punct)/,"gu").replace(/punct/g,hi).getRegex(),og=Je(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),lg=Je(Ho).replace("(?:-->|$)","-->").getRegex(),ug=Je("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",lg).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,cg=Je(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Kc=Je(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",Go).getRegex(),Uc=Je(/^!?\[(ref)\](?:\[\])?/).replace("ref",Go).getRegex(),fg=Je("reflink|nolink(?!\\()","g").replace("reflink",Kc).replace("nolink",Uc).getRegex(),Vl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Vo={_backpedal:Wr,anyPunctuation:ig,autolink:og,blockSkip:Zv,br:Nc,code:Gv,del:Wr,delLDelim:Wr,delRDelim:Wr,emStrongLDelim:Jv,emStrongRDelimAst:eg,emStrongRDelimUnd:ng,escape:Uv,link:cg,nolink:Uc,punctuation:Wv,reflink:Kc,reflinkSearch:fg,tag:ug,text:Hv,url:Wr},dg={...Vo,link:Je(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:Je(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},vo={...Vo,emStrongRDelimAst:tg,emStrongLDelim:$v,delLDelim:rg,delRDelim:sg,url:Je(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Vl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Je(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Vl).getRegex()},hg={...vo,br:Je(Nc).replace("{2,}","*").getRegex(),text:Je(vo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Fs={normal:Wo,gfm:Fv,pedantic:Kv},Ya={normal:Vo,gfm:vo,breaks:hg,pedantic:dg},pg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ql=t=>pg[t];function ar(t,e){if(e){if(Kt.escapeTest.test(t))return t.replace(Kt.escapeReplace,Ql)}else if(Kt.escapeTestNoEncode.test(t))return t.replace(Kt.escapeReplaceNoEncode,Ql);return t}function Xl(t){try{t=encodeURI(t).replace(Kt.percentDecode,"%")}catch{return null}return t}function Zl(t,e){var o;let r=t.replace(Kt.findPipe,(c,d,v)=>{let h=!1,y=d;for(;--y>=0&&v[y]==="\\";)h=!h;return h?"|":" |"}),a=r.split(Kt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Kt.slashPipe,"|");return a}function Va(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function vg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function gg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function Jl(t,e,r,a,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function mg(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ri=class{constructor(t){Ye(this,"options");Ye(this,"rules");Ye(this,"lexer");this.options=t||fa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Va(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=mg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Va(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Va(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Va(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),y=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${h}`:h,i=i?`${i}
${y}`:y;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=x,r.length===0)break;let _=o.at(-1);if((_==null?void 0:_.type)==="code")break;if((_==null?void 0:_.type)==="blockquote"){let w=_,M=w.raw+`
`+r.join(`
`),q=this.blockquote(M);o[o.length-1]=q,a=a.substring(0,a.length-w.raw.length)+q.raw,i=i.substring(0,i.length-w.text.length)+q.text;break}else if((_==null?void 0:_.type)==="list"){let w=_,M=w.raw+`
`+r.join(`
`),q=this.list(M);o[o.length-1]=q,a=a.substring(0,a.length-_.raw.length)+q.raw,i=i.substring(0,i.length-w.raw.length)+q.raw,r=M.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,x="",_="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let w=gg(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],q=!w.trim(),S=0;if(this.options.pedantic?(S=2,_=w.trimStart()):q?S=e[1].length+1:(S=w.search(this.rules.other.nonSpaceChar),S=S>4?1:S,_=w.slice(S),S+=e[1].length),q&&this.rules.other.blankLine.test(M)&&(x+=M+`
`,t=t.substring(M.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(S),ne=this.rules.other.hrRegex(S),G=this.rules.other.fencesBeginRegex(S),U=this.rules.other.headingBeginRegex(S),X=this.rules.other.htmlBeginRegex(S),$=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Y=t.split(`
`,1)[0],ge;if(M=Y,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),ge=M):ge=M.replace(this.rules.other.tabCharGlobal,"    "),G.test(M)||U.test(M)||X.test(M)||$.test(M)||F.test(M)||ne.test(M))break;if(ge.search(this.rules.other.nonSpaceChar)>=S||!M.trim())_+=`
`+ge.slice(S);else{if(q||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||G.test(w)||U.test(w)||ne.test(w))break;_+=`
`+M}q=!M.trim(),x+=Y+`
`,t=t.substring(Y.length+1),w=ge.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(v=!0)),c.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(_),loose:!1,text:_,tokens:[]}),c.raw+=x}let h=c.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let _=this.lexer.inlineQueue.length-1;_>=0;_--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[_].src)){this.lexer.inlineQueue[_].src=this.lexer.inlineQueue[_].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(y.raw);if(x){let _={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};y.checked=_.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=_.raw+y.tokens[0].raw,y.tokens[0].text=_.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(_)):y.tokens.unshift({type:"paragraph",raw:_.raw,text:_.raw,tokens:[_]}):y.tokens.unshift(_)}}if(!c.loose){let x=y.tokens.filter(w=>w.type==="space"),_=x.length>0&&x.some(w=>this.rules.other.anyLine.test(w.raw));c.loose=_}}if(c.loose)for(let y of c.items){y.loose=!0;for(let x of y.tokens)x.type==="text"&&(x.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Zl(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Zl(d,o.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[h]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Va(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=vg(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Jl(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Jl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=0,h=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(c=[...o].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let y=[...a[0]][0].length,x=t.slice(0,i+a.index+y+c);if(Math.min(i,c)%2){let w=x.slice(1,-1);return{type:"em",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}let _=x.slice(2,-2);return{type:"strong",raw:x,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(c=[...o].length,c!==i))continue;if(a[3]||a[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let h=[...a[0]][0].length,y=t.slice(0,i+a.index+h+c),x=y.slice(i,-i);return{type:"del",raw:y,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Mn=class go{constructor(e){Ye(this,"tokens");Ye(this,"options");Ye(this,"state");Ye(this,"inlineQueue");Ye(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||fa,this.options.tokenizer=this.options.tokenizer||new ri,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Kt,block:Fs.normal,inline:Ya.normal};this.options.pedantic?(r.block=Fs.pedantic,r.inline=Ya.pedantic):this.options.gfm&&(r.block=Fs.gfm,this.options.breaks?r.inline=Ya.breaks:r.inline=Ya.gfm),this.tokenizer.rules=r}static get rules(){return{block:Fs,inline:Ya}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace(Kt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Kt.tabCharGlobal,"    ").replace(Kt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let h=1/0,y=e.slice(1),x;this.options.extensions.startBlock.forEach(_=>{x=_.call({lexer:this},y),typeof x=="number"&&x>=0&&(h=Math.min(h,x))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);a&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,y,x,_;let a=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},a))??a;let c=!1,d="";for(;e;){c||(d=""),c=!1;let w;if((x=(y=this.options.extensions)==null?void 0:y.inline)!=null&&x.some(q=>(w=q.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let q=r.at(-1);w.type==="text"&&(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let M=e;if((_=this.options.extensions)!=null&&_.startInline){let q=1/0,S=e.slice(1),F;this.options.extensions.startInline.forEach(ne=>{F=ne.call({lexer:this},S),typeof F=="number"&&F>=0&&(q=Math.min(q,F))}),q<1/0&&q>=0&&(M=e.substring(0,q+1))}if(w=this.tokenizer.inlineText(M)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),c=!0;let q=r.at(-1);(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(e){let q="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(q);break}else throw new Error(q)}}return r}},ai=class{constructor(t){Ye(this,"options");Ye(this,"parser");this.options=t||fa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Kt.notSpaceStart))==null?void 0:o[0],i=t.replace(Kt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ar(a)+'">'+(r?i:ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let c=0;c<t.items.length;c++){let d=t.items[c];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Xl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ar(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Xl(t);if(i===null)return ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ar(t.text)}},Qo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Ln=class mo{constructor(e){Ye(this,"options");Ye(this,"renderer");Ye(this,"textRenderer");this.options=e||fa,this.options.renderer=this.options.renderer||new ai,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Qo}static parse(e,r){return new mo(r).parse(e)}static parseInline(e,r){return new mo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[c.type]){let v=c,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=h||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return a}},Gs,ts=(Gs=class{constructor(t){Ye(this,"options");Ye(this,"block");this.options=t||fa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Mn.lex:Mn.lexInline}provideParser(){return this.block?Ln.parse:Ln.parseInline}},Ye(Gs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ye(Gs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Gs),yg=class{constructor(...t){Ye(this,"defaults",Fo());Ye(this,"options",this.setOptions);Ye(this,"parse",this.parseMarkdown(!0));Ye(this,"parseInline",this.parseMarkdown(!1));Ye(this,"Parser",Ln);Ye(this,"Renderer",ai);Ye(this,"TextRenderer",Qo);Ye(this,"Lexer",Mn);Ye(this,"Tokenizer",ri);Ye(this,"Hooks",ts);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ai(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ri(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ts;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];ts.passThroughHooks.has(o)?i[c]=h=>{if(this.defaults.async&&ts.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,h);return v.call(i,x)})();let y=d.call(i,h);return v.call(i,y)}:i[c]=(...h)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,h);return x===!1&&(x=await v.apply(i,h)),x})();let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Mn.lex(t,e??this.defaults)}parser(t,e){return Ln.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let h=await(i.hooks?await i.hooks.provideParser():t?Ln.parse:Ln.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(h):h})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Ln.parse:Ln.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ua=new yg;function nt(t,e){return ua.parse(t,e)}nt.options=nt.setOptions=function(t){return ua.setOptions(t),nt.defaults=ua.defaults,Oc(nt.defaults),nt};nt.getDefaults=Fo;nt.defaults=fa;nt.use=function(...t){return ua.use(...t),nt.defaults=ua.defaults,Oc(nt.defaults),nt};nt.walkTokens=function(t,e){return ua.walkTokens(t,e)};nt.parseInline=ua.parseInline;nt.Parser=Ln;nt.parser=Ln.parse;nt.Renderer=ai;nt.TextRenderer=Qo;nt.Lexer=Mn;nt.lexer=Mn.lex;nt.Tokenizer=ri;nt.Hooks=ts;nt.parse=nt;nt.options;nt.setOptions;nt.use;nt.walkTokens;nt.parseInline;Ln.parse;Mn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Gc,setPrototypeOf:$l,isFrozen:bg,getPrototypeOf:_g,getOwnPropertyDescriptor:wg}=Object;let{freeze:Gt,seal:xn,create:yo}=Object,{apply:bo,construct:_o}=typeof Reflect<"u"&&Reflect;Gt||(Gt=function(e){return e});xn||(xn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});_o||(_o=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ks=Ht(Array.prototype.forEach),kg=Ht(Array.prototype.lastIndexOf),eu=Ht(Array.prototype.pop),Qa=Ht(Array.prototype.push),xg=Ht(Array.prototype.splice),Zs=Ht(String.prototype.toLowerCase),Hi=Ht(String.prototype.toString),Wi=Ht(String.prototype.match),Xa=Ht(String.prototype.replace),Sg=Ht(String.prototype.indexOf),Tg=Ht(String.prototype.trim),On=Ht(Object.prototype.hasOwnProperty),Ft=Ht(RegExp.prototype.test),Za=Eg(TypeError);function Ht(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function Eg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return _o(t,r)}}function We(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs;$l&&$l(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(bg(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Ag(t){for(let e=0;e<t.length;e++)On(t,e)||(t[e]=null);return t}function Wn(t){const e=yo(null);for(const[r,a]of Gc(t))On(t,r)&&(Array.isArray(a)?e[r]=Ag(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=Wn(a):e[r]=a);return e}function Ja(t,e){for(;t!==null;){const a=wg(t,e);if(a){if(a.get)return Ht(a.get);if(typeof a.value=="function")return Ht(a.value)}t=_g(t)}function r(){return null}return r}const tu=Gt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yi=Gt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Vi=Gt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Cg=Gt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Qi=Gt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ig=Gt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nu=Gt(["#text"]),ru=Gt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Xi=Gt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),au=Gt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Us=Gt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Rg=xn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Pg=xn(/<%[\w\W]*|[\w\W]*%>/gm),Og=xn(/\$\{[\w\W]*/gm),Dg=xn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Mg=xn(/^aria-[\-\w]+$/),Hc=xn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Lg=xn(/^(?:\w+script|data):/i),Ng=xn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Wc=xn(/^html$/i),qg=xn(/^[a-z][.\w]*(-[.\w]+)+$/i);var su=Object.freeze({__proto__:null,ARIA_ATTR:Mg,ATTR_WHITESPACE:Ng,CUSTOM_ELEMENT:qg,DATA_ATTR:Dg,DOCTYPE_NAME:Wc,ERB_EXPR:Pg,IS_ALLOWED_URI:Hc,IS_SCRIPT_OR_DATA:Lg,MUSTACHE_EXPR:Rg,TMPLIT_EXPR:Og});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},jg=function(){return typeof window>"u"?null:window},Bg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},iu=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Yc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jg();const e=Me=>Yc(Me);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:h,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:_,trustedTypes:w}=t,M=v.prototype,q=Ja(M,"cloneNode"),S=Ja(M,"remove"),F=Ja(M,"nextSibling"),ne=Ja(M,"childNodes"),G=Ja(M,"parentNode");if(typeof c=="function"){const Me=r.createElement("template");Me.content&&Me.content.ownerDocument&&(r=Me.content.ownerDocument)}let U,X="";const{implementation:$,createNodeIterator:Y,createDocumentFragment:ge,getElementsByTagName:Le}=r,{importNode:we}=a;let ve=iu();e.isSupported=typeof Gc=="function"&&typeof G=="function"&&$&&$.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:se,ERB_EXPR:re,TMPLIT_EXPR:qe,DATA_ATTR:ie,ARIA_ATTR:le,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:te}=su;let{IS_ALLOWED_URI:ee}=su,he=null;const Z=We({},[...tu,...Yi,...Vi,...Qi,...nu]);let fe=null;const Ae=We({},[...ru,...Xi,...au,...Us]);let _e=Object.seal(yo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),pe=null,J=null;const Ne=Object.seal(yo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Fe=!0,be=!0,lt=!1,Ke=!0,ut=!1,en=!0,At=!1,Or=!1,Dr=!1,Sn=!1,vr=!1,zn=!1,zt=!0,Mr=!1;const Fn="user-content-";let $n=!0,tn=!1,ze={},at=null;const nn=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rn=null;const Kn=We({},["audio","video","img","source","image","track"]);let Tn=null;const dn=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),En="http://www.w3.org/1998/Math/MathML",gr="http://www.w3.org/2000/svg",xt="http://www.w3.org/1999/xhtml";let De=xt,er=!1,An=null;const da=We({},[En,gr,xt],Hi);let Ee=We({},["mi","mo","mn","ms","mtext"]),mr=We({},["annotation-xml"]);const ys=We({},["title","style","font","a","script"]);let tr=null;const bs=["application/xhtml+xml","text/html"],Ma="text/html";let yt=null,yr=null;const br=r.createElement("form"),nr=function(E){return E instanceof RegExp||E instanceof Function},Lr=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(yr&&yr===E)){if((!E||typeof E!="object")&&(E={}),E=Wn(E),tr=bs.indexOf(E.PARSER_MEDIA_TYPE)===-1?Ma:E.PARSER_MEDIA_TYPE,yt=tr==="application/xhtml+xml"?Hi:Zs,he=On(E,"ALLOWED_TAGS")?We({},E.ALLOWED_TAGS,yt):Z,fe=On(E,"ALLOWED_ATTR")?We({},E.ALLOWED_ATTR,yt):Ae,An=On(E,"ALLOWED_NAMESPACES")?We({},E.ALLOWED_NAMESPACES,Hi):da,Tn=On(E,"ADD_URI_SAFE_ATTR")?We(Wn(dn),E.ADD_URI_SAFE_ATTR,yt):dn,rn=On(E,"ADD_DATA_URI_TAGS")?We(Wn(Kn),E.ADD_DATA_URI_TAGS,yt):Kn,at=On(E,"FORBID_CONTENTS")?We({},E.FORBID_CONTENTS,yt):nn,pe=On(E,"FORBID_TAGS")?We({},E.FORBID_TAGS,yt):Wn({}),J=On(E,"FORBID_ATTR")?We({},E.FORBID_ATTR,yt):Wn({}),ze=On(E,"USE_PROFILES")?E.USE_PROFILES:!1,Fe=E.ALLOW_ARIA_ATTR!==!1,be=E.ALLOW_DATA_ATTR!==!1,lt=E.ALLOW_UNKNOWN_PROTOCOLS||!1,Ke=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ut=E.SAFE_FOR_TEMPLATES||!1,en=E.SAFE_FOR_XML!==!1,At=E.WHOLE_DOCUMENT||!1,Sn=E.RETURN_DOM||!1,vr=E.RETURN_DOM_FRAGMENT||!1,zn=E.RETURN_TRUSTED_TYPE||!1,Dr=E.FORCE_BODY||!1,zt=E.SANITIZE_DOM!==!1,Mr=E.SANITIZE_NAMED_PROPS||!1,$n=E.KEEP_CONTENT!==!1,tn=E.IN_PLACE||!1,ee=E.ALLOWED_URI_REGEXP||Hc,De=E.NAMESPACE||xt,Ee=E.MATHML_TEXT_INTEGRATION_POINTS||Ee,mr=E.HTML_INTEGRATION_POINTS||mr,_e=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&nr(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_e.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&nr(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_e.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_e.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ut&&(be=!1),vr&&(Sn=!0),ze&&(he=We({},nu),fe=[],ze.html===!0&&(We(he,tu),We(fe,ru)),ze.svg===!0&&(We(he,Yi),We(fe,Xi),We(fe,Us)),ze.svgFilters===!0&&(We(he,Vi),We(fe,Xi),We(fe,Us)),ze.mathMl===!0&&(We(he,Qi),We(fe,au),We(fe,Us))),E.ADD_TAGS&&(typeof E.ADD_TAGS=="function"?Ne.tagCheck=E.ADD_TAGS:(he===Z&&(he=Wn(he)),We(he,E.ADD_TAGS,yt))),E.ADD_ATTR&&(typeof E.ADD_ATTR=="function"?Ne.attributeCheck=E.ADD_ATTR:(fe===Ae&&(fe=Wn(fe)),We(fe,E.ADD_ATTR,yt))),E.ADD_URI_SAFE_ATTR&&We(Tn,E.ADD_URI_SAFE_ATTR,yt),E.FORBID_CONTENTS&&(at===nn&&(at=Wn(at)),We(at,E.FORBID_CONTENTS,yt)),E.ADD_FORBID_CONTENTS&&(at===nn&&(at=Wn(at)),We(at,E.ADD_FORBID_CONTENTS,yt)),$n&&(he["#text"]=!0),At&&We(he,["html","head","body"]),he.table&&(We(he,["tbody"]),delete pe.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=E.TRUSTED_TYPES_POLICY,X=U.createHTML("")}else U===void 0&&(U=Bg(w,i)),U!==null&&typeof X=="string"&&(X=U.createHTML(""));Gt&&Gt(E),yr=E}},Nr=We({},[...Yi,...Vi,...Cg]),st=We({},[...Qi,...Ig]),kt=function(E){let de=G(E);(!de||!de.tagName)&&(de={namespaceURI:De,tagName:"template"});const ke=Zs(E.tagName),$e=Zs(de.tagName);return An[E.namespaceURI]?E.namespaceURI===gr?de.namespaceURI===xt?ke==="svg":de.namespaceURI===En?ke==="svg"&&($e==="annotation-xml"||Ee[$e]):!!Nr[ke]:E.namespaceURI===En?de.namespaceURI===xt?ke==="math":de.namespaceURI===gr?ke==="math"&&mr[$e]:!!st[ke]:E.namespaceURI===xt?de.namespaceURI===gr&&!mr[$e]||de.namespaceURI===En&&!Ee[$e]?!1:!st[ke]&&(ys[ke]||!Nr[ke]):!!(tr==="application/xhtml+xml"&&An[E.namespaceURI]):!1},hn=function(E){Qa(e.removed,{element:E});try{G(E).removeChild(E)}catch{S(E)}},pn=function(E,de){try{Qa(e.removed,{attribute:de.getAttributeNode(E),from:de})}catch{Qa(e.removed,{attribute:null,from:de})}if(de.removeAttribute(E),E==="is")if(Sn||vr)try{hn(de)}catch{}else try{de.setAttribute(E,"")}catch{}},qr=function(E){let de=null,ke=null;if(Dr)E="<remove></remove>"+E;else{const ht=Wi(E,/^[\r\n\t ]+/);ke=ht&&ht[0]}tr==="application/xhtml+xml"&&De===xt&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const $e=U?U.createHTML(E):E;if(De===xt)try{de=new _().parseFromString($e,tr)}catch{}if(!de||!de.documentElement){de=$.createDocument(De,"template",null);try{de.documentElement.innerHTML=er?X:$e}catch{}}const it=de.body||de.documentElement;return E&&ke&&it.insertBefore(r.createTextNode(ke),it.childNodes[0]||null),De===xt?Le.call(de,At?"html":"body")[0]:At?de.documentElement:it},jr=function(E){return Y.call(E.ownerDocument||E,E,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},La=function(E){return E instanceof x&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof y)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},Cn=function(E){return typeof d=="function"&&E instanceof d};function Lt(Me,E,de){Ks(Me,ke=>{ke.call(e,E,de,yr)})}const In=function(E){let de=null;if(Lt(ve.beforeSanitizeElements,E,null),La(E))return hn(E),!0;const ke=yt(E.nodeName);if(Lt(ve.uponSanitizeElement,E,{tagName:ke,allowedTags:he}),en&&E.hasChildNodes()&&!Cn(E.firstElementChild)&&Ft(/<[/\w!]/g,E.innerHTML)&&Ft(/<[/\w!]/g,E.textContent)||E.nodeType===$a.progressingInstruction||en&&E.nodeType===$a.comment&&Ft(/<[/\w]/g,E.data))return hn(E),!0;if(!(Ne.tagCheck instanceof Function&&Ne.tagCheck(ke))&&(!he[ke]||pe[ke])){if(!pe[ke]&&_s(ke)&&(_e.tagNameCheck instanceof RegExp&&Ft(_e.tagNameCheck,ke)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(ke)))return!1;if($n&&!at[ke]){const $e=G(E)||E.parentNode,it=ne(E)||E.childNodes;if(it&&$e){const ht=it.length;for(let bt=ht-1;bt>=0;--bt){const Wt=q(it[bt],!0);Wt.__removalCount=(E.__removalCount||0)+1,$e.insertBefore(Wt,F(E))}}}return hn(E),!0}return E instanceof v&&!kt(E)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&Ft(/<\/no(script|embed|frames)/i,E.innerHTML)?(hn(E),!0):(ut&&E.nodeType===$a.text&&(de=E.textContent,Ks([se,re,qe],$e=>{de=Xa(de,$e," ")}),E.textContent!==de&&(Qa(e.removed,{element:E.cloneNode()}),E.textContent=de)),Lt(ve.afterSanitizeElements,E,null),!1)},Br=function(E,de,ke){if(zt&&(de==="id"||de==="name")&&(ke in r||ke in br))return!1;if(!(be&&!J[de]&&Ft(ie,de))){if(!(Fe&&Ft(le,de))){if(!(Ne.attributeCheck instanceof Function&&Ne.attributeCheck(de,E))){if(!fe[de]||J[de]){if(!(_s(E)&&(_e.tagNameCheck instanceof RegExp&&Ft(_e.tagNameCheck,E)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(E))&&(_e.attributeNameCheck instanceof RegExp&&Ft(_e.attributeNameCheck,de)||_e.attributeNameCheck instanceof Function&&_e.attributeNameCheck(de,E))||de==="is"&&_e.allowCustomizedBuiltInElements&&(_e.tagNameCheck instanceof RegExp&&Ft(_e.tagNameCheck,ke)||_e.tagNameCheck instanceof Function&&_e.tagNameCheck(ke))))return!1}else if(!Tn[de]){if(!Ft(ee,Xa(ke,Q,""))){if(!((de==="src"||de==="xlink:href"||de==="href")&&E!=="script"&&Sg(ke,"data:")===0&&rn[E])){if(!(lt&&!Ft(ue,Xa(ke,Q,"")))){if(ke)return!1}}}}}}}return!0},_s=function(E){return E!=="annotation-xml"&&Wi(E,te)},Rn=function(E){Lt(ve.beforeSanitizeAttributes,E,null);const{attributes:de}=E;if(!de||La(E))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:fe,forceKeepAttr:void 0};let $e=de.length;for(;$e--;){const it=de[$e],{name:ht,namespaceURI:bt,value:Wt}=it,Un=yt(ht),zr=Wt;let ct=ht==="value"?zr:Tg(zr);if(ke.attrName=Un,ke.attrValue=ct,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Lt(ve.uponSanitizeAttribute,E,ke),ct=ke.attrValue,Mr&&(Un==="id"||Un==="name")&&(pn(ht,E),ct=Fn+ct),en&&Ft(/((--!?|])>)|<\/(style|title|textarea)/i,ct)){pn(ht,E);continue}if(Un==="attributename"&&Wi(ct,"href")){pn(ht,E);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){pn(ht,E);continue}if(!Ke&&Ft(/\/>/i,ct)){pn(ht,E);continue}ut&&Ks([se,re,qe],Fr=>{ct=Xa(ct,Fr," ")});const Na=yt(E.nodeName);if(!Br(Na,Un,ct)){pn(ht,E);continue}if(U&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!bt)switch(w.getAttributeType(Na,Un)){case"TrustedHTML":{ct=U.createHTML(ct);break}case"TrustedScriptURL":{ct=U.createScriptURL(ct);break}}if(ct!==zr)try{bt?E.setAttributeNS(bt,ht,ct):E.setAttribute(ht,ct),La(E)?hn(E):eu(e.removed)}catch{pn(ht,E)}}Lt(ve.afterSanitizeAttributes,E,null)},ws=function Me(E){let de=null;const ke=jr(E);for(Lt(ve.beforeSanitizeShadowDOM,E,null);de=ke.nextNode();)Lt(ve.uponSanitizeShadowNode,de,null),In(de),Rn(de),de.content instanceof o&&Me(de.content);Lt(ve.afterSanitizeShadowDOM,E,null)};return e.sanitize=function(Me){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},de=null,ke=null,$e=null,it=null;if(er=!Me,er&&(Me="<!-->"),typeof Me!="string"&&!Cn(Me))if(typeof Me.toString=="function"){if(Me=Me.toString(),typeof Me!="string")throw Za("dirty is not a string, aborting")}else throw Za("toString is not a function");if(!e.isSupported)return Me;if(Or||Lr(E),e.removed=[],typeof Me=="string"&&(tn=!1),tn){if(Me.nodeName){const Wt=yt(Me.nodeName);if(!he[Wt]||pe[Wt])throw Za("root node is forbidden and cannot be sanitized in-place")}}else if(Me instanceof d)de=qr("<!---->"),ke=de.ownerDocument.importNode(Me,!0),ke.nodeType===$a.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?de=ke:de.appendChild(ke);else{if(!Sn&&!ut&&!At&&Me.indexOf("<")===-1)return U&&zn?U.createHTML(Me):Me;if(de=qr(Me),!de)return Sn?null:zn?X:""}de&&Dr&&hn(de.firstChild);const ht=jr(tn?Me:de);for(;$e=ht.nextNode();)In($e),Rn($e),$e.content instanceof o&&ws($e.content);if(tn)return Me;if(Sn){if(vr)for(it=ge.call(de.ownerDocument);de.firstChild;)it.appendChild(de.firstChild);else it=de;return(fe.shadowroot||fe.shadowrootmode)&&(it=we.call(a,it,!0)),it}let bt=At?de.outerHTML:de.innerHTML;return At&&he["!doctype"]&&de.ownerDocument&&de.ownerDocument.doctype&&de.ownerDocument.doctype.name&&Ft(Wc,de.ownerDocument.doctype.name)&&(bt="<!DOCTYPE "+de.ownerDocument.doctype.name+`>
`+bt),ut&&Ks([se,re,qe],Wt=>{bt=Xa(bt,Wt," ")}),U&&zn?U.createHTML(bt):bt},e.setConfig=function(){let Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lr(Me),Or=!0},e.clearConfig=function(){yr=null,Or=!1},e.isValidAttribute=function(Me,E,de){yr||Lr({});const ke=yt(Me),$e=yt(E);return Br(ke,$e,de)},e.addHook=function(Me,E){typeof E=="function"&&Qa(ve[Me],E)},e.removeHook=function(Me,E){if(E!==void 0){const de=kg(ve[Me],E);return de===-1?void 0:xg(ve[Me],de,1)[0]}return eu(ve[Me])},e.removeHooks=function(Me){ve[Me]=[]},e.removeAllHooks=function(){ve=iu()},e}var zg=Yc();function Fg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${ou(t.from)} |`),e.push(`| **To** | ${ou(t.to)} |`),e.push(`| **Date** | ${jo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Kg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function ou(t){return(t||"").replace(/\|/g,"\\|")}function Kg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return wo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Ug(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function wo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return Ug(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(wo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>wo(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Gg(t){return mc(t,"md")}function lu(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Hg(t){return t.raw||null}function Wg(t){const e=Hg(t);return e?JSON.stringify(e,null,2):"null"}function Yg(t){return mc(t,"json")}var Vg=H('<button title="View as Markdown">.md</button>'),Qg=H('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Xg=H('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Zg=H('<div class="md-preview svelte-1b0rzpb"><!></div>'),Jg=H('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),$g=H('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),em=H('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),tm=H('<pre class="message-text svelte-1b0rzpb"> </pre>'),nm=H('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),rm=H('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),am=H('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function sm(t,e){ft(e,!0);let r=Ie(e,"loading",3,!1);Mt(()=>fn("MessageModal"));const a=new nt.Renderer;a.link=({href:se,title:re,text:qe})=>{const ie=re?` title="${re}"`:"";return`<a href="${se}"${ie} target="_blank" rel="noopener">${qe}</a>`},nt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Oe("email"),o=vt(()=>e.message.body?Fg(e.message):""),c=vt(()=>Wg(e.message)),d=Oe("raw");function v(se){B(i,b(i)===se?"email":se,!0),se==="markdown"&&B(d,"raw")}function h(){lu(b(o),Gg(e.message))}function y(){lu(b(c),Yg(e.message),"application/json;charset=utf-8")}function x(se){const re=nt.parse(se);return zg.sanitize(re,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let _=Oe(null);$s(()=>{var se;if(b(_)&&e.message.htmlBody&&!r()&&b(i)==="email"){const re=b(_).contentDocument||((se=b(_).contentWindow)==null?void 0:se.document);re&&(re.open(),re.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),re.close())}});var w=am();w.__click=function(...se){var re;(re=e.onclose)==null||re.apply(this,se)};var M=k(w);M.__click=se=>se.stopPropagation();var q=k(M),S=k(q),F=k(S),ne=D(S,2),G=k(ne);let U;G.__click=()=>v("json");var X=D(G,2);{var $=se=>{var re=Vg();let qe;re.__click=()=>v("markdown"),ye(()=>qe=Zt(re,1,"action-btn svelte-1b0rzpb",null,qe,{active:b(i)==="markdown"})),K(se,re)};Te(X,se=>{e.message.body&&se($)})}var Y=D(X,2);Y.__click=function(...se){var re;(re=e.onclose)==null||re.apply(this,se)};var ge=D(q,2);{var Le=se=>{var re=Qg(),qe=gt(re),ie=D(k(qe),2);ie.__click=y;var le=D(qe,2),ue=k(le),Q=k(ue);ye(()=>ae(Q,b(c))),K(se,re)},we=se=>{var re=Jg(),qe=gt(re),ie=k(qe),le=k(ie);let ue;le.__click=()=>B(d,"raw");var Q=D(le,2);let te;Q.__click=()=>B(d,"preview");var ee=D(ie,2);ee.__click=h;var he=D(qe,2),Z=k(he);{var fe=_e=>{var pe=Xg(),J=k(pe);ye(()=>ae(J,b(o))),K(_e,pe)},Ae=_e=>{var pe=Zg(),J=k(pe);Bd(J,()=>x(b(o))),K(_e,pe)};Te(Z,_e=>{b(d)==="raw"?_e(fe):_e(Ae,!1)})}ye(()=>{ue=Zt(le,1,"md-tab svelte-1b0rzpb",null,ue,{active:b(d)==="raw"}),te=Zt(Q,1,"md-tab svelte-1b0rzpb",null,te,{active:b(d)==="preview"})}),K(se,re)},ve=se=>{var re=rm(),qe=gt(re),ie=k(qe),le=D(k(ie),2),ue=k(le),Q=D(ie,2),te=D(k(Q),2),ee=k(te),he=D(Q,2),Z=D(k(he),2),fe=k(Z),Ae=D(qe,2),_e=k(Ae);{var pe=be=>{var lt=$g();K(be,lt)},J=be=>{var lt=em();lo(lt,Ke=>B(_,Ke),()=>b(_)),K(be,lt)},Ne=be=>{var lt=tm(),Ke=k(lt);ye(()=>ae(Ke,e.message.body)),K(be,lt)},Fe=be=>{var lt=nm();K(be,lt)};Te(_e,be=>{r()?be(pe):e.message.htmlBody?be(J,1):e.message.body?be(Ne,2):be(Fe,!1)})}ye(be=>{ae(ue,e.message.from),ae(ee,e.message.to),ae(fe,be)},[()=>jo(e.message.date)]),K(se,re)};Te(ge,se=>{b(i)==="json"?se(Le):b(i)==="markdown"?se(we,1):se(ve,!1)})}ye(()=>{ae(F,e.message.subject),U=Zt(G,1,"action-btn svelte-1b0rzpb",null,U,{active:b(i)==="json"})}),K(t,w),dt()}Bt(["click"]);var im=H('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),om=H('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),lm=H('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),um=H("<p> </p>"),cm=H('<p>No emails in local storage. Click "Sync New" to download.</p>'),fm=H('<div class="empty-state svelte-6ts5xm"><!></div>'),dm=H('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),hm=H('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function pm(t,e){ft(e,!0),Mt(()=>fn("DashboardView"));let r=Ie(e,"error",3,null),a=Ie(e,"profile",3,null),i=Ie(e,"loadingProfile",3,!1),o=Ie(e,"emailMessages",19,()=>[]),c=Ie(e,"totalLocalMessages",3,0),d=Ie(e,"hasMoreLocal",3,!1),v=Ie(e,"loadingMessages",3,!1),h=Ie(e,"selectedMessage",3,null),y=Ie(e,"syncStatus",3,null),x=Ie(e,"syncProgress",3,null),_=Ie(e,"isSyncing",3,!1),w=Ie(e,"searchQuery",15);var M=hm(),q=gt(M),S=k(q);{var F=ie=>{Pc(ie,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Te(S,ie=>{r()&&ie(F)})}var ne=D(S,2);hv(ne,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var G=D(ne,2);Ev(G,{get syncStatus(){return y()},get syncProgress(){return x()},get isSyncing(){return _()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var U=D(G,2),X=k(U);X.__keydown=ie=>ie.key==="Enter"&&e.onsearch();var $=D(X,2);$.__click=function(...ie){var le;(le=e.onsearch)==null||le.apply(this,ie)};var Y=k($),ge=D(U,2);{var Le=ie=>{var le=om(),ue=gt(le),Q=k(ue),te=k(Q),ee=D(ue,2);Iv(ee,{get messages(){return o()},get onselect(){return e.onviewmessage}});var he=D(ee,2);{var Z=fe=>{var Ae=im(),_e=k(Ae);_e.__click=function(...J){var Ne;(Ne=e.onloadmore)==null||Ne.apply(this,J)};var pe=k(_e);ye(()=>{_e.disabled=v(),ae(pe,v()?"Loading...":"Load More")}),K(fe,Ae)};Te(he,fe=>{d()&&fe(Z)})}ye(fe=>ae(te,`Showing ${o().length??""} of ${fe??""}
        ${w()?" matching":""} emails`),[()=>c().toLocaleString()]),K(ie,le)},we=ie=>{var le=lm();K(ie,le)},ve=ie=>{var le=fm(),ue=k(le);{var Q=ee=>{var he=um(),Z=k(he);ye(()=>ae(Z,`No emails match "${w()??""}".`)),K(ee,he)},te=ee=>{var he=cm();K(ee,he)};Te(ue,ee=>{w()?ee(Q):ee(te,!1)})}K(ie,le)},se=ie=>{var le=dm();K(ie,le)};Te(ge,ie=>{var le;o().length>0?ie(Le):v()?ie(we,1):(le=y())!=null&&le.synced?ie(ve,2):ie(se,!1)})}var re=D(q,2);{var qe=ie=>{sm(ie,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};Te(re,ie=>{h()&&ie(qe)})}ye(()=>{$.disabled=v(),ae(Y,v()?"Searching...":"Search")}),No(X,w),K(t,M),dt()}Bt(["keydown","click"]);var vm=H('<div class="dashboard svelte-1q5o2lv"><!></div>');function gm(t,e){ft(e,!0);function r(J){J.key==="Escape"&&b(v)&&ue()}Mt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Oe(Rt(localStorage.getItem("googleClientId")||"")),i=Oe(Rt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),h=Oe(""),y=Oe(Rt([])),x=Oe(0),_=Oe(0),w=Oe(!1),M=Oe(!1),q=Oe(!1),S=Oe(null),F=Oe(null),ne=Oe(null),G=Oe(!1);const U=50;$s(()=>{b(c)&&(Q(),re())});let X=vt(()=>!b(a)),$=vt(()=>!!b(c)),Y=vt(()=>b(y).length<b(x));$s(()=>{b(a)&&!b(o)&&Hl(b(a)).then(()=>{B(o,!0)}).catch(J=>{B(S,`Auth init failed: ${J.message}`)})});function ge(){const J=b(i).trim();J&&(localStorage.setItem("googleClientId",J),B(a,J,!0),B(S,null))}function Le(){localStorage.removeItem("googleClientId"),B(a,""),B(i,""),B(o,!1),B(c,null),B(d,null),B(y,[],!0),B(x,0)}async function we(){B(S,null),B(M,!0);try{b(o)||(await Hl(b(a)),B(o,!0));const J=await Fp();B(c,J.access_token,!0),await se()}catch(J){B(S,J.message,!0)}finally{B(M,!1)}}async function ve(){if(b(c))try{await Kp(b(c))}catch{}B(c,null),B(d,null),B(y,[],!0),B(x,0),B(v,null),B(S,null)}async function se(){B(q,!0);try{const J=await hc(b(c));if(!b(c))return;B(d,J,!0)}catch(J){if(!b(c))return;B(S,`Profile fetch failed: ${J.message}`)}finally{B(q,!1)}}async function re(J=!1){B(w,!0);try{const Ne=J?b(_):0,Fe=await hh({query:b(h)||void 0,limit:U,offset:Ne});J?B(y,[...b(y),...Fe.items],!0):B(y,Fe.items,!0),B(x,Fe.total,!0),B(_,b(y).length,!0)}catch(Ne){B(S,`Failed to load messages: ${Ne.message}`)}finally{B(w,!1)}}function qe(){B(_,0),re(!1)}function ie(){re(!0)}function le(J){B(v,J,!0)}function ue(){B(v,null)}async function Q(){try{B(F,await Hp(),!0)}catch{}}async function te(J){if(b(G)||!b(c))return;B(S,null),B(G,!0),B(ne,null);const Ne=new AbortController;try{await Up(b(c),{limit:J,onProgress:Fe=>{B(ne,{...Fe},!0)},signal:Ne.signal}),await Q(),await re(!1)}catch(Fe){if(Fe.name!=="AbortError"){if(!b(c))return;B(S,`Sync failed: ${Fe.message}`)}}finally{B(G,!1)}}async function ee(J){if(b(G)||!b(c))return;B(S,null),B(G,!0),B(ne,null);const Ne=new AbortController;try{await Gp(b(c),{limit:J,onProgress:Fe=>{B(ne,{...Fe},!0)},signal:Ne.signal}),await Q(),await re(!1)}catch(Fe){if(Fe.name!=="AbortError"){if(!b(c))return;B(S,`Sync more failed: ${Fe.message}`)}}finally{B(G,!1)}}async function he(){try{await Wp(),await Q(),B(y,[],!0),B(x,0),B(_,0)}catch(J){B(S,`Failed to clear data: ${J.message}`)}}var Z=vm(),fe=k(Z);{var Ae=J=>{Jp(J,{onsave:ge,get clientIdInput(){return b(i)},set clientIdInput(Ne){B(i,Ne,!0)}})},_e=J=>{uv(J,{get clientId(){return b(a)},get error(){return b(S)},get loadingAuth(){return b(M)},onsignin:we,onclear:Le,onsignout:ve})},pe=J=>{pm(J,{get error(){return b(S)},get profile(){return b(d)},get loadingProfile(){return b(q)},get emailMessages(){return b(y)},get totalLocalMessages(){return b(x)},get hasMoreLocal(){return b(Y)},get loadingMessages(){return b(w)},get selectedMessage(){return b(v)},get syncStatus(){return b(F)},get syncProgress(){return b(ne)},get isSyncing(){return b(G)},onsignout:ve,onsearch:qe,onloadmore:ie,onviewmessage:le,onclosedetail:ue,ondismisserror:()=>B(S,null),onsync:te,onsyncmore:ee,oncleardata:he,get searchQuery(){return b(h)},set searchQuery(Ne){B(h,Ne,!0)}})};Te(fe,J=>{b(X)?J(Ae):b($)?J(pe,!1):J(_e,1)})}K(t,Z),dt()}var mm=H('<span class="spinner svelte-ois7em"></span>'),ym=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),bm=H('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),_m=H('<option class="svelte-ois7em"> </option>'),wm=H('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),km=H('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),xm=H('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function Sm(t,e){ft(e,!0);let r=Ie(e,"engineStatus",3,"idle"),a=Ie(e,"modelName",3,""),i=Ie(e,"isScanning",3,!1),o=Ie(e,"scanProgress",3,null),c=Ie(e,"scanCount",15,20),d=Ie(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function h(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var _=xm(),w=k(_),M=k(w),q=k(M);{var S=ee=>{var he=mm();K(ee,he)},F=ee=>{var he=ym();K(ee,he)};Te(q,ee=>{i()?ee(S):ee(F,!1)})}var ne=D(M,2),G=D(k(ne),2),U=k(G);let X;var $=D(U),Y=D(w,2);{var ge=ee=>{var he=bm(),Z=k(he),fe=k(Z),Ae=D(Z,4),_e=k(Ae),pe=D(Ae,4),J=k(pe);ye(()=>{ae(fe,`${d().totalEmails??""} emails in storage`),ae(_e,`${d().classified??""} classified`),ae(J,`${d().unclassified??""} new`)}),K(ee,he)};Te(Y,ee=>{d()&&ee(ge)})}var Le=D(Y,2),we=k(Le),ve=D(k(we),2);Ut(ve,21,()=>v,pr,(ee,he)=>{var Z=_m(),fe=k(Z),Ae={};ye(()=>{ae(fe,b(he).label),Ae!==(Ae=b(he).value)&&(Z.value=(Z.__value=b(he).value)??"")}),K(ee,Z)});var se=D(we,2),re=k(se);re.__click=function(...ee){var he;(he=e.onscan)==null||he.apply(this,ee)};var qe=k(re),ie=D(re,2);ie.__click=function(...ee){var he;(he=e.onrescan)==null||he.apply(this,ee)};var le=D(Le,2);{var ue=ee=>{var he=wm();K(ee,he)};Te(le,ee=>{r()!=="ready"&&r()!=="loading"&&ee(ue)})}var Q=D(le,2);{var te=ee=>{var he=km(),Z=k(he),fe=k(Z);let Ae,_e;var pe=D(Z,2),J=k(pe);ye(()=>{Ae=Zt(fe,1,"progress-fill svelte-ois7em",null,Ae,{indeterminate:!o().total}),_e=$t(fe,"",_e,{width:`${o().total?o().current/o().total*100:0}%`}),ae(J,o().message||"Scanning...")}),K(ee,he)};Te(Q,ee=>{i()&&o()&&ee(te)})}ye((ee,he,Z,fe)=>{X=$t(U,"",X,ee),ae($,` ${he??""}`),ve.disabled=i(),re.disabled=Z,ae(qe,i()?"Scanning...":"Scan New"),ie.disabled=fe},[()=>({background:y()}),h,()=>!x(),()=>!x()]),Lo(ve,c),K(t,_),dt()}Bt(["click"]);var Tm=H('<span class="row-date svelte-1czytqk"> </span>'),Em=H('<span class="tag svelte-1czytqk"> </span>'),Am=H('<span class="row-tags svelte-1czytqk"></span>'),Cm=H('<span class="row-reason svelte-1czytqk"> </span>'),Im=H('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),Rm=H('<span class="status-label svelte-1czytqk"> </span>'),Pm=H('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Om=H('<p class="summary-reason svelte-1czytqk"> </p>'),Dm=H('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Mm=H('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function uu(t,e){ft(e,!0);let r=Ie(e,"actionColor",3,"#666"),a=Ie(e,"dimmed",3,!1);function i(ie){if(!ie)return"";try{return new Date(ie).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=vt(()=>e.item.status==="pending"),c=Oe(!1);var d=Mm(),v=gt(d);let h;var y=k(v);y.__click=()=>B(c,!b(c));let x;var _=k(y),w=k(_),M=D(_,2),q=k(M),S=k(q),F=D(q,2);{var ne=ie=>{var le=Tm(),ue=k(le);ye(Q=>ae(ue,Q),[()=>i(e.item.date)]),K(ie,le)};Te(F,ie=>{e.item.date&&ie(ne)})}var G=D(M,2);{var U=ie=>{var le=Am();Ut(le,21,()=>e.item.tags,pr,(ue,Q)=>{var te=Em();let ee;var he=k(te);ye(Z=>{ee=$t(te,"",ee,Z),ae(he,b(Q))},[()=>({background:Tc(b(Q))})]),K(ue,te)}),K(ie,le)};Te(G,ie=>{e.item.tags&&e.item.tags.length>0&&ie(U)})}var X=D(G,2);{var $=ie=>{var le=Cm(),ue=k(le);ye(()=>ae(ue,e.item.reason)),K(ie,le)};Te(X,ie=>{e.item.reason&&!b(c)&&ie($)})}var Y=D(y,2),ge=k(Y);{var Le=ie=>{var le=Im(),ue=gt(le);ue.__click=()=>e.onmarkacted(e.item.emailId);var Q=D(ue,2);Q.__click=()=>e.ondismiss(e.item.emailId),K(ie,le)},we=ie=>{var le=Rm(),ue=k(le);ye(()=>ae(ue,e.item.status)),K(ie,le)};Te(ge,ie=>{b(o)?ie(Le):ie(we,!1)})}var ve=D(ge,2);{var se=ie=>{var le=Pm();le.__click=()=>e.onremove(e.item.emailId),K(ie,le)};Te(ve,ie=>{e.onremove&&ie(se)})}var re=D(v,2);{var qe=ie=>{var le=Dm();let ue;var Q=k(le),te=k(Q),ee=D(Q,2);{var he=Z=>{var fe=Om(),Ae=k(fe);ye(()=>ae(Ae,e.item.reason)),K(Z,fe)};Te(ee,Z=>{e.item.reason&&Z(he)})}ye(()=>{ue=$t(le,"",ue,{"border-left-color":r()}),ae(te,e.item.summary)}),K(ie,le)};Te(re,ie=>{b(c)&&e.item.summary&&ie(qe)})}ye(()=>{h=Zt(v,1,"email-row svelte-1czytqk",null,h,{dimmed:a()}),x=$t(y,"",x,{"border-left-color":r()}),ae(w,e.item.subject),ae(S,e.item.from)}),K(t,d),dt()}Bt(["click"]);var Lm=H('<span class="group-acted svelte-tl1unp"> </span>'),Nm=H('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),qm=H('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),jm=H('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Bm=H('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),zm=H('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Fm=H('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Km(t,e){ft(e,!0);let r=Ie(e,"color",3,"#888");Ie(e,"count",3,0);let a=Ie(e,"items",19,()=>[]),i=Ie(e,"expanded",3,!1),o=vt(()=>a().filter($=>$.status==="pending")),c=vt(()=>a().filter($=>$.status!=="pending")),d=Oe(!1);function v($){return $.split("_").map(Y=>Y.charAt(0)+Y.slice(1).toLowerCase()).join(" ")}var h=Fm(),y=k(h);y.__click=function(...$){var Y;(Y=e.ontoggle)==null||Y.apply(this,$)};var x=k(y);let _;var w=k(x),M=D(x,2),q=k(M),S=D(M,2);{var F=$=>{var Y=Lm(),ge=k(Y);ye(()=>ae(ge,`${b(c).length??""} handled`)),K($,Y)};Te(S,$=>{b(c).length>0&&$(F)})}var ne=D(S,4);let G;var U=D(y,2);{var X=$=>{var Y=zm(),ge=k(Y);{var Le=ue=>{var Q=Nm();K(ue,Q)};Te(ge,ue=>{b(o).length===0&&b(c).length===0&&ue(Le)})}var we=D(ge,2);Ut(we,17,()=>b(o),ue=>ue.emailId,(ue,Q)=>{uu(ue,{get item(){return b(Q)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ve=D(we,2);{var se=ue=>{var Q=qm(),te=k(Q),ee=k(te),he=D(te,2);Ut(he,17,()=>b(c),Z=>Z.emailId,(Z,fe)=>{uu(Z,{get item(){return b(fe)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ye(()=>ae(ee,`${b(c).length??""} handled`)),K(ue,Q)};Te(ve,ue=>{b(c).length>0&&ue(se)})}var re=D(ve,2),qe=k(re);{var ie=ue=>{var Q=jm();Q.__click=()=>B(d,!0),K(ue,Q)},le=ue=>{var Q=Bm(),te=k(Q),ee=D(te);ee.__click=()=>B(d,!1);var he=D(ee,2);he.__click=()=>{e.oncleargroup(),B(d,!1)},ye(()=>ae(te,`Clear ${a().length??""} items? `)),K(ue,Q)};Te(qe,ue=>{b(d)?ue(le,!1):ue(ie)})}K($,Y)};Te(U,$=>{i()&&$(X)})}ye($=>{_=$t(x,"",_,{background:r()}),ae(w,$),ae(q,b(o).length),G=Zt(ne,0,"chevron svelte-tl1unp",null,G,{open:i()})},[()=>v(e.action)]),K(t,h),dt()}Bt(["click"]);var Um=H('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Gm=H('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Hm=H('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Wm=H('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Ym=H('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Vm=H('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Qm(t,e){ft(e,!0);let r=Ie(e,"groups",19,()=>({})),a=Ie(e,"groupOrder",19,()=>[]),i=Ie(e,"counts",19,()=>({})),o=Ie(e,"stats",3,null),c=Ie(e,"expandedGroup",3,null),d=Ie(e,"isScanning",3,!1),v=Ie(e,"scanProgress",3,null),h=Ie(e,"scanCount",15,20),y=Ie(e,"error",3,null),x=Oe(!1);var _=Vm(),w=k(_);Sm(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return h()},set scanCount(G){h(G)}});var M=D(w,2);{var q=G=>{var U=Um(),X=k(U),$=k(X),Y=D(X,2);Y.__click=function(...ge){var Le;(Le=e.ondismisserror)==null||Le.apply(this,ge)},ye(()=>ae($,y())),K(G,U)};Te(M,G=>{y()&&G(q)})}var S=D(M,2);{var F=G=>{var U=Wm(),X=gt(U);Ut(X,20,a,se=>se,(se,re)=>{{let qe=vt(()=>zo(re)),ie=vt(()=>{var Q;return((Q=r()[re])==null?void 0:Q.length)||0}),le=vt(()=>r()[re]||[]),ue=vt(()=>c()===re);Km(se,{get action(){return re},get color(){return b(qe)},get count(){return b(ie)},get items(){return b(le)},get expanded(){return b(ue)},ontoggle:()=>e.ontogglegroup(re),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(re)})}});var $=D(X,2),Y=k($),ge=k(Y),Le=D(Y,2);{var we=se=>{var re=Gm();re.__click=()=>B(x,!0),K(se,re)},ve=se=>{var re=Hm(),qe=D(k(re));qe.__click=()=>B(x,!1);var ie=D(qe,2);ie.__click=()=>{e.onclear(),B(x,!1)},K(se,re)};Te(Le,se=>{b(x)?se(ve,!1):se(we)})}ye(()=>ae(ge,`${i().total??""} emails classified into ${a().length??""} groups`)),K(G,U)},ne=G=>{var U=Ym();K(G,U)};Te(S,G=>{i().total>0?G(F):d()||G(ne,1)})}K(t,_),dt()}Bt(["click"]);var Xm=H('<div class="actions-page svelte-3tch4q"><!></div>');function Zm(t,e){ft(e,!0);const r=uc();let a=Oe(Rt(r.status)),i=Oe(""),o=Oe(Rt({})),c=Oe(Rt([])),d=Oe(Rt({total:0})),v=Oe(null),h=Oe(null),y=Oe(!1),x=Oe(null),_=Oe(20),w=Oe(null);Mt(()=>{const we=r.onMessage(ve=>{if(ve.status==="ready"){B(a,"ready");const se=ls.find(re=>re.id===r.modelId);B(i,(se==null?void 0:se.name)||r.modelId||"",!0)}ve.status==="loading"&&B(a,"loading")});if(B(a,r.status,!0),r.modelId){const ve=ls.find(se=>se.id===r.modelId);B(i,(ve==null?void 0:ve.name)||r.modelId||"",!0)}return M(),()=>we()});async function M(){try{const we=await wh();B(o,we.groups,!0),B(c,we.order,!0),B(d,await kh(),!0),B(v,await ho(),!0)}catch(we){B(w,`Failed to load data: ${we.message}`)}}async function q(){await F(!1)}async function S(){await F(!0)}async function F(we){if(!(b(y)||!r.isReady)){B(w,null),B(y,!0),B(x,null);try{await kc(r,{count:b(_),force:we,onProgress:ve=>{B(x,{...ve},!0)}}),await M()}catch(ve){B(w,`Scan failed: ${ve.message}`)}finally{B(y,!1)}}}async function ne(we){await ti(we,"acted"),await M()}async function G(we){await ti(we,"dismissed"),await M()}async function U(we){await Sc(we),await M()}async function X(we){await xc(we),await M()}async function $(){await xh(),await M()}function Y(we){B(h,b(h)===we?null:we,!0)}var ge=Xm(),Le=k(ge);Qm(Le,{get engineStatus(){return b(a)},get modelName(){return b(i)},get groups(){return b(o)},get groupOrder(){return b(c)},get counts(){return b(d)},get stats(){return b(v)},get expandedGroup(){return b(h)},get isScanning(){return b(y)},get scanProgress(){return b(x)},get error(){return b(w)},onscan:q,onrescan:S,ontogglegroup:Y,onmarkacted:ne,ondismiss:G,onremove:U,oncleargroup:X,onclear:$,ondismisserror:()=>B(w,null),get scanCount(){return b(_)},set scanCount(we){B(_,we,!0)}}),K(t,ge),dt()}var Jm=H('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function $m(t,e){ft(e,!0);function r(){const Y=location.hash;return Y==="#dashboard"?"dashboard":Y==="#actions"?"actions":"chat"}let a=Oe(Rt(r()));Mt(()=>{function Y(){B(a,r(),!0)}return window.addEventListener("hashchange",Y),()=>window.removeEventListener("hashchange",Y)});var i=Jm(),o=k(i),c=D(k(o),2),d=k(c);let v;var h=D(d,2);let y;var x=D(h,2);let _;var w=D(o,2),M=k(w);let q;var S=k(M);jp(S,{});var F=D(M,2);let ne;var G=k(F);Zm(G,{});var U=D(F,2);let X;var $=k(U);gm($,{}),ye(()=>{v=Zt(d,1,"svelte-1n46o8q",null,v,{active:b(a)==="chat"}),y=Zt(h,1,"svelte-1n46o8q",null,y,{active:b(a)==="actions"}),_=Zt(x,1,"svelte-1n46o8q",null,_,{active:b(a)==="dashboard"}),q=$t(M,"",q,{display:b(a)==="chat"?"flex":"none"}),ne=$t(F,"",ne,{display:b(a)==="actions"?"flex":"none"}),X=$t(U,"",X,{display:b(a)==="dashboard"?"flex":"none"})}),K(t,i),dt()}Od($m,{target:document.getElementById("app")});
