var kf=Object.defineProperty;var El=t=>{throw TypeError(t)};var xf=(t,e,r)=>e in t?kf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var We=(t,e,r)=>xf(t,typeof e!="symbol"?e+"":e,r),zi=(t,e,r)=>e.has(t)||El("Cannot "+r);var X=(t,e,r)=>(zi(t,e,"read from private field"),r?r.call(t):e.get(t)),Ye=(t,e,r)=>e.has(t)?El("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ge=(t,e,r,a)=>(zi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Kt=(t,e,r)=>(zi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const $i=!1;var So=Array.isArray,Sf=Array.prototype.indexOf,Ca=Array.prototype.includes,ci=Array.from,Tf=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,Ef=Object.getOwnPropertyDescriptors,Af=Object.prototype,Cf=Array.prototype,yc=Object.getPrototypeOf,Al=Object.isExtensible;const If=()=>{};function Rf(t){for(var e=0;e<t.length;e++)t[e]()}function _c(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Nt=2,ls=4,ui=8,bc=1<<24,dr=16,Bn=32,ua=64,wc=128,kn=512,It=1024,qt=2048,qn=4096,ln=8192,ur=16384,ms=32768,Ia=65536,Cl=1<<17,kc=1<<18,Ma=1<<19,Pf=1<<20,cr=1<<25,sa=65536,eo=1<<21,To=1<<22,Cr=1<<23,na=Symbol("$state"),Of=Symbol("legacy props"),Df=Symbol(""),Yr=new class extends Error{constructor(){super(...arguments);We(this,"name","StaleReactionError");We(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Mf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function jf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Lf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Nf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function qf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Bf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function zf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ff(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Kf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Uf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Gf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Hf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Wf=1,Yf=2,xc=4,Vf=8,Xf=16,Qf=1,Zf=4,Jf=8,$f=16,Sc=1,ed=2,Ot=Symbol(),Tc="http://www.w3.org/1999/xhtml";function td(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function nd(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ec(t){return t===this.v}function rd(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ac(t){return!rd(t,this.v)}let ad=!1,cn=null;function Ra(t){cn=t}function ct(t,e=!1,r){cn={p:cn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ut(t){var e=cn,r=e.e;if(r!==null){e.e=null;for(var a of r)Xc(a)}return t!==void 0&&(e.x=t),e.i=!0,cn=e.p,t??{}}function Cc(){return!0}let Vr=[];function Ic(){var t=Vr;Vr=[],Rf(t)}function Ir(t){if(Vr.length===0&&!rs){var e=Vr;queueMicrotask(()=>{e===Vr&&Ic()})}Vr.push(t)}function sd(){for(;Vr.length>0;)Ic()}function Rc(t){var e=nt;if(e===null)return Ve.f|=Cr,t;if((e.f&ms)===0&&(e.f&ls)===0)throw t;Pa(t,e)}function Pa(t,e){for(;e!==null;){if((e.f&wc)!==0){if((e.f&ms)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const id=-7169;function bt(t,e){t.f=t.f&id|e}function Eo(t){(t.f&kn)!==0||t.deps===null?bt(t,It):bt(t,qn)}function Pc(t){if(t!==null)for(const e of t)(e.f&Nt)===0||(e.f&sa)===0||(e.f^=sa,Pc(e.deps))}function Oc(t,e,r){(t.f&qt)!==0?e.add(t):(t.f&qn)!==0&&r.add(t),Pc(t.deps),bt(t,It)}const zs=new Set;let Ke=null,ei=null,Dt=null,Jt=[],fi=null,to=!1,rs=!1;var wa,ka,Qr,xa,ds,ps,Zr,sr,Sa,Zn,no,ro,Dc;const Jo=class Jo{constructor(){Ye(this,Zn);We(this,"committed",!1);We(this,"current",new Map);We(this,"previous",new Map);Ye(this,wa,new Set);Ye(this,ka,new Set);Ye(this,Qr,0);Ye(this,xa,0);Ye(this,ds,null);Ye(this,ps,new Set);Ye(this,Zr,new Set);Ye(this,sr,new Map);We(this,"is_fork",!1);Ye(this,Sa,!1)}is_deferred(){return this.is_fork||X(this,xa)>0}skip_effect(e){X(this,sr).has(e)||X(this,sr).set(e,{d:[],m:[]})}unskip_effect(e){var r=X(this,sr).get(e);if(r){X(this,sr).delete(e);for(var a of r.d)bt(a,qt),Ln(a);for(a of r.m)bt(a,qn),Ln(a)}}process(e){var i;Jt=[],this.apply();var r=[],a=[];for(const o of e)Kt(this,Zn,no).call(this,o,r,a);if(this.is_deferred()){Kt(this,Zn,ro).call(this,a),Kt(this,Zn,ro).call(this,r);for(const[o,u]of X(this,sr))Nc(o,u)}else{for(const o of X(this,wa))o();X(this,wa).clear(),X(this,Qr)===0&&Kt(this,Zn,Dc).call(this),ei=this,Ke=null,Il(a),Il(r),ei=null,(i=X(this,ds))==null||i.resolve()}Dt=null}capture(e,r){r!==Ot&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Cr)===0&&(this.current.set(e,e.v),Dt==null||Dt.set(e,e.v))}activate(){Ke=this,this.apply()}deactivate(){Ke===this&&(Ke=null,Dt=null)}flush(){if(this.activate(),Jt.length>0){if(Mc(),Ke!==null&&Ke!==this)return}else X(this,Qr)===0&&this.process([]);this.deactivate()}discard(){for(const e of X(this,ka))e(this);X(this,ka).clear()}increment(e){Ge(this,Qr,X(this,Qr)+1),e&&Ge(this,xa,X(this,xa)+1)}decrement(e){Ge(this,Qr,X(this,Qr)-1),e&&Ge(this,xa,X(this,xa)-1),!X(this,Sa)&&(Ge(this,Sa,!0),Ir(()=>{Ge(this,Sa,!1),this.is_deferred()?Jt.length>0&&this.flush():this.revive()}))}revive(){for(const e of X(this,ps))X(this,Zr).delete(e),bt(e,qt),Ln(e);for(const e of X(this,Zr))bt(e,qn),Ln(e);this.flush()}oncommit(e){X(this,wa).add(e)}ondiscard(e){X(this,ka).add(e)}settled(){return(X(this,ds)??Ge(this,ds,_c())).promise}static ensure(){if(Ke===null){const e=Ke=new Jo;zs.add(Ke),rs||Ir(()=>{Ke===e&&e.flush()})}return Ke}apply(){}};wa=new WeakMap,ka=new WeakMap,Qr=new WeakMap,xa=new WeakMap,ds=new WeakMap,ps=new WeakMap,Zr=new WeakMap,sr=new WeakMap,Sa=new WeakMap,Zn=new WeakSet,no=function(e,r,a){e.f^=It;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(Bn|ua))!==0,v=d&&(u&It)!==0,p=v||(u&ln)!==0||X(this,sr).has(i);if(!p&&i.fn!==null){d?i.f^=It:o!==null&&(u&(ls|ui|bc))!==0?o.b.defer_effect(i):(u&ls)!==0?r.push(i):ys(i)&&((u&dr)!==0&&X(this,Zr).add(i),Da(i));var y=i.first;if(y!==null){i=y;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},ro=function(e){for(var r=0;r<e.length;r+=1)Oc(e[r],X(this,ps),X(this,Zr))},Dc=function(){var i;if(zs.size>1){this.previous.clear();var e=Dt,r=!0;for(const o of zs){if(o===this){r=!1;continue}const u=[];for(const[v,p]of this.current){if(o.current.has(v))if(r&&p!==o.current.get(v))o.current.set(v,p);else continue;u.push(v)}if(u.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Jt;Jt=[];const v=new Set,p=new Map;for(const y of u)jc(y,d,v,p);if(Jt.length>0){Ke=o,o.apply();for(const y of Jt)Kt(i=o,Zn,no).call(i,y,[],[]);o.deactivate()}Jt=a}}Ke=null,Dt=e}this.committed=!0,zs.delete(this)};let Rr=Jo;function od(t){var e=rs;rs=!0;try{for(var r;;){if(sd(),Jt.length===0&&(Ke==null||Ke.flush(),Jt.length===0))return fi=null,r;Mc()}}finally{rs=e}}function Mc(){to=!0;var t=null;try{for(var e=0;Jt.length>0;){var r=Rr.ensure();if(e++>1e3){var a,i;ld()}r.process(Jt),Pr.clear()}}finally{Jt=[],to=!1,fi=null}}function ld(){try{zf()}catch(t){Pa(t,fi)}}let Pn=null;function Il(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(ur|ln))===0&&ys(a)&&(Pn=new Set,Da(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&$c(a),(Pn==null?void 0:Pn.size)>0)){Pr.clear();for(const i of Pn){if((i.f&(ur|ln))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)Pn.has(u)&&(Pn.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(ur|ln))===0&&Da(v)}}Pn.clear()}}Pn=null}}function jc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Nt)!==0?jc(i,e,r,a):(o&(To|dr))!==0&&(o&qt)===0&&Lc(i,e,a)&&(bt(i,qt),Ln(i))}}function Lc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ca.call(e,i))return!0;if((i.f&Nt)!==0&&Lc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Ln(t){for(var e=fi=t;e.parent!==null;){e=e.parent;var r=e.f;if(to&&e===nt&&(r&dr)!==0&&(r&kc)===0)return;if((r&(ua|Bn))!==0){if((r&It)===0)return;e.f^=It}}Jt.push(e)}function Nc(t,e){if(!((t.f&Bn)!==0&&(t.f&It)!==0)){(t.f&qt)!==0?e.d.push(t):(t.f&qn)!==0&&e.m.push(t),bt(t,It);for(var r=t.first;r!==null;)Nc(r,e),r=r.next}}function cd(t){let e=0,r=ia(0),a;return()=>{Io()&&(g(r),Ro(()=>(e===0&&(a=_s(()=>t(()=>as(r)))),e+=1,()=>{Ir(()=>{e-=1,e===0&&(a==null||a(),a=void 0,as(r))})})))}}var ud=Ia|Ma|wc;function fd(t,e,r){new dd(t,e,r)}var _n,xo,Wn,Jr,Yn,bn,Qt,Vn,ir,Er,$r,Ar,Ta,ea,Ea,Aa,or,oi,Rt,pd,hd,ao,Vs,Xs,so;class dd{constructor(e,r,a){Ye(this,Rt);We(this,"parent");We(this,"is_pending",!1);Ye(this,_n);Ye(this,xo,null);Ye(this,Wn);Ye(this,Jr);Ye(this,Yn);Ye(this,bn,null);Ye(this,Qt,null);Ye(this,Vn,null);Ye(this,ir,null);Ye(this,Er,null);Ye(this,$r,0);Ye(this,Ar,0);Ye(this,Ta,!1);Ye(this,ea,!1);Ye(this,Ea,new Set);Ye(this,Aa,new Set);Ye(this,or,null);Ye(this,oi,cd(()=>(Ge(this,or,ia(X(this,$r))),()=>{Ge(this,or,null)})));Ge(this,_n,e),Ge(this,Wn,r),Ge(this,Jr,a),this.parent=nt.b,this.is_pending=!!X(this,Wn).pending,Ge(this,Yn,Po(()=>{nt.b=this;{var i=Kt(this,Rt,ao).call(this);try{Ge(this,bn,wn(()=>a(i)))}catch(o){this.error(o)}X(this,Ar)>0?Kt(this,Rt,Xs).call(this):this.is_pending=!1}return()=>{var o;(o=X(this,Er))==null||o.remove()}},ud))}defer_effect(e){Oc(e,X(this,Ea),X(this,Aa))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!X(this,Wn).pending}update_pending_count(e){Kt(this,Rt,so).call(this,e),Ge(this,$r,X(this,$r)+e),!(!X(this,or)||X(this,Ta))&&(Ge(this,Ta,!0),Ir(()=>{Ge(this,Ta,!1),X(this,or)&&Oa(X(this,or),X(this,$r))}))}get_effect_pending(){return X(this,oi).call(this),g(X(this,or))}error(e){var r=X(this,Wn).onerror;let a=X(this,Wn).failed;if(X(this,ea)||!r&&!a)throw e;X(this,bn)&&(en(X(this,bn)),Ge(this,bn,null)),X(this,Qt)&&(en(X(this,Qt)),Ge(this,Qt,null)),X(this,Vn)&&(en(X(this,Vn)),Ge(this,Vn,null));var i=!1,o=!1;const u=()=>{if(i){nd();return}i=!0,o&&Hf(),Rr.ensure(),Ge(this,$r,0),X(this,Vn)!==null&&ra(X(this,Vn),()=>{Ge(this,Vn,null)}),this.is_pending=this.has_pending_snippet(),Ge(this,bn,Kt(this,Rt,Vs).call(this,()=>(Ge(this,ea,!1),wn(()=>X(this,Jr).call(this,X(this,_n)))))),X(this,Ar)>0?Kt(this,Rt,Xs).call(this):this.is_pending=!1};Ir(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){Pa(d,X(this,Yn)&&X(this,Yn).parent)}a&&Ge(this,Vn,Kt(this,Rt,Vs).call(this,()=>{Rr.ensure(),Ge(this,ea,!0);try{return wn(()=>{a(X(this,_n),()=>e,()=>u)})}catch(d){return Pa(d,X(this,Yn).parent),null}finally{Ge(this,ea,!1)}}))})}}_n=new WeakMap,xo=new WeakMap,Wn=new WeakMap,Jr=new WeakMap,Yn=new WeakMap,bn=new WeakMap,Qt=new WeakMap,Vn=new WeakMap,ir=new WeakMap,Er=new WeakMap,$r=new WeakMap,Ar=new WeakMap,Ta=new WeakMap,ea=new WeakMap,Ea=new WeakMap,Aa=new WeakMap,or=new WeakMap,oi=new WeakMap,Rt=new WeakSet,pd=function(){try{Ge(this,bn,wn(()=>X(this,Jr).call(this,X(this,_n))))}catch(e){this.error(e)}},hd=function(){const e=X(this,Wn).pending;e&&(Ge(this,Qt,wn(()=>e(X(this,_n)))),Ir(()=>{var r=Kt(this,Rt,ao).call(this);Ge(this,bn,Kt(this,Rt,Vs).call(this,()=>(Rr.ensure(),wn(()=>X(this,Jr).call(this,r))))),X(this,Ar)>0?Kt(this,Rt,Xs).call(this):(ra(X(this,Qt),()=>{Ge(this,Qt,null)}),this.is_pending=!1)}))},ao=function(){var e=X(this,_n);return this.is_pending&&(Ge(this,Er,fr()),X(this,_n).before(X(this,Er)),e=X(this,Er)),e},Vs=function(e){var r=nt,a=Ve,i=cn;Qn(X(this,Yn)),Sn(X(this,Yn)),Ra(X(this,Yn).ctx);try{return e()}catch(o){return Rc(o),null}finally{Qn(r),Sn(a),Ra(i)}},Xs=function(){const e=X(this,Wn).pending;X(this,bn)!==null&&(Ge(this,ir,document.createDocumentFragment()),X(this,ir).append(X(this,Er)),nu(X(this,bn),X(this,ir))),X(this,Qt)===null&&Ge(this,Qt,wn(()=>e(X(this,_n))))},so=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Kt(r=this.parent,Rt,so).call(r,e);return}if(Ge(this,Ar,X(this,Ar)+e),X(this,Ar)===0){this.is_pending=!1;for(const a of X(this,Ea))bt(a,qt),Ln(a);for(const a of X(this,Aa))bt(a,qn),Ln(a);X(this,Ea).clear(),X(this,Aa).clear(),X(this,Qt)&&ra(X(this,Qt),()=>{Ge(this,Qt,null)}),X(this,ir)&&(X(this,_n).before(X(this,ir)),Ge(this,ir,null))}};function vd(t,e,r,a){const i=di;var o=t.filter(k=>!k.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=Ke,d=nt,v=md(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(k=>k.promise)):null;function y(k){v();try{a(k)}catch(w){(d.f&ur)===0&&Pa(w,d)}u==null||u.deactivate(),io()}if(r.length===0){p.then(()=>y(e.map(i)));return}function x(){v(),Promise.all(r.map(k=>gd(k))).then(k=>y([...e.map(i),...k])).catch(k=>Pa(k,d))}p?p.then(x):x()}function md(){var t=nt,e=Ve,r=cn,a=Ke;return function(o=!0){Qn(t),Sn(e),Ra(r),o&&(a==null||a.activate())}}function io(){Qn(null),Sn(null),Ra(null)}function di(t){var e=Nt|qt,r=Ve!==null&&(Ve.f&Nt)!==0?Ve:null;return nt!==null&&(nt.f|=Ma),{ctx:cn,deps:null,effects:null,equals:Ec,f:e,fn:t,reactions:null,rv:0,v:Ot,wv:0,parent:r??nt,ac:null}}function gd(t,e,r){let a=nt;a===null&&jf();var i=a.b,o=void 0,u=ia(Ot),d=!Ve,v=new Map;return Pd(()=>{var w;var p=_c();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{y===Ke&&y.committed&&y.deactivate(),io()})}catch(O){p.reject(O),io()}var y=Ke;if(d){var x=i.is_rendered();i.update_pending_count(1),y.increment(x),(w=v.get(y))==null||w.reject(Yr),v.delete(y),v.set(y,p)}const k=(O,L=void 0)=>{if(y.activate(),L)L!==Yr&&(u.f|=Cr,Oa(u,L));else{(u.f&Cr)!==0&&(u.f^=Cr),Oa(u,O);for(const[T,K]of v){if(v.delete(T),T===y)break;K.reject(Yr)}}d&&(i.update_pending_count(-1),y.decrement(x))};p.promise.then(k,O=>k(null,O||"unknown"))}),Vc(()=>{for(const p of v.values())p.reject(Yr)}),new Promise(p=>{function y(x){function k(){x===o?p(u):y(o)}x.then(k,k)}y(o)})}function ft(t){const e=di(t);return ru(e),e}function qc(t){const e=di(t);return e.equals=Ac,e}function yd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)en(e[r])}}function _d(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&ur)===0?e:null;e=e.parent}return null}function Ao(t){var e,r=nt;Qn(_d(t));try{t.f&=~sa,yd(t),e=ou(t)}finally{Qn(r)}return e}function Bc(t){var e=Ao(t);if(!t.equals(e)&&(t.wv=su(),(!(Ke!=null&&Ke.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){bt(t,It);return}Or||(Dt!==null?(Io()||Ke!=null&&Ke.is_fork)&&Dt.set(t,e):Eo(t))}function bd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Yr),a.teardown=If,a.ac=null,cs(a,0),Oo(a))}function zc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Da(e)}let oo=new Set;const Pr=new Map;let Fc=!1;function ia(t,e){var r={f:0,v:t,reactions:null,equals:Ec,rv:0,wv:0};return r}function Pe(t,e){const r=ia(t);return ru(r),r}function wd(t,e=!1,r=!0){const a=ia(t);return e||(a.equals=Ac),a}function j(t,e,r=!1){Ve!==null&&(!Nn||(Ve.f&Cl)!==0)&&Cc()&&(Ve.f&(Nt|dr|To|Cl))!==0&&(xn===null||!Ca.call(xn,t))&&Gf();let a=r?Mt(e):e;return Oa(t,a)}function Oa(t,e){if(!t.equals(e)){var r=t.v;Or?Pr.set(t,e):Pr.set(t,r),t.v=e;var a=Rr.ensure();if(a.capture(t,r),(t.f&Nt)!==0){const i=t;(t.f&qt)!==0&&Ao(i),Eo(i)}t.wv=su(),Kc(t,qt),nt!==null&&(nt.f&It)!==0&&(nt.f&(Bn|ua))===0&&(yn===null?Dd([t]):yn.push(t)),!a.is_fork&&oo.size>0&&!Fc&&kd()}return e}function kd(){Fc=!1;for(const t of oo)(t.f&It)!==0&&bt(t,qn),ys(t)&&Da(t);oo.clear()}function as(t){j(t,t.v+1)}function Kc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&qt)===0;if(d&&bt(o,e),(u&Nt)!==0){var v=o;Dt==null||Dt.delete(v),(u&sa)===0&&(u&kn&&(o.f|=sa),Kc(v,qn))}else d&&((u&dr)!==0&&Pn!==null&&Pn.add(o),Ln(o))}}function Mt(t){if(typeof t!="object"||t===null||na in t)return t;const e=yc(t);if(e!==Af&&e!==Cf)return t;var r=new Map,a=So(t),i=Pe(0),o=aa,u=d=>{if(aa===o)return d();var v=Ve,p=aa;Sn(null),Ml(o);var y=d();return Sn(v),Ml(p),y};return a&&r.set("length",Pe(t.length)),new Proxy(t,{defineProperty(d,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Kf();var y=r.get(v);return y===void 0?u(()=>{var x=Pe(p.value);return r.set(v,x),x}):j(y,p.value,!0),!0},deleteProperty(d,v){var p=r.get(v);if(p===void 0){if(v in d){const y=u(()=>Pe(Ot));r.set(v,y),as(i)}}else j(p,Ot),as(i);return!0},get(d,v,p){var w;if(v===na)return t;var y=r.get(v),x=v in d;if(y===void 0&&(!x||(w=ba(d,v))!=null&&w.writable)&&(y=u(()=>{var O=Mt(x?d[v]:Ot),L=Pe(O);return L}),r.set(v,y)),y!==void 0){var k=g(y);return k===Ot?void 0:k}return Reflect.get(d,v,p)},getOwnPropertyDescriptor(d,v){var p=Reflect.getOwnPropertyDescriptor(d,v);if(p&&"value"in p){var y=r.get(v);y&&(p.value=g(y))}else if(p===void 0){var x=r.get(v),k=x==null?void 0:x.v;if(x!==void 0&&k!==Ot)return{enumerable:!0,configurable:!0,value:k,writable:!0}}return p},has(d,v){var k;if(v===na)return!0;var p=r.get(v),y=p!==void 0&&p.v!==Ot||Reflect.has(d,v);if(p!==void 0||nt!==null&&(!y||(k=ba(d,v))!=null&&k.writable)){p===void 0&&(p=u(()=>{var w=y?Mt(d[v]):Ot,O=Pe(w);return O}),r.set(v,p));var x=g(p);if(x===Ot)return!1}return y},set(d,v,p,y){var $;var x=r.get(v),k=v in d;if(a&&v==="length")for(var w=p;w<x.v;w+=1){var O=r.get(w+"");O!==void 0?j(O,Ot):w in d&&(O=u(()=>Pe(Ot)),r.set(w+"",O))}if(x===void 0)(!k||($=ba(d,v))!=null&&$.writable)&&(x=u(()=>Pe(void 0)),j(x,Mt(p)),r.set(v,x));else{k=x.v!==Ot;var L=u(()=>Mt(p));j(x,L)}var T=Reflect.getOwnPropertyDescriptor(d,v);if(T!=null&&T.set&&T.set.call(y,p),!k){if(a&&typeof v=="string"){var K=r.get("length"),oe=Number(v);Number.isInteger(oe)&&oe>=K.v&&j(K,oe+1)}as(i)}return!0},ownKeys(d){g(i);var v=Reflect.ownKeys(d).filter(x=>{var k=r.get(x);return k===void 0||k.v!==Ot});for(var[p,y]of r)y.v!==Ot&&!(p in d)&&v.push(p);return v},setPrototypeOf(){Uf()}})}function Rl(t){try{if(t!==null&&typeof t=="object"&&na in t)return t[na]}catch{}return t}function xd(t,e){return Object.is(Rl(t),Rl(e))}var Pl,Uc,Gc,Hc;function Sd(){if(Pl===void 0){Pl=window,Uc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Gc=ba(e,"firstChild").get,Hc=ba(e,"nextSibling").get,Al(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Al(r)&&(r.__t=void 0)}}function fr(t=""){return document.createTextNode(t)}function on(t){return Gc.call(t)}function gs(t){return Hc.call(t)}function b(t,e){return on(t)}function at(t,e=!1){{var r=on(t);return r instanceof Comment&&r.data===""?gs(r):r}}function S(t,e=1,r=!1){let a=t;for(;e--;)a=gs(a);return a}function Td(t){t.textContent=""}function Wc(){return!1}function Ed(t,e,r){return document.createElementNS(Tc,t,void 0)}let Ol=!1;function Ad(){Ol||(Ol=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Co(t){var e=Ve,r=nt;Sn(null),Qn(null);try{return t()}finally{Sn(e),Qn(r)}}function Yc(t,e,r,a=r){t.addEventListener(e,()=>Co(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),Ad()}function Cd(t){nt===null&&(Ve===null&&Bf(),qf()),Or&&Nf()}function Id(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function pr(t,e,r){var a=nt;a!==null&&(a.f&ln)!==0&&(t|=ln);var i={ctx:cn,deps:null,nodes:null,f:t|qt|kn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Da(i)}catch(d){throw en(i),d}else e!==null&&Ln(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ma)===0&&(o=o.first,(t&dr)!==0&&(t&Ia)!==0&&o!==null&&(o.f|=Ia)),o!==null&&(o.parent=a,a!==null&&Id(o,a),Ve!==null&&(Ve.f&Nt)!==0&&(t&ua)===0)){var u=Ve;(u.effects??(u.effects=[])).push(o)}return i}function Io(){return Ve!==null&&!Nn}function Vc(t){const e=pr(ui,null,!1);return bt(e,It),e.teardown=t,e}function ti(t){Cd();var e=nt.f,r=!Ve&&(e&Bn)!==0&&(e&ms)===0;if(r){var a=cn;(a.e??(a.e=[])).push(t)}else return Xc(t)}function Xc(t){return pr(ls|Pf,t,!1)}function Rd(t){Rr.ensure();const e=pr(ua|Ma,t,!0);return(r={})=>new Promise(a=>{r.outro?ra(e,()=>{en(e),a(void 0)}):(en(e),a(void 0))})}function Qc(t){return pr(ls,t,!1)}function Pd(t){return pr(To|Ma,t,!0)}function Ro(t,e=0){return pr(ui|e,t,!0)}function fe(t,e=[],r=[],a=[]){vd(a,e,r,i=>{pr(ui,()=>t(...i.map(g)),!0)})}function Po(t,e=0){var r=pr(dr|e,t,!0);return r}function wn(t){return pr(Bn|Ma,t,!0)}function Zc(t){var e=t.teardown;if(e!==null){const r=Or,a=Ve;Dl(!0),Sn(null);try{e.call(null)}finally{Dl(r),Sn(a)}}}function Oo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Co(()=>{i.abort(Yr)});var a=r.next;(r.f&ua)!==0?r.parent=null:en(r,e),r=a}}function Od(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Bn)===0&&en(e),e=r}}function en(t,e=!0){var r=!1;(e||(t.f&kc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Jc(t.nodes.start,t.nodes.end),r=!0),Oo(t,e&&!r),cs(t,0),bt(t,ur);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Zc(t);var i=t.parent;i!==null&&i.first!==null&&$c(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Jc(t,e){for(;t!==null;){var r=t===e?null:gs(t);t.remove(),t=r}}function $c(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ra(t,e,r=!0){var a=[];eu(t,a,!0);var i=()=>{r&&en(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function eu(t,e,r){if((t.f&ln)===0){t.f^=ln;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Ia)!==0||(i.f&Bn)!==0&&(t.f&dr)!==0;eu(i,e,u?r:!1),i=o}}}function Do(t){tu(t,!0)}function tu(t,e){if((t.f&ln)!==0){t.f^=ln,(t.f&It)===0&&(bt(t,qt),Ln(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ia)!==0||(r.f&Bn)!==0;tu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function nu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:gs(r);e.append(r),r=i}}let Qs=!1,Or=!1;function Dl(t){Or=t}let Ve=null,Nn=!1;function Sn(t){Ve=t}let nt=null;function Qn(t){nt=t}let xn=null;function ru(t){Ve!==null&&(xn===null?xn=[t]:xn.push(t))}let $t=null,an=0,yn=null;function Dd(t){yn=t}let au=1,Xr=0,aa=Xr;function Ml(t){aa=t}function su(){return++au}function ys(t){var e=t.f;if((e&qt)!==0)return!0;if(e&Nt&&(t.f&=~sa),(e&qn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(ys(o)&&Bc(o),o.wv>t.wv)return!0}(e&kn)!==0&&Dt===null&&bt(t,It)}return!1}function iu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(xn!==null&&Ca.call(xn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Nt)!==0?iu(o,e,!1):e===o&&(r?bt(o,qt):(o.f&It)!==0&&bt(o,qn),Ln(o))}}function ou(t){var L;var e=$t,r=an,a=yn,i=Ve,o=xn,u=cn,d=Nn,v=aa,p=t.f;$t=null,an=0,yn=null,Ve=(p&(Bn|ua))===0?t:null,xn=null,Ra(t.ctx),Nn=!1,aa=++Xr,t.ac!==null&&(Co(()=>{t.ac.abort(Yr)}),t.ac=null);try{t.f|=eo;var y=t.fn,x=y();t.f|=ms;var k=t.deps,w=Ke==null?void 0:Ke.is_fork;if($t!==null){var O;if(w||cs(t,an),k!==null&&an>0)for(k.length=an+$t.length,O=0;O<$t.length;O++)k[an+O]=$t[O];else t.deps=k=$t;if(Io()&&(t.f&kn)!==0)for(O=an;O<k.length;O++)((L=k[O]).reactions??(L.reactions=[])).push(t)}else!w&&k!==null&&an<k.length&&(cs(t,an),k.length=an);if(Cc()&&yn!==null&&!Nn&&k!==null&&(t.f&(Nt|qn|qt))===0)for(O=0;O<yn.length;O++)iu(yn[O],t);if(i!==null&&i!==t){if(Xr++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=Xr;if(e!==null)for(const T of e)T.rv=Xr;yn!==null&&(a===null?a=yn:a.push(...yn))}return(t.f&Cr)!==0&&(t.f^=Cr),x}catch(T){return Rc(T)}finally{t.f^=eo,$t=e,an=r,yn=a,Ve=i,xn=o,Ra(u),Nn=d,aa=v}}function Md(t,e){let r=e.reactions;if(r!==null){var a=Sf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Nt)!==0&&($t===null||!Ca.call($t,e))){var o=e;(o.f&kn)!==0&&(o.f^=kn,o.f&=~sa),Eo(o),bd(o),cs(o,0)}}function cs(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Md(t,r[a])}function Da(t){var e=t.f;if((e&ur)===0){bt(t,It);var r=nt,a=Qs;nt=t,Qs=!0;try{(e&(dr|bc))!==0?Od(t):Oo(t),Zc(t);var i=ou(t);t.teardown=typeof i=="function"?i:null,t.wv=au;var o;$i&&ad&&(t.f&qt)!==0&&t.deps}finally{Qs=a,nt=r}}}async function lu(){await Promise.resolve(),od()}function g(t){var e=t.f,r=(e&Nt)!==0;if(Ve!==null&&!Nn){var a=nt!==null&&(nt.f&ur)!==0;if(!a&&(xn===null||!Ca.call(xn,t))){var i=Ve.deps;if((Ve.f&eo)!==0)t.rv<Xr&&(t.rv=Xr,$t===null&&i!==null&&i[an]===t?an++:$t===null?$t=[t]:$t.push(t));else{(Ve.deps??(Ve.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ve]:Ca.call(o,Ve)||o.push(Ve)}}}if(Or&&Pr.has(t))return Pr.get(t);if(r){var u=t;if(Or){var d=u.v;return((u.f&It)===0&&u.reactions!==null||uu(u))&&(d=Ao(u)),Pr.set(u,d),d}var v=(u.f&kn)===0&&!Nn&&Ve!==null&&(Qs||(Ve.f&kn)!==0),p=(u.f&ms)===0;ys(u)&&(v&&(u.f|=kn),Bc(u)),v&&!p&&(zc(u),cu(u))}if(Dt!=null&&Dt.has(t))return Dt.get(t);if((t.f&Cr)!==0)throw t.v;return t.v}function cu(t){if(t.f|=kn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&kn)===0&&(zc(e),cu(e))}function uu(t){if(t.v===Ot)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Pr.has(e)||(e.f&Nt)!==0&&uu(e))return!0;return!1}function _s(t){var e=Nn;try{return Nn=!0,t()}finally{Nn=e}}const jd=["touchstart","touchmove"];function Ld(t){return jd.includes(t)}const fu=new Set,lo=new Set;function Pt(t){for(var e=0;e<t.length;e++)fu.add(t[e]);for(var r of lo)r(t)}let jl=null;function Ll(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;jl=t;var u=0,d=jl===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;v<=p&&(u=v)}if(o=i[u]||t.target,o!==e){Tf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Ve,x=nt;Sn(null),Qn(null);try{for(var k,w=[];o!==null;){var O=o.assignedSlot||o.parentNode||o.host||null;try{var L=o["__"+a];L!=null&&(!o.disabled||t.target===o)&&L.call(o,t)}catch(K){k?w.push(K):k=K}if(t.cancelBubble||O===e||O===null)break;o=O}if(k){for(let K of w)queueMicrotask(()=>{throw K});throw k}}finally{t.__root=e,delete t.currentTarget,Sn(y),Qn(x)}}}var vc,mc;const Fi=(mc=(vc=globalThis==null?void 0:globalThis.window)==null?void 0:vc.trustedTypes)==null?void 0:mc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Nd(t){return(Fi==null?void 0:Fi.createHTML(t))??t}function Mo(t,e=!1){var r=Ed("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Nd(t):t,r.content}function oa(t,e){var r=nt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function H(t,e){var r=(e&Sc)!==0,a=(e&ed)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Mo(o?t:"<!>"+t,!0),r||(i=on(i)));var u=a||Uc?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=on(u),v=u.lastChild;oa(d,v)}else oa(u,u);return u}}function qd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Sc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=Mo(o,!0),v=on(d);if(i)for(u=document.createDocumentFragment();on(v);)u.appendChild(on(v));else u=on(v)}var p=u.cloneNode(!0);if(i){var y=on(p),x=p.lastChild;oa(y,x)}else oa(p,p);return p}}function jo(t,e){return qd(t,e,"svg")}function Nl(t=""){{var e=fr(t+"");return oa(e,e),e}}function fa(){var t=document.createDocumentFragment(),e=document.createComment(""),r=fr();return t.append(e,r),oa(e,r),t}function F(t,e){t!==null&&t.before(e)}function se(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Bd(t,e){return zd(t,e)}const Fs=new Map;function zd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Sd();var d=new Set,v=x=>{for(var k=0;k<x.length;k++){var w=x[k];if(!d.has(w)){d.add(w);var O=Ld(w);for(const K of[e,document]){var L=Fs.get(K);L===void 0&&(L=new Map,Fs.set(K,L));var T=L.get(w);T===void 0?(K.addEventListener(w,Ll,{passive:O}),L.set(w,1)):L.set(w,T+1)}}}};v(ci(fu)),lo.add(v);var p=void 0,y=Rd(()=>{var x=r??e.appendChild(fr());return fd(x,{pending:()=>{}},k=>{ct({});var w=cn;o&&(w.c=o),i&&(a.$$events=i),p=t(k,a)||{},ut()}),()=>{var L;for(var k of d)for(const T of[e,document]){var w=Fs.get(T),O=w.get(k);--O==0?(T.removeEventListener(k,Ll),w.delete(k),w.size===0&&Fs.delete(T)):w.set(k,O)}lo.delete(v),x!==r&&((L=x.parentNode)==null||L.removeChild(x))}});return Fd.set(p,y),p}let Fd=new WeakMap;var Dn,Xn,sn,ta,hs,vs,li;class Kd{constructor(e,r=!0){We(this,"anchor");Ye(this,Dn,new Map);Ye(this,Xn,new Map);Ye(this,sn,new Map);Ye(this,ta,new Set);Ye(this,hs,!0);Ye(this,vs,()=>{var e=Ke;if(X(this,Dn).has(e)){var r=X(this,Dn).get(e),a=X(this,Xn).get(r);if(a)Do(a),X(this,ta).delete(r);else{var i=X(this,sn).get(r);i&&(X(this,Xn).set(r,i.effect),X(this,sn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of X(this,Dn)){if(X(this,Dn).delete(o),o===e)break;const d=X(this,sn).get(u);d&&(en(d.effect),X(this,sn).delete(u))}for(const[o,u]of X(this,Xn)){if(o===r||X(this,ta).has(o))continue;const d=()=>{if(Array.from(X(this,Dn).values()).includes(o)){var p=document.createDocumentFragment();nu(u,p),p.append(fr()),X(this,sn).set(o,{effect:u,fragment:p})}else en(u);X(this,ta).delete(o),X(this,Xn).delete(o)};X(this,hs)||!a?(X(this,ta).add(o),ra(u,d,!1)):d()}}});Ye(this,li,e=>{X(this,Dn).delete(e);const r=Array.from(X(this,Dn).values());for(const[a,i]of X(this,sn))r.includes(a)||(en(i.effect),X(this,sn).delete(a))});this.anchor=e,Ge(this,hs,r)}ensure(e,r){var a=Ke,i=Wc();if(r&&!X(this,Xn).has(e)&&!X(this,sn).has(e))if(i){var o=document.createDocumentFragment(),u=fr();o.append(u),X(this,sn).set(e,{effect:wn(()=>r(u)),fragment:o})}else X(this,Xn).set(e,wn(()=>r(this.anchor)));if(X(this,Dn).set(a,e),i){for(const[d,v]of X(this,Xn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of X(this,sn))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(X(this,vs)),a.ondiscard(X(this,li))}else X(this,vs).call(this)}}Dn=new WeakMap,Xn=new WeakMap,sn=new WeakMap,ta=new WeakMap,hs=new WeakMap,vs=new WeakMap,li=new WeakMap;function _e(t,e,r=!1){var a=new Kd(t),i=r?Ia:0;function o(u,d){a.ensure(u,d)}Po(()=>{var u=!1;e((d,v=0)=>{u=!0,o(v,d)}),u||o(!1,null)},i)}function hr(t,e){return e}function Ud(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let x=e[d];ra(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var k=t.outrogroups;co(ci(o.done)),k.delete(o),k.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var v=a.length===0&&r!==null;if(v){var p=r,y=p.parentNode;Td(y),y.append(p),t.items.clear()}co(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function co(t,e=!0){for(var r=0;r<t.length;r++)en(t[r],e)}var ql;function nn(t,e,r,a,i,o=null){var u=t,d=new Map,v=(e&xc)!==0;if(v){var p=t;u=p.appendChild(fr())}var y=null,x=qc(()=>{var K=r();return So(K)?K:K==null?[]:ci(K)}),k,w=!0;function O(){T.fallback=y,Gd(T,k,u,e,a),y!==null&&(k.length===0?(y.f&cr)===0?Do(y):(y.f^=cr,ts(y,null,u)):ra(y,()=>{y=null}))}var L=Po(()=>{k=g(x);for(var K=k.length,oe=new Set,$=Ke,Y=Wc(),Z=0;Z<K;Z+=1){var J=k[Z],U=a(J,Z),ce=w?null:d.get(U);ce?(ce.v&&Oa(ce.v,J),ce.i&&Oa(ce.i,Z),Y&&$.unskip_effect(ce.e)):(ce=Hd(d,w?u:ql??(ql=fr()),J,U,Z,i,e,r),w||(ce.e.f|=cr),d.set(U,ce)),oe.add(U)}if(K===0&&o&&!y&&(w?y=wn(()=>o(u)):(y=wn(()=>o(ql??(ql=fr()))),y.f|=cr)),K>oe.size&&Lf(),!w)if(Y){for(const[ye,Te]of d)oe.has(ye)||$.skip_effect(Te.e);$.oncommit(O),$.ondiscard(()=>{})}else O();g(x)}),T={effect:L,items:d,outrogroups:null,fallback:y};w=!1}function Ya(t){for(;t!==null&&(t.f&Bn)===0;)t=t.next;return t}function Gd(t,e,r,a,i){var Te,ge,ae,ue,Re,re,le,de,Q;var o=(a&Vf)!==0,u=e.length,d=t.items,v=Ya(t.effect.first),p,y=null,x,k=[],w=[],O,L,T,K;if(o)for(K=0;K<u;K+=1)O=e[K],L=i(O,K),T=d.get(L).e,(T.f&cr)===0&&((ge=(Te=T.nodes)==null?void 0:Te.a)==null||ge.measure(),(x??(x=new Set)).add(T));for(K=0;K<u;K+=1){if(O=e[K],L=i(O,K),T=d.get(L).e,t.outrogroups!==null)for(const ie of t.outrogroups)ie.pending.delete(T),ie.done.delete(T);if((T.f&cr)!==0)if(T.f^=cr,T===v)ts(T,null,r);else{var oe=y?y.next:v;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),Sr(t,y,T),Sr(t,T,oe),ts(T,oe,r),y=T,k=[],w=[],v=Ya(y.next);continue}if((T.f&ln)!==0&&(Do(T),o&&((ue=(ae=T.nodes)==null?void 0:ae.a)==null||ue.unfix(),(x??(x=new Set)).delete(T))),T!==v){if(p!==void 0&&p.has(T)){if(k.length<w.length){var $=w[0],Y;y=$.prev;var Z=k[0],J=k[k.length-1];for(Y=0;Y<k.length;Y+=1)ts(k[Y],$,r);for(Y=0;Y<w.length;Y+=1)p.delete(w[Y]);Sr(t,Z.prev,J.next),Sr(t,y,Z),Sr(t,J,$),v=$,y=J,K-=1,k=[],w=[]}else p.delete(T),ts(T,v,r),Sr(t,T.prev,T.next),Sr(t,T,y===null?t.effect.first:y.next),Sr(t,y,T),y=T;continue}for(k=[],w=[];v!==null&&v!==T;)(p??(p=new Set)).add(v),w.push(v),v=Ya(v.next);if(v===null)continue}(T.f&cr)===0&&k.push(T),y=T,v=Ya(T.next)}if(t.outrogroups!==null){for(const ie of t.outrogroups)ie.pending.size===0&&(co(ci(ie.done)),(Re=t.outrogroups)==null||Re.delete(ie));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||p!==void 0){var U=[];if(p!==void 0)for(T of p)(T.f&ln)===0&&U.push(T);for(;v!==null;)(v.f&ln)===0&&v!==t.fallback&&U.push(v),v=Ya(v.next);var ce=U.length;if(ce>0){var ye=(a&xc)!==0&&u===0?r:null;if(o){for(K=0;K<ce;K+=1)(le=(re=U[K].nodes)==null?void 0:re.a)==null||le.measure();for(K=0;K<ce;K+=1)(Q=(de=U[K].nodes)==null?void 0:de.a)==null||Q.fix()}Ud(t,U,ye)}}o&&Ir(()=>{var ie,ve;if(x!==void 0)for(T of x)(ve=(ie=T.nodes)==null?void 0:ie.a)==null||ve.apply()})}function Hd(t,e,r,a,i,o,u,d){var v=(u&Wf)!==0?(u&Xf)===0?wd(r,!1,!1):ia(r):null,p=(u&Yf)!==0?ia(i):null;return{v,i:p,e:wn(()=>(o(e,v??r,p??i,d),()=>{t.delete(a)}))}}function ts(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&cr)===0?e.nodes.start:r;a!==null;){var u=gs(a);if(o.before(a),a===i)return;a=u}}function Sr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Wd(t,e,r=!1,a=!1,i=!1){var o=t,u="";fe(()=>{var d=nt;if(u!==(u=e()??"")&&(d.nodes!==null&&(Jc(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var v=u+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var p=Mo(v);if((r||a)&&(p=on(p)),oa(on(p),p.lastChild),r||a)for(;on(p);)o.before(on(p));else o.before(p)}})}const Bl=[...` 	
\r\fÂ \v\uFEFF`];function Yd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||Bl.includes(a[u-1]))&&(d===a.length||Bl.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function zl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Ki(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Vd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(Ki)),i&&v.push(...Object.keys(i).map(Ki));var p=0,y=-1;const L=t.length;for(var x=0;x<L;x++){var k=t[x];if(d?k==="/"&&t[x-1]==="*"&&(d=!1):o?o===k&&(o=!1):k==="/"&&t[x+1]==="*"?d=!0:k==='"'||k==="'"?o=k:k==="("?u++:k===")"&&u--,!d&&o===!1&&u===0){if(k===":"&&y===-1)y=x;else if(k===";"||x===L-1){if(y!==-1){var w=Ki(t.substring(p,y).trim());if(!v.includes(w)){k!==";"&&x++;var O=t.substring(p,x).trim();r+=" "+O+";"}}p=x+1,y=-1}}}}return a&&(r+=zl(a)),i&&(r+=zl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function jt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=Yd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var p=!!o[v];(i==null||p!==!!i[v])&&t.classList.toggle(v,p)}return o}function Ui(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function tn(t,e,r,a){var i=t.__style;if(i!==e){var o=Vd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Ui(t,r==null?void 0:r[0],a[0]),Ui(t,r==null?void 0:r[1],a[1],"important")):Ui(t,r,a));return a}function du(t,e,r=!1){if(t.multiple){if(e==null)return;if(!So(e))return td();for(var a of t.options)a.selected=e.includes(ss(a));return}for(a of t.options){var i=ss(a);if(xd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Xd(t){var e=new MutationObserver(()=>{du(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Vc(()=>{e.disconnect()})}function Lo(t,e,r=e){var a=new WeakSet,i=!0;Yc(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),ss);else{var v=t.querySelector(u)??t.querySelector("option:not([disabled])");d=v&&ss(v)}r(d),Ke!==null&&a.add(Ke)}),Qc(()=>{var o=e();if(t===document.activeElement){var u=ei??Ke;if(a.has(u))return}if(du(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=ss(d),r(o))}t.__value=o,i=!1}),Xd(t)}function ss(t){return"__value"in t?t.__value:t.value}const Qd=Symbol("is custom element"),Zd=Symbol("is html");function pu(t,e,r,a){var i=Jd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Df]=r),r==null?t.removeAttribute(e):typeof r!="string"&&$d(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Jd(t){return t.__attributes??(t.__attributes={[Qd]:t.nodeName.includes("-"),[Zd]:t.namespaceURI===Tc})}var Fl=new Map;function $d(t){var e=t.getAttribute("is")||t.nodeName,r=Fl.get(e);if(r)return r;Fl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=Ef(i);for(var u in a)a[u].set&&r.push(u);i=yc(i)}return r}function No(t,e,r=e){var a=new WeakSet;Yc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Gi(t)?Hi(o):o,r(o),Ke!==null&&a.add(Ke),await lu(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;u===d&&d===v&&p>v?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=u,t.selectionEnd=Math.min(d,p))}}}),_s(e)==null&&t.value&&(r(Gi(t)?Hi(t.value):t.value),Ke!==null&&a.add(Ke)),Ro(()=>{var i=e();if(t===document.activeElement){var o=ei??Ke;if(a.has(o))return}Gi(t)&&i===Hi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Gi(t){var e=t.type;return e==="number"||e==="range"}function Hi(t){return t===""?null:+t}function Kl(t,e){return t===e||(t==null?void 0:t[na])===e}function hu(t={},e,r,a){return Qc(()=>{var i,o;return Ro(()=>{i=o,o=[],_s(()=>{t!==r(...o)&&(e(t,...o),i&&Kl(r(...i),t)&&e(null,...i))})}),()=>{Ir(()=>{o&&Kl(r(...o),t)&&e(null,...o)})}}),t}let Ks=!1;function ep(t){var e=Ks;try{return Ks=!1,[t(),Ks]}finally{Ks=e}}function Ie(t,e,r,a){var oe;var i=(r&Jf)!==0,o=(r&$f)!==0,u=a,d=!0,v=()=>(d&&(d=!1,u=o?_s(a):a),u),p;if(i){var y=na in t||Of in t;p=((oe=ba(t,e))==null?void 0:oe.set)??(y&&e in t?$=>t[e]=$:void 0)}var x,k=!1;i?[x,k]=ep(()=>t[e]):x=t[e],x===void 0&&a!==void 0&&(x=v(),p&&(Ff(),p(x)));var w;if(w=()=>{var $=t[e];return $===void 0?v():(d=!0,$)},(r&Zf)===0)return w;if(p){var O=t.$$legacy;return(function($,Y){return arguments.length>0?((!Y||O||k)&&p(Y?w():$),$):w()})}var L=!1,T=((r&Qf)!==0?di:qc)(()=>(L=!1,w()));i&&g(T);var K=nt;return(function($,Y){if(arguments.length>0){const Z=Y?g(T):i?Mt($):$;return j(T,Z),L=!0,u!==void 0&&(u=Z),$}return Or&&L||(K.f&ur)!==0?T.v:g(T)})}function Bt(t){cn===null&&Mf(),ti(()=>{const e=_s(t);if(typeof e=="function")return e})}const tp="5";var gc;typeof window<"u"&&((gc=window.__svelte??(window.__svelte={})).v??(gc.v=new Set)).add(tp);const us=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Zt=null,lr="idle",Zs=null,Hr=new Set;function Us(){return Zt||(Zt=new Worker(new URL(""+new URL("worker-CdBv0KP2.js",import.meta.url).href,import.meta.url),{type:"module"}),Zt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(lr="loading"),e.status==="ready"&&(lr="ready"),e.status==="start"&&(lr="generating"),(e.status==="complete"||e.status==="error")&&(lr=Zs?"ready":"idle");for(const r of Hr)try{r(e)}catch{}})),Zt}function vu(){return{check(){Us().postMessage({type:"check"})},loadModel(t){Zs=t,lr="loading",Us().postMessage({type:"load",modelId:t})},generate(t,e){Us().postMessage({type:"generate",data:t,options:e})},generateFull(t,e){return new Promise((r,a)=>{let i="";const o=d=>{switch(d.status){case"thinking":break;case"thinking-done":break;case"update":i+=d.output;break;case"complete":u(),r(i);break;case"error":u(),a(new Error(d.data));break}},u=()=>{Hr.delete(o)};Hr.add(o),Us().postMessage({type:"generate",data:t,options:e})})},interrupt(){Zt==null||Zt.postMessage({type:"interrupt"})},reset(){Zt==null||Zt.postMessage({type:"reset"})},onMessage(t){return Hr.add(t),()=>Hr.delete(t)},offMessage(t){Hr.delete(t)},get status(){return lr},get isReady(){return lr==="ready"},get isGenerating(){return lr==="generating"},get modelId(){return Zs},terminate(){Zt==null||Zt.terminate(),Zt=null,lr="idle",Zs=null,Hr.clear()}}}var np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Js={exports:{}},ap=Js.exports,Ul;function sp(){return Ul||(Ul=1,(function(t,e){((r,a)=>{t.exports=a()})(ap,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,h=s.length;f<h;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:np,u=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,y={}.hasOwnProperty;function x(n,s){return y.call(n,s)}function k(n,s){typeof s=="function"&&(s=s(p(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){O(n,l,s[l])})}var w=Object.defineProperty;function O(n,s,l,c){w(n,s,v(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function L(n){return{from:function(s){return n.prototype=Object.create(s.prototype),O(n.prototype,"constructor",n),{extend:k.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,K=[].slice;function oe(n,s,l){return K.call(n,s,l)}function $(n,s){return s(n)}function Y(n){if(!n)throw new Error("Assertion Failed")}function Z(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function J(n,s){if(typeof s=="string"&&x(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var h=J(n,s[c]);l.push(h)}return l}var m,_=s.indexOf(".");return _===-1||(m=n[s.substr(0,_)])==null?void 0:J(m,s.substr(_+1))}function U(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){Y(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)U(n,s[c],l[c])}else{var h,m,_=s.indexOf(".");_!==-1?(h=s.substr(0,_),(_=s.substr(_+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:U(m=(m=n[h])&&x(n,h)?m:n[h]={},_,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ce(n){var s,l={};for(s in n)x(n,s)&&(l[s]=n[s]);return l}var ye=[].concat;function Te(n){return ye.apply([],n)}var V="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Te([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ge=new Set(V.map(function(n){return o[n]})),ae=null;function ue(n){return ae=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=ae.get(l);if(c)return c;if(d(l)){c=[],ae.set(l,c);for(var f=0,h=l.length;f<h;++f)c.push(s(l[f]))}else if(ge.has(l.constructor))c=l;else{var m,_=p(l);for(m in c=_===Object.prototype?{}:Object.create(_),ae.set(l,c),l)x(l,m)&&(c[m]=s(l[m]))}return c})(n),ae=null,n}var Re={}.toString;function re(n){return Re.call(n).slice(8,-1)}var le=typeof Symbol<"u"?Symbol.iterator:"@@iterator",de=typeof le=="symbol"?function(n){var s;return n!=null&&(s=n[le])&&s.apply(n)}:function(){return null};function Q(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ie={};function ve(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ie&&typeof n=="string")return[n];if(f=de(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var be=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},V=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],kt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(V),te={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(n,s){this.name=n,this.message=s}function ne(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function Le(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=ne(n,s)}function Fe(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=ne(n,this.failures)}L(W).from(Error).extend({toString:function(){return this.name+": "+this.message}}),L(Le).from(W),L(Fe).from(W);var rt=kt.reduce(function(n,s){return n[s]=s+"Error",n},{}),St=W,B=kt.reduce(function(n,s){var l=s+"Error";function c(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=te[s]||l,this.inner=null)}return L(c).from(St),n[s]=c,n},{}),Ae=(B.Syntax=SyntaxError,B.Type=TypeError,B.Range=RangeError,V.reduce(function(n,s){return n[s+"Error"]=B[s],n},{}));V=kt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=B[s]),n},{});function De(){}function Be(n){return n}function Tt(n,s){return n==null||n===Be?s:function(l){return s(n(l))}}function ht(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function fn(n,s){return n===De?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?ht(c,this.onsuccess):c),f&&(this.onerror=this.onerror?ht(f,this.onerror):f),h!==void 0?h:l}}function Jn(n,s){return n===De?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?ht(l,this.onsuccess):l),c&&(this.onerror=this.onerror?ht(c,this.onerror):c)}}function dn(n,s){return n===De?s:function(f){var c=n.apply(this,arguments),f=(v(f,c),this.onsuccess),h=this.onerror,m=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?ht(f,this.onsuccess):f),h&&(this.onerror=this.onerror?ht(h,this.onerror):h),c===void 0?m===void 0?void 0:m:v(c,m)}}function Gt(n,s){return n===De?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function wt(n,s){return n===De?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return s.apply(c,h)})}return s.apply(this,arguments)}}V.ModifyError=Le,V.DexieError=W,V.BulkError=Fe;var mt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pn(n){mt=n}var hn={},zn=100,En=typeof Promise>"u"?[]:(kt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[En=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(En),kt]:[kt,p(kt),kt]),kt=En[0],ya=En[1],ya=ya&&ya.then,Et=kt&&kt.constructor,Mr=!!En[2],vr=function(n,s){er.push([n,s]),mr&&(queueMicrotask(_r),mr=!1)},pa=!0,mr=!0,Fn=[],$n=[],gr=Be,At={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:De,pgp:!1,env:{},finalize:De},je=At,er=[],An=0,ha=[];function Ee(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=je;if(typeof n!="function"){if(n!==hn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&tr(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(h){if(c._state===null){if(h===c)throw new TypeError("A promise cannot be resolved with itself.");var m=c._lib&&br();h&&typeof h.then=="function"?l(c,function(_,I){h instanceof Ee?h._then(_,I):h.then(_,I)}):(c._state=!0,c._value=h,ks(c)),m&&nr()}},tr.bind(null,c))}catch(h){tr(c,h)}})(this,n)}var yr={get:function(){var n=je,s=qr;function l(c,f){var h=this,m=!n.global&&(n!==je||s!==qr),_=m&&!In(),I=new Ee(function(q,R){ja(h,new ws(A(c,n,m,_),A(f,n,m,_),q,R,n))});return this._consoleTask&&(I._consoleTask=this._consoleTask),I}return l.prototype=hn,l},set:function(n){O(this,"then",n&&n.prototype===hn?yr:{get:function(){return n},set:yr.set})}};function ws(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function tr(n,s){var l,c;$n.push(s),n._state===null&&(l=n._lib&&br(),s=gr(s),n._state=!1,n._value=s,c=n,Fn.some(function(f){return f._value===c._value})||Fn.push(c),ks(n),l)&&nr()}function ks(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)ja(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),An===0&&(++An,vr(function(){--An==0&&jr()},[]))}function ja(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++An,vr(gt,[l,n,s])}}function gt(n,s,l){try{var c,f=s._value;!s._state&&$n.length&&($n=[]),c=mt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||$n.indexOf(f)!==-1||(h=>{for(var m=Fn.length;m;)if(Fn[--m]._value===h._value)return Fn.splice(m,1)})(s),l.resolve(c)}catch(h){l.reject(h)}finally{--An==0&&jr(),--l.psd.ref||l.psd.finalize()}}function _r(){Ne(At,function(){br()&&nr()})}function br(){var n=pa;return mr=pa=!1,n}function nr(){var n,s,l;do for(;0<er.length;)for(n=er,er=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<er.length);mr=pa=!0}function jr(){for(var n=Fn,s=(Fn=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),ha.slice(0)),l=s.length;l;)s[--l]()}function Lr(n){return new Ee(hn,!1,n)}function st(n,s){var l=je;return function(){var c=br(),f=je;try{return Rn(l,!0),n.apply(this,arguments)}catch(h){s&&s(h)}finally{Rn(f,!1),c&&nr()}}}k(Ee.prototype,{then:yr,_then:function(n,s){ja(this,new ws(null,null,n,s,je))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:Lr)(c)}):this.then(null,function(c){return(c&&c.name===s?l:Lr)(c)}))},finally:function(n){return this.then(function(s){return Ee.resolve(n()).then(function(){return s})},function(s){return Ee.resolve(n()).then(function(){return Lr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ee(function(c,f){var h=setTimeout(function(){return f(new B.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&O(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),At.env=Ss(),k(Ee,{all:function(){var n=ve.apply(null,arguments).map(Br);return new Ee(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,h){return Ee.resolve(f).then(function(m){n[h]=m,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ee?n:n&&typeof n.then=="function"?new Ee(function(s,l){n.then(s,l)}):new Ee(hn,!0,n)},reject:Lr,race:function(){var n=ve.apply(null,arguments).map(Br);return new Ee(function(s,l){n.map(function(c){return Ee.resolve(c).then(s,l)})})},PSD:{get:function(){return je},set:function(n){return je=n}},totalEchoes:{get:function(){return qr}},newPSD:Cn,usePSD:Ne,scheduler:{get:function(){return vr},set:function(n){vr=n}},rejectionMapper:{get:function(){return gr},set:function(n){gr=n}},follow:function(n,s){return new Ee(function(l,c){return Cn(function(f,h){var m=je;m.unhandleds=[],m.onunhandled=h,m.finalize=ht(function(){var _,I=this;_=function(){I.unhandleds.length===0?f():h(I.unhandleds[0])},ha.push(function q(){_(),ha.splice(ha.indexOf(q),1)}),++An,vr(function(){--An==0&&jr()},[])},m.finalize),n()},s,l,c)})}}),Et&&(Et.allSettled&&O(Ee,"allSettled",function(){var n=ve.apply(null,arguments).map(Br);return new Ee(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,h){return Ee.resolve(f).then(function(m){return c[h]={status:"fulfilled",value:m}},function(m){return c[h]={status:"rejected",reason:m}}).then(function(){return--l||s(c)})})})}),Et.any&&typeof AggregateError<"u"&&O(Ee,"any",function(){var n=ve.apply(null,arguments).map(Br);return new Ee(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(h,m){return Ee.resolve(h).then(function(_){return s(_)},function(_){f[m]=_,--c||l(new AggregateError(f))})})})}),Et.withResolvers)&&(Ee.withResolvers=Et.withResolvers);var xt={awaits:0,echoes:0,id:0},vn=0,mn=[],Nr=0,qr=0,La=0;function Cn(n,m,l,c){var f=je,h=Object.create(f),m=(h.parent=f,h.ref=0,h.global=!1,h.id=++La,At.env,h.env=Mr?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},m&&v(h,m),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Ne(h,n,l,c));return h.ref===0&&h.finalize(),m}function zt(){return xt.id||(xt.id=++vn),++xt.awaits,xt.echoes+=zn,xt.id}function In(){return!!xt.awaits&&(--xt.awaits==0&&(xt.id=0),xt.echoes=xt.awaits*zn,!0)}function Br(n){return xt.echoes&&n&&n.constructor===Et?(zt(),n.then(function(s){return In(),s},function(s){return In(),ke(s)})):n}function xs(){var n=mn[mn.length-1];mn.pop(),Rn(n,!1)}function Rn(n,s){var l,c,f=je;(s?!xt.echoes||Nr++&&n===je:!Nr||--Nr&&n===je)||queueMicrotask(s?(function(h){++qr,xt.echoes&&--xt.echoes!=0||(xt.echoes=xt.awaits=xt.id=0),mn.push(je),Rn(h,!0)}).bind(null,n):xs),n!==je&&(je=n,f===At&&(At.env=Ss()),Mr)&&(l=At.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function Ss(){var n=o.Promise;return Mr?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ne(n,s,l,c,f){var h=je;try{return Rn(n,!0),s(l,c,f)}finally{Rn(h,!1)}}function A(n,s,l,c){return typeof n!="function"?n:function(){var f=je;l&&zt(),Rn(s,!0);try{return n.apply(this,arguments)}finally{Rn(f,!1),c&&queueMicrotask(In)}}}function me(n){Promise===Et&&xt.echoes===0?Nr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ya).indexOf("[native code]")===-1&&(zt=In=De);var ke=Ee.reject,Je="ï¿¿",it="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",dt="String expected.",yt=[],Xt="__dbnames",Kn="readonly",zr="readwrite";function lt(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Na={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Fr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=ue(s))[n],s}}function $o(){throw B.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Xe(n,s){try{var l=el(n),c=el(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=tl(n),h=tl(s),m=f.length,_=h.length,I=m<_?m:_,q=0;q<I;++q)if(f[q]!==h[q])return f[q]<h[q]?-1:1;return m===_?0:m<_?-1:1;case"Array":for(var R=n,E=s,D=R.length,M=E.length,P=D<M?D:M,C=0;C<P;++C){var z=Xe(R[C],E[C]);if(z!==0)return z}return D===M?0:D<M?-1:1}}catch{}return NaN}function el(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=re(n))==="ArrayBuffer")?"binary":s}function tl(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Ts(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,h){return!l.failures[h]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}nl.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var qa=nl;function nl(n){this["@@propmod"]=n}function rl(n,s){for(var l=u(s),c=l.length,f=!1,h=0;h<c;++h){var m=l[h],_=s[m],I=J(n,m);_ instanceof qa?(U(n,m,_.execute(I)),f=!0):I!==_&&(U(n,m,_),f=!0)}return f}ot.prototype._trans=function(n,s,l){var c=this._tx||je.trans,f=this.name,h=mt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function m(q,R,E){if(E.schema[f])return s(E.idbtrans,E);throw new B.NotFound("Table "+f+" not part of transaction")}var _=br();try{var I=c&&c.db._novip===this.db._novip?c===je.trans?c._promise(n,m,l):Cn(function(){return c._promise(n,m,l)},{trans:c,transless:je.transless||je}):(function q(R,E,D,M){if(R.idbdb&&(R._state.openComplete||je.letThrough||R._vip)){var P=R._createTransaction(E,D,R._dbSchema);try{P.create(),R._state.PR1398_maxLoop=3}catch(C){return C.name===rt.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return q(R,E,D,M)})):ke(C)}return P._promise(E,function(C,z){return Cn(function(){return je.trans=P,M(C,z,P)})}).then(function(C){if(E==="readwrite")try{P.idbtrans.commit()}catch{}return E==="readonly"?C:P._completion.then(function(){return C})})}if(R._state.openComplete)return ke(new B.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return ke(new B.DatabaseClosed);R.open().catch(De)}return R._state.dbReadyPromise.then(function(){return q(R,E,D,M)})})(this.db,n,[this.name],m);return h&&(I._consoleTask=h,I=I.catch(function(q){return console.trace(q),ke(q)})),I}finally{_&&nr()}},ot.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ke(new B.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},ot.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(_){if(_.compound&&s.every(function(q){return 0<=_.keyPath.indexOf(q)})){for(var I=0;I<s.length;++I)if(s.indexOf(_.keyPath[I])===-1)return!1;return!0}return!1}).sort(function(_,I){return _.keyPath.length-I.keyPath.length})[0];if(l&&this.db._maxKey!==Je)return m=l.keyPath.slice(0,s.length),this.where(m).equals(m.map(function(_){return n[_]}));!l&&mt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(_,I){return Xe(_,I)===0}var m=s.reduce(function(R,I){var q=R[0],R=R[1],E=c[I],D=n[I];return[q||E,q||!E?lt(R,E&&E.multi?function(M){return M=J(M,I),d(M)&&M.some(function(P){return f(D,P)})}:function(M){return f(D,J(M,I))}):R]},[null,null]),h=m[0],m=m[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(m):l?this.filter(m):this.where(s).equals("")},ot.prototype.filter=function(n){return this.toCollection().and(n)},ot.prototype.count=function(n){return this.toCollection().count(n)},ot.prototype.offset=function(n){return this.toCollection().offset(n)},ot.prototype.limit=function(n){return this.toCollection().limit(n)},ot.prototype.each=function(n){return this.toCollection().each(n)},ot.prototype.toArray=function(n){return this.toCollection().toArray(n)},ot.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ot.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},ot.prototype.reverse=function(){return this.toCollection().reverse()},ot.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof $o&&(n=(m=>{var _=R,I=m;if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function q(){this.constructor=_}function R(){return m!==null&&m.apply(this,arguments)||this}return r(_,I),_.prototype=I===null?Object.create(I):(q.prototype=I.prototype,new q),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(m){return c.add(m)});function h(m){if(!m)return m;var _,I=Object.create(n.prototype);for(_ in m)if(!c.has(_))try{I[_]=m[_]}catch{}return I}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},ot.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},ot.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,m=n;return h&&f&&(m=Fr(h)(n)),this._trans("readwrite",function(_){return l.core.mutate({trans:_,type:"add",keys:s!=null?[s]:null,values:[m]})}).then(function(_){return _.numFailures?Ee.reject(_.failures[0]):_.lastResult}).then(function(_){if(h)try{U(n,h,_)}catch{}return _})},ot.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var m=h??{};return rl(m,s),c&&U(m,c,n),l.core.mutate({trans:f,type:"put",values:[m],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(_){return _.numFailures?Ee.reject(_.failures[0]):!!h})})})},ot.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=J(n,this.schema.primKey.keyPath))===void 0?ke(new B.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},ot.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,h=c.keyPath,m=n;return h&&f&&(m=Fr(h)(n)),this._trans("readwrite",function(_){return l.core.mutate({trans:_,type:"put",values:[m],keys:s!=null?[s]:null})}).then(function(_){return _.numFailures?Ee.reject(_.failures[0]):_.lastResult}).then(function(_){if(h)try{U(n,h,_)}catch{}return _})},ot.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Ts(s,[n],c)}).then(function(c){return c.numFailures?Ee.reject(c.failures[0]):void 0})})},ot.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Na}).then(function(l){return Ts(n,null,l)})}).then(function(s){return s.numFailures?Ee.reject(s.failures[0]):void 0})},ot.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},ot.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(m){var _=c.schema.primKey,q=_.auto,_=_.keyPath;if(_&&f)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,q=_&&q?n.map(Fr(_)):n;return c.core.mutate({trans:m,type:"add",keys:f,values:q,wantResults:h}).then(function(R){var E=R.numFailures,D=R.failures;if(E===0)return h?R.results:R.lastResult;throw new Fe("".concat(c.name,".bulkAdd(): ").concat(E," of ").concat(I," operations failed"),D)})})},ot.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(m){var _=c.schema.primKey,q=_.auto,_=_.keyPath;if(_&&f)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,q=_&&q?n.map(Fr(_)):n;return c.core.mutate({trans:m,type:"put",keys:f,values:q,wantResults:h}).then(function(R){var E=R.numFailures,D=R.failures;if(E===0)return h?R.results:R.lastResult;throw new Fe("".concat(c.name,".bulkPut(): ").concat(E," of ").concat(I," operations failed"),D)})})},ot.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(m){return m.key}),f=n.map(function(m){return m.changes}),h=[];return this._trans("readwrite",function(m){return l.getMany({trans:m,keys:c,cache:"clone"}).then(function(_){var I=[],q=[],R=(n.forEach(function(E,D){var M=E.key,P=E.changes,C=_[D];if(C){for(var z=0,G=Object.keys(P);z<G.length;z++){var N=G[z],ee=P[N];if(N===s.schema.primKey.keyPath){if(Xe(ee,M)!==0)throw new B.Constraint("Cannot update primary key in bulkUpdate()")}else U(C,N,ee)}h.push(D),I.push(M),q.push(C)}}),I.length);return l.mutate({trans:m,type:"put",keys:I,values:q,updates:{keys:c,changeSpecs:f}}).then(function(E){var D=E.numFailures,M=E.failures;if(D===0)return R;for(var P=0,C=Object.keys(M);P<C.length;P++){var z,G=C[P],N=h[Number(G)];N!=null&&(z=M[G],delete M[G],M[N]=z)}throw new Fe("".concat(s.name,".bulkUpdate(): ").concat(D," of ").concat(R," operations failed"),M)})})})},ot.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return Ts(s,n,f)})}).then(function(c){var f=c.numFailures,h=c.failures;if(f===0)return c.lastResult;throw new Fe("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var al=ot;function ot(){}function Ba(n){function s(m,_){if(_){for(var I=arguments.length,q=new Array(I-1);--I;)q[I-1]=arguments[I];return l[m].subscribe.apply(null,q),n}if(typeof m=="string")return l[m]}var l={};s.addEventType=h;for(var c=1,f=arguments.length;c<f;++c)h(arguments[c]);return s;function h(m,_,I){var q,R;if(typeof m!="object")return _=_||Gt,R={subscribers:[],fire:I=I||De,subscribe:function(E){R.subscribers.indexOf(E)===-1&&(R.subscribers.push(E),R.fire=_(R.fire,E))},unsubscribe:function(E){R.subscribers=R.subscribers.filter(function(D){return D!==E}),R.fire=R.subscribers.reduce(_,I)}},l[m]=s[m]=R;u(q=m).forEach(function(E){var D=q[E];if(d(D))h(E,q[E][0],q[E][1]);else{if(D!=="asap")throw new B.InvalidArgument("Invalid event config");var M=h(E,Be,function(){for(var P=arguments.length,C=new Array(P);P--;)C[P]=arguments[P];M.subscribers.forEach(function(z){Z(function(){z.apply(null,C)})})})}})}}function za(n,s){return L(s).from({prototype:n}),s}function va(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function mi(n,s){n.filter=lt(n.filter,s)}function gi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return lt(c(),s())}:s,n.justLimit=l&&!c}function Es(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new B.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function sl(n,s,l){var c=Es(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function As(n,s,l,c){var f,h,m=n.replayFilter?lt(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(_,I,q){var R,E;m&&!m(I,q,function(D){return I.stop(D)},function(D){return I.fail(D)})||((E=""+(R=I.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(R)),x(f,E))||(f[E]=!0,s(_,I,q))},Promise.all([n.or._iterate(h,l),il(sl(n,c,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):il(sl(n,c,l),lt(n.algorithm,m),s,!n.keysOnly&&n.valueMapper)}function il(n,s,l,c){var f=st(c?function(h,m,_){return l(c(h),m,_)}:l);return n.then(function(h){if(h)return h.start(function(){var m=function(){return h.continue()};s&&!s(h,function(_){return m=_},function(_){h.stop(_),m=De},function(_){h.fail(_),m=De})||f(h.value,h,function(_){return m=_}),m()})})}$e.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ke.bind(null,l.error)):l.table._trans("readonly",n).then(s)},$e.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ke.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},$e.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=lt(s.algorithm,n)},$e.prototype._iterate=function(n,s){return As(this._ctx,n,s,this._ctx.table.core)},$e.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},$e.prototype.raw=function(){return this._ctx.valueMapper=null,this},$e.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return As(s,n,l,s.table.core)})},$e.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,h=f.table.core;return va(f,!0)?h.count({trans:l,query:{index:Es(f,h.schema),range:f.range}}).then(function(m){return Math.min(m,f.limit)}):(c=0,As(f,function(){return++c,!1},l,h).then(function(){return c}))}).then(n)},$e.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function h(I,q){return q?h(I[l[q]],q-1):I[c]}var m=this._ctx.dir==="next"?1:-1;function _(I,q){return Xe(h(I,f),h(q,f))*m}return this.toArray(function(I){return I.sort(_)}).then(s)},$e.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,h,m=s._ctx;return m.dir==="next"&&va(m,!0)&&0<m.limit?(c=m.valueMapper,f=Es(m,m.table.core.schema),m.table.core.query({trans:l,limit:m.limit,values:!0,query:{index:f,range:m.range}}).then(function(_){return _=_.result,c?_.map(c):_})):(h=[],As(m,function(_){return h.push(_)},l,m.table.core).then(function(){return h}))},n)},$e.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,va(s)?gi(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):gi(s,function(){var l=n;return function(){return--l<0}})),this},$e.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),gi(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},$e.prototype.until=function(n,s){return mi(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},$e.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},$e.prototype.last=function(n){return this.reverse().first(n)},$e.prototype.filter=function(n){var s;return mi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=lt(s.isMatch,n),this},$e.prototype.and=function(n){return this.filter(n)},$e.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},$e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$e.prototype.desc=function(){return this.reverse()},$e.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},$e.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},$e.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},$e.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},$e.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&va(s,!0)&&0<s.limit)return this._read(function(c){var f=Es(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},$e.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},$e.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},$e.prototype.lastKey=function(n){return this.reverse().firstKey(n)},$e.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},mi(this._ctx,function(c){var c=c.primaryKey.toString(),f=x(n,c);return n[c]=!0,!f})),this},$e.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(C,z){var G=z.failures;D+=C-z.numFailures;for(var N=0,ee=u(G);N<ee.length;N++){var pe=ee[N];E.push(G[pe])}}var h=typeof n=="function"?n:function(C){return rl(C,n)},m=l.table.core,R=m.schema.primaryKey,_=R.outbound,I=R.extractKey,q=200,R=s.db._options.modifyChunkSize,E=(R&&(q=typeof R=="object"?R[m.name]||R["*"]||200:R),[]),D=0,M=[],P=n===ol;return s.clone().primaryKeys().then(function(C){function z(N){var ee=Math.min(q,C.length-N),pe=C.slice(N,N+ee);return(P?Promise.resolve([]):m.getMany({trans:c,keys:pe,cache:"immutable"})).then(function(xe){var Se=[],he=[],Oe=_?[]:null,Ce=P?pe:[];if(!P)for(var we=0;we<ee;++we){var Me=xe[we],Qe={value:ue(Me),primKey:C[N+we]};h.call(Qe,Qe.value,Qe)!==!1&&(Qe.value==null?Ce.push(C[N+we]):_||Xe(I(Me),I(Qe.value))===0?(he.push(Qe.value),_&&Oe.push(C[N+we])):(Ce.push(C[N+we]),Se.push(Qe.value)))}return Promise.resolve(0<Se.length&&m.mutate({trans:c,type:"add",values:Se}).then(function(et){for(var ze in et.failures)Ce.splice(parseInt(ze),1);f(Se.length,et)})).then(function(){return(0<he.length||G&&typeof n=="object")&&m.mutate({trans:c,type:"put",keys:Oe,values:he,criteria:G,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<N}).then(function(et){return f(he.length,et)})}).then(function(){return(0<Ce.length||G&&P)&&m.mutate({trans:c,type:"delete",keys:Ce,criteria:G,isAdditionalChunk:0<N}).then(function(et){return Ts(l.table,Ce,et)}).then(function(et){return f(Ce.length,et)})}).then(function(){return C.length>N+ee&&z(N+q)})})}var G=va(l)&&l.limit===1/0&&(typeof n!="function"||P)&&{index:l.index,range:l.range};return z(0).then(function(){if(0<E.length)throw new Le("Error modifying one or more objects",E,D,M);return C.length})})})},$e.prototype.delete=function(){var n=this._ctx,s=n.range;return!va(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(ol):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(I){var _=I.failures,I=I.numFailures;if(I)throw new Le("Could not delete some values",Object.keys(_).map(function(q){return _[q]}),h-I);return h-I})})})};var tf=$e;function $e(){}var ol=function(n,s){return s.value=null};function nf(n,s){return n<s?-1:n===s?0:1}function rf(n,s){return s<n?-1:n===s?0:1}function rn(n,s,l){return n=n instanceof cl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function ma(n){return new n.Collection(n,function(){return ll("")}).limit(0)}function Cs(M,s,l,c){var f,h,m,_,I,q,R,E=l.length;if(!l.every(function(C){return typeof C=="string"}))return rn(M,dt);function D(C){f=C==="next"?function(G){return G.toUpperCase()}:function(G){return G.toLowerCase()},h=C==="next"?function(G){return G.toLowerCase()}:function(G){return G.toUpperCase()},m=C==="next"?nf:rf;var z=l.map(function(G){return{lower:h(G),upper:f(G)}}).sort(function(G,N){return m(G.lower,N.lower)});_=z.map(function(G){return G.upper}),I=z.map(function(G){return G.lower}),R=(q=C)==="next"?"":c}D("next");var M=new M.Collection(M,function(){return wr(_[0],I[E-1]+c)}),P=(M._ondirectionchange=function(C){D(C)},0);return M._addAlgorithm(function(C,z,G){var N=C.key;if(typeof N=="string"){var ee=h(N);if(s(ee,I,P))return!0;for(var pe=null,xe=P;xe<E;++xe){var Se=((he,Oe,Ce,we,Me,Qe)=>{for(var et=Math.min(he.length,we.length),ze=-1,Ue=0;Ue<et;++Ue){var pt=Oe[Ue];if(pt!==we[Ue])return Me(he[Ue],Ce[Ue])<0?he.substr(0,Ue)+Ce[Ue]+Ce.substr(Ue+1):Me(he[Ue],we[Ue])<0?he.substr(0,Ue)+we[Ue]+Ce.substr(Ue+1):0<=ze?he.substr(0,ze)+Oe[ze]+Ce.substr(ze+1):null;Me(he[Ue],pt)<0&&(ze=Ue)}return et<we.length&&Qe==="next"?he+Ce.substr(he.length):et<he.length&&Qe==="prev"?he.substr(0,Ce.length):ze<0?null:he.substr(0,ze)+we[ze]+Ce.substr(ze+1)})(N,ee,_[xe],I[xe],m,q);Se===null&&pe===null?P=xe+1:(pe===null||0<m(pe,Se))&&(pe=Se)}z(pe!==null?function(){C.continue(pe+R)}:G)}return!1}),M}function wr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function ll(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Ct.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ct.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?ma(this):new this.Collection(this,function(){return wr(n,s,!l,!c)})}catch{return rn(this,it)}},Ct.prototype.equals=function(n){return n==null?rn(this,it):new this.Collection(this,function(){return ll(n)})},Ct.prototype.above=function(n){return n==null?rn(this,it):new this.Collection(this,function(){return wr(n,void 0,!0)})},Ct.prototype.aboveOrEqual=function(n){return n==null?rn(this,it):new this.Collection(this,function(){return wr(n,void 0,!1)})},Ct.prototype.below=function(n){return n==null?rn(this,it):new this.Collection(this,function(){return wr(void 0,n,!1,!0)})},Ct.prototype.belowOrEqual=function(n){return n==null?rn(this,it):new this.Collection(this,function(){return wr(void 0,n)})},Ct.prototype.startsWith=function(n){return typeof n!="string"?rn(this,dt):this.between(n,n+Je,!0,!0)},Ct.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Cs(this,function(s,l){return s.indexOf(l[0])===0},[n],Je)},Ct.prototype.equalsIgnoreCase=function(n){return Cs(this,function(s,l){return s===l[0]},[n],"")},Ct.prototype.anyOfIgnoreCase=function(){var n=ve.apply(ie,arguments);return n.length===0?ma(this):Cs(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Ct.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(ie,arguments);return n.length===0?ma(this):Cs(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,Je)},Ct.prototype.anyOf=function(){var n,s,l=this,c=ve.apply(ie,arguments),f=this._cmp;try{c.sort(f)}catch{return rn(this,it)}return c.length===0?ma(this):((n=new this.Collection(this,function(){return wr(c[0],c[c.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(h,m,_){for(var I=h.key;0<f(I,c[s]);)if(++s===c.length)return m(_),!1;return f(I,c[s])===0||(m(function(){h.continue(c[s])}),!1)}),n)},Ct.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ct.prototype.noneOf=function(){var n=ve.apply(ie,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return rn(this,it)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Ct.prototype.inAnyRange=function(n,G){var l=this,c=this._cmp,f=this._ascending,h=this._descending,m=this._min,_=this._max;if(n.length===0)return ma(this);if(!n.every(function(N){return N[0]!==void 0&&N[1]!==void 0&&f(N[0],N[1])<=0}))return rn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);var I=!G||G.includeLowers!==!1,q=G&&G.includeUppers===!0,R,E=f;function D(N,ee){return E(N[0],ee[0])}try{(R=n.reduce(function(N,ee){for(var pe=0,xe=N.length;pe<xe;++pe){var Se=N[pe];if(c(ee[0],Se[1])<0&&0<c(ee[1],Se[0])){Se[0]=m(Se[0],ee[0]),Se[1]=_(Se[1],ee[1]);break}}return pe===xe&&N.push(ee),N},[])).sort(D)}catch{return rn(this,it)}var M=0,P=q?function(N){return 0<f(N,R[M][1])}:function(N){return 0<=f(N,R[M][1])},C=I?function(N){return 0<h(N,R[M][0])}:function(N){return 0<=h(N,R[M][0])},z=P,G=new this.Collection(this,function(){return wr(R[0][0],R[R.length-1][1],!I,!q)});return G._ondirectionchange=function(N){E=N==="next"?(z=P,f):(z=C,h),R.sort(D)},G._addAlgorithm(function(N,ee,pe){for(var xe,Se=N.key;z(Se);)if(++M===R.length)return ee(pe),!1;return!P(xe=Se)&&!C(xe)||(l._cmp(Se,R[M][1])===0||l._cmp(Se,R[M][0])===0||ee(function(){E===f?N.continue(R[M][0]):N.continue(R[M][1])}),!1)}),G},Ct.prototype.startsWithAnyOf=function(){var n=ve.apply(ie,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?ma(this):this.inAnyRange(n.map(function(s){return[s,s+Je]})):rn(this,"startsWithAnyOf() only works with strings")};var cl=Ct;function Ct(){}function Un(n){return st(function(s){return Fa(s),n(s.target.error),!1})}function Fa(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Ka="storagemutated",yi="x-storagemutated-1",kr=Ba(null,Ka),af=(Gn.prototype._lock=function(){return Y(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},Gn.prototype._unlock=function(){if(Y(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ne(n[1],n[0])}catch{}}return this},Gn.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},Gn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(Y(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new B.DatabaseClosed(c);case"MissingAPIError":throw new B.MissingAPI(c.message,c);default:throw new B.OpenFailed(c)}if(!this.active)throw new B.TransactionInactive;Y(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=st(function(f){Fa(f),s._reject(n.error)}),n.onabort=st(function(f){Fa(f),s.active&&s._reject(new B.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=st(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&kr.storagemutated.fire(n.mutatedParts)})}return this},Gn.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?ke(new B.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ee(function(h,m){f._blockedFuncs.push([function(){f._promise(n,s,l).then(h,m)},je])}):l?Cn(function(){var h=new Ee(function(m,_){f._lock();var I=s(m,_,f);I&&I.then&&I.then(m,_)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((c=new Ee(function(h,m){var _=s(h,m,f);_&&_.then&&_.then(h,m)}))._lib=!0,c):ke(new B.TransactionInactive)},Gn.prototype._root=function(){return this.parent?this.parent._root():this},Gn.prototype.waitFor=function(n){var s,l=this._root(),c=Ee.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=h)})()),l._waitingFor);return new Ee(function(h,m){c.then(function(_){return l._waitingQueue.push(st(h.bind(null,_)))},function(_){return l._waitingQueue.push(st(m.bind(null,_)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Gn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))},Gn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(x(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new B.NotFound("Table "+n+" not part of transaction")},Gn);function Gn(){}function _i(n,s,l,c,f,h,m,_){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:h,src:(l&&!m?"&":"")+(c?"*":"")+(f?"++":"")+ul(s),type:_}}function ul(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function bi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,h,m){return h=c(h,m),h&&(f[h[0]]=h[1]),f},{}))};var c}var Ua=function(n){try{return n.only([[]]),Ua=function(){return[[]]},[[]]}catch{return Ua=function(){return Je},Je}};function wi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return J(l,s)}:function(l){return J(l,n)};var s}function fl(n){return[].slice.call(n)}var sf=0;function Ga(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function of(n,s,I){function c(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=P.lower,D=P.upper,M=P.lowerOpen,P=P.upperOpen;return E===void 0?D===void 0?null:s.upperBound(D,!!P):D===void 0?s.lowerBound(E,!!M):s.bound(E,D,!!M,!!P)}function f(R){var E,D=R.name;return{name:D,schema:R,mutate:function(M){var P=M.trans,C=M.type,z=M.keys,G=M.values,N=M.range;return new Promise(function(ee,pe){ee=st(ee);var xe=P.objectStore(D),Se=xe.keyPath==null,he=C==="put"||C==="add";if(!he&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var Oe,Ce=(z||G||{length:1}).length;if(z&&G&&z.length!==G.length)throw new Error("Given keys array must have same length as given values array.");if(Ce===0)return ee({numFailures:0,failures:{},results:[],lastResult:void 0});function we(vt){++et,Fa(vt)}var Me=[],Qe=[],et=0;if(C==="deleteRange"){if(N.type===4)return ee({numFailures:et,failures:Qe,results:[],lastResult:void 0});N.type===3?Me.push(Oe=xe.clear()):Me.push(Oe=xe.delete(c(N)))}else{var Se=he?Se?[G,z]:[G,null]:[z,null],ze=Se[0],Ue=Se[1];if(he)for(var pt=0;pt<Ce;++pt)Me.push(Oe=Ue&&Ue[pt]!==void 0?xe[C](ze[pt],Ue[pt]):xe[C](ze[pt])),Oe.onerror=we;else for(pt=0;pt<Ce;++pt)Me.push(Oe=xe[C](ze[pt])),Oe.onerror=we}function gn(vt){vt=vt.target.result,Me.forEach(function(Gr,Bi){return Gr.error!=null&&(Qe[Bi]=Gr.error)}),ee({numFailures:et,failures:Qe,results:C==="delete"?z:Me.map(function(Gr){return Gr.result}),lastResult:vt})}Oe.onerror=function(vt){we(vt),gn(vt)},Oe.onsuccess=gn})},getMany:function(M){var P=M.trans,C=M.keys;return new Promise(function(z,G){z=st(z);for(var N,ee=P.objectStore(D),pe=C.length,xe=new Array(pe),Se=0,he=0,Oe=function(Me){Me=Me.target,xe[Me._pos]=Me.result,++he===Se&&z(xe)},Ce=Un(G),we=0;we<pe;++we)C[we]!=null&&((N=ee.get(C[we]))._pos=we,N.onsuccess=Oe,N.onerror=Ce,++Se);Se===0&&z(xe)})},get:function(M){var P=M.trans,C=M.key;return new Promise(function(z,G){z=st(z);var N=P.objectStore(D).get(C);N.onsuccess=function(ee){return z(ee.target.result)},N.onerror=Un(G)})},query:(E=_,function(M){return new Promise(function(P,C){P=st(P);var z,G,N,he=M.trans,ee=M.values,pe=M.limit,Se=M.query,xe=pe===1/0?void 0:pe,Oe=Se.index,Se=Se.range,he=he.objectStore(D),he=Oe.isPrimaryKey?he:he.index(Oe.name),Oe=c(Se);if(pe===0)return P({result:[]});E?((Se=ee?he.getAll(Oe,xe):he.getAllKeys(Oe,xe)).onsuccess=function(Ce){return P({result:Ce.target.result})},Se.onerror=Un(C)):(z=0,G=!ee&&"openKeyCursor"in he?he.openKeyCursor(Oe):he.openCursor(Oe),N=[],G.onsuccess=function(Ce){var we=G.result;return!we||(N.push(ee?we.value:we.primaryKey),++z===pe)?P({result:N}):void we.continue()},G.onerror=Un(C))})}),openCursor:function(M){var P=M.trans,C=M.values,z=M.query,G=M.reverse,N=M.unique;return new Promise(function(ee,pe){ee=st(ee);var he=z.index,xe=z.range,Se=P.objectStore(D),Se=he.isPrimaryKey?Se:Se.index(he.name),he=G?N?"prevunique":"prev":N?"nextunique":"next",Oe=!C&&"openKeyCursor"in Se?Se.openKeyCursor(c(xe),he):Se.openCursor(c(xe),he);Oe.onerror=Un(pe),Oe.onsuccess=st(function(Ce){var we,Me,Qe,et,ze=Oe.result;ze?(ze.___id=++sf,ze.done=!1,we=ze.continue.bind(ze),Me=(Me=ze.continuePrimaryKey)&&Me.bind(ze),Qe=ze.advance.bind(ze),et=function(){throw new Error("Cursor not stopped")},ze.trans=P,ze.stop=ze.continue=ze.continuePrimaryKey=ze.advance=function(){throw new Error("Cursor not started")},ze.fail=st(pe),ze.next=function(){var Ue=this,pt=1;return this.start(function(){return pt--?Ue.continue():Ue.stop()}).then(function(){return Ue})},ze.start=function(Ue){function pt(){if(Oe.result)try{Ue()}catch(vt){ze.fail(vt)}else ze.done=!0,ze.start=function(){throw new Error("Cursor behind last entry")},ze.stop()}var gn=new Promise(function(vt,Gr){vt=st(vt),Oe.onerror=Un(Gr),ze.fail=Gr,ze.stop=function(Bi){ze.stop=ze.continue=ze.continuePrimaryKey=ze.advance=et,vt(Bi)}});return Oe.onsuccess=st(function(vt){Oe.onsuccess=pt,pt()}),ze.continue=we,ze.continuePrimaryKey=Me,ze.advance=Qe,pt(),gn},ee(ze)):ee(null)},pe)})},count:function(M){var P=M.query,C=M.trans,z=P.index,G=P.range;return new Promise(function(N,ee){var pe=C.objectStore(D),pe=z.isPrimaryKey?pe:pe.index(z.name),xe=c(G),xe=xe?pe.count(xe):pe.count();xe.onsuccess=st(function(Se){return N(Se.target.result)}),xe.onerror=Un(ee)})}}}h=I,m=fl((I=n).objectStoreNames);var h,I={schema:{name:I.name,tables:m.map(function(R){return h.objectStore(R)}).map(function(R){var E=R.keyPath,D=R.autoIncrement,P=d(E),M={},P={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:P,keyPath:E,autoIncrement:D,unique:!0,extractKey:wi(E)},indexes:fl(R.indexNames).map(function(C){return R.index(C)}).map(function(N){var ee=N.name,z=N.unique,G=N.multiEntry,N=N.keyPath,ee={name:ee,compound:d(N),keyPath:N,unique:z,multiEntry:G,extractKey:wi(N)};return M[Ga(N)]=ee}),getIndexByKeyPath:function(C){return M[Ga(C)]}};return M[":id"]=P.primaryKey,E!=null&&(M[Ga(E)]=P.primaryKey),P})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},m=I.schema,_=I.hasGetAll,I=m.tables.map(f),q={};return I.forEach(function(R){return q[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(q[R])return q[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ua(s),schema:m}}function lf(n,s,l,c){return l=l.IDBKeyRange,s=of(s,l,c),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,a(a({},f),h(f))},s)}}function Is(n,s){var l=s.db,l=lf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(h){return h.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function Rs(n,s,l,c){l.forEach(function(f){var h=c[f];s.forEach(function(m){var _=(function I(q,R){return T(q,R)||(q=p(q))&&I(q,R)})(m,f);(!_||"value"in _&&_.value===void 0)&&(m===n.Transaction.prototype||m instanceof n.Transaction?O(m,f,{get:function(){return this.table(f)},set:function(I){w(this,f,{value:I,writable:!0,configurable:!0,enumerable:!0})}}):m[f]=new n.Table(f,h))})})}function ki(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function cf(n,s){return n._cfg.version-s._cfg.version}function uf(n,s,l,c){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=bi("$meta",pl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),m=(h.create(l),h._completion.catch(c),h._reject.bind(h)),_=je.transless||je;Cn(function(){if(je.trans=h,je.transless=_,s!==0)return Is(n,l),q=s,((I=h).storeNames.includes("$meta")?I.table("$meta").get("version").then(function(R){return R??q}):Ee.resolve(q)).then(function(z){var E=n,D=z,M=h,P=l,C=[],z=E._versions,G=E._dbSchema=Os(0,E.idbdb,P);return(z=z.filter(function(N){return N._cfg.version>=D})).length===0?Ee.resolve():(z.forEach(function(N){C.push(function(){var ee,pe,xe,Se=G,he=N._cfg.dbschema,Oe=(Ds(E,Se,P),Ds(E,he,P),G=E._dbSchema=he,xi(Se,he)),Ce=(Oe.add.forEach(function(we){Si(P,we[0],we[1].primKey,we[1].indexes)}),Oe.change.forEach(function(we){if(we.recreate)throw new B.Upgrade("Not yet support for changing primary key");var Me=P.objectStore(we.name);we.add.forEach(function(Qe){return Ps(Me,Qe)}),we.change.forEach(function(Qe){Me.deleteIndex(Qe.name),Ps(Me,Qe)}),we.del.forEach(function(Qe){return Me.deleteIndex(Qe)})}),N._cfg.contentUpgrade);if(Ce&&N._cfg.version>D)return Is(E,P),M._memoizedTables={},ee=ce(he),Oe.del.forEach(function(we){ee[we]=Se[we]}),ki(E,[E.Transaction.prototype]),Rs(E,[E.Transaction.prototype],u(ee),ee),M.schema=ee,(pe=be(Ce))&&zt(),he=Ee.follow(function(){var we;(xe=Ce(M))&&pe&&(we=In.bind(null,null),xe.then(we,we))}),xe&&typeof xe.then=="function"?Ee.resolve(xe):he.then(function(){return xe})}),C.push(function(ee){var pe,xe,Se=N._cfg.dbschema;pe=Se,xe=ee,[].slice.call(xe.db.objectStoreNames).forEach(function(he){return pe[he]==null&&xe.db.deleteObjectStore(he)}),ki(E,[E.Transaction.prototype]),Rs(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),M.schema=E._dbSchema}),C.push(function(ee){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===N._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(pe){return pe!=="$meta"})):ee.objectStore("$meta").put(N._cfg.version,"version"))})}),(function N(){return C.length?Ee.resolve(C.shift()(M.idbtrans)).then(N):Ee.resolve()})().then(function(){dl(G,P)}))}).catch(m);var I,q;u(f).forEach(function(R){Si(l,R,f[R].primKey,f[R].indexes)}),Is(n,l),Ee.follow(function(){return n.on.populate.fire(h)}).catch(m)})}function ff(n,s){dl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Os(0,n.idbdb,s);Ds(n,n._dbSchema,s);for(var c=0,f=xi(l,n._dbSchema).change;c<f.length;c++){var h=(m=>{if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var _=s.objectStore(m.name);m.add.forEach(function(I){mt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(I.src)),Ps(_,I)})})(f[c]);if(typeof h=="object")return h.value}}function xi(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],h=s[l];if(f){var m={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)m.recreate=!0,c.change.push(m);else{var _=f.idxByName,I=h.idxByName,q=void 0;for(q in _)I[q]||m.del.push(q);for(q in I){var R=_[q],E=I[q];R?R.src!==E.src&&m.change.push(E):m.add.push(E)}(0<m.del.length||0<m.add.length||0<m.change.length)&&c.change.push(m)}}else c.add.push([l,h])}return c}function Si(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(h){return Ps(f,h)})}function dl(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(mt&&console.debug("Dexie: Creating missing table",l),Si(s,l,n[l].primKey,n[l].indexes))})}function Ps(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Os(n,s,l){var c={};return oe(s.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),m=_i(ul(q=h.keyPath),q||"",!0,!1,!!h.autoIncrement,q&&typeof q!="string",!0),_=[],I=0;I<h.indexNames.length;++I){var R=h.index(h.indexNames[I]),q=R.keyPath,R=_i(R.name,q,!!R.unique,!!R.multiEntry,!1,q&&typeof q!="string",!1);_.push(R)}c[f]=bi(f,m,_)}),c}function Ds(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var h=c[f],m=l.objectStore(h);n._hasGetAll="getAll"in m;for(var _=0;_<m.indexNames.length;++_){var I,q=m.indexNames[_],R=m.index(q).keyPath,R=typeof R=="string"?R:"["+oe(R).join("+")+"]";s[h]&&(I=s[h].idxByName[R])&&(I.name=q,delete s[h].idxByName[R],s[h].idxByName[q]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function pl(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return _i(f,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(h),l===0,c)})}ga.prototype._createTableSchema=bi,ga.prototype._parseIndexSyntax=pl,ga.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),h=f.shift();if(!h)throw new B.Schema("Invalid schema for table "+c+": "+n[c]);if(h.unique=!0,h.multi)throw new B.Schema("Primary key cannot be multiEntry*");f.forEach(function(m){if(m.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!m.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(c,h,f),s[c]=h}})},ga.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(h){v(c,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(c,f)}),s._dbSchema=f,ki(s,[s._allTables,s,s.Transaction.prototype]),Rs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},ga.prototype.upgrade=function(n){return this._cfg.contentUpgrade=wt(this._cfg.contentUpgrade||De,n),this};var df=ga;function ga(){}function Ti(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new rr(Xt,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ei(n){return n&&typeof n.databases=="function"}function Ai(n){return Cn(function(){return je.letThrough=!0,n()})}function Ci(n){return!("from"in n)}var Ft=function(n,s){var l;if(!this)return l=new Ft,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ha(n,s,l){var c=Xe(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Ci(n))return v(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(Xe(l,n.from)<0)return c?Ha(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},vl(n);if(0<Xe(s,n.to))return f?Ha(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},vl(n);Xe(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Xe(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Wa(n,c),f&&s&&Wa(n,f)}}function Wa(n,s){Ci(s)||(function l(c,f){var h=f.from,m=f.l,_=f.r;Ha(c,h,f.to),m&&l(c,m),_&&l(c,_)})(n,s)}function hl(n,s){var l=Ms(s),c=l.next();if(!c.done)for(var f=c.value,h=Ms(n),m=h.next(f.from),_=m.value;!c.done&&!m.done;){if(Xe(_.from,f.to)<=0&&0<=Xe(_.to,f.from))return!0;Xe(f.from,_.from)<0?f=(c=l.next(_.from)).value:_=(m=h.next(f.from)).value}return!1}function Ms(n){var s=Ci(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&Xe(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||Xe(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function vl(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=ml(l)),n.d=ml(n)}function ml(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function js(n,s){return u(s).forEach(function(l){n[l]?Wa(n[l],s[l]):n[l]=(function c(f){var h,m,_={};for(h in f)x(f,h)&&(m=f[h],_[h]=!m||typeof m!="object"||ge.has(m.constructor)?m:c(m));return _})(s[l])}),n}function Ii(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&hl(s[l],n[l])})}k(Ft.prototype,((kt={add:function(n){return Wa(this,n),this},addKey:function(n){return Ha(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ha(s,l,l)}),this},hasKey:function(n){var s=Ms(this).next(n).value;return s&&Xe(s.from,n)<=0&&0<=Xe(s.to,n)}})[le]=function(){return Ms(this)},kt));var Kr={},Ri={},Pi=!1;function Ls(n){js(Ri,n),Pi||(Pi=!0,setTimeout(function(){Pi=!1,Oi(Ri,!(Ri={}))},0))}function Oi(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values(Kr);c<f.length;c++)gl(_=f[c],n,l,s);else for(var h in n){var m,_,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(m=h[1],h=h[2],_=Kr["idb://".concat(m,"/").concat(h)])&&gl(_,n,l,s)}l.forEach(function(I){return I()})}function gl(n,s,l,c){for(var f=[],h=0,m=Object.entries(n.queries.query);h<m.length;h++){for(var _=m[h],I=_[0],q=[],R=0,E=_[1];R<E.length;R++){var D=E[R];Ii(s,D.obsSet)?D.subscribers.forEach(function(z){return l.add(z)}):c&&q.push(D)}c&&f.push([I,q])}if(c)for(var M=0,P=f;M<P.length;M++){var C=P[M],I=C[0],q=C[1];n.queries.query[I]=q}}function pf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ke(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),h=!1;function m(){if(s.openCanceller!==c)throw new B.DatabaseClosed("db.open() was cancelled")}function _(){return new Ee(function(D,M){if(m(),!l)throw new B.MissingAPI;var P=n.name,C=s.autoSchema||!f?l.open(P):l.open(P,f);if(!C)throw new B.MissingAPI;C.onerror=Un(M),C.onblocked=st(n._fireOnBlocked),C.onupgradeneeded=st(function(z){var G;R=C.transaction,s.autoSchema&&!n._options.allowEmptyDB?(C.onerror=Fa,R.abort(),C.result.close(),(G=l.deleteDatabase(P)).onsuccess=G.onerror=st(function(){M(new B.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(R.onerror=Un(M),G=z.oldVersion>Math.pow(2,62)?0:z.oldVersion,E=G<1,n.idbdb=C.result,h&&ff(n,R),uf(n,G/10,R,M))},M),C.onsuccess=st(function(){R=null;var z,G,N,ee,pe,xe,Se=n.idbdb=C.result,he=oe(Se.objectStoreNames);if(0<he.length)try{var Oe=Se.transaction((pe=he).length===1?pe[0]:pe,"readonly");if(s.autoSchema)xe=Se,ee=Oe,(N=n).verno=xe.version/10,ee=N._dbSchema=Os(0,xe,ee),N._storeNames=oe(xe.objectStoreNames,0),Rs(N,[N._allTables],u(ee),ee);else if(Ds(n,n._dbSchema,Oe),G=Oe,((G=xi(Os(0,(z=n).idbdb,G),z._dbSchema)).add.length||G.change.some(function(Ce){return Ce.add.length||Ce.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Se.close(),f=Se.version+1,h=!0,D(_());Is(n,Oe)}catch{}yt.push(n),Se.onversionchange=st(function(Ce){s.vcFired=!0,n.on("versionchange").fire(Ce)}),Se.onclose=st(function(){n.close({disableAutoOpen:!1})}),E&&(he=n._deps,pe=P,Ei(xe=he.indexedDB)||pe===Xt||Ti(xe,he.IDBKeyRange).put({name:pe}).catch(De)),D()},M)}).catch(function(D){switch(D==null?void 0:D.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),_();break;case"VersionError":if(0<f)return f=0,_()}return Ee.reject(D)})}var I,q=s.dbReadyResolve,R=null,E=!1;return Ee.race([c,(typeof navigator>"u"?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function M(){return indexedDB.databases().finally(D)}I=setInterval(M,100),M()}).finally(function(){return clearInterval(I)}):Promise.resolve()).then(_)]).then(function(){return m(),s.onReadyBeingFired=[],Ee.resolve(Ai(function(){return n.on.ready.fire(n.vip)})).then(function D(){var M;if(0<s.onReadyBeingFired.length)return M=s.onReadyBeingFired.reduce(wt,De),s.onReadyBeingFired=[],Ee.resolve(Ai(function(){return M(n.vip)})).then(D)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(D){s.dbOpenError=D;try{R&&R.abort()}catch{}return c===s.openCanceller&&n._close(),ke(D)}).finally(function(){s.openComplete=!0,q()}).then(function(){var D;return E&&(D={},n.tables.forEach(function(M){M.schema.indexes.forEach(function(P){P.name&&(D["idb://".concat(n.name,"/").concat(M.name,"/").concat(P.name)]=new Ft(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(M.name,"/")]=D["idb://".concat(n.name,"/").concat(M.name,"/:dels")]=new Ft(-1/0,[[[]]])}),kr(Ka).fire(D),Oi(D,!0)),n})}function Di(n){function s(h){return n.next(h)}var l=f(s),c=f(function(h){return n.throw(h)});function f(h){return function(_){var _=h(_),I=_.value;return _.done?I:I&&typeof I.then=="function"?I.then(l,c):d(I)?Promise.all(I).then(l,c):l(I)}}return f(s)()}function Ns(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var hf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},h=[];function m(D,M,P){var N=Ga(D),C=f[N]=f[N]||[],z=D==null?0:typeof D=="string"?1:D.length,G=0<M,N=a(a({},P),{name:G?"".concat(N,"(virtual-from:").concat(P.name,")"):P.name,lowLevelIndex:P,isVirtual:G,keyTail:M,keyLength:z,extractKey:wi(D),unique:!G&&P.unique});return C.push(N),N.isPrimaryKey||h.push(N),1<z&&m(z===2?D[0]:D.slice(0,z-1),M+1,P),C.sort(function(ee,pe){return ee.keyTail-pe.keyTail}),N}var _=m(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[_];for(var I=0,q=c.indexes;I<q.length;I++){var R=q[I];m(R.keyPath,0,R)}function E(D){var M,P=D.query.index;return P.isVirtual?a(a({},D),{query:{index:P.lowLevelIndex,range:(M=D.query.range,P=P.keyTail,{type:M.type===1?2:M.type,lower:Ns(M.lower,M.lowerOpen?n.MAX_KEY:n.MIN_KEY,P),lowerOpen:!0,upper:Ns(M.upper,M.upperOpen?n.MIN_KEY:n.MAX_KEY,P),upperOpen:!0})}}):D}return a(a({},l),{schema:a(a({},c),{primaryKey:_,indexes:h,getIndexByKeyPath:function(D){return(D=f[Ga(D)])&&D[0]}}),count:function(D){return l.count(E(D))},query:function(D){return l.query(E(D))},openCursor:function(D){var M=D.query.index,P=M.keyTail,C=M.keyLength;return M.isVirtual?l.openCursor(E(D)).then(function(G){return G&&z(G)}):l.openCursor(D);function z(G){return Object.create(G,{continue:{value:function(N){N!=null?G.continue(Ns(N,D.reverse?n.MAX_KEY:n.MIN_KEY,P)):D.unique?G.continue(G.key.slice(0,C).concat(D.reverse?n.MIN_KEY:n.MAX_KEY,P)):G.continue()}},continuePrimaryKey:{value:function(N,ee){G.continuePrimaryKey(Ns(N,n.MAX_KEY,P),ee)}},primaryKey:{get:function(){return G.primaryKey}},key:{get:function(){var N=G.key;return C===1?N[0]:N.slice(0,C)}},value:{get:function(){return G.value}}})}}})}})}};function Mi(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var h,m,_;x(s,f)?(h=n[f],m=s[f],typeof h=="object"&&typeof m=="object"&&h&&m?(_=re(h))!==re(m)?l[c+f]=s[f]:_==="Object"?Mi(h,m,l,c+f+"."):h!==m&&(l[c+f]=s[f]):h!==m&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){x(n,f)||(l[c+f]=s[f])}),l}function ji(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var vf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var h=je.trans,m=h.table(s).hook,_=m.deleting,I=m.creating,q=m.updating;switch(f.type){case"add":if(I.fire===De)break;return h._promise("readwrite",function(){return R(f)},!0);case"put":if(I.fire===De&&q.fire===De)break;return h._promise("readwrite",function(){return R(f)},!0);case"delete":if(_.fire===De)break;return h._promise("readwrite",function(){return R(f)},!0);case"deleteRange":if(_.fire===De)break;return h._promise("readwrite",function(){return(function E(D,M,P){return l.query({trans:D,values:!1,query:{index:c,range:M},limit:P}).then(function(C){var z=C.result;return R({type:"delete",keys:z,trans:D}).then(function(G){return 0<G.numFailures?Promise.reject(G.failures[0]):z.length<P?{failures:[],numFailures:0,lastResult:void 0}:E(D,a(a({},M),{lower:z[z.length-1],lowerOpen:!0}),P)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function R(E){var D,M,P,C=je.trans,z=E.keys||ji(c,E);if(z)return(E=E.type==="add"||E.type==="put"?a(a({},E),{keys:z}):a({},E)).type!=="delete"&&(E.values=i([],E.values)),E.keys&&(E.keys=i([],E.keys)),D=l,P=z,((M=E).type==="add"?Promise.resolve([]):D.getMany({trans:M.trans,keys:P,cache:"immutable"})).then(function(G){var N=z.map(function(ee,pe){var xe,Se,he,Oe=G[pe],Ce={onerror:null,onsuccess:null};return E.type==="delete"?_.fire.call(Ce,ee,Oe,C):E.type==="add"||Oe===void 0?(xe=I.fire.call(Ce,ee,E.values[pe],C),ee==null&&xe!=null&&(E.keys[pe]=ee=xe,c.outbound||U(E.values[pe],c.keyPath,ee))):(xe=Mi(Oe,E.values[pe]),(Se=q.fire.call(Ce,xe,ee,Oe,C))&&(he=E.values[pe],Object.keys(Se).forEach(function(we){x(he,we)?he[we]=Se[we]:U(he,we,Se[we])}))),Ce});return l.mutate(E).then(function(ee){for(var pe=ee.failures,xe=ee.results,Se=ee.numFailures,ee=ee.lastResult,he=0;he<z.length;++he){var Oe=(xe||z)[he],Ce=N[he];Oe==null?Ce.onerror&&Ce.onerror(pe[he]):Ce.onsuccess&&Ce.onsuccess(E.type==="put"&&G[he]?E.values[he]:Oe)}return{failures:pe,results:xe,numFailures:Se,lastResult:ee}}).catch(function(ee){return N.forEach(function(pe){return pe.onerror&&pe.onerror(ee)}),Promise.reject(ee)})});throw new Error("Keys missing")}}})}})}};function yl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,h=0;f<s.keys.length&&h<n.length;++f)Xe(s.keys[f],n[h])===0&&(c.push(l?ue(s.values[f]):s.values[f]),++h);return c.length===n.length?c:null}catch{return null}}var mf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=yl(c.keys,c.trans._cache,c.cache==="clone"))?Ee.resolve(f):l.getMany(c).then(function(h){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?ue(h):h},h}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function _l(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function bl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var gf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Ft(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,h){if(je.subscr&&f!=="readonly")throw new B.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return n.transaction(c,f,h)},table:function(c){function f(z){var C,z=z.query;return[C=z.index,new Ft((C=(z=z.range).lower)!=null?C:n.MIN_KEY,(C=z.upper)!=null?C:n.MAX_KEY)]}var h=n.table(c),m=h.schema,_=m.primaryKey,I=m.indexes,q=_.extractKey,R=_.outbound,E=_.autoIncrement&&I.filter(function(P){return P.compound&&P.keyPath.includes(_.keyPath)}),D=a(a({},h),{mutate:function(P){function C(Me){return Me="idb://".concat(s,"/").concat(c,"/").concat(Me),pe[Me]||(pe[Me]=new Ft)}var z,G,N,ee=P.trans,pe=P.mutatedParts||(P.mutatedParts={}),xe=C(""),Se=C(":dels"),he=P.type,Ce=P.type==="deleteRange"?[P.range]:P.type==="delete"?[P.keys]:P.values.length<50?[ji(_,P).filter(function(Me){return Me}),P.values]:[],Oe=Ce[0],Ce=Ce[1],we=P.trans._cache;return d(Oe)?(xe.addKeys(Oe),(he=he==="delete"||Oe.length===Ce.length?yl(Oe,we):null)||Se.addKeys(Oe),(he||Ce)&&(z=C,G=he,N=Ce,m.indexes.forEach(function(Me){var Qe=z(Me.name||"");function et(Ue){return Ue!=null?Me.extractKey(Ue):null}function ze(Ue){Me.multiEntry&&d(Ue)?Ue.forEach(function(pt){return Qe.addKey(pt)}):Qe.addKey(Ue)}(G||N).forEach(function(Ue,vt){var gn=G&&et(G[vt]),vt=N&&et(N[vt]);Xe(gn,vt)!==0&&(gn!=null&&ze(gn),vt!=null)&&ze(vt)})}))):Oe?(Ce={from:(we=Oe.lower)!=null?we:n.MIN_KEY,to:(he=Oe.upper)!=null?he:n.MAX_KEY},Se.add(Ce),xe.add(Ce)):(xe.add(l),Se.add(l),m.indexes.forEach(function(Me){return C(Me.name).add(l)})),h.mutate(P).then(function(Me){return!Oe||P.type!=="add"&&P.type!=="put"||(xe.addKeys(Me.results),E&&E.forEach(function(Qe){for(var et=P.values.map(function(gn){return Qe.extractKey(gn)}),ze=Qe.keyPath.findIndex(function(gn){return gn===_.keyPath}),Ue=0,pt=Me.results.length;Ue<pt;++Ue)et[Ue][ze]=Me.results[Ue];C(Qe.name).addKeys(et)})),ee.mutatedParts=js(ee.mutatedParts||{},pe),Me})}}),M={get:function(P){return[_,new Ft(P.key)]},getMany:function(P){return[_,new Ft().addKeys(P.keys)]},count:f,query:f,openCursor:f};return u(M).forEach(function(P){D[P]=function(C){var z=je.subscr,G=!!z,N=_l(je,h)&&bl(P,C)?C.obsSet={}:z;if(G){var ee,z=function(Ce){return Ce="idb://".concat(s,"/").concat(c,"/").concat(Ce),N[Ce]||(N[Ce]=new Ft)},pe=z(""),xe=z(":dels"),G=M[P](C),Se=G[0],G=G[1];if((P==="query"&&Se.isPrimaryKey&&!C.values?xe:z(Se.name||"")).add(G),!Se.isPrimaryKey){if(P!=="count")return ee=P==="query"&&R&&C.values&&h.query(a(a({},C),{values:!1})),h[P].apply(this,arguments).then(function(Ce){if(P==="query"){if(R&&C.values)return ee.then(function(et){return et=et.result,pe.addKeys(et),Ce});var we=C.values?Ce.result.map(q):Ce.result;(C.values?pe:xe).addKeys(we)}else{var Me,Qe;if(P==="openCursor")return Qe=C.values,(Me=Ce)&&Object.create(Me,{key:{get:function(){return xe.addKey(Me.primaryKey),Me.key}},primaryKey:{get:function(){var et=Me.primaryKey;return xe.addKey(et),et}},value:{get:function(){return Qe&&pe.addKey(Me.primaryKey),Me.value}}})}return Ce});xe.add(l)}}return h[P].apply(this,arguments)}}),D}})}};function wl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,h){return!(h in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,h){return!(h in l.failures)})),c)}function Li(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<Xe(l,c.lower):0<=Xe(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?Xe(l,c.upper)<0:Xe(l,c.upper)<=0));var l,c}function kl(n,s,l,c,f,h){var m,_,I,q,R,E;return!l||l.length===0||(m=s.query.index,_=m.multiEntry,I=s.query.range,q=c.schema.primaryKey.extractKey,R=m.extractKey,E=(m.lowLevelIndex||m).extractKey,(c=l.reduce(function(D,M){var P=D,C=[];if(M.type==="add"||M.type==="put")for(var z=new Ft,G=M.values.length-1;0<=G;--G){var N,ee=M.values[G],pe=q(ee);!z.hasKey(pe)&&(N=R(ee),_&&d(N)?N.some(function(Ce){return Li(Ce,I)}):Li(N,I))&&(z.addKey(pe),C.push(ee))}switch(M.type){case"add":var xe=new Ft().addKeys(s.values?D.map(function(we){return q(we)}):D),P=D.concat(s.values?C.filter(function(we){return we=q(we),!xe.hasKey(we)&&(xe.addKey(we),!0)}):C.map(function(we){return q(we)}).filter(function(we){return!xe.hasKey(we)&&(xe.addKey(we),!0)}));break;case"put":var Se=new Ft().addKeys(M.values.map(function(we){return q(we)}));P=D.filter(function(we){return!Se.hasKey(s.values?q(we):we)}).concat(s.values?C:C.map(function(we){return q(we)}));break;case"delete":var he=new Ft().addKeys(M.keys);P=D.filter(function(we){return!he.hasKey(s.values?q(we):we)});break;case"deleteRange":var Oe=M.range;P=D.filter(function(we){return!Li(q(we),Oe)})}return P},n))===n)?n:(c.sort(function(D,M){return Xe(E(D),E(M))||Xe(q(D),q(M))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),h?Object.freeze(c):c)}function xl(n,s){return Xe(n.lower,s.lower)===0&&Xe(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function yf(n,s){return((l,c,f,h)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=Xe(l,c))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,h)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=Xe(l,c))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function _f(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=s,setTimeout(function(){f.subscribers.size===0&&Q(h,f)},3e3))})}var bf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var h,m,_=n.transaction(l,c,f);return c==="readwrite"&&(f=(h=new AbortController).signal,_.addEventListener("abort",(m=function(I){return function(){if(h.abort(),c==="readwrite"){for(var q=new Set,R=0,E=l;R<E.length;R++){var D=E[R],M=Kr["idb://".concat(s,"/").concat(D)];if(M){var P=n.table(D),C=M.optimisticOps.filter(function(Me){return Me.trans===_});if(_._explicit&&I&&_.mutatedParts)for(var z=0,G=Object.values(M.queries.query);z<G.length;z++)for(var N=0,ee=(Se=G[z]).slice();N<ee.length;N++)Ii((he=ee[N]).obsSet,_.mutatedParts)&&(Q(Se,he),he.subscribers.forEach(function(Me){return q.add(Me)}));else if(0<C.length){M.optimisticOps=M.optimisticOps.filter(function(Me){return Me.trans!==_});for(var pe=0,xe=Object.values(M.queries.query);pe<xe.length;pe++)for(var Se,he,Oe,Ce=0,we=(Se=xe[pe]).slice();Ce<we.length;Ce++)(he=we[Ce]).res!=null&&_.mutatedParts&&(I&&!he.dirty?(Oe=Object.isFrozen(he.res),Oe=kl(he.res,he.req,C,P,he,Oe),he.dirty?(Q(Se,he),he.subscribers.forEach(function(Me){return q.add(Me)})):Oe!==he.res&&(he.res=Oe,he.promise=Ee.resolve({result:Oe}))):(he.dirty&&Q(Se,he),he.subscribers.forEach(function(Me){return q.add(Me)})))}}}q.forEach(function(Me){return Me()})}}})(!1),{signal:f}),_.addEventListener("error",m(!1),{signal:f}),_.addEventListener("complete",m(!0),{signal:f})),_},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(h){var m,_=je.trans;return!f.outbound&&_.db._options.cache!=="disabled"&&!_.explicit&&_.idbtrans.mode==="readwrite"&&(m=Kr["idb://".concat(s,"/").concat(l)])?(_=c.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||ji(f,h).some(function(I){return I==null}))?(m.optimisticOps.push(h),h.mutatedParts&&Ls(h.mutatedParts),_.then(function(I){0<I.numFailures&&(Q(m.optimisticOps,h),(I=wl(0,h,I))&&m.optimisticOps.push(I),h.mutatedParts)&&Ls(h.mutatedParts)}),_.catch(function(){Q(m.optimisticOps,h),h.mutatedParts&&Ls(h.mutatedParts)})):_.then(function(I){var q=wl(0,a(a({},h),{values:h.values.map(function(R,E){var D;return I.failures[E]?R:(U(D=(D=f.keyPath)!=null&&D.includes(".")?ue(R):a({},R),f.keyPath,I.results[E]),D)})}),I);m.optimisticOps.push(q),queueMicrotask(function(){return h.mutatedParts&&Ls(h.mutatedParts)})}),_):c.mutate(h)},query:function(h){var m,_,I,q,R,E,D;return _l(je,c)&&bl("query",h)?(m=((I=je.trans)==null?void 0:I.db._options.cache)==="immutable",_=(I=je).requery,I=I.signal,E=((M,P,C,z)=>{var G=Kr["idb://".concat(M,"/").concat(P)];if(!G)return[];if(!(M=G.queries[C]))return[null,!1,G,null];var N=M[(z.query?z.query.index.name:null)||""];if(!N)return[null,!1,G,null];switch(C){case"query":var ee=N.find(function(pe){return pe.req.limit===z.limit&&pe.req.values===z.values&&xl(pe.req.query.range,z.query.range)});return ee?[ee,!0,G,N]:[N.find(function(pe){return("limit"in pe.req?pe.req.limit:1/0)>=z.limit&&(!z.values||pe.req.values)&&yf(pe.req.query.range,z.query.range)}),!1,G,N];case"count":return ee=N.find(function(pe){return xl(pe.req.query.range,z.query.range)}),[ee,!!ee,G,N]}})(s,l,"query",h),D=E[0],q=E[2],R=E[3],D&&E[1]?D.obsSet=h.obsSet:(E=c.query(h).then(function(M){var P=M.result;if(D&&(D.res=P),m){for(var C=0,z=P.length;C<z;++C)Object.freeze(P[C]);Object.freeze(P)}else M.result=ue(P);return M}).catch(function(M){return R&&D&&Q(R,D),Promise.reject(M)}),D={obsSet:h.obsSet,promise:E,subscribers:new Set,type:"query",req:h,dirty:!1},R?R.push(D):(R=[D],(q=q||(Kr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=R)),_f(D,R,_,I),D.promise.then(function(M){return{result:kl(M.result,h,q==null?void 0:q.optimisticOps,c,D,m)}})):c.query(h)}})}})}};function qs(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}_t.prototype.version=function(n){if(isNaN(n)||n<.1)throw new B.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(cf),l.stores({}),this._state.autoSchema=!1),l},_t.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?n():new Ee(function(l,c){if(s._state.openComplete)return c(new B.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new B.DatabaseClosed);s.open().catch(De)}s._state.dbReadyPromise.then(l,c)}).then(n)},_t.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,h=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return h.push({stack:s,create:l,level:c??10,name:f}),h.sort(function(m,_){return m.level-_.level}),this},_t.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},_t.prototype.open=function(){var n=this;return Ne(At,function(){return pf(n)})},_t.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=yt.indexOf(this);if(0<=s&&yt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ee(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ee(function(l,c){n.cancelOpen=c}))},_t.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new B.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new B.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},_t.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ee(function(f,h){function m(){s.close(n);var _=s._deps.indexedDB.deleteDatabase(s.name);_.onsuccess=st(function(){var I,q,R;I=s._deps,q=s.name,Ei(R=I.indexedDB)||q===Xt||Ti(R,I.IDBKeyRange).delete(q).catch(De),f()}),_.onerror=Un(h),_.onblocked=s._fireOnBlocked}if(l)throw new B.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(m):m()})},_t.prototype.backendDB=function(){return this.idbdb},_t.prototype.isOpen=function(){return this.idbdb!==null},_t.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},_t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_t.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),_t.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new B.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return c=h.pop(),[s,Te(h),c]}).apply(this,arguments);return this._transaction.apply(this,n)},_t.prototype._transaction=function(n,s,l){var c,f,h=this,m=je.trans,_=(m&&m.db===this&&n.indexOf("!")===-1||(m=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(q){if(q=q instanceof h.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),n=="r"||n===Kn)c=Kn;else{if(n!="rw"&&n!=zr)throw new B.InvalidArgument("Invalid transaction mode: "+n);c=zr}if(m){if(m.mode===Kn&&c===zr){if(!_)throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");m=null}m&&f.forEach(function(q){if(m&&m.storeNames.indexOf(q)===-1){if(!_)throw new B.SubTransaction("Table "+q+" not included in parent transaction.");m=null}}),_&&m&&!m.active&&(m=null)}}catch(q){return m?m._promise(null,function(R,E){E(q)}):ke(q)}var I=(function q(R,E,D,M,P){return Ee.resolve().then(function(){var N=je.transless||je,C=R._createTransaction(E,D,R._dbSchema,M),N=(C.explicit=!0,{trans:C,transless:N});if(M)C.idbtrans=M.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(ee){return ee.name===rt.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return q(R,E,D,null,P)})):ke(ee)}var z,G=be(P),N=(G&&zt(),Ee.follow(function(){var ee;(z=P.call(C,C))&&(G?(ee=In.bind(null,null),z.then(ee,ee)):typeof z.next=="function"&&typeof z.throw=="function"&&(z=Di(z)))},N));return(z&&typeof z.then=="function"?Ee.resolve(z).then(function(ee){return C.active?ee:ke(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):N.then(function(){return z})).then(function(ee){return M&&C._resolve(),C._completion.then(function(){return ee})}).catch(function(ee){return C._reject(ee),ke(ee)})})}).bind(null,this,c,f,m,l);return m?m._promise(c,I,"lock"):je.trans?Ne(je.transless,function(){return h._whenReady(I)}):this._whenReady(I)},_t.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new B.InvalidTable("Table ".concat(n," does not exist"))};var rr=_t;function _t(n,s){var l,c,f,h,m,_=this,I=(this._middlewares={},this.verno=0,_t.dependencies),I=(this._options=s=a({addons:_t.addons,autoOpen:!0,indexedDB:I.indexedDB,IDBKeyRange:I.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),q=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:De,dbReadyPromise:null,cancelOpen:De,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(q.dbReadyPromise=new Ee(function(E){q.dbReadyResolve=E}),q.openCanceller=new Ee(function(E,D){q.cancelOpen=D}),this._state=q,this.name=n,this.on=Ba(this,"populate","blocked","versionchange","close",{ready:[wt,De]}),this.once=function(E,D){var M=function(){for(var P=[],C=0;C<arguments.length;C++)P[C]=arguments[C];_.on(E).unsubscribe(M),D.apply(_,P)};return _.on(E,M)},this.on.ready.subscribe=$(this.on.ready.subscribe,function(E){return function(D,M){_t.vip(function(){var P,C=_._state;C.openComplete?(C.dbOpenError||Ee.resolve().then(D),M&&E(D)):C.onReadyBeingFired?(C.onReadyBeingFired.push(D),M&&E(D)):(E(D),P=_,M||E(function z(){P.on.ready.unsubscribe(D),P.on.ready.unsubscribe(z)}))})}}),this.Collection=(l=this,za(tf.prototype,function(z,C){this.db=l;var M=Na,P=null;if(C)try{M=C()}catch(N){P=N}var C=z._ctx,z=C.table,G=z.hook.reading.fire;this._ctx={table:z,index:C.index,isPrimKey:!C.index||z.schema.primKey.keyPath&&C.index===z.schema.primKey.name,range:M,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:C.or,valueMapper:G!==Be?G:null}})),this.Table=(c=this,za(al.prototype,function(E,D,M){this.db=c,this._tx=M,this.name=E,this.schema=D,this.hook=c._allTables[E]?c._allTables[E].hook:Ba(null,{creating:[fn,De],reading:[Tt,Be],updating:[dn,De],deleting:[Jn,De]})})),this.Transaction=(f=this,za(af.prototype,function(E,D,M,P,C){var z=this;E!=="readonly"&&D.forEach(function(G){G=(G=M[G])==null?void 0:G.yProps,G&&(D=D.concat(G.map(function(N){return N.updatesTable})))}),this.db=f,this.mode=E,this.storeNames=D,this.schema=M,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=Ba(this,"complete","error","abort"),this.parent=C||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee(function(G,N){z._resolve=G,z._reject=N}),this._completion.then(function(){z.active=!1,z.on.complete.fire()},function(G){var N=z.active;return z.active=!1,z.on.error.fire(G),z.parent?z.parent._reject(G):N&&z.idbtrans&&z.idbtrans.abort(),ke(G)})})),this.Version=(h=this,za(df.prototype,function(E){this.db=h,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,za(cl.prototype,function(E,D,M){if(this.db=m,this._ctx={table:E,index:D===":id"?null:D,or:M},this._cmp=this._ascending=Xe,this._descending=function(P,C){return Xe(C,P)},this._max=function(P,C){return 0<Xe(P,C)?P:C},this._min=function(P,C){return Xe(P,C)<0?P:C},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new B.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(_.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(_.name,"'. Closing db now to resume the delete request.")),_.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(_.name,"') was blocked")):console.warn("Upgrade '".concat(_.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=Ua(s.IDBKeyRange),this._createTransaction=function(E,D,M,P){return new _.Transaction(E,D,M,_._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(E){_.on("blocked").fire(E),yt.filter(function(D){return D.name===_.name&&D!==_&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(E)})},this.use(mf),this.use(bf),this.use(gf),this.use(hf),this.use(vf),new Proxy(this,{get:function(E,D,M){var P;return D==="_vip"||(D==="table"?function(C){return qs(_.table(C),R)}:(P=Reflect.get(E,D,M))instanceof al?qs(P,R):D==="tables"?P.map(function(C){return qs(C,R)}):D==="_createTransaction"?function(){return qs(P.apply(this,arguments),R)}:P)}}));this.vip=R,I.forEach(function(E){return E(_)})}var Bs,ya=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wf=(Ni.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Ni.prototype[ya]=function(){return this},Ni);function Ni(n){this._subscribe=n}try{Bs={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Bs={indexedDB:null,IDBKeyRange:null}}function Sl(n){var s,l=!1,c=new wf(function(f){var h=be(n),m,_=!1,I={},q={},R={get closed(){return _},unsubscribe:function(){_||(_=!0,m&&m.abort(),E&&kr.storagemutated.unsubscribe(M))}},E=(f.start&&f.start(R),!1),D=function(){return me(P)},M=function(C){js(I,C),Ii(q,I)&&D()},P=function(){var C,z,G;!_&&Bs.indexedDB&&(I={},C={},m&&m.abort(),m=new AbortController,G=(N=>{var ee=br();try{h&&zt();var pe=Cn(n,N);return pe=h?pe.finally(In):pe}finally{ee&&nr()}})(z={subscr:C,signal:m.signal,requery:D,querier:n,trans:null}),Promise.resolve(G).then(function(N){l=!0,s=N,_||z.signal.aborted||(I={},(ee=>{for(var pe in ee)if(x(ee,pe))return;return 1})(q=C)||E||(kr(Ka,M),E=!0),me(function(){return!_&&f.next&&f.next(N)}))},function(N){l=!1,["DatabaseClosedError","AbortError"].includes(N==null?void 0:N.name)||_||me(function(){_||f.error&&f.error(N)})}))};return setTimeout(D,0),R});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var Ur=rr;function qi(n){var s=xr;try{xr=!0,kr.storagemutated.fire(n),Oi(n,!0)}finally{xr=s}}k(Ur,a(a({},V),{delete:function(n){return new Ur(n,{addons:[]}).delete()},exists:function(n){return new Ur(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Ur.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ei(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==Xt})}):Ti(l,s).toCollection().primaryKeys()).then(n)}catch{return ke(new B.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return je.trans?Ne(je.transless,n):n()},vip:Ai,async:function(n){return function(){try{var s=Di(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ee.resolve(s)}catch(l){return ke(l)}}},spawn:function(n,s,l){try{var c=Di(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ee.resolve(c)}catch(f){return ke(f)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(n,s){return n=Ee.resolve(typeof n=="function"?Ur.ignoreTransaction(n):n).timeout(s||6e4),je.trans?je.trans.waitFor(n):n},Promise:Ee,debug:{get:function(){return mt},set:function(n){pn(n)}},derive:L,extend:v,props:k,override:$,Events:Ba,on:kr,liveQuery:Sl,extendObservabilitySet:js,getByKeyPath:J,setByKeyPath:U,delByKeyPath:function(n,s){typeof s=="string"?U(n,s,void 0):"length"in s&&[].map.call(s,function(l){U(n,l,void 0)})},shallowClone:ce,deepClone:ue,getObjectDiff:Mi,cmp:Xe,asap:Z,minKey:-1/0,addons:[],connections:yt,errnames:rt,dependencies:Bs,cache:Kr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Ur.maxKey=Ua(Ur.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(kr(Ka,function(n){xr||(n=new CustomEvent(yi,{detail:n}),xr=!0,dispatchEvent(n),xr=!1)}),addEventListener(yi,function(n){n=n.detail,xr||qi(n)}));var _a,xr=!1,Tl=function(){};return typeof BroadcastChannel<"u"&&((Tl=function(){(_a=new BroadcastChannel(yi)).onmessage=function(n){return n.data&&qi(n.data)}})(),typeof _a.unref=="function"&&_a.unref(),kr(Ka,function(n){xr||_a.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!rr.disableBfCache&&n.persisted){mt&&console.debug("Dexie: handling persisted pagehide"),_a!=null&&_a.close();for(var s=0,l=yt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!rr.disableBfCache&&n.persisted&&(mt&&console.debug("Dexie: handling persisted pageshow"),Tl(),qi({all:new Ft(-1/0,[[]])}))})),Ee.rejectionMapper=function(n,s){return!n||n instanceof W||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Ae[n.name]?n:(s=new Ae[n.name](s||n.message,n),"stack"in n&&O(s,"stack",{get:function(){return this.inner.stack}}),s)},pn(mt),a(rr,Object.freeze({__proto__:null,Dexie:rr,Entity:$o,PropModification:qa,RangeSet:Ft,add:function(n){return new qa({add:n})},cmp:Xe,default:rr,liveQuery:Sl,mergeRanges:Wa,rangesOverlap:hl,remove:function(n){return new qa({remove:n})},replacePrefix:function(n,s){return new qa({replacePrefix:[n,s]})}}),{default:rr}),rr})})(Js)),Js.exports}var ip=sp();const uo=rp(ip),Gl=Symbol.for("Dexie"),Ut=globalThis[Gl]||(globalThis[Gl]=uo);if(uo.semVer!==Ut.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${uo.semVer} and ${Ut.semVer}`);const{liveQuery:Sy,mergeRanges:Ty,rangesOverlap:Ey,RangeSet:Ay,cmp:Cy,Entity:Iy,PropModification:Ry,replacePrefix:Py,add:Oy,remove:Dy,DexieYProvider:My}=Ut,qe=new Ut("me-ai-store");qe.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});qe.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});qe.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});qe.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function mu(t,e){return`${t}:${e}`}function fo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Wi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function op(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function lp(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function gu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const cp="https://gmail.googleapis.com/gmail/v1/users/me";class qo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function up(t){return{Authorization:`Bearer ${t}`}}async function pi(t,e){var a,i,o,u;const r=await fetch(`${cp}${e}`,{headers:up(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,p=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new qo(v,r.status,p)}return r.json()}function yu(t){return pi(t,"/profile")}function _u(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),pi(t,`/messages?${i}`)}function bu(t,e,r="full"){return pi(t,`/messages/${e}?format=${r}`)}function fp(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),pi(t,`/history?${i}`)}function Tr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function is(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function dp(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return is(e.body.data);const r=e.parts||[],a=ni(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return is(a.body.data);const i=ni(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=is(i.body.data);return hp(v)}return"(no body)"}function pp(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return is(e.body.data);const r=e.parts||[],a=ni(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?is(a.body.data):null}function ni(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ni(r.parts,e);if(a)return a}}return null}function hp(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Bo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function wu(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function ku(t){return wu(t).charAt(0).toUpperCase()}function vp(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function mp(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function xu(t,e){return`${vp(t.date)}_${mp(t.subject)}.${e}`}function Su(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function gp(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Tu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function yp(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Tu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function _p(t=10){const e=await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Eu).join(`

---

`)}async function bp(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await qe.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,p,y,x;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(u+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(u+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(u+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>Eu(o)).join(`

---

`)}async function Hl(){const t=await qe.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=Su(t);return{groups:e,order:r,total:t.length}}async function wp({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await qe.items.where("sourceType").equals("gmail").filter(d=>{var v,p,y,x;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return u.sort((d,v)=>(v.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await qe.items.where("sourceType").equals("gmail").count();return{items:await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Tu(){const t=await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).first(),e=await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).last();return{oldest:t,newest:e}}function Eu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=lp(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function kp(){const t=await gp();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function xp(t){const e=[],r=await yp();if(e.push(r),t){const a=await bp(t,5);e.push("","## Relevant Emails",a)}else{const a=await _p(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Sp=20,Tp={maxTokens:512},Au=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Cu(t,{count:e=Sp,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().limit(e).toArray();else{const p=new Set(await qe.emailClassifications.toCollection().primaryKeys());o=0,i=[],await qe.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().until(()=>i.length>=e).each(y=>{p.has(y.id)?o++:i.push(y)})}if(i.length===0){const p=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:p,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const u=Date.now();let d=0,v=0;for(let p=0;p<i.length;p++){const y=i[p];a({phase:"scanning",message:`Classifying email ${p+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:p+1,total:i.length,classified:d});try{const x=Ru(y),k=[{role:"system",content:Au},{role:"user",content:x}],w=await t.generateFull(k,{maxTokens:512,enableThinking:!1}),O=Cp(w);O&&(await qe.emailClassifications.put({emailId:y.id,action:O.action,reason:O.reason,summary:O.summary,tags:O.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:u,status:"pending"}),d++)}catch(x){console.error(`Triage email ${p+1} failed:`,x),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function Ep(){const t=await qe.emailClassifications.toArray();return Su(t)}async function Ap(){const t=await qe.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ri(t,e){await qe.emailClassifications.update(t,{status:e})}async function Wl(){await qe.emailClassifications.clear()}async function zo(t){await qe.emailClassifications.where("action").equals(t).delete()}async function Iu(t){await qe.emailClassifications.delete(t)}async function po(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Ru(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Cp(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=Ip(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(u.tags)&&(v=u.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:v}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function Ip(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function ho(t){return`hsl(${gu(t)}, 55%, 55%)`}function Rp(t){return`hsl(${gu(t)}, 40%, 35%)`}const Pp=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Yl(...t){Pp&&console.log("[debug]",...t)}function un(t){return Yl(`[MOUNT] ${t}`),()=>Yl(`[DESTROY] ${t}`)}var Op=H("<option> </option>"),Dp=H('<p class="model-description svelte-1p89qnn"> </p>'),Mp=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),jp=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Lp=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Np=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),qp=H('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Bp=H('<p class="error svelte-1p89qnn"> </p>'),zp=H('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Fp(t,e){ct(e,!0);let r=Ie(e,"selectedModel",15),a=Ie(e,"gpuInfo",3,null),i=Ie(e,"error",3,null);Bt(()=>un("ModelSelector"));var o=zp(),u=S(b(o),2),d=S(b(u),2);nn(d,21,()=>us,hr,(L,T)=>{var K=Op(),oe=b(K),$={};fe(()=>{se(oe,`${g(T).name??""} â ${g(T).size??""}`),$!==($=g(T).id)&&(K.value=(K.__value=g(T).id)??"")}),F(L,K)});var v=S(d,2);{var p=L=>{const T=ft(()=>us.find(Y=>Y.id===r()));var K=fa(),oe=at(K);{var $=Y=>{var Z=Dp(),J=b(Z);fe(()=>se(J,g(T).description)),F(Y,Z)};_e(oe,Y=>{g(T)&&Y($)})}F(L,K)};_e(v,L=>{r()&&L(p)})}var y=S(u,2);{var x=L=>{var T=qp(),K=S(b(T),2),oe=b(K),$=S(b(oe)),Y=b($),Z=S(oe,2),J=S(b(Z)),U=b(J),ce=S(Z,2);{var ye=le=>{var de=Mp(),Q=S(b(de)),ie=b(Q);fe(()=>se(ie,a().device)),F(le,de)};_e(ce,le=>{a().device&&a().device!=="unknown"&&le(ye)})}var Te=S(ce,2);{var ge=le=>{var de=jp(),Q=S(b(de)),ie=b(Q);fe(()=>se(ie,a().description)),F(le,de)};_e(Te,le=>{a().description&&a().description!=="unknown"&&le(ge)})}var ae=S(Te,2);{var ue=le=>{var de=Lp(),Q=S(b(de)),ie=b(Q);fe(ve=>se(ie,ve),[()=>fo(a().limits.maxBufferSize)]),F(le,de)};_e(ae,le=>{var de;(de=a().limits)!=null&&de.maxBufferSize&&le(ue)})}var Re=S(ae,2);{var re=le=>{var de=Np(),Q=S(b(de)),ie=b(Q);fe(()=>se(ie,`${a().features.length??""} supported`)),F(le,de)};_e(Re,le=>{var de;(de=a().features)!=null&&de.length&&le(re)})}fe(()=>{se(Y,a().vendor),se(U,a().architecture)}),F(L,T)};_e(y,L=>{a()&&L(x)})}var k=S(y,2);{var w=L=>{var T=Bp(),K=b(T);fe(()=>se(K,i())),F(L,T)};_e(k,L=>{i()&&L(w)})}var O=S(k,2);O.__click=function(...L){var T;(T=e.onload)==null||T.apply(this,L)},fe(()=>O.disabled=i()),Lo(d,r),F(t,o),ut()}Pt(["click"]);var Kp=H('<span class="progress-percent svelte-r5fnze"> </span>'),Up=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Gp=H('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Hp=H('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Wp=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Yp=H('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Vp=H('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Xp(t,e){ct(e,!0);let r=Ie(e,"message",3,""),a=Ie(e,"items",19,()=>[]);Bt(()=>un("LoadingProgress"));var i=Vp(),o=b(i),u=b(o),d=S(o,2);nn(d,17,a,hr,(v,p)=>{const y=ft(()=>g(p).total?op(g(p).loaded||0,g(p).total):null);var x=Yp(),k=b(x),w=b(k),O=b(w),L=S(w,2);{var T=Y=>{var Z=Kp(),J=b(Z);fe(U=>se(J,`${U??""}%`),[()=>g(y).toFixed(1)]),F(Y,Z)};_e(L,Y=>{g(y)!==null&&Y(T)})}var K=S(k,2);{var oe=Y=>{var Z=Up(),J=at(Z),U=b(J),ce=S(J,2),ye=b(ce),Te=b(ye),ge=S(ye,4),ae=b(ge),ue=S(ge,2),Re=b(ue);fe((re,le,de,Q,ie)=>{tn(U,`width: ${re??""}%`),se(Te,le),se(ae,de),se(Re,`(${Q??""} / ${ie??""} B)`)},[()=>Math.max(g(p).progress??0,.5).toFixed(1),()=>Wi(g(p).loaded||0),()=>Wi(g(p).total),()=>(g(p).loaded||0).toLocaleString(),()=>g(p).total.toLocaleString()]),F(Y,Z)},$=Y=>{var Z=Wp(),J=S(at(Z),2),U=b(J);{var ce=Te=>{var ge=Gp(),ae=at(ge),ue=b(ae),Re=S(ae,2),re=b(Re);fe((le,de)=>{se(ue,le),se(re,`(${de??""} B)`)},[()=>Wi(g(p).loaded),()=>g(p).loaded.toLocaleString()]),F(Te,ge)},ye=Te=>{var ge=Hp();F(Te,ge)};_e(U,Te=>{g(p).loaded?Te(ce):Te(ye,!1)})}F(Y,Z)};_e(K,Y=>{g(p).total?Y(oe):Y($,!1)})}fe(()=>{pu(w,"title",g(p).file),se(O,g(p).file)}),F(v,x)}),fe(()=>se(u,r())),F(t,i),ut()}var Qp=H('<span class="thinking-tokens svelte-11gjw00"> </span>'),Zp=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Jp=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),$p=H('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),eh=H('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),th=H('<span class="cursor svelte-11gjw00">|</span>'),nh=H(" <!>",1),rh=H('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),ah=H('<div class="content svelte-11gjw00"> </div>'),sh=H('<div><div class="role svelte-11gjw00"> </div> <!></div>');function ih(t,e){ct(e,!0);let r=Ie(e,"isLast",3,!1),a=Ie(e,"isRunning",3,!1),i=Ie(e,"generationPhase",3,null),o=Ie(e,"numTokens",3,null);Bt(()=>un(`MessageBubble[${e.msg.role}]`));var u=sh(),d=b(u),v=b(d),p=S(d,2);{var y=k=>{var w=rh(),O=at(w);{var L=U=>{var ce=Zp(),ye=S(b(ce),4);{var Te=ge=>{var ae=Qp(),ue=b(ae);fe(()=>se(ue,`${o()??""} tokens`)),F(ge,ae)};_e(ye,ge=>{o()&&ge(Te)})}F(U,ce)},T=U=>{var ce=Jp();F(U,ce)};_e(O,U=>{a()&&r()&&i()==="thinking"?U(L):a()&&r()&&i()==="preparing"&&U(T,1)})}var K=S(O,2);{var oe=U=>{var ce=$p(),ye=b(ce),Te=S(b(ye),2),ge=b(Te),ae=S(ye,2),ue=b(ae);fe(Re=>{se(ge,`${Re??""} words`),se(ue,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),F(U,ce)};_e(K,U=>{e.msg.thinking&&U(oe)})}var $=S(K,2),Y=b($);{var Z=U=>{var ce=eh();F(U,ce)},J=U=>{var ce=nh(),ye=at(ce,!0),Te=S(ye);{var ge=ae=>{var ue=th();F(ae,ue)};_e(Te,ae=>{a()&&r()&&ae(ge)})}fe(()=>se(ye,e.msg.content)),F(U,ce)};_e(Y,U=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?U(Z):U(J,!1)})}F(k,w)},x=k=>{var w=ah(),O=b(w);fe(()=>se(O,e.msg.content)),F(k,w)};_e(p,k=>{e.msg.role==="assistant"?k(y):k(x,!1)})}fe(()=>{jt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),se(v,e.msg.role==="user"?"You":"AI")}),F(t,u),ut()}var oh=H('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),lh=H('<span class="edate svelte-mt5nvh"> </span>'),ch=H('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),uh=H('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),fh=H('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),dh=H('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),ph=H('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function hh(t,e){ct(e,!0);let r=Ie(e,"pendingData",3,null),a=Pe(null),i=Pe(null);function o(w){j(a,g(a)===w?null:w,!0),j(i,null)}function u(w){return w.split("_").map(O=>O.charAt(0)+O.slice(1).toLowerCase()).join(" ")}function d(w){if(!w)return"";try{return new Date(w).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(w){if(!w)return"";const O=w.replace(/<.*>/,"").trim();return O.length>24?O.slice(0,22)+"â¦":O}var p={toggleGroup:o},y=fa(),x=at(y);{var k=w=>{var O=ph(),L=b(O),T=b(L),K=S(L,2);nn(K,20,()=>r().order,Y=>Y,(Y,Z)=>{const J=ft(()=>r().groups[Z]),U=ft(()=>ho(Z)),ce=ft(()=>g(a)===Z);var ye=oh();let Te;ye.__click=()=>o(Z);let ge;var ae=b(ye);let ue;var Re=S(ae),re=S(Re),le=b(re);fe(de=>{Te=jt(ye,1,"chip svelte-mt5nvh",null,Te,{active:g(ce)}),ge=tn(ye,"",ge,{"--c":g(U)}),ue=tn(ae,"",ue,{background:g(U)}),se(Re,` ${de??""} `),se(le,g(J).length)},[()=>u(Z)]),F(Y,ye)});var oe=S(K,2);{var $=Y=>{const Z=ft(()=>r().groups[g(a)]),J=ft(()=>ho(g(a)));var U=dh(),ce=b(U);let ye;var Te=b(ce);Te.__click=()=>{j(a,null),j(i,null)};var ge=S(Te,2),ae=b(ge),ue=S(ge,2),Re=b(ue),re=S(ce,2);nn(re,21,()=>g(Z),ve=>ve.emailId,(ve,be)=>{var V=ch(),te=b(V);te.__click=()=>{var Be;return(Be=e.onaskai)==null?void 0:Be.call(e,`Tell me about the email "${g(be).subject}" from ${g(be).from}`)};var W=b(te),ne=b(W),Le=S(W,2),Fe=b(Le),rt=S(Fe);{var St=Be=>{var Tt=lh(),ht=b(Tt);fe(fn=>se(ht,fn),[()=>d(g(be).date)]),F(Be,Tt)};_e(rt,Be=>{g(be).date&&Be(St)})}var B=S(te,2),Ae=b(B);Ae.__click=()=>{var Be;return(Be=e.onmarkacted)==null?void 0:Be.call(e,g(be).emailId)};var De=S(Ae,2);De.__click=()=>{var Be;return(Be=e.ondismiss)==null?void 0:Be.call(e,g(be).emailId)},fe(Be=>{se(ne,g(be).subject),se(Fe,Be)},[()=>v(g(be).from)]),F(ve,V)});var le=S(re,2),de=b(le);{var Q=ve=>{var be=uh(),V=at(be);V.__click=()=>g(Z).forEach(W=>{var ne;return(ne=e.onmarkacted)==null?void 0:ne.call(e,W.emailId)});var te=S(V,2);te.__click=()=>j(i,g(a),!0),F(ve,be)},ie=ve=>{var be=fh(),V=at(be),te=b(V),W=S(V,2);W.__click=()=>j(i,null);var ne=S(W,2);ne.__click=()=>{var Le;(Le=e.oncleargroup)==null||Le.call(e,g(a)),j(i,null),j(a,null)},fe(()=>se(te,`Remove ${g(Z).length??""}?`)),F(ve,be)};_e(de,ve=>{g(i)!==g(a)?ve(Q):ve(ie,!1)})}fe(ve=>{ye=tn(ce,"",ye,{"border-color":g(J)}),se(ae,ve),se(Re,g(Z).length)},[()=>u(g(a))]),F(Y,U)};_e(oe,Y=>{g(a)&&r().groups[g(a)]&&Y($)})}fe(()=>se(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),F(w,O)};_e(x,w=>{r()&&r().total>0&&w(k)})}return F(t,y),ut(p)}Pt(["click"]);var vh=H('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),mh=H('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),gh=H('<div class="strip svelte-1ed7zw1"><!></div>');function yh(t,e){let r=Ie(e,"hasScanData",3,!1),a=Ie(e,"engineReady",3,!1),i=Ie(e,"isScanning",3,!1),o=ft(()=>a()&&!r()&&!i()),u=ft(()=>g(o)||i());var d=fa(),v=at(d);{var p=y=>{var x=gh(),k=b(x);{var w=L=>{var T=vh();F(L,T)},O=L=>{var T=mh();T.__click=function(...K){var oe;(oe=e.onscan)==null||oe.apply(this,K)},F(L,T)};_e(k,L=>{i()?L(w):g(o)&&L(O,1)})}F(y,x)};_e(v,y=>{g(u)&&y(p)})}F(t,d)}Pt(["click"]);var _h=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),bh=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),wh=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),kh=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),xh=H('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Sh=H('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Th=H('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Eh(t,e){ct(e,!0),Bt(()=>un("GpuPanel"));var r=Th(),a=b(r),i=S(b(a),2),o=S(b(i),2),u=b(o),d=S(i,2),v=S(b(d),2),p=b(v),y=S(d,2);{var x=Y=>{var Z=_h(),J=S(b(Z),2),U=b(J);fe(()=>se(U,e.gpuInfo.device)),F(Y,Z)};_e(y,Y=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&Y(x)})}var k=S(y,2);{var w=Y=>{var Z=bh(),J=S(b(Z),2),U=b(J);fe(ce=>se(U,ce),[()=>fo(e.gpuInfo.limits.maxBufferSize)]),F(Y,Z)};_e(k,Y=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxBufferSize&&Y(w)})}var O=S(k,2);{var L=Y=>{var Z=wh(),J=S(b(Z),2),U=b(J);fe(()=>se(U,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),F(Y,Z)};_e(O,Y=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxComputeInvocationsPerWorkgroup&&Y(L)})}var T=S(O,2);{var K=Y=>{var Z=kh(),J=S(b(Z),2),U=b(J);fe(ce=>se(U,ce),[()=>fo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),F(Y,Z)};_e(T,Y=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxComputeWorkgroupStorageSize&&Y(K)})}var oe=S(T,2);{var $=Y=>{var Z=Sh(),J=b(Z),U=b(J),ce=S(J,2);nn(ce,21,()=>e.gpuInfo.features,hr,(ye,Te)=>{var ge=xh(),ae=b(ge);fe(()=>se(ae,g(Te))),F(ye,ge)}),fe(()=>se(U,`Features (${e.gpuInfo.features.length??""})`)),F(Y,Z)};_e(oe,Y=>{var Z;(Z=e.gpuInfo.features)!=null&&Z.length&&Y($)})}fe(()=>{se(u,e.gpuInfo.vendor),se(p,e.gpuInfo.architecture)}),F(t,r),ut()}var Ah=H('<button class="gpu-badge svelte-1ktw27c"> </button>'),Ch=H('<span class="stats svelte-1ktw27c"> </span>'),Ih=H('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Rh=H('<span class="stats preparing svelte-1ktw27c"> </span>'),Ph=H('<span class="stats svelte-1ktw27c"> </span>'),Oh=H('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Dh=H('<button class="btn svelte-1ktw27c">Stop</button>'),Mh=H('<button class="btn primary svelte-1ktw27c">Send</button>'),jh=H('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Lh(t,e){ct(e,!0),Bt(()=>un("ChatView"));let r=Ie(e,"messages",19,()=>[]),a=Ie(e,"pendingData",3,null),i=Ie(e,"hasScanData",3,!1),o=Ie(e,"engineReady",3,!1),u=Ie(e,"isScanning",3,!1),d=Ie(e,"isRunning",3,!1),v=Ie(e,"tps",3,null),p=Ie(e,"numTokens",3,null),y=Ie(e,"generationPhase",3,null),x=Ie(e,"gpuInfo",3,null),k=Ie(e,"chatContainer",15),w=Pe(""),O=Pe(!1);function L(W){W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),T())}function T(){const W=g(w).trim();!W||d()||(j(w,""),e.onsend(W))}function K(W){W&&!d()&&e.onsend(W)}var oe=jh(),$=b(oe),Y=b($);{var Z=W=>{var ne=Ah();ne.__click=()=>j(O,!g(O));var Le=b(ne);fe(()=>se(Le,`WebGPU ${g(O)?"â²":"â¼"}`)),F(W,ne)};_e(Y,W=>{x()&&W(Z)})}var J=S(Y,2);{var U=W=>{var ne=Ch(),Le=b(ne);fe((Fe,rt)=>se(Le,`${p()??""} tokens in ${Fe??""}s
        (${rt??""} tok/s)`),[()=>(p()/v()).toFixed(1),()=>v().toFixed(1)]),F(W,ne)},ce=W=>{var ne=Ih();F(W,ne)},ye=W=>{var ne=Rh(),Le=b(ne);fe(Fe=>se(Le,`thinking... ${Fe??""}`),[()=>v()?`${v().toFixed(0)} tok/s`:""]),F(W,ne)},Te=W=>{var ne=Ph(),Le=b(ne);fe(Fe=>se(Le,`${Fe??""} tok/s`),[()=>v().toFixed(1)]),F(W,ne)};_e(J,W=>{v()&&!d()?W(U):d()&&y()==="preparing"?W(ce,1):d()&&y()==="thinking"?W(ye,2):v()&&d()&&W(Te,3)})}var ge=S(J,4);ge.__click=function(...W){var ne;(ne=e.onreset)==null||ne.apply(this,W)};var ae=S($,2);{var ue=W=>{Eh(W,{get gpuInfo(){return x()}})};_e(ae,W=>{g(O)&&x()&&W(ue)})}var Re=S(ae,2),re=b(Re);{var le=W=>{var ne=Oh();F(W,ne)};_e(re,W=>{r().length===0&&!(a()&&a().total>0)&&W(le)})}var de=S(re,2);nn(de,17,r,hr,(W,ne,Le)=>{var Fe=fa(),rt=at(Fe);{var St=Ae=>{hh(Ae,{get pendingData(){return g(ne).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:K})},B=Ae=>{{let De=ft(()=>Le===r().length-1);ih(Ae,{get msg(){return g(ne)},get isLast(){return g(De)},get isRunning(){return d()},get generationPhase(){return y()},get numTokens(){return p()}})}};_e(rt,Ae=>{g(ne).type==="dashboard"?Ae(St):Ae(B,!1)})}F(W,Fe)}),hu(Re,W=>k(W),()=>k());var Q=S(Re,2);yh(Q,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var ie=S(Q,2),ve=b(ie);ve.__keydown=L;var be=S(ve,2);{var V=W=>{var ne=Dh();ne.__click=function(...Le){var Fe;(Fe=e.onstop)==null||Fe.apply(this,Le)},F(W,ne)},te=W=>{var ne=Mh();ne.__click=T,fe(Le=>ne.disabled=Le,[()=>!g(w).trim()]),F(W,ne)};_e(be,W=>{d()?W(V):W(te,!1)})}fe(()=>{ge.disabled=d(),ve.disabled=d()}),No(ve,()=>g(w),W=>j(w,W)),F(t,oe),ut()}Pt(["click","keydown"]);var Nh=H('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function qh(t,e){ct(e,!0);const r=!!navigator.gpu,a=vu();let i=Pe(Mt(localStorage.getItem("selectedModel")||us[0].id)),o=Pe(null),u=Pe(null),d=Pe(""),v=Pe(Mt([])),p=Pe(Mt([])),y=Pe(!1),x=Pe(null),k=Pe(null),w=Pe(null),O=Pe(null),L=Pe(null),T=Pe(null),K=Pe(!1),oe=Pe(!1),$=!1;Bt(()=>{a.check(),a.isReady&&Y();const V=a.onMessage(te=>{switch(te.status){case"webgpu-info":j(O,te.data,!0);break;case"loading":j(o,"loading"),j(d,te.data,!0);break;case"initiate":j(v,[...g(v),te],!0);break;case"progress":j(v,g(v).map(W=>W.file===te.file?{...W,...te}:W),!0);break;case"done":j(v,g(v).filter(W=>W.file!==te.file),!0);break;case"ready":j(o,"ready"),Y();break;case"start":if(!g(y))break;j(L,te.phase||"preparing",!0),j(p,[...g(p),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!g(y))break;j(L,te.phase,!0);break;case"thinking":{if(!g(y))break;j(x,te.tps,!0),j(k,te.numTokens,!0);const W=g(p)[g(p).length-1];j(p,[...g(p).slice(0,-1),{...W,thinking:(W.thinking||"")+te.content}],!0),ge();break}case"thinking-done":{if(!g(y))break;j(x,te.tps,!0),j(k,te.numTokens,!0);const W=g(p)[g(p).length-1];j(p,[...g(p).slice(0,-1),{...W,thinking:te.content}],!0);break}case"update":{if(!g(y))break;j(x,te.tps,!0),j(k,te.numTokens,!0);const W=g(p)[g(p).length-1];j(p,[...g(p).slice(0,-1),{...W,content:W.content+te.output}],!0),ge();break}case"complete":if(!g(y))break;j(y,!1),j(L,null),Z();break;case"error":if(!g(y))break;j(u,te.data,!0),j(y,!1),j(L,null);break}});return()=>V()});async function Y(){if(!($||g(p).length>0))try{const V=await Hl();j(T,V,!0),V&&($=!0,j(p,[{role:"assistant",type:"dashboard",pendingData:V}],!0),ge());const te=await po();j(K,te.classified>0)}catch{}}async function Z(){try{const V=await Hl();j(T,V,!0);const te=g(p).findIndex(ne=>ne.type==="dashboard");te!==-1&&(V&&V.total>0?j(p,g(p).map((ne,Le)=>Le===te?{...ne,pendingData:V}:ne),!0):j(p,g(p).filter((ne,Le)=>Le!==te),!0));const W=await po();j(K,W.classified>0)}catch{}}async function J(V){await ri(V,"acted"),await Z()}async function U(V){await ri(V,"dismissed"),await Z()}async function ce(V){await Iu(V),await Z()}async function ye(V){await zo(V),await Z()}async function Te(){if(!(g(oe)||!a.isReady)){j(oe,!0);try{await Cu(a,{count:20}),await Z(),g(T)&&!g(p).some(V=>V.type==="dashboard")&&(j(p,[{role:"assistant",type:"dashboard",pendingData:g(T)},...g(p)],!0),ge())}catch(V){console.error("Scan failed:",V)}finally{j(oe,!1)}}}function ge(){lu().then(()=>{g(w)&&(g(w).scrollTop=g(w).scrollHeight)})}function ae(){j(o,"loading"),localStorage.setItem("selectedModel",g(i)),a.loadModel(g(i))}async function ue(V){if(!V||g(y))return;j(p,[...g(p),{role:"user",content:V}],!0),j(x,null),j(y,!0);let te=[];try{const Le=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(V)?await xp(V):await kp();Le&&(te=[{role:"system",content:Le}])}catch{}const W=g(p).filter(ne=>ne.type!=="dashboard").map(ne=>({role:ne.role,content:ne.content}));a.generate([...te,...W]),ge()}function Re(){a.interrupt()}function re(){a.reset(),j(p,[],!0),j(x,null),j(k,null),$=!1,Y()}var le=fa(),de=at(le);{var Q=V=>{var te=Nh();F(V,te)},ie=V=>{Fp(V,{get gpuInfo(){return g(O)},get error(){return g(u)},onload:ae,get selectedModel(){return g(i)},set selectedModel(te){j(i,te,!0)}})},ve=V=>{Xp(V,{get message(){return g(d)},get items(){return g(v)}})},be=V=>{Lh(V,{get messages(){return g(p)},get pendingData(){return g(T)},get hasScanData(){return g(K)},get engineReady(){return a.isReady},get isScanning(){return g(oe)},get isRunning(){return g(y)},get tps(){return g(x)},get numTokens(){return g(k)},get generationPhase(){return g(L)},get gpuInfo(){return g(O)},onsend:ue,onstop:Re,onreset:re,onmarkacted:J,ondismiss:U,onremove:ce,oncleargroup:ye,onscan:Te,get chatContainer(){return g(w)},set chatContainer(te){j(w,te,!0)}})};_e(de,V=>{r?g(o)===null?V(ie,1):g(o)==="loading"?V(ve,2):V(be,!1):V(Q)})}F(t,le),ut()}const Vl="https://accounts.google.com/gsi/client",Bh="https://www.googleapis.com/auth/gmail.readonly",Fo="me-ai:oauth-token",Ko=300*1e3;let fs=null,os=null,Dr=0;function Pu(t,e){Dr=Date.now()+e*1e3;try{sessionStorage.setItem(Fo,JSON.stringify({access_token:t,expires_at:Dr}))}catch{}}function vo(){Dr=0;try{sessionStorage.removeItem(Fo)}catch{}}function zh(){try{const t=sessionStorage.getItem(Fo);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-Ko?(vo(),null):(Dr=r,{access_token:e})}catch{return vo(),null}}function Fh(){return Dr>0&&Date.now()<Dr-Ko}function Kh(){return Dr<=0?0:Math.max(0,Dr-Ko-Date.now())}function Xl(){return new Promise((t,e)=>{if(!fs){e(new Error("Google Auth not initialized."));return}os=r=>{r.error?e(new Error(r.error_description||r.error)):(Pu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},fs.requestAccessToken({prompt:""})})}function Uh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Vl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Vl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Ql(t){await Uh(),fs=google.accounts.oauth2.initTokenClient({client_id:t,scope:Bh,callback:e=>{os&&(os(e),os=null)}})}function Gh(){return new Promise((t,e)=>{if(!fs){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}os=r=>{r.error?e(new Error(r.error_description||r.error)):(Pu(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},fs.requestAccessToken()})}function Hh(t){return vo(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Lt="gmail",Zl=8,Ou=50,Du=100;async function Wh(t,{limit:e=Ou,onProgress:r=()=>{},signal:a}={}){var u;const i=await qe.syncState.get(Lt);if(i!=null&&i.historyId)try{return await Zh(t,i,r,a)}catch(d){if(d instanceof qo&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await qe.syncState.delete(Lt);else throw d}return await Xh(t,e===0?1/0:e,r,a)}async function Yh(t,{limit:e=Ou,onProgress:r=()=>{},signal:a}={}){const i=await qe.syncState.get(Lt);return i!=null&&i.oldestPageToken?await Qh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Vh(){const t=await qe.syncState.get(Lt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Mu(){await qe.transaction("rw",[qe.items,qe.syncState],async()=>{await qe.items.where("sourceType").equals(Lt).delete(),await qe.syncState.delete(Lt)})}async function Xh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),la(a);const i=await yu(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){la(a);const x=e-o.length,k=await _u(t,{maxResults:Math.min(Du,x),pageToken:u}),w=(k.messages||[]).map(O=>O.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=k.nextPageToken,!u||w.length===0)break}if(d=u||null,o.length===0)return await qe.syncState.put({sourceType:Lt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:p}=await ju(t,o,r,a),y=await qe.items.where("sourceType").equals(Lt).count();return await qe.syncState.put({sourceType:Lt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:p}}async function Qh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),la(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){la(i);const x=r-o.length,k=await _u(t,{maxResults:Math.min(Du,x),pageToken:u}),w=(k.messages||[]).map(O=>O.id);if(o.push(...w),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=k.nextPageToken,!u||w.length===0)break}if(d=u||null,o.length===0)return await qe.syncState.update(Lt,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:p}=await ju(t,o,a,i),y=await qe.items.where("sourceType").equals(Lt).count();return await qe.syncState.update(Lt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:p}}async function Zh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),la(a);let i=0,o=0,u=0,d,v=e.historyId;do{la(a);const y=await fp(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const x of y.history){if(x.messagesAdded){const k=x.messagesAdded.map(O=>O.message.id),w=[...new Set(k.filter(O=>O))];if(w.length>0){const O=await Promise.allSettled(w.map(T=>bu(t,T))),L=[];for(const T of O)T.status==="fulfilled"?L.push(Lu(T.value)):u++;L.length>0&&(await qe.items.bulkPut(L),await Nu(L),i+=L.length)}}if(x.messagesDeleted){const k=x.messagesDeleted.map(w=>mu(Lt,w.message.id)).filter(w=>w);k.length>0&&(await qe.items.bulkDelete(k),o+=k.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await qe.items.where("sourceType").equals(Lt).count();return await qe.syncState.put({sourceType:Lt,historyId:v,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:u}}async function ju(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=Zl){la(a);const d=e.slice(u,u+Zl),v=await Promise.allSettled(d.map(y=>bu(t,y))),p=[];for(const y of v)y.status==="fulfilled"?p.push(Lu(y.value)):o++;p.length>0&&(await qe.items.bulkPut(p),await Nu(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Lu(t){const e=Tr(t,"From"),r=Tr(t,"To"),a=Tr(t,"Cc"),i=Tr(t,"Subject")||"(no subject)",o=Tr(t,"Date"),u=Tr(t,"Message-ID"),d=Tr(t,"In-Reply-To"),v=Tr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:mu(Lt,t.id),sourceType:Lt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:dp(t),htmlBody:pp(t),date:p,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Nu(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Jh(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await qe.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await qe.contacts.update(o.id,u)}else await qe.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Jh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function la(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var $h=H(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function ev(t,e){ct(e,!0);let r=Ie(e,"clientIdInput",15);Bt(()=>un("SetupGuide"));let a=Pe(null);async function i(W){try{await navigator.clipboard.writeText(W),j(a,W,!0),setTimeout(()=>{j(a,null)},1500)}catch{const ne=document.createElement("input");ne.value=W,document.body.appendChild(ne),ne.select(),document.execCommand("copy"),document.body.removeChild(ne),j(a,W,!0),setTimeout(()=>{j(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=$h(),p=b(v),y=S(b(p),4),x=S(b(y),6),k=S(b(x),2),w=S(b(k),2),O=S(b(w),2),L=b(O);L.__click=()=>i(o);var T=b(L);T.textContent="http://localhost:5173";var K=S(T,2),oe=b(K),$=S(L,2);$.__click=()=>i(u);var Y=b($);Y.textContent="https://cypherkitty.github.io";var Z=S(Y,2),J=b(Z),U=S(w,2),ce=S(b(U),2),ye=b(ce);ye.__click=()=>i(o);var Te=b(ye);Te.textContent="http://localhost:5173";var ge=S(Te,2),ae=b(ge),ue=S(ye,2);ue.__click=()=>i(u);var Re=b(ue);Re.textContent="https://cypherkitty.github.io";var re=S(Re,2),le=b(re),de=S(ue,2);de.__click=()=>i(d);var Q=b(de);Q.textContent="https://cypherkitty.github.io/me-ai/";var ie=S(Q,2),ve=b(ie),be=S(y,2),V=b(be);V.__keydown=W=>W.key==="Enter"&&e.onsave();var te=S(V,2);te.__click=function(...W){var ne;(ne=e.onsave)==null||ne.apply(this,W)},fe(W=>{se(oe,g(a)===o?"â":"â§"),se(J,g(a)===u?"â":"â§"),se(ae,g(a)===o?"â":"â§"),se(le,g(a)===u?"â":"â§"),se(ve,g(a)===d?"â":"â§"),te.disabled=W},[()=>!r().trim()]),No(V,r),F(t,v),ut()}Pt(["click","keydown"]);function tv(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof qo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var nv=H('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),rv=H('<div class="error-card-title svelte-14buhqq"> </div>'),av=H('<p class="error-card-fix svelte-14buhqq"> </p>'),sv=H('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),iv=H('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),ov=H('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function qu(t,e){ct(e,!0);let r=Ie(e,"ondismiss",3,null),a=Ie(e,"onsignout",3,null),i=ft(()=>tv(e.error));Bt(()=>un("ErrorCard"));var o=ov(),u=b(o);{var d=K=>{var oe=nv(),$=b(oe),Y=b($),Z=S($,2);Z.__click=function(...J){var U;(U=r())==null||U.apply(this,J)},fe(()=>se(Y,g(i).title)),F(K,oe)},v=K=>{var oe=rv(),$=b(oe);fe(()=>se($,g(i).title)),F(K,oe)};_e(u,K=>{r()?K(d):K(v,!1)})}var p=S(u,2),y=b(p),x=S(p,2);{var k=K=>{var oe=av(),$=b(oe);fe(()=>se($,g(i).fix)),F(K,oe)};_e(x,K=>{g(i).fix&&K(k)})}var w=S(x,2);{var O=K=>{var oe=sv(),$=b(oe);fe(()=>{pu(oe,"href",g(i).link.url),se($,`${g(i).link.label??""} â`)}),F(K,oe)};_e(w,K=>{g(i).link&&K(O)})}var L=S(w,2);{var T=K=>{var oe=iv();oe.__click=function(...$){var Y;(Y=a())==null||Y.apply(this,$)},F(K,oe)};_e(L,K=>{g(i).action==="signout"&&a()&&K(T)})}fe(()=>se(y,g(i).description)),F(t,o),ut()}Pt(["click"]);var lv=H('<span class="spinner svelte-nyqevv"></span> Signing in...',1),cv=jo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),uv=H(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function fv(t,e){ct(e,!0);let r=Ie(e,"error",3,null),a=Ie(e,"loadingAuth",3,!1);Bt(()=>un("AuthCard"));var i=uv(),o=b(i),u=S(b(o),4);{var d=T=>{qu(T,{get error(){return r()},get onsignout(){return e.onsignout}})};_e(u,T=>{r()&&T(d)})}var v=S(u,2);v.__click=function(...T){var K;(K=e.onsignin)==null||K.apply(this,T)};var p=b(v);{var y=T=>{var K=lv();F(T,K)},x=T=>{var K=cv();F(T,K)};_e(p,T=>{a()?T(y):T(x,!1)})}var k=S(v,2),w=S(b(k),2),O=b(w),L=S(w,2);L.__click=function(...T){var K;(K=e.onclear)==null||K.apply(this,T)},fe(T=>{v.disabled=a(),se(O,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),F(t,i),ut()}Pt(["click"]);var dv=H('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),pv=H('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),hv=H('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function vv(t,e){ct(e,!0);let r=Ie(e,"profile",3,null),a=Ie(e,"loadingProfile",3,!1);Bt(()=>un("ProfileCard"));var i=hv(),o=b(i),u=b(o),d=S(o,2),v=b(d);{var p=k=>{var w=dv();F(k,w)},y=k=>{var w=pv(),O=at(w),L=b(O),T=S(O,2),K=b(T);fe((oe,$)=>{se(L,r().emailAddress),se(K,`${oe??""} messages
        Â· ${$??""} threads`)},[()=>{var oe;return((oe=r().messagesTotal)==null?void 0:oe.toLocaleString())||"?"},()=>{var oe;return((oe=r().threadsTotal)==null?void 0:oe.toLocaleString())||"?"}]),F(k,w)};_e(v,k=>{a()?k(p):r()&&k(y,1)})}var x=S(d,2);x.__click=function(...k){var w;(w=e.onsignout)==null||w.apply(this,k)},fe(k=>se(u,k),[()=>r()?ku(r().emailAddress):"?"]),F(t,i),ut()}Pt(["click"]);var mv=H('<span class="spinner svelte-1ds3j4k"></span>'),gv=jo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),yv=H('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),_v=H('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),bv=H('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),wv=H('<option class="svelte-1ds3j4k"> </option>'),kv=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),xv=H('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Sv=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Tv=H('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Ev=H('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Av=H('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Cv(t,e){ct(e,!0),Bt(()=>un("SyncStatus"));let r=Ie(e,"syncStatus",3,null),a=Ie(e,"syncProgress",3,null),i=Ie(e,"isSyncing",3,!1),o=Pe(!1),u=Pe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(Q){if(!Q)return"never";const ie=Math.floor((Date.now()-Q)/1e3);if(ie<60)return"just now";const ve=Math.floor(ie/60);if(ve<60)return`${ve}m ago`;const be=Math.floor(ve/60);return be<24?`${be}h ago`:`${Math.floor(be/24)}d ago`}function p(){var Q,ie;return!((Q=a())!=null&&Q.total)||!((ie=a())!=null&&ie.current)?0:Math.round(a().current/a().total*100)}var y=Av(),x=b(y),k=b(x),w=b(k);{var O=Q=>{var ie=mv();F(Q,ie)},L=Q=>{var ie=gv();F(Q,ie)};_e(w,Q=>{i()?Q(O):Q(L,!1)})}var T=S(k,2),K=S(b(T),2);{var oe=Q=>{var ie=yv(),ve=b(ie),be=S(ve);{var V=W=>{var ne=Nl("Â· more available");F(W,ne)},te=W=>{var ne=Nl("Â· all synced");F(W,ne)};_e(be,W=>{r().hasMore?W(V):W(te,!1)})}fe((W,ne)=>se(ve,`${W??""} emails stored
          Â· synced ${ne??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),F(Q,ie)},$=Q=>{var ie=_v();F(Q,ie)};_e(K,Q=>{var ie;(ie=r())!=null&&ie.synced?Q(oe):Q($,!1)})}var Y=S(T,2),Z=b(Y);{var J=Q=>{var ie=bv();ie.__click=()=>j(o,!g(o)),F(Q,ie)};_e(Z,Q=>{var ie;(ie=r())!=null&&ie.synced&&!i()&&Q(J)})}var U=S(x,2),ce=b(U),ye=S(b(ce),2);nn(ye,21,()=>d,hr,(Q,ie)=>{var ve=wv(),be=b(ve),V={};fe(()=>{se(be,g(ie).label),V!==(V=g(ie).value)&&(ve.value=(ve.__value=g(ie).value)??"")}),F(Q,ve)});var Te=S(ce,2),ge=b(Te);{var ae=Q=>{var ie=xv(),ve=at(ie);ve.__click=()=>e.onsync(g(u));var be=b(ve),V=S(ve,2);{var te=W=>{var ne=kv();ne.__click=()=>e.onsyncmore(g(u));var Le=b(ne);fe(()=>{ne.disabled=i(),se(Le,i()?"Loading...":"Sync More")}),F(W,ne)};_e(V,W=>{r().hasMore&&W(te)})}fe(()=>{ve.disabled=i(),se(be,i()?"Syncing...":"Sync New")}),F(Q,ie)},ue=Q=>{var ie=Sv();ie.__click=()=>e.onsync(g(u));var ve=b(ie);fe(()=>{ie.disabled=i(),se(ve,i()?"Syncing...":"Download Emails")}),F(Q,ie)};_e(ge,Q=>{var ie;(ie=r())!=null&&ie.synced?Q(ae):Q(ue,!1)})}var Re=S(U,2);{var re=Q=>{var ie=Tv(),ve=b(ie),be=b(ve);let V,te;var W=S(ve,2),ne=b(W);fe(Le=>{V=jt(be,1,"progress-fill svelte-1ds3j4k",null,V,{indeterminate:!a().total}),te=tn(be,"",te,Le),se(ne,a().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),F(Q,ie)};_e(Re,Q=>{i()&&a()&&Q(re)})}var le=S(Re,2);{var de=Q=>{var ie=Ev(),ve=S(b(ie),2),be=b(ve);be.__click=()=>j(o,!1);var V=S(be,2);V.__click=()=>{e.onclear(),j(o,!1)},F(Q,ie)};_e(le,Q=>{g(o)&&Q(de)})}fe(()=>ye.disabled=i()),Lo(ye,()=>g(u),Q=>j(u,Q)),F(t,y),ut()}Pt(["click"]);var Iv=H('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Rv=H('<div class="message-list svelte-y2uamw"></div>');function Pv(t,e){ct(e,!0);let r=Ie(e,"messages",19,()=>[]);Bt(()=>un("MessageList"));var a=Rv();nn(a,21,r,hr,(i,o)=>{var u=Iv();u.__click=()=>e.onselect(g(o));var d=b(u),v=b(d),p=S(d,2),y=b(p),x=b(y),k=b(x),w=S(x,2),O=b(w),L=S(y,2),T=b(L),K=S(L,2),oe=b(K);fe(($,Y,Z)=>{se(v,$),se(k,Y),se(O,Z),se(T,g(o).subject),se(oe,g(o).snippet)},[()=>ku(g(o).from),()=>wu(g(o).from),()=>Bo(g(o).date)]),F(i,u)}),F(t,a),ut()}Pt(["click"]);function Uo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var da=Uo();function Bu(t){da=t}var Wr={exec:()=>null};function Ze(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(Wt.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Ov=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Wt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Dv=/^(?:[ \t]*(?:\n|$))+/,Mv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,jv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,bs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Lv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Go=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,zu=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Fu=Ze(zu).replace(/bull/g,Go).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Nv=Ze(zu).replace(/bull/g,Go).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ho=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,qv=/^[^\n]+/,Wo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Bv=Ze(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Wo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),zv=Ze(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Go).getRegex(),hi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Yo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Fv=Ze("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Yo).replace("tag",hi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ku=Ze(Ho).replace("hr",bs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex(),Kv=Ze(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ku).getRegex(),Vo={blockquote:Kv,code:Mv,def:Bv,fences:jv,heading:Lv,hr:bs,html:Fv,lheading:Fu,list:zv,newline:Dv,paragraph:Ku,table:Wr,text:qv},Jl=Ze("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",bs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex(),Uv={...Vo,lheading:Nv,table:Jl,paragraph:Ze(Ho).replace("hr",bs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Jl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hi).getRegex()},Gv={...Vo,html:Ze(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Yo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ze(Ho).replace("hr",bs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Fu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Hv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Wv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Uu=/^( {2,}|\\)\n(?!\s*$)/,Yv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,vi=/[\p{P}\p{S}]/u,Xo=/[\s\p{P}\p{S}]/u,Gu=/[^\s\p{P}\p{S}]/u,Vv=Ze(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Xo).getRegex(),Hu=/(?!~)[\p{P}\p{S}]/u,Xv=/(?!~)[\s\p{P}\p{S}]/u,Qv=/(?:[^\s\p{P}\p{S}]|~)/u,Wu=/(?![*_])[\p{P}\p{S}]/u,Zv=/(?![*_])[\s\p{P}\p{S}]/u,Jv=/(?:[^\s\p{P}\p{S}]|[*_])/u,$v=Ze(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Ov?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Yu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,em=Ze(Yu,"u").replace(/punct/g,vi).getRegex(),tm=Ze(Yu,"u").replace(/punct/g,Hu).getRegex(),Vu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",nm=Ze(Vu,"gu").replace(/notPunctSpace/g,Gu).replace(/punctSpace/g,Xo).replace(/punct/g,vi).getRegex(),rm=Ze(Vu,"gu").replace(/notPunctSpace/g,Qv).replace(/punctSpace/g,Xv).replace(/punct/g,Hu).getRegex(),am=Ze("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Gu).replace(/punctSpace/g,Xo).replace(/punct/g,vi).getRegex(),sm=Ze(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Wu).getRegex(),im="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",om=Ze(im,"gu").replace(/notPunctSpace/g,Jv).replace(/punctSpace/g,Zv).replace(/punct/g,Wu).getRegex(),lm=Ze(/\\(punct)/,"gu").replace(/punct/g,vi).getRegex(),cm=Ze(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),um=Ze(Yo).replace("(?:-->|$)","-->").getRegex(),fm=Ze("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",um).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ai=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,dm=Ze(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ai).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Xu=Ze(/^!?\[(label)\]\[(ref)\]/).replace("label",ai).replace("ref",Wo).getRegex(),Qu=Ze(/^!?\[(ref)\](?:\[\])?/).replace("ref",Wo).getRegex(),pm=Ze("reflink|nolink(?!\\()","g").replace("reflink",Xu).replace("nolink",Qu).getRegex(),$l=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Qo={_backpedal:Wr,anyPunctuation:lm,autolink:cm,blockSkip:$v,br:Uu,code:Wv,del:Wr,delLDelim:Wr,delRDelim:Wr,emStrongLDelim:em,emStrongRDelimAst:nm,emStrongRDelimUnd:am,escape:Hv,link:dm,nolink:Qu,punctuation:Vv,reflink:Xu,reflinkSearch:pm,tag:fm,text:Yv,url:Wr},hm={...Qo,link:Ze(/^!?\[(label)\]\((.*?)\)/).replace("label",ai).getRegex(),reflink:Ze(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ai).getRegex()},mo={...Qo,emStrongRDelimAst:rm,emStrongLDelim:tm,delLDelim:sm,delRDelim:om,url:Ze(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",$l).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ze(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",$l).getRegex()},vm={...mo,br:Ze(Uu).replace("{2,}","*").getRegex(),text:Ze(mo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Gs={normal:Vo,gfm:Uv,pedantic:Gv},Va={normal:Qo,gfm:mo,breaks:vm,pedantic:hm},mm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ec=t=>mm[t];function ar(t,e){if(e){if(Wt.escapeTest.test(t))return t.replace(Wt.escapeReplace,ec)}else if(Wt.escapeTestNoEncode.test(t))return t.replace(Wt.escapeReplaceNoEncode,ec);return t}function tc(t){try{t=encodeURI(t).replace(Wt.percentDecode,"%")}catch{return null}return t}function nc(t,e){var o;let r=t.replace(Wt.findPipe,(u,d,v)=>{let p=!1,y=d;for(;--y>=0&&v[y]==="\\";)p=!p;return p?"|":" |"}),a=r.split(Wt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Wt.slashPipe,"|");return a}function Xa(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function gm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function ym(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function rc(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function _m(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var si=class{constructor(t){We(this,"options");We(this,"rules");We(this,"lexer");this.options=t||da}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Xa(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=_m(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Xa(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Xa(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Xa(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),u=!0;else if(!u)d.push(r[v]);else break;r=r.slice(v);let p=d.join(`
`),y=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,i=i?`${i}
${y}`:y;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=x,r.length===0)break;let k=o.at(-1);if((k==null?void 0:k.type)==="code")break;if((k==null?void 0:k.type)==="blockquote"){let w=k,O=w.raw+`
`+r.join(`
`),L=this.blockquote(O);o[o.length-1]=L,a=a.substring(0,a.length-w.raw.length)+L.raw,i=i.substring(0,i.length-w.text.length)+L.text;break}else if((k==null?void 0:k.type)==="list"){let w=k,O=w.raw+`
`+r.join(`
`),L=this.list(O);o[o.length-1]=L,a=a.substring(0,a.length-k.raw.length)+L.raw,i=i.substring(0,i.length-w.raw.length)+L.raw,r=O.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,x="",k="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let w=ym(e[2].split(`
`,1)[0],e[1].length),O=t.split(`
`,1)[0],L=!w.trim(),T=0;if(this.options.pedantic?(T=2,k=w.trimStart()):L?T=e[1].length+1:(T=w.search(this.rules.other.nonSpaceChar),T=T>4?1:T,k=w.slice(T),T+=e[1].length),L&&this.rules.other.blankLine.test(O)&&(x+=O+`
`,t=t.substring(O.length+1),y=!0),!y){let K=this.rules.other.nextBulletRegex(T),oe=this.rules.other.hrRegex(T),$=this.rules.other.fencesBeginRegex(T),Y=this.rules.other.headingBeginRegex(T),Z=this.rules.other.htmlBeginRegex(T),J=this.rules.other.blockquoteBeginRegex(T);for(;t;){let U=t.split(`
`,1)[0],ce;if(O=U,this.options.pedantic?(O=O.replace(this.rules.other.listReplaceNesting,"  "),ce=O):ce=O.replace(this.rules.other.tabCharGlobal,"    "),$.test(O)||Y.test(O)||Z.test(O)||J.test(O)||K.test(O)||oe.test(O))break;if(ce.search(this.rules.other.nonSpaceChar)>=T||!O.trim())k+=`
`+ce.slice(T);else{if(L||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||$.test(w)||Y.test(w)||oe.test(w))break;k+=`
`+O}L=!O.trim(),x+=U+`
`,t=t.substring(U.length+1),w=ce.slice(T)}}u.loose||(v?u.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(v=!0)),u.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(k),loose:!1,text:k,tokens:[]}),u.raw+=x}let p=u.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let y of u.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let k=this.lexer.inlineQueue.length-1;k>=0;k--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[k].src)){this.lexer.inlineQueue[k].src=this.lexer.inlineQueue[k].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(y.raw);if(x){let k={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};y.checked=k.checked,u.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=k.raw+y.tokens[0].raw,y.tokens[0].text=k.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(k)):y.tokens.unshift({type:"paragraph",raw:k.raw,text:k.raw,tokens:[k]}):y.tokens.unshift(k)}}if(!u.loose){let x=y.tokens.filter(w=>w.type==="space"),k=x.length>0&&x.some(w=>this.rules.other.anyLine.test(w.raw));u.loose=k}}if(u.loose)for(let y of u.items){y.loose=!0;for(let x of y.tokens)x.type==="text"&&(x.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=nc(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(nc(d,o.header.length).map((v,p)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Xa(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=gm(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),rc(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return rc(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,v=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(a=p.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){v+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+v);let y=[...a[0]][0].length,x=t.slice(0,i+a.index+y+u);if(Math.min(i,u)%2){let w=x.slice(1,-1);return{type:"em",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}let k=x.slice(2,-2);return{type:"strong",raw:x,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let p=[...a[0]][0].length,y=t.slice(0,i+a.index+p+u),x=y.slice(i,-i);return{type:"del",raw:y,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Mn=class go{constructor(e){We(this,"tokens");We(this,"options");We(this,"state");We(this,"inlineQueue");We(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||da,this.options.tokenizer=this.options.tokenizer||new si,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Wt,block:Gs.normal,inline:Va.normal};this.options.pedantic?(r.block=Gs.pedantic,r.inline=Va.pedantic):this.options.gfm&&(r.block=Gs.gfm,this.options.breaks?r.inline=Va.breaks:r.inline=Va.gfm),this.tokenizer.rules=r}static get rules(){return{block:Gs,inline:Va}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace(Wt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(Wt.tabCharGlobal,"    ").replace(Wt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((u=this.options.extensions)!=null&&u.startBlock){let p=1/0,y=e.slice(1),x;this.options.extensions.startBlock.forEach(k=>{x=k.call({lexer:this},y),typeof x=="number"&&x>=0&&(p=Math.min(p,x))}),p<1/0&&p>=0&&(v=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let p=r.at(-1);a&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,p,y,x,k;let a=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((p=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:p.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let w;if((x=(y=this.options.extensions)==null?void 0:y.inline)!=null&&x.some(L=>(w=L.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let L=r.at(-1);w.type==="text"&&(L==null?void 0:L.type)==="text"?(L.raw+=w.raw,L.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let O=e;if((k=this.options.extensions)!=null&&k.startInline){let L=1/0,T=e.slice(1),K;this.options.extensions.startInline.forEach(oe=>{K=oe.call({lexer:this},T),typeof K=="number"&&K>=0&&(L=Math.min(L,K))}),L<1/0&&L>=0&&(O=e.substring(0,L+1))}if(w=this.tokenizer.inlineText(O)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),u=!0;let L=r.at(-1);(L==null?void 0:L.type)==="text"?(L.raw+=w.raw,L.text+=w.text):r.push(w);continue}if(e){let L="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(L);break}else throw new Error(L)}}return r}},ii=class{constructor(t){We(this,"options");We(this,"parser");this.options=t||da}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Wt.notSpaceStart))==null?void 0:o[0],i=t.replace(Wt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ar(a)+'">'+(r?i:ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=tc(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ar(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=tc(t);if(i===null)return ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ar(t.text)}},Zo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},jn=class yo{constructor(e){We(this,"options");We(this,"renderer");We(this,"textRenderer");this.options=e||da,this.options.renderer=this.options.renderer||new ii,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Zo}static parse(e,r){return new yo(r).parse(e)}static parseInline(e,r){return new yo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let v=u,p=this.options.extensions.renderers[v.type].call({parser:this},v);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=p||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=p||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let p='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return a}},Ys,ns=(Ys=class{constructor(t){We(this,"options");We(this,"block");this.options=t||da}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Mn.lex:Mn.lexInline}provideParser(){return this.block?jn.parse:jn.parseInline}},We(Ys,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),We(Ys,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Ys),bm=class{constructor(...t){We(this,"defaults",Uo());We(this,"options",this.setOptions);We(this,"parse",this.parseMarkdown(!0));We(this,"parseInline",this.parseMarkdown(!1));We(this,"Parser",jn);We(this,"Renderer",ii);We(this,"TextRenderer",Zo);We(this,"Lexer",Mn);We(this,"Tokenizer",si);We(this,"Hooks",ns);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let v=u[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ii(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],v=i[u];i[u]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new si(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],v=i[u];i[u]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ns;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],v=i[u];ns.passThroughHooks.has(o)?i[u]=p=>{if(this.defaults.async&&ns.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,p);return v.call(i,x)})();let y=d.call(i,p);return v.call(i,y)}:i[u]=(...p)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,p);return x===!1&&(x=await v.apply(i,p)),x})();let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Mn.lex(t,e??this.defaults)}parser(t,e){return jn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(u,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?jn.parse:jn.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?jn.parse:jn.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ca=new bm;function tt(t,e){return ca.parse(t,e)}tt.options=tt.setOptions=function(t){return ca.setOptions(t),tt.defaults=ca.defaults,Bu(tt.defaults),tt};tt.getDefaults=Uo;tt.defaults=da;tt.use=function(...t){return ca.use(...t),tt.defaults=ca.defaults,Bu(tt.defaults),tt};tt.walkTokens=function(t,e){return ca.walkTokens(t,e)};tt.parseInline=ca.parseInline;tt.Parser=jn;tt.parser=jn.parse;tt.Renderer=ii;tt.TextRenderer=Zo;tt.Lexer=Mn;tt.lexer=Mn.lex;tt.Tokenizer=si;tt.Hooks=ns;tt.parse=tt;tt.options;tt.setOptions;tt.use;tt.walkTokens;tt.parseInline;jn.parse;Mn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Zu,setPrototypeOf:ac,isFrozen:wm,getPrototypeOf:km,getOwnPropertyDescriptor:xm}=Object;let{freeze:Yt,seal:Tn,create:_o}=Object,{apply:bo,construct:wo}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});Tn||(Tn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});wo||(wo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Hs=Vt(Array.prototype.forEach),Sm=Vt(Array.prototype.lastIndexOf),sc=Vt(Array.prototype.pop),Qa=Vt(Array.prototype.push),Tm=Vt(Array.prototype.splice),$s=Vt(String.prototype.toLowerCase),Yi=Vt(String.prototype.toString),Vi=Vt(String.prototype.match),Za=Vt(String.prototype.replace),Em=Vt(String.prototype.indexOf),Am=Vt(String.prototype.trim),On=Vt(Object.prototype.hasOwnProperty),Ht=Vt(RegExp.prototype.test),Ja=Cm(TypeError);function Vt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function Cm(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return wo(t,r)}}function He(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$s;ac&&ac(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(wm(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Im(t){for(let e=0;e<t.length;e++)On(t,e)||(t[e]=null);return t}function Hn(t){const e=_o(null);for(const[r,a]of Zu(t))On(t,r)&&(Array.isArray(a)?e[r]=Im(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=Hn(a):e[r]=a);return e}function $a(t,e){for(;t!==null;){const a=xm(t,e);if(a){if(a.get)return Vt(a.get);if(typeof a.value=="function")return Vt(a.value)}t=km(t)}function r(){return null}return r}const ic=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xi=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qi=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Rm=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Zi=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Pm=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),oc=Yt(["#text"]),lc=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ji=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),cc=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ws=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Om=Tn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Dm=Tn(/<%[\w\W]*|[\w\W]*%>/gm),Mm=Tn(/\$\{[\w\W]*/gm),jm=Tn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Lm=Tn(/^aria-[\-\w]+$/),Ju=Tn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Nm=Tn(/^(?:\w+script|data):/i),qm=Tn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$u=Tn(/^html$/i),Bm=Tn(/^[a-z][.\w]*(-[.\w]+)+$/i);var uc=Object.freeze({__proto__:null,ARIA_ATTR:Lm,ATTR_WHITESPACE:qm,CUSTOM_ELEMENT:Bm,DATA_ATTR:jm,DOCTYPE_NAME:$u,ERB_EXPR:Dm,IS_ALLOWED_URI:Ju,IS_SCRIPT_OR_DATA:Nm,MUSTACHE_EXPR:Om,TMPLIT_EXPR:Mm});const es={element:1,text:3,progressingInstruction:7,comment:8,document:9},zm=function(){return typeof window>"u"?null:window},Fm=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},fc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ef(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zm();const e=Ne=>ef(Ne);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==es.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:v,NodeFilter:p,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:k,trustedTypes:w}=t,O=v.prototype,L=$a(O,"cloneNode"),T=$a(O,"remove"),K=$a(O,"nextSibling"),oe=$a(O,"childNodes"),$=$a(O,"parentNode");if(typeof u=="function"){const Ne=r.createElement("template");Ne.content&&Ne.content.ownerDocument&&(r=Ne.content.ownerDocument)}let Y,Z="";const{implementation:J,createNodeIterator:U,createDocumentFragment:ce,getElementsByTagName:ye}=r,{importNode:Te}=a;let ge=fc();e.isSupported=typeof Zu=="function"&&typeof $=="function"&&J&&J.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ae,ERB_EXPR:ue,TMPLIT_EXPR:Re,DATA_ATTR:re,ARIA_ATTR:le,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:ie}=uc;let{IS_ALLOWED_URI:ve}=uc,be=null;const V=He({},[...ic,...Xi,...Qi,...Zi,...oc]);let te=null;const W=He({},[...lc,...Ji,...cc,...Ws]);let ne=Object.seal(_o(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Le=null,Fe=null;const rt=Object.seal(_o(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let St=!0,B=!0,Ae=!1,De=!0,Be=!1,Tt=!0,ht=!1,fn=!1,Jn=!1,dn=!1,Gt=!1,wt=!1,mt=!0,pn=!1;const hn="user-content-";let zn=!0,En=!1,kt={},Et=null;const Mr=He({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let vr=null;const pa=He({},["audio","video","img","source","image","track"]);let mr=null;const Fn=He({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$n="http://www.w3.org/1998/Math/MathML",gr="http://www.w3.org/2000/svg",At="http://www.w3.org/1999/xhtml";let je=At,er=!1,An=null;const ha=He({},[$n,gr,At],Yi);let Ee=He({},["mi","mo","mn","ms","mtext"]),yr=He({},["annotation-xml"]);const ws=He({},["title","style","font","a","script"]);let tr=null;const ks=["application/xhtml+xml","text/html"],ja="text/html";let gt=null,_r=null;const br=r.createElement("form"),nr=function(A){return A instanceof RegExp||A instanceof Function},jr=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(_r&&_r===A)){if((!A||typeof A!="object")&&(A={}),A=Hn(A),tr=ks.indexOf(A.PARSER_MEDIA_TYPE)===-1?ja:A.PARSER_MEDIA_TYPE,gt=tr==="application/xhtml+xml"?Yi:$s,be=On(A,"ALLOWED_TAGS")?He({},A.ALLOWED_TAGS,gt):V,te=On(A,"ALLOWED_ATTR")?He({},A.ALLOWED_ATTR,gt):W,An=On(A,"ALLOWED_NAMESPACES")?He({},A.ALLOWED_NAMESPACES,Yi):ha,mr=On(A,"ADD_URI_SAFE_ATTR")?He(Hn(Fn),A.ADD_URI_SAFE_ATTR,gt):Fn,vr=On(A,"ADD_DATA_URI_TAGS")?He(Hn(pa),A.ADD_DATA_URI_TAGS,gt):pa,Et=On(A,"FORBID_CONTENTS")?He({},A.FORBID_CONTENTS,gt):Mr,Le=On(A,"FORBID_TAGS")?He({},A.FORBID_TAGS,gt):Hn({}),Fe=On(A,"FORBID_ATTR")?He({},A.FORBID_ATTR,gt):Hn({}),kt=On(A,"USE_PROFILES")?A.USE_PROFILES:!1,St=A.ALLOW_ARIA_ATTR!==!1,B=A.ALLOW_DATA_ATTR!==!1,Ae=A.ALLOW_UNKNOWN_PROTOCOLS||!1,De=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Be=A.SAFE_FOR_TEMPLATES||!1,Tt=A.SAFE_FOR_XML!==!1,ht=A.WHOLE_DOCUMENT||!1,dn=A.RETURN_DOM||!1,Gt=A.RETURN_DOM_FRAGMENT||!1,wt=A.RETURN_TRUSTED_TYPE||!1,Jn=A.FORCE_BODY||!1,mt=A.SANITIZE_DOM!==!1,pn=A.SANITIZE_NAMED_PROPS||!1,zn=A.KEEP_CONTENT!==!1,En=A.IN_PLACE||!1,ve=A.ALLOWED_URI_REGEXP||Ju,je=A.NAMESPACE||At,Ee=A.MATHML_TEXT_INTEGRATION_POINTS||Ee,yr=A.HTML_INTEGRATION_POINTS||yr,ne=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&nr(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ne.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&nr(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ne.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ne.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(B=!1),Gt&&(dn=!0),kt&&(be=He({},oc),te=[],kt.html===!0&&(He(be,ic),He(te,lc)),kt.svg===!0&&(He(be,Xi),He(te,Ji),He(te,Ws)),kt.svgFilters===!0&&(He(be,Qi),He(te,Ji),He(te,Ws)),kt.mathMl===!0&&(He(be,Zi),He(te,cc),He(te,Ws))),A.ADD_TAGS&&(typeof A.ADD_TAGS=="function"?rt.tagCheck=A.ADD_TAGS:(be===V&&(be=Hn(be)),He(be,A.ADD_TAGS,gt))),A.ADD_ATTR&&(typeof A.ADD_ATTR=="function"?rt.attributeCheck=A.ADD_ATTR:(te===W&&(te=Hn(te)),He(te,A.ADD_ATTR,gt))),A.ADD_URI_SAFE_ATTR&&He(mr,A.ADD_URI_SAFE_ATTR,gt),A.FORBID_CONTENTS&&(Et===Mr&&(Et=Hn(Et)),He(Et,A.FORBID_CONTENTS,gt)),A.ADD_FORBID_CONTENTS&&(Et===Mr&&(Et=Hn(Et)),He(Et,A.ADD_FORBID_CONTENTS,gt)),zn&&(be["#text"]=!0),ht&&He(be,["html","head","body"]),be.table&&(He(be,["tbody"]),delete Le.tbody),A.TRUSTED_TYPES_POLICY){if(typeof A.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof A.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Y=A.TRUSTED_TYPES_POLICY,Z=Y.createHTML("")}else Y===void 0&&(Y=Fm(w,i)),Y!==null&&typeof Z=="string"&&(Z=Y.createHTML(""));Yt&&Yt(A),_r=A}},Lr=He({},[...Xi,...Qi,...Rm]),st=He({},[...Zi,...Pm]),xt=function(A){let me=$(A);(!me||!me.tagName)&&(me={namespaceURI:je,tagName:"template"});const ke=$s(A.tagName),Je=$s(me.tagName);return An[A.namespaceURI]?A.namespaceURI===gr?me.namespaceURI===At?ke==="svg":me.namespaceURI===$n?ke==="svg"&&(Je==="annotation-xml"||Ee[Je]):!!Lr[ke]:A.namespaceURI===$n?me.namespaceURI===At?ke==="math":me.namespaceURI===gr?ke==="math"&&yr[Je]:!!st[ke]:A.namespaceURI===At?me.namespaceURI===gr&&!yr[Je]||me.namespaceURI===$n&&!Ee[Je]?!1:!st[ke]&&(ws[ke]||!Lr[ke]):!!(tr==="application/xhtml+xml"&&An[A.namespaceURI]):!1},vn=function(A){Qa(e.removed,{element:A});try{$(A).removeChild(A)}catch{T(A)}},mn=function(A,me){try{Qa(e.removed,{attribute:me.getAttributeNode(A),from:me})}catch{Qa(e.removed,{attribute:null,from:me})}if(me.removeAttribute(A),A==="is")if(dn||Gt)try{vn(me)}catch{}else try{me.setAttribute(A,"")}catch{}},Nr=function(A){let me=null,ke=null;if(Jn)A="<remove></remove>"+A;else{const dt=Vi(A,/^[\r\n\t ]+/);ke=dt&&dt[0]}tr==="application/xhtml+xml"&&je===At&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");const Je=Y?Y.createHTML(A):A;if(je===At)try{me=new k().parseFromString(Je,tr)}catch{}if(!me||!me.documentElement){me=J.createDocument(je,"template",null);try{me.documentElement.innerHTML=er?Z:Je}catch{}}const it=me.body||me.documentElement;return A&&ke&&it.insertBefore(r.createTextNode(ke),it.childNodes[0]||null),je===At?ye.call(me,ht?"html":"body")[0]:ht?me.documentElement:it},qr=function(A){return U.call(A.ownerDocument||A,A,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},La=function(A){return A instanceof x&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof y)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},Cn=function(A){return typeof d=="function"&&A instanceof d};function zt(Ne,A,me){Hs(Ne,ke=>{ke.call(e,A,me,_r)})}const In=function(A){let me=null;if(zt(ge.beforeSanitizeElements,A,null),La(A))return vn(A),!0;const ke=gt(A.nodeName);if(zt(ge.uponSanitizeElement,A,{tagName:ke,allowedTags:be}),Tt&&A.hasChildNodes()&&!Cn(A.firstElementChild)&&Ht(/<[/\w!]/g,A.innerHTML)&&Ht(/<[/\w!]/g,A.textContent)||A.nodeType===es.progressingInstruction||Tt&&A.nodeType===es.comment&&Ht(/<[/\w]/g,A.data))return vn(A),!0;if(!(rt.tagCheck instanceof Function&&rt.tagCheck(ke))&&(!be[ke]||Le[ke])){if(!Le[ke]&&xs(ke)&&(ne.tagNameCheck instanceof RegExp&&Ht(ne.tagNameCheck,ke)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(ke)))return!1;if(zn&&!Et[ke]){const Je=$(A)||A.parentNode,it=oe(A)||A.childNodes;if(it&&Je){const dt=it.length;for(let yt=dt-1;yt>=0;--yt){const Xt=L(it[yt],!0);Xt.__removalCount=(A.__removalCount||0)+1,Je.insertBefore(Xt,K(A))}}}return vn(A),!0}return A instanceof v&&!xt(A)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&Ht(/<\/no(script|embed|frames)/i,A.innerHTML)?(vn(A),!0):(Be&&A.nodeType===es.text&&(me=A.textContent,Hs([ae,ue,Re],Je=>{me=Za(me,Je," ")}),A.textContent!==me&&(Qa(e.removed,{element:A.cloneNode()}),A.textContent=me)),zt(ge.afterSanitizeElements,A,null),!1)},Br=function(A,me,ke){if(mt&&(me==="id"||me==="name")&&(ke in r||ke in br))return!1;if(!(B&&!Fe[me]&&Ht(re,me))){if(!(St&&Ht(le,me))){if(!(rt.attributeCheck instanceof Function&&rt.attributeCheck(me,A))){if(!te[me]||Fe[me]){if(!(xs(A)&&(ne.tagNameCheck instanceof RegExp&&Ht(ne.tagNameCheck,A)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(A))&&(ne.attributeNameCheck instanceof RegExp&&Ht(ne.attributeNameCheck,me)||ne.attributeNameCheck instanceof Function&&ne.attributeNameCheck(me,A))||me==="is"&&ne.allowCustomizedBuiltInElements&&(ne.tagNameCheck instanceof RegExp&&Ht(ne.tagNameCheck,ke)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(ke))))return!1}else if(!mr[me]){if(!Ht(ve,Za(ke,Q,""))){if(!((me==="src"||me==="xlink:href"||me==="href")&&A!=="script"&&Em(ke,"data:")===0&&vr[A])){if(!(Ae&&!Ht(de,Za(ke,Q,"")))){if(ke)return!1}}}}}}}return!0},xs=function(A){return A!=="annotation-xml"&&Vi(A,ie)},Rn=function(A){zt(ge.beforeSanitizeAttributes,A,null);const{attributes:me}=A;if(!me||La(A))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let Je=me.length;for(;Je--;){const it=me[Je],{name:dt,namespaceURI:yt,value:Xt}=it,Kn=gt(dt),zr=Xt;let lt=dt==="value"?zr:Am(zr);if(ke.attrName=Kn,ke.attrValue=lt,ke.keepAttr=!0,ke.forceKeepAttr=void 0,zt(ge.uponSanitizeAttribute,A,ke),lt=ke.attrValue,pn&&(Kn==="id"||Kn==="name")&&(mn(dt,A),lt=hn+lt),Tt&&Ht(/((--!?|])>)|<\/(style|title|textarea)/i,lt)){mn(dt,A);continue}if(Kn==="attributename"&&Vi(lt,"href")){mn(dt,A);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){mn(dt,A);continue}if(!De&&Ht(/\/>/i,lt)){mn(dt,A);continue}Be&&Hs([ae,ue,Re],Fr=>{lt=Za(lt,Fr," ")});const Na=gt(A.nodeName);if(!Br(Na,Kn,lt)){mn(dt,A);continue}if(Y&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!yt)switch(w.getAttributeType(Na,Kn)){case"TrustedHTML":{lt=Y.createHTML(lt);break}case"TrustedScriptURL":{lt=Y.createScriptURL(lt);break}}if(lt!==zr)try{yt?A.setAttributeNS(yt,dt,lt):A.setAttribute(dt,lt),La(A)?vn(A):sc(e.removed)}catch{mn(dt,A)}}zt(ge.afterSanitizeAttributes,A,null)},Ss=function Ne(A){let me=null;const ke=qr(A);for(zt(ge.beforeSanitizeShadowDOM,A,null);me=ke.nextNode();)zt(ge.uponSanitizeShadowNode,me,null),In(me),Rn(me),me.content instanceof o&&Ne(me.content);zt(ge.afterSanitizeShadowDOM,A,null)};return e.sanitize=function(Ne){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},me=null,ke=null,Je=null,it=null;if(er=!Ne,er&&(Ne="<!-->"),typeof Ne!="string"&&!Cn(Ne))if(typeof Ne.toString=="function"){if(Ne=Ne.toString(),typeof Ne!="string")throw Ja("dirty is not a string, aborting")}else throw Ja("toString is not a function");if(!e.isSupported)return Ne;if(fn||jr(A),e.removed=[],typeof Ne=="string"&&(En=!1),En){if(Ne.nodeName){const Xt=gt(Ne.nodeName);if(!be[Xt]||Le[Xt])throw Ja("root node is forbidden and cannot be sanitized in-place")}}else if(Ne instanceof d)me=Nr("<!---->"),ke=me.ownerDocument.importNode(Ne,!0),ke.nodeType===es.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?me=ke:me.appendChild(ke);else{if(!dn&&!Be&&!ht&&Ne.indexOf("<")===-1)return Y&&wt?Y.createHTML(Ne):Ne;if(me=Nr(Ne),!me)return dn?null:wt?Z:""}me&&Jn&&vn(me.firstChild);const dt=qr(En?Ne:me);for(;Je=dt.nextNode();)In(Je),Rn(Je),Je.content instanceof o&&Ss(Je.content);if(En)return Ne;if(dn){if(Gt)for(it=ce.call(me.ownerDocument);me.firstChild;)it.appendChild(me.firstChild);else it=me;return(te.shadowroot||te.shadowrootmode)&&(it=Te.call(a,it,!0)),it}let yt=ht?me.outerHTML:me.innerHTML;return ht&&be["!doctype"]&&me.ownerDocument&&me.ownerDocument.doctype&&me.ownerDocument.doctype.name&&Ht($u,me.ownerDocument.doctype.name)&&(yt="<!DOCTYPE "+me.ownerDocument.doctype.name+`>
`+yt),Be&&Hs([ae,ue,Re],Xt=>{yt=Za(yt,Xt," ")}),Y&&wt?Y.createHTML(yt):yt},e.setConfig=function(){let Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jr(Ne),fn=!0},e.clearConfig=function(){_r=null,fn=!1},e.isValidAttribute=function(Ne,A,me){_r||jr({});const ke=gt(Ne),Je=gt(A);return Br(ke,Je,me)},e.addHook=function(Ne,A){typeof A=="function"&&Qa(ge[Ne],A)},e.removeHook=function(Ne,A){if(A!==void 0){const me=Sm(ge[Ne],A);return me===-1?void 0:Tm(ge[Ne],me,1)[0]}return sc(ge[Ne])},e.removeHooks=function(Ne){ge[Ne]=[]},e.removeAllHooks=function(){ge=fc()},e}var Km=ef();function Um(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${dc(t.from)} |`),e.push(`| **To** | ${dc(t.to)} |`),e.push(`| **Date** | ${Bo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Gm(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function dc(t){return(t||"").replace(/\|/g,"\\|")}function Gm(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return ko(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Hm(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function ko(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Hm(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(ko).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>ko(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Wm(t){return xu(t,"md")}function pc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Ym(t){return t.raw||null}function Vm(t){const e=Ym(t);return e?JSON.stringify(e,null,2):"null"}function Xm(t){return xu(t,"json")}var Qm=H('<button title="View as Markdown">.md</button>'),Zm=H('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Jm=H('<pre class="md-raw svelte-1b0rzpb"> </pre>'),$m=H('<div class="md-preview svelte-1b0rzpb"><!></div>'),eg=H('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),tg=H('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),ng=H('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),rg=H('<pre class="message-text svelte-1b0rzpb"> </pre>'),ag=H('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),sg=H('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),ig=H('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function og(t,e){ct(e,!0);let r=Ie(e,"loading",3,!1);Bt(()=>un("MessageModal"));const a=new tt.Renderer;a.link=({href:ae,title:ue,text:Re})=>{const re=ue?` title="${ue}"`:"";return`<a href="${ae}"${re} target="_blank" rel="noopener">${Re}</a>`},tt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Pe("email"),o=ft(()=>e.message.body?Um(e.message):""),u=ft(()=>Vm(e.message)),d=Pe("raw");function v(ae){j(i,g(i)===ae?"email":ae,!0),ae==="markdown"&&j(d,"raw")}function p(){pc(g(o),Wm(e.message))}function y(){pc(g(u),Xm(e.message),"application/json;charset=utf-8")}function x(ae){const ue=tt.parse(ae);return Km.sanitize(ue,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let k=Pe(null);ti(()=>{var ae;if(g(k)&&e.message.htmlBody&&!r()&&g(i)==="email"){const ue=g(k).contentDocument||((ae=g(k).contentWindow)==null?void 0:ae.document);ue&&(ue.open(),ue.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ue.close())}});var w=ig();w.__click=function(...ae){var ue;(ue=e.onclose)==null||ue.apply(this,ae)};var O=b(w);O.__click=ae=>ae.stopPropagation();var L=b(O),T=b(L),K=b(T),oe=S(T,2),$=b(oe);let Y;$.__click=()=>v("json");var Z=S($,2);{var J=ae=>{var ue=Qm();let Re;ue.__click=()=>v("markdown"),fe(()=>Re=jt(ue,1,"action-btn svelte-1b0rzpb",null,Re,{active:g(i)==="markdown"})),F(ae,ue)};_e(Z,ae=>{e.message.body&&ae(J)})}var U=S(Z,2);U.__click=function(...ae){var ue;(ue=e.onclose)==null||ue.apply(this,ae)};var ce=S(L,2);{var ye=ae=>{var ue=Zm(),Re=at(ue),re=S(b(Re),2);re.__click=y;var le=S(Re,2),de=b(le),Q=b(de);fe(()=>se(Q,g(u))),F(ae,ue)},Te=ae=>{var ue=eg(),Re=at(ue),re=b(Re),le=b(re);let de;le.__click=()=>j(d,"raw");var Q=S(le,2);let ie;Q.__click=()=>j(d,"preview");var ve=S(re,2);ve.__click=p;var be=S(Re,2),V=b(be);{var te=ne=>{var Le=Jm(),Fe=b(Le);fe(()=>se(Fe,g(o))),F(ne,Le)},W=ne=>{var Le=$m(),Fe=b(Le);Wd(Fe,()=>x(g(o))),F(ne,Le)};_e(V,ne=>{g(d)==="raw"?ne(te):ne(W,!1)})}fe(()=>{de=jt(le,1,"md-tab svelte-1b0rzpb",null,de,{active:g(d)==="raw"}),ie=jt(Q,1,"md-tab svelte-1b0rzpb",null,ie,{active:g(d)==="preview"})}),F(ae,ue)},ge=ae=>{var ue=sg(),Re=at(ue),re=b(Re),le=S(b(re),2),de=b(le),Q=S(re,2),ie=S(b(Q),2),ve=b(ie),be=S(Q,2),V=S(b(be),2),te=b(V),W=S(Re,2),ne=b(W);{var Le=B=>{var Ae=tg();F(B,Ae)},Fe=B=>{var Ae=ng();hu(Ae,De=>j(k,De),()=>g(k)),F(B,Ae)},rt=B=>{var Ae=rg(),De=b(Ae);fe(()=>se(De,e.message.body)),F(B,Ae)},St=B=>{var Ae=ag();F(B,Ae)};_e(ne,B=>{r()?B(Le):e.message.htmlBody?B(Fe,1):e.message.body?B(rt,2):B(St,!1)})}fe(B=>{se(de,e.message.from),se(ve,e.message.to),se(te,B)},[()=>Bo(e.message.date)]),F(ae,ue)};_e(ce,ae=>{g(i)==="json"?ae(ye):g(i)==="markdown"?ae(Te,1):ae(ge,!1)})}fe(()=>{se(K,e.message.subject),Y=jt($,1,"action-btn svelte-1b0rzpb",null,Y,{active:g(i)==="json"})}),F(t,w),ut()}Pt(["click"]);var lg=H('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),cg=H('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),ug=H('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),fg=H("<p> </p>"),dg=H('<p>No emails in local storage. Click "Sync New" to download.</p>'),pg=H('<div class="empty-state svelte-6ts5xm"><!></div>'),hg=H('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),vg=H('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function mg(t,e){ct(e,!0),Bt(()=>un("DashboardView"));let r=Ie(e,"error",3,null),a=Ie(e,"profile",3,null),i=Ie(e,"loadingProfile",3,!1),o=Ie(e,"emailMessages",19,()=>[]),u=Ie(e,"totalLocalMessages",3,0),d=Ie(e,"hasMoreLocal",3,!1),v=Ie(e,"loadingMessages",3,!1),p=Ie(e,"selectedMessage",3,null),y=Ie(e,"syncStatus",3,null),x=Ie(e,"syncProgress",3,null),k=Ie(e,"isSyncing",3,!1),w=Ie(e,"searchQuery",15);var O=vg(),L=at(O),T=b(L);{var K=re=>{qu(re,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};_e(T,re=>{r()&&re(K)})}var oe=S(T,2);vv(oe,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var $=S(oe,2);Cv($,{get syncStatus(){return y()},get syncProgress(){return x()},get isSyncing(){return k()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var Y=S($,2),Z=b(Y);Z.__keydown=re=>re.key==="Enter"&&e.onsearch();var J=S(Z,2);J.__click=function(...re){var le;(le=e.onsearch)==null||le.apply(this,re)};var U=b(J),ce=S(Y,2);{var ye=re=>{var le=cg(),de=at(le),Q=b(de),ie=b(Q),ve=S(de,2);Pv(ve,{get messages(){return o()},get onselect(){return e.onviewmessage}});var be=S(ve,2);{var V=te=>{var W=lg(),ne=b(W);ne.__click=function(...Fe){var rt;(rt=e.onloadmore)==null||rt.apply(this,Fe)};var Le=b(ne);fe(()=>{ne.disabled=v(),se(Le,v()?"Loading...":"Load More")}),F(te,W)};_e(be,te=>{d()&&te(V)})}fe(te=>se(ie,`Showing ${o().length??""} of ${te??""}
        ${w()?" matching":""} emails`),[()=>u().toLocaleString()]),F(re,le)},Te=re=>{var le=ug();F(re,le)},ge=re=>{var le=pg(),de=b(le);{var Q=ve=>{var be=fg(),V=b(be);fe(()=>se(V,`No emails match "${w()??""}".`)),F(ve,be)},ie=ve=>{var be=dg();F(ve,be)};_e(de,ve=>{w()?ve(Q):ve(ie,!1)})}F(re,le)},ae=re=>{var le=hg();F(re,le)};_e(ce,re=>{var le;o().length>0?re(ye):v()?re(Te,1):(le=y())!=null&&le.synced?re(ge,2):re(ae,!1)})}var ue=S(L,2);{var Re=re=>{og(re,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};_e(ue,re=>{p()&&re(Re)})}fe(()=>{J.disabled=v(),se(U,v()?"Searching...":"Search")}),No(Z,w),F(t,O),ut()}Pt(["keydown","click"]);var gg=H('<div class="dashboard svelte-1q5o2lv"><!></div>');function yg(t,e){ct(e,!0);function r(B){B.key==="Escape"&&g(x)&&ve()}let a=null;Bt(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const B=Kh();if(B<=0)return;const Ae=Math.max(0,B-120*1e3);a=setTimeout(async()=>{try{const De=await Xl();j(p,De.access_token,!0),i()}catch{j(p,null),j(y,null),j($,"Session expired. Please sign in again.")}},Ae)}async function o(){if(Fh())return g(p);try{const B=await Xl();return j(p,B.access_token,!0),i(),g(p)}catch{return j(p,null),j(y,null),j($,"Session expired. Please sign in again."),null}}let u=Pe(Mt(localStorage.getItem("googleClientId")||"")),d=Pe(Mt(localStorage.getItem("googleClientId")||"")),v=Pe(!1),p=Pe(null),y=Pe(null),x=Pe(null),k=Pe(""),w=Pe(Mt([])),O=Pe(0),L=Pe(0),T=Pe(!1),K=Pe(!1),oe=Pe(!1),$=Pe(null),Y=Pe(null),Z=Pe(null),J=Pe(!1);const U=50;ti(()=>{g(p)&&(be(),le())});let ce=ft(()=>!g(u)),ye=ft(()=>!!g(p)),Te=ft(()=>g(w).length<g(O));ti(()=>{g(u)&&!g(v)&&Ql(g(u)).then(()=>{if(j(v,!0),!g(p)){const B=zh();B&&(j(p,B.access_token,!0),i(),re())}}).catch(B=>{j($,`Auth init failed: ${B.message}`)})});function ge(){const B=g(d).trim();B&&(localStorage.setItem("googleClientId",B),j(u,B,!0),j($,null))}function ae(){localStorage.removeItem("googleClientId"),j(u,""),j(d,""),j(v,!1),j(p,null),j(y,null),j(w,[],!0),j(O,0)}async function ue(){j($,null),j(K,!0);try{g(v)||(await Ql(g(u)),j(v,!0));const B=await Gh();j(p,B.access_token,!0),i(),await re()}catch(B){j($,B.message,!0)}finally{j(K,!1)}}async function Re(){if(a&&clearTimeout(a),g(p))try{await Hh(g(p))}catch{}j(p,null),j(y,null),j(w,[],!0),j(O,0),j(x,null),j($,null)}async function re(){j(oe,!0);try{const B=await yu(g(p));if(!g(p))return;j(y,B,!0)}catch(B){if(!g(p))return;j($,`Profile fetch failed: ${B.message}`)}finally{j(oe,!1)}}async function le(B=!1){j(T,!0);try{const Ae=B?g(L):0,De=await wp({query:g(k)||void 0,limit:U,offset:Ae});B?j(w,[...g(w),...De.items],!0):j(w,De.items,!0),j(O,De.total,!0),j(L,g(w).length,!0)}catch(Ae){j($,`Failed to load messages: ${Ae.message}`)}finally{j(T,!1)}}function de(){j(L,0),le(!1)}function Q(){le(!0)}function ie(B){j(x,B,!0)}function ve(){j(x,null)}async function be(){try{j(Y,await Vh(),!0)}catch{}}async function V(B){if(g(J)||!g(p))return;const Ae=await o();if(!Ae)return;j($,null),j(J,!0),j(Z,null);const De=new AbortController;try{await Wh(Ae,{limit:B,onProgress:Be=>{j(Z,{...Be},!0)},signal:De.signal}),await be(),await le(!1)}catch(Be){if(Be.name!=="AbortError"){if(!g(p))return;j($,`Sync failed: ${Be.message}`)}}finally{j(J,!1)}}async function te(B){if(g(J)||!g(p))return;const Ae=await o();if(!Ae)return;j($,null),j(J,!0),j(Z,null);const De=new AbortController;try{await Yh(Ae,{limit:B,onProgress:Be=>{j(Z,{...Be},!0)},signal:De.signal}),await be(),await le(!1)}catch(Be){if(Be.name!=="AbortError"){if(!g(p))return;j($,`Sync more failed: ${Be.message}`)}}finally{j(J,!1)}}async function W(){try{await Mu(),await be(),j(w,[],!0),j(O,0),j(L,0)}catch(B){j($,`Failed to clear data: ${B.message}`)}}var ne=gg(),Le=b(ne);{var Fe=B=>{ev(B,{onsave:ge,get clientIdInput(){return g(d)},set clientIdInput(Ae){j(d,Ae,!0)}})},rt=B=>{fv(B,{get clientId(){return g(u)},get error(){return g($)},get loadingAuth(){return g(K)},onsignin:ue,onclear:ae,onsignout:Re})},St=B=>{mg(B,{get error(){return g($)},get profile(){return g(y)},get loadingProfile(){return g(oe)},get emailMessages(){return g(w)},get totalLocalMessages(){return g(O)},get hasMoreLocal(){return g(Te)},get loadingMessages(){return g(T)},get selectedMessage(){return g(x)},get syncStatus(){return g(Y)},get syncProgress(){return g(Z)},get isSyncing(){return g(J)},onsignout:Re,onsearch:de,onloadmore:Q,onviewmessage:ie,onclosedetail:ve,ondismisserror:()=>j($,null),onsync:V,onsyncmore:te,oncleardata:W,get searchQuery(){return g(k)},set searchQuery(Ae){j(k,Ae,!0)}})};_e(Le,B=>{g(ce)?B(Fe):g(ye)?B(St,!1):B(rt,1)})}F(t,ne),ut()}var _g=H('<span class="spinner svelte-ois7em"></span>'),bg=jo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),wg=H('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),kg=H('<option class="svelte-ois7em"> </option>'),xg=H('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),Sg=H('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),Tg=H('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="12" cy="12" r="10" class="svelte-ois7em"></circle><path d="M12 16v-4" class="svelte-ois7em"></path><path d="M12 8h.01" class="svelte-ois7em"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function Eg(t,e){ct(e,!0);let r=Ie(e,"engineStatus",3,"idle"),a=Ie(e,"modelName",3,""),i=Ie(e,"isScanning",3,!1),o=Ie(e,"scanProgress",3,null),u=Ie(e,"scanCount",15,20),d=Ie(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var k=Tg(),w=b(k),O=b(w),L=b(O);{var T=V=>{var te=_g();F(V,te)},K=V=>{var te=bg();F(V,te)};_e(L,V=>{i()?V(T):V(K,!1)})}var oe=S(O,2),$=b(oe),Y=S(b($),2);Y.__click=function(...V){var te;(te=e.oninspect)==null||te.apply(this,V)};var Z=S($,2),J=b(Z);let U;var ce=S(J),ye=S(w,2);{var Te=V=>{var te=wg(),W=b(te),ne=b(W),Le=S(W,4),Fe=b(Le),rt=S(Le,4),St=b(rt);fe(()=>{se(ne,`${d().totalEmails??""} emails in storage`),se(Fe,`${d().classified??""} classified`),se(St,`${d().unclassified??""} new`)}),F(V,te)};_e(ye,V=>{d()&&V(Te)})}var ge=S(ye,2),ae=b(ge),ue=S(b(ae),2);nn(ue,21,()=>v,hr,(V,te)=>{var W=kg(),ne=b(W),Le={};fe(()=>{se(ne,g(te).label),Le!==(Le=g(te).value)&&(W.value=(W.__value=g(te).value)??"")}),F(V,W)});var Re=S(ae,2),re=b(Re);re.__click=function(...V){var te;(te=e.onscan)==null||te.apply(this,V)};var le=b(re),de=S(re,2);de.__click=function(...V){var te;(te=e.onrescan)==null||te.apply(this,V)};var Q=S(ge,2);{var ie=V=>{var te=xg();F(V,te)};_e(Q,V=>{r()!=="ready"&&r()!=="loading"&&V(ie)})}var ve=S(Q,2);{var be=V=>{var te=Sg(),W=b(te),ne=b(W);let Le,Fe;var rt=S(W,2),St=b(rt);fe(()=>{Le=jt(ne,1,"progress-fill svelte-ois7em",null,Le,{indeterminate:!o().total}),Fe=tn(ne,"",Fe,{width:`${o().total?o().current/o().total*100:0}%`}),se(St,o().message||"Scanning...")}),F(V,te)};_e(ve,V=>{i()&&o()&&V(be)})}fe((V,te,W,ne)=>{U=tn(J,"",U,V),se(ce,` ${te??""}`),ue.disabled=i(),re.disabled=W,se(le,i()?"Scanning...":"Scan New"),de.disabled=ne},[()=>({background:y()}),p,()=>!x(),()=>!x()]),Lo(ue,u),F(t,k),ut()}Pt(["click"]);var Ag=H('<span class="row-date svelte-1czytqk"> </span>'),Cg=H('<span class="tag svelte-1czytqk"> </span>'),Ig=H('<span class="row-tags svelte-1czytqk"></span>'),Rg=H('<span class="row-reason svelte-1czytqk"> </span>'),Pg=H('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),Og=H('<span class="status-label svelte-1czytqk"> </span>'),Dg=H('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Mg=H('<p class="summary-reason svelte-1czytqk"> </p>'),jg=H('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Lg=H('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function hc(t,e){ct(e,!0);let r=Ie(e,"actionColor",3,"#666"),a=Ie(e,"dimmed",3,!1);function i(re){if(!re)return"";try{return new Date(re).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=ft(()=>e.item.status==="pending"),u=Pe(!1);var d=Lg(),v=at(d);let p;var y=b(v);y.__click=()=>j(u,!g(u));let x;var k=b(y),w=b(k),O=S(k,2),L=b(O),T=b(L),K=S(L,2);{var oe=re=>{var le=Ag(),de=b(le);fe(Q=>se(de,Q),[()=>i(e.item.date)]),F(re,le)};_e(K,re=>{e.item.date&&re(oe)})}var $=S(O,2);{var Y=re=>{var le=Ig();nn(le,21,()=>e.item.tags,hr,(de,Q)=>{var ie=Cg();let ve;var be=b(ie);fe(V=>{ve=tn(ie,"",ve,V),se(be,g(Q))},[()=>({background:Rp(g(Q))})]),F(de,ie)}),F(re,le)};_e($,re=>{e.item.tags&&e.item.tags.length>0&&re(Y)})}var Z=S($,2);{var J=re=>{var le=Rg(),de=b(le);fe(()=>se(de,e.item.reason)),F(re,le)};_e(Z,re=>{e.item.reason&&!g(u)&&re(J)})}var U=S(y,2),ce=b(U);{var ye=re=>{var le=Pg(),de=at(le);de.__click=()=>e.onmarkacted(e.item.emailId);var Q=S(de,2);Q.__click=()=>e.ondismiss(e.item.emailId),F(re,le)},Te=re=>{var le=Og(),de=b(le);fe(()=>se(de,e.item.status)),F(re,le)};_e(ce,re=>{g(o)?re(ye):re(Te,!1)})}var ge=S(ce,2);{var ae=re=>{var le=Dg();le.__click=()=>e.onremove(e.item.emailId),F(re,le)};_e(ge,re=>{e.onremove&&re(ae)})}var ue=S(v,2);{var Re=re=>{var le=jg();let de;var Q=b(le),ie=b(Q),ve=S(Q,2);{var be=V=>{var te=Mg(),W=b(te);fe(()=>se(W,e.item.reason)),F(V,te)};_e(ve,V=>{e.item.reason&&V(be)})}fe(()=>{de=tn(le,"",de,{"border-left-color":r()}),se(ie,e.item.summary)}),F(re,le)};_e(ue,re=>{g(u)&&e.item.summary&&re(Re)})}fe(()=>{p=jt(v,1,"email-row svelte-1czytqk",null,p,{dimmed:a()}),x=tn(y,"",x,{"border-left-color":r()}),se(w,e.item.subject),se(T,e.item.from)}),F(t,d),ut()}Pt(["click"]);var Ng=H('<span class="group-acted svelte-tl1unp"> </span>'),qg=H('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Bg=H('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),zg=H('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Fg=H('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Kg=H('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Ug=H('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Gg(t,e){ct(e,!0);let r=Ie(e,"color",3,"#888");Ie(e,"count",3,0);let a=Ie(e,"items",19,()=>[]),i=Ie(e,"expanded",3,!1),o=ft(()=>a().filter(J=>J.status==="pending")),u=ft(()=>a().filter(J=>J.status!=="pending")),d=Pe(!1);function v(J){return J.split("_").map(U=>U.charAt(0)+U.slice(1).toLowerCase()).join(" ")}var p=Ug(),y=b(p);y.__click=function(...J){var U;(U=e.ontoggle)==null||U.apply(this,J)};var x=b(y);let k;var w=b(x),O=S(x,2),L=b(O),T=S(O,2);{var K=J=>{var U=Ng(),ce=b(U);fe(()=>se(ce,`${g(u).length??""} handled`)),F(J,U)};_e(T,J=>{g(u).length>0&&J(K)})}var oe=S(T,4);let $;var Y=S(y,2);{var Z=J=>{var U=Kg(),ce=b(U);{var ye=de=>{var Q=qg();F(de,Q)};_e(ce,de=>{g(o).length===0&&g(u).length===0&&de(ye)})}var Te=S(ce,2);nn(Te,17,()=>g(o),de=>de.emailId,(de,Q)=>{hc(de,{get item(){return g(Q)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ge=S(Te,2);{var ae=de=>{var Q=Bg(),ie=b(Q),ve=b(ie),be=S(ie,2);nn(be,17,()=>g(u),V=>V.emailId,(V,te)=>{hc(V,{get item(){return g(te)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),fe(()=>se(ve,`${g(u).length??""} handled`)),F(de,Q)};_e(ge,de=>{g(u).length>0&&de(ae)})}var ue=S(ge,2),Re=b(ue);{var re=de=>{var Q=zg();Q.__click=()=>j(d,!0),F(de,Q)},le=de=>{var Q=Fg(),ie=b(Q),ve=S(ie);ve.__click=()=>j(d,!1);var be=S(ve,2);be.__click=()=>{e.oncleargroup(),j(d,!1)},fe(()=>se(ie,`Clear ${a().length??""} items? `)),F(de,Q)};_e(Re,de=>{g(d)?de(le,!1):de(re)})}F(J,U)};_e(Y,J=>{i()&&J(Z)})}fe(J=>{k=tn(x,"",k,{background:r()}),se(w,J),se(L,g(o).length),$=jt(oe,0,"chevron svelte-tl1unp",null,$,{open:i()})},[()=>v(e.action)]),F(t,p),ut()}Pt(["click"]);var Hg=H(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),Wg=H(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),Yg=H(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),Vg=H('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function Xg(t,e){ct(e,!0);let r=Ie(e,"open",15,!1),a=Ie(e,"sampleEmail",3,null),i=Pe("system");function o(){return a()?Ru(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(x){x.target===x.currentTarget&&u()}var v=fa(),p=at(v);{var y=x=>{var k=Vg();k.__click=d,k.__keydown=ae=>ae.key==="Escape"&&u();var w=b(k),O=b(w),L=S(b(O),2);L.__click=u;var T=S(O,2),K=b(T);let oe;K.__click=()=>j(i,"system");var $=S(K,2);let Y;$.__click=()=>j(i,"email");var Z=S($,2);let J;Z.__click=()=>j(i,"config");var U=S(T,2),ce=b(U);{var ye=ae=>{var ue=Hg(),Re=S(at(ue),2),re=b(Re);fe(()=>se(re,Au)),F(ae,ue)},Te=ae=>{var ue=Wg(),Re=S(at(ue),2),re=S(b(Re),2);re.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var le=S(Re,2),de=S(b(le),2),Q=b(de);fe(ie=>se(Q,ie),[o]),F(ae,ue)},ge=ae=>{var ue=Yg(),Re=S(at(ue),2),re=b(Re),le=S(b(re),2),de=b(le),Q=S(re,2),ie=S(b(Q),2),ve=b(ie),be=S(Q,2),V=S(b(be),2),te=b(V),W=S(Re,4);W.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,fe(()=>{se(de,Tp.maxTokens),se(ve,"false"),se(te,"false")}),F(ae,ue)};_e(ce,ae=>{g(i)==="system"?ae(ye):g(i)==="email"?ae(Te,1):g(i)==="config"&&ae(ge,2)})}fe(()=>{oe=jt(K,1,"tab svelte-10pcy9j",null,oe,{active:g(i)==="system"}),Y=jt($,1,"tab svelte-10pcy9j",null,Y,{active:g(i)==="email"}),J=jt(Z,1,"tab svelte-10pcy9j",null,J,{active:g(i)==="config"})}),F(x,k)};_e(p,x=>{r()&&x(y)})}F(t,v),ut()}Pt(["click","keydown"]);var Qg=H('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),Zg=H('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),Jg=H('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),$g=H('<button class="chip svelte-s2dwjj"> </button>'),ey=H('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),ty=H('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),ny=H('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),ry=H('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),ay=H('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),sy=H('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),iy=H('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),oy=H('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),ly=H('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),cy=H('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),uy=H('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),fy=H('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function dy(t,e){ct(e,!0);let r=Ie(e,"groupOrder",19,()=>[]),a=Pe(!1),i=Pe(null),o=Pe(!1),u=Pe(null);async function d(){var ge;const[U,ce,ye]=await Promise.all([qe.items.where("sourceType").equals("gmail").count(),qe.emailClassifications.count(),qe.contacts.count()]);let Te=0;try{const ae=await((ge=navigator.storage)==null?void 0:ge.estimate());Te=(ae==null?void 0:ae.usage)??0}catch{}j(u,{emailCount:U,classCount:ce,contactCount:ye,totalBytes:Te},!0)}function v(U){return U?U<1024?`${U} B`:U<1024*1024?`${(U/1024).toFixed(1)} KB`:`${(U/(1024*1024)).toFixed(1)} MB`:"â"}function p(){j(a,!g(a)),g(a)&&d()}async function y(U){var ce;j(o,!0),j(i,null);try{await U(),await d(),(ce=e.onrefresh)==null||ce.call(e)}finally{j(o,!1)}}async function x(){await y(()=>Wl())}async function k(U){await y(()=>zo(U))}async function w(){await y(async()=>{await Mu(),await Wl()})}async function O(){await y(()=>qe.contacts.clear())}async function L(){await y(async()=>{await qe.delete(),window.location.reload()})}function T(U){return U.split("_").map(ce=>ce.charAt(0)+ce.slice(1).toLowerCase()).join(" ")}var K=fy(),oe=b(K);oe.__click=p;var $=S(b(oe),2);let Y;var Z=S(oe,2);{var J=U=>{var ce=uy(),ye=b(ce);{var Te=B=>{var Ae=Zg(),De=b(Ae),Be=b(De),Tt=S(De,4),ht=b(Tt),fn=S(Tt,4),Jn=b(fn),dn=S(fn,2);{var Gt=wt=>{var mt=Qg(),pn=S(at(mt),2),hn=b(pn);fe(zn=>se(hn,`${zn??""} used`),[()=>v(g(u).totalBytes)]),F(wt,mt)};_e(dn,wt=>{g(u).totalBytes&&wt(Gt)})}fe(()=>{se(Be,`${g(u).emailCount??""} emails`),se(ht,`${g(u).classCount??""} classifications`),se(Jn,`${g(u).contactCount??""} contacts`)}),F(B,Ae)};_e(ye,B=>{g(u)&&B(Te)})}var ge=S(ye,2);{var ae=B=>{var Ae=ey(),De=S(b(Ae),2);nn(De,21,r,hr,(Be,Tt)=>{var ht=fa(),fn=at(ht);{var Jn=Gt=>{var wt=Jg(),mt=b(wt),pn=S(mt);pn.__click=()=>j(i,null);var hn=S(pn,2);hn.__click=()=>k(g(Tt)),fe(zn=>{se(mt,`Delete ${zn??""}? `),hn.disabled=g(o)},[()=>T(g(Tt))]),F(Gt,wt)},dn=Gt=>{var wt=$g();wt.__click=()=>j(i,`group:${g(Tt)}`);var mt=b(wt);fe(pn=>{wt.disabled=g(o),se(mt,`${pn??""} â`)},[()=>T(g(Tt))]),F(Gt,wt)};_e(fn,Gt=>{g(i)===`group:${g(Tt)}`?Gt(Jn):Gt(dn,!1)})}F(Be,ht)}),F(B,Ae)};_e(ge,B=>{r().length>0&&B(ae)})}var ue=S(ge,2),Re=S(b(ue),2),re=b(Re);{var le=B=>{var Ae=ty(),De=S(b(Ae),2);De.__click=()=>j(i,null);var Be=S(De,2);Be.__click=x,fe(()=>Be.disabled=g(o)),F(B,Ae)},de=B=>{var Ae=ny();Ae.__click=()=>j(i,"classifications"),fe(()=>Ae.disabled=g(o)),F(B,Ae)};_e(re,B=>{g(i)==="classifications"?B(le):B(de,!1)})}var Q=S(re,2);{var ie=B=>{var Ae=ry(),De=S(b(Ae),2);De.__click=()=>j(i,null);var Be=S(De,2);Be.__click=w,fe(()=>Be.disabled=g(o)),F(B,Ae)},ve=B=>{var Ae=ay();Ae.__click=()=>j(i,"emails"),fe(()=>Ae.disabled=g(o)),F(B,Ae)};_e(Q,B=>{g(i)==="emails"?B(ie):B(ve,!1)})}var be=S(Q,2);{var V=B=>{var Ae=sy(),De=S(b(Ae),2);De.__click=()=>j(i,null);var Be=S(De,2);Be.__click=O,fe(()=>Be.disabled=g(o)),F(B,Ae)},te=B=>{var Ae=iy();Ae.__click=()=>j(i,"contacts"),fe(()=>Ae.disabled=g(o)),F(B,Ae)};_e(be,B=>{g(i)==="contacts"?B(V):B(te,!1)})}var W=S(ue,2),ne=b(W);{var Le=B=>{var Ae=oy(),De=S(b(Ae),2);De.__click=()=>j(i,null);var Be=S(De,2);Be.__click=L,fe(()=>Be.disabled=g(o)),F(B,Ae)},Fe=B=>{var Ae=ly();Ae.__click=()=>j(i,"nuke"),fe(()=>Ae.disabled=g(o)),F(B,Ae)};_e(ne,B=>{g(i)==="nuke"?B(Le):B(Fe,!1)})}var rt=S(W,2);{var St=B=>{var Ae=cy();F(B,Ae)};_e(rt,B=>{g(o)&&B(St)})}F(U,ce)};_e(Z,U=>{g(a)&&U(J)})}fe(()=>Y=jt($,0,"chev svelte-s2dwjj",null,Y,{open:g(a)})),F(t,K),ut()}Pt(["click"]);var py=H('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),hy=H('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),vy=H('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),my=H('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function gy(t,e){ct(e,!0);let r=Ie(e,"groups",19,()=>({})),a=Ie(e,"groupOrder",19,()=>[]),i=Ie(e,"counts",19,()=>({})),o=Ie(e,"stats",3,null),u=Ie(e,"expandedGroup",3,null),d=Ie(e,"isScanning",3,!1),v=Ie(e,"scanProgress",3,null),p=Ie(e,"scanCount",15,20),y=Ie(e,"error",3,null),x=Pe(!1),k=ft(()=>{for(const J of a()){const U=r()[J];if((U==null?void 0:U.length)>0)return U[0]}return null});var w=my(),O=b(w);Eg(O,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},oninspect:()=>j(x,!0),get scanCount(){return p()},set scanCount(J){p(J)}});var L=S(O,2);Xg(L,{get sampleEmail(){return g(k)},get open(){return g(x)},set open(J){j(x,J,!0)}});var T=S(L,2);{var K=J=>{var U=py(),ce=b(U),ye=b(ce),Te=S(ce,2);Te.__click=function(...ge){var ae;(ae=e.ondismisserror)==null||ae.apply(this,ge)},fe(()=>se(ye,y())),F(J,U)};_e(T,J=>{y()&&J(K)})}var oe=S(T,2);{var $=J=>{var U=hy(),ce=at(U);nn(ce,20,a,ae=>ae,(ae,ue)=>{{let Re=ft(()=>ho(ue)),re=ft(()=>{var Q;return((Q=r()[ue])==null?void 0:Q.length)||0}),le=ft(()=>r()[ue]||[]),de=ft(()=>u()===ue);Gg(ae,{get action(){return ue},get color(){return g(Re)},get count(){return g(re)},get items(){return g(le)},get expanded(){return g(de)},ontoggle:()=>e.ontogglegroup(ue),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ue)})}});var ye=S(ce,2),Te=b(ye),ge=b(Te);fe(()=>se(ge,`${i().total??""} emails classified into ${a().length??""} groups`)),F(J,U)},Y=J=>{var U=vy();F(J,U)};_e(oe,J=>{i().total>0?J($):d()||J(Y,1)})}var Z=S(oe,2);dy(Z,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),F(t,w),ut()}Pt(["click"]);var yy=H('<div class="actions-page svelte-3tch4q"><!></div>');function _y(t,e){ct(e,!0);const r=vu();let a=Pe(Mt(r.status)),i=Pe(""),o=Pe(Mt({})),u=Pe(Mt([])),d=Pe(Mt({total:0})),v=Pe(null),p=Pe(null),y=Pe(!1),x=Pe(null),k=Pe(20),w=Pe(null);Bt(()=>{const ye=r.onMessage(Te=>{if(Te.status==="ready"){j(a,"ready");const ge=us.find(ae=>ae.id===r.modelId);j(i,(ge==null?void 0:ge.name)||r.modelId||"",!0)}Te.status==="loading"&&j(a,"loading")});if(j(a,r.status,!0),r.modelId){const Te=us.find(ge=>ge.id===r.modelId);j(i,(Te==null?void 0:Te.name)||r.modelId||"",!0)}return O(),()=>ye()});async function O(){try{const ye=await Ep();j(o,ye.groups,!0),j(u,ye.order,!0),j(d,await Ap(),!0),j(v,await po(),!0)}catch(ye){j(w,`Failed to load data: ${ye.message}`)}}async function L(){await K(!1)}async function T(){await K(!0)}async function K(ye){if(!(g(y)||!r.isReady)){j(w,null),j(y,!0),j(x,null);try{await Cu(r,{count:g(k),force:ye,onProgress:Te=>{j(x,{...Te},!0)}}),await O()}catch(Te){j(w,`Scan failed: ${Te.message}`)}finally{j(y,!1)}}}async function oe(ye){await ri(ye,"acted"),await O()}async function $(ye){await ri(ye,"dismissed"),await O()}async function Y(ye){await Iu(ye),await O()}async function Z(ye){await zo(ye),await O()}function J(ye){j(p,g(p)===ye?null:ye,!0)}var U=yy(),ce=b(U);gy(ce,{get engineStatus(){return g(a)},get modelName(){return g(i)},get groups(){return g(o)},get groupOrder(){return g(u)},get counts(){return g(d)},get stats(){return g(v)},get expandedGroup(){return g(p)},get isScanning(){return g(y)},get scanProgress(){return g(x)},get error(){return g(w)},onscan:L,onrescan:T,ontogglegroup:J,onmarkacted:oe,ondismiss:$,onremove:Y,oncleargroup:Z,ondismisserror:()=>j(w,null),onrefresh:O,get scanCount(){return g(k)},set scanCount(ye){j(k,ye,!0)}}),F(t,U),ut()}var by=H('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function wy(t,e){ct(e,!0);function r(){const U=location.hash;return U==="#dashboard"?"dashboard":U==="#actions"?"actions":"chat"}let a=Pe(Mt(r()));Bt(()=>{function U(){j(a,r(),!0)}return window.addEventListener("hashchange",U),()=>window.removeEventListener("hashchange",U)});var i=by(),o=b(i),u=S(b(o),2),d=b(u);let v;var p=S(d,2);let y;var x=S(p,2);let k;var w=S(o,2),O=b(w);let L;var T=b(O);qh(T,{});var K=S(O,2);let oe;var $=b(K);_y($,{});var Y=S(K,2);let Z;var J=b(Y);yg(J,{}),fe(()=>{v=jt(d,1,"svelte-1n46o8q",null,v,{active:g(a)==="chat"}),y=jt(p,1,"svelte-1n46o8q",null,y,{active:g(a)==="actions"}),k=jt(x,1,"svelte-1n46o8q",null,k,{active:g(a)==="dashboard"}),L=tn(O,"",L,{display:g(a)==="chat"?"flex":"none"}),oe=tn(K,"",oe,{display:g(a)==="actions"?"flex":"none"}),Z=tn(Y,"",Z,{display:g(a)==="dashboard"?"flex":"none"})}),F(t,i),ut()}Bd(wy,{target:document.getElementById("app")});
