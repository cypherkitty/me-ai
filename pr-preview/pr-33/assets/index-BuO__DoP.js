var yf=Object.defineProperty;var Sl=t=>{throw TypeError(t)};var bf=(t,e,r)=>e in t?yf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ye=(t,e,r)=>bf(t,typeof e!="symbol"?e+"":e,r),qi=(t,e,r)=>e.has(t)||Sl("Cannot "+r);var X=(t,e,r)=>(qi(t,e,"read from private field"),r?r.call(t):e.get(t)),Ve=(t,e,r)=>e.has(t)?Sl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,a)=>(qi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Kt=(t,e,r)=>(qi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Zi=!1;var xo=Array.isArray,_f=Array.prototype.indexOf,Aa=Array.prototype.includes,oi=Array.from,wf=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,kf=Object.getOwnPropertyDescriptors,xf=Object.prototype,Sf=Array.prototype,vc=Object.getPrototypeOf,Tl=Object.isExtensible;const Tf=()=>{};function Ef(t){for(var e=0;e<t.length;e++)t[e]()}function gc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Nt=2,is=4,li=8,mc=1<<24,dr=16,Bn=32,ca=64,yc=128,kn=512,It=1024,qt=2048,qn=4096,ln=8192,ur=16384,ps=32768,Ca=65536,El=1<<17,bc=1<<18,Da=1<<19,Af=1<<20,cr=1<<25,aa=65536,Ji=1<<21,So=1<<22,Cr=1<<23,ta=Symbol("$state"),Cf=Symbol("legacy props"),If=Symbol(""),Wr=new class extends Error{constructor(){super(...arguments);Ye(this,"name","StaleReactionError");Ye(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Rf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Pf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Of(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Df(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function jf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Mf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Lf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Nf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function qf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Bf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function zf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ff(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Kf=1,Uf=2,_c=4,Gf=8,Hf=16,Wf=1,Yf=4,Vf=8,Xf=16,wc=1,Qf=2,Ot=Symbol(),kc="http://www.w3.org/1999/xhtml";function Zf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Jf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function xc(t){return t===this.v}function $f(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Sc(t){return!$f(t,this.v)}let ed=!1,cn=null;function Ia(t){cn=t}function ut(t,e=!1,r){cn={p:cn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ft(t){var e=cn,r=e.e;if(r!==null){e.e=null;for(var a of r)Wc(a)}return t!==void 0&&(e.x=t),e.i=!0,cn=e.p,t??{}}function Tc(){return!0}let Yr=[];function Ec(){var t=Yr;Yr=[],Ef(t)}function Ir(t){if(Yr.length===0&&!ns){var e=Yr;queueMicrotask(()=>{e===Yr&&Ec()})}Yr.push(t)}function td(){for(;Yr.length>0;)Ec()}function Ac(t){var e=at;if(e===null)return Xe.f|=Cr,t;if((e.f&ps)===0&&(e.f&is)===0)throw t;Ra(t,e)}function Ra(t,e){for(;e!==null;){if((e.f&yc)!==0){if((e.f&ps)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const nd=-7169;function wt(t,e){t.f=t.f&nd|e}function To(t){(t.f&kn)!==0||t.deps===null?wt(t,It):wt(t,qn)}function Cc(t){if(t!==null)for(const e of t)(e.f&Nt)===0||(e.f&aa)===0||(e.f^=aa,Cc(e.deps))}function Ic(t,e,r){(t.f&qt)!==0?e.add(t):(t.f&qn)!==0&&r.add(t),Cc(t.deps),wt(t,It)}const Ns=new Set;let Ke=null,Js=null,Dt=null,Jt=[],ci=null,$i=!1,ns=!1;var _a,wa,Xr,ka,cs,us,Qr,sr,xa,Zn,eo,to,Rc;const Qo=class Qo{constructor(){Ve(this,Zn);Ye(this,"committed",!1);Ye(this,"current",new Map);Ye(this,"previous",new Map);Ve(this,_a,new Set);Ve(this,wa,new Set);Ve(this,Xr,0);Ve(this,ka,0);Ve(this,cs,null);Ve(this,us,new Set);Ve(this,Qr,new Set);Ve(this,sr,new Map);Ye(this,"is_fork",!1);Ve(this,xa,!1)}is_deferred(){return this.is_fork||X(this,ka)>0}skip_effect(e){X(this,sr).has(e)||X(this,sr).set(e,{d:[],m:[]})}unskip_effect(e){var r=X(this,sr).get(e);if(r){X(this,sr).delete(e);for(var a of r.d)wt(a,qt),Ln(a);for(a of r.m)wt(a,qn),Ln(a)}}process(e){var i;Jt=[],this.apply();var r=[],a=[];for(const o of e)Kt(this,Zn,eo).call(this,o,r,a);if(this.is_deferred()){Kt(this,Zn,to).call(this,a),Kt(this,Zn,to).call(this,r);for(const[o,u]of X(this,sr))jc(o,u)}else{for(const o of X(this,_a))o();X(this,_a).clear(),X(this,Xr)===0&&Kt(this,Zn,Rc).call(this),Js=this,Ke=null,Al(a),Al(r),Js=null,(i=X(this,cs))==null||i.resolve()}Dt=null}capture(e,r){r!==Ot&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Cr)===0&&(this.current.set(e,e.v),Dt==null||Dt.set(e,e.v))}activate(){Ke=this,this.apply()}deactivate(){Ke===this&&(Ke=null,Dt=null)}flush(){if(this.activate(),Jt.length>0){if(Pc(),Ke!==null&&Ke!==this)return}else X(this,Xr)===0&&this.process([]);this.deactivate()}discard(){for(const e of X(this,wa))e(this);X(this,wa).clear()}increment(e){He(this,Xr,X(this,Xr)+1),e&&He(this,ka,X(this,ka)+1)}decrement(e){He(this,Xr,X(this,Xr)-1),e&&He(this,ka,X(this,ka)-1),!X(this,xa)&&(He(this,xa,!0),Ir(()=>{He(this,xa,!1),this.is_deferred()?Jt.length>0&&this.flush():this.revive()}))}revive(){for(const e of X(this,us))X(this,Qr).delete(e),wt(e,qt),Ln(e);for(const e of X(this,Qr))wt(e,qn),Ln(e);this.flush()}oncommit(e){X(this,_a).add(e)}ondiscard(e){X(this,wa).add(e)}settled(){return(X(this,cs)??He(this,cs,gc())).promise}static ensure(){if(Ke===null){const e=Ke=new Qo;Ns.add(Ke),ns||Ir(()=>{Ke===e&&e.flush()})}return Ke}apply(){}};_a=new WeakMap,wa=new WeakMap,Xr=new WeakMap,ka=new WeakMap,cs=new WeakMap,us=new WeakMap,Qr=new WeakMap,sr=new WeakMap,xa=new WeakMap,Zn=new WeakSet,eo=function(e,r,a){e.f^=It;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(Bn|ca))!==0,v=d&&(u&It)!==0,h=v||(u&ln)!==0||X(this,sr).has(i);if(!h&&i.fn!==null){d?i.f^=It:o!==null&&(u&(is|li|mc))!==0?o.b.defer_effect(i):(u&is)!==0?r.push(i):vs(i)&&((u&dr)!==0&&X(this,Qr).add(i),Oa(i));var y=i.first;if(y!==null){i=y;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},to=function(e){for(var r=0;r<e.length;r+=1)Ic(e[r],X(this,us),X(this,Qr))},Rc=function(){var i;if(Ns.size>1){this.previous.clear();var e=Dt,r=!0;for(const o of Ns){if(o===this){r=!1;continue}const u=[];for(const[v,h]of this.current){if(o.current.has(v))if(r&&h!==o.current.get(v))o.current.set(v,h);else continue;u.push(v)}if(u.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Jt;Jt=[];const v=new Set,h=new Map;for(const y of u)Oc(y,d,v,h);if(Jt.length>0){Ke=o,o.apply();for(const y of Jt)Kt(i=o,Zn,eo).call(i,y,[],[]);o.deactivate()}Jt=a}}Ke=null,Dt=e}this.committed=!0,Ns.delete(this)};let Rr=Qo;function rd(t){var e=ns;ns=!0;try{for(var r;;){if(td(),Jt.length===0&&(Ke==null||Ke.flush(),Jt.length===0))return ci=null,r;Pc()}}finally{ns=e}}function Pc(){$i=!0;var t=null;try{for(var e=0;Jt.length>0;){var r=Rr.ensure();if(e++>1e3){var a,i;ad()}r.process(Jt),Pr.clear()}}finally{Jt=[],$i=!1,ci=null}}function ad(){try{Lf()}catch(t){Ra(t,ci)}}let Pn=null;function Al(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(ur|ln))===0&&vs(a)&&(Pn=new Set,Oa(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Qc(a),(Pn==null?void 0:Pn.size)>0)){Pr.clear();for(const i of Pn){if((i.f&(ur|ln))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)Pn.has(u)&&(Pn.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(ur|ln))===0&&Oa(v)}}Pn.clear()}}Pn=null}}function Oc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Nt)!==0?Oc(i,e,r,a):(o&(So|dr))!==0&&(o&qt)===0&&Dc(i,e,a)&&(wt(i,qt),Ln(i))}}function Dc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Aa.call(e,i))return!0;if((i.f&Nt)!==0&&Dc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Ln(t){for(var e=ci=t;e.parent!==null;){e=e.parent;var r=e.f;if($i&&e===at&&(r&dr)!==0&&(r&bc)===0)return;if((r&(ca|Bn))!==0){if((r&It)===0)return;e.f^=It}}Jt.push(e)}function jc(t,e){if(!((t.f&Bn)!==0&&(t.f&It)!==0)){(t.f&qt)!==0?e.d.push(t):(t.f&qn)!==0&&e.m.push(t),wt(t,It);for(var r=t.first;r!==null;)jc(r,e),r=r.next}}function sd(t){let e=0,r=sa(0),a;return()=>{Co()&&(m(r),Io(()=>(e===0&&(a=gs(()=>t(()=>rs(r)))),e+=1,()=>{Ir(()=>{e-=1,e===0&&(a==null||a(),a=void 0,rs(r))})})))}}var id=Ca|Da|yc;function od(t,e,r){new ld(t,e,r)}var bn,ko,Wn,Zr,Yn,_n,Qt,Vn,ir,Er,Jr,Ar,Sa,$r,Ta,Ea,or,si,Rt,cd,ud,no,Hs,Ws,ro;class ld{constructor(e,r,a){Ve(this,Rt);Ye(this,"parent");Ye(this,"is_pending",!1);Ve(this,bn);Ve(this,ko,null);Ve(this,Wn);Ve(this,Zr);Ve(this,Yn);Ve(this,_n,null);Ve(this,Qt,null);Ve(this,Vn,null);Ve(this,ir,null);Ve(this,Er,null);Ve(this,Jr,0);Ve(this,Ar,0);Ve(this,Sa,!1);Ve(this,$r,!1);Ve(this,Ta,new Set);Ve(this,Ea,new Set);Ve(this,or,null);Ve(this,si,sd(()=>(He(this,or,sa(X(this,Jr))),()=>{He(this,or,null)})));He(this,bn,e),He(this,Wn,r),He(this,Zr,a),this.parent=at.b,this.is_pending=!!X(this,Wn).pending,He(this,Yn,Ro(()=>{at.b=this;{var i=Kt(this,Rt,no).call(this);try{He(this,_n,wn(()=>a(i)))}catch(o){this.error(o)}X(this,Ar)>0?Kt(this,Rt,Ws).call(this):this.is_pending=!1}return()=>{var o;(o=X(this,Er))==null||o.remove()}},id))}defer_effect(e){Ic(e,X(this,Ta),X(this,Ea))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!X(this,Wn).pending}update_pending_count(e){Kt(this,Rt,ro).call(this,e),He(this,Jr,X(this,Jr)+e),!(!X(this,or)||X(this,Sa))&&(He(this,Sa,!0),Ir(()=>{He(this,Sa,!1),X(this,or)&&Pa(X(this,or),X(this,Jr))}))}get_effect_pending(){return X(this,si).call(this),m(X(this,or))}error(e){var r=X(this,Wn).onerror;let a=X(this,Wn).failed;if(X(this,$r)||!r&&!a)throw e;X(this,_n)&&(en(X(this,_n)),He(this,_n,null)),X(this,Qt)&&(en(X(this,Qt)),He(this,Qt,null)),X(this,Vn)&&(en(X(this,Vn)),He(this,Vn,null));var i=!1,o=!1;const u=()=>{if(i){Jf();return}i=!0,o&&Ff(),Rr.ensure(),He(this,Jr,0),X(this,Vn)!==null&&na(X(this,Vn),()=>{He(this,Vn,null)}),this.is_pending=this.has_pending_snippet(),He(this,_n,Kt(this,Rt,Hs).call(this,()=>(He(this,$r,!1),wn(()=>X(this,Zr).call(this,X(this,bn)))))),X(this,Ar)>0?Kt(this,Rt,Ws).call(this):this.is_pending=!1};Ir(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){Ra(d,X(this,Yn)&&X(this,Yn).parent)}a&&He(this,Vn,Kt(this,Rt,Hs).call(this,()=>{Rr.ensure(),He(this,$r,!0);try{return wn(()=>{a(X(this,bn),()=>e,()=>u)})}catch(d){return Ra(d,X(this,Yn).parent),null}finally{He(this,$r,!1)}}))})}}bn=new WeakMap,ko=new WeakMap,Wn=new WeakMap,Zr=new WeakMap,Yn=new WeakMap,_n=new WeakMap,Qt=new WeakMap,Vn=new WeakMap,ir=new WeakMap,Er=new WeakMap,Jr=new WeakMap,Ar=new WeakMap,Sa=new WeakMap,$r=new WeakMap,Ta=new WeakMap,Ea=new WeakMap,or=new WeakMap,si=new WeakMap,Rt=new WeakSet,cd=function(){try{He(this,_n,wn(()=>X(this,Zr).call(this,X(this,bn))))}catch(e){this.error(e)}},ud=function(){const e=X(this,Wn).pending;e&&(He(this,Qt,wn(()=>e(X(this,bn)))),Ir(()=>{var r=Kt(this,Rt,no).call(this);He(this,_n,Kt(this,Rt,Hs).call(this,()=>(Rr.ensure(),wn(()=>X(this,Zr).call(this,r))))),X(this,Ar)>0?Kt(this,Rt,Ws).call(this):(na(X(this,Qt),()=>{He(this,Qt,null)}),this.is_pending=!1)}))},no=function(){var e=X(this,bn);return this.is_pending&&(He(this,Er,fr()),X(this,bn).before(X(this,Er)),e=X(this,Er)),e},Hs=function(e){var r=at,a=Xe,i=cn;Qn(X(this,Yn)),Sn(X(this,Yn)),Ia(X(this,Yn).ctx);try{return e()}catch(o){return Ac(o),null}finally{Qn(r),Sn(a),Ia(i)}},Ws=function(){const e=X(this,Wn).pending;X(this,_n)!==null&&(He(this,ir,document.createDocumentFragment()),X(this,ir).append(X(this,Er)),$c(X(this,_n),X(this,ir))),X(this,Qt)===null&&He(this,Qt,wn(()=>e(X(this,bn))))},ro=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Kt(r=this.parent,Rt,ro).call(r,e);return}if(He(this,Ar,X(this,Ar)+e),X(this,Ar)===0){this.is_pending=!1;for(const a of X(this,Ta))wt(a,qt),Ln(a);for(const a of X(this,Ea))wt(a,qn),Ln(a);X(this,Ta).clear(),X(this,Ea).clear(),X(this,Qt)&&na(X(this,Qt),()=>{He(this,Qt,null)}),X(this,ir)&&(X(this,bn).before(X(this,ir)),He(this,ir,null))}};function fd(t,e,r,a){const i=ui;var o=t.filter(k=>!k.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=Ke,d=at,v=dd(),h=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(k=>k.promise)):null;function y(k){v();try{a(k)}catch(w){(d.f&ur)===0&&Ra(w,d)}u==null||u.deactivate(),ao()}if(r.length===0){h.then(()=>y(e.map(i)));return}function x(){v(),Promise.all(r.map(k=>pd(k))).then(k=>y([...e.map(i),...k])).catch(k=>Ra(k,d))}h?h.then(x):x()}function dd(){var t=at,e=Xe,r=cn,a=Ke;return function(o=!0){Qn(t),Sn(e),Ia(r),o&&(a==null||a.activate())}}function ao(){Qn(null),Sn(null),Ia(null)}function ui(t){var e=Nt|qt,r=Xe!==null&&(Xe.f&Nt)!==0?Xe:null;return at!==null&&(at.f|=Da),{ctx:cn,deps:null,effects:null,equals:xc,f:e,fn:t,reactions:null,rv:0,v:Ot,wv:0,parent:r??at,ac:null}}function pd(t,e,r){let a=at;a===null&&Pf();var i=a.b,o=void 0,u=sa(Ot),d=!Xe,v=new Map;return Ad(()=>{var w;var h=gc();o=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{y===Ke&&y.committed&&y.deactivate(),ao()})}catch(j){h.reject(j),ao()}var y=Ke;if(d){var x=i.is_rendered();i.update_pending_count(1),y.increment(x),(w=v.get(y))==null||w.reject(Wr),v.delete(y),v.set(y,h)}const k=(j,L=void 0)=>{if(y.activate(),L)L!==Wr&&(u.f|=Cr,Pa(u,L));else{(u.f&Cr)!==0&&(u.f^=Cr),Pa(u,j);for(const[T,K]of v){if(v.delete(T),T===y)break;K.reject(Wr)}}d&&(i.update_pending_count(-1),y.decrement(x))};h.promise.then(k,j=>k(null,j||"unknown"))}),Hc(()=>{for(const h of v.values())h.reject(Wr)}),new Promise(h=>{function y(x){function k(){x===o?h(u):y(o)}x.then(k,k)}y(o)})}function dt(t){const e=ui(t);return eu(e),e}function Mc(t){const e=ui(t);return e.equals=Sc,e}function hd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)en(e[r])}}function vd(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return(e.f&ur)===0?e:null;e=e.parent}return null}function Eo(t){var e,r=at;Qn(vd(t));try{t.f&=~aa,hd(t),e=au(t)}finally{Qn(r)}return e}function Lc(t){var e=Eo(t);if(!t.equals(e)&&(t.wv=nu(),(!(Ke!=null&&Ke.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){wt(t,It);return}Or||(Dt!==null?(Co()||Ke!=null&&Ke.is_fork)&&Dt.set(t,e):To(t))}function gd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Wr),a.teardown=Tf,a.ac=null,os(a,0),Po(a))}function Nc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Oa(e)}let so=new Set;const Pr=new Map;let qc=!1;function sa(t,e){var r={f:0,v:t,reactions:null,equals:xc,rv:0,wv:0};return r}function Re(t,e){const r=sa(t);return eu(r),r}function md(t,e=!1,r=!0){const a=sa(t);return e||(a.equals=Sc),a}function M(t,e,r=!1){Xe!==null&&(!Nn||(Xe.f&El)!==0)&&Tc()&&(Xe.f&(Nt|dr|So|El))!==0&&(xn===null||!Aa.call(xn,t))&&zf();let a=r?jt(e):e;return Pa(t,a)}function Pa(t,e){if(!t.equals(e)){var r=t.v;Or?Pr.set(t,e):Pr.set(t,r),t.v=e;var a=Rr.ensure();if(a.capture(t,r),(t.f&Nt)!==0){const i=t;(t.f&qt)!==0&&Eo(i),To(i)}t.wv=nu(),Bc(t,qt),at!==null&&(at.f&It)!==0&&(at.f&(Bn|ca))===0&&(yn===null?Id([t]):yn.push(t)),!a.is_fork&&so.size>0&&!qc&&yd()}return e}function yd(){qc=!1;for(const t of so)(t.f&It)!==0&&wt(t,qn),vs(t)&&Oa(t);so.clear()}function rs(t){M(t,t.v+1)}function Bc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&qt)===0;if(d&&wt(o,e),(u&Nt)!==0){var v=o;Dt==null||Dt.delete(v),(u&aa)===0&&(u&kn&&(o.f|=aa),Bc(v,qn))}else d&&((u&dr)!==0&&Pn!==null&&Pn.add(o),Ln(o))}}function jt(t){if(typeof t!="object"||t===null||ta in t)return t;const e=vc(t);if(e!==xf&&e!==Sf)return t;var r=new Map,a=xo(t),i=Re(0),o=ra,u=d=>{if(ra===o)return d();var v=Xe,h=ra;Sn(null),Ol(o);var y=d();return Sn(v),Ol(h),y};return a&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&qf();var y=r.get(v);return y===void 0?u(()=>{var x=Re(h.value);return r.set(v,x),x}):M(y,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const y=u(()=>Re(Ot));r.set(v,y),rs(i)}}else M(h,Ot),rs(i);return!0},get(d,v,h){var w;if(v===ta)return t;var y=r.get(v),x=v in d;if(y===void 0&&(!x||(w=ba(d,v))!=null&&w.writable)&&(y=u(()=>{var j=jt(x?d[v]:Ot),L=Re(j);return L}),r.set(v,y)),y!==void 0){var k=m(y);return k===Ot?void 0:k}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var y=r.get(v);y&&(h.value=m(y))}else if(h===void 0){var x=r.get(v),k=x==null?void 0:x.v;if(x!==void 0&&k!==Ot)return{enumerable:!0,configurable:!0,value:k,writable:!0}}return h},has(d,v){var k;if(v===ta)return!0;var h=r.get(v),y=h!==void 0&&h.v!==Ot||Reflect.has(d,v);if(h!==void 0||at!==null&&(!y||(k=ba(d,v))!=null&&k.writable)){h===void 0&&(h=u(()=>{var w=y?jt(d[v]):Ot,j=Re(w);return j}),r.set(v,h));var x=m(h);if(x===Ot)return!1}return y},set(d,v,h,y){var se;var x=r.get(v),k=v in d;if(a&&v==="length")for(var w=h;w<x.v;w+=1){var j=r.get(w+"");j!==void 0?M(j,Ot):w in d&&(j=u(()=>Re(Ot)),r.set(w+"",j))}if(x===void 0)(!k||(se=ba(d,v))!=null&&se.writable)&&(x=u(()=>Re(void 0)),M(x,jt(h)),r.set(v,x));else{k=x.v!==Ot;var L=u(()=>jt(h));M(x,L)}var T=Reflect.getOwnPropertyDescriptor(d,v);if(T!=null&&T.set&&T.set.call(y,h),!k){if(a&&typeof v=="string"){var K=r.get("length"),ae=Number(v);Number.isInteger(ae)&&ae>=K.v&&M(K,ae+1)}rs(i)}return!0},ownKeys(d){m(i);var v=Reflect.ownKeys(d).filter(x=>{var k=r.get(x);return k===void 0||k.v!==Ot});for(var[h,y]of r)y.v!==Ot&&!(h in d)&&v.push(h);return v},setPrototypeOf(){Bf()}})}function Cl(t){try{if(t!==null&&typeof t=="object"&&ta in t)return t[ta]}catch{}return t}function bd(t,e){return Object.is(Cl(t),Cl(e))}var Il,zc,Fc,Kc;function _d(){if(Il===void 0){Il=window,zc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Fc=ba(e,"firstChild").get,Kc=ba(e,"nextSibling").get,Tl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Tl(r)&&(r.__t=void 0)}}function fr(t=""){return document.createTextNode(t)}function on(t){return Fc.call(t)}function hs(t){return Kc.call(t)}function _(t,e){return on(t)}function st(t,e=!1){{var r=on(t);return r instanceof Comment&&r.data===""?hs(r):r}}function S(t,e=1,r=!1){let a=t;for(;e--;)a=hs(a);return a}function wd(t){t.textContent=""}function Uc(){return!1}function kd(t,e,r){return document.createElementNS(kc,t,void 0)}let Rl=!1;function xd(){Rl||(Rl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Ao(t){var e=Xe,r=at;Sn(null),Qn(null);try{return t()}finally{Sn(e),Qn(r)}}function Gc(t,e,r,a=r){t.addEventListener(e,()=>Ao(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),xd()}function Sd(t){at===null&&(Xe===null&&Mf(),jf()),Or&&Df()}function Td(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function pr(t,e,r){var a=at;a!==null&&(a.f&ln)!==0&&(t|=ln);var i={ctx:cn,deps:null,nodes:null,f:t|qt|kn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Oa(i)}catch(d){throw en(i),d}else e!==null&&Ln(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Da)===0&&(o=o.first,(t&dr)!==0&&(t&Ca)!==0&&o!==null&&(o.f|=Ca)),o!==null&&(o.parent=a,a!==null&&Td(o,a),Xe!==null&&(Xe.f&Nt)!==0&&(t&ca)===0)){var u=Xe;(u.effects??(u.effects=[])).push(o)}return i}function Co(){return Xe!==null&&!Nn}function Hc(t){const e=pr(li,null,!1);return wt(e,It),e.teardown=t,e}function $s(t){Sd();var e=at.f,r=!Xe&&(e&Bn)!==0&&(e&ps)===0;if(r){var a=cn;(a.e??(a.e=[])).push(t)}else return Wc(t)}function Wc(t){return pr(is|Af,t,!1)}function Ed(t){Rr.ensure();const e=pr(ca|Da,t,!0);return(r={})=>new Promise(a=>{r.outro?na(e,()=>{en(e),a(void 0)}):(en(e),a(void 0))})}function Yc(t){return pr(is,t,!1)}function Ad(t){return pr(So|Da,t,!0)}function Io(t,e=0){return pr(li|e,t,!0)}function ue(t,e=[],r=[],a=[]){fd(a,e,r,i=>{pr(li,()=>t(...i.map(m)),!0)})}function Ro(t,e=0){var r=pr(dr|e,t,!0);return r}function wn(t){return pr(Bn|Da,t,!0)}function Vc(t){var e=t.teardown;if(e!==null){const r=Or,a=Xe;Pl(!0),Sn(null);try{e.call(null)}finally{Pl(r),Sn(a)}}}function Po(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Ao(()=>{i.abort(Wr)});var a=r.next;(r.f&ca)!==0?r.parent=null:en(r,e),r=a}}function Cd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Bn)===0&&en(e),e=r}}function en(t,e=!0){var r=!1;(e||(t.f&bc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Xc(t.nodes.start,t.nodes.end),r=!0),Po(t,e&&!r),os(t,0),wt(t,ur);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Vc(t);var i=t.parent;i!==null&&i.first!==null&&Qc(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Xc(t,e){for(;t!==null;){var r=t===e?null:hs(t);t.remove(),t=r}}function Qc(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function na(t,e,r=!0){var a=[];Zc(t,a,!0);var i=()=>{r&&en(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function Zc(t,e,r){if((t.f&ln)===0){t.f^=ln;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Ca)!==0||(i.f&Bn)!==0&&(t.f&dr)!==0;Zc(i,e,u?r:!1),i=o}}}function Oo(t){Jc(t,!0)}function Jc(t,e){if((t.f&ln)!==0){t.f^=ln,(t.f&It)===0&&(wt(t,qt),Ln(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ca)!==0||(r.f&Bn)!==0;Jc(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function $c(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:hs(r);e.append(r),r=i}}let Ys=!1,Or=!1;function Pl(t){Or=t}let Xe=null,Nn=!1;function Sn(t){Xe=t}let at=null;function Qn(t){at=t}let xn=null;function eu(t){Xe!==null&&(xn===null?xn=[t]:xn.push(t))}let $t=null,an=0,yn=null;function Id(t){yn=t}let tu=1,Vr=0,ra=Vr;function Ol(t){ra=t}function nu(){return++tu}function vs(t){var e=t.f;if((e&qt)!==0)return!0;if(e&Nt&&(t.f&=~aa),(e&qn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(vs(o)&&Lc(o),o.wv>t.wv)return!0}(e&kn)!==0&&Dt===null&&wt(t,It)}return!1}function ru(t,e,r=!0){var a=t.reactions;if(a!==null&&!(xn!==null&&Aa.call(xn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Nt)!==0?ru(o,e,!1):e===o&&(r?wt(o,qt):(o.f&It)!==0&&wt(o,qn),Ln(o))}}function au(t){var L;var e=$t,r=an,a=yn,i=Xe,o=xn,u=cn,d=Nn,v=ra,h=t.f;$t=null,an=0,yn=null,Xe=(h&(Bn|ca))===0?t:null,xn=null,Ia(t.ctx),Nn=!1,ra=++Vr,t.ac!==null&&(Ao(()=>{t.ac.abort(Wr)}),t.ac=null);try{t.f|=Ji;var y=t.fn,x=y();t.f|=ps;var k=t.deps,w=Ke==null?void 0:Ke.is_fork;if($t!==null){var j;if(w||os(t,an),k!==null&&an>0)for(k.length=an+$t.length,j=0;j<$t.length;j++)k[an+j]=$t[j];else t.deps=k=$t;if(Co()&&(t.f&kn)!==0)for(j=an;j<k.length;j++)((L=k[j]).reactions??(L.reactions=[])).push(t)}else!w&&k!==null&&an<k.length&&(os(t,an),k.length=an);if(Tc()&&yn!==null&&!Nn&&k!==null&&(t.f&(Nt|qn|qt))===0)for(j=0;j<yn.length;j++)ru(yn[j],t);if(i!==null&&i!==t){if(Vr++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=Vr;if(e!==null)for(const T of e)T.rv=Vr;yn!==null&&(a===null?a=yn:a.push(...yn))}return(t.f&Cr)!==0&&(t.f^=Cr),x}catch(T){return Ac(T)}finally{t.f^=Ji,$t=e,an=r,yn=a,Xe=i,xn=o,Ia(u),Nn=d,ra=v}}function Rd(t,e){let r=e.reactions;if(r!==null){var a=_f.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Nt)!==0&&($t===null||!Aa.call($t,e))){var o=e;(o.f&kn)!==0&&(o.f^=kn,o.f&=~aa),To(o),gd(o),os(o,0)}}function os(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Rd(t,r[a])}function Oa(t){var e=t.f;if((e&ur)===0){wt(t,It);var r=at,a=Ys;at=t,Ys=!0;try{(e&(dr|mc))!==0?Cd(t):Po(t),Vc(t);var i=au(t);t.teardown=typeof i=="function"?i:null,t.wv=tu;var o;Zi&&ed&&(t.f&qt)!==0&&t.deps}finally{Ys=a,at=r}}}async function su(){await Promise.resolve(),rd()}function m(t){var e=t.f,r=(e&Nt)!==0;if(Xe!==null&&!Nn){var a=at!==null&&(at.f&ur)!==0;if(!a&&(xn===null||!Aa.call(xn,t))){var i=Xe.deps;if((Xe.f&Ji)!==0)t.rv<Vr&&(t.rv=Vr,$t===null&&i!==null&&i[an]===t?an++:$t===null?$t=[t]:$t.push(t));else{(Xe.deps??(Xe.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Xe]:Aa.call(o,Xe)||o.push(Xe)}}}if(Or&&Pr.has(t))return Pr.get(t);if(r){var u=t;if(Or){var d=u.v;return((u.f&It)===0&&u.reactions!==null||ou(u))&&(d=Eo(u)),Pr.set(u,d),d}var v=(u.f&kn)===0&&!Nn&&Xe!==null&&(Ys||(Xe.f&kn)!==0),h=(u.f&ps)===0;vs(u)&&(v&&(u.f|=kn),Lc(u)),v&&!h&&(Nc(u),iu(u))}if(Dt!=null&&Dt.has(t))return Dt.get(t);if((t.f&Cr)!==0)throw t.v;return t.v}function iu(t){if(t.f|=kn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Nt)!==0&&(e.f&kn)===0&&(Nc(e),iu(e))}function ou(t){if(t.v===Ot)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Pr.has(e)||(e.f&Nt)!==0&&ou(e))return!0;return!1}function gs(t){var e=Nn;try{return Nn=!0,t()}finally{Nn=e}}const Pd=["touchstart","touchmove"];function Od(t){return Pd.includes(t)}const lu=new Set,io=new Set;function Pt(t){for(var e=0;e<t.length;e++)lu.add(t[e]);for(var r of io)r(t)}let Dl=null;function jl(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;Dl=t;var u=0,d=Dl===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=i.indexOf(e);if(h===-1)return;v<=h&&(u=v)}if(o=i[u]||t.target,o!==e){wf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Xe,x=at;Sn(null),Qn(null);try{for(var k,w=[];o!==null;){var j=o.assignedSlot||o.parentNode||o.host||null;try{var L=o["__"+a];L!=null&&(!o.disabled||t.target===o)&&L.call(o,t)}catch(K){k?w.push(K):k=K}if(t.cancelBubble||j===e||j===null)break;o=j}if(k){for(let K of w)queueMicrotask(()=>{throw K});throw k}}finally{t.__root=e,delete t.currentTarget,Sn(y),Qn(x)}}}var dc,pc;const Bi=(pc=(dc=globalThis==null?void 0:globalThis.window)==null?void 0:dc.trustedTypes)==null?void 0:pc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Dd(t){return(Bi==null?void 0:Bi.createHTML(t))??t}function Do(t,e=!1){var r=kd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Dd(t):t,r.content}function ia(t,e){var r=at;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function G(t,e){var r=(e&wc)!==0,a=(e&Qf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Do(o?t:"<!>"+t,!0),r||(i=on(i)));var u=a||zc?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=on(u),v=u.lastChild;ia(d,v)}else ia(u,u);return u}}function jd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&wc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=Do(o,!0),v=on(d);if(i)for(u=document.createDocumentFragment();on(v);)u.appendChild(on(v));else u=on(v)}var h=u.cloneNode(!0);if(i){var y=on(h),x=h.lastChild;ia(y,x)}else ia(h,h);return h}}function jo(t,e){return jd(t,e,"svg")}function Ml(t=""){{var e=fr(t+"");return ia(e,e),e}}function ua(){var t=document.createDocumentFragment(),e=document.createComment(""),r=fr();return t.append(e,r),ia(e,r),t}function z(t,e){t!==null&&t.before(e)}function ie(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Md(t,e){return Ld(t,e)}const qs=new Map;function Ld(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){_d();var d=new Set,v=x=>{for(var k=0;k<x.length;k++){var w=x[k];if(!d.has(w)){d.add(w);var j=Od(w);for(const K of[e,document]){var L=qs.get(K);L===void 0&&(L=new Map,qs.set(K,L));var T=L.get(w);T===void 0?(K.addEventListener(w,jl,{passive:j}),L.set(w,1)):L.set(w,T+1)}}}};v(oi(lu)),io.add(v);var h=void 0,y=Ed(()=>{var x=r??e.appendChild(fr());return od(x,{pending:()=>{}},k=>{ut({});var w=cn;o&&(w.c=o),i&&(a.$$events=i),h=t(k,a)||{},ft()}),()=>{var L;for(var k of d)for(const T of[e,document]){var w=qs.get(T),j=w.get(k);--j==0?(T.removeEventListener(k,jl),w.delete(k),w.size===0&&qs.delete(T)):w.set(k,j)}io.delete(v),x!==r&&((L=x.parentNode)==null||L.removeChild(x))}});return Nd.set(h,y),h}let Nd=new WeakMap;var Dn,Xn,sn,ea,fs,ds,ii;class qd{constructor(e,r=!0){Ye(this,"anchor");Ve(this,Dn,new Map);Ve(this,Xn,new Map);Ve(this,sn,new Map);Ve(this,ea,new Set);Ve(this,fs,!0);Ve(this,ds,()=>{var e=Ke;if(X(this,Dn).has(e)){var r=X(this,Dn).get(e),a=X(this,Xn).get(r);if(a)Oo(a),X(this,ea).delete(r);else{var i=X(this,sn).get(r);i&&(X(this,Xn).set(r,i.effect),X(this,sn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of X(this,Dn)){if(X(this,Dn).delete(o),o===e)break;const d=X(this,sn).get(u);d&&(en(d.effect),X(this,sn).delete(u))}for(const[o,u]of X(this,Xn)){if(o===r||X(this,ea).has(o))continue;const d=()=>{if(Array.from(X(this,Dn).values()).includes(o)){var h=document.createDocumentFragment();$c(u,h),h.append(fr()),X(this,sn).set(o,{effect:u,fragment:h})}else en(u);X(this,ea).delete(o),X(this,Xn).delete(o)};X(this,fs)||!a?(X(this,ea).add(o),na(u,d,!1)):d()}}});Ve(this,ii,e=>{X(this,Dn).delete(e);const r=Array.from(X(this,Dn).values());for(const[a,i]of X(this,sn))r.includes(a)||(en(i.effect),X(this,sn).delete(a))});this.anchor=e,He(this,fs,r)}ensure(e,r){var a=Ke,i=Uc();if(r&&!X(this,Xn).has(e)&&!X(this,sn).has(e))if(i){var o=document.createDocumentFragment(),u=fr();o.append(u),X(this,sn).set(e,{effect:wn(()=>r(u)),fragment:o})}else X(this,Xn).set(e,wn(()=>r(this.anchor)));if(X(this,Dn).set(a,e),i){for(const[d,v]of X(this,Xn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of X(this,sn))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(X(this,ds)),a.ondiscard(X(this,ii))}else X(this,ds).call(this)}}Dn=new WeakMap,Xn=new WeakMap,sn=new WeakMap,ea=new WeakMap,fs=new WeakMap,ds=new WeakMap,ii=new WeakMap;function be(t,e,r=!1){var a=new qd(t),i=r?Ca:0;function o(u,d){a.ensure(u,d)}Ro(()=>{var u=!1;e((d,v=0)=>{u=!0,o(v,d)}),u||o(!1,null)},i)}function hr(t,e){return e}function Bd(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let x=e[d];na(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var k=t.outrogroups;oo(oi(o.done)),k.delete(o),k.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var v=a.length===0&&r!==null;if(v){var h=r,y=h.parentNode;wd(y),y.append(h),t.items.clear()}oo(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function oo(t,e=!0){for(var r=0;r<t.length;r++)en(t[r],e)}var Ll;function nn(t,e,r,a,i,o=null){var u=t,d=new Map,v=(e&_c)!==0;if(v){var h=t;u=h.appendChild(fr())}var y=null,x=Mc(()=>{var K=r();return xo(K)?K:K==null?[]:oi(K)}),k,w=!0;function j(){T.fallback=y,zd(T,k,u,e,a),y!==null&&(k.length===0?(y.f&cr)===0?Oo(y):(y.f^=cr,es(y,null,u)):na(y,()=>{y=null}))}var L=Ro(()=>{k=m(x);for(var K=k.length,ae=new Set,se=Ke,W=Uc(),Z=0;Z<K;Z+=1){var ee=k[Z],F=a(ee,Z),ce=w?null:d.get(F);ce?(ce.v&&Pa(ce.v,ee),ce.i&&Pa(ce.i,Z),W&&se.unskip_effect(ce.e)):(ce=Fd(d,w?u:Ll??(Ll=fr()),ee,F,Z,i,e,r),w||(ce.e.f|=cr),d.set(F,ce)),ae.add(F)}if(K===0&&o&&!y&&(w?y=wn(()=>o(u)):(y=wn(()=>o(Ll??(Ll=fr()))),y.f|=cr)),K>ae.size&&Of(),!w)if(W){for(const[ye,Ee]of d)ae.has(ye)||se.skip_effect(Ee.e);se.oncommit(j),se.ondiscard(()=>{})}else j();m(x)}),T={effect:L,items:d,outrogroups:null,fallback:y};w=!1}function Wa(t){for(;t!==null&&(t.f&Bn)===0;)t=t.next;return t}function zd(t,e,r,a,i){var Ee,ge,ne,le,Pe,re,fe,de,V;var o=(a&Gf)!==0,u=e.length,d=t.items,v=Wa(t.effect.first),h,y=null,x,k=[],w=[],j,L,T,K;if(o)for(K=0;K<u;K+=1)j=e[K],L=i(j,K),T=d.get(L).e,(T.f&cr)===0&&((ge=(Ee=T.nodes)==null?void 0:Ee.a)==null||ge.measure(),(x??(x=new Set)).add(T));for(K=0;K<u;K+=1){if(j=e[K],L=i(j,K),T=d.get(L).e,t.outrogroups!==null)for(const oe of t.outrogroups)oe.pending.delete(T),oe.done.delete(T);if((T.f&cr)!==0)if(T.f^=cr,T===v)es(T,null,r);else{var ae=y?y.next:v;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),Sr(t,y,T),Sr(t,T,ae),es(T,ae,r),y=T,k=[],w=[],v=Wa(y.next);continue}if((T.f&ln)!==0&&(Oo(T),o&&((le=(ne=T.nodes)==null?void 0:ne.a)==null||le.unfix(),(x??(x=new Set)).delete(T))),T!==v){if(h!==void 0&&h.has(T)){if(k.length<w.length){var se=w[0],W;y=se.prev;var Z=k[0],ee=k[k.length-1];for(W=0;W<k.length;W+=1)es(k[W],se,r);for(W=0;W<w.length;W+=1)h.delete(w[W]);Sr(t,Z.prev,ee.next),Sr(t,y,Z),Sr(t,ee,se),v=se,y=ee,K-=1,k=[],w=[]}else h.delete(T),es(T,v,r),Sr(t,T.prev,T.next),Sr(t,T,y===null?t.effect.first:y.next),Sr(t,y,T),y=T;continue}for(k=[],w=[];v!==null&&v!==T;)(h??(h=new Set)).add(v),w.push(v),v=Wa(v.next);if(v===null)continue}(T.f&cr)===0&&k.push(T),y=T,v=Wa(T.next)}if(t.outrogroups!==null){for(const oe of t.outrogroups)oe.pending.size===0&&(oo(oi(oe.done)),(Pe=t.outrogroups)==null||Pe.delete(oe));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var F=[];if(h!==void 0)for(T of h)(T.f&ln)===0&&F.push(T);for(;v!==null;)(v.f&ln)===0&&v!==t.fallback&&F.push(v),v=Wa(v.next);var ce=F.length;if(ce>0){var ye=(a&_c)!==0&&u===0?r:null;if(o){for(K=0;K<ce;K+=1)(fe=(re=F[K].nodes)==null?void 0:re.a)==null||fe.measure();for(K=0;K<ce;K+=1)(V=(de=F[K].nodes)==null?void 0:de.a)==null||V.fix()}Bd(t,F,ye)}}o&&Ir(()=>{var oe,ve;if(x!==void 0)for(T of x)(ve=(oe=T.nodes)==null?void 0:oe.a)==null||ve.apply()})}function Fd(t,e,r,a,i,o,u,d){var v=(u&Kf)!==0?(u&Hf)===0?md(r,!1,!1):sa(r):null,h=(u&Uf)!==0?sa(i):null;return{v,i:h,e:wn(()=>(o(e,v??r,h??i,d),()=>{t.delete(a)}))}}function es(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&cr)===0?e.nodes.start:r;a!==null;){var u=hs(a);if(o.before(a),a===i)return;a=u}}function Sr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Kd(t,e,r=!1,a=!1,i=!1){var o=t,u="";ue(()=>{var d=at;if(u!==(u=e()??"")&&(d.nodes!==null&&(Xc(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var v=u+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var h=Do(v);if((r||a)&&(h=on(h)),ia(on(h),h.lastChild),r||a)for(;on(h);)o.before(on(h));else o.before(h)}})}const Nl=[...` 	
\r\fÂ \v\uFEFF`];function Ud(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||Nl.includes(a[u-1]))&&(d===a.length||Nl.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function ql(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function zi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Gd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(zi)),i&&v.push(...Object.keys(i).map(zi));var h=0,y=-1;const L=t.length;for(var x=0;x<L;x++){var k=t[x];if(d?k==="/"&&t[x-1]==="*"&&(d=!1):o?o===k&&(o=!1):k==="/"&&t[x+1]==="*"?d=!0:k==='"'||k==="'"?o=k:k==="("?u++:k===")"&&u--,!d&&o===!1&&u===0){if(k===":"&&y===-1)y=x;else if(k===";"||x===L-1){if(y!==-1){var w=zi(t.substring(h,y).trim());if(!v.includes(w)){k!==";"&&x++;var j=t.substring(h,x).trim();r+=" "+j+";"}}h=x+1,y=-1}}}}return a&&(r+=ql(a)),i&&(r+=ql(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Mt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=Ud(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var h=!!o[v];(i==null||h!==!!i[v])&&t.classList.toggle(v,h)}return o}function Fi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function tn(t,e,r,a){var i=t.__style;if(i!==e){var o=Gd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Fi(t,r==null?void 0:r[0],a[0]),Fi(t,r==null?void 0:r[1],a[1],"important")):Fi(t,r,a));return a}function cu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!xo(e))return Zf();for(var a of t.options)a.selected=e.includes(as(a));return}for(a of t.options){var i=as(a);if(bd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Hd(t){var e=new MutationObserver(()=>{cu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Hc(()=>{e.disconnect()})}function Mo(t,e,r=e){var a=new WeakSet,i=!0;Gc(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),as);else{var v=t.querySelector(u)??t.querySelector("option:not([disabled])");d=v&&as(v)}r(d),Ke!==null&&a.add(Ke)}),Yc(()=>{var o=e();if(t===document.activeElement){var u=Js??Ke;if(a.has(u))return}if(cu(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=as(d),r(o))}t.__value=o,i=!1}),Hd(t)}function as(t){return"__value"in t?t.__value:t.value}const Wd=Symbol("is custom element"),Yd=Symbol("is html");function uu(t,e,r,a){var i=Vd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[If]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Xd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Vd(t){return t.__attributes??(t.__attributes={[Wd]:t.nodeName.includes("-"),[Yd]:t.namespaceURI===kc})}var Bl=new Map;function Xd(t){var e=t.getAttribute("is")||t.nodeName,r=Bl.get(e);if(r)return r;Bl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=kf(i);for(var u in a)a[u].set&&r.push(u);i=vc(i)}return r}function Lo(t,e,r=e){var a=new WeakSet;Gc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Ki(t)?Ui(o):o,r(o),Ke!==null&&a.add(Ke),await su(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var h=t.value.length;u===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=u,t.selectionEnd=Math.min(d,h))}}}),gs(e)==null&&t.value&&(r(Ki(t)?Ui(t.value):t.value),Ke!==null&&a.add(Ke)),Io(()=>{var i=e();if(t===document.activeElement){var o=Js??Ke;if(a.has(o))return}Ki(t)&&i===Ui(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Ki(t){var e=t.type;return e==="number"||e==="range"}function Ui(t){return t===""?null:+t}function zl(t,e){return t===e||(t==null?void 0:t[ta])===e}function fu(t={},e,r,a){return Yc(()=>{var i,o;return Io(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&zl(r(...i),t)&&e(null,...i))})}),()=>{Ir(()=>{o&&zl(r(...o),t)&&e(null,...o)})}}),t}let Bs=!1;function Qd(t){var e=Bs;try{return Bs=!1,[t(),Bs]}finally{Bs=e}}function Ie(t,e,r,a){var ae;var i=(r&Vf)!==0,o=(r&Xf)!==0,u=a,d=!0,v=()=>(d&&(d=!1,u=o?gs(a):a),u),h;if(i){var y=ta in t||Cf in t;h=((ae=ba(t,e))==null?void 0:ae.set)??(y&&e in t?se=>t[e]=se:void 0)}var x,k=!1;i?[x,k]=Qd(()=>t[e]):x=t[e],x===void 0&&a!==void 0&&(x=v(),h&&(Nf(),h(x)));var w;if(w=()=>{var se=t[e];return se===void 0?v():(d=!0,se)},(r&Yf)===0)return w;if(h){var j=t.$$legacy;return(function(se,W){return arguments.length>0?((!W||j||k)&&h(W?w():se),se):w()})}var L=!1,T=((r&Wf)!==0?ui:Mc)(()=>(L=!1,w()));i&&m(T);var K=at;return(function(se,W){if(arguments.length>0){const Z=W?m(T):i?jt(se):se;return M(T,Z),L=!0,u!==void 0&&(u=Z),se}return Or&&L||(K.f&ur)!==0?T.v:m(T)})}function Bt(t){cn===null&&Rf(),$s(()=>{const e=gs(t);if(typeof e=="function")return e})}const Zd="5";var hc;typeof window<"u"&&((hc=window.__svelte??(window.__svelte={})).v??(hc.v=new Set)).add(Zd);const ls=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Zt=null,lr="idle",Vs=null,Gr=new Set;function zs(){return Zt||(Zt=new Worker(new URL(""+new URL("worker-CdBv0KP2.js",import.meta.url).href,import.meta.url),{type:"module"}),Zt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(lr="loading"),e.status==="ready"&&(lr="ready"),e.status==="start"&&(lr="generating"),(e.status==="complete"||e.status==="error")&&(lr=Vs?"ready":"idle");for(const r of Gr)try{r(e)}catch{}})),Zt}function du(){return{check(){zs().postMessage({type:"check"})},loadModel(t){Vs=t,lr="loading",zs().postMessage({type:"load",modelId:t})},generate(t,e){zs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e){return new Promise((r,a)=>{let i="";const o=d=>{switch(d.status){case"thinking":break;case"thinking-done":break;case"update":i+=d.output;break;case"complete":u(),r(i);break;case"error":u(),a(new Error(d.data));break}},u=()=>{Gr.delete(o)};Gr.add(o),zs().postMessage({type:"generate",data:t,options:e})})},interrupt(){Zt==null||Zt.postMessage({type:"interrupt"})},reset(){Zt==null||Zt.postMessage({type:"reset"})},onMessage(t){return Gr.add(t),()=>Gr.delete(t)},offMessage(t){Gr.delete(t)},get status(){return lr},get isReady(){return lr==="ready"},get isGenerating(){return lr==="generating"},get modelId(){return Vs},terminate(){Zt==null||Zt.terminate(),Zt=null,lr="idle",Vs=null,Gr.clear()}}}var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $d(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xs={exports:{}},ep=Xs.exports,Fl;function tp(){return Fl||(Fl=1,(function(t,e){((r,a)=>{t.exports=a()})(ep,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,p=s.length;f<p;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Jd,u=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function x(n,s){return y.call(n,s)}function k(n,s){typeof s=="function"&&(s=s(h(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){j(n,l,s[l])})}var w=Object.defineProperty;function j(n,s,l,c){w(n,s,v(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function L(n){return{from:function(s){return n.prototype=Object.create(s.prototype),j(n.prototype,"constructor",n),{extend:k.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,K=[].slice;function ae(n,s,l){return K.call(n,s,l)}function se(n,s){return s(n)}function W(n){if(!n)throw new Error("Assertion Failed")}function Z(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function ee(n,s){if(typeof s=="string"&&x(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var p=ee(n,s[c]);l.push(p)}return l}var g,b=s.indexOf(".");return b===-1||(g=n[s.substr(0,b)])==null?void 0:ee(g,s.substr(b+1))}function F(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){W(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)F(n,s[c],l[c])}else{var p,g,b=s.indexOf(".");b!==-1?(p=s.substr(0,b),(b=s.substr(b+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:F(g=(g=n[p])&&x(n,p)?g:n[p]={},b,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ce(n){var s,l={};for(s in n)x(n,s)&&(l[s]=n[s]);return l}var ye=[].concat;function Ee(n){return ye.apply([],n)}var Y="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ee([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ge=new Set(Y.map(function(n){return o[n]})),ne=null;function le(n){return ne=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=ne.get(l);if(c)return c;if(d(l)){c=[],ne.set(l,c);for(var f=0,p=l.length;f<p;++f)c.push(s(l[f]))}else if(ge.has(l.constructor))c=l;else{var g,b=h(l);for(g in c=b===Object.prototype?{}:Object.create(b),ne.set(l,c),l)x(l,g)&&(c[g]=s(l[g]))}return c})(n),ne=null,n}var Pe={}.toString;function re(n){return Pe.call(n).slice(8,-1)}var fe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",de=typeof fe=="symbol"?function(n){var s;return n!=null&&(s=n[fe])&&s.apply(n)}:function(){return null};function V(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var oe={};function ve(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===oe&&typeof n=="string")return[n];if(f=de(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var we=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function H(n,s){this.name=n,this.message=s}function $(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function Me(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=$(n,s)}function Te(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=$(n,this.failures)}L(H).from(Error).extend({toString:function(){return this.name+": "+this.message}}),L(Me).from(H),L(Te).from(H);var Ue=xt.reduce(function(n,s){return n[s]=s+"Error",n},{}),rt=H,te=xt.reduce(function(n,s){var l=s+"Error";function c(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=J[s]||l,this.inner=null)}return L(c).from(rt),n[s]=c,n},{}),Ne=(te.Syntax=SyntaxError,te.Type=TypeError,te.Range=RangeError,Y.reduce(function(n,s){return n[s+"Error"]=te[s],n},{}));Y=xt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=te[s]),n},{});function qe(){}function Fe(n){return n}function Tt(n,s){return n==null||n===Fe?s:function(l){return s(n(l))}}function vt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function fn(n,s){return n===qe?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?vt(c,this.onsuccess):c),f&&(this.onerror=this.onerror?vt(f,this.onerror):f),p!==void 0?p:l}}function Jn(n,s){return n===qe?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?vt(l,this.onsuccess):l),c&&(this.onerror=this.onerror?vt(c,this.onerror):c)}}function dn(n,s){return n===qe?s:function(f){var c=n.apply(this,arguments),f=(v(f,c),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?vt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?vt(p,this.onerror):p),c===void 0?g===void 0?void 0:g:v(c,g)}}function Gt(n,s){return n===qe?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function kt(n,s){return n===qe?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(c,p)})}return s.apply(this,arguments)}}Y.ModifyError=Me,Y.DexieError=H,Y.BulkError=Te;var mt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pn(n){mt=n}var hn={},zn=100,En=typeof Promise>"u"?[]:(xt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[En=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(En),xt]:[xt,h(xt),xt]),xt=En[0],ma=En[1],ma=ma&&ma.then,Et=xt&&xt.constructor,Dr=!!En[2],vr=function(n,s){er.push([n,s]),gr&&(queueMicrotask(br),gr=!1)},da=!0,gr=!0,Fn=[],$n=[],mr=Fe,At={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:qe,pgp:!1,env:{},finalize:qe},je=At,er=[],An=0,pa=[];function Ae(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=je;if(typeof n!="function"){if(n!==hn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&tr(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var g=c._lib&&_r();p&&typeof p.then=="function"?l(c,function(b,I){p instanceof Ae?p._then(b,I):p.then(b,I)}):(c._state=!0,c._value=p,bs(c)),g&&nr()}},tr.bind(null,c))}catch(p){tr(c,p)}})(this,n)}var yr={get:function(){var n=je,s=Nr;function l(c,f){var p=this,g=!n.global&&(n!==je||s!==Nr),b=g&&!In(),I=new Ae(function(q,R){ja(p,new ys(A(c,n,g,b),A(f,n,g,b),q,R,n))});return this._consoleTask&&(I._consoleTask=this._consoleTask),I}return l.prototype=hn,l},set:function(n){j(this,"then",n&&n.prototype===hn?yr:{get:function(){return n},set:yr.set})}};function ys(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function tr(n,s){var l,c;$n.push(s),n._state===null&&(l=n._lib&&_r(),s=mr(s),n._state=!1,n._value=s,c=n,Fn.some(function(f){return f._value===c._value})||Fn.push(c),bs(n),l)&&nr()}function bs(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)ja(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),An===0&&(++An,vr(function(){--An==0&&jr()},[]))}function ja(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++An,vr(yt,[l,n,s])}}function yt(n,s,l){try{var c,f=s._value;!s._state&&$n.length&&($n=[]),c=mt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||$n.indexOf(f)!==-1||(p=>{for(var g=Fn.length;g;)if(Fn[--g]._value===p._value)return Fn.splice(g,1)})(s),l.resolve(c)}catch(p){l.reject(p)}finally{--An==0&&jr(),--l.psd.ref||l.psd.finalize()}}function br(){Le(At,function(){_r()&&nr()})}function _r(){var n=da;return gr=da=!1,n}function nr(){var n,s,l;do for(;0<er.length;)for(n=er,er=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<er.length);gr=da=!0}function jr(){for(var n=Fn,s=(Fn=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),pa.slice(0)),l=s.length;l;)s[--l]()}function Mr(n){return new Ae(hn,!1,n)}function it(n,s){var l=je;return function(){var c=_r(),f=je;try{return Rn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Rn(f,!1),c&&nr()}}}k(Ae.prototype,{then:yr,_then:function(n,s){ja(this,new ys(null,null,n,s,je))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:Mr)(c)}):this.then(null,function(c){return(c&&c.name===s?l:Mr)(c)}))},finally:function(n){return this.then(function(s){return Ae.resolve(n()).then(function(){return s})},function(s){return Ae.resolve(n()).then(function(){return Mr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ae(function(c,f){var p=setTimeout(function(){return f(new te.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&j(Ae.prototype,Symbol.toStringTag,"Dexie.Promise"),At.env=ws(),k(Ae,{all:function(){var n=ve.apply(null,arguments).map(qr);return new Ae(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,p){return Ae.resolve(f).then(function(g){n[p]=g,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ae?n:n&&typeof n.then=="function"?new Ae(function(s,l){n.then(s,l)}):new Ae(hn,!0,n)},reject:Mr,race:function(){var n=ve.apply(null,arguments).map(qr);return new Ae(function(s,l){n.map(function(c){return Ae.resolve(c).then(s,l)})})},PSD:{get:function(){return je},set:function(n){return je=n}},totalEchoes:{get:function(){return Nr}},newPSD:Cn,usePSD:Le,scheduler:{get:function(){return vr},set:function(n){vr=n}},rejectionMapper:{get:function(){return mr},set:function(n){mr=n}},follow:function(n,s){return new Ae(function(l,c){return Cn(function(f,p){var g=je;g.unhandleds=[],g.onunhandled=p,g.finalize=vt(function(){var b,I=this;b=function(){I.unhandleds.length===0?f():p(I.unhandleds[0])},pa.push(function q(){b(),pa.splice(pa.indexOf(q),1)}),++An,vr(function(){--An==0&&jr()},[])},g.finalize),n()},s,l,c)})}}),Et&&(Et.allSettled&&j(Ae,"allSettled",function(){var n=ve.apply(null,arguments).map(qr);return new Ae(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,p){return Ae.resolve(f).then(function(g){return c[p]={status:"fulfilled",value:g}},function(g){return c[p]={status:"rejected",reason:g}}).then(function(){return--l||s(c)})})})}),Et.any&&typeof AggregateError<"u"&&j(Ae,"any",function(){var n=ve.apply(null,arguments).map(qr);return new Ae(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(p,g){return Ae.resolve(p).then(function(b){return s(b)},function(b){f[g]=b,--c||l(new AggregateError(f))})})})}),Et.withResolvers)&&(Ae.withResolvers=Et.withResolvers);var St={awaits:0,echoes:0,id:0},vn=0,gn=[],Lr=0,Nr=0,Ma=0;function Cn(n,g,l,c){var f=je,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++Ma,At.env,p.env=Dr?{Promise:Ae,PromiseProp:{value:Ae,configurable:!0,writable:!0},all:Ae.all,race:Ae.race,allSettled:Ae.allSettled,any:Ae.any,resolve:Ae.resolve,reject:Ae.reject}:{},g&&v(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Le(p,n,l,c));return p.ref===0&&p.finalize(),g}function zt(){return St.id||(St.id=++vn),++St.awaits,St.echoes+=zn,St.id}function In(){return!!St.awaits&&(--St.awaits==0&&(St.id=0),St.echoes=St.awaits*zn,!0)}function qr(n){return St.echoes&&n&&n.constructor===Et?(zt(),n.then(function(s){return In(),s},function(s){return In(),ke(s)})):n}function _s(){var n=gn[gn.length-1];gn.pop(),Rn(n,!1)}function Rn(n,s){var l,c,f=je;(s?!St.echoes||Lr++&&n===je:!Lr||--Lr&&n===je)||queueMicrotask(s?(function(p){++Nr,St.echoes&&--St.echoes!=0||(St.echoes=St.awaits=St.id=0),gn.push(je),Rn(p,!0)}).bind(null,n):_s),n!==je&&(je=n,f===At&&(At.env=ws()),Dr)&&(l=At.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function ws(){var n=o.Promise;return Dr?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Le(n,s,l,c,f){var p=je;try{return Rn(n,!0),s(l,c,f)}finally{Rn(p,!1)}}function A(n,s,l,c){return typeof n!="function"?n:function(){var f=je;l&&zt(),Rn(s,!0);try{return n.apply(this,arguments)}finally{Rn(f,!1),c&&queueMicrotask(In)}}}function me(n){Promise===Et&&St.echoes===0?Lr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ma).indexOf("[native code]")===-1&&(zt=In=qe);var ke=Ae.reject,$e="ï¿¿",ot="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",pt="String expected.",bt=[],Xt="__dbnames",Kn="readonly",Br="readwrite";function ct(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function zr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=le(s))[n],s}}function Zo(){throw te.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Qe(n,s){try{var l=Jo(n),c=Jo(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=$o(n),p=$o(s),g=f.length,b=p.length,I=g<b?g:b,q=0;q<I;++q)if(f[q]!==p[q])return f[q]<p[q]?-1:1;return g===b?0:g<b?-1:1;case"Array":for(var R=n,E=s,O=R.length,D=E.length,P=O<D?O:D,C=0;C<P;++C){var B=Qe(R[C],E[C]);if(B!==0)return B}return O===D?0:O<D?-1:1}}catch{}return NaN}function Jo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=re(n))==="ArrayBuffer")?"binary":s}function $o(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ks(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}el.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Na=el;function el(n){this["@@propmod"]=n}function tl(n,s){for(var l=u(s),c=l.length,f=!1,p=0;p<c;++p){var g=l[p],b=s[g],I=ee(n,g);b instanceof Na?(F(n,g,b.execute(I)),f=!0):I!==b&&(F(n,g,b),f=!0)}return f}lt.prototype._trans=function(n,s,l){var c=this._tx||je.trans,f=this.name,p=mt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(q,R,E){if(E.schema[f])return s(E.idbtrans,E);throw new te.NotFound("Table "+f+" not part of transaction")}var b=_r();try{var I=c&&c.db._novip===this.db._novip?c===je.trans?c._promise(n,g,l):Cn(function(){return c._promise(n,g,l)},{trans:c,transless:je.transless||je}):(function q(R,E,O,D){if(R.idbdb&&(R._state.openComplete||je.letThrough||R._vip)){var P=R._createTransaction(E,O,R._dbSchema);try{P.create(),R._state.PR1398_maxLoop=3}catch(C){return C.name===Ue.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return q(R,E,O,D)})):ke(C)}return P._promise(E,function(C,B){return Cn(function(){return je.trans=P,D(C,B,P)})}).then(function(C){if(E==="readwrite")try{P.idbtrans.commit()}catch{}return E==="readonly"?C:P._completion.then(function(){return C})})}if(R._state.openComplete)return ke(new te.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return ke(new te.DatabaseClosed);R.open().catch(qe)}return R._state.dbReadyPromise.then(function(){return q(R,E,O,D)})})(this.db,n,[this.name],g);return p&&(I._consoleTask=p,I=I.catch(function(q){return console.trace(q),ke(q)})),I}finally{b&&nr()}},lt.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ke(new te.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},lt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(b){if(b.compound&&s.every(function(q){return 0<=b.keyPath.indexOf(q)})){for(var I=0;I<s.length;++I)if(s.indexOf(b.keyPath[I])===-1)return!1;return!0}return!1}).sort(function(b,I){return b.keyPath.length-I.keyPath.length})[0];if(l&&this.db._maxKey!==$e)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(b){return n[b]}));!l&&mt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(b,I){return Qe(b,I)===0}var g=s.reduce(function(R,I){var q=R[0],R=R[1],E=c[I],O=n[I];return[q||E,q||!E?ct(R,E&&E.multi?function(D){return D=ee(D,I),d(D)&&D.some(function(P){return f(O,P)})}:function(D){return f(O,ee(D,I))}):R]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},lt.prototype.filter=function(n){return this.toCollection().and(n)},lt.prototype.count=function(n){return this.toCollection().count(n)},lt.prototype.offset=function(n){return this.toCollection().offset(n)},lt.prototype.limit=function(n){return this.toCollection().limit(n)},lt.prototype.each=function(n){return this.toCollection().each(n)},lt.prototype.toArray=function(n){return this.toCollection().toArray(n)},lt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},lt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},lt.prototype.reverse=function(){return this.toCollection().reverse()},lt.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof Zo&&(n=(g=>{var b=R,I=g;if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function q(){this.constructor=b}function R(){return g!==null&&g.apply(this,arguments)||this}return r(b,I),b.prototype=I===null?Object.create(I):(q.prototype=I.prototype,new q),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),f=n.prototype;f;f=h(f))Object.getOwnPropertyNames(f).forEach(function(g){return c.add(g)});function p(g){if(!g)return g;var b,I=Object.create(n.prototype);for(b in g)if(!c.has(b))try{I[b]=g[b]}catch{}return I}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},lt.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},lt.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,g=n;return p&&f&&(g=zr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{F(n,p,b)}catch{}return b})},lt.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var g=p??{};return tl(g,s),c&&F(g,c,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):!!p})})})},lt.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=ee(n,this.schema.primKey.keyPath))===void 0?ke(new te.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},lt.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,g=n;return p&&f&&(g=zr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{F(n,p,b)}catch{}return b})},lt.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return ks(s,[n],c)}).then(function(c){return c.numFailures?Ae.reject(c.failures[0]):void 0})})},lt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:La}).then(function(l){return ks(n,null,l)})}).then(function(s){return s.numFailures?Ae.reject(s.failures[0]):void 0})},lt.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},lt.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var b=c.schema.primKey,q=b.auto,b=b.keyPath;if(b&&f)throw new te.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new te.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,q=b&&q?n.map(zr(b)):n;return c.core.mutate({trans:g,type:"add",keys:f,values:q,wantResults:p}).then(function(R){var E=R.numFailures,O=R.failures;if(E===0)return p?R.results:R.lastResult;throw new Te("".concat(c.name,".bulkAdd(): ").concat(E," of ").concat(I," operations failed"),O)})})},lt.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var b=c.schema.primKey,q=b.auto,b=b.keyPath;if(b&&f)throw new te.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new te.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,q=b&&q?n.map(zr(b)):n;return c.core.mutate({trans:g,type:"put",keys:f,values:q,wantResults:p}).then(function(R){var E=R.numFailures,O=R.failures;if(E===0)return p?R.results:R.lastResult;throw new Te("".concat(c.name,".bulkPut(): ").concat(E," of ").concat(I," operations failed"),O)})})},lt.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:c,cache:"clone"}).then(function(b){var I=[],q=[],R=(n.forEach(function(E,O){var D=E.key,P=E.changes,C=b[O];if(C){for(var B=0,U=Object.keys(P);B<U.length;B++){var N=U[B],Q=P[N];if(N===s.schema.primKey.keyPath){if(Qe(Q,D)!==0)throw new te.Constraint("Cannot update primary key in bulkUpdate()")}else F(C,N,Q)}p.push(O),I.push(D),q.push(C)}}),I.length);return l.mutate({trans:g,type:"put",keys:I,values:q,updates:{keys:c,changeSpecs:f}}).then(function(E){var O=E.numFailures,D=E.failures;if(O===0)return R;for(var P=0,C=Object.keys(D);P<C.length;P++){var B,U=C[P],N=p[Number(U)];N!=null&&(B=D[U],delete D[U],D[N]=B)}throw new Te("".concat(s.name,".bulkUpdate(): ").concat(O," of ").concat(R," operations failed"),D)})})})},lt.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return ks(s,n,f)})}).then(function(c){var f=c.numFailures,p=c.failures;if(f===0)return c.lastResult;throw new Te("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var nl=lt;function lt(){}function qa(n){function s(g,b){if(b){for(var I=arguments.length,q=new Array(I-1);--I;)q[I-1]=arguments[I];return l[g].subscribe.apply(null,q),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=p;for(var c=1,f=arguments.length;c<f;++c)p(arguments[c]);return s;function p(g,b,I){var q,R;if(typeof g!="object")return b=b||Gt,R={subscribers:[],fire:I=I||qe,subscribe:function(E){R.subscribers.indexOf(E)===-1&&(R.subscribers.push(E),R.fire=b(R.fire,E))},unsubscribe:function(E){R.subscribers=R.subscribers.filter(function(O){return O!==E}),R.fire=R.subscribers.reduce(b,I)}},l[g]=s[g]=R;u(q=g).forEach(function(E){var O=q[E];if(d(O))p(E,q[E][0],q[E][1]);else{if(O!=="asap")throw new te.InvalidArgument("Invalid event config");var D=p(E,Fe,function(){for(var P=arguments.length,C=new Array(P);P--;)C[P]=arguments[P];D.subscribers.forEach(function(B){Z(function(){B.apply(null,C)})})})}})}}function Ba(n,s){return L(s).from({prototype:n}),s}function ha(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function hi(n,s){n.filter=ct(n.filter,s)}function vi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return ct(c(),s())}:s,n.justLimit=l&&!c}function xs(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new te.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function rl(n,s,l){var c=xs(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function Ss(n,s,l,c){var f,p,g=n.replayFilter?ct(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(b,I,q){var R,E;g&&!g(I,q,function(O){return I.stop(O)},function(O){return I.fail(O)})||((E=""+(R=I.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(R)),x(f,E))||(f[E]=!0,s(b,I,q))},Promise.all([n.or._iterate(p,l),al(rl(n,c,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):al(rl(n,c,l),ct(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function al(n,s,l,c){var f=it(c?function(p,g,b){return l(c(p),g,b)}:l);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};s&&!s(p,function(b){return g=b},function(b){p.stop(b),g=qe},function(b){p.fail(b),g=qe})||f(p.value,p,function(b){return g=b}),g()})})}et.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ke.bind(null,l.error)):l.table._trans("readonly",n).then(s)},et.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ke.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},et.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=ct(s.algorithm,n)},et.prototype._iterate=function(n,s){return Ss(this._ctx,n,s,this._ctx.table.core)},et.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},et.prototype.raw=function(){return this._ctx.valueMapper=null,this},et.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Ss(s,n,l,s.table.core)})},et.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,p=f.table.core;return ha(f,!0)?p.count({trans:l,query:{index:xs(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(c=0,Ss(f,function(){return++c,!1},l,p).then(function(){return c}))}).then(n)},et.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function p(I,q){return q?p(I[l[q]],q-1):I[c]}var g=this._ctx.dir==="next"?1:-1;function b(I,q){return Qe(p(I,f),p(q,f))*g}return this.toArray(function(I){return I.sort(b)}).then(s)},et.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,p,g=s._ctx;return g.dir==="next"&&ha(g,!0)&&0<g.limit?(c=g.valueMapper,f=xs(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(b){return b=b.result,c?b.map(c):b})):(p=[],Ss(g,function(b){return p.push(b)},l,g.table.core).then(function(){return p}))},n)},et.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,ha(s)?vi(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):vi(s,function(){var l=n;return function(){return--l<0}})),this},et.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),vi(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},et.prototype.until=function(n,s){return hi(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},et.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},et.prototype.last=function(n){return this.reverse().first(n)},et.prototype.filter=function(n){var s;return hi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=ct(s.isMatch,n),this},et.prototype.and=function(n){return this.filter(n)},et.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},et.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},et.prototype.desc=function(){return this.reverse()},et.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},et.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},et.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},et.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},et.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&ha(s,!0)&&0<s.limit)return this._read(function(c){var f=xs(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},et.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},et.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},et.prototype.lastKey=function(n){return this.reverse().firstKey(n)},et.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},hi(this._ctx,function(c){var c=c.primaryKey.toString(),f=x(n,c);return n[c]=!0,!f})),this},et.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(C,B){var U=B.failures;O+=C-B.numFailures;for(var N=0,Q=u(U);N<Q.length;N++){var pe=Q[N];E.push(U[pe])}}var p=typeof n=="function"?n:function(C){return tl(C,n)},g=l.table.core,R=g.schema.primaryKey,b=R.outbound,I=R.extractKey,q=200,R=s.db._options.modifyChunkSize,E=(R&&(q=typeof R=="object"?R[g.name]||R["*"]||200:R),[]),O=0,D=[],P=n===sl;return s.clone().primaryKeys().then(function(C){function B(N){var Q=Math.min(q,C.length-N),pe=C.slice(N,N+Q);return(P?Promise.resolve([]):g.getMany({trans:c,keys:pe,cache:"immutable"})).then(function(xe){var Se=[],he=[],Oe=b?[]:null,Ce=P?pe:[];if(!P)for(var _e=0;_e<Q;++_e){var De=xe[_e],Ze={value:le(De),primKey:C[N+_e]};p.call(Ze,Ze.value,Ze)!==!1&&(Ze.value==null?Ce.push(C[N+_e]):b||Qe(I(De),I(Ze.value))===0?(he.push(Ze.value),b&&Oe.push(C[N+_e])):(Ce.push(C[N+_e]),Se.push(Ze.value)))}return Promise.resolve(0<Se.length&&g.mutate({trans:c,type:"add",values:Se}).then(function(tt){for(var ze in tt.failures)Ce.splice(parseInt(ze),1);f(Se.length,tt)})).then(function(){return(0<he.length||U&&typeof n=="object")&&g.mutate({trans:c,type:"put",keys:Oe,values:he,criteria:U,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<N}).then(function(tt){return f(he.length,tt)})}).then(function(){return(0<Ce.length||U&&P)&&g.mutate({trans:c,type:"delete",keys:Ce,criteria:U,isAdditionalChunk:0<N}).then(function(tt){return ks(l.table,Ce,tt)}).then(function(tt){return f(Ce.length,tt)})}).then(function(){return C.length>N+Q&&B(N+q)})})}var U=ha(l)&&l.limit===1/0&&(typeof n!="function"||P)&&{index:l.index,range:l.range};return B(0).then(function(){if(0<E.length)throw new Me("Error modifying one or more objects",E,O,D);return C.length})})})},et.prototype.delete=function(){var n=this._ctx,s=n.range;return!ha(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(sl):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(I){var b=I.failures,I=I.numFailures;if(I)throw new Me("Could not delete some values",Object.keys(b).map(function(q){return b[q]}),p-I);return p-I})})})};var Zu=et;function et(){}var sl=function(n,s){return s.value=null};function Ju(n,s){return n<s?-1:n===s?0:1}function $u(n,s){return s<n?-1:n===s?0:1}function rn(n,s,l){return n=n instanceof ol?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function va(n){return new n.Collection(n,function(){return il("")}).limit(0)}function Ts(D,s,l,c){var f,p,g,b,I,q,R,E=l.length;if(!l.every(function(C){return typeof C=="string"}))return rn(D,pt);function O(C){f=C==="next"?function(U){return U.toUpperCase()}:function(U){return U.toLowerCase()},p=C==="next"?function(U){return U.toLowerCase()}:function(U){return U.toUpperCase()},g=C==="next"?Ju:$u;var B=l.map(function(U){return{lower:p(U),upper:f(U)}}).sort(function(U,N){return g(U.lower,N.lower)});b=B.map(function(U){return U.upper}),I=B.map(function(U){return U.lower}),R=(q=C)==="next"?"":c}O("next");var D=new D.Collection(D,function(){return wr(b[0],I[E-1]+c)}),P=(D._ondirectionchange=function(C){O(C)},0);return D._addAlgorithm(function(C,B,U){var N=C.key;if(typeof N=="string"){var Q=p(N);if(s(Q,I,P))return!0;for(var pe=null,xe=P;xe<E;++xe){var Se=((he,Oe,Ce,_e,De,Ze)=>{for(var tt=Math.min(he.length,_e.length),ze=-1,Ge=0;Ge<tt;++Ge){var ht=Oe[Ge];if(ht!==_e[Ge])return De(he[Ge],Ce[Ge])<0?he.substr(0,Ge)+Ce[Ge]+Ce.substr(Ge+1):De(he[Ge],_e[Ge])<0?he.substr(0,Ge)+_e[Ge]+Ce.substr(Ge+1):0<=ze?he.substr(0,ze)+Oe[ze]+Ce.substr(ze+1):null;De(he[Ge],ht)<0&&(ze=Ge)}return tt<_e.length&&Ze==="next"?he+Ce.substr(he.length):tt<he.length&&Ze==="prev"?he.substr(0,Ce.length):ze<0?null:he.substr(0,ze)+_e[ze]+Ce.substr(ze+1)})(N,Q,b[xe],I[xe],g,q);Se===null&&pe===null?P=xe+1:(pe===null||0<g(pe,Se))&&(pe=Se)}B(pe!==null?function(){C.continue(pe+R)}:U)}return!1}),D}function wr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function il(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Ct.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ct.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?va(this):new this.Collection(this,function(){return wr(n,s,!l,!c)})}catch{return rn(this,ot)}},Ct.prototype.equals=function(n){return n==null?rn(this,ot):new this.Collection(this,function(){return il(n)})},Ct.prototype.above=function(n){return n==null?rn(this,ot):new this.Collection(this,function(){return wr(n,void 0,!0)})},Ct.prototype.aboveOrEqual=function(n){return n==null?rn(this,ot):new this.Collection(this,function(){return wr(n,void 0,!1)})},Ct.prototype.below=function(n){return n==null?rn(this,ot):new this.Collection(this,function(){return wr(void 0,n,!1,!0)})},Ct.prototype.belowOrEqual=function(n){return n==null?rn(this,ot):new this.Collection(this,function(){return wr(void 0,n)})},Ct.prototype.startsWith=function(n){return typeof n!="string"?rn(this,pt):this.between(n,n+$e,!0,!0)},Ct.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ts(this,function(s,l){return s.indexOf(l[0])===0},[n],$e)},Ct.prototype.equalsIgnoreCase=function(n){return Ts(this,function(s,l){return s===l[0]},[n],"")},Ct.prototype.anyOfIgnoreCase=function(){var n=ve.apply(oe,arguments);return n.length===0?va(this):Ts(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Ct.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(oe,arguments);return n.length===0?va(this):Ts(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,$e)},Ct.prototype.anyOf=function(){var n,s,l=this,c=ve.apply(oe,arguments),f=this._cmp;try{c.sort(f)}catch{return rn(this,ot)}return c.length===0?va(this):((n=new this.Collection(this,function(){return wr(c[0],c[c.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(p,g,b){for(var I=p.key;0<f(I,c[s]);)if(++s===c.length)return g(b),!1;return f(I,c[s])===0||(g(function(){p.continue(c[s])}),!1)}),n)},Ct.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ct.prototype.noneOf=function(){var n=ve.apply(oe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return rn(this,ot)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Ct.prototype.inAnyRange=function(n,U){var l=this,c=this._cmp,f=this._ascending,p=this._descending,g=this._min,b=this._max;if(n.length===0)return va(this);if(!n.every(function(N){return N[0]!==void 0&&N[1]!==void 0&&f(N[0],N[1])<=0}))return rn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",te.InvalidArgument);var I=!U||U.includeLowers!==!1,q=U&&U.includeUppers===!0,R,E=f;function O(N,Q){return E(N[0],Q[0])}try{(R=n.reduce(function(N,Q){for(var pe=0,xe=N.length;pe<xe;++pe){var Se=N[pe];if(c(Q[0],Se[1])<0&&0<c(Q[1],Se[0])){Se[0]=g(Se[0],Q[0]),Se[1]=b(Se[1],Q[1]);break}}return pe===xe&&N.push(Q),N},[])).sort(O)}catch{return rn(this,ot)}var D=0,P=q?function(N){return 0<f(N,R[D][1])}:function(N){return 0<=f(N,R[D][1])},C=I?function(N){return 0<p(N,R[D][0])}:function(N){return 0<=p(N,R[D][0])},B=P,U=new this.Collection(this,function(){return wr(R[0][0],R[R.length-1][1],!I,!q)});return U._ondirectionchange=function(N){E=N==="next"?(B=P,f):(B=C,p),R.sort(O)},U._addAlgorithm(function(N,Q,pe){for(var xe,Se=N.key;B(Se);)if(++D===R.length)return Q(pe),!1;return!P(xe=Se)&&!C(xe)||(l._cmp(Se,R[D][1])===0||l._cmp(Se,R[D][0])===0||Q(function(){E===f?N.continue(R[D][0]):N.continue(R[D][1])}),!1)}),U},Ct.prototype.startsWithAnyOf=function(){var n=ve.apply(oe,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?va(this):this.inAnyRange(n.map(function(s){return[s,s+$e]})):rn(this,"startsWithAnyOf() only works with strings")};var ol=Ct;function Ct(){}function Un(n){return it(function(s){return za(s),n(s.target.error),!1})}function za(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Fa="storagemutated",gi="x-storagemutated-1",kr=qa(null,Fa),ef=(Gn.prototype._lock=function(){return W(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},Gn.prototype._unlock=function(){if(W(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Le(n[1],n[0])}catch{}}return this},Gn.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},Gn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(W(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new te.DatabaseClosed(c);case"MissingAPIError":throw new te.MissingAPI(c.message,c);default:throw new te.OpenFailed(c)}if(!this.active)throw new te.TransactionInactive;W(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=it(function(f){za(f),s._reject(n.error)}),n.onabort=it(function(f){za(f),s.active&&s._reject(new te.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=it(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&kr.storagemutated.fire(n.mutatedParts)})}return this},Gn.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?ke(new te.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ae(function(p,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,g)},je])}):l?Cn(function(){var p=new Ae(function(g,b){f._lock();var I=s(g,b,f);I&&I.then&&I.then(g,b)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((c=new Ae(function(p,g){var b=s(p,g,f);b&&b.then&&b.then(p,g)}))._lib=!0,c):ke(new te.TransactionInactive)},Gn.prototype._root=function(){return this.parent?this.parent._root():this},Gn.prototype.waitFor=function(n){var s,l=this._root(),c=Ae.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ae(function(p,g){c.then(function(b){return l._waitingQueue.push(it(p.bind(null,b)))},function(b){return l._waitingQueue.push(it(g.bind(null,b)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Gn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new te.Abort))},Gn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(x(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new te.NotFound("Table "+n+" not part of transaction")},Gn);function Gn(){}function mi(n,s,l,c,f,p,g,b){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:p,src:(l&&!g?"&":"")+(c?"*":"")+(f?"++":"")+ll(s),type:b}}function ll(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function yi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,p,g){return p=c(p,g),p&&(f[p[0]]=p[1]),f},{}))};var c}var Ka=function(n){try{return n.only([[]]),Ka=function(){return[[]]},[[]]}catch{return Ka=function(){return $e},$e}};function bi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return ee(l,s)}:function(l){return ee(l,n)};var s}function cl(n){return[].slice.call(n)}var tf=0;function Ua(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function nf(n,s,I){function c(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=P.lower,O=P.upper,D=P.lowerOpen,P=P.upperOpen;return E===void 0?O===void 0?null:s.upperBound(O,!!P):O===void 0?s.lowerBound(E,!!D):s.bound(E,O,!!D,!!P)}function f(R){var E,O=R.name;return{name:O,schema:R,mutate:function(D){var P=D.trans,C=D.type,B=D.keys,U=D.values,N=D.range;return new Promise(function(Q,pe){Q=it(Q);var xe=P.objectStore(O),Se=xe.keyPath==null,he=C==="put"||C==="add";if(!he&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var Oe,Ce=(B||U||{length:1}).length;if(B&&U&&B.length!==U.length)throw new Error("Given keys array must have same length as given values array.");if(Ce===0)return Q({numFailures:0,failures:{},results:[],lastResult:void 0});function _e(gt){++tt,za(gt)}var De=[],Ze=[],tt=0;if(C==="deleteRange"){if(N.type===4)return Q({numFailures:tt,failures:Ze,results:[],lastResult:void 0});N.type===3?De.push(Oe=xe.clear()):De.push(Oe=xe.delete(c(N)))}else{var Se=he?Se?[U,B]:[U,null]:[B,null],ze=Se[0],Ge=Se[1];if(he)for(var ht=0;ht<Ce;++ht)De.push(Oe=Ge&&Ge[ht]!==void 0?xe[C](ze[ht],Ge[ht]):xe[C](ze[ht])),Oe.onerror=_e;else for(ht=0;ht<Ce;++ht)De.push(Oe=xe[C](ze[ht])),Oe.onerror=_e}function mn(gt){gt=gt.target.result,De.forEach(function(Ur,Ni){return Ur.error!=null&&(Ze[Ni]=Ur.error)}),Q({numFailures:tt,failures:Ze,results:C==="delete"?B:De.map(function(Ur){return Ur.result}),lastResult:gt})}Oe.onerror=function(gt){_e(gt),mn(gt)},Oe.onsuccess=mn})},getMany:function(D){var P=D.trans,C=D.keys;return new Promise(function(B,U){B=it(B);for(var N,Q=P.objectStore(O),pe=C.length,xe=new Array(pe),Se=0,he=0,Oe=function(De){De=De.target,xe[De._pos]=De.result,++he===Se&&B(xe)},Ce=Un(U),_e=0;_e<pe;++_e)C[_e]!=null&&((N=Q.get(C[_e]))._pos=_e,N.onsuccess=Oe,N.onerror=Ce,++Se);Se===0&&B(xe)})},get:function(D){var P=D.trans,C=D.key;return new Promise(function(B,U){B=it(B);var N=P.objectStore(O).get(C);N.onsuccess=function(Q){return B(Q.target.result)},N.onerror=Un(U)})},query:(E=b,function(D){return new Promise(function(P,C){P=it(P);var B,U,N,he=D.trans,Q=D.values,pe=D.limit,Se=D.query,xe=pe===1/0?void 0:pe,Oe=Se.index,Se=Se.range,he=he.objectStore(O),he=Oe.isPrimaryKey?he:he.index(Oe.name),Oe=c(Se);if(pe===0)return P({result:[]});E?((Se=Q?he.getAll(Oe,xe):he.getAllKeys(Oe,xe)).onsuccess=function(Ce){return P({result:Ce.target.result})},Se.onerror=Un(C)):(B=0,U=!Q&&"openKeyCursor"in he?he.openKeyCursor(Oe):he.openCursor(Oe),N=[],U.onsuccess=function(Ce){var _e=U.result;return!_e||(N.push(Q?_e.value:_e.primaryKey),++B===pe)?P({result:N}):void _e.continue()},U.onerror=Un(C))})}),openCursor:function(D){var P=D.trans,C=D.values,B=D.query,U=D.reverse,N=D.unique;return new Promise(function(Q,pe){Q=it(Q);var he=B.index,xe=B.range,Se=P.objectStore(O),Se=he.isPrimaryKey?Se:Se.index(he.name),he=U?N?"prevunique":"prev":N?"nextunique":"next",Oe=!C&&"openKeyCursor"in Se?Se.openKeyCursor(c(xe),he):Se.openCursor(c(xe),he);Oe.onerror=Un(pe),Oe.onsuccess=it(function(Ce){var _e,De,Ze,tt,ze=Oe.result;ze?(ze.___id=++tf,ze.done=!1,_e=ze.continue.bind(ze),De=(De=ze.continuePrimaryKey)&&De.bind(ze),Ze=ze.advance.bind(ze),tt=function(){throw new Error("Cursor not stopped")},ze.trans=P,ze.stop=ze.continue=ze.continuePrimaryKey=ze.advance=function(){throw new Error("Cursor not started")},ze.fail=it(pe),ze.next=function(){var Ge=this,ht=1;return this.start(function(){return ht--?Ge.continue():Ge.stop()}).then(function(){return Ge})},ze.start=function(Ge){function ht(){if(Oe.result)try{Ge()}catch(gt){ze.fail(gt)}else ze.done=!0,ze.start=function(){throw new Error("Cursor behind last entry")},ze.stop()}var mn=new Promise(function(gt,Ur){gt=it(gt),Oe.onerror=Un(Ur),ze.fail=Ur,ze.stop=function(Ni){ze.stop=ze.continue=ze.continuePrimaryKey=ze.advance=tt,gt(Ni)}});return Oe.onsuccess=it(function(gt){Oe.onsuccess=ht,ht()}),ze.continue=_e,ze.continuePrimaryKey=De,ze.advance=Ze,ht(),mn},Q(ze)):Q(null)},pe)})},count:function(D){var P=D.query,C=D.trans,B=P.index,U=P.range;return new Promise(function(N,Q){var pe=C.objectStore(O),pe=B.isPrimaryKey?pe:pe.index(B.name),xe=c(U),xe=xe?pe.count(xe):pe.count();xe.onsuccess=it(function(Se){return N(Se.target.result)}),xe.onerror=Un(Q)})}}}p=I,g=cl((I=n).objectStoreNames);var p,I={schema:{name:I.name,tables:g.map(function(R){return p.objectStore(R)}).map(function(R){var E=R.keyPath,O=R.autoIncrement,P=d(E),D={},P={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:P,keyPath:E,autoIncrement:O,unique:!0,extractKey:bi(E)},indexes:cl(R.indexNames).map(function(C){return R.index(C)}).map(function(N){var Q=N.name,B=N.unique,U=N.multiEntry,N=N.keyPath,Q={name:Q,compound:d(N),keyPath:N,unique:B,multiEntry:U,extractKey:bi(N)};return D[Ua(N)]=Q}),getIndexByKeyPath:function(C){return D[Ua(C)]}};return D[":id"]=P.primaryKey,E!=null&&(D[Ua(E)]=P.primaryKey),P})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=I.schema,b=I.hasGetAll,I=g.tables.map(f),q={};return I.forEach(function(R){return q[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(q[R])return q[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ka(s),schema:g}}function rf(n,s,l,c){return l=l.IDBKeyRange,s=nf(s,l,c),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function Es(n,s){var l=s.db,l=rf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(p){return p.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function As(n,s,l,c){l.forEach(function(f){var p=c[f];s.forEach(function(g){var b=(function I(q,R){return T(q,R)||(q=h(q))&&I(q,R)})(g,f);(!b||"value"in b&&b.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?j(g,f,{get:function(){return this.table(f)},set:function(I){w(this,f,{value:I,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function _i(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function af(n,s){return n._cfg.version-s._cfg.version}function sf(n,s,l,c){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=yi("$meta",fl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(l),p._completion.catch(c),p._reject.bind(p)),b=je.transless||je;Cn(function(){if(je.trans=p,je.transless=b,s!==0)return Es(n,l),q=s,((I=p).storeNames.includes("$meta")?I.table("$meta").get("version").then(function(R){return R??q}):Ae.resolve(q)).then(function(B){var E=n,O=B,D=p,P=l,C=[],B=E._versions,U=E._dbSchema=Is(0,E.idbdb,P);return(B=B.filter(function(N){return N._cfg.version>=O})).length===0?Ae.resolve():(B.forEach(function(N){C.push(function(){var Q,pe,xe,Se=U,he=N._cfg.dbschema,Oe=(Rs(E,Se,P),Rs(E,he,P),U=E._dbSchema=he,wi(Se,he)),Ce=(Oe.add.forEach(function(_e){ki(P,_e[0],_e[1].primKey,_e[1].indexes)}),Oe.change.forEach(function(_e){if(_e.recreate)throw new te.Upgrade("Not yet support for changing primary key");var De=P.objectStore(_e.name);_e.add.forEach(function(Ze){return Cs(De,Ze)}),_e.change.forEach(function(Ze){De.deleteIndex(Ze.name),Cs(De,Ze)}),_e.del.forEach(function(Ze){return De.deleteIndex(Ze)})}),N._cfg.contentUpgrade);if(Ce&&N._cfg.version>O)return Es(E,P),D._memoizedTables={},Q=ce(he),Oe.del.forEach(function(_e){Q[_e]=Se[_e]}),_i(E,[E.Transaction.prototype]),As(E,[E.Transaction.prototype],u(Q),Q),D.schema=Q,(pe=we(Ce))&&zt(),he=Ae.follow(function(){var _e;(xe=Ce(D))&&pe&&(_e=In.bind(null,null),xe.then(_e,_e))}),xe&&typeof xe.then=="function"?Ae.resolve(xe):he.then(function(){return xe})}),C.push(function(Q){var pe,xe,Se=N._cfg.dbschema;pe=Se,xe=Q,[].slice.call(xe.db.objectStoreNames).forEach(function(he){return pe[he]==null&&xe.db.deleteObjectStore(he)}),_i(E,[E.Transaction.prototype]),As(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),D.schema=E._dbSchema}),C.push(function(Q){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===N._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(pe){return pe!=="$meta"})):Q.objectStore("$meta").put(N._cfg.version,"version"))})}),(function N(){return C.length?Ae.resolve(C.shift()(D.idbtrans)).then(N):Ae.resolve()})().then(function(){ul(U,P)}))}).catch(g);var I,q;u(f).forEach(function(R){ki(l,R,f[R].primKey,f[R].indexes)}),Es(n,l),Ae.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function of(n,s){ul(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Is(0,n.idbdb,s);Rs(n,n._dbSchema,s);for(var c=0,f=wi(l,n._dbSchema).change;c<f.length;c++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=s.objectStore(g.name);g.add.forEach(function(I){mt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(I.src)),Cs(b,I)})})(f[c]);if(typeof p=="object")return p.value}}function wi(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var g={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,c.change.push(g);else{var b=f.idxByName,I=p.idxByName,q=void 0;for(q in b)I[q]||g.del.push(q);for(q in I){var R=b[q],E=I[q];R?R.src!==E.src&&g.change.push(E):g.add.push(E)}(0<g.del.length||0<g.add.length||0<g.change.length)&&c.change.push(g)}}else c.add.push([l,p])}return c}function ki(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(p){return Cs(f,p)})}function ul(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(mt&&console.debug("Dexie: Creating missing table",l),ki(s,l,n[l].primKey,n[l].indexes))})}function Cs(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Is(n,s,l){var c={};return ae(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),g=mi(ll(q=p.keyPath),q||"",!0,!1,!!p.autoIncrement,q&&typeof q!="string",!0),b=[],I=0;I<p.indexNames.length;++I){var R=p.index(p.indexNames[I]),q=R.keyPath,R=mi(R.name,q,!!R.unique,!!R.multiEntry,!1,q&&typeof q!="string",!1);b.push(R)}c[f]=yi(f,g,b)}),c}function Rs(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var p=c[f],g=l.objectStore(p);n._hasGetAll="getAll"in g;for(var b=0;b<g.indexNames.length;++b){var I,q=g.indexNames[b],R=g.index(q).keyPath,R=typeof R=="string"?R:"["+ae(R).join("+")+"]";s[p]&&(I=s[p].idxByName[R])&&(I.name=q,delete s[p].idxByName[R],s[p].idxByName[q]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function fl(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return mi(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,c)})}ga.prototype._createTableSchema=yi,ga.prototype._parseIndexSyntax=fl,ga.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),p=f.shift();if(!p)throw new te.Schema("Invalid schema for table "+c+": "+n[c]);if(p.unique=!0,p.multi)throw new te.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new te.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new te.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(c,p,f),s[c]=p}})},ga.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(p){v(c,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(c,f)}),s._dbSchema=f,_i(s,[s._allTables,s,s.Transaction.prototype]),As(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},ga.prototype.upgrade=function(n){return this._cfg.contentUpgrade=kt(this._cfg.contentUpgrade||qe,n),this};var lf=ga;function ga(){}function xi(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new rr(Xt,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Si(n){return n&&typeof n.databases=="function"}function Ti(n){return Cn(function(){return je.letThrough=!0,n()})}function Ei(n){return!("from"in n)}var Ft=function(n,s){var l;if(!this)return l=new Ft,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ga(n,s,l){var c=Qe(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Ei(n))return v(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(Qe(l,n.from)<0)return c?Ga(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},pl(n);if(0<Qe(s,n.to))return f?Ga(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},pl(n);Qe(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Qe(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Ha(n,c),f&&s&&Ha(n,f)}}function Ha(n,s){Ei(s)||(function l(c,f){var p=f.from,g=f.l,b=f.r;Ga(c,p,f.to),g&&l(c,g),b&&l(c,b)})(n,s)}function dl(n,s){var l=Ps(s),c=l.next();if(!c.done)for(var f=c.value,p=Ps(n),g=p.next(f.from),b=g.value;!c.done&&!g.done;){if(Qe(b.from,f.to)<=0&&0<=Qe(b.to,f.from))return!0;Qe(f.from,b.from)<0?f=(c=l.next(b.from)).value:b=(g=p.next(f.from)).value}return!1}function Ps(n){var s=Ei(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&Qe(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||Qe(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function pl(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=hl(l)),n.d=hl(n)}function hl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Os(n,s){return u(s).forEach(function(l){n[l]?Ha(n[l],s[l]):n[l]=(function c(f){var p,g,b={};for(p in f)x(f,p)&&(g=f[p],b[p]=!g||typeof g!="object"||ge.has(g.constructor)?g:c(g));return b})(s[l])}),n}function Ai(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&dl(s[l],n[l])})}k(Ft.prototype,((xt={add:function(n){return Ha(this,n),this},addKey:function(n){return Ga(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ga(s,l,l)}),this},hasKey:function(n){var s=Ps(this).next(n).value;return s&&Qe(s.from,n)<=0&&0<=Qe(s.to,n)}})[fe]=function(){return Ps(this)},xt));var Fr={},Ci={},Ii=!1;function Ds(n){Os(Ci,n),Ii||(Ii=!0,setTimeout(function(){Ii=!1,Ri(Ci,!(Ci={}))},0))}function Ri(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values(Fr);c<f.length;c++)vl(b=f[c],n,l,s);else for(var p in n){var g,b,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],b=Fr["idb://".concat(g,"/").concat(p)])&&vl(b,n,l,s)}l.forEach(function(I){return I()})}function vl(n,s,l,c){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var b=g[p],I=b[0],q=[],R=0,E=b[1];R<E.length;R++){var O=E[R];Ai(s,O.obsSet)?O.subscribers.forEach(function(B){return l.add(B)}):c&&q.push(O)}c&&f.push([I,q])}if(c)for(var D=0,P=f;D<P.length;D++){var C=P[D],I=C[0],q=C[1];n.queries.query[I]=q}}function cf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ke(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(s.openCanceller!==c)throw new te.DatabaseClosed("db.open() was cancelled")}function b(){return new Ae(function(O,D){if(g(),!l)throw new te.MissingAPI;var P=n.name,C=s.autoSchema||!f?l.open(P):l.open(P,f);if(!C)throw new te.MissingAPI;C.onerror=Un(D),C.onblocked=it(n._fireOnBlocked),C.onupgradeneeded=it(function(B){var U;R=C.transaction,s.autoSchema&&!n._options.allowEmptyDB?(C.onerror=za,R.abort(),C.result.close(),(U=l.deleteDatabase(P)).onsuccess=U.onerror=it(function(){D(new te.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(R.onerror=Un(D),U=B.oldVersion>Math.pow(2,62)?0:B.oldVersion,E=U<1,n.idbdb=C.result,p&&of(n,R),sf(n,U/10,R,D))},D),C.onsuccess=it(function(){R=null;var B,U,N,Q,pe,xe,Se=n.idbdb=C.result,he=ae(Se.objectStoreNames);if(0<he.length)try{var Oe=Se.transaction((pe=he).length===1?pe[0]:pe,"readonly");if(s.autoSchema)xe=Se,Q=Oe,(N=n).verno=xe.version/10,Q=N._dbSchema=Is(0,xe,Q),N._storeNames=ae(xe.objectStoreNames,0),As(N,[N._allTables],u(Q),Q);else if(Rs(n,n._dbSchema,Oe),U=Oe,((U=wi(Is(0,(B=n).idbdb,U),B._dbSchema)).add.length||U.change.some(function(Ce){return Ce.add.length||Ce.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Se.close(),f=Se.version+1,p=!0,O(b());Es(n,Oe)}catch{}bt.push(n),Se.onversionchange=it(function(Ce){s.vcFired=!0,n.on("versionchange").fire(Ce)}),Se.onclose=it(function(){n.close({disableAutoOpen:!1})}),E&&(he=n._deps,pe=P,Si(xe=he.indexedDB)||pe===Xt||xi(xe,he.IDBKeyRange).put({name:pe}).catch(qe)),O()},D)}).catch(function(O){switch(O==null?void 0:O.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(0<f)return f=0,b()}return Ae.reject(O)})}var I,q=s.dbReadyResolve,R=null,E=!1;return Ae.race([c,(typeof navigator>"u"?Ae.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function D(){return indexedDB.databases().finally(O)}I=setInterval(D,100),D()}).finally(function(){return clearInterval(I)}):Promise.resolve()).then(b)]).then(function(){return g(),s.onReadyBeingFired=[],Ae.resolve(Ti(function(){return n.on.ready.fire(n.vip)})).then(function O(){var D;if(0<s.onReadyBeingFired.length)return D=s.onReadyBeingFired.reduce(kt,qe),s.onReadyBeingFired=[],Ae.resolve(Ti(function(){return D(n.vip)})).then(O)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(O){s.dbOpenError=O;try{R&&R.abort()}catch{}return c===s.openCanceller&&n._close(),ke(O)}).finally(function(){s.openComplete=!0,q()}).then(function(){var O;return E&&(O={},n.tables.forEach(function(D){D.schema.indexes.forEach(function(P){P.name&&(O["idb://".concat(n.name,"/").concat(D.name,"/").concat(P.name)]=new Ft(-1/0,[[[]]]))}),O["idb://".concat(n.name,"/").concat(D.name,"/")]=O["idb://".concat(n.name,"/").concat(D.name,"/:dels")]=new Ft(-1/0,[[[]]])}),kr(Fa).fire(O),Ri(O,!0)),n})}function Pi(n){function s(p){return n.next(p)}var l=f(s),c=f(function(p){return n.throw(p)});function f(p){return function(b){var b=p(b),I=b.value;return b.done?I:I&&typeof I.then=="function"?I.then(l,c):d(I)?Promise.all(I).then(l,c):l(I)}}return f(s)()}function js(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var uf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},p=[];function g(O,D,P){var N=Ua(O),C=f[N]=f[N]||[],B=O==null?0:typeof O=="string"?1:O.length,U=0<D,N=a(a({},P),{name:U?"".concat(N,"(virtual-from:").concat(P.name,")"):P.name,lowLevelIndex:P,isVirtual:U,keyTail:D,keyLength:B,extractKey:bi(O),unique:!U&&P.unique});return C.push(N),N.isPrimaryKey||p.push(N),1<B&&g(B===2?O[0]:O.slice(0,B-1),D+1,P),C.sort(function(Q,pe){return Q.keyTail-pe.keyTail}),N}var b=g(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[b];for(var I=0,q=c.indexes;I<q.length;I++){var R=q[I];g(R.keyPath,0,R)}function E(O){var D,P=O.query.index;return P.isVirtual?a(a({},O),{query:{index:P.lowLevelIndex,range:(D=O.query.range,P=P.keyTail,{type:D.type===1?2:D.type,lower:js(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,P),lowerOpen:!0,upper:js(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,P),upperOpen:!0})}}):O}return a(a({},l),{schema:a(a({},c),{primaryKey:b,indexes:p,getIndexByKeyPath:function(O){return(O=f[Ua(O)])&&O[0]}}),count:function(O){return l.count(E(O))},query:function(O){return l.query(E(O))},openCursor:function(O){var D=O.query.index,P=D.keyTail,C=D.keyLength;return D.isVirtual?l.openCursor(E(O)).then(function(U){return U&&B(U)}):l.openCursor(O);function B(U){return Object.create(U,{continue:{value:function(N){N!=null?U.continue(js(N,O.reverse?n.MAX_KEY:n.MIN_KEY,P)):O.unique?U.continue(U.key.slice(0,C).concat(O.reverse?n.MIN_KEY:n.MAX_KEY,P)):U.continue()}},continuePrimaryKey:{value:function(N,Q){U.continuePrimaryKey(js(N,n.MAX_KEY,P),Q)}},primaryKey:{get:function(){return U.primaryKey}},key:{get:function(){var N=U.key;return C===1?N[0]:N.slice(0,C)}},value:{get:function(){return U.value}}})}}})}})}};function Oi(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var p,g,b;x(s,f)?(p=n[f],g=s[f],typeof p=="object"&&typeof g=="object"&&p&&g?(b=re(p))!==re(g)?l[c+f]=s[f]:b==="Object"?Oi(p,g,l,c+f+"."):p!==g&&(l[c+f]=s[f]):p!==g&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){x(n,f)||(l[c+f]=s[f])}),l}function Di(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var ff={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=je.trans,g=p.table(s).hook,b=g.deleting,I=g.creating,q=g.updating;switch(f.type){case"add":if(I.fire===qe)break;return p._promise("readwrite",function(){return R(f)},!0);case"put":if(I.fire===qe&&q.fire===qe)break;return p._promise("readwrite",function(){return R(f)},!0);case"delete":if(b.fire===qe)break;return p._promise("readwrite",function(){return R(f)},!0);case"deleteRange":if(b.fire===qe)break;return p._promise("readwrite",function(){return(function E(O,D,P){return l.query({trans:O,values:!1,query:{index:c,range:D},limit:P}).then(function(C){var B=C.result;return R({type:"delete",keys:B,trans:O}).then(function(U){return 0<U.numFailures?Promise.reject(U.failures[0]):B.length<P?{failures:[],numFailures:0,lastResult:void 0}:E(O,a(a({},D),{lower:B[B.length-1],lowerOpen:!0}),P)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function R(E){var O,D,P,C=je.trans,B=E.keys||Di(c,E);if(B)return(E=E.type==="add"||E.type==="put"?a(a({},E),{keys:B}):a({},E)).type!=="delete"&&(E.values=i([],E.values)),E.keys&&(E.keys=i([],E.keys)),O=l,P=B,((D=E).type==="add"?Promise.resolve([]):O.getMany({trans:D.trans,keys:P,cache:"immutable"})).then(function(U){var N=B.map(function(Q,pe){var xe,Se,he,Oe=U[pe],Ce={onerror:null,onsuccess:null};return E.type==="delete"?b.fire.call(Ce,Q,Oe,C):E.type==="add"||Oe===void 0?(xe=I.fire.call(Ce,Q,E.values[pe],C),Q==null&&xe!=null&&(E.keys[pe]=Q=xe,c.outbound||F(E.values[pe],c.keyPath,Q))):(xe=Oi(Oe,E.values[pe]),(Se=q.fire.call(Ce,xe,Q,Oe,C))&&(he=E.values[pe],Object.keys(Se).forEach(function(_e){x(he,_e)?he[_e]=Se[_e]:F(he,_e,Se[_e])}))),Ce});return l.mutate(E).then(function(Q){for(var pe=Q.failures,xe=Q.results,Se=Q.numFailures,Q=Q.lastResult,he=0;he<B.length;++he){var Oe=(xe||B)[he],Ce=N[he];Oe==null?Ce.onerror&&Ce.onerror(pe[he]):Ce.onsuccess&&Ce.onsuccess(E.type==="put"&&U[he]?E.values[he]:Oe)}return{failures:pe,results:xe,numFailures:Se,lastResult:Q}}).catch(function(Q){return N.forEach(function(pe){return pe.onerror&&pe.onerror(Q)}),Promise.reject(Q)})});throw new Error("Keys missing")}}})}})}};function gl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)Qe(s.keys[f],n[p])===0&&(c.push(l?le(s.values[f]):s.values[f]),++p);return c.length===n.length?c:null}catch{return null}}var df={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=gl(c.keys,c.trans._cache,c.cache==="clone"))?Ae.resolve(f):l.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?le(p):p},p}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function ml(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function yl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var pf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Ft(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,p){if(je.subscr&&f!=="readonly")throw new te.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return n.transaction(c,f,p)},table:function(c){function f(B){var C,B=B.query;return[C=B.index,new Ft((C=(B=B.range).lower)!=null?C:n.MIN_KEY,(C=B.upper)!=null?C:n.MAX_KEY)]}var p=n.table(c),g=p.schema,b=g.primaryKey,I=g.indexes,q=b.extractKey,R=b.outbound,E=b.autoIncrement&&I.filter(function(P){return P.compound&&P.keyPath.includes(b.keyPath)}),O=a(a({},p),{mutate:function(P){function C(De){return De="idb://".concat(s,"/").concat(c,"/").concat(De),pe[De]||(pe[De]=new Ft)}var B,U,N,Q=P.trans,pe=P.mutatedParts||(P.mutatedParts={}),xe=C(""),Se=C(":dels"),he=P.type,Ce=P.type==="deleteRange"?[P.range]:P.type==="delete"?[P.keys]:P.values.length<50?[Di(b,P).filter(function(De){return De}),P.values]:[],Oe=Ce[0],Ce=Ce[1],_e=P.trans._cache;return d(Oe)?(xe.addKeys(Oe),(he=he==="delete"||Oe.length===Ce.length?gl(Oe,_e):null)||Se.addKeys(Oe),(he||Ce)&&(B=C,U=he,N=Ce,g.indexes.forEach(function(De){var Ze=B(De.name||"");function tt(Ge){return Ge!=null?De.extractKey(Ge):null}function ze(Ge){De.multiEntry&&d(Ge)?Ge.forEach(function(ht){return Ze.addKey(ht)}):Ze.addKey(Ge)}(U||N).forEach(function(Ge,gt){var mn=U&&tt(U[gt]),gt=N&&tt(N[gt]);Qe(mn,gt)!==0&&(mn!=null&&ze(mn),gt!=null)&&ze(gt)})}))):Oe?(Ce={from:(_e=Oe.lower)!=null?_e:n.MIN_KEY,to:(he=Oe.upper)!=null?he:n.MAX_KEY},Se.add(Ce),xe.add(Ce)):(xe.add(l),Se.add(l),g.indexes.forEach(function(De){return C(De.name).add(l)})),p.mutate(P).then(function(De){return!Oe||P.type!=="add"&&P.type!=="put"||(xe.addKeys(De.results),E&&E.forEach(function(Ze){for(var tt=P.values.map(function(mn){return Ze.extractKey(mn)}),ze=Ze.keyPath.findIndex(function(mn){return mn===b.keyPath}),Ge=0,ht=De.results.length;Ge<ht;++Ge)tt[Ge][ze]=De.results[Ge];C(Ze.name).addKeys(tt)})),Q.mutatedParts=Os(Q.mutatedParts||{},pe),De})}}),D={get:function(P){return[b,new Ft(P.key)]},getMany:function(P){return[b,new Ft().addKeys(P.keys)]},count:f,query:f,openCursor:f};return u(D).forEach(function(P){O[P]=function(C){var B=je.subscr,U=!!B,N=ml(je,p)&&yl(P,C)?C.obsSet={}:B;if(U){var Q,B=function(Ce){return Ce="idb://".concat(s,"/").concat(c,"/").concat(Ce),N[Ce]||(N[Ce]=new Ft)},pe=B(""),xe=B(":dels"),U=D[P](C),Se=U[0],U=U[1];if((P==="query"&&Se.isPrimaryKey&&!C.values?xe:B(Se.name||"")).add(U),!Se.isPrimaryKey){if(P!=="count")return Q=P==="query"&&R&&C.values&&p.query(a(a({},C),{values:!1})),p[P].apply(this,arguments).then(function(Ce){if(P==="query"){if(R&&C.values)return Q.then(function(tt){return tt=tt.result,pe.addKeys(tt),Ce});var _e=C.values?Ce.result.map(q):Ce.result;(C.values?pe:xe).addKeys(_e)}else{var De,Ze;if(P==="openCursor")return Ze=C.values,(De=Ce)&&Object.create(De,{key:{get:function(){return xe.addKey(De.primaryKey),De.key}},primaryKey:{get:function(){var tt=De.primaryKey;return xe.addKey(tt),tt}},value:{get:function(){return Ze&&pe.addKey(De.primaryKey),De.value}}})}return Ce});xe.add(l)}}return p[P].apply(this,arguments)}}),O}})}};function bl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,p){return!(p in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,p){return!(p in l.failures)})),c)}function ji(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<Qe(l,c.lower):0<=Qe(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?Qe(l,c.upper)<0:Qe(l,c.upper)<=0));var l,c}function _l(n,s,l,c,f,p){var g,b,I,q,R,E;return!l||l.length===0||(g=s.query.index,b=g.multiEntry,I=s.query.range,q=c.schema.primaryKey.extractKey,R=g.extractKey,E=(g.lowLevelIndex||g).extractKey,(c=l.reduce(function(O,D){var P=O,C=[];if(D.type==="add"||D.type==="put")for(var B=new Ft,U=D.values.length-1;0<=U;--U){var N,Q=D.values[U],pe=q(Q);!B.hasKey(pe)&&(N=R(Q),b&&d(N)?N.some(function(Ce){return ji(Ce,I)}):ji(N,I))&&(B.addKey(pe),C.push(Q))}switch(D.type){case"add":var xe=new Ft().addKeys(s.values?O.map(function(_e){return q(_e)}):O),P=O.concat(s.values?C.filter(function(_e){return _e=q(_e),!xe.hasKey(_e)&&(xe.addKey(_e),!0)}):C.map(function(_e){return q(_e)}).filter(function(_e){return!xe.hasKey(_e)&&(xe.addKey(_e),!0)}));break;case"put":var Se=new Ft().addKeys(D.values.map(function(_e){return q(_e)}));P=O.filter(function(_e){return!Se.hasKey(s.values?q(_e):_e)}).concat(s.values?C:C.map(function(_e){return q(_e)}));break;case"delete":var he=new Ft().addKeys(D.keys);P=O.filter(function(_e){return!he.hasKey(s.values?q(_e):_e)});break;case"deleteRange":var Oe=D.range;P=O.filter(function(_e){return!ji(q(_e),Oe)})}return P},n))===n)?n:(c.sort(function(O,D){return Qe(E(O),E(D))||Qe(q(O),q(D))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),p?Object.freeze(c):c)}function wl(n,s){return Qe(n.lower,s.lower)===0&&Qe(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function hf(n,s){return((l,c,f,p)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=Qe(l,c))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,p)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=Qe(l,c))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function vf(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&V(p,f)},3e3))})}var gf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var p,g,b=n.transaction(l,c,f);return c==="readwrite"&&(f=(p=new AbortController).signal,b.addEventListener("abort",(g=function(I){return function(){if(p.abort(),c==="readwrite"){for(var q=new Set,R=0,E=l;R<E.length;R++){var O=E[R],D=Fr["idb://".concat(s,"/").concat(O)];if(D){var P=n.table(O),C=D.optimisticOps.filter(function(De){return De.trans===b});if(b._explicit&&I&&b.mutatedParts)for(var B=0,U=Object.values(D.queries.query);B<U.length;B++)for(var N=0,Q=(Se=U[B]).slice();N<Q.length;N++)Ai((he=Q[N]).obsSet,b.mutatedParts)&&(V(Se,he),he.subscribers.forEach(function(De){return q.add(De)}));else if(0<C.length){D.optimisticOps=D.optimisticOps.filter(function(De){return De.trans!==b});for(var pe=0,xe=Object.values(D.queries.query);pe<xe.length;pe++)for(var Se,he,Oe,Ce=0,_e=(Se=xe[pe]).slice();Ce<_e.length;Ce++)(he=_e[Ce]).res!=null&&b.mutatedParts&&(I&&!he.dirty?(Oe=Object.isFrozen(he.res),Oe=_l(he.res,he.req,C,P,he,Oe),he.dirty?(V(Se,he),he.subscribers.forEach(function(De){return q.add(De)})):Oe!==he.res&&(he.res=Oe,he.promise=Ae.resolve({result:Oe}))):(he.dirty&&V(Se,he),he.subscribers.forEach(function(De){return q.add(De)})))}}}q.forEach(function(De){return De()})}}})(!1),{signal:f}),b.addEventListener("error",g(!1),{signal:f}),b.addEventListener("complete",g(!0),{signal:f})),b},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(p){var g,b=je.trans;return!f.outbound&&b.db._options.cache!=="disabled"&&!b.explicit&&b.idbtrans.mode==="readwrite"&&(g=Fr["idb://".concat(s,"/").concat(l)])?(b=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Di(f,p).some(function(I){return I==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Ds(p.mutatedParts),b.then(function(I){0<I.numFailures&&(V(g.optimisticOps,p),(I=bl(0,p,I))&&g.optimisticOps.push(I),p.mutatedParts)&&Ds(p.mutatedParts)}),b.catch(function(){V(g.optimisticOps,p),p.mutatedParts&&Ds(p.mutatedParts)})):b.then(function(I){var q=bl(0,a(a({},p),{values:p.values.map(function(R,E){var O;return I.failures[E]?R:(F(O=(O=f.keyPath)!=null&&O.includes(".")?le(R):a({},R),f.keyPath,I.results[E]),O)})}),I);g.optimisticOps.push(q),queueMicrotask(function(){return p.mutatedParts&&Ds(p.mutatedParts)})}),b):c.mutate(p)},query:function(p){var g,b,I,q,R,E,O;return ml(je,c)&&yl("query",p)?(g=((I=je.trans)==null?void 0:I.db._options.cache)==="immutable",b=(I=je).requery,I=I.signal,E=((D,P,C,B)=>{var U=Fr["idb://".concat(D,"/").concat(P)];if(!U)return[];if(!(D=U.queries[C]))return[null,!1,U,null];var N=D[(B.query?B.query.index.name:null)||""];if(!N)return[null,!1,U,null];switch(C){case"query":var Q=N.find(function(pe){return pe.req.limit===B.limit&&pe.req.values===B.values&&wl(pe.req.query.range,B.query.range)});return Q?[Q,!0,U,N]:[N.find(function(pe){return("limit"in pe.req?pe.req.limit:1/0)>=B.limit&&(!B.values||pe.req.values)&&hf(pe.req.query.range,B.query.range)}),!1,U,N];case"count":return Q=N.find(function(pe){return wl(pe.req.query.range,B.query.range)}),[Q,!!Q,U,N]}})(s,l,"query",p),O=E[0],q=E[2],R=E[3],O&&E[1]?O.obsSet=p.obsSet:(E=c.query(p).then(function(D){var P=D.result;if(O&&(O.res=P),g){for(var C=0,B=P.length;C<B;++C)Object.freeze(P[C]);Object.freeze(P)}else D.result=le(P);return D}).catch(function(D){return R&&O&&V(R,O),Promise.reject(D)}),O={obsSet:p.obsSet,promise:E,subscribers:new Set,type:"query",req:p,dirty:!1},R?R.push(O):(R=[O],(q=q||(Fr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=R)),vf(O,R,b,I),O.promise.then(function(D){return{result:_l(D.result,p,q==null?void 0:q.optimisticOps,c,O,g)}})):c.query(p)}})}})}};function Ms(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}_t.prototype.version=function(n){if(isNaN(n)||n<.1)throw new te.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new te.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(af),l.stores({}),this._state.autoSchema=!1),l},_t.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?n():new Ae(function(l,c){if(s._state.openComplete)return c(new te.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new te.DatabaseClosed);s.open().catch(qe)}s._state.dbReadyPromise.then(l,c)}).then(n)},_t.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:c??10,name:f}),p.sort(function(g,b){return g.level-b.level}),this},_t.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},_t.prototype.open=function(){var n=this;return Le(At,function(){return cf(n)})},_t.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=bt.indexOf(this);if(0<=s&&bt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ae(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ae(function(l,c){n.cancelOpen=c}))},_t.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new te.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new te.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},_t.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ae(function(f,p){function g(){s.close(n);var b=s._deps.indexedDB.deleteDatabase(s.name);b.onsuccess=it(function(){var I,q,R;I=s._deps,q=s.name,Si(R=I.indexedDB)||q===Xt||xi(R,I.IDBKeyRange).delete(q).catch(qe),f()}),b.onerror=Un(p),b.onblocked=s._fireOnBlocked}if(l)throw new te.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(g):g()})},_t.prototype.backendDB=function(){return this.idbdb},_t.prototype.isOpen=function(){return this.idbdb!==null},_t.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},_t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_t.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),_t.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new te.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return c=p.pop(),[s,Ee(p),c]}).apply(this,arguments);return this._transaction.apply(this,n)},_t.prototype._transaction=function(n,s,l){var c,f,p=this,g=je.trans,b=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(q){if(q=q instanceof p.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),n=="r"||n===Kn)c=Kn;else{if(n!="rw"&&n!=Br)throw new te.InvalidArgument("Invalid transaction mode: "+n);c=Br}if(g){if(g.mode===Kn&&c===Br){if(!b)throw new te.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(q){if(g&&g.storeNames.indexOf(q)===-1){if(!b)throw new te.SubTransaction("Table "+q+" not included in parent transaction.");g=null}}),b&&g&&!g.active&&(g=null)}}catch(q){return g?g._promise(null,function(R,E){E(q)}):ke(q)}var I=(function q(R,E,O,D,P){return Ae.resolve().then(function(){var N=je.transless||je,C=R._createTransaction(E,O,R._dbSchema,D),N=(C.explicit=!0,{trans:C,transless:N});if(D)C.idbtrans=D.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(Q){return Q.name===Ue.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return q(R,E,O,null,P)})):ke(Q)}var B,U=we(P),N=(U&&zt(),Ae.follow(function(){var Q;(B=P.call(C,C))&&(U?(Q=In.bind(null,null),B.then(Q,Q)):typeof B.next=="function"&&typeof B.throw=="function"&&(B=Pi(B)))},N));return(B&&typeof B.then=="function"?Ae.resolve(B).then(function(Q){return C.active?Q:ke(new te.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):N.then(function(){return B})).then(function(Q){return D&&C._resolve(),C._completion.then(function(){return Q})}).catch(function(Q){return C._reject(Q),ke(Q)})})}).bind(null,this,c,f,g,l);return g?g._promise(c,I,"lock"):je.trans?Le(je.transless,function(){return p._whenReady(I)}):this._whenReady(I)},_t.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new te.InvalidTable("Table ".concat(n," does not exist"))};var rr=_t;function _t(n,s){var l,c,f,p,g,b=this,I=(this._middlewares={},this.verno=0,_t.dependencies),I=(this._options=s=a({addons:_t.addons,autoOpen:!0,indexedDB:I.indexedDB,IDBKeyRange:I.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),q=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:qe,dbReadyPromise:null,cancelOpen:qe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(q.dbReadyPromise=new Ae(function(E){q.dbReadyResolve=E}),q.openCanceller=new Ae(function(E,O){q.cancelOpen=O}),this._state=q,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[kt,qe]}),this.once=function(E,O){var D=function(){for(var P=[],C=0;C<arguments.length;C++)P[C]=arguments[C];b.on(E).unsubscribe(D),O.apply(b,P)};return b.on(E,D)},this.on.ready.subscribe=se(this.on.ready.subscribe,function(E){return function(O,D){_t.vip(function(){var P,C=b._state;C.openComplete?(C.dbOpenError||Ae.resolve().then(O),D&&E(O)):C.onReadyBeingFired?(C.onReadyBeingFired.push(O),D&&E(O)):(E(O),P=b,D||E(function B(){P.on.ready.unsubscribe(O),P.on.ready.unsubscribe(B)}))})}}),this.Collection=(l=this,Ba(Zu.prototype,function(B,C){this.db=l;var D=La,P=null;if(C)try{D=C()}catch(N){P=N}var C=B._ctx,B=C.table,U=B.hook.reading.fire;this._ctx={table:B,index:C.index,isPrimKey:!C.index||B.schema.primKey.keyPath&&C.index===B.schema.primKey.name,range:D,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:C.or,valueMapper:U!==Fe?U:null}})),this.Table=(c=this,Ba(nl.prototype,function(E,O,D){this.db=c,this._tx=D,this.name=E,this.schema=O,this.hook=c._allTables[E]?c._allTables[E].hook:qa(null,{creating:[fn,qe],reading:[Tt,Fe],updating:[dn,qe],deleting:[Jn,qe]})})),this.Transaction=(f=this,Ba(ef.prototype,function(E,O,D,P,C){var B=this;E!=="readonly"&&O.forEach(function(U){U=(U=D[U])==null?void 0:U.yProps,U&&(O=O.concat(U.map(function(N){return N.updatesTable})))}),this.db=f,this.mode=E,this.storeNames=O,this.schema=D,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=C||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ae(function(U,N){B._resolve=U,B._reject=N}),this._completion.then(function(){B.active=!1,B.on.complete.fire()},function(U){var N=B.active;return B.active=!1,B.on.error.fire(U),B.parent?B.parent._reject(U):N&&B.idbtrans&&B.idbtrans.abort(),ke(U)})})),this.Version=(p=this,Ba(lf.prototype,function(E){this.db=p,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Ba(ol.prototype,function(E,O,D){if(this.db=g,this._ctx={table:E,index:O===":id"?null:O,or:D},this._cmp=this._ascending=Qe,this._descending=function(P,C){return Qe(C,P)},this._max=function(P,C){return 0<Qe(P,C)?P:C},this._min=function(P,C){return Qe(P,C)<0?P:C},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new te.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(b.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(b.name,"'. Closing db now to resume the delete request.")),b.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(b.name,"') was blocked")):console.warn("Upgrade '".concat(b.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=Ka(s.IDBKeyRange),this._createTransaction=function(E,O,D,P){return new b.Transaction(E,O,D,b._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(E){b.on("blocked").fire(E),bt.filter(function(O){return O.name===b.name&&O!==b&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(E)})},this.use(df),this.use(gf),this.use(pf),this.use(uf),this.use(ff),new Proxy(this,{get:function(E,O,D){var P;return O==="_vip"||(O==="table"?function(C){return Ms(b.table(C),R)}:(P=Reflect.get(E,O,D))instanceof nl?Ms(P,R):O==="tables"?P.map(function(C){return Ms(C,R)}):O==="_createTransaction"?function(){return Ms(P.apply(this,arguments),R)}:P)}}));this.vip=R,I.forEach(function(E){return E(b)})}var Ls,ma=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",mf=(Mi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Mi.prototype[ma]=function(){return this},Mi);function Mi(n){this._subscribe=n}try{Ls={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ls={indexedDB:null,IDBKeyRange:null}}function kl(n){var s,l=!1,c=new mf(function(f){var p=we(n),g,b=!1,I={},q={},R={get closed(){return b},unsubscribe:function(){b||(b=!0,g&&g.abort(),E&&kr.storagemutated.unsubscribe(D))}},E=(f.start&&f.start(R),!1),O=function(){return me(P)},D=function(C){Os(I,C),Ai(q,I)&&O()},P=function(){var C,B,U;!b&&Ls.indexedDB&&(I={},C={},g&&g.abort(),g=new AbortController,U=(N=>{var Q=_r();try{p&&zt();var pe=Cn(n,N);return pe=p?pe.finally(In):pe}finally{Q&&nr()}})(B={subscr:C,signal:g.signal,requery:O,querier:n,trans:null}),Promise.resolve(U).then(function(N){l=!0,s=N,b||B.signal.aborted||(I={},(Q=>{for(var pe in Q)if(x(Q,pe))return;return 1})(q=C)||E||(kr(Fa,D),E=!0),me(function(){return!b&&f.next&&f.next(N)}))},function(N){l=!1,["DatabaseClosedError","AbortError"].includes(N==null?void 0:N.name)||b||me(function(){b||f.error&&f.error(N)})}))};return setTimeout(O,0),R});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var Kr=rr;function Li(n){var s=xr;try{xr=!0,kr.storagemutated.fire(n),Ri(n,!0)}finally{xr=s}}k(Kr,a(a({},Y),{delete:function(n){return new Kr(n,{addons:[]}).delete()},exists:function(n){return new Kr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Kr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Si(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==Xt})}):xi(l,s).toCollection().primaryKeys()).then(n)}catch{return ke(new te.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return je.trans?Le(je.transless,n):n()},vip:Ti,async:function(n){return function(){try{var s=Pi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ae.resolve(s)}catch(l){return ke(l)}}},spawn:function(n,s,l){try{var c=Pi(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ae.resolve(c)}catch(f){return ke(f)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(n,s){return n=Ae.resolve(typeof n=="function"?Kr.ignoreTransaction(n):n).timeout(s||6e4),je.trans?je.trans.waitFor(n):n},Promise:Ae,debug:{get:function(){return mt},set:function(n){pn(n)}},derive:L,extend:v,props:k,override:se,Events:qa,on:kr,liveQuery:kl,extendObservabilitySet:Os,getByKeyPath:ee,setByKeyPath:F,delByKeyPath:function(n,s){typeof s=="string"?F(n,s,void 0):"length"in s&&[].map.call(s,function(l){F(n,l,void 0)})},shallowClone:ce,deepClone:le,getObjectDiff:Oi,cmp:Qe,asap:Z,minKey:-1/0,addons:[],connections:bt,errnames:Ue,dependencies:Ls,cache:Fr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Kr.maxKey=Ka(Kr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(kr(Fa,function(n){xr||(n=new CustomEvent(gi,{detail:n}),xr=!0,dispatchEvent(n),xr=!1)}),addEventListener(gi,function(n){n=n.detail,xr||Li(n)}));var ya,xr=!1,xl=function(){};return typeof BroadcastChannel<"u"&&((xl=function(){(ya=new BroadcastChannel(gi)).onmessage=function(n){return n.data&&Li(n.data)}})(),typeof ya.unref=="function"&&ya.unref(),kr(Fa,function(n){xr||ya.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!rr.disableBfCache&&n.persisted){mt&&console.debug("Dexie: handling persisted pagehide"),ya!=null&&ya.close();for(var s=0,l=bt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!rr.disableBfCache&&n.persisted&&(mt&&console.debug("Dexie: handling persisted pageshow"),xl(),Li({all:new Ft(-1/0,[[]])}))})),Ae.rejectionMapper=function(n,s){return!n||n instanceof H||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Ne[n.name]?n:(s=new Ne[n.name](s||n.message,n),"stack"in n&&j(s,"stack",{get:function(){return this.inner.stack}}),s)},pn(mt),a(rr,Object.freeze({__proto__:null,Dexie:rr,Entity:Zo,PropModification:Na,RangeSet:Ft,add:function(n){return new Na({add:n})},cmp:Qe,default:rr,liveQuery:kl,mergeRanges:Ha,rangesOverlap:dl,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,s){return new Na({replacePrefix:[n,s]})}}),{default:rr}),rr})})(Xs)),Xs.exports}var np=tp();const lo=$d(np),Kl=Symbol.for("Dexie"),Ut=globalThis[Kl]||(globalThis[Kl]=lo);if(lo.semVer!==Ut.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${lo.semVer} and ${Ut.semVer}`);const{liveQuery:_y,mergeRanges:wy,rangesOverlap:ky,RangeSet:xy,cmp:Sy,Entity:Ty,PropModification:Ey,replacePrefix:Ay,add:Cy,remove:Iy,DexieYProvider:Ry}=Ut,Be=new Ut("me-ai-store");Be.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Be.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Be.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Be.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function pu(t,e){return`${t}:${e}`}function co(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Gi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function rp(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function ap(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function hu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const sp="https://gmail.googleapis.com/gmail/v1/users/me";class No extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function ip(t){return{Authorization:`Bearer ${t}`}}async function fi(t,e){var a,i,o,u;const r=await fetch(`${sp}${e}`,{headers:ip(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,h=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new No(v,r.status,h)}return r.json()}function vu(t){return fi(t,"/profile")}function gu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),fi(t,`/messages?${i}`)}function mu(t,e,r="full"){return fi(t,`/messages/${e}?format=${r}`)}function op(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),fi(t,`/history?${i}`)}function Tr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ss(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function lp(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return ss(a.body.data);const i=ei(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=ss(i.body.data);return up(v)}return"(no body)"}function cp(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ss(a.body.data):null}function ei(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ei(r.parts,e);if(a)return a}}return null}function up(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function qo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function yu(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function bu(t){return yu(t).charAt(0).toUpperCase()}function fp(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function dp(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function _u(t,e){return`${fp(t.date)}_${dp(t.subject)}.${e}`}function wu(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function pp(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await ku();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function hp(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await ku();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function vp(t=10){const e=await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(xu).join(`

---

`)}async function gp(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Be.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,h,y,x;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(u+=2),(h=o.to)!=null&&h.toLowerCase().includes(r)&&(u+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(u+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>xu(o)).join(`

---

`)}async function Ul(){const t=await Be.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=wu(t);return{groups:e,order:r,total:t.length}}async function mp({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await Be.items.where("sourceType").equals("gmail").filter(d=>{var v,h,y,x;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((h=d.from)==null?void 0:h.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return u.sort((d,v)=>(v.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await Be.items.where("sourceType").equals("gmail").count();return{items:await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function ku(){const t=await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).first(),e=await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).last();return{oldest:t,newest:e}}function xu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=ap(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function yp(){const t=await pp();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function bp(t){const e=[],r=await hp();if(e.push(r),t){const a=await gp(t,5);e.push("","## Relevant Emails",a)}else{const a=await vp(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const _p=20,wp={maxTokens:512},Su=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Tu(t,{count:e=_p,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().limit(e).toArray();else{const h=new Set(await Be.emailClassifications.toCollection().primaryKeys());o=0,i=[],await Be.items.where("[sourceType+date]").between(["gmail",Ut.minKey],["gmail",Ut.maxKey]).reverse().until(()=>i.length>=e).each(y=>{h.has(y.id)?o++:i.push(y)})}if(i.length===0){const h=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:h,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const u=Date.now();let d=0,v=0;for(let h=0;h<i.length;h++){const y=i[h];a({phase:"scanning",message:`Classifying email ${h+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:h+1,total:i.length,classified:d});try{const x=Au(y),k=[{role:"system",content:Su},{role:"user",content:x}],w=await t.generateFull(k,{maxTokens:512,enableThinking:!1}),j=Sp(w);j&&(await Be.emailClassifications.put({emailId:y.id,action:j.action,reason:j.reason,summary:j.summary,tags:j.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:u,status:"pending"}),d++)}catch(x){console.error(`Triage email ${h+1} failed:`,x),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function kp(){const t=await Be.emailClassifications.toArray();return wu(t)}async function xp(){const t=await Be.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ti(t,e){await Be.emailClassifications.update(t,{status:e})}async function Gl(){await Be.emailClassifications.clear()}async function Bo(t){await Be.emailClassifications.where("action").equals(t).delete()}async function Eu(t){await Be.emailClassifications.delete(t)}async function uo(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Au(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Sp(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=Tp(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(u.tags)&&(v=u.tags.filter(h=>typeof h=="string"&&h.trim()).map(h=>h.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:v}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function Tp(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function fo(t){return`hsl(${hu(t)}, 55%, 55%)`}function Ep(t){return`hsl(${hu(t)}, 40%, 35%)`}const Ap=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Hl(...t){Ap&&console.log("[debug]",...t)}function un(t){return Hl(`[MOUNT] ${t}`),()=>Hl(`[DESTROY] ${t}`)}var Cp=G("<option> </option>"),Ip=G('<p class="model-description svelte-1p89qnn"> </p>'),Rp=G('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Pp=G('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Op=G('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Dp=G('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),jp=G('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Mp=G('<p class="error svelte-1p89qnn"> </p>'),Lp=G('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Np(t,e){ut(e,!0);let r=Ie(e,"selectedModel",15),a=Ie(e,"gpuInfo",3,null),i=Ie(e,"error",3,null);Bt(()=>un("ModelSelector"));var o=Lp(),u=S(_(o),2),d=S(_(u),2);nn(d,21,()=>ls,hr,(L,T)=>{var K=Cp(),ae=_(K),se={};ue(()=>{ie(ae,`${m(T).name??""} â ${m(T).size??""}`),se!==(se=m(T).id)&&(K.value=(K.__value=m(T).id)??"")}),z(L,K)});var v=S(d,2);{var h=L=>{const T=dt(()=>ls.find(W=>W.id===r()));var K=ua(),ae=st(K);{var se=W=>{var Z=Ip(),ee=_(Z);ue(()=>ie(ee,m(T).description)),z(W,Z)};be(ae,W=>{m(T)&&W(se)})}z(L,K)};be(v,L=>{r()&&L(h)})}var y=S(u,2);{var x=L=>{var T=jp(),K=S(_(T),2),ae=_(K),se=S(_(ae)),W=_(se),Z=S(ae,2),ee=S(_(Z)),F=_(ee),ce=S(Z,2);{var ye=fe=>{var de=Rp(),V=S(_(de)),oe=_(V);ue(()=>ie(oe,a().device)),z(fe,de)};be(ce,fe=>{a().device&&a().device!=="unknown"&&fe(ye)})}var Ee=S(ce,2);{var ge=fe=>{var de=Pp(),V=S(_(de)),oe=_(V);ue(()=>ie(oe,a().description)),z(fe,de)};be(Ee,fe=>{a().description&&a().description!=="unknown"&&fe(ge)})}var ne=S(Ee,2);{var le=fe=>{var de=Op(),V=S(_(de)),oe=_(V);ue(ve=>ie(oe,ve),[()=>co(a().limits.maxBufferSize)]),z(fe,de)};be(ne,fe=>{var de;(de=a().limits)!=null&&de.maxBufferSize&&fe(le)})}var Pe=S(ne,2);{var re=fe=>{var de=Dp(),V=S(_(de)),oe=_(V);ue(()=>ie(oe,`${a().features.length??""} supported`)),z(fe,de)};be(Pe,fe=>{var de;(de=a().features)!=null&&de.length&&fe(re)})}ue(()=>{ie(W,a().vendor),ie(F,a().architecture)}),z(L,T)};be(y,L=>{a()&&L(x)})}var k=S(y,2);{var w=L=>{var T=Mp(),K=_(T);ue(()=>ie(K,i())),z(L,T)};be(k,L=>{i()&&L(w)})}var j=S(k,2);j.__click=function(...L){var T;(T=e.onload)==null||T.apply(this,L)},ue(()=>j.disabled=i()),Mo(d,r),z(t,o),ft()}Pt(["click"]);var qp=G('<span class="progress-percent svelte-r5fnze"> </span>'),Bp=G('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),zp=G('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Fp=G('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Kp=G('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Up=G('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Gp=G('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Hp(t,e){ut(e,!0);let r=Ie(e,"message",3,""),a=Ie(e,"items",19,()=>[]);Bt(()=>un("LoadingProgress"));var i=Gp(),o=_(i),u=_(o),d=S(o,2);nn(d,17,a,hr,(v,h)=>{const y=dt(()=>m(h).total?rp(m(h).loaded||0,m(h).total):null);var x=Up(),k=_(x),w=_(k),j=_(w),L=S(w,2);{var T=W=>{var Z=qp(),ee=_(Z);ue(F=>ie(ee,`${F??""}%`),[()=>m(y).toFixed(1)]),z(W,Z)};be(L,W=>{m(y)!==null&&W(T)})}var K=S(k,2);{var ae=W=>{var Z=Bp(),ee=st(Z),F=_(ee),ce=S(ee,2),ye=_(ce),Ee=_(ye),ge=S(ye,4),ne=_(ge),le=S(ge,2),Pe=_(le);ue((re,fe,de,V,oe)=>{tn(F,`width: ${re??""}%`),ie(Ee,fe),ie(ne,de),ie(Pe,`(${V??""} / ${oe??""} B)`)},[()=>Math.max(m(h).progress??0,.5).toFixed(1),()=>Gi(m(h).loaded||0),()=>Gi(m(h).total),()=>(m(h).loaded||0).toLocaleString(),()=>m(h).total.toLocaleString()]),z(W,Z)},se=W=>{var Z=Kp(),ee=S(st(Z),2),F=_(ee);{var ce=Ee=>{var ge=zp(),ne=st(ge),le=_(ne),Pe=S(ne,2),re=_(Pe);ue((fe,de)=>{ie(le,fe),ie(re,`(${de??""} B)`)},[()=>Gi(m(h).loaded),()=>m(h).loaded.toLocaleString()]),z(Ee,ge)},ye=Ee=>{var ge=Fp();z(Ee,ge)};be(F,Ee=>{m(h).loaded?Ee(ce):Ee(ye,!1)})}z(W,Z)};be(K,W=>{m(h).total?W(ae):W(se,!1)})}ue(()=>{uu(w,"title",m(h).file),ie(j,m(h).file)}),z(v,x)}),ue(()=>ie(u,r())),z(t,i),ft()}var Wp=G('<span class="thinking-tokens svelte-11gjw00"> </span>'),Yp=G('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Vp=G('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Xp=G('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Qp=G('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Zp=G('<span class="cursor svelte-11gjw00">|</span>'),Jp=G(" <!>",1),$p=G('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),eh=G('<div class="content svelte-11gjw00"> </div>'),th=G('<div><div class="role svelte-11gjw00"> </div> <!></div>');function nh(t,e){ut(e,!0);let r=Ie(e,"isLast",3,!1),a=Ie(e,"isRunning",3,!1),i=Ie(e,"generationPhase",3,null),o=Ie(e,"numTokens",3,null);Bt(()=>un(`MessageBubble[${e.msg.role}]`));var u=th(),d=_(u),v=_(d),h=S(d,2);{var y=k=>{var w=$p(),j=st(w);{var L=F=>{var ce=Yp(),ye=S(_(ce),4);{var Ee=ge=>{var ne=Wp(),le=_(ne);ue(()=>ie(le,`${o()??""} tokens`)),z(ge,ne)};be(ye,ge=>{o()&&ge(Ee)})}z(F,ce)},T=F=>{var ce=Vp();z(F,ce)};be(j,F=>{a()&&r()&&i()==="thinking"?F(L):a()&&r()&&i()==="preparing"&&F(T,1)})}var K=S(j,2);{var ae=F=>{var ce=Xp(),ye=_(ce),Ee=S(_(ye),2),ge=_(Ee),ne=S(ye,2),le=_(ne);ue(Pe=>{ie(ge,`${Pe??""} words`),ie(le,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),z(F,ce)};be(K,F=>{e.msg.thinking&&F(ae)})}var se=S(K,2),W=_(se);{var Z=F=>{var ce=Qp();z(F,ce)},ee=F=>{var ce=Jp(),ye=st(ce,!0),Ee=S(ye);{var ge=ne=>{var le=Zp();z(ne,le)};be(Ee,ne=>{a()&&r()&&ne(ge)})}ue(()=>ie(ye,e.msg.content)),z(F,ce)};be(W,F=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?F(Z):F(ee,!1)})}z(k,w)},x=k=>{var w=eh(),j=_(w);ue(()=>ie(j,e.msg.content)),z(k,w)};be(h,k=>{e.msg.role==="assistant"?k(y):k(x,!1)})}ue(()=>{Mt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ie(v,e.msg.role==="user"?"You":"AI")}),z(t,u),ft()}var rh=G('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),ah=G('<span class="edate svelte-mt5nvh"> </span>'),sh=G('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),ih=G('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),oh=G('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),lh=G('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),ch=G('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function uh(t,e){ut(e,!0);let r=Ie(e,"pendingData",3,null),a=Re(null),i=Re(null);function o(w){M(a,m(a)===w?null:w,!0),M(i,null)}function u(w){return w.split("_").map(j=>j.charAt(0)+j.slice(1).toLowerCase()).join(" ")}function d(w){if(!w)return"";try{return new Date(w).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(w){if(!w)return"";const j=w.replace(/<.*>/,"").trim();return j.length>24?j.slice(0,22)+"â¦":j}var h={toggleGroup:o},y=ua(),x=st(y);{var k=w=>{var j=ch(),L=_(j),T=_(L),K=S(L,2);nn(K,20,()=>r().order,W=>W,(W,Z)=>{const ee=dt(()=>r().groups[Z]),F=dt(()=>fo(Z)),ce=dt(()=>m(a)===Z);var ye=rh();let Ee;ye.__click=()=>o(Z);let ge;var ne=_(ye);let le;var Pe=S(ne),re=S(Pe),fe=_(re);ue(de=>{Ee=Mt(ye,1,"chip svelte-mt5nvh",null,Ee,{active:m(ce)}),ge=tn(ye,"",ge,{"--c":m(F)}),le=tn(ne,"",le,{background:m(F)}),ie(Pe,` ${de??""} `),ie(fe,m(ee).length)},[()=>u(Z)]),z(W,ye)});var ae=S(K,2);{var se=W=>{const Z=dt(()=>r().groups[m(a)]),ee=dt(()=>fo(m(a)));var F=lh(),ce=_(F);let ye;var Ee=_(ce);Ee.__click=()=>{M(a,null),M(i,null)};var ge=S(Ee,2),ne=_(ge),le=S(ge,2),Pe=_(le),re=S(ce,2);nn(re,21,()=>m(Z),ve=>ve.emailId,(ve,we)=>{var Y=sh(),J=_(Y);J.__click=()=>{var Fe;return(Fe=e.onaskai)==null?void 0:Fe.call(e,`Tell me about the email "${m(we).subject}" from ${m(we).from}`)};var H=_(J),$=_(H),Me=S(H,2),Te=_(Me),Ue=S(Te);{var rt=Fe=>{var Tt=ah(),vt=_(Tt);ue(fn=>ie(vt,fn),[()=>d(m(we).date)]),z(Fe,Tt)};be(Ue,Fe=>{m(we).date&&Fe(rt)})}var te=S(J,2),Ne=_(te);Ne.__click=()=>{var Fe;return(Fe=e.onmarkacted)==null?void 0:Fe.call(e,m(we).emailId)};var qe=S(Ne,2);qe.__click=()=>{var Fe;return(Fe=e.ondismiss)==null?void 0:Fe.call(e,m(we).emailId)},ue(Fe=>{ie($,m(we).subject),ie(Te,Fe)},[()=>v(m(we).from)]),z(ve,Y)});var fe=S(re,2),de=_(fe);{var V=ve=>{var we=ih(),Y=st(we);Y.__click=()=>m(Z).forEach(H=>{var $;return($=e.onmarkacted)==null?void 0:$.call(e,H.emailId)});var J=S(Y,2);J.__click=()=>M(i,m(a),!0),z(ve,we)},oe=ve=>{var we=oh(),Y=st(we),J=_(Y),H=S(Y,2);H.__click=()=>M(i,null);var $=S(H,2);$.__click=()=>{var Me;(Me=e.oncleargroup)==null||Me.call(e,m(a)),M(i,null),M(a,null)},ue(()=>ie(J,`Remove ${m(Z).length??""}?`)),z(ve,we)};be(de,ve=>{m(i)!==m(a)?ve(V):ve(oe,!1)})}ue(ve=>{ye=tn(ce,"",ye,{"border-color":m(ee)}),ie(ne,ve),ie(Pe,m(Z).length)},[()=>u(m(a))]),z(W,F)};be(ae,W=>{m(a)&&r().groups[m(a)]&&W(se)})}ue(()=>ie(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),z(w,j)};be(x,w=>{r()&&r().total>0&&w(k)})}return z(t,y),ft(h)}Pt(["click"]);var fh=G('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),dh=G('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),ph=G('<div class="strip svelte-1ed7zw1"><!></div>');function hh(t,e){let r=Ie(e,"hasScanData",3,!1),a=Ie(e,"engineReady",3,!1),i=Ie(e,"isScanning",3,!1),o=dt(()=>a()&&!r()&&!i()),u=dt(()=>m(o)||i());var d=ua(),v=st(d);{var h=y=>{var x=ph(),k=_(x);{var w=L=>{var T=fh();z(L,T)},j=L=>{var T=dh();T.__click=function(...K){var ae;(ae=e.onscan)==null||ae.apply(this,K)},z(L,T)};be(k,L=>{i()?L(w):m(o)&&L(j,1)})}z(y,x)};be(v,y=>{m(u)&&y(h)})}z(t,d)}Pt(["click"]);var vh=G('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),gh=G('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mh=G('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),yh=G('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),bh=G('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),_h=G('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),wh=G('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function kh(t,e){ut(e,!0),Bt(()=>un("GpuPanel"));var r=wh(),a=_(r),i=S(_(a),2),o=S(_(i),2),u=_(o),d=S(i,2),v=S(_(d),2),h=_(v),y=S(d,2);{var x=W=>{var Z=vh(),ee=S(_(Z),2),F=_(ee);ue(()=>ie(F,e.gpuInfo.device)),z(W,Z)};be(y,W=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&W(x)})}var k=S(y,2);{var w=W=>{var Z=gh(),ee=S(_(Z),2),F=_(ee);ue(ce=>ie(F,ce),[()=>co(e.gpuInfo.limits.maxBufferSize)]),z(W,Z)};be(k,W=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxBufferSize&&W(w)})}var j=S(k,2);{var L=W=>{var Z=mh(),ee=S(_(Z),2),F=_(ee);ue(()=>ie(F,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),z(W,Z)};be(j,W=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxComputeInvocationsPerWorkgroup&&W(L)})}var T=S(j,2);{var K=W=>{var Z=yh(),ee=S(_(Z),2),F=_(ee);ue(ce=>ie(F,ce),[()=>co(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),z(W,Z)};be(T,W=>{var Z;(Z=e.gpuInfo.limits)!=null&&Z.maxComputeWorkgroupStorageSize&&W(K)})}var ae=S(T,2);{var se=W=>{var Z=_h(),ee=_(Z),F=_(ee),ce=S(ee,2);nn(ce,21,()=>e.gpuInfo.features,hr,(ye,Ee)=>{var ge=bh(),ne=_(ge);ue(()=>ie(ne,m(Ee))),z(ye,ge)}),ue(()=>ie(F,`Features (${e.gpuInfo.features.length??""})`)),z(W,Z)};be(ae,W=>{var Z;(Z=e.gpuInfo.features)!=null&&Z.length&&W(se)})}ue(()=>{ie(u,e.gpuInfo.vendor),ie(h,e.gpuInfo.architecture)}),z(t,r),ft()}var xh=G('<button class="gpu-badge svelte-1ktw27c"> </button>'),Sh=G('<span class="stats svelte-1ktw27c"> </span>'),Th=G('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Eh=G('<span class="stats preparing svelte-1ktw27c"> </span>'),Ah=G('<span class="stats svelte-1ktw27c"> </span>'),Ch=G('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ih=G('<button class="btn svelte-1ktw27c">Stop</button>'),Rh=G('<button class="btn primary svelte-1ktw27c">Send</button>'),Ph=G('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Oh(t,e){ut(e,!0),Bt(()=>un("ChatView"));let r=Ie(e,"messages",19,()=>[]),a=Ie(e,"pendingData",3,null),i=Ie(e,"hasScanData",3,!1),o=Ie(e,"engineReady",3,!1),u=Ie(e,"isScanning",3,!1),d=Ie(e,"isRunning",3,!1),v=Ie(e,"tps",3,null),h=Ie(e,"numTokens",3,null),y=Ie(e,"generationPhase",3,null),x=Ie(e,"gpuInfo",3,null),k=Ie(e,"chatContainer",15),w=Re(""),j=Re(!1);function L(H){H.key==="Enter"&&!H.shiftKey&&(H.preventDefault(),T())}function T(){const H=m(w).trim();!H||d()||(M(w,""),e.onsend(H))}function K(H){H&&!d()&&e.onsend(H)}var ae=Ph(),se=_(ae),W=_(se);{var Z=H=>{var $=xh();$.__click=()=>M(j,!m(j));var Me=_($);ue(()=>ie(Me,`WebGPU ${m(j)?"â²":"â¼"}`)),z(H,$)};be(W,H=>{x()&&H(Z)})}var ee=S(W,2);{var F=H=>{var $=Sh(),Me=_($);ue((Te,Ue)=>ie(Me,`${h()??""} tokens in ${Te??""}s
        (${Ue??""} tok/s)`),[()=>(h()/v()).toFixed(1),()=>v().toFixed(1)]),z(H,$)},ce=H=>{var $=Th();z(H,$)},ye=H=>{var $=Eh(),Me=_($);ue(Te=>ie(Me,`thinking... ${Te??""}`),[()=>v()?`${v().toFixed(0)} tok/s`:""]),z(H,$)},Ee=H=>{var $=Ah(),Me=_($);ue(Te=>ie(Me,`${Te??""} tok/s`),[()=>v().toFixed(1)]),z(H,$)};be(ee,H=>{v()&&!d()?H(F):d()&&y()==="preparing"?H(ce,1):d()&&y()==="thinking"?H(ye,2):v()&&d()&&H(Ee,3)})}var ge=S(ee,4);ge.__click=function(...H){var $;($=e.onreset)==null||$.apply(this,H)};var ne=S(se,2);{var le=H=>{kh(H,{get gpuInfo(){return x()}})};be(ne,H=>{m(j)&&x()&&H(le)})}var Pe=S(ne,2),re=_(Pe);{var fe=H=>{var $=Ch();z(H,$)};be(re,H=>{r().length===0&&!(a()&&a().total>0)&&H(fe)})}var de=S(re,2);nn(de,17,r,hr,(H,$,Me)=>{var Te=ua(),Ue=st(Te);{var rt=Ne=>{uh(Ne,{get pendingData(){return m($).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:K})},te=Ne=>{{let qe=dt(()=>Me===r().length-1);nh(Ne,{get msg(){return m($)},get isLast(){return m(qe)},get isRunning(){return d()},get generationPhase(){return y()},get numTokens(){return h()}})}};be(Ue,Ne=>{m($).type==="dashboard"?Ne(rt):Ne(te,!1)})}z(H,Te)}),fu(Pe,H=>k(H),()=>k());var V=S(Pe,2);hh(V,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var oe=S(V,2),ve=_(oe);ve.__keydown=L;var we=S(ve,2);{var Y=H=>{var $=Ih();$.__click=function(...Me){var Te;(Te=e.onstop)==null||Te.apply(this,Me)},z(H,$)},J=H=>{var $=Rh();$.__click=T,ue(Me=>$.disabled=Me,[()=>!m(w).trim()]),z(H,$)};be(we,H=>{d()?H(Y):H(J,!1)})}ue(()=>{ge.disabled=d(),ve.disabled=d()}),Lo(ve,()=>m(w),H=>M(w,H)),z(t,ae),ft()}Pt(["click","keydown"]);var Dh=G('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function jh(t,e){ut(e,!0);const r=!!navigator.gpu,a=du();let i=Re(jt(localStorage.getItem("selectedModel")||ls[0].id)),o=Re(null),u=Re(null),d=Re(""),v=Re(jt([])),h=Re(jt([])),y=Re(!1),x=Re(null),k=Re(null),w=Re(null),j=Re(null),L=Re(null),T=Re(null),K=Re(!1),ae=Re(!1),se=!1;Bt(()=>{a.check(),a.isReady&&W();const Y=a.onMessage(J=>{switch(J.status){case"webgpu-info":M(j,J.data,!0);break;case"loading":M(o,"loading"),M(d,J.data,!0);break;case"initiate":M(v,[...m(v),J],!0);break;case"progress":M(v,m(v).map(H=>H.file===J.file?{...H,...J}:H),!0);break;case"done":M(v,m(v).filter(H=>H.file!==J.file),!0);break;case"ready":M(o,"ready"),W();break;case"start":if(!m(y))break;M(L,J.phase||"preparing",!0),M(h,[...m(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!m(y))break;M(L,J.phase,!0);break;case"thinking":{if(!m(y))break;M(x,J.tps,!0),M(k,J.numTokens,!0);const H=m(h)[m(h).length-1];M(h,[...m(h).slice(0,-1),{...H,thinking:(H.thinking||"")+J.content}],!0),ge();break}case"thinking-done":{if(!m(y))break;M(x,J.tps,!0),M(k,J.numTokens,!0);const H=m(h)[m(h).length-1];M(h,[...m(h).slice(0,-1),{...H,thinking:J.content}],!0);break}case"update":{if(!m(y))break;M(x,J.tps,!0),M(k,J.numTokens,!0);const H=m(h)[m(h).length-1];M(h,[...m(h).slice(0,-1),{...H,content:H.content+J.output}],!0),ge();break}case"complete":if(!m(y))break;M(y,!1),M(L,null),Z();break;case"error":if(!m(y))break;M(u,J.data,!0),M(y,!1),M(L,null);break}});return()=>Y()});async function W(){if(!(se||m(h).length>0))try{const Y=await Ul();M(T,Y,!0),Y&&(se=!0,M(h,[{role:"assistant",type:"dashboard",pendingData:Y}],!0),ge());const J=await uo();M(K,J.classified>0)}catch{}}async function Z(){try{const Y=await Ul();M(T,Y,!0);const J=m(h).findIndex($=>$.type==="dashboard");J!==-1&&(Y&&Y.total>0?M(h,m(h).map(($,Me)=>Me===J?{...$,pendingData:Y}:$),!0):M(h,m(h).filter(($,Me)=>Me!==J),!0));const H=await uo();M(K,H.classified>0)}catch{}}async function ee(Y){await ti(Y,"acted"),await Z()}async function F(Y){await ti(Y,"dismissed"),await Z()}async function ce(Y){await Eu(Y),await Z()}async function ye(Y){await Bo(Y),await Z()}async function Ee(){if(!(m(ae)||!a.isReady)){M(ae,!0);try{await Tu(a,{count:20}),await Z(),m(T)&&!m(h).some(Y=>Y.type==="dashboard")&&(M(h,[{role:"assistant",type:"dashboard",pendingData:m(T)},...m(h)],!0),ge())}catch(Y){console.error("Scan failed:",Y)}finally{M(ae,!1)}}}function ge(){su().then(()=>{m(w)&&(m(w).scrollTop=m(w).scrollHeight)})}function ne(){M(o,"loading"),localStorage.setItem("selectedModel",m(i)),a.loadModel(m(i))}async function le(Y){if(!Y||m(y))return;M(h,[...m(h),{role:"user",content:Y}],!0),M(x,null),M(y,!0);let J=[];try{const Me=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Y)?await bp(Y):await yp();Me&&(J=[{role:"system",content:Me}])}catch{}const H=m(h).filter($=>$.type!=="dashboard").map($=>({role:$.role,content:$.content}));a.generate([...J,...H]),ge()}function Pe(){a.interrupt()}function re(){a.reset(),M(h,[],!0),M(x,null),M(k,null),se=!1,W()}var fe=ua(),de=st(fe);{var V=Y=>{var J=Dh();z(Y,J)},oe=Y=>{Np(Y,{get gpuInfo(){return m(j)},get error(){return m(u)},onload:ne,get selectedModel(){return m(i)},set selectedModel(J){M(i,J,!0)}})},ve=Y=>{Hp(Y,{get message(){return m(d)},get items(){return m(v)}})},we=Y=>{Oh(Y,{get messages(){return m(h)},get pendingData(){return m(T)},get hasScanData(){return m(K)},get engineReady(){return a.isReady},get isScanning(){return m(ae)},get isRunning(){return m(y)},get tps(){return m(x)},get numTokens(){return m(k)},get generationPhase(){return m(L)},get gpuInfo(){return m(j)},onsend:le,onstop:Pe,onreset:re,onmarkacted:ee,ondismiss:F,onremove:ce,oncleargroup:ye,onscan:Ee,get chatContainer(){return m(w)},set chatContainer(J){M(w,J,!0)}})};be(de,Y=>{r?m(o)===null?Y(oe,1):m(o)==="loading"?Y(ve,2):Y(we,!1):Y(V)})}z(t,fe),ft()}const Wl="https://accounts.google.com/gsi/client",Mh="https://www.googleapis.com/auth/gmail.readonly",zo="me-ai:oauth-token",Lh=300*1e3;let po=null,Qs=null;function Nh(t,e){try{sessionStorage.setItem(zo,JSON.stringify({access_token:t,expires_at:Date.now()+e*1e3}))}catch{}}function ho(){try{sessionStorage.removeItem(zo)}catch{}}function qh(){try{const t=sessionStorage.getItem(zo);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-Lh?(ho(),null):{access_token:e}}catch{return ho(),null}}function Bh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Wl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Wl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Yl(t){await Bh(),po=google.accounts.oauth2.initTokenClient({client_id:t,scope:Mh,callback:e=>{Qs&&(Qs(e),Qs=null)}})}function zh(){return new Promise((t,e)=>{if(!po){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Qs=r=>{r.error?e(new Error(r.error_description||r.error)):(Nh(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},po.requestAccessToken()})}function Fh(t){return ho(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Lt="gmail",Vl=8,Cu=50,Iu=100;async function Kh(t,{limit:e=Cu,onProgress:r=()=>{},signal:a}={}){var u;const i=await Be.syncState.get(Lt);if(i!=null&&i.historyId)try{return await Yh(t,i,r,a)}catch(d){if(d instanceof No&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Be.syncState.delete(Lt);else throw d}return await Hh(t,e===0?1/0:e,r,a)}async function Uh(t,{limit:e=Cu,onProgress:r=()=>{},signal:a}={}){const i=await Be.syncState.get(Lt);return i!=null&&i.oldestPageToken?await Wh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Gh(){const t=await Be.syncState.get(Lt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Ru(){await Be.transaction("rw",[Be.items,Be.syncState],async()=>{await Be.items.where("sourceType").equals(Lt).delete(),await Be.syncState.delete(Lt)})}async function Hh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),oa(a);const i=await vu(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){oa(a);const x=e-o.length,k=await gu(t,{maxResults:Math.min(Iu,x),pageToken:u}),w=(k.messages||[]).map(j=>j.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=k.nextPageToken,!u||w.length===0)break}if(d=u||null,o.length===0)return await Be.syncState.put({sourceType:Lt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await Pu(t,o,r,a),y=await Be.items.where("sourceType").equals(Lt).count();return await Be.syncState.put({sourceType:Lt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function Wh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),oa(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){oa(i);const x=r-o.length,k=await gu(t,{maxResults:Math.min(Iu,x),pageToken:u}),w=(k.messages||[]).map(j=>j.id);if(o.push(...w),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=k.nextPageToken,!u||w.length===0)break}if(d=u||null,o.length===0)return await Be.syncState.update(Lt,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await Pu(t,o,a,i),y=await Be.items.where("sourceType").equals(Lt).count();return await Be.syncState.update(Lt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:h}}async function Yh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),oa(a);let i=0,o=0,u=0,d,v=e.historyId;do{oa(a);const y=await op(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const x of y.history){if(x.messagesAdded){const k=x.messagesAdded.map(j=>j.message.id),w=[...new Set(k.filter(j=>j))];if(w.length>0){const j=await Promise.allSettled(w.map(T=>mu(t,T))),L=[];for(const T of j)T.status==="fulfilled"?L.push(Ou(T.value)):u++;L.length>0&&(await Be.items.bulkPut(L),await Du(L),i+=L.length)}}if(x.messagesDeleted){const k=x.messagesDeleted.map(w=>pu(Lt,w.message.id)).filter(w=>w);k.length>0&&(await Be.items.bulkDelete(k),o+=k.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const h=await Be.items.where("sourceType").equals(Lt).count();return await Be.syncState.put({sourceType:Lt,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:h,total:h}),{added:i,deleted:o,errors:u}}async function Pu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=Vl){oa(a);const d=e.slice(u,u+Vl),v=await Promise.allSettled(d.map(y=>mu(t,y))),h=[];for(const y of v)y.status==="fulfilled"?h.push(Ou(y.value)):o++;h.length>0&&(await Be.items.bulkPut(h),await Du(h)),i+=h.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Ou(t){const e=Tr(t,"From"),r=Tr(t,"To"),a=Tr(t,"Cc"),i=Tr(t,"Subject")||"(no subject)",o=Tr(t,"Date"),u=Tr(t,"Message-ID"),d=Tr(t,"In-Reply-To"),v=Tr(t,"References");let h;try{h=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:pu(Lt,t.id),sourceType:Lt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:lp(t),htmlBody:cp(t),date:h,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Du(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Vh(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Be.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await Be.contacts.update(o.id,u)}else await Be.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Vh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function oa(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Xh=G(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Qh(t,e){ut(e,!0);let r=Ie(e,"clientIdInput",15);Bt(()=>un("SetupGuide"));let a=Re(null);async function i(H){try{await navigator.clipboard.writeText(H),M(a,H,!0),setTimeout(()=>{M(a,null)},1500)}catch{const $=document.createElement("input");$.value=H,document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($),M(a,H,!0),setTimeout(()=>{M(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Xh(),h=_(v),y=S(_(h),4),x=S(_(y),6),k=S(_(x),2),w=S(_(k),2),j=S(_(w),2),L=_(j);L.__click=()=>i(o);var T=_(L);T.textContent="http://localhost:5173";var K=S(T,2),ae=_(K),se=S(L,2);se.__click=()=>i(u);var W=_(se);W.textContent="https://cypherkitty.github.io";var Z=S(W,2),ee=_(Z),F=S(w,2),ce=S(_(F),2),ye=_(ce);ye.__click=()=>i(o);var Ee=_(ye);Ee.textContent="http://localhost:5173";var ge=S(Ee,2),ne=_(ge),le=S(ye,2);le.__click=()=>i(u);var Pe=_(le);Pe.textContent="https://cypherkitty.github.io";var re=S(Pe,2),fe=_(re),de=S(le,2);de.__click=()=>i(d);var V=_(de);V.textContent="https://cypherkitty.github.io/me-ai/";var oe=S(V,2),ve=_(oe),we=S(y,2),Y=_(we);Y.__keydown=H=>H.key==="Enter"&&e.onsave();var J=S(Y,2);J.__click=function(...H){var $;($=e.onsave)==null||$.apply(this,H)},ue(H=>{ie(ae,m(a)===o?"â":"â§"),ie(ee,m(a)===u?"â":"â§"),ie(ne,m(a)===o?"â":"â§"),ie(fe,m(a)===u?"â":"â§"),ie(ve,m(a)===d?"â":"â§"),J.disabled=H},[()=>!r().trim()]),Lo(Y,r),z(t,v),ft()}Pt(["click","keydown"]);function Zh(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof No?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Jh=G('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),$h=G('<div class="error-card-title svelte-14buhqq"> </div>'),ev=G('<p class="error-card-fix svelte-14buhqq"> </p>'),tv=G('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),nv=G('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),rv=G('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function ju(t,e){ut(e,!0);let r=Ie(e,"ondismiss",3,null),a=Ie(e,"onsignout",3,null),i=dt(()=>Zh(e.error));Bt(()=>un("ErrorCard"));var o=rv(),u=_(o);{var d=K=>{var ae=Jh(),se=_(ae),W=_(se),Z=S(se,2);Z.__click=function(...ee){var F;(F=r())==null||F.apply(this,ee)},ue(()=>ie(W,m(i).title)),z(K,ae)},v=K=>{var ae=$h(),se=_(ae);ue(()=>ie(se,m(i).title)),z(K,ae)};be(u,K=>{r()?K(d):K(v,!1)})}var h=S(u,2),y=_(h),x=S(h,2);{var k=K=>{var ae=ev(),se=_(ae);ue(()=>ie(se,m(i).fix)),z(K,ae)};be(x,K=>{m(i).fix&&K(k)})}var w=S(x,2);{var j=K=>{var ae=tv(),se=_(ae);ue(()=>{uu(ae,"href",m(i).link.url),ie(se,`${m(i).link.label??""} â`)}),z(K,ae)};be(w,K=>{m(i).link&&K(j)})}var L=S(w,2);{var T=K=>{var ae=nv();ae.__click=function(...se){var W;(W=a())==null||W.apply(this,se)},z(K,ae)};be(L,K=>{m(i).action==="signout"&&a()&&K(T)})}ue(()=>ie(y,m(i).description)),z(t,o),ft()}Pt(["click"]);var av=G('<span class="spinner svelte-nyqevv"></span> Signing in...',1),sv=jo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),iv=G(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function ov(t,e){ut(e,!0);let r=Ie(e,"error",3,null),a=Ie(e,"loadingAuth",3,!1);Bt(()=>un("AuthCard"));var i=iv(),o=_(i),u=S(_(o),4);{var d=T=>{ju(T,{get error(){return r()},get onsignout(){return e.onsignout}})};be(u,T=>{r()&&T(d)})}var v=S(u,2);v.__click=function(...T){var K;(K=e.onsignin)==null||K.apply(this,T)};var h=_(v);{var y=T=>{var K=av();z(T,K)},x=T=>{var K=sv();z(T,K)};be(h,T=>{a()?T(y):T(x,!1)})}var k=S(v,2),w=S(_(k),2),j=_(w),L=S(w,2);L.__click=function(...T){var K;(K=e.onclear)==null||K.apply(this,T)},ue(T=>{v.disabled=a(),ie(j,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),z(t,i),ft()}Pt(["click"]);var lv=G('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),cv=G('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),uv=G('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function fv(t,e){ut(e,!0);let r=Ie(e,"profile",3,null),a=Ie(e,"loadingProfile",3,!1);Bt(()=>un("ProfileCard"));var i=uv(),o=_(i),u=_(o),d=S(o,2),v=_(d);{var h=k=>{var w=lv();z(k,w)},y=k=>{var w=cv(),j=st(w),L=_(j),T=S(j,2),K=_(T);ue((ae,se)=>{ie(L,r().emailAddress),ie(K,`${ae??""} messages
        Â· ${se??""} threads`)},[()=>{var ae;return((ae=r().messagesTotal)==null?void 0:ae.toLocaleString())||"?"},()=>{var ae;return((ae=r().threadsTotal)==null?void 0:ae.toLocaleString())||"?"}]),z(k,w)};be(v,k=>{a()?k(h):r()&&k(y,1)})}var x=S(d,2);x.__click=function(...k){var w;(w=e.onsignout)==null||w.apply(this,k)},ue(k=>ie(u,k),[()=>r()?bu(r().emailAddress):"?"]),z(t,i),ft()}Pt(["click"]);var dv=G('<span class="spinner svelte-1ds3j4k"></span>'),pv=jo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),hv=G('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),vv=G('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),gv=G('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),mv=G('<option class="svelte-1ds3j4k"> </option>'),yv=G('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),bv=G('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),_v=G('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),wv=G('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),kv=G('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),xv=G('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Sv(t,e){ut(e,!0),Bt(()=>un("SyncStatus"));let r=Ie(e,"syncStatus",3,null),a=Ie(e,"syncProgress",3,null),i=Ie(e,"isSyncing",3,!1),o=Re(!1),u=Re(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(V){if(!V)return"never";const oe=Math.floor((Date.now()-V)/1e3);if(oe<60)return"just now";const ve=Math.floor(oe/60);if(ve<60)return`${ve}m ago`;const we=Math.floor(ve/60);return we<24?`${we}h ago`:`${Math.floor(we/24)}d ago`}function h(){var V,oe;return!((V=a())!=null&&V.total)||!((oe=a())!=null&&oe.current)?0:Math.round(a().current/a().total*100)}var y=xv(),x=_(y),k=_(x),w=_(k);{var j=V=>{var oe=dv();z(V,oe)},L=V=>{var oe=pv();z(V,oe)};be(w,V=>{i()?V(j):V(L,!1)})}var T=S(k,2),K=S(_(T),2);{var ae=V=>{var oe=hv(),ve=_(oe),we=S(ve);{var Y=H=>{var $=Ml("Â· more available");z(H,$)},J=H=>{var $=Ml("Â· all synced");z(H,$)};be(we,H=>{r().hasMore?H(Y):H(J,!1)})}ue((H,$)=>ie(ve,`${H??""} emails stored
          Â· synced ${$??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),z(V,oe)},se=V=>{var oe=vv();z(V,oe)};be(K,V=>{var oe;(oe=r())!=null&&oe.synced?V(ae):V(se,!1)})}var W=S(T,2),Z=_(W);{var ee=V=>{var oe=gv();oe.__click=()=>M(o,!m(o)),z(V,oe)};be(Z,V=>{var oe;(oe=r())!=null&&oe.synced&&!i()&&V(ee)})}var F=S(x,2),ce=_(F),ye=S(_(ce),2);nn(ye,21,()=>d,hr,(V,oe)=>{var ve=mv(),we=_(ve),Y={};ue(()=>{ie(we,m(oe).label),Y!==(Y=m(oe).value)&&(ve.value=(ve.__value=m(oe).value)??"")}),z(V,ve)});var Ee=S(ce,2),ge=_(Ee);{var ne=V=>{var oe=bv(),ve=st(oe);ve.__click=()=>e.onsync(m(u));var we=_(ve),Y=S(ve,2);{var J=H=>{var $=yv();$.__click=()=>e.onsyncmore(m(u));var Me=_($);ue(()=>{$.disabled=i(),ie(Me,i()?"Loading...":"Sync More")}),z(H,$)};be(Y,H=>{r().hasMore&&H(J)})}ue(()=>{ve.disabled=i(),ie(we,i()?"Syncing...":"Sync New")}),z(V,oe)},le=V=>{var oe=_v();oe.__click=()=>e.onsync(m(u));var ve=_(oe);ue(()=>{oe.disabled=i(),ie(ve,i()?"Syncing...":"Download Emails")}),z(V,oe)};be(ge,V=>{var oe;(oe=r())!=null&&oe.synced?V(ne):V(le,!1)})}var Pe=S(F,2);{var re=V=>{var oe=wv(),ve=_(oe),we=_(ve);let Y,J;var H=S(ve,2),$=_(H);ue(Me=>{Y=Mt(we,1,"progress-fill svelte-1ds3j4k",null,Y,{indeterminate:!a().total}),J=tn(we,"",J,Me),ie($,a().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),z(V,oe)};be(Pe,V=>{i()&&a()&&V(re)})}var fe=S(Pe,2);{var de=V=>{var oe=kv(),ve=S(_(oe),2),we=_(ve);we.__click=()=>M(o,!1);var Y=S(we,2);Y.__click=()=>{e.onclear(),M(o,!1)},z(V,oe)};be(fe,V=>{m(o)&&V(de)})}ue(()=>ye.disabled=i()),Mo(ye,()=>m(u),V=>M(u,V)),z(t,y),ft()}Pt(["click"]);var Tv=G('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Ev=G('<div class="message-list svelte-y2uamw"></div>');function Av(t,e){ut(e,!0);let r=Ie(e,"messages",19,()=>[]);Bt(()=>un("MessageList"));var a=Ev();nn(a,21,r,hr,(i,o)=>{var u=Tv();u.__click=()=>e.onselect(m(o));var d=_(u),v=_(d),h=S(d,2),y=_(h),x=_(y),k=_(x),w=S(x,2),j=_(w),L=S(y,2),T=_(L),K=S(L,2),ae=_(K);ue((se,W,Z)=>{ie(v,se),ie(k,W),ie(j,Z),ie(T,m(o).subject),ie(ae,m(o).snippet)},[()=>bu(m(o).from),()=>yu(m(o).from),()=>qo(m(o).date)]),z(i,u)}),z(t,a),ft()}Pt(["click"]);function Fo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var fa=Fo();function Mu(t){fa=t}var Hr={exec:()=>null};function Je(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(Wt.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Cv=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Wt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Iv=/^(?:[ \t]*(?:\n|$))+/,Rv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Pv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ms=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ov=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ko=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Lu=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Nu=Je(Lu).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Dv=Je(Lu).replace(/bull/g,Ko).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Uo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jv=/^[^\n]+/,Go=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Mv=Je(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Go).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Lv=Je(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ko).getRegex(),di="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ho=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Nv=Je("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ho).replace("tag",di).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),qu=Je(Uo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),qv=Je(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",qu).getRegex(),Wo={blockquote:qv,code:Rv,def:Mv,fences:Pv,heading:Ov,hr:ms,html:Nv,lheading:Nu,list:Lv,newline:Iv,paragraph:qu,table:Hr,text:jv},Xl=Je("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),Bv={...Wo,lheading:Dv,table:Xl,paragraph:Je(Uo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex()},zv={...Wo,html:Je(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ho).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Hr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Je(Uo).replace("hr",ms).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Nu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Fv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Kv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Bu=/^( {2,}|\\)\n(?!\s*$)/,Uv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pi=/[\p{P}\p{S}]/u,Yo=/[\s\p{P}\p{S}]/u,zu=/[^\s\p{P}\p{S}]/u,Gv=Je(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Yo).getRegex(),Fu=/(?!~)[\p{P}\p{S}]/u,Hv=/(?!~)[\s\p{P}\p{S}]/u,Wv=/(?:[^\s\p{P}\p{S}]|~)/u,Ku=/(?![*_])[\p{P}\p{S}]/u,Yv=/(?![*_])[\s\p{P}\p{S}]/u,Vv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Xv=Je(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Cv?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Uu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Qv=Je(Uu,"u").replace(/punct/g,pi).getRegex(),Zv=Je(Uu,"u").replace(/punct/g,Fu).getRegex(),Gu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Jv=Je(Gu,"gu").replace(/notPunctSpace/g,zu).replace(/punctSpace/g,Yo).replace(/punct/g,pi).getRegex(),$v=Je(Gu,"gu").replace(/notPunctSpace/g,Wv).replace(/punctSpace/g,Hv).replace(/punct/g,Fu).getRegex(),eg=Je("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,zu).replace(/punctSpace/g,Yo).replace(/punct/g,pi).getRegex(),tg=Je(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Ku).getRegex(),ng="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",rg=Je(ng,"gu").replace(/notPunctSpace/g,Vv).replace(/punctSpace/g,Yv).replace(/punct/g,Ku).getRegex(),ag=Je(/\\(punct)/,"gu").replace(/punct/g,pi).getRegex(),sg=Je(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ig=Je(Ho).replace("(?:-->|$)","-->").getRegex(),og=Je("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ig).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,lg=Je(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Hu=Je(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",Go).getRegex(),Wu=Je(/^!?\[(ref)\](?:\[\])?/).replace("ref",Go).getRegex(),cg=Je("reflink|nolink(?!\\()","g").replace("reflink",Hu).replace("nolink",Wu).getRegex(),Ql=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Vo={_backpedal:Hr,anyPunctuation:ag,autolink:sg,blockSkip:Xv,br:Bu,code:Kv,del:Hr,delLDelim:Hr,delRDelim:Hr,emStrongLDelim:Qv,emStrongRDelimAst:Jv,emStrongRDelimUnd:eg,escape:Fv,link:lg,nolink:Wu,punctuation:Gv,reflink:Hu,reflinkSearch:cg,tag:og,text:Uv,url:Hr},ug={...Vo,link:Je(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:Je(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},vo={...Vo,emStrongRDelimAst:$v,emStrongLDelim:Zv,delLDelim:tg,delRDelim:rg,url:Je(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Ql).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Je(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Ql).getRegex()},fg={...vo,br:Je(Bu).replace("{2,}","*").getRegex(),text:Je(vo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Fs={normal:Wo,gfm:Bv,pedantic:zv},Ya={normal:Vo,gfm:vo,breaks:fg,pedantic:ug},dg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zl=t=>dg[t];function ar(t,e){if(e){if(Wt.escapeTest.test(t))return t.replace(Wt.escapeReplace,Zl)}else if(Wt.escapeTestNoEncode.test(t))return t.replace(Wt.escapeReplaceNoEncode,Zl);return t}function Jl(t){try{t=encodeURI(t).replace(Wt.percentDecode,"%")}catch{return null}return t}function $l(t,e){var o;let r=t.replace(Wt.findPipe,(u,d,v)=>{let h=!1,y=d;for(;--y>=0&&v[y]==="\\";)h=!h;return h?"|":" |"}),a=r.split(Wt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Wt.slashPipe,"|");return a}function Va(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function pg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function hg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function ec(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function vg(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ri=class{constructor(t){Ye(this,"options");Ye(this,"rules");Ye(this,"lexer");this.options=t||fa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Va(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=vg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Va(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Va(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Va(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),u=!0;else if(!u)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),y=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${h}`:h,i=i?`${i}
${y}`:y;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=x,r.length===0)break;let k=o.at(-1);if((k==null?void 0:k.type)==="code")break;if((k==null?void 0:k.type)==="blockquote"){let w=k,j=w.raw+`
`+r.join(`
`),L=this.blockquote(j);o[o.length-1]=L,a=a.substring(0,a.length-w.raw.length)+L.raw,i=i.substring(0,i.length-w.text.length)+L.text;break}else if((k==null?void 0:k.type)==="list"){let w=k,j=w.raw+`
`+r.join(`
`),L=this.list(j);o[o.length-1]=L,a=a.substring(0,a.length-k.raw.length)+L.raw,i=i.substring(0,i.length-w.raw.length)+L.raw,r=j.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,x="",k="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let w=hg(e[2].split(`
`,1)[0],e[1].length),j=t.split(`
`,1)[0],L=!w.trim(),T=0;if(this.options.pedantic?(T=2,k=w.trimStart()):L?T=e[1].length+1:(T=w.search(this.rules.other.nonSpaceChar),T=T>4?1:T,k=w.slice(T),T+=e[1].length),L&&this.rules.other.blankLine.test(j)&&(x+=j+`
`,t=t.substring(j.length+1),y=!0),!y){let K=this.rules.other.nextBulletRegex(T),ae=this.rules.other.hrRegex(T),se=this.rules.other.fencesBeginRegex(T),W=this.rules.other.headingBeginRegex(T),Z=this.rules.other.htmlBeginRegex(T),ee=this.rules.other.blockquoteBeginRegex(T);for(;t;){let F=t.split(`
`,1)[0],ce;if(j=F,this.options.pedantic?(j=j.replace(this.rules.other.listReplaceNesting,"  "),ce=j):ce=j.replace(this.rules.other.tabCharGlobal,"    "),se.test(j)||W.test(j)||Z.test(j)||ee.test(j)||K.test(j)||ae.test(j))break;if(ce.search(this.rules.other.nonSpaceChar)>=T||!j.trim())k+=`
`+ce.slice(T);else{if(L||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||se.test(w)||W.test(w)||ae.test(w))break;k+=`
`+j}L=!j.trim(),x+=F+`
`,t=t.substring(F.length+1),w=ce.slice(T)}}u.loose||(v?u.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(v=!0)),u.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(k),loose:!1,text:k,tokens:[]}),u.raw+=x}let h=u.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let y of u.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let k=this.lexer.inlineQueue.length-1;k>=0;k--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[k].src)){this.lexer.inlineQueue[k].src=this.lexer.inlineQueue[k].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(y.raw);if(x){let k={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};y.checked=k.checked,u.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=k.raw+y.tokens[0].raw,y.tokens[0].text=k.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(k)):y.tokens.unshift({type:"paragraph",raw:k.raw,text:k.raw,tokens:[k]}):y.tokens.unshift(k)}}if(!u.loose){let x=y.tokens.filter(w=>w.type==="space"),k=x.length>0&&x.some(w=>this.rules.other.anyLine.test(w.raw));u.loose=k}}if(u.loose)for(let y of u.items){y.loose=!0;for(let x of y.tokens)x.type==="text"&&(x.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=$l(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push($l(d,o.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[h]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Va(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=pg(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),ec(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return ec(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,v=0,h=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){v+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+v);let y=[...a[0]][0].length,x=t.slice(0,i+a.index+y+u);if(Math.min(i,u)%2){let w=x.slice(1,-1);return{type:"em",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}let k=x.slice(2,-2);return{type:"strong",raw:x,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let h=[...a[0]][0].length,y=t.slice(0,i+a.index+h+u),x=y.slice(i,-i);return{type:"del",raw:y,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},jn=class go{constructor(e){Ye(this,"tokens");Ye(this,"options");Ye(this,"state");Ye(this,"inlineQueue");Ye(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||fa,this.options.tokenizer=this.options.tokenizer||new ri,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Wt,block:Fs.normal,inline:Ya.normal};this.options.pedantic?(r.block=Fs.pedantic,r.inline=Ya.pedantic):this.options.gfm&&(r.block=Fs.gfm,this.options.breaks?r.inline=Ya.breaks:r.inline=Ya.gfm),this.tokenizer.rules=r}static get rules(){return{block:Fs,inline:Ya}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace(Wt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(Wt.tabCharGlobal,"    ").replace(Wt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((u=this.options.extensions)!=null&&u.startBlock){let h=1/0,y=e.slice(1),x;this.options.extensions.startBlock.forEach(k=>{x=k.call({lexer:this},y),typeof x=="number"&&x>=0&&(h=Math.min(h,x))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);a&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,y,x,k;let a=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let w;if((x=(y=this.options.extensions)==null?void 0:y.inline)!=null&&x.some(L=>(w=L.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let L=r.at(-1);w.type==="text"&&(L==null?void 0:L.type)==="text"?(L.raw+=w.raw,L.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,a,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let j=e;if((k=this.options.extensions)!=null&&k.startInline){let L=1/0,T=e.slice(1),K;this.options.extensions.startInline.forEach(ae=>{K=ae.call({lexer:this},T),typeof K=="number"&&K>=0&&(L=Math.min(L,K))}),L<1/0&&L>=0&&(j=e.substring(0,L+1))}if(w=this.tokenizer.inlineText(j)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),u=!0;let L=r.at(-1);(L==null?void 0:L.type)==="text"?(L.raw+=w.raw,L.text+=w.text):r.push(w);continue}if(e){let L="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(L);break}else throw new Error(L)}}return r}},ai=class{constructor(t){Ye(this,"options");Ye(this,"parser");this.options=t||fa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Wt.notSpaceStart))==null?void 0:o[0],i=t.replace(Wt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ar(a)+'">'+(r?i:ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Jl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ar(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Jl(t);if(i===null)return ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ar(t.text)}},Xo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Mn=class mo{constructor(e){Ye(this,"options");Ye(this,"renderer");Ye(this,"textRenderer");this.options=e||fa,this.options.renderer=this.options.renderer||new ai,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Xo}static parse(e,r){return new mo(r).parse(e)}static parseInline(e,r){return new mo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let v=u,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=h||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return a}},Gs,ts=(Gs=class{constructor(t){Ye(this,"options");Ye(this,"block");this.options=t||fa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?jn.lex:jn.lexInline}provideParser(){return this.block?Mn.parse:Mn.parseInline}},Ye(Gs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ye(Gs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Gs),gg=class{constructor(...t){Ye(this,"defaults",Fo());Ye(this,"options",this.setOptions);Ye(this,"parse",this.parseMarkdown(!0));Ye(this,"parseInline",this.parseMarkdown(!1));Ye(this,"Parser",Mn);Ye(this,"Renderer",ai);Ye(this,"TextRenderer",Xo);Ye(this,"Lexer",jn);Ye(this,"Tokenizer",ri);Ye(this,"Hooks",ts);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let v=u[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ai(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],v=i[u];i[u]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ri(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],v=i[u];i[u]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ts;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],v=i[u];ts.passThroughHooks.has(o)?i[u]=h=>{if(this.defaults.async&&ts.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,h);return v.call(i,x)})();let y=d.call(i,h);return v.call(i,y)}:i[u]=(...h)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,h);return x===!1&&(x=await v.apply(i,h)),x})();let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return jn.lex(t,e??this.defaults)}parser(t,e){return Mn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?jn.lex:jn.lexInline)(u,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let h=await(i.hooks?await i.hooks.provideParser():t?Mn.parse:Mn.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(h):h})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?jn.lex:jn.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Mn.parse:Mn.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},la=new gg;function nt(t,e){return la.parse(t,e)}nt.options=nt.setOptions=function(t){return la.setOptions(t),nt.defaults=la.defaults,Mu(nt.defaults),nt};nt.getDefaults=Fo;nt.defaults=fa;nt.use=function(...t){return la.use(...t),nt.defaults=la.defaults,Mu(nt.defaults),nt};nt.walkTokens=function(t,e){return la.walkTokens(t,e)};nt.parseInline=la.parseInline;nt.Parser=Mn;nt.parser=Mn.parse;nt.Renderer=ai;nt.TextRenderer=Xo;nt.Lexer=jn;nt.lexer=jn.lex;nt.Tokenizer=ri;nt.Hooks=ts;nt.parse=nt;nt.options;nt.setOptions;nt.use;nt.walkTokens;nt.parseInline;Mn.parse;jn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Yu,setPrototypeOf:tc,isFrozen:mg,getPrototypeOf:yg,getOwnPropertyDescriptor:bg}=Object;let{freeze:Yt,seal:Tn,create:yo}=Object,{apply:bo,construct:_o}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});Tn||(Tn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});_o||(_o=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ks=Vt(Array.prototype.forEach),_g=Vt(Array.prototype.lastIndexOf),nc=Vt(Array.prototype.pop),Xa=Vt(Array.prototype.push),wg=Vt(Array.prototype.splice),Zs=Vt(String.prototype.toLowerCase),Hi=Vt(String.prototype.toString),Wi=Vt(String.prototype.match),Qa=Vt(String.prototype.replace),kg=Vt(String.prototype.indexOf),xg=Vt(String.prototype.trim),On=Vt(Object.prototype.hasOwnProperty),Ht=Vt(RegExp.prototype.test),Za=Sg(TypeError);function Vt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function Sg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return _o(t,r)}}function We(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs;tc&&tc(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(mg(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Tg(t){for(let e=0;e<t.length;e++)On(t,e)||(t[e]=null);return t}function Hn(t){const e=yo(null);for(const[r,a]of Yu(t))On(t,r)&&(Array.isArray(a)?e[r]=Tg(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=Hn(a):e[r]=a);return e}function Ja(t,e){for(;t!==null;){const a=bg(t,e);if(a){if(a.get)return Vt(a.get);if(typeof a.value=="function")return Vt(a.value)}t=yg(t)}function r(){return null}return r}const rc=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yi=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Vi=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Eg=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xi=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ag=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ac=Yt(["#text"]),sc=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Qi=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ic=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Us=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Cg=Tn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ig=Tn(/<%[\w\W]*|[\w\W]*%>/gm),Rg=Tn(/\$\{[\w\W]*/gm),Pg=Tn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Og=Tn(/^aria-[\-\w]+$/),Vu=Tn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Dg=Tn(/^(?:\w+script|data):/i),jg=Tn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Xu=Tn(/^html$/i),Mg=Tn(/^[a-z][.\w]*(-[.\w]+)+$/i);var oc=Object.freeze({__proto__:null,ARIA_ATTR:Og,ATTR_WHITESPACE:jg,CUSTOM_ELEMENT:Mg,DATA_ATTR:Pg,DOCTYPE_NAME:Xu,ERB_EXPR:Ig,IS_ALLOWED_URI:Vu,IS_SCRIPT_OR_DATA:Dg,MUSTACHE_EXPR:Cg,TMPLIT_EXPR:Rg});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},Lg=function(){return typeof window>"u"?null:window},Ng=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},lc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Qu(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lg();const e=Le=>Qu(Le);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:v,NodeFilter:h,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:k,trustedTypes:w}=t,j=v.prototype,L=Ja(j,"cloneNode"),T=Ja(j,"remove"),K=Ja(j,"nextSibling"),ae=Ja(j,"childNodes"),se=Ja(j,"parentNode");if(typeof u=="function"){const Le=r.createElement("template");Le.content&&Le.content.ownerDocument&&(r=Le.content.ownerDocument)}let W,Z="";const{implementation:ee,createNodeIterator:F,createDocumentFragment:ce,getElementsByTagName:ye}=r,{importNode:Ee}=a;let ge=lc();e.isSupported=typeof Yu=="function"&&typeof se=="function"&&ee&&ee.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:le,TMPLIT_EXPR:Pe,DATA_ATTR:re,ARIA_ATTR:fe,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:V,CUSTOM_ELEMENT:oe}=oc;let{IS_ALLOWED_URI:ve}=oc,we=null;const Y=We({},[...rc,...Yi,...Vi,...Xi,...ac]);let J=null;const H=We({},[...sc,...Qi,...ic,...Us]);let $=Object.seal(yo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,Te=null;const Ue=Object.seal(yo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let rt=!0,te=!0,Ne=!1,qe=!0,Fe=!1,Tt=!0,vt=!1,fn=!1,Jn=!1,dn=!1,Gt=!1,kt=!1,mt=!0,pn=!1;const hn="user-content-";let zn=!0,En=!1,xt={},Et=null;const Dr=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let vr=null;const da=We({},["audio","video","img","source","image","track"]);let gr=null;const Fn=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$n="http://www.w3.org/1998/Math/MathML",mr="http://www.w3.org/2000/svg",At="http://www.w3.org/1999/xhtml";let je=At,er=!1,An=null;const pa=We({},[$n,mr,At],Hi);let Ae=We({},["mi","mo","mn","ms","mtext"]),yr=We({},["annotation-xml"]);const ys=We({},["title","style","font","a","script"]);let tr=null;const bs=["application/xhtml+xml","text/html"],ja="text/html";let yt=null,br=null;const _r=r.createElement("form"),nr=function(A){return A instanceof RegExp||A instanceof Function},jr=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(br&&br===A)){if((!A||typeof A!="object")&&(A={}),A=Hn(A),tr=bs.indexOf(A.PARSER_MEDIA_TYPE)===-1?ja:A.PARSER_MEDIA_TYPE,yt=tr==="application/xhtml+xml"?Hi:Zs,we=On(A,"ALLOWED_TAGS")?We({},A.ALLOWED_TAGS,yt):Y,J=On(A,"ALLOWED_ATTR")?We({},A.ALLOWED_ATTR,yt):H,An=On(A,"ALLOWED_NAMESPACES")?We({},A.ALLOWED_NAMESPACES,Hi):pa,gr=On(A,"ADD_URI_SAFE_ATTR")?We(Hn(Fn),A.ADD_URI_SAFE_ATTR,yt):Fn,vr=On(A,"ADD_DATA_URI_TAGS")?We(Hn(da),A.ADD_DATA_URI_TAGS,yt):da,Et=On(A,"FORBID_CONTENTS")?We({},A.FORBID_CONTENTS,yt):Dr,Me=On(A,"FORBID_TAGS")?We({},A.FORBID_TAGS,yt):Hn({}),Te=On(A,"FORBID_ATTR")?We({},A.FORBID_ATTR,yt):Hn({}),xt=On(A,"USE_PROFILES")?A.USE_PROFILES:!1,rt=A.ALLOW_ARIA_ATTR!==!1,te=A.ALLOW_DATA_ATTR!==!1,Ne=A.ALLOW_UNKNOWN_PROTOCOLS||!1,qe=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Fe=A.SAFE_FOR_TEMPLATES||!1,Tt=A.SAFE_FOR_XML!==!1,vt=A.WHOLE_DOCUMENT||!1,dn=A.RETURN_DOM||!1,Gt=A.RETURN_DOM_FRAGMENT||!1,kt=A.RETURN_TRUSTED_TYPE||!1,Jn=A.FORCE_BODY||!1,mt=A.SANITIZE_DOM!==!1,pn=A.SANITIZE_NAMED_PROPS||!1,zn=A.KEEP_CONTENT!==!1,En=A.IN_PLACE||!1,ve=A.ALLOWED_URI_REGEXP||Vu,je=A.NAMESPACE||At,Ae=A.MATHML_TEXT_INTEGRATION_POINTS||Ae,yr=A.HTML_INTEGRATION_POINTS||yr,$=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&nr(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&nr(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(te=!1),Gt&&(dn=!0),xt&&(we=We({},ac),J=[],xt.html===!0&&(We(we,rc),We(J,sc)),xt.svg===!0&&(We(we,Yi),We(J,Qi),We(J,Us)),xt.svgFilters===!0&&(We(we,Vi),We(J,Qi),We(J,Us)),xt.mathMl===!0&&(We(we,Xi),We(J,ic),We(J,Us))),A.ADD_TAGS&&(typeof A.ADD_TAGS=="function"?Ue.tagCheck=A.ADD_TAGS:(we===Y&&(we=Hn(we)),We(we,A.ADD_TAGS,yt))),A.ADD_ATTR&&(typeof A.ADD_ATTR=="function"?Ue.attributeCheck=A.ADD_ATTR:(J===H&&(J=Hn(J)),We(J,A.ADD_ATTR,yt))),A.ADD_URI_SAFE_ATTR&&We(gr,A.ADD_URI_SAFE_ATTR,yt),A.FORBID_CONTENTS&&(Et===Dr&&(Et=Hn(Et)),We(Et,A.FORBID_CONTENTS,yt)),A.ADD_FORBID_CONTENTS&&(Et===Dr&&(Et=Hn(Et)),We(Et,A.ADD_FORBID_CONTENTS,yt)),zn&&(we["#text"]=!0),vt&&We(we,["html","head","body"]),we.table&&(We(we,["tbody"]),delete Me.tbody),A.TRUSTED_TYPES_POLICY){if(typeof A.TRUSTED_TYPES_POLICY.createHTML!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof A.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');W=A.TRUSTED_TYPES_POLICY,Z=W.createHTML("")}else W===void 0&&(W=Ng(w,i)),W!==null&&typeof Z=="string"&&(Z=W.createHTML(""));Yt&&Yt(A),br=A}},Mr=We({},[...Yi,...Vi,...Eg]),it=We({},[...Xi,...Ag]),St=function(A){let me=se(A);(!me||!me.tagName)&&(me={namespaceURI:je,tagName:"template"});const ke=Zs(A.tagName),$e=Zs(me.tagName);return An[A.namespaceURI]?A.namespaceURI===mr?me.namespaceURI===At?ke==="svg":me.namespaceURI===$n?ke==="svg"&&($e==="annotation-xml"||Ae[$e]):!!Mr[ke]:A.namespaceURI===$n?me.namespaceURI===At?ke==="math":me.namespaceURI===mr?ke==="math"&&yr[$e]:!!it[ke]:A.namespaceURI===At?me.namespaceURI===mr&&!yr[$e]||me.namespaceURI===$n&&!Ae[$e]?!1:!it[ke]&&(ys[ke]||!Mr[ke]):!!(tr==="application/xhtml+xml"&&An[A.namespaceURI]):!1},vn=function(A){Xa(e.removed,{element:A});try{se(A).removeChild(A)}catch{T(A)}},gn=function(A,me){try{Xa(e.removed,{attribute:me.getAttributeNode(A),from:me})}catch{Xa(e.removed,{attribute:null,from:me})}if(me.removeAttribute(A),A==="is")if(dn||Gt)try{vn(me)}catch{}else try{me.setAttribute(A,"")}catch{}},Lr=function(A){let me=null,ke=null;if(Jn)A="<remove></remove>"+A;else{const pt=Wi(A,/^[\r\n\t ]+/);ke=pt&&pt[0]}tr==="application/xhtml+xml"&&je===At&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");const $e=W?W.createHTML(A):A;if(je===At)try{me=new k().parseFromString($e,tr)}catch{}if(!me||!me.documentElement){me=ee.createDocument(je,"template",null);try{me.documentElement.innerHTML=er?Z:$e}catch{}}const ot=me.body||me.documentElement;return A&&ke&&ot.insertBefore(r.createTextNode(ke),ot.childNodes[0]||null),je===At?ye.call(me,vt?"html":"body")[0]:vt?me.documentElement:ot},Nr=function(A){return F.call(A.ownerDocument||A,A,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Ma=function(A){return A instanceof x&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof y)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},Cn=function(A){return typeof d=="function"&&A instanceof d};function zt(Le,A,me){Ks(Le,ke=>{ke.call(e,A,me,br)})}const In=function(A){let me=null;if(zt(ge.beforeSanitizeElements,A,null),Ma(A))return vn(A),!0;const ke=yt(A.nodeName);if(zt(ge.uponSanitizeElement,A,{tagName:ke,allowedTags:we}),Tt&&A.hasChildNodes()&&!Cn(A.firstElementChild)&&Ht(/<[/\w!]/g,A.innerHTML)&&Ht(/<[/\w!]/g,A.textContent)||A.nodeType===$a.progressingInstruction||Tt&&A.nodeType===$a.comment&&Ht(/<[/\w]/g,A.data))return vn(A),!0;if(!(Ue.tagCheck instanceof Function&&Ue.tagCheck(ke))&&(!we[ke]||Me[ke])){if(!Me[ke]&&_s(ke)&&($.tagNameCheck instanceof RegExp&&Ht($.tagNameCheck,ke)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ke)))return!1;if(zn&&!Et[ke]){const $e=se(A)||A.parentNode,ot=ae(A)||A.childNodes;if(ot&&$e){const pt=ot.length;for(let bt=pt-1;bt>=0;--bt){const Xt=L(ot[bt],!0);Xt.__removalCount=(A.__removalCount||0)+1,$e.insertBefore(Xt,K(A))}}}return vn(A),!0}return A instanceof v&&!St(A)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&Ht(/<\/no(script|embed|frames)/i,A.innerHTML)?(vn(A),!0):(Fe&&A.nodeType===$a.text&&(me=A.textContent,Ks([ne,le,Pe],$e=>{me=Qa(me,$e," ")}),A.textContent!==me&&(Xa(e.removed,{element:A.cloneNode()}),A.textContent=me)),zt(ge.afterSanitizeElements,A,null),!1)},qr=function(A,me,ke){if(mt&&(me==="id"||me==="name")&&(ke in r||ke in _r))return!1;if(!(te&&!Te[me]&&Ht(re,me))){if(!(rt&&Ht(fe,me))){if(!(Ue.attributeCheck instanceof Function&&Ue.attributeCheck(me,A))){if(!J[me]||Te[me]){if(!(_s(A)&&($.tagNameCheck instanceof RegExp&&Ht($.tagNameCheck,A)||$.tagNameCheck instanceof Function&&$.tagNameCheck(A))&&($.attributeNameCheck instanceof RegExp&&Ht($.attributeNameCheck,me)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(me,A))||me==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&Ht($.tagNameCheck,ke)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ke))))return!1}else if(!gr[me]){if(!Ht(ve,Qa(ke,V,""))){if(!((me==="src"||me==="xlink:href"||me==="href")&&A!=="script"&&kg(ke,"data:")===0&&vr[A])){if(!(Ne&&!Ht(de,Qa(ke,V,"")))){if(ke)return!1}}}}}}}return!0},_s=function(A){return A!=="annotation-xml"&&Wi(A,oe)},Rn=function(A){zt(ge.beforeSanitizeAttributes,A,null);const{attributes:me}=A;if(!me||Ma(A))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J,forceKeepAttr:void 0};let $e=me.length;for(;$e--;){const ot=me[$e],{name:pt,namespaceURI:bt,value:Xt}=ot,Kn=yt(pt),Br=Xt;let ct=pt==="value"?Br:xg(Br);if(ke.attrName=Kn,ke.attrValue=ct,ke.keepAttr=!0,ke.forceKeepAttr=void 0,zt(ge.uponSanitizeAttribute,A,ke),ct=ke.attrValue,pn&&(Kn==="id"||Kn==="name")&&(gn(pt,A),ct=hn+ct),Tt&&Ht(/((--!?|])>)|<\/(style|title|textarea)/i,ct)){gn(pt,A);continue}if(Kn==="attributename"&&Wi(ct,"href")){gn(pt,A);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){gn(pt,A);continue}if(!qe&&Ht(/\/>/i,ct)){gn(pt,A);continue}Fe&&Ks([ne,le,Pe],zr=>{ct=Qa(ct,zr," ")});const La=yt(A.nodeName);if(!qr(La,Kn,ct)){gn(pt,A);continue}if(W&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!bt)switch(w.getAttributeType(La,Kn)){case"TrustedHTML":{ct=W.createHTML(ct);break}case"TrustedScriptURL":{ct=W.createScriptURL(ct);break}}if(ct!==Br)try{bt?A.setAttributeNS(bt,pt,ct):A.setAttribute(pt,ct),Ma(A)?vn(A):nc(e.removed)}catch{gn(pt,A)}}zt(ge.afterSanitizeAttributes,A,null)},ws=function Le(A){let me=null;const ke=Nr(A);for(zt(ge.beforeSanitizeShadowDOM,A,null);me=ke.nextNode();)zt(ge.uponSanitizeShadowNode,me,null),In(me),Rn(me),me.content instanceof o&&Le(me.content);zt(ge.afterSanitizeShadowDOM,A,null)};return e.sanitize=function(Le){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},me=null,ke=null,$e=null,ot=null;if(er=!Le,er&&(Le="<!-->"),typeof Le!="string"&&!Cn(Le))if(typeof Le.toString=="function"){if(Le=Le.toString(),typeof Le!="string")throw Za("dirty is not a string, aborting")}else throw Za("toString is not a function");if(!e.isSupported)return Le;if(fn||jr(A),e.removed=[],typeof Le=="string"&&(En=!1),En){if(Le.nodeName){const Xt=yt(Le.nodeName);if(!we[Xt]||Me[Xt])throw Za("root node is forbidden and cannot be sanitized in-place")}}else if(Le instanceof d)me=Lr("<!---->"),ke=me.ownerDocument.importNode(Le,!0),ke.nodeType===$a.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?me=ke:me.appendChild(ke);else{if(!dn&&!Fe&&!vt&&Le.indexOf("<")===-1)return W&&kt?W.createHTML(Le):Le;if(me=Lr(Le),!me)return dn?null:kt?Z:""}me&&Jn&&vn(me.firstChild);const pt=Nr(En?Le:me);for(;$e=pt.nextNode();)In($e),Rn($e),$e.content instanceof o&&ws($e.content);if(En)return Le;if(dn){if(Gt)for(ot=ce.call(me.ownerDocument);me.firstChild;)ot.appendChild(me.firstChild);else ot=me;return(J.shadowroot||J.shadowrootmode)&&(ot=Ee.call(a,ot,!0)),ot}let bt=vt?me.outerHTML:me.innerHTML;return vt&&we["!doctype"]&&me.ownerDocument&&me.ownerDocument.doctype&&me.ownerDocument.doctype.name&&Ht(Xu,me.ownerDocument.doctype.name)&&(bt="<!DOCTYPE "+me.ownerDocument.doctype.name+`>
`+bt),Fe&&Ks([ne,le,Pe],Xt=>{bt=Qa(bt,Xt," ")}),W&&kt?W.createHTML(bt):bt},e.setConfig=function(){let Le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jr(Le),fn=!0},e.clearConfig=function(){br=null,fn=!1},e.isValidAttribute=function(Le,A,me){br||jr({});const ke=yt(Le),$e=yt(A);return qr(ke,$e,me)},e.addHook=function(Le,A){typeof A=="function"&&Xa(ge[Le],A)},e.removeHook=function(Le,A){if(A!==void 0){const me=_g(ge[Le],A);return me===-1?void 0:wg(ge[Le],me,1)[0]}return nc(ge[Le])},e.removeHooks=function(Le){ge[Le]=[]},e.removeAllHooks=function(){ge=lc()},e}var qg=Qu();function Bg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${cc(t.from)} |`),e.push(`| **To** | ${cc(t.to)} |`),e.push(`| **Date** | ${qo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?zg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function cc(t){return(t||"").replace(/\|/g,"\\|")}function zg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return wo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Fg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function wo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Fg(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(wo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>wo(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Kg(t){return _u(t,"md")}function uc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Ug(t){return t.raw||null}function Gg(t){const e=Ug(t);return e?JSON.stringify(e,null,2):"null"}function Hg(t){return _u(t,"json")}var Wg=G('<button title="View as Markdown">.md</button>'),Yg=G('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Vg=G('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Xg=G('<div class="md-preview svelte-1b0rzpb"><!></div>'),Qg=G('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Zg=G('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Jg=G('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),$g=G('<pre class="message-text svelte-1b0rzpb"> </pre>'),em=G('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),tm=G('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),nm=G('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function rm(t,e){ut(e,!0);let r=Ie(e,"loading",3,!1);Bt(()=>un("MessageModal"));const a=new nt.Renderer;a.link=({href:ne,title:le,text:Pe})=>{const re=le?` title="${le}"`:"";return`<a href="${ne}"${re} target="_blank" rel="noopener">${Pe}</a>`},nt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Re("email"),o=dt(()=>e.message.body?Bg(e.message):""),u=dt(()=>Gg(e.message)),d=Re("raw");function v(ne){M(i,m(i)===ne?"email":ne,!0),ne==="markdown"&&M(d,"raw")}function h(){uc(m(o),Kg(e.message))}function y(){uc(m(u),Hg(e.message),"application/json;charset=utf-8")}function x(ne){const le=nt.parse(ne);return qg.sanitize(le,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let k=Re(null);$s(()=>{var ne;if(m(k)&&e.message.htmlBody&&!r()&&m(i)==="email"){const le=m(k).contentDocument||((ne=m(k).contentWindow)==null?void 0:ne.document);le&&(le.open(),le.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),le.close())}});var w=nm();w.__click=function(...ne){var le;(le=e.onclose)==null||le.apply(this,ne)};var j=_(w);j.__click=ne=>ne.stopPropagation();var L=_(j),T=_(L),K=_(T),ae=S(T,2),se=_(ae);let W;se.__click=()=>v("json");var Z=S(se,2);{var ee=ne=>{var le=Wg();let Pe;le.__click=()=>v("markdown"),ue(()=>Pe=Mt(le,1,"action-btn svelte-1b0rzpb",null,Pe,{active:m(i)==="markdown"})),z(ne,le)};be(Z,ne=>{e.message.body&&ne(ee)})}var F=S(Z,2);F.__click=function(...ne){var le;(le=e.onclose)==null||le.apply(this,ne)};var ce=S(L,2);{var ye=ne=>{var le=Yg(),Pe=st(le),re=S(_(Pe),2);re.__click=y;var fe=S(Pe,2),de=_(fe),V=_(de);ue(()=>ie(V,m(u))),z(ne,le)},Ee=ne=>{var le=Qg(),Pe=st(le),re=_(Pe),fe=_(re);let de;fe.__click=()=>M(d,"raw");var V=S(fe,2);let oe;V.__click=()=>M(d,"preview");var ve=S(re,2);ve.__click=h;var we=S(Pe,2),Y=_(we);{var J=$=>{var Me=Vg(),Te=_(Me);ue(()=>ie(Te,m(o))),z($,Me)},H=$=>{var Me=Xg(),Te=_(Me);Kd(Te,()=>x(m(o))),z($,Me)};be(Y,$=>{m(d)==="raw"?$(J):$(H,!1)})}ue(()=>{de=Mt(fe,1,"md-tab svelte-1b0rzpb",null,de,{active:m(d)==="raw"}),oe=Mt(V,1,"md-tab svelte-1b0rzpb",null,oe,{active:m(d)==="preview"})}),z(ne,le)},ge=ne=>{var le=tm(),Pe=st(le),re=_(Pe),fe=S(_(re),2),de=_(fe),V=S(re,2),oe=S(_(V),2),ve=_(oe),we=S(V,2),Y=S(_(we),2),J=_(Y),H=S(Pe,2),$=_(H);{var Me=te=>{var Ne=Zg();z(te,Ne)},Te=te=>{var Ne=Jg();fu(Ne,qe=>M(k,qe),()=>m(k)),z(te,Ne)},Ue=te=>{var Ne=$g(),qe=_(Ne);ue(()=>ie(qe,e.message.body)),z(te,Ne)},rt=te=>{var Ne=em();z(te,Ne)};be($,te=>{r()?te(Me):e.message.htmlBody?te(Te,1):e.message.body?te(Ue,2):te(rt,!1)})}ue(te=>{ie(de,e.message.from),ie(ve,e.message.to),ie(J,te)},[()=>qo(e.message.date)]),z(ne,le)};be(ce,ne=>{m(i)==="json"?ne(ye):m(i)==="markdown"?ne(Ee,1):ne(ge,!1)})}ue(()=>{ie(K,e.message.subject),W=Mt(se,1,"action-btn svelte-1b0rzpb",null,W,{active:m(i)==="json"})}),z(t,w),ft()}Pt(["click"]);var am=G('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),sm=G('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),im=G('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),om=G("<p> </p>"),lm=G('<p>No emails in local storage. Click "Sync New" to download.</p>'),cm=G('<div class="empty-state svelte-6ts5xm"><!></div>'),um=G('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),fm=G('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function dm(t,e){ut(e,!0),Bt(()=>un("DashboardView"));let r=Ie(e,"error",3,null),a=Ie(e,"profile",3,null),i=Ie(e,"loadingProfile",3,!1),o=Ie(e,"emailMessages",19,()=>[]),u=Ie(e,"totalLocalMessages",3,0),d=Ie(e,"hasMoreLocal",3,!1),v=Ie(e,"loadingMessages",3,!1),h=Ie(e,"selectedMessage",3,null),y=Ie(e,"syncStatus",3,null),x=Ie(e,"syncProgress",3,null),k=Ie(e,"isSyncing",3,!1),w=Ie(e,"searchQuery",15);var j=fm(),L=st(j),T=_(L);{var K=re=>{ju(re,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};be(T,re=>{r()&&re(K)})}var ae=S(T,2);fv(ae,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var se=S(ae,2);Sv(se,{get syncStatus(){return y()},get syncProgress(){return x()},get isSyncing(){return k()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var W=S(se,2),Z=_(W);Z.__keydown=re=>re.key==="Enter"&&e.onsearch();var ee=S(Z,2);ee.__click=function(...re){var fe;(fe=e.onsearch)==null||fe.apply(this,re)};var F=_(ee),ce=S(W,2);{var ye=re=>{var fe=sm(),de=st(fe),V=_(de),oe=_(V),ve=S(de,2);Av(ve,{get messages(){return o()},get onselect(){return e.onviewmessage}});var we=S(ve,2);{var Y=J=>{var H=am(),$=_(H);$.__click=function(...Te){var Ue;(Ue=e.onloadmore)==null||Ue.apply(this,Te)};var Me=_($);ue(()=>{$.disabled=v(),ie(Me,v()?"Loading...":"Load More")}),z(J,H)};be(we,J=>{d()&&J(Y)})}ue(J=>ie(oe,`Showing ${o().length??""} of ${J??""}
        ${w()?" matching":""} emails`),[()=>u().toLocaleString()]),z(re,fe)},Ee=re=>{var fe=im();z(re,fe)},ge=re=>{var fe=cm(),de=_(fe);{var V=ve=>{var we=om(),Y=_(we);ue(()=>ie(Y,`No emails match "${w()??""}".`)),z(ve,we)},oe=ve=>{var we=lm();z(ve,we)};be(de,ve=>{w()?ve(V):ve(oe,!1)})}z(re,fe)},ne=re=>{var fe=um();z(re,fe)};be(ce,re=>{var fe;o().length>0?re(ye):v()?re(Ee,1):(fe=y())!=null&&fe.synced?re(ge,2):re(ne,!1)})}var le=S(L,2);{var Pe=re=>{rm(re,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};be(le,re=>{h()&&re(Pe)})}ue(()=>{ee.disabled=v(),ie(F,v()?"Searching...":"Search")}),Lo(Z,w),z(t,j),ft()}Pt(["keydown","click"]);var pm=G('<div class="dashboard svelte-1q5o2lv"><!></div>');function hm(t,e){ut(e,!0);function r(Te){Te.key==="Escape"&&m(v)&&de()}Bt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Re(jt(localStorage.getItem("googleClientId")||"")),i=Re(jt(localStorage.getItem("googleClientId")||"")),o=Re(!1),u=Re(null),d=Re(null),v=Re(null),h=Re(""),y=Re(jt([])),x=Re(0),k=Re(0),w=Re(!1),j=Re(!1),L=Re(!1),T=Re(null),K=Re(null),ae=Re(null),se=Re(!1);const W=50;$s(()=>{m(u)&&(V(),le())});let Z=dt(()=>!m(a)),ee=dt(()=>!!m(u)),F=dt(()=>m(y).length<m(x));$s(()=>{m(a)&&!m(o)&&Yl(m(a)).then(()=>{if(M(o,!0),!m(u)){const Te=qh();Te&&(M(u,Te.access_token,!0),ne())}}).catch(Te=>{M(T,`Auth init failed: ${Te.message}`)})});function ce(){const Te=m(i).trim();Te&&(localStorage.setItem("googleClientId",Te),M(a,Te,!0),M(T,null))}function ye(){localStorage.removeItem("googleClientId"),M(a,""),M(i,""),M(o,!1),M(u,null),M(d,null),M(y,[],!0),M(x,0)}async function Ee(){M(T,null),M(j,!0);try{m(o)||(await Yl(m(a)),M(o,!0));const Te=await zh();M(u,Te.access_token,!0),await ne()}catch(Te){M(T,Te.message,!0)}finally{M(j,!1)}}async function ge(){if(m(u))try{await Fh(m(u))}catch{}M(u,null),M(d,null),M(y,[],!0),M(x,0),M(v,null),M(T,null)}async function ne(){M(L,!0);try{const Te=await vu(m(u));if(!m(u))return;M(d,Te,!0)}catch(Te){if(!m(u))return;M(T,`Profile fetch failed: ${Te.message}`)}finally{M(L,!1)}}async function le(Te=!1){M(w,!0);try{const Ue=Te?m(k):0,rt=await mp({query:m(h)||void 0,limit:W,offset:Ue});Te?M(y,[...m(y),...rt.items],!0):M(y,rt.items,!0),M(x,rt.total,!0),M(k,m(y).length,!0)}catch(Ue){M(T,`Failed to load messages: ${Ue.message}`)}finally{M(w,!1)}}function Pe(){M(k,0),le(!1)}function re(){le(!0)}function fe(Te){M(v,Te,!0)}function de(){M(v,null)}async function V(){try{M(K,await Gh(),!0)}catch{}}async function oe(Te){if(m(se)||!m(u))return;M(T,null),M(se,!0),M(ae,null);const Ue=new AbortController;try{await Kh(m(u),{limit:Te,onProgress:rt=>{M(ae,{...rt},!0)},signal:Ue.signal}),await V(),await le(!1)}catch(rt){if(rt.name!=="AbortError"){if(!m(u))return;M(T,`Sync failed: ${rt.message}`)}}finally{M(se,!1)}}async function ve(Te){if(m(se)||!m(u))return;M(T,null),M(se,!0),M(ae,null);const Ue=new AbortController;try{await Uh(m(u),{limit:Te,onProgress:rt=>{M(ae,{...rt},!0)},signal:Ue.signal}),await V(),await le(!1)}catch(rt){if(rt.name!=="AbortError"){if(!m(u))return;M(T,`Sync more failed: ${rt.message}`)}}finally{M(se,!1)}}async function we(){try{await Ru(),await V(),M(y,[],!0),M(x,0),M(k,0)}catch(Te){M(T,`Failed to clear data: ${Te.message}`)}}var Y=pm(),J=_(Y);{var H=Te=>{Qh(Te,{onsave:ce,get clientIdInput(){return m(i)},set clientIdInput(Ue){M(i,Ue,!0)}})},$=Te=>{ov(Te,{get clientId(){return m(a)},get error(){return m(T)},get loadingAuth(){return m(j)},onsignin:Ee,onclear:ye,onsignout:ge})},Me=Te=>{dm(Te,{get error(){return m(T)},get profile(){return m(d)},get loadingProfile(){return m(L)},get emailMessages(){return m(y)},get totalLocalMessages(){return m(x)},get hasMoreLocal(){return m(F)},get loadingMessages(){return m(w)},get selectedMessage(){return m(v)},get syncStatus(){return m(K)},get syncProgress(){return m(ae)},get isSyncing(){return m(se)},onsignout:ge,onsearch:Pe,onloadmore:re,onviewmessage:fe,onclosedetail:de,ondismisserror:()=>M(T,null),onsync:oe,onsyncmore:ve,oncleardata:we,get searchQuery(){return m(h)},set searchQuery(Ue){M(h,Ue,!0)}})};be(J,Te=>{m(Z)?Te(H):m(ee)?Te(Me,!1):Te($,1)})}z(t,Y),ft()}var vm=G('<span class="spinner svelte-ois7em"></span>'),gm=jo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),mm=G('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),ym=G('<option class="svelte-ois7em"> </option>'),bm=G('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),_m=G('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),wm=G('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="12" cy="12" r="10" class="svelte-ois7em"></circle><path d="M12 16v-4" class="svelte-ois7em"></path><path d="M12 8h.01" class="svelte-ois7em"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function km(t,e){ut(e,!0);let r=Ie(e,"engineStatus",3,"idle"),a=Ie(e,"modelName",3,""),i=Ie(e,"isScanning",3,!1),o=Ie(e,"scanProgress",3,null),u=Ie(e,"scanCount",15,20),d=Ie(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function h(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var k=wm(),w=_(k),j=_(w),L=_(j);{var T=Y=>{var J=vm();z(Y,J)},K=Y=>{var J=gm();z(Y,J)};be(L,Y=>{i()?Y(T):Y(K,!1)})}var ae=S(j,2),se=_(ae),W=S(_(se),2);W.__click=function(...Y){var J;(J=e.oninspect)==null||J.apply(this,Y)};var Z=S(se,2),ee=_(Z);let F;var ce=S(ee),ye=S(w,2);{var Ee=Y=>{var J=mm(),H=_(J),$=_(H),Me=S(H,4),Te=_(Me),Ue=S(Me,4),rt=_(Ue);ue(()=>{ie($,`${d().totalEmails??""} emails in storage`),ie(Te,`${d().classified??""} classified`),ie(rt,`${d().unclassified??""} new`)}),z(Y,J)};be(ye,Y=>{d()&&Y(Ee)})}var ge=S(ye,2),ne=_(ge),le=S(_(ne),2);nn(le,21,()=>v,hr,(Y,J)=>{var H=ym(),$=_(H),Me={};ue(()=>{ie($,m(J).label),Me!==(Me=m(J).value)&&(H.value=(H.__value=m(J).value)??"")}),z(Y,H)});var Pe=S(ne,2),re=_(Pe);re.__click=function(...Y){var J;(J=e.onscan)==null||J.apply(this,Y)};var fe=_(re),de=S(re,2);de.__click=function(...Y){var J;(J=e.onrescan)==null||J.apply(this,Y)};var V=S(ge,2);{var oe=Y=>{var J=bm();z(Y,J)};be(V,Y=>{r()!=="ready"&&r()!=="loading"&&Y(oe)})}var ve=S(V,2);{var we=Y=>{var J=_m(),H=_(J),$=_(H);let Me,Te;var Ue=S(H,2),rt=_(Ue);ue(()=>{Me=Mt($,1,"progress-fill svelte-ois7em",null,Me,{indeterminate:!o().total}),Te=tn($,"",Te,{width:`${o().total?o().current/o().total*100:0}%`}),ie(rt,o().message||"Scanning...")}),z(Y,J)};be(ve,Y=>{i()&&o()&&Y(we)})}ue((Y,J,H,$)=>{F=tn(ee,"",F,Y),ie(ce,` ${J??""}`),le.disabled=i(),re.disabled=H,ie(fe,i()?"Scanning...":"Scan New"),de.disabled=$},[()=>({background:y()}),h,()=>!x(),()=>!x()]),Mo(le,u),z(t,k),ft()}Pt(["click"]);var xm=G('<span class="row-date svelte-1czytqk"> </span>'),Sm=G('<span class="tag svelte-1czytqk"> </span>'),Tm=G('<span class="row-tags svelte-1czytqk"></span>'),Em=G('<span class="row-reason svelte-1czytqk"> </span>'),Am=G('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),Cm=G('<span class="status-label svelte-1czytqk"> </span>'),Im=G('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Rm=G('<p class="summary-reason svelte-1czytqk"> </p>'),Pm=G('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Om=G('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function fc(t,e){ut(e,!0);let r=Ie(e,"actionColor",3,"#666"),a=Ie(e,"dimmed",3,!1);function i(re){if(!re)return"";try{return new Date(re).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=dt(()=>e.item.status==="pending"),u=Re(!1);var d=Om(),v=st(d);let h;var y=_(v);y.__click=()=>M(u,!m(u));let x;var k=_(y),w=_(k),j=S(k,2),L=_(j),T=_(L),K=S(L,2);{var ae=re=>{var fe=xm(),de=_(fe);ue(V=>ie(de,V),[()=>i(e.item.date)]),z(re,fe)};be(K,re=>{e.item.date&&re(ae)})}var se=S(j,2);{var W=re=>{var fe=Tm();nn(fe,21,()=>e.item.tags,hr,(de,V)=>{var oe=Sm();let ve;var we=_(oe);ue(Y=>{ve=tn(oe,"",ve,Y),ie(we,m(V))},[()=>({background:Ep(m(V))})]),z(de,oe)}),z(re,fe)};be(se,re=>{e.item.tags&&e.item.tags.length>0&&re(W)})}var Z=S(se,2);{var ee=re=>{var fe=Em(),de=_(fe);ue(()=>ie(de,e.item.reason)),z(re,fe)};be(Z,re=>{e.item.reason&&!m(u)&&re(ee)})}var F=S(y,2),ce=_(F);{var ye=re=>{var fe=Am(),de=st(fe);de.__click=()=>e.onmarkacted(e.item.emailId);var V=S(de,2);V.__click=()=>e.ondismiss(e.item.emailId),z(re,fe)},Ee=re=>{var fe=Cm(),de=_(fe);ue(()=>ie(de,e.item.status)),z(re,fe)};be(ce,re=>{m(o)?re(ye):re(Ee,!1)})}var ge=S(ce,2);{var ne=re=>{var fe=Im();fe.__click=()=>e.onremove(e.item.emailId),z(re,fe)};be(ge,re=>{e.onremove&&re(ne)})}var le=S(v,2);{var Pe=re=>{var fe=Pm();let de;var V=_(fe),oe=_(V),ve=S(V,2);{var we=Y=>{var J=Rm(),H=_(J);ue(()=>ie(H,e.item.reason)),z(Y,J)};be(ve,Y=>{e.item.reason&&Y(we)})}ue(()=>{de=tn(fe,"",de,{"border-left-color":r()}),ie(oe,e.item.summary)}),z(re,fe)};be(le,re=>{m(u)&&e.item.summary&&re(Pe)})}ue(()=>{h=Mt(v,1,"email-row svelte-1czytqk",null,h,{dimmed:a()}),x=tn(y,"",x,{"border-left-color":r()}),ie(w,e.item.subject),ie(T,e.item.from)}),z(t,d),ft()}Pt(["click"]);var Dm=G('<span class="group-acted svelte-tl1unp"> </span>'),jm=G('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Mm=G('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Lm=G('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Nm=G('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),qm=G('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Bm=G('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function zm(t,e){ut(e,!0);let r=Ie(e,"color",3,"#888");Ie(e,"count",3,0);let a=Ie(e,"items",19,()=>[]),i=Ie(e,"expanded",3,!1),o=dt(()=>a().filter(ee=>ee.status==="pending")),u=dt(()=>a().filter(ee=>ee.status!=="pending")),d=Re(!1);function v(ee){return ee.split("_").map(F=>F.charAt(0)+F.slice(1).toLowerCase()).join(" ")}var h=Bm(),y=_(h);y.__click=function(...ee){var F;(F=e.ontoggle)==null||F.apply(this,ee)};var x=_(y);let k;var w=_(x),j=S(x,2),L=_(j),T=S(j,2);{var K=ee=>{var F=Dm(),ce=_(F);ue(()=>ie(ce,`${m(u).length??""} handled`)),z(ee,F)};be(T,ee=>{m(u).length>0&&ee(K)})}var ae=S(T,4);let se;var W=S(y,2);{var Z=ee=>{var F=qm(),ce=_(F);{var ye=de=>{var V=jm();z(de,V)};be(ce,de=>{m(o).length===0&&m(u).length===0&&de(ye)})}var Ee=S(ce,2);nn(Ee,17,()=>m(o),de=>de.emailId,(de,V)=>{fc(de,{get item(){return m(V)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ge=S(Ee,2);{var ne=de=>{var V=Mm(),oe=_(V),ve=_(oe),we=S(oe,2);nn(we,17,()=>m(u),Y=>Y.emailId,(Y,J)=>{fc(Y,{get item(){return m(J)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ue(()=>ie(ve,`${m(u).length??""} handled`)),z(de,V)};be(ge,de=>{m(u).length>0&&de(ne)})}var le=S(ge,2),Pe=_(le);{var re=de=>{var V=Lm();V.__click=()=>M(d,!0),z(de,V)},fe=de=>{var V=Nm(),oe=_(V),ve=S(oe);ve.__click=()=>M(d,!1);var we=S(ve,2);we.__click=()=>{e.oncleargroup(),M(d,!1)},ue(()=>ie(oe,`Clear ${a().length??""} items? `)),z(de,V)};be(Pe,de=>{m(d)?de(fe,!1):de(re)})}z(ee,F)};be(W,ee=>{i()&&ee(Z)})}ue(ee=>{k=tn(x,"",k,{background:r()}),ie(w,ee),ie(L,m(o).length),se=Mt(ae,0,"chevron svelte-tl1unp",null,se,{open:i()})},[()=>v(e.action)]),z(t,h),ft()}Pt(["click"]);var Fm=G(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),Km=G(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),Um=G(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),Gm=G('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function Hm(t,e){ut(e,!0);let r=Ie(e,"open",15,!1),a=Ie(e,"sampleEmail",3,null),i=Re("system");function o(){return a()?Au(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(x){x.target===x.currentTarget&&u()}var v=ua(),h=st(v);{var y=x=>{var k=Gm();k.__click=d,k.__keydown=ne=>ne.key==="Escape"&&u();var w=_(k),j=_(w),L=S(_(j),2);L.__click=u;var T=S(j,2),K=_(T);let ae;K.__click=()=>M(i,"system");var se=S(K,2);let W;se.__click=()=>M(i,"email");var Z=S(se,2);let ee;Z.__click=()=>M(i,"config");var F=S(T,2),ce=_(F);{var ye=ne=>{var le=Fm(),Pe=S(st(le),2),re=_(Pe);ue(()=>ie(re,Su)),z(ne,le)},Ee=ne=>{var le=Km(),Pe=S(st(le),2),re=S(_(Pe),2);re.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var fe=S(Pe,2),de=S(_(fe),2),V=_(de);ue(oe=>ie(V,oe),[o]),z(ne,le)},ge=ne=>{var le=Um(),Pe=S(st(le),2),re=_(Pe),fe=S(_(re),2),de=_(fe),V=S(re,2),oe=S(_(V),2),ve=_(oe),we=S(V,2),Y=S(_(we),2),J=_(Y),H=S(Pe,4);H.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,ue(()=>{ie(de,wp.maxTokens),ie(ve,"false"),ie(J,"false")}),z(ne,le)};be(ce,ne=>{m(i)==="system"?ne(ye):m(i)==="email"?ne(Ee,1):m(i)==="config"&&ne(ge,2)})}ue(()=>{ae=Mt(K,1,"tab svelte-10pcy9j",null,ae,{active:m(i)==="system"}),W=Mt(se,1,"tab svelte-10pcy9j",null,W,{active:m(i)==="email"}),ee=Mt(Z,1,"tab svelte-10pcy9j",null,ee,{active:m(i)==="config"})}),z(x,k)};be(h,x=>{r()&&x(y)})}z(t,v),ft()}Pt(["click","keydown"]);var Wm=G('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),Ym=G('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),Vm=G('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),Xm=G('<button class="chip svelte-s2dwjj"> </button>'),Qm=G('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),Zm=G('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Jm=G('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),$m=G('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),ey=G('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),ty=G('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),ny=G('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),ry=G('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),ay=G('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),sy=G('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),iy=G('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),oy=G('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function ly(t,e){ut(e,!0);let r=Ie(e,"groupOrder",19,()=>[]),a=Re(!1),i=Re(null),o=Re(!1),u=Re(null);async function d(){var ge;const[F,ce,ye]=await Promise.all([Be.items.where("sourceType").equals("gmail").count(),Be.emailClassifications.count(),Be.contacts.count()]);let Ee=0;try{const ne=await((ge=navigator.storage)==null?void 0:ge.estimate());Ee=(ne==null?void 0:ne.usage)??0}catch{}M(u,{emailCount:F,classCount:ce,contactCount:ye,totalBytes:Ee},!0)}function v(F){return F?F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(1)} MB`:"â"}function h(){M(a,!m(a)),m(a)&&d()}async function y(F){var ce;M(o,!0),M(i,null);try{await F(),await d(),(ce=e.onrefresh)==null||ce.call(e)}finally{M(o,!1)}}async function x(){await y(()=>Gl())}async function k(F){await y(()=>Bo(F))}async function w(){await y(async()=>{await Ru(),await Gl()})}async function j(){await y(()=>Be.contacts.clear())}async function L(){await y(async()=>{await Be.delete(),window.location.reload()})}function T(F){return F.split("_").map(ce=>ce.charAt(0)+ce.slice(1).toLowerCase()).join(" ")}var K=oy(),ae=_(K);ae.__click=h;var se=S(_(ae),2);let W;var Z=S(ae,2);{var ee=F=>{var ce=iy(),ye=_(ce);{var Ee=te=>{var Ne=Ym(),qe=_(Ne),Fe=_(qe),Tt=S(qe,4),vt=_(Tt),fn=S(Tt,4),Jn=_(fn),dn=S(fn,2);{var Gt=kt=>{var mt=Wm(),pn=S(st(mt),2),hn=_(pn);ue(zn=>ie(hn,`${zn??""} used`),[()=>v(m(u).totalBytes)]),z(kt,mt)};be(dn,kt=>{m(u).totalBytes&&kt(Gt)})}ue(()=>{ie(Fe,`${m(u).emailCount??""} emails`),ie(vt,`${m(u).classCount??""} classifications`),ie(Jn,`${m(u).contactCount??""} contacts`)}),z(te,Ne)};be(ye,te=>{m(u)&&te(Ee)})}var ge=S(ye,2);{var ne=te=>{var Ne=Qm(),qe=S(_(Ne),2);nn(qe,21,r,hr,(Fe,Tt)=>{var vt=ua(),fn=st(vt);{var Jn=Gt=>{var kt=Vm(),mt=_(kt),pn=S(mt);pn.__click=()=>M(i,null);var hn=S(pn,2);hn.__click=()=>k(m(Tt)),ue(zn=>{ie(mt,`Delete ${zn??""}? `),hn.disabled=m(o)},[()=>T(m(Tt))]),z(Gt,kt)},dn=Gt=>{var kt=Xm();kt.__click=()=>M(i,`group:${m(Tt)}`);var mt=_(kt);ue(pn=>{kt.disabled=m(o),ie(mt,`${pn??""} â`)},[()=>T(m(Tt))]),z(Gt,kt)};be(fn,Gt=>{m(i)===`group:${m(Tt)}`?Gt(Jn):Gt(dn,!1)})}z(Fe,vt)}),z(te,Ne)};be(ge,te=>{r().length>0&&te(ne)})}var le=S(ge,2),Pe=S(_(le),2),re=_(Pe);{var fe=te=>{var Ne=Zm(),qe=S(_(Ne),2);qe.__click=()=>M(i,null);var Fe=S(qe,2);Fe.__click=x,ue(()=>Fe.disabled=m(o)),z(te,Ne)},de=te=>{var Ne=Jm();Ne.__click=()=>M(i,"classifications"),ue(()=>Ne.disabled=m(o)),z(te,Ne)};be(re,te=>{m(i)==="classifications"?te(fe):te(de,!1)})}var V=S(re,2);{var oe=te=>{var Ne=$m(),qe=S(_(Ne),2);qe.__click=()=>M(i,null);var Fe=S(qe,2);Fe.__click=w,ue(()=>Fe.disabled=m(o)),z(te,Ne)},ve=te=>{var Ne=ey();Ne.__click=()=>M(i,"emails"),ue(()=>Ne.disabled=m(o)),z(te,Ne)};be(V,te=>{m(i)==="emails"?te(oe):te(ve,!1)})}var we=S(V,2);{var Y=te=>{var Ne=ty(),qe=S(_(Ne),2);qe.__click=()=>M(i,null);var Fe=S(qe,2);Fe.__click=j,ue(()=>Fe.disabled=m(o)),z(te,Ne)},J=te=>{var Ne=ny();Ne.__click=()=>M(i,"contacts"),ue(()=>Ne.disabled=m(o)),z(te,Ne)};be(we,te=>{m(i)==="contacts"?te(Y):te(J,!1)})}var H=S(le,2),$=_(H);{var Me=te=>{var Ne=ry(),qe=S(_(Ne),2);qe.__click=()=>M(i,null);var Fe=S(qe,2);Fe.__click=L,ue(()=>Fe.disabled=m(o)),z(te,Ne)},Te=te=>{var Ne=ay();Ne.__click=()=>M(i,"nuke"),ue(()=>Ne.disabled=m(o)),z(te,Ne)};be($,te=>{m(i)==="nuke"?te(Me):te(Te,!1)})}var Ue=S(H,2);{var rt=te=>{var Ne=sy();z(te,Ne)};be(Ue,te=>{m(o)&&te(rt)})}z(F,ce)};be(Z,F=>{m(a)&&F(ee)})}ue(()=>W=Mt(se,0,"chev svelte-s2dwjj",null,W,{open:m(a)})),z(t,K),ft()}Pt(["click"]);var cy=G('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),uy=G('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),fy=G('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),dy=G('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function py(t,e){ut(e,!0);let r=Ie(e,"groups",19,()=>({})),a=Ie(e,"groupOrder",19,()=>[]),i=Ie(e,"counts",19,()=>({})),o=Ie(e,"stats",3,null),u=Ie(e,"expandedGroup",3,null),d=Ie(e,"isScanning",3,!1),v=Ie(e,"scanProgress",3,null),h=Ie(e,"scanCount",15,20),y=Ie(e,"error",3,null),x=Re(!1),k=dt(()=>{for(const ee of a()){const F=r()[ee];if((F==null?void 0:F.length)>0)return F[0]}return null});var w=dy(),j=_(w);km(j,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},oninspect:()=>M(x,!0),get scanCount(){return h()},set scanCount(ee){h(ee)}});var L=S(j,2);Hm(L,{get sampleEmail(){return m(k)},get open(){return m(x)},set open(ee){M(x,ee,!0)}});var T=S(L,2);{var K=ee=>{var F=cy(),ce=_(F),ye=_(ce),Ee=S(ce,2);Ee.__click=function(...ge){var ne;(ne=e.ondismisserror)==null||ne.apply(this,ge)},ue(()=>ie(ye,y())),z(ee,F)};be(T,ee=>{y()&&ee(K)})}var ae=S(T,2);{var se=ee=>{var F=uy(),ce=st(F);nn(ce,20,a,ne=>ne,(ne,le)=>{{let Pe=dt(()=>fo(le)),re=dt(()=>{var V;return((V=r()[le])==null?void 0:V.length)||0}),fe=dt(()=>r()[le]||[]),de=dt(()=>u()===le);zm(ne,{get action(){return le},get color(){return m(Pe)},get count(){return m(re)},get items(){return m(fe)},get expanded(){return m(de)},ontoggle:()=>e.ontogglegroup(le),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(le)})}});var ye=S(ce,2),Ee=_(ye),ge=_(Ee);ue(()=>ie(ge,`${i().total??""} emails classified into ${a().length??""} groups`)),z(ee,F)},W=ee=>{var F=fy();z(ee,F)};be(ae,ee=>{i().total>0?ee(se):d()||ee(W,1)})}var Z=S(ae,2);ly(Z,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),z(t,w),ft()}Pt(["click"]);var hy=G('<div class="actions-page svelte-3tch4q"><!></div>');function vy(t,e){ut(e,!0);const r=du();let a=Re(jt(r.status)),i=Re(""),o=Re(jt({})),u=Re(jt([])),d=Re(jt({total:0})),v=Re(null),h=Re(null),y=Re(!1),x=Re(null),k=Re(20),w=Re(null);Bt(()=>{const ye=r.onMessage(Ee=>{if(Ee.status==="ready"){M(a,"ready");const ge=ls.find(ne=>ne.id===r.modelId);M(i,(ge==null?void 0:ge.name)||r.modelId||"",!0)}Ee.status==="loading"&&M(a,"loading")});if(M(a,r.status,!0),r.modelId){const Ee=ls.find(ge=>ge.id===r.modelId);M(i,(Ee==null?void 0:Ee.name)||r.modelId||"",!0)}return j(),()=>ye()});async function j(){try{const ye=await kp();M(o,ye.groups,!0),M(u,ye.order,!0),M(d,await xp(),!0),M(v,await uo(),!0)}catch(ye){M(w,`Failed to load data: ${ye.message}`)}}async function L(){await K(!1)}async function T(){await K(!0)}async function K(ye){if(!(m(y)||!r.isReady)){M(w,null),M(y,!0),M(x,null);try{await Tu(r,{count:m(k),force:ye,onProgress:Ee=>{M(x,{...Ee},!0)}}),await j()}catch(Ee){M(w,`Scan failed: ${Ee.message}`)}finally{M(y,!1)}}}async function ae(ye){await ti(ye,"acted"),await j()}async function se(ye){await ti(ye,"dismissed"),await j()}async function W(ye){await Eu(ye),await j()}async function Z(ye){await Bo(ye),await j()}function ee(ye){M(h,m(h)===ye?null:ye,!0)}var F=hy(),ce=_(F);py(ce,{get engineStatus(){return m(a)},get modelName(){return m(i)},get groups(){return m(o)},get groupOrder(){return m(u)},get counts(){return m(d)},get stats(){return m(v)},get expandedGroup(){return m(h)},get isScanning(){return m(y)},get scanProgress(){return m(x)},get error(){return m(w)},onscan:L,onrescan:T,ontogglegroup:ee,onmarkacted:ae,ondismiss:se,onremove:W,oncleargroup:Z,ondismisserror:()=>M(w,null),onrefresh:j,get scanCount(){return m(k)},set scanCount(ye){M(k,ye,!0)}}),z(t,F),ft()}var gy=G('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function my(t,e){ut(e,!0);function r(){const F=location.hash;return F==="#dashboard"?"dashboard":F==="#actions"?"actions":"chat"}let a=Re(jt(r()));Bt(()=>{function F(){M(a,r(),!0)}return window.addEventListener("hashchange",F),()=>window.removeEventListener("hashchange",F)});var i=gy(),o=_(i),u=S(_(o),2),d=_(u);let v;var h=S(d,2);let y;var x=S(h,2);let k;var w=S(o,2),j=_(w);let L;var T=_(j);jh(T,{});var K=S(j,2);let ae;var se=_(K);vy(se,{});var W=S(K,2);let Z;var ee=_(W);hm(ee,{}),ue(()=>{v=Mt(d,1,"svelte-1n46o8q",null,v,{active:m(a)==="chat"}),y=Mt(h,1,"svelte-1n46o8q",null,y,{active:m(a)==="actions"}),k=Mt(x,1,"svelte-1n46o8q",null,k,{active:m(a)==="dashboard"}),L=tn(j,"",L,{display:m(a)==="chat"?"flex":"none"}),ae=tn(K,"",ae,{display:m(a)==="actions"?"flex":"none"}),Z=tn(W,"",Z,{display:m(a)==="dashboard"?"flex":"none"})}),z(t,i),ft()}Md(my,{target:document.getElementById("app")});
