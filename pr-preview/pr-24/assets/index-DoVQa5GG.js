var ef=Object.defineProperty;var gl=t=>{throw TypeError(t)};var tf=(t,e,r)=>e in t?ef(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ke=(t,e,r)=>tf(t,typeof e!="symbol"?e+"":e,r),Ns=(t,e,r)=>e.has(t)||gl("Cannot "+r);var G=(t,e,r)=>(Ns(t,e,"read from private field"),r?r.call(t):e.get(t)),Ue=(t,e,r)=>e.has(t)?gl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ze=(t,e,r,i)=>(Ns(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),Rt=(t,e,r)=>(Ns(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();const $s=!1;var yo=Array.isArray,nf=Array.prototype.indexOf,xa=Array.prototype.includes,is=Array.from,rf=Object.defineProperty,va=Object.getOwnPropertyDescriptor,af=Object.getOwnPropertyDescriptors,sf=Object.prototype,of=Array.prototype,iu=Object.getPrototypeOf,ml=Object.isExtensible;const lf=()=>{};function uf(t){for(var e=0;e<t.length;e++)t[e]()}function su(){var t,e,r=new Promise((i,s)=>{t=i,e=s});return{promise:r,resolve:t,reject:e}}const Et=2,ii=4,ss=8,ou=1<<24,nr=16,Pn=32,ra=64,lu=128,dn=512,wt=1024,At=2048,Cn=4096,Jt=8192,Jn=16384,di=32768,Sa=65536,yl=1<<17,uu=1<<18,Ca=1<<19,cf=1<<20,Zn=1<<25,Zr=65536,Xs=1<<21,bo=1<<22,_r=1<<23,$r=Symbol("$state"),ff=Symbol("legacy props"),df=Symbol(""),zr=new class extends Error{constructor(){super(...arguments);Ke(this,"name","StaleReactionError");Ke(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function hf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function pf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function vf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function gf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function mf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function yf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function bf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function _f(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function wf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function kf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function xf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Sf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Tf=1,Ef=2,cu=4,Af=8,If=16,Cf=1,Pf=4,Rf=8,Of=16,fu=1,Df=2,xt=Symbol(),du="http://www.w3.org/1999/xhtml";function Mf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Lf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function hu(t){return t===this.v}function Nf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function pu(t){return!Nf(t,this.v)}let qf=!1,en=null;function Ta(t){en=t}function ut(t,e=!1,r){en={p:en,i:!1,c:null,e:null,s:t,x:null,l:null}}function ct(t){var e=en,r=e.e;if(r!==null){e.e=null;for(var i of r)Nu(i)}return e.i=!0,en=e.p,{}}function vu(){return!0}let Fr=[];function gu(){var t=Fr;Fr=[],uf(t)}function wr(t){if(Fr.length===0&&!ti){var e=Fr;queueMicrotask(()=>{e===Fr&&gu()})}Fr.push(t)}function jf(){for(;Fr.length>0;)gu()}function mu(t){var e=Je;if(e===null)return Ge.f|=_r,t;if((e.f&di)===0&&(e.f&ii)===0)throw t;Ea(t,e)}function Ea(t,e){for(;e!==null;){if((e.f&lu)!==0){if((e.f&di)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Bf=-7169;function pt(t,e){t.f=t.f&Bf|e}function _o(t){(t.f&dn)!==0||t.deps===null?pt(t,wt):pt(t,Cn)}function yu(t){if(t!==null)for(const e of t)(e.f&Et)===0||(e.f&Zr)===0||(e.f^=Zr,yu(e.deps))}function bu(t,e,r){(t.f&At)!==0?e.add(t):(t.f&Cn)!==0&&r.add(t),yu(t.deps),pt(t,wt)}const Ni=new Set;let je=null,Qi=null,St=null,Ut=[],os=null,Qs=!1,ti=!1;var ga,ma,Ur,ya,li,ui,Gr,Vn,ba,Fn,Zs,Js,_u;const Ko=class Ko{constructor(){Ue(this,Fn);Ke(this,"committed",!1);Ke(this,"current",new Map);Ke(this,"previous",new Map);Ue(this,ga,new Set);Ue(this,ma,new Set);Ue(this,Ur,0);Ue(this,ya,0);Ue(this,li,null);Ue(this,ui,new Set);Ue(this,Gr,new Set);Ue(this,Vn,new Map);Ke(this,"is_fork",!1);Ue(this,ba,!1)}is_deferred(){return this.is_fork||G(this,ya)>0}skip_effect(e){G(this,Vn).has(e)||G(this,Vn).set(e,{d:[],m:[]})}unskip_effect(e){var r=G(this,Vn).get(e);if(r){G(this,Vn).delete(e);for(var i of r.d)pt(i,At),An(i);for(i of r.m)pt(i,Cn),An(i)}}process(e){var s;Ut=[],this.apply();var r=[],i=[];for(const l of e)Rt(this,Fn,Zs).call(this,l,r,i);if(this.is_deferred()){Rt(this,Fn,Js).call(this,i),Rt(this,Fn,Js).call(this,r);for(const[l,f]of G(this,Vn))Su(l,f)}else{for(const l of G(this,ga))l();G(this,ga).clear(),G(this,Ur)===0&&Rt(this,Fn,_u).call(this),Qi=this,je=null,bl(i),bl(r),Qi=null,(s=G(this,li))==null||s.resolve()}St=null}capture(e,r){r!==xt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&_r)===0&&(this.current.set(e,e.v),St==null||St.set(e,e.v))}activate(){je=this,this.apply()}deactivate(){je===this&&(je=null,St=null)}flush(){if(this.activate(),Ut.length>0){if(wu(),je!==null&&je!==this)return}else G(this,Ur)===0&&this.process([]);this.deactivate()}discard(){for(const e of G(this,ma))e(this);G(this,ma).clear()}increment(e){ze(this,Ur,G(this,Ur)+1),e&&ze(this,ya,G(this,ya)+1)}decrement(e){ze(this,Ur,G(this,Ur)-1),e&&ze(this,ya,G(this,ya)-1),!G(this,ba)&&(ze(this,ba,!0),wr(()=>{ze(this,ba,!1),this.is_deferred()?Ut.length>0&&this.flush():this.revive()}))}revive(){for(const e of G(this,ui))G(this,Gr).delete(e),pt(e,At),An(e);for(const e of G(this,Gr))pt(e,Cn),An(e);this.flush()}oncommit(e){G(this,ga).add(e)}ondiscard(e){G(this,ma).add(e)}settled(){return(G(this,li)??ze(this,li,su())).promise}static ensure(){if(je===null){const e=je=new Ko;Ni.add(je),ti||wr(()=>{je===e&&e.flush()})}return je}apply(){}};ga=new WeakMap,ma=new WeakMap,Ur=new WeakMap,ya=new WeakMap,li=new WeakMap,ui=new WeakMap,Gr=new WeakMap,Vn=new WeakMap,ba=new WeakMap,Fn=new WeakSet,Zs=function(e,r,i){e.f^=wt;for(var s=e.first,l=null;s!==null;){var f=s.f,d=(f&(Pn|ra))!==0,v=d&&(f&wt)!==0,p=v||(f&Jt)!==0||G(this,Vn).has(s);if(!p&&s.fn!==null){d?s.f^=wt:l!==null&&(f&(ii|ss|ou))!==0?l.b.defer_effect(s):(f&ii)!==0?r.push(s):pi(s)&&((f&nr)!==0&&G(this,Gr).add(s),Ia(s));var y=s.first;if(y!==null){s=y;continue}}var w=s.parent;for(s=s.next;s===null&&w!==null;)w===l&&(l=null),s=w.next,w=w.parent}},Js=function(e){for(var r=0;r<e.length;r+=1)bu(e[r],G(this,ui),G(this,Gr))},_u=function(){var s;if(Ni.size>1){this.previous.clear();var e=St,r=!0;for(const l of Ni){if(l===this){r=!1;continue}const f=[];for(const[v,p]of this.current){if(l.current.has(v))if(r&&p!==l.current.get(v))l.current.set(v,p);else continue;f.push(v)}if(f.length===0)continue;const d=[...l.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var i=Ut;Ut=[];const v=new Set,p=new Map;for(const y of f)ku(y,d,v,p);if(Ut.length>0){je=l,l.apply();for(const y of Ut)Rt(s=l,Fn,Zs).call(s,y,[],[]);l.deactivate()}Ut=i}}je=null,St=e}this.committed=!0,Ni.delete(this)};let kr=Ko;function zf(t){var e=ti;ti=!0;try{for(var r;;){if(jf(),Ut.length===0&&(je==null||je.flush(),Ut.length===0))return os=null,r;wu()}}finally{ti=e}}function wu(){Qs=!0;var t=null;try{for(var e=0;Ut.length>0;){var r=kr.ensure();if(e++>1e3){var i,s;Ff()}r.process(Ut),xr.clear()}}finally{Ut=[],Qs=!1,os=null}}function Ff(){try{bf()}catch(t){Ea(t,os)}}let kn=null;function bl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var i=t[r++];if((i.f&(Jn|Jt))===0&&pi(i)&&(kn=new Set,Ia(i),i.deps===null&&i.first===null&&i.nodes===null&&i.teardown===null&&i.ac===null&&zu(i),(kn==null?void 0:kn.size)>0)){xr.clear();for(const s of kn){if((s.f&(Jn|Jt))!==0)continue;const l=[s];let f=s.parent;for(;f!==null;)kn.has(f)&&(kn.delete(f),l.push(f)),f=f.parent;for(let d=l.length-1;d>=0;d--){const v=l[d];(v.f&(Jn|Jt))===0&&Ia(v)}}kn.clear()}}kn=null}}function ku(t,e,r,i){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const s of t.reactions){const l=s.f;(l&Et)!==0?ku(s,e,r,i):(l&(bo|nr))!==0&&(l&At)===0&&xu(s,e,i)&&(pt(s,At),An(s))}}function xu(t,e,r){const i=r.get(t);if(i!==void 0)return i;if(t.deps!==null)for(const s of t.deps){if(xa.call(e,s))return!0;if((s.f&Et)!==0&&xu(s,e,r))return r.set(s,!0),!0}return r.set(t,!1),!1}function An(t){for(var e=os=t;e.parent!==null;){e=e.parent;var r=e.f;if(Qs&&e===Je&&(r&nr)!==0&&(r&uu)===0)return;if((r&(ra|Pn))!==0){if((r&wt)===0)return;e.f^=wt}}Ut.push(e)}function Su(t,e){if(!((t.f&Pn)!==0&&(t.f&wt)!==0)){(t.f&At)!==0?e.d.push(t):(t.f&Cn)!==0&&e.m.push(t),pt(t,wt);for(var r=t.first;r!==null;)Su(r,e),r=r.next}}function Kf(t){let e=0,r=Jr(0),i;return()=>{xo()&&(k(r),So(()=>(e===0&&(i=vi(()=>t(()=>ni(r)))),e+=1,()=>{wr(()=>{e-=1,e===0&&(i==null||i(),i=void 0,ni(r))})})))}}var Uf=Sa|Ca|lu;function Gf(t,e,r){new Hf(t,e,r)}var ln,mo,Nn,Hr,qn,un,Ft,jn,$n,yr,Wr,br,_a,Yr,wa,ka,Xn,rs,kt,Wf,Yf,eo,Gi,Hi,to;class Hf{constructor(e,r,i){Ue(this,kt);Ke(this,"parent");Ke(this,"is_pending",!1);Ue(this,ln);Ue(this,mo,null);Ue(this,Nn);Ue(this,Hr);Ue(this,qn);Ue(this,un,null);Ue(this,Ft,null);Ue(this,jn,null);Ue(this,$n,null);Ue(this,yr,null);Ue(this,Wr,0);Ue(this,br,0);Ue(this,_a,!1);Ue(this,Yr,!1);Ue(this,wa,new Set);Ue(this,ka,new Set);Ue(this,Xn,null);Ue(this,rs,Kf(()=>(ze(this,Xn,Jr(G(this,Wr))),()=>{ze(this,Xn,null)})));ze(this,ln,e),ze(this,Nn,r),ze(this,Hr,i),this.parent=Je.b,this.is_pending=!!G(this,Nn).pending,ze(this,qn,To(()=>{Je.b=this;{var s=Rt(this,kt,eo).call(this);try{ze(this,un,cn(()=>i(s)))}catch(l){this.error(l)}G(this,br)>0?Rt(this,kt,Hi).call(this):this.is_pending=!1}return()=>{var l;(l=G(this,yr))==null||l.remove()}},Uf))}defer_effect(e){bu(e,G(this,wa),G(this,ka))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!G(this,Nn).pending}update_pending_count(e){Rt(this,kt,to).call(this,e),ze(this,Wr,G(this,Wr)+e),!(!G(this,Xn)||G(this,_a))&&(ze(this,_a,!0),wr(()=>{ze(this,_a,!1),G(this,Xn)&&Aa(G(this,Xn),G(this,Wr))}))}get_effect_pending(){return G(this,rs).call(this),k(G(this,Xn))}error(e){var r=G(this,Nn).onerror;let i=G(this,Nn).failed;if(G(this,Yr)||!r&&!i)throw e;G(this,un)&&(Wt(G(this,un)),ze(this,un,null)),G(this,Ft)&&(Wt(G(this,Ft)),ze(this,Ft,null)),G(this,jn)&&(Wt(G(this,jn)),ze(this,jn,null));var s=!1,l=!1;const f=()=>{if(s){Lf();return}s=!0,l&&Sf(),kr.ensure(),ze(this,Wr,0),G(this,jn)!==null&&Xr(G(this,jn),()=>{ze(this,jn,null)}),this.is_pending=this.has_pending_snippet(),ze(this,un,Rt(this,kt,Gi).call(this,()=>(ze(this,Yr,!1),cn(()=>G(this,Hr).call(this,G(this,ln)))))),G(this,br)>0?Rt(this,kt,Hi).call(this):this.is_pending=!1};wr(()=>{try{l=!0,r==null||r(e,f),l=!1}catch(d){Ea(d,G(this,qn)&&G(this,qn).parent)}i&&ze(this,jn,Rt(this,kt,Gi).call(this,()=>{kr.ensure(),ze(this,Yr,!0);try{return cn(()=>{i(G(this,ln),()=>e,()=>f)})}catch(d){return Ea(d,G(this,qn).parent),null}finally{ze(this,Yr,!1)}}))})}}ln=new WeakMap,mo=new WeakMap,Nn=new WeakMap,Hr=new WeakMap,qn=new WeakMap,un=new WeakMap,Ft=new WeakMap,jn=new WeakMap,$n=new WeakMap,yr=new WeakMap,Wr=new WeakMap,br=new WeakMap,_a=new WeakMap,Yr=new WeakMap,wa=new WeakMap,ka=new WeakMap,Xn=new WeakMap,rs=new WeakMap,kt=new WeakSet,Wf=function(){try{ze(this,un,cn(()=>G(this,Hr).call(this,G(this,ln))))}catch(e){this.error(e)}},Yf=function(){const e=G(this,Nn).pending;e&&(ze(this,Ft,cn(()=>e(G(this,ln)))),wr(()=>{var r=Rt(this,kt,eo).call(this);ze(this,un,Rt(this,kt,Gi).call(this,()=>(kr.ensure(),cn(()=>G(this,Hr).call(this,r))))),G(this,br)>0?Rt(this,kt,Hi).call(this):(Xr(G(this,Ft),()=>{ze(this,Ft,null)}),this.is_pending=!1)}))},eo=function(){var e=G(this,ln);return this.is_pending&&(ze(this,yr,er()),G(this,ln).before(G(this,yr)),e=G(this,yr)),e},Gi=function(e){var r=Je,i=Ge,s=en;zn(G(this,qn)),vn(G(this,qn)),Ta(G(this,qn).ctx);try{return e()}catch(l){return mu(l),null}finally{zn(r),vn(i),Ta(s)}},Hi=function(){const e=G(this,Nn).pending;G(this,un)!==null&&(ze(this,$n,document.createDocumentFragment()),G(this,$n).append(G(this,yr)),Uu(G(this,un),G(this,$n))),G(this,Ft)===null&&ze(this,Ft,cn(()=>e(G(this,ln))))},to=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Rt(r=this.parent,kt,to).call(r,e);return}if(ze(this,br,G(this,br)+e),G(this,br)===0){this.is_pending=!1;for(const i of G(this,wa))pt(i,At),An(i);for(const i of G(this,ka))pt(i,Cn),An(i);G(this,wa).clear(),G(this,ka).clear(),G(this,Ft)&&Xr(G(this,Ft),()=>{ze(this,Ft,null)}),G(this,$n)&&(G(this,ln).before(G(this,$n)),ze(this,$n,null))}};function Vf(t,e,r,i){const s=ls;var l=t.filter(b=>!b.settled);if(r.length===0&&l.length===0){i(e.map(s));return}var f=je,d=Je,v=$f(),p=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(b=>b.promise)):null;function y(b){v();try{i(b)}catch(_){(d.f&Jn)===0&&Ea(_,d)}f==null||f.deactivate(),no()}if(r.length===0){p.then(()=>y(e.map(s)));return}function w(){v(),Promise.all(r.map(b=>Xf(b))).then(b=>y([...e.map(s),...b])).catch(b=>Ea(b,d))}p?p.then(w):w()}function $f(){var t=Je,e=Ge,r=en,i=je;return function(l=!0){zn(t),vn(e),Ta(r),l&&(i==null||i.activate())}}function no(){zn(null),vn(null),Ta(null)}function ls(t){var e=Et|At,r=Ge!==null&&(Ge.f&Et)!==0?Ge:null;return Je!==null&&(Je.f|=Ca),{ctx:en,deps:null,effects:null,equals:hu,f:e,fn:t,reactions:null,rv:0,v:xt,wv:0,parent:r??Je,ac:null}}function Xf(t,e,r){let i=Je;i===null&&pf();var s=i.b,l=void 0,f=Jr(xt),d=!Ge,v=new Map;return cd(()=>{var _;var p=su();l=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{y===je&&y.committed&&y.deactivate(),no()})}catch(L){p.reject(L),no()}var y=je;if(d){var w=s.is_rendered();s.update_pending_count(1),y.increment(w),(_=v.get(y))==null||_.reject(zr),v.delete(y),v.set(y,p)}const b=(L,q=void 0)=>{if(y.activate(),q)q!==zr&&(f.f|=_r,Aa(f,q));else{(f.f&_r)!==0&&(f.f^=_r),Aa(f,L);for(const[E,z]of v){if(v.delete(E),E===y)break;z.reject(zr)}}d&&(s.update_pending_count(-1),y.decrement(w))};p.promise.then(b,L=>b(null,L||"unknown"))}),Lu(()=>{for(const p of v.values())p.reject(zr)}),new Promise(p=>{function y(w){function b(){w===l?p(f):y(l)}w.then(b,b)}y(l)})}function hn(t){const e=ls(t);return Gu(e),e}function Tu(t){const e=ls(t);return e.equals=pu,e}function Qf(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Wt(e[r])}}function Zf(t){for(var e=t.parent;e!==null;){if((e.f&Et)===0)return(e.f&Jn)===0?e:null;e=e.parent}return null}function wo(t){var e,r=Je;zn(Zf(t));try{t.f&=~Zr,Qf(t),e=Vu(t)}finally{zn(r)}return e}function Eu(t){var e=wo(t);if(!t.equals(e)&&(t.wv=Wu(),(!(je!=null&&je.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){pt(t,wt);return}Sr||(St!==null?(xo()||je!=null&&je.is_fork)&&St.set(t,e):_o(t))}function Jf(t){var e,r;if(t.effects!==null)for(const i of t.effects)(i.teardown||i.ac)&&((e=i.teardown)==null||e.call(i),(r=i.ac)==null||r.abort(zr),i.teardown=lf,i.ac=null,si(i,0),Eo(i))}function Au(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ia(e)}let ro=new Set;const xr=new Map;let Iu=!1;function Jr(t,e){var r={f:0,v:t,reactions:null,equals:hu,rv:0,wv:0};return r}function Ce(t,e){const r=Jr(t);return Gu(r),r}function ed(t,e=!1,r=!0){const i=Jr(t);return e||(i.equals=pu),i}function U(t,e,r=!1){Ge!==null&&(!In||(Ge.f&yl)!==0)&&vu()&&(Ge.f&(Et|nr|bo|yl))!==0&&(pn===null||!xa.call(pn,t))&&xf();let i=r?Ot(e):e;return Aa(t,i)}function Aa(t,e){if(!t.equals(e)){var r=t.v;Sr?xr.set(t,e):xr.set(t,r),t.v=e;var i=kr.ensure();if(i.capture(t,r),(t.f&Et)!==0){const s=t;(t.f&At)!==0&&wo(s),_o(s)}t.wv=Wu(),Cu(t,At),Je!==null&&(Je.f&wt)!==0&&(Je.f&(Pn|ra))===0&&(on===null?dd([t]):on.push(t)),!i.is_fork&&ro.size>0&&!Iu&&td()}return e}function td(){Iu=!1;for(const t of ro)(t.f&wt)!==0&&pt(t,Cn),pi(t)&&Ia(t);ro.clear()}function ni(t){U(t,t.v+1)}function Cu(t,e){var r=t.reactions;if(r!==null)for(var i=r.length,s=0;s<i;s++){var l=r[s],f=l.f,d=(f&At)===0;if(d&&pt(l,e),(f&Et)!==0){var v=l;St==null||St.delete(v),(f&Zr)===0&&(f&dn&&(l.f|=Zr),Cu(v,Cn))}else d&&((f&nr)!==0&&kn!==null&&kn.add(l),An(l))}}function Ot(t){if(typeof t!="object"||t===null||$r in t)return t;const e=iu(t);if(e!==sf&&e!==of)return t;var r=new Map,i=yo(t),s=Ce(0),l=Qr,f=d=>{if(Qr===l)return d();var v=Ge,p=Qr;vn(null),Sl(l);var y=d();return vn(v),Sl(p),y};return i&&r.set("length",Ce(t.length)),new Proxy(t,{defineProperty(d,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&wf();var y=r.get(v);return y===void 0?f(()=>{var w=Ce(p.value);return r.set(v,w),w}):U(y,p.value,!0),!0},deleteProperty(d,v){var p=r.get(v);if(p===void 0){if(v in d){const y=f(()=>Ce(xt));r.set(v,y),ni(s)}}else U(p,xt),ni(s);return!0},get(d,v,p){var _;if(v===$r)return t;var y=r.get(v),w=v in d;if(y===void 0&&(!w||(_=va(d,v))!=null&&_.writable)&&(y=f(()=>{var L=Ot(w?d[v]:xt),q=Ce(L);return q}),r.set(v,y)),y!==void 0){var b=k(y);return b===xt?void 0:b}return Reflect.get(d,v,p)},getOwnPropertyDescriptor(d,v){var p=Reflect.getOwnPropertyDescriptor(d,v);if(p&&"value"in p){var y=r.get(v);y&&(p.value=k(y))}else if(p===void 0){var w=r.get(v),b=w==null?void 0:w.v;if(w!==void 0&&b!==xt)return{enumerable:!0,configurable:!0,value:b,writable:!0}}return p},has(d,v){var b;if(v===$r)return!0;var p=r.get(v),y=p!==void 0&&p.v!==xt||Reflect.has(d,v);if(p!==void 0||Je!==null&&(!y||(b=va(d,v))!=null&&b.writable)){p===void 0&&(p=f(()=>{var _=y?Ot(d[v]):xt,L=Ce(_);return L}),r.set(v,p));var w=k(p);if(w===xt)return!1}return y},set(d,v,p,y){var J;var w=r.get(v),b=v in d;if(i&&v==="length")for(var _=p;_<w.v;_+=1){var L=r.get(_+"");L!==void 0?U(L,xt):_ in d&&(L=f(()=>Ce(xt)),r.set(_+"",L))}if(w===void 0)(!b||(J=va(d,v))!=null&&J.writable)&&(w=f(()=>Ce(void 0)),U(w,Ot(p)),r.set(v,w));else{b=w.v!==xt;var q=f(()=>Ot(p));U(w,q)}var E=Reflect.getOwnPropertyDescriptor(d,v);if(E!=null&&E.set&&E.set.call(y,p),!b){if(i&&typeof v=="string"){var z=r.get("length"),ee=Number(v);Number.isInteger(ee)&&ee>=z.v&&U(z,ee+1)}ni(s)}return!0},ownKeys(d){k(s);var v=Reflect.ownKeys(d).filter(w=>{var b=r.get(w);return b===void 0||b.v!==xt});for(var[p,y]of r)y.v!==xt&&!(p in d)&&v.push(p);return v},setPrototypeOf(){kf()}})}function _l(t){try{if(t!==null&&typeof t=="object"&&$r in t)return t[$r]}catch{}return t}function nd(t,e){return Object.is(_l(t),_l(e))}var wl,Pu,Ru,Ou;function rd(){if(wl===void 0){wl=window,Pu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Ru=va(e,"firstChild").get,Ou=va(e,"nextSibling").get,ml(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ml(r)&&(r.__t=void 0)}}function er(t=""){return document.createTextNode(t)}function Zt(t){return Ru.call(t)}function hi(t){return Ou.call(t)}function T(t,e){return Zt(t)}function Dt(t,e=!1){{var r=Zt(t);return r instanceof Comment&&r.data===""?hi(r):r}}function j(t,e=1,r=!1){let i=t;for(;e--;)i=hi(i);return i}function ad(t){t.textContent=""}function Du(){return!1}function id(t,e,r){return document.createElementNS(du,t,void 0)}let kl=!1;function sd(){kl||(kl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function ko(t){var e=Ge,r=Je;vn(null),zn(null);try{return t()}finally{vn(e),zn(r)}}function Mu(t,e,r,i=r){t.addEventListener(e,()=>ko(r));const s=t.__on_r;s?t.__on_r=()=>{s(),i(!0)}:t.__on_r=()=>i(!0),sd()}function od(t){Je===null&&(Ge===null&&yf(),mf()),Sr&&gf()}function ld(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function rr(t,e,r){var i=Je;i!==null&&(i.f&Jt)!==0&&(t|=Jt);var s={ctx:en,deps:null,nodes:null,f:t|At|dn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ia(s)}catch(d){throw Wt(s),d}else e!==null&&An(s);var l=s;if(r&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&Ca)===0&&(l=l.first,(t&nr)!==0&&(t&Sa)!==0&&l!==null&&(l.f|=Sa)),l!==null&&(l.parent=i,i!==null&&ld(l,i),Ge!==null&&(Ge.f&Et)!==0&&(t&ra)===0)){var f=Ge;(f.effects??(f.effects=[])).push(l)}return s}function xo(){return Ge!==null&&!In}function Lu(t){const e=rr(ss,null,!1);return pt(e,wt),e.teardown=t,e}function Zi(t){od();var e=Je.f,r=!Ge&&(e&Pn)!==0&&(e&di)===0;if(r){var i=en;(i.e??(i.e=[])).push(t)}else return Nu(t)}function Nu(t){return rr(ii|cf,t,!1)}function ud(t){kr.ensure();const e=rr(ra|Ca,t,!0);return(r={})=>new Promise(i=>{r.outro?Xr(e,()=>{Wt(e),i(void 0)}):(Wt(e),i(void 0))})}function qu(t){return rr(ii,t,!1)}function cd(t){return rr(bo|Ca,t,!0)}function So(t,e=0){return rr(ss|e,t,!0)}function ge(t,e=[],r=[],i=[]){Vf(i,e,r,s=>{rr(ss,()=>t(...s.map(k)),!0)})}function To(t,e=0){var r=rr(nr|e,t,!0);return r}function cn(t){return rr(Pn|Ca,t,!0)}function ju(t){var e=t.teardown;if(e!==null){const r=Sr,i=Ge;xl(!0),vn(null);try{e.call(null)}finally{xl(r),vn(i)}}}function Eo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const s=r.ac;s!==null&&ko(()=>{s.abort(zr)});var i=r.next;(r.f&ra)!==0?r.parent=null:Wt(r,e),r=i}}function fd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Pn)===0&&Wt(e),e=r}}function Wt(t,e=!0){var r=!1;(e||(t.f&uu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Bu(t.nodes.start,t.nodes.end),r=!0),Eo(t,e&&!r),si(t,0),pt(t,Jn);var i=t.nodes&&t.nodes.t;if(i!==null)for(const l of i)l.stop();ju(t);var s=t.parent;s!==null&&s.first!==null&&zu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Bu(t,e){for(;t!==null;){var r=t===e?null:hi(t);t.remove(),t=r}}function zu(t){var e=t.parent,r=t.prev,i=t.next;r!==null&&(r.next=i),i!==null&&(i.prev=r),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=r))}function Xr(t,e,r=!0){var i=[];Fu(t,i,!0);var s=()=>{r&&Wt(t),e&&e()},l=i.length;if(l>0){var f=()=>--l||s();for(var d of i)d.out(f)}else s()}function Fu(t,e,r){if((t.f&Jt)===0){t.f^=Jt;var i=t.nodes&&t.nodes.t;if(i!==null)for(const d of i)(d.is_global||r)&&e.push(d);for(var s=t.first;s!==null;){var l=s.next,f=(s.f&Sa)!==0||(s.f&Pn)!==0&&(t.f&nr)!==0;Fu(s,e,f?r:!1),s=l}}}function Ao(t){Ku(t,!0)}function Ku(t,e){if((t.f&Jt)!==0){t.f^=Jt,(t.f&wt)===0&&(pt(t,At),An(t));for(var r=t.first;r!==null;){var i=r.next,s=(r.f&Sa)!==0||(r.f&Pn)!==0;Ku(r,s?e:!1),r=i}var l=t.nodes&&t.nodes.t;if(l!==null)for(const f of l)(f.is_global||e)&&f.in()}}function Uu(t,e){if(t.nodes)for(var r=t.nodes.start,i=t.nodes.end;r!==null;){var s=r===i?null:hi(r);e.append(r),r=s}}let Wi=!1,Sr=!1;function xl(t){Sr=t}let Ge=null,In=!1;function vn(t){Ge=t}let Je=null;function zn(t){Je=t}let pn=null;function Gu(t){Ge!==null&&(pn===null?pn=[t]:pn.push(t))}let Gt=null,Xt=0,on=null;function dd(t){on=t}let Hu=1,Kr=0,Qr=Kr;function Sl(t){Qr=t}function Wu(){return++Hu}function pi(t){var e=t.f;if((e&At)!==0)return!0;if(e&Et&&(t.f&=~Zr),(e&Cn)!==0){for(var r=t.deps,i=r.length,s=0;s<i;s++){var l=r[s];if(pi(l)&&Eu(l),l.wv>t.wv)return!0}(e&dn)!==0&&St===null&&pt(t,wt)}return!1}function Yu(t,e,r=!0){var i=t.reactions;if(i!==null&&!(pn!==null&&xa.call(pn,t)))for(var s=0;s<i.length;s++){var l=i[s];(l.f&Et)!==0?Yu(l,e,!1):e===l&&(r?pt(l,At):(l.f&wt)!==0&&pt(l,Cn),An(l))}}function Vu(t){var q;var e=Gt,r=Xt,i=on,s=Ge,l=pn,f=en,d=In,v=Qr,p=t.f;Gt=null,Xt=0,on=null,Ge=(p&(Pn|ra))===0?t:null,pn=null,Ta(t.ctx),In=!1,Qr=++Kr,t.ac!==null&&(ko(()=>{t.ac.abort(zr)}),t.ac=null);try{t.f|=Xs;var y=t.fn,w=y();t.f|=di;var b=t.deps,_=je==null?void 0:je.is_fork;if(Gt!==null){var L;if(_||si(t,Xt),b!==null&&Xt>0)for(b.length=Xt+Gt.length,L=0;L<Gt.length;L++)b[Xt+L]=Gt[L];else t.deps=b=Gt;if(xo()&&(t.f&dn)!==0)for(L=Xt;L<b.length;L++)((q=b[L]).reactions??(q.reactions=[])).push(t)}else!_&&b!==null&&Xt<b.length&&(si(t,Xt),b.length=Xt);if(vu()&&on!==null&&!In&&b!==null&&(t.f&(Et|Cn|At))===0)for(L=0;L<on.length;L++)Yu(on[L],t);if(s!==null&&s!==t){if(Kr++,s.deps!==null)for(let E=0;E<r;E+=1)s.deps[E].rv=Kr;if(e!==null)for(const E of e)E.rv=Kr;on!==null&&(i===null?i=on:i.push(...on))}return(t.f&_r)!==0&&(t.f^=_r),w}catch(E){return mu(E)}finally{t.f^=Xs,Gt=e,Xt=r,on=i,Ge=s,pn=l,Ta(f),In=d,Qr=v}}function hd(t,e){let r=e.reactions;if(r!==null){var i=nf.call(r,t);if(i!==-1){var s=r.length-1;s===0?r=e.reactions=null:(r[i]=r[s],r.pop())}}if(r===null&&(e.f&Et)!==0&&(Gt===null||!xa.call(Gt,e))){var l=e;(l.f&dn)!==0&&(l.f^=dn,l.f&=~Zr),_o(l),Jf(l),si(l,0)}}function si(t,e){var r=t.deps;if(r!==null)for(var i=e;i<r.length;i++)hd(t,r[i])}function Ia(t){var e=t.f;if((e&Jn)===0){pt(t,wt);var r=Je,i=Wi;Je=t,Wi=!0;try{(e&(nr|ou))!==0?fd(t):Eo(t),ju(t);var s=Vu(t);t.teardown=typeof s=="function"?s:null,t.wv=Hu;var l;$s&&qf&&(t.f&At)!==0&&t.deps}finally{Wi=i,Je=r}}}async function $u(){await Promise.resolve(),zf()}function k(t){var e=t.f,r=(e&Et)!==0;if(Ge!==null&&!In){var i=Je!==null&&(Je.f&Jn)!==0;if(!i&&(pn===null||!xa.call(pn,t))){var s=Ge.deps;if((Ge.f&Xs)!==0)t.rv<Kr&&(t.rv=Kr,Gt===null&&s!==null&&s[Xt]===t?Xt++:Gt===null?Gt=[t]:Gt.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var l=t.reactions;l===null?t.reactions=[Ge]:xa.call(l,Ge)||l.push(Ge)}}}if(Sr&&xr.has(t))return xr.get(t);if(r){var f=t;if(Sr){var d=f.v;return((f.f&wt)===0&&f.reactions!==null||Qu(f))&&(d=wo(f)),xr.set(f,d),d}var v=(f.f&dn)===0&&!In&&Ge!==null&&(Wi||(Ge.f&dn)!==0),p=(f.f&di)===0;pi(f)&&(v&&(f.f|=dn),Eu(f)),v&&!p&&(Au(f),Xu(f))}if(St!=null&&St.has(t))return St.get(t);if((t.f&_r)!==0)throw t.v;return t.v}function Xu(t){if(t.f|=dn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Et)!==0&&(e.f&dn)===0&&(Au(e),Xu(e))}function Qu(t){if(t.v===xt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Et)!==0&&Qu(e))return!0;return!1}function vi(t){var e=In;try{return In=!0,t()}finally{In=e}}const pd=["touchstart","touchmove"];function vd(t){return pd.includes(t)}const Zu=new Set,ao=new Set;function Yt(t){for(var e=0;e<t.length;e++)Zu.add(t[e]);for(var r of ao)r(t)}let Tl=null;function El(t){var E;var e=this,r=e.ownerDocument,i=t.type,s=((E=t.composedPath)==null?void 0:E.call(t))||[],l=s[0]||t.target;Tl=t;var f=0,d=Tl===t&&t.__root;if(d){var v=s.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var p=s.indexOf(e);if(p===-1)return;v<=p&&(f=v)}if(l=s[f]||t.target,l!==e){rf(t,"currentTarget",{configurable:!0,get(){return l||r}});var y=Ge,w=Je;vn(null),zn(null);try{for(var b,_=[];l!==null;){var L=l.assignedSlot||l.parentNode||l.host||null;try{var q=l["__"+i];q!=null&&(!l.disabled||t.target===l)&&q.call(l,t)}catch(z){b?_.push(z):b=z}if(t.cancelBubble||L===e||L===null)break;l=L}if(b){for(let z of _)queueMicrotask(()=>{throw z});throw b}}finally{t.__root=e,delete t.currentTarget,vn(y),zn(w)}}}var nu,ru;const qs=(ru=(nu=globalThis==null?void 0:globalThis.window)==null?void 0:nu.trustedTypes)==null?void 0:ru.createPolicy("svelte-trusted-html",{createHTML:t=>t});function gd(t){return(qs==null?void 0:qs.createHTML(t))??t}function Io(t,e=!1){var r=id("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?gd(t):t,r.content}function ea(t,e){var r=Je;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function V(t,e){var r=(e&fu)!==0,i=(e&Df)!==0,s,l=!t.startsWith("<!>");return()=>{s===void 0&&(s=Io(l?t:"<!>"+t,!0),r||(s=Zt(s)));var f=i||Pu?document.importNode(s,!0):s.cloneNode(!0);if(r){var d=Zt(f),v=f.lastChild;ea(d,v)}else ea(f,f);return f}}function md(t,e,r="svg"){var i=!t.startsWith("<!>"),s=(e&fu)!==0,l=`<${r}>${i?t:"<!>"+t}</${r}>`,f;return()=>{if(!f){var d=Io(l,!0),v=Zt(d);if(s)for(f=document.createDocumentFragment();Zt(v);)f.appendChild(Zt(v));else f=Zt(v)}var p=f.cloneNode(!0);if(s){var y=Zt(p),w=p.lastChild;ea(y,w)}else ea(p,p);return p}}function Co(t,e){return md(t,e,"svg")}function Al(t=""){{var e=er(t+"");return ea(e,e),e}}function Ju(){var t=document.createDocumentFragment(),e=document.createComment(""),r=er();return t.append(e,r),ea(e,r),t}function Y(t,e){t!==null&&t.before(e)}function oe(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function yd(t,e){return bd(t,e)}const qi=new Map;function bd(t,{target:e,anchor:r,props:i={},events:s,context:l,intro:f=!0}){rd();var d=new Set,v=w=>{for(var b=0;b<w.length;b++){var _=w[b];if(!d.has(_)){d.add(_);var L=vd(_);for(const z of[e,document]){var q=qi.get(z);q===void 0&&(q=new Map,qi.set(z,q));var E=q.get(_);E===void 0?(z.addEventListener(_,El,{passive:L}),q.set(_,1)):q.set(_,E+1)}}}};v(is(Zu)),ao.add(v);var p=void 0,y=ud(()=>{var w=r??e.appendChild(er());return Gf(w,{pending:()=>{}},b=>{ut({});var _=en;l&&(_.c=l),s&&(i.$$events=s),p=t(b,i)||{},ct()}),()=>{var q;for(var b of d)for(const E of[e,document]){var _=qi.get(E),L=_.get(b);--L==0?(E.removeEventListener(b,El),_.delete(b),_.size===0&&qi.delete(E)):_.set(b,L)}ao.delete(v),w!==r&&((q=w.parentNode)==null||q.removeChild(w))}});return _d.set(p,y),p}let _d=new WeakMap;var Sn,Bn,Qt,Vr,ci,fi,as;class wd{constructor(e,r=!0){Ke(this,"anchor");Ue(this,Sn,new Map);Ue(this,Bn,new Map);Ue(this,Qt,new Map);Ue(this,Vr,new Set);Ue(this,ci,!0);Ue(this,fi,()=>{var e=je;if(G(this,Sn).has(e)){var r=G(this,Sn).get(e),i=G(this,Bn).get(r);if(i)Ao(i),G(this,Vr).delete(r);else{var s=G(this,Qt).get(r);s&&(G(this,Bn).set(r,s.effect),G(this,Qt).delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),i=s.effect)}for(const[l,f]of G(this,Sn)){if(G(this,Sn).delete(l),l===e)break;const d=G(this,Qt).get(f);d&&(Wt(d.effect),G(this,Qt).delete(f))}for(const[l,f]of G(this,Bn)){if(l===r||G(this,Vr).has(l))continue;const d=()=>{if(Array.from(G(this,Sn).values()).includes(l)){var p=document.createDocumentFragment();Uu(f,p),p.append(er()),G(this,Qt).set(l,{effect:f,fragment:p})}else Wt(f);G(this,Vr).delete(l),G(this,Bn).delete(l)};G(this,ci)||!i?(G(this,Vr).add(l),Xr(f,d,!1)):d()}}});Ue(this,as,e=>{G(this,Sn).delete(e);const r=Array.from(G(this,Sn).values());for(const[i,s]of G(this,Qt))r.includes(i)||(Wt(s.effect),G(this,Qt).delete(i))});this.anchor=e,ze(this,ci,r)}ensure(e,r){var i=je,s=Du();if(r&&!G(this,Bn).has(e)&&!G(this,Qt).has(e))if(s){var l=document.createDocumentFragment(),f=er();l.append(f),G(this,Qt).set(e,{effect:cn(()=>r(f)),fragment:l})}else G(this,Bn).set(e,cn(()=>r(this.anchor)));if(G(this,Sn).set(i,e),s){for(const[d,v]of G(this,Bn))d===e?i.unskip_effect(v):i.skip_effect(v);for(const[d,v]of G(this,Qt))d===e?i.unskip_effect(v.effect):i.skip_effect(v.effect);i.oncommit(G(this,fi)),i.ondiscard(G(this,as))}else G(this,fi).call(this)}}Sn=new WeakMap,Bn=new WeakMap,Qt=new WeakMap,Vr=new WeakMap,ci=new WeakMap,fi=new WeakMap,as=new WeakMap;function Te(t,e,r=!1){var i=new wd(t),s=r?Sa:0;function l(f,d){i.ensure(f,d)}To(()=>{var f=!1;e((d,v=0)=>{f=!0,l(v,d)}),f||l(!1,null)},s)}function Tr(t,e){return e}function kd(t,e,r){for(var i=[],s=e.length,l,f=e.length,d=0;d<s;d++){let w=e[d];Xr(w,()=>{if(l){if(l.pending.delete(w),l.done.add(w),l.pending.size===0){var b=t.outrogroups;io(is(l.done)),b.delete(l),b.size===0&&(t.outrogroups=null)}}else f-=1},!1)}if(f===0){var v=i.length===0&&r!==null;if(v){var p=r,y=p.parentNode;ad(y),y.append(p),t.items.clear()}io(e,!v)}else l={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(l)}function io(t,e=!0){for(var r=0;r<t.length;r++)Wt(t[r],e)}var Il;function ar(t,e,r,i,s,l=null){var f=t,d=new Map,v=(e&cu)!==0;if(v){var p=t;f=p.appendChild(er())}var y=null,w=Tu(()=>{var z=r();return yo(z)?z:z==null?[]:is(z)}),b,_=!0;function L(){E.fallback=y,xd(E,b,f,e,i),y!==null&&(b.length===0?(y.f&Zn)===0?Ao(y):(y.f^=Zn,Ja(y,null,f)):Xr(y,()=>{y=null}))}var q=To(()=>{b=k(w);for(var z=b.length,ee=new Set,J=je,K=Du(),$=0;$<z;$+=1){var ue=b[$],Q=i(ue,$),me=_?null:d.get(Q);me?(me.v&&Aa(me.v,ue),me.i&&Aa(me.i,$),K&&J.unskip_effect(me.e)):(me=Sd(d,_?f:Il??(Il=er()),ue,Q,$,s,e,r),_||(me.e.f|=Zn),d.set(Q,me)),ee.add(Q)}if(z===0&&l&&!y&&(_?y=cn(()=>l(f)):(y=cn(()=>l(Il??(Il=er()))),y.f|=Zn)),z>ee.size&&vf(),!_)if(K){for(const[Re,De]of d)ee.has(Re)||J.skip_effect(De.e);J.oncommit(L),J.ondiscard(()=>{})}else L();k(w)}),E={effect:q,items:d,outrogroups:null,fallback:y};_=!1}function Ha(t){for(;t!==null&&(t.f&Pn)===0;)t=t.next;return t}function xd(t,e,r,i,s){var De,fe,X,ae,le,Z,ie,we,F;var l=(i&Af)!==0,f=e.length,d=t.items,v=Ha(t.effect.first),p,y=null,w,b=[],_=[],L,q,E,z;if(l)for(z=0;z<f;z+=1)L=e[z],q=s(L,z),E=d.get(q).e,(E.f&Zn)===0&&((fe=(De=E.nodes)==null?void 0:De.a)==null||fe.measure(),(w??(w=new Set)).add(E));for(z=0;z<f;z+=1){if(L=e[z],q=s(L,z),E=d.get(q).e,t.outrogroups!==null)for(const W of t.outrogroups)W.pending.delete(E),W.done.delete(E);if((E.f&Zn)!==0)if(E.f^=Zn,E===v)Ja(E,null,r);else{var ee=y?y.next:v;E===t.effect.last&&(t.effect.last=E.prev),E.prev&&(E.prev.next=E.next),E.next&&(E.next.prev=E.prev),gr(t,y,E),gr(t,E,ee),Ja(E,ee,r),y=E,b=[],_=[],v=Ha(y.next);continue}if((E.f&Jt)!==0&&(Ao(E),l&&((ae=(X=E.nodes)==null?void 0:X.a)==null||ae.unfix(),(w??(w=new Set)).delete(E))),E!==v){if(p!==void 0&&p.has(E)){if(b.length<_.length){var J=_[0],K;y=J.prev;var $=b[0],ue=b[b.length-1];for(K=0;K<b.length;K+=1)Ja(b[K],J,r);for(K=0;K<_.length;K+=1)p.delete(_[K]);gr(t,$.prev,ue.next),gr(t,y,$),gr(t,ue,J),v=J,y=ue,z-=1,b=[],_=[]}else p.delete(E),Ja(E,v,r),gr(t,E.prev,E.next),gr(t,E,y===null?t.effect.first:y.next),gr(t,y,E),y=E;continue}for(b=[],_=[];v!==null&&v!==E;)(p??(p=new Set)).add(v),_.push(v),v=Ha(v.next);if(v===null)continue}(E.f&Zn)===0&&b.push(E),y=E,v=Ha(E.next)}if(t.outrogroups!==null){for(const W of t.outrogroups)W.pending.size===0&&(io(is(W.done)),(le=t.outrogroups)==null||le.delete(W));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||p!==void 0){var Q=[];if(p!==void 0)for(E of p)(E.f&Jt)===0&&Q.push(E);for(;v!==null;)(v.f&Jt)===0&&v!==t.fallback&&Q.push(v),v=Ha(v.next);var me=Q.length;if(me>0){var Re=(i&cu)!==0&&f===0?r:null;if(l){for(z=0;z<me;z+=1)(ie=(Z=Q[z].nodes)==null?void 0:Z.a)==null||ie.measure();for(z=0;z<me;z+=1)(F=(we=Q[z].nodes)==null?void 0:we.a)==null||F.fix()}kd(t,Q,Re)}}l&&wr(()=>{var W,ve;if(w!==void 0)for(E of w)(ve=(W=E.nodes)==null?void 0:W.a)==null||ve.apply()})}function Sd(t,e,r,i,s,l,f,d){var v=(f&Tf)!==0?(f&If)===0?ed(r,!1,!1):Jr(r):null,p=(f&Ef)!==0?Jr(s):null;return{v,i:p,e:cn(()=>(l(e,v??r,p??s,d),()=>{t.delete(i)}))}}function Ja(t,e,r){if(t.nodes)for(var i=t.nodes.start,s=t.nodes.end,l=e&&(e.f&Zn)===0?e.nodes.start:r;i!==null;){var f=hi(i);if(l.before(i),i===s)return;i=f}}function gr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Td(t,e,r=!1,i=!1,s=!1){var l=t,f="";ge(()=>{var d=Je;if(f!==(f=e()??"")&&(d.nodes!==null&&(Bu(d.nodes.start,d.nodes.end),d.nodes=null),f!=="")){var v=f+"";r?v=`<svg>${v}</svg>`:i&&(v=`<math>${v}</math>`);var p=Io(v);if((r||i)&&(p=Zt(p)),ea(Zt(p),p.lastChild),r||i)for(;Zt(p);)l.before(Zt(p));else l.before(p)}})}const Cl=[...` 	
\r\fÂ \v\uFEFF`];function Ed(t,e,r){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),r){for(var s in r)if(r[s])i=i?i+" "+s:s;else if(i.length)for(var l=s.length,f=0;(f=i.indexOf(s,f))>=0;){var d=f+l;(f===0||Cl.includes(i[f-1]))&&(d===i.length||Cl.includes(i[d]))?i=(f===0?"":i.substring(0,f))+i.substring(d+1):f=d}}return i===""?null:i}function Pl(t,e=!1){var r=e?" !important;":";",i="";for(var s in t){var l=t[s];l!=null&&l!==""&&(i+=" "+s+": "+l+r)}return i}function js(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Ad(t,e){if(e){var r="",i,s;if(Array.isArray(e)?(i=e[0],s=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var l=!1,f=0,d=!1,v=[];i&&v.push(...Object.keys(i).map(js)),s&&v.push(...Object.keys(s).map(js));var p=0,y=-1;const q=t.length;for(var w=0;w<q;w++){var b=t[w];if(d?b==="/"&&t[w-1]==="*"&&(d=!1):l?l===b&&(l=!1):b==="/"&&t[w+1]==="*"?d=!0:b==='"'||b==="'"?l=b:b==="("?f++:b===")"&&f--,!d&&l===!1&&f===0){if(b===":"&&y===-1)y=w;else if(b===";"||w===q-1){if(y!==-1){var _=js(t.substring(p,y).trim());if(!v.includes(_)){b!==";"&&w++;var L=t.substring(p,w).trim();r+=" "+L+";"}}p=w+1,y=-1}}}}return i&&(r+=Pl(i)),s&&(r+=Pl(s,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function fn(t,e,r,i,s,l){var f=t.__className;if(f!==r||f===void 0){var d=Ed(r,i,l);d==null?t.removeAttribute("class"):t.className=d,t.__className=r}else if(l&&s!==l)for(var v in l){var p=!!l[v];(s==null||p!==!!s[v])&&t.classList.toggle(v,p)}return l}function Bs(t,e={},r,i){for(var s in r){var l=r[s];e[s]!==l&&(r[s]==null?t.style.removeProperty(s):t.style.setProperty(s,l,i))}}function tr(t,e,r,i){var s=t.__style;if(s!==e){var l=Ad(e,i);l==null?t.removeAttribute("style"):t.style.cssText=l,t.__style=e}else i&&(Array.isArray(i)?(Bs(t,r==null?void 0:r[0],i[0]),Bs(t,r==null?void 0:r[1],i[1],"important")):Bs(t,r,i));return i}function ec(t,e,r=!1){if(t.multiple){if(e==null)return;if(!yo(e))return Mf();for(var i of t.options)i.selected=e.includes(ri(i));return}for(i of t.options){var s=ri(i);if(nd(s,e)){i.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Id(t){var e=new MutationObserver(()=>{ec(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Lu(()=>{e.disconnect()})}function Po(t,e,r=e){var i=new WeakSet,s=!0;Mu(t,"change",l=>{var f=l?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(f),ri);else{var v=t.querySelector(f)??t.querySelector("option:not([disabled])");d=v&&ri(v)}r(d),je!==null&&i.add(je)}),qu(()=>{var l=e();if(t===document.activeElement){var f=Qi??je;if(i.has(f))return}if(ec(t,l,s),s&&l===void 0){var d=t.querySelector(":checked");d!==null&&(l=ri(d),r(l))}t.__value=l,s=!1}),Id(t)}function ri(t){return"__value"in t?t.__value:t.value}const Cd=Symbol("is custom element"),Pd=Symbol("is html");function tc(t,e,r,i){var s=Rd(t);s[e]!==(s[e]=r)&&(e==="loading"&&(t[df]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Od(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Rd(t){return t.__attributes??(t.__attributes={[Cd]:t.nodeName.includes("-"),[Pd]:t.namespaceURI===du})}var Rl=new Map;function Od(t){var e=t.getAttribute("is")||t.nodeName,r=Rl.get(e);if(r)return r;Rl.set(e,r=[]);for(var i,s=t,l=Element.prototype;l!==s;){i=af(s);for(var f in i)i[f].set&&r.push(f);s=iu(s)}return r}function Ro(t,e,r=e){var i=new WeakSet;Mu(t,"input",async s=>{var l=s?t.defaultValue:t.value;if(l=zs(t)?Fs(l):l,r(l),je!==null&&i.add(je),await $u(),l!==(l=e())){var f=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=l??"",d!==null){var p=t.value.length;f===d&&d===v&&p>v?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=f,t.selectionEnd=Math.min(d,p))}}}),vi(e)==null&&t.value&&(r(zs(t)?Fs(t.value):t.value),je!==null&&i.add(je)),So(()=>{var s=e();if(t===document.activeElement){var l=Qi??je;if(i.has(l))return}zs(t)&&s===Fs(t.value)||t.type==="date"&&!s&&!t.value||s!==t.value&&(t.value=s??"")})}function zs(t){var e=t.type;return e==="number"||e==="range"}function Fs(t){return t===""?null:+t}function Ol(t,e){return t===e||(t==null?void 0:t[$r])===e}function nc(t={},e,r,i){return qu(()=>{var s,l;return So(()=>{s=l,l=[],vi(()=>{t!==r(...l)&&(e(t,...l),s&&Ol(r(...s),t)&&e(null,...s))})}),()=>{wr(()=>{l&&Ol(r(...l),t)&&e(null,...l)})}}),t}let ji=!1;function Dd(t){var e=ji;try{return ji=!1,[t(),ji]}finally{ji=e}}function Pe(t,e,r,i){var ee;var s=(r&Rf)!==0,l=(r&Of)!==0,f=i,d=!0,v=()=>(d&&(d=!1,f=l?vi(i):i),f),p;if(s){var y=$r in t||ff in t;p=((ee=va(t,e))==null?void 0:ee.set)??(y&&e in t?J=>t[e]=J:void 0)}var w,b=!1;s?[w,b]=Dd(()=>t[e]):w=t[e],w===void 0&&i!==void 0&&(w=v(),p&&(_f(),p(w)));var _;if(_=()=>{var J=t[e];return J===void 0?v():(d=!0,J)},(r&Pf)===0)return _;if(p){var L=t.$$legacy;return(function(J,K){return arguments.length>0?((!K||L||b)&&p(K?_():J),J):_()})}var q=!1,E=((r&Cf)!==0?ls:Tu)(()=>(q=!1,_()));s&&k(E);var z=Je;return(function(J,K){if(arguments.length>0){const $=K?k(E):s?Ot(J):J;return U(E,$),q=!0,f!==void 0&&(f=$),J}return Sr&&q||(z.f&Jn)!==0?E.v:k(E)})}function It(t){en===null&&hf(),Zi(()=>{const e=vi(t);if(typeof e=="function")return e})}const Md="5";var au;typeof window<"u"&&((au=window.__svelte??(window.__svelte={})).v??(au.v=new Set)).add(Md);const oi=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Kt=null,Qn="idle",Yi=null,jr=new Set;function Bi(){return Kt||(Kt=new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),Kt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Qn="loading"),e.status==="ready"&&(Qn="ready"),e.status==="start"&&(Qn="generating"),(e.status==="complete"||e.status==="error")&&(Qn=Yi?"ready":"idle");for(const r of jr)try{r(e)}catch{}})),Kt}function rc(){return{check(){Bi().postMessage({type:"check"})},loadModel(t){Yi=t,Qn="loading",Bi().postMessage({type:"load",modelId:t})},generate(t){Bi().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let i="";const s=f=>{switch(f.status){case"thinking":break;case"thinking-done":break;case"update":i+=f.output;break;case"complete":l(),e(i);break;case"error":l(),r(new Error(f.data));break}},l=()=>{jr.delete(s)};jr.add(s),Bi().postMessage({type:"generate",data:t})})},interrupt(){Kt==null||Kt.postMessage({type:"interrupt"})},reset(){Kt==null||Kt.postMessage({type:"reset"})},onMessage(t){return jr.add(t),()=>jr.delete(t)},offMessage(t){jr.delete(t)},get status(){return Qn},get isReady(){return Qn==="ready"},get isGenerating(){return Qn==="generating"},get modelId(){return Yi},terminate(){Kt==null||Kt.terminate(),Kt=null,Qn="idle",Yi=null,jr.clear()}}}var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vi={exports:{}},qd=Vi.exports,Dl;function jd(){return Dl||(Dl=1,(function(t,e){((r,i)=>{t.exports=i()})(qd,function(){var r=function(n,a){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(o,u){o.__proto__=u}:function(o,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(o[c]=u[c])}))(n,a)},i=function(){return(i=Object.assign||function(n){for(var a,o=1,u=arguments.length;o<u;o++)for(var c in a=arguments[o])Object.prototype.hasOwnProperty.call(a,c)&&(n[c]=a[c]);return n}).apply(this,arguments)};function s(n,a,o){for(var u,c=0,h=a.length;c<h;c++)!u&&c in a||((u=u||Array.prototype.slice.call(a,0,c))[c]=a[c]);return n.concat(u||Array.prototype.slice.call(a))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ld,f=Object.keys,d=Array.isArray;function v(n,a){return typeof a=="object"&&f(a).forEach(function(o){n[o]=a[o]}),n}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var p=Object.getPrototypeOf,y={}.hasOwnProperty;function w(n,a){return y.call(n,a)}function b(n,a){typeof a=="function"&&(a=a(p(n))),(typeof Reflect>"u"?f:Reflect.ownKeys)(a).forEach(function(o){L(n,o,a[o])})}var _=Object.defineProperty;function L(n,a,o,u){_(n,a,v(o&&w(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function q(n){return{from:function(a){return n.prototype=Object.create(a.prototype),L(n.prototype,"constructor",n),{extend:b.bind(null,n.prototype)}}}}var E=Object.getOwnPropertyDescriptor,z=[].slice;function ee(n,a,o){return z.call(n,a,o)}function J(n,a){return a(n)}function K(n){if(!n)throw new Error("Assertion Failed")}function $(n){l.setImmediate?setImmediate(n):setTimeout(n,0)}function ue(n,a){if(typeof a=="string"&&w(n,a))return n[a];if(!a)return n;if(typeof a!="string"){for(var o=[],u=0,c=a.length;u<c;++u){var h=ue(n,a[u]);o.push(h)}return o}var g,m=a.indexOf(".");return m===-1||(g=n[a.substr(0,m)])==null?void 0:ue(g,a.substr(m+1))}function Q(n,a,o){if(n&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof a!="string"&&"length"in a){K(typeof o!="string"&&"length"in o);for(var u=0,c=a.length;u<c;++u)Q(n,a[u],o[u])}else{var h,g,m=a.indexOf(".");m!==-1?(h=a.substr(0,m),(m=a.substr(m+1))===""?o===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=o:Q(g=(g=n[h])&&w(n,h)?g:n[h]={},m,o)):o===void 0?d(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=o}}function me(n){var a,o={};for(a in n)w(n,a)&&(o[a]=n[a]);return o}var Re=[].concat;function De(n){return Re.apply([],n)}var Le="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(De([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(a){return a+n+"Array"})}))).filter(function(n){return l[n]}),fe=new Set(Le.map(function(n){return l[n]})),X=null;function ae(n){return X=new WeakMap,n=(function a(o){if(!o||typeof o!="object")return o;var u=X.get(o);if(u)return u;if(d(o)){u=[],X.set(o,u);for(var c=0,h=o.length;c<h;++c)u.push(a(o[c]))}else if(fe.has(o.constructor))u=o;else{var g,m=p(o);for(g in u=m===Object.prototype?{}:Object.create(m),X.set(o,u),o)w(o,g)&&(u[g]=a(o[g]))}return u})(n),X=null,n}var le={}.toString;function Z(n){return le.call(n).slice(8,-1)}var ie=typeof Symbol<"u"?Symbol.iterator:"@@iterator",we=typeof ie=="symbol"?function(n){var a;return n!=null&&(a=n[ie])&&a.apply(n)}:function(){return null};function F(n,a){a=n.indexOf(a),0<=a&&n.splice(a,1)}var W={};function ve(n){var a,o,u,c;if(arguments.length===1){if(d(n))return n.slice();if(this===W&&typeof n=="string")return[n];if(c=we(n))for(o=[];!(u=c.next()).done;)o.push(u.value);else{if(n==null)return[n];if(typeof(a=n.length)!="number")return[n];for(o=new Array(a);a--;)o[a]=n[a]}}else for(a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return o}var ke=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Le=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Le),qe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ne(n,a){this.name=n,this.message=a}function Ae(n,a){return n+". Errors: "+Object.keys(a).map(function(o){return a[o].toString()}).filter(function(o,u,c){return c.indexOf(o)===u}).join(`
`)}function nt(n,a,o,u){this.failures=a,this.failedKeys=u,this.successCount=o,this.message=Ae(n,a)}function Ie(n,a){this.name="BulkError",this.failures=Object.keys(a).map(function(o){return a[o]}),this.failuresByPos=a,this.message=Ae(n,this.failures)}q(Ne).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(nt).from(Ne),q(Ie).from(Ne);var et=gt.reduce(function(n,a){return n[a]=a+"Error",n},{}),vt=Ne,ye=gt.reduce(function(n,a){var o=a+"Error";function u(c,h){this.name=o,c?typeof c=="string"?(this.message="".concat(c).concat(h?`
 `+h:""),this.inner=h||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=qe[a]||o,this.inner=null)}return q(u).from(vt),n[a]=u,n},{}),Mt=(ye.Syntax=SyntaxError,ye.Type=TypeError,ye.Range=RangeError,Le.reduce(function(n,a){return n[a+"Error"]=ye[a],n},{}));Le=gt.reduce(function(n,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(n[a+"Error"]=ye[a]),n},{});function He(){}function nn(n){return n}function ia(n,a){return n==null||n===nn?a:function(o){return a(n(o))}}function Lt(n,a){return function(){n.apply(this,arguments),a.apply(this,arguments)}}function Pa(n,a){return n===He?a:function(){var o=n.apply(this,arguments),u=(o!==void 0&&(arguments[0]=o),this.onsuccess),c=this.onerror,h=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Lt(u,this.onsuccess):u),c&&(this.onerror=this.onerror?Lt(c,this.onerror):c),h!==void 0?h:o}}function Ra(n,a){return n===He?a:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Lt(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Lt(u,this.onerror):u)}}function ir(n,a){return n===He?a:function(c){var u=n.apply(this,arguments),c=(v(c,u),this.onsuccess),h=this.onerror,g=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?Lt(c,this.onsuccess):c),h&&(this.onerror=this.onerror?Lt(h,this.onerror):h),u===void 0?g===void 0?void 0:g:v(u,g)}}function sa(n,a){return n===He?a:function(){return a.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function sr(n,a){return n===He?a:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,c=arguments.length,h=new Array(c);c--;)h[c]=arguments[c];return o.then(function(){return a.apply(u,h)})}return a.apply(this,arguments)}}Le.ModifyError=nt,Le.DexieError=Ne,Le.BulkError=Ie;var Vt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Oa(n){Vt=n}var Er={},oa=100,mn=typeof Promise>"u"?[]:(gt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[mn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(mn),gt]:[gt,p(gt),gt]),gt=mn[0],ha=mn[1],ha=ha&&ha.then,yt=gt&&gt.constructor,Ar=!!mn[2],or=function(n,a){Un.push([n,a]),lr&&(queueMicrotask(fr),lr=!1)},la=!0,lr=!0,Rn=[],Kn=[],ur=nn,bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:He,pgp:!1,env:{},finalize:He},Se=bt,Un=[],yn=0,ua=[];function pe(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=Se;if(typeof n!="function"){if(n!==Er)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Gn(this,this._value)}else this._state=null,this._value=null,++a.ref,(function o(u,c){try{c(function(h){if(u._state===null){if(h===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&dr();h&&typeof h.then=="function"?o(u,function(m,I){h instanceof pe?h._then(m,I):h.then(m,I)}):(u._state=!0,u._value=h,yi(u)),g&&Hn()}},Gn.bind(null,u))}catch(h){Gn(u,h)}})(this,n)}var cr={get:function(){var n=Se,a=Rr;function o(u,c){var h=this,g=!n.global&&(n!==Se||a!==Rr),m=g&&!_n(),I=new pe(function(M,C){Da(h,new mi(S(u,n,g,m),S(c,n,g,m),M,C,n))});return this._consoleTask&&(I._consoleTask=this._consoleTask),I}return o.prototype=Er,o},set:function(n){L(this,"then",n&&n.prototype===Er?cr:{get:function(){return n},set:cr.set})}};function mi(n,a,o,u,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof a=="function"?a:null,this.resolve=o,this.reject=u,this.psd=c}function Gn(n,a){var o,u;Kn.push(a),n._state===null&&(o=n._lib&&dr(),a=ur(a),n._state=!1,n._value=a,u=n,Rn.some(function(c){return c._value===u._value})||Rn.push(u),yi(n),o)&&Hn()}function yi(n){var a=n._listeners;n._listeners=[];for(var o=0,u=a.length;o<u;++o)Da(n,a[o]);var c=n._PSD;--c.ref||c.finalize(),yn===0&&(++yn,or(function(){--yn==0&&Ir()},[]))}function Da(n,a){if(n._state===null)n._listeners.push(a);else{var o=n._state?a.onFulfilled:a.onRejected;if(o===null)return(n._state?a.resolve:a.reject)(n._value);++a.psd.ref,++yn,or(ft,[o,n,a])}}function ft(n,a,o){try{var u,c=a._value;!a._state&&Kn.length&&(Kn=[]),u=Vt&&a._consoleTask?a._consoleTask.run(function(){return n(c)}):n(c),a._state||Kn.indexOf(c)!==-1||(h=>{for(var g=Rn.length;g;)if(Rn[--g]._value===h._value)return Rn.splice(g,1)})(a),o.resolve(u)}catch(h){o.reject(h)}finally{--yn==0&&Ir(),--o.psd.ref||o.psd.finalize()}}function fr(){Ee(bt,function(){dr()&&Hn()})}function dr(){var n=la;return lr=la=!1,n}function Hn(){var n,a,o;do for(;0<Un.length;)for(n=Un,Un=[],o=n.length,a=0;a<o;++a){var u=n[a];u[0].apply(null,u[1])}while(0<Un.length);lr=la=!0}function Ir(){for(var n=Rn,a=(Rn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),ua.slice(0)),o=a.length;o;)a[--o]()}function Cr(n){return new pe(Er,!1,n)}function tt(n,a){var o=Se;return function(){var u=dr(),c=Se;try{return wn(o,!0),n.apply(this,arguments)}catch(h){a&&a(h)}finally{wn(c,!1),u&&Hn()}}}b(pe.prototype,{then:cr,_then:function(n,a){Da(this,new mi(null,null,n,a,Se))},catch:function(n){var a,o;return arguments.length===1?this.then(null,n):(a=n,o=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?o:Cr)(u)}):this.then(null,function(u){return(u&&u.name===a?o:Cr)(u)}))},finally:function(n){return this.then(function(a){return pe.resolve(n()).then(function(){return a})},function(a){return pe.resolve(n()).then(function(){return Cr(a)})})},timeout:function(n,a){var o=this;return n<1/0?new pe(function(u,c){var h=setTimeout(function(){return c(new ye.Timeout(a))},n);o.then(u,c).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&L(pe.prototype,Symbol.toStringTag,"Dexie.Promise"),bt.env=_i(),b(pe,{all:function(){var n=ve.apply(null,arguments).map(Or);return new pe(function(a,o){n.length===0&&a([]);var u=n.length;n.forEach(function(c,h){return pe.resolve(c).then(function(g){n[h]=g,--u||a(n)},o)})})},resolve:function(n){return n instanceof pe?n:n&&typeof n.then=="function"?new pe(function(a,o){n.then(a,o)}):new pe(Er,!0,n)},reject:Cr,race:function(){var n=ve.apply(null,arguments).map(Or);return new pe(function(a,o){n.map(function(u){return pe.resolve(u).then(a,o)})})},PSD:{get:function(){return Se},set:function(n){return Se=n}},totalEchoes:{get:function(){return Rr}},newPSD:bn,usePSD:Ee,scheduler:{get:function(){return or},set:function(n){or=n}},rejectionMapper:{get:function(){return ur},set:function(n){ur=n}},follow:function(n,a){return new pe(function(o,u){return bn(function(c,h){var g=Se;g.unhandleds=[],g.onunhandled=h,g.finalize=Lt(function(){var m,I=this;m=function(){I.unhandleds.length===0?c():h(I.unhandleds[0])},ua.push(function M(){m(),ua.splice(ua.indexOf(M),1)}),++yn,or(function(){--yn==0&&Ir()},[])},g.finalize),n()},a,o,u)})}}),yt&&(yt.allSettled&&L(pe,"allSettled",function(){var n=ve.apply(null,arguments).map(Or);return new pe(function(a){n.length===0&&a([]);var o=n.length,u=new Array(o);n.forEach(function(c,h){return pe.resolve(c).then(function(g){return u[h]={status:"fulfilled",value:g}},function(g){return u[h]={status:"rejected",reason:g}}).then(function(){return--o||a(u)})})})}),yt.any&&typeof AggregateError<"u"&&L(pe,"any",function(){var n=ve.apply(null,arguments).map(Or);return new pe(function(a,o){n.length===0&&o(new AggregateError([]));var u=n.length,c=new Array(u);n.forEach(function(h,g){return pe.resolve(h).then(function(m){return a(m)},function(m){c[g]=m,--u||o(new AggregateError(c))})})})}),yt.withResolvers)&&(pe.withResolvers=yt.withResolvers);var mt={awaits:0,echoes:0,id:0},rn=0,an=[],Pr=0,Rr=0,Ma=0;function bn(n,g,o,u){var c=Se,h=Object.create(c),g=(h.parent=c,h.ref=0,h.global=!1,h.id=++Ma,bt.env,h.env=Ar?{Promise:pe,PromiseProp:{value:pe,configurable:!0,writable:!0},all:pe.all,race:pe.race,allSettled:pe.allSettled,any:pe.any,resolve:pe.resolve,reject:pe.reject}:{},g&&v(h,g),++c.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Ee(h,n,o,u));return h.ref===0&&h.finalize(),g}function Ct(){return mt.id||(mt.id=++rn),++mt.awaits,mt.echoes+=oa,mt.id}function _n(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*oa,!0)}function Or(n){return mt.echoes&&n&&n.constructor===yt?(Ct(),n.then(function(a){return _n(),a},function(a){return _n(),ce(a)})):n}function bi(){var n=an[an.length-1];an.pop(),wn(n,!1)}function wn(n,a){var o,u,c=Se;(a?!mt.echoes||Pr++&&n===Se:!Pr||--Pr&&n===Se)||queueMicrotask(a?(function(h){++Rr,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),an.push(Se),wn(h,!0)}).bind(null,n):bi),n!==Se&&(Se=n,c===bt&&(bt.env=_i()),Ar)&&(o=bt.env.Promise,u=n.env,c.global||n.global)&&(Object.defineProperty(l,"Promise",u.PromiseProp),o.all=u.all,o.race=u.race,o.resolve=u.resolve,o.reject=u.reject,u.allSettled&&(o.allSettled=u.allSettled),u.any)&&(o.any=u.any)}function _i(){var n=l.Promise;return Ar?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ee(n,a,o,u,c){var h=Se;try{return wn(n,!0),a(o,u,c)}finally{wn(h,!1)}}function S(n,a,o,u){return typeof n!="function"?n:function(){var c=Se;o&&Ct(),wn(a,!0);try{return n.apply(this,arguments)}finally{wn(c,!1),u&&queueMicrotask(_n)}}}function re(n){Promise===yt&&mt.echoes===0?Pr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ha).indexOf("[native code]")===-1&&(Ct=_n=He);var ce=pe.reject,$e="ï¿¿",rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",st="String expected.",dt=[],zt="__dbnames",On="readonly",Dr="readwrite";function it(n,a){return n?a?function(){return n.apply(this,arguments)&&a.apply(this,arguments)}:n:a}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mr(n){return typeof n!="string"||/\./.test(n)?function(a){return a}:function(a){return a[n]===void 0&&n in a&&delete(a=ae(a))[n],a}}function Uo(){throw ye.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function We(n,a){try{var o=Go(n),u=Go(a);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return a<n?1:n<a?-1:0;case"binary":for(var c=Ho(n),h=Ho(a),g=c.length,m=h.length,I=g<m?g:m,M=0;M<I;++M)if(c[M]!==h[M])return c[M]<h[M]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var C=n,x=a,R=C.length,O=x.length,P=R<O?R:O,A=0;A<P;++A){var N=We(C[A],x[A]);if(N!==0)return N}return R===O?0:R<O?-1:1}}catch{}return NaN}function Go(n){var a=typeof n;return a=="object"&&(ArrayBuffer.isView(n)||(a=Z(n))==="ArrayBuffer")?"binary":a}function Ho(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function wi(n,a,o){var u=n.schema.yProps;return u?(a&&0<o.numFailures&&(a=a.filter(function(c,h){return!o.failures[h]})),Promise.all(u.map(function(c){return c=c.updatesTable,a?n.db.table(c).where("k").anyOf(a).delete():n.db.table(c).clear()})).then(function(){return o})):o}Wo.prototype.execute=function(n){var a=this["@@propmod"];if(a.add!==void 0){var o=a.add;if(d(o))return s(s([],d(n)?n:[],!0),o).sort();if(typeof o=="number")return(Number(n)||0)+o;if(typeof o=="bigint")try{return BigInt(n)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(a.remove!==void 0){var u=a.remove;if(d(u))return d(n)?n.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return o=(o=a.replacePrefix)==null?void 0:o[0],o&&typeof n=="string"&&n.startsWith(o)?a.replacePrefix[1]+n.substring(o.length):n};var Na=Wo;function Wo(n){this["@@propmod"]=n}function Yo(n,a){for(var o=f(a),u=o.length,c=!1,h=0;h<u;++h){var g=o[h],m=a[g],I=ue(n,g);m instanceof Na?(Q(n,g,m.execute(I)),c=!0):I!==m&&(Q(n,g,m),c=!0)}return c}at.prototype._trans=function(n,a,o){var u=this._tx||Se.trans,c=this.name,h=Vt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(M,C,x){if(x.schema[c])return a(x.idbtrans,x);throw new ye.NotFound("Table "+c+" not part of transaction")}var m=dr();try{var I=u&&u.db._novip===this.db._novip?u===Se.trans?u._promise(n,g,o):bn(function(){return u._promise(n,g,o)},{trans:u,transless:Se.transless||Se}):(function M(C,x,R,O){if(C.idbdb&&(C._state.openComplete||Se.letThrough||C._vip)){var P=C._createTransaction(x,R,C._dbSchema);try{P.create(),C._state.PR1398_maxLoop=3}catch(A){return A.name===et.InvalidState&&C.isOpen()&&0<--C._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),C.close({disableAutoOpen:!1}),C.open().then(function(){return M(C,x,R,O)})):ce(A)}return P._promise(x,function(A,N){return bn(function(){return Se.trans=P,O(A,N,P)})}).then(function(A){if(x==="readwrite")try{P.idbtrans.commit()}catch{}return x==="readonly"?A:P._completion.then(function(){return A})})}if(C._state.openComplete)return ce(new ye.DatabaseClosed(C._state.dbOpenError));if(!C._state.isBeingOpened){if(!C._state.autoOpen)return ce(new ye.DatabaseClosed);C.open().catch(He)}return C._state.dbReadyPromise.then(function(){return M(C,x,R,O)})})(this.db,n,[this.name],g);return h&&(I._consoleTask=h,I=I.catch(function(M){return console.trace(M),ce(M)})),I}finally{m&&Hn()}},at.prototype.get=function(n,a){var o=this;return n&&n.constructor===Object?this.where(n).first(a):n==null?ce(new ye.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return o.core.get({trans:u,key:n}).then(function(c){return o.hook.reading.fire(c)})}).then(a)},at.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var a=f(n);if(a.length===1)return this.where(a[0]).equals(n[a[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(M){return 0<=m.keyPath.indexOf(M)})){for(var I=0;I<a.length;++I)if(a.indexOf(m.keyPath[I])===-1)return!1;return!0}return!1}).sort(function(m,I){return m.keyPath.length-I.keyPath.length})[0];if(o&&this.db._maxKey!==$e)return g=o.keyPath.slice(0,a.length),this.where(g).equals(g.map(function(m){return n[m]}));!o&&Vt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function c(m,I){return We(m,I)===0}var g=a.reduce(function(C,I){var M=C[0],C=C[1],x=u[I],R=n[I];return[M||x,M||!x?it(C,x&&x.multi?function(O){return O=ue(O,I),d(O)&&O.some(function(P){return c(R,P)})}:function(O){return c(R,ue(O,I))}):C]},[null,null]),h=g[0],g=g[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(g):o?this.filter(g):this.where(a).equals("")},at.prototype.filter=function(n){return this.toCollection().and(n)},at.prototype.count=function(n){return this.toCollection().count(n)},at.prototype.offset=function(n){return this.toCollection().offset(n)},at.prototype.limit=function(n){return this.toCollection().limit(n)},at.prototype.each=function(n){return this.toCollection().each(n)},at.prototype.toArray=function(n){return this.toCollection().toArray(n)},at.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},at.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},at.prototype.reverse=function(){return this.toCollection().reverse()},at.prototype.mapToClass=function(n){for(var a=this.db,o=this.name,u=((this.schema.mappedClass=n).prototype instanceof Uo&&(n=(g=>{var m=C,I=g;if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function M(){this.constructor=m}function C(){return g!==null&&g.apply(this,arguments)||this}return r(m,I),m.prototype=I===null?Object.create(I):(M.prototype=I.prototype,new M),Object.defineProperty(C.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),C.prototype.table=function(){return o},C})(n)),new Set),c=n.prototype;c;c=p(c))Object.getOwnPropertyNames(c).forEach(function(g){return u.add(g)});function h(g){if(!g)return g;var m,I=Object.create(n.prototype);for(m in g)if(!u.has(m))try{I[m]=g[m]}catch{}return I}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},at.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},at.prototype.add=function(n,a){var o=this,u=this.schema.primKey,c=u.auto,h=u.keyPath,g=n;return h&&c&&(g=Mr(h)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[g]})}).then(function(m){return m.numFailures?pe.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Q(n,h,m)}catch{}return m})},at.prototype.upsert=function(n,a){var o=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return o.core.get({trans:c,key:n}).then(function(h){var g=h??{};return Yo(g,a),u&&Q(g,u,n),o.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[a]}}).then(function(m){return m.numFailures?pe.reject(m.failures[0]):!!h})})})},at.prototype.update=function(n,a){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(a):(n=ue(n,this.schema.primKey.keyPath))===void 0?ce(new ye.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(a)},at.prototype.put=function(n,a){var o=this,u=this.schema.primKey,c=u.auto,h=u.keyPath,g=n;return h&&c&&(g=Mr(h)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"put",values:[g],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?pe.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Q(n,h,m)}catch{}return m})},at.prototype.delete=function(n){var a=this;return this._trans("readwrite",function(o){return a.core.mutate({trans:o,type:"delete",keys:[n]}).then(function(u){return wi(a,[n],u)}).then(function(u){return u.numFailures?pe.reject(u.failures[0]):void 0})})},at.prototype.clear=function(){var n=this;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"deleteRange",range:La}).then(function(o){return wi(n,null,o)})}).then(function(a){return a.numFailures?pe.reject(a.failures[0]):void 0})},at.prototype.bulkGet=function(n){var a=this;return this._trans("readonly",function(o){return a.core.getMany({keys:n,trans:o}).then(function(u){return u.map(function(c){return a.hook.reading.fire(c)})})})},at.prototype.bulkAdd=function(n,a,o){var u=this,c=Array.isArray(a)?a:void 0,h=(o=o||(c?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,M=m.auto,m=m.keyPath;if(m&&c)throw new ye.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ye.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,M=m&&M?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"add",keys:c,values:M,wantResults:h}).then(function(C){var x=C.numFailures,R=C.failures;if(x===0)return h?C.results:C.lastResult;throw new Ie("".concat(u.name,".bulkAdd(): ").concat(x," of ").concat(I," operations failed"),R)})})},at.prototype.bulkPut=function(n,a,o){var u=this,c=Array.isArray(a)?a:void 0,h=(o=o||(c?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,M=m.auto,m=m.keyPath;if(m&&c)throw new ye.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ye.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,M=m&&M?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"put",keys:c,values:M,wantResults:h}).then(function(C){var x=C.numFailures,R=C.failures;if(x===0)return h?C.results:C.lastResult;throw new Ie("".concat(u.name,".bulkPut(): ").concat(x," of ").concat(I," operations failed"),R)})})},at.prototype.bulkUpdate=function(n){var a=this,o=this.core,u=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),h=[];return this._trans("readwrite",function(g){return o.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var I=[],M=[],C=(n.forEach(function(x,R){var O=x.key,P=x.changes,A=m[R];if(A){for(var N=0,B=Object.keys(P);N<B.length;N++){var D=B[N],H=P[D];if(D===a.schema.primKey.keyPath){if(We(H,O)!==0)throw new ye.Constraint("Cannot update primary key in bulkUpdate()")}else Q(A,D,H)}h.push(R),I.push(O),M.push(A)}}),I.length);return o.mutate({trans:g,type:"put",keys:I,values:M,updates:{keys:u,changeSpecs:c}}).then(function(x){var R=x.numFailures,O=x.failures;if(R===0)return C;for(var P=0,A=Object.keys(O);P<A.length;P++){var N,B=A[P],D=h[Number(B)];D!=null&&(N=O[B],delete O[B],O[D]=N)}throw new Ie("".concat(a.name,".bulkUpdate(): ").concat(R," of ").concat(C," operations failed"),O)})})})},at.prototype.bulkDelete=function(n){var a=this,o=n.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:n}).then(function(c){return wi(a,n,c)})}).then(function(u){var c=u.numFailures,h=u.failures;if(c===0)return u.lastResult;throw new Ie("".concat(a.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),h)})};var Vo=at;function at(){}function qa(n){function a(g,m){if(m){for(var I=arguments.length,M=new Array(I-1);--I;)M[I-1]=arguments[I];return o[g].subscribe.apply(null,M),n}if(typeof g=="string")return o[g]}var o={};a.addEventType=h;for(var u=1,c=arguments.length;u<c;++u)h(arguments[u]);return a;function h(g,m,I){var M,C;if(typeof g!="object")return m=m||sa,C={subscribers:[],fire:I=I||He,subscribe:function(x){C.subscribers.indexOf(x)===-1&&(C.subscribers.push(x),C.fire=m(C.fire,x))},unsubscribe:function(x){C.subscribers=C.subscribers.filter(function(R){return R!==x}),C.fire=C.subscribers.reduce(m,I)}},o[g]=a[g]=C;f(M=g).forEach(function(x){var R=M[x];if(d(R))h(x,M[x][0],M[x][1]);else{if(R!=="asap")throw new ye.InvalidArgument("Invalid event config");var O=h(x,nn,function(){for(var P=arguments.length,A=new Array(P);P--;)A[P]=arguments[P];O.subscribers.forEach(function(N){$(function(){N.apply(null,A)})})})}})}}function ja(n,a){return q(a).from({prototype:n}),a}function ca(n,a){return!(n.filter||n.algorithm||n.or)&&(a?n.justLimit:!n.replayFilter)}function ds(n,a){n.filter=it(n.filter,a)}function hs(n,a,o){var u=n.replayFilter;n.replayFilter=u?function(){return it(u(),a())}:a,n.justLimit=o&&!u}function ki(n,a){if(n.isPrimKey)return a.primaryKey;var o=a.getIndexByKeyPath(n.index);if(o)return o;throw new ye.Schema("KeyPath "+n.index+" on object store "+a.name+" is not indexed")}function $o(n,a,o){var u=ki(n,a.schema);return a.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function xi(n,a,o,u){var c,h,g=n.replayFilter?it(n.filter,n.replayFilter()):n.filter;return n.or?(c={},h=function(m,I,M){var C,x;g&&!g(I,M,function(R){return I.stop(R)},function(R){return I.fail(R)})||((x=""+(C=I.primaryKey))=="[object ArrayBuffer]"&&(x=""+new Uint8Array(C)),w(c,x))||(c[x]=!0,a(m,I,M))},Promise.all([n.or._iterate(h,o),Xo($o(n,u,o),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):Xo($o(n,u,o),it(n.algorithm,g),a,!n.keysOnly&&n.valueMapper)}function Xo(n,a,o,u){var c=tt(u?function(h,g,m){return o(u(h),g,m)}:o);return n.then(function(h){if(h)return h.start(function(){var g=function(){return h.continue()};a&&!a(h,function(m){return g=m},function(m){h.stop(m),g=He},function(m){h.fail(m),g=He})||c(h.value,h,function(m){return g=m}),g()})})}Xe.prototype._read=function(n,a){var o=this._ctx;return o.error?o.table._trans(null,ce.bind(null,o.error)):o.table._trans("readonly",n).then(a)},Xe.prototype._write=function(n){var a=this._ctx;return a.error?a.table._trans(null,ce.bind(null,a.error)):a.table._trans("readwrite",n,"locked")},Xe.prototype._addAlgorithm=function(n){var a=this._ctx;a.algorithm=it(a.algorithm,n)},Xe.prototype._iterate=function(n,a){return xi(this._ctx,n,a,this._ctx.table.core)},Xe.prototype.clone=function(n){var a=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return n&&v(o,n),a._ctx=o,a},Xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Xe.prototype.each=function(n){var a=this._ctx;return this._read(function(o){return xi(a,n,o,a.table.core)})},Xe.prototype.count=function(n){var a=this;return this._read(function(o){var u,c=a._ctx,h=c.table.core;return ca(c,!0)?h.count({trans:o,query:{index:ki(c,h.schema),range:c.range}}).then(function(g){return Math.min(g,c.limit)}):(u=0,xi(c,function(){return++u,!1},o,h).then(function(){return u}))}).then(n)},Xe.prototype.sortBy=function(n,a){var o=n.split(".").reverse(),u=o[0],c=o.length-1;function h(I,M){return M?h(I[o[M]],M-1):I[u]}var g=this._ctx.dir==="next"?1:-1;function m(I,M){return We(h(I,c),h(M,c))*g}return this.toArray(function(I){return I.sort(m)}).then(a)},Xe.prototype.toArray=function(n){var a=this;return this._read(function(o){var u,c,h,g=a._ctx;return g.dir==="next"&&ca(g,!0)&&0<g.limit?(u=g.valueMapper,c=ki(g,g.table.core.schema),g.table.core.query({trans:o,limit:g.limit,values:!0,query:{index:c,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(h=[],xi(g,function(m){return h.push(m)},o,g.table.core).then(function(){return h}))},n)},Xe.prototype.offset=function(n){var a=this._ctx;return n<=0||(a.offset+=n,ca(a)?hs(a,function(){var o=n;return function(u,c){return o===0||(o===1?--o:c(function(){u.advance(o),o=0}),!1)}}):hs(a,function(){var o=n;return function(){return--o<0}})),this},Xe.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),hs(this._ctx,function(){var a=n;return function(o,u,c){return--a<=0&&u(c),0<=a}},!0),this},Xe.prototype.until=function(n,a){return ds(this._ctx,function(o,u,c){return!n(o.value)||(u(c),a)}),this},Xe.prototype.first=function(n){return this.limit(1).toArray(function(a){return a[0]}).then(n)},Xe.prototype.last=function(n){return this.reverse().first(n)},Xe.prototype.filter=function(n){var a;return ds(this._ctx,function(o){return n(o.value)}),(a=this._ctx).isMatch=it(a.isMatch,n),this},Xe.prototype.and=function(n){return this.filter(n)},Xe.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Xe.prototype.desc=function(){return this.reverse()},Xe.prototype.eachKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.key,u)})},Xe.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Xe.prototype.eachPrimaryKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.primaryKey,u)})},Xe.prototype.keys=function(n){var a=this._ctx,o=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,c){o.push(c.key)}).then(function(){return o}).then(n)},Xe.prototype.primaryKeys=function(n){var a=this._ctx;if(a.dir==="next"&&ca(a,!0)&&0<a.limit)return this._read(function(u){var c=ki(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:c,range:a.range}})}).then(function(u){return u.result}).then(n);a.keysOnly=!a.isMatch;var o=[];return this.each(function(u,c){o.push(c.primaryKey)}).then(function(){return o}).then(n)},Xe.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Xe.prototype.firstKey=function(n){return this.limit(1).keys(function(a){return a[0]}).then(n)},Xe.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Xe.prototype.distinct=function(){var n,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(n={},ds(this._ctx,function(u){var u=u.primaryKey.toString(),c=w(n,u);return n[u]=!0,!c})),this},Xe.prototype.modify=function(n){var a=this,o=this._ctx;return this._write(function(u){function c(A,N){var B=N.failures;R+=A-N.numFailures;for(var D=0,H=f(B);D<H.length;D++){var te=H[D];x.push(B[te])}}var h=typeof n=="function"?n:function(A){return Yo(A,n)},g=o.table.core,C=g.schema.primaryKey,m=C.outbound,I=C.extractKey,M=200,C=a.db._options.modifyChunkSize,x=(C&&(M=typeof C=="object"?C[g.name]||C["*"]||200:C),[]),R=0,O=[],P=n===Qo;return a.clone().primaryKeys().then(function(A){function N(D){var H=Math.min(M,A.length-D),te=A.slice(D,D+H);return(P?Promise.resolve([]):g.getMany({trans:u,keys:te,cache:"immutable"})).then(function(de){var he=[],ne=[],_e=m?[]:null,be=P?te:[];if(!P)for(var se=0;se<H;++se){var xe=de[se],Ye={value:ae(xe),primKey:A[D+se]};h.call(Ye,Ye.value,Ye)!==!1&&(Ye.value==null?be.push(A[D+se]):m||We(I(xe),I(Ye.value))===0?(ne.push(Ye.value),m&&_e.push(A[D+se])):(be.push(A[D+se]),he.push(Ye.value)))}return Promise.resolve(0<he.length&&g.mutate({trans:u,type:"add",values:he}).then(function(Qe){for(var Oe in Qe.failures)be.splice(parseInt(Oe),1);c(he.length,Qe)})).then(function(){return(0<ne.length||B&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:_e,values:ne,criteria:B,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<D}).then(function(Qe){return c(ne.length,Qe)})}).then(function(){return(0<be.length||B&&P)&&g.mutate({trans:u,type:"delete",keys:be,criteria:B,isAdditionalChunk:0<D}).then(function(Qe){return wi(o.table,be,Qe)}).then(function(Qe){return c(be.length,Qe)})}).then(function(){return A.length>D+H&&N(D+M)})})}var B=ca(o)&&o.limit===1/0&&(typeof n!="function"||P)&&{index:o.index,range:o.range};return N(0).then(function(){if(0<x.length)throw new nt("Error modifying one or more objects",x,R,O);return A.length})})})},Xe.prototype.delete=function(){var n=this._ctx,a=n.range;return!ca(n)||n.table.schema.yProps||!n.isPrimKey&&a.type!==3?this.modify(Qo):this._write(function(o){var u=n.table.core.schema.primaryKey,c=a;return n.table.core.count({trans:o,query:{index:u,range:c}}).then(function(h){return n.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(I){var m=I.failures,I=I.numFailures;if(I)throw new nt("Could not delete some values",Object.keys(m).map(function(M){return m[M]}),h-I);return h-I})})})};var Mc=Xe;function Xe(){}var Qo=function(n,a){return a.value=null};function Lc(n,a){return n<a?-1:n===a?0:1}function Nc(n,a){return a<n?-1:n===a?0:1}function $t(n,a,o){return n=n instanceof Jo?new n.Collection(n):n,n._ctx.error=new(o||TypeError)(a),n}function fa(n){return new n.Collection(n,function(){return Zo("")}).limit(0)}function Si(O,a,o,u){var c,h,g,m,I,M,C,x=o.length;if(!o.every(function(A){return typeof A=="string"}))return $t(O,st);function R(A){c=A==="next"?function(B){return B.toUpperCase()}:function(B){return B.toLowerCase()},h=A==="next"?function(B){return B.toLowerCase()}:function(B){return B.toUpperCase()},g=A==="next"?Lc:Nc;var N=o.map(function(B){return{lower:h(B),upper:c(B)}}).sort(function(B,D){return g(B.lower,D.lower)});m=N.map(function(B){return B.upper}),I=N.map(function(B){return B.lower}),C=(M=A)==="next"?"":u}R("next");var O=new O.Collection(O,function(){return hr(m[0],I[x-1]+u)}),P=(O._ondirectionchange=function(A){R(A)},0);return O._addAlgorithm(function(A,N,B){var D=A.key;if(typeof D=="string"){var H=h(D);if(a(H,I,P))return!0;for(var te=null,de=P;de<x;++de){var he=((ne,_e,be,se,xe,Ye)=>{for(var Qe=Math.min(ne.length,se.length),Oe=-1,Be=0;Be<Qe;++Be){var ot=_e[Be];if(ot!==se[Be])return xe(ne[Be],be[Be])<0?ne.substr(0,Be)+be[Be]+be.substr(Be+1):xe(ne[Be],se[Be])<0?ne.substr(0,Be)+se[Be]+be.substr(Be+1):0<=Oe?ne.substr(0,Oe)+_e[Oe]+be.substr(Oe+1):null;xe(ne[Be],ot)<0&&(Oe=Be)}return Qe<se.length&&Ye==="next"?ne+be.substr(ne.length):Qe<ne.length&&Ye==="prev"?ne.substr(0,be.length):Oe<0?null:ne.substr(0,Oe)+se[Oe]+be.substr(Oe+1)})(D,H,m[de],I[de],g,M);he===null&&te===null?P=de+1:(te===null||0<g(te,he))&&(te=he)}N(te!==null?function(){A.continue(te+C)}:B)}return!1}),O}function hr(n,a,o,u){return{type:2,lower:n,upper:a,lowerOpen:o,upperOpen:u}}function Zo(n){return{type:1,lower:n,upper:n}}Object.defineProperty(_t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_t.prototype.between=function(n,a,o,u){o=o!==!1,u=u===!0;try{return 0<this._cmp(n,a)||this._cmp(n,a)===0&&(o||u)&&(!o||!u)?fa(this):new this.Collection(this,function(){return hr(n,a,!o,!u)})}catch{return $t(this,rt)}},_t.prototype.equals=function(n){return n==null?$t(this,rt):new this.Collection(this,function(){return Zo(n)})},_t.prototype.above=function(n){return n==null?$t(this,rt):new this.Collection(this,function(){return hr(n,void 0,!0)})},_t.prototype.aboveOrEqual=function(n){return n==null?$t(this,rt):new this.Collection(this,function(){return hr(n,void 0,!1)})},_t.prototype.below=function(n){return n==null?$t(this,rt):new this.Collection(this,function(){return hr(void 0,n,!1,!0)})},_t.prototype.belowOrEqual=function(n){return n==null?$t(this,rt):new this.Collection(this,function(){return hr(void 0,n)})},_t.prototype.startsWith=function(n){return typeof n!="string"?$t(this,st):this.between(n,n+$e,!0,!0)},_t.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Si(this,function(a,o){return a.indexOf(o[0])===0},[n],$e)},_t.prototype.equalsIgnoreCase=function(n){return Si(this,function(a,o){return a===o[0]},[n],"")},_t.prototype.anyOfIgnoreCase=function(){var n=ve.apply(W,arguments);return n.length===0?fa(this):Si(this,function(a,o){return o.indexOf(a)!==-1},n,"")},_t.prototype.startsWithAnyOfIgnoreCase=function(){var n=ve.apply(W,arguments);return n.length===0?fa(this):Si(this,function(a,o){return o.some(function(u){return a.indexOf(u)===0})},n,$e)},_t.prototype.anyOf=function(){var n,a,o=this,u=ve.apply(W,arguments),c=this._cmp;try{u.sort(c)}catch{return $t(this,rt)}return u.length===0?fa(this):((n=new this.Collection(this,function(){return hr(u[0],u[u.length-1])}))._ondirectionchange=function(h){c=h==="next"?o._ascending:o._descending,u.sort(c)},a=0,n._addAlgorithm(function(h,g,m){for(var I=h.key;0<c(I,u[a]);)if(++a===u.length)return g(m),!1;return c(I,u[a])===0||(g(function(){h.continue(u[a])}),!1)}),n)},_t.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_t.prototype.noneOf=function(){var n=ve.apply(W,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return $t(this,rt)}var a=n.reduce(function(o,u){return o?o.concat([[o[o.length-1][1],u]]):[[-1/0,u]]},null);return a.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},_t.prototype.inAnyRange=function(n,B){var o=this,u=this._cmp,c=this._ascending,h=this._descending,g=this._min,m=this._max;if(n.length===0)return fa(this);if(!n.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&c(D[0],D[1])<=0}))return $t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ye.InvalidArgument);var I=!B||B.includeLowers!==!1,M=B&&B.includeUppers===!0,C,x=c;function R(D,H){return x(D[0],H[0])}try{(C=n.reduce(function(D,H){for(var te=0,de=D.length;te<de;++te){var he=D[te];if(u(H[0],he[1])<0&&0<u(H[1],he[0])){he[0]=g(he[0],H[0]),he[1]=m(he[1],H[1]);break}}return te===de&&D.push(H),D},[])).sort(R)}catch{return $t(this,rt)}var O=0,P=M?function(D){return 0<c(D,C[O][1])}:function(D){return 0<=c(D,C[O][1])},A=I?function(D){return 0<h(D,C[O][0])}:function(D){return 0<=h(D,C[O][0])},N=P,B=new this.Collection(this,function(){return hr(C[0][0],C[C.length-1][1],!I,!M)});return B._ondirectionchange=function(D){x=D==="next"?(N=P,c):(N=A,h),C.sort(R)},B._addAlgorithm(function(D,H,te){for(var de,he=D.key;N(he);)if(++O===C.length)return H(te),!1;return!P(de=he)&&!A(de)||(o._cmp(he,C[O][1])===0||o._cmp(he,C[O][0])===0||H(function(){x===c?D.continue(C[O][0]):D.continue(C[O][1])}),!1)}),B},_t.prototype.startsWithAnyOf=function(){var n=ve.apply(W,arguments);return n.every(function(a){return typeof a=="string"})?n.length===0?fa(this):this.inAnyRange(n.map(function(a){return[a,a+$e]})):$t(this,"startsWithAnyOf() only works with strings")};var Jo=_t;function _t(){}function Dn(n){return tt(function(a){return Ba(a),n(a.target.error),!1})}function Ba(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var za="storagemutated",ps="x-storagemutated-1",pr=qa(null,za),qc=(Mn.prototype._lock=function(){return K(!Se.global),++this._reculock,this._reculock!==1||Se.global||(Se.lockOwnerFor=this),this},Mn.prototype._unlock=function(){if(K(!Se.global),--this._reculock==0)for(Se.global||(Se.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ee(n[1],n[0])}catch{}}return this},Mn.prototype._locked=function(){return this._reculock&&Se.lockOwnerFor!==this},Mn.prototype.create=function(n){var a=this;if(this.mode){var o=this.db.idbdb,u=this.db._state.dbOpenError;if(K(!this.idbtrans),!n&&!o)switch(u&&u.name){case"DatabaseClosedError":throw new ye.DatabaseClosed(u);case"MissingAPIError":throw new ye.MissingAPI(u.message,u);default:throw new ye.OpenFailed(u)}if(!this.active)throw new ye.TransactionInactive;K(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=tt(function(c){Ba(c),a._reject(n.error)}),n.onabort=tt(function(c){Ba(c),a.active&&a._reject(new ye.Abort(n.error)),a.active=!1,a.on("abort").fire(c)}),n.oncomplete=tt(function(){a.active=!1,a._resolve(),"mutatedParts"in n&&pr.storagemutated.fire(n.mutatedParts)})}return this},Mn.prototype._promise=function(n,a,o){var u,c=this;return n==="readwrite"&&this.mode!=="readwrite"?ce(new ye.ReadOnly("Transaction is readonly")):this.active?this._locked()?new pe(function(h,g){c._blockedFuncs.push([function(){c._promise(n,a,o).then(h,g)},Se])}):o?bn(function(){var h=new pe(function(g,m){c._lock();var I=a(g,m,c);I&&I.then&&I.then(g,m)});return h.finally(function(){return c._unlock()}),h._lib=!0,h}):((u=new pe(function(h,g){var m=a(h,g,c);m&&m.then&&m.then(h,g)}))._lib=!0,u):ce(new ye.TransactionInactive)},Mn.prototype._root=function(){return this.parent?this.parent._root():this},Mn.prototype.waitFor=function(n){var a,o=this._root(),u=pe.resolve(n),c=(o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return u}):(o._waitingFor=u,o._waitingQueue=[],a=o.idbtrans.objectStore(o.storeNames[0]),(function h(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(a.get(-1/0).onsuccess=h)})()),o._waitingFor);return new pe(function(h,g){u.then(function(m){return o._waitingQueue.push(tt(h.bind(null,m)))},function(m){return o._waitingQueue.push(tt(g.bind(null,m)))}).finally(function(){o._waitingFor===c&&(o._waitingFor=null)})})},Mn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ye.Abort))},Mn.prototype.table=function(n){var a=this._memoizedTables||(this._memoizedTables={});if(w(a,n))return a[n];var o=this.schema[n];if(o)return(o=new this.db.Table(n,o,this)).core=this.db.core.table(n),a[n]=o;throw new ye.NotFound("Table "+n+" not part of transaction")},Mn);function Mn(){}function vs(n,a,o,u,c,h,g,m){return{name:n,keyPath:a,unique:o,multi:u,auto:c,compound:h,src:(o&&!g?"&":"")+(u?"*":"")+(c?"++":"")+el(a),type:m}}function el(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function gs(n,a,o){return{name:n,primKey:a,indexes:o,mappedClass:null,idxByName:(u=function(c){return[c.name,c]},o.reduce(function(c,h,g){return h=u(h,g),h&&(c[h[0]]=h[1]),c},{}))};var u}var Fa=function(n){try{return n.only([[]]),Fa=function(){return[[]]},[[]]}catch{return Fa=function(){return $e},$e}};function ms(n){return n==null?function(){}:typeof n=="string"?(a=n).split(".").length===1?function(o){return o[a]}:function(o){return ue(o,a)}:function(o){return ue(o,n)};var a}function tl(n){return[].slice.call(n)}var jc=0;function Ka(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Bc(n,a,I){function u(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var x=P.lower,R=P.upper,O=P.lowerOpen,P=P.upperOpen;return x===void 0?R===void 0?null:a.upperBound(R,!!P):R===void 0?a.lowerBound(x,!!O):a.bound(x,R,!!O,!!P)}function c(C){var x,R=C.name;return{name:R,schema:C,mutate:function(O){var P=O.trans,A=O.type,N=O.keys,B=O.values,D=O.range;return new Promise(function(H,te){H=tt(H);var de=P.objectStore(R),he=de.keyPath==null,ne=A==="put"||A==="add";if(!ne&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var _e,be=(N||B||{length:1}).length;if(N&&B&&N.length!==B.length)throw new Error("Given keys array must have same length as given values array.");if(be===0)return H({numFailures:0,failures:{},results:[],lastResult:void 0});function se(lt){++Qe,Ba(lt)}var xe=[],Ye=[],Qe=0;if(A==="deleteRange"){if(D.type===4)return H({numFailures:Qe,failures:Ye,results:[],lastResult:void 0});D.type===3?xe.push(_e=de.clear()):xe.push(_e=de.delete(u(D)))}else{var he=ne?he?[B,N]:[B,null]:[N,null],Oe=he[0],Be=he[1];if(ne)for(var ot=0;ot<be;++ot)xe.push(_e=Be&&Be[ot]!==void 0?de[A](Oe[ot],Be[ot]):de[A](Oe[ot])),_e.onerror=se;else for(ot=0;ot<be;++ot)xe.push(_e=de[A](Oe[ot])),_e.onerror=se}function sn(lt){lt=lt.target.result,xe.forEach(function(qr,Ls){return qr.error!=null&&(Ye[Ls]=qr.error)}),H({numFailures:Qe,failures:Ye,results:A==="delete"?N:xe.map(function(qr){return qr.result}),lastResult:lt})}_e.onerror=function(lt){se(lt),sn(lt)},_e.onsuccess=sn})},getMany:function(O){var P=O.trans,A=O.keys;return new Promise(function(N,B){N=tt(N);for(var D,H=P.objectStore(R),te=A.length,de=new Array(te),he=0,ne=0,_e=function(xe){xe=xe.target,de[xe._pos]=xe.result,++ne===he&&N(de)},be=Dn(B),se=0;se<te;++se)A[se]!=null&&((D=H.get(A[se]))._pos=se,D.onsuccess=_e,D.onerror=be,++he);he===0&&N(de)})},get:function(O){var P=O.trans,A=O.key;return new Promise(function(N,B){N=tt(N);var D=P.objectStore(R).get(A);D.onsuccess=function(H){return N(H.target.result)},D.onerror=Dn(B)})},query:(x=m,function(O){return new Promise(function(P,A){P=tt(P);var N,B,D,ne=O.trans,H=O.values,te=O.limit,he=O.query,de=te===1/0?void 0:te,_e=he.index,he=he.range,ne=ne.objectStore(R),ne=_e.isPrimaryKey?ne:ne.index(_e.name),_e=u(he);if(te===0)return P({result:[]});x?((he=H?ne.getAll(_e,de):ne.getAllKeys(_e,de)).onsuccess=function(be){return P({result:be.target.result})},he.onerror=Dn(A)):(N=0,B=!H&&"openKeyCursor"in ne?ne.openKeyCursor(_e):ne.openCursor(_e),D=[],B.onsuccess=function(be){var se=B.result;return!se||(D.push(H?se.value:se.primaryKey),++N===te)?P({result:D}):void se.continue()},B.onerror=Dn(A))})}),openCursor:function(O){var P=O.trans,A=O.values,N=O.query,B=O.reverse,D=O.unique;return new Promise(function(H,te){H=tt(H);var ne=N.index,de=N.range,he=P.objectStore(R),he=ne.isPrimaryKey?he:he.index(ne.name),ne=B?D?"prevunique":"prev":D?"nextunique":"next",_e=!A&&"openKeyCursor"in he?he.openKeyCursor(u(de),ne):he.openCursor(u(de),ne);_e.onerror=Dn(te),_e.onsuccess=tt(function(be){var se,xe,Ye,Qe,Oe=_e.result;Oe?(Oe.___id=++jc,Oe.done=!1,se=Oe.continue.bind(Oe),xe=(xe=Oe.continuePrimaryKey)&&xe.bind(Oe),Ye=Oe.advance.bind(Oe),Qe=function(){throw new Error("Cursor not stopped")},Oe.trans=P,Oe.stop=Oe.continue=Oe.continuePrimaryKey=Oe.advance=function(){throw new Error("Cursor not started")},Oe.fail=tt(te),Oe.next=function(){var Be=this,ot=1;return this.start(function(){return ot--?Be.continue():Be.stop()}).then(function(){return Be})},Oe.start=function(Be){function ot(){if(_e.result)try{Be()}catch(lt){Oe.fail(lt)}else Oe.done=!0,Oe.start=function(){throw new Error("Cursor behind last entry")},Oe.stop()}var sn=new Promise(function(lt,qr){lt=tt(lt),_e.onerror=Dn(qr),Oe.fail=qr,Oe.stop=function(Ls){Oe.stop=Oe.continue=Oe.continuePrimaryKey=Oe.advance=Qe,lt(Ls)}});return _e.onsuccess=tt(function(lt){_e.onsuccess=ot,ot()}),Oe.continue=se,Oe.continuePrimaryKey=xe,Oe.advance=Ye,ot(),sn},H(Oe)):H(null)},te)})},count:function(O){var P=O.query,A=O.trans,N=P.index,B=P.range;return new Promise(function(D,H){var te=A.objectStore(R),te=N.isPrimaryKey?te:te.index(N.name),de=u(B),de=de?te.count(de):te.count();de.onsuccess=tt(function(he){return D(he.target.result)}),de.onerror=Dn(H)})}}}h=I,g=tl((I=n).objectStoreNames);var h,I={schema:{name:I.name,tables:g.map(function(C){return h.objectStore(C)}).map(function(C){var x=C.keyPath,R=C.autoIncrement,P=d(x),O={},P={name:C.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:x==null,compound:P,keyPath:x,autoIncrement:R,unique:!0,extractKey:ms(x)},indexes:tl(C.indexNames).map(function(A){return C.index(A)}).map(function(D){var H=D.name,N=D.unique,B=D.multiEntry,D=D.keyPath,H={name:H,compound:d(D),keyPath:D,unique:N,multiEntry:B,extractKey:ms(D)};return O[Ka(D)]=H}),getIndexByKeyPath:function(A){return O[Ka(A)]}};return O[":id"]=P.primaryKey,x!=null&&(O[Ka(x)]=P.primaryKey),P})},hasGetAll:0<g.length&&"getAll"in h.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=I.schema,m=I.hasGetAll,I=g.tables.map(c),M={};return I.forEach(function(C){return M[C.name]=C}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(C){if(M[C])return M[C];throw new Error("Table '".concat(C,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Fa(a),schema:g}}function zc(n,a,o,u){return o=o.IDBKeyRange,a=Bc(a,o,u),{dbcore:n.dbcore.reduce(function(c,h){return h=h.create,i(i({},c),h(c))},a)}}function Ti(n,a){var o=a.db,o=zc(n._middlewares,o,n._deps,a);n.core=o.dbcore,n.tables.forEach(function(u){var c=u.name;n.core.schema.tables.some(function(h){return h.name===c})&&(u.core=n.core.table(c),n[c]instanceof n.Table)&&(n[c].core=u.core)})}function Ei(n,a,o,u){o.forEach(function(c){var h=u[c];a.forEach(function(g){var m=(function I(M,C){return E(M,C)||(M=p(M))&&I(M,C)})(g,c);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?L(g,c,{get:function(){return this.table(c)},set:function(I){_(this,c,{value:I,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,h))})})}function ys(n,a){a.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function Fc(n,a){return n._cfg.version-a._cfg.version}function Kc(n,a,o,u){var c=n._dbSchema,h=(o.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=gs("$meta",rl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,c)),g=(h.create(o),h._completion.catch(u),h._reject.bind(h)),m=Se.transless||Se;bn(function(){if(Se.trans=h,Se.transless=m,a!==0)return Ti(n,o),M=a,((I=h).storeNames.includes("$meta")?I.table("$meta").get("version").then(function(C){return C??M}):pe.resolve(M)).then(function(N){var x=n,R=N,O=h,P=o,A=[],N=x._versions,B=x._dbSchema=Ii(0,x.idbdb,P);return(N=N.filter(function(D){return D._cfg.version>=R})).length===0?pe.resolve():(N.forEach(function(D){A.push(function(){var H,te,de,he=B,ne=D._cfg.dbschema,_e=(Ci(x,he,P),Ci(x,ne,P),B=x._dbSchema=ne,bs(he,ne)),be=(_e.add.forEach(function(se){_s(P,se[0],se[1].primKey,se[1].indexes)}),_e.change.forEach(function(se){if(se.recreate)throw new ye.Upgrade("Not yet support for changing primary key");var xe=P.objectStore(se.name);se.add.forEach(function(Ye){return Ai(xe,Ye)}),se.change.forEach(function(Ye){xe.deleteIndex(Ye.name),Ai(xe,Ye)}),se.del.forEach(function(Ye){return xe.deleteIndex(Ye)})}),D._cfg.contentUpgrade);if(be&&D._cfg.version>R)return Ti(x,P),O._memoizedTables={},H=me(ne),_e.del.forEach(function(se){H[se]=he[se]}),ys(x,[x.Transaction.prototype]),Ei(x,[x.Transaction.prototype],f(H),H),O.schema=H,(te=ke(be))&&Ct(),ne=pe.follow(function(){var se;(de=be(O))&&te&&(se=_n.bind(null,null),de.then(se,se))}),de&&typeof de.then=="function"?pe.resolve(de):ne.then(function(){return de})}),A.push(function(H){var te,de,he=D._cfg.dbschema;te=he,de=H,[].slice.call(de.db.objectStoreNames).forEach(function(ne){return te[ne]==null&&de.db.deleteObjectStore(ne)}),ys(x,[x.Transaction.prototype]),Ei(x,[x.Transaction.prototype],x._storeNames,x._dbSchema),O.schema=x._dbSchema}),A.push(function(H){x.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(x.idbdb.version/10)===D._cfg.version?(x.idbdb.deleteObjectStore("$meta"),delete x._dbSchema.$meta,x._storeNames=x._storeNames.filter(function(te){return te!=="$meta"})):H.objectStore("$meta").put(D._cfg.version,"version"))})}),(function D(){return A.length?pe.resolve(A.shift()(O.idbtrans)).then(D):pe.resolve()})().then(function(){nl(B,P)}))}).catch(g);var I,M;f(c).forEach(function(C){_s(o,C,c[C].primKey,c[C].indexes)}),Ti(n,o),pe.follow(function(){return n.on.populate.fire(h)}).catch(g)})}function Uc(n,a){nl(n._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var o=Ii(0,n.idbdb,a);Ci(n,n._dbSchema,a);for(var u=0,c=bs(o,n._dbSchema).change;u<c.length;u++){var h=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(g.name);g.add.forEach(function(I){Vt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(I.src)),Ai(m,I)})})(c[u]);if(typeof h=="object")return h.value}}function bs(n,a){var o,u={del:[],add:[],change:[]};for(o in n)a[o]||u.del.push(o);for(o in a){var c=n[o],h=a[o];if(c){var g={name:o,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||c.primKey.auto!==h.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=c.idxByName,I=h.idxByName,M=void 0;for(M in m)I[M]||g.del.push(M);for(M in I){var C=m[M],x=I[M];C?C.src!==x.src&&g.change.push(x):g.add.push(x)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([o,h])}return u}function _s(n,a,o,u){var c=n.db.createObjectStore(a,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});u.forEach(function(h){return Ai(c,h)})}function nl(n,a){f(n).forEach(function(o){a.db.objectStoreNames.contains(o)||(Vt&&console.debug("Dexie: Creating missing table",o),_s(a,o,n[o].primKey,n[o].indexes))})}function Ai(n,a){n.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function Ii(n,a,o){var u={};return ee(a.objectStoreNames,0).forEach(function(c){for(var h=o.objectStore(c),g=vs(el(M=h.keyPath),M||"",!0,!1,!!h.autoIncrement,M&&typeof M!="string",!0),m=[],I=0;I<h.indexNames.length;++I){var C=h.index(h.indexNames[I]),M=C.keyPath,C=vs(C.name,M,!!C.unique,!!C.multiEntry,!1,M&&typeof M!="string",!1);m.push(C)}u[c]=gs(c,g,m)}),u}function Ci(n,a,o){for(var u=o.db.objectStoreNames,c=0;c<u.length;++c){var h=u[c],g=o.objectStore(h);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var I,M=g.indexNames[m],C=g.index(M).keyPath,C=typeof C=="string"?C:"["+ee(C).join("+")+"]";a[h]&&(I=a[h].idxByName[C])&&(I.name=M,delete a[h].idxByName[C],a[h].idxByName[M]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function rl(n){return n.split(",").map(function(a,o){var c=a.split(":"),u=(u=c[1])==null?void 0:u.trim(),c=(a=c[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return vs(c,h||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),d(h),o===0,u)})}da.prototype._createTableSchema=gs,da.prototype._parseIndexSyntax=rl,da.prototype._parseStoresSpec=function(n,a){var o=this;f(n).forEach(function(u){if(n[u]!==null){var c=o._parseIndexSyntax(n[u]),h=c.shift();if(!h)throw new ye.Schema("Invalid schema for table "+u+": "+n[u]);if(h.unique=!0,h.multi)throw new ye.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new ye.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ye.Schema("Index must have a name and cannot be an empty string")}),h=o._createTableSchema(u,h,c),a[u]=h}})},da.prototype.stores=function(o){var a=this.db,o=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,o):o,a._versions),u={},c={};return o.forEach(function(h){v(u,h._cfg.storesSource),c=h._cfg.dbschema={},h._parseStoresSpec(u,c)}),a._dbSchema=c,ys(a,[a._allTables,a,a.Transaction.prototype]),Ei(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],f(c),c),a._storeNames=f(c),this},da.prototype.upgrade=function(n){return this._cfg.contentUpgrade=sr(this._cfg.contentUpgrade||He,n),this};var Gc=da;function da(){}function ws(n,a){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new Wn(zt,{addons:[],indexedDB:n,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function ks(n){return n&&typeof n.databases=="function"}function xs(n){return bn(function(){return Se.letThrough=!0,n()})}function Ss(n){return!("from"in n)}var Pt=function(n,a){var o;if(!this)return o=new Pt,n&&"d"in n&&v(o,n),o;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?a:n}:{d:0})};function Ua(n,a,o){var u=We(a,o);if(!isNaN(u)){if(0<u)throw RangeError();if(Ss(n))return v(n,{from:a,to:o,d:1});var u=n.l,c=n.r;if(We(o,n.from)<0)return u?Ua(u,a,o):n.l={from:a,to:o,d:1,l:null,r:null},il(n);if(0<We(a,n.to))return c?Ua(c,a,o):n.r={from:a,to:o,d:1,l:null,r:null},il(n);We(a,n.from)<0&&(n.from=a,n.l=null,n.d=c?c.d+1:1),0<We(o,n.to)&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,u&&!n.l&&Ga(n,u),c&&a&&Ga(n,c)}}function Ga(n,a){Ss(a)||(function o(u,c){var h=c.from,g=c.l,m=c.r;Ua(u,h,c.to),g&&o(u,g),m&&o(u,m)})(n,a)}function al(n,a){var o=Pi(a),u=o.next();if(!u.done)for(var c=u.value,h=Pi(n),g=h.next(c.from),m=g.value;!u.done&&!g.done;){if(We(m.from,c.to)<=0&&0<=We(m.to,c.from))return!0;We(c.from,m.from)<0?c=(u=o.next(m.from)).value:m=(g=h.next(c.from)).value}return!1}function Pi(n){var a=Ss(n)?null:{s:0,n};return{next:function(o){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&We(o,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||We(o,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function il(n){var a,o,u,c=(((c=n.r)==null?void 0:c.d)||0)-(((c=n.l)==null?void 0:c.d)||0),c=1<c?"r":c<-1?"l":"";c&&(a=c=="r"?"l":"r",o=i({},n),u=n[c],n.from=u.from,n.to=u.to,n[c]=u[c],o[c]=u[a],(n[a]=o).d=sl(o)),n.d=sl(n)}function sl(o){var a=o.r,o=o.l;return(a?o?Math.max(a.d,o.d):a.d:o?o.d:0)+1}function Ri(n,a){return f(a).forEach(function(o){n[o]?Ga(n[o],a[o]):n[o]=(function u(c){var h,g,m={};for(h in c)w(c,h)&&(g=c[h],m[h]=!g||typeof g!="object"||fe.has(g.constructor)?g:u(g));return m})(a[o])}),n}function Ts(n,a){return n.all||a.all||Object.keys(n).some(function(o){return a[o]&&al(a[o],n[o])})}b(Pt.prototype,((gt={add:function(n){return Ga(this,n),this},addKey:function(n){return Ua(this,n,n),this},addKeys:function(n){var a=this;return n.forEach(function(o){return Ua(a,o,o)}),this},hasKey:function(n){var a=Pi(this).next(n).value;return a&&We(a.from,n)<=0&&0<=We(a.to,n)}})[ie]=function(){return Pi(this)},gt));var Lr={},Es={},As=!1;function Oi(n){Ri(Es,n),As||(As=!0,setTimeout(function(){As=!1,Is(Es,!(Es={}))},0))}function Is(n,a){a===void 0&&(a=!1);var o=new Set;if(n.all)for(var u=0,c=Object.values(Lr);u<c.length;u++)ol(m=c[u],n,o,a);else for(var h in n){var g,m,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(g=h[1],h=h[2],m=Lr["idb://".concat(g,"/").concat(h)])&&ol(m,n,o,a)}o.forEach(function(I){return I()})}function ol(n,a,o,u){for(var c=[],h=0,g=Object.entries(n.queries.query);h<g.length;h++){for(var m=g[h],I=m[0],M=[],C=0,x=m[1];C<x.length;C++){var R=x[C];Ts(a,R.obsSet)?R.subscribers.forEach(function(N){return o.add(N)}):u&&M.push(R)}u&&c.push([I,M])}if(u)for(var O=0,P=c;O<P.length;O++){var A=P[O],I=A[0],M=A[1];n.queries.query[I]=M}}function Hc(n){var a=n._state,o=n._deps.indexedDB;if(a.isBeingOpened||n.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?ce(a.dbOpenError):n});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,c=Math.round(10*n.verno),h=!1;function g(){if(a.openCanceller!==u)throw new ye.DatabaseClosed("db.open() was cancelled")}function m(){return new pe(function(R,O){if(g(),!o)throw new ye.MissingAPI;var P=n.name,A=a.autoSchema||!c?o.open(P):o.open(P,c);if(!A)throw new ye.MissingAPI;A.onerror=Dn(O),A.onblocked=tt(n._fireOnBlocked),A.onupgradeneeded=tt(function(N){var B;C=A.transaction,a.autoSchema&&!n._options.allowEmptyDB?(A.onerror=Ba,C.abort(),A.result.close(),(B=o.deleteDatabase(P)).onsuccess=B.onerror=tt(function(){O(new ye.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(C.onerror=Dn(O),B=N.oldVersion>Math.pow(2,62)?0:N.oldVersion,x=B<1,n.idbdb=A.result,h&&Uc(n,C),Kc(n,B/10,C,O))},O),A.onsuccess=tt(function(){C=null;var N,B,D,H,te,de,he=n.idbdb=A.result,ne=ee(he.objectStoreNames);if(0<ne.length)try{var _e=he.transaction((te=ne).length===1?te[0]:te,"readonly");if(a.autoSchema)de=he,H=_e,(D=n).verno=de.version/10,H=D._dbSchema=Ii(0,de,H),D._storeNames=ee(de.objectStoreNames,0),Ei(D,[D._allTables],f(H),H);else if(Ci(n,n._dbSchema,_e),B=_e,((B=bs(Ii(0,(N=n).idbdb,B),N._dbSchema)).add.length||B.change.some(function(be){return be.add.length||be.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),he.close(),c=he.version+1,h=!0,R(m());Ti(n,_e)}catch{}dt.push(n),he.onversionchange=tt(function(be){a.vcFired=!0,n.on("versionchange").fire(be)}),he.onclose=tt(function(){n.close({disableAutoOpen:!1})}),x&&(ne=n._deps,te=P,ks(de=ne.indexedDB)||te===zt||ws(de,ne.IDBKeyRange).put({name:te}).catch(He)),R()},O)}).catch(function(R){switch(R==null?void 0:R.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<c)return c=0,m()}return pe.reject(R)})}var I,M=a.dbReadyResolve,C=null,x=!1;return pe.race([u,(typeof navigator>"u"?pe.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(R){function O(){return indexedDB.databases().finally(R)}I=setInterval(O,100),O()}).finally(function(){return clearInterval(I)}):Promise.resolve()).then(m)]).then(function(){return g(),a.onReadyBeingFired=[],pe.resolve(xs(function(){return n.on.ready.fire(n.vip)})).then(function R(){var O;if(0<a.onReadyBeingFired.length)return O=a.onReadyBeingFired.reduce(sr,He),a.onReadyBeingFired=[],pe.resolve(xs(function(){return O(n.vip)})).then(R)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(R){a.dbOpenError=R;try{C&&C.abort()}catch{}return u===a.openCanceller&&n._close(),ce(R)}).finally(function(){a.openComplete=!0,M()}).then(function(){var R;return x&&(R={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(P){P.name&&(R["idb://".concat(n.name,"/").concat(O.name,"/").concat(P.name)]=new Pt(-1/0,[[[]]]))}),R["idb://".concat(n.name,"/").concat(O.name,"/")]=R["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Pt(-1/0,[[[]]])}),pr(za).fire(R),Is(R,!0)),n})}function Cs(n){function a(h){return n.next(h)}var o=c(a),u=c(function(h){return n.throw(h)});function c(h){return function(m){var m=h(m),I=m.value;return m.done?I:I&&typeof I.then=="function"?I.then(o,u):d(I)?Promise.all(I).then(o,u):o(I)}}return c(a)()}function Di(n,a,o){for(var u=d(n)?n.slice():[n],c=0;c<o;++c)u.push(a);return u}var Wc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(u){var o=n.table(u),u=o.schema,c={},h=[];function g(R,O,P){var D=Ka(R),A=c[D]=c[D]||[],N=R==null?0:typeof R=="string"?1:R.length,B=0<O,D=i(i({},P),{name:B?"".concat(D,"(virtual-from:").concat(P.name,")"):P.name,lowLevelIndex:P,isVirtual:B,keyTail:O,keyLength:N,extractKey:ms(R),unique:!B&&P.unique});return A.push(D),D.isPrimaryKey||h.push(D),1<N&&g(N===2?R[0]:R.slice(0,N-1),O+1,P),A.sort(function(H,te){return H.keyTail-te.keyTail}),D}var m=g(u.primaryKey.keyPath,0,u.primaryKey);c[":id"]=[m];for(var I=0,M=u.indexes;I<M.length;I++){var C=M[I];g(C.keyPath,0,C)}function x(R){var O,P=R.query.index;return P.isVirtual?i(i({},R),{query:{index:P.lowLevelIndex,range:(O=R.query.range,P=P.keyTail,{type:O.type===1?2:O.type,lower:Di(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,P),lowerOpen:!0,upper:Di(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,P),upperOpen:!0})}}):R}return i(i({},o),{schema:i(i({},u),{primaryKey:m,indexes:h,getIndexByKeyPath:function(R){return(R=c[Ka(R)])&&R[0]}}),count:function(R){return o.count(x(R))},query:function(R){return o.query(x(R))},openCursor:function(R){var O=R.query.index,P=O.keyTail,A=O.keyLength;return O.isVirtual?o.openCursor(x(R)).then(function(B){return B&&N(B)}):o.openCursor(R);function N(B){return Object.create(B,{continue:{value:function(D){D!=null?B.continue(Di(D,R.reverse?n.MAX_KEY:n.MIN_KEY,P)):R.unique?B.continue(B.key.slice(0,A).concat(R.reverse?n.MIN_KEY:n.MAX_KEY,P)):B.continue()}},continuePrimaryKey:{value:function(D,H){B.continuePrimaryKey(Di(D,n.MAX_KEY,P),H)}},primaryKey:{get:function(){return B.primaryKey}},key:{get:function(){var D=B.key;return A===1?D[0]:D.slice(0,A)}},value:{get:function(){return B.value}}})}}})}})}};function Ps(n,a,o,u){return o=o||{},u=u||"",f(n).forEach(function(c){var h,g,m;w(a,c)?(h=n[c],g=a[c],typeof h=="object"&&typeof g=="object"&&h&&g?(m=Z(h))!==Z(g)?o[u+c]=a[c]:m==="Object"?Ps(h,g,o,u+c+"."):h!==g&&(o[u+c]=a[c]):h!==g&&(o[u+c]=a[c])):o[u+c]=void 0}),f(a).forEach(function(c){w(n,c)||(o[u+c]=a[c])}),o}function Rs(n,a){return a.type==="delete"?a.keys:a.keys||a.values.map(n.extractKey)}var Yc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(a){var o=n.table(a),u=o.schema.primaryKey;return i(i({},o),{mutate:function(c){var h=Se.trans,g=h.table(a).hook,m=g.deleting,I=g.creating,M=g.updating;switch(c.type){case"add":if(I.fire===He)break;return h._promise("readwrite",function(){return C(c)},!0);case"put":if(I.fire===He&&M.fire===He)break;return h._promise("readwrite",function(){return C(c)},!0);case"delete":if(m.fire===He)break;return h._promise("readwrite",function(){return C(c)},!0);case"deleteRange":if(m.fire===He)break;return h._promise("readwrite",function(){return(function x(R,O,P){return o.query({trans:R,values:!1,query:{index:u,range:O},limit:P}).then(function(A){var N=A.result;return C({type:"delete",keys:N,trans:R}).then(function(B){return 0<B.numFailures?Promise.reject(B.failures[0]):N.length<P?{failures:[],numFailures:0,lastResult:void 0}:x(R,i(i({},O),{lower:N[N.length-1],lowerOpen:!0}),P)})})})(c.trans,c.range,1e4)},!0)}return o.mutate(c);function C(x){var R,O,P,A=Se.trans,N=x.keys||Rs(u,x);if(N)return(x=x.type==="add"||x.type==="put"?i(i({},x),{keys:N}):i({},x)).type!=="delete"&&(x.values=s([],x.values)),x.keys&&(x.keys=s([],x.keys)),R=o,P=N,((O=x).type==="add"?Promise.resolve([]):R.getMany({trans:O.trans,keys:P,cache:"immutable"})).then(function(B){var D=N.map(function(H,te){var de,he,ne,_e=B[te],be={onerror:null,onsuccess:null};return x.type==="delete"?m.fire.call(be,H,_e,A):x.type==="add"||_e===void 0?(de=I.fire.call(be,H,x.values[te],A),H==null&&de!=null&&(x.keys[te]=H=de,u.outbound||Q(x.values[te],u.keyPath,H))):(de=Ps(_e,x.values[te]),(he=M.fire.call(be,de,H,_e,A))&&(ne=x.values[te],Object.keys(he).forEach(function(se){w(ne,se)?ne[se]=he[se]:Q(ne,se,he[se])}))),be});return o.mutate(x).then(function(H){for(var te=H.failures,de=H.results,he=H.numFailures,H=H.lastResult,ne=0;ne<N.length;++ne){var _e=(de||N)[ne],be=D[ne];_e==null?be.onerror&&be.onerror(te[ne]):be.onsuccess&&be.onsuccess(x.type==="put"&&B[ne]?x.values[ne]:_e)}return{failures:te,results:de,numFailures:he,lastResult:H}}).catch(function(H){return D.forEach(function(te){return te.onerror&&te.onerror(H)}),Promise.reject(H)})});throw new Error("Keys missing")}}})}})}};function ll(n,a,o){try{if(!a||a.keys.length<n.length)return null;for(var u=[],c=0,h=0;c<a.keys.length&&h<n.length;++c)We(a.keys[c],n[h])===0&&(u.push(o?ae(a.values[c]):a.values[c]),++h);return u.length===n.length?u:null}catch{return null}}var Vc={stack:"dbcore",level:-1,create:function(n){return{table:function(a){var o=n.table(a);return i(i({},o),{getMany:function(u){var c;return u.cache?(c=ll(u.keys,u.trans._cache,u.cache==="clone"))?pe.resolve(c):o.getMany(u).then(function(h){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ae(h):h},h}):o.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function ul(n,a){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function cl(n,a){switch(n){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var $c={stack:"dbcore",level:0,name:"Observability",create:function(n){var a=n.schema.name,o=new Pt(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(u,c,h){if(Se.subscr&&c!=="readonly")throw new ye.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Se.querier));return n.transaction(u,c,h)},table:function(u){function c(N){var A,N=N.query;return[A=N.index,new Pt((A=(N=N.range).lower)!=null?A:n.MIN_KEY,(A=N.upper)!=null?A:n.MAX_KEY)]}var h=n.table(u),g=h.schema,m=g.primaryKey,I=g.indexes,M=m.extractKey,C=m.outbound,x=m.autoIncrement&&I.filter(function(P){return P.compound&&P.keyPath.includes(m.keyPath)}),R=i(i({},h),{mutate:function(P){function A(xe){return xe="idb://".concat(a,"/").concat(u,"/").concat(xe),te[xe]||(te[xe]=new Pt)}var N,B,D,H=P.trans,te=P.mutatedParts||(P.mutatedParts={}),de=A(""),he=A(":dels"),ne=P.type,be=P.type==="deleteRange"?[P.range]:P.type==="delete"?[P.keys]:P.values.length<50?[Rs(m,P).filter(function(xe){return xe}),P.values]:[],_e=be[0],be=be[1],se=P.trans._cache;return d(_e)?(de.addKeys(_e),(ne=ne==="delete"||_e.length===be.length?ll(_e,se):null)||he.addKeys(_e),(ne||be)&&(N=A,B=ne,D=be,g.indexes.forEach(function(xe){var Ye=N(xe.name||"");function Qe(Be){return Be!=null?xe.extractKey(Be):null}function Oe(Be){xe.multiEntry&&d(Be)?Be.forEach(function(ot){return Ye.addKey(ot)}):Ye.addKey(Be)}(B||D).forEach(function(Be,lt){var sn=B&&Qe(B[lt]),lt=D&&Qe(D[lt]);We(sn,lt)!==0&&(sn!=null&&Oe(sn),lt!=null)&&Oe(lt)})}))):_e?(be={from:(se=_e.lower)!=null?se:n.MIN_KEY,to:(ne=_e.upper)!=null?ne:n.MAX_KEY},he.add(be),de.add(be)):(de.add(o),he.add(o),g.indexes.forEach(function(xe){return A(xe.name).add(o)})),h.mutate(P).then(function(xe){return!_e||P.type!=="add"&&P.type!=="put"||(de.addKeys(xe.results),x&&x.forEach(function(Ye){for(var Qe=P.values.map(function(sn){return Ye.extractKey(sn)}),Oe=Ye.keyPath.findIndex(function(sn){return sn===m.keyPath}),Be=0,ot=xe.results.length;Be<ot;++Be)Qe[Be][Oe]=xe.results[Be];A(Ye.name).addKeys(Qe)})),H.mutatedParts=Ri(H.mutatedParts||{},te),xe})}}),O={get:function(P){return[m,new Pt(P.key)]},getMany:function(P){return[m,new Pt().addKeys(P.keys)]},count:c,query:c,openCursor:c};return f(O).forEach(function(P){R[P]=function(A){var N=Se.subscr,B=!!N,D=ul(Se,h)&&cl(P,A)?A.obsSet={}:N;if(B){var H,N=function(be){return be="idb://".concat(a,"/").concat(u,"/").concat(be),D[be]||(D[be]=new Pt)},te=N(""),de=N(":dels"),B=O[P](A),he=B[0],B=B[1];if((P==="query"&&he.isPrimaryKey&&!A.values?de:N(he.name||"")).add(B),!he.isPrimaryKey){if(P!=="count")return H=P==="query"&&C&&A.values&&h.query(i(i({},A),{values:!1})),h[P].apply(this,arguments).then(function(be){if(P==="query"){if(C&&A.values)return H.then(function(Qe){return Qe=Qe.result,te.addKeys(Qe),be});var se=A.values?be.result.map(M):be.result;(A.values?te:de).addKeys(se)}else{var xe,Ye;if(P==="openCursor")return Ye=A.values,(xe=be)&&Object.create(xe,{key:{get:function(){return de.addKey(xe.primaryKey),xe.key}},primaryKey:{get:function(){var Qe=xe.primaryKey;return de.addKey(Qe),Qe}},value:{get:function(){return Ye&&te.addKey(xe.primaryKey),xe.value}}})}return be});de.add(o)}}return h[P].apply(this,arguments)}}),R}})}};function fl(n,a,o){var u;return o.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,o.numFailures===u)?null:(u=i({},a),d(u.keys)&&(u.keys=u.keys.filter(function(c,h){return!(h in o.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(c,h){return!(h in o.failures)})),u)}function Os(n,a){return o=n,((u=a).lower===void 0||(u.lowerOpen?0<We(o,u.lower):0<=We(o,u.lower)))&&(o=n,(u=a).upper===void 0||(u.upperOpen?We(o,u.upper)<0:We(o,u.upper)<=0));var o,u}function dl(n,a,o,u,c,h){var g,m,I,M,C,x;return!o||o.length===0||(g=a.query.index,m=g.multiEntry,I=a.query.range,M=u.schema.primaryKey.extractKey,C=g.extractKey,x=(g.lowLevelIndex||g).extractKey,(u=o.reduce(function(R,O){var P=R,A=[];if(O.type==="add"||O.type==="put")for(var N=new Pt,B=O.values.length-1;0<=B;--B){var D,H=O.values[B],te=M(H);!N.hasKey(te)&&(D=C(H),m&&d(D)?D.some(function(be){return Os(be,I)}):Os(D,I))&&(N.addKey(te),A.push(H))}switch(O.type){case"add":var de=new Pt().addKeys(a.values?R.map(function(se){return M(se)}):R),P=R.concat(a.values?A.filter(function(se){return se=M(se),!de.hasKey(se)&&(de.addKey(se),!0)}):A.map(function(se){return M(se)}).filter(function(se){return!de.hasKey(se)&&(de.addKey(se),!0)}));break;case"put":var he=new Pt().addKeys(O.values.map(function(se){return M(se)}));P=R.filter(function(se){return!he.hasKey(a.values?M(se):se)}).concat(a.values?A:A.map(function(se){return M(se)}));break;case"delete":var ne=new Pt().addKeys(O.keys);P=R.filter(function(se){return!ne.hasKey(a.values?M(se):se)});break;case"deleteRange":var _e=O.range;P=R.filter(function(se){return!Os(M(se),_e)})}return P},n))===n)?n:(u.sort(function(R,O){return We(x(R),x(O))||We(M(R),M(O))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:n.length===a.limit&&u.length<a.limit&&(c.dirty=!0)),h?Object.freeze(u):u)}function hl(n,a){return We(n.lower,a.lower)===0&&We(n.upper,a.upper)===0&&!!n.lowerOpen==!!a.lowerOpen&&!!n.upperOpen==!!a.upperOpen}function Xc(n,a){return((o,u,c,h)=>{if(o===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((o=We(o,u))===0){if(c&&h)return 0;if(c)return 1;if(h)return-1}return o})(n.lower,a.lower,n.lowerOpen,a.lowerOpen)<=0&&0<=((o,u,c,h)=>{if(o===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((o=We(o,u))===0){if(c&&h)return 0;if(c)return-1;if(h)return 1}return o})(n.upper,a.upper,n.upperOpen,a.upperOpen)}function Qc(n,a,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){var c,h;n.subscribers.delete(o),n.subscribers.size===0&&(c=n,h=a,setTimeout(function(){c.subscribers.size===0&&F(h,c)},3e3))})}var Zc={stack:"dbcore",level:0,name:"Cache",create:function(n){var a=n.schema.name;return i(i({},n),{transaction:function(o,u,c){var h,g,m=n.transaction(o,u,c);return u==="readwrite"&&(c=(h=new AbortController).signal,m.addEventListener("abort",(g=function(I){return function(){if(h.abort(),u==="readwrite"){for(var M=new Set,C=0,x=o;C<x.length;C++){var R=x[C],O=Lr["idb://".concat(a,"/").concat(R)];if(O){var P=n.table(R),A=O.optimisticOps.filter(function(xe){return xe.trans===m});if(m._explicit&&I&&m.mutatedParts)for(var N=0,B=Object.values(O.queries.query);N<B.length;N++)for(var D=0,H=(he=B[N]).slice();D<H.length;D++)Ts((ne=H[D]).obsSet,m.mutatedParts)&&(F(he,ne),ne.subscribers.forEach(function(xe){return M.add(xe)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(xe){return xe.trans!==m});for(var te=0,de=Object.values(O.queries.query);te<de.length;te++)for(var he,ne,_e,be=0,se=(he=de[te]).slice();be<se.length;be++)(ne=se[be]).res!=null&&m.mutatedParts&&(I&&!ne.dirty?(_e=Object.isFrozen(ne.res),_e=dl(ne.res,ne.req,A,P,ne,_e),ne.dirty?(F(he,ne),ne.subscribers.forEach(function(xe){return M.add(xe)})):_e!==ne.res&&(ne.res=_e,ne.promise=pe.resolve({result:_e}))):(ne.dirty&&F(he,ne),ne.subscribers.forEach(function(xe){return M.add(xe)})))}}}M.forEach(function(xe){return xe()})}}})(!1),{signal:c}),m.addEventListener("error",g(!1),{signal:c}),m.addEventListener("complete",g(!0),{signal:c})),m},table:function(o){var u=n.table(o),c=u.schema.primaryKey;return i(i({},u),{mutate:function(h){var g,m=Se.trans;return!c.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Lr["idb://".concat(a,"/").concat(o)])?(m=u.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Rs(c,h).some(function(I){return I==null}))?(g.optimisticOps.push(h),h.mutatedParts&&Oi(h.mutatedParts),m.then(function(I){0<I.numFailures&&(F(g.optimisticOps,h),(I=fl(0,h,I))&&g.optimisticOps.push(I),h.mutatedParts)&&Oi(h.mutatedParts)}),m.catch(function(){F(g.optimisticOps,h),h.mutatedParts&&Oi(h.mutatedParts)})):m.then(function(I){var M=fl(0,i(i({},h),{values:h.values.map(function(C,x){var R;return I.failures[x]?C:(Q(R=(R=c.keyPath)!=null&&R.includes(".")?ae(C):i({},C),c.keyPath,I.results[x]),R)})}),I);g.optimisticOps.push(M),queueMicrotask(function(){return h.mutatedParts&&Oi(h.mutatedParts)})}),m):u.mutate(h)},query:function(h){var g,m,I,M,C,x,R;return ul(Se,u)&&cl("query",h)?(g=((I=Se.trans)==null?void 0:I.db._options.cache)==="immutable",m=(I=Se).requery,I=I.signal,x=((O,P,A,N)=>{var B=Lr["idb://".concat(O,"/").concat(P)];if(!B)return[];if(!(O=B.queries[A]))return[null,!1,B,null];var D=O[(N.query?N.query.index.name:null)||""];if(!D)return[null,!1,B,null];switch(A){case"query":var H=D.find(function(te){return te.req.limit===N.limit&&te.req.values===N.values&&hl(te.req.query.range,N.query.range)});return H?[H,!0,B,D]:[D.find(function(te){return("limit"in te.req?te.req.limit:1/0)>=N.limit&&(!N.values||te.req.values)&&Xc(te.req.query.range,N.query.range)}),!1,B,D];case"count":return H=D.find(function(te){return hl(te.req.query.range,N.query.range)}),[H,!!H,B,D]}})(a,o,"query",h),R=x[0],M=x[2],C=x[3],R&&x[1]?R.obsSet=h.obsSet:(x=u.query(h).then(function(O){var P=O.result;if(R&&(R.res=P),g){for(var A=0,N=P.length;A<N;++A)Object.freeze(P[A]);Object.freeze(P)}else O.result=ae(P);return O}).catch(function(O){return C&&R&&F(C,R),Promise.reject(O)}),R={obsSet:h.obsSet,promise:x,subscribers:new Set,type:"query",req:h,dirty:!1},C?C.push(R):(C=[R],(M=M||(Lr["idb://".concat(a,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=C)),Qc(R,C,m,I),R.promise.then(function(O){return{result:dl(O.result,h,M==null?void 0:M.optimisticOps,u,R,g)}})):u.query(h)}})}})}};function Mi(n,a){return new Proxy(n,{get:function(o,u,c){return u==="db"?a:Reflect.get(o,u,c)}})}ht.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ye.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ye.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var a=this._versions,o=a.filter(function(u){return u._cfg.version===n})[0];return o||(o=new this.Version(n),a.push(o),a.sort(Fc),o.stores({}),this._state.autoSchema=!1),o},ht.prototype._whenReady=function(n){var a=this;return this.idbdb&&(this._state.openComplete||Se.letThrough||this._vip)?n():new pe(function(o,u){if(a._state.openComplete)return u(new ye.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new ye.DatabaseClosed);a.open().catch(He)}a._state.dbReadyPromise.then(o,u)}).then(n)},ht.prototype.use=function(c){var a=c.stack,o=c.create,u=c.level,c=c.name,h=(c&&this.unuse({stack:a,name:c}),this._middlewares[a]||(this._middlewares[a]=[]));return h.push({stack:a,create:o,level:u??10,name:c}),h.sort(function(g,m){return g.level-m.level}),this},ht.prototype.unuse=function(n){var a=n.stack,o=n.name,u=n.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(c){return u?c.create!==u:!!o&&c.name!==o})),this},ht.prototype.open=function(){var n=this;return Ee(bt,function(){return Hc(n)})},ht.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,a=dt.indexOf(this);if(0<=a&&dt.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new pe(function(o){n.dbReadyResolve=o}),n.openCanceller=new pe(function(o,u){n.cancelOpen=u}))},ht.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,o=this._state;a?(o.isBeingOpened&&o.cancelOpen(new ye.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new ye.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},ht.prototype.delete=function(n){var a=this,o=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new pe(function(c,h){function g(){a.close(n);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=tt(function(){var I,M,C;I=a._deps,M=a.name,ks(C=I.indexedDB)||M===zt||ws(C,I.IDBKeyRange).delete(M).catch(He),c()}),m.onerror=Dn(h),m.onblocked=a._fireOnBlocked}if(o)throw new ye.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},ht.prototype.backendDB=function(){return this.idbdb},ht.prototype.isOpen=function(){return this.idbdb!==null},ht.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},ht.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ht.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ht.prototype,"tables",{get:function(){var n=this;return f(this._allTables).map(function(a){return n._allTables[a]})},enumerable:!1,configurable:!0}),ht.prototype.transaction=function(){var n=(function(a,o,u){var c=arguments.length;if(c<2)throw new ye.InvalidArgument("Too few arguments");for(var h=new Array(c-1);--c;)h[c-1]=arguments[c];return u=h.pop(),[a,De(h),u]}).apply(this,arguments);return this._transaction.apply(this,n)},ht.prototype._transaction=function(n,a,o){var u,c,h=this,g=Se.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(c=a.map(function(M){if(M=M instanceof h.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),n=="r"||n===On)u=On;else{if(n!="rw"&&n!=Dr)throw new ye.InvalidArgument("Invalid transaction mode: "+n);u=Dr}if(g){if(g.mode===On&&u===Dr){if(!m)throw new ye.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&c.forEach(function(M){if(g&&g.storeNames.indexOf(M)===-1){if(!m)throw new ye.SubTransaction("Table "+M+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(M){return g?g._promise(null,function(C,x){x(M)}):ce(M)}var I=(function M(C,x,R,O,P){return pe.resolve().then(function(){var D=Se.transless||Se,A=C._createTransaction(x,R,C._dbSchema,O),D=(A.explicit=!0,{trans:A,transless:D});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,C._state.PR1398_maxLoop=3}catch(H){return H.name===et.InvalidState&&C.isOpen()&&0<--C._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),C.close({disableAutoOpen:!1}),C.open().then(function(){return M(C,x,R,null,P)})):ce(H)}var N,B=ke(P),D=(B&&Ct(),pe.follow(function(){var H;(N=P.call(A,A))&&(B?(H=_n.bind(null,null),N.then(H,H)):typeof N.next=="function"&&typeof N.throw=="function"&&(N=Cs(N)))},D));return(N&&typeof N.then=="function"?pe.resolve(N).then(function(H){return A.active?H:ce(new ye.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):D.then(function(){return N})).then(function(H){return O&&A._resolve(),A._completion.then(function(){return H})}).catch(function(H){return A._reject(H),ce(H)})})}).bind(null,this,u,c,g,o);return g?g._promise(u,I,"lock"):Se.trans?Ee(Se.transless,function(){return h._whenReady(I)}):this._whenReady(I)},ht.prototype.table=function(n){if(w(this._allTables,n))return this._allTables[n];throw new ye.InvalidTable("Table ".concat(n," does not exist"))};var Wn=ht;function ht(n,a){var o,u,c,h,g,m=this,I=(this._middlewares={},this.verno=0,ht.dependencies),I=(this._options=a=i({addons:ht.addons,autoOpen:!0,indexedDB:I.indexedDB,IDBKeyRange:I.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),M=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:He,dbReadyPromise:null,cancelOpen:He,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),C=(M.dbReadyPromise=new pe(function(x){M.dbReadyResolve=x}),M.openCanceller=new pe(function(x,R){M.cancelOpen=R}),this._state=M,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[sr,He]}),this.once=function(x,R){var O=function(){for(var P=[],A=0;A<arguments.length;A++)P[A]=arguments[A];m.on(x).unsubscribe(O),R.apply(m,P)};return m.on(x,O)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(x){return function(R,O){ht.vip(function(){var P,A=m._state;A.openComplete?(A.dbOpenError||pe.resolve().then(R),O&&x(R)):A.onReadyBeingFired?(A.onReadyBeingFired.push(R),O&&x(R)):(x(R),P=m,O||x(function N(){P.on.ready.unsubscribe(R),P.on.ready.unsubscribe(N)}))})}}),this.Collection=(o=this,ja(Mc.prototype,function(N,A){this.db=o;var O=La,P=null;if(A)try{O=A()}catch(D){P=D}var A=N._ctx,N=A.table,B=N.hook.reading.fire;this._ctx={table:N,index:A.index,isPrimKey:!A.index||N.schema.primKey.keyPath&&A.index===N.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:A.or,valueMapper:B!==nn?B:null}})),this.Table=(u=this,ja(Vo.prototype,function(x,R,O){this.db=u,this._tx=O,this.name=x,this.schema=R,this.hook=u._allTables[x]?u._allTables[x].hook:qa(null,{creating:[Pa,He],reading:[ia,nn],updating:[ir,He],deleting:[Ra,He]})})),this.Transaction=(c=this,ja(qc.prototype,function(x,R,O,P,A){var N=this;x!=="readonly"&&R.forEach(function(B){B=(B=O[B])==null?void 0:B.yProps,B&&(R=R.concat(B.map(function(D){return D.updatesTable})))}),this.db=c,this.mode=x,this.storeNames=R,this.schema=O,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new pe(function(B,D){N._resolve=B,N._reject=D}),this._completion.then(function(){N.active=!1,N.on.complete.fire()},function(B){var D=N.active;return N.active=!1,N.on.error.fire(B),N.parent?N.parent._reject(B):D&&N.idbtrans&&N.idbtrans.abort(),ce(B)})})),this.Version=(h=this,ja(Gc.prototype,function(x){this.db=h,this._cfg={version:x,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,ja(Jo.prototype,function(x,R,O){if(this.db=g,this._ctx={table:x,index:R===":id"?null:R,or:O},this._cmp=this._ascending=We,this._descending=function(P,A){return We(A,P)},this._max=function(P,A){return 0<We(P,A)?P:A},this._min=function(P,A){return We(P,A)<0?P:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ye.MissingAPI})),this.on("versionchange",function(x){0<x.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(x){!x.newVersion||x.newVersion<x.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(x.oldVersion/10))}),this._maxKey=Fa(a.IDBKeyRange),this._createTransaction=function(x,R,O,P){return new m.Transaction(x,R,O,m._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(x){m.on("blocked").fire(x),dt.filter(function(R){return R.name===m.name&&R!==m&&!R._state.vcFired}).map(function(R){return R.on("versionchange").fire(x)})},this.use(Vc),this.use(Zc),this.use($c),this.use(Wc),this.use(Yc),new Proxy(this,{get:function(x,R,O){var P;return R==="_vip"||(R==="table"?function(A){return Mi(m.table(A),C)}:(P=Reflect.get(x,R,O))instanceof Vo?Mi(P,C):R==="tables"?P.map(function(A){return Mi(A,C)}):R==="_createTransaction"?function(){return Mi(P.apply(this,arguments),C)}:P)}}));this.vip=C,I.forEach(function(x){return x(m)})}var Li,ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Jc=(Ds.prototype.subscribe=function(n,a,o){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:a,complete:o})},Ds.prototype[ha]=function(){return this},Ds);function Ds(n){this._subscribe=n}try{Li={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Li={indexedDB:null,IDBKeyRange:null}}function pl(n){var a,o=!1,u=new Jc(function(c){var h=ke(n),g,m=!1,I={},M={},C={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),x&&pr.storagemutated.unsubscribe(O))}},x=(c.start&&c.start(C),!1),R=function(){return re(P)},O=function(A){Ri(I,A),Ts(M,I)&&R()},P=function(){var A,N,B;!m&&Li.indexedDB&&(I={},A={},g&&g.abort(),g=new AbortController,B=(D=>{var H=dr();try{h&&Ct();var te=bn(n,D);return te=h?te.finally(_n):te}finally{H&&Hn()}})(N={subscr:A,signal:g.signal,requery:R,querier:n,trans:null}),Promise.resolve(B).then(function(D){o=!0,a=D,m||N.signal.aborted||(I={},(H=>{for(var te in H)if(w(H,te))return;return 1})(M=A)||x||(pr(za,O),x=!0),re(function(){return!m&&c.next&&c.next(D)}))},function(D){o=!1,["DatabaseClosedError","AbortError"].includes(D==null?void 0:D.name)||m||re(function(){m||c.error&&c.error(D)})}))};return setTimeout(R,0),C});return u.hasValue=function(){return o},u.getValue=function(){return a},u}var Nr=Wn;function Ms(n){var a=vr;try{vr=!0,pr.storagemutated.fire(n),Is(n,!0)}finally{vr=a}}b(Nr,i(i({},Le),{delete:function(n){return new Nr(n,{addons:[]}).delete()},exists:function(n){return new Nr(n,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return a=Nr.dependencies,o=a.indexedDB,a=a.IDBKeyRange,(ks(o)?Promise.resolve(o.databases()).then(function(u){return u.map(function(c){return c.name}).filter(function(c){return c!==zt})}):ws(o,a).toCollection().primaryKeys()).then(n)}catch{return ce(new ye.MissingAPI)}var a,o},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Se.trans?Ee(Se.transless,n):n()},vip:xs,async:function(n){return function(){try{var a=Cs(n.apply(this,arguments));return a&&typeof a.then=="function"?a:pe.resolve(a)}catch(o){return ce(o)}}},spawn:function(n,a,o){try{var u=Cs(n.apply(o,a||[]));return u&&typeof u.then=="function"?u:pe.resolve(u)}catch(c){return ce(c)}},currentTransaction:{get:function(){return Se.trans||null}},waitFor:function(n,a){return n=pe.resolve(typeof n=="function"?Nr.ignoreTransaction(n):n).timeout(a||6e4),Se.trans?Se.trans.waitFor(n):n},Promise:pe,debug:{get:function(){return Vt},set:function(n){Oa(n)}},derive:q,extend:v,props:b,override:J,Events:qa,on:pr,liveQuery:pl,extendObservabilitySet:Ri,getByKeyPath:ue,setByKeyPath:Q,delByKeyPath:function(n,a){typeof a=="string"?Q(n,a,void 0):"length"in a&&[].map.call(a,function(o){Q(n,o,void 0)})},shallowClone:me,deepClone:ae,getObjectDiff:Ps,cmp:We,asap:$,minKey:-1/0,addons:[],connections:dt,errnames:et,dependencies:Li,cache:Lr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,a,o){return n+a/Math.pow(10,2*o)})})),Nr.maxKey=Fa(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pr(za,function(n){vr||(n=new CustomEvent(ps,{detail:n}),vr=!0,dispatchEvent(n),vr=!1)}),addEventListener(ps,function(n){n=n.detail,vr||Ms(n)}));var pa,vr=!1,vl=function(){};return typeof BroadcastChannel<"u"&&((vl=function(){(pa=new BroadcastChannel(ps)).onmessage=function(n){return n.data&&Ms(n.data)}})(),typeof pa.unref=="function"&&pa.unref(),pr(za,function(n){vr||pa.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Wn.disableBfCache&&n.persisted){Vt&&console.debug("Dexie: handling persisted pagehide"),pa!=null&&pa.close();for(var a=0,o=dt;a<o.length;a++)o[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Wn.disableBfCache&&n.persisted&&(Vt&&console.debug("Dexie: handling persisted pageshow"),vl(),Ms({all:new Pt(-1/0,[[]])}))})),pe.rejectionMapper=function(n,a){return!n||n instanceof Ne||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Mt[n.name]?n:(a=new Mt[n.name](a||n.message,n),"stack"in n&&L(a,"stack",{get:function(){return this.inner.stack}}),a)},Oa(Vt),i(Wn,Object.freeze({__proto__:null,Dexie:Wn,Entity:Uo,PropModification:Na,RangeSet:Pt,add:function(n){return new Na({add:n})},cmp:We,default:Wn,liveQuery:pl,mergeRanges:Ga,rangesOverlap:al,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,a){return new Na({replacePrefix:[n,a]})}}),{default:Wn}),Wn})})(Vi)),Vi.exports}var Bd=jd();const so=Nd(Bd),Ml=Symbol.for("Dexie"),Ht=globalThis[Ml]||(globalThis[Ml]=so);if(so.semVer!==Ht.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${so.semVer} and ${Ht.semVer}`);const{liveQuery:_m,mergeRanges:wm,rangesOverlap:km,RangeSet:xm,cmp:Sm,Entity:Tm,PropModification:Em,replacePrefix:Am,add:Im,remove:Cm,DexieYProvider:Pm}=Ht,Me=new Ht("me-ai-store");Me.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Me.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});function ac(t,e){return`${t}:${e}`}async function zd(){const t=await Me.items.where("sourceType").equals("gmail").count(),e=await Me.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],i=await Me.items.where("[sourceType+date]").between(["gmail",Ht.minKey],["gmail",Ht.maxKey]).first(),s=await Me.items.where("[sourceType+date]").between(["gmail",Ht.minKey],["gmail",Ht.maxKey]).last();if(i&&s){const f=new Date(i.date).toLocaleDateString(),d=new Date(s.date).toLocaleDateString();r.push(`Date range: ${f} to ${d}.`)}const l=await ic(5);return l.length>0&&r.push("Top senders: "+l.map(([f,d])=>`${Vd(f)} (${d})`).join(", ")+"."),r.join(" ")}async function Fd(){const t=await Me.items.where("sourceType").equals("gmail").count(),e=await Me.contacts.count();if(t===0)return"No emails stored locally.";const r=await ic(10),i=await Wd(10),s=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],l=await Me.items.where("sourceType").equals("gmail").sortBy("date");if(l.length>0){const f=new Date(l[0].date).toLocaleDateString(),d=new Date(l[l.length-1].date).toLocaleDateString();s.push(`- **Date range:** ${f} â ${d}`)}if(r.length>0){s.push("","### Top Senders");for(const[f,d]of r)s.push(`- ${f}: ${d}`)}if(i.length>0){s.push("","### Labels");for(const[f,d]of i)s.push(`- ${f}: ${d}`)}return s.join(`
`)}async function Kd(t=10){const e=await Me.items.where("[sourceType+date]").between(["gmail",Ht.minKey],["gmail",Ht.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(sc).join(`

---

`)}async function Ud(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),s=(await Me.items.toArray()).map(l=>{var d,v,p,y,w;let f=0;return(d=l.subject)!=null&&d.toLowerCase().includes(r)&&(f+=3),(v=l.from)!=null&&v.toLowerCase().includes(r)&&(f+=2),(p=l.to)!=null&&p.toLowerCase().includes(r)&&(f+=2),(y=l.snippet)!=null&&y.toLowerCase().includes(r)&&(f+=1),(w=l.body)!=null&&w.toLowerCase().includes(r)&&(f+=1),{item:l,score:f}}).filter(({score:l})=>l>0).sort((l,f)=>f.score-l.score).slice(0,e);return s.length===0?`No results found for "${t}".`:s.map(({item:l})=>sc(l)).join(`

---

`)}async function Gd(){const t=await zd();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Hd(t){const e=[],r=await Fd();if(e.push(r),t){const i=await Ud(t,5);e.push("","## Relevant Emails",i)}else{const i=await Kd(5);e.push("","## Recent Emails",i)}return e.join(`
`)}async function ic(t){const e=await Me.items.where("sourceType").equals("gmail").toArray(),r={};for(const i of e){const s=i.from||"Unknown";r[s]=(r[s]||0)+1}return Object.entries(r).sort((i,s)=>s[1]-i[1]).slice(0,t)}async function Wd(t){const e=await Me.items.where("sourceType").equals("gmail").toArray(),r={};for(const i of e)for(const s of i.labels||[])r[s]=(r[s]||0)+1;return Object.entries(r).sort((i,s)=>s[1]-i[1]).slice(0,t)}function sc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Yd(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}function Yd(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function Vd(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}async function $d({query:t,limit:e=50,offset:r=0}={}){if(t){const l=t.toLowerCase(),f=await Me.items.where("sourceType").equals("gmail").filter(d=>{var v,p,y,w;return((v=d.subject)==null?void 0:v.toLowerCase().includes(l))||((p=d.from)==null?void 0:p.toLowerCase().includes(l))||((y=d.to)==null?void 0:y.toLowerCase().includes(l))||((w=d.snippet)==null?void 0:w.toLowerCase().includes(l))}).toArray();return f.sort((d,v)=>(v.date||0)-(d.date||0)),{items:f.slice(r,r+e),total:f.length}}const i=await Me.items.where("sourceType").equals("gmail").count();return{items:await Me.items.where("[sourceType+date]").between(["gmail",Ht.minKey],["gmail",Ht.maxKey]).reverse().offset(r).limit(e).toArray(),total:i}}function oo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,i)).toFixed(1)+" "+r[i]}function Ks(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e)),s=t/Math.pow(e,i),l=i>=2?2:i>=1?1:0;return s.toFixed(l)+" "+r[i]}function Xd(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}const Qd=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Ll(...t){Qd&&console.log("[debug]",...t)}function tn(t){return Ll(`[MOUNT] ${t}`),()=>Ll(`[DESTROY] ${t}`)}var Zd=V("<option> </option>"),Jd=V('<p class="model-description svelte-1p89qnn"> </p>'),eh=V('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),th=V('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),nh=V('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),rh=V('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),ah=V('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),ih=V('<p class="error svelte-1p89qnn"> </p>'),sh=V('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function oh(t,e){ut(e,!0);let r=Pe(e,"selectedModel",15),i=Pe(e,"gpuInfo",3,null),s=Pe(e,"error",3,null);It(()=>tn("ModelSelector"));var l=sh(),f=j(T(l),2),d=j(T(f),2);ar(d,21,()=>oi,Tr,(q,E)=>{var z=Zd(),ee=T(z),J={};ge(()=>{oe(ee,`${k(E).name??""} â ${k(E).size??""}`),J!==(J=k(E).id)&&(z.value=(z.__value=k(E).id)??"")}),Y(q,z)});var v=j(d,2);{var p=q=>{const E=hn(()=>oi.find(K=>K.id===r()));var z=Ju(),ee=Dt(z);{var J=K=>{var $=Jd(),ue=T($);ge(()=>oe(ue,k(E).description)),Y(K,$)};Te(ee,K=>{k(E)&&K(J)})}Y(q,z)};Te(v,q=>{r()&&q(p)})}var y=j(f,2);{var w=q=>{var E=ah(),z=j(T(E),2),ee=T(z),J=j(T(ee)),K=T(J),$=j(ee,2),ue=j(T($)),Q=T(ue),me=j($,2);{var Re=ie=>{var we=eh(),F=j(T(we)),W=T(F);ge(()=>oe(W,i().device)),Y(ie,we)};Te(me,ie=>{i().device&&i().device!=="unknown"&&ie(Re)})}var De=j(me,2);{var fe=ie=>{var we=th(),F=j(T(we)),W=T(F);ge(()=>oe(W,i().description)),Y(ie,we)};Te(De,ie=>{i().description&&i().description!=="unknown"&&ie(fe)})}var X=j(De,2);{var ae=ie=>{var we=nh(),F=j(T(we)),W=T(F);ge(ve=>oe(W,ve),[()=>oo(i().limits.maxBufferSize)]),Y(ie,we)};Te(X,ie=>{var we;(we=i().limits)!=null&&we.maxBufferSize&&ie(ae)})}var le=j(X,2);{var Z=ie=>{var we=rh(),F=j(T(we)),W=T(F);ge(()=>oe(W,`${i().features.length??""} supported`)),Y(ie,we)};Te(le,ie=>{var we;(we=i().features)!=null&&we.length&&ie(Z)})}ge(()=>{oe(K,i().vendor),oe(Q,i().architecture)}),Y(q,E)};Te(y,q=>{i()&&q(w)})}var b=j(y,2);{var _=q=>{var E=ih(),z=T(E);ge(()=>oe(z,s())),Y(q,E)};Te(b,q=>{s()&&q(_)})}var L=j(b,2);L.__click=function(...q){var E;(E=e.onload)==null||E.apply(this,q)},ge(()=>L.disabled=s()),Po(d,r),Y(t,l),ct()}Yt(["click"]);var lh=V('<span class="progress-percent svelte-r5fnze"> </span>'),uh=V('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),ch=V('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),fh=V('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),dh=V('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),hh=V('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),ph=V('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function vh(t,e){ut(e,!0);let r=Pe(e,"message",3,""),i=Pe(e,"items",19,()=>[]);It(()=>tn("LoadingProgress"));var s=ph(),l=T(s),f=T(l),d=j(l,2);ar(d,17,i,Tr,(v,p)=>{const y=hn(()=>k(p).total?Xd(k(p).loaded||0,k(p).total):null);var w=hh(),b=T(w),_=T(b),L=T(_),q=j(_,2);{var E=K=>{var $=lh(),ue=T($);ge(Q=>oe(ue,`${Q??""}%`),[()=>k(y).toFixed(1)]),Y(K,$)};Te(q,K=>{k(y)!==null&&K(E)})}var z=j(b,2);{var ee=K=>{var $=uh(),ue=Dt($),Q=T(ue),me=j(ue,2),Re=T(me),De=T(Re),fe=j(Re,4),X=T(fe),ae=j(fe,2),le=T(ae);ge((Z,ie,we,F,W)=>{tr(Q,`width: ${Z??""}%`),oe(De,ie),oe(X,we),oe(le,`(${F??""} / ${W??""} B)`)},[()=>Math.max(k(p).progress??0,.5).toFixed(1),()=>Ks(k(p).loaded||0),()=>Ks(k(p).total),()=>(k(p).loaded||0).toLocaleString(),()=>k(p).total.toLocaleString()]),Y(K,$)},J=K=>{var $=dh(),ue=j(Dt($),2),Q=T(ue);{var me=De=>{var fe=ch(),X=Dt(fe),ae=T(X),le=j(X,2),Z=T(le);ge((ie,we)=>{oe(ae,ie),oe(Z,`(${we??""} B)`)},[()=>Ks(k(p).loaded),()=>k(p).loaded.toLocaleString()]),Y(De,fe)},Re=De=>{var fe=fh();Y(De,fe)};Te(Q,De=>{k(p).loaded?De(me):De(Re,!1)})}Y(K,$)};Te(z,K=>{k(p).total?K(ee):K(J,!1)})}ge(()=>{tc(_,"title",k(p).file),oe(L,k(p).file)}),Y(v,w)}),ge(()=>oe(f,r())),Y(t,s),ct()}var gh=V('<span class="thinking-tokens svelte-11gjw00"> </span>'),mh=V('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),yh=V('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),bh=V('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),_h=V('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),wh=V('<span class="cursor svelte-11gjw00">|</span>'),kh=V(" <!>",1),xh=V('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Sh=V('<div class="content svelte-11gjw00"> </div>'),Th=V('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Eh(t,e){ut(e,!0);let r=Pe(e,"isLast",3,!1),i=Pe(e,"isRunning",3,!1),s=Pe(e,"generationPhase",3,null),l=Pe(e,"numTokens",3,null);It(()=>tn(`MessageBubble[${e.msg.role}]`));var f=Th(),d=T(f),v=T(d),p=j(d,2);{var y=b=>{var _=xh(),L=Dt(_);{var q=Q=>{var me=mh(),Re=j(T(me),4);{var De=fe=>{var X=gh(),ae=T(X);ge(()=>oe(ae,`${l()??""} tokens`)),Y(fe,X)};Te(Re,fe=>{l()&&fe(De)})}Y(Q,me)},E=Q=>{var me=yh();Y(Q,me)};Te(L,Q=>{i()&&r()&&s()==="thinking"?Q(q):i()&&r()&&s()==="preparing"&&Q(E,1)})}var z=j(L,2);{var ee=Q=>{var me=bh(),Re=T(me),De=j(T(Re),2),fe=T(De),X=j(Re,2),ae=T(X);ge(le=>{oe(fe,`${le??""} words`),oe(ae,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),Y(Q,me)};Te(z,Q=>{e.msg.thinking&&Q(ee)})}var J=j(z,2),K=T(J);{var $=Q=>{var me=_h();Y(Q,me)},ue=Q=>{var me=kh(),Re=Dt(me,!0),De=j(Re);{var fe=X=>{var ae=wh();Y(X,ae)};Te(De,X=>{i()&&r()&&X(fe)})}ge(()=>oe(Re,e.msg.content)),Y(Q,me)};Te(K,Q=>{i()&&r()&&!e.msg.content&&s()!=="thinking"?Q($):Q(ue,!1)})}Y(b,_)},w=b=>{var _=Sh(),L=T(_);ge(()=>oe(L,e.msg.content)),Y(b,_)};Te(p,b=>{e.msg.role==="assistant"?b(y):b(w,!1)})}ge(()=>{fn(f,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),oe(v,e.msg.role==="user"?"You":"AI")}),Y(t,f),ct()}var Ah=V('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Ih=V('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Ch=V('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Ph=V('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Rh=V('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Oh=V('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Dh=V('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Mh(t,e){ut(e,!0),It(()=>tn("GpuPanel"));var r=Dh(),i=T(r),s=j(T(i),2),l=j(T(s),2),f=T(l),d=j(s,2),v=j(T(d),2),p=T(v),y=j(d,2);{var w=K=>{var $=Ah(),ue=j(T($),2),Q=T(ue);ge(()=>oe(Q,e.gpuInfo.device)),Y(K,$)};Te(y,K=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&K(w)})}var b=j(y,2);{var _=K=>{var $=Ih(),ue=j(T($),2),Q=T(ue);ge(me=>oe(Q,me),[()=>oo(e.gpuInfo.limits.maxBufferSize)]),Y(K,$)};Te(b,K=>{var $;($=e.gpuInfo.limits)!=null&&$.maxBufferSize&&K(_)})}var L=j(b,2);{var q=K=>{var $=Ch(),ue=j(T($),2),Q=T(ue);ge(()=>oe(Q,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),Y(K,$)};Te(L,K=>{var $;($=e.gpuInfo.limits)!=null&&$.maxComputeInvocationsPerWorkgroup&&K(q)})}var E=j(L,2);{var z=K=>{var $=Ph(),ue=j(T($),2),Q=T(ue);ge(me=>oe(Q,me),[()=>oo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),Y(K,$)};Te(E,K=>{var $;($=e.gpuInfo.limits)!=null&&$.maxComputeWorkgroupStorageSize&&K(z)})}var ee=j(E,2);{var J=K=>{var $=Oh(),ue=T($),Q=T(ue),me=j(ue,2);ar(me,21,()=>e.gpuInfo.features,Tr,(Re,De)=>{var fe=Rh(),X=T(fe);ge(()=>oe(X,k(De))),Y(Re,fe)}),ge(()=>oe(Q,`Features (${e.gpuInfo.features.length??""})`)),Y(K,$)};Te(ee,K=>{var $;($=e.gpuInfo.features)!=null&&$.length&&K(J)})}ge(()=>{oe(f,e.gpuInfo.vendor),oe(p,e.gpuInfo.architecture)}),Y(t,r),ct()}var Lh=V('<button class="gpu-badge svelte-1ktw27c"> </button>'),Nh=V('<span class="stats svelte-1ktw27c"> </span>'),qh=V('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),jh=V('<span class="stats preparing svelte-1ktw27c"> </span>'),Bh=V('<span class="stats svelte-1ktw27c"> </span>'),zh=V('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Fh=V('<button class="btn svelte-1ktw27c">Stop</button>'),Kh=V('<button class="btn primary svelte-1ktw27c">Send</button>'),Uh=V('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Gh(t,e){ut(e,!0),It(()=>tn("ChatView"));let r=Pe(e,"messages",19,()=>[]),i=Pe(e,"isRunning",3,!1),s=Pe(e,"tps",3,null),l=Pe(e,"numTokens",3,null),f=Pe(e,"generationPhase",3,null),d=Pe(e,"gpuInfo",3,null),v=Pe(e,"chatContainer",15),p=Ce(""),y=Ce(!1);function w(F){F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),b())}function b(){const F=k(p).trim();!F||i()||(U(p,""),e.onsend(F))}var _=Uh(),L=T(_),q=T(L);{var E=F=>{var W=Lh();W.__click=()=>U(y,!k(y));var ve=T(W);ge(()=>oe(ve,`WebGPU ${k(y)?"â²":"â¼"}`)),Y(F,W)};Te(q,F=>{d()&&F(E)})}var z=j(q,2);{var ee=F=>{var W=Nh(),ve=T(W);ge((ke,Le)=>oe(ve,`${l()??""} tokens in ${ke??""}s
        (${Le??""} tok/s)`),[()=>(l()/s()).toFixed(1),()=>s().toFixed(1)]),Y(F,W)},J=F=>{var W=qh();Y(F,W)},K=F=>{var W=jh(),ve=T(W);ge(ke=>oe(ve,`thinking... ${ke??""}`),[()=>s()?`${s().toFixed(0)} tok/s`:""]),Y(F,W)},$=F=>{var W=Bh(),ve=T(W);ge(ke=>oe(ve,`${ke??""} tok/s`),[()=>s().toFixed(1)]),Y(F,W)};Te(z,F=>{s()&&!i()?F(ee):i()&&f()==="preparing"?F(J,1):i()&&f()==="thinking"?F(K,2):s()&&i()&&F($,3)})}var ue=j(z,4);ue.__click=function(...F){var W;(W=e.onreset)==null||W.apply(this,F)};var Q=j(L,2);{var me=F=>{Mh(F,{get gpuInfo(){return d()}})};Te(Q,F=>{k(y)&&d()&&F(me)})}var Re=j(Q,2),De=T(Re);{var fe=F=>{var W=zh();Y(F,W)};Te(De,F=>{r().length===0&&F(fe)})}var X=j(De,2);ar(X,17,r,Tr,(F,W,ve)=>{{let ke=hn(()=>ve===r().length-1);Eh(F,{get msg(){return k(W)},get isLast(){return k(ke)},get isRunning(){return i()},get generationPhase(){return f()},get numTokens(){return l()}})}}),nc(Re,F=>v(F),()=>v());var ae=j(Re,2),le=T(ae);le.__keydown=w;var Z=j(le,2);{var ie=F=>{var W=Fh();W.__click=function(...ve){var ke;(ke=e.onstop)==null||ke.apply(this,ve)},Y(F,W)},we=F=>{var W=Kh();W.__click=b,ge(ve=>W.disabled=ve,[()=>!k(p).trim()]),Y(F,W)};Te(Z,F=>{i()?F(ie):F(we,!1)})}ge(()=>{ue.disabled=i(),le.disabled=i()}),Ro(le,()=>k(p),F=>U(p,F)),Y(t,_),ct()}Yt(["click","keydown"]);var Hh=V('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Wh(t,e){ut(e,!0);const r=!!navigator.gpu,i=rc();let s=Ce(Ot(localStorage.getItem("selectedModel")||oi[0].id)),l=Ce(null),f=Ce(null),d=Ce(""),v=Ce(Ot([])),p=Ce(Ot([])),y=Ce(!1),w=Ce(null),b=Ce(null),_=Ce(null),L=Ce(null),q=Ce(null);It(()=>{i.check();const fe=i.onMessage(X=>{switch(X.status){case"webgpu-info":U(L,X.data,!0);break;case"loading":U(l,"loading"),U(d,X.data,!0);break;case"initiate":U(v,[...k(v),X],!0);break;case"progress":U(v,k(v).map(ae=>ae.file===X.file?{...ae,...X}:ae),!0);break;case"done":U(v,k(v).filter(ae=>ae.file!==X.file),!0);break;case"ready":U(l,"ready");break;case"start":if(!k(y))break;U(q,X.phase||"preparing",!0),U(p,[...k(p),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!k(y))break;U(q,X.phase,!0);break;case"thinking":{if(!k(y))break;U(w,X.tps,!0),U(b,X.numTokens,!0);const ae=k(p)[k(p).length-1];U(p,[...k(p).slice(0,-1),{...ae,thinking:(ae.thinking||"")+X.content}],!0),E();break}case"thinking-done":{if(!k(y))break;U(w,X.tps,!0),U(b,X.numTokens,!0);const ae=k(p)[k(p).length-1];U(p,[...k(p).slice(0,-1),{...ae,thinking:X.content}],!0);break}case"update":{if(!k(y))break;U(w,X.tps,!0),U(b,X.numTokens,!0);const ae=k(p)[k(p).length-1];U(p,[...k(p).slice(0,-1),{...ae,content:ae.content+X.output}],!0),E();break}case"complete":if(!k(y))break;U(y,!1),U(q,null);break;case"error":if(!k(y))break;U(f,X.data,!0),U(y,!1),U(q,null);break}});return()=>fe()});function E(){$u().then(()=>{k(_)&&(k(_).scrollTop=k(_).scrollHeight)})}function z(){U(l,"loading"),localStorage.setItem("selectedModel",k(s)),i.loadModel(k(s))}async function ee(fe){if(!fe||k(y))return;U(p,[...k(p),{role:"user",content:fe}],!0),U(w,null),U(y,!0);let X=[];try{const le=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail)\b/i;let Z;le.test(fe)?Z=await Hd(fe):Z=await Gd(),Z&&(X=[{role:"system",content:Z}])}catch{}const ae=k(p).map(le=>({role:le.role,content:le.content}));i.generate([...X,...ae]),E()}function J(){i.interrupt()}function K(){i.reset(),U(p,[],!0),U(w,null),U(b,null)}var $=Ju(),ue=Dt($);{var Q=fe=>{var X=Hh();Y(fe,X)},me=fe=>{oh(fe,{get gpuInfo(){return k(L)},get error(){return k(f)},onload:z,get selectedModel(){return k(s)},set selectedModel(X){U(s,X,!0)}})},Re=fe=>{vh(fe,{get message(){return k(d)},get items(){return k(v)}})},De=fe=>{Gh(fe,{get messages(){return k(p)},get isRunning(){return k(y)},get tps(){return k(w)},get numTokens(){return k(b)},get generationPhase(){return k(q)},get gpuInfo(){return k(L)},onsend:ee,onstop:J,onreset:K,get chatContainer(){return k(_)},set chatContainer(X){U(_,X,!0)}})};Te(ue,fe=>{r?k(l)===null?fe(me,1):k(l)==="loading"?fe(Re,2):fe(De,!1):fe(Q)})}Y(t,$),ct()}const Nl="https://accounts.google.com/gsi/client",Yh="https://www.googleapis.com/auth/gmail.readonly";let lo=null,$i=null;function Vh(){return new Promise((t,e)=>{var s,l;if((l=(s=window.google)==null?void 0:s.accounts)!=null&&l.oauth2){t();return}const r=document.querySelector(`script[src="${Nl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const i=document.createElement("script");i.src=Nl,i.async=!0,i.defer=!0,i.onload=()=>t(),i.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(i)})}async function ql(t){await Vh(),lo=google.accounts.oauth2.initTokenClient({client_id:t,scope:Yh,callback:e=>{$i&&($i(e),$i=null)}})}function $h(){return new Promise((t,e)=>{if(!lo){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}$i=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},lo.requestAccessToken()})}function Xh(t){return new Promise(e=>{var r,i;(i=(r=window.google)==null?void 0:r.accounts)!=null&&i.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Qh="https://gmail.googleapis.com/gmail/v1/users/me";function Zh(t){return{Authorization:`Bearer ${t}`}}async function us(t,e){var i;const r=await fetch(`${Qh}${e}`,{headers:Zh(t)});if(!r.ok){const s=await r.json().catch(()=>({}));throw new Error(((i=s.error)==null?void 0:i.message)||`Gmail API error: ${r.status}`)}return r.json()}function oc(t){return us(t,"/profile")}function lc(t,{maxResults:e=20,pageToken:r,q:i}={}){const s=new URLSearchParams;return s.set("maxResults",String(e)),r&&s.set("pageToken",r),i&&s.set("q",i),us(t,`/messages?${s}`)}function uc(t,e,r="full"){return us(t,`/messages/${e}?format=${r}`)}function Jh(t,{startHistoryId:e,pageToken:r,maxResults:i=500}={}){const s=new URLSearchParams;return s.set("startHistoryId",e),s.set("maxResults",String(i)),s.append("historyTypes","messageAdded"),s.append("historyTypes","messageDeleted"),r&&s.set("pageToken",r),us(t,`/history?${s}`)}function mr(t,e){var l;const r=((l=t==null?void 0:t.payload)==null?void 0:l.headers)||[],i=e.toLowerCase(),s=r.find(f=>f.name.toLowerCase()===i);return(s==null?void 0:s.value)||""}function ai(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const i=atob(e),s=Uint8Array.from(i,l=>l.charCodeAt(0));return new TextDecoder().decode(s)}function ep(t){var l,f,d;const e=t==null?void 0:t.payload;if(!e)return"";if((l=e.body)!=null&&l.data)return ai(e.body.data);const r=e.parts||[],i=Ji(r,"text/plain");if((f=i==null?void 0:i.body)!=null&&f.data)return ai(i.body.data);const s=Ji(r,"text/html");if((d=s==null?void 0:s.body)!=null&&d.data){const v=ai(s.body.data);return np(v)}return"(no body)"}function tp(t){var s,l;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((s=e.body)!=null&&s.data))return ai(e.body.data);const r=e.parts||[],i=Ji(r,"text/html");return(l=i==null?void 0:i.body)!=null&&l.data?ai(i.body.data):null}function Ji(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const i=Ji(r.parts,e);if(i)return i}}return null}function np(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}const Tt="gmail",jl=8,cc=50,fc=100;async function rp(t,{limit:e=cc,onProgress:r=()=>{},signal:i}={}){var f,d,v,p;const s=await Me.syncState.get(Tt);if(s!=null&&s.historyId)try{return await up(t,s,r,i)}catch(y){if((f=y.message)!=null&&f.includes("404")||(d=y.message)!=null&&d.includes("notFound")||(v=y.message)!=null&&v.includes("Start history id")||(p=y.message)!=null&&p.includes("history_types"))r({phase:"info",message:"History expired, performing full re-sync..."}),await Me.syncState.delete(Tt);else throw y}return await op(t,e===0?1/0:e,r,i)}async function ap(t,{limit:e=cc,onProgress:r=()=>{},signal:i}={}){const s=await Me.syncState.get(Tt);return s!=null&&s.oldestPageToken?await lp(t,s,e===0?1/0:e,r,i):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function ip(){const t=await Me.syncState.get(Tt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function sp(){await Me.transaction("rw",[Me.items,Me.syncState],async()=>{await Me.items.where("sourceType").equals(Tt).delete(),await Me.syncState.delete(Tt)})}async function op(t,e,r,i){r({phase:"counting",message:"Getting mailbox info..."}),ta(i);const s=await oc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(s.messagesTotal||e,e)});const l=[];let f,d=null;for(;l.length<e;){ta(i);const w=e-l.length,b=await lc(t,{maxResults:Math.min(fc,w),pageToken:f}),_=(b.messages||[]).map(L=>L.id);if(l.push(..._),r({phase:"listing",message:`Listed ${l.length} messages...`,current:l.length,total:Math.min(s.messagesTotal||e,e)}),f=b.nextPageToken,!f||_.length===0)break}if(d=f||null,l.length===0)return await Me.syncState.put({sourceType:Tt,historyId:s.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:p}=await dc(t,l,r,i),y=await Me.items.where("sourceType").equals(Tt).count();return await Me.syncState.put({sourceType:Tt,historyId:s.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:p}}async function lp(t,e,r,i,s){i({phase:"listing",message:"Loading more messages...",current:0}),ta(s);const l=[];let f=e.oldestPageToken,d=null;for(;l.length<r;){ta(s);const w=r-l.length,b=await lc(t,{maxResults:Math.min(fc,w),pageToken:f}),_=(b.messages||[]).map(L=>L.id);if(l.push(..._),i({phase:"listing",message:`Listed ${l.length} more messages...`,current:l.length}),f=b.nextPageToken,!f||_.length===0)break}if(d=f||null,l.length===0)return await Me.syncState.update(Tt,{oldestPageToken:null,lastSyncAt:Date.now()}),i({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:p}=await dc(t,l,i,s),y=await Me.items.where("sourceType").equals(Tt).count();return await Me.syncState.update(Tt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),i({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:p}}async function up(t,e,r,i){r({phase:"syncing",message:"Checking for changes..."}),ta(i);let s=0,l=0,f=0,d,v=e.historyId;do{ta(i);const y=await Jh(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const w of y.history){if(w.messagesAdded){const b=w.messagesAdded.map(L=>L.message.id),_=[...new Set(b.filter(L=>L))];if(_.length>0){const L=await Promise.allSettled(_.map(E=>uc(t,E))),q=[];for(const E of L)E.status==="fulfilled"?q.push(hc(E.value)):f++;q.length>0&&(await Me.items.bulkPut(q),await pc(q),s+=q.length)}}if(w.messagesDeleted){const b=w.messagesDeleted.map(_=>ac(Tt,_.message.id)).filter(_=>_);b.length>0&&(await Me.items.bulkDelete(b),l+=b.length)}}r({phase:"syncing",message:`Changes: +${s} -${l}`,current:s+l})}}while(d);const p=await Me.items.where("sourceType").equals(Tt).count();return await Me.syncState.put({sourceType:Tt,historyId:v,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:s===0&&l===0?"Already up to date":`Synced: +${s} -${l}`,current:p,total:p}),{added:s,deleted:l,errors:f}}async function dc(t,e,r,i){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let s=0,l=0;for(let f=0;f<e.length;f+=jl){ta(i);const d=e.slice(f,f+jl),v=await Promise.allSettled(d.map(y=>uc(t,y))),p=[];for(const y of v)y.status==="fulfilled"?p.push(hc(y.value)):l++;p.length>0&&(await Me.items.bulkPut(p),await pc(p)),s+=p.length,r({phase:"downloading",message:`Downloaded ${s} of ${e.length} messages`,current:s,total:e.length})}return{added:s,errors:l}}function hc(t){const e=mr(t,"From"),r=mr(t,"To"),i=mr(t,"Cc"),s=mr(t,"Subject")||"(no subject)",l=mr(t,"Date"),f=mr(t,"Message-ID"),d=mr(t,"In-Reply-To"),v=mr(t,"References");let p;try{p=l?new Date(l).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:ac(Tt,t.id),sourceType:Tt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:i,subject:s,snippet:t.snippet||"",body:ep(t),htmlBody:tp(t),date:p,labels:t.labelIds||[],messageId:f,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function pc(t){const e=new Map;for(const r of t)for(const i of[r.from,r.to,r.cc]){if(!i)continue;const s=i.split(",").map(l=>l.trim()).filter(Boolean);for(const l of s){const f=cp(l);f&&!e.has(f.email)&&e.set(f.email,{...f,date:r.date})}}for(const[r,{name:i,date:s}]of e)try{const l=await Me.contacts.where("email").equals(r).first();if(l){const f={};i&&!l.name&&(f.name=i),s>(l.lastSeen||0)&&(f.lastSeen=s),Object.keys(f).length>0&&await Me.contacts.update(l.id,f)}else await Me.contacts.add({email:r,name:i||"",firstSeen:s,lastSeen:s})}catch{}}function cp(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const i=e[1].toLowerCase().trim(),s=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:i,name:s}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ta(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var fp=V(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function dp(t,e){ut(e,!0);let r=Pe(e,"clientIdInput",15);It(()=>tn("SetupGuide"));let i=Ce(null);async function s(Ne){try{await navigator.clipboard.writeText(Ne),U(i,Ne,!0),setTimeout(()=>{U(i,null)},1500)}catch{const Ae=document.createElement("input");Ae.value=Ne,document.body.appendChild(Ae),Ae.select(),document.execCommand("copy"),document.body.removeChild(Ae),U(i,Ne,!0),setTimeout(()=>{U(i,null)},1500)}}const l="http://localhost:5173",f="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=fp(),p=T(v),y=j(T(p),4),w=j(T(y),6),b=j(T(w),2),_=j(T(b),2),L=j(T(_),2),q=T(L);q.__click=()=>s(l);var E=T(q);E.textContent="http://localhost:5173";var z=j(E,2),ee=T(z),J=j(q,2);J.__click=()=>s(f);var K=T(J);K.textContent="https://cypherkitty.github.io";var $=j(K,2),ue=T($),Q=j(_,2),me=j(T(Q),2),Re=T(me);Re.__click=()=>s(l);var De=T(Re);De.textContent="http://localhost:5173";var fe=j(De,2),X=T(fe),ae=j(Re,2);ae.__click=()=>s(f);var le=T(ae);le.textContent="https://cypherkitty.github.io";var Z=j(le,2),ie=T(Z),we=j(ae,2);we.__click=()=>s(d);var F=T(we);F.textContent="https://cypherkitty.github.io/me-ai/";var W=j(F,2),ve=T(W),ke=j(y,2),Le=T(ke);Le.__keydown=Ne=>Ne.key==="Enter"&&e.onsave();var qe=j(Le,2);qe.__click=function(...Ne){var Ae;(Ae=e.onsave)==null||Ae.apply(this,Ne)},ge(Ne=>{oe(ee,k(i)===l?"â":"â§"),oe(ue,k(i)===f?"â":"â§"),oe(X,k(i)===l?"â":"â§"),oe(ie,k(i)===f?"â":"â§"),oe(ve,k(i)===d?"â":"â§"),qe.disabled=Ne},[()=>!r().trim()]),Ro(Le,r),Y(t,v),ct()}Yt(["click","keydown"]);function hp(t){const e=t||"";if(e.includes("has not been used in project")||e.includes("is disabled")){const r=e.match(/project\s+(\d+)/),i=r==null?void 0:r[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:i?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${i}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return e.includes("Invalid Credentials")||e.includes("401")||e.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:e.includes("insufficient")&&e.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:e.includes("access_denied")||e.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:e.includes("popup")||e.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:e.includes("Rate Limit")||e.includes("429")||e.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:e,fix:null}}var pp=V('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),vp=V('<div class="error-card-title svelte-14buhqq"> </div>'),gp=V('<p class="error-card-fix svelte-14buhqq"> </p>'),mp=V('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),yp=V('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),bp=V('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function vc(t,e){ut(e,!0);let r=Pe(e,"ondismiss",3,null),i=Pe(e,"onsignout",3,null),s=hn(()=>hp(e.error));It(()=>tn("ErrorCard"));var l=bp(),f=T(l);{var d=z=>{var ee=pp(),J=T(ee),K=T(J),$=j(J,2);$.__click=function(...ue){var Q;(Q=r())==null||Q.apply(this,ue)},ge(()=>oe(K,k(s).title)),Y(z,ee)},v=z=>{var ee=vp(),J=T(ee);ge(()=>oe(J,k(s).title)),Y(z,ee)};Te(f,z=>{r()?z(d):z(v,!1)})}var p=j(f,2),y=T(p),w=j(p,2);{var b=z=>{var ee=gp(),J=T(ee);ge(()=>oe(J,k(s).fix)),Y(z,ee)};Te(w,z=>{k(s).fix&&z(b)})}var _=j(w,2);{var L=z=>{var ee=mp(),J=T(ee);ge(()=>{tc(ee,"href",k(s).link.url),oe(J,`${k(s).link.label??""} â`)}),Y(z,ee)};Te(_,z=>{k(s).link&&z(L)})}var q=j(_,2);{var E=z=>{var ee=yp();ee.__click=function(...J){var K;(K=i())==null||K.apply(this,J)},Y(z,ee)};Te(q,z=>{k(s).action==="signout"&&i()&&z(E)})}ge(()=>oe(y,k(s).description)),Y(t,l),ct()}Yt(["click"]);var _p=V('<span class="spinner svelte-nyqevv"></span> Signing in...',1),wp=Co('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),kp=V(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function xp(t,e){ut(e,!0);let r=Pe(e,"error",3,null),i=Pe(e,"loadingAuth",3,!1);It(()=>tn("AuthCard"));var s=kp(),l=T(s),f=j(T(l),4);{var d=E=>{vc(E,{get error(){return r()},get onsignout(){return e.onsignout}})};Te(f,E=>{r()&&E(d)})}var v=j(f,2);v.__click=function(...E){var z;(z=e.onsignin)==null||z.apply(this,E)};var p=T(v);{var y=E=>{var z=_p();Y(E,z)},w=E=>{var z=wp();Y(E,z)};Te(p,E=>{i()?E(y):E(w,!1)})}var b=j(v,2),_=j(T(b),2),L=T(_),q=j(_,2);q.__click=function(...E){var z;(z=e.onclear)==null||z.apply(this,E)},ge(E=>{v.disabled=i(),oe(L,`${E??""}...`)},[()=>e.clientId.slice(0,20)]),Y(t,s),ct()}Yt(["click"]);function Oo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function gc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function mc(t){return gc(t).charAt(0).toUpperCase()}var Sp=V('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Tp=V('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Ep=V('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function Ap(t,e){ut(e,!0);let r=Pe(e,"profile",3,null),i=Pe(e,"loadingProfile",3,!1);It(()=>tn("ProfileCard"));var s=Ep(),l=T(s),f=T(l),d=j(l,2),v=T(d);{var p=b=>{var _=Sp();Y(b,_)},y=b=>{var _=Tp(),L=Dt(_),q=T(L),E=j(L,2),z=T(E);ge((ee,J)=>{oe(q,r().emailAddress),oe(z,`${ee??""} messages
        Â· ${J??""} threads`)},[()=>{var ee;return((ee=r().messagesTotal)==null?void 0:ee.toLocaleString())||"?"},()=>{var ee;return((ee=r().threadsTotal)==null?void 0:ee.toLocaleString())||"?"}]),Y(b,_)};Te(v,b=>{i()?b(p):r()&&b(y,1)})}var w=j(d,2);w.__click=function(...b){var _;(_=e.onsignout)==null||_.apply(this,b)},ge(b=>oe(f,b),[()=>r()?mc(r().emailAddress):"?"]),Y(t,s),ct()}Yt(["click"]);var Ip=V('<span class="spinner svelte-1ds3j4k"></span>'),Cp=Co('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Pp=V('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),Rp=V('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Op=V('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Dp=V('<option class="svelte-1ds3j4k"> </option>'),Mp=V('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Lp=V('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Np=V('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),qp=V('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),jp=V('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Bp=V('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function zp(t,e){ut(e,!0),It(()=>tn("SyncStatus"));let r=Pe(e,"syncStatus",3,null),i=Pe(e,"syncProgress",3,null),s=Pe(e,"isSyncing",3,!1),l=Ce(!1),f=Ce(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(F){if(!F)return"never";const W=Math.floor((Date.now()-F)/1e3);if(W<60)return"just now";const ve=Math.floor(W/60);if(ve<60)return`${ve}m ago`;const ke=Math.floor(ve/60);return ke<24?`${ke}h ago`:`${Math.floor(ke/24)}d ago`}function p(){var F,W;return!((F=i())!=null&&F.total)||!((W=i())!=null&&W.current)?0:Math.round(i().current/i().total*100)}var y=Bp(),w=T(y),b=T(w),_=T(b);{var L=F=>{var W=Ip();Y(F,W)},q=F=>{var W=Cp();Y(F,W)};Te(_,F=>{s()?F(L):F(q,!1)})}var E=j(b,2),z=j(T(E),2);{var ee=F=>{var W=Pp(),ve=T(W),ke=j(ve);{var Le=Ne=>{var Ae=Al("Â· more available");Y(Ne,Ae)},qe=Ne=>{var Ae=Al("Â· all synced");Y(Ne,Ae)};Te(ke,Ne=>{r().hasMore?Ne(Le):Ne(qe,!1)})}ge((Ne,Ae)=>oe(ve,`${Ne??""} emails stored
          Â· synced ${Ae??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),Y(F,W)},J=F=>{var W=Rp();Y(F,W)};Te(z,F=>{var W;(W=r())!=null&&W.synced?F(ee):F(J,!1)})}var K=j(E,2),$=T(K);{var ue=F=>{var W=Op();W.__click=()=>U(l,!k(l)),Y(F,W)};Te($,F=>{var W;(W=r())!=null&&W.synced&&!s()&&F(ue)})}var Q=j(w,2),me=T(Q),Re=j(T(me),2);ar(Re,21,()=>d,Tr,(F,W)=>{var ve=Dp(),ke=T(ve),Le={};ge(()=>{oe(ke,k(W).label),Le!==(Le=k(W).value)&&(ve.value=(ve.__value=k(W).value)??"")}),Y(F,ve)});var De=j(me,2),fe=T(De);{var X=F=>{var W=Lp(),ve=Dt(W);ve.__click=()=>e.onsync(k(f));var ke=T(ve),Le=j(ve,2);{var qe=Ne=>{var Ae=Mp();Ae.__click=()=>e.onsyncmore(k(f));var nt=T(Ae);ge(()=>{Ae.disabled=s(),oe(nt,s()?"Loading...":"Sync More")}),Y(Ne,Ae)};Te(Le,Ne=>{r().hasMore&&Ne(qe)})}ge(()=>{ve.disabled=s(),oe(ke,s()?"Syncing...":"Sync New")}),Y(F,W)},ae=F=>{var W=Np();W.__click=()=>e.onsync(k(f));var ve=T(W);ge(()=>{W.disabled=s(),oe(ve,s()?"Syncing...":"Download Emails")}),Y(F,W)};Te(fe,F=>{var W;(W=r())!=null&&W.synced?F(X):F(ae,!1)})}var le=j(Q,2);{var Z=F=>{var W=qp(),ve=T(W),ke=T(ve);let Le,qe;var Ne=j(ve,2),Ae=T(Ne);ge(nt=>{Le=fn(ke,1,"progress-fill svelte-1ds3j4k",null,Le,{indeterminate:!i().total}),qe=tr(ke,"",qe,nt),oe(Ae,i().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),Y(F,W)};Te(le,F=>{s()&&i()&&F(Z)})}var ie=j(le,2);{var we=F=>{var W=jp(),ve=j(T(W),2),ke=T(ve);ke.__click=()=>U(l,!1);var Le=j(ke,2);Le.__click=()=>{e.onclear(),U(l,!1)},Y(F,W)};Te(ie,F=>{k(l)&&F(we)})}ge(()=>Re.disabled=s()),Po(Re,()=>k(f),F=>U(f,F)),Y(t,y),ct()}Yt(["click"]);var Fp=V('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Kp=V('<div class="message-list svelte-y2uamw"></div>');function Up(t,e){ut(e,!0);let r=Pe(e,"messages",19,()=>[]);It(()=>tn("MessageList"));var i=Kp();ar(i,21,r,Tr,(s,l)=>{var f=Fp();f.__click=()=>e.onselect(k(l));var d=T(f),v=T(d),p=j(d,2),y=T(p),w=T(y),b=T(w),_=j(w,2),L=T(_),q=j(y,2),E=T(q),z=j(q,2),ee=T(z);ge((J,K,$)=>{oe(v,J),oe(b,K),oe(L,$),oe(E,k(l).subject),oe(ee,k(l).snippet)},[()=>mc(k(l).from),()=>gc(k(l).from),()=>Oo(k(l).date)]),Y(s,f)}),Y(t,i),ct()}Yt(["click"]);function Do(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var aa=Do();function yc(t){aa=t}var Br={exec:()=>null};function Ve(t,e=""){let r=typeof t=="string"?t:t.source,i={replace:(s,l)=>{let f=typeof l=="string"?l:l.source;return f=f.replace(qt.caret,"$1"),r=r.replace(s,f),i},getRegex:()=>new RegExp(r,e)};return i}var Gp=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),qt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Hp=/^(?:[ \t]*(?:\n|$))+/,Wp=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Yp=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,gi=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Vp=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Mo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,bc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_c=Ve(bc).replace(/bull/g,Mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),$p=Ve(bc).replace(/bull/g,Mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Lo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Xp=/^[^\n]+/,No=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Qp=Ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",No).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Zp=Ve(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Mo).getRegex(),cs="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",qo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Jp=Ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",qo).replace("tag",cs).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),wc=Ve(Lo).replace("hr",gi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",cs).getRegex(),ev=Ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",wc).getRegex(),jo={blockquote:ev,code:Wp,def:Qp,fences:Yp,heading:Vp,hr:gi,html:Jp,lheading:_c,list:Zp,newline:Hp,paragraph:wc,table:Br,text:Xp},Bl=Ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",gi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",cs).getRegex(),tv={...jo,lheading:$p,table:Bl,paragraph:Ve(Lo).replace("hr",gi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Bl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",cs).getRegex()},nv={...jo,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",qo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Br,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(Lo).replace("hr",gi).replace("heading",` *#{1,6} *[^
]`).replace("lheading",_c).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},rv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,av=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,kc=/^( {2,}|\\)\n(?!\s*$)/,iv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fs=/[\p{P}\p{S}]/u,Bo=/[\s\p{P}\p{S}]/u,xc=/[^\s\p{P}\p{S}]/u,sv=Ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Bo).getRegex(),Sc=/(?!~)[\p{P}\p{S}]/u,ov=/(?!~)[\s\p{P}\p{S}]/u,lv=/(?:[^\s\p{P}\p{S}]|~)/u,Tc=/(?![*_])[\p{P}\p{S}]/u,uv=/(?![*_])[\s\p{P}\p{S}]/u,cv=/(?:[^\s\p{P}\p{S}]|[*_])/u,fv=Ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Gp?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ec=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,dv=Ve(Ec,"u").replace(/punct/g,fs).getRegex(),hv=Ve(Ec,"u").replace(/punct/g,Sc).getRegex(),Ac="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",pv=Ve(Ac,"gu").replace(/notPunctSpace/g,xc).replace(/punctSpace/g,Bo).replace(/punct/g,fs).getRegex(),vv=Ve(Ac,"gu").replace(/notPunctSpace/g,lv).replace(/punctSpace/g,ov).replace(/punct/g,Sc).getRegex(),gv=Ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,xc).replace(/punctSpace/g,Bo).replace(/punct/g,fs).getRegex(),mv=Ve(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Tc).getRegex(),yv="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",bv=Ve(yv,"gu").replace(/notPunctSpace/g,cv).replace(/punctSpace/g,uv).replace(/punct/g,Tc).getRegex(),_v=Ve(/\\(punct)/,"gu").replace(/punct/g,fs).getRegex(),wv=Ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),kv=Ve(qo).replace("(?:-->|$)","-->").getRegex(),xv=Ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",kv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),es=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Sv=Ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",es).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ic=Ve(/^!?\[(label)\]\[(ref)\]/).replace("label",es).replace("ref",No).getRegex(),Cc=Ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",No).getRegex(),Tv=Ve("reflink|nolink(?!\\()","g").replace("reflink",Ic).replace("nolink",Cc).getRegex(),zl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,zo={_backpedal:Br,anyPunctuation:_v,autolink:wv,blockSkip:fv,br:kc,code:av,del:Br,delLDelim:Br,delRDelim:Br,emStrongLDelim:dv,emStrongRDelimAst:pv,emStrongRDelimUnd:gv,escape:rv,link:Sv,nolink:Cc,punctuation:sv,reflink:Ic,reflinkSearch:Tv,tag:xv,text:iv,url:Br},Ev={...zo,link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",es).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",es).getRegex()},uo={...zo,emStrongRDelimAst:vv,emStrongLDelim:hv,delLDelim:mv,delRDelim:bv,url:Ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",zl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",zl).getRegex()},Av={...uo,br:Ve(kc).replace("{2,}","*").getRegex(),text:Ve(uo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zi={normal:jo,gfm:tv,pedantic:nv},Wa={normal:zo,gfm:uo,breaks:Av,pedantic:Ev},Iv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fl=t=>Iv[t];function Yn(t,e){if(e){if(qt.escapeTest.test(t))return t.replace(qt.escapeReplace,Fl)}else if(qt.escapeTestNoEncode.test(t))return t.replace(qt.escapeReplaceNoEncode,Fl);return t}function Kl(t){try{t=encodeURI(t).replace(qt.percentDecode,"%")}catch{return null}return t}function Ul(t,e){var l;let r=t.replace(qt.findPipe,(f,d,v)=>{let p=!1,y=d;for(;--y>=0&&v[y]==="\\";)p=!p;return p?"|":" |"}),i=r.split(qt.splitPipe),s=0;if(i[0].trim()||i.shift(),i.length>0&&!((l=i.at(-1))!=null&&l.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;s<i.length;s++)i[s]=i[s].trim().replace(qt.slashPipe,"|");return i}function Ya(t,e,r){let i=t.length;if(i===0)return"";let s=0;for(;s<i&&t.charAt(i-s-1)===e;)s++;return t.slice(0,i-s)}function Cv(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let i=0;i<t.length;i++)if(t[i]==="\\")i++;else if(t[i]===e[0])r++;else if(t[i]===e[1]&&(r--,r<0))return i;return r>0?-2:-1}function Pv(t,e=0){let r=e,i="";for(let s of t)if(s==="	"){let l=4-r%4;i+=" ".repeat(l),r+=l}else i+=s,r++;return i}function Gl(t,e,r,i,s){let l=e.href,f=e.title||null,d=t[1].replace(s.other.outputLinkReplace,"$1");i.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:l,title:f,text:d,tokens:i.inlineTokens(d)};return i.state.inLink=!1,v}function Rv(t,e,r){let i=t.match(r.other.indentCodeCompensation);if(i===null)return e;let s=i[1];return e.split(`
`).map(l=>{let f=l.match(r.other.beginningSpace);if(f===null)return l;let[d]=f;return d.length>=s.length?l.slice(s.length):l}).join(`
`)}var ts=class{constructor(t){Ke(this,"options");Ke(this,"rules");Ke(this,"lexer");this.options=t||aa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ya(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],i=Rv(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let i=Ya(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ya(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ya(e[0],`
`).split(`
`),i="",s="",l=[];for(;r.length>0;){let f=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),f=!0;else if(!f)d.push(r[v]);else break;r=r.slice(v);let p=d.join(`
`),y=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${p}`:p,s=s?`${s}
${y}`:y;let w=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,l,!0),this.lexer.state.top=w,r.length===0)break;let b=l.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let _=b,L=_.raw+`
`+r.join(`
`),q=this.blockquote(L);l[l.length-1]=q,i=i.substring(0,i.length-_.raw.length)+q.raw,s=s.substring(0,s.length-_.text.length)+q.text;break}else if((b==null?void 0:b.type)==="list"){let _=b,L=_.raw+`
`+r.join(`
`),q=this.list(L);l[l.length-1]=q,i=i.substring(0,i.length-b.raw.length)+q.raw,s=s.substring(0,s.length-_.raw.length)+q.raw,r=L.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:l,text:s}}}list(t){var r,i;let e=this.rules.block.list.exec(t);if(e){let s=e[1].trim(),l=s.length>1,f={type:"list",raw:"",ordered:l,start:l?+s.slice(0,-1):"",loose:!1,items:[]};s=l?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=l?s:"[*+-]");let d=this.rules.other.listItemRegex(s),v=!1;for(;t;){let y=!1,w="",b="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;w=e[0],t=t.substring(w.length);let _=Pv(e[2].split(`
`,1)[0],e[1].length),L=t.split(`
`,1)[0],q=!_.trim(),E=0;if(this.options.pedantic?(E=2,b=_.trimStart()):q?E=e[1].length+1:(E=_.search(this.rules.other.nonSpaceChar),E=E>4?1:E,b=_.slice(E),E+=e[1].length),q&&this.rules.other.blankLine.test(L)&&(w+=L+`
`,t=t.substring(L.length+1),y=!0),!y){let z=this.rules.other.nextBulletRegex(E),ee=this.rules.other.hrRegex(E),J=this.rules.other.fencesBeginRegex(E),K=this.rules.other.headingBeginRegex(E),$=this.rules.other.htmlBeginRegex(E),ue=this.rules.other.blockquoteBeginRegex(E);for(;t;){let Q=t.split(`
`,1)[0],me;if(L=Q,this.options.pedantic?(L=L.replace(this.rules.other.listReplaceNesting,"  "),me=L):me=L.replace(this.rules.other.tabCharGlobal,"    "),J.test(L)||K.test(L)||$.test(L)||ue.test(L)||z.test(L)||ee.test(L))break;if(me.search(this.rules.other.nonSpaceChar)>=E||!L.trim())b+=`
`+me.slice(E);else{if(q||_.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||J.test(_)||K.test(_)||ee.test(_))break;b+=`
`+L}q=!L.trim(),w+=Q+`
`,t=t.substring(Q.length+1),_=me.slice(E)}}f.loose||(v?f.loose=!0:this.rules.other.doubleBlankLine.test(w)&&(v=!0)),f.items.push({type:"list_item",raw:w,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),f.raw+=w}let p=f.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;f.raw=f.raw.trimEnd();for(let y of f.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((i=y.tokens[0])==null?void 0:i.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let w=this.rules.other.listTaskCheckbox.exec(y.raw);if(w){let b={type:"checkbox",raw:w[0]+" ",checked:w[0]!=="[ ]"};y.checked=b.checked,f.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=b.raw+y.tokens[0].raw,y.tokens[0].text=b.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(b)):y.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):y.tokens.unshift(b)}}if(!f.loose){let w=y.tokens.filter(_=>_.type==="space"),b=w.length>0&&w.some(_=>this.rules.other.anyLine.test(_.raw));f.loose=b}}if(f.loose)for(let y of f.items){y.loose=!0;for(let w of y.tokens)w.type==="text"&&(w.type="paragraph")}return f}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:i,title:s}}}table(t){var f;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Ul(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(f=e[3])!=null&&f.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===i.length){for(let d of i)this.rules.other.tableAlignRight.test(d)?l.align.push("right"):this.rules.other.tableAlignCenter.test(d)?l.align.push("center"):this.rules.other.tableAlignLeft.test(d)?l.align.push("left"):l.align.push(null);for(let d=0;d<r.length;d++)l.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:l.align[d]});for(let d of s)l.rows.push(Ul(d,l.header.length).map((v,p)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:l.align[p]})));return l}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let l=Ya(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{let l=Cv(e[2],"()");if(l===-2)return;if(l>-1){let f=(e[0].indexOf("!")===0?5:4)+e[1].length+l;e[2]=e[2].substring(0,l),e[0]=e[0].substring(0,f).trim(),e[3]=""}}let i=e[2],s="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(i);l&&(i=l[1],s=l[3])}else s=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),Gl(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=e[i.toLowerCase()];if(!s){let l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Gl(r,s,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!r||this.rules.inline.punctuation.exec(r))){let s=[...i[0]].length-1,l,f,d=s,v=0,p=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+s);(i=p.exec(e))!=null;){if(l=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!l)continue;if(f=[...l].length,i[3]||i[4]){d+=f;continue}else if((i[5]||i[6])&&s%3&&!((s+f)%3)){v+=f;continue}if(d-=f,d>0)continue;f=Math.min(f,f+d+v);let y=[...i[0]][0].length,w=t.slice(0,s+i.index+y+f);if(Math.min(s,f)%2){let _=w.slice(1,-1);return{type:"em",raw:w,text:_,tokens:this.lexer.inlineTokens(_)}}let b=w.slice(2,-2);return{type:"strong",raw:w,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let i=this.rules.inline.delLDelim.exec(t);if(i&&(!i[1]||!r||this.rules.inline.punctuation.exec(r))){let s=[...i[0]].length-1,l,f,d=s,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+s);(i=v.exec(e))!=null;){if(l=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!l||(f=[...l].length,f!==s))continue;if(i[3]||i[4]){d+=f;continue}if(d-=f,d>0)continue;f=Math.min(f,f+d);let p=[...i[0]][0].length,y=t.slice(0,s+i.index+p+f),w=y.slice(s,-s);return{type:"del",raw:y,text:w,tokens:this.lexer.inlineTokens(w)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,i;return e[2]==="@"?(r=e[1],i="mailto:"+r):(r=e[1],i=r),{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let i,s;if(e[2]==="@")i=e[0],s="mailto:"+i;else{let l;do l=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(l!==e[0]);i=e[0],e[1]==="www."?s="http://"+e[0]:s=e[0]}return{type:"link",raw:e[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Tn=class co{constructor(e){Ke(this,"tokens");Ke(this,"options");Ke(this,"state");Ke(this,"inlineQueue");Ke(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||aa,this.options.tokenizer=this.options.tokenizer||new ts,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:qt,block:zi.normal,inline:Wa.normal};this.options.pedantic?(r.block=zi.pedantic,r.inline=Wa.pedantic):this.options.gfm&&(r.block=zi.gfm,this.options.breaks?r.inline=Wa.breaks:r.inline=Wa.gfm),this.tokenizer.rules=r}static get rules(){return{block:zi,inline:Wa}}static lex(e,r){return new co(r).lex(e)}static lexInline(e,r){return new co(r).inlineTokens(e)}lex(e){e=e.replace(qt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let i=this.inlineQueue[r];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],i=!1){var s,l,f;for(this.options.pedantic&&(e=e.replace(qt.tabCharGlobal,"    ").replace(qt.spaceLine,""));e;){let d;if((l=(s=this.options.extensions)==null?void 0:s.block)!=null&&l.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((f=this.options.extensions)!=null&&f.startBlock){let p=1/0,y=e.slice(1),w;this.options.extensions.startBlock.forEach(b=>{w=b.call({lexer:this},y),typeof w=="number"&&w>=0&&(p=Math.min(p,w))}),p<1/0&&p>=0&&(v=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let p=r.at(-1);i&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),i=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,p,y,w,b;let i=e,s=null;if(this.tokens.links){let _=Object.keys(this.tokens.links);if(_.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)_.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,s.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let l;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)l=s[2]?s[2].length:0,i=i.slice(0,s.index+l)+"["+"a".repeat(s[0].length-l-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);i=((p=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:p.call({lexer:this},i))??i;let f=!1,d="";for(;e;){f||(d=""),f=!1;let _;if((w=(y=this.options.extensions)==null?void 0:y.inline)!=null&&w.some(q=>(_=q.call({lexer:this},e,r))?(e=e.substring(_.raw.length),r.push(_),!0):!1))continue;if(_=this.tokenizer.escape(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.tag(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.link(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(_.raw.length);let q=r.at(-1);_.type==="text"&&(q==null?void 0:q.type)==="text"?(q.raw+=_.raw,q.text+=_.text):r.push(_);continue}if(_=this.tokenizer.emStrong(e,i,d)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.codespan(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.br(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.del(e,i,d)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.autolink(e)){e=e.substring(_.raw.length),r.push(_);continue}if(!this.state.inLink&&(_=this.tokenizer.url(e))){e=e.substring(_.raw.length),r.push(_);continue}let L=e;if((b=this.options.extensions)!=null&&b.startInline){let q=1/0,E=e.slice(1),z;this.options.extensions.startInline.forEach(ee=>{z=ee.call({lexer:this},E),typeof z=="number"&&z>=0&&(q=Math.min(q,z))}),q<1/0&&q>=0&&(L=e.substring(0,q+1))}if(_=this.tokenizer.inlineText(L)){e=e.substring(_.raw.length),_.raw.slice(-1)!=="_"&&(d=_.raw.slice(-1)),f=!0;let q=r.at(-1);(q==null?void 0:q.type)==="text"?(q.raw+=_.raw,q.text+=_.text):r.push(_);continue}if(e){let q="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(q);break}else throw new Error(q)}}return r}},ns=class{constructor(t){Ke(this,"options");Ke(this,"parser");this.options=t||aa}space(t){return""}code({text:t,lang:e,escaped:r}){var l;let i=(l=(e||"").match(qt.notSpaceStart))==null?void 0:l[0],s=t.replace(qt.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Yn(i)+'">'+(r?s:Yn(s,!0))+`</code></pre>
`:"<pre><code>"+(r?s:Yn(s,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,i="";for(let f=0;f<t.items.length;f++){let d=t.items[f];i+=this.listitem(d)}let s=e?"ol":"ul",l=e&&r!==1?' start="'+r+'"':"";return"<"+s+l+`>
`+i+"</"+s+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let s=0;s<t.header.length;s++)r+=this.tablecell(t.header[s]);e+=this.tablerow({text:r});let i="";for(let s=0;s<t.rows.length;s++){let l=t.rows[s];r="";for(let f=0;f<l.length;f++)r+=this.tablecell(l[f]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Yn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let i=this.parser.parseInline(r),s=Kl(t);if(s===null)return i;t=s;let l='<a href="'+t+'"';return e&&(l+=' title="'+Yn(e)+'"'),l+=">"+i+"</a>",l}image({href:t,title:e,text:r,tokens:i}){i&&(r=this.parser.parseInline(i,this.parser.textRenderer));let s=Kl(t);if(s===null)return Yn(r);t=s;let l=`<img src="${t}" alt="${r}"`;return e&&(l+=` title="${Yn(e)}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Yn(t.text)}},Fo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},En=class fo{constructor(e){Ke(this,"options");Ke(this,"renderer");Ke(this,"textRenderer");this.options=e||aa,this.options.renderer=this.options.renderer||new ns,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Fo}static parse(e,r){return new fo(r).parse(e)}static parseInline(e,r){return new fo(r).parseInline(e)}parse(e){var i,s;let r="";for(let l=0;l<e.length;l++){let f=e[l];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[f.type]){let v=f,p=this.options.extensions.renderers[v.type].call({parser:this},v);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=p||"";continue}}let d=f;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var s,l;let i="";for(let f=0;f<e.length;f++){let d=e[f];if((l=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&l[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){i+=p||"";continue}}let v=d;switch(v.type){case"escape":{i+=r.text(v);break}case"html":{i+=r.html(v);break}case"link":{i+=r.link(v);break}case"image":{i+=r.image(v);break}case"checkbox":{i+=r.checkbox(v);break}case"strong":{i+=r.strong(v);break}case"em":{i+=r.em(v);break}case"codespan":{i+=r.codespan(v);break}case"br":{i+=r.br(v);break}case"del":{i+=r.del(v);break}case"text":{i+=r.text(v);break}default:{let p='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return i}},Ui,ei=(Ui=class{constructor(t){Ke(this,"options");Ke(this,"block");this.options=t||aa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Tn.lex:Tn.lexInline}provideParser(){return this.block?En.parse:En.parseInline}},Ke(Ui,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ke(Ui,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Ui),Ov=class{constructor(...t){Ke(this,"defaults",Do());Ke(this,"options",this.setOptions);Ke(this,"parse",this.parseMarkdown(!0));Ke(this,"parseInline",this.parseMarkdown(!1));Ke(this,"Parser",En);Ke(this,"Renderer",ns);Ke(this,"TextRenderer",Fo);Ke(this,"Lexer",Tn);Ke(this,"Tokenizer",ts);Ke(this,"Hooks",ei);this.use(...t)}walkTokens(t,e){var i,s;let r=[];for(let l of t)switch(r=r.concat(e.call(this,l)),l.type){case"table":{let f=l;for(let d of f.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of f.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let f=l;r=r.concat(this.walkTokens(f.items,e));break}default:{let f=l;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[f.type]?this.defaults.extensions.childTokens[f.type].forEach(d=>{let v=f[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):f.tokens&&(r=r.concat(this.walkTokens(f.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let l=e.renderers[s.name];l?e.renderers[s.name]=function(...f){let d=s.renderer.apply(this,f);return d===!1&&(d=l.apply(this,f)),d}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=e[s.level];l?l.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),i.extensions=e),r.renderer){let s=this.defaults.renderer||new ns(this.defaults);for(let l in r.renderer){if(!(l in s))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let f=l,d=r.renderer[f],v=s[f];s[f]=(...p)=>{let y=d.apply(s,p);return y===!1&&(y=v.apply(s,p)),y||""}}i.renderer=s}if(r.tokenizer){let s=this.defaults.tokenizer||new ts(this.defaults);for(let l in r.tokenizer){if(!(l in s))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let f=l,d=r.tokenizer[f],v=s[f];s[f]=(...p)=>{let y=d.apply(s,p);return y===!1&&(y=v.apply(s,p)),y}}i.tokenizer=s}if(r.hooks){let s=this.defaults.hooks||new ei;for(let l in r.hooks){if(!(l in s))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let f=l,d=r.hooks[f],v=s[f];ei.passThroughHooks.has(l)?s[f]=p=>{if(this.defaults.async&&ei.passThroughHooksRespectAsync.has(l))return(async()=>{let w=await d.call(s,p);return v.call(s,w)})();let y=d.call(s,p);return v.call(s,y)}:s[f]=(...p)=>{if(this.defaults.async)return(async()=>{let w=await d.apply(s,p);return w===!1&&(w=await v.apply(s,p)),w})();let y=d.apply(s,p);return y===!1&&(y=v.apply(s,p)),y}}i.hooks=s}if(r.walkTokens){let s=this.defaults.walkTokens,l=r.walkTokens;i.walkTokens=function(f){let d=[];return d.push(l.call(this,f)),s&&(d=d.concat(s.call(this,f))),d}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Tn.lex(t,e??this.defaults)}parser(t,e){return En.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let i={...r},s={...this.defaults,...i},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=t),s.async)return(async()=>{let f=s.hooks?await s.hooks.preprocess(e):e,d=await(s.hooks?await s.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(f,s),v=s.hooks?await s.hooks.processAllTokens(d):d;s.walkTokens&&await Promise.all(this.walkTokens(v,s.walkTokens));let p=await(s.hooks?await s.hooks.provideParser():t?En.parse:En.parseInline)(v,s);return s.hooks?await s.hooks.postprocess(p):p})().catch(l);try{s.hooks&&(e=s.hooks.preprocess(e));let f=(s.hooks?s.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(e,s);s.hooks&&(f=s.hooks.processAllTokens(f)),s.walkTokens&&this.walkTokens(f,s.walkTokens);let d=(s.hooks?s.hooks.provideParser():t?En.parse:En.parseInline)(f,s);return s.hooks&&(d=s.hooks.postprocess(d)),d}catch(f){return l(f)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let i="<p>An error occurred:</p><pre>"+Yn(r.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(r);throw r}}},na=new Ov;function Ze(t,e){return na.parse(t,e)}Ze.options=Ze.setOptions=function(t){return na.setOptions(t),Ze.defaults=na.defaults,yc(Ze.defaults),Ze};Ze.getDefaults=Do;Ze.defaults=aa;Ze.use=function(...t){return na.use(...t),Ze.defaults=na.defaults,yc(Ze.defaults),Ze};Ze.walkTokens=function(t,e){return na.walkTokens(t,e)};Ze.parseInline=na.parseInline;Ze.Parser=En;Ze.parser=En.parse;Ze.Renderer=ns;Ze.TextRenderer=Fo;Ze.Lexer=Tn;Ze.lexer=Tn.lex;Ze.Tokenizer=ts;Ze.Hooks=ei;Ze.parse=Ze;Ze.options;Ze.setOptions;Ze.use;Ze.walkTokens;Ze.parseInline;En.parse;Tn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Pc,setPrototypeOf:Hl,isFrozen:Dv,getPrototypeOf:Mv,getOwnPropertyDescriptor:Lv}=Object;let{freeze:jt,seal:gn,create:ho}=Object,{apply:po,construct:vo}=typeof Reflect<"u"&&Reflect;jt||(jt=function(e){return e});gn||(gn=function(e){return e});po||(po=function(e,r){for(var i=arguments.length,s=new Array(i>2?i-2:0),l=2;l<i;l++)s[l-2]=arguments[l];return e.apply(r,s)});vo||(vo=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return new e(...i)});const Fi=Bt(Array.prototype.forEach),Nv=Bt(Array.prototype.lastIndexOf),Wl=Bt(Array.prototype.pop),Va=Bt(Array.prototype.push),qv=Bt(Array.prototype.splice),Xi=Bt(String.prototype.toLowerCase),Us=Bt(String.prototype.toString),Gs=Bt(String.prototype.match),$a=Bt(String.prototype.replace),jv=Bt(String.prototype.indexOf),Bv=Bt(String.prototype.trim),xn=Bt(Object.prototype.hasOwnProperty),Nt=Bt(RegExp.prototype.test),Xa=zv(TypeError);function Bt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return po(t,e,i)}}function zv(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return vo(t,r)}}function Fe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xi;Hl&&Hl(t,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const l=r(s);l!==s&&(Dv(e)||(e[i]=l),s=l)}t[s]=!0}return t}function Fv(t){for(let e=0;e<t.length;e++)xn(t,e)||(t[e]=null);return t}function Ln(t){const e=ho(null);for(const[r,i]of Pc(t))xn(t,r)&&(Array.isArray(i)?e[r]=Fv(i):i&&typeof i=="object"&&i.constructor===Object?e[r]=Ln(i):e[r]=i);return e}function Qa(t,e){for(;t!==null;){const i=Lv(t,e);if(i){if(i.get)return Bt(i.get);if(typeof i.value=="function")return Bt(i.value)}t=Mv(t)}function r(){return null}return r}const Yl=jt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hs=jt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ws=jt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Kv=jt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ys=jt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Uv=jt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Vl=jt(["#text"]),$l=jt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vs=jt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Xl=jt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ki=jt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Gv=gn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Hv=gn(/<%[\w\W]*|[\w\W]*%>/gm),Wv=gn(/\$\{[\w\W]*/gm),Yv=gn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Vv=gn(/^aria-[\-\w]+$/),Rc=gn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$v=gn(/^(?:\w+script|data):/i),Xv=gn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Oc=gn(/^html$/i),Qv=gn(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ql=Object.freeze({__proto__:null,ARIA_ATTR:Vv,ATTR_WHITESPACE:Xv,CUSTOM_ELEMENT:Qv,DATA_ATTR:Yv,DOCTYPE_NAME:Oc,ERB_EXPR:Hv,IS_ALLOWED_URI:Rc,IS_SCRIPT_OR_DATA:$v,MUSTACHE_EXPR:Gv,TMPLIT_EXPR:Wv});const Za={element:1,text:3,progressingInstruction:7,comment:8,document:9},Zv=function(){return typeof window>"u"?null:window},Jv=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(i=r.getAttribute(s));const l="dompurify"+(i?"#"+i:"");try{return e.createPolicy(l,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}},Zl=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Dc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zv();const e=Ee=>Dc(Ee);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==Za.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const i=r,s=i.currentScript,{DocumentFragment:l,HTMLTemplateElement:f,Node:d,Element:v,NodeFilter:p,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:w,DOMParser:b,trustedTypes:_}=t,L=v.prototype,q=Qa(L,"cloneNode"),E=Qa(L,"remove"),z=Qa(L,"nextSibling"),ee=Qa(L,"childNodes"),J=Qa(L,"parentNode");if(typeof f=="function"){const Ee=r.createElement("template");Ee.content&&Ee.content.ownerDocument&&(r=Ee.content.ownerDocument)}let K,$="";const{implementation:ue,createNodeIterator:Q,createDocumentFragment:me,getElementsByTagName:Re}=r,{importNode:De}=i;let fe=Zl();e.isSupported=typeof Pc=="function"&&typeof J=="function"&&ue&&ue.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:ae,TMPLIT_EXPR:le,DATA_ATTR:Z,ARIA_ATTR:ie,IS_SCRIPT_OR_DATA:we,ATTR_WHITESPACE:F,CUSTOM_ELEMENT:W}=Ql;let{IS_ALLOWED_URI:ve}=Ql,ke=null;const Le=Fe({},[...Yl,...Hs,...Ws,...Ys,...Vl]);let qe=null;const Ne=Fe({},[...$l,...Vs,...Xl,...Ki]);let Ae=Object.seal(ho(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),nt=null,Ie=null;const et=Object.seal(ho(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let vt=!0,ye=!0,Mt=!1,He=!0,nn=!1,ia=!0,Lt=!1,Pa=!1,Ra=!1,ir=!1,sa=!1,sr=!1,Vt=!0,Oa=!1;const Er="user-content-";let oa=!0,mn=!1,gt={},yt=null;const Ar=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let or=null;const la=Fe({},["audio","video","img","source","image","track"]);let lr=null;const Rn=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Kn="http://www.w3.org/1998/Math/MathML",ur="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Se=bt,Un=!1,yn=null;const ua=Fe({},[Kn,ur,bt],Us);let pe=Fe({},["mi","mo","mn","ms","mtext"]),cr=Fe({},["annotation-xml"]);const mi=Fe({},["title","style","font","a","script"]);let Gn=null;const yi=["application/xhtml+xml","text/html"],Da="text/html";let ft=null,fr=null;const dr=r.createElement("form"),Hn=function(S){return S instanceof RegExp||S instanceof Function},Ir=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fr&&fr===S)){if((!S||typeof S!="object")&&(S={}),S=Ln(S),Gn=yi.indexOf(S.PARSER_MEDIA_TYPE)===-1?Da:S.PARSER_MEDIA_TYPE,ft=Gn==="application/xhtml+xml"?Us:Xi,ke=xn(S,"ALLOWED_TAGS")?Fe({},S.ALLOWED_TAGS,ft):Le,qe=xn(S,"ALLOWED_ATTR")?Fe({},S.ALLOWED_ATTR,ft):Ne,yn=xn(S,"ALLOWED_NAMESPACES")?Fe({},S.ALLOWED_NAMESPACES,Us):ua,lr=xn(S,"ADD_URI_SAFE_ATTR")?Fe(Ln(Rn),S.ADD_URI_SAFE_ATTR,ft):Rn,or=xn(S,"ADD_DATA_URI_TAGS")?Fe(Ln(la),S.ADD_DATA_URI_TAGS,ft):la,yt=xn(S,"FORBID_CONTENTS")?Fe({},S.FORBID_CONTENTS,ft):Ar,nt=xn(S,"FORBID_TAGS")?Fe({},S.FORBID_TAGS,ft):Ln({}),Ie=xn(S,"FORBID_ATTR")?Fe({},S.FORBID_ATTR,ft):Ln({}),gt=xn(S,"USE_PROFILES")?S.USE_PROFILES:!1,vt=S.ALLOW_ARIA_ATTR!==!1,ye=S.ALLOW_DATA_ATTR!==!1,Mt=S.ALLOW_UNKNOWN_PROTOCOLS||!1,He=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,nn=S.SAFE_FOR_TEMPLATES||!1,ia=S.SAFE_FOR_XML!==!1,Lt=S.WHOLE_DOCUMENT||!1,ir=S.RETURN_DOM||!1,sa=S.RETURN_DOM_FRAGMENT||!1,sr=S.RETURN_TRUSTED_TYPE||!1,Ra=S.FORCE_BODY||!1,Vt=S.SANITIZE_DOM!==!1,Oa=S.SANITIZE_NAMED_PROPS||!1,oa=S.KEEP_CONTENT!==!1,mn=S.IN_PLACE||!1,ve=S.ALLOWED_URI_REGEXP||Rc,Se=S.NAMESPACE||bt,pe=S.MATHML_TEXT_INTEGRATION_POINTS||pe,cr=S.HTML_INTEGRATION_POINTS||cr,Ae=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&Hn(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ae.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&Hn(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ae.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ae.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),nn&&(ye=!1),sa&&(ir=!0),gt&&(ke=Fe({},Vl),qe=[],gt.html===!0&&(Fe(ke,Yl),Fe(qe,$l)),gt.svg===!0&&(Fe(ke,Hs),Fe(qe,Vs),Fe(qe,Ki)),gt.svgFilters===!0&&(Fe(ke,Ws),Fe(qe,Vs),Fe(qe,Ki)),gt.mathMl===!0&&(Fe(ke,Ys),Fe(qe,Xl),Fe(qe,Ki))),S.ADD_TAGS&&(typeof S.ADD_TAGS=="function"?et.tagCheck=S.ADD_TAGS:(ke===Le&&(ke=Ln(ke)),Fe(ke,S.ADD_TAGS,ft))),S.ADD_ATTR&&(typeof S.ADD_ATTR=="function"?et.attributeCheck=S.ADD_ATTR:(qe===Ne&&(qe=Ln(qe)),Fe(qe,S.ADD_ATTR,ft))),S.ADD_URI_SAFE_ATTR&&Fe(lr,S.ADD_URI_SAFE_ATTR,ft),S.FORBID_CONTENTS&&(yt===Ar&&(yt=Ln(yt)),Fe(yt,S.FORBID_CONTENTS,ft)),S.ADD_FORBID_CONTENTS&&(yt===Ar&&(yt=Ln(yt)),Fe(yt,S.ADD_FORBID_CONTENTS,ft)),oa&&(ke["#text"]=!0),Lt&&Fe(ke,["html","head","body"]),ke.table&&(Fe(ke,["tbody"]),delete nt.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');K=S.TRUSTED_TYPES_POLICY,$=K.createHTML("")}else K===void 0&&(K=Jv(_,s)),K!==null&&typeof $=="string"&&($=K.createHTML(""));jt&&jt(S),fr=S}},Cr=Fe({},[...Hs,...Ws,...Kv]),tt=Fe({},[...Ys,...Uv]),mt=function(S){let re=J(S);(!re||!re.tagName)&&(re={namespaceURI:Se,tagName:"template"});const ce=Xi(S.tagName),$e=Xi(re.tagName);return yn[S.namespaceURI]?S.namespaceURI===ur?re.namespaceURI===bt?ce==="svg":re.namespaceURI===Kn?ce==="svg"&&($e==="annotation-xml"||pe[$e]):!!Cr[ce]:S.namespaceURI===Kn?re.namespaceURI===bt?ce==="math":re.namespaceURI===ur?ce==="math"&&cr[$e]:!!tt[ce]:S.namespaceURI===bt?re.namespaceURI===ur&&!cr[$e]||re.namespaceURI===Kn&&!pe[$e]?!1:!tt[ce]&&(mi[ce]||!Cr[ce]):!!(Gn==="application/xhtml+xml"&&yn[S.namespaceURI]):!1},rn=function(S){Va(e.removed,{element:S});try{J(S).removeChild(S)}catch{E(S)}},an=function(S,re){try{Va(e.removed,{attribute:re.getAttributeNode(S),from:re})}catch{Va(e.removed,{attribute:null,from:re})}if(re.removeAttribute(S),S==="is")if(ir||sa)try{rn(re)}catch{}else try{re.setAttribute(S,"")}catch{}},Pr=function(S){let re=null,ce=null;if(Ra)S="<remove></remove>"+S;else{const st=Gs(S,/^[\r\n\t ]+/);ce=st&&st[0]}Gn==="application/xhtml+xml"&&Se===bt&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const $e=K?K.createHTML(S):S;if(Se===bt)try{re=new b().parseFromString($e,Gn)}catch{}if(!re||!re.documentElement){re=ue.createDocument(Se,"template",null);try{re.documentElement.innerHTML=Un?$:$e}catch{}}const rt=re.body||re.documentElement;return S&&ce&&rt.insertBefore(r.createTextNode(ce),rt.childNodes[0]||null),Se===bt?Re.call(re,Lt?"html":"body")[0]:Lt?re.documentElement:rt},Rr=function(S){return Q.call(S.ownerDocument||S,S,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},Ma=function(S){return S instanceof w&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof y)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},bn=function(S){return typeof d=="function"&&S instanceof d};function Ct(Ee,S,re){Fi(Ee,ce=>{ce.call(e,S,re,fr)})}const _n=function(S){let re=null;if(Ct(fe.beforeSanitizeElements,S,null),Ma(S))return rn(S),!0;const ce=ft(S.nodeName);if(Ct(fe.uponSanitizeElement,S,{tagName:ce,allowedTags:ke}),ia&&S.hasChildNodes()&&!bn(S.firstElementChild)&&Nt(/<[/\w!]/g,S.innerHTML)&&Nt(/<[/\w!]/g,S.textContent)||S.nodeType===Za.progressingInstruction||ia&&S.nodeType===Za.comment&&Nt(/<[/\w]/g,S.data))return rn(S),!0;if(!(et.tagCheck instanceof Function&&et.tagCheck(ce))&&(!ke[ce]||nt[ce])){if(!nt[ce]&&bi(ce)&&(Ae.tagNameCheck instanceof RegExp&&Nt(Ae.tagNameCheck,ce)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(ce)))return!1;if(oa&&!yt[ce]){const $e=J(S)||S.parentNode,rt=ee(S)||S.childNodes;if(rt&&$e){const st=rt.length;for(let dt=st-1;dt>=0;--dt){const zt=q(rt[dt],!0);zt.__removalCount=(S.__removalCount||0)+1,$e.insertBefore(zt,z(S))}}}return rn(S),!0}return S instanceof v&&!mt(S)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&Nt(/<\/no(script|embed|frames)/i,S.innerHTML)?(rn(S),!0):(nn&&S.nodeType===Za.text&&(re=S.textContent,Fi([X,ae,le],$e=>{re=$a(re,$e," ")}),S.textContent!==re&&(Va(e.removed,{element:S.cloneNode()}),S.textContent=re)),Ct(fe.afterSanitizeElements,S,null),!1)},Or=function(S,re,ce){if(Vt&&(re==="id"||re==="name")&&(ce in r||ce in dr))return!1;if(!(ye&&!Ie[re]&&Nt(Z,re))){if(!(vt&&Nt(ie,re))){if(!(et.attributeCheck instanceof Function&&et.attributeCheck(re,S))){if(!qe[re]||Ie[re]){if(!(bi(S)&&(Ae.tagNameCheck instanceof RegExp&&Nt(Ae.tagNameCheck,S)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(S))&&(Ae.attributeNameCheck instanceof RegExp&&Nt(Ae.attributeNameCheck,re)||Ae.attributeNameCheck instanceof Function&&Ae.attributeNameCheck(re,S))||re==="is"&&Ae.allowCustomizedBuiltInElements&&(Ae.tagNameCheck instanceof RegExp&&Nt(Ae.tagNameCheck,ce)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(ce))))return!1}else if(!lr[re]){if(!Nt(ve,$a(ce,F,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&S!=="script"&&jv(ce,"data:")===0&&or[S])){if(!(Mt&&!Nt(we,$a(ce,F,"")))){if(ce)return!1}}}}}}}return!0},bi=function(S){return S!=="annotation-xml"&&Gs(S,W)},wn=function(S){Ct(fe.beforeSanitizeAttributes,S,null);const{attributes:re}=S;if(!re||Ma(S))return;const ce={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:qe,forceKeepAttr:void 0};let $e=re.length;for(;$e--;){const rt=re[$e],{name:st,namespaceURI:dt,value:zt}=rt,On=ft(st),Dr=zt;let it=st==="value"?Dr:Bv(Dr);if(ce.attrName=On,ce.attrValue=it,ce.keepAttr=!0,ce.forceKeepAttr=void 0,Ct(fe.uponSanitizeAttribute,S,ce),it=ce.attrValue,Oa&&(On==="id"||On==="name")&&(an(st,S),it=Er+it),ia&&Nt(/((--!?|])>)|<\/(style|title|textarea)/i,it)){an(st,S);continue}if(On==="attributename"&&Gs(it,"href")){an(st,S);continue}if(ce.forceKeepAttr)continue;if(!ce.keepAttr){an(st,S);continue}if(!He&&Nt(/\/>/i,it)){an(st,S);continue}nn&&Fi([X,ae,le],Mr=>{it=$a(it,Mr," ")});const La=ft(S.nodeName);if(!Or(La,On,it)){an(st,S);continue}if(K&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!dt)switch(_.getAttributeType(La,On)){case"TrustedHTML":{it=K.createHTML(it);break}case"TrustedScriptURL":{it=K.createScriptURL(it);break}}if(it!==Dr)try{dt?S.setAttributeNS(dt,st,it):S.setAttribute(st,it),Ma(S)?rn(S):Wl(e.removed)}catch{an(st,S)}}Ct(fe.afterSanitizeAttributes,S,null)},_i=function Ee(S){let re=null;const ce=Rr(S);for(Ct(fe.beforeSanitizeShadowDOM,S,null);re=ce.nextNode();)Ct(fe.uponSanitizeShadowNode,re,null),_n(re),wn(re),re.content instanceof l&&Ee(re.content);Ct(fe.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(Ee){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,ce=null,$e=null,rt=null;if(Un=!Ee,Un&&(Ee="<!-->"),typeof Ee!="string"&&!bn(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw Xa("dirty is not a string, aborting")}else throw Xa("toString is not a function");if(!e.isSupported)return Ee;if(Pa||Ir(S),e.removed=[],typeof Ee=="string"&&(mn=!1),mn){if(Ee.nodeName){const zt=ft(Ee.nodeName);if(!ke[zt]||nt[zt])throw Xa("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof d)re=Pr("<!---->"),ce=re.ownerDocument.importNode(Ee,!0),ce.nodeType===Za.element&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?re=ce:re.appendChild(ce);else{if(!ir&&!nn&&!Lt&&Ee.indexOf("<")===-1)return K&&sr?K.createHTML(Ee):Ee;if(re=Pr(Ee),!re)return ir?null:sr?$:""}re&&Ra&&rn(re.firstChild);const st=Rr(mn?Ee:re);for(;$e=st.nextNode();)_n($e),wn($e),$e.content instanceof l&&_i($e.content);if(mn)return Ee;if(ir){if(sa)for(rt=me.call(re.ownerDocument);re.firstChild;)rt.appendChild(re.firstChild);else rt=re;return(qe.shadowroot||qe.shadowrootmode)&&(rt=De.call(i,rt,!0)),rt}let dt=Lt?re.outerHTML:re.innerHTML;return Lt&&ke["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&Nt(Oc,re.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+dt),nn&&Fi([X,ae,le],zt=>{dt=$a(dt,zt," ")}),K&&sr?K.createHTML(dt):dt},e.setConfig=function(){let Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ir(Ee),Pa=!0},e.clearConfig=function(){fr=null,Pa=!1},e.isValidAttribute=function(Ee,S,re){fr||Ir({});const ce=ft(Ee),$e=ft(S);return Or(ce,$e,re)},e.addHook=function(Ee,S){typeof S=="function"&&Va(fe[Ee],S)},e.removeHook=function(Ee,S){if(S!==void 0){const re=Nv(fe[Ee],S);return re===-1?void 0:qv(fe[Ee],re,1)[0]}return Wl(fe[Ee])},e.removeHooks=function(Ee){fe[Ee]=[]},e.removeAllHooks=function(){fe=Zl()},e}var eg=Dc();function tg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${Jl(t.from)} |`),e.push(`| **To** | ${Jl(t.to)} |`),e.push(`| **Date** | ${Oo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?ng(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function Jl(t){return(t||"").replace(/\|/g,"\\|")}function ng(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return go(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function rg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),i=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||i>0&&i<=3)return!0;const s=e.toLowerCase();return s.includes("spacer")||s.includes("transparent")||s.includes("transp.gif")||s.includes("/track")&&s.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(s)?!0:s.includes("mail.google.com/mail/u/")&&s.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(s)||s.endsWith(".gif")&&s.includes("1x1"))}function go(t){var s;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const l=t.getAttribute("src")||"",f=t.getAttribute("alt")||"";return rg(t,l)?"":`![${f}](${l})`}const r=Array.from(t.childNodes).map(go).join(""),i=r.trim();if(!i&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${i}

`;if(e==="blockquote")return`

> ${i.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const l=Number(e[1]);return`

${"#".repeat(l)} ${i}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((s=t.parentElement)==null?void 0:s.tagName.toLowerCase())==="ol"?"1.":"-"} ${i}
`;if(e==="a"){const l=t.getAttribute("href")||"";return!l||l.startsWith("mailto:")?i:i===l?l:`[${i}](${l})`}if(e==="strong"||e==="b")return`**${i}**`;if(e==="em"||e==="i")return`*${i}*`;if(e==="code")return`\`${i}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(f=>go(f).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const l=r.trim(),f=(l.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(f,1)).fill("---").join(" | ")+" |";return`${l}${d}
`}return r}function ag(t){const e=ig(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.md`}function ig(t){try{const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${r}-${i}-${s}`}catch{return"email"}}function eu(t,e,r="text/markdown;charset=utf-8"){const i=new Blob([t],{type:r}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}function sg(t){return t.raw||null}function og(t){const e=sg(t);return e?JSON.stringify(e,null,2):"null"}function lg(t){const e=ug(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.json`}function ug(t){try{const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${r}-${i}-${s}`}catch{return"email"}}var cg=V('<button title="View as Markdown">.md</button>'),fg=V('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),dg=V('<pre class="md-raw svelte-1b0rzpb"> </pre>'),hg=V('<div class="md-preview svelte-1b0rzpb"><!></div>'),pg=V('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),vg=V('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),gg=V('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),mg=V('<pre class="message-text svelte-1b0rzpb"> </pre>'),yg=V('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),bg=V('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),_g=V('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function wg(t,e){ut(e,!0);let r=Pe(e,"loading",3,!1);It(()=>tn("MessageModal"));const i=new Ze.Renderer;i.link=({href:X,title:ae,text:le})=>{const Z=ae?` title="${ae}"`:"";return`<a href="${X}"${Z} target="_blank" rel="noopener">${le}</a>`},Ze.setOptions({breaks:!0,gfm:!0,renderer:i});let s=Ce("email"),l=hn(()=>e.message.body?tg(e.message):""),f=hn(()=>og(e.message)),d=Ce("raw");function v(X){U(s,k(s)===X?"email":X,!0),X==="markdown"&&U(d,"raw")}function p(){eu(k(l),ag(e.message))}function y(){eu(k(f),lg(e.message),"application/json;charset=utf-8")}function w(X){const ae=Ze.parse(X);return eg.sanitize(ae,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let b=Ce(null);Zi(()=>{var X;if(k(b)&&e.message.htmlBody&&!r()&&k(s)==="email"){const ae=k(b).contentDocument||((X=k(b).contentWindow)==null?void 0:X.document);ae&&(ae.open(),ae.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ae.close())}});var _=_g();_.__click=function(...X){var ae;(ae=e.onclose)==null||ae.apply(this,X)};var L=T(_);L.__click=X=>X.stopPropagation();var q=T(L),E=T(q),z=T(E),ee=j(E,2),J=T(ee);let K;J.__click=()=>v("json");var $=j(J,2);{var ue=X=>{var ae=cg();let le;ae.__click=()=>v("markdown"),ge(()=>le=fn(ae,1,"action-btn svelte-1b0rzpb",null,le,{active:k(s)==="markdown"})),Y(X,ae)};Te($,X=>{e.message.body&&X(ue)})}var Q=j($,2);Q.__click=function(...X){var ae;(ae=e.onclose)==null||ae.apply(this,X)};var me=j(q,2);{var Re=X=>{var ae=fg(),le=Dt(ae),Z=j(T(le),2);Z.__click=y;var ie=j(le,2),we=T(ie),F=T(we);ge(()=>oe(F,k(f))),Y(X,ae)},De=X=>{var ae=pg(),le=Dt(ae),Z=T(le),ie=T(Z);let we;ie.__click=()=>U(d,"raw");var F=j(ie,2);let W;F.__click=()=>U(d,"preview");var ve=j(Z,2);ve.__click=p;var ke=j(le,2),Le=T(ke);{var qe=Ae=>{var nt=dg(),Ie=T(nt);ge(()=>oe(Ie,k(l))),Y(Ae,nt)},Ne=Ae=>{var nt=hg(),Ie=T(nt);Td(Ie,()=>w(k(l))),Y(Ae,nt)};Te(Le,Ae=>{k(d)==="raw"?Ae(qe):Ae(Ne,!1)})}ge(()=>{we=fn(ie,1,"md-tab svelte-1b0rzpb",null,we,{active:k(d)==="raw"}),W=fn(F,1,"md-tab svelte-1b0rzpb",null,W,{active:k(d)==="preview"})}),Y(X,ae)},fe=X=>{var ae=bg(),le=Dt(ae),Z=T(le),ie=j(T(Z),2),we=T(ie),F=j(Z,2),W=j(T(F),2),ve=T(W),ke=j(F,2),Le=j(T(ke),2),qe=T(Le),Ne=j(le,2),Ae=T(Ne);{var nt=ye=>{var Mt=vg();Y(ye,Mt)},Ie=ye=>{var Mt=gg();nc(Mt,He=>U(b,He),()=>k(b)),Y(ye,Mt)},et=ye=>{var Mt=mg(),He=T(Mt);ge(()=>oe(He,e.message.body)),Y(ye,Mt)},vt=ye=>{var Mt=yg();Y(ye,Mt)};Te(Ae,ye=>{r()?ye(nt):e.message.htmlBody?ye(Ie,1):e.message.body?ye(et,2):ye(vt,!1)})}ge(ye=>{oe(we,e.message.from),oe(ve,e.message.to),oe(qe,ye)},[()=>Oo(e.message.date)]),Y(X,ae)};Te(me,X=>{k(s)==="json"?X(Re):k(s)==="markdown"?X(De,1):X(fe,!1)})}ge(()=>{oe(z,e.message.subject),K=fn(J,1,"action-btn svelte-1b0rzpb",null,K,{active:k(s)==="json"})}),Y(t,_),ct()}Yt(["click"]);var kg=V('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),xg=V('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),Sg=V('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Tg=V("<p> </p>"),Eg=V('<p>No emails in local storage. Click "Sync New" to download.</p>'),Ag=V('<div class="empty-state svelte-6ts5xm"><!></div>'),Ig=V('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),Cg=V('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Pg(t,e){ut(e,!0),It(()=>tn("DashboardView"));let r=Pe(e,"error",3,null),i=Pe(e,"profile",3,null),s=Pe(e,"loadingProfile",3,!1),l=Pe(e,"emailMessages",19,()=>[]),f=Pe(e,"totalLocalMessages",3,0),d=Pe(e,"hasMoreLocal",3,!1),v=Pe(e,"loadingMessages",3,!1),p=Pe(e,"selectedMessage",3,null),y=Pe(e,"syncStatus",3,null),w=Pe(e,"syncProgress",3,null),b=Pe(e,"isSyncing",3,!1),_=Pe(e,"searchQuery",15);var L=Cg(),q=Dt(L),E=T(q);{var z=Z=>{vc(Z,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Te(E,Z=>{r()&&Z(z)})}var ee=j(E,2);Ap(ee,{get profile(){return i()},get loadingProfile(){return s()},get onsignout(){return e.onsignout}});var J=j(ee,2);zp(J,{get syncStatus(){return y()},get syncProgress(){return w()},get isSyncing(){return b()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var K=j(J,2),$=T(K);$.__keydown=Z=>Z.key==="Enter"&&e.onsearch();var ue=j($,2);ue.__click=function(...Z){var ie;(ie=e.onsearch)==null||ie.apply(this,Z)};var Q=T(ue),me=j(K,2);{var Re=Z=>{var ie=xg(),we=Dt(ie),F=T(we),W=T(F),ve=j(we,2);Up(ve,{get messages(){return l()},get onselect(){return e.onviewmessage}});var ke=j(ve,2);{var Le=qe=>{var Ne=kg(),Ae=T(Ne);Ae.__click=function(...Ie){var et;(et=e.onloadmore)==null||et.apply(this,Ie)};var nt=T(Ae);ge(()=>{Ae.disabled=v(),oe(nt,v()?"Loading...":"Load More")}),Y(qe,Ne)};Te(ke,qe=>{d()&&qe(Le)})}ge(qe=>oe(W,`Showing ${l().length??""} of ${qe??""}
        ${_()?" matching":""} emails`),[()=>f().toLocaleString()]),Y(Z,ie)},De=Z=>{var ie=Sg();Y(Z,ie)},fe=Z=>{var ie=Ag(),we=T(ie);{var F=ve=>{var ke=Tg(),Le=T(ke);ge(()=>oe(Le,`No emails match "${_()??""}".`)),Y(ve,ke)},W=ve=>{var ke=Eg();Y(ve,ke)};Te(we,ve=>{_()?ve(F):ve(W,!1)})}Y(Z,ie)},X=Z=>{var ie=Ig();Y(Z,ie)};Te(me,Z=>{var ie;l().length>0?Z(Re):v()?Z(De,1):(ie=y())!=null&&ie.synced?Z(fe,2):Z(X,!1)})}var ae=j(q,2);{var le=Z=>{wg(Z,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};Te(ae,Z=>{p()&&Z(le)})}ge(()=>{ue.disabled=v(),oe(Q,v()?"Searching...":"Search")}),Ro($,_),Y(t,L),ct()}Yt(["keydown","click"]);var Rg=V('<div class="dashboard svelte-1q5o2lv"><!></div>');function Og(t,e){ut(e,!0);function r(Ie){Ie.key==="Escape"&&k(v)&&we()}It(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let i=Ce(Ot(localStorage.getItem("googleClientId")||"")),s=Ce(Ot(localStorage.getItem("googleClientId")||"")),l=Ce(!1),f=Ce(null),d=Ce(null),v=Ce(null),p=Ce(""),y=Ce(Ot([])),w=Ce(0),b=Ce(0),_=Ce(!1),L=Ce(!1),q=Ce(!1),E=Ce(null),z=Ce(null),ee=Ce(null),J=Ce(!1);const K=50;Zi(()=>{k(f)&&(F(),ae())});let $=hn(()=>!k(i)),ue=hn(()=>!!k(f)),Q=hn(()=>k(y).length<k(w));Zi(()=>{k(i)&&!k(l)&&ql(k(i)).then(()=>{U(l,!0)}).catch(Ie=>{U(E,`Auth init failed: ${Ie.message}`)})});function me(){const Ie=k(s).trim();Ie&&(localStorage.setItem("googleClientId",Ie),U(i,Ie,!0),U(E,null))}function Re(){localStorage.removeItem("googleClientId"),U(i,""),U(s,""),U(l,!1),U(f,null),U(d,null),U(y,[],!0),U(w,0)}async function De(){U(E,null),U(L,!0);try{k(l)||(await ql(k(i)),U(l,!0));const Ie=await $h();U(f,Ie.access_token,!0),await X()}catch(Ie){U(E,Ie.message,!0)}finally{U(L,!1)}}async function fe(){if(k(f))try{await Xh(k(f))}catch{}U(f,null),U(d,null),U(y,[],!0),U(w,0),U(v,null),U(E,null)}async function X(){U(q,!0);try{const Ie=await oc(k(f));if(!k(f))return;U(d,Ie,!0)}catch(Ie){if(!k(f))return;U(E,`Profile fetch failed: ${Ie.message}`)}finally{U(q,!1)}}async function ae(Ie=!1){U(_,!0);try{const et=Ie?k(b):0,vt=await $d({query:k(p)||void 0,limit:K,offset:et});Ie?U(y,[...k(y),...vt.items],!0):U(y,vt.items,!0),U(w,vt.total,!0),U(b,k(y).length,!0)}catch(et){U(E,`Failed to load messages: ${et.message}`)}finally{U(_,!1)}}function le(){U(b,0),ae(!1)}function Z(){ae(!0)}function ie(Ie){U(v,Ie,!0)}function we(){U(v,null)}async function F(){try{U(z,await ip(),!0)}catch{}}async function W(Ie){if(k(J)||!k(f))return;U(E,null),U(J,!0),U(ee,null);const et=new AbortController;try{await rp(k(f),{limit:Ie,onProgress:vt=>{U(ee,{...vt},!0)},signal:et.signal}),await F(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(f))return;U(E,`Sync failed: ${vt.message}`)}}finally{U(J,!1)}}async function ve(Ie){if(k(J)||!k(f))return;U(E,null),U(J,!0),U(ee,null);const et=new AbortController;try{await ap(k(f),{limit:Ie,onProgress:vt=>{U(ee,{...vt},!0)},signal:et.signal}),await F(),await ae(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(f))return;U(E,`Sync more failed: ${vt.message}`)}}finally{U(J,!1)}}async function ke(){try{await sp(),await F(),U(y,[],!0),U(w,0),U(b,0)}catch(Ie){U(E,`Failed to clear data: ${Ie.message}`)}}var Le=Rg(),qe=T(Le);{var Ne=Ie=>{dp(Ie,{onsave:me,get clientIdInput(){return k(s)},set clientIdInput(et){U(s,et,!0)}})},Ae=Ie=>{xp(Ie,{get clientId(){return k(i)},get error(){return k(E)},get loadingAuth(){return k(L)},onsignin:De,onclear:Re,onsignout:fe})},nt=Ie=>{Pg(Ie,{get error(){return k(E)},get profile(){return k(d)},get loadingProfile(){return k(q)},get emailMessages(){return k(y)},get totalLocalMessages(){return k(w)},get hasMoreLocal(){return k(Q)},get loadingMessages(){return k(_)},get selectedMessage(){return k(v)},get syncStatus(){return k(z)},get syncProgress(){return k(ee)},get isSyncing(){return k(J)},onsignout:fe,onsearch:le,onloadmore:Z,onviewmessage:ie,onclosedetail:we,ondismisserror:()=>U(E,null),onsync:W,onsyncmore:ve,oncleardata:ke,get searchQuery(){return k(p)},set searchQuery(et){U(p,et,!0)}})};Te(qe,Ie=>{k($)?Ie(Ne):k(ue)?Ie(nt,!1):Ie(Ae,1)})}Y(t,Le),ct()}const Dg=20,Mg=`You are an email triage assistant. Analyze the email and decide if it requires action from the recipient.

Output ONLY a valid JSON array of action items â no markdown, no explanation, no extra text.
If no action is needed, output an empty array: []

Format:
[
  {
    "type": "todo",
    "title": "Short action title",
    "description": "Brief description of what needs to be done",
    "dueDate": "YYYY-MM-DD or null",
    "priority": "high"
  }
]

Rules:
- "type" must be one of: "todo", "calendar", "note"
- "priority" must be one of: "high", "medium", "low"
- "dueDate" should be a date string if mentioned, otherwise null
- Use "todo" for tasks requiring a response or action
- Use "calendar" for meetings, events, deadlines with specific dates/times
- Use "note" for important information to remember (shipping updates, policy changes, etc.)
- Output ONLY the JSON array, nothing else`;async function Lg(t,{count:e=Dg,onProgress:r=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");r({phase:"loading",message:"Loading recent emails..."});const i=await Me.items.where("[sourceType+date]").between(["gmail",Ht.minKey],["gmail",Ht.maxKey]).reverse().limit(e).toArray();if(i.length===0)return r({phase:"done",message:"No emails to scan."}),{scanned:0,actionsFound:0,errors:0};const s=Date.now();let l=0,f=0;for(let d=0;d<i.length;d++){const v=i[d];r({phase:"scanning",message:`Scanning email ${d+1} of ${i.length}...`,current:d+1,total:i.length,actionsFound:l});try{const p=Bg(v),y=[{role:"system",content:Mg},{role:"user",content:p}],w=await t.generateFull(y),b=Fg(w),_=Kg(b,v,s);_.length>0&&(await Me.actionItems.bulkAdd(_),l+=_.length)}catch(p){console.error(`Triage email ${d+1} failed:`,p),f++}}return r({phase:"done",message:`Scanned ${i.length} emails, found ${l} actions.`,actionsFound:l}),{scanned:i.length,actionsFound:l,errors:f}}async function Ng({type:t,status:e}={}){let r;return t&&e?r=Me.actionItems.where("[type+status]").equals([t,e]):t?r=Me.actionItems.where("type").equals(t):e?r=Me.actionItems.where("status").equals(e):r=Me.actionItems.toCollection(),r.reverse().sortBy("createdAt")}async function tu(t,e){await Me.actionItems.update(t,{status:e})}async function qg(){await Me.actionItems.clear()}async function jg(){const t=await Me.actionItems.toArray(),e={total:t.length,todo:0,calendar:0,note:0,new:0,done:0,dismissed:0};for(const r of t)r.type in e&&e[r.type]++,r.status in e&&e[r.status]++;return e}function Bg(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=zg(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function zg(t,e){return!t||t.length<=e?t:t.slice(0,e)+"..."}function Fg(t){if(!t||!t.trim())return[];let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("["),i=e.lastIndexOf("]");if(r===-1||i===-1||i<=r)return console.warn("Triage: no JSON array found in response"),[];const s=e.slice(r,i+1);try{const l=JSON.parse(s);return Array.isArray(l)?l:[]}catch(l){return console.warn("Triage: failed to parse JSON response:",l.message),[]}}function Kg(t,e,r){const i=[];if(!Array.isArray(t))return i;for(const s of t){if(!s.type||!s.title)continue;const l=["todo","calendar","note"].includes(s.type)?s.type:"note",f=["high","medium","low"].includes(s.priority)?s.priority:"medium";let d=null;if(s.dueDate&&s.dueDate!=="null")try{d=new Date(s.dueDate).getTime(),isNaN(d)&&(d=null)}catch{d=null}i.push({type:l,status:"new",title:String(s.title).slice(0,200),description:String(s.description||"").slice(0,500),sourceItemId:e.id,sourceSubject:e.subject||"(no subject)",priority:f,dueDate:d,createdAt:r,scannedAt:r})}return i}var Ug=V('<span class="spinner svelte-ois7em"></span>'),Gg=Co('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),Hg=V('<option class="svelte-ois7em"> </option>'),Wg=V('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),Yg=V('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),Vg=V('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <button class="btn scan-btn primary svelte-ois7em"> </button></div> <!> <!></div>');function $g(t,e){ut(e,!0);let r=Pe(e,"engineStatus",3,"idle"),i=Pe(e,"modelName",3,""),s=Pe(e,"isScanning",3,!1),l=Pe(e,"scanProgress",3,null),f=Pe(e,"scanCount",15,20);const d=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}];function v(){return r()==="ready"?`${i()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function p(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function y(){return r()==="ready"&&!s()}var w=Vg(),b=T(w),_=T(b),L=T(_);{var q=Z=>{var ie=Ug();Y(Z,ie)},E=Z=>{var ie=Gg();Y(Z,ie)};Te(L,Z=>{s()?Z(q):Z(E,!1)})}var z=j(_,2),ee=j(T(z),2),J=T(ee);let K;var $=j(J),ue=j(b,2),Q=T(ue),me=j(T(Q),2);ar(me,21,()=>d,Tr,(Z,ie)=>{var we=Hg(),F=T(we),W={};ge(()=>{oe(F,k(ie).label),W!==(W=k(ie).value)&&(we.value=(we.__value=k(ie).value)??"")}),Y(Z,we)});var Re=j(Q,2);Re.__click=function(...Z){var ie;(ie=e.onscan)==null||ie.apply(this,Z)};var De=T(Re),fe=j(ue,2);{var X=Z=>{var ie=Wg();Y(Z,ie)};Te(fe,Z=>{r()!=="ready"&&r()!=="loading"&&Z(X)})}var ae=j(fe,2);{var le=Z=>{var ie=Yg(),we=T(ie),F=T(we);let W,ve;var ke=j(we,2),Le=T(ke);ge(()=>{W=fn(F,1,"progress-fill svelte-ois7em",null,W,{indeterminate:!l().total}),ve=tr(F,"",ve,{width:`${l().total?l().current/l().total*100:0}%`}),oe(Le,l().message||"Scanning...")}),Y(Z,ie)};Te(ae,Z=>{s()&&l()&&Z(le)})}ge((Z,ie,we)=>{K=tr(J,"",K,Z),oe($,` ${ie??""}`),me.disabled=s(),Re.disabled=we,oe(De,s()?"Scanning...":"Scan Emails")},[()=>({background:p()}),v,()=>!y()]),Po(me,f),Y(t,w),ct()}Yt(["click"]);var Xg=V('<span class="filter-count svelte-xjm8a5"> </span>'),Qg=V("<button> <!></button>"),Zg=V('<div class="filter-bar svelte-xjm8a5"></div>');function Jg(t,e){ut(e,!0);let r=Pe(e,"filter",3,"all"),i=Pe(e,"counts",19,()=>({}));const s=[{id:"all",label:"All",countKey:"total"},{id:"todo",label:"Todos",countKey:"todo"},{id:"calendar",label:"Calendar",countKey:"calendar"},{id:"note",label:"Notes",countKey:"note"}];var l=Zg();ar(l,21,()=>s,Tr,(f,d)=>{var v=Qg();let p;v.__click=()=>e.onsetfilter(k(d).id);var y=T(v),w=j(y);{var b=_=>{var L=Xg(),q=T(L);ge(()=>oe(q,i()[k(d).countKey])),Y(_,L)};Te(w,_=>{i()[k(d).countKey]&&_(b)})}ge(()=>{p=fn(v,1,"filter-btn svelte-xjm8a5",null,p,{active:r()===k(d).id}),oe(y,`${k(d).label??""} `)}),Y(f,v)}),Y(t,l),ct()}Yt(["click"]);var em=V('<span class="due-date svelte-1yo5avs"> </span>'),tm=V('<button class="icon-btn done-btn svelte-1yo5avs" title="Mark done"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1yo5avs" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),nm=V('<span class="status-label svelte-1yo5avs"> </span>'),rm=V('<p class="card-desc svelte-1yo5avs"> </p>'),am=V('<div><div class="card-header svelte-1yo5avs"><span class="type-badge svelte-1yo5avs"> </span> <span class="priority-badge svelte-1yo5avs"> </span> <!> <span class="spacer svelte-1yo5avs"></span> <!></div> <div class="card-body svelte-1yo5avs"><p class="card-title svelte-1yo5avs"> </p> <!></div> <div class="card-source svelte-1yo5avs"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg> <span class="source-subject svelte-1yo5avs"> </span></div></div>');function im(t,e){ut(e,!0);const r={todo:{label:"TODO",color:"#3b82f6"},calendar:{label:"CALENDAR",color:"#a78bfa"},note:{label:"NOTE",color:"#34d399"}},i={high:{label:"high",color:"#f87171"},medium:{label:"med",color:"#fbbf24"},low:{label:"low",color:"#666"}};function s(le){if(!le)return"";try{return new Date(le).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let l=hn(()=>r[e.item.type]||r.note),f=hn(()=>i[e.item.priority]||i.medium),d=hn(()=>e.item.status==="done"||e.item.status==="dismissed");var v=am();let p;var y=T(v),w=T(y);let b;var _=T(w),L=j(w,2);let q;var E=T(L),z=j(L,2);{var ee=le=>{var Z=em(),ie=T(Z);ge(we=>oe(ie,we),[()=>s(e.item.dueDate)]),Y(le,Z)};Te(z,le=>{e.item.dueDate&&le(ee)})}var J=j(z,4);{var K=le=>{var Z=tm(),ie=Dt(Z);ie.__click=()=>e.onmarkdone(e.item.id);var we=j(ie,2);we.__click=()=>e.ondismiss(e.item.id),Y(le,Z)},$=le=>{var Z=nm(),ie=T(Z);ge(()=>oe(ie,e.item.status)),Y(le,Z)};Te(J,le=>{k(d)?le($,!1):le(K)})}var ue=j(y,2),Q=T(ue),me=T(Q),Re=j(Q,2);{var De=le=>{var Z=rm(),ie=T(Z);ge(()=>oe(ie,e.item.description)),Y(le,Z)};Te(Re,le=>{e.item.description&&le(De)})}var fe=j(ue,2),X=j(T(fe),2),ae=T(X);ge(()=>{p=fn(v,1,"action-card svelte-1yo5avs",null,p,{done:k(d)}),b=tr(w,"",b,{background:k(l).color}),oe(_,k(l).label),q=tr(L,"",q,{color:k(f).color}),oe(E,k(f).label),oe(me,e.item.title),oe(ae,e.item.sourceSubject)}),Y(t,v),ct()}Yt(["click"]);var sm=V('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),om=V('<div class="empty-filter svelte-12gkq0i"> </div>'),lm=V('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),um=V('<span class="clear-confirm svelte-12gkq0i">Delete all items? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),cm=V('<!> <div class="actions-list svelte-12gkq0i"><!> <!></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),fm=V('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No actions scanned yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan Emails</strong> to analyze your recent emails and extract actionable items like todos, calendar events, and notes.</p></div>'),dm=V('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function hm(t,e){ut(e,!0);let r=Pe(e,"items",19,()=>[]),i=Pe(e,"counts",19,()=>({})),s=Pe(e,"filter",3,"all"),l=Pe(e,"isScanning",3,!1),f=Pe(e,"scanProgress",3,null),d=Pe(e,"scanCount",15,20),v=Pe(e,"error",3,null),p=Ce(!1);var y=dm(),w=T(y);$g(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return l()},get scanProgress(){return f()},get onscan(){return e.onscan},get scanCount(){return d()},set scanCount(z){d(z)}});var b=j(w,2);{var _=z=>{var ee=sm(),J=T(ee),K=T(J),$=j(J,2);$.__click=function(...ue){var Q;(Q=e.ondismisserror)==null||Q.apply(this,ue)},ge(()=>oe(K,v())),Y(z,ee)};Te(b,z=>{v()&&z(_)})}var L=j(b,2);{var q=z=>{var ee=cm(),J=Dt(ee);Jg(J,{get filter(){return s()},get counts(){return i()},get onsetfilter(){return e.onsetfilter}});var K=j(J,2),$=T(K);ar($,17,r,le=>le.id,(le,Z)=>{im(le,{get item(){return k(Z)},get onmarkdone(){return e.onmarkdone},get ondismiss(){return e.ondismiss}})});var ue=j($,2);{var Q=le=>{var Z=om(),ie=T(Z);ge(()=>oe(ie,`No ${(s()==="all"?"":s())??""} items found.`)),Y(le,Z)};Te(ue,le=>{r().length===0&&le(Q)})}var me=j(K,2),Re=T(me),De=T(Re),fe=j(Re,2);{var X=le=>{var Z=lm();Z.__click=()=>U(p,!0),Y(le,Z)},ae=le=>{var Z=um(),ie=j(T(Z));ie.__click=()=>U(p,!1);var we=j(ie,2);we.__click=()=>{e.onclear(),U(p,!1)},Y(le,Z)};Te(fe,le=>{k(p)?le(ae,!1):le(X)})}ge(()=>oe(De,`${i().total??""} total Â· ${i().new??""} active Â· ${i().done??""} done Â· ${i().dismissed??""} dismissed`)),Y(z,ee)},E=z=>{var ee=fm();Y(z,ee)};Te(L,z=>{i().total>0?z(q):l()||z(E,1)})}Y(t,y),ct()}Yt(["click"]);var pm=V('<div class="actions-page svelte-3tch4q"><!></div>');function vm(t,e){ut(e,!0);const r=rc();let i=Ce(Ot(r.status)),s=Ce(""),l=Ce(Ot([])),f=Ce(Ot({total:0,todo:0,calendar:0,note:0,new:0,done:0,dismissed:0})),d=Ce("all"),v=Ce(!1),p=Ce(null),y=Ce(20),w=Ce(null);It(()=>{const K=r.onMessage($=>{if($.status==="ready"){U(i,"ready");const ue=oi.find(Q=>Q.id===r.modelId);U(s,(ue==null?void 0:ue.name)||r.modelId||"",!0)}$.status==="loading"&&U(i,"loading")});if(U(i,r.status,!0),r.modelId){const $=oi.find(ue=>ue.id===r.modelId);U(s,($==null?void 0:$.name)||r.modelId||"",!0)}return b(),()=>K()});async function b(){try{const K=k(d)==="all"?void 0:k(d);U(l,await Ng({type:K}),!0),U(f,await jg(),!0)}catch(K){U(w,`Failed to load items: ${K.message}`)}}async function _(){if(!(k(v)||!r.isReady)){U(w,null),U(v,!0),U(p,null);try{await Lg(r,{count:k(y),onProgress:K=>{U(p,{...K},!0)}}),await b()}catch(K){U(w,`Scan failed: ${K.message}`)}finally{U(v,!1)}}}async function L(K){await tu(K,"done"),await b()}async function q(K){await tu(K,"dismissed"),await b()}async function E(){await qg(),await b()}function z(K){U(d,K,!0),b()}var ee=pm(),J=T(ee);hm(J,{get engineStatus(){return k(i)},get modelName(){return k(s)},get items(){return k(l)},get counts(){return k(f)},get filter(){return k(d)},get isScanning(){return k(v)},get scanProgress(){return k(p)},get error(){return k(w)},onscan:_,onsetfilter:z,onmarkdone:L,ondismiss:q,onclear:E,ondismisserror:()=>U(w,null),get scanCount(){return k(y)},set scanCount(K){U(y,K,!0)}}),Y(t,ee),ct()}var gm=V('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function mm(t,e){ut(e,!0);function r(){const Q=location.hash;return Q==="#dashboard"?"dashboard":Q==="#actions"?"actions":"chat"}let i=Ce(Ot(r()));It(()=>{function Q(){U(i,r(),!0)}return window.addEventListener("hashchange",Q),()=>window.removeEventListener("hashchange",Q)});var s=gm(),l=T(s),f=j(T(l),2),d=T(f);let v;var p=j(d,2);let y;var w=j(p,2);let b;var _=j(l,2),L=T(_);let q;var E=T(L);Wh(E,{});var z=j(L,2);let ee;var J=T(z);vm(J,{});var K=j(z,2);let $;var ue=T(K);Og(ue,{}),ge(()=>{v=fn(d,1,"svelte-1n46o8q",null,v,{active:k(i)==="chat"}),y=fn(p,1,"svelte-1n46o8q",null,y,{active:k(i)==="actions"}),b=fn(w,1,"svelte-1n46o8q",null,b,{active:k(i)==="dashboard"}),q=tr(L,"",q,{display:k(i)==="chat"?"flex":"none"}),ee=tr(z,"",ee,{display:k(i)==="actions"?"flex":"none"}),$=tr(K,"",$,{display:k(i)==="dashboard"?"flex":"none"})}),Y(t,s),ct()}yd(mm,{target:document.getElementById("app")});
