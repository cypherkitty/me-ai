var tf=Object.defineProperty;var gl=t=>{throw TypeError(t)};var nf=(t,e,r)=>e in t?tf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ke=(t,e,r)=>nf(t,typeof e!="symbol"?e+"":e,r),Ni=(t,e,r)=>e.has(t)||gl("Cannot "+r);var G=(t,e,r)=>(Ni(t,e,"read from private field"),r?r.call(t):e.get(t)),Ue=(t,e,r)=>e.has(t)?gl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ze=(t,e,r,s)=>(Ni(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),Dt=(t,e,r)=>(Ni(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();const Xi=!1;var yo=Array.isArray,rf=Array.prototype.indexOf,xa=Array.prototype.includes,si=Array.from,af=Object.defineProperty,va=Object.getOwnPropertyDescriptor,sf=Object.getOwnPropertyDescriptors,of=Object.prototype,lf=Array.prototype,iu=Object.getPrototypeOf,ml=Object.isExtensible;const uf=()=>{};function cf(t){for(var e=0;e<t.length;e++)t[e]()}function ou(){var t,e,r=new Promise((s,i)=>{t=s,e=i});return{promise:r,resolve:t,reject:e}}const Ct=2,ss=4,ii=8,lu=1<<24,rr=16,On=32,ra=64,uu=128,pn=512,wt=1024,It=2048,Rn=4096,en=8192,tr=16384,ds=32768,Sa=65536,yl=1<<17,cu=1<<18,Ia=1<<19,ff=1<<20,er=1<<25,$r=65536,Qi=1<<21,bo=1<<22,_r=1<<23,Xr=Symbol("$state"),df=Symbol("legacy props"),pf=Symbol(""),zr=new class extends Error{constructor(){super(...arguments);Ke(this,"name","StaleReactionError");Ke(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function hf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function vf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function gf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function mf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function yf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function bf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function _f(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function kf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function xf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Sf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Tf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ef=1,Af=2,fu=4,Cf=8,If=16,Rf=1,Pf=4,Of=8,Df=16,du=1,Mf=2,xt=Symbol(),pu="http://www.w3.org/1999/xhtml";function Lf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Nf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function hu(t){return t===this.v}function qf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function vu(t){return!qf(t,this.v)}let jf=!1,tn=null;function Ta(t){tn=t}function ut(t,e=!1,r){tn={p:tn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ct(t){var e=tn,r=e.e;if(r!==null){e.e=null;for(var s of r)qu(s)}return e.i=!0,tn=e.p,{}}function gu(){return!0}let Fr=[];function mu(){var t=Fr;Fr=[],cf(t)}function wr(t){if(Fr.length===0&&!ts){var e=Fr;queueMicrotask(()=>{e===Fr&&mu()})}Fr.push(t)}function Bf(){for(;Fr.length>0;)mu()}function yu(t){var e=et;if(e===null)return Ge.f|=_r,t;if((e.f&ds)===0&&(e.f&ss)===0)throw t;Ea(t,e)}function Ea(t,e){for(;e!==null;){if((e.f&uu)!==0){if((e.f&ds)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const zf=-7169;function ht(t,e){t.f=t.f&zf|e}function _o(t){(t.f&pn)!==0||t.deps===null?ht(t,wt):ht(t,Rn)}function bu(t){if(t!==null)for(const e of t)(e.f&Ct)===0||(e.f&$r)===0||(e.f^=$r,bu(e.deps))}function _u(t,e,r){(t.f&It)!==0?e.add(t):(t.f&Rn)!==0&&r.add(t),bu(t.deps),ht(t,wt)}const Ns=new Set;let je=null,Zs=null,St=null,Gt=[],oi=null,Zi=!1,ts=!1;var ga,ma,Ur,ya,ls,us,Gr,Qn,ba,Un,$i,Ji,wu;const Ko=class Ko{constructor(){Ue(this,Un);Ke(this,"committed",!1);Ke(this,"current",new Map);Ke(this,"previous",new Map);Ue(this,ga,new Set);Ue(this,ma,new Set);Ue(this,Ur,0);Ue(this,ya,0);Ue(this,ls,null);Ue(this,us,new Set);Ue(this,Gr,new Set);Ue(this,Qn,new Map);Ke(this,"is_fork",!1);Ue(this,ba,!1)}is_deferred(){return this.is_fork||G(this,ya)>0}skip_effect(e){G(this,Qn).has(e)||G(this,Qn).set(e,{d:[],m:[]})}unskip_effect(e){var r=G(this,Qn).get(e);if(r){G(this,Qn).delete(e);for(var s of r.d)ht(s,It),An(s);for(s of r.m)ht(s,Rn),An(s)}}process(e){var i;Gt=[],this.apply();var r=[],s=[];for(const l of e)Dt(this,Un,$i).call(this,l,r,s);if(this.is_deferred()){Dt(this,Un,Ji).call(this,s),Dt(this,Un,Ji).call(this,r);for(const[l,c]of G(this,Qn))Tu(l,c)}else{for(const l of G(this,ga))l();G(this,ga).clear(),G(this,Ur)===0&&Dt(this,Un,wu).call(this),Zs=this,je=null,bl(s),bl(r),Zs=null,(i=G(this,ls))==null||i.resolve()}St=null}capture(e,r){r!==xt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&_r)===0&&(this.current.set(e,e.v),St==null||St.set(e,e.v))}activate(){je=this,this.apply()}deactivate(){je===this&&(je=null,St=null)}flush(){if(this.activate(),Gt.length>0){if(ku(),je!==null&&je!==this)return}else G(this,Ur)===0&&this.process([]);this.deactivate()}discard(){for(const e of G(this,ma))e(this);G(this,ma).clear()}increment(e){ze(this,Ur,G(this,Ur)+1),e&&ze(this,ya,G(this,ya)+1)}decrement(e){ze(this,Ur,G(this,Ur)-1),e&&ze(this,ya,G(this,ya)-1),!G(this,ba)&&(ze(this,ba,!0),wr(()=>{ze(this,ba,!1),this.is_deferred()?Gt.length>0&&this.flush():this.revive()}))}revive(){for(const e of G(this,us))G(this,Gr).delete(e),ht(e,It),An(e);for(const e of G(this,Gr))ht(e,Rn),An(e);this.flush()}oncommit(e){G(this,ga).add(e)}ondiscard(e){G(this,ma).add(e)}settled(){return(G(this,ls)??ze(this,ls,ou())).promise}static ensure(){if(je===null){const e=je=new Ko;Ns.add(je),ts||wr(()=>{je===e&&e.flush()})}return je}apply(){}};ga=new WeakMap,ma=new WeakMap,Ur=new WeakMap,ya=new WeakMap,ls=new WeakMap,us=new WeakMap,Gr=new WeakMap,Qn=new WeakMap,ba=new WeakMap,Un=new WeakSet,$i=function(e,r,s){e.f^=wt;for(var i=e.first,l=null;i!==null;){var c=i.f,d=(c&(On|ra))!==0,v=d&&(c&wt)!==0,h=v||(c&en)!==0||G(this,Qn).has(i);if(!h&&i.fn!==null){d?i.f^=wt:l!==null&&(c&(ss|ii|lu))!==0?l.b.defer_effect(i):(c&ss)!==0?r.push(i):hs(i)&&((c&rr)!==0&&G(this,Gr).add(i),Ca(i));var y=i.first;if(y!==null){i=y;continue}}var _=i.parent;for(i=i.next;i===null&&_!==null;)_===l&&(l=null),i=_.next,_=_.parent}},Ji=function(e){for(var r=0;r<e.length;r+=1)_u(e[r],G(this,us),G(this,Gr))},wu=function(){var i;if(Ns.size>1){this.previous.clear();var e=St,r=!0;for(const l of Ns){if(l===this){r=!1;continue}const c=[];for(const[v,h]of this.current){if(l.current.has(v))if(r&&h!==l.current.get(v))l.current.set(v,h);else continue;c.push(v)}if(c.length===0)continue;const d=[...l.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var s=Gt;Gt=[];const v=new Set,h=new Map;for(const y of c)xu(y,d,v,h);if(Gt.length>0){je=l,l.apply();for(const y of Gt)Dt(i=l,Un,$i).call(i,y,[],[]);l.deactivate()}Gt=s}}je=null,St=e}this.committed=!0,Ns.delete(this)};let kr=Ko;function Ff(t){var e=ts;ts=!0;try{for(var r;;){if(Bf(),Gt.length===0&&(je==null||je.flush(),Gt.length===0))return oi=null,r;ku()}}finally{ts=e}}function ku(){Zi=!0;var t=null;try{for(var e=0;Gt.length>0;){var r=kr.ensure();if(e++>1e3){var s,i;Kf()}r.process(Gt),xr.clear()}}finally{Gt=[],Zi=!1,oi=null}}function Kf(){try{_f()}catch(t){Ea(t,oi)}}let kn=null;function bl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var s=t[r++];if((s.f&(tr|en))===0&&hs(s)&&(kn=new Set,Ca(s),s.deps===null&&s.first===null&&s.nodes===null&&s.teardown===null&&s.ac===null&&Fu(s),(kn==null?void 0:kn.size)>0)){xr.clear();for(const i of kn){if((i.f&(tr|en))!==0)continue;const l=[i];let c=i.parent;for(;c!==null;)kn.has(c)&&(kn.delete(c),l.push(c)),c=c.parent;for(let d=l.length-1;d>=0;d--){const v=l[d];(v.f&(tr|en))===0&&Ca(v)}}kn.clear()}}kn=null}}function xu(t,e,r,s){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const l=i.f;(l&Ct)!==0?xu(i,e,r,s):(l&(bo|rr))!==0&&(l&It)===0&&Su(i,e,s)&&(ht(i,It),An(i))}}function Su(t,e,r){const s=r.get(t);if(s!==void 0)return s;if(t.deps!==null)for(const i of t.deps){if(xa.call(e,i))return!0;if((i.f&Ct)!==0&&Su(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function An(t){for(var e=oi=t;e.parent!==null;){e=e.parent;var r=e.f;if(Zi&&e===et&&(r&rr)!==0&&(r&cu)===0)return;if((r&(ra|On))!==0){if((r&wt)===0)return;e.f^=wt}}Gt.push(e)}function Tu(t,e){if(!((t.f&On)!==0&&(t.f&wt)!==0)){(t.f&It)!==0?e.d.push(t):(t.f&Rn)!==0&&e.m.push(t),ht(t,wt);for(var r=t.first;r!==null;)Tu(r,e),r=r.next}}function Uf(t){let e=0,r=Jr(0),s;return()=>{xo()&&(k(r),So(()=>(e===0&&(s=vs(()=>t(()=>ns(r)))),e+=1,()=>{wr(()=>{e-=1,e===0&&(s==null||s(),s=void 0,ns(r))})})))}}var Gf=Sa|Ia|uu;function Hf(t,e,r){new Wf(t,e,r)}var un,mo,jn,Hr,Bn,cn,Kt,zn,Zn,yr,Wr,br,_a,Yr,wa,ka,$n,ri,kt,Yf,Vf,eo,Gs,Hs,to;class Wf{constructor(e,r,s){Ue(this,kt);Ke(this,"parent");Ke(this,"is_pending",!1);Ue(this,un);Ue(this,mo,null);Ue(this,jn);Ue(this,Hr);Ue(this,Bn);Ue(this,cn,null);Ue(this,Kt,null);Ue(this,zn,null);Ue(this,Zn,null);Ue(this,yr,null);Ue(this,Wr,0);Ue(this,br,0);Ue(this,_a,!1);Ue(this,Yr,!1);Ue(this,wa,new Set);Ue(this,ka,new Set);Ue(this,$n,null);Ue(this,ri,Uf(()=>(ze(this,$n,Jr(G(this,Wr))),()=>{ze(this,$n,null)})));ze(this,un,e),ze(this,jn,r),ze(this,Hr,s),this.parent=et.b,this.is_pending=!!G(this,jn).pending,ze(this,Bn,To(()=>{et.b=this;{var i=Dt(this,kt,eo).call(this);try{ze(this,cn,fn(()=>s(i)))}catch(l){this.error(l)}G(this,br)>0?Dt(this,kt,Hs).call(this):this.is_pending=!1}return()=>{var l;(l=G(this,yr))==null||l.remove()}},Gf))}defer_effect(e){_u(e,G(this,wa),G(this,ka))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!G(this,jn).pending}update_pending_count(e){Dt(this,kt,to).call(this,e),ze(this,Wr,G(this,Wr)+e),!(!G(this,$n)||G(this,_a))&&(ze(this,_a,!0),wr(()=>{ze(this,_a,!1),G(this,$n)&&Aa(G(this,$n),G(this,Wr))}))}get_effect_pending(){return G(this,ri).call(this),k(G(this,$n))}error(e){var r=G(this,jn).onerror;let s=G(this,jn).failed;if(G(this,Yr)||!r&&!s)throw e;G(this,cn)&&(Yt(G(this,cn)),ze(this,cn,null)),G(this,Kt)&&(Yt(G(this,Kt)),ze(this,Kt,null)),G(this,zn)&&(Yt(G(this,zn)),ze(this,zn,null));var i=!1,l=!1;const c=()=>{if(i){Nf();return}i=!0,l&&Tf(),kr.ensure(),ze(this,Wr,0),G(this,zn)!==null&&Qr(G(this,zn),()=>{ze(this,zn,null)}),this.is_pending=this.has_pending_snippet(),ze(this,cn,Dt(this,kt,Gs).call(this,()=>(ze(this,Yr,!1),fn(()=>G(this,Hr).call(this,G(this,un)))))),G(this,br)>0?Dt(this,kt,Hs).call(this):this.is_pending=!1};wr(()=>{try{l=!0,r==null||r(e,c),l=!1}catch(d){Ea(d,G(this,Bn)&&G(this,Bn).parent)}s&&ze(this,zn,Dt(this,kt,Gs).call(this,()=>{kr.ensure(),ze(this,Yr,!0);try{return fn(()=>{s(G(this,un),()=>e,()=>c)})}catch(d){return Ea(d,G(this,Bn).parent),null}finally{ze(this,Yr,!1)}}))})}}un=new WeakMap,mo=new WeakMap,jn=new WeakMap,Hr=new WeakMap,Bn=new WeakMap,cn=new WeakMap,Kt=new WeakMap,zn=new WeakMap,Zn=new WeakMap,yr=new WeakMap,Wr=new WeakMap,br=new WeakMap,_a=new WeakMap,Yr=new WeakMap,wa=new WeakMap,ka=new WeakMap,$n=new WeakMap,ri=new WeakMap,kt=new WeakSet,Yf=function(){try{ze(this,cn,fn(()=>G(this,Hr).call(this,G(this,un))))}catch(e){this.error(e)}},Vf=function(){const e=G(this,jn).pending;e&&(ze(this,Kt,fn(()=>e(G(this,un)))),wr(()=>{var r=Dt(this,kt,eo).call(this);ze(this,cn,Dt(this,kt,Gs).call(this,()=>(kr.ensure(),fn(()=>G(this,Hr).call(this,r))))),G(this,br)>0?Dt(this,kt,Hs).call(this):(Qr(G(this,Kt),()=>{ze(this,Kt,null)}),this.is_pending=!1)}))},eo=function(){var e=G(this,un);return this.is_pending&&(ze(this,yr,nr()),G(this,un).before(G(this,yr)),e=G(this,yr)),e},Gs=function(e){var r=et,s=Ge,i=tn;Kn(G(this,Bn)),vn(G(this,Bn)),Ta(G(this,Bn).ctx);try{return e()}catch(l){return yu(l),null}finally{Kn(r),vn(s),Ta(i)}},Hs=function(){const e=G(this,jn).pending;G(this,cn)!==null&&(ze(this,Zn,document.createDocumentFragment()),G(this,Zn).append(G(this,yr)),Gu(G(this,cn),G(this,Zn))),G(this,Kt)===null&&ze(this,Kt,fn(()=>e(G(this,un))))},to=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Dt(r=this.parent,kt,to).call(r,e);return}if(ze(this,br,G(this,br)+e),G(this,br)===0){this.is_pending=!1;for(const s of G(this,wa))ht(s,It),An(s);for(const s of G(this,ka))ht(s,Rn),An(s);G(this,wa).clear(),G(this,ka).clear(),G(this,Kt)&&Qr(G(this,Kt),()=>{ze(this,Kt,null)}),G(this,Zn)&&(G(this,un).before(G(this,Zn)),ze(this,Zn,null))}};function Xf(t,e,r,s){const i=li;var l=t.filter(b=>!b.settled);if(r.length===0&&l.length===0){s(e.map(i));return}var c=je,d=et,v=Qf(),h=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(b=>b.promise)):null;function y(b){v();try{s(b)}catch(w){(d.f&tr)===0&&Ea(w,d)}c==null||c.deactivate(),no()}if(r.length===0){h.then(()=>y(e.map(i)));return}function _(){v(),Promise.all(r.map(b=>Zf(b))).then(b=>y([...e.map(i),...b])).catch(b=>Ea(b,d))}h?h.then(_):_()}function Qf(){var t=et,e=Ge,r=tn,s=je;return function(l=!0){Kn(t),vn(e),Ta(r),l&&(s==null||s.activate())}}function no(){Kn(null),vn(null),Ta(null)}function li(t){var e=Ct|It,r=Ge!==null&&(Ge.f&Ct)!==0?Ge:null;return et!==null&&(et.f|=Ia),{ctx:tn,deps:null,effects:null,equals:hu,f:e,fn:t,reactions:null,rv:0,v:xt,wv:0,parent:r??et,ac:null}}function Zf(t,e,r){let s=et;s===null&&vf();var i=s.b,l=void 0,c=Jr(xt),d=!Ge,v=new Map;return fd(()=>{var w;var h=ou();l=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{y===je&&y.committed&&y.deactivate(),no()})}catch(M){h.reject(M),no()}var y=je;if(d){var _=i.is_rendered();i.update_pending_count(1),y.increment(_),(w=v.get(y))==null||w.reject(zr),v.delete(y),v.set(y,h)}const b=(M,q=void 0)=>{if(y.activate(),q)q!==zr&&(c.f|=_r,Aa(c,q));else{(c.f&_r)!==0&&(c.f^=_r),Aa(c,M);for(const[T,K]of v){if(v.delete(T),T===y)break;K.reject(zr)}}d&&(i.update_pending_count(-1),y.decrement(_))};h.promise.then(b,M=>b(null,M||"unknown"))}),Nu(()=>{for(const h of v.values())h.reject(zr)}),new Promise(h=>{function y(_){function b(){_===l?h(c):y(l)}_.then(b,b)}y(l)})}function Mt(t){const e=li(t);return Hu(e),e}function Eu(t){const e=li(t);return e.equals=vu,e}function $f(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Yt(e[r])}}function Jf(t){for(var e=t.parent;e!==null;){if((e.f&Ct)===0)return(e.f&tr)===0?e:null;e=e.parent}return null}function wo(t){var e,r=et;Kn(Jf(t));try{t.f&=~$r,$f(t),e=Xu(t)}finally{Kn(r)}return e}function Au(t){var e=wo(t);if(!t.equals(e)&&(t.wv=Yu(),(!(je!=null&&je.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){ht(t,wt);return}Sr||(St!==null?(xo()||je!=null&&je.is_fork)&&St.set(t,e):_o(t))}function ed(t){var e,r;if(t.effects!==null)for(const s of t.effects)(s.teardown||s.ac)&&((e=s.teardown)==null||e.call(s),(r=s.ac)==null||r.abort(zr),s.teardown=uf,s.ac=null,is(s,0),Eo(s))}function Cu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ca(e)}let ro=new Set;const xr=new Map;let Iu=!1;function Jr(t,e){var r={f:0,v:t,reactions:null,equals:hu,rv:0,wv:0};return r}function Oe(t,e){const r=Jr(t);return Hu(r),r}function td(t,e=!1,r=!0){const s=Jr(t);return e||(s.equals=vu),s}function F(t,e,r=!1){Ge!==null&&(!Cn||(Ge.f&yl)!==0)&&gu()&&(Ge.f&(Ct|rr|bo|yl))!==0&&(hn===null||!xa.call(hn,t))&&Sf();let s=r?Tt(e):e;return Aa(t,s)}function Aa(t,e){if(!t.equals(e)){var r=t.v;Sr?xr.set(t,e):xr.set(t,r),t.v=e;var s=kr.ensure();if(s.capture(t,r),(t.f&Ct)!==0){const i=t;(t.f&It)!==0&&wo(i),_o(i)}t.wv=Yu(),Ru(t,It),et!==null&&(et.f&wt)!==0&&(et.f&(On|ra))===0&&(ln===null?pd([t]):ln.push(t)),!s.is_fork&&ro.size>0&&!Iu&&nd()}return e}function nd(){Iu=!1;for(const t of ro)(t.f&wt)!==0&&ht(t,Rn),hs(t)&&Ca(t);ro.clear()}function ns(t){F(t,t.v+1)}function Ru(t,e){var r=t.reactions;if(r!==null)for(var s=r.length,i=0;i<s;i++){var l=r[i],c=l.f,d=(c&It)===0;if(d&&ht(l,e),(c&Ct)!==0){var v=l;St==null||St.delete(v),(c&$r)===0&&(c&pn&&(l.f|=$r),Ru(v,Rn))}else d&&((c&rr)!==0&&kn!==null&&kn.add(l),An(l))}}function Tt(t){if(typeof t!="object"||t===null||Xr in t)return t;const e=iu(t);if(e!==of&&e!==lf)return t;var r=new Map,s=yo(t),i=Oe(0),l=Zr,c=d=>{if(Zr===l)return d();var v=Ge,h=Zr;vn(null),Sl(l);var y=d();return vn(v),Sl(h),y};return s&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&kf();var y=r.get(v);return y===void 0?c(()=>{var _=Oe(h.value);return r.set(v,_),_}):F(y,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const y=c(()=>Oe(xt));r.set(v,y),ns(i)}}else F(h,xt),ns(i);return!0},get(d,v,h){var w;if(v===Xr)return t;var y=r.get(v),_=v in d;if(y===void 0&&(!_||(w=va(d,v))!=null&&w.writable)&&(y=c(()=>{var M=Tt(_?d[v]:xt),q=Oe(M);return q}),r.set(v,y)),y!==void 0){var b=k(y);return b===xt?void 0:b}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var y=r.get(v);y&&(h.value=k(y))}else if(h===void 0){var _=r.get(v),b=_==null?void 0:_.v;if(_!==void 0&&b!==xt)return{enumerable:!0,configurable:!0,value:b,writable:!0}}return h},has(d,v){var b;if(v===Xr)return!0;var h=r.get(v),y=h!==void 0&&h.v!==xt||Reflect.has(d,v);if(h!==void 0||et!==null&&(!y||(b=va(d,v))!=null&&b.writable)){h===void 0&&(h=c(()=>{var w=y?Tt(d[v]):xt,M=Oe(w);return M}),r.set(v,h));var _=k(h);if(_===xt)return!1}return y},set(d,v,h,y){var Z;var _=r.get(v),b=v in d;if(s&&v==="length")for(var w=h;w<_.v;w+=1){var M=r.get(w+"");M!==void 0?F(M,xt):w in d&&(M=c(()=>Oe(xt)),r.set(w+"",M))}if(_===void 0)(!b||(Z=va(d,v))!=null&&Z.writable)&&(_=c(()=>Oe(void 0)),F(_,Tt(h)),r.set(v,_));else{b=_.v!==xt;var q=c(()=>Tt(h));F(_,q)}var T=Reflect.getOwnPropertyDescriptor(d,v);if(T!=null&&T.set&&T.set.call(y,h),!b){if(s&&typeof v=="string"){var K=r.get("length"),se=Number(v);Number.isInteger(se)&&se>=K.v&&F(K,se+1)}ns(i)}return!0},ownKeys(d){k(i);var v=Reflect.ownKeys(d).filter(_=>{var b=r.get(_);return b===void 0||b.v!==xt});for(var[h,y]of r)y.v!==xt&&!(h in d)&&v.push(h);return v},setPrototypeOf(){xf()}})}function _l(t){try{if(t!==null&&typeof t=="object"&&Xr in t)return t[Xr]}catch{}return t}function rd(t,e){return Object.is(_l(t),_l(e))}var wl,Pu,Ou,Du;function ad(){if(wl===void 0){wl=window,Pu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Ou=va(e,"firstChild").get,Du=va(e,"nextSibling").get,ml(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ml(r)&&(r.__t=void 0)}}function nr(t=""){return document.createTextNode(t)}function Jt(t){return Ou.call(t)}function ps(t){return Du.call(t)}function x(t,e){return Jt(t)}function Et(t,e=!1){{var r=Jt(t);return r instanceof Comment&&r.data===""?ps(r):r}}function L(t,e=1,r=!1){let s=t;for(;e--;)s=ps(s);return s}function sd(t){t.textContent=""}function Mu(){return!1}function id(t,e,r){return document.createElementNS(pu,t,void 0)}let kl=!1;function od(){kl||(kl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function ko(t){var e=Ge,r=et;vn(null),Kn(null);try{return t()}finally{vn(e),Kn(r)}}function Lu(t,e,r,s=r){t.addEventListener(e,()=>ko(r));const i=t.__on_r;i?t.__on_r=()=>{i(),s(!0)}:t.__on_r=()=>s(!0),od()}function ld(t){et===null&&(Ge===null&&bf(),yf()),Sr&&mf()}function ud(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ar(t,e,r){var s=et;s!==null&&(s.f&en)!==0&&(t|=en);var i={ctx:tn,deps:null,nodes:null,f:t|It|pn,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ca(i)}catch(d){throw Yt(i),d}else e!==null&&An(i);var l=i;if(r&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&Ia)===0&&(l=l.first,(t&rr)!==0&&(t&Sa)!==0&&l!==null&&(l.f|=Sa)),l!==null&&(l.parent=s,s!==null&&ud(l,s),Ge!==null&&(Ge.f&Ct)!==0&&(t&ra)===0)){var c=Ge;(c.effects??(c.effects=[])).push(l)}return i}function xo(){return Ge!==null&&!Cn}function Nu(t){const e=ar(ii,null,!1);return ht(e,wt),e.teardown=t,e}function $s(t){ld();var e=et.f,r=!Ge&&(e&On)!==0&&(e&ds)===0;if(r){var s=tn;(s.e??(s.e=[])).push(t)}else return qu(t)}function qu(t){return ar(ss|ff,t,!1)}function cd(t){kr.ensure();const e=ar(ra|Ia,t,!0);return(r={})=>new Promise(s=>{r.outro?Qr(e,()=>{Yt(e),s(void 0)}):(Yt(e),s(void 0))})}function ju(t){return ar(ss,t,!1)}function fd(t){return ar(bo|Ia,t,!0)}function So(t,e=0){return ar(ii|e,t,!0)}function ye(t,e=[],r=[],s=[]){Xf(s,e,r,i=>{ar(ii,()=>t(...i.map(k)),!0)})}function To(t,e=0){var r=ar(rr|e,t,!0);return r}function fn(t){return ar(On|Ia,t,!0)}function Bu(t){var e=t.teardown;if(e!==null){const r=Sr,s=Ge;xl(!0),vn(null);try{e.call(null)}finally{xl(r),vn(s)}}}function Eo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&ko(()=>{i.abort(zr)});var s=r.next;(r.f&ra)!==0?r.parent=null:Yt(r,e),r=s}}function dd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&On)===0&&Yt(e),e=r}}function Yt(t,e=!0){var r=!1;(e||(t.f&cu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(zu(t.nodes.start,t.nodes.end),r=!0),Eo(t,e&&!r),is(t,0),ht(t,tr);var s=t.nodes&&t.nodes.t;if(s!==null)for(const l of s)l.stop();Bu(t);var i=t.parent;i!==null&&i.first!==null&&Fu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function zu(t,e){for(;t!==null;){var r=t===e?null:ps(t);t.remove(),t=r}}function Fu(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function Qr(t,e,r=!0){var s=[];Ku(t,s,!0);var i=()=>{r&&Yt(t),e&&e()},l=s.length;if(l>0){var c=()=>--l||i();for(var d of s)d.out(c)}else i()}function Ku(t,e,r){if((t.f&en)===0){t.f^=en;var s=t.nodes&&t.nodes.t;if(s!==null)for(const d of s)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var l=i.next,c=(i.f&Sa)!==0||(i.f&On)!==0&&(t.f&rr)!==0;Ku(i,e,c?r:!1),i=l}}}function Ao(t){Uu(t,!0)}function Uu(t,e){if((t.f&en)!==0){t.f^=en,(t.f&wt)===0&&(ht(t,It),An(t));for(var r=t.first;r!==null;){var s=r.next,i=(r.f&Sa)!==0||(r.f&On)!==0;Uu(r,i?e:!1),r=s}var l=t.nodes&&t.nodes.t;if(l!==null)for(const c of l)(c.is_global||e)&&c.in()}}function Gu(t,e){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end;r!==null;){var i=r===s?null:ps(r);e.append(r),r=i}}let Ws=!1,Sr=!1;function xl(t){Sr=t}let Ge=null,Cn=!1;function vn(t){Ge=t}let et=null;function Kn(t){et=t}let hn=null;function Hu(t){Ge!==null&&(hn===null?hn=[t]:hn.push(t))}let Ht=null,Zt=0,ln=null;function pd(t){ln=t}let Wu=1,Kr=0,Zr=Kr;function Sl(t){Zr=t}function Yu(){return++Wu}function hs(t){var e=t.f;if((e&It)!==0)return!0;if(e&Ct&&(t.f&=~$r),(e&Rn)!==0){for(var r=t.deps,s=r.length,i=0;i<s;i++){var l=r[i];if(hs(l)&&Au(l),l.wv>t.wv)return!0}(e&pn)!==0&&St===null&&ht(t,wt)}return!1}function Vu(t,e,r=!0){var s=t.reactions;if(s!==null&&!(hn!==null&&xa.call(hn,t)))for(var i=0;i<s.length;i++){var l=s[i];(l.f&Ct)!==0?Vu(l,e,!1):e===l&&(r?ht(l,It):(l.f&wt)!==0&&ht(l,Rn),An(l))}}function Xu(t){var q;var e=Ht,r=Zt,s=ln,i=Ge,l=hn,c=tn,d=Cn,v=Zr,h=t.f;Ht=null,Zt=0,ln=null,Ge=(h&(On|ra))===0?t:null,hn=null,Ta(t.ctx),Cn=!1,Zr=++Kr,t.ac!==null&&(ko(()=>{t.ac.abort(zr)}),t.ac=null);try{t.f|=Qi;var y=t.fn,_=y();t.f|=ds;var b=t.deps,w=je==null?void 0:je.is_fork;if(Ht!==null){var M;if(w||is(t,Zt),b!==null&&Zt>0)for(b.length=Zt+Ht.length,M=0;M<Ht.length;M++)b[Zt+M]=Ht[M];else t.deps=b=Ht;if(xo()&&(t.f&pn)!==0)for(M=Zt;M<b.length;M++)((q=b[M]).reactions??(q.reactions=[])).push(t)}else!w&&b!==null&&Zt<b.length&&(is(t,Zt),b.length=Zt);if(gu()&&ln!==null&&!Cn&&b!==null&&(t.f&(Ct|Rn|It))===0)for(M=0;M<ln.length;M++)Vu(ln[M],t);if(i!==null&&i!==t){if(Kr++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=Kr;if(e!==null)for(const T of e)T.rv=Kr;ln!==null&&(s===null?s=ln:s.push(...ln))}return(t.f&_r)!==0&&(t.f^=_r),_}catch(T){return yu(T)}finally{t.f^=Qi,Ht=e,Zt=r,ln=s,Ge=i,hn=l,Ta(c),Cn=d,Zr=v}}function hd(t,e){let r=e.reactions;if(r!==null){var s=rf.call(r,t);if(s!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[s]=r[i],r.pop())}}if(r===null&&(e.f&Ct)!==0&&(Ht===null||!xa.call(Ht,e))){var l=e;(l.f&pn)!==0&&(l.f^=pn,l.f&=~$r),_o(l),ed(l),is(l,0)}}function is(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)hd(t,r[s])}function Ca(t){var e=t.f;if((e&tr)===0){ht(t,wt);var r=et,s=Ws;et=t,Ws=!0;try{(e&(rr|lu))!==0?dd(t):Eo(t),Bu(t);var i=Xu(t);t.teardown=typeof i=="function"?i:null,t.wv=Wu;var l;Xi&&jf&&(t.f&It)!==0&&t.deps}finally{Ws=s,et=r}}}async function Qu(){await Promise.resolve(),Ff()}function k(t){var e=t.f,r=(e&Ct)!==0;if(Ge!==null&&!Cn){var s=et!==null&&(et.f&tr)!==0;if(!s&&(hn===null||!xa.call(hn,t))){var i=Ge.deps;if((Ge.f&Qi)!==0)t.rv<Kr&&(t.rv=Kr,Ht===null&&i!==null&&i[Zt]===t?Zt++:Ht===null?Ht=[t]:Ht.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var l=t.reactions;l===null?t.reactions=[Ge]:xa.call(l,Ge)||l.push(Ge)}}}if(Sr&&xr.has(t))return xr.get(t);if(r){var c=t;if(Sr){var d=c.v;return((c.f&wt)===0&&c.reactions!==null||$u(c))&&(d=wo(c)),xr.set(c,d),d}var v=(c.f&pn)===0&&!Cn&&Ge!==null&&(Ws||(Ge.f&pn)!==0),h=(c.f&ds)===0;hs(c)&&(v&&(c.f|=pn),Au(c)),v&&!h&&(Cu(c),Zu(c))}if(St!=null&&St.has(t))return St.get(t);if((t.f&_r)!==0)throw t.v;return t.v}function Zu(t){if(t.f|=pn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ct)!==0&&(e.f&pn)===0&&(Cu(e),Zu(e))}function $u(t){if(t.v===xt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Ct)!==0&&$u(e))return!0;return!1}function vs(t){var e=Cn;try{return Cn=!0,t()}finally{Cn=e}}const vd=["touchstart","touchmove"];function gd(t){return vd.includes(t)}const Ju=new Set,ao=new Set;function Vt(t){for(var e=0;e<t.length;e++)Ju.add(t[e]);for(var r of ao)r(t)}let Tl=null;function El(t){var T;var e=this,r=e.ownerDocument,s=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],l=i[0]||t.target;Tl=t;var c=0,d=Tl===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=i.indexOf(e);if(h===-1)return;v<=h&&(c=v)}if(l=i[c]||t.target,l!==e){af(t,"currentTarget",{configurable:!0,get(){return l||r}});var y=Ge,_=et;vn(null),Kn(null);try{for(var b,w=[];l!==null;){var M=l.assignedSlot||l.parentNode||l.host||null;try{var q=l["__"+s];q!=null&&(!l.disabled||t.target===l)&&q.call(l,t)}catch(K){b?w.push(K):b=K}if(t.cancelBubble||M===e||M===null)break;l=M}if(b){for(let K of w)queueMicrotask(()=>{throw K});throw b}}finally{t.__root=e,delete t.currentTarget,vn(y),Kn(_)}}}var ru,au;const qi=(au=(ru=globalThis==null?void 0:globalThis.window)==null?void 0:ru.trustedTypes)==null?void 0:au.createPolicy("svelte-trusted-html",{createHTML:t=>t});function md(t){return(qi==null?void 0:qi.createHTML(t))??t}function Co(t,e=!1){var r=id("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?md(t):t,r.content}function ea(t,e){var r=et;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function X(t,e){var r=(e&du)!==0,s=(e&Mf)!==0,i,l=!t.startsWith("<!>");return()=>{i===void 0&&(i=Co(l?t:"<!>"+t,!0),r||(i=Jt(i)));var c=s||Pu?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=Jt(c),v=c.lastChild;ea(d,v)}else ea(c,c);return c}}function yd(t,e,r="svg"){var s=!t.startsWith("<!>"),i=(e&du)!==0,l=`<${r}>${s?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Co(l,!0),v=Jt(d);if(i)for(c=document.createDocumentFragment();Jt(v);)c.appendChild(Jt(v));else c=Jt(v)}var h=c.cloneNode(!0);if(i){var y=Jt(h),_=h.lastChild;ea(y,_)}else ea(h,h);return h}}function Io(t,e){return yd(t,e,"svg")}function Al(t=""){{var e=nr(t+"");return ea(e,e),e}}function ec(){var t=document.createDocumentFragment(),e=document.createComment(""),r=nr();return t.append(e,r),ea(e,r),t}function W(t,e){t!==null&&t.before(e)}function ue(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function bd(t,e){return _d(t,e)}const qs=new Map;function _d(t,{target:e,anchor:r,props:s={},events:i,context:l,intro:c=!0}){ad();var d=new Set,v=_=>{for(var b=0;b<_.length;b++){var w=_[b];if(!d.has(w)){d.add(w);var M=gd(w);for(const K of[e,document]){var q=qs.get(K);q===void 0&&(q=new Map,qs.set(K,q));var T=q.get(w);T===void 0?(K.addEventListener(w,El,{passive:M}),q.set(w,1)):q.set(w,T+1)}}}};v(si(Ju)),ao.add(v);var h=void 0,y=cd(()=>{var _=r??e.appendChild(nr());return Hf(_,{pending:()=>{}},b=>{ut({});var w=tn;l&&(w.c=l),i&&(s.$$events=i),h=t(b,s)||{},ct()}),()=>{var q;for(var b of d)for(const T of[e,document]){var w=qs.get(T),M=w.get(b);--M==0?(T.removeEventListener(b,El),w.delete(b),w.size===0&&qs.delete(T)):w.set(b,M)}ao.delete(v),_!==r&&((q=_.parentNode)==null||q.removeChild(_))}});return wd.set(h,y),h}let wd=new WeakMap;var Sn,Fn,$t,Vr,cs,fs,ai;class kd{constructor(e,r=!0){Ke(this,"anchor");Ue(this,Sn,new Map);Ue(this,Fn,new Map);Ue(this,$t,new Map);Ue(this,Vr,new Set);Ue(this,cs,!0);Ue(this,fs,()=>{var e=je;if(G(this,Sn).has(e)){var r=G(this,Sn).get(e),s=G(this,Fn).get(r);if(s)Ao(s),G(this,Vr).delete(r);else{var i=G(this,$t).get(r);i&&(G(this,Fn).set(r,i.effect),G(this,$t).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),s=i.effect)}for(const[l,c]of G(this,Sn)){if(G(this,Sn).delete(l),l===e)break;const d=G(this,$t).get(c);d&&(Yt(d.effect),G(this,$t).delete(c))}for(const[l,c]of G(this,Fn)){if(l===r||G(this,Vr).has(l))continue;const d=()=>{if(Array.from(G(this,Sn).values()).includes(l)){var h=document.createDocumentFragment();Gu(c,h),h.append(nr()),G(this,$t).set(l,{effect:c,fragment:h})}else Yt(c);G(this,Vr).delete(l),G(this,Fn).delete(l)};G(this,cs)||!s?(G(this,Vr).add(l),Qr(c,d,!1)):d()}}});Ue(this,ai,e=>{G(this,Sn).delete(e);const r=Array.from(G(this,Sn).values());for(const[s,i]of G(this,$t))r.includes(s)||(Yt(i.effect),G(this,$t).delete(s))});this.anchor=e,ze(this,cs,r)}ensure(e,r){var s=je,i=Mu();if(r&&!G(this,Fn).has(e)&&!G(this,$t).has(e))if(i){var l=document.createDocumentFragment(),c=nr();l.append(c),G(this,$t).set(e,{effect:fn(()=>r(c)),fragment:l})}else G(this,Fn).set(e,fn(()=>r(this.anchor)));if(G(this,Sn).set(s,e),i){for(const[d,v]of G(this,Fn))d===e?s.unskip_effect(v):s.skip_effect(v);for(const[d,v]of G(this,$t))d===e?s.unskip_effect(v.effect):s.skip_effect(v.effect);s.oncommit(G(this,fs)),s.ondiscard(G(this,ai))}else G(this,fs).call(this)}}Sn=new WeakMap,Fn=new WeakMap,$t=new WeakMap,Vr=new WeakMap,cs=new WeakMap,fs=new WeakMap,ai=new WeakMap;function ke(t,e,r=!1){var s=new kd(t),i=r?Sa:0;function l(c,d){s.ensure(c,d)}To(()=>{var c=!1;e((d,v=0)=>{c=!0,l(v,d)}),c||l(!1,null)},i)}function Tr(t,e){return e}function xd(t,e,r){for(var s=[],i=e.length,l,c=e.length,d=0;d<i;d++){let _=e[d];Qr(_,()=>{if(l){if(l.pending.delete(_),l.done.add(_),l.pending.size===0){var b=t.outrogroups;so(si(l.done)),b.delete(l),b.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=s.length===0&&r!==null;if(v){var h=r,y=h.parentNode;sd(y),y.append(h),t.items.clear()}so(e,!v)}else l={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(l)}function so(t,e=!0){for(var r=0;r<t.length;r++)Yt(t[r],e)}var Cl;function Pn(t,e,r,s,i,l=null){var c=t,d=new Map,v=(e&fu)!==0;if(v){var h=t;c=h.appendChild(nr())}var y=null,_=Eu(()=>{var K=r();return yo(K)?K:K==null?[]:si(K)}),b,w=!0;function M(){T.fallback=y,Sd(T,b,c,e,s),y!==null&&(b.length===0?(y.f&er)===0?Ao(y):(y.f^=er,Ja(y,null,c)):Qr(y,()=>{y=null}))}var q=To(()=>{b=k(_);for(var K=b.length,se=new Set,Z=je,H=Mu(),ee=0;ee<K;ee+=1){var ie=b[ee],Q=s(ie,ee),he=w?null:d.get(Q);he?(he.v&&Aa(he.v,ie),he.i&&Aa(he.i,ee),H&&Z.unskip_effect(he.e)):(he=Td(d,w?c:Cl??(Cl=nr()),ie,Q,ee,i,e,r),w||(he.e.f|=er),d.set(Q,he)),se.add(Q)}if(K===0&&l&&!y&&(w?y=fn(()=>l(c)):(y=fn(()=>l(Cl??(Cl=nr()))),y.f|=er)),K>se.size&&gf(),!w)if(H){for(const[De,be]of d)se.has(De)||Z.skip_effect(be.e);Z.oncommit(M),Z.ondiscard(()=>{})}else M();k(_)}),T={effect:q,items:d,outrogroups:null,fallback:y};w=!1}function Ha(t){for(;t!==null&&(t.f&On)===0;)t=t.next;return t}function Sd(t,e,r,s,i){var be,re,Y,$,Ie,te,ce,de,j;var l=(s&Cf)!==0,c=e.length,d=t.items,v=Ha(t.effect.first),h,y=null,_,b=[],w=[],M,q,T,K;if(l)for(K=0;K<c;K+=1)M=e[K],q=i(M,K),T=d.get(q).e,(T.f&er)===0&&((re=(be=T.nodes)==null?void 0:be.a)==null||re.measure(),(_??(_=new Set)).add(T));for(K=0;K<c;K+=1){if(M=e[K],q=i(M,K),T=d.get(q).e,t.outrogroups!==null)for(const U of t.outrogroups)U.pending.delete(T),U.done.delete(T);if((T.f&er)!==0)if(T.f^=er,T===v)Ja(T,null,r);else{var se=y?y.next:v;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),gr(t,y,T),gr(t,T,se),Ja(T,se,r),y=T,b=[],w=[],v=Ha(y.next);continue}if((T.f&en)!==0&&(Ao(T),l&&(($=(Y=T.nodes)==null?void 0:Y.a)==null||$.unfix(),(_??(_=new Set)).delete(T))),T!==v){if(h!==void 0&&h.has(T)){if(b.length<w.length){var Z=w[0],H;y=Z.prev;var ee=b[0],ie=b[b.length-1];for(H=0;H<b.length;H+=1)Ja(b[H],Z,r);for(H=0;H<w.length;H+=1)h.delete(w[H]);gr(t,ee.prev,ie.next),gr(t,y,ee),gr(t,ie,Z),v=Z,y=ie,K-=1,b=[],w=[]}else h.delete(T),Ja(T,v,r),gr(t,T.prev,T.next),gr(t,T,y===null?t.effect.first:y.next),gr(t,y,T),y=T;continue}for(b=[],w=[];v!==null&&v!==T;)(h??(h=new Set)).add(v),w.push(v),v=Ha(v.next);if(v===null)continue}(T.f&er)===0&&b.push(T),y=T,v=Ha(T.next)}if(t.outrogroups!==null){for(const U of t.outrogroups)U.pending.size===0&&(so(si(U.done)),(Ie=t.outrogroups)==null||Ie.delete(U));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var Q=[];if(h!==void 0)for(T of h)(T.f&en)===0&&Q.push(T);for(;v!==null;)(v.f&en)===0&&v!==t.fallback&&Q.push(v),v=Ha(v.next);var he=Q.length;if(he>0){var De=(s&fu)!==0&&c===0?r:null;if(l){for(K=0;K<he;K+=1)(ce=(te=Q[K].nodes)==null?void 0:te.a)==null||ce.measure();for(K=0;K<he;K+=1)(j=(de=Q[K].nodes)==null?void 0:de.a)==null||j.fix()}xd(t,Q,De)}}l&&wr(()=>{var U,J;if(_!==void 0)for(T of _)(J=(U=T.nodes)==null?void 0:U.a)==null||J.apply()})}function Td(t,e,r,s,i,l,c,d){var v=(c&Ef)!==0?(c&If)===0?td(r,!1,!1):Jr(r):null,h=(c&Af)!==0?Jr(i):null;return{v,i:h,e:fn(()=>(l(e,v??r,h??i,d),()=>{t.delete(s)}))}}function Ja(t,e,r){if(t.nodes)for(var s=t.nodes.start,i=t.nodes.end,l=e&&(e.f&er)===0?e.nodes.start:r;s!==null;){var c=ps(s);if(l.before(s),s===i)return;s=c}}function gr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Ed(t,e,r=!1,s=!1,i=!1){var l=t,c="";ye(()=>{var d=et;if(c!==(c=e()??"")&&(d.nodes!==null&&(zu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:s&&(v=`<math>${v}</math>`);var h=Co(v);if((r||s)&&(h=Jt(h)),ea(Jt(h),h.lastChild),r||s)for(;Jt(h);)l.before(Jt(h));else l.before(h)}})}const Il=[...` 	
\r\fÂ \v\uFEFF`];function Ad(t,e,r){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),r){for(var i in r)if(r[i])s=s?s+" "+i:i;else if(s.length)for(var l=i.length,c=0;(c=s.indexOf(i,c))>=0;){var d=c+l;(c===0||Il.includes(s[c-1]))&&(d===s.length||Il.includes(s[d]))?s=(c===0?"":s.substring(0,c))+s.substring(d+1):c=d}}return s===""?null:s}function Rl(t,e=!1){var r=e?" !important;":";",s="";for(var i in t){var l=t[i];l!=null&&l!==""&&(s+=" "+i+": "+l+r)}return s}function ji(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Cd(t,e){if(e){var r="",s,i;if(Array.isArray(e)?(s=e[0],i=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var l=!1,c=0,d=!1,v=[];s&&v.push(...Object.keys(s).map(ji)),i&&v.push(...Object.keys(i).map(ji));var h=0,y=-1;const q=t.length;for(var _=0;_<q;_++){var b=t[_];if(d?b==="/"&&t[_-1]==="*"&&(d=!1):l?l===b&&(l=!1):b==="/"&&t[_+1]==="*"?d=!0:b==='"'||b==="'"?l=b:b==="("?c++:b===")"&&c--,!d&&l===!1&&c===0){if(b===":"&&y===-1)y=_;else if(b===";"||_===q-1){if(y!==-1){var w=ji(t.substring(h,y).trim());if(!v.includes(w)){b!==";"&&_++;var M=t.substring(h,_).trim();r+=" "+M+";"}}h=_+1,y=-1}}}}return s&&(r+=Rl(s)),i&&(r+=Rl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function dn(t,e,r,s,i,l){var c=t.__className;if(c!==r||c===void 0){var d=Ad(r,s,l);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(l&&i!==l)for(var v in l){var h=!!l[v];(i==null||h!==!!i[v])&&t.classList.toggle(v,h)}return l}function Bi(t,e={},r,s){for(var i in r){var l=r[i];e[i]!==l&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,l,s))}}function In(t,e,r,s){var i=t.__style;if(i!==e){var l=Cd(e,s);l==null?t.removeAttribute("style"):t.style.cssText=l,t.__style=e}else s&&(Array.isArray(s)?(Bi(t,r==null?void 0:r[0],s[0]),Bi(t,r==null?void 0:r[1],s[1],"important")):Bi(t,r,s));return s}function tc(t,e,r=!1){if(t.multiple){if(e==null)return;if(!yo(e))return Lf();for(var s of t.options)s.selected=e.includes(rs(s));return}for(s of t.options){var i=rs(s);if(rd(i,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Id(t){var e=new MutationObserver(()=>{tc(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Nu(()=>{e.disconnect()})}function Ro(t,e,r=e){var s=new WeakSet,i=!0;Lu(t,"change",l=>{var c=l?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),rs);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&rs(v)}r(d),je!==null&&s.add(je)}),ju(()=>{var l=e();if(t===document.activeElement){var c=Zs??je;if(s.has(c))return}if(tc(t,l,i),i&&l===void 0){var d=t.querySelector(":checked");d!==null&&(l=rs(d),r(l))}t.__value=l,i=!1}),Id(t)}function rs(t){return"__value"in t?t.__value:t.value}const Rd=Symbol("is custom element"),Pd=Symbol("is html");function nc(t,e,r,s){var i=Od(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[pf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Dd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Od(t){return t.__attributes??(t.__attributes={[Rd]:t.nodeName.includes("-"),[Pd]:t.namespaceURI===pu})}var Pl=new Map;function Dd(t){var e=t.getAttribute("is")||t.nodeName,r=Pl.get(e);if(r)return r;Pl.set(e,r=[]);for(var s,i=t,l=Element.prototype;l!==i;){s=sf(i);for(var c in s)s[c].set&&r.push(c);i=iu(i)}return r}function Po(t,e,r=e){var s=new WeakSet;Lu(t,"input",async i=>{var l=i?t.defaultValue:t.value;if(l=zi(t)?Fi(l):l,r(l),je!==null&&s.add(je),await Qu(),l!==(l=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=l??"",d!==null){var h=t.value.length;c===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=c,t.selectionEnd=Math.min(d,h))}}}),vs(e)==null&&t.value&&(r(zi(t)?Fi(t.value):t.value),je!==null&&s.add(je)),So(()=>{var i=e();if(t===document.activeElement){var l=Zs??je;if(s.has(l))return}zi(t)&&i===Fi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function zi(t){var e=t.type;return e==="number"||e==="range"}function Fi(t){return t===""?null:+t}function Ol(t,e){return t===e||(t==null?void 0:t[Xr])===e}function rc(t={},e,r,s){return ju(()=>{var i,l;return So(()=>{i=l,l=[],vs(()=>{t!==r(...l)&&(e(t,...l),i&&Ol(r(...i),t)&&e(null,...i))})}),()=>{wr(()=>{l&&Ol(r(...l),t)&&e(null,...l)})}}),t}let js=!1;function Md(t){var e=js;try{return js=!1,[t(),js]}finally{js=e}}function Re(t,e,r,s){var se;var i=(r&Of)!==0,l=(r&Df)!==0,c=s,d=!0,v=()=>(d&&(d=!1,c=l?vs(s):s),c),h;if(i){var y=Xr in t||df in t;h=((se=va(t,e))==null?void 0:se.set)??(y&&e in t?Z=>t[e]=Z:void 0)}var _,b=!1;i?[_,b]=Md(()=>t[e]):_=t[e],_===void 0&&s!==void 0&&(_=v(),h&&(wf(),h(_)));var w;if(w=()=>{var Z=t[e];return Z===void 0?v():(d=!0,Z)},(r&Pf)===0)return w;if(h){var M=t.$$legacy;return(function(Z,H){return arguments.length>0?((!H||M||b)&&h(H?w():Z),Z):w()})}var q=!1,T=((r&Rf)!==0?li:Eu)(()=>(q=!1,w()));i&&k(T);var K=et;return(function(Z,H){if(arguments.length>0){const ee=H?k(T):i?Tt(Z):Z;return F(T,ee),q=!0,c!==void 0&&(c=ee),Z}return Sr&&q||(K.f&tr)!==0?T.v:k(T)})}function Rt(t){tn===null&&hf(),$s(()=>{const e=vs(t);if(typeof e=="function")return e})}const Ld="5";var su;typeof window<"u"&&((su=window.__svelte??(window.__svelte={})).v??(su.v=new Set)).add(Ld);const os=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Ut=null,Jn="idle",Ys=null,jr=new Set;function Bs(){return Ut||(Ut=new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),Ut.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Jn="loading"),e.status==="ready"&&(Jn="ready"),e.status==="start"&&(Jn="generating"),(e.status==="complete"||e.status==="error")&&(Jn=Ys?"ready":"idle");for(const r of jr)try{r(e)}catch{}})),Ut}function ac(){return{check(){Bs().postMessage({type:"check"})},loadModel(t){Ys=t,Jn="loading",Bs().postMessage({type:"load",modelId:t})},generate(t){Bs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let s="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":s+=c.output;break;case"complete":l(),e(s);break;case"error":l(),r(new Error(c.data));break}},l=()=>{jr.delete(i)};jr.add(i),Bs().postMessage({type:"generate",data:t})})},interrupt(){Ut==null||Ut.postMessage({type:"interrupt"})},reset(){Ut==null||Ut.postMessage({type:"reset"})},onMessage(t){return jr.add(t),()=>jr.delete(t)},offMessage(t){jr.delete(t)},get status(){return Jn},get isReady(){return Jn==="ready"},get isGenerating(){return Jn==="generating"},get modelId(){return Ys},terminate(){Ut==null||Ut.terminate(),Ut=null,Jn="idle",Ys=null,jr.clear()}}}var Nd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vs={exports:{}},jd=Vs.exports,Dl;function Bd(){return Dl||(Dl=1,(function(t,e){((r,s)=>{t.exports=s()})(jd,function(){var r=function(n,a){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(o,u){o.__proto__=u}:function(o,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(o[f]=u[f])}))(n,a)},s=function(){return(s=Object.assign||function(n){for(var a,o=1,u=arguments.length;o<u;o++)for(var f in a=arguments[o])Object.prototype.hasOwnProperty.call(a,f)&&(n[f]=a[f]);return n}).apply(this,arguments)};function i(n,a,o){for(var u,f=0,p=a.length;f<p;f++)!u&&f in a||((u=u||Array.prototype.slice.call(a,0,f))[f]=a[f]);return n.concat(u||Array.prototype.slice.call(a))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Nd,c=Object.keys,d=Array.isArray;function v(n,a){return typeof a=="object"&&c(a).forEach(function(o){n[o]=a[o]}),n}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function _(n,a){return y.call(n,a)}function b(n,a){typeof a=="function"&&(a=a(h(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(a).forEach(function(o){M(n,o,a[o])})}var w=Object.defineProperty;function M(n,a,o,u){w(n,a,v(o&&_(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function q(n){return{from:function(a){return n.prototype=Object.create(a.prototype),M(n.prototype,"constructor",n),{extend:b.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,K=[].slice;function se(n,a,o){return K.call(n,a,o)}function Z(n,a){return a(n)}function H(n){if(!n)throw new Error("Assertion Failed")}function ee(n){l.setImmediate?setImmediate(n):setTimeout(n,0)}function ie(n,a){if(typeof a=="string"&&_(n,a))return n[a];if(!a)return n;if(typeof a!="string"){for(var o=[],u=0,f=a.length;u<f;++u){var p=ie(n,a[u]);o.push(p)}return o}var g,m=a.indexOf(".");return m===-1||(g=n[a.substr(0,m)])==null?void 0:ie(g,a.substr(m+1))}function Q(n,a,o){if(n&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof a!="string"&&"length"in a){H(typeof o!="string"&&"length"in o);for(var u=0,f=a.length;u<f;++u)Q(n,a[u],o[u])}else{var p,g,m=a.indexOf(".");m!==-1?(p=a.substr(0,m),(m=a.substr(m+1))===""?o===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=o:Q(g=(g=n[p])&&_(n,p)?g:n[p]={},m,o)):o===void 0?d(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=o}}function he(n){var a,o={};for(a in n)_(n,a)&&(o[a]=n[a]);return o}var De=[].concat;function be(n){return De.apply([],n)}var Te="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(be([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(a){return a+n+"Array"})}))).filter(function(n){return l[n]}),re=new Set(Te.map(function(n){return l[n]})),Y=null;function $(n){return Y=new WeakMap,n=(function a(o){if(!o||typeof o!="object")return o;var u=Y.get(o);if(u)return u;if(d(o)){u=[],Y.set(o,u);for(var f=0,p=o.length;f<p;++f)u.push(a(o[f]))}else if(re.has(o.constructor))u=o;else{var g,m=h(o);for(g in u=m===Object.prototype?{}:Object.create(m),Y.set(o,u),o)_(o,g)&&(u[g]=a(o[g]))}return u})(n),Y=null,n}var Ie={}.toString;function te(n){return Ie.call(n).slice(8,-1)}var ce=typeof Symbol<"u"?Symbol.iterator:"@@iterator",de=typeof ce=="symbol"?function(n){var a;return n!=null&&(a=n[ce])&&a.apply(n)}:function(){return null};function j(n,a){a=n.indexOf(a),0<=a&&n.splice(a,1)}var U={};function J(n){var a,o,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===U&&typeof n=="string")return[n];if(f=de(n))for(o=[];!(u=f.next()).done;)o.push(u.value);else{if(n==null)return[n];if(typeof(a=n.length)!="number")return[n];for(o=new Array(a);a--;)o[a]=n[a]}}else for(a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return o}var oe=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Te=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Te),Me={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Le(n,a){this.name=n,this.message=a}function Ee(n,a){return n+". Errors: "+Object.keys(a).map(function(o){return a[o].toString()}).filter(function(o,u,f){return f.indexOf(o)===u}).join(`
`)}function Je(n,a,o,u){this.failures=a,this.failedKeys=u,this.successCount=o,this.message=Ee(n,a)}function Pe(n,a){this.name="BulkError",this.failures=Object.keys(a).map(function(o){return a[o]}),this.failuresByPos=a,this.message=Ee(n,this.failures)}q(Le).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(Je).from(Le),q(Pe).from(Le);var tt=gt.reduce(function(n,a){return n[a]=a+"Error",n},{}),vt=Le,_e=gt.reduce(function(n,a){var o=a+"Error";function u(f,p){this.name=o,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=Me[a]||o,this.inner=null)}return q(u).from(vt),n[a]=u,n},{}),Lt=(_e.Syntax=SyntaxError,_e.Type=TypeError,_e.Range=RangeError,Te.reduce(function(n,a){return n[a+"Error"]=_e[a],n},{}));Te=gt.reduce(function(n,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(n[a+"Error"]=_e[a]),n},{});function He(){}function rn(n){return n}function sa(n,a){return n==null||n===rn?a:function(o){return a(n(o))}}function Nt(n,a){return function(){n.apply(this,arguments),a.apply(this,arguments)}}function Ra(n,a){return n===He?a:function(){var o=n.apply(this,arguments),u=(o!==void 0&&(arguments[0]=o),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Nt(u,this.onsuccess):u),f&&(this.onerror=this.onerror?Nt(f,this.onerror):f),p!==void 0?p:o}}function Pa(n,a){return n===He?a:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Nt(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Nt(u,this.onerror):u)}}function sr(n,a){return n===He?a:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?Nt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?Nt(p,this.onerror):p),u===void 0?g===void 0?void 0:g:v(u,g)}}function ia(n,a){return n===He?a:function(){return a.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function ir(n,a){return n===He?a:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return o.then(function(){return a.apply(u,p)})}return a.apply(this,arguments)}}Te.ModifyError=Je,Te.DexieError=Le,Te.BulkError=Pe;var Xt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Oa(n){Xt=n}var Er={},oa=100,mn=typeof Promise>"u"?[]:(gt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[mn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(mn),gt]:[gt,h(gt),gt]),gt=mn[0],pa=mn[1],pa=pa&&pa.then,yt=gt&&gt.constructor,Ar=!!mn[2],or=function(n,a){Hn.push([n,a]),lr&&(queueMicrotask(fr),lr=!1)},la=!0,lr=!0,Dn=[],Gn=[],ur=rn,bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:He,pgp:!1,env:{},finalize:He},Ae=bt,Hn=[],yn=0,ua=[];function me(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=Ae;if(typeof n!="function"){if(n!==Er)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Wn(this,this._value)}else this._state=null,this._value=null,++a.ref,(function o(u,f){try{f(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&dr();p&&typeof p.then=="function"?o(u,function(m,C){p instanceof me?p._then(m,C):p.then(m,C)}):(u._state=!0,u._value=p,ys(u)),g&&Yn()}},Wn.bind(null,u))}catch(p){Wn(u,p)}})(this,n)}var cr={get:function(){var n=Ae,a=Pr;function o(u,f){var p=this,g=!n.global&&(n!==Ae||a!==Pr),m=g&&!_n(),C=new me(function(N,I){Da(p,new ms(E(u,n,g,m),E(f,n,g,m),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return o.prototype=Er,o},set:function(n){M(this,"then",n&&n.prototype===Er?cr:{get:function(){return n},set:cr.set})}};function ms(n,a,o,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof a=="function"?a:null,this.resolve=o,this.reject=u,this.psd=f}function Wn(n,a){var o,u;Gn.push(a),n._state===null&&(o=n._lib&&dr(),a=ur(a),n._state=!1,n._value=a,u=n,Dn.some(function(f){return f._value===u._value})||Dn.push(u),ys(n),o)&&Yn()}function ys(n){var a=n._listeners;n._listeners=[];for(var o=0,u=a.length;o<u;++o)Da(n,a[o]);var f=n._PSD;--f.ref||f.finalize(),yn===0&&(++yn,or(function(){--yn==0&&Cr()},[]))}function Da(n,a){if(n._state===null)n._listeners.push(a);else{var o=n._state?a.onFulfilled:a.onRejected;if(o===null)return(n._state?a.resolve:a.reject)(n._value);++a.psd.ref,++yn,or(ft,[o,n,a])}}function ft(n,a,o){try{var u,f=a._value;!a._state&&Gn.length&&(Gn=[]),u=Xt&&a._consoleTask?a._consoleTask.run(function(){return n(f)}):n(f),a._state||Gn.indexOf(f)!==-1||(p=>{for(var g=Dn.length;g;)if(Dn[--g]._value===p._value)return Dn.splice(g,1)})(a),o.resolve(u)}catch(p){o.reject(p)}finally{--yn==0&&Cr(),--o.psd.ref||o.psd.finalize()}}function fr(){Ce(bt,function(){dr()&&Yn()})}function dr(){var n=la;return lr=la=!1,n}function Yn(){var n,a,o;do for(;0<Hn.length;)for(n=Hn,Hn=[],o=n.length,a=0;a<o;++a){var u=n[a];u[0].apply(null,u[1])}while(0<Hn.length);lr=la=!0}function Cr(){for(var n=Dn,a=(Dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),ua.slice(0)),o=a.length;o;)a[--o]()}function Ir(n){return new me(Er,!1,n)}function nt(n,a){var o=Ae;return function(){var u=dr(),f=Ae;try{return wn(o,!0),n.apply(this,arguments)}catch(p){a&&a(p)}finally{wn(f,!1),u&&Yn()}}}b(me.prototype,{then:cr,_then:function(n,a){Da(this,new ms(null,null,n,a,Ae))},catch:function(n){var a,o;return arguments.length===1?this.then(null,n):(a=n,o=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?o:Ir)(u)}):this.then(null,function(u){return(u&&u.name===a?o:Ir)(u)}))},finally:function(n){return this.then(function(a){return me.resolve(n()).then(function(){return a})},function(a){return me.resolve(n()).then(function(){return Ir(a)})})},timeout:function(n,a){var o=this;return n<1/0?new me(function(u,f){var p=setTimeout(function(){return f(new _e.Timeout(a))},n);o.then(u,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(me.prototype,Symbol.toStringTag,"Dexie.Promise"),bt.env=_s(),b(me,{all:function(){var n=J.apply(null,arguments).map(Or);return new me(function(a,o){n.length===0&&a([]);var u=n.length;n.forEach(function(f,p){return me.resolve(f).then(function(g){n[p]=g,--u||a(n)},o)})})},resolve:function(n){return n instanceof me?n:n&&typeof n.then=="function"?new me(function(a,o){n.then(a,o)}):new me(Er,!0,n)},reject:Ir,race:function(){var n=J.apply(null,arguments).map(Or);return new me(function(a,o){n.map(function(u){return me.resolve(u).then(a,o)})})},PSD:{get:function(){return Ae},set:function(n){return Ae=n}},totalEchoes:{get:function(){return Pr}},newPSD:bn,usePSD:Ce,scheduler:{get:function(){return or},set:function(n){or=n}},rejectionMapper:{get:function(){return ur},set:function(n){ur=n}},follow:function(n,a){return new me(function(o,u){return bn(function(f,p){var g=Ae;g.unhandleds=[],g.onunhandled=p,g.finalize=Nt(function(){var m,C=this;m=function(){C.unhandleds.length===0?f():p(C.unhandleds[0])},ua.push(function N(){m(),ua.splice(ua.indexOf(N),1)}),++yn,or(function(){--yn==0&&Cr()},[])},g.finalize),n()},a,o,u)})}}),yt&&(yt.allSettled&&M(me,"allSettled",function(){var n=J.apply(null,arguments).map(Or);return new me(function(a){n.length===0&&a([]);var o=n.length,u=new Array(o);n.forEach(function(f,p){return me.resolve(f).then(function(g){return u[p]={status:"fulfilled",value:g}},function(g){return u[p]={status:"rejected",reason:g}}).then(function(){return--o||a(u)})})})}),yt.any&&typeof AggregateError<"u"&&M(me,"any",function(){var n=J.apply(null,arguments).map(Or);return new me(function(a,o){n.length===0&&o(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(p,g){return me.resolve(p).then(function(m){return a(m)},function(m){f[g]=m,--u||o(new AggregateError(f))})})})}),yt.withResolvers)&&(me.withResolvers=yt.withResolvers);var mt={awaits:0,echoes:0,id:0},an=0,sn=[],Rr=0,Pr=0,Ma=0;function bn(n,g,o,u){var f=Ae,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++Ma,bt.env,p.env=Ar?{Promise:me,PromiseProp:{value:me,configurable:!0,writable:!0},all:me.all,race:me.race,allSettled:me.allSettled,any:me.any,resolve:me.resolve,reject:me.reject}:{},g&&v(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Ce(p,n,o,u));return p.ref===0&&p.finalize(),g}function Pt(){return mt.id||(mt.id=++an),++mt.awaits,mt.echoes+=oa,mt.id}function _n(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*oa,!0)}function Or(n){return mt.echoes&&n&&n.constructor===yt?(Pt(),n.then(function(a){return _n(),a},function(a){return _n(),pe(a)})):n}function bs(){var n=sn[sn.length-1];sn.pop(),wn(n,!1)}function wn(n,a){var o,u,f=Ae;(a?!mt.echoes||Rr++&&n===Ae:!Rr||--Rr&&n===Ae)||queueMicrotask(a?(function(p){++Pr,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),sn.push(Ae),wn(p,!0)}).bind(null,n):bs),n!==Ae&&(Ae=n,f===bt&&(bt.env=_s()),Ar)&&(o=bt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(l,"Promise",u.PromiseProp),o.all=u.all,o.race=u.race,o.resolve=u.resolve,o.reject=u.reject,u.allSettled&&(o.allSettled=u.allSettled),u.any)&&(o.any=u.any)}function _s(){var n=l.Promise;return Ar?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ce(n,a,o,u,f){var p=Ae;try{return wn(n,!0),a(o,u,f)}finally{wn(p,!1)}}function E(n,a,o,u){return typeof n!="function"?n:function(){var f=Ae;o&&Pt(),wn(a,!0);try{return n.apply(this,arguments)}finally{wn(f,!1),u&&queueMicrotask(_n)}}}function le(n){Promise===yt&&mt.echoes===0?Rr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+pa).indexOf("[native code]")===-1&&(Pt=_n=He);var pe=me.reject,Xe="ï¿¿",rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",it="String expected.",dt=[],Ft="__dbnames",Mn="readonly",Dr="readwrite";function st(n,a){return n?a?function(){return n.apply(this,arguments)&&a.apply(this,arguments)}:n:a}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mr(n){return typeof n!="string"||/\./.test(n)?function(a){return a}:function(a){return a[n]===void 0&&n in a&&delete(a=$(a))[n],a}}function Uo(){throw _e.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function We(n,a){try{var o=Go(n),u=Go(a);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return a<n?1:n<a?-1:0;case"binary":for(var f=Ho(n),p=Ho(a),g=f.length,m=p.length,C=g<m?g:m,N=0;N<C;++N)if(f[N]!==p[N])return f[N]<p[N]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var I=n,S=a,P=I.length,O=S.length,R=P<O?P:O,A=0;A<R;++A){var B=We(I[A],S[A]);if(B!==0)return B}return P===O?0:P<O?-1:1}}catch{}return NaN}function Go(n){var a=typeof n;return a=="object"&&(ArrayBuffer.isView(n)||(a=te(n))==="ArrayBuffer")?"binary":a}function Ho(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ws(n,a,o){var u=n.schema.yProps;return u?(a&&0<o.numFailures&&(a=a.filter(function(f,p){return!o.failures[p]})),Promise.all(u.map(function(f){return f=f.updatesTable,a?n.db.table(f).where("k").anyOf(a).delete():n.db.table(f).clear()})).then(function(){return o})):o}Wo.prototype.execute=function(n){var a=this["@@propmod"];if(a.add!==void 0){var o=a.add;if(d(o))return i(i([],d(n)?n:[],!0),o).sort();if(typeof o=="number")return(Number(n)||0)+o;if(typeof o=="bigint")try{return BigInt(n)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(a.remove!==void 0){var u=a.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return o=(o=a.replacePrefix)==null?void 0:o[0],o&&typeof n=="string"&&n.startsWith(o)?a.replacePrefix[1]+n.substring(o.length):n};var Na=Wo;function Wo(n){this["@@propmod"]=n}function Yo(n,a){for(var o=c(a),u=o.length,f=!1,p=0;p<u;++p){var g=o[p],m=a[g],C=ie(n,g);m instanceof Na?(Q(n,g,m.execute(C)),f=!0):C!==m&&(Q(n,g,m),f=!0)}return f}at.prototype._trans=function(n,a,o){var u=this._tx||Ae.trans,f=this.name,p=Xt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,S){if(S.schema[f])return a(S.idbtrans,S);throw new _e.NotFound("Table "+f+" not part of transaction")}var m=dr();try{var C=u&&u.db._novip===this.db._novip?u===Ae.trans?u._promise(n,g,o):bn(function(){return u._promise(n,g,o)},{trans:u,transless:Ae.transless||Ae}):(function N(I,S,P,O){if(I.idbdb&&(I._state.openComplete||Ae.letThrough||I._vip)){var R=I._createTransaction(S,P,I._dbSchema);try{R.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,S,P,O)})):pe(A)}return R._promise(S,function(A,B){return bn(function(){return Ae.trans=R,O(A,B,R)})}).then(function(A){if(S==="readwrite")try{R.idbtrans.commit()}catch{}return S==="readonly"?A:R._completion.then(function(){return A})})}if(I._state.openComplete)return pe(new _e.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return pe(new _e.DatabaseClosed);I.open().catch(He)}return I._state.dbReadyPromise.then(function(){return N(I,S,P,O)})})(this.db,n,[this.name],g);return p&&(C._consoleTask=p,C=C.catch(function(N){return console.trace(N),pe(N)})),C}finally{m&&Yn()}},at.prototype.get=function(n,a){var o=this;return n&&n.constructor===Object?this.where(n).first(a):n==null?pe(new _e.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return o.core.get({trans:u,key:n}).then(function(f){return o.hook.reading.fire(f)})}).then(a)},at.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var a=c(n);if(a.length===1)return this.where(a[0]).equals(n[a[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(N){return 0<=m.keyPath.indexOf(N)})){for(var C=0;C<a.length;++C)if(a.indexOf(m.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(m,C){return m.keyPath.length-C.keyPath.length})[0];if(o&&this.db._maxKey!==Xe)return g=o.keyPath.slice(0,a.length),this.where(g).equals(g.map(function(m){return n[m]}));!o&&Xt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function f(m,C){return We(m,C)===0}var g=a.reduce(function(I,C){var N=I[0],I=I[1],S=u[C],P=n[C];return[N||S,N||!S?st(I,S&&S.multi?function(O){return O=ie(O,C),d(O)&&O.some(function(R){return f(P,R)})}:function(O){return f(P,ie(O,C))}):I]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):o?this.filter(g):this.where(a).equals("")},at.prototype.filter=function(n){return this.toCollection().and(n)},at.prototype.count=function(n){return this.toCollection().count(n)},at.prototype.offset=function(n){return this.toCollection().offset(n)},at.prototype.limit=function(n){return this.toCollection().limit(n)},at.prototype.each=function(n){return this.toCollection().each(n)},at.prototype.toArray=function(n){return this.toCollection().toArray(n)},at.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},at.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},at.prototype.reverse=function(){return this.toCollection().reverse()},at.prototype.mapToClass=function(n){for(var a=this.db,o=this.name,u=((this.schema.mappedClass=n).prototype instanceof Uo&&(n=(g=>{var m=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=m}function I(){return g!==null&&g.apply(this,arguments)||this}return r(m,C),m.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),I.prototype.table=function(){return o},I})(n)),new Set),f=n.prototype;f;f=h(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function p(g){if(!g)return g;var m,C=Object.create(n.prototype);for(m in g)if(!u.has(m))try{C[m]=g[m]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},at.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},at.prototype.add=function(n,a){var o=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Mr(p)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[g]})}).then(function(m){return m.numFailures?me.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Q(n,p,m)}catch{}return m})},at.prototype.upsert=function(n,a){var o=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return o.core.get({trans:f,key:n}).then(function(p){var g=p??{};return Yo(g,a),u&&Q(g,u,n),o.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[a]}}).then(function(m){return m.numFailures?me.reject(m.failures[0]):!!p})})})},at.prototype.update=function(n,a){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(a):(n=ie(n,this.schema.primKey.keyPath))===void 0?pe(new _e.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(a)},at.prototype.put=function(n,a){var o=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=Mr(p)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"put",values:[g],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?me.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{Q(n,p,m)}catch{}return m})},at.prototype.delete=function(n){var a=this;return this._trans("readwrite",function(o){return a.core.mutate({trans:o,type:"delete",keys:[n]}).then(function(u){return ws(a,[n],u)}).then(function(u){return u.numFailures?me.reject(u.failures[0]):void 0})})},at.prototype.clear=function(){var n=this;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"deleteRange",range:La}).then(function(o){return ws(n,null,o)})}).then(function(a){return a.numFailures?me.reject(a.failures[0]):void 0})},at.prototype.bulkGet=function(n){var a=this;return this._trans("readonly",function(o){return a.core.getMany({keys:n,trans:o}).then(function(u){return u.map(function(f){return a.hook.reading.fire(f)})})})},at.prototype.bulkAdd=function(n,a,o){var u=this,f=Array.isArray(a)?a:void 0,p=(o=o||(f?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new _e.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:p}).then(function(I){var S=I.numFailures,P=I.failures;if(S===0)return p?I.results:I.lastResult;throw new Pe("".concat(u.name,".bulkAdd(): ").concat(S," of ").concat(C," operations failed"),P)})})},at.prototype.bulkPut=function(n,a,o){var u=this,f=Array.isArray(a)?a:void 0,p=(o=o||(f?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new _e.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new _e.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Mr(m)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:p}).then(function(I){var S=I.numFailures,P=I.failures;if(S===0)return p?I.results:I.lastResult;throw new Pe("".concat(u.name,".bulkPut(): ").concat(S," of ").concat(C," operations failed"),P)})})},at.prototype.bulkUpdate=function(n){var a=this,o=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return o.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var C=[],N=[],I=(n.forEach(function(S,P){var O=S.key,R=S.changes,A=m[P];if(A){for(var B=0,z=Object.keys(R);B<z.length;B++){var D=z[B],V=R[D];if(D===a.schema.primKey.keyPath){if(We(V,O)!==0)throw new _e.Constraint("Cannot update primary key in bulkUpdate()")}else Q(A,D,V)}p.push(P),C.push(O),N.push(A)}}),C.length);return o.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(S){var P=S.numFailures,O=S.failures;if(P===0)return I;for(var R=0,A=Object.keys(O);R<A.length;R++){var B,z=A[R],D=p[Number(z)];D!=null&&(B=O[z],delete O[z],O[D]=B)}throw new Pe("".concat(a.name,".bulkUpdate(): ").concat(P," of ").concat(I," operations failed"),O)})})})},at.prototype.bulkDelete=function(n){var a=this,o=n.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ws(a,n,f)})}).then(function(u){var f=u.numFailures,p=u.failures;if(f===0)return u.lastResult;throw new Pe("".concat(a.name,".bulkDelete(): ").concat(f," of ").concat(o," operations failed"),p)})};var Vo=at;function at(){}function qa(n){function a(g,m){if(m){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return o[g].subscribe.apply(null,N),n}if(typeof g=="string")return o[g]}var o={};a.addEventType=p;for(var u=1,f=arguments.length;u<f;++u)p(arguments[u]);return a;function p(g,m,C){var N,I;if(typeof g!="object")return m=m||ia,I={subscribers:[],fire:C=C||He,subscribe:function(S){I.subscribers.indexOf(S)===-1&&(I.subscribers.push(S),I.fire=m(I.fire,S))},unsubscribe:function(S){I.subscribers=I.subscribers.filter(function(P){return P!==S}),I.fire=I.subscribers.reduce(m,C)}},o[g]=a[g]=I;c(N=g).forEach(function(S){var P=N[S];if(d(P))p(S,N[S][0],N[S][1]);else{if(P!=="asap")throw new _e.InvalidArgument("Invalid event config");var O=p(S,rn,function(){for(var R=arguments.length,A=new Array(R);R--;)A[R]=arguments[R];O.subscribers.forEach(function(B){ee(function(){B.apply(null,A)})})})}})}}function ja(n,a){return q(a).from({prototype:n}),a}function ca(n,a){return!(n.filter||n.algorithm||n.or)&&(a?n.justLimit:!n.replayFilter)}function di(n,a){n.filter=st(n.filter,a)}function pi(n,a,o){var u=n.replayFilter;n.replayFilter=u?function(){return st(u(),a())}:a,n.justLimit=o&&!u}function ks(n,a){if(n.isPrimKey)return a.primaryKey;var o=a.getIndexByKeyPath(n.index);if(o)return o;throw new _e.Schema("KeyPath "+n.index+" on object store "+a.name+" is not indexed")}function Xo(n,a,o){var u=ks(n,a.schema);return a.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function xs(n,a,o,u){var f,p,g=n.replayFilter?st(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(m,C,N){var I,S;g&&!g(C,N,function(P){return C.stop(P)},function(P){return C.fail(P)})||((S=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(S=""+new Uint8Array(I)),_(f,S))||(f[S]=!0,a(m,C,N))},Promise.all([n.or._iterate(p,o),Qo(Xo(n,u,o),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):Qo(Xo(n,u,o),st(n.algorithm,g),a,!n.keysOnly&&n.valueMapper)}function Qo(n,a,o,u){var f=nt(u?function(p,g,m){return o(u(p),g,m)}:o);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};a&&!a(p,function(m){return g=m},function(m){p.stop(m),g=He},function(m){p.fail(m),g=He})||f(p.value,p,function(m){return g=m}),g()})})}Qe.prototype._read=function(n,a){var o=this._ctx;return o.error?o.table._trans(null,pe.bind(null,o.error)):o.table._trans("readonly",n).then(a)},Qe.prototype._write=function(n){var a=this._ctx;return a.error?a.table._trans(null,pe.bind(null,a.error)):a.table._trans("readwrite",n,"locked")},Qe.prototype._addAlgorithm=function(n){var a=this._ctx;a.algorithm=st(a.algorithm,n)},Qe.prototype._iterate=function(n,a){return xs(this._ctx,n,a,this._ctx.table.core)},Qe.prototype.clone=function(n){var a=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return n&&v(o,n),a._ctx=o,a},Qe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Qe.prototype.each=function(n){var a=this._ctx;return this._read(function(o){return xs(a,n,o,a.table.core)})},Qe.prototype.count=function(n){var a=this;return this._read(function(o){var u,f=a._ctx,p=f.table.core;return ca(f,!0)?p.count({trans:o,query:{index:ks(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,xs(f,function(){return++u,!1},o,p).then(function(){return u}))}).then(n)},Qe.prototype.sortBy=function(n,a){var o=n.split(".").reverse(),u=o[0],f=o.length-1;function p(C,N){return N?p(C[o[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function m(C,N){return We(p(C,f),p(N,f))*g}return this.toArray(function(C){return C.sort(m)}).then(a)},Qe.prototype.toArray=function(n){var a=this;return this._read(function(o){var u,f,p,g=a._ctx;return g.dir==="next"&&ca(g,!0)&&0<g.limit?(u=g.valueMapper,f=ks(g,g.table.core.schema),g.table.core.query({trans:o,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(p=[],xs(g,function(m){return p.push(m)},o,g.table.core).then(function(){return p}))},n)},Qe.prototype.offset=function(n){var a=this._ctx;return n<=0||(a.offset+=n,ca(a)?pi(a,function(){var o=n;return function(u,f){return o===0||(o===1?--o:f(function(){u.advance(o),o=0}),!1)}}):pi(a,function(){var o=n;return function(){return--o<0}})),this},Qe.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),pi(this._ctx,function(){var a=n;return function(o,u,f){return--a<=0&&u(f),0<=a}},!0),this},Qe.prototype.until=function(n,a){return di(this._ctx,function(o,u,f){return!n(o.value)||(u(f),a)}),this},Qe.prototype.first=function(n){return this.limit(1).toArray(function(a){return a[0]}).then(n)},Qe.prototype.last=function(n){return this.reverse().first(n)},Qe.prototype.filter=function(n){var a;return di(this._ctx,function(o){return n(o.value)}),(a=this._ctx).isMatch=st(a.isMatch,n),this},Qe.prototype.and=function(n){return this.filter(n)},Qe.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Qe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Qe.prototype.desc=function(){return this.reverse()},Qe.prototype.eachKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.key,u)})},Qe.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Qe.prototype.eachPrimaryKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.primaryKey,u)})},Qe.prototype.keys=function(n){var a=this._ctx,o=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,f){o.push(f.key)}).then(function(){return o}).then(n)},Qe.prototype.primaryKeys=function(n){var a=this._ctx;if(a.dir==="next"&&ca(a,!0)&&0<a.limit)return this._read(function(u){var f=ks(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:f,range:a.range}})}).then(function(u){return u.result}).then(n);a.keysOnly=!a.isMatch;var o=[];return this.each(function(u,f){o.push(f.primaryKey)}).then(function(){return o}).then(n)},Qe.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Qe.prototype.firstKey=function(n){return this.limit(1).keys(function(a){return a[0]}).then(n)},Qe.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Qe.prototype.distinct=function(){var n,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(n={},di(this._ctx,function(u){var u=u.primaryKey.toString(),f=_(n,u);return n[u]=!0,!f})),this},Qe.prototype.modify=function(n){var a=this,o=this._ctx;return this._write(function(u){function f(A,B){var z=B.failures;P+=A-B.numFailures;for(var D=0,V=c(z);D<V.length;D++){var ne=V[D];S.push(z[ne])}}var p=typeof n=="function"?n:function(A){return Yo(A,n)},g=o.table.core,I=g.schema.primaryKey,m=I.outbound,C=I.extractKey,N=200,I=a.db._options.modifyChunkSize,S=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),P=0,O=[],R=n===Zo;return a.clone().primaryKeys().then(function(A){function B(D){var V=Math.min(N,A.length-D),ne=A.slice(D,D+V);return(R?Promise.resolve([]):g.getMany({trans:u,keys:ne,cache:"immutable"})).then(function(ve){var ge=[],ae=[],xe=m?[]:null,we=R?ne:[];if(!R)for(var fe=0;fe<V;++fe){var Se=ve[fe],Ye={value:$(Se),primKey:A[D+fe]};p.call(Ye,Ye.value,Ye)!==!1&&(Ye.value==null?we.push(A[D+fe]):m||We(C(Se),C(Ye.value))===0?(ae.push(Ye.value),m&&xe.push(A[D+fe])):(we.push(A[D+fe]),ge.push(Ye.value)))}return Promise.resolve(0<ge.length&&g.mutate({trans:u,type:"add",values:ge}).then(function(Ze){for(var Ne in Ze.failures)we.splice(parseInt(Ne),1);f(ge.length,Ze)})).then(function(){return(0<ae.length||z&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:xe,values:ae,criteria:z,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<D}).then(function(Ze){return f(ae.length,Ze)})}).then(function(){return(0<we.length||z&&R)&&g.mutate({trans:u,type:"delete",keys:we,criteria:z,isAdditionalChunk:0<D}).then(function(Ze){return ws(o.table,we,Ze)}).then(function(Ze){return f(we.length,Ze)})}).then(function(){return A.length>D+V&&B(D+N)})})}var z=ca(o)&&o.limit===1/0&&(typeof n!="function"||R)&&{index:o.index,range:o.range};return B(0).then(function(){if(0<S.length)throw new Je("Error modifying one or more objects",S,P,O);return A.length})})})},Qe.prototype.delete=function(){var n=this._ctx,a=n.range;return!ca(n)||n.table.schema.yProps||!n.isPrimKey&&a.type!==3?this.modify(Zo):this._write(function(o){var u=n.table.core.schema.primaryKey,f=a;return n.table.core.count({trans:o,query:{index:u,range:f}}).then(function(p){return n.table.core.mutate({trans:o,type:"deleteRange",range:f}).then(function(C){var m=C.failures,C=C.numFailures;if(C)throw new Je("Could not delete some values",Object.keys(m).map(function(N){return m[N]}),p-C);return p-C})})})};var Lc=Qe;function Qe(){}var Zo=function(n,a){return a.value=null};function Nc(n,a){return n<a?-1:n===a?0:1}function qc(n,a){return a<n?-1:n===a?0:1}function Qt(n,a,o){return n=n instanceof Jo?new n.Collection(n):n,n._ctx.error=new(o||TypeError)(a),n}function fa(n){return new n.Collection(n,function(){return $o("")}).limit(0)}function Ss(O,a,o,u){var f,p,g,m,C,N,I,S=o.length;if(!o.every(function(A){return typeof A=="string"}))return Qt(O,it);function P(A){f=A==="next"?function(z){return z.toUpperCase()}:function(z){return z.toLowerCase()},p=A==="next"?function(z){return z.toLowerCase()}:function(z){return z.toUpperCase()},g=A==="next"?Nc:qc;var B=o.map(function(z){return{lower:p(z),upper:f(z)}}).sort(function(z,D){return g(z.lower,D.lower)});m=B.map(function(z){return z.upper}),C=B.map(function(z){return z.lower}),I=(N=A)==="next"?"":u}P("next");var O=new O.Collection(O,function(){return pr(m[0],C[S-1]+u)}),R=(O._ondirectionchange=function(A){P(A)},0);return O._addAlgorithm(function(A,B,z){var D=A.key;if(typeof D=="string"){var V=p(D);if(a(V,C,R))return!0;for(var ne=null,ve=R;ve<S;++ve){var ge=((ae,xe,we,fe,Se,Ye)=>{for(var Ze=Math.min(ae.length,fe.length),Ne=-1,Be=0;Be<Ze;++Be){var ot=xe[Be];if(ot!==fe[Be])return Se(ae[Be],we[Be])<0?ae.substr(0,Be)+we[Be]+we.substr(Be+1):Se(ae[Be],fe[Be])<0?ae.substr(0,Be)+fe[Be]+we.substr(Be+1):0<=Ne?ae.substr(0,Ne)+xe[Ne]+we.substr(Ne+1):null;Se(ae[Be],ot)<0&&(Ne=Be)}return Ze<fe.length&&Ye==="next"?ae+we.substr(ae.length):Ze<ae.length&&Ye==="prev"?ae.substr(0,we.length):Ne<0?null:ae.substr(0,Ne)+fe[Ne]+we.substr(Ne+1)})(D,V,m[ve],C[ve],g,N);ge===null&&ne===null?R=ve+1:(ne===null||0<g(ne,ge))&&(ne=ge)}B(ne!==null?function(){A.continue(ne+I)}:z)}return!1}),O}function pr(n,a,o,u){return{type:2,lower:n,upper:a,lowerOpen:o,upperOpen:u}}function $o(n){return{type:1,lower:n,upper:n}}Object.defineProperty(_t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),_t.prototype.between=function(n,a,o,u){o=o!==!1,u=u===!0;try{return 0<this._cmp(n,a)||this._cmp(n,a)===0&&(o||u)&&(!o||!u)?fa(this):new this.Collection(this,function(){return pr(n,a,!o,!u)})}catch{return Qt(this,rt)}},_t.prototype.equals=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return $o(n)})},_t.prototype.above=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(n,void 0,!0)})},_t.prototype.aboveOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(n,void 0,!1)})},_t.prototype.below=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(void 0,n,!1,!0)})},_t.prototype.belowOrEqual=function(n){return n==null?Qt(this,rt):new this.Collection(this,function(){return pr(void 0,n)})},_t.prototype.startsWith=function(n){return typeof n!="string"?Qt(this,it):this.between(n,n+Xe,!0,!0)},_t.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ss(this,function(a,o){return a.indexOf(o[0])===0},[n],Xe)},_t.prototype.equalsIgnoreCase=function(n){return Ss(this,function(a,o){return a===o[0]},[n],"")},_t.prototype.anyOfIgnoreCase=function(){var n=J.apply(U,arguments);return n.length===0?fa(this):Ss(this,function(a,o){return o.indexOf(a)!==-1},n,"")},_t.prototype.startsWithAnyOfIgnoreCase=function(){var n=J.apply(U,arguments);return n.length===0?fa(this):Ss(this,function(a,o){return o.some(function(u){return a.indexOf(u)===0})},n,Xe)},_t.prototype.anyOf=function(){var n,a,o=this,u=J.apply(U,arguments),f=this._cmp;try{u.sort(f)}catch{return Qt(this,rt)}return u.length===0?fa(this):((n=new this.Collection(this,function(){return pr(u[0],u[u.length-1])}))._ondirectionchange=function(p){f=p==="next"?o._ascending:o._descending,u.sort(f)},a=0,n._addAlgorithm(function(p,g,m){for(var C=p.key;0<f(C,u[a]);)if(++a===u.length)return g(m),!1;return f(C,u[a])===0||(g(function(){p.continue(u[a])}),!1)}),n)},_t.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},_t.prototype.noneOf=function(){var n=J.apply(U,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Qt(this,rt)}var a=n.reduce(function(o,u){return o?o.concat([[o[o.length-1][1],u]]):[[-1/0,u]]},null);return a.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},_t.prototype.inAnyRange=function(n,z){var o=this,u=this._cmp,f=this._ascending,p=this._descending,g=this._min,m=this._max;if(n.length===0)return fa(this);if(!n.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&f(D[0],D[1])<=0}))return Qt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",_e.InvalidArgument);var C=!z||z.includeLowers!==!1,N=z&&z.includeUppers===!0,I,S=f;function P(D,V){return S(D[0],V[0])}try{(I=n.reduce(function(D,V){for(var ne=0,ve=D.length;ne<ve;++ne){var ge=D[ne];if(u(V[0],ge[1])<0&&0<u(V[1],ge[0])){ge[0]=g(ge[0],V[0]),ge[1]=m(ge[1],V[1]);break}}return ne===ve&&D.push(V),D},[])).sort(P)}catch{return Qt(this,rt)}var O=0,R=N?function(D){return 0<f(D,I[O][1])}:function(D){return 0<=f(D,I[O][1])},A=C?function(D){return 0<p(D,I[O][0])}:function(D){return 0<=p(D,I[O][0])},B=R,z=new this.Collection(this,function(){return pr(I[0][0],I[I.length-1][1],!C,!N)});return z._ondirectionchange=function(D){S=D==="next"?(B=R,f):(B=A,p),I.sort(P)},z._addAlgorithm(function(D,V,ne){for(var ve,ge=D.key;B(ge);)if(++O===I.length)return V(ne),!1;return!R(ve=ge)&&!A(ve)||(o._cmp(ge,I[O][1])===0||o._cmp(ge,I[O][0])===0||V(function(){S===f?D.continue(I[O][0]):D.continue(I[O][1])}),!1)}),z},_t.prototype.startsWithAnyOf=function(){var n=J.apply(U,arguments);return n.every(function(a){return typeof a=="string"})?n.length===0?fa(this):this.inAnyRange(n.map(function(a){return[a,a+Xe]})):Qt(this,"startsWithAnyOf() only works with strings")};var Jo=_t;function _t(){}function Ln(n){return nt(function(a){return Ba(a),n(a.target.error),!1})}function Ba(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var za="storagemutated",hi="x-storagemutated-1",hr=qa(null,za),jc=(Nn.prototype._lock=function(){return H(!Ae.global),++this._reculock,this._reculock!==1||Ae.global||(Ae.lockOwnerFor=this),this},Nn.prototype._unlock=function(){if(H(!Ae.global),--this._reculock==0)for(Ae.global||(Ae.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ce(n[1],n[0])}catch{}}return this},Nn.prototype._locked=function(){return this._reculock&&Ae.lockOwnerFor!==this},Nn.prototype.create=function(n){var a=this;if(this.mode){var o=this.db.idbdb,u=this.db._state.dbOpenError;if(H(!this.idbtrans),!n&&!o)switch(u&&u.name){case"DatabaseClosedError":throw new _e.DatabaseClosed(u);case"MissingAPIError":throw new _e.MissingAPI(u.message,u);default:throw new _e.OpenFailed(u)}if(!this.active)throw new _e.TransactionInactive;H(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=nt(function(f){Ba(f),a._reject(n.error)}),n.onabort=nt(function(f){Ba(f),a.active&&a._reject(new _e.Abort(n.error)),a.active=!1,a.on("abort").fire(f)}),n.oncomplete=nt(function(){a.active=!1,a._resolve(),"mutatedParts"in n&&hr.storagemutated.fire(n.mutatedParts)})}return this},Nn.prototype._promise=function(n,a,o){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?pe(new _e.ReadOnly("Transaction is readonly")):this.active?this._locked()?new me(function(p,g){f._blockedFuncs.push([function(){f._promise(n,a,o).then(p,g)},Ae])}):o?bn(function(){var p=new me(function(g,m){f._lock();var C=a(g,m,f);C&&C.then&&C.then(g,m)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((u=new me(function(p,g){var m=a(p,g,f);m&&m.then&&m.then(p,g)}))._lib=!0,u):pe(new _e.TransactionInactive)},Nn.prototype._root=function(){return this.parent?this.parent._root():this},Nn.prototype.waitFor=function(n){var a,o=this._root(),u=me.resolve(n),f=(o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return u}):(o._waitingFor=u,o._waitingQueue=[],a=o.idbtrans.objectStore(o.storeNames[0]),(function p(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(a.get(-1/0).onsuccess=p)})()),o._waitingFor);return new me(function(p,g){u.then(function(m){return o._waitingQueue.push(nt(p.bind(null,m)))},function(m){return o._waitingQueue.push(nt(g.bind(null,m)))}).finally(function(){o._waitingFor===f&&(o._waitingFor=null)})})},Nn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new _e.Abort))},Nn.prototype.table=function(n){var a=this._memoizedTables||(this._memoizedTables={});if(_(a,n))return a[n];var o=this.schema[n];if(o)return(o=new this.db.Table(n,o,this)).core=this.db.core.table(n),a[n]=o;throw new _e.NotFound("Table "+n+" not part of transaction")},Nn);function Nn(){}function vi(n,a,o,u,f,p,g,m){return{name:n,keyPath:a,unique:o,multi:u,auto:f,compound:p,src:(o&&!g?"&":"")+(u?"*":"")+(f?"++":"")+el(a),type:m}}function el(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function gi(n,a,o){return{name:n,primKey:a,indexes:o,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},o.reduce(function(f,p,g){return p=u(p,g),p&&(f[p[0]]=p[1]),f},{}))};var u}var Fa=function(n){try{return n.only([[]]),Fa=function(){return[[]]},[[]]}catch{return Fa=function(){return Xe},Xe}};function mi(n){return n==null?function(){}:typeof n=="string"?(a=n).split(".").length===1?function(o){return o[a]}:function(o){return ie(o,a)}:function(o){return ie(o,n)};var a}function tl(n){return[].slice.call(n)}var Bc=0;function Ka(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function zc(n,a,C){function u(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var S=R.lower,P=R.upper,O=R.lowerOpen,R=R.upperOpen;return S===void 0?P===void 0?null:a.upperBound(P,!!R):P===void 0?a.lowerBound(S,!!O):a.bound(S,P,!!O,!!R)}function f(I){var S,P=I.name;return{name:P,schema:I,mutate:function(O){var R=O.trans,A=O.type,B=O.keys,z=O.values,D=O.range;return new Promise(function(V,ne){V=nt(V);var ve=R.objectStore(P),ge=ve.keyPath==null,ae=A==="put"||A==="add";if(!ae&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var xe,we=(B||z||{length:1}).length;if(B&&z&&B.length!==z.length)throw new Error("Given keys array must have same length as given values array.");if(we===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function fe(lt){++Ze,Ba(lt)}var Se=[],Ye=[],Ze=0;if(A==="deleteRange"){if(D.type===4)return V({numFailures:Ze,failures:Ye,results:[],lastResult:void 0});D.type===3?Se.push(xe=ve.clear()):Se.push(xe=ve.delete(u(D)))}else{var ge=ae?ge?[z,B]:[z,null]:[B,null],Ne=ge[0],Be=ge[1];if(ae)for(var ot=0;ot<we;++ot)Se.push(xe=Be&&Be[ot]!==void 0?ve[A](Ne[ot],Be[ot]):ve[A](Ne[ot])),xe.onerror=fe;else for(ot=0;ot<we;++ot)Se.push(xe=ve[A](Ne[ot])),xe.onerror=fe}function on(lt){lt=lt.target.result,Se.forEach(function(qr,Li){return qr.error!=null&&(Ye[Li]=qr.error)}),V({numFailures:Ze,failures:Ye,results:A==="delete"?B:Se.map(function(qr){return qr.result}),lastResult:lt})}xe.onerror=function(lt){fe(lt),on(lt)},xe.onsuccess=on})},getMany:function(O){var R=O.trans,A=O.keys;return new Promise(function(B,z){B=nt(B);for(var D,V=R.objectStore(P),ne=A.length,ve=new Array(ne),ge=0,ae=0,xe=function(Se){Se=Se.target,ve[Se._pos]=Se.result,++ae===ge&&B(ve)},we=Ln(z),fe=0;fe<ne;++fe)A[fe]!=null&&((D=V.get(A[fe]))._pos=fe,D.onsuccess=xe,D.onerror=we,++ge);ge===0&&B(ve)})},get:function(O){var R=O.trans,A=O.key;return new Promise(function(B,z){B=nt(B);var D=R.objectStore(P).get(A);D.onsuccess=function(V){return B(V.target.result)},D.onerror=Ln(z)})},query:(S=m,function(O){return new Promise(function(R,A){R=nt(R);var B,z,D,ae=O.trans,V=O.values,ne=O.limit,ge=O.query,ve=ne===1/0?void 0:ne,xe=ge.index,ge=ge.range,ae=ae.objectStore(P),ae=xe.isPrimaryKey?ae:ae.index(xe.name),xe=u(ge);if(ne===0)return R({result:[]});S?((ge=V?ae.getAll(xe,ve):ae.getAllKeys(xe,ve)).onsuccess=function(we){return R({result:we.target.result})},ge.onerror=Ln(A)):(B=0,z=!V&&"openKeyCursor"in ae?ae.openKeyCursor(xe):ae.openCursor(xe),D=[],z.onsuccess=function(we){var fe=z.result;return!fe||(D.push(V?fe.value:fe.primaryKey),++B===ne)?R({result:D}):void fe.continue()},z.onerror=Ln(A))})}),openCursor:function(O){var R=O.trans,A=O.values,B=O.query,z=O.reverse,D=O.unique;return new Promise(function(V,ne){V=nt(V);var ae=B.index,ve=B.range,ge=R.objectStore(P),ge=ae.isPrimaryKey?ge:ge.index(ae.name),ae=z?D?"prevunique":"prev":D?"nextunique":"next",xe=!A&&"openKeyCursor"in ge?ge.openKeyCursor(u(ve),ae):ge.openCursor(u(ve),ae);xe.onerror=Ln(ne),xe.onsuccess=nt(function(we){var fe,Se,Ye,Ze,Ne=xe.result;Ne?(Ne.___id=++Bc,Ne.done=!1,fe=Ne.continue.bind(Ne),Se=(Se=Ne.continuePrimaryKey)&&Se.bind(Ne),Ye=Ne.advance.bind(Ne),Ze=function(){throw new Error("Cursor not stopped")},Ne.trans=R,Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=function(){throw new Error("Cursor not started")},Ne.fail=nt(ne),Ne.next=function(){var Be=this,ot=1;return this.start(function(){return ot--?Be.continue():Be.stop()}).then(function(){return Be})},Ne.start=function(Be){function ot(){if(xe.result)try{Be()}catch(lt){Ne.fail(lt)}else Ne.done=!0,Ne.start=function(){throw new Error("Cursor behind last entry")},Ne.stop()}var on=new Promise(function(lt,qr){lt=nt(lt),xe.onerror=Ln(qr),Ne.fail=qr,Ne.stop=function(Li){Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=Ze,lt(Li)}});return xe.onsuccess=nt(function(lt){xe.onsuccess=ot,ot()}),Ne.continue=fe,Ne.continuePrimaryKey=Se,Ne.advance=Ye,ot(),on},V(Ne)):V(null)},ne)})},count:function(O){var R=O.query,A=O.trans,B=R.index,z=R.range;return new Promise(function(D,V){var ne=A.objectStore(P),ne=B.isPrimaryKey?ne:ne.index(B.name),ve=u(z),ve=ve?ne.count(ve):ne.count();ve.onsuccess=nt(function(ge){return D(ge.target.result)}),ve.onerror=Ln(V)})}}}p=C,g=tl((C=n).objectStoreNames);var p,C={schema:{name:C.name,tables:g.map(function(I){return p.objectStore(I)}).map(function(I){var S=I.keyPath,P=I.autoIncrement,R=d(S),O={},R={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:S==null,compound:R,keyPath:S,autoIncrement:P,unique:!0,extractKey:mi(S)},indexes:tl(I.indexNames).map(function(A){return I.index(A)}).map(function(D){var V=D.name,B=D.unique,z=D.multiEntry,D=D.keyPath,V={name:V,compound:d(D),keyPath:D,unique:B,multiEntry:z,extractKey:mi(D)};return O[Ka(D)]=V}),getIndexByKeyPath:function(A){return O[Ka(A)]}};return O[":id"]=R.primaryKey,S!=null&&(O[Ka(S)]=R.primaryKey),R})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,m=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Fa(a),schema:g}}function Fc(n,a,o,u){return o=o.IDBKeyRange,a=zc(a,o,u),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,s(s({},f),p(f))},a)}}function Ts(n,a){var o=a.db,o=Fc(n._middlewares,o,n._deps,a);n.core=o.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(p){return p.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function Es(n,a,o,u){o.forEach(function(f){var p=u[f];a.forEach(function(g){var m=(function C(N,I){return T(N,I)||(N=h(N))&&C(N,I)})(g,f);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?M(g,f,{get:function(){return this.table(f)},set:function(C){w(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function yi(n,a){a.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function Kc(n,a){return n._cfg.version-a._cfg.version}function Uc(n,a,o,u){var f=n._dbSchema,p=(o.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=gi("$meta",rl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(o),p._completion.catch(u),p._reject.bind(p)),m=Ae.transless||Ae;bn(function(){if(Ae.trans=p,Ae.transless=m,a!==0)return Ts(n,o),N=a,((C=p).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):me.resolve(N)).then(function(B){var S=n,P=B,O=p,R=o,A=[],B=S._versions,z=S._dbSchema=Cs(0,S.idbdb,R);return(B=B.filter(function(D){return D._cfg.version>=P})).length===0?me.resolve():(B.forEach(function(D){A.push(function(){var V,ne,ve,ge=z,ae=D._cfg.dbschema,xe=(Is(S,ge,R),Is(S,ae,R),z=S._dbSchema=ae,bi(ge,ae)),we=(xe.add.forEach(function(fe){_i(R,fe[0],fe[1].primKey,fe[1].indexes)}),xe.change.forEach(function(fe){if(fe.recreate)throw new _e.Upgrade("Not yet support for changing primary key");var Se=R.objectStore(fe.name);fe.add.forEach(function(Ye){return As(Se,Ye)}),fe.change.forEach(function(Ye){Se.deleteIndex(Ye.name),As(Se,Ye)}),fe.del.forEach(function(Ye){return Se.deleteIndex(Ye)})}),D._cfg.contentUpgrade);if(we&&D._cfg.version>P)return Ts(S,R),O._memoizedTables={},V=he(ae),xe.del.forEach(function(fe){V[fe]=ge[fe]}),yi(S,[S.Transaction.prototype]),Es(S,[S.Transaction.prototype],c(V),V),O.schema=V,(ne=oe(we))&&Pt(),ae=me.follow(function(){var fe;(ve=we(O))&&ne&&(fe=_n.bind(null,null),ve.then(fe,fe))}),ve&&typeof ve.then=="function"?me.resolve(ve):ae.then(function(){return ve})}),A.push(function(V){var ne,ve,ge=D._cfg.dbschema;ne=ge,ve=V,[].slice.call(ve.db.objectStoreNames).forEach(function(ae){return ne[ae]==null&&ve.db.deleteObjectStore(ae)}),yi(S,[S.Transaction.prototype]),Es(S,[S.Transaction.prototype],S._storeNames,S._dbSchema),O.schema=S._dbSchema}),A.push(function(V){S.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(S.idbdb.version/10)===D._cfg.version?(S.idbdb.deleteObjectStore("$meta"),delete S._dbSchema.$meta,S._storeNames=S._storeNames.filter(function(ne){return ne!=="$meta"})):V.objectStore("$meta").put(D._cfg.version,"version"))})}),(function D(){return A.length?me.resolve(A.shift()(O.idbtrans)).then(D):me.resolve()})().then(function(){nl(z,R)}))}).catch(g);var C,N;c(f).forEach(function(I){_i(o,I,f[I].primKey,f[I].indexes)}),Ts(n,o),me.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function Gc(n,a){nl(n._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var o=Cs(0,n.idbdb,a);Is(n,n._dbSchema,a);for(var u=0,f=bi(o,n._dbSchema).change;u<f.length;u++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(g.name);g.add.forEach(function(C){Xt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),As(m,C)})})(f[u]);if(typeof p=="object")return p.value}}function bi(n,a){var o,u={del:[],add:[],change:[]};for(o in n)a[o]||u.del.push(o);for(o in a){var f=n[o],p=a[o];if(f){var g={name:o,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=f.idxByName,C=p.idxByName,N=void 0;for(N in m)C[N]||g.del.push(N);for(N in C){var I=m[N],S=C[N];I?I.src!==S.src&&g.change.push(S):g.add.push(S)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([o,p])}return u}function _i(n,a,o,u){var f=n.db.createObjectStore(a,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});u.forEach(function(p){return As(f,p)})}function nl(n,a){c(n).forEach(function(o){a.db.objectStoreNames.contains(o)||(Xt&&console.debug("Dexie: Creating missing table",o),_i(a,o,n[o].primKey,n[o].indexes))})}function As(n,a){n.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function Cs(n,a,o){var u={};return se(a.objectStoreNames,0).forEach(function(f){for(var p=o.objectStore(f),g=vi(el(N=p.keyPath),N||"",!0,!1,!!p.autoIncrement,N&&typeof N!="string",!0),m=[],C=0;C<p.indexNames.length;++C){var I=p.index(p.indexNames[C]),N=I.keyPath,I=vi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);m.push(I)}u[f]=gi(f,g,m)}),u}function Is(n,a,o){for(var u=o.db.objectStoreNames,f=0;f<u.length;++f){var p=u[f],g=o.objectStore(p);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var C,N=g.indexNames[m],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+se(I).join("+")+"]";a[p]&&(C=a[p].idxByName[I])&&(C.name=N,delete a[p].idxByName[I],a[p].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function rl(n){return n.split(",").map(function(a,o){var f=a.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(a=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return vi(f,p||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),d(p),o===0,u)})}da.prototype._createTableSchema=gi,da.prototype._parseIndexSyntax=rl,da.prototype._parseStoresSpec=function(n,a){var o=this;c(n).forEach(function(u){if(n[u]!==null){var f=o._parseIndexSyntax(n[u]),p=f.shift();if(!p)throw new _e.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new _e.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new _e.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new _e.Schema("Index must have a name and cannot be an empty string")}),p=o._createTableSchema(u,p,f),a[u]=p}})},da.prototype.stores=function(o){var a=this.db,o=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,o):o,a._versions),u={},f={};return o.forEach(function(p){v(u,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(u,f)}),a._dbSchema=f,yi(a,[a._allTables,a,a.Transaction.prototype]),Es(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],c(f),f),a._storeNames=c(f),this},da.prototype.upgrade=function(n){return this._cfg.contentUpgrade=ir(this._cfg.contentUpgrade||He,n),this};var Hc=da;function da(){}function wi(n,a){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new Vn(Ft,{addons:[],indexedDB:n,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function ki(n){return n&&typeof n.databases=="function"}function xi(n){return bn(function(){return Ae.letThrough=!0,n()})}function Si(n){return!("from"in n)}var Ot=function(n,a){var o;if(!this)return o=new Ot,n&&"d"in n&&v(o,n),o;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?a:n}:{d:0})};function Ua(n,a,o){var u=We(a,o);if(!isNaN(u)){if(0<u)throw RangeError();if(Si(n))return v(n,{from:a,to:o,d:1});var u=n.l,f=n.r;if(We(o,n.from)<0)return u?Ua(u,a,o):n.l={from:a,to:o,d:1,l:null,r:null},sl(n);if(0<We(a,n.to))return f?Ua(f,a,o):n.r={from:a,to:o,d:1,l:null,r:null},sl(n);We(a,n.from)<0&&(n.from=a,n.l=null,n.d=f?f.d+1:1),0<We(o,n.to)&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,u&&!n.l&&Ga(n,u),f&&a&&Ga(n,f)}}function Ga(n,a){Si(a)||(function o(u,f){var p=f.from,g=f.l,m=f.r;Ua(u,p,f.to),g&&o(u,g),m&&o(u,m)})(n,a)}function al(n,a){var o=Rs(a),u=o.next();if(!u.done)for(var f=u.value,p=Rs(n),g=p.next(f.from),m=g.value;!u.done&&!g.done;){if(We(m.from,f.to)<=0&&0<=We(m.to,f.from))return!0;We(f.from,m.from)<0?f=(u=o.next(m.from)).value:m=(g=p.next(f.from)).value}return!1}function Rs(n){var a=Si(n)?null:{s:0,n};return{next:function(o){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&We(o,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||We(o,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function sl(n){var a,o,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(a=f=="r"?"l":"r",o=s({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],o[f]=u[a],(n[a]=o).d=il(o)),n.d=il(n)}function il(o){var a=o.r,o=o.l;return(a?o?Math.max(a.d,o.d):a.d:o?o.d:0)+1}function Ps(n,a){return c(a).forEach(function(o){n[o]?Ga(n[o],a[o]):n[o]=(function u(f){var p,g,m={};for(p in f)_(f,p)&&(g=f[p],m[p]=!g||typeof g!="object"||re.has(g.constructor)?g:u(g));return m})(a[o])}),n}function Ti(n,a){return n.all||a.all||Object.keys(n).some(function(o){return a[o]&&al(a[o],n[o])})}b(Ot.prototype,((gt={add:function(n){return Ga(this,n),this},addKey:function(n){return Ua(this,n,n),this},addKeys:function(n){var a=this;return n.forEach(function(o){return Ua(a,o,o)}),this},hasKey:function(n){var a=Rs(this).next(n).value;return a&&We(a.from,n)<=0&&0<=We(a.to,n)}})[ce]=function(){return Rs(this)},gt));var Lr={},Ei={},Ai=!1;function Os(n){Ps(Ei,n),Ai||(Ai=!0,setTimeout(function(){Ai=!1,Ci(Ei,!(Ei={}))},0))}function Ci(n,a){a===void 0&&(a=!1);var o=new Set;if(n.all)for(var u=0,f=Object.values(Lr);u<f.length;u++)ol(m=f[u],n,o,a);else for(var p in n){var g,m,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],m=Lr["idb://".concat(g,"/").concat(p)])&&ol(m,n,o,a)}o.forEach(function(C){return C()})}function ol(n,a,o,u){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var m=g[p],C=m[0],N=[],I=0,S=m[1];I<S.length;I++){var P=S[I];Ti(a,P.obsSet)?P.subscribers.forEach(function(B){return o.add(B)}):u&&N.push(P)}u&&f.push([C,N])}if(u)for(var O=0,R=f;O<R.length;O++){var A=R[O],C=A[0],N=A[1];n.queries.query[C]=N}}function Wc(n){var a=n._state,o=n._deps.indexedDB;if(a.isBeingOpened||n.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?pe(a.dbOpenError):n});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(a.openCanceller!==u)throw new _e.DatabaseClosed("db.open() was cancelled")}function m(){return new me(function(P,O){if(g(),!o)throw new _e.MissingAPI;var R=n.name,A=a.autoSchema||!f?o.open(R):o.open(R,f);if(!A)throw new _e.MissingAPI;A.onerror=Ln(O),A.onblocked=nt(n._fireOnBlocked),A.onupgradeneeded=nt(function(B){var z;I=A.transaction,a.autoSchema&&!n._options.allowEmptyDB?(A.onerror=Ba,I.abort(),A.result.close(),(z=o.deleteDatabase(R)).onsuccess=z.onerror=nt(function(){O(new _e.NoSuchDatabase("Database ".concat(R," doesnt exist")))})):(I.onerror=Ln(O),z=B.oldVersion>Math.pow(2,62)?0:B.oldVersion,S=z<1,n.idbdb=A.result,p&&Gc(n,I),Uc(n,z/10,I,O))},O),A.onsuccess=nt(function(){I=null;var B,z,D,V,ne,ve,ge=n.idbdb=A.result,ae=se(ge.objectStoreNames);if(0<ae.length)try{var xe=ge.transaction((ne=ae).length===1?ne[0]:ne,"readonly");if(a.autoSchema)ve=ge,V=xe,(D=n).verno=ve.version/10,V=D._dbSchema=Cs(0,ve,V),D._storeNames=se(ve.objectStoreNames,0),Es(D,[D._allTables],c(V),V);else if(Is(n,n._dbSchema,xe),z=xe,((z=bi(Cs(0,(B=n).idbdb,z),B._dbSchema)).add.length||z.change.some(function(we){return we.add.length||we.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ge.close(),f=ge.version+1,p=!0,P(m());Ts(n,xe)}catch{}dt.push(n),ge.onversionchange=nt(function(we){a.vcFired=!0,n.on("versionchange").fire(we)}),ge.onclose=nt(function(){n.close({disableAutoOpen:!1})}),S&&(ae=n._deps,ne=R,ki(ve=ae.indexedDB)||ne===Ft||wi(ve,ae.IDBKeyRange).put({name:ne}).catch(He)),P()},O)}).catch(function(P){switch(P==null?void 0:P.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<f)return f=0,m()}return me.reject(P)})}var C,N=a.dbReadyResolve,I=null,S=!1;return me.race([u,(typeof navigator>"u"?me.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function O(){return indexedDB.databases().finally(P)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(m)]).then(function(){return g(),a.onReadyBeingFired=[],me.resolve(xi(function(){return n.on.ready.fire(n.vip)})).then(function P(){var O;if(0<a.onReadyBeingFired.length)return O=a.onReadyBeingFired.reduce(ir,He),a.onReadyBeingFired=[],me.resolve(xi(function(){return O(n.vip)})).then(P)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(P){a.dbOpenError=P;try{I&&I.abort()}catch{}return u===a.openCanceller&&n._close(),pe(P)}).finally(function(){a.openComplete=!0,N()}).then(function(){var P;return S&&(P={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(R){R.name&&(P["idb://".concat(n.name,"/").concat(O.name,"/").concat(R.name)]=new Ot(-1/0,[[[]]]))}),P["idb://".concat(n.name,"/").concat(O.name,"/")]=P["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Ot(-1/0,[[[]]])}),hr(za).fire(P),Ci(P,!0)),n})}function Ii(n){function a(p){return n.next(p)}var o=f(a),u=f(function(p){return n.throw(p)});function f(p){return function(m){var m=p(m),C=m.value;return m.done?C:C&&typeof C.then=="function"?C.then(o,u):d(C)?Promise.all(C).then(o,u):o(C)}}return f(a)()}function Ds(n,a,o){for(var u=d(n)?n.slice():[n],f=0;f<o;++f)u.push(a);return u}var Yc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return s(s({},n),{table:function(u){var o=n.table(u),u=o.schema,f={},p=[];function g(P,O,R){var D=Ka(P),A=f[D]=f[D]||[],B=P==null?0:typeof P=="string"?1:P.length,z=0<O,D=s(s({},R),{name:z?"".concat(D,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:z,keyTail:O,keyLength:B,extractKey:mi(P),unique:!z&&R.unique});return A.push(D),D.isPrimaryKey||p.push(D),1<B&&g(B===2?P[0]:P.slice(0,B-1),O+1,R),A.sort(function(V,ne){return V.keyTail-ne.keyTail}),D}var m=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[m];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function S(P){var O,R=P.query.index;return R.isVirtual?s(s({},P),{query:{index:R.lowLevelIndex,range:(O=P.query.range,R=R.keyTail,{type:O.type===1?2:O.type,lower:Ds(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,R),lowerOpen:!0,upper:Ds(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,R),upperOpen:!0})}}):P}return s(s({},o),{schema:s(s({},u),{primaryKey:m,indexes:p,getIndexByKeyPath:function(P){return(P=f[Ka(P)])&&P[0]}}),count:function(P){return o.count(S(P))},query:function(P){return o.query(S(P))},openCursor:function(P){var O=P.query.index,R=O.keyTail,A=O.keyLength;return O.isVirtual?o.openCursor(S(P)).then(function(z){return z&&B(z)}):o.openCursor(P);function B(z){return Object.create(z,{continue:{value:function(D){D!=null?z.continue(Ds(D,P.reverse?n.MAX_KEY:n.MIN_KEY,R)):P.unique?z.continue(z.key.slice(0,A).concat(P.reverse?n.MIN_KEY:n.MAX_KEY,R)):z.continue()}},continuePrimaryKey:{value:function(D,V){z.continuePrimaryKey(Ds(D,n.MAX_KEY,R),V)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var D=z.key;return A===1?D[0]:D.slice(0,A)}},value:{get:function(){return z.value}}})}}})}})}};function Ri(n,a,o,u){return o=o||{},u=u||"",c(n).forEach(function(f){var p,g,m;_(a,f)?(p=n[f],g=a[f],typeof p=="object"&&typeof g=="object"&&p&&g?(m=te(p))!==te(g)?o[u+f]=a[f]:m==="Object"?Ri(p,g,o,u+f+"."):p!==g&&(o[u+f]=a[f]):p!==g&&(o[u+f]=a[f])):o[u+f]=void 0}),c(a).forEach(function(f){_(n,f)||(o[u+f]=a[f])}),o}function Pi(n,a){return a.type==="delete"?a.keys:a.keys||a.values.map(n.extractKey)}var Vc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return s(s({},n),{table:function(a){var o=n.table(a),u=o.schema.primaryKey;return s(s({},o),{mutate:function(f){var p=Ae.trans,g=p.table(a).hook,m=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===He&&N.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"delete":if(m.fire===He)break;return p._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(m.fire===He)break;return p._promise("readwrite",function(){return(function S(P,O,R){return o.query({trans:P,values:!1,query:{index:u,range:O},limit:R}).then(function(A){var B=A.result;return I({type:"delete",keys:B,trans:P}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):B.length<R?{failures:[],numFailures:0,lastResult:void 0}:S(P,s(s({},O),{lower:B[B.length-1],lowerOpen:!0}),R)})})})(f.trans,f.range,1e4)},!0)}return o.mutate(f);function I(S){var P,O,R,A=Ae.trans,B=S.keys||Pi(u,S);if(B)return(S=S.type==="add"||S.type==="put"?s(s({},S),{keys:B}):s({},S)).type!=="delete"&&(S.values=i([],S.values)),S.keys&&(S.keys=i([],S.keys)),P=o,R=B,((O=S).type==="add"?Promise.resolve([]):P.getMany({trans:O.trans,keys:R,cache:"immutable"})).then(function(z){var D=B.map(function(V,ne){var ve,ge,ae,xe=z[ne],we={onerror:null,onsuccess:null};return S.type==="delete"?m.fire.call(we,V,xe,A):S.type==="add"||xe===void 0?(ve=C.fire.call(we,V,S.values[ne],A),V==null&&ve!=null&&(S.keys[ne]=V=ve,u.outbound||Q(S.values[ne],u.keyPath,V))):(ve=Ri(xe,S.values[ne]),(ge=N.fire.call(we,ve,V,xe,A))&&(ae=S.values[ne],Object.keys(ge).forEach(function(fe){_(ae,fe)?ae[fe]=ge[fe]:Q(ae,fe,ge[fe])}))),we});return o.mutate(S).then(function(V){for(var ne=V.failures,ve=V.results,ge=V.numFailures,V=V.lastResult,ae=0;ae<B.length;++ae){var xe=(ve||B)[ae],we=D[ae];xe==null?we.onerror&&we.onerror(ne[ae]):we.onsuccess&&we.onsuccess(S.type==="put"&&z[ae]?S.values[ae]:xe)}return{failures:ne,results:ve,numFailures:ge,lastResult:V}}).catch(function(V){return D.forEach(function(ne){return ne.onerror&&ne.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function ll(n,a,o){try{if(!a||a.keys.length<n.length)return null;for(var u=[],f=0,p=0;f<a.keys.length&&p<n.length;++f)We(a.keys[f],n[p])===0&&(u.push(o?$(a.values[f]):a.values[f]),++p);return u.length===n.length?u:null}catch{return null}}var Xc={stack:"dbcore",level:-1,create:function(n){return{table:function(a){var o=n.table(a);return s(s({},o),{getMany:function(u){var f;return u.cache?(f=ll(u.keys,u.trans._cache,u.cache==="clone"))?me.resolve(f):o.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?$(p):p},p}):o.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function ul(n,a){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function cl(n,a){switch(n){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Qc={stack:"dbcore",level:0,name:"Observability",create:function(n){var a=n.schema.name,o=new Ot(n.MIN_KEY,n.MAX_KEY);return s(s({},n),{transaction:function(u,f,p){if(Ae.subscr&&f!=="readonly")throw new _e.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ae.querier));return n.transaction(u,f,p)},table:function(u){function f(B){var A,B=B.query;return[A=B.index,new Ot((A=(B=B.range).lower)!=null?A:n.MIN_KEY,(A=B.upper)!=null?A:n.MAX_KEY)]}var p=n.table(u),g=p.schema,m=g.primaryKey,C=g.indexes,N=m.extractKey,I=m.outbound,S=m.autoIncrement&&C.filter(function(R){return R.compound&&R.keyPath.includes(m.keyPath)}),P=s(s({},p),{mutate:function(R){function A(Se){return Se="idb://".concat(a,"/").concat(u,"/").concat(Se),ne[Se]||(ne[Se]=new Ot)}var B,z,D,V=R.trans,ne=R.mutatedParts||(R.mutatedParts={}),ve=A(""),ge=A(":dels"),ae=R.type,we=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Pi(m,R).filter(function(Se){return Se}),R.values]:[],xe=we[0],we=we[1],fe=R.trans._cache;return d(xe)?(ve.addKeys(xe),(ae=ae==="delete"||xe.length===we.length?ll(xe,fe):null)||ge.addKeys(xe),(ae||we)&&(B=A,z=ae,D=we,g.indexes.forEach(function(Se){var Ye=B(Se.name||"");function Ze(Be){return Be!=null?Se.extractKey(Be):null}function Ne(Be){Se.multiEntry&&d(Be)?Be.forEach(function(ot){return Ye.addKey(ot)}):Ye.addKey(Be)}(z||D).forEach(function(Be,lt){var on=z&&Ze(z[lt]),lt=D&&Ze(D[lt]);We(on,lt)!==0&&(on!=null&&Ne(on),lt!=null)&&Ne(lt)})}))):xe?(we={from:(fe=xe.lower)!=null?fe:n.MIN_KEY,to:(ae=xe.upper)!=null?ae:n.MAX_KEY},ge.add(we),ve.add(we)):(ve.add(o),ge.add(o),g.indexes.forEach(function(Se){return A(Se.name).add(o)})),p.mutate(R).then(function(Se){return!xe||R.type!=="add"&&R.type!=="put"||(ve.addKeys(Se.results),S&&S.forEach(function(Ye){for(var Ze=R.values.map(function(on){return Ye.extractKey(on)}),Ne=Ye.keyPath.findIndex(function(on){return on===m.keyPath}),Be=0,ot=Se.results.length;Be<ot;++Be)Ze[Be][Ne]=Se.results[Be];A(Ye.name).addKeys(Ze)})),V.mutatedParts=Ps(V.mutatedParts||{},ne),Se})}}),O={get:function(R){return[m,new Ot(R.key)]},getMany:function(R){return[m,new Ot().addKeys(R.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(R){P[R]=function(A){var B=Ae.subscr,z=!!B,D=ul(Ae,p)&&cl(R,A)?A.obsSet={}:B;if(z){var V,B=function(we){return we="idb://".concat(a,"/").concat(u,"/").concat(we),D[we]||(D[we]=new Ot)},ne=B(""),ve=B(":dels"),z=O[R](A),ge=z[0],z=z[1];if((R==="query"&&ge.isPrimaryKey&&!A.values?ve:B(ge.name||"")).add(z),!ge.isPrimaryKey){if(R!=="count")return V=R==="query"&&I&&A.values&&p.query(s(s({},A),{values:!1})),p[R].apply(this,arguments).then(function(we){if(R==="query"){if(I&&A.values)return V.then(function(Ze){return Ze=Ze.result,ne.addKeys(Ze),we});var fe=A.values?we.result.map(N):we.result;(A.values?ne:ve).addKeys(fe)}else{var Se,Ye;if(R==="openCursor")return Ye=A.values,(Se=we)&&Object.create(Se,{key:{get:function(){return ve.addKey(Se.primaryKey),Se.key}},primaryKey:{get:function(){var Ze=Se.primaryKey;return ve.addKey(Ze),Ze}},value:{get:function(){return Ye&&ne.addKey(Se.primaryKey),Se.value}}})}return we});ve.add(o)}}return p[R].apply(this,arguments)}}),P}})}};function fl(n,a,o){var u;return o.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,o.numFailures===u)?null:(u=s({},a),d(u.keys)&&(u.keys=u.keys.filter(function(f,p){return!(p in o.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,p){return!(p in o.failures)})),u)}function Oi(n,a){return o=n,((u=a).lower===void 0||(u.lowerOpen?0<We(o,u.lower):0<=We(o,u.lower)))&&(o=n,(u=a).upper===void 0||(u.upperOpen?We(o,u.upper)<0:We(o,u.upper)<=0));var o,u}function dl(n,a,o,u,f,p){var g,m,C,N,I,S;return!o||o.length===0||(g=a.query.index,m=g.multiEntry,C=a.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,S=(g.lowLevelIndex||g).extractKey,(u=o.reduce(function(P,O){var R=P,A=[];if(O.type==="add"||O.type==="put")for(var B=new Ot,z=O.values.length-1;0<=z;--z){var D,V=O.values[z],ne=N(V);!B.hasKey(ne)&&(D=I(V),m&&d(D)?D.some(function(we){return Oi(we,C)}):Oi(D,C))&&(B.addKey(ne),A.push(V))}switch(O.type){case"add":var ve=new Ot().addKeys(a.values?P.map(function(fe){return N(fe)}):P),R=P.concat(a.values?A.filter(function(fe){return fe=N(fe),!ve.hasKey(fe)&&(ve.addKey(fe),!0)}):A.map(function(fe){return N(fe)}).filter(function(fe){return!ve.hasKey(fe)&&(ve.addKey(fe),!0)}));break;case"put":var ge=new Ot().addKeys(O.values.map(function(fe){return N(fe)}));R=P.filter(function(fe){return!ge.hasKey(a.values?N(fe):fe)}).concat(a.values?A:A.map(function(fe){return N(fe)}));break;case"delete":var ae=new Ot().addKeys(O.keys);R=P.filter(function(fe){return!ae.hasKey(a.values?N(fe):fe)});break;case"deleteRange":var xe=O.range;R=P.filter(function(fe){return!Oi(N(fe),xe)})}return R},n))===n)?n:(u.sort(function(P,O){return We(S(P),S(O))||We(N(P),N(O))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:n.length===a.limit&&u.length<a.limit&&(f.dirty=!0)),p?Object.freeze(u):u)}function pl(n,a){return We(n.lower,a.lower)===0&&We(n.upper,a.upper)===0&&!!n.lowerOpen==!!a.lowerOpen&&!!n.upperOpen==!!a.upperOpen}function Zc(n,a){return((o,u,f,p)=>{if(o===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((o=We(o,u))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return o})(n.lower,a.lower,n.lowerOpen,a.lowerOpen)<=0&&0<=((o,u,f,p)=>{if(o===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((o=We(o,u))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return o})(n.upper,a.upper,n.upperOpen,a.upperOpen)}function $c(n,a,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){var f,p;n.subscribers.delete(o),n.subscribers.size===0&&(f=n,p=a,setTimeout(function(){f.subscribers.size===0&&j(p,f)},3e3))})}var Jc={stack:"dbcore",level:0,name:"Cache",create:function(n){var a=n.schema.name;return s(s({},n),{transaction:function(o,u,f){var p,g,m=n.transaction(o,u,f);return u==="readwrite"&&(f=(p=new AbortController).signal,m.addEventListener("abort",(g=function(C){return function(){if(p.abort(),u==="readwrite"){for(var N=new Set,I=0,S=o;I<S.length;I++){var P=S[I],O=Lr["idb://".concat(a,"/").concat(P)];if(O){var R=n.table(P),A=O.optimisticOps.filter(function(Se){return Se.trans===m});if(m._explicit&&C&&m.mutatedParts)for(var B=0,z=Object.values(O.queries.query);B<z.length;B++)for(var D=0,V=(ge=z[B]).slice();D<V.length;D++)Ti((ae=V[D]).obsSet,m.mutatedParts)&&(j(ge,ae),ae.subscribers.forEach(function(Se){return N.add(Se)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Se){return Se.trans!==m});for(var ne=0,ve=Object.values(O.queries.query);ne<ve.length;ne++)for(var ge,ae,xe,we=0,fe=(ge=ve[ne]).slice();we<fe.length;we++)(ae=fe[we]).res!=null&&m.mutatedParts&&(C&&!ae.dirty?(xe=Object.isFrozen(ae.res),xe=dl(ae.res,ae.req,A,R,ae,xe),ae.dirty?(j(ge,ae),ae.subscribers.forEach(function(Se){return N.add(Se)})):xe!==ae.res&&(ae.res=xe,ae.promise=me.resolve({result:xe}))):(ae.dirty&&j(ge,ae),ae.subscribers.forEach(function(Se){return N.add(Se)})))}}}N.forEach(function(Se){return Se()})}}})(!1),{signal:f}),m.addEventListener("error",g(!1),{signal:f}),m.addEventListener("complete",g(!0),{signal:f})),m},table:function(o){var u=n.table(o),f=u.schema.primaryKey;return s(s({},u),{mutate:function(p){var g,m=Ae.trans;return!f.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Lr["idb://".concat(a,"/").concat(o)])?(m=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Pi(f,p).some(function(C){return C==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Os(p.mutatedParts),m.then(function(C){0<C.numFailures&&(j(g.optimisticOps,p),(C=fl(0,p,C))&&g.optimisticOps.push(C),p.mutatedParts)&&Os(p.mutatedParts)}),m.catch(function(){j(g.optimisticOps,p),p.mutatedParts&&Os(p.mutatedParts)})):m.then(function(C){var N=fl(0,s(s({},p),{values:p.values.map(function(I,S){var P;return C.failures[S]?I:(Q(P=(P=f.keyPath)!=null&&P.includes(".")?$(I):s({},I),f.keyPath,C.results[S]),P)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return p.mutatedParts&&Os(p.mutatedParts)})}),m):u.mutate(p)},query:function(p){var g,m,C,N,I,S,P;return ul(Ae,u)&&cl("query",p)?(g=((C=Ae.trans)==null?void 0:C.db._options.cache)==="immutable",m=(C=Ae).requery,C=C.signal,S=((O,R,A,B)=>{var z=Lr["idb://".concat(O,"/").concat(R)];if(!z)return[];if(!(O=z.queries[A]))return[null,!1,z,null];var D=O[(B.query?B.query.index.name:null)||""];if(!D)return[null,!1,z,null];switch(A){case"query":var V=D.find(function(ne){return ne.req.limit===B.limit&&ne.req.values===B.values&&pl(ne.req.query.range,B.query.range)});return V?[V,!0,z,D]:[D.find(function(ne){return("limit"in ne.req?ne.req.limit:1/0)>=B.limit&&(!B.values||ne.req.values)&&Zc(ne.req.query.range,B.query.range)}),!1,z,D];case"count":return V=D.find(function(ne){return pl(ne.req.query.range,B.query.range)}),[V,!!V,z,D]}})(a,o,"query",p),P=S[0],N=S[2],I=S[3],P&&S[1]?P.obsSet=p.obsSet:(S=u.query(p).then(function(O){var R=O.result;if(P&&(P.res=R),g){for(var A=0,B=R.length;A<B;++A)Object.freeze(R[A]);Object.freeze(R)}else O.result=$(R);return O}).catch(function(O){return I&&P&&j(I,P),Promise.reject(O)}),P={obsSet:p.obsSet,promise:S,subscribers:new Set,type:"query",req:p,dirty:!1},I?I.push(P):(I=[P],(N=N||(Lr["idb://".concat(a,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=I)),$c(P,I,m,C),P.promise.then(function(O){return{result:dl(O.result,p,N==null?void 0:N.optimisticOps,u,P,g)}})):u.query(p)}})}})}};function Ms(n,a){return new Proxy(n,{get:function(o,u,f){return u==="db"?a:Reflect.get(o,u,f)}})}pt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new _e.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new _e.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var a=this._versions,o=a.filter(function(u){return u._cfg.version===n})[0];return o||(o=new this.Version(n),a.push(o),a.sort(Kc),o.stores({}),this._state.autoSchema=!1),o},pt.prototype._whenReady=function(n){var a=this;return this.idbdb&&(this._state.openComplete||Ae.letThrough||this._vip)?n():new me(function(o,u){if(a._state.openComplete)return u(new _e.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new _e.DatabaseClosed);a.open().catch(He)}a._state.dbReadyPromise.then(o,u)}).then(n)},pt.prototype.use=function(f){var a=f.stack,o=f.create,u=f.level,f=f.name,p=(f&&this.unuse({stack:a,name:f}),this._middlewares[a]||(this._middlewares[a]=[]));return p.push({stack:a,create:o,level:u??10,name:f}),p.sort(function(g,m){return g.level-m.level}),this},pt.prototype.unuse=function(n){var a=n.stack,o=n.name,u=n.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(f){return u?f.create!==u:!!o&&f.name!==o})),this},pt.prototype.open=function(){var n=this;return Ce(bt,function(){return Wc(n)})},pt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,a=dt.indexOf(this);if(0<=a&&dt.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new me(function(o){n.dbReadyResolve=o}),n.openCanceller=new me(function(o,u){n.cancelOpen=u}))},pt.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,o=this._state;a?(o.isBeingOpened&&o.cancelOpen(new _e.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new _e.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},pt.prototype.delete=function(n){var a=this,o=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new me(function(f,p){function g(){a.close(n);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=nt(function(){var C,N,I;C=a._deps,N=a.name,ki(I=C.indexedDB)||N===Ft||wi(I,C.IDBKeyRange).delete(N).catch(He),f()}),m.onerror=Ln(p),m.onblocked=a._fireOnBlocked}if(o)throw new _e.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},pt.prototype.backendDB=function(){return this.idbdb},pt.prototype.isOpen=function(){return this.idbdb!==null},pt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},pt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},pt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(pt.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(a){return n._allTables[a]})},enumerable:!1,configurable:!0}),pt.prototype.transaction=function(){var n=(function(a,o,u){var f=arguments.length;if(f<2)throw new _e.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return u=p.pop(),[a,be(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},pt.prototype._transaction=function(n,a,o){var u,f,p=this,g=Ae.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=a.map(function(N){if(N=N instanceof p.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===Mn)u=Mn;else{if(n!="rw"&&n!=Dr)throw new _e.InvalidArgument("Invalid transaction mode: "+n);u=Dr}if(g){if(g.mode===Mn&&u===Dr){if(!m)throw new _e.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!m)throw new _e.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,S){S(N)}):pe(N)}var C=(function N(I,S,P,O,R){return me.resolve().then(function(){var D=Ae.transless||Ae,A=I._createTransaction(S,P,I._dbSchema,O),D=(A.explicit=!0,{trans:A,transless:D});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===tt.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,S,P,null,R)})):pe(V)}var B,z=oe(R),D=(z&&Pt(),me.follow(function(){var V;(B=R.call(A,A))&&(z?(V=_n.bind(null,null),B.then(V,V)):typeof B.next=="function"&&typeof B.throw=="function"&&(B=Ii(B)))},D));return(B&&typeof B.then=="function"?me.resolve(B).then(function(V){return A.active?V:pe(new _e.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):D.then(function(){return B})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),pe(V)})})}).bind(null,this,u,f,g,o);return g?g._promise(u,C,"lock"):Ae.trans?Ce(Ae.transless,function(){return p._whenReady(C)}):this._whenReady(C)},pt.prototype.table=function(n){if(_(this._allTables,n))return this._allTables[n];throw new _e.InvalidTable("Table ".concat(n," does not exist"))};var Vn=pt;function pt(n,a){var o,u,f,p,g,m=this,C=(this._middlewares={},this.verno=0,pt.dependencies),C=(this._options=a=s({addons:pt.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:He,dbReadyPromise:null,cancelOpen:He,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),I=(N.dbReadyPromise=new me(function(S){N.dbReadyResolve=S}),N.openCanceller=new me(function(S,P){N.cancelOpen=P}),this._state=N,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[ir,He]}),this.once=function(S,P){var O=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];m.on(S).unsubscribe(O),P.apply(m,R)};return m.on(S,O)},this.on.ready.subscribe=Z(this.on.ready.subscribe,function(S){return function(P,O){pt.vip(function(){var R,A=m._state;A.openComplete?(A.dbOpenError||me.resolve().then(P),O&&S(P)):A.onReadyBeingFired?(A.onReadyBeingFired.push(P),O&&S(P)):(S(P),R=m,O||S(function B(){R.on.ready.unsubscribe(P),R.on.ready.unsubscribe(B)}))})}}),this.Collection=(o=this,ja(Lc.prototype,function(B,A){this.db=o;var O=La,R=null;if(A)try{O=A()}catch(D){R=D}var A=B._ctx,B=A.table,z=B.hook.reading.fire;this._ctx={table:B,index:A.index,isPrimKey:!A.index||B.schema.primKey.keyPath&&A.index===B.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:R,or:A.or,valueMapper:z!==rn?z:null}})),this.Table=(u=this,ja(Vo.prototype,function(S,P,O){this.db=u,this._tx=O,this.name=S,this.schema=P,this.hook=u._allTables[S]?u._allTables[S].hook:qa(null,{creating:[Ra,He],reading:[sa,rn],updating:[sr,He],deleting:[Pa,He]})})),this.Transaction=(f=this,ja(jc.prototype,function(S,P,O,R,A){var B=this;S!=="readonly"&&P.forEach(function(z){z=(z=O[z])==null?void 0:z.yProps,z&&(P=P.concat(z.map(function(D){return D.updatesTable})))}),this.db=f,this.mode=S,this.storeNames=P,this.schema=O,this.chromeTransactionDurability=R,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new me(function(z,D){B._resolve=z,B._reject=D}),this._completion.then(function(){B.active=!1,B.on.complete.fire()},function(z){var D=B.active;return B.active=!1,B.on.error.fire(z),B.parent?B.parent._reject(z):D&&B.idbtrans&&B.idbtrans.abort(),pe(z)})})),this.Version=(p=this,ja(Hc.prototype,function(S){this.db=p,this._cfg={version:S,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,ja(Jo.prototype,function(S,P,O){if(this.db=g,this._ctx={table:S,index:P===":id"?null:P,or:O},this._cmp=this._ascending=We,this._descending=function(R,A){return We(A,R)},this._max=function(R,A){return 0<We(R,A)?R:A},this._min=function(R,A){return We(R,A)<0?R:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new _e.MissingAPI})),this.on("versionchange",function(S){0<S.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(S){!S.newVersion||S.newVersion<S.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(S.oldVersion/10))}),this._maxKey=Fa(a.IDBKeyRange),this._createTransaction=function(S,P,O,R){return new m.Transaction(S,P,O,m._options.chromeTransactionDurability,R)},this._fireOnBlocked=function(S){m.on("blocked").fire(S),dt.filter(function(P){return P.name===m.name&&P!==m&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(S)})},this.use(Xc),this.use(Jc),this.use(Qc),this.use(Yc),this.use(Vc),new Proxy(this,{get:function(S,P,O){var R;return P==="_vip"||(P==="table"?function(A){return Ms(m.table(A),I)}:(R=Reflect.get(S,P,O))instanceof Vo?Ms(R,I):P==="tables"?R.map(function(A){return Ms(A,I)}):P==="_createTransaction"?function(){return Ms(R.apply(this,arguments),I)}:R)}}));this.vip=I,C.forEach(function(S){return S(m)})}var Ls,pa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ef=(Di.prototype.subscribe=function(n,a,o){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:a,complete:o})},Di.prototype[pa]=function(){return this},Di);function Di(n){this._subscribe=n}try{Ls={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Ls={indexedDB:null,IDBKeyRange:null}}function hl(n){var a,o=!1,u=new ef(function(f){var p=oe(n),g,m=!1,C={},N={},I={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),S&&hr.storagemutated.unsubscribe(O))}},S=(f.start&&f.start(I),!1),P=function(){return le(R)},O=function(A){Ps(C,A),Ti(N,C)&&P()},R=function(){var A,B,z;!m&&Ls.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,z=(D=>{var V=dr();try{p&&Pt();var ne=bn(n,D);return ne=p?ne.finally(_n):ne}finally{V&&Yn()}})(B={subscr:A,signal:g.signal,requery:P,querier:n,trans:null}),Promise.resolve(z).then(function(D){o=!0,a=D,m||B.signal.aborted||(C={},(V=>{for(var ne in V)if(_(V,ne))return;return 1})(N=A)||S||(hr(za,O),S=!0),le(function(){return!m&&f.next&&f.next(D)}))},function(D){o=!1,["DatabaseClosedError","AbortError"].includes(D==null?void 0:D.name)||m||le(function(){m||f.error&&f.error(D)})}))};return setTimeout(P,0),I});return u.hasValue=function(){return o},u.getValue=function(){return a},u}var Nr=Vn;function Mi(n){var a=vr;try{vr=!0,hr.storagemutated.fire(n),Ci(n,!0)}finally{vr=a}}b(Nr,s(s({},Te),{delete:function(n){return new Nr(n,{addons:[]}).delete()},exists:function(n){return new Nr(n,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return a=Nr.dependencies,o=a.indexedDB,a=a.IDBKeyRange,(ki(o)?Promise.resolve(o.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Ft})}):wi(o,a).toCollection().primaryKeys()).then(n)}catch{return pe(new _e.MissingAPI)}var a,o},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Ae.trans?Ce(Ae.transless,n):n()},vip:xi,async:function(n){return function(){try{var a=Ii(n.apply(this,arguments));return a&&typeof a.then=="function"?a:me.resolve(a)}catch(o){return pe(o)}}},spawn:function(n,a,o){try{var u=Ii(n.apply(o,a||[]));return u&&typeof u.then=="function"?u:me.resolve(u)}catch(f){return pe(f)}},currentTransaction:{get:function(){return Ae.trans||null}},waitFor:function(n,a){return n=me.resolve(typeof n=="function"?Nr.ignoreTransaction(n):n).timeout(a||6e4),Ae.trans?Ae.trans.waitFor(n):n},Promise:me,debug:{get:function(){return Xt},set:function(n){Oa(n)}},derive:q,extend:v,props:b,override:Z,Events:qa,on:hr,liveQuery:hl,extendObservabilitySet:Ps,getByKeyPath:ie,setByKeyPath:Q,delByKeyPath:function(n,a){typeof a=="string"?Q(n,a,void 0):"length"in a&&[].map.call(a,function(o){Q(n,o,void 0)})},shallowClone:he,deepClone:$,getObjectDiff:Ri,cmp:We,asap:ee,minKey:-1/0,addons:[],connections:dt,errnames:tt,dependencies:Ls,cache:Lr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,a,o){return n+a/Math.pow(10,2*o)})})),Nr.maxKey=Fa(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(hr(za,function(n){vr||(n=new CustomEvent(hi,{detail:n}),vr=!0,dispatchEvent(n),vr=!1)}),addEventListener(hi,function(n){n=n.detail,vr||Mi(n)}));var ha,vr=!1,vl=function(){};return typeof BroadcastChannel<"u"&&((vl=function(){(ha=new BroadcastChannel(hi)).onmessage=function(n){return n.data&&Mi(n.data)}})(),typeof ha.unref=="function"&&ha.unref(),hr(za,function(n){vr||ha.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Vn.disableBfCache&&n.persisted){Xt&&console.debug("Dexie: handling persisted pagehide"),ha!=null&&ha.close();for(var a=0,o=dt;a<o.length;a++)o[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Vn.disableBfCache&&n.persisted&&(Xt&&console.debug("Dexie: handling persisted pageshow"),vl(),Mi({all:new Ot(-1/0,[[]])}))})),me.rejectionMapper=function(n,a){return!n||n instanceof Le||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Lt[n.name]?n:(a=new Lt[n.name](a||n.message,n),"stack"in n&&M(a,"stack",{get:function(){return this.inner.stack}}),a)},Oa(Xt),s(Vn,Object.freeze({__proto__:null,Dexie:Vn,Entity:Uo,PropModification:Na,RangeSet:Ot,add:function(n){return new Na({add:n})},cmp:We,default:Vn,liveQuery:hl,mergeRanges:Ga,rangesOverlap:al,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,a){return new Na({replacePrefix:[n,a]})}}),{default:Vn}),Vn})})(Vs)),Vs.exports}var zd=Bd();const io=qd(zd),Ml=Symbol.for("Dexie"),Wt=globalThis[Ml]||(globalThis[Ml]=io);if(io.semVer!==Wt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${io.semVer} and ${Wt.semVer}`);const{liveQuery:Mm,mergeRanges:Lm,rangesOverlap:Nm,RangeSet:qm,cmp:jm,Entity:Bm,PropModification:zm,replacePrefix:Fm,add:Km,remove:Um,DexieYProvider:Gm}=Wt,qe=new Wt("me-ai-store");qe.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});qe.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});qe.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});qe.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function sc(t,e){return`${t}:${e}`}async function Fd(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],s=await qe.items.where("[sourceType+date]").between(["gmail",Wt.minKey],["gmail",Wt.maxKey]).first(),i=await qe.items.where("[sourceType+date]").between(["gmail",Wt.minKey],["gmail",Wt.maxKey]).last();if(s&&i){const c=new Date(s.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const l=await ic(5);return l.length>0&&r.push("Top senders: "+l.map(([c,d])=>`${Xd(c)} (${d})`).join(", ")+"."),r.join(" ")}async function Kd(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.contacts.count();if(t===0)return"No emails stored locally.";const r=await ic(10),s=await Yd(10),i=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],l=await qe.items.where("sourceType").equals("gmail").sortBy("date");if(l.length>0){const c=new Date(l[0].date).toLocaleDateString(),d=new Date(l[l.length-1].date).toLocaleDateString();i.push(`- **Date range:** ${c} â ${d}`)}if(r.length>0){i.push("","### Top Senders");for(const[c,d]of r)i.push(`- ${c}: ${d}`)}if(s.length>0){i.push("","### Labels");for(const[c,d]of s)i.push(`- ${c}: ${d}`)}return i.join(`
`)}async function Ud(t=10){const e=await qe.items.where("[sourceType+date]").between(["gmail",Wt.minKey],["gmail",Wt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(oc).join(`

---

`)}async function Gd(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await qe.items.toArray()).map(l=>{var d,v,h,y,_;let c=0;return(d=l.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=l.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(h=l.to)!=null&&h.toLowerCase().includes(r)&&(c+=2),(y=l.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(_=l.body)!=null&&_.toLowerCase().includes(r)&&(c+=1),{item:l,score:c}}).filter(({score:l})=>l>0).sort((l,c)=>c.score-l.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:l})=>oc(l)).join(`

---

`)}async function Hd(){const t=await Fd();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Wd(t){const e=[],r=await Kd();if(e.push(r),t){const s=await Gd(t,5);e.push("","## Relevant Emails",s)}else{const s=await Ud(5);e.push("","## Recent Emails",s)}return e.join(`
`)}async function ic(t){const e=await qe.items.where("sourceType").equals("gmail").toArray(),r={};for(const s of e){const i=s.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((s,i)=>i[1]-s[1]).slice(0,t)}async function Yd(t){const e=await qe.items.where("sourceType").equals("gmail").toArray(),r={};for(const s of e)for(const i of s.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((s,i)=>i[1]-s[1]).slice(0,t)}function oc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Vd(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}function Vd(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function Xd(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}async function Qd({query:t,limit:e=50,offset:r=0}={}){if(t){const l=t.toLowerCase(),c=await qe.items.where("sourceType").equals("gmail").filter(d=>{var v,h,y,_;return((v=d.subject)==null?void 0:v.toLowerCase().includes(l))||((h=d.from)==null?void 0:h.toLowerCase().includes(l))||((y=d.to)==null?void 0:y.toLowerCase().includes(l))||((_=d.snippet)==null?void 0:_.toLowerCase().includes(l))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const s=await qe.items.where("sourceType").equals("gmail").count();return{items:await qe.items.where("[sourceType+date]").between(["gmail",Wt.minKey],["gmail",Wt.maxKey]).reverse().offset(r).limit(e).toArray(),total:s}}function oo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,s)).toFixed(1)+" "+r[s]}function Ki(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,s),l=s>=2?2:s>=1?1:0;return i.toFixed(l)+" "+r[s]}function Zd(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}const $d=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Ll(...t){$d&&console.log("[debug]",...t)}function nn(t){return Ll(`[MOUNT] ${t}`),()=>Ll(`[DESTROY] ${t}`)}var Jd=X("<option> </option>"),ep=X('<p class="model-description svelte-1p89qnn"> </p>'),tp=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),np=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),rp=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),ap=X('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),sp=X('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),ip=X('<p class="error svelte-1p89qnn"> </p>'),op=X('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function lp(t,e){ut(e,!0);let r=Re(e,"selectedModel",15),s=Re(e,"gpuInfo",3,null),i=Re(e,"error",3,null);Rt(()=>nn("ModelSelector"));var l=op(),c=L(x(l),2),d=L(x(c),2);Pn(d,21,()=>os,Tr,(q,T)=>{var K=Jd(),se=x(K),Z={};ye(()=>{ue(se,`${k(T).name??""} â ${k(T).size??""}`),Z!==(Z=k(T).id)&&(K.value=(K.__value=k(T).id)??"")}),W(q,K)});var v=L(d,2);{var h=q=>{const T=Mt(()=>os.find(H=>H.id===r()));var K=ec(),se=Et(K);{var Z=H=>{var ee=ep(),ie=x(ee);ye(()=>ue(ie,k(T).description)),W(H,ee)};ke(se,H=>{k(T)&&H(Z)})}W(q,K)};ke(v,q=>{r()&&q(h)})}var y=L(c,2);{var _=q=>{var T=sp(),K=L(x(T),2),se=x(K),Z=L(x(se)),H=x(Z),ee=L(se,2),ie=L(x(ee)),Q=x(ie),he=L(ee,2);{var De=ce=>{var de=tp(),j=L(x(de)),U=x(j);ye(()=>ue(U,s().device)),W(ce,de)};ke(he,ce=>{s().device&&s().device!=="unknown"&&ce(De)})}var be=L(he,2);{var re=ce=>{var de=np(),j=L(x(de)),U=x(j);ye(()=>ue(U,s().description)),W(ce,de)};ke(be,ce=>{s().description&&s().description!=="unknown"&&ce(re)})}var Y=L(be,2);{var $=ce=>{var de=rp(),j=L(x(de)),U=x(j);ye(J=>ue(U,J),[()=>oo(s().limits.maxBufferSize)]),W(ce,de)};ke(Y,ce=>{var de;(de=s().limits)!=null&&de.maxBufferSize&&ce($)})}var Ie=L(Y,2);{var te=ce=>{var de=ap(),j=L(x(de)),U=x(j);ye(()=>ue(U,`${s().features.length??""} supported`)),W(ce,de)};ke(Ie,ce=>{var de;(de=s().features)!=null&&de.length&&ce(te)})}ye(()=>{ue(H,s().vendor),ue(Q,s().architecture)}),W(q,T)};ke(y,q=>{s()&&q(_)})}var b=L(y,2);{var w=q=>{var T=ip(),K=x(T);ye(()=>ue(K,i())),W(q,T)};ke(b,q=>{i()&&q(w)})}var M=L(b,2);M.__click=function(...q){var T;(T=e.onload)==null||T.apply(this,q)},ye(()=>M.disabled=i()),Ro(d,r),W(t,l),ct()}Vt(["click"]);var up=X('<span class="progress-percent svelte-r5fnze"> </span>'),cp=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),fp=X('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),dp=X('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),pp=X('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),hp=X('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),vp=X('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function gp(t,e){ut(e,!0);let r=Re(e,"message",3,""),s=Re(e,"items",19,()=>[]);Rt(()=>nn("LoadingProgress"));var i=vp(),l=x(i),c=x(l),d=L(l,2);Pn(d,17,s,Tr,(v,h)=>{const y=Mt(()=>k(h).total?Zd(k(h).loaded||0,k(h).total):null);var _=hp(),b=x(_),w=x(b),M=x(w),q=L(w,2);{var T=H=>{var ee=up(),ie=x(ee);ye(Q=>ue(ie,`${Q??""}%`),[()=>k(y).toFixed(1)]),W(H,ee)};ke(q,H=>{k(y)!==null&&H(T)})}var K=L(b,2);{var se=H=>{var ee=cp(),ie=Et(ee),Q=x(ie),he=L(ie,2),De=x(he),be=x(De),re=L(De,4),Y=x(re),$=L(re,2),Ie=x($);ye((te,ce,de,j,U)=>{In(Q,`width: ${te??""}%`),ue(be,ce),ue(Y,de),ue(Ie,`(${j??""} / ${U??""} B)`)},[()=>Math.max(k(h).progress??0,.5).toFixed(1),()=>Ki(k(h).loaded||0),()=>Ki(k(h).total),()=>(k(h).loaded||0).toLocaleString(),()=>k(h).total.toLocaleString()]),W(H,ee)},Z=H=>{var ee=pp(),ie=L(Et(ee),2),Q=x(ie);{var he=be=>{var re=fp(),Y=Et(re),$=x(Y),Ie=L(Y,2),te=x(Ie);ye((ce,de)=>{ue($,ce),ue(te,`(${de??""} B)`)},[()=>Ki(k(h).loaded),()=>k(h).loaded.toLocaleString()]),W(be,re)},De=be=>{var re=dp();W(be,re)};ke(Q,be=>{k(h).loaded?be(he):be(De,!1)})}W(H,ee)};ke(K,H=>{k(h).total?H(se):H(Z,!1)})}ye(()=>{nc(w,"title",k(h).file),ue(M,k(h).file)}),W(v,_)}),ye(()=>ue(c,r())),W(t,i),ct()}var mp=X('<span class="thinking-tokens svelte-11gjw00"> </span>'),yp=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),bp=X('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),_p=X('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),wp=X('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),kp=X('<span class="cursor svelte-11gjw00">|</span>'),xp=X(" <!>",1),Sp=X('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Tp=X('<div class="content svelte-11gjw00"> </div>'),Ep=X('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Ap(t,e){ut(e,!0);let r=Re(e,"isLast",3,!1),s=Re(e,"isRunning",3,!1),i=Re(e,"generationPhase",3,null),l=Re(e,"numTokens",3,null);Rt(()=>nn(`MessageBubble[${e.msg.role}]`));var c=Ep(),d=x(c),v=x(d),h=L(d,2);{var y=b=>{var w=Sp(),M=Et(w);{var q=Q=>{var he=yp(),De=L(x(he),4);{var be=re=>{var Y=mp(),$=x(Y);ye(()=>ue($,`${l()??""} tokens`)),W(re,Y)};ke(De,re=>{l()&&re(be)})}W(Q,he)},T=Q=>{var he=bp();W(Q,he)};ke(M,Q=>{s()&&r()&&i()==="thinking"?Q(q):s()&&r()&&i()==="preparing"&&Q(T,1)})}var K=L(M,2);{var se=Q=>{var he=_p(),De=x(he),be=L(x(De),2),re=x(be),Y=L(De,2),$=x(Y);ye(Ie=>{ue(re,`${Ie??""} words`),ue($,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),W(Q,he)};ke(K,Q=>{e.msg.thinking&&Q(se)})}var Z=L(K,2),H=x(Z);{var ee=Q=>{var he=wp();W(Q,he)},ie=Q=>{var he=xp(),De=Et(he,!0),be=L(De);{var re=Y=>{var $=kp();W(Y,$)};ke(be,Y=>{s()&&r()&&Y(re)})}ye(()=>ue(De,e.msg.content)),W(Q,he)};ke(H,Q=>{s()&&r()&&!e.msg.content&&i()!=="thinking"?Q(ee):Q(ie,!1)})}W(b,w)},_=b=>{var w=Tp(),M=x(w);ye(()=>ue(M,e.msg.content)),W(b,w)};ke(h,b=>{e.msg.role==="assistant"?b(y):b(_,!1)})}ye(()=>{dn(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),ue(v,e.msg.role==="user"?"You":"AI")}),W(t,c),ct()}var Cp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Ip=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Rp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Pp=X('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Op=X('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Dp=X('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Mp=X('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Lp(t,e){ut(e,!0),Rt(()=>nn("GpuPanel"));var r=Mp(),s=x(r),i=L(x(s),2),l=L(x(i),2),c=x(l),d=L(i,2),v=L(x(d),2),h=x(v),y=L(d,2);{var _=H=>{var ee=Cp(),ie=L(x(ee),2),Q=x(ie);ye(()=>ue(Q,e.gpuInfo.device)),W(H,ee)};ke(y,H=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&H(_)})}var b=L(y,2);{var w=H=>{var ee=Ip(),ie=L(x(ee),2),Q=x(ie);ye(he=>ue(Q,he),[()=>oo(e.gpuInfo.limits.maxBufferSize)]),W(H,ee)};ke(b,H=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxBufferSize&&H(w)})}var M=L(b,2);{var q=H=>{var ee=Rp(),ie=L(x(ee),2),Q=x(ie);ye(()=>ue(Q,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),W(H,ee)};ke(M,H=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeInvocationsPerWorkgroup&&H(q)})}var T=L(M,2);{var K=H=>{var ee=Pp(),ie=L(x(ee),2),Q=x(ie);ye(he=>ue(Q,he),[()=>oo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),W(H,ee)};ke(T,H=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeWorkgroupStorageSize&&H(K)})}var se=L(T,2);{var Z=H=>{var ee=Dp(),ie=x(ee),Q=x(ie),he=L(ie,2);Pn(he,21,()=>e.gpuInfo.features,Tr,(De,be)=>{var re=Op(),Y=x(re);ye(()=>ue(Y,k(be))),W(De,re)}),ye(()=>ue(Q,`Features (${e.gpuInfo.features.length??""})`)),W(H,ee)};ke(se,H=>{var ee;(ee=e.gpuInfo.features)!=null&&ee.length&&H(Z)})}ye(()=>{ue(c,e.gpuInfo.vendor),ue(h,e.gpuInfo.architecture)}),W(t,r),ct()}var Np=X('<button class="gpu-badge svelte-1ktw27c"> </button>'),qp=X('<span class="stats svelte-1ktw27c"> </span>'),jp=X('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Bp=X('<span class="stats preparing svelte-1ktw27c"> </span>'),zp=X('<span class="stats svelte-1ktw27c"> </span>'),Fp=X('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Kp=X('<button class="btn svelte-1ktw27c">Stop</button>'),Up=X('<button class="btn primary svelte-1ktw27c">Send</button>'),Gp=X('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Hp(t,e){ut(e,!0),Rt(()=>nn("ChatView"));let r=Re(e,"messages",19,()=>[]),s=Re(e,"isRunning",3,!1),i=Re(e,"tps",3,null),l=Re(e,"numTokens",3,null),c=Re(e,"generationPhase",3,null),d=Re(e,"gpuInfo",3,null),v=Re(e,"chatContainer",15),h=Oe(""),y=Oe(!1);function _(j){j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),b())}function b(){const j=k(h).trim();!j||s()||(F(h,""),e.onsend(j))}var w=Gp(),M=x(w),q=x(M);{var T=j=>{var U=Np();U.__click=()=>F(y,!k(y));var J=x(U);ye(()=>ue(J,`WebGPU ${k(y)?"â²":"â¼"}`)),W(j,U)};ke(q,j=>{d()&&j(T)})}var K=L(q,2);{var se=j=>{var U=qp(),J=x(U);ye((oe,Te)=>ue(J,`${l()??""} tokens in ${oe??""}s
        (${Te??""} tok/s)`),[()=>(l()/i()).toFixed(1),()=>i().toFixed(1)]),W(j,U)},Z=j=>{var U=jp();W(j,U)},H=j=>{var U=Bp(),J=x(U);ye(oe=>ue(J,`thinking... ${oe??""}`),[()=>i()?`${i().toFixed(0)} tok/s`:""]),W(j,U)},ee=j=>{var U=zp(),J=x(U);ye(oe=>ue(J,`${oe??""} tok/s`),[()=>i().toFixed(1)]),W(j,U)};ke(K,j=>{i()&&!s()?j(se):s()&&c()==="preparing"?j(Z,1):s()&&c()==="thinking"?j(H,2):i()&&s()&&j(ee,3)})}var ie=L(K,4);ie.__click=function(...j){var U;(U=e.onreset)==null||U.apply(this,j)};var Q=L(M,2);{var he=j=>{Lp(j,{get gpuInfo(){return d()}})};ke(Q,j=>{k(y)&&d()&&j(he)})}var De=L(Q,2),be=x(De);{var re=j=>{var U=Fp();W(j,U)};ke(be,j=>{r().length===0&&j(re)})}var Y=L(be,2);Pn(Y,17,r,Tr,(j,U,J)=>{{let oe=Mt(()=>J===r().length-1);Ap(j,{get msg(){return k(U)},get isLast(){return k(oe)},get isRunning(){return s()},get generationPhase(){return c()},get numTokens(){return l()}})}}),rc(De,j=>v(j),()=>v());var $=L(De,2),Ie=x($);Ie.__keydown=_;var te=L(Ie,2);{var ce=j=>{var U=Kp();U.__click=function(...J){var oe;(oe=e.onstop)==null||oe.apply(this,J)},W(j,U)},de=j=>{var U=Up();U.__click=b,ye(J=>U.disabled=J,[()=>!k(h).trim()]),W(j,U)};ke(te,j=>{s()?j(ce):j(de,!1)})}ye(()=>{ie.disabled=s(),Ie.disabled=s()}),Po(Ie,()=>k(h),j=>F(h,j)),W(t,w),ct()}Vt(["click","keydown"]);var Wp=X('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Yp(t,e){ut(e,!0);const r=!!navigator.gpu,s=ac();let i=Oe(Tt(localStorage.getItem("selectedModel")||os[0].id)),l=Oe(null),c=Oe(null),d=Oe(""),v=Oe(Tt([])),h=Oe(Tt([])),y=Oe(!1),_=Oe(null),b=Oe(null),w=Oe(null),M=Oe(null),q=Oe(null);Rt(()=>{s.check();const re=s.onMessage(Y=>{switch(Y.status){case"webgpu-info":F(M,Y.data,!0);break;case"loading":F(l,"loading"),F(d,Y.data,!0);break;case"initiate":F(v,[...k(v),Y],!0);break;case"progress":F(v,k(v).map($=>$.file===Y.file?{...$,...Y}:$),!0);break;case"done":F(v,k(v).filter($=>$.file!==Y.file),!0);break;case"ready":F(l,"ready");break;case"start":if(!k(y))break;F(q,Y.phase||"preparing",!0),F(h,[...k(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!k(y))break;F(q,Y.phase,!0);break;case"thinking":{if(!k(y))break;F(_,Y.tps,!0),F(b,Y.numTokens,!0);const $=k(h)[k(h).length-1];F(h,[...k(h).slice(0,-1),{...$,thinking:($.thinking||"")+Y.content}],!0),T();break}case"thinking-done":{if(!k(y))break;F(_,Y.tps,!0),F(b,Y.numTokens,!0);const $=k(h)[k(h).length-1];F(h,[...k(h).slice(0,-1),{...$,thinking:Y.content}],!0);break}case"update":{if(!k(y))break;F(_,Y.tps,!0),F(b,Y.numTokens,!0);const $=k(h)[k(h).length-1];F(h,[...k(h).slice(0,-1),{...$,content:$.content+Y.output}],!0),T();break}case"complete":if(!k(y))break;F(y,!1),F(q,null);break;case"error":if(!k(y))break;F(c,Y.data,!0),F(y,!1),F(q,null);break}});return()=>re()});function T(){Qu().then(()=>{k(w)&&(k(w).scrollTop=k(w).scrollHeight)})}function K(){F(l,"loading"),localStorage.setItem("selectedModel",k(i)),s.loadModel(k(i))}async function se(re){if(!re||k(y))return;F(h,[...k(h),{role:"user",content:re}],!0),F(_,null),F(y,!0);let Y=[];try{const Ie=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail)\b/i;let te;Ie.test(re)?te=await Wd(re):te=await Hd(),te&&(Y=[{role:"system",content:te}])}catch{}const $=k(h).map(Ie=>({role:Ie.role,content:Ie.content}));s.generate([...Y,...$]),T()}function Z(){s.interrupt()}function H(){s.reset(),F(h,[],!0),F(_,null),F(b,null)}var ee=ec(),ie=Et(ee);{var Q=re=>{var Y=Wp();W(re,Y)},he=re=>{lp(re,{get gpuInfo(){return k(M)},get error(){return k(c)},onload:K,get selectedModel(){return k(i)},set selectedModel(Y){F(i,Y,!0)}})},De=re=>{gp(re,{get message(){return k(d)},get items(){return k(v)}})},be=re=>{Hp(re,{get messages(){return k(h)},get isRunning(){return k(y)},get tps(){return k(_)},get numTokens(){return k(b)},get generationPhase(){return k(q)},get gpuInfo(){return k(M)},onsend:se,onstop:Z,onreset:H,get chatContainer(){return k(w)},set chatContainer(Y){F(w,Y,!0)}})};ke(ie,re=>{r?k(l)===null?re(he,1):k(l)==="loading"?re(De,2):re(be,!1):re(Q)})}W(t,ee),ct()}const Nl="https://accounts.google.com/gsi/client",Vp="https://www.googleapis.com/auth/gmail.readonly";let lo=null,Xs=null;function Xp(){return new Promise((t,e)=>{var i,l;if((l=(i=window.google)==null?void 0:i.accounts)!=null&&l.oauth2){t();return}const r=document.querySelector(`script[src="${Nl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const s=document.createElement("script");s.src=Nl,s.async=!0,s.defer=!0,s.onload=()=>t(),s.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(s)})}async function ql(t){await Xp(),lo=google.accounts.oauth2.initTokenClient({client_id:t,scope:Vp,callback:e=>{Xs&&(Xs(e),Xs=null)}})}function Qp(){return new Promise((t,e)=>{if(!lo){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Xs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},lo.requestAccessToken()})}function Zp(t){return new Promise(e=>{var r,s;(s=(r=window.google)==null?void 0:r.accounts)!=null&&s.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const $p="https://gmail.googleapis.com/gmail/v1/users/me";function Jp(t){return{Authorization:`Bearer ${t}`}}async function ui(t,e){var s;const r=await fetch(`${$p}${e}`,{headers:Jp(t)});if(!r.ok){const i=await r.json().catch(()=>({}));throw new Error(((s=i.error)==null?void 0:s.message)||`Gmail API error: ${r.status}`)}return r.json()}function lc(t){return ui(t,"/profile")}function uc(t,{maxResults:e=20,pageToken:r,q:s}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),s&&i.set("q",s),ui(t,`/messages?${i}`)}function cc(t,e,r="full"){return ui(t,`/messages/${e}?format=${r}`)}function eh(t,{startHistoryId:e,pageToken:r,maxResults:s=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(s)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),ui(t,`/history?${i}`)}function mr(t,e){var l;const r=((l=t==null?void 0:t.payload)==null?void 0:l.headers)||[],s=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===s);return(i==null?void 0:i.value)||""}function as(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const s=atob(e),i=Uint8Array.from(s,l=>l.charCodeAt(0));return new TextDecoder().decode(i)}function th(t){var l,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((l=e.body)!=null&&l.data)return as(e.body.data);const r=e.parts||[],s=Js(r,"text/plain");if((c=s==null?void 0:s.body)!=null&&c.data)return as(s.body.data);const i=Js(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=as(i.body.data);return rh(v)}return"(no body)"}function nh(t){var i,l;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return as(e.body.data);const r=e.parts||[],s=Js(r,"text/html");return(l=s==null?void 0:s.body)!=null&&l.data?as(s.body.data):null}function Js(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const s=Js(r.parts,e);if(s)return s}}return null}function rh(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}const At="gmail",jl=8,fc=50,dc=100;async function ah(t,{limit:e=fc,onProgress:r=()=>{},signal:s}={}){var c,d,v,h;const i=await qe.syncState.get(At);if(i!=null&&i.historyId)try{return await ch(t,i,r,s)}catch(y){if((c=y.message)!=null&&c.includes("404")||(d=y.message)!=null&&d.includes("notFound")||(v=y.message)!=null&&v.includes("Start history id")||(h=y.message)!=null&&h.includes("history_types"))r({phase:"info",message:"History expired, performing full re-sync..."}),await qe.syncState.delete(At);else throw y}return await lh(t,e===0?1/0:e,r,s)}async function sh(t,{limit:e=fc,onProgress:r=()=>{},signal:s}={}){const i=await qe.syncState.get(At);return i!=null&&i.oldestPageToken?await uh(t,i,e===0?1/0:e,r,s):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function ih(){const t=await qe.syncState.get(At);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function oh(){await qe.transaction("rw",[qe.items,qe.syncState],async()=>{await qe.items.where("sourceType").equals(At).delete(),await qe.syncState.delete(At)})}async function lh(t,e,r,s){r({phase:"counting",message:"Getting mailbox info..."}),ta(s);const i=await lc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const l=[];let c,d=null;for(;l.length<e;){ta(s);const _=e-l.length,b=await uc(t,{maxResults:Math.min(dc,_),pageToken:c}),w=(b.messages||[]).map(M=>M.id);if(l.push(...w),r({phase:"listing",message:`Listed ${l.length} messages...`,current:l.length,total:Math.min(i.messagesTotal||e,e)}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,l.length===0)return await qe.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await pc(t,l,r,s),y=await qe.items.where("sourceType").equals(At).count();return await qe.syncState.put({sourceType:At,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function uh(t,e,r,s,i){s({phase:"listing",message:"Loading more messages...",current:0}),ta(i);const l=[];let c=e.oldestPageToken,d=null;for(;l.length<r;){ta(i);const _=r-l.length,b=await uc(t,{maxResults:Math.min(dc,_),pageToken:c}),w=(b.messages||[]).map(M=>M.id);if(l.push(...w),s({phase:"listing",message:`Listed ${l.length} more messages...`,current:l.length}),c=b.nextPageToken,!c||w.length===0)break}if(d=c||null,l.length===0)return await qe.syncState.update(At,{oldestPageToken:null,lastSyncAt:Date.now()}),s({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await pc(t,l,s,i),y=await qe.items.where("sourceType").equals(At).count();return await qe.syncState.update(At,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),s({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:h}}async function ch(t,e,r,s){r({phase:"syncing",message:"Checking for changes..."}),ta(s);let i=0,l=0,c=0,d,v=e.historyId;do{ta(s);const y=await eh(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const _ of y.history){if(_.messagesAdded){const b=_.messagesAdded.map(M=>M.message.id),w=[...new Set(b.filter(M=>M))];if(w.length>0){const M=await Promise.allSettled(w.map(T=>cc(t,T))),q=[];for(const T of M)T.status==="fulfilled"?q.push(hc(T.value)):c++;q.length>0&&(await qe.items.bulkPut(q),await vc(q),i+=q.length)}}if(_.messagesDeleted){const b=_.messagesDeleted.map(w=>sc(At,w.message.id)).filter(w=>w);b.length>0&&(await qe.items.bulkDelete(b),l+=b.length)}}r({phase:"syncing",message:`Changes: +${i} -${l}`,current:i+l})}}while(d);const h=await qe.items.where("sourceType").equals(At).count();return await qe.syncState.put({sourceType:At,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&l===0?"Already up to date":`Synced: +${i} -${l}`,current:h,total:h}),{added:i,deleted:l,errors:c}}async function pc(t,e,r,s){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,l=0;for(let c=0;c<e.length;c+=jl){ta(s);const d=e.slice(c,c+jl),v=await Promise.allSettled(d.map(y=>cc(t,y))),h=[];for(const y of v)y.status==="fulfilled"?h.push(hc(y.value)):l++;h.length>0&&(await qe.items.bulkPut(h),await vc(h)),i+=h.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:l}}function hc(t){const e=mr(t,"From"),r=mr(t,"To"),s=mr(t,"Cc"),i=mr(t,"Subject")||"(no subject)",l=mr(t,"Date"),c=mr(t,"Message-ID"),d=mr(t,"In-Reply-To"),v=mr(t,"References");let h;try{h=l?new Date(l).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:sc(At,t.id),sourceType:At,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:s,subject:i,snippet:t.snippet||"",body:th(t),htmlBody:nh(t),date:h,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function vc(t){const e=new Map;for(const r of t)for(const s of[r.from,r.to,r.cc]){if(!s)continue;const i=s.split(",").map(l=>l.trim()).filter(Boolean);for(const l of i){const c=fh(l);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:s,date:i}]of e)try{const l=await qe.contacts.where("email").equals(r).first();if(l){const c={};s&&!l.name&&(c.name=s),i>(l.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await qe.contacts.update(l.id,c)}else await qe.contacts.add({email:r,name:s||"",firstSeen:i,lastSeen:i})}catch{}}function fh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const s=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:s,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ta(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var dh=X(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function ph(t,e){ut(e,!0);let r=Re(e,"clientIdInput",15);Rt(()=>nn("SetupGuide"));let s=Oe(null);async function i(Le){try{await navigator.clipboard.writeText(Le),F(s,Le,!0),setTimeout(()=>{F(s,null)},1500)}catch{const Ee=document.createElement("input");Ee.value=Le,document.body.appendChild(Ee),Ee.select(),document.execCommand("copy"),document.body.removeChild(Ee),F(s,Le,!0),setTimeout(()=>{F(s,null)},1500)}}const l="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=dh(),h=x(v),y=L(x(h),4),_=L(x(y),6),b=L(x(_),2),w=L(x(b),2),M=L(x(w),2),q=x(M);q.__click=()=>i(l);var T=x(q);T.textContent="http://localhost:5173";var K=L(T,2),se=x(K),Z=L(q,2);Z.__click=()=>i(c);var H=x(Z);H.textContent="https://cypherkitty.github.io";var ee=L(H,2),ie=x(ee),Q=L(w,2),he=L(x(Q),2),De=x(he);De.__click=()=>i(l);var be=x(De);be.textContent="http://localhost:5173";var re=L(be,2),Y=x(re),$=L(De,2);$.__click=()=>i(c);var Ie=x($);Ie.textContent="https://cypherkitty.github.io";var te=L(Ie,2),ce=x(te),de=L($,2);de.__click=()=>i(d);var j=x(de);j.textContent="https://cypherkitty.github.io/me-ai/";var U=L(j,2),J=x(U),oe=L(y,2),Te=x(oe);Te.__keydown=Le=>Le.key==="Enter"&&e.onsave();var Me=L(Te,2);Me.__click=function(...Le){var Ee;(Ee=e.onsave)==null||Ee.apply(this,Le)},ye(Le=>{ue(se,k(s)===l?"â":"â§"),ue(ie,k(s)===c?"â":"â§"),ue(Y,k(s)===l?"â":"â§"),ue(ce,k(s)===c?"â":"â§"),ue(J,k(s)===d?"â":"â§"),Me.disabled=Le},[()=>!r().trim()]),Po(Te,r),W(t,v),ct()}Vt(["click","keydown"]);function hh(t){const e=t||"";if(e.includes("has not been used in project")||e.includes("is disabled")){const r=e.match(/project\s+(\d+)/),s=r==null?void 0:r[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:s?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${s}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return e.includes("Invalid Credentials")||e.includes("401")||e.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:e.includes("insufficient")&&e.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:e.includes("access_denied")||e.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:e.includes("popup")||e.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:e.includes("Rate Limit")||e.includes("429")||e.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:e,fix:null}}var vh=X('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),gh=X('<div class="error-card-title svelte-14buhqq"> </div>'),mh=X('<p class="error-card-fix svelte-14buhqq"> </p>'),yh=X('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),bh=X('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),_h=X('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function gc(t,e){ut(e,!0);let r=Re(e,"ondismiss",3,null),s=Re(e,"onsignout",3,null),i=Mt(()=>hh(e.error));Rt(()=>nn("ErrorCard"));var l=_h(),c=x(l);{var d=K=>{var se=vh(),Z=x(se),H=x(Z),ee=L(Z,2);ee.__click=function(...ie){var Q;(Q=r())==null||Q.apply(this,ie)},ye(()=>ue(H,k(i).title)),W(K,se)},v=K=>{var se=gh(),Z=x(se);ye(()=>ue(Z,k(i).title)),W(K,se)};ke(c,K=>{r()?K(d):K(v,!1)})}var h=L(c,2),y=x(h),_=L(h,2);{var b=K=>{var se=mh(),Z=x(se);ye(()=>ue(Z,k(i).fix)),W(K,se)};ke(_,K=>{k(i).fix&&K(b)})}var w=L(_,2);{var M=K=>{var se=yh(),Z=x(se);ye(()=>{nc(se,"href",k(i).link.url),ue(Z,`${k(i).link.label??""} â`)}),W(K,se)};ke(w,K=>{k(i).link&&K(M)})}var q=L(w,2);{var T=K=>{var se=bh();se.__click=function(...Z){var H;(H=s())==null||H.apply(this,Z)},W(K,se)};ke(q,K=>{k(i).action==="signout"&&s()&&K(T)})}ye(()=>ue(y,k(i).description)),W(t,l),ct()}Vt(["click"]);var wh=X('<span class="spinner svelte-nyqevv"></span> Signing in...',1),kh=Io('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),xh=X(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function Sh(t,e){ut(e,!0);let r=Re(e,"error",3,null),s=Re(e,"loadingAuth",3,!1);Rt(()=>nn("AuthCard"));var i=xh(),l=x(i),c=L(x(l),4);{var d=T=>{gc(T,{get error(){return r()},get onsignout(){return e.onsignout}})};ke(c,T=>{r()&&T(d)})}var v=L(c,2);v.__click=function(...T){var K;(K=e.onsignin)==null||K.apply(this,T)};var h=x(v);{var y=T=>{var K=wh();W(T,K)},_=T=>{var K=kh();W(T,K)};ke(h,T=>{s()?T(y):T(_,!1)})}var b=L(v,2),w=L(x(b),2),M=x(w),q=L(w,2);q.__click=function(...T){var K;(K=e.onclear)==null||K.apply(this,T)},ye(T=>{v.disabled=s(),ue(M,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),W(t,i),ct()}Vt(["click"]);function Oo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function mc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function yc(t){return mc(t).charAt(0).toUpperCase()}var Th=X('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Eh=X('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Ah=X('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function Ch(t,e){ut(e,!0);let r=Re(e,"profile",3,null),s=Re(e,"loadingProfile",3,!1);Rt(()=>nn("ProfileCard"));var i=Ah(),l=x(i),c=x(l),d=L(l,2),v=x(d);{var h=b=>{var w=Th();W(b,w)},y=b=>{var w=Eh(),M=Et(w),q=x(M),T=L(M,2),K=x(T);ye((se,Z)=>{ue(q,r().emailAddress),ue(K,`${se??""} messages
        Â· ${Z??""} threads`)},[()=>{var se;return((se=r().messagesTotal)==null?void 0:se.toLocaleString())||"?"},()=>{var se;return((se=r().threadsTotal)==null?void 0:se.toLocaleString())||"?"}]),W(b,w)};ke(v,b=>{s()?b(h):r()&&b(y,1)})}var _=L(d,2);_.__click=function(...b){var w;(w=e.onsignout)==null||w.apply(this,b)},ye(b=>ue(c,b),[()=>r()?yc(r().emailAddress):"?"]),W(t,i),ct()}Vt(["click"]);var Ih=X('<span class="spinner svelte-1ds3j4k"></span>'),Rh=Io('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Ph=X('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),Oh=X('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Dh=X('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Mh=X('<option class="svelte-1ds3j4k"> </option>'),Lh=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Nh=X('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),qh=X('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),jh=X('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Bh=X('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),zh=X('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Fh(t,e){ut(e,!0),Rt(()=>nn("SyncStatus"));let r=Re(e,"syncStatus",3,null),s=Re(e,"syncProgress",3,null),i=Re(e,"isSyncing",3,!1),l=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(j){if(!j)return"never";const U=Math.floor((Date.now()-j)/1e3);if(U<60)return"just now";const J=Math.floor(U/60);if(J<60)return`${J}m ago`;const oe=Math.floor(J/60);return oe<24?`${oe}h ago`:`${Math.floor(oe/24)}d ago`}function h(){var j,U;return!((j=s())!=null&&j.total)||!((U=s())!=null&&U.current)?0:Math.round(s().current/s().total*100)}var y=zh(),_=x(y),b=x(_),w=x(b);{var M=j=>{var U=Ih();W(j,U)},q=j=>{var U=Rh();W(j,U)};ke(w,j=>{i()?j(M):j(q,!1)})}var T=L(b,2),K=L(x(T),2);{var se=j=>{var U=Ph(),J=x(U),oe=L(J);{var Te=Le=>{var Ee=Al("Â· more available");W(Le,Ee)},Me=Le=>{var Ee=Al("Â· all synced");W(Le,Ee)};ke(oe,Le=>{r().hasMore?Le(Te):Le(Me,!1)})}ye((Le,Ee)=>ue(J,`${Le??""} emails stored
          Â· synced ${Ee??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),W(j,U)},Z=j=>{var U=Oh();W(j,U)};ke(K,j=>{var U;(U=r())!=null&&U.synced?j(se):j(Z,!1)})}var H=L(T,2),ee=x(H);{var ie=j=>{var U=Dh();U.__click=()=>F(l,!k(l)),W(j,U)};ke(ee,j=>{var U;(U=r())!=null&&U.synced&&!i()&&j(ie)})}var Q=L(_,2),he=x(Q),De=L(x(he),2);Pn(De,21,()=>d,Tr,(j,U)=>{var J=Mh(),oe=x(J),Te={};ye(()=>{ue(oe,k(U).label),Te!==(Te=k(U).value)&&(J.value=(J.__value=k(U).value)??"")}),W(j,J)});var be=L(he,2),re=x(be);{var Y=j=>{var U=Nh(),J=Et(U);J.__click=()=>e.onsync(k(c));var oe=x(J),Te=L(J,2);{var Me=Le=>{var Ee=Lh();Ee.__click=()=>e.onsyncmore(k(c));var Je=x(Ee);ye(()=>{Ee.disabled=i(),ue(Je,i()?"Loading...":"Sync More")}),W(Le,Ee)};ke(Te,Le=>{r().hasMore&&Le(Me)})}ye(()=>{J.disabled=i(),ue(oe,i()?"Syncing...":"Sync New")}),W(j,U)},$=j=>{var U=qh();U.__click=()=>e.onsync(k(c));var J=x(U);ye(()=>{U.disabled=i(),ue(J,i()?"Syncing...":"Download Emails")}),W(j,U)};ke(re,j=>{var U;(U=r())!=null&&U.synced?j(Y):j($,!1)})}var Ie=L(Q,2);{var te=j=>{var U=jh(),J=x(U),oe=x(J);let Te,Me;var Le=L(J,2),Ee=x(Le);ye(Je=>{Te=dn(oe,1,"progress-fill svelte-1ds3j4k",null,Te,{indeterminate:!s().total}),Me=In(oe,"",Me,Je),ue(Ee,s().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),W(j,U)};ke(Ie,j=>{i()&&s()&&j(te)})}var ce=L(Ie,2);{var de=j=>{var U=Bh(),J=L(x(U),2),oe=x(J);oe.__click=()=>F(l,!1);var Te=L(oe,2);Te.__click=()=>{e.onclear(),F(l,!1)},W(j,U)};ke(ce,j=>{k(l)&&j(de)})}ye(()=>De.disabled=i()),Ro(De,()=>k(c),j=>F(c,j)),W(t,y),ct()}Vt(["click"]);var Kh=X('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Uh=X('<div class="message-list svelte-y2uamw"></div>');function Gh(t,e){ut(e,!0);let r=Re(e,"messages",19,()=>[]);Rt(()=>nn("MessageList"));var s=Uh();Pn(s,21,r,Tr,(i,l)=>{var c=Kh();c.__click=()=>e.onselect(k(l));var d=x(c),v=x(d),h=L(d,2),y=x(h),_=x(y),b=x(_),w=L(_,2),M=x(w),q=L(y,2),T=x(q),K=L(q,2),se=x(K);ye((Z,H,ee)=>{ue(v,Z),ue(b,H),ue(M,ee),ue(T,k(l).subject),ue(se,k(l).snippet)},[()=>yc(k(l).from),()=>mc(k(l).from),()=>Oo(k(l).date)]),W(i,c)}),W(t,s),ct()}Vt(["click"]);function Do(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var aa=Do();function bc(t){aa=t}var Br={exec:()=>null};function Ve(t,e=""){let r=typeof t=="string"?t:t.source,s={replace:(i,l)=>{let c=typeof l=="string"?l:l.source;return c=c.replace(jt.caret,"$1"),r=r.replace(i,c),s},getRegex:()=>new RegExp(r,e)};return s}var Hh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),jt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Wh=/^(?:[ \t]*(?:\n|$))+/,Yh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Vh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,gs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Xh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Mo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,_c=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,wc=Ve(_c).replace(/bull/g,Mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Qh=Ve(_c).replace(/bull/g,Mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Lo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Zh=/^[^\n]+/,No=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,$h=Ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",No).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Jh=Ve(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Mo).getRegex(),ci="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",qo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ev=Ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",qo).replace("tag",ci).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),kc=Ve(Lo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),tv=Ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",kc).getRegex(),jo={blockquote:tv,code:Yh,def:$h,fences:Vh,heading:Xh,hr:gs,html:ev,lheading:wc,list:Jh,newline:Wh,paragraph:kc,table:Br,text:Zh},Bl=Ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex(),nv={...jo,lheading:Qh,table:Bl,paragraph:Ve(Lo).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Bl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ci).getRegex()},rv={...jo,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",qo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Br,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(Lo).replace("hr",gs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",wc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},av=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,sv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,xc=/^( {2,}|\\)\n(?!\s*$)/,iv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,fi=/[\p{P}\p{S}]/u,Bo=/[\s\p{P}\p{S}]/u,Sc=/[^\s\p{P}\p{S}]/u,ov=Ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Bo).getRegex(),Tc=/(?!~)[\p{P}\p{S}]/u,lv=/(?!~)[\s\p{P}\p{S}]/u,uv=/(?:[^\s\p{P}\p{S}]|~)/u,Ec=/(?![*_])[\p{P}\p{S}]/u,cv=/(?![*_])[\s\p{P}\p{S}]/u,fv=/(?:[^\s\p{P}\p{S}]|[*_])/u,dv=Ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Hh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ac=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,pv=Ve(Ac,"u").replace(/punct/g,fi).getRegex(),hv=Ve(Ac,"u").replace(/punct/g,Tc).getRegex(),Cc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",vv=Ve(Cc,"gu").replace(/notPunctSpace/g,Sc).replace(/punctSpace/g,Bo).replace(/punct/g,fi).getRegex(),gv=Ve(Cc,"gu").replace(/notPunctSpace/g,uv).replace(/punctSpace/g,lv).replace(/punct/g,Tc).getRegex(),mv=Ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Sc).replace(/punctSpace/g,Bo).replace(/punct/g,fi).getRegex(),yv=Ve(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Ec).getRegex(),bv="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",_v=Ve(bv,"gu").replace(/notPunctSpace/g,fv).replace(/punctSpace/g,cv).replace(/punct/g,Ec).getRegex(),wv=Ve(/\\(punct)/,"gu").replace(/punct/g,fi).getRegex(),kv=Ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),xv=Ve(qo).replace("(?:-->|$)","-->").getRegex(),Sv=Ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",xv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ei=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Tv=Ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ei).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ic=Ve(/^!?\[(label)\]\[(ref)\]/).replace("label",ei).replace("ref",No).getRegex(),Rc=Ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",No).getRegex(),Ev=Ve("reflink|nolink(?!\\()","g").replace("reflink",Ic).replace("nolink",Rc).getRegex(),zl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,zo={_backpedal:Br,anyPunctuation:wv,autolink:kv,blockSkip:dv,br:xc,code:sv,del:Br,delLDelim:Br,delRDelim:Br,emStrongLDelim:pv,emStrongRDelimAst:vv,emStrongRDelimUnd:mv,escape:av,link:Tv,nolink:Rc,punctuation:ov,reflink:Ic,reflinkSearch:Ev,tag:Sv,text:iv,url:Br},Av={...zo,link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",ei).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ei).getRegex()},uo={...zo,emStrongRDelimAst:gv,emStrongLDelim:hv,delLDelim:yv,delRDelim:_v,url:Ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",zl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",zl).getRegex()},Cv={...uo,br:Ve(xc).replace("{2,}","*").getRegex(),text:Ve(uo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:jo,gfm:nv,pedantic:rv},Wa={normal:zo,gfm:uo,breaks:Cv,pedantic:Av},Iv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Fl=t=>Iv[t];function Xn(t,e){if(e){if(jt.escapeTest.test(t))return t.replace(jt.escapeReplace,Fl)}else if(jt.escapeTestNoEncode.test(t))return t.replace(jt.escapeReplaceNoEncode,Fl);return t}function Kl(t){try{t=encodeURI(t).replace(jt.percentDecode,"%")}catch{return null}return t}function Ul(t,e){var l;let r=t.replace(jt.findPipe,(c,d,v)=>{let h=!1,y=d;for(;--y>=0&&v[y]==="\\";)h=!h;return h?"|":" |"}),s=r.split(jt.splitPipe),i=0;if(s[0].trim()||s.shift(),s.length>0&&!((l=s.at(-1))!=null&&l.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(jt.slashPipe,"|");return s}function Ya(t,e,r){let s=t.length;if(s===0)return"";let i=0;for(;i<s&&t.charAt(s-i-1)===e;)i++;return t.slice(0,s-i)}function Rv(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let s=0;s<t.length;s++)if(t[s]==="\\")s++;else if(t[s]===e[0])r++;else if(t[s]===e[1]&&(r--,r<0))return s;return r>0?-2:-1}function Pv(t,e=0){let r=e,s="";for(let i of t)if(i==="	"){let l=4-r%4;s+=" ".repeat(l),r+=l}else s+=i,r++;return s}function Gl(t,e,r,s,i){let l=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");s.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:l,title:c,text:d,tokens:s.inlineTokens(d)};return s.state.inLink=!1,v}function Ov(t,e,r){let s=t.match(r.other.indentCodeCompensation);if(s===null)return e;let i=s[1];return e.split(`
`).map(l=>{let c=l.match(r.other.beginningSpace);if(c===null)return l;let[d]=c;return d.length>=i.length?l.slice(i.length):l}).join(`
`)}var ti=class{constructor(t){Ke(this,"options");Ke(this,"rules");Ke(this,"lexer");this.options=t||aa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ya(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],s=Ov(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let s=Ya(r,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(r=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ya(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ya(e[0],`
`).split(`
`),s="",i="",l=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),y=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${h}`:h,i=i?`${i}
${y}`:y;let _=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,l,!0),this.lexer.state.top=_,r.length===0)break;let b=l.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let w=b,M=w.raw+`
`+r.join(`
`),q=this.blockquote(M);l[l.length-1]=q,s=s.substring(0,s.length-w.raw.length)+q.raw,i=i.substring(0,i.length-w.text.length)+q.text;break}else if((b==null?void 0:b.type)==="list"){let w=b,M=w.raw+`
`+r.join(`
`),q=this.list(M);l[l.length-1]=q,s=s.substring(0,s.length-b.raw.length)+q.raw,i=i.substring(0,i.length-w.raw.length)+q.raw,r=M.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:l,text:i}}}list(t){var r,s;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),l=i.length>1,c={type:"list",raw:"",ordered:l,start:l?+i.slice(0,-1):"",loose:!1,items:[]};i=l?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=l?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,_="",b="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;_=e[0],t=t.substring(_.length);let w=Pv(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],q=!w.trim(),T=0;if(this.options.pedantic?(T=2,b=w.trimStart()):q?T=e[1].length+1:(T=w.search(this.rules.other.nonSpaceChar),T=T>4?1:T,b=w.slice(T),T+=e[1].length),q&&this.rules.other.blankLine.test(M)&&(_+=M+`
`,t=t.substring(M.length+1),y=!0),!y){let K=this.rules.other.nextBulletRegex(T),se=this.rules.other.hrRegex(T),Z=this.rules.other.fencesBeginRegex(T),H=this.rules.other.headingBeginRegex(T),ee=this.rules.other.htmlBeginRegex(T),ie=this.rules.other.blockquoteBeginRegex(T);for(;t;){let Q=t.split(`
`,1)[0],he;if(M=Q,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),he=M):he=M.replace(this.rules.other.tabCharGlobal,"    "),Z.test(M)||H.test(M)||ee.test(M)||ie.test(M)||K.test(M)||se.test(M))break;if(he.search(this.rules.other.nonSpaceChar)>=T||!M.trim())b+=`
`+he.slice(T);else{if(q||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||Z.test(w)||H.test(w)||se.test(w))break;b+=`
`+M}q=!M.trim(),_+=Q+`
`,t=t.substring(Q.length+1),w=he.slice(T)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(_)&&(v=!0)),c.items.push({type:"list_item",raw:_,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),c.raw+=_}let h=c.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((s=y.tokens[0])==null?void 0:s.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let _=this.rules.other.listTaskCheckbox.exec(y.raw);if(_){let b={type:"checkbox",raw:_[0]+" ",checked:_[0]!=="[ ]"};y.checked=b.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=b.raw+y.tokens[0].raw,y.tokens[0].text=b.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(b)):y.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):y.tokens.unshift(b)}}if(!c.loose){let _=y.tokens.filter(w=>w.type==="space"),b=_.length>0&&_.some(w=>this.rules.other.anyLine.test(w.raw));c.loose=b}}if(c.loose)for(let y of c.items){y.loose=!0;for(let _ of y.tokens)_.type==="text"&&(_.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:s,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Ul(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===s.length){for(let d of s)this.rules.other.tableAlignRight.test(d)?l.align.push("right"):this.rules.other.tableAlignCenter.test(d)?l.align.push("center"):this.rules.other.tableAlignLeft.test(d)?l.align.push("left"):l.align.push(null);for(let d=0;d<r.length;d++)l.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:l.align[d]});for(let d of i)l.rows.push(Ul(d,l.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:l.align[h]})));return l}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let l=Ya(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{let l=Rv(e[2],"()");if(l===-2)return;if(l>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+l;e[2]=e[2].substring(0,l),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let s=e[2],i="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(s);l&&(s=l[1],i=l[3])}else i=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?s=s.slice(1):s=s.slice(1,-1)),Gl(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let s=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[s.toLowerCase()];if(!i){let l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return Gl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let s=this.rules.inline.emStrongLDelim.exec(t);if(!(!s||s[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,l,c,d=i,v=0,h=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(s=h.exec(e))!=null;){if(l=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!l)continue;if(c=[...l].length,s[3]||s[4]){d+=c;continue}else if((s[5]||s[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let y=[...s[0]][0].length,_=t.slice(0,i+s.index+y+c);if(Math.min(i,c)%2){let w=_.slice(1,-1);return{type:"em",raw:_,text:w,tokens:this.lexer.inlineTokens(w)}}let b=_.slice(2,-2);return{type:"strong",raw:_,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return s&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let s=this.rules.inline.delLDelim.exec(t);if(s&&(!s[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,l,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(s=v.exec(e))!=null;){if(l=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!l||(c=[...l].length,c!==i))continue;if(s[3]||s[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let h=[...s[0]][0].length,y=t.slice(0,i+s.index+h+c),_=y.slice(i,-i);return{type:"del",raw:y,text:_,tokens:this.lexer.inlineTokens(_)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,s;return e[2]==="@"?(r=e[1],s="mailto:"+r):(r=e[1],s=r),{type:"link",raw:e[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let s,i;if(e[2]==="@")s=e[0],i="mailto:"+s;else{let l;do l=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(l!==e[0]);s=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Tn=class co{constructor(e){Ke(this,"tokens");Ke(this,"options");Ke(this,"state");Ke(this,"inlineQueue");Ke(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||aa,this.options.tokenizer=this.options.tokenizer||new ti,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:jt,block:zs.normal,inline:Wa.normal};this.options.pedantic?(r.block=zs.pedantic,r.inline=Wa.pedantic):this.options.gfm&&(r.block=zs.gfm,this.options.breaks?r.inline=Wa.breaks:r.inline=Wa.gfm),this.tokenizer.rules=r}static get rules(){return{block:zs,inline:Wa}}static lex(e,r){return new co(r).lex(e)}static lexInline(e,r){return new co(r).inlineTokens(e)}lex(e){e=e.replace(jt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let s=this.inlineQueue[r];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],s=!1){var i,l,c;for(this.options.pedantic&&(e=e.replace(jt.tabCharGlobal,"    ").replace(jt.spaceLine,""));e;){let d;if((l=(i=this.options.extensions)==null?void 0:i.block)!=null&&l.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let h=1/0,y=e.slice(1),_;this.options.extensions.startBlock.forEach(b=>{_=b.call({lexer:this},y),typeof _=="number"&&_>=0&&(h=Math.min(h,_))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);s&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),s=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,y,_,b;let s=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let l;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)l=i[2]?i[2].length:0,s=s.slice(0,i.index+l)+"["+"a".repeat(i[0].length-l-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},s))??s;let c=!1,d="";for(;e;){c||(d=""),c=!1;let w;if((_=(y=this.options.extensions)==null?void 0:y.inline)!=null&&_.some(q=>(w=q.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let q=r.at(-1);w.type==="text"&&(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let M=e;if((b=this.options.extensions)!=null&&b.startInline){let q=1/0,T=e.slice(1),K;this.options.extensions.startInline.forEach(se=>{K=se.call({lexer:this},T),typeof K=="number"&&K>=0&&(q=Math.min(q,K))}),q<1/0&&q>=0&&(M=e.substring(0,q+1))}if(w=this.tokenizer.inlineText(M)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),c=!0;let q=r.at(-1);(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(e){let q="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(q);break}else throw new Error(q)}}return r}},ni=class{constructor(t){Ke(this,"options");Ke(this,"parser");this.options=t||aa}space(t){return""}code({text:t,lang:e,escaped:r}){var l;let s=(l=(e||"").match(jt.notSpaceStart))==null?void 0:l[0],i=t.replace(jt.endingNewline,"")+`
`;return s?'<pre><code class="language-'+Xn(s)+'">'+(r?i:Xn(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Xn(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,s="";for(let c=0;c<t.items.length;c++){let d=t.items[c];s+=this.listitem(d)}let i=e?"ol":"ul",l=e&&r!==1?' start="'+r+'"':"";return"<"+i+l+`>
`+s+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let s="";for(let i=0;i<t.rows.length;i++){let l=t.rows[i];r="";for(let c=0;c<l.length;c++)r+=this.tablecell(l[c]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Xn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let s=this.parser.parseInline(r),i=Kl(t);if(i===null)return s;t=i;let l='<a href="'+t+'"';return e&&(l+=' title="'+Xn(e)+'"'),l+=">"+s+"</a>",l}image({href:t,title:e,text:r,tokens:s}){s&&(r=this.parser.parseInline(s,this.parser.textRenderer));let i=Kl(t);if(i===null)return Xn(r);t=i;let l=`<img src="${t}" alt="${r}"`;return e&&(l+=` title="${Xn(e)}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Xn(t.text)}},Fo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},En=class fo{constructor(e){Ke(this,"options");Ke(this,"renderer");Ke(this,"textRenderer");this.options=e||aa,this.options.renderer=this.options.renderer||new ni,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Fo}static parse(e,r){return new fo(r).parse(e)}static parseInline(e,r){return new fo(r).parseInline(e)}parse(e){var s,i;let r="";for(let l=0;l<e.length;l++){let c=e[l];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[c.type]){let v=c,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,l;let s="";for(let c=0;c<e.length;c++){let d=e[c];if((l=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&l[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){s+=h||"";continue}}let v=d;switch(v.type){case"escape":{s+=r.text(v);break}case"html":{s+=r.html(v);break}case"link":{s+=r.link(v);break}case"image":{s+=r.image(v);break}case"checkbox":{s+=r.checkbox(v);break}case"strong":{s+=r.strong(v);break}case"em":{s+=r.em(v);break}case"codespan":{s+=r.codespan(v);break}case"br":{s+=r.br(v);break}case"del":{s+=r.del(v);break}case"text":{s+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return s}},Us,es=(Us=class{constructor(t){Ke(this,"options");Ke(this,"block");this.options=t||aa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Tn.lex:Tn.lexInline}provideParser(){return this.block?En.parse:En.parseInline}},Ke(Us,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ke(Us,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Us),Dv=class{constructor(...t){Ke(this,"defaults",Do());Ke(this,"options",this.setOptions);Ke(this,"parse",this.parseMarkdown(!0));Ke(this,"parseInline",this.parseMarkdown(!1));Ke(this,"Parser",En);Ke(this,"Renderer",ni);Ke(this,"TextRenderer",Fo);Ke(this,"Lexer",Tn);Ke(this,"Tokenizer",ti);Ke(this,"Hooks",es);this.use(...t)}walkTokens(t,e){var s,i;let r=[];for(let l of t)switch(r=r.concat(e.call(this,l)),l.type){case"table":{let c=l;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=l;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=l;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let l=e.renderers[i.name];l?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=l.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=e[i.level];l?l.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),s.extensions=e),r.renderer){let i=this.defaults.renderer||new ni(this.defaults);for(let l in r.renderer){if(!(l in i))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let c=l,d=r.renderer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y||""}}s.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ti(this.defaults);for(let l in r.tokenizer){if(!(l in i))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let c=l,d=r.tokenizer[c],v=i[c];i[c]=(...h)=>{let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}s.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new es;for(let l in r.hooks){if(!(l in i))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let c=l,d=r.hooks[c],v=i[c];es.passThroughHooks.has(l)?i[c]=h=>{if(this.defaults.async&&es.passThroughHooksRespectAsync.has(l))return(async()=>{let _=await d.call(i,h);return v.call(i,_)})();let y=d.call(i,h);return v.call(i,y)}:i[c]=(...h)=>{if(this.defaults.async)return(async()=>{let _=await d.apply(i,h);return _===!1&&(_=await v.apply(i,h)),_})();let y=d.apply(i,h);return y===!1&&(y=v.apply(i,h)),y}}s.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,l=r.walkTokens;s.walkTokens=function(c){let d=[];return d.push(l.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...s}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Tn.lex(t,e??this.defaults)}parser(t,e){return En.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let s={...r},i={...this.defaults,...s},l=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let h=await(i.hooks?await i.hooks.provideParser():t?En.parse:En.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(h):h})().catch(l);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Tn.lex:Tn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?En.parse:En.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return l(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let s="<p>An error occurred:</p><pre>"+Xn(r.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(r);throw r}}},na=new Dv;function $e(t,e){return na.parse(t,e)}$e.options=$e.setOptions=function(t){return na.setOptions(t),$e.defaults=na.defaults,bc($e.defaults),$e};$e.getDefaults=Do;$e.defaults=aa;$e.use=function(...t){return na.use(...t),$e.defaults=na.defaults,bc($e.defaults),$e};$e.walkTokens=function(t,e){return na.walkTokens(t,e)};$e.parseInline=na.parseInline;$e.Parser=En;$e.parser=En.parse;$e.Renderer=ni;$e.TextRenderer=Fo;$e.Lexer=Tn;$e.lexer=Tn.lex;$e.Tokenizer=ti;$e.Hooks=es;$e.parse=$e;$e.options;$e.setOptions;$e.use;$e.walkTokens;$e.parseInline;En.parse;Tn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Pc,setPrototypeOf:Hl,isFrozen:Mv,getPrototypeOf:Lv,getOwnPropertyDescriptor:Nv}=Object;let{freeze:Bt,seal:gn,create:po}=Object,{apply:ho,construct:vo}=typeof Reflect<"u"&&Reflect;Bt||(Bt=function(e){return e});gn||(gn=function(e){return e});ho||(ho=function(e,r){for(var s=arguments.length,i=new Array(s>2?s-2:0),l=2;l<s;l++)i[l-2]=arguments[l];return e.apply(r,i)});vo||(vo=function(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return new e(...s)});const Fs=zt(Array.prototype.forEach),qv=zt(Array.prototype.lastIndexOf),Wl=zt(Array.prototype.pop),Va=zt(Array.prototype.push),jv=zt(Array.prototype.splice),Qs=zt(String.prototype.toLowerCase),Ui=zt(String.prototype.toString),Gi=zt(String.prototype.match),Xa=zt(String.prototype.replace),Bv=zt(String.prototype.indexOf),zv=zt(String.prototype.trim),xn=zt(Object.prototype.hasOwnProperty),qt=zt(RegExp.prototype.test),Qa=Fv(TypeError);function zt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return ho(t,e,s)}}function Fv(t){return function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return vo(t,r)}}function Fe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qs;Hl&&Hl(t,null);let s=e.length;for(;s--;){let i=e[s];if(typeof i=="string"){const l=r(i);l!==i&&(Mv(e)||(e[s]=l),i=l)}t[i]=!0}return t}function Kv(t){for(let e=0;e<t.length;e++)xn(t,e)||(t[e]=null);return t}function qn(t){const e=po(null);for(const[r,s]of Pc(t))xn(t,r)&&(Array.isArray(s)?e[r]=Kv(s):s&&typeof s=="object"&&s.constructor===Object?e[r]=qn(s):e[r]=s);return e}function Za(t,e){for(;t!==null;){const s=Nv(t,e);if(s){if(s.get)return zt(s.get);if(typeof s.value=="function")return zt(s.value)}t=Lv(t)}function r(){return null}return r}const Yl=Bt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hi=Bt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wi=Bt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Uv=Bt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yi=Bt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Gv=Bt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Vl=Bt(["#text"]),Xl=Bt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vi=Bt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ql=Bt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ks=Bt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Hv=gn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Wv=gn(/<%[\w\W]*|[\w\W]*%>/gm),Yv=gn(/\$\{[\w\W]*/gm),Vv=gn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Xv=gn(/^aria-[\-\w]+$/),Oc=gn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Qv=gn(/^(?:\w+script|data):/i),Zv=gn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Dc=gn(/^html$/i),$v=gn(/^[a-z][.\w]*(-[.\w]+)+$/i);var Zl=Object.freeze({__proto__:null,ARIA_ATTR:Xv,ATTR_WHITESPACE:Zv,CUSTOM_ELEMENT:$v,DATA_ATTR:Vv,DOCTYPE_NAME:Dc,ERB_EXPR:Wv,IS_ALLOWED_URI:Oc,IS_SCRIPT_OR_DATA:Qv,MUSTACHE_EXPR:Hv,TMPLIT_EXPR:Yv});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},Jv=function(){return typeof window>"u"?null:window},eg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(s=r.getAttribute(i));const l="dompurify"+(s?"#"+s:"");try{return e.createPolicy(l,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}},$l=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jv();const e=Ce=>Mc(Ce);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const s=r,i=s.currentScript,{DocumentFragment:l,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:h,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:_,DOMParser:b,trustedTypes:w}=t,M=v.prototype,q=Za(M,"cloneNode"),T=Za(M,"remove"),K=Za(M,"nextSibling"),se=Za(M,"childNodes"),Z=Za(M,"parentNode");if(typeof c=="function"){const Ce=r.createElement("template");Ce.content&&Ce.content.ownerDocument&&(r=Ce.content.ownerDocument)}let H,ee="";const{implementation:ie,createNodeIterator:Q,createDocumentFragment:he,getElementsByTagName:De}=r,{importNode:be}=s;let re=$l();e.isSupported=typeof Pc=="function"&&typeof Z=="function"&&ie&&ie.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Y,ERB_EXPR:$,TMPLIT_EXPR:Ie,DATA_ATTR:te,ARIA_ATTR:ce,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:U}=Zl;let{IS_ALLOWED_URI:J}=Zl,oe=null;const Te=Fe({},[...Yl,...Hi,...Wi,...Yi,...Vl]);let Me=null;const Le=Fe({},[...Xl,...Vi,...Ql,...Ks]);let Ee=Object.seal(po(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Je=null,Pe=null;const tt=Object.seal(po(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let vt=!0,_e=!0,Lt=!1,He=!0,rn=!1,sa=!0,Nt=!1,Ra=!1,Pa=!1,sr=!1,ia=!1,ir=!1,Xt=!0,Oa=!1;const Er="user-content-";let oa=!0,mn=!1,gt={},yt=null;const Ar=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let or=null;const la=Fe({},["audio","video","img","source","image","track"]);let lr=null;const Dn=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gn="http://www.w3.org/1998/Math/MathML",ur="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Ae=bt,Hn=!1,yn=null;const ua=Fe({},[Gn,ur,bt],Ui);let me=Fe({},["mi","mo","mn","ms","mtext"]),cr=Fe({},["annotation-xml"]);const ms=Fe({},["title","style","font","a","script"]);let Wn=null;const ys=["application/xhtml+xml","text/html"],Da="text/html";let ft=null,fr=null;const dr=r.createElement("form"),Yn=function(E){return E instanceof RegExp||E instanceof Function},Cr=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fr&&fr===E)){if((!E||typeof E!="object")&&(E={}),E=qn(E),Wn=ys.indexOf(E.PARSER_MEDIA_TYPE)===-1?Da:E.PARSER_MEDIA_TYPE,ft=Wn==="application/xhtml+xml"?Ui:Qs,oe=xn(E,"ALLOWED_TAGS")?Fe({},E.ALLOWED_TAGS,ft):Te,Me=xn(E,"ALLOWED_ATTR")?Fe({},E.ALLOWED_ATTR,ft):Le,yn=xn(E,"ALLOWED_NAMESPACES")?Fe({},E.ALLOWED_NAMESPACES,Ui):ua,lr=xn(E,"ADD_URI_SAFE_ATTR")?Fe(qn(Dn),E.ADD_URI_SAFE_ATTR,ft):Dn,or=xn(E,"ADD_DATA_URI_TAGS")?Fe(qn(la),E.ADD_DATA_URI_TAGS,ft):la,yt=xn(E,"FORBID_CONTENTS")?Fe({},E.FORBID_CONTENTS,ft):Ar,Je=xn(E,"FORBID_TAGS")?Fe({},E.FORBID_TAGS,ft):qn({}),Pe=xn(E,"FORBID_ATTR")?Fe({},E.FORBID_ATTR,ft):qn({}),gt=xn(E,"USE_PROFILES")?E.USE_PROFILES:!1,vt=E.ALLOW_ARIA_ATTR!==!1,_e=E.ALLOW_DATA_ATTR!==!1,Lt=E.ALLOW_UNKNOWN_PROTOCOLS||!1,He=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,rn=E.SAFE_FOR_TEMPLATES||!1,sa=E.SAFE_FOR_XML!==!1,Nt=E.WHOLE_DOCUMENT||!1,sr=E.RETURN_DOM||!1,ia=E.RETURN_DOM_FRAGMENT||!1,ir=E.RETURN_TRUSTED_TYPE||!1,Pa=E.FORCE_BODY||!1,Xt=E.SANITIZE_DOM!==!1,Oa=E.SANITIZE_NAMED_PROPS||!1,oa=E.KEEP_CONTENT!==!1,mn=E.IN_PLACE||!1,J=E.ALLOWED_URI_REGEXP||Oc,Ae=E.NAMESPACE||bt,me=E.MATHML_TEXT_INTEGRATION_POINTS||me,cr=E.HTML_INTEGRATION_POINTS||cr,Ee=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&Yn(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&Yn(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),rn&&(_e=!1),ia&&(sr=!0),gt&&(oe=Fe({},Vl),Me=[],gt.html===!0&&(Fe(oe,Yl),Fe(Me,Xl)),gt.svg===!0&&(Fe(oe,Hi),Fe(Me,Vi),Fe(Me,Ks)),gt.svgFilters===!0&&(Fe(oe,Wi),Fe(Me,Vi),Fe(Me,Ks)),gt.mathMl===!0&&(Fe(oe,Yi),Fe(Me,Ql),Fe(Me,Ks))),E.ADD_TAGS&&(typeof E.ADD_TAGS=="function"?tt.tagCheck=E.ADD_TAGS:(oe===Te&&(oe=qn(oe)),Fe(oe,E.ADD_TAGS,ft))),E.ADD_ATTR&&(typeof E.ADD_ATTR=="function"?tt.attributeCheck=E.ADD_ATTR:(Me===Le&&(Me=qn(Me)),Fe(Me,E.ADD_ATTR,ft))),E.ADD_URI_SAFE_ATTR&&Fe(lr,E.ADD_URI_SAFE_ATTR,ft),E.FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,E.FORBID_CONTENTS,ft)),E.ADD_FORBID_CONTENTS&&(yt===Ar&&(yt=qn(yt)),Fe(yt,E.ADD_FORBID_CONTENTS,ft)),oa&&(oe["#text"]=!0),Nt&&Fe(oe,["html","head","body"]),oe.table&&(Fe(oe,["tbody"]),delete Je.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=E.TRUSTED_TYPES_POLICY,ee=H.createHTML("")}else H===void 0&&(H=eg(w,i)),H!==null&&typeof ee=="string"&&(ee=H.createHTML(""));Bt&&Bt(E),fr=E}},Ir=Fe({},[...Hi,...Wi,...Uv]),nt=Fe({},[...Yi,...Gv]),mt=function(E){let le=Z(E);(!le||!le.tagName)&&(le={namespaceURI:Ae,tagName:"template"});const pe=Qs(E.tagName),Xe=Qs(le.tagName);return yn[E.namespaceURI]?E.namespaceURI===ur?le.namespaceURI===bt?pe==="svg":le.namespaceURI===Gn?pe==="svg"&&(Xe==="annotation-xml"||me[Xe]):!!Ir[pe]:E.namespaceURI===Gn?le.namespaceURI===bt?pe==="math":le.namespaceURI===ur?pe==="math"&&cr[Xe]:!!nt[pe]:E.namespaceURI===bt?le.namespaceURI===ur&&!cr[Xe]||le.namespaceURI===Gn&&!me[Xe]?!1:!nt[pe]&&(ms[pe]||!Ir[pe]):!!(Wn==="application/xhtml+xml"&&yn[E.namespaceURI]):!1},an=function(E){Va(e.removed,{element:E});try{Z(E).removeChild(E)}catch{T(E)}},sn=function(E,le){try{Va(e.removed,{attribute:le.getAttributeNode(E),from:le})}catch{Va(e.removed,{attribute:null,from:le})}if(le.removeAttribute(E),E==="is")if(sr||ia)try{an(le)}catch{}else try{le.setAttribute(E,"")}catch{}},Rr=function(E){let le=null,pe=null;if(Pa)E="<remove></remove>"+E;else{const it=Gi(E,/^[\r\n\t ]+/);pe=it&&it[0]}Wn==="application/xhtml+xml"&&Ae===bt&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Xe=H?H.createHTML(E):E;if(Ae===bt)try{le=new b().parseFromString(Xe,Wn)}catch{}if(!le||!le.documentElement){le=ie.createDocument(Ae,"template",null);try{le.documentElement.innerHTML=Hn?ee:Xe}catch{}}const rt=le.body||le.documentElement;return E&&pe&&rt.insertBefore(r.createTextNode(pe),rt.childNodes[0]||null),Ae===bt?De.call(le,Nt?"html":"body")[0]:Nt?le.documentElement:rt},Pr=function(E){return Q.call(E.ownerDocument||E,E,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Ma=function(E){return E instanceof _&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof y)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},bn=function(E){return typeof d=="function"&&E instanceof d};function Pt(Ce,E,le){Fs(Ce,pe=>{pe.call(e,E,le,fr)})}const _n=function(E){let le=null;if(Pt(re.beforeSanitizeElements,E,null),Ma(E))return an(E),!0;const pe=ft(E.nodeName);if(Pt(re.uponSanitizeElement,E,{tagName:pe,allowedTags:oe}),sa&&E.hasChildNodes()&&!bn(E.firstElementChild)&&qt(/<[/\w!]/g,E.innerHTML)&&qt(/<[/\w!]/g,E.textContent)||E.nodeType===$a.progressingInstruction||sa&&E.nodeType===$a.comment&&qt(/<[/\w]/g,E.data))return an(E),!0;if(!(tt.tagCheck instanceof Function&&tt.tagCheck(pe))&&(!oe[pe]||Je[pe])){if(!Je[pe]&&bs(pe)&&(Ee.tagNameCheck instanceof RegExp&&qt(Ee.tagNameCheck,pe)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(pe)))return!1;if(oa&&!yt[pe]){const Xe=Z(E)||E.parentNode,rt=se(E)||E.childNodes;if(rt&&Xe){const it=rt.length;for(let dt=it-1;dt>=0;--dt){const Ft=q(rt[dt],!0);Ft.__removalCount=(E.__removalCount||0)+1,Xe.insertBefore(Ft,K(E))}}}return an(E),!0}return E instanceof v&&!mt(E)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&qt(/<\/no(script|embed|frames)/i,E.innerHTML)?(an(E),!0):(rn&&E.nodeType===$a.text&&(le=E.textContent,Fs([Y,$,Ie],Xe=>{le=Xa(le,Xe," ")}),E.textContent!==le&&(Va(e.removed,{element:E.cloneNode()}),E.textContent=le)),Pt(re.afterSanitizeElements,E,null),!1)},Or=function(E,le,pe){if(Xt&&(le==="id"||le==="name")&&(pe in r||pe in dr))return!1;if(!(_e&&!Pe[le]&&qt(te,le))){if(!(vt&&qt(ce,le))){if(!(tt.attributeCheck instanceof Function&&tt.attributeCheck(le,E))){if(!Me[le]||Pe[le]){if(!(bs(E)&&(Ee.tagNameCheck instanceof RegExp&&qt(Ee.tagNameCheck,E)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(E))&&(Ee.attributeNameCheck instanceof RegExp&&qt(Ee.attributeNameCheck,le)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(le,E))||le==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&qt(Ee.tagNameCheck,pe)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(pe))))return!1}else if(!lr[le]){if(!qt(J,Xa(pe,j,""))){if(!((le==="src"||le==="xlink:href"||le==="href")&&E!=="script"&&Bv(pe,"data:")===0&&or[E])){if(!(Lt&&!qt(de,Xa(pe,j,"")))){if(pe)return!1}}}}}}}return!0},bs=function(E){return E!=="annotation-xml"&&Gi(E,U)},wn=function(E){Pt(re.beforeSanitizeAttributes,E,null);const{attributes:le}=E;if(!le||Ma(E))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Me,forceKeepAttr:void 0};let Xe=le.length;for(;Xe--;){const rt=le[Xe],{name:it,namespaceURI:dt,value:Ft}=rt,Mn=ft(it),Dr=Ft;let st=it==="value"?Dr:zv(Dr);if(pe.attrName=Mn,pe.attrValue=st,pe.keepAttr=!0,pe.forceKeepAttr=void 0,Pt(re.uponSanitizeAttribute,E,pe),st=pe.attrValue,Oa&&(Mn==="id"||Mn==="name")&&(sn(it,E),st=Er+st),sa&&qt(/((--!?|])>)|<\/(style|title|textarea)/i,st)){sn(it,E);continue}if(Mn==="attributename"&&Gi(st,"href")){sn(it,E);continue}if(pe.forceKeepAttr)continue;if(!pe.keepAttr){sn(it,E);continue}if(!He&&qt(/\/>/i,st)){sn(it,E);continue}rn&&Fs([Y,$,Ie],Mr=>{st=Xa(st,Mr," ")});const La=ft(E.nodeName);if(!Or(La,Mn,st)){sn(it,E);continue}if(H&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!dt)switch(w.getAttributeType(La,Mn)){case"TrustedHTML":{st=H.createHTML(st);break}case"TrustedScriptURL":{st=H.createScriptURL(st);break}}if(st!==Dr)try{dt?E.setAttributeNS(dt,it,st):E.setAttribute(it,st),Ma(E)?an(E):Wl(e.removed)}catch{sn(it,E)}}Pt(re.afterSanitizeAttributes,E,null)},_s=function Ce(E){let le=null;const pe=Pr(E);for(Pt(re.beforeSanitizeShadowDOM,E,null);le=pe.nextNode();)Pt(re.uponSanitizeShadowNode,le,null),_n(le),wn(le),le.content instanceof l&&Ce(le.content);Pt(re.afterSanitizeShadowDOM,E,null)};return e.sanitize=function(Ce){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},le=null,pe=null,Xe=null,rt=null;if(Hn=!Ce,Hn&&(Ce="<!-->"),typeof Ce!="string"&&!bn(Ce))if(typeof Ce.toString=="function"){if(Ce=Ce.toString(),typeof Ce!="string")throw Qa("dirty is not a string, aborting")}else throw Qa("toString is not a function");if(!e.isSupported)return Ce;if(Ra||Cr(E),e.removed=[],typeof Ce=="string"&&(mn=!1),mn){if(Ce.nodeName){const Ft=ft(Ce.nodeName);if(!oe[Ft]||Je[Ft])throw Qa("root node is forbidden and cannot be sanitized in-place")}}else if(Ce instanceof d)le=Rr("<!---->"),pe=le.ownerDocument.importNode(Ce,!0),pe.nodeType===$a.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?le=pe:le.appendChild(pe);else{if(!sr&&!rn&&!Nt&&Ce.indexOf("<")===-1)return H&&ir?H.createHTML(Ce):Ce;if(le=Rr(Ce),!le)return sr?null:ir?ee:""}le&&Pa&&an(le.firstChild);const it=Pr(mn?Ce:le);for(;Xe=it.nextNode();)_n(Xe),wn(Xe),Xe.content instanceof l&&_s(Xe.content);if(mn)return Ce;if(sr){if(ia)for(rt=he.call(le.ownerDocument);le.firstChild;)rt.appendChild(le.firstChild);else rt=le;return(Me.shadowroot||Me.shadowrootmode)&&(rt=be.call(s,rt,!0)),rt}let dt=Nt?le.outerHTML:le.innerHTML;return Nt&&oe["!doctype"]&&le.ownerDocument&&le.ownerDocument.doctype&&le.ownerDocument.doctype.name&&qt(Dc,le.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+le.ownerDocument.doctype.name+`>
`+dt),rn&&Fs([Y,$,Ie],Ft=>{dt=Xa(dt,Ft," ")}),H&&ir?H.createHTML(dt):dt},e.setConfig=function(){let Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cr(Ce),Ra=!0},e.clearConfig=function(){fr=null,Ra=!1},e.isValidAttribute=function(Ce,E,le){fr||Cr({});const pe=ft(Ce),Xe=ft(E);return Or(pe,Xe,le)},e.addHook=function(Ce,E){typeof E=="function"&&Va(re[Ce],E)},e.removeHook=function(Ce,E){if(E!==void 0){const le=qv(re[Ce],E);return le===-1?void 0:jv(re[Ce],le,1)[0]}return Wl(re[Ce])},e.removeHooks=function(Ce){re[Ce]=[]},e.removeAllHooks=function(){re=$l()},e}var tg=Mc();function ng(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${Jl(t.from)} |`),e.push(`| **To** | ${Jl(t.to)} |`),e.push(`| **Date** | ${Oo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?rg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function Jl(t){return(t||"").replace(/\|/g,"\\|")}function rg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return go(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function ag(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),s=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||s>0&&s<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function go(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const l=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return ag(t,l)?"":`![${c}](${l})`}const r=Array.from(t.childNodes).map(go).join(""),s=r.trim();if(!s&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${s}

`;if(e==="blockquote")return`

> ${s.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const l=Number(e[1]);return`

${"#".repeat(l)} ${s}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${s}
`;if(e==="a"){const l=t.getAttribute("href")||"";return!l||l.startsWith("mailto:")?s:s===l?l:`[${s}](${l})`}if(e==="strong"||e==="b")return`**${s}**`;if(e==="em"||e==="i")return`*${s}*`;if(e==="code")return`\`${s}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>go(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const l=r.trim(),c=(l.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${l}${d}
`}return r}function sg(t){const e=ig(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.md`}function ig(t){try{const e=new Date(t),r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${i}`}catch{return"email"}}function eu(t,e,r="text/markdown;charset=utf-8"){const s=new Blob([t],{type:r}),i=URL.createObjectURL(s),l=document.createElement("a");l.href=i,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}function og(t){return t.raw||null}function lg(t){const e=og(t);return e?JSON.stringify(e,null,2):"null"}function ug(t){const e=cg(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.json`}function cg(t){try{const e=new Date(t),r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${i}`}catch{return"email"}}var fg=X('<button title="View as Markdown">.md</button>'),dg=X('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),pg=X('<pre class="md-raw svelte-1b0rzpb"> </pre>'),hg=X('<div class="md-preview svelte-1b0rzpb"><!></div>'),vg=X('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),gg=X('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),mg=X('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),yg=X('<pre class="message-text svelte-1b0rzpb"> </pre>'),bg=X('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),_g=X('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),wg=X('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function kg(t,e){ut(e,!0);let r=Re(e,"loading",3,!1);Rt(()=>nn("MessageModal"));const s=new $e.Renderer;s.link=({href:Y,title:$,text:Ie})=>{const te=$?` title="${$}"`:"";return`<a href="${Y}"${te} target="_blank" rel="noopener">${Ie}</a>`},$e.setOptions({breaks:!0,gfm:!0,renderer:s});let i=Oe("email"),l=Mt(()=>e.message.body?ng(e.message):""),c=Mt(()=>lg(e.message)),d=Oe("raw");function v(Y){F(i,k(i)===Y?"email":Y,!0),Y==="markdown"&&F(d,"raw")}function h(){eu(k(l),sg(e.message))}function y(){eu(k(c),ug(e.message),"application/json;charset=utf-8")}function _(Y){const $=$e.parse(Y);return tg.sanitize($,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let b=Oe(null);$s(()=>{var Y;if(k(b)&&e.message.htmlBody&&!r()&&k(i)==="email"){const $=k(b).contentDocument||((Y=k(b).contentWindow)==null?void 0:Y.document);$&&($.open(),$.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),$.close())}});var w=wg();w.__click=function(...Y){var $;($=e.onclose)==null||$.apply(this,Y)};var M=x(w);M.__click=Y=>Y.stopPropagation();var q=x(M),T=x(q),K=x(T),se=L(T,2),Z=x(se);let H;Z.__click=()=>v("json");var ee=L(Z,2);{var ie=Y=>{var $=fg();let Ie;$.__click=()=>v("markdown"),ye(()=>Ie=dn($,1,"action-btn svelte-1b0rzpb",null,Ie,{active:k(i)==="markdown"})),W(Y,$)};ke(ee,Y=>{e.message.body&&Y(ie)})}var Q=L(ee,2);Q.__click=function(...Y){var $;($=e.onclose)==null||$.apply(this,Y)};var he=L(q,2);{var De=Y=>{var $=dg(),Ie=Et($),te=L(x(Ie),2);te.__click=y;var ce=L(Ie,2),de=x(ce),j=x(de);ye(()=>ue(j,k(c))),W(Y,$)},be=Y=>{var $=vg(),Ie=Et($),te=x(Ie),ce=x(te);let de;ce.__click=()=>F(d,"raw");var j=L(ce,2);let U;j.__click=()=>F(d,"preview");var J=L(te,2);J.__click=h;var oe=L(Ie,2),Te=x(oe);{var Me=Ee=>{var Je=pg(),Pe=x(Je);ye(()=>ue(Pe,k(l))),W(Ee,Je)},Le=Ee=>{var Je=hg(),Pe=x(Je);Ed(Pe,()=>_(k(l))),W(Ee,Je)};ke(Te,Ee=>{k(d)==="raw"?Ee(Me):Ee(Le,!1)})}ye(()=>{de=dn(ce,1,"md-tab svelte-1b0rzpb",null,de,{active:k(d)==="raw"}),U=dn(j,1,"md-tab svelte-1b0rzpb",null,U,{active:k(d)==="preview"})}),W(Y,$)},re=Y=>{var $=_g(),Ie=Et($),te=x(Ie),ce=L(x(te),2),de=x(ce),j=L(te,2),U=L(x(j),2),J=x(U),oe=L(j,2),Te=L(x(oe),2),Me=x(Te),Le=L(Ie,2),Ee=x(Le);{var Je=_e=>{var Lt=gg();W(_e,Lt)},Pe=_e=>{var Lt=mg();rc(Lt,He=>F(b,He),()=>k(b)),W(_e,Lt)},tt=_e=>{var Lt=yg(),He=x(Lt);ye(()=>ue(He,e.message.body)),W(_e,Lt)},vt=_e=>{var Lt=bg();W(_e,Lt)};ke(Ee,_e=>{r()?_e(Je):e.message.htmlBody?_e(Pe,1):e.message.body?_e(tt,2):_e(vt,!1)})}ye(_e=>{ue(de,e.message.from),ue(J,e.message.to),ue(Me,_e)},[()=>Oo(e.message.date)]),W(Y,$)};ke(he,Y=>{k(i)==="json"?Y(De):k(i)==="markdown"?Y(be,1):Y(re,!1)})}ye(()=>{ue(K,e.message.subject),H=dn(Z,1,"action-btn svelte-1b0rzpb",null,H,{active:k(i)==="json"})}),W(t,w),ct()}Vt(["click"]);var xg=X('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),Sg=X('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),Tg=X('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Eg=X("<p> </p>"),Ag=X('<p>No emails in local storage. Click "Sync New" to download.</p>'),Cg=X('<div class="empty-state svelte-6ts5xm"><!></div>'),Ig=X('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),Rg=X('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Pg(t,e){ut(e,!0),Rt(()=>nn("DashboardView"));let r=Re(e,"error",3,null),s=Re(e,"profile",3,null),i=Re(e,"loadingProfile",3,!1),l=Re(e,"emailMessages",19,()=>[]),c=Re(e,"totalLocalMessages",3,0),d=Re(e,"hasMoreLocal",3,!1),v=Re(e,"loadingMessages",3,!1),h=Re(e,"selectedMessage",3,null),y=Re(e,"syncStatus",3,null),_=Re(e,"syncProgress",3,null),b=Re(e,"isSyncing",3,!1),w=Re(e,"searchQuery",15);var M=Rg(),q=Et(M),T=x(q);{var K=te=>{gc(te,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};ke(T,te=>{r()&&te(K)})}var se=L(T,2);Ch(se,{get profile(){return s()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var Z=L(se,2);Fh(Z,{get syncStatus(){return y()},get syncProgress(){return _()},get isSyncing(){return b()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var H=L(Z,2),ee=x(H);ee.__keydown=te=>te.key==="Enter"&&e.onsearch();var ie=L(ee,2);ie.__click=function(...te){var ce;(ce=e.onsearch)==null||ce.apply(this,te)};var Q=x(ie),he=L(H,2);{var De=te=>{var ce=Sg(),de=Et(ce),j=x(de),U=x(j),J=L(de,2);Gh(J,{get messages(){return l()},get onselect(){return e.onviewmessage}});var oe=L(J,2);{var Te=Me=>{var Le=xg(),Ee=x(Le);Ee.__click=function(...Pe){var tt;(tt=e.onloadmore)==null||tt.apply(this,Pe)};var Je=x(Ee);ye(()=>{Ee.disabled=v(),ue(Je,v()?"Loading...":"Load More")}),W(Me,Le)};ke(oe,Me=>{d()&&Me(Te)})}ye(Me=>ue(U,`Showing ${l().length??""} of ${Me??""}
        ${w()?" matching":""} emails`),[()=>c().toLocaleString()]),W(te,ce)},be=te=>{var ce=Tg();W(te,ce)},re=te=>{var ce=Cg(),de=x(ce);{var j=J=>{var oe=Eg(),Te=x(oe);ye(()=>ue(Te,`No emails match "${w()??""}".`)),W(J,oe)},U=J=>{var oe=Ag();W(J,oe)};ke(de,J=>{w()?J(j):J(U,!1)})}W(te,ce)},Y=te=>{var ce=Ig();W(te,ce)};ke(he,te=>{var ce;l().length>0?te(De):v()?te(be,1):(ce=y())!=null&&ce.synced?te(re,2):te(Y,!1)})}var $=L(q,2);{var Ie=te=>{kg(te,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};ke($,te=>{h()&&te(Ie)})}ye(()=>{ie.disabled=v(),ue(Q,v()?"Searching...":"Search")}),Po(ee,w),W(t,M),ct()}Vt(["keydown","click"]);var Og=X('<div class="dashboard svelte-1q5o2lv"><!></div>');function Dg(t,e){ut(e,!0);function r(Pe){Pe.key==="Escape"&&k(v)&&de()}Rt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let s=Oe(Tt(localStorage.getItem("googleClientId")||"")),i=Oe(Tt(localStorage.getItem("googleClientId")||"")),l=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),h=Oe(""),y=Oe(Tt([])),_=Oe(0),b=Oe(0),w=Oe(!1),M=Oe(!1),q=Oe(!1),T=Oe(null),K=Oe(null),se=Oe(null),Z=Oe(!1);const H=50;$s(()=>{k(c)&&(j(),$())});let ee=Mt(()=>!k(s)),ie=Mt(()=>!!k(c)),Q=Mt(()=>k(y).length<k(_));$s(()=>{k(s)&&!k(l)&&ql(k(s)).then(()=>{F(l,!0)}).catch(Pe=>{F(T,`Auth init failed: ${Pe.message}`)})});function he(){const Pe=k(i).trim();Pe&&(localStorage.setItem("googleClientId",Pe),F(s,Pe,!0),F(T,null))}function De(){localStorage.removeItem("googleClientId"),F(s,""),F(i,""),F(l,!1),F(c,null),F(d,null),F(y,[],!0),F(_,0)}async function be(){F(T,null),F(M,!0);try{k(l)||(await ql(k(s)),F(l,!0));const Pe=await Qp();F(c,Pe.access_token,!0),await Y()}catch(Pe){F(T,Pe.message,!0)}finally{F(M,!1)}}async function re(){if(k(c))try{await Zp(k(c))}catch{}F(c,null),F(d,null),F(y,[],!0),F(_,0),F(v,null),F(T,null)}async function Y(){F(q,!0);try{const Pe=await lc(k(c));if(!k(c))return;F(d,Pe,!0)}catch(Pe){if(!k(c))return;F(T,`Profile fetch failed: ${Pe.message}`)}finally{F(q,!1)}}async function $(Pe=!1){F(w,!0);try{const tt=Pe?k(b):0,vt=await Qd({query:k(h)||void 0,limit:H,offset:tt});Pe?F(y,[...k(y),...vt.items],!0):F(y,vt.items,!0),F(_,vt.total,!0),F(b,k(y).length,!0)}catch(tt){F(T,`Failed to load messages: ${tt.message}`)}finally{F(w,!1)}}function Ie(){F(b,0),$(!1)}function te(){$(!0)}function ce(Pe){F(v,Pe,!0)}function de(){F(v,null)}async function j(){try{F(K,await ih(),!0)}catch{}}async function U(Pe){if(k(Z)||!k(c))return;F(T,null),F(Z,!0),F(se,null);const tt=new AbortController;try{await ah(k(c),{limit:Pe,onProgress:vt=>{F(se,{...vt},!0)},signal:tt.signal}),await j(),await $(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;F(T,`Sync failed: ${vt.message}`)}}finally{F(Z,!1)}}async function J(Pe){if(k(Z)||!k(c))return;F(T,null),F(Z,!0),F(se,null);const tt=new AbortController;try{await sh(k(c),{limit:Pe,onProgress:vt=>{F(se,{...vt},!0)},signal:tt.signal}),await j(),await $(!1)}catch(vt){if(vt.name!=="AbortError"){if(!k(c))return;F(T,`Sync more failed: ${vt.message}`)}}finally{F(Z,!1)}}async function oe(){try{await oh(),await j(),F(y,[],!0),F(_,0),F(b,0)}catch(Pe){F(T,`Failed to clear data: ${Pe.message}`)}}var Te=Og(),Me=x(Te);{var Le=Pe=>{ph(Pe,{onsave:he,get clientIdInput(){return k(i)},set clientIdInput(tt){F(i,tt,!0)}})},Ee=Pe=>{Sh(Pe,{get clientId(){return k(s)},get error(){return k(T)},get loadingAuth(){return k(M)},onsignin:be,onclear:De,onsignout:re})},Je=Pe=>{Pg(Pe,{get error(){return k(T)},get profile(){return k(d)},get loadingProfile(){return k(q)},get emailMessages(){return k(y)},get totalLocalMessages(){return k(_)},get hasMoreLocal(){return k(Q)},get loadingMessages(){return k(w)},get selectedMessage(){return k(v)},get syncStatus(){return k(K)},get syncProgress(){return k(se)},get isSyncing(){return k(Z)},onsignout:re,onsearch:Ie,onloadmore:te,onviewmessage:ce,onclosedetail:de,ondismisserror:()=>F(T,null),onsync:U,onsyncmore:J,oncleardata:oe,get searchQuery(){return k(h)},set searchQuery(tt){F(h,tt,!0)}})};ke(Me,Pe=>{k(ee)?Pe(Le):k(ie)?Pe(Je,!1):Pe(Ee,1)})}W(t,Te),ct()}const Mg=20,Lg=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Ng(t,{count:e=Mg,force:r=!1,onProgress:s=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");s({phase:"loading",message:"Loading recent emails..."});const i=await qe.items.where("[sourceType+date]").between(["gmail",Wt.minKey],["gmail",Wt.maxKey]).reverse().limit(e).toArray();if(i.length===0)return s({phase:"done",message:"No emails to scan."}),{scanned:0,classified:0,skipped:0,errors:0};let l=i,c=0;if(!r){const y=new Set((await qe.emailClassifications.toArray()).map(_=>_.emailId));l=i.filter(_=>!y.has(_.id)),c=i.length-l.length}if(l.length===0)return s({phase:"done",message:`All ${i.length} emails already classified. Use "Rescan All" to reclassify.`,classified:0}),{scanned:0,classified:0,skipped:c,errors:0};const d=Date.now();let v=0,h=0;for(let y=0;y<l.length;y++){const _=l[y];s({phase:"scanning",message:`Classifying email ${y+1} of ${l.length}${c?` (${c} skipped)`:""}...`,current:y+1,total:l.length,classified:v});try{const b=Ug(_),w=[{role:"system",content:Lg},{role:"user",content:b}],M=await t.generateFull(w),q=Hg(M);q&&(await qe.emailClassifications.put({emailId:_.id,action:q.action,reason:q.reason,summary:q.summary,tags:q.tags,subject:_.subject||"(no subject)",from:_.from||"",date:_.date,scannedAt:d,status:"pending"}),v++)}catch(b){console.error(`Triage email ${y+1} failed:`,b),h++}}return s({phase:"done",message:`Classified ${v} of ${l.length} emails${c?`, ${c} already done`:""}.`,classified:v}),{scanned:l.length,classified:v,skipped:c,errors:h}}async function qg(){const t=await qe.emailClassifications.toArray(),e={};for(const s of t){const i=s.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(s)}for(const s of Object.keys(e))e[s].sort((i,l)=>(l.date||0)-(i.date||0));const r=Object.keys(e).sort((s,i)=>e[i].length-e[s].length);return{groups:e,order:r}}async function jg(){const t=await qe.emailClassifications.toArray(),e={total:t.length};for(const r of t){const s=r.action||"UNKNOWN";e[s]=(e[s]||0)+1}return e}async function tu(t,e){await qe.emailClassifications.update(t,{status:e})}async function Bg(){await qe.emailClassifications.clear()}async function zg(t){await qe.emailClassifications.where("action").equals(t).delete()}async function Fg(t){await qe.emailClassifications.delete(t)}async function Kg(){const t=await qe.items.where("sourceType").equals("gmail").count(),e=await qe.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Ug(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=Gg(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Gg(t,e){return!t||t.length<=e?t:t.slice(0,e)+"..."}function Hg(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),s=e.lastIndexOf("}");if(r===-1||s===-1||s<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const l=e.slice(r,s+1);try{const c=JSON.parse(l);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=Wg(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(h=>typeof h=="string"&&h.trim()).map(h=>h.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function Wg(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function Yg(t){let e=0;for(let s=0;s<t.length;s++)e=t.charCodeAt(s)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 55%, 55%)`}function Vg(t){let e=0;for(let s=0;s<t.length;s++)e=t.charCodeAt(s)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 40%, 35%)`}var Xg=X('<span class="spinner svelte-ois7em"></span>'),Qg=Io('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),Zg=X('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),$g=X('<option class="svelte-ois7em"> </option>'),Jg=X('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),em=X('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),tm=X('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function nm(t,e){ut(e,!0);let r=Re(e,"engineStatus",3,"idle"),s=Re(e,"modelName",3,""),i=Re(e,"isScanning",3,!1),l=Re(e,"scanProgress",3,null),c=Re(e,"scanCount",15,20),d=Re(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function h(){return r()==="ready"?`${s()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function _(){return r()==="ready"&&!i()}var b=tm(),w=x(b),M=x(w),q=x(M);{var T=J=>{var oe=Xg();W(J,oe)},K=J=>{var oe=Qg();W(J,oe)};ke(q,J=>{i()?J(T):J(K,!1)})}var se=L(M,2),Z=L(x(se),2),H=x(Z);let ee;var ie=L(H),Q=L(w,2);{var he=J=>{var oe=Zg(),Te=x(oe),Me=x(Te),Le=L(Te,4),Ee=x(Le),Je=L(Le,4),Pe=x(Je);ye(()=>{ue(Me,`${d().totalEmails??""} emails in storage`),ue(Ee,`${d().classified??""} classified`),ue(Pe,`${d().unclassified??""} new`)}),W(J,oe)};ke(Q,J=>{d()&&J(he)})}var De=L(Q,2),be=x(De),re=L(x(be),2);Pn(re,21,()=>v,Tr,(J,oe)=>{var Te=$g(),Me=x(Te),Le={};ye(()=>{ue(Me,k(oe).label),Le!==(Le=k(oe).value)&&(Te.value=(Te.__value=k(oe).value)??"")}),W(J,Te)});var Y=L(be,2),$=x(Y);$.__click=function(...J){var oe;(oe=e.onscan)==null||oe.apply(this,J)};var Ie=x($),te=L($,2);te.__click=function(...J){var oe;(oe=e.onrescan)==null||oe.apply(this,J)};var ce=L(De,2);{var de=J=>{var oe=Jg();W(J,oe)};ke(ce,J=>{r()!=="ready"&&r()!=="loading"&&J(de)})}var j=L(ce,2);{var U=J=>{var oe=em(),Te=x(oe),Me=x(Te);let Le,Ee;var Je=L(Te,2),Pe=x(Je);ye(()=>{Le=dn(Me,1,"progress-fill svelte-ois7em",null,Le,{indeterminate:!l().total}),Ee=In(Me,"",Ee,{width:`${l().total?l().current/l().total*100:0}%`}),ue(Pe,l().message||"Scanning...")}),W(J,oe)};ke(j,J=>{i()&&l()&&J(U)})}ye((J,oe,Te,Me)=>{ee=In(H,"",ee,J),ue(ie,` ${oe??""}`),re.disabled=i(),$.disabled=Te,ue(Ie,i()?"Scanning...":"Scan New"),te.disabled=Me},[()=>({background:y()}),h,()=>!_(),()=>!_()]),Ro(re,c),W(t,b),ct()}Vt(["click"]);var rm=X('<span class="row-date svelte-1czytqk"> </span>'),am=X('<span class="tag svelte-1czytqk"> </span>'),sm=X('<span class="row-tags svelte-1czytqk"></span>'),im=X('<span class="row-reason svelte-1czytqk"> </span>'),om=X('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),lm=X('<span class="status-label svelte-1czytqk"> </span>'),um=X('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),cm=X('<p class="summary-reason svelte-1czytqk"> </p>'),fm=X('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),dm=X('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function nu(t,e){ut(e,!0);let r=Re(e,"actionColor",3,"#666"),s=Re(e,"dimmed",3,!1);function i(te){if(!te)return"";try{return new Date(te).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let l=Mt(()=>e.item.status==="pending"),c=Oe(!1);var d=dm(),v=Et(d);let h;var y=x(v);y.__click=()=>F(c,!k(c));let _;var b=x(y),w=x(b),M=L(b,2),q=x(M),T=x(q),K=L(q,2);{var se=te=>{var ce=rm(),de=x(ce);ye(j=>ue(de,j),[()=>i(e.item.date)]),W(te,ce)};ke(K,te=>{e.item.date&&te(se)})}var Z=L(M,2);{var H=te=>{var ce=sm();Pn(ce,21,()=>e.item.tags,Tr,(de,j)=>{var U=am();let J;var oe=x(U);ye(Te=>{J=In(U,"",J,Te),ue(oe,k(j))},[()=>({background:Vg(k(j))})]),W(de,U)}),W(te,ce)};ke(Z,te=>{e.item.tags&&e.item.tags.length>0&&te(H)})}var ee=L(Z,2);{var ie=te=>{var ce=im(),de=x(ce);ye(()=>ue(de,e.item.reason)),W(te,ce)};ke(ee,te=>{e.item.reason&&!k(c)&&te(ie)})}var Q=L(y,2),he=x(Q);{var De=te=>{var ce=om(),de=Et(ce);de.__click=()=>e.onmarkacted(e.item.emailId);var j=L(de,2);j.__click=()=>e.ondismiss(e.item.emailId),W(te,ce)},be=te=>{var ce=lm(),de=x(ce);ye(()=>ue(de,e.item.status)),W(te,ce)};ke(he,te=>{k(l)?te(De):te(be,!1)})}var re=L(he,2);{var Y=te=>{var ce=um();ce.__click=()=>e.onremove(e.item.emailId),W(te,ce)};ke(re,te=>{e.onremove&&te(Y)})}var $=L(v,2);{var Ie=te=>{var ce=fm();let de;var j=x(ce),U=x(j),J=L(j,2);{var oe=Te=>{var Me=cm(),Le=x(Me);ye(()=>ue(Le,e.item.reason)),W(Te,Me)};ke(J,Te=>{e.item.reason&&Te(oe)})}ye(()=>{de=In(ce,"",de,{"border-left-color":r()}),ue(U,e.item.summary)}),W(te,ce)};ke($,te=>{k(c)&&e.item.summary&&te(Ie)})}ye(()=>{h=dn(v,1,"email-row svelte-1czytqk",null,h,{dimmed:s()}),_=In(y,"",_,{"border-left-color":r()}),ue(w,e.item.subject),ue(T,e.item.from)}),W(t,d),ct()}Vt(["click"]);var pm=X('<span class="group-acted svelte-tl1unp"> </span>'),hm=X('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),vm=X('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),gm=X('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),mm=X('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),ym=X('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),bm=X('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function _m(t,e){ut(e,!0);let r=Re(e,"color",3,"#888");Re(e,"count",3,0);let s=Re(e,"items",19,()=>[]),i=Re(e,"expanded",3,!1),l=Mt(()=>s().filter(ie=>ie.status==="pending")),c=Mt(()=>s().filter(ie=>ie.status!=="pending")),d=Oe(!1);function v(ie){return ie.split("_").map(Q=>Q.charAt(0)+Q.slice(1).toLowerCase()).join(" ")}var h=bm(),y=x(h);y.__click=function(...ie){var Q;(Q=e.ontoggle)==null||Q.apply(this,ie)};var _=x(y);let b;var w=x(_),M=L(_,2),q=x(M),T=L(M,2);{var K=ie=>{var Q=pm(),he=x(Q);ye(()=>ue(he,`${k(c).length??""} handled`)),W(ie,Q)};ke(T,ie=>{k(c).length>0&&ie(K)})}var se=L(T,4);let Z;var H=L(y,2);{var ee=ie=>{var Q=ym(),he=x(Q);{var De=de=>{var j=hm();W(de,j)};ke(he,de=>{k(l).length===0&&k(c).length===0&&de(De)})}var be=L(he,2);Pn(be,17,()=>k(l),de=>de.emailId,(de,j)=>{nu(de,{get item(){return k(j)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var re=L(be,2);{var Y=de=>{var j=vm(),U=x(j),J=x(U),oe=L(U,2);Pn(oe,17,()=>k(c),Te=>Te.emailId,(Te,Me)=>{nu(Te,{get item(){return k(Me)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ye(()=>ue(J,`${k(c).length??""} handled`)),W(de,j)};ke(re,de=>{k(c).length>0&&de(Y)})}var $=L(re,2),Ie=x($);{var te=de=>{var j=gm();j.__click=()=>F(d,!0),W(de,j)},ce=de=>{var j=mm(),U=x(j),J=L(U);J.__click=()=>F(d,!1);var oe=L(J,2);oe.__click=()=>{e.oncleargroup(),F(d,!1)},ye(()=>ue(U,`Clear ${s().length??""} items? `)),W(de,j)};ke(Ie,de=>{k(d)?de(ce,!1):de(te)})}W(ie,Q)};ke(H,ie=>{i()&&ie(ee)})}ye(ie=>{b=In(_,"",b,{background:r()}),ue(w,ie),ue(q,k(l).length),Z=dn(se,0,"chevron svelte-tl1unp",null,Z,{open:i()})},[()=>v(e.action)]),W(t,h),ct()}Vt(["click"]);var wm=X('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),km=X('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),xm=X('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Sm=X('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Tm=X('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Em=X('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Am(t,e){ut(e,!0);let r=Re(e,"groups",19,()=>({})),s=Re(e,"groupOrder",19,()=>[]),i=Re(e,"counts",19,()=>({})),l=Re(e,"stats",3,null),c=Re(e,"expandedGroup",3,null),d=Re(e,"isScanning",3,!1),v=Re(e,"scanProgress",3,null),h=Re(e,"scanCount",15,20),y=Re(e,"error",3,null),_=Oe(!1);var b=Em(),w=x(b);nm(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return l()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return h()},set scanCount(Z){h(Z)}});var M=L(w,2);{var q=Z=>{var H=wm(),ee=x(H),ie=x(ee),Q=L(ee,2);Q.__click=function(...he){var De;(De=e.ondismisserror)==null||De.apply(this,he)},ye(()=>ue(ie,y())),W(Z,H)};ke(M,Z=>{y()&&Z(q)})}var T=L(M,2);{var K=Z=>{var H=Sm(),ee=Et(H);Pn(ee,20,s,Y=>Y,(Y,$)=>{{let Ie=Mt(()=>Yg($)),te=Mt(()=>{var j;return((j=r()[$])==null?void 0:j.length)||0}),ce=Mt(()=>r()[$]||[]),de=Mt(()=>c()===$);_m(Y,{get action(){return $},get color(){return k(Ie)},get count(){return k(te)},get items(){return k(ce)},get expanded(){return k(de)},ontoggle:()=>e.ontogglegroup($),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup($)})}});var ie=L(ee,2),Q=x(ie),he=x(Q),De=L(Q,2);{var be=Y=>{var $=km();$.__click=()=>F(_,!0),W(Y,$)},re=Y=>{var $=xm(),Ie=L(x($));Ie.__click=()=>F(_,!1);var te=L(Ie,2);te.__click=()=>{e.onclear(),F(_,!1)},W(Y,$)};ke(De,Y=>{k(_)?Y(re,!1):Y(be)})}ye(()=>ue(he,`${i().total??""} emails classified into ${s().length??""} groups`)),W(Z,H)},se=Z=>{var H=Tm();W(Z,H)};ke(T,Z=>{i().total>0?Z(K):d()||Z(se,1)})}W(t,b),ct()}Vt(["click"]);var Cm=X('<div class="actions-page svelte-3tch4q"><!></div>');function Im(t,e){ut(e,!0);const r=ac();let s=Oe(Tt(r.status)),i=Oe(""),l=Oe(Tt({})),c=Oe(Tt([])),d=Oe(Tt({total:0})),v=Oe(null),h=Oe(null),y=Oe(!1),_=Oe(null),b=Oe(20),w=Oe(null);Rt(()=>{const be=r.onMessage(re=>{if(re.status==="ready"){F(s,"ready");const Y=os.find($=>$.id===r.modelId);F(i,(Y==null?void 0:Y.name)||r.modelId||"",!0)}re.status==="loading"&&F(s,"loading")});if(F(s,r.status,!0),r.modelId){const re=os.find(Y=>Y.id===r.modelId);F(i,(re==null?void 0:re.name)||r.modelId||"",!0)}return M(),()=>be()});async function M(){try{const be=await qg();F(l,be.groups,!0),F(c,be.order,!0),F(d,await jg(),!0),F(v,await Kg(),!0)}catch(be){F(w,`Failed to load data: ${be.message}`)}}async function q(){await K(!1)}async function T(){await K(!0)}async function K(be){if(!(k(y)||!r.isReady)){F(w,null),F(y,!0),F(_,null);try{await Ng(r,{count:k(b),force:be,onProgress:re=>{F(_,{...re},!0)}}),await M()}catch(re){F(w,`Scan failed: ${re.message}`)}finally{F(y,!1)}}}async function se(be){await tu(be,"acted"),await M()}async function Z(be){await tu(be,"dismissed"),await M()}async function H(be){await Fg(be),await M()}async function ee(be){await zg(be),await M()}async function ie(){await Bg(),await M()}function Q(be){F(h,k(h)===be?null:be,!0)}var he=Cm(),De=x(he);Am(De,{get engineStatus(){return k(s)},get modelName(){return k(i)},get groups(){return k(l)},get groupOrder(){return k(c)},get counts(){return k(d)},get stats(){return k(v)},get expandedGroup(){return k(h)},get isScanning(){return k(y)},get scanProgress(){return k(_)},get error(){return k(w)},onscan:q,onrescan:T,ontogglegroup:Q,onmarkacted:se,ondismiss:Z,onremove:H,oncleargroup:ee,onclear:ie,ondismisserror:()=>F(w,null),get scanCount(){return k(b)},set scanCount(be){F(b,be,!0)}}),W(t,he),ct()}var Rm=X('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Pm(t,e){ut(e,!0);function r(){const Q=location.hash;return Q==="#dashboard"?"dashboard":Q==="#actions"?"actions":"chat"}let s=Oe(Tt(r()));Rt(()=>{function Q(){F(s,r(),!0)}return window.addEventListener("hashchange",Q),()=>window.removeEventListener("hashchange",Q)});var i=Rm(),l=x(i),c=L(x(l),2),d=x(c);let v;var h=L(d,2);let y;var _=L(h,2);let b;var w=L(l,2),M=x(w);let q;var T=x(M);Yp(T,{});var K=L(M,2);let se;var Z=x(K);Im(Z,{});var H=L(K,2);let ee;var ie=x(H);Dg(ie,{}),ye(()=>{v=dn(d,1,"svelte-1n46o8q",null,v,{active:k(s)==="chat"}),y=dn(h,1,"svelte-1n46o8q",null,y,{active:k(s)==="actions"}),b=dn(_,1,"svelte-1n46o8q",null,b,{active:k(s)==="dashboard"}),q=In(M,"",q,{display:k(s)==="chat"?"flex":"none"}),se=In(K,"",se,{display:k(s)==="actions"?"flex":"none"}),ee=In(H,"",ee,{display:k(s)==="dashboard"?"flex":"none"})}),W(t,i),ct()}bd(Pm,{target:document.getElementById("app")});
