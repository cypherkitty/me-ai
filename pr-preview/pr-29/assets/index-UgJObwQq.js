var gf=Object.defineProperty;var xl=t=>{throw TypeError(t)};var mf=(t,e,r)=>e in t?gf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var He=(t,e,r)=>mf(t,typeof e!="symbol"?e+"":e,r),qi=(t,e,r)=>e.has(t)||xl("Cannot "+r);var X=(t,e,r)=>(qi(t,e,"read from private field"),r?r.call(t):e.get(t)),We=(t,e,r)=>e.has(t)?xl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ke=(t,e,r,a)=>(qi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),qt=(t,e,r)=>(qi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Zi=!1;var xo=Array.isArray,yf=Array.prototype.indexOf,Sa=Array.prototype.includes,oi=Array.from,bf=Object.defineProperty,ga=Object.getOwnPropertyDescriptor,_f=Object.getOwnPropertyDescriptors,wf=Object.prototype,kf=Array.prototype,du=Object.getPrototypeOf,Sl=Object.isExtensible;const xf=()=>{};function Sf(t){for(var e=0;e<t.length;e++)t[e]()}function pu(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Ot=2,is=4,li=8,hu=1<<24,ar=16,On=32,sa=64,vu=128,vn=512,Tt=1024,Dt=2048,Pn=4096,rn=8192,nr=16384,ps=32768,Ta=65536,Tl=1<<17,gu=1<<18,Ra=1<<19,Tf=1<<20,tr=1<<25,ea=65536,Ji=1<<21,So=1<<22,wr=1<<23,Zr=Symbol("$state"),Ef=Symbol("legacy props"),Af=Symbol(""),Kr=new class extends Error{constructor(){super(...arguments);He(this,"name","StaleReactionError");He(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Cf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function If(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Rf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Pf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Of(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Df(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Mf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Lf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Nf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Bf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const zf=1,Ff=2,mu=4,Kf=8,Uf=16,Gf=1,Hf=4,Wf=8,Yf=16,yu=1,Vf=2,Ct=Symbol(),bu="http://www.w3.org/1999/xhtml";function Xf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Qf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function _u(t){return t===this.v}function Zf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function wu(t){return!Zf(t,this.v)}let Jf=!1,an=null;function Ea(t){an=t}function ft(t,e=!1,r){an={p:an,i:!1,c:null,e:null,s:t,x:null,l:null}}function dt(t){var e=an,r=e.e;if(r!==null){e.e=null;for(var a of r)Uu(a)}return t!==void 0&&(e.x=t),e.i=!0,an=e.p,t??{}}function ku(){return!0}let Ur=[];function xu(){var t=Ur;Ur=[],Sf(t)}function kr(t){if(Ur.length===0&&!ns){var e=Ur;queueMicrotask(()=>{e===Ur&&xu()})}Ur.push(t)}function $f(){for(;Ur.length>0;)xu()}function Su(t){var e=tt;if(e===null)return Ye.f|=wr,t;if((e.f&ps)===0&&(e.f&is)===0)throw t;Aa(t,e)}function Aa(t,e){for(;e!==null;){if((e.f&vu)!==0){if((e.f&ps)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const ed=-7169;function bt(t,e){t.f=t.f&ed|e}function To(t){(t.f&vn)!==0||t.deps===null?bt(t,Tt):bt(t,Pn)}function Tu(t){if(t!==null)for(const e of t)(e.f&Ot)===0||(e.f&ea)===0||(e.f^=ea,Tu(e.deps))}function Eu(t,e,r){(t.f&Dt)!==0?e.add(t):(t.f&Pn)!==0&&r.add(t),Tu(t.deps),bt(t,Tt)}const js=new Set;let Be=null,Js=null,It=null,Vt=[],ui=null,$i=!1,ns=!1;var ma,ya,Hr,ba,us,cs,Wr,Zn,_a,Un,eo,to,Au;const Xo=class Xo{constructor(){We(this,Un);He(this,"committed",!1);He(this,"current",new Map);He(this,"previous",new Map);We(this,ma,new Set);We(this,ya,new Set);We(this,Hr,0);We(this,ba,0);We(this,us,null);We(this,cs,new Set);We(this,Wr,new Set);We(this,Zn,new Map);He(this,"is_fork",!1);We(this,_a,!1)}is_deferred(){return this.is_fork||X(this,ba)>0}skip_effect(e){X(this,Zn).has(e)||X(this,Zn).set(e,{d:[],m:[]})}unskip_effect(e){var r=X(this,Zn).get(e);if(r){X(this,Zn).delete(e);for(var a of r.d)bt(a,Dt),In(a);for(a of r.m)bt(a,Pn),In(a)}}process(e){var i;Vt=[],this.apply();var r=[],a=[];for(const o of e)qt(this,Un,eo).call(this,o,r,a);if(this.is_deferred()){qt(this,Un,to).call(this,a),qt(this,Un,to).call(this,r);for(const[o,c]of X(this,Zn))Pu(o,c)}else{for(const o of X(this,ma))o();X(this,ma).clear(),X(this,Hr)===0&&qt(this,Un,Au).call(this),Js=this,Be=null,El(a),El(r),Js=null,(i=X(this,us))==null||i.resolve()}It=null}capture(e,r){r!==Ct&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&wr)===0&&(this.current.set(e,e.v),It==null||It.set(e,e.v))}activate(){Be=this,this.apply()}deactivate(){Be===this&&(Be=null,It=null)}flush(){if(this.activate(),Vt.length>0){if(Cu(),Be!==null&&Be!==this)return}else X(this,Hr)===0&&this.process([]);this.deactivate()}discard(){for(const e of X(this,ya))e(this);X(this,ya).clear()}increment(e){Ke(this,Hr,X(this,Hr)+1),e&&Ke(this,ba,X(this,ba)+1)}decrement(e){Ke(this,Hr,X(this,Hr)-1),e&&Ke(this,ba,X(this,ba)-1),!X(this,_a)&&(Ke(this,_a,!0),kr(()=>{Ke(this,_a,!1),this.is_deferred()?Vt.length>0&&this.flush():this.revive()}))}revive(){for(const e of X(this,cs))X(this,Wr).delete(e),bt(e,Dt),In(e);for(const e of X(this,Wr))bt(e,Pn),In(e);this.flush()}oncommit(e){X(this,ma).add(e)}ondiscard(e){X(this,ya).add(e)}settled(){return(X(this,us)??Ke(this,us,pu())).promise}static ensure(){if(Be===null){const e=Be=new Xo;js.add(Be),ns||kr(()=>{Be===e&&e.flush()})}return Be}apply(){}};ma=new WeakMap,ya=new WeakMap,Hr=new WeakMap,ba=new WeakMap,us=new WeakMap,cs=new WeakMap,Wr=new WeakMap,Zn=new WeakMap,_a=new WeakMap,Un=new WeakSet,eo=function(e,r,a){e.f^=Tt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(On|sa))!==0,v=d&&(c&Tt)!==0,p=v||(c&rn)!==0||X(this,Zn).has(i);if(!p&&i.fn!==null){d?i.f^=Tt:o!==null&&(c&(is|li|hu))!==0?o.b.defer_effect(i):(c&is)!==0?r.push(i):vs(i)&&((c&ar)!==0&&X(this,Wr).add(i),Ia(i));var m=i.first;if(m!==null){i=m;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},to=function(e){for(var r=0;r<e.length;r+=1)Eu(e[r],X(this,cs),X(this,Wr))},Au=function(){var i;if(js.size>1){this.previous.clear();var e=It,r=!0;for(const o of js){if(o===this){r=!1;continue}const c=[];for(const[v,p]of this.current){if(o.current.has(v))if(r&&p!==o.current.get(v))o.current.set(v,p);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Vt;Vt=[];const v=new Set,p=new Map;for(const m of c)Iu(m,d,v,p);if(Vt.length>0){Be=o,o.apply();for(const m of Vt)qt(i=o,Un,eo).call(i,m,[],[]);o.deactivate()}Vt=a}}Be=null,It=e}this.committed=!0,js.delete(this)};let xr=Xo;function td(t){var e=ns;ns=!0;try{for(var r;;){if($f(),Vt.length===0&&(Be==null||Be.flush(),Vt.length===0))return ui=null,r;Cu()}}finally{ns=e}}function Cu(){$i=!0;var t=null;try{for(var e=0;Vt.length>0;){var r=xr.ensure();if(e++>1e3){var a,i;nd()}r.process(Vt),Sr.clear()}}finally{Vt=[],$i=!1,ui=null}}function nd(){try{Mf()}catch(t){Aa(t,ui)}}let Sn=null;function El(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(nr|rn))===0&&vs(a)&&(Sn=new Set,Ia(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Yu(a),(Sn==null?void 0:Sn.size)>0)){Sr.clear();for(const i of Sn){if((i.f&(nr|rn))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)Sn.has(c)&&(Sn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(nr|rn))===0&&Ia(v)}}Sn.clear()}}Sn=null}}function Iu(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ot)!==0?Iu(i,e,r,a):(o&(So|ar))!==0&&(o&Dt)===0&&Ru(i,e,a)&&(bt(i,Dt),In(i))}}function Ru(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Sa.call(e,i))return!0;if((i.f&Ot)!==0&&Ru(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function In(t){for(var e=ui=t;e.parent!==null;){e=e.parent;var r=e.f;if($i&&e===tt&&(r&ar)!==0&&(r&gu)===0)return;if((r&(sa|On))!==0){if((r&Tt)===0)return;e.f^=Tt}}Vt.push(e)}function Pu(t,e){if(!((t.f&On)!==0&&(t.f&Tt)!==0)){(t.f&Dt)!==0?e.d.push(t):(t.f&Pn)!==0&&e.m.push(t),bt(t,Tt);for(var r=t.first;r!==null;)Pu(r,e),r=r.next}}function rd(t){let e=0,r=ta(0),a;return()=>{Co()&&(b(r),Io(()=>(e===0&&(a=gs(()=>t(()=>rs(r)))),e+=1,()=>{kr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,rs(r))})})))}}var ad=Ta|Ra|vu;function sd(t,e,r){new id(t,e,r)}var dn,ko,qn,Yr,Bn,pn,Wt,zn,Jn,br,Vr,_r,wa,Xr,ka,xa,$n,si,Et,od,ld,no,Hs,Ws,ro;class id{constructor(e,r,a){We(this,Et);He(this,"parent");He(this,"is_pending",!1);We(this,dn);We(this,ko,null);We(this,qn);We(this,Yr);We(this,Bn);We(this,pn,null);We(this,Wt,null);We(this,zn,null);We(this,Jn,null);We(this,br,null);We(this,Vr,0);We(this,_r,0);We(this,wa,!1);We(this,Xr,!1);We(this,ka,new Set);We(this,xa,new Set);We(this,$n,null);We(this,si,rd(()=>(Ke(this,$n,ta(X(this,Vr))),()=>{Ke(this,$n,null)})));Ke(this,dn,e),Ke(this,qn,r),Ke(this,Yr,a),this.parent=tt.b,this.is_pending=!!X(this,qn).pending,Ke(this,Bn,Ro(()=>{tt.b=this;{var i=qt(this,Et,no).call(this);try{Ke(this,pn,hn(()=>a(i)))}catch(o){this.error(o)}X(this,_r)>0?qt(this,Et,Ws).call(this):this.is_pending=!1}return()=>{var o;(o=X(this,br))==null||o.remove()}},ad))}defer_effect(e){Eu(e,X(this,ka),X(this,xa))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!X(this,qn).pending}update_pending_count(e){qt(this,Et,ro).call(this,e),Ke(this,Vr,X(this,Vr)+e),!(!X(this,$n)||X(this,wa))&&(Ke(this,wa,!0),kr(()=>{Ke(this,wa,!1),X(this,$n)&&Ca(X(this,$n),X(this,Vr))}))}get_effect_pending(){return X(this,si).call(this),b(X(this,$n))}error(e){var r=X(this,qn).onerror;let a=X(this,qn).failed;if(X(this,Xr)||!r&&!a)throw e;X(this,pn)&&(Qt(X(this,pn)),Ke(this,pn,null)),X(this,Wt)&&(Qt(X(this,Wt)),Ke(this,Wt,null)),X(this,zn)&&(Qt(X(this,zn)),Ke(this,zn,null));var i=!1,o=!1;const c=()=>{if(i){Qf();return}i=!0,o&&Bf(),xr.ensure(),Ke(this,Vr,0),X(this,zn)!==null&&Jr(X(this,zn),()=>{Ke(this,zn,null)}),this.is_pending=this.has_pending_snippet(),Ke(this,pn,qt(this,Et,Hs).call(this,()=>(Ke(this,Xr,!1),hn(()=>X(this,Yr).call(this,X(this,dn)))))),X(this,_r)>0?qt(this,Et,Ws).call(this):this.is_pending=!1};kr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Aa(d,X(this,Bn)&&X(this,Bn).parent)}a&&Ke(this,zn,qt(this,Et,Hs).call(this,()=>{xr.ensure(),Ke(this,Xr,!0);try{return hn(()=>{a(X(this,dn),()=>e,()=>c)})}catch(d){return Aa(d,X(this,Bn).parent),null}finally{Ke(this,Xr,!1)}}))})}}dn=new WeakMap,ko=new WeakMap,qn=new WeakMap,Yr=new WeakMap,Bn=new WeakMap,pn=new WeakMap,Wt=new WeakMap,zn=new WeakMap,Jn=new WeakMap,br=new WeakMap,Vr=new WeakMap,_r=new WeakMap,wa=new WeakMap,Xr=new WeakMap,ka=new WeakMap,xa=new WeakMap,$n=new WeakMap,si=new WeakMap,Et=new WeakSet,od=function(){try{Ke(this,pn,hn(()=>X(this,Yr).call(this,X(this,dn))))}catch(e){this.error(e)}},ld=function(){const e=X(this,qn).pending;e&&(Ke(this,Wt,hn(()=>e(X(this,dn)))),kr(()=>{var r=qt(this,Et,no).call(this);Ke(this,pn,qt(this,Et,Hs).call(this,()=>(xr.ensure(),hn(()=>X(this,Yr).call(this,r))))),X(this,_r)>0?qt(this,Et,Ws).call(this):(Jr(X(this,Wt),()=>{Ke(this,Wt,null)}),this.is_pending=!1)}))},no=function(){var e=X(this,dn);return this.is_pending&&(Ke(this,br,rr()),X(this,dn).before(X(this,br)),e=X(this,br)),e},Hs=function(e){var r=tt,a=Ye,i=an;Kn(X(this,Bn)),mn(X(this,Bn)),Ea(X(this,Bn).ctx);try{return e()}catch(o){return Su(o),null}finally{Kn(r),mn(a),Ea(i)}},Ws=function(){const e=X(this,qn).pending;X(this,pn)!==null&&(Ke(this,Jn,document.createDocumentFragment()),X(this,Jn).append(X(this,br)),Qu(X(this,pn),X(this,Jn))),X(this,Wt)===null&&Ke(this,Wt,hn(()=>e(X(this,dn))))},ro=function(e){var r;if(!this.has_pending_snippet()){this.parent&&qt(r=this.parent,Et,ro).call(r,e);return}if(Ke(this,_r,X(this,_r)+e),X(this,_r)===0){this.is_pending=!1;for(const a of X(this,ka))bt(a,Dt),In(a);for(const a of X(this,xa))bt(a,Pn),In(a);X(this,ka).clear(),X(this,xa).clear(),X(this,Wt)&&Jr(X(this,Wt),()=>{Ke(this,Wt,null)}),X(this,Jn)&&(X(this,dn).before(X(this,Jn)),Ke(this,Jn,null))}};function ud(t,e,r,a){const i=ci;var o=t.filter(_=>!_.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var c=Be,d=tt,v=cd(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(_=>_.promise)):null;function m(_){v();try{a(_)}catch(k){(d.f&nr)===0&&Aa(k,d)}c==null||c.deactivate(),ao()}if(r.length===0){p.then(()=>m(e.map(i)));return}function x(){v(),Promise.all(r.map(_=>fd(_))).then(_=>m([...e.map(i),..._])).catch(_=>Aa(_,d))}p?p.then(x):x()}function cd(){var t=tt,e=Ye,r=an,a=Be;return function(o=!0){Kn(t),mn(e),Ea(r),o&&(a==null||a.activate())}}function ao(){Kn(null),mn(null),Ea(null)}function ci(t){var e=Ot|Dt,r=Ye!==null&&(Ye.f&Ot)!==0?Ye:null;return tt!==null&&(tt.f|=Ra),{ctx:an,deps:null,effects:null,equals:_u,f:e,fn:t,reactions:null,rv:0,v:Ct,wv:0,parent:r??tt,ac:null}}function fd(t,e,r){let a=tt;a===null&&If();var i=a.b,o=void 0,c=ta(Ct),d=!Ye,v=new Map;return Td(()=>{var k;var p=pu();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{m===Be&&m.committed&&m.deactivate(),ao()})}catch(M){p.reject(M),ao()}var m=Be;if(d){var x=i.is_rendered();i.update_pending_count(1),m.increment(x),(k=v.get(m))==null||k.reject(Kr),v.delete(m),v.set(m,p)}const _=(M,L=void 0)=>{if(m.activate(),L)L!==Kr&&(c.f|=wr,Ca(c,L));else{(c.f&wr)!==0&&(c.f^=wr),Ca(c,M);for(const[S,F]of v){if(v.delete(S),S===m)break;F.reject(Kr)}}d&&(i.update_pending_count(-1),m.decrement(x))};p.promise.then(_,M=>_(null,M||"unknown"))}),Ku(()=>{for(const p of v.values())p.reject(Kr)}),new Promise(p=>{function m(x){function _(){x===o?p(c):m(o)}x.then(_,_)}m(o)})}function ct(t){const e=ci(t);return Zu(e),e}function Ou(t){const e=ci(t);return e.equals=wu,e}function dd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Qt(e[r])}}function pd(t){for(var e=t.parent;e!==null;){if((e.f&Ot)===0)return(e.f&nr)===0?e:null;e=e.parent}return null}function Eo(t){var e,r=tt;Kn(pd(t));try{t.f&=~ea,dd(t),e=tc(t)}finally{Kn(r)}return e}function Du(t){var e=Eo(t);if(!t.equals(e)&&(t.wv=$u(),(!(Be!=null&&Be.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){bt(t,Tt);return}Tr||(It!==null?(Co()||Be!=null&&Be.is_fork)&&It.set(t,e):To(t))}function hd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Kr),a.teardown=xf,a.ac=null,os(a,0),Po(a))}function Mu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ia(e)}let so=new Set;const Sr=new Map;let Lu=!1;function ta(t,e){var r={f:0,v:t,reactions:null,equals:_u,rv:0,wv:0};return r}function Pe(t,e){const r=ta(t);return Zu(r),r}function vd(t,e=!1,r=!0){const a=ta(t);return e||(a.equals=wu),a}function q(t,e,r=!1){Ye!==null&&(!Rn||(Ye.f&Tl)!==0)&&ku()&&(Ye.f&(Ot|ar|So|Tl))!==0&&(gn===null||!Sa.call(gn,t))&&qf();let a=r?Rt(e):e;return Ca(t,a)}function Ca(t,e){if(!t.equals(e)){var r=t.v;Tr?Sr.set(t,e):Sr.set(t,r),t.v=e;var a=xr.ensure();if(a.capture(t,r),(t.f&Ot)!==0){const i=t;(t.f&Dt)!==0&&Eo(i),To(i)}t.wv=$u(),Nu(t,Dt),tt!==null&&(tt.f&Tt)!==0&&(tt.f&(On|sa))===0&&(fn===null?Ad([t]):fn.push(t)),!a.is_fork&&so.size>0&&!Lu&&gd()}return e}function gd(){Lu=!1;for(const t of so)(t.f&Tt)!==0&&bt(t,Pn),vs(t)&&Ia(t);so.clear()}function rs(t){q(t,t.v+1)}function Nu(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],c=o.f,d=(c&Dt)===0;if(d&&bt(o,e),(c&Ot)!==0){var v=o;It==null||It.delete(v),(c&ea)===0&&(c&vn&&(o.f|=ea),Nu(v,Pn))}else d&&((c&ar)!==0&&Sn!==null&&Sn.add(o),In(o))}}function Rt(t){if(typeof t!="object"||t===null||Zr in t)return t;const e=du(t);if(e!==wf&&e!==kf)return t;var r=new Map,a=xo(t),i=Pe(0),o=$r,c=d=>{if($r===o)return d();var v=Ye,p=$r;mn(null),Pl(o);var m=d();return mn(v),Pl(p),m};return a&&r.set("length",Pe(t.length)),new Proxy(t,{defineProperty(d,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Nf();var m=r.get(v);return m===void 0?c(()=>{var x=Pe(p.value);return r.set(v,x),x}):q(m,p.value,!0),!0},deleteProperty(d,v){var p=r.get(v);if(p===void 0){if(v in d){const m=c(()=>Pe(Ct));r.set(v,m),rs(i)}}else q(p,Ct),rs(i);return!0},get(d,v,p){var k;if(v===Zr)return t;var m=r.get(v),x=v in d;if(m===void 0&&(!x||(k=ga(d,v))!=null&&k.writable)&&(m=c(()=>{var M=Rt(x?d[v]:Ct),L=Pe(M);return L}),r.set(v,m)),m!==void 0){var _=b(m);return _===Ct?void 0:_}return Reflect.get(d,v,p)},getOwnPropertyDescriptor(d,v){var p=Reflect.getOwnPropertyDescriptor(d,v);if(p&&"value"in p){var m=r.get(v);m&&(p.value=b(m))}else if(p===void 0){var x=r.get(v),_=x==null?void 0:x.v;if(x!==void 0&&_!==Ct)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return p},has(d,v){var _;if(v===Zr)return!0;var p=r.get(v),m=p!==void 0&&p.v!==Ct||Reflect.has(d,v);if(p!==void 0||tt!==null&&(!m||(_=ga(d,v))!=null&&_.writable)){p===void 0&&(p=c(()=>{var k=m?Rt(d[v]):Ct,M=Pe(k);return M}),r.set(v,p));var x=b(p);if(x===Ct)return!1}return m},set(d,v,p,m){var re;var x=r.get(v),_=v in d;if(a&&v==="length")for(var k=p;k<x.v;k+=1){var M=r.get(k+"");M!==void 0?q(M,Ct):k in d&&(M=c(()=>Pe(Ct)),r.set(k+"",M))}if(x===void 0)(!_||(re=ga(d,v))!=null&&re.writable)&&(x=c(()=>Pe(void 0)),q(x,Rt(p)),r.set(v,x));else{_=x.v!==Ct;var L=c(()=>Rt(p));q(x,L)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(m,p),!_){if(a&&typeof v=="string"){var F=r.get("length"),ie=Number(v);Number.isInteger(ie)&&ie>=F.v&&q(F,ie+1)}rs(i)}return!0},ownKeys(d){b(i);var v=Reflect.ownKeys(d).filter(x=>{var _=r.get(x);return _===void 0||_.v!==Ct});for(var[p,m]of r)m.v!==Ct&&!(p in d)&&v.push(p);return v},setPrototypeOf(){jf()}})}function Al(t){try{if(t!==null&&typeof t=="object"&&Zr in t)return t[Zr]}catch{}return t}function md(t,e){return Object.is(Al(t),Al(e))}var Cl,ju,qu,Bu;function yd(){if(Cl===void 0){Cl=window,ju=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;qu=ga(e,"firstChild").get,Bu=ga(e,"nextSibling").get,Sl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Sl(r)&&(r.__t=void 0)}}function rr(t=""){return document.createTextNode(t)}function nn(t){return qu.call(t)}function hs(t){return Bu.call(t)}function w(t,e){return nn(t)}function ot(t,e=!1){{var r=nn(t);return r instanceof Comment&&r.data===""?hs(r):r}}function A(t,e=1,r=!1){let a=t;for(;e--;)a=hs(a);return a}function bd(t){t.textContent=""}function zu(){return!1}function _d(t,e,r){return document.createElementNS(bu,t,void 0)}let Il=!1;function wd(){Il||(Il=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Ao(t){var e=Ye,r=tt;mn(null),Kn(null);try{return t()}finally{mn(e),Kn(r)}}function Fu(t,e,r,a=r){t.addEventListener(e,()=>Ao(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),wd()}function kd(t){tt===null&&(Ye===null&&Df(),Of()),Tr&&Pf()}function xd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function sr(t,e,r){var a=tt;a!==null&&(a.f&rn)!==0&&(t|=rn);var i={ctx:an,deps:null,nodes:null,f:t|Dt|vn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ia(i)}catch(d){throw Qt(i),d}else e!==null&&In(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ra)===0&&(o=o.first,(t&ar)!==0&&(t&Ta)!==0&&o!==null&&(o.f|=Ta)),o!==null&&(o.parent=a,a!==null&&xd(o,a),Ye!==null&&(Ye.f&Ot)!==0&&(t&sa)===0)){var c=Ye;(c.effects??(c.effects=[])).push(o)}return i}function Co(){return Ye!==null&&!Rn}function Ku(t){const e=sr(li,null,!1);return bt(e,Tt),e.teardown=t,e}function $s(t){kd();var e=tt.f,r=!Ye&&(e&On)!==0&&(e&ps)===0;if(r){var a=an;(a.e??(a.e=[])).push(t)}else return Uu(t)}function Uu(t){return sr(is|Tf,t,!1)}function Sd(t){xr.ensure();const e=sr(sa|Ra,t,!0);return(r={})=>new Promise(a=>{r.outro?Jr(e,()=>{Qt(e),a(void 0)}):(Qt(e),a(void 0))})}function Gu(t){return sr(is,t,!1)}function Td(t){return sr(So|Ra,t,!0)}function Io(t,e=0){return sr(li|e,t,!0)}function ge(t,e=[],r=[],a=[]){ud(a,e,r,i=>{sr(li,()=>t(...i.map(b)),!0)})}function Ro(t,e=0){var r=sr(ar|e,t,!0);return r}function hn(t){return sr(On|Ra,t,!0)}function Hu(t){var e=t.teardown;if(e!==null){const r=Tr,a=Ye;Rl(!0),mn(null);try{e.call(null)}finally{Rl(r),mn(a)}}}function Po(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Ao(()=>{i.abort(Kr)});var a=r.next;(r.f&sa)!==0?r.parent=null:Qt(r,e),r=a}}function Ed(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&On)===0&&Qt(e),e=r}}function Qt(t,e=!0){var r=!1;(e||(t.f&gu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Wu(t.nodes.start,t.nodes.end),r=!0),Po(t,e&&!r),os(t,0),bt(t,nr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Hu(t);var i=t.parent;i!==null&&i.first!==null&&Yu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Wu(t,e){for(;t!==null;){var r=t===e?null:hs(t);t.remove(),t=r}}function Yu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function Jr(t,e,r=!0){var a=[];Vu(t,a,!0);var i=()=>{r&&Qt(t),e&&e()},o=a.length;if(o>0){var c=()=>--o||i();for(var d of a)d.out(c)}else i()}function Vu(t,e,r){if((t.f&rn)===0){t.f^=rn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Ta)!==0||(i.f&On)!==0&&(t.f&ar)!==0;Vu(i,e,c?r:!1),i=o}}}function Oo(t){Xu(t,!0)}function Xu(t,e){if((t.f&rn)!==0){t.f^=rn,(t.f&Tt)===0&&(bt(t,Dt),In(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ta)!==0||(r.f&On)!==0;Xu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Qu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:hs(r);e.append(r),r=i}}let Ys=!1,Tr=!1;function Rl(t){Tr=t}let Ye=null,Rn=!1;function mn(t){Ye=t}let tt=null;function Kn(t){tt=t}let gn=null;function Zu(t){Ye!==null&&(gn===null?gn=[t]:gn.push(t))}let Xt=null,en=0,fn=null;function Ad(t){fn=t}let Ju=1,Gr=0,$r=Gr;function Pl(t){$r=t}function $u(){return++Ju}function vs(t){var e=t.f;if((e&Dt)!==0)return!0;if(e&Ot&&(t.f&=~ea),(e&Pn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(vs(o)&&Du(o),o.wv>t.wv)return!0}(e&vn)!==0&&It===null&&bt(t,Tt)}return!1}function ec(t,e,r=!0){var a=t.reactions;if(a!==null&&!(gn!==null&&Sa.call(gn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Ot)!==0?ec(o,e,!1):e===o&&(r?bt(o,Dt):(o.f&Tt)!==0&&bt(o,Pn),In(o))}}function tc(t){var L;var e=Xt,r=en,a=fn,i=Ye,o=gn,c=an,d=Rn,v=$r,p=t.f;Xt=null,en=0,fn=null,Ye=(p&(On|sa))===0?t:null,gn=null,Ea(t.ctx),Rn=!1,$r=++Gr,t.ac!==null&&(Ao(()=>{t.ac.abort(Kr)}),t.ac=null);try{t.f|=Ji;var m=t.fn,x=m();t.f|=ps;var _=t.deps,k=Be==null?void 0:Be.is_fork;if(Xt!==null){var M;if(k||os(t,en),_!==null&&en>0)for(_.length=en+Xt.length,M=0;M<Xt.length;M++)_[en+M]=Xt[M];else t.deps=_=Xt;if(Co()&&(t.f&vn)!==0)for(M=en;M<_.length;M++)((L=_[M]).reactions??(L.reactions=[])).push(t)}else!k&&_!==null&&en<_.length&&(os(t,en),_.length=en);if(ku()&&fn!==null&&!Rn&&_!==null&&(t.f&(Ot|Pn|Dt))===0)for(M=0;M<fn.length;M++)ec(fn[M],t);if(i!==null&&i!==t){if(Gr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Gr;if(e!==null)for(const S of e)S.rv=Gr;fn!==null&&(a===null?a=fn:a.push(...fn))}return(t.f&wr)!==0&&(t.f^=wr),x}catch(S){return Su(S)}finally{t.f^=Ji,Xt=e,en=r,fn=a,Ye=i,gn=o,Ea(c),Rn=d,$r=v}}function Cd(t,e){let r=e.reactions;if(r!==null){var a=yf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Ot)!==0&&(Xt===null||!Sa.call(Xt,e))){var o=e;(o.f&vn)!==0&&(o.f^=vn,o.f&=~ea),To(o),hd(o),os(o,0)}}function os(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Cd(t,r[a])}function Ia(t){var e=t.f;if((e&nr)===0){bt(t,Tt);var r=tt,a=Ys;tt=t,Ys=!0;try{(e&(ar|hu))!==0?Ed(t):Po(t),Hu(t);var i=tc(t);t.teardown=typeof i=="function"?i:null,t.wv=Ju;var o;Zi&&Jf&&(t.f&Dt)!==0&&t.deps}finally{Ys=a,tt=r}}}async function nc(){await Promise.resolve(),td()}function b(t){var e=t.f,r=(e&Ot)!==0;if(Ye!==null&&!Rn){var a=tt!==null&&(tt.f&nr)!==0;if(!a&&(gn===null||!Sa.call(gn,t))){var i=Ye.deps;if((Ye.f&Ji)!==0)t.rv<Gr&&(t.rv=Gr,Xt===null&&i!==null&&i[en]===t?en++:Xt===null?Xt=[t]:Xt.push(t));else{(Ye.deps??(Ye.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ye]:Sa.call(o,Ye)||o.push(Ye)}}}if(Tr&&Sr.has(t))return Sr.get(t);if(r){var c=t;if(Tr){var d=c.v;return((c.f&Tt)===0&&c.reactions!==null||ac(c))&&(d=Eo(c)),Sr.set(c,d),d}var v=(c.f&vn)===0&&!Rn&&Ye!==null&&(Ys||(Ye.f&vn)!==0),p=(c.f&ps)===0;vs(c)&&(v&&(c.f|=vn),Du(c)),v&&!p&&(Mu(c),rc(c))}if(It!=null&&It.has(t))return It.get(t);if((t.f&wr)!==0)throw t.v;return t.v}function rc(t){if(t.f|=vn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ot)!==0&&(e.f&vn)===0&&(Mu(e),rc(e))}function ac(t){if(t.v===Ct)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Sr.has(e)||(e.f&Ot)!==0&&ac(e))return!0;return!1}function gs(t){var e=Rn;try{return Rn=!0,t()}finally{Rn=e}}const Id=["touchstart","touchmove"];function Rd(t){return Id.includes(t)}const sc=new Set,io=new Set;function Mt(t){for(var e=0;e<t.length;e++)sc.add(t[e]);for(var r of io)r(t)}let Ol=null;function Dl(t){var S;var e=this,r=e.ownerDocument,a=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;Ol=t;var c=0,d=Ol===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;v<=p&&(c=v)}if(o=i[c]||t.target,o!==e){bf(t,"currentTarget",{configurable:!0,get(){return o||r}});var m=Ye,x=tt;mn(null),Kn(null);try{for(var _,k=[];o!==null;){var M=o.assignedSlot||o.parentNode||o.host||null;try{var L=o["__"+a];L!=null&&(!o.disabled||t.target===o)&&L.call(o,t)}catch(F){_?k.push(F):_=F}if(t.cancelBubble||M===e||M===null)break;o=M}if(_){for(let F of k)queueMicrotask(()=>{throw F});throw _}}finally{t.__root=e,delete t.currentTarget,mn(m),Kn(x)}}}var uu,cu;const Bi=(cu=(uu=globalThis==null?void 0:globalThis.window)==null?void 0:uu.trustedTypes)==null?void 0:cu.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Pd(t){return(Bi==null?void 0:Bi.createHTML(t))??t}function Do(t,e=!1){var r=_d("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Pd(t):t,r.content}function na(t,e){var r=tt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function W(t,e){var r=(e&yu)!==0,a=(e&Vf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Do(o?t:"<!>"+t,!0),r||(i=nn(i)));var c=a||ju?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=nn(c),v=c.lastChild;na(d,v)}else na(c,c);return c}}function Od(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&yu)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Do(o,!0),v=nn(d);if(i)for(c=document.createDocumentFragment();nn(v);)c.appendChild(nn(v));else c=nn(v)}var p=c.cloneNode(!0);if(i){var m=nn(p),x=p.lastChild;na(m,x)}else na(p,p);return p}}function Mo(t,e){return Od(t,e,"svg")}function Ml(t=""){{var e=rr(t+"");return na(e,e),e}}function Pa(){var t=document.createDocumentFragment(),e=document.createComment(""),r=rr();return t.append(e,r),na(e,r),t}function K(t,e){t!==null&&t.before(e)}function oe(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Dd(t,e){return Md(t,e)}const qs=new Map;function Md(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:c=!0}){yd();var d=new Set,v=x=>{for(var _=0;_<x.length;_++){var k=x[_];if(!d.has(k)){d.add(k);var M=Rd(k);for(const F of[e,document]){var L=qs.get(F);L===void 0&&(L=new Map,qs.set(F,L));var S=L.get(k);S===void 0?(F.addEventListener(k,Dl,{passive:M}),L.set(k,1)):L.set(k,S+1)}}}};v(oi(sc)),io.add(v);var p=void 0,m=Sd(()=>{var x=r??e.appendChild(rr());return sd(x,{pending:()=>{}},_=>{ft({});var k=an;o&&(k.c=o),i&&(a.$$events=i),p=t(_,a)||{},dt()}),()=>{var L;for(var _ of d)for(const S of[e,document]){var k=qs.get(S),M=k.get(_);--M==0?(S.removeEventListener(_,Dl),k.delete(_),k.size===0&&qs.delete(S)):k.set(_,M)}io.delete(v),x!==r&&((L=x.parentNode)==null||L.removeChild(x))}});return Ld.set(p,m),p}let Ld=new WeakMap;var En,Fn,tn,Qr,fs,ds,ii;class Nd{constructor(e,r=!0){He(this,"anchor");We(this,En,new Map);We(this,Fn,new Map);We(this,tn,new Map);We(this,Qr,new Set);We(this,fs,!0);We(this,ds,()=>{var e=Be;if(X(this,En).has(e)){var r=X(this,En).get(e),a=X(this,Fn).get(r);if(a)Oo(a),X(this,Qr).delete(r);else{var i=X(this,tn).get(r);i&&(X(this,Fn).set(r,i.effect),X(this,tn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,c]of X(this,En)){if(X(this,En).delete(o),o===e)break;const d=X(this,tn).get(c);d&&(Qt(d.effect),X(this,tn).delete(c))}for(const[o,c]of X(this,Fn)){if(o===r||X(this,Qr).has(o))continue;const d=()=>{if(Array.from(X(this,En).values()).includes(o)){var p=document.createDocumentFragment();Qu(c,p),p.append(rr()),X(this,tn).set(o,{effect:c,fragment:p})}else Qt(c);X(this,Qr).delete(o),X(this,Fn).delete(o)};X(this,fs)||!a?(X(this,Qr).add(o),Jr(c,d,!1)):d()}}});We(this,ii,e=>{X(this,En).delete(e);const r=Array.from(X(this,En).values());for(const[a,i]of X(this,tn))r.includes(a)||(Qt(i.effect),X(this,tn).delete(a))});this.anchor=e,Ke(this,fs,r)}ensure(e,r){var a=Be,i=zu();if(r&&!X(this,Fn).has(e)&&!X(this,tn).has(e))if(i){var o=document.createDocumentFragment(),c=rr();o.append(c),X(this,tn).set(e,{effect:hn(()=>r(c)),fragment:o})}else X(this,Fn).set(e,hn(()=>r(this.anchor)));if(X(this,En).set(a,e),i){for(const[d,v]of X(this,Fn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of X(this,tn))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(X(this,ds)),a.ondiscard(X(this,ii))}else X(this,ds).call(this)}}En=new WeakMap,Fn=new WeakMap,tn=new WeakMap,Qr=new WeakMap,fs=new WeakMap,ds=new WeakMap,ii=new WeakMap;function Se(t,e,r=!1){var a=new Nd(t),i=r?Ta:0;function o(c,d){a.ensure(c,d)}Ro(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function Er(t,e){return e}function jd(t,e,r){for(var a=[],i=e.length,o,c=e.length,d=0;d<i;d++){let x=e[d];Jr(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var _=t.outrogroups;oo(oi(o.done)),_.delete(o),_.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=a.length===0&&r!==null;if(v){var p=r,m=p.parentNode;bd(m),m.append(p),t.items.clear()}oo(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function oo(t,e=!0){for(var r=0;r<t.length;r++)Qt(t[r],e)}var Ll;function sn(t,e,r,a,i,o=null){var c=t,d=new Map,v=(e&mu)!==0;if(v){var p=t;c=p.appendChild(rr())}var m=null,x=Ou(()=>{var F=r();return xo(F)?F:F==null?[]:oi(F)}),_,k=!0;function M(){S.fallback=m,qd(S,_,c,e,a),m!==null&&(_.length===0?(m.f&tr)===0?Oo(m):(m.f^=tr,es(m,null,c)):Jr(m,()=>{m=null}))}var L=Ro(()=>{_=b(x);for(var F=_.length,ie=new Set,re=Be,G=zu(),J=0;J<F;J+=1){var te=_[J],Y=a(te,J),ve=k?null:d.get(Y);ve?(ve.v&&Ca(ve.v,te),ve.i&&Ca(ve.i,J),G&&re.unskip_effect(ve.e)):(ve=Bd(d,k?c:Ll??(Ll=rr()),te,Y,J,i,e,r),k||(ve.e.f|=tr),d.set(Y,ve)),ie.add(Y)}if(F===0&&o&&!m&&(k?m=hn(()=>o(c)):(m=hn(()=>o(Ll??(Ll=rr()))),m.f|=tr)),F>ie.size&&Rf(),!k)if(G){for(const[Oe,be]of d)ie.has(Oe)||re.skip_effect(be.e);re.oncommit(M),re.ondiscard(()=>{})}else M();b(x)}),S={effect:L,items:d,outrogroups:null,fallback:m};k=!1}function Wa(t){for(;t!==null&&(t.f&On)===0;)t=t.next;return t}function qd(t,e,r,a,i){var be,he,se,ue,Re,$,ae,le,V;var o=(a&Kf)!==0,c=e.length,d=t.items,v=Wa(t.effect.first),p,m=null,x,_=[],k=[],M,L,S,F;if(o)for(F=0;F<c;F+=1)M=e[F],L=i(M,F),S=d.get(L).e,(S.f&tr)===0&&((he=(be=S.nodes)==null?void 0:be.a)==null||he.measure(),(x??(x=new Set)).add(S));for(F=0;F<c;F+=1){if(M=e[F],L=i(M,F),S=d.get(L).e,t.outrogroups!==null)for(const ne of t.outrogroups)ne.pending.delete(S),ne.done.delete(S);if((S.f&tr)!==0)if(S.f^=tr,S===v)es(S,null,r);else{var ie=m?m.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),mr(t,m,S),mr(t,S,ie),es(S,ie,r),m=S,_=[],k=[],v=Wa(m.next);continue}if((S.f&rn)!==0&&(Oo(S),o&&((ue=(se=S.nodes)==null?void 0:se.a)==null||ue.unfix(),(x??(x=new Set)).delete(S))),S!==v){if(p!==void 0&&p.has(S)){if(_.length<k.length){var re=k[0],G;m=re.prev;var J=_[0],te=_[_.length-1];for(G=0;G<_.length;G+=1)es(_[G],re,r);for(G=0;G<k.length;G+=1)p.delete(k[G]);mr(t,J.prev,te.next),mr(t,m,J),mr(t,te,re),v=re,m=te,F-=1,_=[],k=[]}else p.delete(S),es(S,v,r),mr(t,S.prev,S.next),mr(t,S,m===null?t.effect.first:m.next),mr(t,m,S),m=S;continue}for(_=[],k=[];v!==null&&v!==S;)(p??(p=new Set)).add(v),k.push(v),v=Wa(v.next);if(v===null)continue}(S.f&tr)===0&&_.push(S),m=S,v=Wa(S.next)}if(t.outrogroups!==null){for(const ne of t.outrogroups)ne.pending.size===0&&(oo(oi(ne.done)),(Re=t.outrogroups)==null||Re.delete(ne));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||p!==void 0){var Y=[];if(p!==void 0)for(S of p)(S.f&rn)===0&&Y.push(S);for(;v!==null;)(v.f&rn)===0&&v!==t.fallback&&Y.push(v),v=Wa(v.next);var ve=Y.length;if(ve>0){var Oe=(a&mu)!==0&&c===0?r:null;if(o){for(F=0;F<ve;F+=1)(ae=($=Y[F].nodes)==null?void 0:$.a)==null||ae.measure();for(F=0;F<ve;F+=1)(V=(le=Y[F].nodes)==null?void 0:le.a)==null||V.fix()}jd(t,Y,Oe)}}o&&kr(()=>{var ne,de;if(x!==void 0)for(S of x)(de=(ne=S.nodes)==null?void 0:ne.a)==null||de.apply()})}function Bd(t,e,r,a,i,o,c,d){var v=(c&zf)!==0?(c&Uf)===0?vd(r,!1,!1):ta(r):null,p=(c&Ff)!==0?ta(i):null;return{v,i:p,e:hn(()=>(o(e,v??r,p??i,d),()=>{t.delete(a)}))}}function es(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&tr)===0?e.nodes.start:r;a!==null;){var c=hs(a);if(o.before(a),a===i)return;a=c}}function mr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function zd(t,e,r=!1,a=!1,i=!1){var o=t,c="";ge(()=>{var d=tt;if(c!==(c=e()??"")&&(d.nodes!==null&&(Wu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var p=Do(v);if((r||a)&&(p=nn(p)),na(nn(p),p.lastChild),r||a)for(;nn(p);)o.before(nn(p));else o.before(p)}})}const Nl=[...` 	
\r\fÂ \v\uFEFF`];function Fd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,c=0;(c=a.indexOf(i,c))>=0;){var d=c+o;(c===0||Nl.includes(a[c-1]))&&(d===a.length||Nl.includes(a[d]))?a=(c===0?"":a.substring(0,c))+a.substring(d+1):c=d}}return a===""?null:a}function jl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function zi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Kd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(zi)),i&&v.push(...Object.keys(i).map(zi));var p=0,m=-1;const L=t.length;for(var x=0;x<L;x++){var _=t[x];if(d?_==="/"&&t[x-1]==="*"&&(d=!1):o?o===_&&(o=!1):_==="/"&&t[x+1]==="*"?d=!0:_==='"'||_==="'"?o=_:_==="("?c++:_===")"&&c--,!d&&o===!1&&c===0){if(_===":"&&m===-1)m=x;else if(_===";"||x===L-1){if(m!==-1){var k=zi(t.substring(p,m).trim());if(!v.includes(k)){_!==";"&&x++;var M=t.substring(p,x).trim();r+=" "+M+";"}}p=x+1,m=-1}}}}return a&&(r+=jl(a)),i&&(r+=jl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Bt(t,e,r,a,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Fd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var p=!!o[v];(i==null||p!==!!i[v])&&t.classList.toggle(v,p)}return o}function Fi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function Zt(t,e,r,a){var i=t.__style;if(i!==e){var o=Kd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Fi(t,r==null?void 0:r[0],a[0]),Fi(t,r==null?void 0:r[1],a[1],"important")):Fi(t,r,a));return a}function ic(t,e,r=!1){if(t.multiple){if(e==null)return;if(!xo(e))return Xf();for(var a of t.options)a.selected=e.includes(as(a));return}for(a of t.options){var i=as(a);if(md(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Ud(t){var e=new MutationObserver(()=>{ic(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ku(()=>{e.disconnect()})}function Lo(t,e,r=e){var a=new WeakSet,i=!0;Fu(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),as);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&as(v)}r(d),Be!==null&&a.add(Be)}),Gu(()=>{var o=e();if(t===document.activeElement){var c=Js??Be;if(a.has(c))return}if(ic(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=as(d),r(o))}t.__value=o,i=!1}),Ud(t)}function as(t){return"__value"in t?t.__value:t.value}const Gd=Symbol("is custom element"),Hd=Symbol("is html");function oc(t,e,r,a){var i=Wd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Af]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Yd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Wd(t){return t.__attributes??(t.__attributes={[Gd]:t.nodeName.includes("-"),[Hd]:t.namespaceURI===bu})}var ql=new Map;function Yd(t){var e=t.getAttribute("is")||t.nodeName,r=ql.get(e);if(r)return r;ql.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=_f(i);for(var c in a)a[c].set&&r.push(c);i=du(i)}return r}function No(t,e,r=e){var a=new WeakSet;Fu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Ki(t)?Ui(o):o,r(o),Be!==null&&a.add(Be),await nc(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;c===d&&d===v&&p>v?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=c,t.selectionEnd=Math.min(d,p))}}}),gs(e)==null&&t.value&&(r(Ki(t)?Ui(t.value):t.value),Be!==null&&a.add(Be)),Io(()=>{var i=e();if(t===document.activeElement){var o=Js??Be;if(a.has(o))return}Ki(t)&&i===Ui(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Ki(t){var e=t.type;return e==="number"||e==="range"}function Ui(t){return t===""?null:+t}function Bl(t,e){return t===e||(t==null?void 0:t[Zr])===e}function lc(t={},e,r,a){return Gu(()=>{var i,o;return Io(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&Bl(r(...i),t)&&e(null,...i))})}),()=>{kr(()=>{o&&Bl(r(...o),t)&&e(null,...o)})}}),t}let Bs=!1;function Vd(t){var e=Bs;try{return Bs=!1,[t(),Bs]}finally{Bs=e}}function Ce(t,e,r,a){var ie;var i=(r&Wf)!==0,o=(r&Yf)!==0,c=a,d=!0,v=()=>(d&&(d=!1,c=o?gs(a):a),c),p;if(i){var m=Zr in t||Ef in t;p=((ie=ga(t,e))==null?void 0:ie.set)??(m&&e in t?re=>t[e]=re:void 0)}var x,_=!1;i?[x,_]=Vd(()=>t[e]):x=t[e],x===void 0&&a!==void 0&&(x=v(),p&&(Lf(),p(x)));var k;if(k=()=>{var re=t[e];return re===void 0?v():(d=!0,re)},(r&Hf)===0)return k;if(p){var M=t.$$legacy;return(function(re,G){return arguments.length>0?((!G||M||_)&&p(G?k():re),re):k()})}var L=!1,S=((r&Gf)!==0?ci:Ou)(()=>(L=!1,k()));i&&b(S);var F=tt;return(function(re,G){if(arguments.length>0){const J=G?b(S):i?Rt(re):re;return q(S,J),L=!0,c!==void 0&&(c=J),re}return Tr&&L||(F.f&nr)!==0?S.v:b(S)})}function Lt(t){an===null&&Cf(),$s(()=>{const e=gs(t);if(typeof e=="function")return e})}const Xd="5";var fu;typeof window<"u"&&((fu=window.__svelte??(window.__svelte={})).v??(fu.v=new Set)).add(Xd);const ls=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Yt=null,er="idle",Vs=null,zr=new Set;function zs(){return Yt||(Yt=new Worker(new URL(""+new URL("worker-CdBv0KP2.js",import.meta.url).href,import.meta.url),{type:"module"}),Yt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(er="loading"),e.status==="ready"&&(er="ready"),e.status==="start"&&(er="generating"),(e.status==="complete"||e.status==="error")&&(er=Vs?"ready":"idle");for(const r of zr)try{r(e)}catch{}})),Yt}function uc(){return{check(){zs().postMessage({type:"check"})},loadModel(t){Vs=t,er="loading",zs().postMessage({type:"load",modelId:t})},generate(t,e){zs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e){return new Promise((r,a)=>{let i="";const o=d=>{switch(d.status){case"thinking":break;case"thinking-done":break;case"update":i+=d.output;break;case"complete":c(),r(i);break;case"error":c(),a(new Error(d.data));break}},c=()=>{zr.delete(o)};zr.add(o),zs().postMessage({type:"generate",data:t,options:e})})},interrupt(){Yt==null||Yt.postMessage({type:"interrupt"})},reset(){Yt==null||Yt.postMessage({type:"reset"})},onMessage(t){return zr.add(t),()=>zr.delete(t)},offMessage(t){zr.delete(t)},get status(){return er},get isReady(){return er==="ready"},get isGenerating(){return er==="generating"},get modelId(){return Vs},terminate(){Yt==null||Yt.terminate(),Yt=null,er="idle",Vs=null,zr.clear()}}}var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xs={exports:{}},Jd=Xs.exports,zl;function $d(){return zl||(zl=1,(function(t,e){((r,a)=>{t.exports=a()})(Jd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,u=arguments.length;l<u;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var u,f=0,h=s.length;f<h;f++)!u&&f in s||((u=u||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(u||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qd,c=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&c(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,m={}.hasOwnProperty;function x(n,s){return m.call(n,s)}function _(n,s){typeof s=="function"&&(s=s(p(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(s).forEach(function(l){M(n,l,s[l])})}var k=Object.defineProperty;function M(n,s,l,u){k(n,s,v(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function L(n){return{from:function(s){return n.prototype=Object.create(s.prototype),M(n.prototype,"constructor",n),{extend:_.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,F=[].slice;function ie(n,s,l){return F.call(n,s,l)}function re(n,s){return s(n)}function G(n){if(!n)throw new Error("Assertion Failed")}function J(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function te(n,s){if(typeof s=="string"&&x(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],u=0,f=s.length;u<f;++u){var h=te(n,s[u]);l.push(h)}return l}var g,y=s.indexOf(".");return y===-1||(g=n[s.substr(0,y)])==null?void 0:te(g,s.substr(y+1))}function Y(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){G(typeof l!="string"&&"length"in l);for(var u=0,f=s.length;u<f;++u)Y(n,s[u],l[u])}else{var h,g,y=s.indexOf(".");y!==-1?(h=s.substr(0,y),(y=s.substr(y+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:Y(g=(g=n[h])&&x(n,h)?g:n[h]={},y,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ve(n){var s,l={};for(s in n)x(n,s)&&(l[s]=n[s]);return l}var Oe=[].concat;function be(n){return Oe.apply([],n)}var H="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(be([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),he=new Set(H.map(function(n){return o[n]})),se=null;function ue(n){return se=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var u=se.get(l);if(u)return u;if(d(l)){u=[],se.set(l,u);for(var f=0,h=l.length;f<h;++f)u.push(s(l[f]))}else if(he.has(l.constructor))u=l;else{var g,y=p(l);for(g in u=y===Object.prototype?{}:Object.create(y),se.set(l,u),l)x(l,g)&&(u[g]=s(l[g]))}return u})(n),se=null,n}var Re={}.toString;function $(n){return Re.call(n).slice(8,-1)}var ae=typeof Symbol<"u"?Symbol.iterator:"@@iterator",le=typeof ae=="symbol"?function(n){var s;return n!=null&&(s=n[ae])&&s.apply(n)}:function(){return null};function V(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ne={};function de(n){var s,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ne&&typeof n=="string")return[n];if(f=le(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var ye=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},H=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],_t=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(H),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function U(n,s){this.name=n,this.message=s}function Z(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function Ne(n,s,l,u){this.failures=s,this.failedKeys=u,this.successCount=l,this.message=Z(n,s)}function _e(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=Z(n,this.failures)}L(U).from(Error).extend({toString:function(){return this.name+": "+this.message}}),L(Ne).from(U),L(_e).from(U);var Ge=_t.reduce(function(n,s){return n[s]=s+"Error",n},{}),nt=U,Ee=_t.reduce(function(n,s){var l=s+"Error";function u(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=ee[s]||l,this.inner=null)}return L(u).from(nt),n[s]=u,n},{}),lt=(Ee.Syntax=SyntaxError,Ee.Type=TypeError,Ee.Range=RangeError,H.reduce(function(n,s){return n[s+"Error"]=Ee[s],n},{}));H=_t.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=Ee[s]),n},{});function ze(){}function rt(n){return n}function Gn(n,s){return n==null||n===rt?s:function(l){return s(n(l))}}function At(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Ar(n,s){return n===ze?s:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?At(u,this.onsuccess):u),f&&(this.onerror=this.onerror?At(f,this.onerror):f),h!==void 0?h:l}}function Oa(n,s){return n===ze?s:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?At(l,this.onsuccess):l),u&&(this.onerror=this.onerror?At(u,this.onerror):u)}}function ir(n,s){return n===ze?s:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),h=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?At(f,this.onsuccess):f),h&&(this.onerror=this.onerror?At(h,this.onerror):h),u===void 0?g===void 0?void 0:g:v(u,g)}}function oa(n,s){return n===ze?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function or(n,s){return n===ze?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return s.apply(u,h)})}return s.apply(this,arguments)}}H.ModifyError=Ne,H.DexieError=U,H.BulkError=_e;var Jt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Da(n){Jt=n}var Cr={},la=100,bn=typeof Promise>"u"?[]:(_t=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[bn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(bn),_t]:[_t,p(_t),_t]),_t=bn[0],ha=bn[1],ha=ha&&ha.then,kt=_t&&_t.constructor,Ir=!!bn[2],lr=function(n,s){Wn.push([n,s]),ur&&(queueMicrotask(dr),ur=!1)},ua=!0,ur=!0,Dn=[],Hn=[],cr=rt,xt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ze,pgp:!1,env:{},finalize:ze},Me=xt,Wn=[],_n=0,ca=[];function Te(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Me;if(typeof n!="function"){if(n!==Cr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Yn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(u,f){try{f(function(h){if(u._state===null){if(h===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&pr();h&&typeof h.then=="function"?l(u,function(y,I){h instanceof Te?h._then(y,I):h.then(y,I)}):(u._state=!0,u._value=h,bs(u)),g&&Vn()}},Yn.bind(null,u))}catch(h){Yn(u,h)}})(this,n)}var fr={get:function(){var n=Me,s=Dr;function l(u,f){var h=this,g=!n.global&&(n!==Me||s!==Dr),y=g&&!kn(),I=new Te(function(j,R){Ma(h,new ys(E(u,n,g,y),E(f,n,g,y),j,R,n))});return this._consoleTask&&(I._consoleTask=this._consoleTask),I}return l.prototype=Cr,l},set:function(n){M(this,"then",n&&n.prototype===Cr?fr:{get:function(){return n},set:fr.set})}};function ys(n,s,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=u,this.psd=f}function Yn(n,s){var l,u;Hn.push(s),n._state===null&&(l=n._lib&&pr(),s=cr(s),n._state=!1,n._value=s,u=n,Dn.some(function(f){return f._value===u._value})||Dn.push(u),bs(n),l)&&Vn()}function bs(n){var s=n._listeners;n._listeners=[];for(var l=0,u=s.length;l<u;++l)Ma(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),_n===0&&(++_n,lr(function(){--_n==0&&Rr()},[]))}function Ma(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++_n,lr(gt,[l,n,s])}}function gt(n,s,l){try{var u,f=s._value;!s._state&&Hn.length&&(Hn=[]),u=Jt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||Hn.indexOf(f)!==-1||(h=>{for(var g=Dn.length;g;)if(Dn[--g]._value===h._value)return Dn.splice(g,1)})(s),l.resolve(u)}catch(h){l.reject(h)}finally{--_n==0&&Rr(),--l.psd.ref||l.psd.finalize()}}function dr(){Le(xt,function(){pr()&&Vn()})}function pr(){var n=ua;return ur=ua=!1,n}function Vn(){var n,s,l;do for(;0<Wn.length;)for(n=Wn,Wn=[],l=n.length,s=0;s<l;++s){var u=n[s];u[0].apply(null,u[1])}while(0<Wn.length);ur=ua=!0}function Rr(){for(var n=Dn,s=(Dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),ca.slice(0)),l=s.length;l;)s[--l]()}function Pr(n){return new Te(Cr,!1,n)}function at(n,s){var l=Me;return function(){var u=pr(),f=Me;try{return xn(l,!0),n.apply(this,arguments)}catch(h){s&&s(h)}finally{xn(f,!1),u&&Vn()}}}_(Te.prototype,{then:fr,_then:function(n,s){Ma(this,new ys(null,null,n,s,Me))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(u){return(u instanceof s?l:Pr)(u)}):this.then(null,function(u){return(u&&u.name===s?l:Pr)(u)}))},finally:function(n){return this.then(function(s){return Te.resolve(n()).then(function(){return s})},function(s){return Te.resolve(n()).then(function(){return Pr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Te(function(u,f){var h=setTimeout(function(){return f(new Ee.Timeout(s))},n);l.then(u,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(Te.prototype,Symbol.toStringTag,"Dexie.Promise"),xt.env=ws(),_(Te,{all:function(){var n=de.apply(null,arguments).map(Mr);return new Te(function(s,l){n.length===0&&s([]);var u=n.length;n.forEach(function(f,h){return Te.resolve(f).then(function(g){n[h]=g,--u||s(n)},l)})})},resolve:function(n){return n instanceof Te?n:n&&typeof n.then=="function"?new Te(function(s,l){n.then(s,l)}):new Te(Cr,!0,n)},reject:Pr,race:function(){var n=de.apply(null,arguments).map(Mr);return new Te(function(s,l){n.map(function(u){return Te.resolve(u).then(s,l)})})},PSD:{get:function(){return Me},set:function(n){return Me=n}},totalEchoes:{get:function(){return Dr}},newPSD:wn,usePSD:Le,scheduler:{get:function(){return lr},set:function(n){lr=n}},rejectionMapper:{get:function(){return cr},set:function(n){cr=n}},follow:function(n,s){return new Te(function(l,u){return wn(function(f,h){var g=Me;g.unhandleds=[],g.onunhandled=h,g.finalize=At(function(){var y,I=this;y=function(){I.unhandleds.length===0?f():h(I.unhandleds[0])},ca.push(function j(){y(),ca.splice(ca.indexOf(j),1)}),++_n,lr(function(){--_n==0&&Rr()},[])},g.finalize),n()},s,l,u)})}}),kt&&(kt.allSettled&&M(Te,"allSettled",function(){var n=de.apply(null,arguments).map(Mr);return new Te(function(s){n.length===0&&s([]);var l=n.length,u=new Array(l);n.forEach(function(f,h){return Te.resolve(f).then(function(g){return u[h]={status:"fulfilled",value:g}},function(g){return u[h]={status:"rejected",reason:g}}).then(function(){return--l||s(u)})})})}),kt.any&&typeof AggregateError<"u"&&M(Te,"any",function(){var n=de.apply(null,arguments).map(Mr);return new Te(function(s,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(h,g){return Te.resolve(h).then(function(y){return s(y)},function(y){f[g]=y,--u||l(new AggregateError(f))})})})}),kt.withResolvers)&&(Te.withResolvers=kt.withResolvers);var wt={awaits:0,echoes:0,id:0},ln=0,un=[],Or=0,Dr=0,La=0;function wn(n,g,l,u){var f=Me,h=Object.create(f),g=(h.parent=f,h.ref=0,h.global=!1,h.id=++La,xt.env,h.env=Ir?{Promise:Te,PromiseProp:{value:Te,configurable:!0,writable:!0},all:Te.all,race:Te.race,allSettled:Te.allSettled,any:Te.any,resolve:Te.resolve,reject:Te.reject}:{},g&&v(h,g),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Le(h,n,l,u));return h.ref===0&&h.finalize(),g}function Nt(){return wt.id||(wt.id=++ln),++wt.awaits,wt.echoes+=la,wt.id}function kn(){return!!wt.awaits&&(--wt.awaits==0&&(wt.id=0),wt.echoes=wt.awaits*la,!0)}function Mr(n){return wt.echoes&&n&&n.constructor===kt?(Nt(),n.then(function(s){return kn(),s},function(s){return kn(),we(s)})):n}function _s(){var n=un[un.length-1];un.pop(),xn(n,!1)}function xn(n,s){var l,u,f=Me;(s?!wt.echoes||Or++&&n===Me:!Or||--Or&&n===Me)||queueMicrotask(s?(function(h){++Dr,wt.echoes&&--wt.echoes!=0||(wt.echoes=wt.awaits=wt.id=0),un.push(Me),xn(h,!0)}).bind(null,n):_s),n!==Me&&(Me=n,f===xt&&(xt.env=ws()),Ir)&&(l=xt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function ws(){var n=o.Promise;return Ir?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Le(n,s,l,u,f){var h=Me;try{return xn(n,!0),s(l,u,f)}finally{xn(h,!1)}}function E(n,s,l,u){return typeof n!="function"?n:function(){var f=Me;l&&Nt(),xn(s,!0);try{return n.apply(this,arguments)}finally{xn(f,!1),u&&queueMicrotask(kn)}}}function pe(n){Promise===kt&&wt.echoes===0?Or===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ha).indexOf("[native code]")===-1&&(Nt=kn=ze);var we=Te.reject,Ze="ï¿¿",st="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",pt="String expected.",mt=[],Ht="__dbnames",Mn="readonly",Lr="readwrite";function ut(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Na={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Nr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=ue(s))[n],s}}function Qo(){throw Ee.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ve(n,s){try{var l=Zo(n),u=Zo(s);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=Jo(n),h=Jo(s),g=f.length,y=h.length,I=g<y?g:y,j=0;j<I;++j)if(f[j]!==h[j])return f[j]<h[j]?-1:1;return g===y?0:g<y?-1:1;case"Array":for(var R=n,T=s,O=R.length,D=T.length,P=O<D?O:D,C=0;C<P;++C){var B=Ve(R[C],T[C]);if(B!==0)return B}return O===D?0:O<D?-1:1}}catch{}return NaN}function Zo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=$(n))==="ArrayBuffer")?"binary":s}function Jo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ks(n,s,l){var u=n.schema.yProps;return u?(s&&0<l.numFailures&&(s=s.filter(function(f,h){return!l.failures[h]})),Promise.all(u.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}$o.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var u=s.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var ja=$o;function $o(n){this["@@propmod"]=n}function el(n,s){for(var l=c(s),u=l.length,f=!1,h=0;h<u;++h){var g=l[h],y=s[g],I=te(n,g);y instanceof ja?(Y(n,g,y.execute(I)),f=!0):I!==y&&(Y(n,g,y),f=!0)}return f}it.prototype._trans=function(n,s,l){var u=this._tx||Me.trans,f=this.name,h=Jt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(j,R,T){if(T.schema[f])return s(T.idbtrans,T);throw new Ee.NotFound("Table "+f+" not part of transaction")}var y=pr();try{var I=u&&u.db._novip===this.db._novip?u===Me.trans?u._promise(n,g,l):wn(function(){return u._promise(n,g,l)},{trans:u,transless:Me.transless||Me}):(function j(R,T,O,D){if(R.idbdb&&(R._state.openComplete||Me.letThrough||R._vip)){var P=R._createTransaction(T,O,R._dbSchema);try{P.create(),R._state.PR1398_maxLoop=3}catch(C){return C.name===Ge.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return j(R,T,O,D)})):we(C)}return P._promise(T,function(C,B){return wn(function(){return Me.trans=P,D(C,B,P)})}).then(function(C){if(T==="readwrite")try{P.idbtrans.commit()}catch{}return T==="readonly"?C:P._completion.then(function(){return C})})}if(R._state.openComplete)return we(new Ee.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return we(new Ee.DatabaseClosed);R.open().catch(ze)}return R._state.dbReadyPromise.then(function(){return j(R,T,O,D)})})(this.db,n,[this.name],g);return h&&(I._consoleTask=h,I=I.catch(function(j){return console.trace(j),we(j)})),I}finally{y&&Vn()}},it.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?we(new Ee.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},it.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=c(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&s.every(function(j){return 0<=y.keyPath.indexOf(j)})){for(var I=0;I<s.length;++I)if(s.indexOf(y.keyPath[I])===-1)return!1;return!0}return!1}).sort(function(y,I){return y.keyPath.length-I.keyPath.length})[0];if(l&&this.db._maxKey!==Ze)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(y){return n[y]}));!l&&Jt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var u=this.schema.idxByName;function f(y,I){return Ve(y,I)===0}var g=s.reduce(function(R,I){var j=R[0],R=R[1],T=u[I],O=n[I];return[j||T,j||!T?ut(R,T&&T.multi?function(D){return D=te(D,I),d(D)&&D.some(function(P){return f(O,P)})}:function(D){return f(O,te(D,I))}):R]},[null,null]),h=g[0],g=g[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},it.prototype.filter=function(n){return this.toCollection().and(n)},it.prototype.count=function(n){return this.toCollection().count(n)},it.prototype.offset=function(n){return this.toCollection().offset(n)},it.prototype.limit=function(n){return this.toCollection().limit(n)},it.prototype.each=function(n){return this.toCollection().each(n)},it.prototype.toArray=function(n){return this.toCollection().toArray(n)},it.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},it.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},it.prototype.reverse=function(){return this.toCollection().reverse()},it.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Qo&&(n=(g=>{var y=R,I=g;if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function j(){this.constructor=y}function R(){return g!==null&&g.apply(this,arguments)||this}return r(y,I),y.prototype=I===null?Object.create(I):(j.prototype=I.prototype,new j),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function h(g){if(!g)return g;var y,I=Object.create(n.prototype);for(y in g)if(!u.has(y))try{I[y]=g[y]}catch{}return I}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},it.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},it.prototype.add=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Nr(h)(n)),this._trans("readwrite",function(y){return l.core.mutate({trans:y,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(y){return y.numFailures?Te.reject(y.failures[0]):y.lastResult}).then(function(y){if(h)try{Y(n,h,y)}catch{}return y})},it.prototype.upsert=function(n,s){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var g=h??{};return el(g,s),u&&Y(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(y){return y.numFailures?Te.reject(y.failures[0]):!!h})})})},it.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=te(n,this.schema.primKey.keyPath))===void 0?we(new Ee.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},it.prototype.put=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Nr(h)(n)),this._trans("readwrite",function(y){return l.core.mutate({trans:y,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(y){return y.numFailures?Te.reject(y.failures[0]):y.lastResult}).then(function(y){if(h)try{Y(n,h,y)}catch{}return y})},it.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ks(s,[n],u)}).then(function(u){return u.numFailures?Te.reject(u.failures[0]):void 0})})},it.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Na}).then(function(l){return ks(n,null,l)})}).then(function(s){return s.numFailures?Te.reject(s.failures[0]):void 0})},it.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return s.hook.reading.fire(f)})})})},it.prototype.bulkAdd=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var y=u.schema.primKey,j=y.auto,y=y.keyPath;if(y&&f)throw new Ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new Ee.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,j=y&&j?n.map(Nr(y)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:j,wantResults:h}).then(function(R){var T=R.numFailures,O=R.failures;if(T===0)return h?R.results:R.lastResult;throw new _e("".concat(u.name,".bulkAdd(): ").concat(T," of ").concat(I," operations failed"),O)})})},it.prototype.bulkPut=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,h=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var y=u.schema.primKey,j=y.auto,y=y.keyPath;if(y&&f)throw new Ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new Ee.InvalidArgument("Arguments objects and keys must have the same length");var I=n.length,j=y&&j?n.map(Nr(y)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:j,wantResults:h}).then(function(R){var T=R.numFailures,O=R.failures;if(T===0)return h?R.results:R.lastResult;throw new _e("".concat(u.name,".bulkPut(): ").concat(T," of ").concat(I," operations failed"),O)})})},it.prototype.bulkUpdate=function(n){var s=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),h=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(y){var I=[],j=[],R=(n.forEach(function(T,O){var D=T.key,P=T.changes,C=y[O];if(C){for(var B=0,z=Object.keys(P);B<z.length;B++){var N=z[B],Q=P[N];if(N===s.schema.primKey.keyPath){if(Ve(Q,D)!==0)throw new Ee.Constraint("Cannot update primary key in bulkUpdate()")}else Y(C,N,Q)}h.push(O),I.push(D),j.push(C)}}),I.length);return l.mutate({trans:g,type:"put",keys:I,values:j,updates:{keys:u,changeSpecs:f}}).then(function(T){var O=T.numFailures,D=T.failures;if(O===0)return R;for(var P=0,C=Object.keys(D);P<C.length;P++){var B,z=C[P],N=h[Number(z)];N!=null&&(B=D[z],delete D[z],D[N]=B)}throw new _e("".concat(s.name,".bulkUpdate(): ").concat(O," of ").concat(R," operations failed"),D)})})})},it.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ks(s,n,f)})}).then(function(u){var f=u.numFailures,h=u.failures;if(f===0)return u.lastResult;throw new _e("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var tl=it;function it(){}function qa(n){function s(g,y){if(y){for(var I=arguments.length,j=new Array(I-1);--I;)j[I-1]=arguments[I];return l[g].subscribe.apply(null,j),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=h;for(var u=1,f=arguments.length;u<f;++u)h(arguments[u]);return s;function h(g,y,I){var j,R;if(typeof g!="object")return y=y||oa,R={subscribers:[],fire:I=I||ze,subscribe:function(T){R.subscribers.indexOf(T)===-1&&(R.subscribers.push(T),R.fire=y(R.fire,T))},unsubscribe:function(T){R.subscribers=R.subscribers.filter(function(O){return O!==T}),R.fire=R.subscribers.reduce(y,I)}},l[g]=s[g]=R;c(j=g).forEach(function(T){var O=j[T];if(d(O))h(T,j[T][0],j[T][1]);else{if(O!=="asap")throw new Ee.InvalidArgument("Invalid event config");var D=h(T,rt,function(){for(var P=arguments.length,C=new Array(P);P--;)C[P]=arguments[P];D.subscribers.forEach(function(B){J(function(){B.apply(null,C)})})})}})}}function Ba(n,s){return L(s).from({prototype:n}),s}function fa(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function hi(n,s){n.filter=ut(n.filter,s)}function vi(n,s,l){var u=n.replayFilter;n.replayFilter=u?function(){return ut(u(),s())}:s,n.justLimit=l&&!u}function xs(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new Ee.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function nl(n,s,l){var u=xs(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function Ss(n,s,l,u){var f,h,g=n.replayFilter?ut(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(y,I,j){var R,T;g&&!g(I,j,function(O){return I.stop(O)},function(O){return I.fail(O)})||((T=""+(R=I.primaryKey))=="[object ArrayBuffer]"&&(T=""+new Uint8Array(R)),x(f,T))||(f[T]=!0,s(y,I,j))},Promise.all([n.or._iterate(h,l),rl(nl(n,u,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):rl(nl(n,u,l),ut(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function rl(n,s,l,u){var f=at(u?function(h,g,y){return l(u(h),g,y)}:l);return n.then(function(h){if(h)return h.start(function(){var g=function(){return h.continue()};s&&!s(h,function(y){return g=y},function(y){h.stop(y),g=ze},function(y){h.fail(y),g=ze})||f(h.value,h,function(y){return g=y}),g()})})}Je.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,we.bind(null,l.error)):l.table._trans("readonly",n).then(s)},Je.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,we.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},Je.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=ut(s.algorithm,n)},Je.prototype._iterate=function(n,s){return Ss(this._ctx,n,s,this._ctx.table.core)},Je.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},Je.prototype.raw=function(){return this._ctx.valueMapper=null,this},Je.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Ss(s,n,l,s.table.core)})},Je.prototype.count=function(n){var s=this;return this._read(function(l){var u,f=s._ctx,h=f.table.core;return fa(f,!0)?h.count({trans:l,query:{index:xs(f,h.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,Ss(f,function(){return++u,!1},l,h).then(function(){return u}))}).then(n)},Je.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function h(I,j){return j?h(I[l[j]],j-1):I[u]}var g=this._ctx.dir==="next"?1:-1;function y(I,j){return Ve(h(I,f),h(j,f))*g}return this.toArray(function(I){return I.sort(y)}).then(s)},Je.prototype.toArray=function(n){var s=this;return this._read(function(l){var u,f,h,g=s._ctx;return g.dir==="next"&&fa(g,!0)&&0<g.limit?(u=g.valueMapper,f=xs(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(y){return y=y.result,u?y.map(u):y})):(h=[],Ss(g,function(y){return h.push(y)},l,g.table.core).then(function(){return h}))},n)},Je.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,fa(s)?vi(s,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):vi(s,function(){var l=n;return function(){return--l<0}})),this},Je.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),vi(this._ctx,function(){var s=n;return function(l,u,f){return--s<=0&&u(f),0<=s}},!0),this},Je.prototype.until=function(n,s){return hi(this._ctx,function(l,u,f){return!n(l.value)||(u(f),s)}),this},Je.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},Je.prototype.last=function(n){return this.reverse().first(n)},Je.prototype.filter=function(n){var s;return hi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=ut(s.isMatch,n),this},Je.prototype.and=function(n){return this.filter(n)},Je.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Je.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Je.prototype.desc=function(){return this.reverse()},Je.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.key,u)})},Je.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Je.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},Je.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},Je.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&fa(s,!0)&&0<s.limit)return this._read(function(u){var f=xs(s,s.table.core.schema);return s.table.core.query({trans:u,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(u){return u.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},Je.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Je.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},Je.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Je.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},hi(this._ctx,function(u){var u=u.primaryKey.toString(),f=x(n,u);return n[u]=!0,!f})),this},Je.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(u){function f(C,B){var z=B.failures;O+=C-B.numFailures;for(var N=0,Q=c(z);N<Q.length;N++){var ce=Q[N];T.push(z[ce])}}var h=typeof n=="function"?n:function(C){return el(C,n)},g=l.table.core,R=g.schema.primaryKey,y=R.outbound,I=R.extractKey,j=200,R=s.db._options.modifyChunkSize,T=(R&&(j=typeof R=="object"?R[g.name]||R["*"]||200:R),[]),O=0,D=[],P=n===al;return s.clone().primaryKeys().then(function(C){function B(N){var Q=Math.min(j,C.length-N),ce=C.slice(N,N+Q);return(P?Promise.resolve([]):g.getMany({trans:u,keys:ce,cache:"immutable"})).then(function(ke){var xe=[],fe=[],Ie=y?[]:null,Ae=P?ce:[];if(!P)for(var me=0;me<Q;++me){var De=ke[me],Xe={value:ue(De),primKey:C[N+me]};h.call(Xe,Xe.value,Xe)!==!1&&(Xe.value==null?Ae.push(C[N+me]):y||Ve(I(De),I(Xe.value))===0?(fe.push(Xe.value),y&&Ie.push(C[N+me])):(Ae.push(C[N+me]),xe.push(Xe.value)))}return Promise.resolve(0<xe.length&&g.mutate({trans:u,type:"add",values:xe}).then(function($e){for(var qe in $e.failures)Ae.splice(parseInt(qe),1);f(xe.length,$e)})).then(function(){return(0<fe.length||z&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Ie,values:fe,criteria:z,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<N}).then(function($e){return f(fe.length,$e)})}).then(function(){return(0<Ae.length||z&&P)&&g.mutate({trans:u,type:"delete",keys:Ae,criteria:z,isAdditionalChunk:0<N}).then(function($e){return ks(l.table,Ae,$e)}).then(function($e){return f(Ae.length,$e)})}).then(function(){return C.length>N+Q&&B(N+j)})})}var z=fa(l)&&l.limit===1/0&&(typeof n!="function"||P)&&{index:l.index,range:l.range};return B(0).then(function(){if(0<T.length)throw new Ne("Error modifying one or more objects",T,O,D);return C.length})})})},Je.prototype.delete=function(){var n=this._ctx,s=n.range;return!fa(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(al):this._write(function(l){var u=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(I){var y=I.failures,I=I.numFailures;if(I)throw new Ne("Could not delete some values",Object.keys(y).map(function(j){return y[j]}),h-I);return h-I})})})};var Xc=Je;function Je(){}var al=function(n,s){return s.value=null};function Qc(n,s){return n<s?-1:n===s?0:1}function Zc(n,s){return s<n?-1:n===s?0:1}function $t(n,s,l){return n=n instanceof il?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function da(n){return new n.Collection(n,function(){return sl("")}).limit(0)}function Ts(D,s,l,u){var f,h,g,y,I,j,R,T=l.length;if(!l.every(function(C){return typeof C=="string"}))return $t(D,pt);function O(C){f=C==="next"?function(z){return z.toUpperCase()}:function(z){return z.toLowerCase()},h=C==="next"?function(z){return z.toLowerCase()}:function(z){return z.toUpperCase()},g=C==="next"?Qc:Zc;var B=l.map(function(z){return{lower:h(z),upper:f(z)}}).sort(function(z,N){return g(z.lower,N.lower)});y=B.map(function(z){return z.upper}),I=B.map(function(z){return z.lower}),R=(j=C)==="next"?"":u}O("next");var D=new D.Collection(D,function(){return hr(y[0],I[T-1]+u)}),P=(D._ondirectionchange=function(C){O(C)},0);return D._addAlgorithm(function(C,B,z){var N=C.key;if(typeof N=="string"){var Q=h(N);if(s(Q,I,P))return!0;for(var ce=null,ke=P;ke<T;++ke){var xe=((fe,Ie,Ae,me,De,Xe)=>{for(var $e=Math.min(fe.length,me.length),qe=-1,Fe=0;Fe<$e;++Fe){var ht=Ie[Fe];if(ht!==me[Fe])return De(fe[Fe],Ae[Fe])<0?fe.substr(0,Fe)+Ae[Fe]+Ae.substr(Fe+1):De(fe[Fe],me[Fe])<0?fe.substr(0,Fe)+me[Fe]+Ae.substr(Fe+1):0<=qe?fe.substr(0,qe)+Ie[qe]+Ae.substr(qe+1):null;De(fe[Fe],ht)<0&&(qe=Fe)}return $e<me.length&&Xe==="next"?fe+Ae.substr(fe.length):$e<fe.length&&Xe==="prev"?fe.substr(0,Ae.length):qe<0?null:fe.substr(0,qe)+me[qe]+Ae.substr(qe+1)})(N,Q,y[ke],I[ke],g,j);xe===null&&ce===null?P=ke+1:(ce===null||0<g(ce,xe))&&(ce=xe)}B(ce!==null?function(){C.continue(ce+R)}:z)}return!1}),D}function hr(n,s,l,u){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:u}}function sl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(St.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),St.prototype.between=function(n,s,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||u)&&(!l||!u)?da(this):new this.Collection(this,function(){return hr(n,s,!l,!u)})}catch{return $t(this,st)}},St.prototype.equals=function(n){return n==null?$t(this,st):new this.Collection(this,function(){return sl(n)})},St.prototype.above=function(n){return n==null?$t(this,st):new this.Collection(this,function(){return hr(n,void 0,!0)})},St.prototype.aboveOrEqual=function(n){return n==null?$t(this,st):new this.Collection(this,function(){return hr(n,void 0,!1)})},St.prototype.below=function(n){return n==null?$t(this,st):new this.Collection(this,function(){return hr(void 0,n,!1,!0)})},St.prototype.belowOrEqual=function(n){return n==null?$t(this,st):new this.Collection(this,function(){return hr(void 0,n)})},St.prototype.startsWith=function(n){return typeof n!="string"?$t(this,pt):this.between(n,n+Ze,!0,!0)},St.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ts(this,function(s,l){return s.indexOf(l[0])===0},[n],Ze)},St.prototype.equalsIgnoreCase=function(n){return Ts(this,function(s,l){return s===l[0]},[n],"")},St.prototype.anyOfIgnoreCase=function(){var n=de.apply(ne,arguments);return n.length===0?da(this):Ts(this,function(s,l){return l.indexOf(s)!==-1},n,"")},St.prototype.startsWithAnyOfIgnoreCase=function(){var n=de.apply(ne,arguments);return n.length===0?da(this):Ts(this,function(s,l){return l.some(function(u){return s.indexOf(u)===0})},n,Ze)},St.prototype.anyOf=function(){var n,s,l=this,u=de.apply(ne,arguments),f=this._cmp;try{u.sort(f)}catch{return $t(this,st)}return u.length===0?da(this):((n=new this.Collection(this,function(){return hr(u[0],u[u.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,u.sort(f)},s=0,n._addAlgorithm(function(h,g,y){for(var I=h.key;0<f(I,u[s]);)if(++s===u.length)return g(y),!1;return f(I,u[s])===0||(g(function(){h.continue(u[s])}),!1)}),n)},St.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},St.prototype.noneOf=function(){var n=de.apply(ne,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return $t(this,st)}var s=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},St.prototype.inAnyRange=function(n,z){var l=this,u=this._cmp,f=this._ascending,h=this._descending,g=this._min,y=this._max;if(n.length===0)return da(this);if(!n.every(function(N){return N[0]!==void 0&&N[1]!==void 0&&f(N[0],N[1])<=0}))return $t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ee.InvalidArgument);var I=!z||z.includeLowers!==!1,j=z&&z.includeUppers===!0,R,T=f;function O(N,Q){return T(N[0],Q[0])}try{(R=n.reduce(function(N,Q){for(var ce=0,ke=N.length;ce<ke;++ce){var xe=N[ce];if(u(Q[0],xe[1])<0&&0<u(Q[1],xe[0])){xe[0]=g(xe[0],Q[0]),xe[1]=y(xe[1],Q[1]);break}}return ce===ke&&N.push(Q),N},[])).sort(O)}catch{return $t(this,st)}var D=0,P=j?function(N){return 0<f(N,R[D][1])}:function(N){return 0<=f(N,R[D][1])},C=I?function(N){return 0<h(N,R[D][0])}:function(N){return 0<=h(N,R[D][0])},B=P,z=new this.Collection(this,function(){return hr(R[0][0],R[R.length-1][1],!I,!j)});return z._ondirectionchange=function(N){T=N==="next"?(B=P,f):(B=C,h),R.sort(O)},z._addAlgorithm(function(N,Q,ce){for(var ke,xe=N.key;B(xe);)if(++D===R.length)return Q(ce),!1;return!P(ke=xe)&&!C(ke)||(l._cmp(xe,R[D][1])===0||l._cmp(xe,R[D][0])===0||Q(function(){T===f?N.continue(R[D][0]):N.continue(R[D][1])}),!1)}),z},St.prototype.startsWithAnyOf=function(){var n=de.apply(ne,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?da(this):this.inAnyRange(n.map(function(s){return[s,s+Ze]})):$t(this,"startsWithAnyOf() only works with strings")};var il=St;function St(){}function Ln(n){return at(function(s){return za(s),n(s.target.error),!1})}function za(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Fa="storagemutated",gi="x-storagemutated-1",vr=qa(null,Fa),Jc=(Nn.prototype._lock=function(){return G(!Me.global),++this._reculock,this._reculock!==1||Me.global||(Me.lockOwnerFor=this),this},Nn.prototype._unlock=function(){if(G(!Me.global),--this._reculock==0)for(Me.global||(Me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Le(n[1],n[0])}catch{}}return this},Nn.prototype._locked=function(){return this._reculock&&Me.lockOwnerFor!==this},Nn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(G(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new Ee.DatabaseClosed(u);case"MissingAPIError":throw new Ee.MissingAPI(u.message,u);default:throw new Ee.OpenFailed(u)}if(!this.active)throw new Ee.TransactionInactive;G(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=at(function(f){za(f),s._reject(n.error)}),n.onabort=at(function(f){za(f),s.active&&s._reject(new Ee.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=at(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&vr.storagemutated.fire(n.mutatedParts)})}return this},Nn.prototype._promise=function(n,s,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?we(new Ee.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Te(function(h,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(h,g)},Me])}):l?wn(function(){var h=new Te(function(g,y){f._lock();var I=s(g,y,f);I&&I.then&&I.then(g,y)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((u=new Te(function(h,g){var y=s(h,g,f);y&&y.then&&y.then(h,g)}))._lib=!0,u):we(new Ee.TransactionInactive)},Nn.prototype._root=function(){return this.parent?this.parent._root():this},Nn.prototype.waitFor=function(n){var s,l=this._root(),u=Te.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=h)})()),l._waitingFor);return new Te(function(h,g){u.then(function(y){return l._waitingQueue.push(at(h.bind(null,y)))},function(y){return l._waitingQueue.push(at(g.bind(null,y)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Nn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ee.Abort))},Nn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(x(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new Ee.NotFound("Table "+n+" not part of transaction")},Nn);function Nn(){}function mi(n,s,l,u,f,h,g,y){return{name:n,keyPath:s,unique:l,multi:u,auto:f,compound:h,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+ol(s),type:y}}function ol(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function yi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,h,g){return h=u(h,g),h&&(f[h[0]]=h[1]),f},{}))};var u}var Ka=function(n){try{return n.only([[]]),Ka=function(){return[[]]},[[]]}catch{return Ka=function(){return Ze},Ze}};function bi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return te(l,s)}:function(l){return te(l,n)};var s}function ll(n){return[].slice.call(n)}var $c=0;function Ua(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function ef(n,s,I){function u(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=P.lower,O=P.upper,D=P.lowerOpen,P=P.upperOpen;return T===void 0?O===void 0?null:s.upperBound(O,!!P):O===void 0?s.lowerBound(T,!!D):s.bound(T,O,!!D,!!P)}function f(R){var T,O=R.name;return{name:O,schema:R,mutate:function(D){var P=D.trans,C=D.type,B=D.keys,z=D.values,N=D.range;return new Promise(function(Q,ce){Q=at(Q);var ke=P.objectStore(O),xe=ke.keyPath==null,fe=C==="put"||C==="add";if(!fe&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var Ie,Ae=(B||z||{length:1}).length;if(B&&z&&B.length!==z.length)throw new Error("Given keys array must have same length as given values array.");if(Ae===0)return Q({numFailures:0,failures:{},results:[],lastResult:void 0});function me(vt){++$e,za(vt)}var De=[],Xe=[],$e=0;if(C==="deleteRange"){if(N.type===4)return Q({numFailures:$e,failures:Xe,results:[],lastResult:void 0});N.type===3?De.push(Ie=ke.clear()):De.push(Ie=ke.delete(u(N)))}else{var xe=fe?xe?[z,B]:[z,null]:[B,null],qe=xe[0],Fe=xe[1];if(fe)for(var ht=0;ht<Ae;++ht)De.push(Ie=Fe&&Fe[ht]!==void 0?ke[C](qe[ht],Fe[ht]):ke[C](qe[ht])),Ie.onerror=me;else for(ht=0;ht<Ae;++ht)De.push(Ie=ke[C](qe[ht])),Ie.onerror=me}function cn(vt){vt=vt.target.result,De.forEach(function(Br,ji){return Br.error!=null&&(Xe[ji]=Br.error)}),Q({numFailures:$e,failures:Xe,results:C==="delete"?B:De.map(function(Br){return Br.result}),lastResult:vt})}Ie.onerror=function(vt){me(vt),cn(vt)},Ie.onsuccess=cn})},getMany:function(D){var P=D.trans,C=D.keys;return new Promise(function(B,z){B=at(B);for(var N,Q=P.objectStore(O),ce=C.length,ke=new Array(ce),xe=0,fe=0,Ie=function(De){De=De.target,ke[De._pos]=De.result,++fe===xe&&B(ke)},Ae=Ln(z),me=0;me<ce;++me)C[me]!=null&&((N=Q.get(C[me]))._pos=me,N.onsuccess=Ie,N.onerror=Ae,++xe);xe===0&&B(ke)})},get:function(D){var P=D.trans,C=D.key;return new Promise(function(B,z){B=at(B);var N=P.objectStore(O).get(C);N.onsuccess=function(Q){return B(Q.target.result)},N.onerror=Ln(z)})},query:(T=y,function(D){return new Promise(function(P,C){P=at(P);var B,z,N,fe=D.trans,Q=D.values,ce=D.limit,xe=D.query,ke=ce===1/0?void 0:ce,Ie=xe.index,xe=xe.range,fe=fe.objectStore(O),fe=Ie.isPrimaryKey?fe:fe.index(Ie.name),Ie=u(xe);if(ce===0)return P({result:[]});T?((xe=Q?fe.getAll(Ie,ke):fe.getAllKeys(Ie,ke)).onsuccess=function(Ae){return P({result:Ae.target.result})},xe.onerror=Ln(C)):(B=0,z=!Q&&"openKeyCursor"in fe?fe.openKeyCursor(Ie):fe.openCursor(Ie),N=[],z.onsuccess=function(Ae){var me=z.result;return!me||(N.push(Q?me.value:me.primaryKey),++B===ce)?P({result:N}):void me.continue()},z.onerror=Ln(C))})}),openCursor:function(D){var P=D.trans,C=D.values,B=D.query,z=D.reverse,N=D.unique;return new Promise(function(Q,ce){Q=at(Q);var fe=B.index,ke=B.range,xe=P.objectStore(O),xe=fe.isPrimaryKey?xe:xe.index(fe.name),fe=z?N?"prevunique":"prev":N?"nextunique":"next",Ie=!C&&"openKeyCursor"in xe?xe.openKeyCursor(u(ke),fe):xe.openCursor(u(ke),fe);Ie.onerror=Ln(ce),Ie.onsuccess=at(function(Ae){var me,De,Xe,$e,qe=Ie.result;qe?(qe.___id=++$c,qe.done=!1,me=qe.continue.bind(qe),De=(De=qe.continuePrimaryKey)&&De.bind(qe),Xe=qe.advance.bind(qe),$e=function(){throw new Error("Cursor not stopped")},qe.trans=P,qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=function(){throw new Error("Cursor not started")},qe.fail=at(ce),qe.next=function(){var Fe=this,ht=1;return this.start(function(){return ht--?Fe.continue():Fe.stop()}).then(function(){return Fe})},qe.start=function(Fe){function ht(){if(Ie.result)try{Fe()}catch(vt){qe.fail(vt)}else qe.done=!0,qe.start=function(){throw new Error("Cursor behind last entry")},qe.stop()}var cn=new Promise(function(vt,Br){vt=at(vt),Ie.onerror=Ln(Br),qe.fail=Br,qe.stop=function(ji){qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=$e,vt(ji)}});return Ie.onsuccess=at(function(vt){Ie.onsuccess=ht,ht()}),qe.continue=me,qe.continuePrimaryKey=De,qe.advance=Xe,ht(),cn},Q(qe)):Q(null)},ce)})},count:function(D){var P=D.query,C=D.trans,B=P.index,z=P.range;return new Promise(function(N,Q){var ce=C.objectStore(O),ce=B.isPrimaryKey?ce:ce.index(B.name),ke=u(z),ke=ke?ce.count(ke):ce.count();ke.onsuccess=at(function(xe){return N(xe.target.result)}),ke.onerror=Ln(Q)})}}}h=I,g=ll((I=n).objectStoreNames);var h,I={schema:{name:I.name,tables:g.map(function(R){return h.objectStore(R)}).map(function(R){var T=R.keyPath,O=R.autoIncrement,P=d(T),D={},P={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T==null,compound:P,keyPath:T,autoIncrement:O,unique:!0,extractKey:bi(T)},indexes:ll(R.indexNames).map(function(C){return R.index(C)}).map(function(N){var Q=N.name,B=N.unique,z=N.multiEntry,N=N.keyPath,Q={name:Q,compound:d(N),keyPath:N,unique:B,multiEntry:z,extractKey:bi(N)};return D[Ua(N)]=Q}),getIndexByKeyPath:function(C){return D[Ua(C)]}};return D[":id"]=P.primaryKey,T!=null&&(D[Ua(T)]=P.primaryKey),P})},hasGetAll:0<g.length&&"getAll"in h.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=I.schema,y=I.hasGetAll,I=g.tables.map(f),j={};return I.forEach(function(R){return j[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(j[R])return j[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ka(s),schema:g}}function tf(n,s,l,u){return l=l.IDBKeyRange,s=ef(s,l,u),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,a(a({},f),h(f))},s)}}function Es(n,s){var l=s.db,l=tf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(h){return h.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function As(n,s,l,u){l.forEach(function(f){var h=u[f];s.forEach(function(g){var y=(function I(j,R){return S(j,R)||(j=p(j))&&I(j,R)})(g,f);(!y||"value"in y&&y.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?M(g,f,{get:function(){return this.table(f)},set:function(I){k(this,f,{value:I,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,h))})})}function _i(n,s){s.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function nf(n,s){return n._cfg.version-s._cfg.version}function rf(n,s,l,u){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=yi("$meta",cl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(h.create(l),h._completion.catch(u),h._reject.bind(h)),y=Me.transless||Me;wn(function(){if(Me.trans=h,Me.transless=y,s!==0)return Es(n,l),j=s,((I=h).storeNames.includes("$meta")?I.table("$meta").get("version").then(function(R){return R??j}):Te.resolve(j)).then(function(B){var T=n,O=B,D=h,P=l,C=[],B=T._versions,z=T._dbSchema=Is(0,T.idbdb,P);return(B=B.filter(function(N){return N._cfg.version>=O})).length===0?Te.resolve():(B.forEach(function(N){C.push(function(){var Q,ce,ke,xe=z,fe=N._cfg.dbschema,Ie=(Rs(T,xe,P),Rs(T,fe,P),z=T._dbSchema=fe,wi(xe,fe)),Ae=(Ie.add.forEach(function(me){ki(P,me[0],me[1].primKey,me[1].indexes)}),Ie.change.forEach(function(me){if(me.recreate)throw new Ee.Upgrade("Not yet support for changing primary key");var De=P.objectStore(me.name);me.add.forEach(function(Xe){return Cs(De,Xe)}),me.change.forEach(function(Xe){De.deleteIndex(Xe.name),Cs(De,Xe)}),me.del.forEach(function(Xe){return De.deleteIndex(Xe)})}),N._cfg.contentUpgrade);if(Ae&&N._cfg.version>O)return Es(T,P),D._memoizedTables={},Q=ve(fe),Ie.del.forEach(function(me){Q[me]=xe[me]}),_i(T,[T.Transaction.prototype]),As(T,[T.Transaction.prototype],c(Q),Q),D.schema=Q,(ce=ye(Ae))&&Nt(),fe=Te.follow(function(){var me;(ke=Ae(D))&&ce&&(me=kn.bind(null,null),ke.then(me,me))}),ke&&typeof ke.then=="function"?Te.resolve(ke):fe.then(function(){return ke})}),C.push(function(Q){var ce,ke,xe=N._cfg.dbschema;ce=xe,ke=Q,[].slice.call(ke.db.objectStoreNames).forEach(function(fe){return ce[fe]==null&&ke.db.deleteObjectStore(fe)}),_i(T,[T.Transaction.prototype]),As(T,[T.Transaction.prototype],T._storeNames,T._dbSchema),D.schema=T._dbSchema}),C.push(function(Q){T.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(T.idbdb.version/10)===N._cfg.version?(T.idbdb.deleteObjectStore("$meta"),delete T._dbSchema.$meta,T._storeNames=T._storeNames.filter(function(ce){return ce!=="$meta"})):Q.objectStore("$meta").put(N._cfg.version,"version"))})}),(function N(){return C.length?Te.resolve(C.shift()(D.idbtrans)).then(N):Te.resolve()})().then(function(){ul(z,P)}))}).catch(g);var I,j;c(f).forEach(function(R){ki(l,R,f[R].primKey,f[R].indexes)}),Es(n,l),Te.follow(function(){return n.on.populate.fire(h)}).catch(g)})}function af(n,s){ul(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Is(0,n.idbdb,s);Rs(n,n._dbSchema,s);for(var u=0,f=wi(l,n._dbSchema).change;u<f.length;u++){var h=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=s.objectStore(g.name);g.add.forEach(function(I){Jt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(I.src)),Cs(y,I)})})(f[u]);if(typeof h=="object")return h.value}}function wi(n,s){var l,u={del:[],add:[],change:[]};for(l in n)s[l]||u.del.push(l);for(l in s){var f=n[l],h=s[l];if(f){var g={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)g.recreate=!0,u.change.push(g);else{var y=f.idxByName,I=h.idxByName,j=void 0;for(j in y)I[j]||g.del.push(j);for(j in I){var R=y[j],T=I[j];R?R.src!==T.src&&g.change.push(T):g.add.push(T)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,h])}return u}function ki(n,s,l,u){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(h){return Cs(f,h)})}function ul(n,s){c(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(Jt&&console.debug("Dexie: Creating missing table",l),ki(s,l,n[l].primKey,n[l].indexes))})}function Cs(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Is(n,s,l){var u={};return ie(s.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),g=mi(ol(j=h.keyPath),j||"",!0,!1,!!h.autoIncrement,j&&typeof j!="string",!0),y=[],I=0;I<h.indexNames.length;++I){var R=h.index(h.indexNames[I]),j=R.keyPath,R=mi(R.name,j,!!R.unique,!!R.multiEntry,!1,j&&typeof j!="string",!1);y.push(R)}u[f]=yi(f,g,y)}),u}function Rs(n,s,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var h=u[f],g=l.objectStore(h);n._hasGetAll="getAll"in g;for(var y=0;y<g.indexNames.length;++y){var I,j=g.indexNames[y],R=g.index(j).keyPath,R=typeof R=="string"?R:"["+ie(R).join("+")+"]";s[h]&&(I=s[h].idxByName[R])&&(I.name=j,delete s[h].idxByName[R],s[h].idxByName[j]=I)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function cl(n){return n.split(",").map(function(s,l){var f=s.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return mi(f,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(h),l===0,u)})}pa.prototype._createTableSchema=yi,pa.prototype._parseIndexSyntax=cl,pa.prototype._parseStoresSpec=function(n,s){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),h=f.shift();if(!h)throw new Ee.Schema("Invalid schema for table "+u+": "+n[u]);if(h.unique=!0,h.multi)throw new Ee.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new Ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new Ee.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(u,h,f),s[u]=h}})},pa.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),u={},f={};return l.forEach(function(h){v(u,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(u,f)}),s._dbSchema=f,_i(s,[s._allTables,s,s.Transaction.prototype]),As(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],c(f),f),s._storeNames=c(f),this},pa.prototype.upgrade=function(n){return this._cfg.contentUpgrade=or(this._cfg.contentUpgrade||ze,n),this};var sf=pa;function pa(){}function xi(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new Xn(Ht,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Si(n){return n&&typeof n.databases=="function"}function Ti(n){return wn(function(){return Me.letThrough=!0,n()})}function Ei(n){return!("from"in n)}var jt=function(n,s){var l;if(!this)return l=new jt,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ga(n,s,l){var u=Ve(s,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Ei(n))return v(n,{from:s,to:l,d:1});var u=n.l,f=n.r;if(Ve(l,n.from)<0)return u?Ga(u,s,l):n.l={from:s,to:l,d:1,l:null,r:null},dl(n);if(0<Ve(s,n.to))return f?Ga(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},dl(n);Ve(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Ve(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,u&&!n.l&&Ha(n,u),f&&s&&Ha(n,f)}}function Ha(n,s){Ei(s)||(function l(u,f){var h=f.from,g=f.l,y=f.r;Ga(u,h,f.to),g&&l(u,g),y&&l(u,y)})(n,s)}function fl(n,s){var l=Ps(s),u=l.next();if(!u.done)for(var f=u.value,h=Ps(n),g=h.next(f.from),y=g.value;!u.done&&!g.done;){if(Ve(y.from,f.to)<=0&&0<=Ve(y.to,f.from))return!0;Ve(f.from,y.from)<0?f=(u=l.next(y.from)).value:y=(g=h.next(f.from)).value}return!1}function Ps(n){var s=Ei(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,u)for(;s.n.l&&Ve(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!u||Ve(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function dl(n){var s,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[s],(n[s]=l).d=pl(l)),n.d=pl(n)}function pl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Os(n,s){return c(s).forEach(function(l){n[l]?Ha(n[l],s[l]):n[l]=(function u(f){var h,g,y={};for(h in f)x(f,h)&&(g=f[h],y[h]=!g||typeof g!="object"||he.has(g.constructor)?g:u(g));return y})(s[l])}),n}function Ai(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&fl(s[l],n[l])})}_(jt.prototype,((_t={add:function(n){return Ha(this,n),this},addKey:function(n){return Ga(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ga(s,l,l)}),this},hasKey:function(n){var s=Ps(this).next(n).value;return s&&Ve(s.from,n)<=0&&0<=Ve(s.to,n)}})[ae]=function(){return Ps(this)},_t));var jr={},Ci={},Ii=!1;function Ds(n){Os(Ci,n),Ii||(Ii=!0,setTimeout(function(){Ii=!1,Ri(Ci,!(Ci={}))},0))}function Ri(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(jr);u<f.length;u++)hl(y=f[u],n,l,s);else for(var h in n){var g,y,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(g=h[1],h=h[2],y=jr["idb://".concat(g,"/").concat(h)])&&hl(y,n,l,s)}l.forEach(function(I){return I()})}function hl(n,s,l,u){for(var f=[],h=0,g=Object.entries(n.queries.query);h<g.length;h++){for(var y=g[h],I=y[0],j=[],R=0,T=y[1];R<T.length;R++){var O=T[R];Ai(s,O.obsSet)?O.subscribers.forEach(function(B){return l.add(B)}):u&&j.push(O)}u&&f.push([I,j])}if(u)for(var D=0,P=f;D<P.length;D++){var C=P[D],I=C[0],j=C[1];n.queries.query[I]=j}}function of(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?we(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var u=s.openCanceller,f=Math.round(10*n.verno),h=!1;function g(){if(s.openCanceller!==u)throw new Ee.DatabaseClosed("db.open() was cancelled")}function y(){return new Te(function(O,D){if(g(),!l)throw new Ee.MissingAPI;var P=n.name,C=s.autoSchema||!f?l.open(P):l.open(P,f);if(!C)throw new Ee.MissingAPI;C.onerror=Ln(D),C.onblocked=at(n._fireOnBlocked),C.onupgradeneeded=at(function(B){var z;R=C.transaction,s.autoSchema&&!n._options.allowEmptyDB?(C.onerror=za,R.abort(),C.result.close(),(z=l.deleteDatabase(P)).onsuccess=z.onerror=at(function(){D(new Ee.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(R.onerror=Ln(D),z=B.oldVersion>Math.pow(2,62)?0:B.oldVersion,T=z<1,n.idbdb=C.result,h&&af(n,R),rf(n,z/10,R,D))},D),C.onsuccess=at(function(){R=null;var B,z,N,Q,ce,ke,xe=n.idbdb=C.result,fe=ie(xe.objectStoreNames);if(0<fe.length)try{var Ie=xe.transaction((ce=fe).length===1?ce[0]:ce,"readonly");if(s.autoSchema)ke=xe,Q=Ie,(N=n).verno=ke.version/10,Q=N._dbSchema=Is(0,ke,Q),N._storeNames=ie(ke.objectStoreNames,0),As(N,[N._allTables],c(Q),Q);else if(Rs(n,n._dbSchema,Ie),z=Ie,((z=wi(Is(0,(B=n).idbdb,z),B._dbSchema)).add.length||z.change.some(function(Ae){return Ae.add.length||Ae.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),xe.close(),f=xe.version+1,h=!0,O(y());Es(n,Ie)}catch{}mt.push(n),xe.onversionchange=at(function(Ae){s.vcFired=!0,n.on("versionchange").fire(Ae)}),xe.onclose=at(function(){n.close({disableAutoOpen:!1})}),T&&(fe=n._deps,ce=P,Si(ke=fe.indexedDB)||ce===Ht||xi(ke,fe.IDBKeyRange).put({name:ce}).catch(ze)),O()},D)}).catch(function(O){switch(O==null?void 0:O.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(0<f)return f=0,y()}return Te.reject(O)})}var I,j=s.dbReadyResolve,R=null,T=!1;return Te.race([u,(typeof navigator>"u"?Te.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function D(){return indexedDB.databases().finally(O)}I=setInterval(D,100),D()}).finally(function(){return clearInterval(I)}):Promise.resolve()).then(y)]).then(function(){return g(),s.onReadyBeingFired=[],Te.resolve(Ti(function(){return n.on.ready.fire(n.vip)})).then(function O(){var D;if(0<s.onReadyBeingFired.length)return D=s.onReadyBeingFired.reduce(or,ze),s.onReadyBeingFired=[],Te.resolve(Ti(function(){return D(n.vip)})).then(O)})}).finally(function(){s.openCanceller===u&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(O){s.dbOpenError=O;try{R&&R.abort()}catch{}return u===s.openCanceller&&n._close(),we(O)}).finally(function(){s.openComplete=!0,j()}).then(function(){var O;return T&&(O={},n.tables.forEach(function(D){D.schema.indexes.forEach(function(P){P.name&&(O["idb://".concat(n.name,"/").concat(D.name,"/").concat(P.name)]=new jt(-1/0,[[[]]]))}),O["idb://".concat(n.name,"/").concat(D.name,"/")]=O["idb://".concat(n.name,"/").concat(D.name,"/:dels")]=new jt(-1/0,[[[]]])}),vr(Fa).fire(O),Ri(O,!0)),n})}function Pi(n){function s(h){return n.next(h)}var l=f(s),u=f(function(h){return n.throw(h)});function f(h){return function(y){var y=h(y),I=y.value;return y.done?I:I&&typeof I.then=="function"?I.then(l,u):d(I)?Promise.all(I).then(l,u):l(I)}}return f(s)()}function Ms(n,s,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(s);return u}var lf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},h=[];function g(O,D,P){var N=Ua(O),C=f[N]=f[N]||[],B=O==null?0:typeof O=="string"?1:O.length,z=0<D,N=a(a({},P),{name:z?"".concat(N,"(virtual-from:").concat(P.name,")"):P.name,lowLevelIndex:P,isVirtual:z,keyTail:D,keyLength:B,extractKey:bi(O),unique:!z&&P.unique});return C.push(N),N.isPrimaryKey||h.push(N),1<B&&g(B===2?O[0]:O.slice(0,B-1),D+1,P),C.sort(function(Q,ce){return Q.keyTail-ce.keyTail}),N}var y=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[y];for(var I=0,j=u.indexes;I<j.length;I++){var R=j[I];g(R.keyPath,0,R)}function T(O){var D,P=O.query.index;return P.isVirtual?a(a({},O),{query:{index:P.lowLevelIndex,range:(D=O.query.range,P=P.keyTail,{type:D.type===1?2:D.type,lower:Ms(D.lower,D.lowerOpen?n.MAX_KEY:n.MIN_KEY,P),lowerOpen:!0,upper:Ms(D.upper,D.upperOpen?n.MIN_KEY:n.MAX_KEY,P),upperOpen:!0})}}):O}return a(a({},l),{schema:a(a({},u),{primaryKey:y,indexes:h,getIndexByKeyPath:function(O){return(O=f[Ua(O)])&&O[0]}}),count:function(O){return l.count(T(O))},query:function(O){return l.query(T(O))},openCursor:function(O){var D=O.query.index,P=D.keyTail,C=D.keyLength;return D.isVirtual?l.openCursor(T(O)).then(function(z){return z&&B(z)}):l.openCursor(O);function B(z){return Object.create(z,{continue:{value:function(N){N!=null?z.continue(Ms(N,O.reverse?n.MAX_KEY:n.MIN_KEY,P)):O.unique?z.continue(z.key.slice(0,C).concat(O.reverse?n.MIN_KEY:n.MAX_KEY,P)):z.continue()}},continuePrimaryKey:{value:function(N,Q){z.continuePrimaryKey(Ms(N,n.MAX_KEY,P),Q)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var N=z.key;return C===1?N[0]:N.slice(0,C)}},value:{get:function(){return z.value}}})}}})}})}};function Oi(n,s,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var h,g,y;x(s,f)?(h=n[f],g=s[f],typeof h=="object"&&typeof g=="object"&&h&&g?(y=$(h))!==$(g)?l[u+f]=s[f]:y==="Object"?Oi(h,g,l,u+f+"."):h!==g&&(l[u+f]=s[f]):h!==g&&(l[u+f]=s[f])):l[u+f]=void 0}),c(s).forEach(function(f){x(n,f)||(l[u+f]=s[f])}),l}function Di(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var uf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),u=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var h=Me.trans,g=h.table(s).hook,y=g.deleting,I=g.creating,j=g.updating;switch(f.type){case"add":if(I.fire===ze)break;return h._promise("readwrite",function(){return R(f)},!0);case"put":if(I.fire===ze&&j.fire===ze)break;return h._promise("readwrite",function(){return R(f)},!0);case"delete":if(y.fire===ze)break;return h._promise("readwrite",function(){return R(f)},!0);case"deleteRange":if(y.fire===ze)break;return h._promise("readwrite",function(){return(function T(O,D,P){return l.query({trans:O,values:!1,query:{index:u,range:D},limit:P}).then(function(C){var B=C.result;return R({type:"delete",keys:B,trans:O}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):B.length<P?{failures:[],numFailures:0,lastResult:void 0}:T(O,a(a({},D),{lower:B[B.length-1],lowerOpen:!0}),P)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function R(T){var O,D,P,C=Me.trans,B=T.keys||Di(u,T);if(B)return(T=T.type==="add"||T.type==="put"?a(a({},T),{keys:B}):a({},T)).type!=="delete"&&(T.values=i([],T.values)),T.keys&&(T.keys=i([],T.keys)),O=l,P=B,((D=T).type==="add"?Promise.resolve([]):O.getMany({trans:D.trans,keys:P,cache:"immutable"})).then(function(z){var N=B.map(function(Q,ce){var ke,xe,fe,Ie=z[ce],Ae={onerror:null,onsuccess:null};return T.type==="delete"?y.fire.call(Ae,Q,Ie,C):T.type==="add"||Ie===void 0?(ke=I.fire.call(Ae,Q,T.values[ce],C),Q==null&&ke!=null&&(T.keys[ce]=Q=ke,u.outbound||Y(T.values[ce],u.keyPath,Q))):(ke=Oi(Ie,T.values[ce]),(xe=j.fire.call(Ae,ke,Q,Ie,C))&&(fe=T.values[ce],Object.keys(xe).forEach(function(me){x(fe,me)?fe[me]=xe[me]:Y(fe,me,xe[me])}))),Ae});return l.mutate(T).then(function(Q){for(var ce=Q.failures,ke=Q.results,xe=Q.numFailures,Q=Q.lastResult,fe=0;fe<B.length;++fe){var Ie=(ke||B)[fe],Ae=N[fe];Ie==null?Ae.onerror&&Ae.onerror(ce[fe]):Ae.onsuccess&&Ae.onsuccess(T.type==="put"&&z[fe]?T.values[fe]:Ie)}return{failures:ce,results:ke,numFailures:xe,lastResult:Q}}).catch(function(Q){return N.forEach(function(ce){return ce.onerror&&ce.onerror(Q)}),Promise.reject(Q)})});throw new Error("Keys missing")}}})}})}};function vl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var u=[],f=0,h=0;f<s.keys.length&&h<n.length;++f)Ve(s.keys[f],n[h])===0&&(u.push(l?ue(s.values[f]):s.values[f]),++h);return u.length===n.length?u:null}catch{return null}}var cf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(u){var f;return u.cache?(f=vl(u.keys,u.trans._cache,u.cache==="clone"))?Te.resolve(f):l.getMany(u).then(function(h){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ue(h):h},h}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function gl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function ml(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ff={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new jt(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,f,h){if(Me.subscr&&f!=="readonly")throw new Ee.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Me.querier));return n.transaction(u,f,h)},table:function(u){function f(B){var C,B=B.query;return[C=B.index,new jt((C=(B=B.range).lower)!=null?C:n.MIN_KEY,(C=B.upper)!=null?C:n.MAX_KEY)]}var h=n.table(u),g=h.schema,y=g.primaryKey,I=g.indexes,j=y.extractKey,R=y.outbound,T=y.autoIncrement&&I.filter(function(P){return P.compound&&P.keyPath.includes(y.keyPath)}),O=a(a({},h),{mutate:function(P){function C(De){return De="idb://".concat(s,"/").concat(u,"/").concat(De),ce[De]||(ce[De]=new jt)}var B,z,N,Q=P.trans,ce=P.mutatedParts||(P.mutatedParts={}),ke=C(""),xe=C(":dels"),fe=P.type,Ae=P.type==="deleteRange"?[P.range]:P.type==="delete"?[P.keys]:P.values.length<50?[Di(y,P).filter(function(De){return De}),P.values]:[],Ie=Ae[0],Ae=Ae[1],me=P.trans._cache;return d(Ie)?(ke.addKeys(Ie),(fe=fe==="delete"||Ie.length===Ae.length?vl(Ie,me):null)||xe.addKeys(Ie),(fe||Ae)&&(B=C,z=fe,N=Ae,g.indexes.forEach(function(De){var Xe=B(De.name||"");function $e(Fe){return Fe!=null?De.extractKey(Fe):null}function qe(Fe){De.multiEntry&&d(Fe)?Fe.forEach(function(ht){return Xe.addKey(ht)}):Xe.addKey(Fe)}(z||N).forEach(function(Fe,vt){var cn=z&&$e(z[vt]),vt=N&&$e(N[vt]);Ve(cn,vt)!==0&&(cn!=null&&qe(cn),vt!=null)&&qe(vt)})}))):Ie?(Ae={from:(me=Ie.lower)!=null?me:n.MIN_KEY,to:(fe=Ie.upper)!=null?fe:n.MAX_KEY},xe.add(Ae),ke.add(Ae)):(ke.add(l),xe.add(l),g.indexes.forEach(function(De){return C(De.name).add(l)})),h.mutate(P).then(function(De){return!Ie||P.type!=="add"&&P.type!=="put"||(ke.addKeys(De.results),T&&T.forEach(function(Xe){for(var $e=P.values.map(function(cn){return Xe.extractKey(cn)}),qe=Xe.keyPath.findIndex(function(cn){return cn===y.keyPath}),Fe=0,ht=De.results.length;Fe<ht;++Fe)$e[Fe][qe]=De.results[Fe];C(Xe.name).addKeys($e)})),Q.mutatedParts=Os(Q.mutatedParts||{},ce),De})}}),D={get:function(P){return[y,new jt(P.key)]},getMany:function(P){return[y,new jt().addKeys(P.keys)]},count:f,query:f,openCursor:f};return c(D).forEach(function(P){O[P]=function(C){var B=Me.subscr,z=!!B,N=gl(Me,h)&&ml(P,C)?C.obsSet={}:B;if(z){var Q,B=function(Ae){return Ae="idb://".concat(s,"/").concat(u,"/").concat(Ae),N[Ae]||(N[Ae]=new jt)},ce=B(""),ke=B(":dels"),z=D[P](C),xe=z[0],z=z[1];if((P==="query"&&xe.isPrimaryKey&&!C.values?ke:B(xe.name||"")).add(z),!xe.isPrimaryKey){if(P!=="count")return Q=P==="query"&&R&&C.values&&h.query(a(a({},C),{values:!1})),h[P].apply(this,arguments).then(function(Ae){if(P==="query"){if(R&&C.values)return Q.then(function($e){return $e=$e.result,ce.addKeys($e),Ae});var me=C.values?Ae.result.map(j):Ae.result;(C.values?ce:ke).addKeys(me)}else{var De,Xe;if(P==="openCursor")return Xe=C.values,(De=Ae)&&Object.create(De,{key:{get:function(){return ke.addKey(De.primaryKey),De.key}},primaryKey:{get:function(){var $e=De.primaryKey;return ke.addKey($e),$e}},value:{get:function(){return Xe&&ce.addKey(De.primaryKey),De.value}}})}return Ae});ke.add(l)}}return h[P].apply(this,arguments)}}),O}})}};function yl(n,s,l){var u;return l.numFailures===0?s:s.type==="deleteRange"||(u=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===u)?null:(u=a({},s),d(u.keys)&&(u.keys=u.keys.filter(function(f,h){return!(h in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,h){return!(h in l.failures)})),u)}function Mi(n,s){return l=n,((u=s).lower===void 0||(u.lowerOpen?0<Ve(l,u.lower):0<=Ve(l,u.lower)))&&(l=n,(u=s).upper===void 0||(u.upperOpen?Ve(l,u.upper)<0:Ve(l,u.upper)<=0));var l,u}function bl(n,s,l,u,f,h){var g,y,I,j,R,T;return!l||l.length===0||(g=s.query.index,y=g.multiEntry,I=s.query.range,j=u.schema.primaryKey.extractKey,R=g.extractKey,T=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(O,D){var P=O,C=[];if(D.type==="add"||D.type==="put")for(var B=new jt,z=D.values.length-1;0<=z;--z){var N,Q=D.values[z],ce=j(Q);!B.hasKey(ce)&&(N=R(Q),y&&d(N)?N.some(function(Ae){return Mi(Ae,I)}):Mi(N,I))&&(B.addKey(ce),C.push(Q))}switch(D.type){case"add":var ke=new jt().addKeys(s.values?O.map(function(me){return j(me)}):O),P=O.concat(s.values?C.filter(function(me){return me=j(me),!ke.hasKey(me)&&(ke.addKey(me),!0)}):C.map(function(me){return j(me)}).filter(function(me){return!ke.hasKey(me)&&(ke.addKey(me),!0)}));break;case"put":var xe=new jt().addKeys(D.values.map(function(me){return j(me)}));P=O.filter(function(me){return!xe.hasKey(s.values?j(me):me)}).concat(s.values?C:C.map(function(me){return j(me)}));break;case"delete":var fe=new jt().addKeys(D.keys);P=O.filter(function(me){return!fe.hasKey(s.values?j(me):me)});break;case"deleteRange":var Ie=D.range;P=O.filter(function(me){return!Mi(j(me),Ie)})}return P},n))===n)?n:(u.sort(function(O,D){return Ve(T(O),T(D))||Ve(j(O),j(D))}),s.limit&&s.limit<1/0&&(u.length>s.limit?u.length=s.limit:n.length===s.limit&&u.length<s.limit&&(f.dirty=!0)),h?Object.freeze(u):u)}function _l(n,s){return Ve(n.lower,s.lower)===0&&Ve(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function df(n,s){return((l,u,f,h)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=Ve(l,u))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,u,f,h)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=Ve(l,u))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function pf(n,s,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=s,setTimeout(function(){f.subscribers.size===0&&V(h,f)},3e3))})}var hf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,u,f){var h,g,y=n.transaction(l,u,f);return u==="readwrite"&&(f=(h=new AbortController).signal,y.addEventListener("abort",(g=function(I){return function(){if(h.abort(),u==="readwrite"){for(var j=new Set,R=0,T=l;R<T.length;R++){var O=T[R],D=jr["idb://".concat(s,"/").concat(O)];if(D){var P=n.table(O),C=D.optimisticOps.filter(function(De){return De.trans===y});if(y._explicit&&I&&y.mutatedParts)for(var B=0,z=Object.values(D.queries.query);B<z.length;B++)for(var N=0,Q=(xe=z[B]).slice();N<Q.length;N++)Ai((fe=Q[N]).obsSet,y.mutatedParts)&&(V(xe,fe),fe.subscribers.forEach(function(De){return j.add(De)}));else if(0<C.length){D.optimisticOps=D.optimisticOps.filter(function(De){return De.trans!==y});for(var ce=0,ke=Object.values(D.queries.query);ce<ke.length;ce++)for(var xe,fe,Ie,Ae=0,me=(xe=ke[ce]).slice();Ae<me.length;Ae++)(fe=me[Ae]).res!=null&&y.mutatedParts&&(I&&!fe.dirty?(Ie=Object.isFrozen(fe.res),Ie=bl(fe.res,fe.req,C,P,fe,Ie),fe.dirty?(V(xe,fe),fe.subscribers.forEach(function(De){return j.add(De)})):Ie!==fe.res&&(fe.res=Ie,fe.promise=Te.resolve({result:Ie}))):(fe.dirty&&V(xe,fe),fe.subscribers.forEach(function(De){return j.add(De)})))}}}j.forEach(function(De){return De()})}}})(!1),{signal:f}),y.addEventListener("error",g(!1),{signal:f}),y.addEventListener("complete",g(!0),{signal:f})),y},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return a(a({},u),{mutate:function(h){var g,y=Me.trans;return!f.outbound&&y.db._options.cache!=="disabled"&&!y.explicit&&y.idbtrans.mode==="readwrite"&&(g=jr["idb://".concat(s,"/").concat(l)])?(y=u.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Di(f,h).some(function(I){return I==null}))?(g.optimisticOps.push(h),h.mutatedParts&&Ds(h.mutatedParts),y.then(function(I){0<I.numFailures&&(V(g.optimisticOps,h),(I=yl(0,h,I))&&g.optimisticOps.push(I),h.mutatedParts)&&Ds(h.mutatedParts)}),y.catch(function(){V(g.optimisticOps,h),h.mutatedParts&&Ds(h.mutatedParts)})):y.then(function(I){var j=yl(0,a(a({},h),{values:h.values.map(function(R,T){var O;return I.failures[T]?R:(Y(O=(O=f.keyPath)!=null&&O.includes(".")?ue(R):a({},R),f.keyPath,I.results[T]),O)})}),I);g.optimisticOps.push(j),queueMicrotask(function(){return h.mutatedParts&&Ds(h.mutatedParts)})}),y):u.mutate(h)},query:function(h){var g,y,I,j,R,T,O;return gl(Me,u)&&ml("query",h)?(g=((I=Me.trans)==null?void 0:I.db._options.cache)==="immutable",y=(I=Me).requery,I=I.signal,T=((D,P,C,B)=>{var z=jr["idb://".concat(D,"/").concat(P)];if(!z)return[];if(!(D=z.queries[C]))return[null,!1,z,null];var N=D[(B.query?B.query.index.name:null)||""];if(!N)return[null,!1,z,null];switch(C){case"query":var Q=N.find(function(ce){return ce.req.limit===B.limit&&ce.req.values===B.values&&_l(ce.req.query.range,B.query.range)});return Q?[Q,!0,z,N]:[N.find(function(ce){return("limit"in ce.req?ce.req.limit:1/0)>=B.limit&&(!B.values||ce.req.values)&&df(ce.req.query.range,B.query.range)}),!1,z,N];case"count":return Q=N.find(function(ce){return _l(ce.req.query.range,B.query.range)}),[Q,!!Q,z,N]}})(s,l,"query",h),O=T[0],j=T[2],R=T[3],O&&T[1]?O.obsSet=h.obsSet:(T=u.query(h).then(function(D){var P=D.result;if(O&&(O.res=P),g){for(var C=0,B=P.length;C<B;++C)Object.freeze(P[C]);Object.freeze(P)}else D.result=ue(P);return D}).catch(function(D){return R&&O&&V(R,O),Promise.reject(D)}),O={obsSet:h.obsSet,promise:T,subscribers:new Set,type:"query",req:h,dirty:!1},R?R.push(O):(R=[O],(j=j||(jr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=R)),pf(O,R,y,I),O.promise.then(function(D){return{result:bl(D.result,h,j==null?void 0:j.optimisticOps,u,O,g)}})):u.query(h)}})}})}};function Ls(n,s){return new Proxy(n,{get:function(l,u,f){return u==="db"?s:Reflect.get(l,u,f)}})}yt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new Ee.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new Ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(nf),l.stores({}),this._state.autoSchema=!1),l},yt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?n():new Te(function(l,u){if(s._state.openComplete)return u(new Ee.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void u(new Ee.DatabaseClosed);s.open().catch(ze)}s._state.dbReadyPromise.then(l,u)}).then(n)},yt.prototype.use=function(f){var s=f.stack,l=f.create,u=f.level,f=f.name,h=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return h.push({stack:s,create:l,level:u??10,name:f}),h.sort(function(g,y){return g.level-y.level}),this},yt.prototype.unuse=function(n){var s=n.stack,l=n.name,u=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},yt.prototype.open=function(){var n=this;return Le(xt,function(){return of(n)})},yt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=mt.indexOf(this);if(0<=s&&mt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Te(function(l){n.dbReadyResolve=l}),n.openCanceller=new Te(function(l,u){n.cancelOpen=u}))},yt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new Ee.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new Ee.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},yt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new Te(function(f,h){function g(){s.close(n);var y=s._deps.indexedDB.deleteDatabase(s.name);y.onsuccess=at(function(){var I,j,R;I=s._deps,j=s.name,Si(R=I.indexedDB)||j===Ht||xi(R,I.IDBKeyRange).delete(j).catch(ze),f()}),y.onerror=Ln(h),y.onblocked=s._fireOnBlocked}if(l)throw new Ee.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},yt.prototype.backendDB=function(){return this.idbdb},yt.prototype.isOpen=function(){return this.idbdb!==null},yt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},yt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},yt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(yt.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),yt.prototype.transaction=function(){var n=(function(s,l,u){var f=arguments.length;if(f<2)throw new Ee.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return u=h.pop(),[s,be(h),u]}).apply(this,arguments);return this._transaction.apply(this,n)},yt.prototype._transaction=function(n,s,l){var u,f,h=this,g=Me.trans,y=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(j){if(j=j instanceof h.Table?j.name:j,typeof j!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return j}),n=="r"||n===Mn)u=Mn;else{if(n!="rw"&&n!=Lr)throw new Ee.InvalidArgument("Invalid transaction mode: "+n);u=Lr}if(g){if(g.mode===Mn&&u===Lr){if(!y)throw new Ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(j){if(g&&g.storeNames.indexOf(j)===-1){if(!y)throw new Ee.SubTransaction("Table "+j+" not included in parent transaction.");g=null}}),y&&g&&!g.active&&(g=null)}}catch(j){return g?g._promise(null,function(R,T){T(j)}):we(j)}var I=(function j(R,T,O,D,P){return Te.resolve().then(function(){var N=Me.transless||Me,C=R._createTransaction(T,O,R._dbSchema,D),N=(C.explicit=!0,{trans:C,transless:N});if(D)C.idbtrans=D.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(Q){return Q.name===Ge.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return j(R,T,O,null,P)})):we(Q)}var B,z=ye(P),N=(z&&Nt(),Te.follow(function(){var Q;(B=P.call(C,C))&&(z?(Q=kn.bind(null,null),B.then(Q,Q)):typeof B.next=="function"&&typeof B.throw=="function"&&(B=Pi(B)))},N));return(B&&typeof B.then=="function"?Te.resolve(B).then(function(Q){return C.active?Q:we(new Ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):N.then(function(){return B})).then(function(Q){return D&&C._resolve(),C._completion.then(function(){return Q})}).catch(function(Q){return C._reject(Q),we(Q)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,I,"lock"):Me.trans?Le(Me.transless,function(){return h._whenReady(I)}):this._whenReady(I)},yt.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new Ee.InvalidTable("Table ".concat(n," does not exist"))};var Xn=yt;function yt(n,s){var l,u,f,h,g,y=this,I=(this._middlewares={},this.verno=0,yt.dependencies),I=(this._options=s=a({addons:yt.addons,autoOpen:!0,indexedDB:I.indexedDB,IDBKeyRange:I.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),j=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ze,dbReadyPromise:null,cancelOpen:ze,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(j.dbReadyPromise=new Te(function(T){j.dbReadyResolve=T}),j.openCanceller=new Te(function(T,O){j.cancelOpen=O}),this._state=j,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[or,ze]}),this.once=function(T,O){var D=function(){for(var P=[],C=0;C<arguments.length;C++)P[C]=arguments[C];y.on(T).unsubscribe(D),O.apply(y,P)};return y.on(T,D)},this.on.ready.subscribe=re(this.on.ready.subscribe,function(T){return function(O,D){yt.vip(function(){var P,C=y._state;C.openComplete?(C.dbOpenError||Te.resolve().then(O),D&&T(O)):C.onReadyBeingFired?(C.onReadyBeingFired.push(O),D&&T(O)):(T(O),P=y,D||T(function B(){P.on.ready.unsubscribe(O),P.on.ready.unsubscribe(B)}))})}}),this.Collection=(l=this,Ba(Xc.prototype,function(B,C){this.db=l;var D=Na,P=null;if(C)try{D=C()}catch(N){P=N}var C=B._ctx,B=C.table,z=B.hook.reading.fire;this._ctx={table:B,index:C.index,isPrimKey:!C.index||B.schema.primKey.keyPath&&C.index===B.schema.primKey.name,range:D,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:C.or,valueMapper:z!==rt?z:null}})),this.Table=(u=this,Ba(tl.prototype,function(T,O,D){this.db=u,this._tx=D,this.name=T,this.schema=O,this.hook=u._allTables[T]?u._allTables[T].hook:qa(null,{creating:[Ar,ze],reading:[Gn,rt],updating:[ir,ze],deleting:[Oa,ze]})})),this.Transaction=(f=this,Ba(Jc.prototype,function(T,O,D,P,C){var B=this;T!=="readonly"&&O.forEach(function(z){z=(z=D[z])==null?void 0:z.yProps,z&&(O=O.concat(z.map(function(N){return N.updatesTable})))}),this.db=f,this.mode=T,this.storeNames=O,this.schema=D,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=C||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Te(function(z,N){B._resolve=z,B._reject=N}),this._completion.then(function(){B.active=!1,B.on.complete.fire()},function(z){var N=B.active;return B.active=!1,B.on.error.fire(z),B.parent?B.parent._reject(z):N&&B.idbtrans&&B.idbtrans.abort(),we(z)})})),this.Version=(h=this,Ba(sf.prototype,function(T){this.db=h,this._cfg={version:T,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Ba(il.prototype,function(T,O,D){if(this.db=g,this._ctx={table:T,index:O===":id"?null:O,or:D},this._cmp=this._ascending=Ve,this._descending=function(P,C){return Ve(C,P)},this._max=function(P,C){return 0<Ve(P,C)?P:C},this._min=function(P,C){return Ve(P,C)<0?P:C},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ee.MissingAPI})),this.on("versionchange",function(T){0<T.newVersion?console.warn("Another connection wants to upgrade database '".concat(y.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(y.name,"'. Closing db now to resume the delete request.")),y.close({disableAutoOpen:!1})}),this.on("blocked",function(T){!T.newVersion||T.newVersion<T.oldVersion?console.warn("Dexie.delete('".concat(y.name,"') was blocked")):console.warn("Upgrade '".concat(y.name,"' blocked by other connection holding version ").concat(T.oldVersion/10))}),this._maxKey=Ka(s.IDBKeyRange),this._createTransaction=function(T,O,D,P){return new y.Transaction(T,O,D,y._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(T){y.on("blocked").fire(T),mt.filter(function(O){return O.name===y.name&&O!==y&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(T)})},this.use(cf),this.use(hf),this.use(ff),this.use(lf),this.use(uf),new Proxy(this,{get:function(T,O,D){var P;return O==="_vip"||(O==="table"?function(C){return Ls(y.table(C),R)}:(P=Reflect.get(T,O,D))instanceof tl?Ls(P,R):O==="tables"?P.map(function(C){return Ls(C,R)}):O==="_createTransaction"?function(){return Ls(P.apply(this,arguments),R)}:P)}}));this.vip=R,I.forEach(function(T){return T(y)})}var Ns,ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",vf=(Li.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Li.prototype[ha]=function(){return this},Li);function Li(n){this._subscribe=n}try{Ns={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ns={indexedDB:null,IDBKeyRange:null}}function wl(n){var s,l=!1,u=new vf(function(f){var h=ye(n),g,y=!1,I={},j={},R={get closed(){return y},unsubscribe:function(){y||(y=!0,g&&g.abort(),T&&vr.storagemutated.unsubscribe(D))}},T=(f.start&&f.start(R),!1),O=function(){return pe(P)},D=function(C){Os(I,C),Ai(j,I)&&O()},P=function(){var C,B,z;!y&&Ns.indexedDB&&(I={},C={},g&&g.abort(),g=new AbortController,z=(N=>{var Q=pr();try{h&&Nt();var ce=wn(n,N);return ce=h?ce.finally(kn):ce}finally{Q&&Vn()}})(B={subscr:C,signal:g.signal,requery:O,querier:n,trans:null}),Promise.resolve(z).then(function(N){l=!0,s=N,y||B.signal.aborted||(I={},(Q=>{for(var ce in Q)if(x(Q,ce))return;return 1})(j=C)||T||(vr(Fa,D),T=!0),pe(function(){return!y&&f.next&&f.next(N)}))},function(N){l=!1,["DatabaseClosedError","AbortError"].includes(N==null?void 0:N.name)||y||pe(function(){y||f.error&&f.error(N)})}))};return setTimeout(O,0),R});return u.hasValue=function(){return l},u.getValue=function(){return s},u}var qr=Xn;function Ni(n){var s=gr;try{gr=!0,vr.storagemutated.fire(n),Ri(n,!0)}finally{gr=s}}_(qr,a(a({},H),{delete:function(n){return new qr(n,{addons:[]}).delete()},exists:function(n){return new qr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=qr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Si(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Ht})}):xi(l,s).toCollection().primaryKeys()).then(n)}catch{return we(new Ee.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Me.trans?Le(Me.transless,n):n()},vip:Ti,async:function(n){return function(){try{var s=Pi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Te.resolve(s)}catch(l){return we(l)}}},spawn:function(n,s,l){try{var u=Pi(n.apply(l,s||[]));return u&&typeof u.then=="function"?u:Te.resolve(u)}catch(f){return we(f)}},currentTransaction:{get:function(){return Me.trans||null}},waitFor:function(n,s){return n=Te.resolve(typeof n=="function"?qr.ignoreTransaction(n):n).timeout(s||6e4),Me.trans?Me.trans.waitFor(n):n},Promise:Te,debug:{get:function(){return Jt},set:function(n){Da(n)}},derive:L,extend:v,props:_,override:re,Events:qa,on:vr,liveQuery:wl,extendObservabilitySet:Os,getByKeyPath:te,setByKeyPath:Y,delByKeyPath:function(n,s){typeof s=="string"?Y(n,s,void 0):"length"in s&&[].map.call(s,function(l){Y(n,l,void 0)})},shallowClone:ve,deepClone:ue,getObjectDiff:Oi,cmp:Ve,asap:J,minKey:-1/0,addons:[],connections:mt,errnames:Ge,dependencies:Ns,cache:jr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),qr.maxKey=Ka(qr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(vr(Fa,function(n){gr||(n=new CustomEvent(gi,{detail:n}),gr=!0,dispatchEvent(n),gr=!1)}),addEventListener(gi,function(n){n=n.detail,gr||Ni(n)}));var va,gr=!1,kl=function(){};return typeof BroadcastChannel<"u"&&((kl=function(){(va=new BroadcastChannel(gi)).onmessage=function(n){return n.data&&Ni(n.data)}})(),typeof va.unref=="function"&&va.unref(),vr(Fa,function(n){gr||va.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Xn.disableBfCache&&n.persisted){Jt&&console.debug("Dexie: handling persisted pagehide"),va!=null&&va.close();for(var s=0,l=mt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Xn.disableBfCache&&n.persisted&&(Jt&&console.debug("Dexie: handling persisted pageshow"),kl(),Ni({all:new jt(-1/0,[[]])}))})),Te.rejectionMapper=function(n,s){return!n||n instanceof U||n instanceof TypeError||n instanceof SyntaxError||!n.name||!lt[n.name]?n:(s=new lt[n.name](s||n.message,n),"stack"in n&&M(s,"stack",{get:function(){return this.inner.stack}}),s)},Da(Jt),a(Xn,Object.freeze({__proto__:null,Dexie:Xn,Entity:Qo,PropModification:ja,RangeSet:jt,add:function(n){return new ja({add:n})},cmp:Ve,default:Xn,liveQuery:wl,mergeRanges:Ha,rangesOverlap:fl,remove:function(n){return new ja({remove:n})},replacePrefix:function(n,s){return new ja({replacePrefix:[n,s]})}}),{default:Xn}),Xn})})(Xs)),Xs.exports}var ep=$d();const lo=Zd(ep),Fl=Symbol.for("Dexie"),zt=globalThis[Fl]||(globalThis[Fl]=lo);if(lo.semVer!==zt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${lo.semVer} and ${zt.semVer}`);const{liveQuery:ay,mergeRanges:sy,rangesOverlap:iy,RangeSet:oy,cmp:ly,Entity:uy,PropModification:cy,replacePrefix:fy,add:dy,remove:py,DexieYProvider:hy}=zt,je=new zt("me-ai-store");je.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});je.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});je.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});je.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function cc(t,e){return`${t}:${e}`}function uo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Gi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function tp(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function fc(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function dc(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const np="https://gmail.googleapis.com/gmail/v1/users/me";class jo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function rp(t){return{Authorization:`Bearer ${t}`}}async function fi(t,e){var a,i,o,c;const r=await fetch(`${np}${e}`,{headers:rp(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,p=((c=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:c.reason)||void 0;throw new jo(v,r.status,p)}return r.json()}function pc(t){return fi(t,"/profile")}function hc(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),fi(t,`/messages?${i}`)}function vc(t,e,r="full"){return fi(t,`/messages/${e}?format=${r}`)}function ap(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),fi(t,`/history?${i}`)}function yr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function ss(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function sp(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/plain");if((c=a==null?void 0:a.body)!=null&&c.data)return ss(a.body.data);const i=ei(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=ss(i.body.data);return op(v)}return"(no body)"}function ip(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ss(e.body.data);const r=e.parts||[],a=ei(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?ss(a.body.data):null}function ei(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ei(r.parts,e);if(a)return a}}return null}function op(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function qo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Bo(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function gc(t){return Bo(t).charAt(0).toUpperCase()}function lp(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function up(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function mc(t,e){return`${lp(t.date)}_${up(t.subject)}.${e}`}function yc(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function cp(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await bc();if(a&&i){const c=new Date(a.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const o=await vp(5);return o.length>0&&r.push("Top senders: "+o.map(([c,d])=>`${Bo(c)} (${d})`).join(", ")+"."),r.join(" ")}async function fp(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await bc();if(a&&i){const v=new Date(a.date).toLocaleDateString(),p=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${v} â ${p}`)}const o=await je.items.where("sourceType").equals("gmail").toArray(),c=_c(o,10),d=gp(o,10);if(c.length>0){r.push("","### Top Senders");for(const[v,p]of c)r.push(`- ${v}: ${p}`)}if(d.length>0){r.push("","### Labels");for(const[v,p]of d)r.push(`- ${v}: ${p}`)}return r.join(`
`)}async function dp(t=10){const e=await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(wc).join(`

---

`)}async function pp(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await je.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,p,m,x;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(c+=2),(m=o.snippet)!=null&&m.toLowerCase().includes(r)&&(c+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>wc(o)).join(`

---

`)}async function co(){const t=await je.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=yc(t);return{groups:e,order:r,total:t.length}}async function hp({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await je.items.where("sourceType").equals("gmail").filter(d=>{var v,p,m,x;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((m=d.to)==null?void 0:m.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const a=await je.items.where("sourceType").equals("gmail").count();return{items:await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function bc(){const t=await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).first(),e=await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).last();return{oldest:t,newest:e}}async function vp(t){const e=await je.items.where("sourceType").equals("gmail").toArray();return _c(e,t)}function _c(t,e){const r={};for(const a of t){const i=a.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,e)}function gp(t,e){const r={};for(const a of t)for(const i of a.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,e)}function wc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=fc(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function mp(){const t=await cp();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function yp(t){const e=[],r=await fp();if(e.push(r),t){const a=await pp(t,5);e.push("","## Relevant Emails",a)}else{const a=await dp(5);e.push("","## Recent Emails",a)}return e.join(`
`)}async function bp(){const t=await co();if(!t)return null;const e=["## Pending Action Items",`You have ${t.total} pending email action items that need attention:`,""];for(const r of t.order){const a=t.groups[r],i=r.replace(/_/g," ");e.push(`### ${i} (${a.length})`);for(const o of a.slice(0,5)){const c=o.date?new Date(o.date).toLocaleDateString():"unknown date";e.push(`- **${o.subject}** from ${o.from} (${c})`),o.summary&&e.push(`  ${o.summary}`)}a.length>5&&e.push(`  ...and ${a.length-5} more`),e.push("")}return e.push("The user is seeing these pending items in their chat. Help them decide what to do with these items. You can suggest specific actions like archiving, replying, following up, etc."),e.join(`
`)}const _p=20,wp={maxTokens:512},kc=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function xc(t,{count:e=_p,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).reverse().limit(e).toArray();else{const p=new Set(await je.emailClassifications.toCollection().primaryKeys());o=0,i=[],await je.items.where("[sourceType+date]").between(["gmail",zt.minKey],["gmail",zt.maxKey]).reverse().until(()=>i.length>=e).each(m=>{p.has(m.id)?o++:i.push(m)})}if(i.length===0){const p=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:p,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let p=0;p<i.length;p++){const m=i[p];a({phase:"scanning",message:`Classifying email ${p+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:p+1,total:i.length,classified:d});try{const x=Ec(m),_=[{role:"system",content:kc},{role:"user",content:x}],k=await t.generateFull(_,{maxTokens:512,enableThinking:!1}),M=Tp(k);M&&(await je.emailClassifications.put({emailId:m.id,action:M.action,reason:M.reason,summary:M.summary,tags:M.tags,subject:m.subject||"(no subject)",from:m.from||"",date:m.date,scannedAt:c,status:"pending"}),d++)}catch(x){console.error(`Triage email ${p+1} failed:`,x),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function kp(){const t=await je.emailClassifications.toArray();return yc(t)}async function xp(){const t=await je.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ti(t,e){await je.emailClassifications.update(t,{status:e})}async function Sp(){await je.emailClassifications.clear()}async function Sc(t){await je.emailClassifications.where("action").equals(t).delete()}async function Tc(t){await je.emailClassifications.delete(t)}async function fo(){const t=await je.items.where("sourceType").equals("gmail").count(),e=await je.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Ec(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=fc(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Tp(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=Ep(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function Ep(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function po(t){return`hsl(${dc(t)}, 55%, 55%)`}function Ap(t){return`hsl(${dc(t)}, 40%, 35%)`}const Cp=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Kl(...t){Cp&&console.log("[debug]",...t)}function on(t){return Kl(`[MOUNT] ${t}`),()=>Kl(`[DESTROY] ${t}`)}var Ip=W("<option> </option>"),Rp=W('<p class="model-description svelte-1p89qnn"> </p>'),Pp=W('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Op=W('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Dp=W('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Mp=W('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Lp=W('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Np=W('<p class="error svelte-1p89qnn"> </p>'),jp=W('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function qp(t,e){ft(e,!0);let r=Ce(e,"selectedModel",15),a=Ce(e,"gpuInfo",3,null),i=Ce(e,"error",3,null);Lt(()=>on("ModelSelector"));var o=jp(),c=A(w(o),2),d=A(w(c),2);sn(d,21,()=>ls,Er,(L,S)=>{var F=Ip(),ie=w(F),re={};ge(()=>{oe(ie,`${b(S).name??""} â ${b(S).size??""}`),re!==(re=b(S).id)&&(F.value=(F.__value=b(S).id)??"")}),K(L,F)});var v=A(d,2);{var p=L=>{const S=ct(()=>ls.find(G=>G.id===r()));var F=Pa(),ie=ot(F);{var re=G=>{var J=Rp(),te=w(J);ge(()=>oe(te,b(S).description)),K(G,J)};Se(ie,G=>{b(S)&&G(re)})}K(L,F)};Se(v,L=>{r()&&L(p)})}var m=A(c,2);{var x=L=>{var S=Lp(),F=A(w(S),2),ie=w(F),re=A(w(ie)),G=w(re),J=A(ie,2),te=A(w(J)),Y=w(te),ve=A(J,2);{var Oe=ae=>{var le=Pp(),V=A(w(le)),ne=w(V);ge(()=>oe(ne,a().device)),K(ae,le)};Se(ve,ae=>{a().device&&a().device!=="unknown"&&ae(Oe)})}var be=A(ve,2);{var he=ae=>{var le=Op(),V=A(w(le)),ne=w(V);ge(()=>oe(ne,a().description)),K(ae,le)};Se(be,ae=>{a().description&&a().description!=="unknown"&&ae(he)})}var se=A(be,2);{var ue=ae=>{var le=Dp(),V=A(w(le)),ne=w(V);ge(de=>oe(ne,de),[()=>uo(a().limits.maxBufferSize)]),K(ae,le)};Se(se,ae=>{var le;(le=a().limits)!=null&&le.maxBufferSize&&ae(ue)})}var Re=A(se,2);{var $=ae=>{var le=Mp(),V=A(w(le)),ne=w(V);ge(()=>oe(ne,`${a().features.length??""} supported`)),K(ae,le)};Se(Re,ae=>{var le;(le=a().features)!=null&&le.length&&ae($)})}ge(()=>{oe(G,a().vendor),oe(Y,a().architecture)}),K(L,S)};Se(m,L=>{a()&&L(x)})}var _=A(m,2);{var k=L=>{var S=Np(),F=w(S);ge(()=>oe(F,i())),K(L,S)};Se(_,L=>{i()&&L(k)})}var M=A(_,2);M.__click=function(...L){var S;(S=e.onload)==null||S.apply(this,L)},ge(()=>M.disabled=i()),Lo(d,r),K(t,o),dt()}Mt(["click"]);var Bp=W('<span class="progress-percent svelte-r5fnze"> </span>'),zp=W('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Fp=W('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Kp=W('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Up=W('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Gp=W('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Hp=W('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Wp(t,e){ft(e,!0);let r=Ce(e,"message",3,""),a=Ce(e,"items",19,()=>[]);Lt(()=>on("LoadingProgress"));var i=Hp(),o=w(i),c=w(o),d=A(o,2);sn(d,17,a,Er,(v,p)=>{const m=ct(()=>b(p).total?tp(b(p).loaded||0,b(p).total):null);var x=Gp(),_=w(x),k=w(_),M=w(k),L=A(k,2);{var S=G=>{var J=Bp(),te=w(J);ge(Y=>oe(te,`${Y??""}%`),[()=>b(m).toFixed(1)]),K(G,J)};Se(L,G=>{b(m)!==null&&G(S)})}var F=A(_,2);{var ie=G=>{var J=zp(),te=ot(J),Y=w(te),ve=A(te,2),Oe=w(ve),be=w(Oe),he=A(Oe,4),se=w(he),ue=A(he,2),Re=w(ue);ge(($,ae,le,V,ne)=>{Zt(Y,`width: ${$??""}%`),oe(be,ae),oe(se,le),oe(Re,`(${V??""} / ${ne??""} B)`)},[()=>Math.max(b(p).progress??0,.5).toFixed(1),()=>Gi(b(p).loaded||0),()=>Gi(b(p).total),()=>(b(p).loaded||0).toLocaleString(),()=>b(p).total.toLocaleString()]),K(G,J)},re=G=>{var J=Up(),te=A(ot(J),2),Y=w(te);{var ve=be=>{var he=Fp(),se=ot(he),ue=w(se),Re=A(se,2),$=w(Re);ge((ae,le)=>{oe(ue,ae),oe($,`(${le??""} B)`)},[()=>Gi(b(p).loaded),()=>b(p).loaded.toLocaleString()]),K(be,he)},Oe=be=>{var he=Kp();K(be,he)};Se(Y,be=>{b(p).loaded?be(ve):be(Oe,!1)})}K(G,J)};Se(F,G=>{b(p).total?G(ie):G(re,!1)})}ge(()=>{oc(k,"title",b(p).file),oe(M,b(p).file)}),K(v,x)}),ge(()=>oe(c,r())),K(t,i),dt()}var Yp=W('<span class="thinking-tokens svelte-11gjw00"> </span>'),Vp=W('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Xp=W('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Qp=W('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Zp=W('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Jp=W('<span class="cursor svelte-11gjw00">|</span>'),$p=W(" <!>",1),eh=W('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),th=W('<div class="content svelte-11gjw00"> </div>'),nh=W('<div><div class="role svelte-11gjw00"> </div> <!></div>');function rh(t,e){ft(e,!0);let r=Ce(e,"isLast",3,!1),a=Ce(e,"isRunning",3,!1),i=Ce(e,"generationPhase",3,null),o=Ce(e,"numTokens",3,null);Lt(()=>on(`MessageBubble[${e.msg.role}]`));var c=nh(),d=w(c),v=w(d),p=A(d,2);{var m=_=>{var k=eh(),M=ot(k);{var L=Y=>{var ve=Vp(),Oe=A(w(ve),4);{var be=he=>{var se=Yp(),ue=w(se);ge(()=>oe(ue,`${o()??""} tokens`)),K(he,se)};Se(Oe,he=>{o()&&he(be)})}K(Y,ve)},S=Y=>{var ve=Xp();K(Y,ve)};Se(M,Y=>{a()&&r()&&i()==="thinking"?Y(L):a()&&r()&&i()==="preparing"&&Y(S,1)})}var F=A(M,2);{var ie=Y=>{var ve=Qp(),Oe=w(ve),be=A(w(Oe),2),he=w(be),se=A(Oe,2),ue=w(se);ge(Re=>{oe(he,`${Re??""} words`),oe(ue,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),K(Y,ve)};Se(F,Y=>{e.msg.thinking&&Y(ie)})}var re=A(F,2),G=w(re);{var J=Y=>{var ve=Zp();K(Y,ve)},te=Y=>{var ve=$p(),Oe=ot(ve,!0),be=A(Oe);{var he=se=>{var ue=Jp();K(se,ue)};Se(be,se=>{a()&&r()&&se(he)})}ge(()=>oe(Oe,e.msg.content)),K(Y,ve)};Se(G,Y=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?Y(J):Y(te,!1)})}K(_,k)},x=_=>{var k=th(),M=w(k);ge(()=>oe(M,e.msg.content)),K(_,k)};Se(p,_=>{e.msg.role==="assistant"?_(m):_(x,!1)})}ge(()=>{Bt(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),oe(v,e.msg.role==="user"?"You":"AI")}),K(t,c),dt()}var ah=W('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),sh=W('<span class="edate svelte-mt5nvh"> </span>'),ih=W('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),oh=W('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),lh=W('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),uh=W('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),ch=W('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function fh(t,e){ft(e,!0);let r=Ce(e,"pendingData",3,null),a=Pe(null),i=Pe(null);function o(k){q(a,b(a)===k?null:k,!0),q(i,null)}function c(k){return k.split("_").map(M=>M.charAt(0)+M.slice(1).toLowerCase()).join(" ")}function d(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(k){if(!k)return"";const M=k.replace(/<.*>/,"").trim();return M.length>24?M.slice(0,22)+"â¦":M}var p={toggleGroup:o},m=Pa(),x=ot(m);{var _=k=>{var M=ch(),L=w(M),S=w(L),F=A(L,2);sn(F,20,()=>r().order,G=>G,(G,J)=>{const te=ct(()=>r().groups[J]),Y=ct(()=>po(J)),ve=ct(()=>b(a)===J);var Oe=ah();let be;Oe.__click=()=>o(J);let he;var se=w(Oe);let ue;var Re=A(se),$=A(Re),ae=w($);ge(le=>{be=Bt(Oe,1,"chip svelte-mt5nvh",null,be,{active:b(ve)}),he=Zt(Oe,"",he,{"--c":b(Y)}),ue=Zt(se,"",ue,{background:b(Y)}),oe(Re,` ${le??""} `),oe(ae,b(te).length)},[()=>c(J)]),K(G,Oe)});var ie=A(F,2);{var re=G=>{const J=ct(()=>r().groups[b(a)]),te=ct(()=>po(b(a)));var Y=uh(),ve=w(Y);let Oe;var be=w(ve);be.__click=()=>{q(a,null),q(i,null)};var he=A(be,2),se=w(he),ue=A(he,2),Re=w(ue),$=A(ve,2);sn($,21,()=>b(J),de=>de.emailId,(de,ye)=>{var H=ih(),ee=w(H);ee.__click=()=>{var rt;return(rt=e.onaskai)==null?void 0:rt.call(e,`Tell me about the email "${b(ye).subject}" from ${b(ye).from}`)};var U=w(ee),Z=w(U),Ne=A(U,2),_e=w(Ne),Ge=A(_e);{var nt=rt=>{var Gn=sh(),At=w(Gn);ge(Ar=>oe(At,Ar),[()=>d(b(ye).date)]),K(rt,Gn)};Se(Ge,rt=>{b(ye).date&&rt(nt)})}var Ee=A(ee,2),lt=w(Ee);lt.__click=()=>{var rt;return(rt=e.onmarkacted)==null?void 0:rt.call(e,b(ye).emailId)};var ze=A(lt,2);ze.__click=()=>{var rt;return(rt=e.ondismiss)==null?void 0:rt.call(e,b(ye).emailId)},ge(rt=>{oe(Z,b(ye).subject),oe(_e,rt)},[()=>v(b(ye).from)]),K(de,H)});var ae=A($,2),le=w(ae);{var V=de=>{var ye=oh(),H=ot(ye);H.__click=()=>b(J).forEach(U=>{var Z;return(Z=e.onmarkacted)==null?void 0:Z.call(e,U.emailId)});var ee=A(H,2);ee.__click=()=>q(i,b(a),!0),K(de,ye)},ne=de=>{var ye=lh(),H=ot(ye),ee=w(H),U=A(H,2);U.__click=()=>q(i,null);var Z=A(U,2);Z.__click=()=>{var Ne;(Ne=e.oncleargroup)==null||Ne.call(e,b(a)),q(i,null),q(a,null)},ge(()=>oe(ee,`Remove ${b(J).length??""}?`)),K(de,ye)};Se(le,de=>{b(i)!==b(a)?de(V):de(ne,!1)})}ge(de=>{Oe=Zt(ve,"",Oe,{"border-color":b(te)}),oe(se,de),oe(Re,b(J).length)},[()=>c(b(a))]),K(G,Y)};Se(ie,G=>{b(a)&&r().groups[b(a)]&&G(re)})}ge(()=>oe(S,`${r().total??""} item${r().total!==1?"s":""} need attention`)),K(k,M)};Se(x,k=>{r()&&r().total>0&&k(_)})}return K(t,m),dt(p)}Mt(["click"]);var dh=W('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),ph=W('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),hh=W('<div class="strip svelte-1ed7zw1"><!></div>');function vh(t,e){let r=Ce(e,"hasScanData",3,!1),a=Ce(e,"engineReady",3,!1),i=Ce(e,"isScanning",3,!1),o=ct(()=>a()&&!r()&&!i()),c=ct(()=>b(o)||i());var d=Pa(),v=ot(d);{var p=m=>{var x=hh(),_=w(x);{var k=L=>{var S=dh();K(L,S)},M=L=>{var S=ph();S.__click=function(...F){var ie;(ie=e.onscan)==null||ie.apply(this,F)},K(L,S)};Se(_,L=>{i()?L(k):b(o)&&L(M,1)})}K(m,x)};Se(v,m=>{b(c)&&m(p)})}K(t,d)}Mt(["click"]);var gh=W('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mh=W('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),yh=W('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),bh=W('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),_h=W('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),wh=W('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),kh=W('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function xh(t,e){ft(e,!0),Lt(()=>on("GpuPanel"));var r=kh(),a=w(r),i=A(w(a),2),o=A(w(i),2),c=w(o),d=A(i,2),v=A(w(d),2),p=w(v),m=A(d,2);{var x=G=>{var J=gh(),te=A(w(J),2),Y=w(te);ge(()=>oe(Y,e.gpuInfo.device)),K(G,J)};Se(m,G=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&G(x)})}var _=A(m,2);{var k=G=>{var J=mh(),te=A(w(J),2),Y=w(te);ge(ve=>oe(Y,ve),[()=>uo(e.gpuInfo.limits.maxBufferSize)]),K(G,J)};Se(_,G=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxBufferSize&&G(k)})}var M=A(_,2);{var L=G=>{var J=yh(),te=A(w(J),2),Y=w(te);ge(()=>oe(Y,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),K(G,J)};Se(M,G=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeInvocationsPerWorkgroup&&G(L)})}var S=A(M,2);{var F=G=>{var J=bh(),te=A(w(J),2),Y=w(te);ge(ve=>oe(Y,ve),[()=>uo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),K(G,J)};Se(S,G=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeWorkgroupStorageSize&&G(F)})}var ie=A(S,2);{var re=G=>{var J=wh(),te=w(J),Y=w(te),ve=A(te,2);sn(ve,21,()=>e.gpuInfo.features,Er,(Oe,be)=>{var he=_h(),se=w(he);ge(()=>oe(se,b(be))),K(Oe,he)}),ge(()=>oe(Y,`Features (${e.gpuInfo.features.length??""})`)),K(G,J)};Se(ie,G=>{var J;(J=e.gpuInfo.features)!=null&&J.length&&G(re)})}ge(()=>{oe(c,e.gpuInfo.vendor),oe(p,e.gpuInfo.architecture)}),K(t,r),dt()}var Sh=W('<button class="gpu-badge svelte-1ktw27c"> </button>'),Th=W('<span class="stats svelte-1ktw27c"> </span>'),Eh=W('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Ah=W('<span class="stats preparing svelte-1ktw27c"> </span>'),Ch=W('<span class="stats svelte-1ktw27c"> </span>'),Ih=W('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Rh=W('<button class="btn svelte-1ktw27c">Stop</button>'),Ph=W('<button class="btn primary svelte-1ktw27c">Send</button>'),Oh=W('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Dh(t,e){ft(e,!0),Lt(()=>on("ChatView"));let r=Ce(e,"messages",19,()=>[]),a=Ce(e,"pendingData",3,null),i=Ce(e,"hasScanData",3,!1),o=Ce(e,"engineReady",3,!1),c=Ce(e,"isScanning",3,!1),d=Ce(e,"isRunning",3,!1),v=Ce(e,"tps",3,null),p=Ce(e,"numTokens",3,null),m=Ce(e,"generationPhase",3,null),x=Ce(e,"gpuInfo",3,null),_=Ce(e,"chatContainer",15),k=Pe(""),M=Pe(!1);function L(U){U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),S())}function S(){const U=b(k).trim();!U||d()||(q(k,""),e.onsend(U))}function F(U){U&&!d()&&e.onsend(U)}var ie=Oh(),re=w(ie),G=w(re);{var J=U=>{var Z=Sh();Z.__click=()=>q(M,!b(M));var Ne=w(Z);ge(()=>oe(Ne,`WebGPU ${b(M)?"â²":"â¼"}`)),K(U,Z)};Se(G,U=>{x()&&U(J)})}var te=A(G,2);{var Y=U=>{var Z=Th(),Ne=w(Z);ge((_e,Ge)=>oe(Ne,`${p()??""} tokens in ${_e??""}s
        (${Ge??""} tok/s)`),[()=>(p()/v()).toFixed(1),()=>v().toFixed(1)]),K(U,Z)},ve=U=>{var Z=Eh();K(U,Z)},Oe=U=>{var Z=Ah(),Ne=w(Z);ge(_e=>oe(Ne,`thinking... ${_e??""}`),[()=>v()?`${v().toFixed(0)} tok/s`:""]),K(U,Z)},be=U=>{var Z=Ch(),Ne=w(Z);ge(_e=>oe(Ne,`${_e??""} tok/s`),[()=>v().toFixed(1)]),K(U,Z)};Se(te,U=>{v()&&!d()?U(Y):d()&&m()==="preparing"?U(ve,1):d()&&m()==="thinking"?U(Oe,2):v()&&d()&&U(be,3)})}var he=A(te,4);he.__click=function(...U){var Z;(Z=e.onreset)==null||Z.apply(this,U)};var se=A(re,2);{var ue=U=>{xh(U,{get gpuInfo(){return x()}})};Se(se,U=>{b(M)&&x()&&U(ue)})}var Re=A(se,2),$=w(Re);{var ae=U=>{var Z=Ih();K(U,Z)};Se($,U=>{r().length===0&&!(a()&&a().total>0)&&U(ae)})}var le=A($,2);sn(le,17,r,Er,(U,Z,Ne)=>{var _e=Pa(),Ge=ot(_e);{var nt=lt=>{fh(lt,{get pendingData(){return b(Z).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:F})},Ee=lt=>{{let ze=ct(()=>Ne===r().length-1);rh(lt,{get msg(){return b(Z)},get isLast(){return b(ze)},get isRunning(){return d()},get generationPhase(){return m()},get numTokens(){return p()}})}};Se(Ge,lt=>{b(Z).type==="dashboard"?lt(nt):lt(Ee,!1)})}K(U,_e)}),lc(Re,U=>_(U),()=>_());var V=A(Re,2);vh(V,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return c()},get onscan(){return e.onscan}});var ne=A(V,2),de=w(ne);de.__keydown=L;var ye=A(de,2);{var H=U=>{var Z=Rh();Z.__click=function(...Ne){var _e;(_e=e.onstop)==null||_e.apply(this,Ne)},K(U,Z)},ee=U=>{var Z=Ph();Z.__click=S,ge(Ne=>Z.disabled=Ne,[()=>!b(k).trim()]),K(U,Z)};Se(ye,U=>{d()?U(H):U(ee,!1)})}ge(()=>{he.disabled=d(),de.disabled=d()}),No(de,()=>b(k),U=>q(k,U)),K(t,ie),dt()}Mt(["click","keydown"]);var Mh=W('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Lh(t,e){ft(e,!0);const r=!!navigator.gpu,a=uc();let i=Pe(Rt(localStorage.getItem("selectedModel")||ls[0].id)),o=Pe(null),c=Pe(null),d=Pe(""),v=Pe(Rt([])),p=Pe(Rt([])),m=Pe(!1),x=Pe(null),_=Pe(null),k=Pe(null),M=Pe(null),L=Pe(null),S=Pe(null),F=Pe(!1),ie=Pe(!1),re=!1;Lt(()=>{a.check(),a.isReady&&G();const H=a.onMessage(ee=>{switch(ee.status){case"webgpu-info":q(M,ee.data,!0);break;case"loading":q(o,"loading"),q(d,ee.data,!0);break;case"initiate":q(v,[...b(v),ee],!0);break;case"progress":q(v,b(v).map(U=>U.file===ee.file?{...U,...ee}:U),!0);break;case"done":q(v,b(v).filter(U=>U.file!==ee.file),!0);break;case"ready":q(o,"ready"),G();break;case"start":if(!b(m))break;q(L,ee.phase||"preparing",!0),q(p,[...b(p),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!b(m))break;q(L,ee.phase,!0);break;case"thinking":{if(!b(m))break;q(x,ee.tps,!0),q(_,ee.numTokens,!0);const U=b(p)[b(p).length-1];q(p,[...b(p).slice(0,-1),{...U,thinking:(U.thinking||"")+ee.content}],!0),he();break}case"thinking-done":{if(!b(m))break;q(x,ee.tps,!0),q(_,ee.numTokens,!0);const U=b(p)[b(p).length-1];q(p,[...b(p).slice(0,-1),{...U,thinking:ee.content}],!0);break}case"update":{if(!b(m))break;q(x,ee.tps,!0),q(_,ee.numTokens,!0);const U=b(p)[b(p).length-1];q(p,[...b(p).slice(0,-1),{...U,content:U.content+ee.output}],!0),he();break}case"complete":if(!b(m))break;q(m,!1),q(L,null),J();break;case"error":if(!b(m))break;q(c,ee.data,!0),q(m,!1),q(L,null);break}});return()=>H()});async function G(){if(!(re||b(p).length>0))try{const H=await co();q(S,H,!0),H&&(re=!0,q(p,[{role:"assistant",type:"dashboard",pendingData:H}],!0),he());const ee=await fo();q(F,ee.classified>0)}catch{}}async function J(){try{const H=await co();q(S,H,!0);const ee=b(p).findIndex(Z=>Z.type==="dashboard");ee!==-1&&(H&&H.total>0?q(p,b(p).map((Z,Ne)=>Ne===ee?{...Z,pendingData:H}:Z),!0):q(p,b(p).filter((Z,Ne)=>Ne!==ee),!0));const U=await fo();q(F,U.classified>0)}catch{}}async function te(H){await ti(H,"acted"),await J()}async function Y(H){await ti(H,"dismissed"),await J()}async function ve(H){await Tc(H),await J()}async function Oe(H){await Sc(H),await J()}async function be(){if(!(b(ie)||!a.isReady)){q(ie,!0);try{await xc(a,{count:20}),await J(),b(S)&&!b(p).some(H=>H.type==="dashboard")&&(q(p,[{role:"assistant",type:"dashboard",pendingData:b(S)},...b(p)],!0),he())}catch(H){console.error("Scan failed:",H)}finally{q(ie,!1)}}}function he(){nc().then(()=>{b(k)&&(b(k).scrollTop=b(k).scrollHeight)})}function se(){q(o,"loading"),localStorage.setItem("selectedModel",b(i)),a.loadModel(b(i))}async function ue(H){if(!H||b(m))return;q(p,[...b(p),{role:"user",content:H}],!0),q(x,null),q(m,!0);let ee=[];try{const Z=await bp(),Ne=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i;let _e;Ne.test(H)||Z?(_e=await yp(H),Z&&(_e=(_e||"")+`

`+Z)):_e=await mp(),_e&&(ee=[{role:"system",content:_e}])}catch{}const U=b(p).filter(Z=>Z.type!=="dashboard").map(Z=>({role:Z.role,content:Z.content}));a.generate([...ee,...U]),he()}function Re(){a.interrupt()}function $(){a.reset(),q(p,[],!0),q(x,null),q(_,null),re=!1,G()}var ae=Pa(),le=ot(ae);{var V=H=>{var ee=Mh();K(H,ee)},ne=H=>{qp(H,{get gpuInfo(){return b(M)},get error(){return b(c)},onload:se,get selectedModel(){return b(i)},set selectedModel(ee){q(i,ee,!0)}})},de=H=>{Wp(H,{get message(){return b(d)},get items(){return b(v)}})},ye=H=>{Dh(H,{get messages(){return b(p)},get pendingData(){return b(S)},get hasScanData(){return b(F)},get engineReady(){return a.isReady},get isScanning(){return b(ie)},get isRunning(){return b(m)},get tps(){return b(x)},get numTokens(){return b(_)},get generationPhase(){return b(L)},get gpuInfo(){return b(M)},onsend:ue,onstop:Re,onreset:$,onmarkacted:te,ondismiss:Y,onremove:ve,oncleargroup:Oe,onscan:be,get chatContainer(){return b(k)},set chatContainer(ee){q(k,ee,!0)}})};Se(le,H=>{r?b(o)===null?H(ne,1):b(o)==="loading"?H(de,2):H(ye,!1):H(V)})}K(t,ae),dt()}const Ul="https://accounts.google.com/gsi/client",Nh="https://www.googleapis.com/auth/gmail.readonly";let ho=null,Qs=null;function jh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Ul}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Ul,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Gl(t){await jh(),ho=google.accounts.oauth2.initTokenClient({client_id:t,scope:Nh,callback:e=>{Qs&&(Qs(e),Qs=null)}})}function qh(){return new Promise((t,e)=>{if(!ho){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Qs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},ho.requestAccessToken()})}function Bh(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Pt="gmail",Hl=8,Ac=50,Cc=100;async function zh(t,{limit:e=Ac,onProgress:r=()=>{},signal:a}={}){var c;const i=await je.syncState.get(Pt);if(i!=null&&i.historyId)try{return await Wh(t,i,r,a)}catch(d){if(d instanceof jo&&(d.status===404||d.code==="notFound")||((c=d.message)==null?void 0:c.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await je.syncState.delete(Pt);else throw d}return await Gh(t,e===0?1/0:e,r,a)}async function Fh(t,{limit:e=Ac,onProgress:r=()=>{},signal:a}={}){const i=await je.syncState.get(Pt);return i!=null&&i.oldestPageToken?await Hh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Kh(){const t=await je.syncState.get(Pt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Uh(){await je.transaction("rw",[je.items,je.syncState],async()=>{await je.items.where("sourceType").equals(Pt).delete(),await je.syncState.delete(Pt)})}async function Gh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ra(a);const i=await pc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){ra(a);const x=e-o.length,_=await hc(t,{maxResults:Math.min(Cc,x),pageToken:c}),k=(_.messages||[]).map(M=>M.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=_.nextPageToken,!c||k.length===0)break}if(d=c||null,o.length===0)return await je.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:p}=await Ic(t,o,r,a),m=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:m,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:p}}async function Hh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ra(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){ra(i);const x=r-o.length,_=await hc(t,{maxResults:Math.min(Cc,x),pageToken:c}),k=(_.messages||[]).map(M=>M.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=_.nextPageToken,!c||k.length===0)break}if(d=c||null,o.length===0)return await je.syncState.update(Pt,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:p}=await Ic(t,o,a,i),m=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.update(Pt,{totalItems:m,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:m,total:m}),{added:v,errors:p}}async function Wh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ra(a);let i=0,o=0,c=0,d,v=e.historyId;do{ra(a);const m=await ap(t,{startHistoryId:e.historyId,pageToken:d});if(v=m.historyId||v,d=m.nextPageToken,!!m.history){for(const x of m.history){if(x.messagesAdded){const _=x.messagesAdded.map(M=>M.message.id),k=[...new Set(_.filter(M=>M))];if(k.length>0){const M=await Promise.allSettled(k.map(S=>vc(t,S))),L=[];for(const S of M)S.status==="fulfilled"?L.push(Rc(S.value)):c++;L.length>0&&(await je.items.bulkPut(L),await Pc(L),i+=L.length)}}if(x.messagesDeleted){const _=x.messagesDeleted.map(k=>cc(Pt,k.message.id)).filter(k=>k);_.length>0&&(await je.items.bulkDelete(_),o+=_.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await je.items.where("sourceType").equals(Pt).count();return await je.syncState.put({sourceType:Pt,historyId:v,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:c}}async function Ic(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Hl){ra(a);const d=e.slice(c,c+Hl),v=await Promise.allSettled(d.map(m=>vc(t,m))),p=[];for(const m of v)m.status==="fulfilled"?p.push(Rc(m.value)):o++;p.length>0&&(await je.items.bulkPut(p),await Pc(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Rc(t){const e=yr(t,"From"),r=yr(t,"To"),a=yr(t,"Cc"),i=yr(t,"Subject")||"(no subject)",o=yr(t,"Date"),c=yr(t,"Message-ID"),d=yr(t,"In-Reply-To"),v=yr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:cc(Pt,t.id),sourceType:Pt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:sp(t),htmlBody:ip(t),date:p,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Pc(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Yh(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await je.contacts.where("email").equals(r).first();if(o){const c={};a&&!o.name&&(c.name=a),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await je.contacts.update(o.id,c)}else await je.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Yh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ra(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Vh=W(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Xh(t,e){ft(e,!0);let r=Ce(e,"clientIdInput",15);Lt(()=>on("SetupGuide"));let a=Pe(null);async function i(U){try{await navigator.clipboard.writeText(U),q(a,U,!0),setTimeout(()=>{q(a,null)},1500)}catch{const Z=document.createElement("input");Z.value=U,document.body.appendChild(Z),Z.select(),document.execCommand("copy"),document.body.removeChild(Z),q(a,U,!0),setTimeout(()=>{q(a,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Vh(),p=w(v),m=A(w(p),4),x=A(w(m),6),_=A(w(x),2),k=A(w(_),2),M=A(w(k),2),L=w(M);L.__click=()=>i(o);var S=w(L);S.textContent="http://localhost:5173";var F=A(S,2),ie=w(F),re=A(L,2);re.__click=()=>i(c);var G=w(re);G.textContent="https://cypherkitty.github.io";var J=A(G,2),te=w(J),Y=A(k,2),ve=A(w(Y),2),Oe=w(ve);Oe.__click=()=>i(o);var be=w(Oe);be.textContent="http://localhost:5173";var he=A(be,2),se=w(he),ue=A(Oe,2);ue.__click=()=>i(c);var Re=w(ue);Re.textContent="https://cypherkitty.github.io";var $=A(Re,2),ae=w($),le=A(ue,2);le.__click=()=>i(d);var V=w(le);V.textContent="https://cypherkitty.github.io/me-ai/";var ne=A(V,2),de=w(ne),ye=A(m,2),H=w(ye);H.__keydown=U=>U.key==="Enter"&&e.onsave();var ee=A(H,2);ee.__click=function(...U){var Z;(Z=e.onsave)==null||Z.apply(this,U)},ge(U=>{oe(ie,b(a)===o?"â":"â§"),oe(te,b(a)===c?"â":"â§"),oe(se,b(a)===o?"â":"â§"),oe(ae,b(a)===c?"â":"â§"),oe(de,b(a)===d?"â":"â§"),ee.disabled=U},[()=>!r().trim()]),No(H,r),K(t,v),dt()}Mt(["click","keydown"]);function Qh(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof jo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Zh=W('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Jh=W('<div class="error-card-title svelte-14buhqq"> </div>'),$h=W('<p class="error-card-fix svelte-14buhqq"> </p>'),ev=W('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),tv=W('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),nv=W('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Oc(t,e){ft(e,!0);let r=Ce(e,"ondismiss",3,null),a=Ce(e,"onsignout",3,null),i=ct(()=>Qh(e.error));Lt(()=>on("ErrorCard"));var o=nv(),c=w(o);{var d=F=>{var ie=Zh(),re=w(ie),G=w(re),J=A(re,2);J.__click=function(...te){var Y;(Y=r())==null||Y.apply(this,te)},ge(()=>oe(G,b(i).title)),K(F,ie)},v=F=>{var ie=Jh(),re=w(ie);ge(()=>oe(re,b(i).title)),K(F,ie)};Se(c,F=>{r()?F(d):F(v,!1)})}var p=A(c,2),m=w(p),x=A(p,2);{var _=F=>{var ie=$h(),re=w(ie);ge(()=>oe(re,b(i).fix)),K(F,ie)};Se(x,F=>{b(i).fix&&F(_)})}var k=A(x,2);{var M=F=>{var ie=ev(),re=w(ie);ge(()=>{oc(ie,"href",b(i).link.url),oe(re,`${b(i).link.label??""} â`)}),K(F,ie)};Se(k,F=>{b(i).link&&F(M)})}var L=A(k,2);{var S=F=>{var ie=tv();ie.__click=function(...re){var G;(G=a())==null||G.apply(this,re)},K(F,ie)};Se(L,F=>{b(i).action==="signout"&&a()&&F(S)})}ge(()=>oe(m,b(i).description)),K(t,o),dt()}Mt(["click"]);var rv=W('<span class="spinner svelte-nyqevv"></span> Signing in...',1),av=Mo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),sv=W(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function iv(t,e){ft(e,!0);let r=Ce(e,"error",3,null),a=Ce(e,"loadingAuth",3,!1);Lt(()=>on("AuthCard"));var i=sv(),o=w(i),c=A(w(o),4);{var d=S=>{Oc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};Se(c,S=>{r()&&S(d)})}var v=A(c,2);v.__click=function(...S){var F;(F=e.onsignin)==null||F.apply(this,S)};var p=w(v);{var m=S=>{var F=rv();K(S,F)},x=S=>{var F=av();K(S,F)};Se(p,S=>{a()?S(m):S(x,!1)})}var _=A(v,2),k=A(w(_),2),M=w(k),L=A(k,2);L.__click=function(...S){var F;(F=e.onclear)==null||F.apply(this,S)},ge(S=>{v.disabled=a(),oe(M,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),K(t,i),dt()}Mt(["click"]);var ov=W('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),lv=W('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),uv=W('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function cv(t,e){ft(e,!0);let r=Ce(e,"profile",3,null),a=Ce(e,"loadingProfile",3,!1);Lt(()=>on("ProfileCard"));var i=uv(),o=w(i),c=w(o),d=A(o,2),v=w(d);{var p=_=>{var k=ov();K(_,k)},m=_=>{var k=lv(),M=ot(k),L=w(M),S=A(M,2),F=w(S);ge((ie,re)=>{oe(L,r().emailAddress),oe(F,`${ie??""} messages
        Â· ${re??""} threads`)},[()=>{var ie;return((ie=r().messagesTotal)==null?void 0:ie.toLocaleString())||"?"},()=>{var ie;return((ie=r().threadsTotal)==null?void 0:ie.toLocaleString())||"?"}]),K(_,k)};Se(v,_=>{a()?_(p):r()&&_(m,1)})}var x=A(d,2);x.__click=function(..._){var k;(k=e.onsignout)==null||k.apply(this,_)},ge(_=>oe(c,_),[()=>r()?gc(r().emailAddress):"?"]),K(t,i),dt()}Mt(["click"]);var fv=W('<span class="spinner svelte-1ds3j4k"></span>'),dv=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),pv=W('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),hv=W('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),vv=W('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),gv=W('<option class="svelte-1ds3j4k"> </option>'),mv=W('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),yv=W('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),bv=W('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),_v=W('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),wv=W('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),kv=W('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function xv(t,e){ft(e,!0),Lt(()=>on("SyncStatus"));let r=Ce(e,"syncStatus",3,null),a=Ce(e,"syncProgress",3,null),i=Ce(e,"isSyncing",3,!1),o=Pe(!1),c=Pe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(V){if(!V)return"never";const ne=Math.floor((Date.now()-V)/1e3);if(ne<60)return"just now";const de=Math.floor(ne/60);if(de<60)return`${de}m ago`;const ye=Math.floor(de/60);return ye<24?`${ye}h ago`:`${Math.floor(ye/24)}d ago`}function p(){var V,ne;return!((V=a())!=null&&V.total)||!((ne=a())!=null&&ne.current)?0:Math.round(a().current/a().total*100)}var m=kv(),x=w(m),_=w(x),k=w(_);{var M=V=>{var ne=fv();K(V,ne)},L=V=>{var ne=dv();K(V,ne)};Se(k,V=>{i()?V(M):V(L,!1)})}var S=A(_,2),F=A(w(S),2);{var ie=V=>{var ne=pv(),de=w(ne),ye=A(de);{var H=U=>{var Z=Ml("Â· more available");K(U,Z)},ee=U=>{var Z=Ml("Â· all synced");K(U,Z)};Se(ye,U=>{r().hasMore?U(H):U(ee,!1)})}ge((U,Z)=>oe(de,`${U??""} emails stored
          Â· synced ${Z??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),K(V,ne)},re=V=>{var ne=hv();K(V,ne)};Se(F,V=>{var ne;(ne=r())!=null&&ne.synced?V(ie):V(re,!1)})}var G=A(S,2),J=w(G);{var te=V=>{var ne=vv();ne.__click=()=>q(o,!b(o)),K(V,ne)};Se(J,V=>{var ne;(ne=r())!=null&&ne.synced&&!i()&&V(te)})}var Y=A(x,2),ve=w(Y),Oe=A(w(ve),2);sn(Oe,21,()=>d,Er,(V,ne)=>{var de=gv(),ye=w(de),H={};ge(()=>{oe(ye,b(ne).label),H!==(H=b(ne).value)&&(de.value=(de.__value=b(ne).value)??"")}),K(V,de)});var be=A(ve,2),he=w(be);{var se=V=>{var ne=yv(),de=ot(ne);de.__click=()=>e.onsync(b(c));var ye=w(de),H=A(de,2);{var ee=U=>{var Z=mv();Z.__click=()=>e.onsyncmore(b(c));var Ne=w(Z);ge(()=>{Z.disabled=i(),oe(Ne,i()?"Loading...":"Sync More")}),K(U,Z)};Se(H,U=>{r().hasMore&&U(ee)})}ge(()=>{de.disabled=i(),oe(ye,i()?"Syncing...":"Sync New")}),K(V,ne)},ue=V=>{var ne=bv();ne.__click=()=>e.onsync(b(c));var de=w(ne);ge(()=>{ne.disabled=i(),oe(de,i()?"Syncing...":"Download Emails")}),K(V,ne)};Se(he,V=>{var ne;(ne=r())!=null&&ne.synced?V(se):V(ue,!1)})}var Re=A(Y,2);{var $=V=>{var ne=_v(),de=w(ne),ye=w(de);let H,ee;var U=A(de,2),Z=w(U);ge(Ne=>{H=Bt(ye,1,"progress-fill svelte-1ds3j4k",null,H,{indeterminate:!a().total}),ee=Zt(ye,"",ee,Ne),oe(Z,a().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),K(V,ne)};Se(Re,V=>{i()&&a()&&V($)})}var ae=A(Re,2);{var le=V=>{var ne=wv(),de=A(w(ne),2),ye=w(de);ye.__click=()=>q(o,!1);var H=A(ye,2);H.__click=()=>{e.onclear(),q(o,!1)},K(V,ne)};Se(ae,V=>{b(o)&&V(le)})}ge(()=>Oe.disabled=i()),Lo(Oe,()=>b(c),V=>q(c,V)),K(t,m),dt()}Mt(["click"]);var Sv=W('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Tv=W('<div class="message-list svelte-y2uamw"></div>');function Ev(t,e){ft(e,!0);let r=Ce(e,"messages",19,()=>[]);Lt(()=>on("MessageList"));var a=Tv();sn(a,21,r,Er,(i,o)=>{var c=Sv();c.__click=()=>e.onselect(b(o));var d=w(c),v=w(d),p=A(d,2),m=w(p),x=w(m),_=w(x),k=A(x,2),M=w(k),L=A(m,2),S=w(L),F=A(L,2),ie=w(F);ge((re,G,J)=>{oe(v,re),oe(_,G),oe(M,J),oe(S,b(o).subject),oe(ie,b(o).snippet)},[()=>gc(b(o).from),()=>Bo(b(o).from),()=>qo(b(o).date)]),K(i,c)}),K(t,a),dt()}Mt(["click"]);function zo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ia=zo();function Dc(t){ia=t}var Fr={exec:()=>null};function Qe(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Kt.caret,"$1"),r=r.replace(i,c),a},getRegex:()=>new RegExp(r,e)};return a}var Av=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Kt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Cv=/^(?:[ \t]*(?:\n|$))+/,Iv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Rv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ms=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Pv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Fo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Mc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Lc=Qe(Mc).replace(/bull/g,Fo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ov=Qe(Mc).replace(/bull/g,Fo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ko=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Dv=/^[^\n]+/,Uo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Mv=Qe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Uo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Lv=Qe(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Fo).getRegex(),di="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Go=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Nv=Qe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Go).replace("tag",di).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Nc=Qe(Ko).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),jv=Qe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Nc).getRegex(),Ho={blockquote:jv,code:Iv,def:Mv,fences:Rv,heading:Pv,hr:ms,html:Nv,lheading:Lc,list:Lv,newline:Cv,paragraph:Nc,table:Fr,text:Dv},Wl=Qe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),qv={...Ho,lheading:Ov,table:Wl,paragraph:Qe(Ko).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex()},Bv={...Ho,html:Qe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Go).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Fr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Qe(Ko).replace("hr",ms).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Lc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},zv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Fv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,jc=/^( {2,}|\\)\n(?!\s*$)/,Kv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pi=/[\p{P}\p{S}]/u,Wo=/[\s\p{P}\p{S}]/u,qc=/[^\s\p{P}\p{S}]/u,Uv=Qe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Wo).getRegex(),Bc=/(?!~)[\p{P}\p{S}]/u,Gv=/(?!~)[\s\p{P}\p{S}]/u,Hv=/(?:[^\s\p{P}\p{S}]|~)/u,zc=/(?![*_])[\p{P}\p{S}]/u,Wv=/(?![*_])[\s\p{P}\p{S}]/u,Yv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Vv=Qe(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Av?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Fc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Xv=Qe(Fc,"u").replace(/punct/g,pi).getRegex(),Qv=Qe(Fc,"u").replace(/punct/g,Bc).getRegex(),Kc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Zv=Qe(Kc,"gu").replace(/notPunctSpace/g,qc).replace(/punctSpace/g,Wo).replace(/punct/g,pi).getRegex(),Jv=Qe(Kc,"gu").replace(/notPunctSpace/g,Hv).replace(/punctSpace/g,Gv).replace(/punct/g,Bc).getRegex(),$v=Qe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,qc).replace(/punctSpace/g,Wo).replace(/punct/g,pi).getRegex(),eg=Qe(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,zc).getRegex(),tg="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",ng=Qe(tg,"gu").replace(/notPunctSpace/g,Yv).replace(/punctSpace/g,Wv).replace(/punct/g,zc).getRegex(),rg=Qe(/\\(punct)/,"gu").replace(/punct/g,pi).getRegex(),ag=Qe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sg=Qe(Go).replace("(?:-->|$)","-->").getRegex(),ig=Qe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sg).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,og=Qe(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Uc=Qe(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",Uo).getRegex(),Gc=Qe(/^!?\[(ref)\](?:\[\])?/).replace("ref",Uo).getRegex(),lg=Qe("reflink|nolink(?!\\()","g").replace("reflink",Uc).replace("nolink",Gc).getRegex(),Yl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Yo={_backpedal:Fr,anyPunctuation:rg,autolink:ag,blockSkip:Vv,br:jc,code:Fv,del:Fr,delLDelim:Fr,delRDelim:Fr,emStrongLDelim:Xv,emStrongRDelimAst:Zv,emStrongRDelimUnd:$v,escape:zv,link:og,nolink:Gc,punctuation:Uv,reflink:Uc,reflinkSearch:lg,tag:ig,text:Kv,url:Fr},ug={...Yo,link:Qe(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:Qe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},vo={...Yo,emStrongRDelimAst:Jv,emStrongLDelim:Qv,delLDelim:eg,delRDelim:ng,url:Qe(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Yl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Qe(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Yl).getRegex()},cg={...vo,br:Qe(jc).replace("{2,}","*").getRegex(),text:Qe(vo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Fs={normal:Ho,gfm:qv,pedantic:Bv},Ya={normal:Yo,gfm:vo,breaks:cg,pedantic:ug},fg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vl=t=>fg[t];function Qn(t,e){if(e){if(Kt.escapeTest.test(t))return t.replace(Kt.escapeReplace,Vl)}else if(Kt.escapeTestNoEncode.test(t))return t.replace(Kt.escapeReplaceNoEncode,Vl);return t}function Xl(t){try{t=encodeURI(t).replace(Kt.percentDecode,"%")}catch{return null}return t}function Ql(t,e){var o;let r=t.replace(Kt.findPipe,(c,d,v)=>{let p=!1,m=d;for(;--m>=0&&v[m]==="\\";)p=!p;return p?"|":" |"}),a=r.split(Kt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Kt.slashPipe,"|");return a}function Va(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function dg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function pg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function Zl(t,e,r,a,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function hg(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ri=class{constructor(t){He(this,"options");He(this,"rules");He(this,"lexer");this.options=t||ia}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Va(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=hg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Va(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Va(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Va(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let p=d.join(`
`),m=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,i=i?`${i}
${m}`:m;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(m,o,!0),this.lexer.state.top=x,r.length===0)break;let _=o.at(-1);if((_==null?void 0:_.type)==="code")break;if((_==null?void 0:_.type)==="blockquote"){let k=_,M=k.raw+`
`+r.join(`
`),L=this.blockquote(M);o[o.length-1]=L,a=a.substring(0,a.length-k.raw.length)+L.raw,i=i.substring(0,i.length-k.text.length)+L.text;break}else if((_==null?void 0:_.type)==="list"){let k=_,M=k.raw+`
`+r.join(`
`),L=this.list(M);o[o.length-1]=L,a=a.substring(0,a.length-_.raw.length)+L.raw,i=i.substring(0,i.length-k.raw.length)+L.raw,r=M.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let m=!1,x="",_="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let k=pg(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],L=!k.trim(),S=0;if(this.options.pedantic?(S=2,_=k.trimStart()):L?S=e[1].length+1:(S=k.search(this.rules.other.nonSpaceChar),S=S>4?1:S,_=k.slice(S),S+=e[1].length),L&&this.rules.other.blankLine.test(M)&&(x+=M+`
`,t=t.substring(M.length+1),m=!0),!m){let F=this.rules.other.nextBulletRegex(S),ie=this.rules.other.hrRegex(S),re=this.rules.other.fencesBeginRegex(S),G=this.rules.other.headingBeginRegex(S),J=this.rules.other.htmlBeginRegex(S),te=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Y=t.split(`
`,1)[0],ve;if(M=Y,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),ve=M):ve=M.replace(this.rules.other.tabCharGlobal,"    "),re.test(M)||G.test(M)||J.test(M)||te.test(M)||F.test(M)||ie.test(M))break;if(ve.search(this.rules.other.nonSpaceChar)>=S||!M.trim())_+=`
`+ve.slice(S);else{if(L||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||re.test(k)||G.test(k)||ie.test(k))break;_+=`
`+M}L=!M.trim(),x+=Y+`
`,t=t.substring(Y.length+1),k=ve.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(v=!0)),c.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(_),loose:!1,text:_,tokens:[]}),c.raw+=x}let p=c.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let m of c.items){if(this.lexer.state.top=!1,m.tokens=this.lexer.blockTokens(m.text,[]),m.task){if(m.text=m.text.replace(this.rules.other.listReplaceTask,""),((r=m.tokens[0])==null?void 0:r.type)==="text"||((a=m.tokens[0])==null?void 0:a.type)==="paragraph"){m.tokens[0].raw=m.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),m.tokens[0].text=m.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let _=this.lexer.inlineQueue.length-1;_>=0;_--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[_].src)){this.lexer.inlineQueue[_].src=this.lexer.inlineQueue[_].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(m.raw);if(x){let _={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};m.checked=_.checked,c.loose?m.tokens[0]&&["paragraph","text"].includes(m.tokens[0].type)&&"tokens"in m.tokens[0]&&m.tokens[0].tokens?(m.tokens[0].raw=_.raw+m.tokens[0].raw,m.tokens[0].text=_.raw+m.tokens[0].text,m.tokens[0].tokens.unshift(_)):m.tokens.unshift({type:"paragraph",raw:_.raw,text:_.raw,tokens:[_]}):m.tokens.unshift(_)}}if(!c.loose){let x=m.tokens.filter(k=>k.type==="space"),_=x.length>0&&x.some(k=>this.rules.other.anyLine.test(k.raw));c.loose=_}}if(c.loose)for(let m of c.items){m.loose=!0;for(let x of m.tokens)x.type==="text"&&(x.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Ql(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Ql(d,o.header.length).map((v,p)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Va(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=dg(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Zl(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Zl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(a=p.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(c=[...o].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let m=[...a[0]][0].length,x=t.slice(0,i+a.index+m+c);if(Math.min(i,c)%2){let k=x.slice(1,-1);return{type:"em",raw:x,text:k,tokens:this.lexer.inlineTokens(k)}}let _=x.slice(2,-2);return{type:"strong",raw:x,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(c=[...o].length,c!==i))continue;if(a[3]||a[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let p=[...a[0]][0].length,m=t.slice(0,i+a.index+p+c),x=m.slice(i,-i);return{type:"del",raw:m,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},An=class go{constructor(e){He(this,"tokens");He(this,"options");He(this,"state");He(this,"inlineQueue");He(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ia,this.options.tokenizer=this.options.tokenizer||new ri,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Kt,block:Fs.normal,inline:Ya.normal};this.options.pedantic?(r.block=Fs.pedantic,r.inline=Ya.pedantic):this.options.gfm&&(r.block=Fs.gfm,this.options.breaks?r.inline=Ya.breaks:r.inline=Ya.gfm),this.tokenizer.rules=r}static get rules(){return{block:Fs,inline:Ya}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace(Kt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Kt.tabCharGlobal,"    ").replace(Kt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let p=1/0,m=e.slice(1),x;this.options.extensions.startBlock.forEach(_=>{x=_.call({lexer:this},m),typeof x=="number"&&x>=0&&(p=Math.min(p,x))}),p<1/0&&p>=0&&(v=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let p=r.at(-1);a&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,p,m,x,_;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((p=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:p.call({lexer:this},a))??a;let c=!1,d="";for(;e;){c||(d=""),c=!1;let k;if((x=(m=this.options.extensions)==null?void 0:m.inline)!=null&&x.some(L=>(k=L.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let L=r.at(-1);k.type==="text"&&(L==null?void 0:L.type)==="text"?(L.raw+=k.raw,L.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let M=e;if((_=this.options.extensions)!=null&&_.startInline){let L=1/0,S=e.slice(1),F;this.options.extensions.startInline.forEach(ie=>{F=ie.call({lexer:this},S),typeof F=="number"&&F>=0&&(L=Math.min(L,F))}),L<1/0&&L>=0&&(M=e.substring(0,L+1))}if(k=this.tokenizer.inlineText(M)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(d=k.raw.slice(-1)),c=!0;let L=r.at(-1);(L==null?void 0:L.type)==="text"?(L.raw+=k.raw,L.text+=k.text):r.push(k);continue}if(e){let L="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(L);break}else throw new Error(L)}}return r}},ai=class{constructor(t){He(this,"options");He(this,"parser");this.options=t||ia}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Kt.notSpaceStart))==null?void 0:o[0],i=t.replace(Kt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Qn(a)+'">'+(r?i:Qn(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Qn(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let c=0;c<t.items.length;c++){let d=t.items[c];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Qn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Xl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Qn(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Xl(t);if(i===null)return Qn(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Qn(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Qn(t.text)}},Vo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Cn=class mo{constructor(e){He(this,"options");He(this,"renderer");He(this,"textRenderer");this.options=e||ia,this.options.renderer=this.options.renderer||new ai,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Vo}static parse(e,r){return new mo(r).parse(e)}static parseInline(e,r){return new mo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[c.type]){let v=c,p=this.options.extensions.renderers[v.type].call({parser:this},v);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=p||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=p||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let p='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return a}},Gs,ts=(Gs=class{constructor(t){He(this,"options");He(this,"block");this.options=t||ia}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?An.lex:An.lexInline}provideParser(){return this.block?Cn.parse:Cn.parseInline}},He(Gs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),He(Gs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Gs),vg=class{constructor(...t){He(this,"defaults",zo());He(this,"options",this.setOptions);He(this,"parse",this.parseMarkdown(!0));He(this,"parseInline",this.parseMarkdown(!1));He(this,"Parser",Cn);He(this,"Renderer",ai);He(this,"TextRenderer",Vo);He(this,"Lexer",An);He(this,"Tokenizer",ri);He(this,"Hooks",ts);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ai(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...p)=>{let m=d.apply(i,p);return m===!1&&(m=v.apply(i,p)),m||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ri(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...p)=>{let m=d.apply(i,p);return m===!1&&(m=v.apply(i,p)),m}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ts;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];ts.passThroughHooks.has(o)?i[c]=p=>{if(this.defaults.async&&ts.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,p);return v.call(i,x)})();let m=d.call(i,p);return v.call(i,m)}:i[c]=(...p)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,p);return x===!1&&(x=await v.apply(i,p)),x})();let m=d.apply(i,p);return m===!1&&(m=v.apply(i,p)),m}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return An.lex(t,e??this.defaults)}parser(t,e){return Cn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?An.lex:An.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?Cn.parse:Cn.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?An.lex:An.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Cn.parse:Cn.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Qn(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},aa=new vg;function et(t,e){return aa.parse(t,e)}et.options=et.setOptions=function(t){return aa.setOptions(t),et.defaults=aa.defaults,Dc(et.defaults),et};et.getDefaults=zo;et.defaults=ia;et.use=function(...t){return aa.use(...t),et.defaults=aa.defaults,Dc(et.defaults),et};et.walkTokens=function(t,e){return aa.walkTokens(t,e)};et.parseInline=aa.parseInline;et.Parser=Cn;et.parser=Cn.parse;et.Renderer=ai;et.TextRenderer=Vo;et.Lexer=An;et.lexer=An.lex;et.Tokenizer=ri;et.Hooks=ts;et.parse=et;et.options;et.setOptions;et.use;et.walkTokens;et.parseInline;Cn.parse;An.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Hc,setPrototypeOf:Jl,isFrozen:gg,getPrototypeOf:mg,getOwnPropertyDescriptor:yg}=Object;let{freeze:Ut,seal:yn,create:yo}=Object,{apply:bo,construct:_o}=typeof Reflect<"u"&&Reflect;Ut||(Ut=function(e){return e});yn||(yn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});_o||(_o=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ks=Gt(Array.prototype.forEach),bg=Gt(Array.prototype.lastIndexOf),$l=Gt(Array.prototype.pop),Xa=Gt(Array.prototype.push),_g=Gt(Array.prototype.splice),Zs=Gt(String.prototype.toLowerCase),Hi=Gt(String.prototype.toString),Wi=Gt(String.prototype.match),Qa=Gt(String.prototype.replace),wg=Gt(String.prototype.indexOf),kg=Gt(String.prototype.trim),Tn=Gt(Object.prototype.hasOwnProperty),Ft=Gt(RegExp.prototype.test),Za=xg(TypeError);function Gt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function xg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return _o(t,r)}}function Ue(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs;Jl&&Jl(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(gg(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Sg(t){for(let e=0;e<t.length;e++)Tn(t,e)||(t[e]=null);return t}function jn(t){const e=yo(null);for(const[r,a]of Hc(t))Tn(t,r)&&(Array.isArray(a)?e[r]=Sg(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=jn(a):e[r]=a);return e}function Ja(t,e){for(;t!==null;){const a=yg(t,e);if(a){if(a.get)return Gt(a.get);if(typeof a.value=="function")return Gt(a.value)}t=mg(t)}function r(){return null}return r}const eu=Ut(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yi=Ut(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Vi=Ut(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Tg=Ut(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xi=Ut(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Eg=Ut(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tu=Ut(["#text"]),nu=Ut(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Qi=Ut(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ru=Ut(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Us=Ut(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ag=yn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Cg=yn(/<%[\w\W]*|[\w\W]*%>/gm),Ig=yn(/\$\{[\w\W]*/gm),Rg=yn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Pg=yn(/^aria-[\-\w]+$/),Wc=yn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Og=yn(/^(?:\w+script|data):/i),Dg=yn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yc=yn(/^html$/i),Mg=yn(/^[a-z][.\w]*(-[.\w]+)+$/i);var au=Object.freeze({__proto__:null,ARIA_ATTR:Pg,ATTR_WHITESPACE:Dg,CUSTOM_ELEMENT:Mg,DATA_ATTR:Rg,DOCTYPE_NAME:Yc,ERB_EXPR:Cg,IS_ALLOWED_URI:Wc,IS_SCRIPT_OR_DATA:Og,MUSTACHE_EXPR:Ag,TMPLIT_EXPR:Ig});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},Lg=function(){return typeof window>"u"?null:window},Ng=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},su=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Vc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lg();const e=Le=>Vc(Le);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:p,NamedNodeMap:m=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:_,trustedTypes:k}=t,M=v.prototype,L=Ja(M,"cloneNode"),S=Ja(M,"remove"),F=Ja(M,"nextSibling"),ie=Ja(M,"childNodes"),re=Ja(M,"parentNode");if(typeof c=="function"){const Le=r.createElement("template");Le.content&&Le.content.ownerDocument&&(r=Le.content.ownerDocument)}let G,J="";const{implementation:te,createNodeIterator:Y,createDocumentFragment:ve,getElementsByTagName:Oe}=r,{importNode:be}=a;let he=su();e.isSupported=typeof Hc=="function"&&typeof re=="function"&&te&&te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:se,ERB_EXPR:ue,TMPLIT_EXPR:Re,DATA_ATTR:$,ARIA_ATTR:ae,IS_SCRIPT_OR_DATA:le,ATTR_WHITESPACE:V,CUSTOM_ELEMENT:ne}=au;let{IS_ALLOWED_URI:de}=au,ye=null;const H=Ue({},[...eu,...Yi,...Vi,...Xi,...tu]);let ee=null;const U=Ue({},[...nu,...Qi,...ru,...Us]);let Z=Object.seal(yo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,_e=null;const Ge=Object.seal(yo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let nt=!0,Ee=!0,lt=!1,ze=!0,rt=!1,Gn=!0,At=!1,Ar=!1,Oa=!1,ir=!1,oa=!1,or=!1,Jt=!0,Da=!1;const Cr="user-content-";let la=!0,bn=!1,_t={},kt=null;const Ir=Ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let lr=null;const ua=Ue({},["audio","video","img","source","image","track"]);let ur=null;const Dn=Ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Hn="http://www.w3.org/1998/Math/MathML",cr="http://www.w3.org/2000/svg",xt="http://www.w3.org/1999/xhtml";let Me=xt,Wn=!1,_n=null;const ca=Ue({},[Hn,cr,xt],Hi);let Te=Ue({},["mi","mo","mn","ms","mtext"]),fr=Ue({},["annotation-xml"]);const ys=Ue({},["title","style","font","a","script"]);let Yn=null;const bs=["application/xhtml+xml","text/html"],Ma="text/html";let gt=null,dr=null;const pr=r.createElement("form"),Vn=function(E){return E instanceof RegExp||E instanceof Function},Rr=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(dr&&dr===E)){if((!E||typeof E!="object")&&(E={}),E=jn(E),Yn=bs.indexOf(E.PARSER_MEDIA_TYPE)===-1?Ma:E.PARSER_MEDIA_TYPE,gt=Yn==="application/xhtml+xml"?Hi:Zs,ye=Tn(E,"ALLOWED_TAGS")?Ue({},E.ALLOWED_TAGS,gt):H,ee=Tn(E,"ALLOWED_ATTR")?Ue({},E.ALLOWED_ATTR,gt):U,_n=Tn(E,"ALLOWED_NAMESPACES")?Ue({},E.ALLOWED_NAMESPACES,Hi):ca,ur=Tn(E,"ADD_URI_SAFE_ATTR")?Ue(jn(Dn),E.ADD_URI_SAFE_ATTR,gt):Dn,lr=Tn(E,"ADD_DATA_URI_TAGS")?Ue(jn(ua),E.ADD_DATA_URI_TAGS,gt):ua,kt=Tn(E,"FORBID_CONTENTS")?Ue({},E.FORBID_CONTENTS,gt):Ir,Ne=Tn(E,"FORBID_TAGS")?Ue({},E.FORBID_TAGS,gt):jn({}),_e=Tn(E,"FORBID_ATTR")?Ue({},E.FORBID_ATTR,gt):jn({}),_t=Tn(E,"USE_PROFILES")?E.USE_PROFILES:!1,nt=E.ALLOW_ARIA_ATTR!==!1,Ee=E.ALLOW_DATA_ATTR!==!1,lt=E.ALLOW_UNKNOWN_PROTOCOLS||!1,ze=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,rt=E.SAFE_FOR_TEMPLATES||!1,Gn=E.SAFE_FOR_XML!==!1,At=E.WHOLE_DOCUMENT||!1,ir=E.RETURN_DOM||!1,oa=E.RETURN_DOM_FRAGMENT||!1,or=E.RETURN_TRUSTED_TYPE||!1,Oa=E.FORCE_BODY||!1,Jt=E.SANITIZE_DOM!==!1,Da=E.SANITIZE_NAMED_PROPS||!1,la=E.KEEP_CONTENT!==!1,bn=E.IN_PLACE||!1,de=E.ALLOWED_URI_REGEXP||Wc,Me=E.NAMESPACE||xt,Te=E.MATHML_TEXT_INTEGRATION_POINTS||Te,fr=E.HTML_INTEGRATION_POINTS||fr,Z=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&Vn(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Z.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&Vn(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Z.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Z.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),rt&&(Ee=!1),oa&&(ir=!0),_t&&(ye=Ue({},tu),ee=[],_t.html===!0&&(Ue(ye,eu),Ue(ee,nu)),_t.svg===!0&&(Ue(ye,Yi),Ue(ee,Qi),Ue(ee,Us)),_t.svgFilters===!0&&(Ue(ye,Vi),Ue(ee,Qi),Ue(ee,Us)),_t.mathMl===!0&&(Ue(ye,Xi),Ue(ee,ru),Ue(ee,Us))),E.ADD_TAGS&&(typeof E.ADD_TAGS=="function"?Ge.tagCheck=E.ADD_TAGS:(ye===H&&(ye=jn(ye)),Ue(ye,E.ADD_TAGS,gt))),E.ADD_ATTR&&(typeof E.ADD_ATTR=="function"?Ge.attributeCheck=E.ADD_ATTR:(ee===U&&(ee=jn(ee)),Ue(ee,E.ADD_ATTR,gt))),E.ADD_URI_SAFE_ATTR&&Ue(ur,E.ADD_URI_SAFE_ATTR,gt),E.FORBID_CONTENTS&&(kt===Ir&&(kt=jn(kt)),Ue(kt,E.FORBID_CONTENTS,gt)),E.ADD_FORBID_CONTENTS&&(kt===Ir&&(kt=jn(kt)),Ue(kt,E.ADD_FORBID_CONTENTS,gt)),la&&(ye["#text"]=!0),At&&Ue(ye,["html","head","body"]),ye.table&&(Ue(ye,["tbody"]),delete Ne.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');G=E.TRUSTED_TYPES_POLICY,J=G.createHTML("")}else G===void 0&&(G=Ng(k,i)),G!==null&&typeof J=="string"&&(J=G.createHTML(""));Ut&&Ut(E),dr=E}},Pr=Ue({},[...Yi,...Vi,...Tg]),at=Ue({},[...Xi,...Eg]),wt=function(E){let pe=re(E);(!pe||!pe.tagName)&&(pe={namespaceURI:Me,tagName:"template"});const we=Zs(E.tagName),Ze=Zs(pe.tagName);return _n[E.namespaceURI]?E.namespaceURI===cr?pe.namespaceURI===xt?we==="svg":pe.namespaceURI===Hn?we==="svg"&&(Ze==="annotation-xml"||Te[Ze]):!!Pr[we]:E.namespaceURI===Hn?pe.namespaceURI===xt?we==="math":pe.namespaceURI===cr?we==="math"&&fr[Ze]:!!at[we]:E.namespaceURI===xt?pe.namespaceURI===cr&&!fr[Ze]||pe.namespaceURI===Hn&&!Te[Ze]?!1:!at[we]&&(ys[we]||!Pr[we]):!!(Yn==="application/xhtml+xml"&&_n[E.namespaceURI]):!1},ln=function(E){Xa(e.removed,{element:E});try{re(E).removeChild(E)}catch{S(E)}},un=function(E,pe){try{Xa(e.removed,{attribute:pe.getAttributeNode(E),from:pe})}catch{Xa(e.removed,{attribute:null,from:pe})}if(pe.removeAttribute(E),E==="is")if(ir||oa)try{ln(pe)}catch{}else try{pe.setAttribute(E,"")}catch{}},Or=function(E){let pe=null,we=null;if(Oa)E="<remove></remove>"+E;else{const pt=Wi(E,/^[\r\n\t ]+/);we=pt&&pt[0]}Yn==="application/xhtml+xml"&&Me===xt&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Ze=G?G.createHTML(E):E;if(Me===xt)try{pe=new _().parseFromString(Ze,Yn)}catch{}if(!pe||!pe.documentElement){pe=te.createDocument(Me,"template",null);try{pe.documentElement.innerHTML=Wn?J:Ze}catch{}}const st=pe.body||pe.documentElement;return E&&we&&st.insertBefore(r.createTextNode(we),st.childNodes[0]||null),Me===xt?Oe.call(pe,At?"html":"body")[0]:At?pe.documentElement:st},Dr=function(E){return Y.call(E.ownerDocument||E,E,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},La=function(E){return E instanceof x&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof m)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},wn=function(E){return typeof d=="function"&&E instanceof d};function Nt(Le,E,pe){Ks(Le,we=>{we.call(e,E,pe,dr)})}const kn=function(E){let pe=null;if(Nt(he.beforeSanitizeElements,E,null),La(E))return ln(E),!0;const we=gt(E.nodeName);if(Nt(he.uponSanitizeElement,E,{tagName:we,allowedTags:ye}),Gn&&E.hasChildNodes()&&!wn(E.firstElementChild)&&Ft(/<[/\w!]/g,E.innerHTML)&&Ft(/<[/\w!]/g,E.textContent)||E.nodeType===$a.progressingInstruction||Gn&&E.nodeType===$a.comment&&Ft(/<[/\w]/g,E.data))return ln(E),!0;if(!(Ge.tagCheck instanceof Function&&Ge.tagCheck(we))&&(!ye[we]||Ne[we])){if(!Ne[we]&&_s(we)&&(Z.tagNameCheck instanceof RegExp&&Ft(Z.tagNameCheck,we)||Z.tagNameCheck instanceof Function&&Z.tagNameCheck(we)))return!1;if(la&&!kt[we]){const Ze=re(E)||E.parentNode,st=ie(E)||E.childNodes;if(st&&Ze){const pt=st.length;for(let mt=pt-1;mt>=0;--mt){const Ht=L(st[mt],!0);Ht.__removalCount=(E.__removalCount||0)+1,Ze.insertBefore(Ht,F(E))}}}return ln(E),!0}return E instanceof v&&!wt(E)||(we==="noscript"||we==="noembed"||we==="noframes")&&Ft(/<\/no(script|embed|frames)/i,E.innerHTML)?(ln(E),!0):(rt&&E.nodeType===$a.text&&(pe=E.textContent,Ks([se,ue,Re],Ze=>{pe=Qa(pe,Ze," ")}),E.textContent!==pe&&(Xa(e.removed,{element:E.cloneNode()}),E.textContent=pe)),Nt(he.afterSanitizeElements,E,null),!1)},Mr=function(E,pe,we){if(Jt&&(pe==="id"||pe==="name")&&(we in r||we in pr))return!1;if(!(Ee&&!_e[pe]&&Ft($,pe))){if(!(nt&&Ft(ae,pe))){if(!(Ge.attributeCheck instanceof Function&&Ge.attributeCheck(pe,E))){if(!ee[pe]||_e[pe]){if(!(_s(E)&&(Z.tagNameCheck instanceof RegExp&&Ft(Z.tagNameCheck,E)||Z.tagNameCheck instanceof Function&&Z.tagNameCheck(E))&&(Z.attributeNameCheck instanceof RegExp&&Ft(Z.attributeNameCheck,pe)||Z.attributeNameCheck instanceof Function&&Z.attributeNameCheck(pe,E))||pe==="is"&&Z.allowCustomizedBuiltInElements&&(Z.tagNameCheck instanceof RegExp&&Ft(Z.tagNameCheck,we)||Z.tagNameCheck instanceof Function&&Z.tagNameCheck(we))))return!1}else if(!ur[pe]){if(!Ft(de,Qa(we,V,""))){if(!((pe==="src"||pe==="xlink:href"||pe==="href")&&E!=="script"&&wg(we,"data:")===0&&lr[E])){if(!(lt&&!Ft(le,Qa(we,V,"")))){if(we)return!1}}}}}}}return!0},_s=function(E){return E!=="annotation-xml"&&Wi(E,ne)},xn=function(E){Nt(he.beforeSanitizeAttributes,E,null);const{attributes:pe}=E;if(!pe||La(E))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ee,forceKeepAttr:void 0};let Ze=pe.length;for(;Ze--;){const st=pe[Ze],{name:pt,namespaceURI:mt,value:Ht}=st,Mn=gt(pt),Lr=Ht;let ut=pt==="value"?Lr:kg(Lr);if(we.attrName=Mn,we.attrValue=ut,we.keepAttr=!0,we.forceKeepAttr=void 0,Nt(he.uponSanitizeAttribute,E,we),ut=we.attrValue,Da&&(Mn==="id"||Mn==="name")&&(un(pt,E),ut=Cr+ut),Gn&&Ft(/((--!?|])>)|<\/(style|title|textarea)/i,ut)){un(pt,E);continue}if(Mn==="attributename"&&Wi(ut,"href")){un(pt,E);continue}if(we.forceKeepAttr)continue;if(!we.keepAttr){un(pt,E);continue}if(!ze&&Ft(/\/>/i,ut)){un(pt,E);continue}rt&&Ks([se,ue,Re],Nr=>{ut=Qa(ut,Nr," ")});const Na=gt(E.nodeName);if(!Mr(Na,Mn,ut)){un(pt,E);continue}if(G&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!mt)switch(k.getAttributeType(Na,Mn)){case"TrustedHTML":{ut=G.createHTML(ut);break}case"TrustedScriptURL":{ut=G.createScriptURL(ut);break}}if(ut!==Lr)try{mt?E.setAttributeNS(mt,pt,ut):E.setAttribute(pt,ut),La(E)?ln(E):$l(e.removed)}catch{un(pt,E)}}Nt(he.afterSanitizeAttributes,E,null)},ws=function Le(E){let pe=null;const we=Dr(E);for(Nt(he.beforeSanitizeShadowDOM,E,null);pe=we.nextNode();)Nt(he.uponSanitizeShadowNode,pe,null),kn(pe),xn(pe),pe.content instanceof o&&Le(pe.content);Nt(he.afterSanitizeShadowDOM,E,null)};return e.sanitize=function(Le){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},pe=null,we=null,Ze=null,st=null;if(Wn=!Le,Wn&&(Le="<!-->"),typeof Le!="string"&&!wn(Le))if(typeof Le.toString=="function"){if(Le=Le.toString(),typeof Le!="string")throw Za("dirty is not a string, aborting")}else throw Za("toString is not a function");if(!e.isSupported)return Le;if(Ar||Rr(E),e.removed=[],typeof Le=="string"&&(bn=!1),bn){if(Le.nodeName){const Ht=gt(Le.nodeName);if(!ye[Ht]||Ne[Ht])throw Za("root node is forbidden and cannot be sanitized in-place")}}else if(Le instanceof d)pe=Or("<!---->"),we=pe.ownerDocument.importNode(Le,!0),we.nodeType===$a.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?pe=we:pe.appendChild(we);else{if(!ir&&!rt&&!At&&Le.indexOf("<")===-1)return G&&or?G.createHTML(Le):Le;if(pe=Or(Le),!pe)return ir?null:or?J:""}pe&&Oa&&ln(pe.firstChild);const pt=Dr(bn?Le:pe);for(;Ze=pt.nextNode();)kn(Ze),xn(Ze),Ze.content instanceof o&&ws(Ze.content);if(bn)return Le;if(ir){if(oa)for(st=ve.call(pe.ownerDocument);pe.firstChild;)st.appendChild(pe.firstChild);else st=pe;return(ee.shadowroot||ee.shadowrootmode)&&(st=be.call(a,st,!0)),st}let mt=At?pe.outerHTML:pe.innerHTML;return At&&ye["!doctype"]&&pe.ownerDocument&&pe.ownerDocument.doctype&&pe.ownerDocument.doctype.name&&Ft(Yc,pe.ownerDocument.doctype.name)&&(mt="<!DOCTYPE "+pe.ownerDocument.doctype.name+`>
`+mt),rt&&Ks([se,ue,Re],Ht=>{mt=Qa(mt,Ht," ")}),G&&or?G.createHTML(mt):mt},e.setConfig=function(){let Le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rr(Le),Ar=!0},e.clearConfig=function(){dr=null,Ar=!1},e.isValidAttribute=function(Le,E,pe){dr||Rr({});const we=gt(Le),Ze=gt(E);return Mr(we,Ze,pe)},e.addHook=function(Le,E){typeof E=="function"&&Xa(he[Le],E)},e.removeHook=function(Le,E){if(E!==void 0){const pe=bg(he[Le],E);return pe===-1?void 0:_g(he[Le],pe,1)[0]}return $l(he[Le])},e.removeHooks=function(Le){he[Le]=[]},e.removeAllHooks=function(){he=su()},e}var jg=Vc();function qg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${iu(t.from)} |`),e.push(`| **To** | ${iu(t.to)} |`),e.push(`| **Date** | ${qo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Bg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function iu(t){return(t||"").replace(/\|/g,"\\|")}function Bg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return wo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function zg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function wo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return zg(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(wo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>wo(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Fg(t){return mc(t,"md")}function ou(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Kg(t){return t.raw||null}function Ug(t){const e=Kg(t);return e?JSON.stringify(e,null,2):"null"}function Gg(t){return mc(t,"json")}var Hg=W('<button title="View as Markdown">.md</button>'),Wg=W('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Yg=W('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Vg=W('<div class="md-preview svelte-1b0rzpb"><!></div>'),Xg=W('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Qg=W('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Zg=W('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Jg=W('<pre class="message-text svelte-1b0rzpb"> </pre>'),$g=W('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),em=W('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),tm=W('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function nm(t,e){ft(e,!0);let r=Ce(e,"loading",3,!1);Lt(()=>on("MessageModal"));const a=new et.Renderer;a.link=({href:se,title:ue,text:Re})=>{const $=ue?` title="${ue}"`:"";return`<a href="${se}"${$} target="_blank" rel="noopener">${Re}</a>`},et.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Pe("email"),o=ct(()=>e.message.body?qg(e.message):""),c=ct(()=>Ug(e.message)),d=Pe("raw");function v(se){q(i,b(i)===se?"email":se,!0),se==="markdown"&&q(d,"raw")}function p(){ou(b(o),Fg(e.message))}function m(){ou(b(c),Gg(e.message),"application/json;charset=utf-8")}function x(se){const ue=et.parse(se);return jg.sanitize(ue,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let _=Pe(null);$s(()=>{var se;if(b(_)&&e.message.htmlBody&&!r()&&b(i)==="email"){const ue=b(_).contentDocument||((se=b(_).contentWindow)==null?void 0:se.document);ue&&(ue.open(),ue.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ue.close())}});var k=tm();k.__click=function(...se){var ue;(ue=e.onclose)==null||ue.apply(this,se)};var M=w(k);M.__click=se=>se.stopPropagation();var L=w(M),S=w(L),F=w(S),ie=A(S,2),re=w(ie);let G;re.__click=()=>v("json");var J=A(re,2);{var te=se=>{var ue=Hg();let Re;ue.__click=()=>v("markdown"),ge(()=>Re=Bt(ue,1,"action-btn svelte-1b0rzpb",null,Re,{active:b(i)==="markdown"})),K(se,ue)};Se(J,se=>{e.message.body&&se(te)})}var Y=A(J,2);Y.__click=function(...se){var ue;(ue=e.onclose)==null||ue.apply(this,se)};var ve=A(L,2);{var Oe=se=>{var ue=Wg(),Re=ot(ue),$=A(w(Re),2);$.__click=m;var ae=A(Re,2),le=w(ae),V=w(le);ge(()=>oe(V,b(c))),K(se,ue)},be=se=>{var ue=Xg(),Re=ot(ue),$=w(Re),ae=w($);let le;ae.__click=()=>q(d,"raw");var V=A(ae,2);let ne;V.__click=()=>q(d,"preview");var de=A($,2);de.__click=p;var ye=A(Re,2),H=w(ye);{var ee=Z=>{var Ne=Yg(),_e=w(Ne);ge(()=>oe(_e,b(o))),K(Z,Ne)},U=Z=>{var Ne=Vg(),_e=w(Ne);zd(_e,()=>x(b(o))),K(Z,Ne)};Se(H,Z=>{b(d)==="raw"?Z(ee):Z(U,!1)})}ge(()=>{le=Bt(ae,1,"md-tab svelte-1b0rzpb",null,le,{active:b(d)==="raw"}),ne=Bt(V,1,"md-tab svelte-1b0rzpb",null,ne,{active:b(d)==="preview"})}),K(se,ue)},he=se=>{var ue=em(),Re=ot(ue),$=w(Re),ae=A(w($),2),le=w(ae),V=A($,2),ne=A(w(V),2),de=w(ne),ye=A(V,2),H=A(w(ye),2),ee=w(H),U=A(Re,2),Z=w(U);{var Ne=Ee=>{var lt=Qg();K(Ee,lt)},_e=Ee=>{var lt=Zg();lc(lt,ze=>q(_,ze),()=>b(_)),K(Ee,lt)},Ge=Ee=>{var lt=Jg(),ze=w(lt);ge(()=>oe(ze,e.message.body)),K(Ee,lt)},nt=Ee=>{var lt=$g();K(Ee,lt)};Se(Z,Ee=>{r()?Ee(Ne):e.message.htmlBody?Ee(_e,1):e.message.body?Ee(Ge,2):Ee(nt,!1)})}ge(Ee=>{oe(le,e.message.from),oe(de,e.message.to),oe(ee,Ee)},[()=>qo(e.message.date)]),K(se,ue)};Se(ve,se=>{b(i)==="json"?se(Oe):b(i)==="markdown"?se(be,1):se(he,!1)})}ge(()=>{oe(F,e.message.subject),G=Bt(re,1,"action-btn svelte-1b0rzpb",null,G,{active:b(i)==="json"})}),K(t,k),dt()}Mt(["click"]);var rm=W('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),am=W('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),sm=W('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),im=W("<p> </p>"),om=W('<p>No emails in local storage. Click "Sync New" to download.</p>'),lm=W('<div class="empty-state svelte-6ts5xm"><!></div>'),um=W('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),cm=W('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function fm(t,e){ft(e,!0),Lt(()=>on("DashboardView"));let r=Ce(e,"error",3,null),a=Ce(e,"profile",3,null),i=Ce(e,"loadingProfile",3,!1),o=Ce(e,"emailMessages",19,()=>[]),c=Ce(e,"totalLocalMessages",3,0),d=Ce(e,"hasMoreLocal",3,!1),v=Ce(e,"loadingMessages",3,!1),p=Ce(e,"selectedMessage",3,null),m=Ce(e,"syncStatus",3,null),x=Ce(e,"syncProgress",3,null),_=Ce(e,"isSyncing",3,!1),k=Ce(e,"searchQuery",15);var M=cm(),L=ot(M),S=w(L);{var F=$=>{Oc($,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Se(S,$=>{r()&&$(F)})}var ie=A(S,2);cv(ie,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var re=A(ie,2);xv(re,{get syncStatus(){return m()},get syncProgress(){return x()},get isSyncing(){return _()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var G=A(re,2),J=w(G);J.__keydown=$=>$.key==="Enter"&&e.onsearch();var te=A(J,2);te.__click=function(...$){var ae;(ae=e.onsearch)==null||ae.apply(this,$)};var Y=w(te),ve=A(G,2);{var Oe=$=>{var ae=am(),le=ot(ae),V=w(le),ne=w(V),de=A(le,2);Ev(de,{get messages(){return o()},get onselect(){return e.onviewmessage}});var ye=A(de,2);{var H=ee=>{var U=rm(),Z=w(U);Z.__click=function(..._e){var Ge;(Ge=e.onloadmore)==null||Ge.apply(this,_e)};var Ne=w(Z);ge(()=>{Z.disabled=v(),oe(Ne,v()?"Loading...":"Load More")}),K(ee,U)};Se(ye,ee=>{d()&&ee(H)})}ge(ee=>oe(ne,`Showing ${o().length??""} of ${ee??""}
        ${k()?" matching":""} emails`),[()=>c().toLocaleString()]),K($,ae)},be=$=>{var ae=sm();K($,ae)},he=$=>{var ae=lm(),le=w(ae);{var V=de=>{var ye=im(),H=w(ye);ge(()=>oe(H,`No emails match "${k()??""}".`)),K(de,ye)},ne=de=>{var ye=om();K(de,ye)};Se(le,de=>{k()?de(V):de(ne,!1)})}K($,ae)},se=$=>{var ae=um();K($,ae)};Se(ve,$=>{var ae;o().length>0?$(Oe):v()?$(be,1):(ae=m())!=null&&ae.synced?$(he,2):$(se,!1)})}var ue=A(L,2);{var Re=$=>{nm($,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};Se(ue,$=>{p()&&$(Re)})}ge(()=>{te.disabled=v(),oe(Y,v()?"Searching...":"Search")}),No(J,k),K(t,M),dt()}Mt(["keydown","click"]);var dm=W('<div class="dashboard svelte-1q5o2lv"><!></div>');function pm(t,e){ft(e,!0);function r(_e){_e.key==="Escape"&&b(v)&&le()}Lt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Pe(Rt(localStorage.getItem("googleClientId")||"")),i=Pe(Rt(localStorage.getItem("googleClientId")||"")),o=Pe(!1),c=Pe(null),d=Pe(null),v=Pe(null),p=Pe(""),m=Pe(Rt([])),x=Pe(0),_=Pe(0),k=Pe(!1),M=Pe(!1),L=Pe(!1),S=Pe(null),F=Pe(null),ie=Pe(null),re=Pe(!1);const G=50;$s(()=>{b(c)&&(V(),ue())});let J=ct(()=>!b(a)),te=ct(()=>!!b(c)),Y=ct(()=>b(m).length<b(x));$s(()=>{b(a)&&!b(o)&&Gl(b(a)).then(()=>{q(o,!0)}).catch(_e=>{q(S,`Auth init failed: ${_e.message}`)})});function ve(){const _e=b(i).trim();_e&&(localStorage.setItem("googleClientId",_e),q(a,_e,!0),q(S,null))}function Oe(){localStorage.removeItem("googleClientId"),q(a,""),q(i,""),q(o,!1),q(c,null),q(d,null),q(m,[],!0),q(x,0)}async function be(){q(S,null),q(M,!0);try{b(o)||(await Gl(b(a)),q(o,!0));const _e=await qh();q(c,_e.access_token,!0),await se()}catch(_e){q(S,_e.message,!0)}finally{q(M,!1)}}async function he(){if(b(c))try{await Bh(b(c))}catch{}q(c,null),q(d,null),q(m,[],!0),q(x,0),q(v,null),q(S,null)}async function se(){q(L,!0);try{const _e=await pc(b(c));if(!b(c))return;q(d,_e,!0)}catch(_e){if(!b(c))return;q(S,`Profile fetch failed: ${_e.message}`)}finally{q(L,!1)}}async function ue(_e=!1){q(k,!0);try{const Ge=_e?b(_):0,nt=await hp({query:b(p)||void 0,limit:G,offset:Ge});_e?q(m,[...b(m),...nt.items],!0):q(m,nt.items,!0),q(x,nt.total,!0),q(_,b(m).length,!0)}catch(Ge){q(S,`Failed to load messages: ${Ge.message}`)}finally{q(k,!1)}}function Re(){q(_,0),ue(!1)}function $(){ue(!0)}function ae(_e){q(v,_e,!0)}function le(){q(v,null)}async function V(){try{q(F,await Kh(),!0)}catch{}}async function ne(_e){if(b(re)||!b(c))return;q(S,null),q(re,!0),q(ie,null);const Ge=new AbortController;try{await zh(b(c),{limit:_e,onProgress:nt=>{q(ie,{...nt},!0)},signal:Ge.signal}),await V(),await ue(!1)}catch(nt){if(nt.name!=="AbortError"){if(!b(c))return;q(S,`Sync failed: ${nt.message}`)}}finally{q(re,!1)}}async function de(_e){if(b(re)||!b(c))return;q(S,null),q(re,!0),q(ie,null);const Ge=new AbortController;try{await Fh(b(c),{limit:_e,onProgress:nt=>{q(ie,{...nt},!0)},signal:Ge.signal}),await V(),await ue(!1)}catch(nt){if(nt.name!=="AbortError"){if(!b(c))return;q(S,`Sync more failed: ${nt.message}`)}}finally{q(re,!1)}}async function ye(){try{await Uh(),await V(),q(m,[],!0),q(x,0),q(_,0)}catch(_e){q(S,`Failed to clear data: ${_e.message}`)}}var H=dm(),ee=w(H);{var U=_e=>{Xh(_e,{onsave:ve,get clientIdInput(){return b(i)},set clientIdInput(Ge){q(i,Ge,!0)}})},Z=_e=>{iv(_e,{get clientId(){return b(a)},get error(){return b(S)},get loadingAuth(){return b(M)},onsignin:be,onclear:Oe,onsignout:he})},Ne=_e=>{fm(_e,{get error(){return b(S)},get profile(){return b(d)},get loadingProfile(){return b(L)},get emailMessages(){return b(m)},get totalLocalMessages(){return b(x)},get hasMoreLocal(){return b(Y)},get loadingMessages(){return b(k)},get selectedMessage(){return b(v)},get syncStatus(){return b(F)},get syncProgress(){return b(ie)},get isSyncing(){return b(re)},onsignout:he,onsearch:Re,onloadmore:$,onviewmessage:ae,onclosedetail:le,ondismisserror:()=>q(S,null),onsync:ne,onsyncmore:de,oncleardata:ye,get searchQuery(){return b(p)},set searchQuery(Ge){q(p,Ge,!0)}})};Se(ee,_e=>{b(J)?_e(U):b(te)?_e(Ne,!1):_e(Z,1)})}K(t,H),dt()}var hm=W('<span class="spinner svelte-ois7em"></span>'),vm=Mo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),gm=W('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),mm=W('<option class="svelte-ois7em"> </option>'),ym=W('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),bm=W('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),_m=W('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="12" cy="12" r="10" class="svelte-ois7em"></circle><path d="M12 16v-4" class="svelte-ois7em"></path><path d="M12 8h.01" class="svelte-ois7em"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function wm(t,e){ft(e,!0);let r=Ce(e,"engineStatus",3,"idle"),a=Ce(e,"modelName",3,""),i=Ce(e,"isScanning",3,!1),o=Ce(e,"scanProgress",3,null),c=Ce(e,"scanCount",15,20),d=Ce(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function m(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var _=_m(),k=w(_),M=w(k),L=w(M);{var S=H=>{var ee=hm();K(H,ee)},F=H=>{var ee=vm();K(H,ee)};Se(L,H=>{i()?H(S):H(F,!1)})}var ie=A(M,2),re=w(ie),G=A(w(re),2);G.__click=function(...H){var ee;(ee=e.oninspect)==null||ee.apply(this,H)};var J=A(re,2),te=w(J);let Y;var ve=A(te),Oe=A(k,2);{var be=H=>{var ee=gm(),U=w(ee),Z=w(U),Ne=A(U,4),_e=w(Ne),Ge=A(Ne,4),nt=w(Ge);ge(()=>{oe(Z,`${d().totalEmails??""} emails in storage`),oe(_e,`${d().classified??""} classified`),oe(nt,`${d().unclassified??""} new`)}),K(H,ee)};Se(Oe,H=>{d()&&H(be)})}var he=A(Oe,2),se=w(he),ue=A(w(se),2);sn(ue,21,()=>v,Er,(H,ee)=>{var U=mm(),Z=w(U),Ne={};ge(()=>{oe(Z,b(ee).label),Ne!==(Ne=b(ee).value)&&(U.value=(U.__value=b(ee).value)??"")}),K(H,U)});var Re=A(se,2),$=w(Re);$.__click=function(...H){var ee;(ee=e.onscan)==null||ee.apply(this,H)};var ae=w($),le=A($,2);le.__click=function(...H){var ee;(ee=e.onrescan)==null||ee.apply(this,H)};var V=A(he,2);{var ne=H=>{var ee=ym();K(H,ee)};Se(V,H=>{r()!=="ready"&&r()!=="loading"&&H(ne)})}var de=A(V,2);{var ye=H=>{var ee=bm(),U=w(ee),Z=w(U);let Ne,_e;var Ge=A(U,2),nt=w(Ge);ge(()=>{Ne=Bt(Z,1,"progress-fill svelte-ois7em",null,Ne,{indeterminate:!o().total}),_e=Zt(Z,"",_e,{width:`${o().total?o().current/o().total*100:0}%`}),oe(nt,o().message||"Scanning...")}),K(H,ee)};Se(de,H=>{i()&&o()&&H(ye)})}ge((H,ee,U,Z)=>{Y=Zt(te,"",Y,H),oe(ve,` ${ee??""}`),ue.disabled=i(),$.disabled=U,oe(ae,i()?"Scanning...":"Scan New"),le.disabled=Z},[()=>({background:m()}),p,()=>!x(),()=>!x()]),Lo(ue,c),K(t,_),dt()}Mt(["click"]);var km=W('<span class="row-date svelte-1czytqk"> </span>'),xm=W('<span class="tag svelte-1czytqk"> </span>'),Sm=W('<span class="row-tags svelte-1czytqk"></span>'),Tm=W('<span class="row-reason svelte-1czytqk"> </span>'),Em=W('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),Am=W('<span class="status-label svelte-1czytqk"> </span>'),Cm=W('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Im=W('<p class="summary-reason svelte-1czytqk"> </p>'),Rm=W('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Pm=W('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function lu(t,e){ft(e,!0);let r=Ce(e,"actionColor",3,"#666"),a=Ce(e,"dimmed",3,!1);function i($){if(!$)return"";try{return new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=ct(()=>e.item.status==="pending"),c=Pe(!1);var d=Pm(),v=ot(d);let p;var m=w(v);m.__click=()=>q(c,!b(c));let x;var _=w(m),k=w(_),M=A(_,2),L=w(M),S=w(L),F=A(L,2);{var ie=$=>{var ae=km(),le=w(ae);ge(V=>oe(le,V),[()=>i(e.item.date)]),K($,ae)};Se(F,$=>{e.item.date&&$(ie)})}var re=A(M,2);{var G=$=>{var ae=Sm();sn(ae,21,()=>e.item.tags,Er,(le,V)=>{var ne=xm();let de;var ye=w(ne);ge(H=>{de=Zt(ne,"",de,H),oe(ye,b(V))},[()=>({background:Ap(b(V))})]),K(le,ne)}),K($,ae)};Se(re,$=>{e.item.tags&&e.item.tags.length>0&&$(G)})}var J=A(re,2);{var te=$=>{var ae=Tm(),le=w(ae);ge(()=>oe(le,e.item.reason)),K($,ae)};Se(J,$=>{e.item.reason&&!b(c)&&$(te)})}var Y=A(m,2),ve=w(Y);{var Oe=$=>{var ae=Em(),le=ot(ae);le.__click=()=>e.onmarkacted(e.item.emailId);var V=A(le,2);V.__click=()=>e.ondismiss(e.item.emailId),K($,ae)},be=$=>{var ae=Am(),le=w(ae);ge(()=>oe(le,e.item.status)),K($,ae)};Se(ve,$=>{b(o)?$(Oe):$(be,!1)})}var he=A(ve,2);{var se=$=>{var ae=Cm();ae.__click=()=>e.onremove(e.item.emailId),K($,ae)};Se(he,$=>{e.onremove&&$(se)})}var ue=A(v,2);{var Re=$=>{var ae=Rm();let le;var V=w(ae),ne=w(V),de=A(V,2);{var ye=H=>{var ee=Im(),U=w(ee);ge(()=>oe(U,e.item.reason)),K(H,ee)};Se(de,H=>{e.item.reason&&H(ye)})}ge(()=>{le=Zt(ae,"",le,{"border-left-color":r()}),oe(ne,e.item.summary)}),K($,ae)};Se(ue,$=>{b(c)&&e.item.summary&&$(Re)})}ge(()=>{p=Bt(v,1,"email-row svelte-1czytqk",null,p,{dimmed:a()}),x=Zt(m,"",x,{"border-left-color":r()}),oe(k,e.item.subject),oe(S,e.item.from)}),K(t,d),dt()}Mt(["click"]);var Om=W('<span class="group-acted svelte-tl1unp"> </span>'),Dm=W('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Mm=W('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Lm=W('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Nm=W('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),jm=W('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),qm=W('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Bm(t,e){ft(e,!0);let r=Ce(e,"color",3,"#888");Ce(e,"count",3,0);let a=Ce(e,"items",19,()=>[]),i=Ce(e,"expanded",3,!1),o=ct(()=>a().filter(te=>te.status==="pending")),c=ct(()=>a().filter(te=>te.status!=="pending")),d=Pe(!1);function v(te){return te.split("_").map(Y=>Y.charAt(0)+Y.slice(1).toLowerCase()).join(" ")}var p=qm(),m=w(p);m.__click=function(...te){var Y;(Y=e.ontoggle)==null||Y.apply(this,te)};var x=w(m);let _;var k=w(x),M=A(x,2),L=w(M),S=A(M,2);{var F=te=>{var Y=Om(),ve=w(Y);ge(()=>oe(ve,`${b(c).length??""} handled`)),K(te,Y)};Se(S,te=>{b(c).length>0&&te(F)})}var ie=A(S,4);let re;var G=A(m,2);{var J=te=>{var Y=jm(),ve=w(Y);{var Oe=le=>{var V=Dm();K(le,V)};Se(ve,le=>{b(o).length===0&&b(c).length===0&&le(Oe)})}var be=A(ve,2);sn(be,17,()=>b(o),le=>le.emailId,(le,V)=>{lu(le,{get item(){return b(V)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var he=A(be,2);{var se=le=>{var V=Mm(),ne=w(V),de=w(ne),ye=A(ne,2);sn(ye,17,()=>b(c),H=>H.emailId,(H,ee)=>{lu(H,{get item(){return b(ee)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ge(()=>oe(de,`${b(c).length??""} handled`)),K(le,V)};Se(he,le=>{b(c).length>0&&le(se)})}var ue=A(he,2),Re=w(ue);{var $=le=>{var V=Lm();V.__click=()=>q(d,!0),K(le,V)},ae=le=>{var V=Nm(),ne=w(V),de=A(ne);de.__click=()=>q(d,!1);var ye=A(de,2);ye.__click=()=>{e.oncleargroup(),q(d,!1)},ge(()=>oe(ne,`Clear ${a().length??""} items? `)),K(le,V)};Se(Re,le=>{b(d)?le(ae,!1):le($)})}K(te,Y)};Se(G,te=>{i()&&te(J)})}ge(te=>{_=Zt(x,"",_,{background:r()}),oe(k,te),oe(L,b(o).length),re=Bt(ie,0,"chevron svelte-tl1unp",null,re,{open:i()})},[()=>v(e.action)]),K(t,p),dt()}Mt(["click"]);var zm=W(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),Fm=W(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The body is truncated to 500 characters.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),Km=W(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),Um=W('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function Gm(t,e){ft(e,!0);let r=Ce(e,"open",15,!1),a=Ce(e,"sampleEmail",3,null),i=Pe("system");function o(){return a()?Ec(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function c(){r(!1)}function d(x){x.target===x.currentTarget&&c()}var v=Pa(),p=ot(v);{var m=x=>{var _=Um();_.__click=d,_.__keydown=se=>se.key==="Escape"&&c();var k=w(_),M=w(k),L=A(w(M),2);L.__click=c;var S=A(M,2),F=w(S);let ie;F.__click=()=>q(i,"system");var re=A(F,2);let G;re.__click=()=>q(i,"email");var J=A(re,2);let te;J.__click=()=>q(i,"config");var Y=A(S,2),ve=w(Y);{var Oe=se=>{var ue=zm(),Re=A(ot(ue),2),$=w(Re);ge(()=>oe($,kc)),K(se,ue)},be=se=>{var ue=Fm(),Re=A(ot(ue),2),$=A(w(Re),2);$.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body, truncated to 500 chars}`;var ae=A(Re,2),le=A(w(ae),2),V=w(le);ge(ne=>oe(V,ne),[o]),K(se,ue)},he=se=>{var ue=Km(),Re=A(ot(ue),2),$=w(Re),ae=A(w($),2),le=w(ae),V=A($,2),ne=A(w(V),2),de=w(ne),ye=A(V,2),H=A(w(ye),2),ee=w(H),U=A(Re,4);U.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,ge(()=>{oe(le,wp.maxTokens),oe(de,"false"),oe(ee,"false")}),K(se,ue)};Se(ve,se=>{b(i)==="system"?se(Oe):b(i)==="email"?se(be,1):b(i)==="config"&&se(he,2)})}ge(()=>{ie=Bt(F,1,"tab svelte-10pcy9j",null,ie,{active:b(i)==="system"}),G=Bt(re,1,"tab svelte-10pcy9j",null,G,{active:b(i)==="email"}),te=Bt(J,1,"tab svelte-10pcy9j",null,te,{active:b(i)==="config"})}),K(x,_)};Se(p,x=>{r()&&x(m)})}K(t,v),dt()}Mt(["click","keydown"]);var Hm=W('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Wm=W('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Ym=W('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Vm=W('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Xm=W('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Qm=W('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!></div>');function Zm(t,e){ft(e,!0);let r=Ce(e,"groups",19,()=>({})),a=Ce(e,"groupOrder",19,()=>[]),i=Ce(e,"counts",19,()=>({})),o=Ce(e,"stats",3,null),c=Ce(e,"expandedGroup",3,null),d=Ce(e,"isScanning",3,!1),v=Ce(e,"scanProgress",3,null),p=Ce(e,"scanCount",15,20),m=Ce(e,"error",3,null),x=Pe(!1),_=Pe(!1),k=ct(()=>{for(const te of a()){const Y=r()[te];if((Y==null?void 0:Y.length)>0)return Y[0]}return null});var M=Qm(),L=w(M);wm(L,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},oninspect:()=>q(_,!0),get scanCount(){return p()},set scanCount(te){p(te)}});var S=A(L,2);Gm(S,{get sampleEmail(){return b(k)},get open(){return b(_)},set open(te){q(_,te,!0)}});var F=A(S,2);{var ie=te=>{var Y=Hm(),ve=w(Y),Oe=w(ve),be=A(ve,2);be.__click=function(...he){var se;(se=e.ondismisserror)==null||se.apply(this,he)},ge(()=>oe(Oe,m())),K(te,Y)};Se(F,te=>{m()&&te(ie)})}var re=A(F,2);{var G=te=>{var Y=Vm(),ve=ot(Y);sn(ve,20,a,$=>$,($,ae)=>{{let le=ct(()=>po(ae)),V=ct(()=>{var ye;return((ye=r()[ae])==null?void 0:ye.length)||0}),ne=ct(()=>r()[ae]||[]),de=ct(()=>c()===ae);Bm($,{get action(){return ae},get color(){return b(le)},get count(){return b(V)},get items(){return b(ne)},get expanded(){return b(de)},ontoggle:()=>e.ontogglegroup(ae),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ae)})}});var Oe=A(ve,2),be=w(Oe),he=w(be),se=A(be,2);{var ue=$=>{var ae=Wm();ae.__click=()=>q(x,!0),K($,ae)},Re=$=>{var ae=Ym(),le=A(w(ae));le.__click=()=>q(x,!1);var V=A(le,2);V.__click=()=>{e.onclear(),q(x,!1)},K($,ae)};Se(se,$=>{b(x)?$(Re,!1):$(ue)})}ge(()=>oe(he,`${i().total??""} emails classified into ${a().length??""} groups`)),K(te,Y)},J=te=>{var Y=Xm();K(te,Y)};Se(re,te=>{i().total>0?te(G):d()||te(J,1)})}K(t,M),dt()}Mt(["click"]);var Jm=W('<div class="actions-page svelte-3tch4q"><!></div>');function $m(t,e){ft(e,!0);const r=uc();let a=Pe(Rt(r.status)),i=Pe(""),o=Pe(Rt({})),c=Pe(Rt([])),d=Pe(Rt({total:0})),v=Pe(null),p=Pe(null),m=Pe(!1),x=Pe(null),_=Pe(20),k=Pe(null);Lt(()=>{const be=r.onMessage(he=>{if(he.status==="ready"){q(a,"ready");const se=ls.find(ue=>ue.id===r.modelId);q(i,(se==null?void 0:se.name)||r.modelId||"",!0)}he.status==="loading"&&q(a,"loading")});if(q(a,r.status,!0),r.modelId){const he=ls.find(se=>se.id===r.modelId);q(i,(he==null?void 0:he.name)||r.modelId||"",!0)}return M(),()=>be()});async function M(){try{const be=await kp();q(o,be.groups,!0),q(c,be.order,!0),q(d,await xp(),!0),q(v,await fo(),!0)}catch(be){q(k,`Failed to load data: ${be.message}`)}}async function L(){await F(!1)}async function S(){await F(!0)}async function F(be){if(!(b(m)||!r.isReady)){q(k,null),q(m,!0),q(x,null);try{await xc(r,{count:b(_),force:be,onProgress:he=>{q(x,{...he},!0)}}),await M()}catch(he){q(k,`Scan failed: ${he.message}`)}finally{q(m,!1)}}}async function ie(be){await ti(be,"acted"),await M()}async function re(be){await ti(be,"dismissed"),await M()}async function G(be){await Tc(be),await M()}async function J(be){await Sc(be),await M()}async function te(){await Sp(),await M()}function Y(be){q(p,b(p)===be?null:be,!0)}var ve=Jm(),Oe=w(ve);Zm(Oe,{get engineStatus(){return b(a)},get modelName(){return b(i)},get groups(){return b(o)},get groupOrder(){return b(c)},get counts(){return b(d)},get stats(){return b(v)},get expandedGroup(){return b(p)},get isScanning(){return b(m)},get scanProgress(){return b(x)},get error(){return b(k)},onscan:L,onrescan:S,ontogglegroup:Y,onmarkacted:ie,ondismiss:re,onremove:G,oncleargroup:J,onclear:te,ondismisserror:()=>q(k,null),get scanCount(){return b(_)},set scanCount(be){q(_,be,!0)}}),K(t,ve),dt()}var ey=W('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function ty(t,e){ft(e,!0);function r(){const Y=location.hash;return Y==="#dashboard"?"dashboard":Y==="#actions"?"actions":"chat"}let a=Pe(Rt(r()));Lt(()=>{function Y(){q(a,r(),!0)}return window.addEventListener("hashchange",Y),()=>window.removeEventListener("hashchange",Y)});var i=ey(),o=w(i),c=A(w(o),2),d=w(c);let v;var p=A(d,2);let m;var x=A(p,2);let _;var k=A(o,2),M=w(k);let L;var S=w(M);Lh(S,{});var F=A(M,2);let ie;var re=w(F);$m(re,{});var G=A(F,2);let J;var te=w(G);pm(te,{}),ge(()=>{v=Bt(d,1,"svelte-1n46o8q",null,v,{active:b(a)==="chat"}),m=Bt(p,1,"svelte-1n46o8q",null,m,{active:b(a)==="actions"}),_=Bt(x,1,"svelte-1n46o8q",null,_,{active:b(a)==="dashboard"}),L=Zt(M,"",L,{display:b(a)==="chat"?"flex":"none"}),ie=Zt(F,"",ie,{display:b(a)==="actions"?"flex":"none"}),J=Zt(G,"",J,{display:b(a)==="dashboard"?"flex":"none"})}),K(t,i),dt()}Dd(ty,{target:document.getElementById("app")});
