var Wc=Object.defineProperty;var ul=t=>{throw TypeError(t)};var $c=(t,e,r)=>e in t?Wc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ke=(t,e,r)=>$c(t,typeof e!="symbol"?e+"":e,r),Ps=(t,e,r)=>e.has(t)||ul("Cannot "+r);var z=(t,e,r)=>(Ps(t,e,"read from private field"),r?r.call(t):e.get(t)),Ue=(t,e,r)=>e.has(t)?ul("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Be=(t,e,r,i)=>(Ps(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),Pt=(t,e,r)=>(Ps(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();const Us=!1;var po=Array.isArray,Yc=Array.prototype.indexOf,ga=Array.prototype.includes,Ji=Array.from,Vc=Object.defineProperty,la=Object.getOwnPropertyDescriptor,Xc=Object.getOwnPropertyDescriptors,Qc=Object.prototype,Zc=Array.prototype,Xl=Object.getPrototypeOf,cl=Object.isExtensible;const Jc=()=>{};function ef(t){for(var e=0;e<t.length;e++)t[e]()}function Ql(){var t,e,r=new Promise((i,s)=>{t=i,e=s});return{promise:r,resolve:t,reject:e}}const St=2,ti=4,es=8,Zl=1<<24,Xn=16,Tn=32,Xr=64,Jl=128,ln=512,bt=1024,Tt=2048,Sn=4096,Yt=8192,Yn=16384,oi=32768,ma=65536,fl=1<<17,eu=1<<18,ka=1<<19,tf=1<<20,$n=1<<25,Hr=65536,Gs=1<<21,ho=1<<22,pr=1<<23,Fr=Symbol("$state"),nf=Symbol("legacy props"),rf=Symbol(""),Or=new class extends Error{constructor(){super(...arguments);Ke(this,"name","StaleReactionError");Ke(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function af(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function sf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function of(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function lf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function uf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function cf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function ff(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function df(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function pf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function hf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function vf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function gf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const mf=1,yf=2,tu=4,bf=8,_f=16,wf=1,kf=4,xf=8,Sf=16,nu=1,Tf=2,wt=Symbol(),ru="http://www.w3.org/1999/xhtml";function Ef(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Af(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function au(t){return t===this.v}function If(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function iu(t){return!If(t,this.v)}let Cf=!1,Xt=null;function ya(t){Xt=t}function Et(t,e=!1,r){Xt={p:Xt,i:!1,c:null,e:null,s:t,x:null,l:null}}function At(t){var e=Xt,r=e.e;if(r!==null){e.e=null;for(var i of r)Au(i)}return e.i=!0,Xt=e.p,{}}function su(){return!0}let Dr=[];function ou(){var t=Dr;Dr=[],ef(t)}function hr(t){if(Dr.length===0&&!Qa){var e=Dr;queueMicrotask(()=>{e===Dr&&ou()})}Dr.push(t)}function Pf(){for(;Dr.length>0;)ou()}function lu(t){var e=Je;if(e===null)return Ge.f|=pr,t;if((e.f&oi)===0&&(e.f&ti)===0)throw t;ba(t,e)}function ba(t,e){for(;e!==null;){if((e.f&Jl)!==0){if((e.f&oi)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Rf=-7169;function dt(t,e){t.f=t.f&Rf|e}function vo(t){(t.f&ln)!==0||t.deps===null?dt(t,bt):dt(t,Sn)}function uu(t){if(t!==null)for(const e of t)(e.f&St)===0||(e.f&Hr)===0||(e.f^=Hr,uu(e.deps))}function cu(t,e,r){(t.f&Tt)!==0?e.add(t):(t.f&Sn)!==0&&r.add(t),uu(t.deps),dt(t,bt)}const Ri=new Set;let Le=null,Gi=null,kt=null,Bt=[],ts=null,Hs=!1,Qa=!1;var ua,ca,Lr,fa,ri,ai,Nr,Gn,da,Nn,Ws,$s,fu;const Lo=class Lo{constructor(){Ue(this,Nn);Ke(this,"committed",!1);Ke(this,"current",new Map);Ke(this,"previous",new Map);Ue(this,ua,new Set);Ue(this,ca,new Set);Ue(this,Lr,0);Ue(this,fa,0);Ue(this,ri,null);Ue(this,ai,new Set);Ue(this,Nr,new Set);Ue(this,Gn,new Map);Ke(this,"is_fork",!1);Ue(this,da,!1)}is_deferred(){return this.is_fork||z(this,fa)>0}skip_effect(e){z(this,Gn).has(e)||z(this,Gn).set(e,{d:[],m:[]})}unskip_effect(e){var r=z(this,Gn).get(e);if(r){z(this,Gn).delete(e);for(var i of r.d)dt(i,Tt),kn(i);for(i of r.m)dt(i,Sn),kn(i)}}process(e){var s;Bt=[],this.apply();var r=[],i=[];for(const l of e)Pt(this,Nn,Ws).call(this,l,r,i);if(this.is_deferred()){Pt(this,Nn,$s).call(this,i),Pt(this,Nn,$s).call(this,r);for(const[l,f]of z(this,Gn))vu(l,f)}else{for(const l of z(this,ua))l();z(this,ua).clear(),z(this,Lr)===0&&Pt(this,Nn,fu).call(this),Gi=this,Le=null,dl(i),dl(r),Gi=null,(s=z(this,ri))==null||s.resolve()}kt=null}capture(e,r){r!==wt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&pr)===0&&(this.current.set(e,e.v),kt==null||kt.set(e,e.v))}activate(){Le=this,this.apply()}deactivate(){Le===this&&(Le=null,kt=null)}flush(){if(this.activate(),Bt.length>0){if(du(),Le!==null&&Le!==this)return}else z(this,Lr)===0&&this.process([]);this.deactivate()}discard(){for(const e of z(this,ca))e(this);z(this,ca).clear()}increment(e){Be(this,Lr,z(this,Lr)+1),e&&Be(this,fa,z(this,fa)+1)}decrement(e){Be(this,Lr,z(this,Lr)-1),e&&Be(this,fa,z(this,fa)-1),!z(this,da)&&(Be(this,da,!0),hr(()=>{Be(this,da,!1),this.is_deferred()?Bt.length>0&&this.flush():this.revive()}))}revive(){for(const e of z(this,ai))z(this,Nr).delete(e),dt(e,Tt),kn(e);for(const e of z(this,Nr))dt(e,Sn),kn(e);this.flush()}oncommit(e){z(this,ua).add(e)}ondiscard(e){z(this,ca).add(e)}settled(){return(z(this,ri)??Be(this,ri,Ql())).promise}static ensure(){if(Le===null){const e=Le=new Lo;Ri.add(Le),Qa||hr(()=>{Le===e&&e.flush()})}return Le}apply(){}};ua=new WeakMap,ca=new WeakMap,Lr=new WeakMap,fa=new WeakMap,ri=new WeakMap,ai=new WeakMap,Nr=new WeakMap,Gn=new WeakMap,da=new WeakMap,Nn=new WeakSet,Ws=function(e,r,i){e.f^=bt;for(var s=e.first,l=null;s!==null;){var f=s.f,d=(f&(Tn|Xr))!==0,v=d&&(f&bt)!==0,h=v||(f&Yt)!==0||z(this,Gn).has(s);if(!h&&s.fn!==null){d?s.f^=bt:l!==null&&(f&(ti|es|Zl))!==0?l.b.defer_effect(s):(f&ti)!==0?r.push(s):ui(s)&&((f&Xn)!==0&&z(this,Nr).add(s),wa(s));var y=s.first;if(y!==null){s=y;continue}}var k=s.parent;for(s=s.next;s===null&&k!==null;)k===l&&(l=null),s=k.next,k=k.parent}},$s=function(e){for(var r=0;r<e.length;r+=1)cu(e[r],z(this,ai),z(this,Nr))},fu=function(){var s;if(Ri.size>1){this.previous.clear();var e=kt,r=!0;for(const l of Ri){if(l===this){r=!1;continue}const f=[];for(const[v,h]of this.current){if(l.current.has(v))if(r&&h!==l.current.get(v))l.current.set(v,h);else continue;f.push(v)}if(f.length===0)continue;const d=[...l.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var i=Bt;Bt=[];const v=new Set,h=new Map;for(const y of f)pu(y,d,v,h);if(Bt.length>0){Le=l,l.apply();for(const y of Bt)Pt(s=l,Nn,Ws).call(s,y,[],[]);l.deactivate()}Bt=i}}Le=null,kt=e}this.committed=!0,Ri.delete(this)};let vr=Lo;function Of(t){var e=Qa;Qa=!0;try{for(var r;;){if(Pf(),Bt.length===0&&(Le==null||Le.flush(),Bt.length===0))return ts=null,r;du()}}finally{Qa=e}}function du(){Hs=!0;var t=null;try{for(var e=0;Bt.length>0;){var r=vr.ensure();if(e++>1e3){var i,s;Df()}r.process(Bt),mr.clear()}}finally{Bt=[],Hs=!1,ts=null}}function Df(){try{ff()}catch(t){ba(t,ts)}}let mn=null;function dl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var i=t[r++];if((i.f&(Yn|Yt))===0&&ui(i)&&(mn=new Set,wa(i),i.deps===null&&i.first===null&&i.nodes===null&&i.teardown===null&&i.ac===null&&Ru(i),(mn==null?void 0:mn.size)>0)){mr.clear();for(const s of mn){if((s.f&(Yn|Yt))!==0)continue;const l=[s];let f=s.parent;for(;f!==null;)mn.has(f)&&(mn.delete(f),l.push(f)),f=f.parent;for(let d=l.length-1;d>=0;d--){const v=l[d];(v.f&(Yn|Yt))===0&&wa(v)}}mn.clear()}}mn=null}}function pu(t,e,r,i){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const s of t.reactions){const l=s.f;(l&St)!==0?pu(s,e,r,i):(l&(ho|Xn))!==0&&(l&Tt)===0&&hu(s,e,i)&&(dt(s,Tt),kn(s))}}function hu(t,e,r){const i=r.get(t);if(i!==void 0)return i;if(t.deps!==null)for(const s of t.deps){if(ga.call(e,s))return!0;if((s.f&St)!==0&&hu(s,e,r))return r.set(s,!0),!0}return r.set(t,!1),!1}function kn(t){for(var e=ts=t;e.parent!==null;){e=e.parent;var r=e.f;if(Hs&&e===Je&&(r&Xn)!==0&&(r&eu)===0)return;if((r&(Xr|Tn))!==0){if((r&bt)===0)return;e.f^=bt}}Bt.push(e)}function vu(t,e){if(!((t.f&Tn)!==0&&(t.f&bt)!==0)){(t.f&Tt)!==0?e.d.push(t):(t.f&Sn)!==0&&e.m.push(t),dt(t,bt);for(var r=t.first;r!==null;)vu(r,e),r=r.next}}function Mf(t){let e=0,r=Wr(0),i;return()=>{yo()&&(R(r),bo(()=>(e===0&&(i=ci(()=>t(()=>Za(r)))),e+=1,()=>{hr(()=>{e-=1,e===0&&(i==null||i(),i=void 0,Za(r))})})))}}var Lf=ma|ka|Jl;function Nf(t,e,r){new qf(t,e,r)}var rn,fo,Rn,qr,On,an,jt,Dn,Hn,fr,jr,dr,pa,Br,ha,va,Wn,Qi,_t,jf,Bf,Ys,ji,Bi,Vs;class qf{constructor(e,r,i){Ue(this,_t);Ke(this,"parent");Ke(this,"is_pending",!1);Ue(this,rn);Ue(this,fo,null);Ue(this,Rn);Ue(this,qr);Ue(this,On);Ue(this,an,null);Ue(this,jt,null);Ue(this,Dn,null);Ue(this,Hn,null);Ue(this,fr,null);Ue(this,jr,0);Ue(this,dr,0);Ue(this,pa,!1);Ue(this,Br,!1);Ue(this,ha,new Set);Ue(this,va,new Set);Ue(this,Wn,null);Ue(this,Qi,Mf(()=>(Be(this,Wn,Wr(z(this,jr))),()=>{Be(this,Wn,null)})));Be(this,rn,e),Be(this,Rn,r),Be(this,qr,i),this.parent=Je.b,this.is_pending=!!z(this,Rn).pending,Be(this,On,_o(()=>{Je.b=this;{var s=Pt(this,_t,Ys).call(this);try{Be(this,an,sn(()=>i(s)))}catch(l){this.error(l)}z(this,dr)>0?Pt(this,_t,Bi).call(this):this.is_pending=!1}return()=>{var l;(l=z(this,fr))==null||l.remove()}},Lf))}defer_effect(e){cu(e,z(this,ha),z(this,va))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!z(this,Rn).pending}update_pending_count(e){Pt(this,_t,Vs).call(this,e),Be(this,jr,z(this,jr)+e),!(!z(this,Wn)||z(this,pa))&&(Be(this,pa,!0),hr(()=>{Be(this,pa,!1),z(this,Wn)&&_a(z(this,Wn),z(this,jr))}))}get_effect_pending(){return z(this,Qi).call(this),R(z(this,Wn))}error(e){var r=z(this,Rn).onerror;let i=z(this,Rn).failed;if(z(this,Br)||!r&&!i)throw e;z(this,an)&&(Ft(z(this,an)),Be(this,an,null)),z(this,jt)&&(Ft(z(this,jt)),Be(this,jt,null)),z(this,Dn)&&(Ft(z(this,Dn)),Be(this,Dn,null));var s=!1,l=!1;const f=()=>{if(s){Af();return}s=!0,l&&gf(),vr.ensure(),Be(this,jr,0),z(this,Dn)!==null&&Kr(z(this,Dn),()=>{Be(this,Dn,null)}),this.is_pending=this.has_pending_snippet(),Be(this,an,Pt(this,_t,ji).call(this,()=>(Be(this,Br,!1),sn(()=>z(this,qr).call(this,z(this,rn)))))),z(this,dr)>0?Pt(this,_t,Bi).call(this):this.is_pending=!1};hr(()=>{try{l=!0,r==null||r(e,f),l=!1}catch(d){ba(d,z(this,On)&&z(this,On).parent)}i&&Be(this,Dn,Pt(this,_t,ji).call(this,()=>{vr.ensure(),Be(this,Br,!0);try{return sn(()=>{i(z(this,rn),()=>e,()=>f)})}catch(d){return ba(d,z(this,On).parent),null}finally{Be(this,Br,!1)}}))})}}rn=new WeakMap,fo=new WeakMap,Rn=new WeakMap,qr=new WeakMap,On=new WeakMap,an=new WeakMap,jt=new WeakMap,Dn=new WeakMap,Hn=new WeakMap,fr=new WeakMap,jr=new WeakMap,dr=new WeakMap,pa=new WeakMap,Br=new WeakMap,ha=new WeakMap,va=new WeakMap,Wn=new WeakMap,Qi=new WeakMap,_t=new WeakSet,jf=function(){try{Be(this,an,sn(()=>z(this,qr).call(this,z(this,rn))))}catch(e){this.error(e)}},Bf=function(){const e=z(this,Rn).pending;e&&(Be(this,jt,sn(()=>e(z(this,rn)))),hr(()=>{var r=Pt(this,_t,Ys).call(this);Be(this,an,Pt(this,_t,ji).call(this,()=>(vr.ensure(),sn(()=>z(this,qr).call(this,r))))),z(this,dr)>0?Pt(this,_t,Bi).call(this):(Kr(z(this,jt),()=>{Be(this,jt,null)}),this.is_pending=!1)}))},Ys=function(){var e=z(this,rn);return this.is_pending&&(Be(this,fr,Vn()),z(this,rn).before(z(this,fr)),e=z(this,fr)),e},ji=function(e){var r=Je,i=Ge,s=Xt;Ln(z(this,On)),cn(z(this,On)),ya(z(this,On).ctx);try{return e()}catch(l){return lu(l),null}finally{Ln(r),cn(i),ya(s)}},Bi=function(){const e=z(this,Rn).pending;z(this,an)!==null&&(Be(this,Hn,document.createDocumentFragment()),z(this,Hn).append(z(this,fr)),Mu(z(this,an),z(this,Hn))),z(this,jt)===null&&Be(this,jt,sn(()=>e(z(this,rn))))},Vs=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Pt(r=this.parent,_t,Vs).call(r,e);return}if(Be(this,dr,z(this,dr)+e),z(this,dr)===0){this.is_pending=!1;for(const i of z(this,ha))dt(i,Tt),kn(i);for(const i of z(this,va))dt(i,Sn),kn(i);z(this,ha).clear(),z(this,va).clear(),z(this,jt)&&Kr(z(this,jt),()=>{Be(this,jt,null)}),z(this,Hn)&&(z(this,rn).before(z(this,Hn)),Be(this,Hn,null))}};function zf(t,e,r,i){const s=ns;var l=t.filter(b=>!b.settled);if(r.length===0&&l.length===0){i(e.map(s));return}var f=Le,d=Je,v=Ff(),h=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(b=>b.promise)):null;function y(b){v();try{i(b)}catch(_){(d.f&Yn)===0&&ba(_,d)}f==null||f.deactivate(),Xs()}if(r.length===0){h.then(()=>y(e.map(s)));return}function k(){v(),Promise.all(r.map(b=>Kf(b))).then(b=>y([...e.map(s),...b])).catch(b=>ba(b,d))}h?h.then(k):k()}function Ff(){var t=Je,e=Ge,r=Xt,i=Le;return function(l=!0){Ln(t),cn(e),ya(r),l&&(i==null||i.activate())}}function Xs(){Ln(null),cn(null),ya(null)}function ns(t){var e=St|Tt,r=Ge!==null&&(Ge.f&St)!==0?Ge:null;return Je!==null&&(Je.f|=ka),{ctx:Xt,deps:null,effects:null,equals:au,f:e,fn:t,reactions:null,rv:0,v:wt,wv:0,parent:r??Je,ac:null}}function Kf(t,e,r){let i=Je;i===null&&sf();var s=i.b,l=void 0,f=Wr(wt),d=!Ge,v=new Map;return nd(()=>{var _;var h=Ql();l=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{y===Le&&y.committed&&y.deactivate(),Xs()})}catch(q){h.reject(q),Xs()}var y=Le;if(d){var k=s.is_rendered();s.update_pending_count(1),y.increment(k),(_=v.get(y))==null||_.reject(Or),v.delete(y),v.set(y,h)}const b=(q,j=void 0)=>{if(y.activate(),j)j!==Or&&(f.f|=pr,_a(f,j));else{(f.f&pr)!==0&&(f.f^=pr),_a(f,q);for(const[P,F]of v){if(v.delete(P),P===y)break;F.reject(Or)}}d&&(s.update_pending_count(-1),y.decrement(k))};h.promise.then(b,q=>b(null,q||"unknown"))}),Eu(()=>{for(const h of v.values())h.reject(Or)}),new Promise(h=>{function y(k){function b(){k===l?h(f):y(l)}k.then(b,b)}y(l)})}function gr(t){const e=ns(t);return Lu(e),e}function gu(t){const e=ns(t);return e.equals=iu,e}function Uf(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Ft(e[r])}}function Gf(t){for(var e=t.parent;e!==null;){if((e.f&St)===0)return(e.f&Yn)===0?e:null;e=e.parent}return null}function go(t){var e,r=Je;Ln(Gf(t));try{t.f&=~Hr,Uf(t),e=Bu(t)}finally{Ln(r)}return e}function mu(t){var e=go(t);if(!t.equals(e)&&(t.wv=qu(),(!(Le!=null&&Le.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){dt(t,bt);return}yr||(kt!==null?(yo()||Le!=null&&Le.is_fork)&&kt.set(t,e):vo(t))}function Hf(t){var e,r;if(t.effects!==null)for(const i of t.effects)(i.teardown||i.ac)&&((e=i.teardown)==null||e.call(i),(r=i.ac)==null||r.abort(Or),i.teardown=Jc,i.ac=null,ni(i,0),wo(i))}function yu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&wa(e)}let Qs=new Set;const mr=new Map;let bu=!1;function Wr(t,e){var r={f:0,v:t,reactions:null,equals:au,rv:0,wv:0};return r}function Re(t,e){const r=Wr(t);return Lu(r),r}function Wf(t,e=!1,r=!0){const i=Wr(t);return e||(i.equals=iu),i}function G(t,e,r=!1){Ge!==null&&(!xn||(Ge.f&fl)!==0)&&su()&&(Ge.f&(St|Xn|ho|fl))!==0&&(un===null||!ga.call(un,t))&&vf();let i=r?$t(e):e;return _a(t,i)}function _a(t,e){if(!t.equals(e)){var r=t.v;yr?mr.set(t,e):mr.set(t,r),t.v=e;var i=vr.ensure();if(i.capture(t,r),(t.f&St)!==0){const s=t;(t.f&Tt)!==0&&go(s),vo(s)}t.wv=qu(),_u(t,Tt),Je!==null&&(Je.f&bt)!==0&&(Je.f&(Tn|Xr))===0&&(nn===null?ad([t]):nn.push(t)),!i.is_fork&&Qs.size>0&&!bu&&$f()}return e}function $f(){bu=!1;for(const t of Qs)(t.f&bt)!==0&&dt(t,Sn),ui(t)&&wa(t);Qs.clear()}function Za(t){G(t,t.v+1)}function _u(t,e){var r=t.reactions;if(r!==null)for(var i=r.length,s=0;s<i;s++){var l=r[s],f=l.f,d=(f&Tt)===0;if(d&&dt(l,e),(f&St)!==0){var v=l;kt==null||kt.delete(v),(f&Hr)===0&&(f&ln&&(l.f|=Hr),_u(v,Sn))}else d&&((f&Xn)!==0&&mn!==null&&mn.add(l),kn(l))}}function $t(t){if(typeof t!="object"||t===null||Fr in t)return t;const e=Xl(t);if(e!==Qc&&e!==Zc)return t;var r=new Map,i=po(t),s=Re(0),l=Ur,f=d=>{if(Ur===l)return d();var v=Ge,h=Ur;cn(null),ml(l);var y=d();return cn(v),ml(h),y};return i&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&pf();var y=r.get(v);return y===void 0?f(()=>{var k=Re(h.value);return r.set(v,k),k}):G(y,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const y=f(()=>Re(wt));r.set(v,y),Za(s)}}else G(h,wt),Za(s);return!0},get(d,v,h){var _;if(v===Fr)return t;var y=r.get(v),k=v in d;if(y===void 0&&(!k||(_=la(d,v))!=null&&_.writable)&&(y=f(()=>{var q=$t(k?d[v]:wt),j=Re(q);return j}),r.set(v,y)),y!==void 0){var b=R(y);return b===wt?void 0:b}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var y=r.get(v);y&&(h.value=R(y))}else if(h===void 0){var k=r.get(v),b=k==null?void 0:k.v;if(k!==void 0&&b!==wt)return{enumerable:!0,configurable:!0,value:b,writable:!0}}return h},has(d,v){var b;if(v===Fr)return!0;var h=r.get(v),y=h!==void 0&&h.v!==wt||Reflect.has(d,v);if(h!==void 0||Je!==null&&(!y||(b=la(d,v))!=null&&b.writable)){h===void 0&&(h=f(()=>{var _=y?$t(d[v]):wt,q=Re(_);return q}),r.set(v,h));var k=R(h);if(k===wt)return!1}return y},set(d,v,h,y){var ne;var k=r.get(v),b=v in d;if(i&&v==="length")for(var _=h;_<k.v;_+=1){var q=r.get(_+"");q!==void 0?G(q,wt):_ in d&&(q=f(()=>Re(wt)),r.set(_+"",q))}if(k===void 0)(!b||(ne=la(d,v))!=null&&ne.writable)&&(k=f(()=>Re(void 0)),G(k,$t(h)),r.set(v,k));else{b=k.v!==wt;var j=f(()=>$t(h));G(k,j)}var P=Reflect.getOwnPropertyDescriptor(d,v);if(P!=null&&P.set&&P.set.call(y,h),!b){if(i&&typeof v=="string"){var F=r.get("length"),re=Number(v);Number.isInteger(re)&&re>=F.v&&G(F,re+1)}Za(s)}return!0},ownKeys(d){R(s);var v=Reflect.ownKeys(d).filter(k=>{var b=r.get(k);return b===void 0||b.v!==wt});for(var[h,y]of r)y.v!==wt&&!(h in d)&&v.push(h);return v},setPrototypeOf(){hf()}})}function pl(t){try{if(t!==null&&typeof t=="object"&&Fr in t)return t[Fr]}catch{}return t}function Yf(t,e){return Object.is(pl(t),pl(e))}var hl,wu,ku,xu;function Vf(){if(hl===void 0){hl=window,wu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;ku=la(e,"firstChild").get,xu=la(e,"nextSibling").get,cl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),cl(r)&&(r.__t=void 0)}}function Vn(t=""){return document.createTextNode(t)}function Wt(t){return ku.call(t)}function li(t){return xu.call(t)}function M(t,e){return Wt(t)}function Vt(t,e=!1){{var r=Wt(t);return r instanceof Comment&&r.data===""?li(r):r}}function K(t,e=1,r=!1){let i=t;for(;e--;)i=li(i);return i}function Xf(t){t.textContent=""}function Su(){return!1}function Qf(t,e,r){return document.createElementNS(ru,t,void 0)}let vl=!1;function Zf(){vl||(vl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function mo(t){var e=Ge,r=Je;cn(null),Ln(null);try{return t()}finally{cn(e),Ln(r)}}function Tu(t,e,r,i=r){t.addEventListener(e,()=>mo(r));const s=t.__on_r;s?t.__on_r=()=>{s(),i(!0)}:t.__on_r=()=>i(!0),Zf()}function Jf(t){Je===null&&(Ge===null&&cf(),uf()),yr&&lf()}function ed(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Qn(t,e,r){var i=Je;i!==null&&(i.f&Yt)!==0&&(t|=Yt);var s={ctx:Xt,deps:null,nodes:null,f:t|Tt|ln,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{wa(s)}catch(d){throw Ft(s),d}else e!==null&&kn(s);var l=s;if(r&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&ka)===0&&(l=l.first,(t&Xn)!==0&&(t&ma)!==0&&l!==null&&(l.f|=ma)),l!==null&&(l.parent=i,i!==null&&ed(l,i),Ge!==null&&(Ge.f&St)!==0&&(t&Xr)===0)){var f=Ge;(f.effects??(f.effects=[])).push(l)}return s}function yo(){return Ge!==null&&!xn}function Eu(t){const e=Qn(es,null,!1);return dt(e,bt),e.teardown=t,e}function Hi(t){Jf();var e=Je.f,r=!Ge&&(e&Tn)!==0&&(e&oi)===0;if(r){var i=Xt;(i.e??(i.e=[])).push(t)}else return Au(t)}function Au(t){return Qn(ti|tf,t,!1)}function td(t){vr.ensure();const e=Qn(Xr|ka,t,!0);return(r={})=>new Promise(i=>{r.outro?Kr(e,()=>{Ft(e),i(void 0)}):(Ft(e),i(void 0))})}function Iu(t){return Qn(ti,t,!1)}function nd(t){return Qn(ho|ka,t,!0)}function bo(t,e=0){return Qn(es|e,t,!0)}function we(t,e=[],r=[],i=[]){zf(i,e,r,s=>{Qn(es,()=>t(...s.map(R)),!0)})}function _o(t,e=0){var r=Qn(Xn|e,t,!0);return r}function sn(t){return Qn(Tn|ka,t,!0)}function Cu(t){var e=t.teardown;if(e!==null){const r=yr,i=Ge;gl(!0),cn(null);try{e.call(null)}finally{gl(r),cn(i)}}}function wo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const s=r.ac;s!==null&&mo(()=>{s.abort(Or)});var i=r.next;(r.f&Xr)!==0?r.parent=null:Ft(r,e),r=i}}function rd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Tn)===0&&Ft(e),e=r}}function Ft(t,e=!0){var r=!1;(e||(t.f&eu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Pu(t.nodes.start,t.nodes.end),r=!0),wo(t,e&&!r),ni(t,0),dt(t,Yn);var i=t.nodes&&t.nodes.t;if(i!==null)for(const l of i)l.stop();Cu(t);var s=t.parent;s!==null&&s.first!==null&&Ru(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Pu(t,e){for(;t!==null;){var r=t===e?null:li(t);t.remove(),t=r}}function Ru(t){var e=t.parent,r=t.prev,i=t.next;r!==null&&(r.next=i),i!==null&&(i.prev=r),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=r))}function Kr(t,e,r=!0){var i=[];Ou(t,i,!0);var s=()=>{r&&Ft(t),e&&e()},l=i.length;if(l>0){var f=()=>--l||s();for(var d of i)d.out(f)}else s()}function Ou(t,e,r){if((t.f&Yt)===0){t.f^=Yt;var i=t.nodes&&t.nodes.t;if(i!==null)for(const d of i)(d.is_global||r)&&e.push(d);for(var s=t.first;s!==null;){var l=s.next,f=(s.f&ma)!==0||(s.f&Tn)!==0&&(t.f&Xn)!==0;Ou(s,e,f?r:!1),s=l}}}function ko(t){Du(t,!0)}function Du(t,e){if((t.f&Yt)!==0){t.f^=Yt,(t.f&bt)===0&&(dt(t,Tt),kn(t));for(var r=t.first;r!==null;){var i=r.next,s=(r.f&ma)!==0||(r.f&Tn)!==0;Du(r,s?e:!1),r=i}var l=t.nodes&&t.nodes.t;if(l!==null)for(const f of l)(f.is_global||e)&&f.in()}}function Mu(t,e){if(t.nodes)for(var r=t.nodes.start,i=t.nodes.end;r!==null;){var s=r===i?null:li(r);e.append(r),r=s}}let zi=!1,yr=!1;function gl(t){yr=t}let Ge=null,xn=!1;function cn(t){Ge=t}let Je=null;function Ln(t){Je=t}let un=null;function Lu(t){Ge!==null&&(un===null?un=[t]:un.push(t))}let zt=null,Gt=0,nn=null;function ad(t){nn=t}let Nu=1,Mr=0,Ur=Mr;function ml(t){Ur=t}function qu(){return++Nu}function ui(t){var e=t.f;if((e&Tt)!==0)return!0;if(e&St&&(t.f&=~Hr),(e&Sn)!==0){for(var r=t.deps,i=r.length,s=0;s<i;s++){var l=r[s];if(ui(l)&&mu(l),l.wv>t.wv)return!0}(e&ln)!==0&&kt===null&&dt(t,bt)}return!1}function ju(t,e,r=!0){var i=t.reactions;if(i!==null&&!(un!==null&&ga.call(un,t)))for(var s=0;s<i.length;s++){var l=i[s];(l.f&St)!==0?ju(l,e,!1):e===l&&(r?dt(l,Tt):(l.f&bt)!==0&&dt(l,Sn),kn(l))}}function Bu(t){var j;var e=zt,r=Gt,i=nn,s=Ge,l=un,f=Xt,d=xn,v=Ur,h=t.f;zt=null,Gt=0,nn=null,Ge=(h&(Tn|Xr))===0?t:null,un=null,ya(t.ctx),xn=!1,Ur=++Mr,t.ac!==null&&(mo(()=>{t.ac.abort(Or)}),t.ac=null);try{t.f|=Gs;var y=t.fn,k=y();t.f|=oi;var b=t.deps,_=Le==null?void 0:Le.is_fork;if(zt!==null){var q;if(_||ni(t,Gt),b!==null&&Gt>0)for(b.length=Gt+zt.length,q=0;q<zt.length;q++)b[Gt+q]=zt[q];else t.deps=b=zt;if(yo()&&(t.f&ln)!==0)for(q=Gt;q<b.length;q++)((j=b[q]).reactions??(j.reactions=[])).push(t)}else!_&&b!==null&&Gt<b.length&&(ni(t,Gt),b.length=Gt);if(su()&&nn!==null&&!xn&&b!==null&&(t.f&(St|Sn|Tt))===0)for(q=0;q<nn.length;q++)ju(nn[q],t);if(s!==null&&s!==t){if(Mr++,s.deps!==null)for(let P=0;P<r;P+=1)s.deps[P].rv=Mr;if(e!==null)for(const P of e)P.rv=Mr;nn!==null&&(i===null?i=nn:i.push(...nn))}return(t.f&pr)!==0&&(t.f^=pr),k}catch(P){return lu(P)}finally{t.f^=Gs,zt=e,Gt=r,nn=i,Ge=s,un=l,ya(f),xn=d,Ur=v}}function id(t,e){let r=e.reactions;if(r!==null){var i=Yc.call(r,t);if(i!==-1){var s=r.length-1;s===0?r=e.reactions=null:(r[i]=r[s],r.pop())}}if(r===null&&(e.f&St)!==0&&(zt===null||!ga.call(zt,e))){var l=e;(l.f&ln)!==0&&(l.f^=ln,l.f&=~Hr),vo(l),Hf(l),ni(l,0)}}function ni(t,e){var r=t.deps;if(r!==null)for(var i=e;i<r.length;i++)id(t,r[i])}function wa(t){var e=t.f;if((e&Yn)===0){dt(t,bt);var r=Je,i=zi;Je=t,zi=!0;try{(e&(Xn|Zl))!==0?rd(t):wo(t),Cu(t);var s=Bu(t);t.teardown=typeof s=="function"?s:null,t.wv=Nu;var l;Us&&Cf&&(t.f&Tt)!==0&&t.deps}finally{zi=i,Je=r}}}async function zu(){await Promise.resolve(),Of()}function R(t){var e=t.f,r=(e&St)!==0;if(Ge!==null&&!xn){var i=Je!==null&&(Je.f&Yn)!==0;if(!i&&(un===null||!ga.call(un,t))){var s=Ge.deps;if((Ge.f&Gs)!==0)t.rv<Mr&&(t.rv=Mr,zt===null&&s!==null&&s[Gt]===t?Gt++:zt===null?zt=[t]:zt.push(t));else{(Ge.deps??(Ge.deps=[])).push(t);var l=t.reactions;l===null?t.reactions=[Ge]:ga.call(l,Ge)||l.push(Ge)}}}if(yr&&mr.has(t))return mr.get(t);if(r){var f=t;if(yr){var d=f.v;return((f.f&bt)===0&&f.reactions!==null||Ku(f))&&(d=go(f)),mr.set(f,d),d}var v=(f.f&ln)===0&&!xn&&Ge!==null&&(zi||(Ge.f&ln)!==0),h=(f.f&oi)===0;ui(f)&&(v&&(f.f|=ln),mu(f)),v&&!h&&(yu(f),Fu(f))}if(kt!=null&&kt.has(t))return kt.get(t);if((t.f&pr)!==0)throw t.v;return t.v}function Fu(t){if(t.f|=ln,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&St)!==0&&(e.f&ln)===0&&(yu(e),Fu(e))}function Ku(t){if(t.v===wt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(mr.has(e)||(e.f&St)!==0&&Ku(e))return!0;return!1}function ci(t){var e=xn;try{return xn=!0,t()}finally{xn=e}}const sd=["touchstart","touchmove"];function od(t){return sd.includes(t)}const Uu=new Set,Zs=new Set;function qn(t){for(var e=0;e<t.length;e++)Uu.add(t[e]);for(var r of Zs)r(t)}let yl=null;function bl(t){var P;var e=this,r=e.ownerDocument,i=t.type,s=((P=t.composedPath)==null?void 0:P.call(t))||[],l=s[0]||t.target;yl=t;var f=0,d=yl===t&&t.__root;if(d){var v=s.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=s.indexOf(e);if(h===-1)return;v<=h&&(f=v)}if(l=s[f]||t.target,l!==e){Vc(t,"currentTarget",{configurable:!0,get(){return l||r}});var y=Ge,k=Je;cn(null),Ln(null);try{for(var b,_=[];l!==null;){var q=l.assignedSlot||l.parentNode||l.host||null;try{var j=l["__"+i];j!=null&&(!l.disabled||t.target===l)&&j.call(l,t)}catch(F){b?_.push(F):b=F}if(t.cancelBubble||q===e||q===null)break;l=q}if(b){for(let F of _)queueMicrotask(()=>{throw F});throw b}}finally{t.__root=e,delete t.currentTarget,cn(y),Ln(k)}}}var $l,Yl;const Rs=(Yl=($l=globalThis==null?void 0:globalThis.window)==null?void 0:$l.trustedTypes)==null?void 0:Yl.createPolicy("svelte-trusted-html",{createHTML:t=>t});function ld(t){return(Rs==null?void 0:Rs.createHTML(t))??t}function xo(t,e=!1){var r=Qf("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?ld(t):t,r.content}function $r(t,e){var r=Je;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function te(t,e){var r=(e&nu)!==0,i=(e&Tf)!==0,s,l=!t.startsWith("<!>");return()=>{s===void 0&&(s=xo(l?t:"<!>"+t,!0),r||(s=Wt(s)));var f=i||wu?document.importNode(s,!0):s.cloneNode(!0);if(r){var d=Wt(f),v=f.lastChild;$r(d,v)}else $r(f,f);return f}}function ud(t,e,r="svg"){var i=!t.startsWith("<!>"),s=(e&nu)!==0,l=`<${r}>${i?t:"<!>"+t}</${r}>`,f;return()=>{if(!f){var d=xo(l,!0),v=Wt(d);if(s)for(f=document.createDocumentFragment();Wt(v);)f.appendChild(Wt(v));else f=Wt(v)}var h=f.cloneNode(!0);if(s){var y=Wt(h),k=h.lastChild;$r(y,k)}else $r(h,h);return h}}function Gu(t,e){return ud(t,e,"svg")}function _l(t=""){{var e=Vn(t+"");return $r(e,e),e}}function Hu(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Vn();return t.append(e,r),$r(e,r),t}function Q(t,e){t!==null&&t.before(e)}function de(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function cd(t,e){return fd(t,e)}const Oi=new Map;function fd(t,{target:e,anchor:r,props:i={},events:s,context:l,intro:f=!0}){Vf();var d=new Set,v=k=>{for(var b=0;b<k.length;b++){var _=k[b];if(!d.has(_)){d.add(_);var q=od(_);for(const F of[e,document]){var j=Oi.get(F);j===void 0&&(j=new Map,Oi.set(F,j));var P=j.get(_);P===void 0?(F.addEventListener(_,bl,{passive:q}),j.set(_,1)):j.set(_,P+1)}}}};v(Ji(Uu)),Zs.add(v);var h=void 0,y=td(()=>{var k=r??e.appendChild(Vn());return Nf(k,{pending:()=>{}},b=>{Et({});var _=Xt;l&&(_.c=l),s&&(i.$$events=s),h=t(b,i)||{},At()}),()=>{var j;for(var b of d)for(const P of[e,document]){var _=Oi.get(P),q=_.get(b);--q==0?(P.removeEventListener(b,bl),_.delete(b),_.size===0&&Oi.delete(P)):_.set(b,q)}Zs.delete(v),k!==r&&((j=k.parentNode)==null||j.removeChild(k))}});return dd.set(h,y),h}let dd=new WeakMap;var bn,Mn,Ht,zr,ii,si,Zi;class pd{constructor(e,r=!0){Ke(this,"anchor");Ue(this,bn,new Map);Ue(this,Mn,new Map);Ue(this,Ht,new Map);Ue(this,zr,new Set);Ue(this,ii,!0);Ue(this,si,()=>{var e=Le;if(z(this,bn).has(e)){var r=z(this,bn).get(e),i=z(this,Mn).get(r);if(i)ko(i),z(this,zr).delete(r);else{var s=z(this,Ht).get(r);s&&(z(this,Mn).set(r,s.effect),z(this,Ht).delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),i=s.effect)}for(const[l,f]of z(this,bn)){if(z(this,bn).delete(l),l===e)break;const d=z(this,Ht).get(f);d&&(Ft(d.effect),z(this,Ht).delete(f))}for(const[l,f]of z(this,Mn)){if(l===r||z(this,zr).has(l))continue;const d=()=>{if(Array.from(z(this,bn).values()).includes(l)){var h=document.createDocumentFragment();Mu(f,h),h.append(Vn()),z(this,Ht).set(l,{effect:f,fragment:h})}else Ft(f);z(this,zr).delete(l),z(this,Mn).delete(l)};z(this,ii)||!i?(z(this,zr).add(l),Kr(f,d,!1)):d()}}});Ue(this,Zi,e=>{z(this,bn).delete(e);const r=Array.from(z(this,bn).values());for(const[i,s]of z(this,Ht))r.includes(i)||(Ft(s.effect),z(this,Ht).delete(i))});this.anchor=e,Be(this,ii,r)}ensure(e,r){var i=Le,s=Su();if(r&&!z(this,Mn).has(e)&&!z(this,Ht).has(e))if(s){var l=document.createDocumentFragment(),f=Vn();l.append(f),z(this,Ht).set(e,{effect:sn(()=>r(f)),fragment:l})}else z(this,Mn).set(e,sn(()=>r(this.anchor)));if(z(this,bn).set(i,e),s){for(const[d,v]of z(this,Mn))d===e?i.unskip_effect(v):i.skip_effect(v);for(const[d,v]of z(this,Ht))d===e?i.unskip_effect(v.effect):i.skip_effect(v.effect);i.oncommit(z(this,si)),i.ondiscard(z(this,Zi))}else z(this,si).call(this)}}bn=new WeakMap,Mn=new WeakMap,Ht=new WeakMap,zr=new WeakMap,ii=new WeakMap,si=new WeakMap,Zi=new WeakMap;function Ae(t,e,r=!1){var i=new pd(t),s=r?ma:0;function l(f,d){i.ensure(f,d)}_o(()=>{var f=!1;e((d,v=0)=>{f=!0,l(v,d)}),f||l(!1,null)},s)}function xa(t,e){return e}function hd(t,e,r){for(var i=[],s=e.length,l,f=e.length,d=0;d<s;d++){let k=e[d];Kr(k,()=>{if(l){if(l.pending.delete(k),l.done.add(k),l.pending.size===0){var b=t.outrogroups;Js(Ji(l.done)),b.delete(l),b.size===0&&(t.outrogroups=null)}}else f-=1},!1)}if(f===0){var v=i.length===0&&r!==null;if(v){var h=r,y=h.parentNode;Xf(y),y.append(h),t.items.clear()}Js(e,!v)}else l={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(l)}function Js(t,e=!0){for(var r=0;r<t.length;r++)Ft(t[r],e)}var wl;function Sa(t,e,r,i,s,l=null){var f=t,d=new Map,v=(e&tu)!==0;if(v){var h=t;f=h.appendChild(Vn())}var y=null,k=gu(()=>{var F=r();return po(F)?F:F==null?[]:Ji(F)}),b,_=!0;function q(){P.fallback=y,vd(P,b,f,e,i),y!==null&&(b.length===0?(y.f&$n)===0?ko(y):(y.f^=$n,Va(y,null,f)):Kr(y,()=>{y=null}))}var j=_o(()=>{b=R(k);for(var F=b.length,re=new Set,ne=Le,$=Su(),J=0;J<F;J+=1){var ve=b[J],W=i(ve,J),Z=_?null:d.get(W);Z?(Z.v&&_a(Z.v,ve),Z.i&&_a(Z.i,J),$&&ne.unskip_effect(Z.e)):(Z=gd(d,_?f:wl??(wl=Vn()),ve,W,J,s,e,r),_||(Z.e.f|=$n),d.set(W,Z)),re.add(W)}if(F===0&&l&&!y&&(_?y=sn(()=>l(f)):(y=sn(()=>l(wl??(wl=Vn()))),y.f|=$n)),F>re.size&&of(),!_)if($){for(const[Ee,Ce]of d)re.has(Ee)||ne.skip_effect(Ce.e);ne.oncommit(q),ne.ondiscard(()=>{})}else q();R(k)}),P={effect:j,items:d,outrogroups:null,fallback:y};_=!1}function Fa(t){for(;t!==null&&(t.f&Tn)===0;)t=t.next;return t}function vd(t,e,r,i,s){var Ce,ie,ce,be,Me,xe,Se,Pe,B;var l=(i&bf)!==0,f=e.length,d=t.items,v=Fa(t.effect.first),h,y=null,k,b=[],_=[],q,j,P,F;if(l)for(F=0;F<f;F+=1)q=e[F],j=s(q,F),P=d.get(j).e,(P.f&$n)===0&&((ie=(Ce=P.nodes)==null?void 0:Ce.a)==null||ie.measure(),(k??(k=new Set)).add(P));for(F=0;F<f;F+=1){if(q=e[F],j=s(q,F),P=d.get(j).e,t.outrogroups!==null)for(const H of t.outrogroups)H.pending.delete(P),H.done.delete(P);if((P.f&$n)!==0)if(P.f^=$n,P===v)Va(P,null,r);else{var re=y?y.next:v;P===t.effect.last&&(t.effect.last=P.prev),P.prev&&(P.prev.next=P.next),P.next&&(P.next.prev=P.prev),ur(t,y,P),ur(t,P,re),Va(P,re,r),y=P,b=[],_=[],v=Fa(y.next);continue}if((P.f&Yt)!==0&&(ko(P),l&&((be=(ce=P.nodes)==null?void 0:ce.a)==null||be.unfix(),(k??(k=new Set)).delete(P))),P!==v){if(h!==void 0&&h.has(P)){if(b.length<_.length){var ne=_[0],$;y=ne.prev;var J=b[0],ve=b[b.length-1];for($=0;$<b.length;$+=1)Va(b[$],ne,r);for($=0;$<_.length;$+=1)h.delete(_[$]);ur(t,J.prev,ve.next),ur(t,y,J),ur(t,ve,ne),v=ne,y=ve,F-=1,b=[],_=[]}else h.delete(P),Va(P,v,r),ur(t,P.prev,P.next),ur(t,P,y===null?t.effect.first:y.next),ur(t,y,P),y=P;continue}for(b=[],_=[];v!==null&&v!==P;)(h??(h=new Set)).add(v),_.push(v),v=Fa(v.next);if(v===null)continue}(P.f&$n)===0&&b.push(P),y=P,v=Fa(P.next)}if(t.outrogroups!==null){for(const H of t.outrogroups)H.pending.size===0&&(Js(Ji(H.done)),(Me=t.outrogroups)==null||Me.delete(H));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var W=[];if(h!==void 0)for(P of h)(P.f&Yt)===0&&W.push(P);for(;v!==null;)(v.f&Yt)===0&&v!==t.fallback&&W.push(v),v=Fa(v.next);var Z=W.length;if(Z>0){var Ee=(i&tu)!==0&&f===0?r:null;if(l){for(F=0;F<Z;F+=1)(Se=(xe=W[F].nodes)==null?void 0:xe.a)==null||Se.measure();for(F=0;F<Z;F+=1)(B=(Pe=W[F].nodes)==null?void 0:Pe.a)==null||B.fix()}hd(t,W,Ee)}}l&&hr(()=>{var H,ue;if(k!==void 0)for(P of k)(ue=(H=P.nodes)==null?void 0:H.a)==null||ue.apply()})}function gd(t,e,r,i,s,l,f,d){var v=(f&mf)!==0?(f&_f)===0?Wf(r,!1,!1):Wr(r):null,h=(f&yf)!==0?Wr(s):null;return{v,i:h,e:sn(()=>(l(e,v??r,h??s,d),()=>{t.delete(i)}))}}function Va(t,e,r){if(t.nodes)for(var i=t.nodes.start,s=t.nodes.end,l=e&&(e.f&$n)===0?e.nodes.start:r;i!==null;){var f=li(i);if(l.before(i),i===s)return;i=f}}function ur(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function md(t,e,r=!1,i=!1,s=!1){var l=t,f="";we(()=>{var d=Je;if(f!==(f=e()??"")&&(d.nodes!==null&&(Pu(d.nodes.start,d.nodes.end),d.nodes=null),f!=="")){var v=f+"";r?v=`<svg>${v}</svg>`:i&&(v=`<math>${v}</math>`);var h=xo(v);if((r||i)&&(h=Wt(h)),$r(Wt(h),h.lastChild),r||i)for(;Wt(h);)l.before(Wt(h));else l.before(h)}})}const kl=[...` 	
\r\fÂ \v\uFEFF`];function yd(t,e,r){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),r){for(var s in r)if(r[s])i=i?i+" "+s:s;else if(i.length)for(var l=s.length,f=0;(f=i.indexOf(s,f))>=0;){var d=f+l;(f===0||kl.includes(i[f-1]))&&(d===i.length||kl.includes(i[d]))?i=(f===0?"":i.substring(0,f))+i.substring(d+1):f=d}}return i===""?null:i}function xl(t,e=!1){var r=e?" !important;":";",i="";for(var s in t){var l=t[s];l!=null&&l!==""&&(i+=" "+s+": "+l+r)}return i}function Os(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function bd(t,e){if(e){var r="",i,s;if(Array.isArray(e)?(i=e[0],s=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var l=!1,f=0,d=!1,v=[];i&&v.push(...Object.keys(i).map(Os)),s&&v.push(...Object.keys(s).map(Os));var h=0,y=-1;const j=t.length;for(var k=0;k<j;k++){var b=t[k];if(d?b==="/"&&t[k-1]==="*"&&(d=!1):l?l===b&&(l=!1):b==="/"&&t[k+1]==="*"?d=!0:b==='"'||b==="'"?l=b:b==="("?f++:b===")"&&f--,!d&&l===!1&&f===0){if(b===":"&&y===-1)y=k;else if(b===";"||k===j-1){if(y!==-1){var _=Os(t.substring(h,y).trim());if(!v.includes(_)){b!==";"&&k++;var q=t.substring(h,k).trim();r+=" "+q+";"}}h=k+1,y=-1}}}}return i&&(r+=xl(i)),s&&(r+=xl(s,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Gr(t,e,r,i,s,l){var f=t.__className;if(f!==r||f===void 0){var d=yd(r,i,l);d==null?t.removeAttribute("class"):t.className=d,t.__className=r}else if(l&&s!==l)for(var v in l){var h=!!l[v];(s==null||h!==!!s[v])&&t.classList.toggle(v,h)}return l}function Ds(t,e={},r,i){for(var s in r){var l=r[s];e[s]!==l&&(r[s]==null?t.style.removeProperty(s):t.style.setProperty(s,l,i))}}function Wi(t,e,r,i){var s=t.__style;if(s!==e){var l=bd(e,i);l==null?t.removeAttribute("style"):t.style.cssText=l,t.__style=e}else i&&(Array.isArray(i)?(Ds(t,r==null?void 0:r[0],i[0]),Ds(t,r==null?void 0:r[1],i[1],"important")):Ds(t,r,i));return i}function Wu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!po(e))return Ef();for(var i of t.options)i.selected=e.includes(Ja(i));return}for(i of t.options){var s=Ja(i);if(Yf(s,e)){i.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function _d(t){var e=new MutationObserver(()=>{Wu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Eu(()=>{e.disconnect()})}function $u(t,e,r=e){var i=new WeakSet,s=!0;Tu(t,"change",l=>{var f=l?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(f),Ja);else{var v=t.querySelector(f)??t.querySelector("option:not([disabled])");d=v&&Ja(v)}r(d),Le!==null&&i.add(Le)}),Iu(()=>{var l=e();if(t===document.activeElement){var f=Gi??Le;if(i.has(f))return}if(Wu(t,l,s),s&&l===void 0){var d=t.querySelector(":checked");d!==null&&(l=Ja(d),r(l))}t.__value=l,s=!1}),_d(t)}function Ja(t){return"__value"in t?t.__value:t.value}const wd=Symbol("is custom element"),kd=Symbol("is html");function Yu(t,e,r,i){var s=xd(t);s[e]!==(s[e]=r)&&(e==="loading"&&(t[rf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Sd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function xd(t){return t.__attributes??(t.__attributes={[wd]:t.nodeName.includes("-"),[kd]:t.namespaceURI===ru})}var Sl=new Map;function Sd(t){var e=t.getAttribute("is")||t.nodeName,r=Sl.get(e);if(r)return r;Sl.set(e,r=[]);for(var i,s=t,l=Element.prototype;l!==s;){i=Xc(s);for(var f in i)i[f].set&&r.push(f);s=Xl(s)}return r}function So(t,e,r=e){var i=new WeakSet;Tu(t,"input",async s=>{var l=s?t.defaultValue:t.value;if(l=Ms(t)?Ls(l):l,r(l),Le!==null&&i.add(Le),await zu(),l!==(l=e())){var f=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=l??"",d!==null){var h=t.value.length;f===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=f,t.selectionEnd=Math.min(d,h))}}}),ci(e)==null&&t.value&&(r(Ms(t)?Ls(t.value):t.value),Le!==null&&i.add(Le)),bo(()=>{var s=e();if(t===document.activeElement){var l=Gi??Le;if(i.has(l))return}Ms(t)&&s===Ls(t.value)||t.type==="date"&&!s&&!t.value||s!==t.value&&(t.value=s??"")})}function Ms(t){var e=t.type;return e==="number"||e==="range"}function Ls(t){return t===""?null:+t}function Tl(t,e){return t===e||(t==null?void 0:t[Fr])===e}function Vu(t={},e,r,i){return Iu(()=>{var s,l;return bo(()=>{s=l,l=[],ci(()=>{t!==r(...l)&&(e(t,...l),s&&Tl(r(...s),t)&&e(null,...s))})}),()=>{hr(()=>{l&&Tl(r(...l),t)&&e(null,...l)})}}),t}let Di=!1;function Td(t){var e=Di;try{return Di=!1,[t(),Di]}finally{Di=e}}function Ne(t,e,r,i){var re;var s=(r&xf)!==0,l=(r&Sf)!==0,f=i,d=!0,v=()=>(d&&(d=!1,f=l?ci(i):i),f),h;if(s){var y=Fr in t||nf in t;h=((re=la(t,e))==null?void 0:re.set)??(y&&e in t?ne=>t[e]=ne:void 0)}var k,b=!1;s?[k,b]=Td(()=>t[e]):k=t[e],k===void 0&&i!==void 0&&(k=v(),h&&(df(),h(k)));var _;if(_=()=>{var ne=t[e];return ne===void 0?v():(d=!0,ne)},(r&kf)===0)return _;if(h){var q=t.$$legacy;return(function(ne,$){return arguments.length>0?((!$||q||b)&&h($?_():ne),ne):_()})}var j=!1,P=((r&wf)!==0?ns:gu)(()=>(j=!1,_()));s&&R(P);var F=Je;return(function(ne,$){if(arguments.length>0){const J=$?R(P):s?$t(ne):ne;return G(P,J),j=!0,f!==void 0&&(f=J),ne}return yr&&j||(F.f&Yn)!==0?P.v:R(P)})}function Rt(t){Xt===null&&af(),Hi(()=>{const e=ci(t);if(typeof e=="function")return e})}const Ed="5";var Vl;typeof window<"u"&&((Vl=window.__svelte??(window.__svelte={})).v??(Vl.v=new Set)).add(Ed);const eo=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];var Ad=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Id(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fi={exports:{}},Cd=Fi.exports,El;function Pd(){return El||(El=1,(function(t,e){((r,i)=>{t.exports=i()})(Cd,function(){var r=function(n,a){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(o,u){o.__proto__=u}:function(o,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(o[c]=u[c])}))(n,a)},i=function(){return(i=Object.assign||function(n){for(var a,o=1,u=arguments.length;o<u;o++)for(var c in a=arguments[o])Object.prototype.hasOwnProperty.call(a,c)&&(n[c]=a[c]);return n}).apply(this,arguments)};function s(n,a,o){for(var u,c=0,p=a.length;c<p;c++)!u&&c in a||((u=u||Array.prototype.slice.call(a,0,c))[c]=a[c]);return n.concat(u||Array.prototype.slice.call(a))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ad,f=Object.keys,d=Array.isArray;function v(n,a){return typeof a=="object"&&f(a).forEach(function(o){n[o]=a[o]}),n}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function k(n,a){return y.call(n,a)}function b(n,a){typeof a=="function"&&(a=a(h(n))),(typeof Reflect>"u"?f:Reflect.ownKeys)(a).forEach(function(o){q(n,o,a[o])})}var _=Object.defineProperty;function q(n,a,o,u){_(n,a,v(o&&k(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function j(n){return{from:function(a){return n.prototype=Object.create(a.prototype),q(n.prototype,"constructor",n),{extend:b.bind(null,n.prototype)}}}}var P=Object.getOwnPropertyDescriptor,F=[].slice;function re(n,a,o){return F.call(n,a,o)}function ne(n,a){return a(n)}function $(n){if(!n)throw new Error("Assertion Failed")}function J(n){l.setImmediate?setImmediate(n):setTimeout(n,0)}function ve(n,a){if(typeof a=="string"&&k(n,a))return n[a];if(!a)return n;if(typeof a!="string"){for(var o=[],u=0,c=a.length;u<c;++u){var p=ve(n,a[u]);o.push(p)}return o}var g,m=a.indexOf(".");return m===-1||(g=n[a.substr(0,m)])==null?void 0:ve(g,a.substr(m+1))}function W(n,a,o){if(n&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof a!="string"&&"length"in a){$(typeof o!="string"&&"length"in o);for(var u=0,c=a.length;u<c;++u)W(n,a[u],o[u])}else{var p,g,m=a.indexOf(".");m!==-1?(p=a.substr(0,m),(m=a.substr(m+1))===""?o===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=o:W(g=(g=n[p])&&k(n,p)?g:n[p]={},m,o)):o===void 0?d(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=o}}function Z(n){var a,o={};for(a in n)k(n,a)&&(o[a]=n[a]);return o}var Ee=[].concat;function Ce(n){return Ee.apply([],n)}var Oe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ce([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(a){return a+n+"Array"})}))).filter(function(n){return l[n]}),ie=new Set(Oe.map(function(n){return l[n]})),ce=null;function be(n){return ce=new WeakMap,n=(function a(o){if(!o||typeof o!="object")return o;var u=ce.get(o);if(u)return u;if(d(o)){u=[],ce.set(o,u);for(var c=0,p=o.length;c<p;++c)u.push(a(o[c]))}else if(ie.has(o.constructor))u=o;else{var g,m=h(o);for(g in u=m===Object.prototype?{}:Object.create(m),ce.set(o,u),o)k(o,g)&&(u[g]=a(o[g]))}return u})(n),ce=null,n}var Me={}.toString;function xe(n){return Me.call(n).slice(8,-1)}var Se=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Pe=typeof Se=="symbol"?function(n){var a;return n!=null&&(a=n[Se])&&a.apply(n)}:function(){return null};function B(n,a){a=n.indexOf(a),0<=a&&n.splice(a,1)}var H={};function ue(n){var a,o,u,c;if(arguments.length===1){if(d(n))return n.slice();if(this===H&&typeof n=="string")return[n];if(c=Pe(n))for(o=[];!(u=c.next()).done;)o.push(u.value);else{if(n==null)return[n];if(typeof(a=n.length)!="number")return[n];for(o=new Array(a);a--;)o[a]=n[a]}}else for(a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return o}var pe=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Oe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],pt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Oe),qe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function De(n,a){this.name=n,this.message=a}function ge(n,a){return n+". Errors: "+Object.keys(a).map(function(o){return a[o].toString()}).filter(function(o,u,c){return c.indexOf(o)===u}).join(`
`)}function et(n,a,o,u){this.failures=a,this.failedKeys=u,this.successCount=o,this.message=ge(n,a)}function Te(n,a){this.name="BulkError",this.failures=Object.keys(a).map(function(o){return a[o]}),this.failuresByPos=a,this.message=ge(n,this.failures)}j(De).from(Error).extend({toString:function(){return this.name+": "+this.message}}),j(et).from(De),j(Te).from(De);var at=pt.reduce(function(n,a){return n[a]=a+"Error",n},{}),vt=De,ke=pt.reduce(function(n,a){var o=a+"Error";function u(c,p){this.name=o,c?typeof c=="string"?(this.message="".concat(c).concat(p?`
 `+p:""),this.inner=p||null):typeof c=="object"&&(this.message="".concat(c.name," ").concat(c.message),this.inner=c):(this.message=qe[a]||o,this.inner=null)}return j(u).from(vt),n[a]=u,n},{}),Ta=(ke.Syntax=SyntaxError,ke.Type=TypeError,ke.Range=RangeError,Oe.reduce(function(n,a){return n[a+"Error"]=ke[a],n},{}));Oe=pt.reduce(function(n,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(n[a+"Error"]=ke[a]),n},{});function Qe(){}function Zt(n){return n}function Zr(n,a){return n==null||n===Zt?a:function(o){return a(n(o))}}function Ot(n,a){return function(){n.apply(this,arguments),a.apply(this,arguments)}}function Ea(n,a){return n===Qe?a:function(){var o=n.apply(this,arguments),u=(o!==void 0&&(arguments[0]=o),this.onsuccess),c=this.onerror,p=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Ot(u,this.onsuccess):u),c&&(this.onerror=this.onerror?Ot(c,this.onerror):c),p!==void 0?p:o}}function Aa(n,a){return n===Qe?a:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Ot(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Ot(u,this.onerror):u)}}function Zn(n,a){return n===Qe?a:function(c){var u=n.apply(this,arguments),c=(v(c,u),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?Ot(c,this.onsuccess):c),p&&(this.onerror=this.onerror?Ot(p,this.onerror):p),u===void 0?g===void 0?void 0:g:v(u,g)}}function Jr(n,a){return n===Qe?a:function(){return a.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function Jn(n,a){return n===Qe?a:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,c=arguments.length,p=new Array(c);c--;)p[c]=arguments[c];return o.then(function(){return a.apply(u,p)})}return a.apply(this,arguments)}}Oe.ModifyError=et,Oe.DexieError=De,Oe.BulkError=Te;var Kt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ia(n){Kt=n}var br={},ea=100,dn=typeof Promise>"u"?[]:(pt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[dn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(dn),pt]:[pt,h(pt),pt]),pt=dn[0],sa=dn[1],sa=sa&&sa.then,gt=pt&&pt.constructor,_r=!!dn[2],er=function(n,a){Bn.push([n,a]),tr&&(queueMicrotask(ar),tr=!1)},ta=!0,tr=!0,En=[],jn=[],nr=Zt,mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Qe,pgp:!1,env:{},finalize:Qe},ye=mt,Bn=[],pn=0,na=[];function le(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=ye;if(typeof n!="function"){if(n!==br)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&zn(this,this._value)}else this._state=null,this._value=null,++a.ref,(function o(u,c){try{c(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&ir();p&&typeof p.then=="function"?o(u,function(m,T){p instanceof le?p._then(m,T):p.then(m,T)}):(u._state=!0,u._value=p,pi(u)),g&&Fn()}},zn.bind(null,u))}catch(p){zn(u,p)}})(this,n)}var rr={get:function(){var n=ye,a=Sr;function o(u,c){var p=this,g=!n.global&&(n!==ye||a!==Sr),m=g&&!vn(),T=new le(function(D,E){Ca(p,new di(x(u,n,g,m),x(c,n,g,m),D,E,n))});return this._consoleTask&&(T._consoleTask=this._consoleTask),T}return o.prototype=br,o},set:function(n){q(this,"then",n&&n.prototype===br?rr:{get:function(){return n},set:rr.set})}};function di(n,a,o,u,c){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof a=="function"?a:null,this.resolve=o,this.reject=u,this.psd=c}function zn(n,a){var o,u;jn.push(a),n._state===null&&(o=n._lib&&ir(),a=nr(a),n._state=!1,n._value=a,u=n,En.some(function(c){return c._value===u._value})||En.push(u),pi(n),o)&&Fn()}function pi(n){var a=n._listeners;n._listeners=[];for(var o=0,u=a.length;o<u;++o)Ca(n,a[o]);var c=n._PSD;--c.ref||c.finalize(),pn===0&&(++pn,er(function(){--pn==0&&wr()},[]))}function Ca(n,a){if(n._state===null)n._listeners.push(a);else{var o=n._state?a.onFulfilled:a.onRejected;if(o===null)return(n._state?a.resolve:a.reject)(n._value);++a.psd.ref,++pn,er(ut,[o,n,a])}}function ut(n,a,o){try{var u,c=a._value;!a._state&&jn.length&&(jn=[]),u=Kt&&a._consoleTask?a._consoleTask.run(function(){return n(c)}):n(c),a._state||jn.indexOf(c)!==-1||(p=>{for(var g=En.length;g;)if(En[--g]._value===p._value)return En.splice(g,1)})(a),o.resolve(u)}catch(p){o.reject(p)}finally{--pn==0&&wr(),--o.psd.ref||o.psd.finalize()}}function ar(){_e(mt,function(){ir()&&Fn()})}function ir(){var n=ta;return tr=ta=!1,n}function Fn(){var n,a,o;do for(;0<Bn.length;)for(n=Bn,Bn=[],o=n.length,a=0;a<o;++a){var u=n[a];u[0].apply(null,u[1])}while(0<Bn.length);tr=ta=!0}function wr(){for(var n=En,a=(En=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),na.slice(0)),o=a.length;o;)a[--o]()}function kr(n){return new le(br,!1,n)}function tt(n,a){var o=ye;return function(){var u=ir(),c=ye;try{return gn(o,!0),n.apply(this,arguments)}catch(p){a&&a(p)}finally{gn(c,!1),u&&Fn()}}}b(le.prototype,{then:rr,_then:function(n,a){Ca(this,new di(null,null,n,a,ye))},catch:function(n){var a,o;return arguments.length===1?this.then(null,n):(a=n,o=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?o:kr)(u)}):this.then(null,function(u){return(u&&u.name===a?o:kr)(u)}))},finally:function(n){return this.then(function(a){return le.resolve(n()).then(function(){return a})},function(a){return le.resolve(n()).then(function(){return kr(a)})})},timeout:function(n,a){var o=this;return n<1/0?new le(function(u,c){var p=setTimeout(function(){return c(new ke.Timeout(a))},n);o.then(u,c).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&q(le.prototype,Symbol.toStringTag,"Dexie.Promise"),mt.env=vi(),b(le,{all:function(){var n=ue.apply(null,arguments).map(Tr);return new le(function(a,o){n.length===0&&a([]);var u=n.length;n.forEach(function(c,p){return le.resolve(c).then(function(g){n[p]=g,--u||a(n)},o)})})},resolve:function(n){return n instanceof le?n:n&&typeof n.then=="function"?new le(function(a,o){n.then(a,o)}):new le(br,!0,n)},reject:kr,race:function(){var n=ue.apply(null,arguments).map(Tr);return new le(function(a,o){n.map(function(u){return le.resolve(u).then(a,o)})})},PSD:{get:function(){return ye},set:function(n){return ye=n}},totalEchoes:{get:function(){return Sr}},newPSD:hn,usePSD:_e,scheduler:{get:function(){return er},set:function(n){er=n}},rejectionMapper:{get:function(){return nr},set:function(n){nr=n}},follow:function(n,a){return new le(function(o,u){return hn(function(c,p){var g=ye;g.unhandleds=[],g.onunhandled=p,g.finalize=Ot(function(){var m,T=this;m=function(){T.unhandleds.length===0?c():p(T.unhandleds[0])},na.push(function D(){m(),na.splice(na.indexOf(D),1)}),++pn,er(function(){--pn==0&&wr()},[])},g.finalize),n()},a,o,u)})}}),gt&&(gt.allSettled&&q(le,"allSettled",function(){var n=ue.apply(null,arguments).map(Tr);return new le(function(a){n.length===0&&a([]);var o=n.length,u=new Array(o);n.forEach(function(c,p){return le.resolve(c).then(function(g){return u[p]={status:"fulfilled",value:g}},function(g){return u[p]={status:"rejected",reason:g}}).then(function(){return--o||a(u)})})})}),gt.any&&typeof AggregateError<"u"&&q(le,"any",function(){var n=ue.apply(null,arguments).map(Tr);return new le(function(a,o){n.length===0&&o(new AggregateError([]));var u=n.length,c=new Array(u);n.forEach(function(p,g){return le.resolve(p).then(function(m){return a(m)},function(m){c[g]=m,--u||o(new AggregateError(c))})})})}),gt.withResolvers)&&(le.withResolvers=gt.withResolvers);var ht={awaits:0,echoes:0,id:0},Jt=0,en=[],xr=0,Sr=0,Pa=0;function hn(n,g,o,u){var c=ye,p=Object.create(c),g=(p.parent=c,p.ref=0,p.global=!1,p.id=++Pa,mt.env,p.env=_r?{Promise:le,PromiseProp:{value:le,configurable:!0,writable:!0},all:le.all,race:le.race,allSettled:le.allSettled,any:le.any,resolve:le.resolve,reject:le.reject}:{},g&&v(p,g),++c.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},_e(p,n,o,u));return p.ref===0&&p.finalize(),g}function It(){return ht.id||(ht.id=++Jt),++ht.awaits,ht.echoes+=ea,ht.id}function vn(){return!!ht.awaits&&(--ht.awaits==0&&(ht.id=0),ht.echoes=ht.awaits*ea,!0)}function Tr(n){return ht.echoes&&n&&n.constructor===gt?(It(),n.then(function(a){return vn(),a},function(a){return vn(),ae(a)})):n}function hi(){var n=en[en.length-1];en.pop(),gn(n,!1)}function gn(n,a){var o,u,c=ye;(a?!ht.echoes||xr++&&n===ye:!xr||--xr&&n===ye)||queueMicrotask(a?(function(p){++Sr,ht.echoes&&--ht.echoes!=0||(ht.echoes=ht.awaits=ht.id=0),en.push(ye),gn(p,!0)}).bind(null,n):hi),n!==ye&&(ye=n,c===mt&&(mt.env=vi()),_r)&&(o=mt.env.Promise,u=n.env,c.global||n.global)&&(Object.defineProperty(l,"Promise",u.PromiseProp),o.all=u.all,o.race=u.race,o.resolve=u.resolve,o.reject=u.reject,u.allSettled&&(o.allSettled=u.allSettled),u.any)&&(o.any=u.any)}function vi(){var n=l.Promise;return _r?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function _e(n,a,o,u,c){var p=ye;try{return gn(n,!0),a(o,u,c)}finally{gn(p,!1)}}function x(n,a,o,u){return typeof n!="function"?n:function(){var c=ye;o&&It(),gn(a,!0);try{return n.apply(this,arguments)}finally{gn(c,!1),u&&queueMicrotask(vn)}}}function X(n){Promise===gt&&ht.echoes===0?xr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+sa).indexOf("[native code]")===-1&&(It=vn=Qe);var ae=le.reject,Ye="ï¿¿",nt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",st="String expected.",ct=[],qt="__dbnames",An="readonly",Er="readwrite";function it(n,a){return n?a?function(){return n.apply(this,arguments)&&a.apply(this,arguments)}:n:a}var Ra={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ar(n){return typeof n!="string"||/\./.test(n)?function(a){return a}:function(a){return a[n]===void 0&&n in a&&delete(a=be(a))[n],a}}function No(){throw ke.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function He(n,a){try{var o=qo(n),u=qo(a);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return a<n?1:n<a?-1:0;case"binary":for(var c=jo(n),p=jo(a),g=c.length,m=p.length,T=g<m?g:m,D=0;D<T;++D)if(c[D]!==p[D])return c[D]<p[D]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var E=n,w=a,I=E.length,C=w.length,A=I<C?I:C,S=0;S<A;++S){var L=He(E[S],w[S]);if(L!==0)return L}return I===C?0:I<C?-1:1}}catch{}return NaN}function qo(n){var a=typeof n;return a=="object"&&(ArrayBuffer.isView(n)||(a=xe(n))==="ArrayBuffer")?"binary":a}function jo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function gi(n,a,o){var u=n.schema.yProps;return u?(a&&0<o.numFailures&&(a=a.filter(function(c,p){return!o.failures[p]})),Promise.all(u.map(function(c){return c=c.updatesTable,a?n.db.table(c).where("k").anyOf(a).delete():n.db.table(c).clear()})).then(function(){return o})):o}Bo.prototype.execute=function(n){var a=this["@@propmod"];if(a.add!==void 0){var o=a.add;if(d(o))return s(s([],d(n)?n:[],!0),o).sort();if(typeof o=="number")return(Number(n)||0)+o;if(typeof o=="bigint")try{return BigInt(n)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(a.remove!==void 0){var u=a.remove;if(d(u))return d(n)?n.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return o=(o=a.replacePrefix)==null?void 0:o[0],o&&typeof n=="string"&&n.startsWith(o)?a.replacePrefix[1]+n.substring(o.length):n};var Oa=Bo;function Bo(n){this["@@propmod"]=n}function zo(n,a){for(var o=f(a),u=o.length,c=!1,p=0;p<u;++p){var g=o[p],m=a[g],T=ve(n,g);m instanceof Oa?(W(n,g,m.execute(T)),c=!0):T!==m&&(W(n,g,m),c=!0)}return c}rt.prototype._trans=function(n,a,o){var u=this._tx||ye.trans,c=this.name,p=Kt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(D,E,w){if(w.schema[c])return a(w.idbtrans,w);throw new ke.NotFound("Table "+c+" not part of transaction")}var m=ir();try{var T=u&&u.db._novip===this.db._novip?u===ye.trans?u._promise(n,g,o):hn(function(){return u._promise(n,g,o)},{trans:u,transless:ye.transless||ye}):(function D(E,w,I,C){if(E.idbdb&&(E._state.openComplete||ye.letThrough||E._vip)){var A=E._createTransaction(w,I,E._dbSchema);try{A.create(),E._state.PR1398_maxLoop=3}catch(S){return S.name===at.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return D(E,w,I,C)})):ae(S)}return A._promise(w,function(S,L){return hn(function(){return ye.trans=A,C(S,L,A)})}).then(function(S){if(w==="readwrite")try{A.idbtrans.commit()}catch{}return w==="readonly"?S:A._completion.then(function(){return S})})}if(E._state.openComplete)return ae(new ke.DatabaseClosed(E._state.dbOpenError));if(!E._state.isBeingOpened){if(!E._state.autoOpen)return ae(new ke.DatabaseClosed);E.open().catch(Qe)}return E._state.dbReadyPromise.then(function(){return D(E,w,I,C)})})(this.db,n,[this.name],g);return p&&(T._consoleTask=p,T=T.catch(function(D){return console.trace(D),ae(D)})),T}finally{m&&Fn()}},rt.prototype.get=function(n,a){var o=this;return n&&n.constructor===Object?this.where(n).first(a):n==null?ae(new ke.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return o.core.get({trans:u,key:n}).then(function(c){return o.hook.reading.fire(c)})}).then(a)},rt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var a=f(n);if(a.length===1)return this.where(a[0]).equals(n[a[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(D){return 0<=m.keyPath.indexOf(D)})){for(var T=0;T<a.length;++T)if(a.indexOf(m.keyPath[T])===-1)return!1;return!0}return!1}).sort(function(m,T){return m.keyPath.length-T.keyPath.length})[0];if(o&&this.db._maxKey!==Ye)return g=o.keyPath.slice(0,a.length),this.where(g).equals(g.map(function(m){return n[m]}));!o&&Kt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function c(m,T){return He(m,T)===0}var g=a.reduce(function(E,T){var D=E[0],E=E[1],w=u[T],I=n[T];return[D||w,D||!w?it(E,w&&w.multi?function(C){return C=ve(C,T),d(C)&&C.some(function(A){return c(I,A)})}:function(C){return c(I,ve(C,T))}):E]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):o?this.filter(g):this.where(a).equals("")},rt.prototype.filter=function(n){return this.toCollection().and(n)},rt.prototype.count=function(n){return this.toCollection().count(n)},rt.prototype.offset=function(n){return this.toCollection().offset(n)},rt.prototype.limit=function(n){return this.toCollection().limit(n)},rt.prototype.each=function(n){return this.toCollection().each(n)},rt.prototype.toArray=function(n){return this.toCollection().toArray(n)},rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},rt.prototype.reverse=function(){return this.toCollection().reverse()},rt.prototype.mapToClass=function(n){for(var a=this.db,o=this.name,u=((this.schema.mappedClass=n).prototype instanceof No&&(n=(g=>{var m=E,T=g;if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function D(){this.constructor=m}function E(){return g!==null&&g.apply(this,arguments)||this}return r(m,T),m.prototype=T===null?Object.create(T):(D.prototype=T.prototype,new D),Object.defineProperty(E.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),E.prototype.table=function(){return o},E})(n)),new Set),c=n.prototype;c;c=h(c))Object.getOwnPropertyNames(c).forEach(function(g){return u.add(g)});function p(g){if(!g)return g;var m,T=Object.create(n.prototype);for(m in g)if(!u.has(m))try{T[m]=g[m]}catch{}return T}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},rt.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},rt.prototype.add=function(n,a){var o=this,u=this.schema.primKey,c=u.auto,p=u.keyPath,g=n;return p&&c&&(g=Ar(p)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[g]})}).then(function(m){return m.numFailures?le.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{W(n,p,m)}catch{}return m})},rt.prototype.upsert=function(n,a){var o=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(c){return o.core.get({trans:c,key:n}).then(function(p){var g=p??{};return zo(g,a),u&&W(g,u,n),o.core.mutate({trans:c,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[a]}}).then(function(m){return m.numFailures?le.reject(m.failures[0]):!!p})})})},rt.prototype.update=function(n,a){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(a):(n=ve(n,this.schema.primKey.keyPath))===void 0?ae(new ke.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(a)},rt.prototype.put=function(n,a){var o=this,u=this.schema.primKey,c=u.auto,p=u.keyPath,g=n;return p&&c&&(g=Ar(p)(n)),this._trans("readwrite",function(m){return o.core.mutate({trans:m,type:"put",values:[g],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?le.reject(m.failures[0]):m.lastResult}).then(function(m){if(p)try{W(n,p,m)}catch{}return m})},rt.prototype.delete=function(n){var a=this;return this._trans("readwrite",function(o){return a.core.mutate({trans:o,type:"delete",keys:[n]}).then(function(u){return gi(a,[n],u)}).then(function(u){return u.numFailures?le.reject(u.failures[0]):void 0})})},rt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"deleteRange",range:Ra}).then(function(o){return gi(n,null,o)})}).then(function(a){return a.numFailures?le.reject(a.failures[0]):void 0})},rt.prototype.bulkGet=function(n){var a=this;return this._trans("readonly",function(o){return a.core.getMany({keys:n,trans:o}).then(function(u){return u.map(function(c){return a.hook.reading.fire(c)})})})},rt.prototype.bulkAdd=function(n,a,o){var u=this,c=Array.isArray(a)?a:void 0,p=(o=o||(c?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,D=m.auto,m=m.keyPath;if(m&&c)throw new ke.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var T=n.length,D=m&&D?n.map(Ar(m)):n;return u.core.mutate({trans:g,type:"add",keys:c,values:D,wantResults:p}).then(function(E){var w=E.numFailures,I=E.failures;if(w===0)return p?E.results:E.lastResult;throw new Te("".concat(u.name,".bulkAdd(): ").concat(w," of ").concat(T," operations failed"),I)})})},rt.prototype.bulkPut=function(n,a,o){var u=this,c=Array.isArray(a)?a:void 0,p=(o=o||(c?void 0:a))?o.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,D=m.auto,m=m.keyPath;if(m&&c)throw new ke.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==n.length)throw new ke.InvalidArgument("Arguments objects and keys must have the same length");var T=n.length,D=m&&D?n.map(Ar(m)):n;return u.core.mutate({trans:g,type:"put",keys:c,values:D,wantResults:p}).then(function(E){var w=E.numFailures,I=E.failures;if(w===0)return p?E.results:E.lastResult;throw new Te("".concat(u.name,".bulkPut(): ").concat(w," of ").concat(T," operations failed"),I)})})},rt.prototype.bulkUpdate=function(n){var a=this,o=this.core,u=n.map(function(g){return g.key}),c=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return o.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var T=[],D=[],E=(n.forEach(function(w,I){var C=w.key,A=w.changes,S=m[I];if(S){for(var L=0,N=Object.keys(A);L<N.length;L++){var O=N[L],U=A[O];if(O===a.schema.primKey.keyPath){if(He(U,C)!==0)throw new ke.Constraint("Cannot update primary key in bulkUpdate()")}else W(S,O,U)}p.push(I),T.push(C),D.push(S)}}),T.length);return o.mutate({trans:g,type:"put",keys:T,values:D,updates:{keys:u,changeSpecs:c}}).then(function(w){var I=w.numFailures,C=w.failures;if(I===0)return E;for(var A=0,S=Object.keys(C);A<S.length;A++){var L,N=S[A],O=p[Number(N)];O!=null&&(L=C[N],delete C[N],C[O]=L)}throw new Te("".concat(a.name,".bulkUpdate(): ").concat(I," of ").concat(E," operations failed"),C)})})})},rt.prototype.bulkDelete=function(n){var a=this,o=n.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:n}).then(function(c){return gi(a,n,c)})}).then(function(u){var c=u.numFailures,p=u.failures;if(c===0)return u.lastResult;throw new Te("".concat(a.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),p)})};var Fo=rt;function rt(){}function Da(n){function a(g,m){if(m){for(var T=arguments.length,D=new Array(T-1);--T;)D[T-1]=arguments[T];return o[g].subscribe.apply(null,D),n}if(typeof g=="string")return o[g]}var o={};a.addEventType=p;for(var u=1,c=arguments.length;u<c;++u)p(arguments[u]);return a;function p(g,m,T){var D,E;if(typeof g!="object")return m=m||Jr,E={subscribers:[],fire:T=T||Qe,subscribe:function(w){E.subscribers.indexOf(w)===-1&&(E.subscribers.push(w),E.fire=m(E.fire,w))},unsubscribe:function(w){E.subscribers=E.subscribers.filter(function(I){return I!==w}),E.fire=E.subscribers.reduce(m,T)}},o[g]=a[g]=E;f(D=g).forEach(function(w){var I=D[w];if(d(I))p(w,D[w][0],D[w][1]);else{if(I!=="asap")throw new ke.InvalidArgument("Invalid event config");var C=p(w,Zt,function(){for(var A=arguments.length,S=new Array(A);A--;)S[A]=arguments[A];C.subscribers.forEach(function(L){J(function(){L.apply(null,S)})})})}})}}function Ma(n,a){return j(a).from({prototype:n}),a}function ra(n,a){return!(n.filter||n.algorithm||n.or)&&(a?n.justLimit:!n.replayFilter)}function ss(n,a){n.filter=it(n.filter,a)}function os(n,a,o){var u=n.replayFilter;n.replayFilter=u?function(){return it(u(),a())}:a,n.justLimit=o&&!u}function mi(n,a){if(n.isPrimKey)return a.primaryKey;var o=a.getIndexByKeyPath(n.index);if(o)return o;throw new ke.Schema("KeyPath "+n.index+" on object store "+a.name+" is not indexed")}function Ko(n,a,o){var u=mi(n,a.schema);return a.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function yi(n,a,o,u){var c,p,g=n.replayFilter?it(n.filter,n.replayFilter()):n.filter;return n.or?(c={},p=function(m,T,D){var E,w;g&&!g(T,D,function(I){return T.stop(I)},function(I){return T.fail(I)})||((w=""+(E=T.primaryKey))=="[object ArrayBuffer]"&&(w=""+new Uint8Array(E)),k(c,w))||(c[w]=!0,a(m,T,D))},Promise.all([n.or._iterate(p,o),Uo(Ko(n,u,o),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):Uo(Ko(n,u,o),it(n.algorithm,g),a,!n.keysOnly&&n.valueMapper)}function Uo(n,a,o,u){var c=tt(u?function(p,g,m){return o(u(p),g,m)}:o);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};a&&!a(p,function(m){return g=m},function(m){p.stop(m),g=Qe},function(m){p.fail(m),g=Qe})||c(p.value,p,function(m){return g=m}),g()})})}Ve.prototype._read=function(n,a){var o=this._ctx;return o.error?o.table._trans(null,ae.bind(null,o.error)):o.table._trans("readonly",n).then(a)},Ve.prototype._write=function(n){var a=this._ctx;return a.error?a.table._trans(null,ae.bind(null,a.error)):a.table._trans("readwrite",n,"locked")},Ve.prototype._addAlgorithm=function(n){var a=this._ctx;a.algorithm=it(a.algorithm,n)},Ve.prototype._iterate=function(n,a){return yi(this._ctx,n,a,this._ctx.table.core)},Ve.prototype.clone=function(n){var a=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return n&&v(o,n),a._ctx=o,a},Ve.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ve.prototype.each=function(n){var a=this._ctx;return this._read(function(o){return yi(a,n,o,a.table.core)})},Ve.prototype.count=function(n){var a=this;return this._read(function(o){var u,c=a._ctx,p=c.table.core;return ra(c,!0)?p.count({trans:o,query:{index:mi(c,p.schema),range:c.range}}).then(function(g){return Math.min(g,c.limit)}):(u=0,yi(c,function(){return++u,!1},o,p).then(function(){return u}))}).then(n)},Ve.prototype.sortBy=function(n,a){var o=n.split(".").reverse(),u=o[0],c=o.length-1;function p(T,D){return D?p(T[o[D]],D-1):T[u]}var g=this._ctx.dir==="next"?1:-1;function m(T,D){return He(p(T,c),p(D,c))*g}return this.toArray(function(T){return T.sort(m)}).then(a)},Ve.prototype.toArray=function(n){var a=this;return this._read(function(o){var u,c,p,g=a._ctx;return g.dir==="next"&&ra(g,!0)&&0<g.limit?(u=g.valueMapper,c=mi(g,g.table.core.schema),g.table.core.query({trans:o,limit:g.limit,values:!0,query:{index:c,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(p=[],yi(g,function(m){return p.push(m)},o,g.table.core).then(function(){return p}))},n)},Ve.prototype.offset=function(n){var a=this._ctx;return n<=0||(a.offset+=n,ra(a)?os(a,function(){var o=n;return function(u,c){return o===0||(o===1?--o:c(function(){u.advance(o),o=0}),!1)}}):os(a,function(){var o=n;return function(){return--o<0}})),this},Ve.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),os(this._ctx,function(){var a=n;return function(o,u,c){return--a<=0&&u(c),0<=a}},!0),this},Ve.prototype.until=function(n,a){return ss(this._ctx,function(o,u,c){return!n(o.value)||(u(c),a)}),this},Ve.prototype.first=function(n){return this.limit(1).toArray(function(a){return a[0]}).then(n)},Ve.prototype.last=function(n){return this.reverse().first(n)},Ve.prototype.filter=function(n){var a;return ss(this._ctx,function(o){return n(o.value)}),(a=this._ctx).isMatch=it(a.isMatch,n),this},Ve.prototype.and=function(n){return this.filter(n)},Ve.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Ve.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ve.prototype.desc=function(){return this.reverse()},Ve.prototype.eachKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.key,u)})},Ve.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Ve.prototype.eachPrimaryKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(o,u){n(u.primaryKey,u)})},Ve.prototype.keys=function(n){var a=this._ctx,o=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,c){o.push(c.key)}).then(function(){return o}).then(n)},Ve.prototype.primaryKeys=function(n){var a=this._ctx;if(a.dir==="next"&&ra(a,!0)&&0<a.limit)return this._read(function(u){var c=mi(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:c,range:a.range}})}).then(function(u){return u.result}).then(n);a.keysOnly=!a.isMatch;var o=[];return this.each(function(u,c){o.push(c.primaryKey)}).then(function(){return o}).then(n)},Ve.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Ve.prototype.firstKey=function(n){return this.limit(1).keys(function(a){return a[0]}).then(n)},Ve.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Ve.prototype.distinct=function(){var n,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(n={},ss(this._ctx,function(u){var u=u.primaryKey.toString(),c=k(n,u);return n[u]=!0,!c})),this},Ve.prototype.modify=function(n){var a=this,o=this._ctx;return this._write(function(u){function c(S,L){var N=L.failures;I+=S-L.numFailures;for(var O=0,U=f(N);O<U.length;O++){var Y=U[O];w.push(N[Y])}}var p=typeof n=="function"?n:function(S){return zo(S,n)},g=o.table.core,E=g.schema.primaryKey,m=E.outbound,T=E.extractKey,D=200,E=a.db._options.modifyChunkSize,w=(E&&(D=typeof E=="object"?E[g.name]||E["*"]||200:E),[]),I=0,C=[],A=n===Go;return a.clone().primaryKeys().then(function(S){function L(O){var U=Math.min(D,S.length-O),Y=S.slice(O,O+U);return(A?Promise.resolve([]):g.getMany({trans:u,keys:Y,cache:"immutable"})).then(function(se){var oe=[],V=[],he=m?[]:null,fe=A?Y:[];if(!A)for(var ee=0;ee<U;++ee){var me=se[ee],We={value:be(me),primKey:S[O+ee]};p.call(We,We.value,We)!==!1&&(We.value==null?fe.push(S[O+ee]):m||He(T(me),T(We.value))===0?(V.push(We.value),m&&he.push(S[O+ee])):(fe.push(S[O+ee]),oe.push(We.value)))}return Promise.resolve(0<oe.length&&g.mutate({trans:u,type:"add",values:oe}).then(function(Xe){for(var Ie in Xe.failures)fe.splice(parseInt(Ie),1);c(oe.length,Xe)})).then(function(){return(0<V.length||N&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:he,values:V,criteria:N,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<O}).then(function(Xe){return c(V.length,Xe)})}).then(function(){return(0<fe.length||N&&A)&&g.mutate({trans:u,type:"delete",keys:fe,criteria:N,isAdditionalChunk:0<O}).then(function(Xe){return gi(o.table,fe,Xe)}).then(function(Xe){return c(fe.length,Xe)})}).then(function(){return S.length>O+U&&L(O+D)})})}var N=ra(o)&&o.limit===1/0&&(typeof n!="function"||A)&&{index:o.index,range:o.range};return L(0).then(function(){if(0<w.length)throw new et("Error modifying one or more objects",w,I,C);return S.length})})})},Ve.prototype.delete=function(){var n=this._ctx,a=n.range;return!ra(n)||n.table.schema.yProps||!n.isPrimKey&&a.type!==3?this.modify(Go):this._write(function(o){var u=n.table.core.schema.primaryKey,c=a;return n.table.core.count({trans:o,query:{index:u,range:c}}).then(function(p){return n.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(T){var m=T.failures,T=T.numFailures;if(T)throw new et("Could not delete some values",Object.keys(m).map(function(D){return m[D]}),p-T);return p-T})})})};var Ec=Ve;function Ve(){}var Go=function(n,a){return a.value=null};function Ac(n,a){return n<a?-1:n===a?0:1}function Ic(n,a){return a<n?-1:n===a?0:1}function Ut(n,a,o){return n=n instanceof Wo?new n.Collection(n):n,n._ctx.error=new(o||TypeError)(a),n}function aa(n){return new n.Collection(n,function(){return Ho("")}).limit(0)}function bi(C,a,o,u){var c,p,g,m,T,D,E,w=o.length;if(!o.every(function(S){return typeof S=="string"}))return Ut(C,st);function I(S){c=S==="next"?function(N){return N.toUpperCase()}:function(N){return N.toLowerCase()},p=S==="next"?function(N){return N.toLowerCase()}:function(N){return N.toUpperCase()},g=S==="next"?Ac:Ic;var L=o.map(function(N){return{lower:p(N),upper:c(N)}}).sort(function(N,O){return g(N.lower,O.lower)});m=L.map(function(N){return N.upper}),T=L.map(function(N){return N.lower}),E=(D=S)==="next"?"":u}I("next");var C=new C.Collection(C,function(){return sr(m[0],T[w-1]+u)}),A=(C._ondirectionchange=function(S){I(S)},0);return C._addAlgorithm(function(S,L,N){var O=S.key;if(typeof O=="string"){var U=p(O);if(a(U,T,A))return!0;for(var Y=null,se=A;se<w;++se){var oe=((V,he,fe,ee,me,We)=>{for(var Xe=Math.min(V.length,ee.length),Ie=-1,je=0;je<Xe;++je){var ot=he[je];if(ot!==ee[je])return me(V[je],fe[je])<0?V.substr(0,je)+fe[je]+fe.substr(je+1):me(V[je],ee[je])<0?V.substr(0,je)+ee[je]+fe.substr(je+1):0<=Ie?V.substr(0,Ie)+he[Ie]+fe.substr(Ie+1):null;me(V[je],ot)<0&&(Ie=je)}return Xe<ee.length&&We==="next"?V+fe.substr(V.length):Xe<V.length&&We==="prev"?V.substr(0,fe.length):Ie<0?null:V.substr(0,Ie)+ee[Ie]+fe.substr(Ie+1)})(O,U,m[se],T[se],g,D);oe===null&&Y===null?A=se+1:(Y===null||0<g(Y,oe))&&(Y=oe)}L(Y!==null?function(){S.continue(Y+E)}:N)}return!1}),C}function sr(n,a,o,u){return{type:2,lower:n,upper:a,lowerOpen:o,upperOpen:u}}function Ho(n){return{type:1,lower:n,upper:n}}Object.defineProperty(yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),yt.prototype.between=function(n,a,o,u){o=o!==!1,u=u===!0;try{return 0<this._cmp(n,a)||this._cmp(n,a)===0&&(o||u)&&(!o||!u)?aa(this):new this.Collection(this,function(){return sr(n,a,!o,!u)})}catch{return Ut(this,nt)}},yt.prototype.equals=function(n){return n==null?Ut(this,nt):new this.Collection(this,function(){return Ho(n)})},yt.prototype.above=function(n){return n==null?Ut(this,nt):new this.Collection(this,function(){return sr(n,void 0,!0)})},yt.prototype.aboveOrEqual=function(n){return n==null?Ut(this,nt):new this.Collection(this,function(){return sr(n,void 0,!1)})},yt.prototype.below=function(n){return n==null?Ut(this,nt):new this.Collection(this,function(){return sr(void 0,n,!1,!0)})},yt.prototype.belowOrEqual=function(n){return n==null?Ut(this,nt):new this.Collection(this,function(){return sr(void 0,n)})},yt.prototype.startsWith=function(n){return typeof n!="string"?Ut(this,st):this.between(n,n+Ye,!0,!0)},yt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):bi(this,function(a,o){return a.indexOf(o[0])===0},[n],Ye)},yt.prototype.equalsIgnoreCase=function(n){return bi(this,function(a,o){return a===o[0]},[n],"")},yt.prototype.anyOfIgnoreCase=function(){var n=ue.apply(H,arguments);return n.length===0?aa(this):bi(this,function(a,o){return o.indexOf(a)!==-1},n,"")},yt.prototype.startsWithAnyOfIgnoreCase=function(){var n=ue.apply(H,arguments);return n.length===0?aa(this):bi(this,function(a,o){return o.some(function(u){return a.indexOf(u)===0})},n,Ye)},yt.prototype.anyOf=function(){var n,a,o=this,u=ue.apply(H,arguments),c=this._cmp;try{u.sort(c)}catch{return Ut(this,nt)}return u.length===0?aa(this):((n=new this.Collection(this,function(){return sr(u[0],u[u.length-1])}))._ondirectionchange=function(p){c=p==="next"?o._ascending:o._descending,u.sort(c)},a=0,n._addAlgorithm(function(p,g,m){for(var T=p.key;0<c(T,u[a]);)if(++a===u.length)return g(m),!1;return c(T,u[a])===0||(g(function(){p.continue(u[a])}),!1)}),n)},yt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},yt.prototype.noneOf=function(){var n=ue.apply(H,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Ut(this,nt)}var a=n.reduce(function(o,u){return o?o.concat([[o[o.length-1][1],u]]):[[-1/0,u]]},null);return a.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},yt.prototype.inAnyRange=function(n,N){var o=this,u=this._cmp,c=this._ascending,p=this._descending,g=this._min,m=this._max;if(n.length===0)return aa(this);if(!n.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&c(O[0],O[1])<=0}))return Ut(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ke.InvalidArgument);var T=!N||N.includeLowers!==!1,D=N&&N.includeUppers===!0,E,w=c;function I(O,U){return w(O[0],U[0])}try{(E=n.reduce(function(O,U){for(var Y=0,se=O.length;Y<se;++Y){var oe=O[Y];if(u(U[0],oe[1])<0&&0<u(U[1],oe[0])){oe[0]=g(oe[0],U[0]),oe[1]=m(oe[1],U[1]);break}}return Y===se&&O.push(U),O},[])).sort(I)}catch{return Ut(this,nt)}var C=0,A=D?function(O){return 0<c(O,E[C][1])}:function(O){return 0<=c(O,E[C][1])},S=T?function(O){return 0<p(O,E[C][0])}:function(O){return 0<=p(O,E[C][0])},L=A,N=new this.Collection(this,function(){return sr(E[0][0],E[E.length-1][1],!T,!D)});return N._ondirectionchange=function(O){w=O==="next"?(L=A,c):(L=S,p),E.sort(I)},N._addAlgorithm(function(O,U,Y){for(var se,oe=O.key;L(oe);)if(++C===E.length)return U(Y),!1;return!A(se=oe)&&!S(se)||(o._cmp(oe,E[C][1])===0||o._cmp(oe,E[C][0])===0||U(function(){w===c?O.continue(E[C][0]):O.continue(E[C][1])}),!1)}),N},yt.prototype.startsWithAnyOf=function(){var n=ue.apply(H,arguments);return n.every(function(a){return typeof a=="string"})?n.length===0?aa(this):this.inAnyRange(n.map(function(a){return[a,a+Ye]})):Ut(this,"startsWithAnyOf() only works with strings")};var Wo=yt;function yt(){}function In(n){return tt(function(a){return La(a),n(a.target.error),!1})}function La(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Na="storagemutated",ls="x-storagemutated-1",or=Da(null,Na),Cc=(Cn.prototype._lock=function(){return $(!ye.global),++this._reculock,this._reculock!==1||ye.global||(ye.lockOwnerFor=this),this},Cn.prototype._unlock=function(){if($(!ye.global),--this._reculock==0)for(ye.global||(ye.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{_e(n[1],n[0])}catch{}}return this},Cn.prototype._locked=function(){return this._reculock&&ye.lockOwnerFor!==this},Cn.prototype.create=function(n){var a=this;if(this.mode){var o=this.db.idbdb,u=this.db._state.dbOpenError;if($(!this.idbtrans),!n&&!o)switch(u&&u.name){case"DatabaseClosedError":throw new ke.DatabaseClosed(u);case"MissingAPIError":throw new ke.MissingAPI(u.message,u);default:throw new ke.OpenFailed(u)}if(!this.active)throw new ke.TransactionInactive;$(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=tt(function(c){La(c),a._reject(n.error)}),n.onabort=tt(function(c){La(c),a.active&&a._reject(new ke.Abort(n.error)),a.active=!1,a.on("abort").fire(c)}),n.oncomplete=tt(function(){a.active=!1,a._resolve(),"mutatedParts"in n&&or.storagemutated.fire(n.mutatedParts)})}return this},Cn.prototype._promise=function(n,a,o){var u,c=this;return n==="readwrite"&&this.mode!=="readwrite"?ae(new ke.ReadOnly("Transaction is readonly")):this.active?this._locked()?new le(function(p,g){c._blockedFuncs.push([function(){c._promise(n,a,o).then(p,g)},ye])}):o?hn(function(){var p=new le(function(g,m){c._lock();var T=a(g,m,c);T&&T.then&&T.then(g,m)});return p.finally(function(){return c._unlock()}),p._lib=!0,p}):((u=new le(function(p,g){var m=a(p,g,c);m&&m.then&&m.then(p,g)}))._lib=!0,u):ae(new ke.TransactionInactive)},Cn.prototype._root=function(){return this.parent?this.parent._root():this},Cn.prototype.waitFor=function(n){var a,o=this._root(),u=le.resolve(n),c=(o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return u}):(o._waitingFor=u,o._waitingQueue=[],a=o.idbtrans.objectStore(o.storeNames[0]),(function p(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(a.get(-1/0).onsuccess=p)})()),o._waitingFor);return new le(function(p,g){u.then(function(m){return o._waitingQueue.push(tt(p.bind(null,m)))},function(m){return o._waitingQueue.push(tt(g.bind(null,m)))}).finally(function(){o._waitingFor===c&&(o._waitingFor=null)})})},Cn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ke.Abort))},Cn.prototype.table=function(n){var a=this._memoizedTables||(this._memoizedTables={});if(k(a,n))return a[n];var o=this.schema[n];if(o)return(o=new this.db.Table(n,o,this)).core=this.db.core.table(n),a[n]=o;throw new ke.NotFound("Table "+n+" not part of transaction")},Cn);function Cn(){}function us(n,a,o,u,c,p,g,m){return{name:n,keyPath:a,unique:o,multi:u,auto:c,compound:p,src:(o&&!g?"&":"")+(u?"*":"")+(c?"++":"")+$o(a),type:m}}function $o(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function cs(n,a,o){return{name:n,primKey:a,indexes:o,mappedClass:null,idxByName:(u=function(c){return[c.name,c]},o.reduce(function(c,p,g){return p=u(p,g),p&&(c[p[0]]=p[1]),c},{}))};var u}var qa=function(n){try{return n.only([[]]),qa=function(){return[[]]},[[]]}catch{return qa=function(){return Ye},Ye}};function fs(n){return n==null?function(){}:typeof n=="string"?(a=n).split(".").length===1?function(o){return o[a]}:function(o){return ve(o,a)}:function(o){return ve(o,n)};var a}function Yo(n){return[].slice.call(n)}var Pc=0;function ja(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Rc(n,a,T){function u(A){if(A.type===3)return null;if(A.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=A.lower,I=A.upper,C=A.lowerOpen,A=A.upperOpen;return w===void 0?I===void 0?null:a.upperBound(I,!!A):I===void 0?a.lowerBound(w,!!C):a.bound(w,I,!!C,!!A)}function c(E){var w,I=E.name;return{name:I,schema:E,mutate:function(C){var A=C.trans,S=C.type,L=C.keys,N=C.values,O=C.range;return new Promise(function(U,Y){U=tt(U);var se=A.objectStore(I),oe=se.keyPath==null,V=S==="put"||S==="add";if(!V&&S!=="delete"&&S!=="deleteRange")throw new Error("Invalid operation type: "+S);var he,fe=(L||N||{length:1}).length;if(L&&N&&L.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(fe===0)return U({numFailures:0,failures:{},results:[],lastResult:void 0});function ee(lt){++Xe,La(lt)}var me=[],We=[],Xe=0;if(S==="deleteRange"){if(O.type===4)return U({numFailures:Xe,failures:We,results:[],lastResult:void 0});O.type===3?me.push(he=se.clear()):me.push(he=se.delete(u(O)))}else{var oe=V?oe?[N,L]:[N,null]:[L,null],Ie=oe[0],je=oe[1];if(V)for(var ot=0;ot<fe;++ot)me.push(he=je&&je[ot]!==void 0?se[S](Ie[ot],je[ot]):se[S](Ie[ot])),he.onerror=ee;else for(ot=0;ot<fe;++ot)me.push(he=se[S](Ie[ot])),he.onerror=ee}function tn(lt){lt=lt.target.result,me.forEach(function(Pr,Cs){return Pr.error!=null&&(We[Cs]=Pr.error)}),U({numFailures:Xe,failures:We,results:S==="delete"?L:me.map(function(Pr){return Pr.result}),lastResult:lt})}he.onerror=function(lt){ee(lt),tn(lt)},he.onsuccess=tn})},getMany:function(C){var A=C.trans,S=C.keys;return new Promise(function(L,N){L=tt(L);for(var O,U=A.objectStore(I),Y=S.length,se=new Array(Y),oe=0,V=0,he=function(me){me=me.target,se[me._pos]=me.result,++V===oe&&L(se)},fe=In(N),ee=0;ee<Y;++ee)S[ee]!=null&&((O=U.get(S[ee]))._pos=ee,O.onsuccess=he,O.onerror=fe,++oe);oe===0&&L(se)})},get:function(C){var A=C.trans,S=C.key;return new Promise(function(L,N){L=tt(L);var O=A.objectStore(I).get(S);O.onsuccess=function(U){return L(U.target.result)},O.onerror=In(N)})},query:(w=m,function(C){return new Promise(function(A,S){A=tt(A);var L,N,O,V=C.trans,U=C.values,Y=C.limit,oe=C.query,se=Y===1/0?void 0:Y,he=oe.index,oe=oe.range,V=V.objectStore(I),V=he.isPrimaryKey?V:V.index(he.name),he=u(oe);if(Y===0)return A({result:[]});w?((oe=U?V.getAll(he,se):V.getAllKeys(he,se)).onsuccess=function(fe){return A({result:fe.target.result})},oe.onerror=In(S)):(L=0,N=!U&&"openKeyCursor"in V?V.openKeyCursor(he):V.openCursor(he),O=[],N.onsuccess=function(fe){var ee=N.result;return!ee||(O.push(U?ee.value:ee.primaryKey),++L===Y)?A({result:O}):void ee.continue()},N.onerror=In(S))})}),openCursor:function(C){var A=C.trans,S=C.values,L=C.query,N=C.reverse,O=C.unique;return new Promise(function(U,Y){U=tt(U);var V=L.index,se=L.range,oe=A.objectStore(I),oe=V.isPrimaryKey?oe:oe.index(V.name),V=N?O?"prevunique":"prev":O?"nextunique":"next",he=!S&&"openKeyCursor"in oe?oe.openKeyCursor(u(se),V):oe.openCursor(u(se),V);he.onerror=In(Y),he.onsuccess=tt(function(fe){var ee,me,We,Xe,Ie=he.result;Ie?(Ie.___id=++Pc,Ie.done=!1,ee=Ie.continue.bind(Ie),me=(me=Ie.continuePrimaryKey)&&me.bind(Ie),We=Ie.advance.bind(Ie),Xe=function(){throw new Error("Cursor not stopped")},Ie.trans=A,Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=function(){throw new Error("Cursor not started")},Ie.fail=tt(Y),Ie.next=function(){var je=this,ot=1;return this.start(function(){return ot--?je.continue():je.stop()}).then(function(){return je})},Ie.start=function(je){function ot(){if(he.result)try{je()}catch(lt){Ie.fail(lt)}else Ie.done=!0,Ie.start=function(){throw new Error("Cursor behind last entry")},Ie.stop()}var tn=new Promise(function(lt,Pr){lt=tt(lt),he.onerror=In(Pr),Ie.fail=Pr,Ie.stop=function(Cs){Ie.stop=Ie.continue=Ie.continuePrimaryKey=Ie.advance=Xe,lt(Cs)}});return he.onsuccess=tt(function(lt){he.onsuccess=ot,ot()}),Ie.continue=ee,Ie.continuePrimaryKey=me,Ie.advance=We,ot(),tn},U(Ie)):U(null)},Y)})},count:function(C){var A=C.query,S=C.trans,L=A.index,N=A.range;return new Promise(function(O,U){var Y=S.objectStore(I),Y=L.isPrimaryKey?Y:Y.index(L.name),se=u(N),se=se?Y.count(se):Y.count();se.onsuccess=tt(function(oe){return O(oe.target.result)}),se.onerror=In(U)})}}}p=T,g=Yo((T=n).objectStoreNames);var p,T={schema:{name:T.name,tables:g.map(function(E){return p.objectStore(E)}).map(function(E){var w=E.keyPath,I=E.autoIncrement,A=d(w),C={},A={name:E.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:w==null,compound:A,keyPath:w,autoIncrement:I,unique:!0,extractKey:fs(w)},indexes:Yo(E.indexNames).map(function(S){return E.index(S)}).map(function(O){var U=O.name,L=O.unique,N=O.multiEntry,O=O.keyPath,U={name:U,compound:d(O),keyPath:O,unique:L,multiEntry:N,extractKey:fs(O)};return C[ja(O)]=U}),getIndexByKeyPath:function(S){return C[ja(S)]}};return C[":id"]=A.primaryKey,w!=null&&(C[ja(w)]=A.primaryKey),A})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=T.schema,m=T.hasGetAll,T=g.tables.map(c),D={};return T.forEach(function(E){return D[E.name]=E}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(E){if(D[E])return D[E];throw new Error("Table '".concat(E,"' not found"))},MIN_KEY:-1/0,MAX_KEY:qa(a),schema:g}}function Oc(n,a,o,u){return o=o.IDBKeyRange,a=Rc(a,o,u),{dbcore:n.dbcore.reduce(function(c,p){return p=p.create,i(i({},c),p(c))},a)}}function _i(n,a){var o=a.db,o=Oc(n._middlewares,o,n._deps,a);n.core=o.dbcore,n.tables.forEach(function(u){var c=u.name;n.core.schema.tables.some(function(p){return p.name===c})&&(u.core=n.core.table(c),n[c]instanceof n.Table)&&(n[c].core=u.core)})}function wi(n,a,o,u){o.forEach(function(c){var p=u[c];a.forEach(function(g){var m=(function T(D,E){return P(D,E)||(D=h(D))&&T(D,E)})(g,c);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?q(g,c,{get:function(){return this.table(c)},set:function(T){_(this,c,{value:T,writable:!0,configurable:!0,enumerable:!0})}}):g[c]=new n.Table(c,p))})})}function ds(n,a){a.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function Dc(n,a){return n._cfg.version-a._cfg.version}function Mc(n,a,o,u){var c=n._dbSchema,p=(o.objectStoreNames.contains("$meta")&&!c.$meta&&(c.$meta=cs("$meta",Xo("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,c)),g=(p.create(o),p._completion.catch(u),p._reject.bind(p)),m=ye.transless||ye;hn(function(){if(ye.trans=p,ye.transless=m,a!==0)return _i(n,o),D=a,((T=p).storeNames.includes("$meta")?T.table("$meta").get("version").then(function(E){return E??D}):le.resolve(D)).then(function(L){var w=n,I=L,C=p,A=o,S=[],L=w._versions,N=w._dbSchema=xi(0,w.idbdb,A);return(L=L.filter(function(O){return O._cfg.version>=I})).length===0?le.resolve():(L.forEach(function(O){S.push(function(){var U,Y,se,oe=N,V=O._cfg.dbschema,he=(Si(w,oe,A),Si(w,V,A),N=w._dbSchema=V,ps(oe,V)),fe=(he.add.forEach(function(ee){hs(A,ee[0],ee[1].primKey,ee[1].indexes)}),he.change.forEach(function(ee){if(ee.recreate)throw new ke.Upgrade("Not yet support for changing primary key");var me=A.objectStore(ee.name);ee.add.forEach(function(We){return ki(me,We)}),ee.change.forEach(function(We){me.deleteIndex(We.name),ki(me,We)}),ee.del.forEach(function(We){return me.deleteIndex(We)})}),O._cfg.contentUpgrade);if(fe&&O._cfg.version>I)return _i(w,A),C._memoizedTables={},U=Z(V),he.del.forEach(function(ee){U[ee]=oe[ee]}),ds(w,[w.Transaction.prototype]),wi(w,[w.Transaction.prototype],f(U),U),C.schema=U,(Y=pe(fe))&&It(),V=le.follow(function(){var ee;(se=fe(C))&&Y&&(ee=vn.bind(null,null),se.then(ee,ee))}),se&&typeof se.then=="function"?le.resolve(se):V.then(function(){return se})}),S.push(function(U){var Y,se,oe=O._cfg.dbschema;Y=oe,se=U,[].slice.call(se.db.objectStoreNames).forEach(function(V){return Y[V]==null&&se.db.deleteObjectStore(V)}),ds(w,[w.Transaction.prototype]),wi(w,[w.Transaction.prototype],w._storeNames,w._dbSchema),C.schema=w._dbSchema}),S.push(function(U){w.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(w.idbdb.version/10)===O._cfg.version?(w.idbdb.deleteObjectStore("$meta"),delete w._dbSchema.$meta,w._storeNames=w._storeNames.filter(function(Y){return Y!=="$meta"})):U.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return S.length?le.resolve(S.shift()(C.idbtrans)).then(O):le.resolve()})().then(function(){Vo(N,A)}))}).catch(g);var T,D;f(c).forEach(function(E){hs(o,E,c[E].primKey,c[E].indexes)}),_i(n,o),le.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function Lc(n,a){Vo(n._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var o=xi(0,n.idbdb,a);Si(n,n._dbSchema,a);for(var u=0,c=ps(o,n._dbSchema).change;u<c.length;u++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(g.name);g.add.forEach(function(T){Kt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(T.src)),ki(m,T)})})(c[u]);if(typeof p=="object")return p.value}}function ps(n,a){var o,u={del:[],add:[],change:[]};for(o in n)a[o]||u.del.push(o);for(o in a){var c=n[o],p=a[o];if(c){var g={name:o,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(c.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||c.primKey.auto!==p.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=c.idxByName,T=p.idxByName,D=void 0;for(D in m)T[D]||g.del.push(D);for(D in T){var E=m[D],w=T[D];E?E.src!==w.src&&g.change.push(w):g.add.push(w)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([o,p])}return u}function hs(n,a,o,u){var c=n.db.createObjectStore(a,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});u.forEach(function(p){return ki(c,p)})}function Vo(n,a){f(n).forEach(function(o){a.db.objectStoreNames.contains(o)||(Kt&&console.debug("Dexie: Creating missing table",o),hs(a,o,n[o].primKey,n[o].indexes))})}function ki(n,a){n.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function xi(n,a,o){var u={};return re(a.objectStoreNames,0).forEach(function(c){for(var p=o.objectStore(c),g=us($o(D=p.keyPath),D||"",!0,!1,!!p.autoIncrement,D&&typeof D!="string",!0),m=[],T=0;T<p.indexNames.length;++T){var E=p.index(p.indexNames[T]),D=E.keyPath,E=us(E.name,D,!!E.unique,!!E.multiEntry,!1,D&&typeof D!="string",!1);m.push(E)}u[c]=cs(c,g,m)}),u}function Si(n,a,o){for(var u=o.db.objectStoreNames,c=0;c<u.length;++c){var p=u[c],g=o.objectStore(p);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var T,D=g.indexNames[m],E=g.index(D).keyPath,E=typeof E=="string"?E:"["+re(E).join("+")+"]";a[p]&&(T=a[p].idxByName[E])&&(T.name=D,delete a[p].idxByName[E],a[p].idxByName[D]=T)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Xo(n){return n.split(",").map(function(a,o){var c=a.split(":"),u=(u=c[1])==null?void 0:u.trim(),c=(a=c[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return us(c,p||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),d(p),o===0,u)})}ia.prototype._createTableSchema=cs,ia.prototype._parseIndexSyntax=Xo,ia.prototype._parseStoresSpec=function(n,a){var o=this;f(n).forEach(function(u){if(n[u]!==null){var c=o._parseIndexSyntax(n[u]),p=c.shift();if(!p)throw new ke.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new ke.Schema("Primary key cannot be multiEntry*");c.forEach(function(g){if(g.auto)throw new ke.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new ke.Schema("Index must have a name and cannot be an empty string")}),p=o._createTableSchema(u,p,c),a[u]=p}})},ia.prototype.stores=function(o){var a=this.db,o=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,o):o,a._versions),u={},c={};return o.forEach(function(p){v(u,p._cfg.storesSource),c=p._cfg.dbschema={},p._parseStoresSpec(u,c)}),a._dbSchema=c,ds(a,[a._allTables,a,a.Transaction.prototype]),wi(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],f(c),c),a._storeNames=f(c),this},ia.prototype.upgrade=function(n){return this._cfg.contentUpgrade=Jn(this._cfg.contentUpgrade||Qe,n),this};var Nc=ia;function ia(){}function vs(n,a){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new Kn(qt,{addons:[],indexedDB:n,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function gs(n){return n&&typeof n.databases=="function"}function ms(n){return hn(function(){return ye.letThrough=!0,n()})}function ys(n){return!("from"in n)}var Ct=function(n,a){var o;if(!this)return o=new Ct,n&&"d"in n&&v(o,n),o;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?a:n}:{d:0})};function Ba(n,a,o){var u=He(a,o);if(!isNaN(u)){if(0<u)throw RangeError();if(ys(n))return v(n,{from:a,to:o,d:1});var u=n.l,c=n.r;if(He(o,n.from)<0)return u?Ba(u,a,o):n.l={from:a,to:o,d:1,l:null,r:null},Zo(n);if(0<He(a,n.to))return c?Ba(c,a,o):n.r={from:a,to:o,d:1,l:null,r:null},Zo(n);He(a,n.from)<0&&(n.from=a,n.l=null,n.d=c?c.d+1:1),0<He(o,n.to)&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,u&&!n.l&&za(n,u),c&&a&&za(n,c)}}function za(n,a){ys(a)||(function o(u,c){var p=c.from,g=c.l,m=c.r;Ba(u,p,c.to),g&&o(u,g),m&&o(u,m)})(n,a)}function Qo(n,a){var o=Ti(a),u=o.next();if(!u.done)for(var c=u.value,p=Ti(n),g=p.next(c.from),m=g.value;!u.done&&!g.done;){if(He(m.from,c.to)<=0&&0<=He(m.to,c.from))return!0;He(c.from,m.from)<0?c=(u=o.next(m.from)).value:m=(g=p.next(c.from)).value}return!1}function Ti(n){var a=ys(n)?null:{s:0,n};return{next:function(o){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&He(o,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||He(o,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function Zo(n){var a,o,u,c=(((c=n.r)==null?void 0:c.d)||0)-(((c=n.l)==null?void 0:c.d)||0),c=1<c?"r":c<-1?"l":"";c&&(a=c=="r"?"l":"r",o=i({},n),u=n[c],n.from=u.from,n.to=u.to,n[c]=u[c],o[c]=u[a],(n[a]=o).d=Jo(o)),n.d=Jo(n)}function Jo(o){var a=o.r,o=o.l;return(a?o?Math.max(a.d,o.d):a.d:o?o.d:0)+1}function Ei(n,a){return f(a).forEach(function(o){n[o]?za(n[o],a[o]):n[o]=(function u(c){var p,g,m={};for(p in c)k(c,p)&&(g=c[p],m[p]=!g||typeof g!="object"||ie.has(g.constructor)?g:u(g));return m})(a[o])}),n}function bs(n,a){return n.all||a.all||Object.keys(n).some(function(o){return a[o]&&Qo(a[o],n[o])})}b(Ct.prototype,((pt={add:function(n){return za(this,n),this},addKey:function(n){return Ba(this,n,n),this},addKeys:function(n){var a=this;return n.forEach(function(o){return Ba(a,o,o)}),this},hasKey:function(n){var a=Ti(this).next(n).value;return a&&He(a.from,n)<=0&&0<=He(a.to,n)}})[Se]=function(){return Ti(this)},pt));var Ir={},_s={},ws=!1;function Ai(n){Ei(_s,n),ws||(ws=!0,setTimeout(function(){ws=!1,ks(_s,!(_s={}))},0))}function ks(n,a){a===void 0&&(a=!1);var o=new Set;if(n.all)for(var u=0,c=Object.values(Ir);u<c.length;u++)el(m=c[u],n,o,a);else for(var p in n){var g,m,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],m=Ir["idb://".concat(g,"/").concat(p)])&&el(m,n,o,a)}o.forEach(function(T){return T()})}function el(n,a,o,u){for(var c=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var m=g[p],T=m[0],D=[],E=0,w=m[1];E<w.length;E++){var I=w[E];bs(a,I.obsSet)?I.subscribers.forEach(function(L){return o.add(L)}):u&&D.push(I)}u&&c.push([T,D])}if(u)for(var C=0,A=c;C<A.length;C++){var S=A[C],T=S[0],D=S[1];n.queries.query[T]=D}}function qc(n){var a=n._state,o=n._deps.indexedDB;if(a.isBeingOpened||n.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?ae(a.dbOpenError):n});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,c=Math.round(10*n.verno),p=!1;function g(){if(a.openCanceller!==u)throw new ke.DatabaseClosed("db.open() was cancelled")}function m(){return new le(function(I,C){if(g(),!o)throw new ke.MissingAPI;var A=n.name,S=a.autoSchema||!c?o.open(A):o.open(A,c);if(!S)throw new ke.MissingAPI;S.onerror=In(C),S.onblocked=tt(n._fireOnBlocked),S.onupgradeneeded=tt(function(L){var N;E=S.transaction,a.autoSchema&&!n._options.allowEmptyDB?(S.onerror=La,E.abort(),S.result.close(),(N=o.deleteDatabase(A)).onsuccess=N.onerror=tt(function(){C(new ke.NoSuchDatabase("Database ".concat(A," doesnt exist")))})):(E.onerror=In(C),N=L.oldVersion>Math.pow(2,62)?0:L.oldVersion,w=N<1,n.idbdb=S.result,p&&Lc(n,E),Mc(n,N/10,E,C))},C),S.onsuccess=tt(function(){E=null;var L,N,O,U,Y,se,oe=n.idbdb=S.result,V=re(oe.objectStoreNames);if(0<V.length)try{var he=oe.transaction((Y=V).length===1?Y[0]:Y,"readonly");if(a.autoSchema)se=oe,U=he,(O=n).verno=se.version/10,U=O._dbSchema=xi(0,se,U),O._storeNames=re(se.objectStoreNames,0),wi(O,[O._allTables],f(U),U);else if(Si(n,n._dbSchema,he),N=he,((N=ps(xi(0,(L=n).idbdb,N),L._dbSchema)).add.length||N.change.some(function(fe){return fe.add.length||fe.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),oe.close(),c=oe.version+1,p=!0,I(m());_i(n,he)}catch{}ct.push(n),oe.onversionchange=tt(function(fe){a.vcFired=!0,n.on("versionchange").fire(fe)}),oe.onclose=tt(function(){n.close({disableAutoOpen:!1})}),w&&(V=n._deps,Y=A,gs(se=V.indexedDB)||Y===qt||vs(se,V.IDBKeyRange).put({name:Y}).catch(Qe)),I()},C)}).catch(function(I){switch(I==null?void 0:I.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<c)return c=0,m()}return le.reject(I)})}var T,D=a.dbReadyResolve,E=null,w=!1;return le.race([u,(typeof navigator>"u"?le.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function C(){return indexedDB.databases().finally(I)}T=setInterval(C,100),C()}).finally(function(){return clearInterval(T)}):Promise.resolve()).then(m)]).then(function(){return g(),a.onReadyBeingFired=[],le.resolve(ms(function(){return n.on.ready.fire(n.vip)})).then(function I(){var C;if(0<a.onReadyBeingFired.length)return C=a.onReadyBeingFired.reduce(Jn,Qe),a.onReadyBeingFired=[],le.resolve(ms(function(){return C(n.vip)})).then(I)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(I){a.dbOpenError=I;try{E&&E.abort()}catch{}return u===a.openCanceller&&n._close(),ae(I)}).finally(function(){a.openComplete=!0,D()}).then(function(){var I;return w&&(I={},n.tables.forEach(function(C){C.schema.indexes.forEach(function(A){A.name&&(I["idb://".concat(n.name,"/").concat(C.name,"/").concat(A.name)]=new Ct(-1/0,[[[]]]))}),I["idb://".concat(n.name,"/").concat(C.name,"/")]=I["idb://".concat(n.name,"/").concat(C.name,"/:dels")]=new Ct(-1/0,[[[]]])}),or(Na).fire(I),ks(I,!0)),n})}function xs(n){function a(p){return n.next(p)}var o=c(a),u=c(function(p){return n.throw(p)});function c(p){return function(m){var m=p(m),T=m.value;return m.done?T:T&&typeof T.then=="function"?T.then(o,u):d(T)?Promise.all(T).then(o,u):o(T)}}return c(a)()}function Ii(n,a,o){for(var u=d(n)?n.slice():[n],c=0;c<o;++c)u.push(a);return u}var jc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return i(i({},n),{table:function(u){var o=n.table(u),u=o.schema,c={},p=[];function g(I,C,A){var O=ja(I),S=c[O]=c[O]||[],L=I==null?0:typeof I=="string"?1:I.length,N=0<C,O=i(i({},A),{name:N?"".concat(O,"(virtual-from:").concat(A.name,")"):A.name,lowLevelIndex:A,isVirtual:N,keyTail:C,keyLength:L,extractKey:fs(I),unique:!N&&A.unique});return S.push(O),O.isPrimaryKey||p.push(O),1<L&&g(L===2?I[0]:I.slice(0,L-1),C+1,A),S.sort(function(U,Y){return U.keyTail-Y.keyTail}),O}var m=g(u.primaryKey.keyPath,0,u.primaryKey);c[":id"]=[m];for(var T=0,D=u.indexes;T<D.length;T++){var E=D[T];g(E.keyPath,0,E)}function w(I){var C,A=I.query.index;return A.isVirtual?i(i({},I),{query:{index:A.lowLevelIndex,range:(C=I.query.range,A=A.keyTail,{type:C.type===1?2:C.type,lower:Ii(C.lower,C.lowerOpen?n.MAX_KEY:n.MIN_KEY,A),lowerOpen:!0,upper:Ii(C.upper,C.upperOpen?n.MIN_KEY:n.MAX_KEY,A),upperOpen:!0})}}):I}return i(i({},o),{schema:i(i({},u),{primaryKey:m,indexes:p,getIndexByKeyPath:function(I){return(I=c[ja(I)])&&I[0]}}),count:function(I){return o.count(w(I))},query:function(I){return o.query(w(I))},openCursor:function(I){var C=I.query.index,A=C.keyTail,S=C.keyLength;return C.isVirtual?o.openCursor(w(I)).then(function(N){return N&&L(N)}):o.openCursor(I);function L(N){return Object.create(N,{continue:{value:function(O){O!=null?N.continue(Ii(O,I.reverse?n.MAX_KEY:n.MIN_KEY,A)):I.unique?N.continue(N.key.slice(0,S).concat(I.reverse?n.MIN_KEY:n.MAX_KEY,A)):N.continue()}},continuePrimaryKey:{value:function(O,U){N.continuePrimaryKey(Ii(O,n.MAX_KEY,A),U)}},primaryKey:{get:function(){return N.primaryKey}},key:{get:function(){var O=N.key;return S===1?O[0]:O.slice(0,S)}},value:{get:function(){return N.value}}})}}})}})}};function Ss(n,a,o,u){return o=o||{},u=u||"",f(n).forEach(function(c){var p,g,m;k(a,c)?(p=n[c],g=a[c],typeof p=="object"&&typeof g=="object"&&p&&g?(m=xe(p))!==xe(g)?o[u+c]=a[c]:m==="Object"?Ss(p,g,o,u+c+"."):p!==g&&(o[u+c]=a[c]):p!==g&&(o[u+c]=a[c])):o[u+c]=void 0}),f(a).forEach(function(c){k(n,c)||(o[u+c]=a[c])}),o}function Ts(n,a){return a.type==="delete"?a.keys:a.keys||a.values.map(n.extractKey)}var Bc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return i(i({},n),{table:function(a){var o=n.table(a),u=o.schema.primaryKey;return i(i({},o),{mutate:function(c){var p=ye.trans,g=p.table(a).hook,m=g.deleting,T=g.creating,D=g.updating;switch(c.type){case"add":if(T.fire===Qe)break;return p._promise("readwrite",function(){return E(c)},!0);case"put":if(T.fire===Qe&&D.fire===Qe)break;return p._promise("readwrite",function(){return E(c)},!0);case"delete":if(m.fire===Qe)break;return p._promise("readwrite",function(){return E(c)},!0);case"deleteRange":if(m.fire===Qe)break;return p._promise("readwrite",function(){return(function w(I,C,A){return o.query({trans:I,values:!1,query:{index:u,range:C},limit:A}).then(function(S){var L=S.result;return E({type:"delete",keys:L,trans:I}).then(function(N){return 0<N.numFailures?Promise.reject(N.failures[0]):L.length<A?{failures:[],numFailures:0,lastResult:void 0}:w(I,i(i({},C),{lower:L[L.length-1],lowerOpen:!0}),A)})})})(c.trans,c.range,1e4)},!0)}return o.mutate(c);function E(w){var I,C,A,S=ye.trans,L=w.keys||Ts(u,w);if(L)return(w=w.type==="add"||w.type==="put"?i(i({},w),{keys:L}):i({},w)).type!=="delete"&&(w.values=s([],w.values)),w.keys&&(w.keys=s([],w.keys)),I=o,A=L,((C=w).type==="add"?Promise.resolve([]):I.getMany({trans:C.trans,keys:A,cache:"immutable"})).then(function(N){var O=L.map(function(U,Y){var se,oe,V,he=N[Y],fe={onerror:null,onsuccess:null};return w.type==="delete"?m.fire.call(fe,U,he,S):w.type==="add"||he===void 0?(se=T.fire.call(fe,U,w.values[Y],S),U==null&&se!=null&&(w.keys[Y]=U=se,u.outbound||W(w.values[Y],u.keyPath,U))):(se=Ss(he,w.values[Y]),(oe=D.fire.call(fe,se,U,he,S))&&(V=w.values[Y],Object.keys(oe).forEach(function(ee){k(V,ee)?V[ee]=oe[ee]:W(V,ee,oe[ee])}))),fe});return o.mutate(w).then(function(U){for(var Y=U.failures,se=U.results,oe=U.numFailures,U=U.lastResult,V=0;V<L.length;++V){var he=(se||L)[V],fe=O[V];he==null?fe.onerror&&fe.onerror(Y[V]):fe.onsuccess&&fe.onsuccess(w.type==="put"&&N[V]?w.values[V]:he)}return{failures:Y,results:se,numFailures:oe,lastResult:U}}).catch(function(U){return O.forEach(function(Y){return Y.onerror&&Y.onerror(U)}),Promise.reject(U)})});throw new Error("Keys missing")}}})}})}};function tl(n,a,o){try{if(!a||a.keys.length<n.length)return null;for(var u=[],c=0,p=0;c<a.keys.length&&p<n.length;++c)He(a.keys[c],n[p])===0&&(u.push(o?be(a.values[c]):a.values[c]),++p);return u.length===n.length?u:null}catch{return null}}var zc={stack:"dbcore",level:-1,create:function(n){return{table:function(a){var o=n.table(a);return i(i({},o),{getMany:function(u){var c;return u.cache?(c=tl(u.keys,u.trans._cache,u.cache==="clone"))?le.resolve(c):o.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?be(p):p},p}):o.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function nl(n,a){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function rl(n,a){switch(n){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Fc={stack:"dbcore",level:0,name:"Observability",create:function(n){var a=n.schema.name,o=new Ct(n.MIN_KEY,n.MAX_KEY);return i(i({},n),{transaction:function(u,c,p){if(ye.subscr&&c!=="readonly")throw new ke.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ye.querier));return n.transaction(u,c,p)},table:function(u){function c(L){var S,L=L.query;return[S=L.index,new Ct((S=(L=L.range).lower)!=null?S:n.MIN_KEY,(S=L.upper)!=null?S:n.MAX_KEY)]}var p=n.table(u),g=p.schema,m=g.primaryKey,T=g.indexes,D=m.extractKey,E=m.outbound,w=m.autoIncrement&&T.filter(function(A){return A.compound&&A.keyPath.includes(m.keyPath)}),I=i(i({},p),{mutate:function(A){function S(me){return me="idb://".concat(a,"/").concat(u,"/").concat(me),Y[me]||(Y[me]=new Ct)}var L,N,O,U=A.trans,Y=A.mutatedParts||(A.mutatedParts={}),se=S(""),oe=S(":dels"),V=A.type,fe=A.type==="deleteRange"?[A.range]:A.type==="delete"?[A.keys]:A.values.length<50?[Ts(m,A).filter(function(me){return me}),A.values]:[],he=fe[0],fe=fe[1],ee=A.trans._cache;return d(he)?(se.addKeys(he),(V=V==="delete"||he.length===fe.length?tl(he,ee):null)||oe.addKeys(he),(V||fe)&&(L=S,N=V,O=fe,g.indexes.forEach(function(me){var We=L(me.name||"");function Xe(je){return je!=null?me.extractKey(je):null}function Ie(je){me.multiEntry&&d(je)?je.forEach(function(ot){return We.addKey(ot)}):We.addKey(je)}(N||O).forEach(function(je,lt){var tn=N&&Xe(N[lt]),lt=O&&Xe(O[lt]);He(tn,lt)!==0&&(tn!=null&&Ie(tn),lt!=null)&&Ie(lt)})}))):he?(fe={from:(ee=he.lower)!=null?ee:n.MIN_KEY,to:(V=he.upper)!=null?V:n.MAX_KEY},oe.add(fe),se.add(fe)):(se.add(o),oe.add(o),g.indexes.forEach(function(me){return S(me.name).add(o)})),p.mutate(A).then(function(me){return!he||A.type!=="add"&&A.type!=="put"||(se.addKeys(me.results),w&&w.forEach(function(We){for(var Xe=A.values.map(function(tn){return We.extractKey(tn)}),Ie=We.keyPath.findIndex(function(tn){return tn===m.keyPath}),je=0,ot=me.results.length;je<ot;++je)Xe[je][Ie]=me.results[je];S(We.name).addKeys(Xe)})),U.mutatedParts=Ei(U.mutatedParts||{},Y),me})}}),C={get:function(A){return[m,new Ct(A.key)]},getMany:function(A){return[m,new Ct().addKeys(A.keys)]},count:c,query:c,openCursor:c};return f(C).forEach(function(A){I[A]=function(S){var L=ye.subscr,N=!!L,O=nl(ye,p)&&rl(A,S)?S.obsSet={}:L;if(N){var U,L=function(fe){return fe="idb://".concat(a,"/").concat(u,"/").concat(fe),O[fe]||(O[fe]=new Ct)},Y=L(""),se=L(":dels"),N=C[A](S),oe=N[0],N=N[1];if((A==="query"&&oe.isPrimaryKey&&!S.values?se:L(oe.name||"")).add(N),!oe.isPrimaryKey){if(A!=="count")return U=A==="query"&&E&&S.values&&p.query(i(i({},S),{values:!1})),p[A].apply(this,arguments).then(function(fe){if(A==="query"){if(E&&S.values)return U.then(function(Xe){return Xe=Xe.result,Y.addKeys(Xe),fe});var ee=S.values?fe.result.map(D):fe.result;(S.values?Y:se).addKeys(ee)}else{var me,We;if(A==="openCursor")return We=S.values,(me=fe)&&Object.create(me,{key:{get:function(){return se.addKey(me.primaryKey),me.key}},primaryKey:{get:function(){var Xe=me.primaryKey;return se.addKey(Xe),Xe}},value:{get:function(){return We&&Y.addKey(me.primaryKey),me.value}}})}return fe});se.add(o)}}return p[A].apply(this,arguments)}}),I}})}};function al(n,a,o){var u;return o.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,o.numFailures===u)?null:(u=i({},a),d(u.keys)&&(u.keys=u.keys.filter(function(c,p){return!(p in o.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(c,p){return!(p in o.failures)})),u)}function Es(n,a){return o=n,((u=a).lower===void 0||(u.lowerOpen?0<He(o,u.lower):0<=He(o,u.lower)))&&(o=n,(u=a).upper===void 0||(u.upperOpen?He(o,u.upper)<0:He(o,u.upper)<=0));var o,u}function il(n,a,o,u,c,p){var g,m,T,D,E,w;return!o||o.length===0||(g=a.query.index,m=g.multiEntry,T=a.query.range,D=u.schema.primaryKey.extractKey,E=g.extractKey,w=(g.lowLevelIndex||g).extractKey,(u=o.reduce(function(I,C){var A=I,S=[];if(C.type==="add"||C.type==="put")for(var L=new Ct,N=C.values.length-1;0<=N;--N){var O,U=C.values[N],Y=D(U);!L.hasKey(Y)&&(O=E(U),m&&d(O)?O.some(function(fe){return Es(fe,T)}):Es(O,T))&&(L.addKey(Y),S.push(U))}switch(C.type){case"add":var se=new Ct().addKeys(a.values?I.map(function(ee){return D(ee)}):I),A=I.concat(a.values?S.filter(function(ee){return ee=D(ee),!se.hasKey(ee)&&(se.addKey(ee),!0)}):S.map(function(ee){return D(ee)}).filter(function(ee){return!se.hasKey(ee)&&(se.addKey(ee),!0)}));break;case"put":var oe=new Ct().addKeys(C.values.map(function(ee){return D(ee)}));A=I.filter(function(ee){return!oe.hasKey(a.values?D(ee):ee)}).concat(a.values?S:S.map(function(ee){return D(ee)}));break;case"delete":var V=new Ct().addKeys(C.keys);A=I.filter(function(ee){return!V.hasKey(a.values?D(ee):ee)});break;case"deleteRange":var he=C.range;A=I.filter(function(ee){return!Es(D(ee),he)})}return A},n))===n)?n:(u.sort(function(I,C){return He(w(I),w(C))||He(D(I),D(C))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:n.length===a.limit&&u.length<a.limit&&(c.dirty=!0)),p?Object.freeze(u):u)}function sl(n,a){return He(n.lower,a.lower)===0&&He(n.upper,a.upper)===0&&!!n.lowerOpen==!!a.lowerOpen&&!!n.upperOpen==!!a.upperOpen}function Kc(n,a){return((o,u,c,p)=>{if(o===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((o=He(o,u))===0){if(c&&p)return 0;if(c)return 1;if(p)return-1}return o})(n.lower,a.lower,n.lowerOpen,a.lowerOpen)<=0&&0<=((o,u,c,p)=>{if(o===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((o=He(o,u))===0){if(c&&p)return 0;if(c)return-1;if(p)return 1}return o})(n.upper,a.upper,n.upperOpen,a.upperOpen)}function Uc(n,a,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){var c,p;n.subscribers.delete(o),n.subscribers.size===0&&(c=n,p=a,setTimeout(function(){c.subscribers.size===0&&B(p,c)},3e3))})}var Gc={stack:"dbcore",level:0,name:"Cache",create:function(n){var a=n.schema.name;return i(i({},n),{transaction:function(o,u,c){var p,g,m=n.transaction(o,u,c);return u==="readwrite"&&(c=(p=new AbortController).signal,m.addEventListener("abort",(g=function(T){return function(){if(p.abort(),u==="readwrite"){for(var D=new Set,E=0,w=o;E<w.length;E++){var I=w[E],C=Ir["idb://".concat(a,"/").concat(I)];if(C){var A=n.table(I),S=C.optimisticOps.filter(function(me){return me.trans===m});if(m._explicit&&T&&m.mutatedParts)for(var L=0,N=Object.values(C.queries.query);L<N.length;L++)for(var O=0,U=(oe=N[L]).slice();O<U.length;O++)bs((V=U[O]).obsSet,m.mutatedParts)&&(B(oe,V),V.subscribers.forEach(function(me){return D.add(me)}));else if(0<S.length){C.optimisticOps=C.optimisticOps.filter(function(me){return me.trans!==m});for(var Y=0,se=Object.values(C.queries.query);Y<se.length;Y++)for(var oe,V,he,fe=0,ee=(oe=se[Y]).slice();fe<ee.length;fe++)(V=ee[fe]).res!=null&&m.mutatedParts&&(T&&!V.dirty?(he=Object.isFrozen(V.res),he=il(V.res,V.req,S,A,V,he),V.dirty?(B(oe,V),V.subscribers.forEach(function(me){return D.add(me)})):he!==V.res&&(V.res=he,V.promise=le.resolve({result:he}))):(V.dirty&&B(oe,V),V.subscribers.forEach(function(me){return D.add(me)})))}}}D.forEach(function(me){return me()})}}})(!1),{signal:c}),m.addEventListener("error",g(!1),{signal:c}),m.addEventListener("complete",g(!0),{signal:c})),m},table:function(o){var u=n.table(o),c=u.schema.primaryKey;return i(i({},u),{mutate:function(p){var g,m=ye.trans;return!c.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Ir["idb://".concat(a,"/").concat(o)])?(m=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Ts(c,p).some(function(T){return T==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Ai(p.mutatedParts),m.then(function(T){0<T.numFailures&&(B(g.optimisticOps,p),(T=al(0,p,T))&&g.optimisticOps.push(T),p.mutatedParts)&&Ai(p.mutatedParts)}),m.catch(function(){B(g.optimisticOps,p),p.mutatedParts&&Ai(p.mutatedParts)})):m.then(function(T){var D=al(0,i(i({},p),{values:p.values.map(function(E,w){var I;return T.failures[w]?E:(W(I=(I=c.keyPath)!=null&&I.includes(".")?be(E):i({},E),c.keyPath,T.results[w]),I)})}),T);g.optimisticOps.push(D),queueMicrotask(function(){return p.mutatedParts&&Ai(p.mutatedParts)})}),m):u.mutate(p)},query:function(p){var g,m,T,D,E,w,I;return nl(ye,u)&&rl("query",p)?(g=((T=ye.trans)==null?void 0:T.db._options.cache)==="immutable",m=(T=ye).requery,T=T.signal,w=((C,A,S,L)=>{var N=Ir["idb://".concat(C,"/").concat(A)];if(!N)return[];if(!(C=N.queries[S]))return[null,!1,N,null];var O=C[(L.query?L.query.index.name:null)||""];if(!O)return[null,!1,N,null];switch(S){case"query":var U=O.find(function(Y){return Y.req.limit===L.limit&&Y.req.values===L.values&&sl(Y.req.query.range,L.query.range)});return U?[U,!0,N,O]:[O.find(function(Y){return("limit"in Y.req?Y.req.limit:1/0)>=L.limit&&(!L.values||Y.req.values)&&Kc(Y.req.query.range,L.query.range)}),!1,N,O];case"count":return U=O.find(function(Y){return sl(Y.req.query.range,L.query.range)}),[U,!!U,N,O]}})(a,o,"query",p),I=w[0],D=w[2],E=w[3],I&&w[1]?I.obsSet=p.obsSet:(w=u.query(p).then(function(C){var A=C.result;if(I&&(I.res=A),g){for(var S=0,L=A.length;S<L;++S)Object.freeze(A[S]);Object.freeze(A)}else C.result=be(A);return C}).catch(function(C){return E&&I&&B(E,I),Promise.reject(C)}),I={obsSet:p.obsSet,promise:w,subscribers:new Set,type:"query",req:p,dirty:!1},E?E.push(I):(E=[I],(D=D||(Ir["idb://".concat(a,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=E)),Uc(I,E,m,T),I.promise.then(function(C){return{result:il(C.result,p,D==null?void 0:D.optimisticOps,u,I,g)}})):u.query(p)}})}})}};function Ci(n,a){return new Proxy(n,{get:function(o,u,c){return u==="db"?a:Reflect.get(o,u,c)}})}ft.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ke.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ke.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var a=this._versions,o=a.filter(function(u){return u._cfg.version===n})[0];return o||(o=new this.Version(n),a.push(o),a.sort(Dc),o.stores({}),this._state.autoSchema=!1),o},ft.prototype._whenReady=function(n){var a=this;return this.idbdb&&(this._state.openComplete||ye.letThrough||this._vip)?n():new le(function(o,u){if(a._state.openComplete)return u(new ke.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new ke.DatabaseClosed);a.open().catch(Qe)}a._state.dbReadyPromise.then(o,u)}).then(n)},ft.prototype.use=function(c){var a=c.stack,o=c.create,u=c.level,c=c.name,p=(c&&this.unuse({stack:a,name:c}),this._middlewares[a]||(this._middlewares[a]=[]));return p.push({stack:a,create:o,level:u??10,name:c}),p.sort(function(g,m){return g.level-m.level}),this},ft.prototype.unuse=function(n){var a=n.stack,o=n.name,u=n.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(c){return u?c.create!==u:!!o&&c.name!==o})),this},ft.prototype.open=function(){var n=this;return _e(mt,function(){return qc(n)})},ft.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,a=ct.indexOf(this);if(0<=a&&ct.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new le(function(o){n.dbReadyResolve=o}),n.openCanceller=new le(function(o,u){n.cancelOpen=u}))},ft.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,o=this._state;a?(o.isBeingOpened&&o.cancelOpen(new ke.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new ke.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},ft.prototype.delete=function(n){var a=this,o=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new le(function(c,p){function g(){a.close(n);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=tt(function(){var T,D,E;T=a._deps,D=a.name,gs(E=T.indexedDB)||D===qt||vs(E,T.IDBKeyRange).delete(D).catch(Qe),c()}),m.onerror=In(p),m.onblocked=a._fireOnBlocked}if(o)throw new ke.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},ft.prototype.backendDB=function(){return this.idbdb},ft.prototype.isOpen=function(){return this.idbdb!==null},ft.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},ft.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ft.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ft.prototype,"tables",{get:function(){var n=this;return f(this._allTables).map(function(a){return n._allTables[a]})},enumerable:!1,configurable:!0}),ft.prototype.transaction=function(){var n=(function(a,o,u){var c=arguments.length;if(c<2)throw new ke.InvalidArgument("Too few arguments");for(var p=new Array(c-1);--c;)p[c-1]=arguments[c];return u=p.pop(),[a,Ce(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},ft.prototype._transaction=function(n,a,o){var u,c,p=this,g=ye.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(c=a.map(function(D){if(D=D instanceof p.Table?D.name:D,typeof D!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return D}),n=="r"||n===An)u=An;else{if(n!="rw"&&n!=Er)throw new ke.InvalidArgument("Invalid transaction mode: "+n);u=Er}if(g){if(g.mode===An&&u===Er){if(!m)throw new ke.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&c.forEach(function(D){if(g&&g.storeNames.indexOf(D)===-1){if(!m)throw new ke.SubTransaction("Table "+D+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(D){return g?g._promise(null,function(E,w){w(D)}):ae(D)}var T=(function D(E,w,I,C,A){return le.resolve().then(function(){var O=ye.transless||ye,S=E._createTransaction(w,I,E._dbSchema,C),O=(S.explicit=!0,{trans:S,transless:O});if(C)S.idbtrans=C.idbtrans;else try{S.create(),S.idbtrans._explicit=!0,E._state.PR1398_maxLoop=3}catch(U){return U.name===at.InvalidState&&E.isOpen()&&0<--E._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),E.close({disableAutoOpen:!1}),E.open().then(function(){return D(E,w,I,null,A)})):ae(U)}var L,N=pe(A),O=(N&&It(),le.follow(function(){var U;(L=A.call(S,S))&&(N?(U=vn.bind(null,null),L.then(U,U)):typeof L.next=="function"&&typeof L.throw=="function"&&(L=xs(L)))},O));return(L&&typeof L.then=="function"?le.resolve(L).then(function(U){return S.active?U:ae(new ke.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return L})).then(function(U){return C&&S._resolve(),S._completion.then(function(){return U})}).catch(function(U){return S._reject(U),ae(U)})})}).bind(null,this,u,c,g,o);return g?g._promise(u,T,"lock"):ye.trans?_e(ye.transless,function(){return p._whenReady(T)}):this._whenReady(T)},ft.prototype.table=function(n){if(k(this._allTables,n))return this._allTables[n];throw new ke.InvalidTable("Table ".concat(n," does not exist"))};var Kn=ft;function ft(n,a){var o,u,c,p,g,m=this,T=(this._middlewares={},this.verno=0,ft.dependencies),T=(this._options=a=i({addons:ft.addons,autoOpen:!0,indexedDB:T.indexedDB,IDBKeyRange:T.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),D=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Qe,dbReadyPromise:null,cancelOpen:Qe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),E=(D.dbReadyPromise=new le(function(w){D.dbReadyResolve=w}),D.openCanceller=new le(function(w,I){D.cancelOpen=I}),this._state=D,this.name=n,this.on=Da(this,"populate","blocked","versionchange","close",{ready:[Jn,Qe]}),this.once=function(w,I){var C=function(){for(var A=[],S=0;S<arguments.length;S++)A[S]=arguments[S];m.on(w).unsubscribe(C),I.apply(m,A)};return m.on(w,C)},this.on.ready.subscribe=ne(this.on.ready.subscribe,function(w){return function(I,C){ft.vip(function(){var A,S=m._state;S.openComplete?(S.dbOpenError||le.resolve().then(I),C&&w(I)):S.onReadyBeingFired?(S.onReadyBeingFired.push(I),C&&w(I)):(w(I),A=m,C||w(function L(){A.on.ready.unsubscribe(I),A.on.ready.unsubscribe(L)}))})}}),this.Collection=(o=this,Ma(Ec.prototype,function(L,S){this.db=o;var C=Ra,A=null;if(S)try{C=S()}catch(O){A=O}var S=L._ctx,L=S.table,N=L.hook.reading.fire;this._ctx={table:L,index:S.index,isPrimKey:!S.index||L.schema.primKey.keyPath&&S.index===L.schema.primKey.name,range:C,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:A,or:S.or,valueMapper:N!==Zt?N:null}})),this.Table=(u=this,Ma(Fo.prototype,function(w,I,C){this.db=u,this._tx=C,this.name=w,this.schema=I,this.hook=u._allTables[w]?u._allTables[w].hook:Da(null,{creating:[Ea,Qe],reading:[Zr,Zt],updating:[Zn,Qe],deleting:[Aa,Qe]})})),this.Transaction=(c=this,Ma(Cc.prototype,function(w,I,C,A,S){var L=this;w!=="readonly"&&I.forEach(function(N){N=(N=C[N])==null?void 0:N.yProps,N&&(I=I.concat(N.map(function(O){return O.updatesTable})))}),this.db=c,this.mode=w,this.storeNames=I,this.schema=C,this.chromeTransactionDurability=A,this.idbtrans=null,this.on=Da(this,"complete","error","abort"),this.parent=S||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new le(function(N,O){L._resolve=N,L._reject=O}),this._completion.then(function(){L.active=!1,L.on.complete.fire()},function(N){var O=L.active;return L.active=!1,L.on.error.fire(N),L.parent?L.parent._reject(N):O&&L.idbtrans&&L.idbtrans.abort(),ae(N)})})),this.Version=(p=this,Ma(Nc.prototype,function(w){this.db=p,this._cfg={version:w,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Ma(Wo.prototype,function(w,I,C){if(this.db=g,this._ctx={table:w,index:I===":id"?null:I,or:C},this._cmp=this._ascending=He,this._descending=function(A,S){return He(S,A)},this._max=function(A,S){return 0<He(A,S)?A:S},this._min=function(A,S){return He(A,S)<0?A:S},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new ke.MissingAPI})),this.on("versionchange",function(w){0<w.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(w){!w.newVersion||w.newVersion<w.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(w.oldVersion/10))}),this._maxKey=qa(a.IDBKeyRange),this._createTransaction=function(w,I,C,A){return new m.Transaction(w,I,C,m._options.chromeTransactionDurability,A)},this._fireOnBlocked=function(w){m.on("blocked").fire(w),ct.filter(function(I){return I.name===m.name&&I!==m&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(w)})},this.use(zc),this.use(Gc),this.use(Fc),this.use(jc),this.use(Bc),new Proxy(this,{get:function(w,I,C){var A;return I==="_vip"||(I==="table"?function(S){return Ci(m.table(S),E)}:(A=Reflect.get(w,I,C))instanceof Fo?Ci(A,E):I==="tables"?A.map(function(S){return Ci(S,E)}):I==="_createTransaction"?function(){return Ci(A.apply(this,arguments),E)}:A)}}));this.vip=E,T.forEach(function(w){return w(m)})}var Pi,sa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Hc=(As.prototype.subscribe=function(n,a,o){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:a,complete:o})},As.prototype[sa]=function(){return this},As);function As(n){this._subscribe=n}try{Pi={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Pi={indexedDB:null,IDBKeyRange:null}}function ol(n){var a,o=!1,u=new Hc(function(c){var p=pe(n),g,m=!1,T={},D={},E={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),w&&or.storagemutated.unsubscribe(C))}},w=(c.start&&c.start(E),!1),I=function(){return X(A)},C=function(S){Ei(T,S),bs(D,T)&&I()},A=function(){var S,L,N;!m&&Pi.indexedDB&&(T={},S={},g&&g.abort(),g=new AbortController,N=(O=>{var U=ir();try{p&&It();var Y=hn(n,O);return Y=p?Y.finally(vn):Y}finally{U&&Fn()}})(L={subscr:S,signal:g.signal,requery:I,querier:n,trans:null}),Promise.resolve(N).then(function(O){o=!0,a=O,m||L.signal.aborted||(T={},(U=>{for(var Y in U)if(k(U,Y))return;return 1})(D=S)||w||(or(Na,C),w=!0),X(function(){return!m&&c.next&&c.next(O)}))},function(O){o=!1,["DatabaseClosedError","AbortError"].includes(O==null?void 0:O.name)||m||X(function(){m||c.error&&c.error(O)})}))};return setTimeout(I,0),E});return u.hasValue=function(){return o},u.getValue=function(){return a},u}var Cr=Kn;function Is(n){var a=lr;try{lr=!0,or.storagemutated.fire(n),ks(n,!0)}finally{lr=a}}b(Cr,i(i({},Oe),{delete:function(n){return new Cr(n,{addons:[]}).delete()},exists:function(n){return new Cr(n,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return a=Cr.dependencies,o=a.indexedDB,a=a.IDBKeyRange,(gs(o)?Promise.resolve(o.databases()).then(function(u){return u.map(function(c){return c.name}).filter(function(c){return c!==qt})}):vs(o,a).toCollection().primaryKeys()).then(n)}catch{return ae(new ke.MissingAPI)}var a,o},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return ye.trans?_e(ye.transless,n):n()},vip:ms,async:function(n){return function(){try{var a=xs(n.apply(this,arguments));return a&&typeof a.then=="function"?a:le.resolve(a)}catch(o){return ae(o)}}},spawn:function(n,a,o){try{var u=xs(n.apply(o,a||[]));return u&&typeof u.then=="function"?u:le.resolve(u)}catch(c){return ae(c)}},currentTransaction:{get:function(){return ye.trans||null}},waitFor:function(n,a){return n=le.resolve(typeof n=="function"?Cr.ignoreTransaction(n):n).timeout(a||6e4),ye.trans?ye.trans.waitFor(n):n},Promise:le,debug:{get:function(){return Kt},set:function(n){Ia(n)}},derive:j,extend:v,props:b,override:ne,Events:Da,on:or,liveQuery:ol,extendObservabilitySet:Ei,getByKeyPath:ve,setByKeyPath:W,delByKeyPath:function(n,a){typeof a=="string"?W(n,a,void 0):"length"in a&&[].map.call(a,function(o){W(n,o,void 0)})},shallowClone:Z,deepClone:be,getObjectDiff:Ss,cmp:He,asap:J,minKey:-1/0,addons:[],connections:ct,errnames:at,dependencies:Pi,cache:Ir,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,a,o){return n+a/Math.pow(10,2*o)})})),Cr.maxKey=qa(Cr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(or(Na,function(n){lr||(n=new CustomEvent(ls,{detail:n}),lr=!0,dispatchEvent(n),lr=!1)}),addEventListener(ls,function(n){n=n.detail,lr||Is(n)}));var oa,lr=!1,ll=function(){};return typeof BroadcastChannel<"u"&&((ll=function(){(oa=new BroadcastChannel(ls)).onmessage=function(n){return n.data&&Is(n.data)}})(),typeof oa.unref=="function"&&oa.unref(),or(Na,function(n){lr||oa.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Kn.disableBfCache&&n.persisted){Kt&&console.debug("Dexie: handling persisted pagehide"),oa!=null&&oa.close();for(var a=0,o=ct;a<o.length;a++)o[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Kn.disableBfCache&&n.persisted&&(Kt&&console.debug("Dexie: handling persisted pageshow"),ll(),Is({all:new Ct(-1/0,[[]])}))})),le.rejectionMapper=function(n,a){return!n||n instanceof De||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Ta[n.name]?n:(a=new Ta[n.name](a||n.message,n),"stack"in n&&q(a,"stack",{get:function(){return this.inner.stack}}),a)},Ia(Kt),i(Kn,Object.freeze({__proto__:null,Dexie:Kn,Entity:No,PropModification:Oa,RangeSet:Ct,add:function(n){return new Oa({add:n})},cmp:He,default:Kn,liveQuery:ol,mergeRanges:za,rangesOverlap:Qo,remove:function(n){return new Oa({remove:n})},replacePrefix:function(n,a){return new Oa({replacePrefix:[n,a]})}}),{default:Kn}),Kn})})(Fi)),Fi.exports}var Rd=Pd();const to=Id(Rd),Al=Symbol.for("Dexie"),on=globalThis[Al]||(globalThis[Al]=to);if(to.semVer!==on.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${to.semVer} and ${on.semVer}`);const{liveQuery:Tg,mergeRanges:Eg,rangesOverlap:Ag,RangeSet:Ig,cmp:Cg,Entity:Pg,PropModification:Rg,replacePrefix:Og,add:Dg,remove:Mg,DexieYProvider:Lg}=on,Fe=new on("me-ai-store");Fe.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});function Xu(t,e){return`${t}:${e}`}async function Od(){const t=await Fe.items.where("sourceType").equals("gmail").count(),e=await Fe.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],i=await Fe.items.where("[sourceType+date]").between(["gmail",on.minKey],["gmail",on.maxKey]).first(),s=await Fe.items.where("[sourceType+date]").between(["gmail",on.minKey],["gmail",on.maxKey]).last();if(i&&s){const f=new Date(i.date).toLocaleDateString(),d=new Date(s.date).toLocaleDateString();r.push(`Date range: ${f} to ${d}.`)}const l=await Qu(5);return l.length>0&&r.push("Top senders: "+l.map(([f,d])=>`${zd(f)} (${d})`).join(", ")+"."),r.join(" ")}async function Dd(){const t=await Fe.items.where("sourceType").equals("gmail").count(),e=await Fe.contacts.count();if(t===0)return"No emails stored locally.";const r=await Qu(10),i=await jd(10),s=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],l=await Fe.items.where("sourceType").equals("gmail").sortBy("date");if(l.length>0){const f=new Date(l[0].date).toLocaleDateString(),d=new Date(l[l.length-1].date).toLocaleDateString();s.push(`- **Date range:** ${f} â ${d}`)}if(r.length>0){s.push("","### Top Senders");for(const[f,d]of r)s.push(`- ${f}: ${d}`)}if(i.length>0){s.push("","### Labels");for(const[f,d]of i)s.push(`- ${f}: ${d}`)}return s.join(`
`)}async function Md(t=10){const e=await Fe.items.where("[sourceType+date]").between(["gmail",on.minKey],["gmail",on.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Zu).join(`

---

`)}async function Ld(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),s=(await Fe.items.toArray()).map(l=>{var d,v,h,y,k;let f=0;return(d=l.subject)!=null&&d.toLowerCase().includes(r)&&(f+=3),(v=l.from)!=null&&v.toLowerCase().includes(r)&&(f+=2),(h=l.to)!=null&&h.toLowerCase().includes(r)&&(f+=2),(y=l.snippet)!=null&&y.toLowerCase().includes(r)&&(f+=1),(k=l.body)!=null&&k.toLowerCase().includes(r)&&(f+=1),{item:l,score:f}}).filter(({score:l})=>l>0).sort((l,f)=>f.score-l.score).slice(0,e);return s.length===0?`No results found for "${t}".`:s.map(({item:l})=>Zu(l)).join(`

---

`)}async function Nd(){const t=await Od();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function qd(t){const e=[],r=await Dd();if(e.push(r),t){const i=await Ld(t,5);e.push("","## Relevant Emails",i)}else{const i=await Md(5);e.push("","## Recent Emails",i)}return e.join(`
`)}async function Qu(t){const e=await Fe.items.where("sourceType").equals("gmail").toArray(),r={};for(const i of e){const s=i.from||"Unknown";r[s]=(r[s]||0)+1}return Object.entries(r).sort((i,s)=>s[1]-i[1]).slice(0,t)}async function jd(t){const e=await Fe.items.where("sourceType").equals("gmail").toArray(),r={};for(const i of e)for(const s of i.labels||[])r[s]=(r[s]||0)+1;return Object.entries(r).sort((i,s)=>s[1]-i[1]).slice(0,t)}function Zu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Bd(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}function Bd(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function zd(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}async function Fd({query:t,limit:e=50,offset:r=0}={}){if(t){const l=t.toLowerCase(),f=await Fe.items.where("sourceType").equals("gmail").filter(d=>{var v,h,y,k;return((v=d.subject)==null?void 0:v.toLowerCase().includes(l))||((h=d.from)==null?void 0:h.toLowerCase().includes(l))||((y=d.to)==null?void 0:y.toLowerCase().includes(l))||((k=d.snippet)==null?void 0:k.toLowerCase().includes(l))}).toArray();return f.sort((d,v)=>(v.date||0)-(d.date||0)),{items:f.slice(r,r+e),total:f.length}}const i=await Fe.items.where("sourceType").equals("gmail").count();return{items:await Fe.items.where("[sourceType+date]").between(["gmail",on.minKey],["gmail",on.maxKey]).reverse().offset(r).limit(e).toArray(),total:i}}function no(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,i)).toFixed(1)+" "+r[i]}function Ns(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e)),s=t/Math.pow(e,i),l=i>=2?2:i>=1?1:0;return s.toFixed(l)+" "+r[i]}function Kd(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}const Ud=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Il(...t){Ud&&console.log("[debug]",...t)}function Qt(t){return Il(`[MOUNT] ${t}`),()=>Il(`[DESTROY] ${t}`)}var Gd=te("<option> </option>"),Hd=te('<p class="model-description svelte-1p89qnn"> </p>'),Wd=te('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),$d=te('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Yd=te('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Vd=te('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Xd=te('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Qd=te('<p class="error svelte-1p89qnn"> </p>'),Zd=te('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Jd(t,e){Et(e,!0);let r=Ne(e,"selectedModel",15),i=Ne(e,"gpuInfo",3,null),s=Ne(e,"error",3,null);Rt(()=>Qt("ModelSelector"));var l=Zd(),f=K(M(l),2),d=K(M(f),2);Sa(d,21,()=>eo,xa,(j,P)=>{var F=Gd(),re=M(F),ne={};we(()=>{de(re,`${R(P).name??""} â ${R(P).size??""}`),ne!==(ne=R(P).id)&&(F.value=(F.__value=R(P).id)??"")}),Q(j,F)});var v=K(d,2);{var h=j=>{const P=gr(()=>eo.find($=>$.id===r()));var F=Hu(),re=Vt(F);{var ne=$=>{var J=Hd(),ve=M(J);we(()=>de(ve,R(P).description)),Q($,J)};Ae(re,$=>{R(P)&&$(ne)})}Q(j,F)};Ae(v,j=>{r()&&j(h)})}var y=K(f,2);{var k=j=>{var P=Xd(),F=K(M(P),2),re=M(F),ne=K(M(re)),$=M(ne),J=K(re,2),ve=K(M(J)),W=M(ve),Z=K(J,2);{var Ee=Se=>{var Pe=Wd(),B=K(M(Pe)),H=M(B);we(()=>de(H,i().device)),Q(Se,Pe)};Ae(Z,Se=>{i().device&&i().device!=="unknown"&&Se(Ee)})}var Ce=K(Z,2);{var ie=Se=>{var Pe=$d(),B=K(M(Pe)),H=M(B);we(()=>de(H,i().description)),Q(Se,Pe)};Ae(Ce,Se=>{i().description&&i().description!=="unknown"&&Se(ie)})}var ce=K(Ce,2);{var be=Se=>{var Pe=Yd(),B=K(M(Pe)),H=M(B);we(ue=>de(H,ue),[()=>no(i().limits.maxBufferSize)]),Q(Se,Pe)};Ae(ce,Se=>{var Pe;(Pe=i().limits)!=null&&Pe.maxBufferSize&&Se(be)})}var Me=K(ce,2);{var xe=Se=>{var Pe=Vd(),B=K(M(Pe)),H=M(B);we(()=>de(H,`${i().features.length??""} supported`)),Q(Se,Pe)};Ae(Me,Se=>{var Pe;(Pe=i().features)!=null&&Pe.length&&Se(xe)})}we(()=>{de($,i().vendor),de(W,i().architecture)}),Q(j,P)};Ae(y,j=>{i()&&j(k)})}var b=K(y,2);{var _=j=>{var P=Qd(),F=M(P);we(()=>de(F,s())),Q(j,P)};Ae(b,j=>{s()&&j(_)})}var q=K(b,2);q.__click=function(...j){var P;(P=e.onload)==null||P.apply(this,j)},we(()=>q.disabled=s()),$u(d,r),Q(t,l),At()}qn(["click"]);var ep=te('<span class="progress-percent svelte-r5fnze"> </span>'),tp=te('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),np=te('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),rp=te('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),ap=te('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),ip=te('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),sp=te('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function op(t,e){Et(e,!0);let r=Ne(e,"message",3,""),i=Ne(e,"items",19,()=>[]);Rt(()=>Qt("LoadingProgress"));var s=sp(),l=M(s),f=M(l),d=K(l,2);Sa(d,17,i,xa,(v,h)=>{const y=gr(()=>R(h).total?Kd(R(h).loaded||0,R(h).total):null);var k=ip(),b=M(k),_=M(b),q=M(_),j=K(_,2);{var P=$=>{var J=ep(),ve=M(J);we(W=>de(ve,`${W??""}%`),[()=>R(y).toFixed(1)]),Q($,J)};Ae(j,$=>{R(y)!==null&&$(P)})}var F=K(b,2);{var re=$=>{var J=tp(),ve=Vt(J),W=M(ve),Z=K(ve,2),Ee=M(Z),Ce=M(Ee),ie=K(Ee,4),ce=M(ie),be=K(ie,2),Me=M(be);we((xe,Se,Pe,B,H)=>{Wi(W,`width: ${xe??""}%`),de(Ce,Se),de(ce,Pe),de(Me,`(${B??""} / ${H??""} B)`)},[()=>Math.max(R(h).progress??0,.5).toFixed(1),()=>Ns(R(h).loaded||0),()=>Ns(R(h).total),()=>(R(h).loaded||0).toLocaleString(),()=>R(h).total.toLocaleString()]),Q($,J)},ne=$=>{var J=ap(),ve=K(Vt(J),2),W=M(ve);{var Z=Ce=>{var ie=np(),ce=Vt(ie),be=M(ce),Me=K(ce,2),xe=M(Me);we((Se,Pe)=>{de(be,Se),de(xe,`(${Pe??""} B)`)},[()=>Ns(R(h).loaded),()=>R(h).loaded.toLocaleString()]),Q(Ce,ie)},Ee=Ce=>{var ie=rp();Q(Ce,ie)};Ae(W,Ce=>{R(h).loaded?Ce(Z):Ce(Ee,!1)})}Q($,J)};Ae(F,$=>{R(h).total?$(re):$(ne,!1)})}we(()=>{Yu(_,"title",R(h).file),de(q,R(h).file)}),Q(v,k)}),we(()=>de(f,r())),Q(t,s),At()}var lp=te('<span class="thinking-tokens svelte-11gjw00"> </span>'),up=te('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),cp=te('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),fp=te('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),dp=te('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),pp=te('<span class="cursor svelte-11gjw00">|</span>'),hp=te(" <!>",1),vp=te('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),gp=te('<div class="content svelte-11gjw00"> </div>'),mp=te('<div><div class="role svelte-11gjw00"> </div> <!></div>');function yp(t,e){Et(e,!0);let r=Ne(e,"isLast",3,!1),i=Ne(e,"isRunning",3,!1),s=Ne(e,"generationPhase",3,null),l=Ne(e,"numTokens",3,null);Rt(()=>Qt(`MessageBubble[${e.msg.role}]`));var f=mp(),d=M(f),v=M(d),h=K(d,2);{var y=b=>{var _=vp(),q=Vt(_);{var j=W=>{var Z=up(),Ee=K(M(Z),4);{var Ce=ie=>{var ce=lp(),be=M(ce);we(()=>de(be,`${l()??""} tokens`)),Q(ie,ce)};Ae(Ee,ie=>{l()&&ie(Ce)})}Q(W,Z)},P=W=>{var Z=cp();Q(W,Z)};Ae(q,W=>{i()&&r()&&s()==="thinking"?W(j):i()&&r()&&s()==="preparing"&&W(P,1)})}var F=K(q,2);{var re=W=>{var Z=fp(),Ee=M(Z),Ce=K(M(Ee),2),ie=M(Ce),ce=K(Ee,2),be=M(ce);we(Me=>{de(ie,`${Me??""} words`),de(be,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),Q(W,Z)};Ae(F,W=>{e.msg.thinking&&W(re)})}var ne=K(F,2),$=M(ne);{var J=W=>{var Z=dp();Q(W,Z)},ve=W=>{var Z=hp(),Ee=Vt(Z,!0),Ce=K(Ee);{var ie=ce=>{var be=pp();Q(ce,be)};Ae(Ce,ce=>{i()&&r()&&ce(ie)})}we(()=>de(Ee,e.msg.content)),Q(W,Z)};Ae($,W=>{i()&&r()&&!e.msg.content&&s()!=="thinking"?W(J):W(ve,!1)})}Q(b,_)},k=b=>{var _=gp(),q=M(_);we(()=>de(q,e.msg.content)),Q(b,_)};Ae(h,b=>{e.msg.role==="assistant"?b(y):b(k,!1)})}we(()=>{Gr(f,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),de(v,e.msg.role==="user"?"You":"AI")}),Q(t,f),At()}var bp=te('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),_p=te('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),wp=te('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),kp=te('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),xp=te('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Sp=te('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Tp=te('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Ep(t,e){Et(e,!0),Rt(()=>Qt("GpuPanel"));var r=Tp(),i=M(r),s=K(M(i),2),l=K(M(s),2),f=M(l),d=K(s,2),v=K(M(d),2),h=M(v),y=K(d,2);{var k=$=>{var J=bp(),ve=K(M(J),2),W=M(ve);we(()=>de(W,e.gpuInfo.device)),Q($,J)};Ae(y,$=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&$(k)})}var b=K(y,2);{var _=$=>{var J=_p(),ve=K(M(J),2),W=M(ve);we(Z=>de(W,Z),[()=>no(e.gpuInfo.limits.maxBufferSize)]),Q($,J)};Ae(b,$=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxBufferSize&&$(_)})}var q=K(b,2);{var j=$=>{var J=wp(),ve=K(M(J),2),W=M(ve);we(()=>de(W,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),Q($,J)};Ae(q,$=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeInvocationsPerWorkgroup&&$(j)})}var P=K(q,2);{var F=$=>{var J=kp(),ve=K(M(J),2),W=M(ve);we(Z=>de(W,Z),[()=>no(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),Q($,J)};Ae(P,$=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeWorkgroupStorageSize&&$(F)})}var re=K(P,2);{var ne=$=>{var J=Sp(),ve=M(J),W=M(ve),Z=K(ve,2);Sa(Z,21,()=>e.gpuInfo.features,xa,(Ee,Ce)=>{var ie=xp(),ce=M(ie);we(()=>de(ce,R(Ce))),Q(Ee,ie)}),we(()=>de(W,`Features (${e.gpuInfo.features.length??""})`)),Q($,J)};Ae(re,$=>{var J;(J=e.gpuInfo.features)!=null&&J.length&&$(ne)})}we(()=>{de(f,e.gpuInfo.vendor),de(h,e.gpuInfo.architecture)}),Q(t,r),At()}var Ap=te('<button class="gpu-badge svelte-1ktw27c"> </button>'),Ip=te('<span class="stats svelte-1ktw27c"> </span>'),Cp=te('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Pp=te('<span class="stats preparing svelte-1ktw27c"> </span>'),Rp=te('<span class="stats svelte-1ktw27c"> </span>'),Op=te('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Dp=te('<button class="btn svelte-1ktw27c">Stop</button>'),Mp=te('<button class="btn primary svelte-1ktw27c">Send</button>'),Lp=te('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Np(t,e){Et(e,!0),Rt(()=>Qt("ChatView"));let r=Ne(e,"messages",19,()=>[]),i=Ne(e,"isRunning",3,!1),s=Ne(e,"tps",3,null),l=Ne(e,"numTokens",3,null),f=Ne(e,"generationPhase",3,null),d=Ne(e,"gpuInfo",3,null),v=Ne(e,"chatContainer",15),h=Re(""),y=Re(!1);function k(B){B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),b())}function b(){const B=R(h).trim();!B||i()||(G(h,""),e.onsend(B))}var _=Lp(),q=M(_),j=M(q);{var P=B=>{var H=Ap();H.__click=()=>G(y,!R(y));var ue=M(H);we(()=>de(ue,`WebGPU ${R(y)?"â²":"â¼"}`)),Q(B,H)};Ae(j,B=>{d()&&B(P)})}var F=K(j,2);{var re=B=>{var H=Ip(),ue=M(H);we((pe,Oe)=>de(ue,`${l()??""} tokens in ${pe??""}s
        (${Oe??""} tok/s)`),[()=>(l()/s()).toFixed(1),()=>s().toFixed(1)]),Q(B,H)},ne=B=>{var H=Cp();Q(B,H)},$=B=>{var H=Pp(),ue=M(H);we(pe=>de(ue,`thinking... ${pe??""}`),[()=>s()?`${s().toFixed(0)} tok/s`:""]),Q(B,H)},J=B=>{var H=Rp(),ue=M(H);we(pe=>de(ue,`${pe??""} tok/s`),[()=>s().toFixed(1)]),Q(B,H)};Ae(F,B=>{s()&&!i()?B(re):i()&&f()==="preparing"?B(ne,1):i()&&f()==="thinking"?B($,2):s()&&i()&&B(J,3)})}var ve=K(F,4);ve.__click=function(...B){var H;(H=e.onreset)==null||H.apply(this,B)};var W=K(q,2);{var Z=B=>{Ep(B,{get gpuInfo(){return d()}})};Ae(W,B=>{R(y)&&d()&&B(Z)})}var Ee=K(W,2),Ce=M(Ee);{var ie=B=>{var H=Op();Q(B,H)};Ae(Ce,B=>{r().length===0&&B(ie)})}var ce=K(Ce,2);Sa(ce,17,r,xa,(B,H,ue)=>{{let pe=gr(()=>ue===r().length-1);yp(B,{get msg(){return R(H)},get isLast(){return R(pe)},get isRunning(){return i()},get generationPhase(){return f()},get numTokens(){return l()}})}}),Vu(Ee,B=>v(B),()=>v());var be=K(Ee,2),Me=M(be);Me.__keydown=k;var xe=K(Me,2);{var Se=B=>{var H=Dp();H.__click=function(...ue){var pe;(pe=e.onstop)==null||pe.apply(this,ue)},Q(B,H)},Pe=B=>{var H=Mp();H.__click=b,we(ue=>H.disabled=ue,[()=>!R(h).trim()]),Q(B,H)};Ae(xe,B=>{i()?B(Se):B(Pe,!1)})}we(()=>{ve.disabled=i(),Me.disabled=i()}),So(Me,()=>R(h),B=>G(h,B)),Q(t,_),At()}qn(["click","keydown"]);var qp=te('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function jp(t,e){Et(e,!0);const r=!!navigator.gpu;let i=Re(null),s=Re($t(localStorage.getItem("selectedModel")||eo[0].id)),l=Re(null),f=Re(null),d=Re(""),v=Re($t([])),h=Re($t([])),y=Re(!1),k=Re(null),b=Re(null),_=Re(null),q=Re(null),j=Re(null);Rt(()=>(G(i,new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),!0),R(i).postMessage({type:"check"}),R(i).addEventListener("message",ie=>{const ce=ie.data;switch(ce.status){case"webgpu-info":G(q,ce.data,!0);break;case"loading":G(l,"loading"),G(d,ce.data,!0);break;case"initiate":G(v,[...R(v),ce],!0);break;case"progress":G(v,R(v).map(be=>be.file===ce.file?{...be,...ce}:be),!0);break;case"done":G(v,R(v).filter(be=>be.file!==ce.file),!0);break;case"ready":G(l,"ready");break;case"start":G(j,ce.phase||"preparing",!0),G(h,[...R(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":G(j,ce.phase,!0);break;case"thinking":{G(k,ce.tps,!0),G(b,ce.numTokens,!0);const be=R(h)[R(h).length-1];G(h,[...R(h).slice(0,-1),{...be,thinking:(be.thinking||"")+ce.content}],!0),P();break}case"thinking-done":{G(k,ce.tps,!0),G(b,ce.numTokens,!0);const be=R(h)[R(h).length-1];G(h,[...R(h).slice(0,-1),{...be,thinking:ce.content}],!0);break}case"update":{G(k,ce.tps,!0),G(b,ce.numTokens,!0);const be=R(h)[R(h).length-1];G(h,[...R(h).slice(0,-1),{...be,content:be.content+ce.output}],!0),P();break}case"complete":G(y,!1),G(j,null);break;case"error":G(f,ce.data,!0),G(y,!1),G(j,null);break}}),()=>{var ie;return(ie=R(i))==null?void 0:ie.terminate()}));function P(){zu().then(()=>{R(_)&&(R(_).scrollTop=R(_).scrollHeight)})}function F(){G(l,"loading"),localStorage.setItem("selectedModel",R(s)),R(i).postMessage({type:"load",modelId:R(s)})}async function re(ie){if(!ie||R(y))return;G(h,[...R(h),{role:"user",content:ie}],!0),G(k,null),G(y,!0);let ce=[];try{const Me=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail)\b/i;let xe;Me.test(ie)?xe=await qd(ie):xe=await Nd(),xe&&(ce=[{role:"system",content:xe}])}catch{}const be=R(h).map(Me=>({role:Me.role,content:Me.content}));R(i).postMessage({type:"generate",data:[...ce,...be]}),P()}function ne(){R(i).postMessage({type:"interrupt"})}function $(){R(i).postMessage({type:"reset"}),G(h,[],!0),G(k,null),G(b,null)}var J=Hu(),ve=Vt(J);{var W=ie=>{var ce=qp();Q(ie,ce)},Z=ie=>{Jd(ie,{get gpuInfo(){return R(q)},get error(){return R(f)},onload:F,get selectedModel(){return R(s)},set selectedModel(ce){G(s,ce,!0)}})},Ee=ie=>{op(ie,{get message(){return R(d)},get items(){return R(v)}})},Ce=ie=>{Np(ie,{get messages(){return R(h)},get isRunning(){return R(y)},get tps(){return R(k)},get numTokens(){return R(b)},get generationPhase(){return R(j)},get gpuInfo(){return R(q)},onsend:re,onstop:ne,onreset:$,get chatContainer(){return R(_)},set chatContainer(ce){G(_,ce,!0)}})};Ae(ve,ie=>{r?R(l)===null?ie(Z,1):R(l)==="loading"?ie(Ee,2):ie(Ce,!1):ie(W)})}Q(t,J),At()}const Cl="https://accounts.google.com/gsi/client",Bp="https://www.googleapis.com/auth/gmail.readonly";let ro=null,Ki=null;function zp(){return new Promise((t,e)=>{var s,l;if((l=(s=window.google)==null?void 0:s.accounts)!=null&&l.oauth2){t();return}const r=document.querySelector(`script[src="${Cl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const i=document.createElement("script");i.src=Cl,i.async=!0,i.defer=!0,i.onload=()=>t(),i.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(i)})}async function Pl(t){await zp(),ro=google.accounts.oauth2.initTokenClient({client_id:t,scope:Bp,callback:e=>{Ki&&(Ki(e),Ki=null)}})}function Fp(){return new Promise((t,e)=>{if(!ro){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Ki=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},ro.requestAccessToken()})}function Kp(t){return new Promise(e=>{var r,i;(i=(r=window.google)==null?void 0:r.accounts)!=null&&i.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Up="https://gmail.googleapis.com/gmail/v1/users/me";function Gp(t){return{Authorization:`Bearer ${t}`}}async function rs(t,e){var i;const r=await fetch(`${Up}${e}`,{headers:Gp(t)});if(!r.ok){const s=await r.json().catch(()=>({}));throw new Error(((i=s.error)==null?void 0:i.message)||`Gmail API error: ${r.status}`)}return r.json()}function Ju(t){return rs(t,"/profile")}function ec(t,{maxResults:e=20,pageToken:r,q:i}={}){const s=new URLSearchParams;return s.set("maxResults",String(e)),r&&s.set("pageToken",r),i&&s.set("q",i),rs(t,`/messages?${s}`)}function tc(t,e,r="full"){return rs(t,`/messages/${e}?format=${r}`)}function Hp(t,{startHistoryId:e,pageToken:r,maxResults:i=500}={}){const s=new URLSearchParams;return s.set("startHistoryId",e),s.set("maxResults",String(i)),s.append("historyTypes","messageAdded"),s.append("historyTypes","messageDeleted"),r&&s.set("pageToken",r),rs(t,`/history?${s}`)}function cr(t,e){var l;const r=((l=t==null?void 0:t.payload)==null?void 0:l.headers)||[],i=e.toLowerCase(),s=r.find(f=>f.name.toLowerCase()===i);return(s==null?void 0:s.value)||""}function ei(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const i=atob(e),s=Uint8Array.from(i,l=>l.charCodeAt(0));return new TextDecoder().decode(s)}function Wp(t){var l,f,d;const e=t==null?void 0:t.payload;if(!e)return"";if((l=e.body)!=null&&l.data)return ei(e.body.data);const r=e.parts||[],i=$i(r,"text/plain");if((f=i==null?void 0:i.body)!=null&&f.data)return ei(i.body.data);const s=$i(r,"text/html");if((d=s==null?void 0:s.body)!=null&&d.data){const v=ei(s.body.data);return Yp(v)}return"(no body)"}function $p(t){var s,l;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((s=e.body)!=null&&s.data))return ei(e.body.data);const r=e.parts||[],i=$i(r,"text/html");return(l=i==null?void 0:i.body)!=null&&l.data?ei(i.body.data):null}function $i(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const i=$i(r.parts,e);if(i)return i}}return null}function Yp(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}const xt="gmail",Rl=8,nc=50,rc=100;async function Vp(t,{limit:e=nc,onProgress:r=()=>{},signal:i}={}){var f,d,v,h;const s=await Fe.syncState.get(xt);if(s!=null&&s.historyId)try{return await th(t,s,r,i)}catch(y){if((f=y.message)!=null&&f.includes("404")||(d=y.message)!=null&&d.includes("notFound")||(v=y.message)!=null&&v.includes("Start history id")||(h=y.message)!=null&&h.includes("history_types"))r({phase:"info",message:"History expired, performing full re-sync..."}),await Fe.syncState.delete(xt);else throw y}return await Jp(t,e===0?1/0:e,r,i)}async function Xp(t,{limit:e=nc,onProgress:r=()=>{},signal:i}={}){const s=await Fe.syncState.get(xt);return s!=null&&s.oldestPageToken?await eh(t,s,e===0?1/0:e,r,i):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Qp(){const t=await Fe.syncState.get(xt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Zp(){await Fe.transaction("rw",[Fe.items,Fe.syncState],async()=>{await Fe.items.where("sourceType").equals(xt).delete(),await Fe.syncState.delete(xt)})}async function Jp(t,e,r,i){r({phase:"counting",message:"Getting mailbox info..."}),Yr(i);const s=await Ju(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(s.messagesTotal||e,e)});const l=[];let f,d=null;for(;l.length<e;){Yr(i);const k=e-l.length,b=await ec(t,{maxResults:Math.min(rc,k),pageToken:f}),_=(b.messages||[]).map(q=>q.id);if(l.push(..._),r({phase:"listing",message:`Listed ${l.length} messages...`,current:l.length,total:Math.min(s.messagesTotal||e,e)}),f=b.nextPageToken,!f||_.length===0)break}if(d=f||null,l.length===0)return await Fe.syncState.put({sourceType:xt,historyId:s.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await ac(t,l,r,i),y=await Fe.items.where("sourceType").equals(xt).count();return await Fe.syncState.put({sourceType:xt,historyId:s.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function eh(t,e,r,i,s){i({phase:"listing",message:"Loading more messages...",current:0}),Yr(s);const l=[];let f=e.oldestPageToken,d=null;for(;l.length<r;){Yr(s);const k=r-l.length,b=await ec(t,{maxResults:Math.min(rc,k),pageToken:f}),_=(b.messages||[]).map(q=>q.id);if(l.push(..._),i({phase:"listing",message:`Listed ${l.length} more messages...`,current:l.length}),f=b.nextPageToken,!f||_.length===0)break}if(d=f||null,l.length===0)return await Fe.syncState.update(xt,{oldestPageToken:null,lastSyncAt:Date.now()}),i({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await ac(t,l,i,s),y=await Fe.items.where("sourceType").equals(xt).count();return await Fe.syncState.update(xt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),i({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:h}}async function th(t,e,r,i){r({phase:"syncing",message:"Checking for changes..."}),Yr(i);let s=0,l=0,f=0,d,v=e.historyId;do{Yr(i);const y=await Hp(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const k of y.history){if(k.messagesAdded){const b=k.messagesAdded.map(q=>q.message.id),_=[...new Set(b.filter(q=>q))];if(_.length>0){const q=await Promise.allSettled(_.map(P=>tc(t,P))),j=[];for(const P of q)P.status==="fulfilled"?j.push(ic(P.value)):f++;j.length>0&&(await Fe.items.bulkPut(j),await sc(j),s+=j.length)}}if(k.messagesDeleted){const b=k.messagesDeleted.map(_=>Xu(xt,_.message.id)).filter(_=>_);b.length>0&&(await Fe.items.bulkDelete(b),l+=b.length)}}r({phase:"syncing",message:`Changes: +${s} -${l}`,current:s+l})}}while(d);const h=await Fe.items.where("sourceType").equals(xt).count();return await Fe.syncState.put({sourceType:xt,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:s===0&&l===0?"Already up to date":`Synced: +${s} -${l}`,current:h,total:h}),{added:s,deleted:l,errors:f}}async function ac(t,e,r,i){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let s=0,l=0;for(let f=0;f<e.length;f+=Rl){Yr(i);const d=e.slice(f,f+Rl),v=await Promise.allSettled(d.map(y=>tc(t,y))),h=[];for(const y of v)y.status==="fulfilled"?h.push(ic(y.value)):l++;h.length>0&&(await Fe.items.bulkPut(h),await sc(h)),s+=h.length,r({phase:"downloading",message:`Downloaded ${s} of ${e.length} messages`,current:s,total:e.length})}return{added:s,errors:l}}function ic(t){const e=cr(t,"From"),r=cr(t,"To"),i=cr(t,"Cc"),s=cr(t,"Subject")||"(no subject)",l=cr(t,"Date"),f=cr(t,"Message-ID"),d=cr(t,"In-Reply-To"),v=cr(t,"References");let h;try{h=l?new Date(l).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:Xu(xt,t.id),sourceType:xt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:i,subject:s,snippet:t.snippet||"",body:Wp(t),htmlBody:$p(t),date:h,labels:t.labelIds||[],messageId:f,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function sc(t){const e=new Map;for(const r of t)for(const i of[r.from,r.to,r.cc]){if(!i)continue;const s=i.split(",").map(l=>l.trim()).filter(Boolean);for(const l of s){const f=nh(l);f&&!e.has(f.email)&&e.set(f.email,{...f,date:r.date})}}for(const[r,{name:i,date:s}]of e)try{const l=await Fe.contacts.where("email").equals(r).first();if(l){const f={};i&&!l.name&&(f.name=i),s>(l.lastSeen||0)&&(f.lastSeen=s),Object.keys(f).length>0&&await Fe.contacts.update(l.id,f)}else await Fe.contacts.add({email:r,name:i||"",firstSeen:s,lastSeen:s})}catch{}}function nh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const i=e[1].toLowerCase().trim(),s=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:i,name:s}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function Yr(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var rh=te(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function ah(t,e){Et(e,!0);let r=Ne(e,"clientIdInput",15);Rt(()=>Qt("SetupGuide"));let i=Re(null);async function s(De){try{await navigator.clipboard.writeText(De),G(i,De,!0),setTimeout(()=>{G(i,null)},1500)}catch{const ge=document.createElement("input");ge.value=De,document.body.appendChild(ge),ge.select(),document.execCommand("copy"),document.body.removeChild(ge),G(i,De,!0),setTimeout(()=>{G(i,null)},1500)}}const l="http://localhost:5173",f="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=rh(),h=M(v),y=K(M(h),4),k=K(M(y),6),b=K(M(k),2),_=K(M(b),2),q=K(M(_),2),j=M(q);j.__click=()=>s(l);var P=M(j);P.textContent="http://localhost:5173";var F=K(P,2),re=M(F),ne=K(j,2);ne.__click=()=>s(f);var $=M(ne);$.textContent="https://cypherkitty.github.io";var J=K($,2),ve=M(J),W=K(_,2),Z=K(M(W),2),Ee=M(Z);Ee.__click=()=>s(l);var Ce=M(Ee);Ce.textContent="http://localhost:5173";var ie=K(Ce,2),ce=M(ie),be=K(Ee,2);be.__click=()=>s(f);var Me=M(be);Me.textContent="https://cypherkitty.github.io";var xe=K(Me,2),Se=M(xe),Pe=K(be,2);Pe.__click=()=>s(d);var B=M(Pe);B.textContent="https://cypherkitty.github.io/me-ai/";var H=K(B,2),ue=M(H),pe=K(y,2),Oe=M(pe);Oe.__keydown=De=>De.key==="Enter"&&e.onsave();var qe=K(Oe,2);qe.__click=function(...De){var ge;(ge=e.onsave)==null||ge.apply(this,De)},we(De=>{de(re,R(i)===l?"â":"â§"),de(ve,R(i)===f?"â":"â§"),de(ce,R(i)===l?"â":"â§"),de(Se,R(i)===f?"â":"â§"),de(ue,R(i)===d?"â":"â§"),qe.disabled=De},[()=>!r().trim()]),So(Oe,r),Q(t,v),At()}qn(["click","keydown"]);function ih(t){const e=t||"";if(e.includes("has not been used in project")||e.includes("is disabled")){const r=e.match(/project\s+(\d+)/),i=r==null?void 0:r[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:i?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${i}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return e.includes("Invalid Credentials")||e.includes("401")||e.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:e.includes("insufficient")&&e.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:e.includes("access_denied")||e.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:e.includes("popup")||e.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:e.includes("Rate Limit")||e.includes("429")||e.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:e,fix:null}}var sh=te('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),oh=te('<div class="error-card-title svelte-14buhqq"> </div>'),lh=te('<p class="error-card-fix svelte-14buhqq"> </p>'),uh=te('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),ch=te('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),fh=te('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function oc(t,e){Et(e,!0);let r=Ne(e,"ondismiss",3,null),i=Ne(e,"onsignout",3,null),s=gr(()=>ih(e.error));Rt(()=>Qt("ErrorCard"));var l=fh(),f=M(l);{var d=F=>{var re=sh(),ne=M(re),$=M(ne),J=K(ne,2);J.__click=function(...ve){var W;(W=r())==null||W.apply(this,ve)},we(()=>de($,R(s).title)),Q(F,re)},v=F=>{var re=oh(),ne=M(re);we(()=>de(ne,R(s).title)),Q(F,re)};Ae(f,F=>{r()?F(d):F(v,!1)})}var h=K(f,2),y=M(h),k=K(h,2);{var b=F=>{var re=lh(),ne=M(re);we(()=>de(ne,R(s).fix)),Q(F,re)};Ae(k,F=>{R(s).fix&&F(b)})}var _=K(k,2);{var q=F=>{var re=uh(),ne=M(re);we(()=>{Yu(re,"href",R(s).link.url),de(ne,`${R(s).link.label??""} â`)}),Q(F,re)};Ae(_,F=>{R(s).link&&F(q)})}var j=K(_,2);{var P=F=>{var re=ch();re.__click=function(...ne){var $;($=i())==null||$.apply(this,ne)},Q(F,re)};Ae(j,F=>{R(s).action==="signout"&&i()&&F(P)})}we(()=>de(y,R(s).description)),Q(t,l),At()}qn(["click"]);var dh=te('<span class="spinner svelte-nyqevv"></span> Signing in...',1),ph=Gu('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),hh=te(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function vh(t,e){Et(e,!0);let r=Ne(e,"error",3,null),i=Ne(e,"loadingAuth",3,!1);Rt(()=>Qt("AuthCard"));var s=hh(),l=M(s),f=K(M(l),4);{var d=P=>{oc(P,{get error(){return r()},get onsignout(){return e.onsignout}})};Ae(f,P=>{r()&&P(d)})}var v=K(f,2);v.__click=function(...P){var F;(F=e.onsignin)==null||F.apply(this,P)};var h=M(v);{var y=P=>{var F=dh();Q(P,F)},k=P=>{var F=ph();Q(P,F)};Ae(h,P=>{i()?P(y):P(k,!1)})}var b=K(v,2),_=K(M(b),2),q=M(_),j=K(_,2);j.__click=function(...P){var F;(F=e.onclear)==null||F.apply(this,P)},we(P=>{v.disabled=i(),de(q,`${P??""}...`)},[()=>e.clientId.slice(0,20)]),Q(t,s),At()}qn(["click"]);function To(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function lc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function uc(t){return lc(t).charAt(0).toUpperCase()}var gh=te('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),mh=te('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),yh=te('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function bh(t,e){Et(e,!0);let r=Ne(e,"profile",3,null),i=Ne(e,"loadingProfile",3,!1);Rt(()=>Qt("ProfileCard"));var s=yh(),l=M(s),f=M(l),d=K(l,2),v=M(d);{var h=b=>{var _=gh();Q(b,_)},y=b=>{var _=mh(),q=Vt(_),j=M(q),P=K(q,2),F=M(P);we((re,ne)=>{de(j,r().emailAddress),de(F,`${re??""} messages
        Â· ${ne??""} threads`)},[()=>{var re;return((re=r().messagesTotal)==null?void 0:re.toLocaleString())||"?"},()=>{var re;return((re=r().threadsTotal)==null?void 0:re.toLocaleString())||"?"}]),Q(b,_)};Ae(v,b=>{i()?b(h):r()&&b(y,1)})}var k=K(d,2);k.__click=function(...b){var _;(_=e.onsignout)==null||_.apply(this,b)},we(b=>de(f,b),[()=>r()?uc(r().emailAddress):"?"]),Q(t,s),At()}qn(["click"]);var _h=te('<span class="spinner svelte-1ds3j4k"></span>'),wh=Gu('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),kh=te('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),xh=te('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Sh=te('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Th=te('<option class="svelte-1ds3j4k"> </option>'),Eh=te('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Ah=te('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Ih=te('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Ch=te('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Ph=te('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Rh=te('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Oh(t,e){Et(e,!0),Rt(()=>Qt("SyncStatus"));let r=Ne(e,"syncStatus",3,null),i=Ne(e,"syncProgress",3,null),s=Ne(e,"isSyncing",3,!1),l=Re(!1),f=Re(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(B){if(!B)return"never";const H=Math.floor((Date.now()-B)/1e3);if(H<60)return"just now";const ue=Math.floor(H/60);if(ue<60)return`${ue}m ago`;const pe=Math.floor(ue/60);return pe<24?`${pe}h ago`:`${Math.floor(pe/24)}d ago`}function h(){var B,H;return!((B=i())!=null&&B.total)||!((H=i())!=null&&H.current)?0:Math.round(i().current/i().total*100)}var y=Rh(),k=M(y),b=M(k),_=M(b);{var q=B=>{var H=_h();Q(B,H)},j=B=>{var H=wh();Q(B,H)};Ae(_,B=>{s()?B(q):B(j,!1)})}var P=K(b,2),F=K(M(P),2);{var re=B=>{var H=kh(),ue=M(H),pe=K(ue);{var Oe=De=>{var ge=_l("Â· more available");Q(De,ge)},qe=De=>{var ge=_l("Â· all synced");Q(De,ge)};Ae(pe,De=>{r().hasMore?De(Oe):De(qe,!1)})}we((De,ge)=>de(ue,`${De??""} emails stored
          Â· synced ${ge??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),Q(B,H)},ne=B=>{var H=xh();Q(B,H)};Ae(F,B=>{var H;(H=r())!=null&&H.synced?B(re):B(ne,!1)})}var $=K(P,2),J=M($);{var ve=B=>{var H=Sh();H.__click=()=>G(l,!R(l)),Q(B,H)};Ae(J,B=>{var H;(H=r())!=null&&H.synced&&!s()&&B(ve)})}var W=K(k,2),Z=M(W),Ee=K(M(Z),2);Sa(Ee,21,()=>d,xa,(B,H)=>{var ue=Th(),pe=M(ue),Oe={};we(()=>{de(pe,R(H).label),Oe!==(Oe=R(H).value)&&(ue.value=(ue.__value=R(H).value)??"")}),Q(B,ue)});var Ce=K(Z,2),ie=M(Ce);{var ce=B=>{var H=Ah(),ue=Vt(H);ue.__click=()=>e.onsync(R(f));var pe=M(ue),Oe=K(ue,2);{var qe=De=>{var ge=Eh();ge.__click=()=>e.onsyncmore(R(f));var et=M(ge);we(()=>{ge.disabled=s(),de(et,s()?"Loading...":"Sync More")}),Q(De,ge)};Ae(Oe,De=>{r().hasMore&&De(qe)})}we(()=>{ue.disabled=s(),de(pe,s()?"Syncing...":"Sync New")}),Q(B,H)},be=B=>{var H=Ih();H.__click=()=>e.onsync(R(f));var ue=M(H);we(()=>{H.disabled=s(),de(ue,s()?"Syncing...":"Download Emails")}),Q(B,H)};Ae(ie,B=>{var H;(H=r())!=null&&H.synced?B(ce):B(be,!1)})}var Me=K(W,2);{var xe=B=>{var H=Ch(),ue=M(H),pe=M(ue);let Oe,qe;var De=K(ue,2),ge=M(De);we(et=>{Oe=Gr(pe,1,"progress-fill svelte-1ds3j4k",null,Oe,{indeterminate:!i().total}),qe=Wi(pe,"",qe,et),de(ge,i().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),Q(B,H)};Ae(Me,B=>{s()&&i()&&B(xe)})}var Se=K(Me,2);{var Pe=B=>{var H=Ph(),ue=K(M(H),2),pe=M(ue);pe.__click=()=>G(l,!1);var Oe=K(pe,2);Oe.__click=()=>{e.onclear(),G(l,!1)},Q(B,H)};Ae(Se,B=>{R(l)&&B(Pe)})}we(()=>Ee.disabled=s()),$u(Ee,()=>R(f),B=>G(f,B)),Q(t,y),At()}qn(["click"]);var Dh=te('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Mh=te('<div class="message-list svelte-y2uamw"></div>');function Lh(t,e){Et(e,!0);let r=Ne(e,"messages",19,()=>[]);Rt(()=>Qt("MessageList"));var i=Mh();Sa(i,21,r,xa,(s,l)=>{var f=Dh();f.__click=()=>e.onselect(R(l));var d=M(f),v=M(d),h=K(d,2),y=M(h),k=M(y),b=M(k),_=K(k,2),q=M(_),j=K(y,2),P=M(j),F=K(j,2),re=M(F);we((ne,$,J)=>{de(v,ne),de(b,$),de(q,J),de(P,R(l).subject),de(re,R(l).snippet)},[()=>uc(R(l).from),()=>lc(R(l).from),()=>To(R(l).date)]),Q(s,f)}),Q(t,i),At()}qn(["click"]);function Eo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Qr=Eo();function cc(t){Qr=t}var Rr={exec:()=>null};function $e(t,e=""){let r=typeof t=="string"?t:t.source,i={replace:(s,l)=>{let f=typeof l=="string"?l:l.source;return f=f.replace(Mt.caret,"$1"),r=r.replace(s,f),i},getRegex:()=>new RegExp(r,e)};return i}var Nh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Mt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},qh=/^(?:[ \t]*(?:\n|$))+/,jh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Bh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,fi=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,zh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ao=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,fc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,dc=$e(fc).replace(/bull/g,Ao).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Fh=$e(fc).replace(/bull/g,Ao).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Io=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Kh=/^[^\n]+/,Co=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Uh=$e(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Co).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Gh=$e(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ao).getRegex(),as="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Po=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Hh=$e("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Po).replace("tag",as).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),pc=$e(Io).replace("hr",fi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",as).getRegex(),Wh=$e(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",pc).getRegex(),Ro={blockquote:Wh,code:jh,def:Uh,fences:Bh,heading:zh,hr:fi,html:Hh,lheading:dc,list:Gh,newline:qh,paragraph:pc,table:Rr,text:Kh},Ol=$e("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",fi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",as).getRegex(),$h={...Ro,lheading:Fh,table:Ol,paragraph:$e(Io).replace("hr",fi).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ol).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",as).getRegex()},Yh={...Ro,html:$e(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Po).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Rr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:$e(Io).replace("hr",fi).replace("heading",` *#{1,6} *[^
]`).replace("lheading",dc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Vh=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Xh=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,hc=/^( {2,}|\\)\n(?!\s*$)/,Qh=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,is=/[\p{P}\p{S}]/u,Oo=/[\s\p{P}\p{S}]/u,vc=/[^\s\p{P}\p{S}]/u,Zh=$e(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Oo).getRegex(),gc=/(?!~)[\p{P}\p{S}]/u,Jh=/(?!~)[\s\p{P}\p{S}]/u,ev=/(?:[^\s\p{P}\p{S}]|~)/u,mc=/(?![*_])[\p{P}\p{S}]/u,tv=/(?![*_])[\s\p{P}\p{S}]/u,nv=/(?:[^\s\p{P}\p{S}]|[*_])/u,rv=$e(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Nh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),yc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,av=$e(yc,"u").replace(/punct/g,is).getRegex(),iv=$e(yc,"u").replace(/punct/g,gc).getRegex(),bc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",sv=$e(bc,"gu").replace(/notPunctSpace/g,vc).replace(/punctSpace/g,Oo).replace(/punct/g,is).getRegex(),ov=$e(bc,"gu").replace(/notPunctSpace/g,ev).replace(/punctSpace/g,Jh).replace(/punct/g,gc).getRegex(),lv=$e("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,vc).replace(/punctSpace/g,Oo).replace(/punct/g,is).getRegex(),uv=$e(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,mc).getRegex(),cv="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",fv=$e(cv,"gu").replace(/notPunctSpace/g,nv).replace(/punctSpace/g,tv).replace(/punct/g,mc).getRegex(),dv=$e(/\\(punct)/,"gu").replace(/punct/g,is).getRegex(),pv=$e(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),hv=$e(Po).replace("(?:-->|$)","-->").getRegex(),vv=$e("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",hv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Yi=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,gv=$e(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Yi).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),_c=$e(/^!?\[(label)\]\[(ref)\]/).replace("label",Yi).replace("ref",Co).getRegex(),wc=$e(/^!?\[(ref)\](?:\[\])?/).replace("ref",Co).getRegex(),mv=$e("reflink|nolink(?!\\()","g").replace("reflink",_c).replace("nolink",wc).getRegex(),Dl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Do={_backpedal:Rr,anyPunctuation:dv,autolink:pv,blockSkip:rv,br:hc,code:Xh,del:Rr,delLDelim:Rr,delRDelim:Rr,emStrongLDelim:av,emStrongRDelimAst:sv,emStrongRDelimUnd:lv,escape:Vh,link:gv,nolink:wc,punctuation:Zh,reflink:_c,reflinkSearch:mv,tag:vv,text:Qh,url:Rr},yv={...Do,link:$e(/^!?\[(label)\]\((.*?)\)/).replace("label",Yi).getRegex(),reflink:$e(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Yi).getRegex()},ao={...Do,emStrongRDelimAst:ov,emStrongLDelim:iv,delLDelim:uv,delRDelim:fv,url:$e(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Dl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:$e(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Dl).getRegex()},bv={...ao,br:$e(hc).replace("{2,}","*").getRegex(),text:$e(ao.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Mi={normal:Ro,gfm:$h,pedantic:Yh},Ka={normal:Do,gfm:ao,breaks:bv,pedantic:yv},_v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ml=t=>_v[t];function Un(t,e){if(e){if(Mt.escapeTest.test(t))return t.replace(Mt.escapeReplace,Ml)}else if(Mt.escapeTestNoEncode.test(t))return t.replace(Mt.escapeReplaceNoEncode,Ml);return t}function Ll(t){try{t=encodeURI(t).replace(Mt.percentDecode,"%")}catch{return null}return t}function Nl(t,e){var l;let r=t.replace(Mt.findPipe,(f,d,v)=>{let h=!1,y=d;for(;--y>=0&&v[y]==="\\";)h=!h;return h?"|":" |"}),i=r.split(Mt.splitPipe),s=0;if(i[0].trim()||i.shift(),i.length>0&&!((l=i.at(-1))!=null&&l.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;s<i.length;s++)i[s]=i[s].trim().replace(Mt.slashPipe,"|");return i}function Ua(t,e,r){let i=t.length;if(i===0)return"";let s=0;for(;s<i&&t.charAt(i-s-1)===e;)s++;return t.slice(0,i-s)}function wv(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let i=0;i<t.length;i++)if(t[i]==="\\")i++;else if(t[i]===e[0])r++;else if(t[i]===e[1]&&(r--,r<0))return i;return r>0?-2:-1}function kv(t,e=0){let r=e,i="";for(let s of t)if(s==="	"){let l=4-r%4;i+=" ".repeat(l),r+=l}else i+=s,r++;return i}function ql(t,e,r,i,s){let l=e.href,f=e.title||null,d=t[1].replace(s.other.outputLinkReplace,"$1");i.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:l,title:f,text:d,tokens:i.inlineTokens(d)};return i.state.inLink=!1,v}function xv(t,e,r){let i=t.match(r.other.indentCodeCompensation);if(i===null)return e;let s=i[1];return e.split(`
`).map(l=>{let f=l.match(r.other.beginningSpace);if(f===null)return l;let[d]=f;return d.length>=s.length?l.slice(s.length):l}).join(`
`)}var Vi=class{constructor(t){Ke(this,"options");Ke(this,"rules");Ke(this,"lexer");this.options=t||Qr}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ua(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],i=xv(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let i=Ua(r,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(r=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ua(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ua(e[0],`
`).split(`
`),i="",s="",l=[];for(;r.length>0;){let f=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),f=!0;else if(!f)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),y=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${h}`:h,s=s?`${s}
${y}`:y;let k=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,l,!0),this.lexer.state.top=k,r.length===0)break;let b=l.at(-1);if((b==null?void 0:b.type)==="code")break;if((b==null?void 0:b.type)==="blockquote"){let _=b,q=_.raw+`
`+r.join(`
`),j=this.blockquote(q);l[l.length-1]=j,i=i.substring(0,i.length-_.raw.length)+j.raw,s=s.substring(0,s.length-_.text.length)+j.text;break}else if((b==null?void 0:b.type)==="list"){let _=b,q=_.raw+`
`+r.join(`
`),j=this.list(q);l[l.length-1]=j,i=i.substring(0,i.length-b.raw.length)+j.raw,s=s.substring(0,s.length-_.raw.length)+j.raw,r=q.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:l,text:s}}}list(t){var r,i;let e=this.rules.block.list.exec(t);if(e){let s=e[1].trim(),l=s.length>1,f={type:"list",raw:"",ordered:l,start:l?+s.slice(0,-1):"",loose:!1,items:[]};s=l?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=l?s:"[*+-]");let d=this.rules.other.listItemRegex(s),v=!1;for(;t;){let y=!1,k="",b="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;k=e[0],t=t.substring(k.length);let _=kv(e[2].split(`
`,1)[0],e[1].length),q=t.split(`
`,1)[0],j=!_.trim(),P=0;if(this.options.pedantic?(P=2,b=_.trimStart()):j?P=e[1].length+1:(P=_.search(this.rules.other.nonSpaceChar),P=P>4?1:P,b=_.slice(P),P+=e[1].length),j&&this.rules.other.blankLine.test(q)&&(k+=q+`
`,t=t.substring(q.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(P),re=this.rules.other.hrRegex(P),ne=this.rules.other.fencesBeginRegex(P),$=this.rules.other.headingBeginRegex(P),J=this.rules.other.htmlBeginRegex(P),ve=this.rules.other.blockquoteBeginRegex(P);for(;t;){let W=t.split(`
`,1)[0],Z;if(q=W,this.options.pedantic?(q=q.replace(this.rules.other.listReplaceNesting,"  "),Z=q):Z=q.replace(this.rules.other.tabCharGlobal,"    "),ne.test(q)||$.test(q)||J.test(q)||ve.test(q)||F.test(q)||re.test(q))break;if(Z.search(this.rules.other.nonSpaceChar)>=P||!q.trim())b+=`
`+Z.slice(P);else{if(j||_.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||ne.test(_)||$.test(_)||re.test(_))break;b+=`
`+q}j=!q.trim(),k+=W+`
`,t=t.substring(W.length+1),_=Z.slice(P)}}f.loose||(v?f.loose=!0:this.rules.other.doubleBlankLine.test(k)&&(v=!0)),f.items.push({type:"list_item",raw:k,task:!!this.options.gfm&&this.rules.other.listIsTask.test(b),loose:!1,text:b,tokens:[]}),f.raw+=k}let h=f.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;f.raw=f.raw.trimEnd();for(let y of f.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((i=y.tokens[0])==null?void 0:i.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let b=this.lexer.inlineQueue.length-1;b>=0;b--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[b].src)){this.lexer.inlineQueue[b].src=this.lexer.inlineQueue[b].src.replace(this.rules.other.listReplaceTask,"");break}}let k=this.rules.other.listTaskCheckbox.exec(y.raw);if(k){let b={type:"checkbox",raw:k[0]+" ",checked:k[0]!=="[ ]"};y.checked=b.checked,f.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=b.raw+y.tokens[0].raw,y.tokens[0].text=b.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(b)):y.tokens.unshift({type:"paragraph",raw:b.raw,text:b.raw,tokens:[b]}):y.tokens.unshift(b)}}if(!f.loose){let k=y.tokens.filter(_=>_.type==="space"),b=k.length>0&&k.some(_=>this.rules.other.anyLine.test(_.raw));f.loose=b}}if(f.loose)for(let y of f.items){y.loose=!0;for(let k of y.tokens)k.type==="text"&&(k.type="paragraph")}return f}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:i,title:s}}}table(t){var f;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Nl(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(f=e[3])!=null&&f.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===i.length){for(let d of i)this.rules.other.tableAlignRight.test(d)?l.align.push("right"):this.rules.other.tableAlignCenter.test(d)?l.align.push("center"):this.rules.other.tableAlignLeft.test(d)?l.align.push("left"):l.align.push(null);for(let d=0;d<r.length;d++)l.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:l.align[d]});for(let d of s)l.rows.push(Nl(d,l.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:l.align[h]})));return l}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let l=Ua(r.slice(0,-1),"\\");if((r.length-l.length)%2===0)return}else{let l=wv(e[2],"()");if(l===-2)return;if(l>-1){let f=(e[0].indexOf("!")===0?5:4)+e[1].length+l;e[2]=e[2].substring(0,l),e[0]=e[0].substring(0,f).trim(),e[3]=""}}let i=e[2],s="";if(this.options.pedantic){let l=this.rules.other.pedanticHrefTitle.exec(i);l&&(i=l[1],s=l[3])}else s=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?i=i.slice(1):i=i.slice(1,-1)),ql(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let i=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=e[i.toLowerCase()];if(!s){let l=r[0].charAt(0);return{type:"text",raw:l,text:l}}return ql(r,s,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!(!i||i[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(i[1]||i[2])||!r||this.rules.inline.punctuation.exec(r))){let s=[...i[0]].length-1,l,f,d=s,v=0,h=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+s);(i=h.exec(e))!=null;){if(l=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!l)continue;if(f=[...l].length,i[3]||i[4]){d+=f;continue}else if((i[5]||i[6])&&s%3&&!((s+f)%3)){v+=f;continue}if(d-=f,d>0)continue;f=Math.min(f,f+d+v);let y=[...i[0]][0].length,k=t.slice(0,s+i.index+y+f);if(Math.min(s,f)%2){let _=k.slice(1,-1);return{type:"em",raw:k,text:_,tokens:this.lexer.inlineTokens(_)}}let b=k.slice(2,-2);return{type:"strong",raw:k,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(r),s=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return i&&s&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let i=this.rules.inline.delLDelim.exec(t);if(i&&(!i[1]||!r||this.rules.inline.punctuation.exec(r))){let s=[...i[0]].length-1,l,f,d=s,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+s);(i=v.exec(e))!=null;){if(l=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!l||(f=[...l].length,f!==s))continue;if(i[3]||i[4]){d+=f;continue}if(d-=f,d>0)continue;f=Math.min(f,f+d);let h=[...i[0]][0].length,y=t.slice(0,s+i.index+h+f),k=y.slice(s,-s);return{type:"del",raw:y,text:k,tokens:this.lexer.inlineTokens(k)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,i;return e[2]==="@"?(r=e[1],i="mailto:"+r):(r=e[1],i=r),{type:"link",raw:e[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let i,s;if(e[2]==="@")i=e[0],s="mailto:"+i;else{let l;do l=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(l!==e[0]);i=e[0],e[1]==="www."?s="http://"+e[0]:s=e[0]}return{type:"link",raw:e[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},_n=class io{constructor(e){Ke(this,"tokens");Ke(this,"options");Ke(this,"state");Ke(this,"inlineQueue");Ke(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Qr,this.options.tokenizer=this.options.tokenizer||new Vi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Mt,block:Mi.normal,inline:Ka.normal};this.options.pedantic?(r.block=Mi.pedantic,r.inline=Ka.pedantic):this.options.gfm&&(r.block=Mi.gfm,this.options.breaks?r.inline=Ka.breaks:r.inline=Ka.gfm),this.tokenizer.rules=r}static get rules(){return{block:Mi,inline:Ka}}static lex(e,r){return new io(r).lex(e)}static lexInline(e,r){return new io(r).inlineTokens(e)}lex(e){e=e.replace(Mt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let i=this.inlineQueue[r];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],i=!1){var s,l,f;for(this.options.pedantic&&(e=e.replace(Mt.tabCharGlobal,"    ").replace(Mt.spaceLine,""));e;){let d;if((l=(s=this.options.extensions)==null?void 0:s.block)!=null&&l.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((f=this.options.extensions)!=null&&f.startBlock){let h=1/0,y=e.slice(1),k;this.options.extensions.startBlock.forEach(b=>{k=b.call({lexer:this},y),typeof k=="number"&&k>=0&&(h=Math.min(h,k))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);i&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),i=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,y,k,b;let i=e,s=null;if(this.tokens.links){let _=Object.keys(this.tokens.links);if(_.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)_.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,s.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let l;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)l=s[2]?s[2].length:0,i=i.slice(0,s.index+l)+"["+"a".repeat(s[0].length-l-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);i=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},i))??i;let f=!1,d="";for(;e;){f||(d=""),f=!1;let _;if((k=(y=this.options.extensions)==null?void 0:y.inline)!=null&&k.some(j=>(_=j.call({lexer:this},e,r))?(e=e.substring(_.raw.length),r.push(_),!0):!1))continue;if(_=this.tokenizer.escape(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.tag(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.link(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(_.raw.length);let j=r.at(-1);_.type==="text"&&(j==null?void 0:j.type)==="text"?(j.raw+=_.raw,j.text+=_.text):r.push(_);continue}if(_=this.tokenizer.emStrong(e,i,d)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.codespan(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.br(e)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.del(e,i,d)){e=e.substring(_.raw.length),r.push(_);continue}if(_=this.tokenizer.autolink(e)){e=e.substring(_.raw.length),r.push(_);continue}if(!this.state.inLink&&(_=this.tokenizer.url(e))){e=e.substring(_.raw.length),r.push(_);continue}let q=e;if((b=this.options.extensions)!=null&&b.startInline){let j=1/0,P=e.slice(1),F;this.options.extensions.startInline.forEach(re=>{F=re.call({lexer:this},P),typeof F=="number"&&F>=0&&(j=Math.min(j,F))}),j<1/0&&j>=0&&(q=e.substring(0,j+1))}if(_=this.tokenizer.inlineText(q)){e=e.substring(_.raw.length),_.raw.slice(-1)!=="_"&&(d=_.raw.slice(-1)),f=!0;let j=r.at(-1);(j==null?void 0:j.type)==="text"?(j.raw+=_.raw,j.text+=_.text):r.push(_);continue}if(e){let j="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(j);break}else throw new Error(j)}}return r}},Xi=class{constructor(t){Ke(this,"options");Ke(this,"parser");this.options=t||Qr}space(t){return""}code({text:t,lang:e,escaped:r}){var l;let i=(l=(e||"").match(Mt.notSpaceStart))==null?void 0:l[0],s=t.replace(Mt.endingNewline,"")+`
`;return i?'<pre><code class="language-'+Un(i)+'">'+(r?s:Un(s,!0))+`</code></pre>
`:"<pre><code>"+(r?s:Un(s,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,i="";for(let f=0;f<t.items.length;f++){let d=t.items[f];i+=this.listitem(d)}let s=e?"ol":"ul",l=e&&r!==1?' start="'+r+'"':"";return"<"+s+l+`>
`+i+"</"+s+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let s=0;s<t.header.length;s++)r+=this.tablecell(t.header[s]);e+=this.tablerow({text:r});let i="";for(let s=0;s<t.rows.length;s++){let l=t.rows[s];r="";for(let f=0;f<l.length;f++)r+=this.tablecell(l[f]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Un(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let i=this.parser.parseInline(r),s=Ll(t);if(s===null)return i;t=s;let l='<a href="'+t+'"';return e&&(l+=' title="'+Un(e)+'"'),l+=">"+i+"</a>",l}image({href:t,title:e,text:r,tokens:i}){i&&(r=this.parser.parseInline(i,this.parser.textRenderer));let s=Ll(t);if(s===null)return Un(r);t=s;let l=`<img src="${t}" alt="${r}"`;return e&&(l+=` title="${Un(e)}"`),l+=">",l}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Un(t.text)}},Mo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},wn=class so{constructor(e){Ke(this,"options");Ke(this,"renderer");Ke(this,"textRenderer");this.options=e||Qr,this.options.renderer=this.options.renderer||new Xi,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Mo}static parse(e,r){return new so(r).parse(e)}static parseInline(e,r){return new so(r).parseInline(e)}parse(e){var i,s;let r="";for(let l=0;l<e.length;l++){let f=e[l];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[f.type]){let v=f,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=f;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var s,l;let i="";for(let f=0;f<e.length;f++){let d=e[f];if((l=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&l[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){i+=h||"";continue}}let v=d;switch(v.type){case"escape":{i+=r.text(v);break}case"html":{i+=r.html(v);break}case"link":{i+=r.link(v);break}case"image":{i+=r.image(v);break}case"checkbox":{i+=r.checkbox(v);break}case"strong":{i+=r.strong(v);break}case"em":{i+=r.em(v);break}case"codespan":{i+=r.codespan(v);break}case"br":{i+=r.br(v);break}case"del":{i+=r.del(v);break}case"text":{i+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return i}},qi,Xa=(qi=class{constructor(t){Ke(this,"options");Ke(this,"block");this.options=t||Qr}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?_n.lex:_n.lexInline}provideParser(){return this.block?wn.parse:wn.parseInline}},Ke(qi,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ke(qi,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),qi),Sv=class{constructor(...t){Ke(this,"defaults",Eo());Ke(this,"options",this.setOptions);Ke(this,"parse",this.parseMarkdown(!0));Ke(this,"parseInline",this.parseMarkdown(!1));Ke(this,"Parser",wn);Ke(this,"Renderer",Xi);Ke(this,"TextRenderer",Mo);Ke(this,"Lexer",_n);Ke(this,"Tokenizer",Vi);Ke(this,"Hooks",Xa);this.use(...t)}walkTokens(t,e){var i,s;let r=[];for(let l of t)switch(r=r.concat(e.call(this,l)),l.type){case"table":{let f=l;for(let d of f.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of f.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let f=l;r=r.concat(this.walkTokens(f.items,e));break}default:{let f=l;(s=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&s[f.type]?this.defaults.extensions.childTokens[f.type].forEach(d=>{let v=f[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):f.tokens&&(r=r.concat(this.walkTokens(f.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let i={...r};if(i.async=this.defaults.async||i.async||!1,r.extensions&&(r.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let l=e.renderers[s.name];l?e.renderers[s.name]=function(...f){let d=s.renderer.apply(this,f);return d===!1&&(d=l.apply(this,f)),d}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let l=e[s.level];l?l.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),i.extensions=e),r.renderer){let s=this.defaults.renderer||new Xi(this.defaults);for(let l in r.renderer){if(!(l in s))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;let f=l,d=r.renderer[f],v=s[f];s[f]=(...h)=>{let y=d.apply(s,h);return y===!1&&(y=v.apply(s,h)),y||""}}i.renderer=s}if(r.tokenizer){let s=this.defaults.tokenizer||new Vi(this.defaults);for(let l in r.tokenizer){if(!(l in s))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;let f=l,d=r.tokenizer[f],v=s[f];s[f]=(...h)=>{let y=d.apply(s,h);return y===!1&&(y=v.apply(s,h)),y}}i.tokenizer=s}if(r.hooks){let s=this.defaults.hooks||new Xa;for(let l in r.hooks){if(!(l in s))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;let f=l,d=r.hooks[f],v=s[f];Xa.passThroughHooks.has(l)?s[f]=h=>{if(this.defaults.async&&Xa.passThroughHooksRespectAsync.has(l))return(async()=>{let k=await d.call(s,h);return v.call(s,k)})();let y=d.call(s,h);return v.call(s,y)}:s[f]=(...h)=>{if(this.defaults.async)return(async()=>{let k=await d.apply(s,h);return k===!1&&(k=await v.apply(s,h)),k})();let y=d.apply(s,h);return y===!1&&(y=v.apply(s,h)),y}}i.hooks=s}if(r.walkTokens){let s=this.defaults.walkTokens,l=r.walkTokens;i.walkTokens=function(f){let d=[];return d.push(l.call(this,f)),s&&(d=d.concat(s.call(this,f))),d}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return _n.lex(t,e??this.defaults)}parser(t,e){return wn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let i={...r},s={...this.defaults,...i},l=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=t),s.async)return(async()=>{let f=s.hooks?await s.hooks.preprocess(e):e,d=await(s.hooks?await s.hooks.provideLexer():t?_n.lex:_n.lexInline)(f,s),v=s.hooks?await s.hooks.processAllTokens(d):d;s.walkTokens&&await Promise.all(this.walkTokens(v,s.walkTokens));let h=await(s.hooks?await s.hooks.provideParser():t?wn.parse:wn.parseInline)(v,s);return s.hooks?await s.hooks.postprocess(h):h})().catch(l);try{s.hooks&&(e=s.hooks.preprocess(e));let f=(s.hooks?s.hooks.provideLexer():t?_n.lex:_n.lexInline)(e,s);s.hooks&&(f=s.hooks.processAllTokens(f)),s.walkTokens&&this.walkTokens(f,s.walkTokens);let d=(s.hooks?s.hooks.provideParser():t?wn.parse:wn.parseInline)(f,s);return s.hooks&&(d=s.hooks.postprocess(d)),d}catch(f){return l(f)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let i="<p>An error occurred:</p><pre>"+Un(r.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(r);throw r}}},Vr=new Sv;function Ze(t,e){return Vr.parse(t,e)}Ze.options=Ze.setOptions=function(t){return Vr.setOptions(t),Ze.defaults=Vr.defaults,cc(Ze.defaults),Ze};Ze.getDefaults=Eo;Ze.defaults=Qr;Ze.use=function(...t){return Vr.use(...t),Ze.defaults=Vr.defaults,cc(Ze.defaults),Ze};Ze.walkTokens=function(t,e){return Vr.walkTokens(t,e)};Ze.parseInline=Vr.parseInline;Ze.Parser=wn;Ze.parser=wn.parse;Ze.Renderer=Xi;Ze.TextRenderer=Mo;Ze.Lexer=_n;Ze.lexer=_n.lex;Ze.Tokenizer=Vi;Ze.Hooks=Xa;Ze.parse=Ze;Ze.options;Ze.setOptions;Ze.use;Ze.walkTokens;Ze.parseInline;wn.parse;_n.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:kc,setPrototypeOf:jl,isFrozen:Tv,getPrototypeOf:Ev,getOwnPropertyDescriptor:Av}=Object;let{freeze:Lt,seal:fn,create:oo}=Object,{apply:lo,construct:uo}=typeof Reflect<"u"&&Reflect;Lt||(Lt=function(e){return e});fn||(fn=function(e){return e});lo||(lo=function(e,r){for(var i=arguments.length,s=new Array(i>2?i-2:0),l=2;l<i;l++)s[l-2]=arguments[l];return e.apply(r,s)});uo||(uo=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return new e(...i)});const Li=Nt(Array.prototype.forEach),Iv=Nt(Array.prototype.lastIndexOf),Bl=Nt(Array.prototype.pop),Ga=Nt(Array.prototype.push),Cv=Nt(Array.prototype.splice),Ui=Nt(String.prototype.toLowerCase),qs=Nt(String.prototype.toString),js=Nt(String.prototype.match),Ha=Nt(String.prototype.replace),Pv=Nt(String.prototype.indexOf),Rv=Nt(String.prototype.trim),yn=Nt(Object.prototype.hasOwnProperty),Dt=Nt(RegExp.prototype.test),Wa=Ov(TypeError);function Nt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return lo(t,e,i)}}function Ov(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return uo(t,r)}}function ze(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ui;jl&&jl(t,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const l=r(s);l!==s&&(Tv(e)||(e[i]=l),s=l)}t[s]=!0}return t}function Dv(t){for(let e=0;e<t.length;e++)yn(t,e)||(t[e]=null);return t}function Pn(t){const e=oo(null);for(const[r,i]of kc(t))yn(t,r)&&(Array.isArray(i)?e[r]=Dv(i):i&&typeof i=="object"&&i.constructor===Object?e[r]=Pn(i):e[r]=i);return e}function $a(t,e){for(;t!==null;){const i=Av(t,e);if(i){if(i.get)return Nt(i.get);if(typeof i.value=="function")return Nt(i.value)}t=Ev(t)}function r(){return null}return r}const zl=Lt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Bs=Lt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zs=Lt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Mv=Lt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fs=Lt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Lv=Lt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fl=Lt(["#text"]),Kl=Lt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ks=Lt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ul=Lt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ni=Lt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Nv=fn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qv=fn(/<%[\w\W]*|[\w\W]*%>/gm),jv=fn(/\$\{[\w\W]*/gm),Bv=fn(/^data-[\-\w.\u00B7-\uFFFF]+$/),zv=fn(/^aria-[\-\w]+$/),xc=fn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Fv=fn(/^(?:\w+script|data):/i),Kv=fn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Sc=fn(/^html$/i),Uv=fn(/^[a-z][.\w]*(-[.\w]+)+$/i);var Gl=Object.freeze({__proto__:null,ARIA_ATTR:zv,ATTR_WHITESPACE:Kv,CUSTOM_ELEMENT:Uv,DATA_ATTR:Bv,DOCTYPE_NAME:Sc,ERB_EXPR:qv,IS_ALLOWED_URI:xc,IS_SCRIPT_OR_DATA:Fv,MUSTACHE_EXPR:Nv,TMPLIT_EXPR:jv});const Ya={element:1,text:3,progressingInstruction:7,comment:8,document:9},Gv=function(){return typeof window>"u"?null:window},Hv=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(i=r.getAttribute(s));const l="dompurify"+(i?"#"+i:"");try{return e.createPolicy(l,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}},Hl=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Tc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gv();const e=_e=>Tc(_e);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==Ya.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const i=r,s=i.currentScript,{DocumentFragment:l,HTMLTemplateElement:f,Node:d,Element:v,NodeFilter:h,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:k,DOMParser:b,trustedTypes:_}=t,q=v.prototype,j=$a(q,"cloneNode"),P=$a(q,"remove"),F=$a(q,"nextSibling"),re=$a(q,"childNodes"),ne=$a(q,"parentNode");if(typeof f=="function"){const _e=r.createElement("template");_e.content&&_e.content.ownerDocument&&(r=_e.content.ownerDocument)}let $,J="";const{implementation:ve,createNodeIterator:W,createDocumentFragment:Z,getElementsByTagName:Ee}=r,{importNode:Ce}=i;let ie=Hl();e.isSupported=typeof kc=="function"&&typeof ne=="function"&&ve&&ve.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ce,ERB_EXPR:be,TMPLIT_EXPR:Me,DATA_ATTR:xe,ARIA_ATTR:Se,IS_SCRIPT_OR_DATA:Pe,ATTR_WHITESPACE:B,CUSTOM_ELEMENT:H}=Gl;let{IS_ALLOWED_URI:ue}=Gl,pe=null;const Oe=ze({},[...zl,...Bs,...zs,...Fs,...Fl]);let qe=null;const De=ze({},[...Kl,...Ks,...Ul,...Ni]);let ge=Object.seal(oo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),et=null,Te=null;const at=Object.seal(oo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let vt=!0,ke=!0,Ta=!1,Qe=!0,Zt=!1,Zr=!0,Ot=!1,Ea=!1,Aa=!1,Zn=!1,Jr=!1,Jn=!1,Kt=!0,Ia=!1;const br="user-content-";let ea=!0,dn=!1,pt={},gt=null;const _r=ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let er=null;const ta=ze({},["audio","video","img","source","image","track"]);let tr=null;const En=ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),jn="http://www.w3.org/1998/Math/MathML",nr="http://www.w3.org/2000/svg",mt="http://www.w3.org/1999/xhtml";let ye=mt,Bn=!1,pn=null;const na=ze({},[jn,nr,mt],qs);let le=ze({},["mi","mo","mn","ms","mtext"]),rr=ze({},["annotation-xml"]);const di=ze({},["title","style","font","a","script"]);let zn=null;const pi=["application/xhtml+xml","text/html"],Ca="text/html";let ut=null,ar=null;const ir=r.createElement("form"),Fn=function(x){return x instanceof RegExp||x instanceof Function},wr=function(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ar&&ar===x)){if((!x||typeof x!="object")&&(x={}),x=Pn(x),zn=pi.indexOf(x.PARSER_MEDIA_TYPE)===-1?Ca:x.PARSER_MEDIA_TYPE,ut=zn==="application/xhtml+xml"?qs:Ui,pe=yn(x,"ALLOWED_TAGS")?ze({},x.ALLOWED_TAGS,ut):Oe,qe=yn(x,"ALLOWED_ATTR")?ze({},x.ALLOWED_ATTR,ut):De,pn=yn(x,"ALLOWED_NAMESPACES")?ze({},x.ALLOWED_NAMESPACES,qs):na,tr=yn(x,"ADD_URI_SAFE_ATTR")?ze(Pn(En),x.ADD_URI_SAFE_ATTR,ut):En,er=yn(x,"ADD_DATA_URI_TAGS")?ze(Pn(ta),x.ADD_DATA_URI_TAGS,ut):ta,gt=yn(x,"FORBID_CONTENTS")?ze({},x.FORBID_CONTENTS,ut):_r,et=yn(x,"FORBID_TAGS")?ze({},x.FORBID_TAGS,ut):Pn({}),Te=yn(x,"FORBID_ATTR")?ze({},x.FORBID_ATTR,ut):Pn({}),pt=yn(x,"USE_PROFILES")?x.USE_PROFILES:!1,vt=x.ALLOW_ARIA_ATTR!==!1,ke=x.ALLOW_DATA_ATTR!==!1,Ta=x.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Zt=x.SAFE_FOR_TEMPLATES||!1,Zr=x.SAFE_FOR_XML!==!1,Ot=x.WHOLE_DOCUMENT||!1,Zn=x.RETURN_DOM||!1,Jr=x.RETURN_DOM_FRAGMENT||!1,Jn=x.RETURN_TRUSTED_TYPE||!1,Aa=x.FORCE_BODY||!1,Kt=x.SANITIZE_DOM!==!1,Ia=x.SANITIZE_NAMED_PROPS||!1,ea=x.KEEP_CONTENT!==!1,dn=x.IN_PLACE||!1,ue=x.ALLOWED_URI_REGEXP||xc,ye=x.NAMESPACE||mt,le=x.MATHML_TEXT_INTEGRATION_POINTS||le,rr=x.HTML_INTEGRATION_POINTS||rr,ge=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&Fn(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ge.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&Fn(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ge.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ge.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Zt&&(ke=!1),Jr&&(Zn=!0),pt&&(pe=ze({},Fl),qe=[],pt.html===!0&&(ze(pe,zl),ze(qe,Kl)),pt.svg===!0&&(ze(pe,Bs),ze(qe,Ks),ze(qe,Ni)),pt.svgFilters===!0&&(ze(pe,zs),ze(qe,Ks),ze(qe,Ni)),pt.mathMl===!0&&(ze(pe,Fs),ze(qe,Ul),ze(qe,Ni))),x.ADD_TAGS&&(typeof x.ADD_TAGS=="function"?at.tagCheck=x.ADD_TAGS:(pe===Oe&&(pe=Pn(pe)),ze(pe,x.ADD_TAGS,ut))),x.ADD_ATTR&&(typeof x.ADD_ATTR=="function"?at.attributeCheck=x.ADD_ATTR:(qe===De&&(qe=Pn(qe)),ze(qe,x.ADD_ATTR,ut))),x.ADD_URI_SAFE_ATTR&&ze(tr,x.ADD_URI_SAFE_ATTR,ut),x.FORBID_CONTENTS&&(gt===_r&&(gt=Pn(gt)),ze(gt,x.FORBID_CONTENTS,ut)),x.ADD_FORBID_CONTENTS&&(gt===_r&&(gt=Pn(gt)),ze(gt,x.ADD_FORBID_CONTENTS,ut)),ea&&(pe["#text"]=!0),Ot&&ze(pe,["html","head","body"]),pe.table&&(ze(pe,["tbody"]),delete et.tbody),x.TRUSTED_TYPES_POLICY){if(typeof x.TRUSTED_TYPES_POLICY.createHTML!="function")throw Wa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof x.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Wa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');$=x.TRUSTED_TYPES_POLICY,J=$.createHTML("")}else $===void 0&&($=Hv(_,s)),$!==null&&typeof J=="string"&&(J=$.createHTML(""));Lt&&Lt(x),ar=x}},kr=ze({},[...Bs,...zs,...Mv]),tt=ze({},[...Fs,...Lv]),ht=function(x){let X=ne(x);(!X||!X.tagName)&&(X={namespaceURI:ye,tagName:"template"});const ae=Ui(x.tagName),Ye=Ui(X.tagName);return pn[x.namespaceURI]?x.namespaceURI===nr?X.namespaceURI===mt?ae==="svg":X.namespaceURI===jn?ae==="svg"&&(Ye==="annotation-xml"||le[Ye]):!!kr[ae]:x.namespaceURI===jn?X.namespaceURI===mt?ae==="math":X.namespaceURI===nr?ae==="math"&&rr[Ye]:!!tt[ae]:x.namespaceURI===mt?X.namespaceURI===nr&&!rr[Ye]||X.namespaceURI===jn&&!le[Ye]?!1:!tt[ae]&&(di[ae]||!kr[ae]):!!(zn==="application/xhtml+xml"&&pn[x.namespaceURI]):!1},Jt=function(x){Ga(e.removed,{element:x});try{ne(x).removeChild(x)}catch{P(x)}},en=function(x,X){try{Ga(e.removed,{attribute:X.getAttributeNode(x),from:X})}catch{Ga(e.removed,{attribute:null,from:X})}if(X.removeAttribute(x),x==="is")if(Zn||Jr)try{Jt(X)}catch{}else try{X.setAttribute(x,"")}catch{}},xr=function(x){let X=null,ae=null;if(Aa)x="<remove></remove>"+x;else{const st=js(x,/^[\r\n\t ]+/);ae=st&&st[0]}zn==="application/xhtml+xml"&&ye===mt&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");const Ye=$?$.createHTML(x):x;if(ye===mt)try{X=new b().parseFromString(Ye,zn)}catch{}if(!X||!X.documentElement){X=ve.createDocument(ye,"template",null);try{X.documentElement.innerHTML=Bn?J:Ye}catch{}}const nt=X.body||X.documentElement;return x&&ae&&nt.insertBefore(r.createTextNode(ae),nt.childNodes[0]||null),ye===mt?Ee.call(X,Ot?"html":"body")[0]:Ot?X.documentElement:nt},Sr=function(x){return W.call(x.ownerDocument||x,x,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Pa=function(x){return x instanceof k&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof y)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},hn=function(x){return typeof d=="function"&&x instanceof d};function It(_e,x,X){Li(_e,ae=>{ae.call(e,x,X,ar)})}const vn=function(x){let X=null;if(It(ie.beforeSanitizeElements,x,null),Pa(x))return Jt(x),!0;const ae=ut(x.nodeName);if(It(ie.uponSanitizeElement,x,{tagName:ae,allowedTags:pe}),Zr&&x.hasChildNodes()&&!hn(x.firstElementChild)&&Dt(/<[/\w!]/g,x.innerHTML)&&Dt(/<[/\w!]/g,x.textContent)||x.nodeType===Ya.progressingInstruction||Zr&&x.nodeType===Ya.comment&&Dt(/<[/\w]/g,x.data))return Jt(x),!0;if(!(at.tagCheck instanceof Function&&at.tagCheck(ae))&&(!pe[ae]||et[ae])){if(!et[ae]&&hi(ae)&&(ge.tagNameCheck instanceof RegExp&&Dt(ge.tagNameCheck,ae)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(ae)))return!1;if(ea&&!gt[ae]){const Ye=ne(x)||x.parentNode,nt=re(x)||x.childNodes;if(nt&&Ye){const st=nt.length;for(let ct=st-1;ct>=0;--ct){const qt=j(nt[ct],!0);qt.__removalCount=(x.__removalCount||0)+1,Ye.insertBefore(qt,F(x))}}}return Jt(x),!0}return x instanceof v&&!ht(x)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&Dt(/<\/no(script|embed|frames)/i,x.innerHTML)?(Jt(x),!0):(Zt&&x.nodeType===Ya.text&&(X=x.textContent,Li([ce,be,Me],Ye=>{X=Ha(X,Ye," ")}),x.textContent!==X&&(Ga(e.removed,{element:x.cloneNode()}),x.textContent=X)),It(ie.afterSanitizeElements,x,null),!1)},Tr=function(x,X,ae){if(Kt&&(X==="id"||X==="name")&&(ae in r||ae in ir))return!1;if(!(ke&&!Te[X]&&Dt(xe,X))){if(!(vt&&Dt(Se,X))){if(!(at.attributeCheck instanceof Function&&at.attributeCheck(X,x))){if(!qe[X]||Te[X]){if(!(hi(x)&&(ge.tagNameCheck instanceof RegExp&&Dt(ge.tagNameCheck,x)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(x))&&(ge.attributeNameCheck instanceof RegExp&&Dt(ge.attributeNameCheck,X)||ge.attributeNameCheck instanceof Function&&ge.attributeNameCheck(X,x))||X==="is"&&ge.allowCustomizedBuiltInElements&&(ge.tagNameCheck instanceof RegExp&&Dt(ge.tagNameCheck,ae)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(ae))))return!1}else if(!tr[X]){if(!Dt(ue,Ha(ae,B,""))){if(!((X==="src"||X==="xlink:href"||X==="href")&&x!=="script"&&Pv(ae,"data:")===0&&er[x])){if(!(Ta&&!Dt(Pe,Ha(ae,B,"")))){if(ae)return!1}}}}}}}return!0},hi=function(x){return x!=="annotation-xml"&&js(x,H)},gn=function(x){It(ie.beforeSanitizeAttributes,x,null);const{attributes:X}=x;if(!X||Pa(x))return;const ae={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:qe,forceKeepAttr:void 0};let Ye=X.length;for(;Ye--;){const nt=X[Ye],{name:st,namespaceURI:ct,value:qt}=nt,An=ut(st),Er=qt;let it=st==="value"?Er:Rv(Er);if(ae.attrName=An,ae.attrValue=it,ae.keepAttr=!0,ae.forceKeepAttr=void 0,It(ie.uponSanitizeAttribute,x,ae),it=ae.attrValue,Ia&&(An==="id"||An==="name")&&(en(st,x),it=br+it),Zr&&Dt(/((--!?|])>)|<\/(style|title|textarea)/i,it)){en(st,x);continue}if(An==="attributename"&&js(it,"href")){en(st,x);continue}if(ae.forceKeepAttr)continue;if(!ae.keepAttr){en(st,x);continue}if(!Qe&&Dt(/\/>/i,it)){en(st,x);continue}Zt&&Li([ce,be,Me],Ar=>{it=Ha(it,Ar," ")});const Ra=ut(x.nodeName);if(!Tr(Ra,An,it)){en(st,x);continue}if($&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!ct)switch(_.getAttributeType(Ra,An)){case"TrustedHTML":{it=$.createHTML(it);break}case"TrustedScriptURL":{it=$.createScriptURL(it);break}}if(it!==Er)try{ct?x.setAttributeNS(ct,st,it):x.setAttribute(st,it),Pa(x)?Jt(x):Bl(e.removed)}catch{en(st,x)}}It(ie.afterSanitizeAttributes,x,null)},vi=function _e(x){let X=null;const ae=Sr(x);for(It(ie.beforeSanitizeShadowDOM,x,null);X=ae.nextNode();)It(ie.uponSanitizeShadowNode,X,null),vn(X),gn(X),X.content instanceof l&&_e(X.content);It(ie.afterSanitizeShadowDOM,x,null)};return e.sanitize=function(_e){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=null,ae=null,Ye=null,nt=null;if(Bn=!_e,Bn&&(_e="<!-->"),typeof _e!="string"&&!hn(_e))if(typeof _e.toString=="function"){if(_e=_e.toString(),typeof _e!="string")throw Wa("dirty is not a string, aborting")}else throw Wa("toString is not a function");if(!e.isSupported)return _e;if(Ea||wr(x),e.removed=[],typeof _e=="string"&&(dn=!1),dn){if(_e.nodeName){const qt=ut(_e.nodeName);if(!pe[qt]||et[qt])throw Wa("root node is forbidden and cannot be sanitized in-place")}}else if(_e instanceof d)X=xr("<!---->"),ae=X.ownerDocument.importNode(_e,!0),ae.nodeType===Ya.element&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?X=ae:X.appendChild(ae);else{if(!Zn&&!Zt&&!Ot&&_e.indexOf("<")===-1)return $&&Jn?$.createHTML(_e):_e;if(X=xr(_e),!X)return Zn?null:Jn?J:""}X&&Aa&&Jt(X.firstChild);const st=Sr(dn?_e:X);for(;Ye=st.nextNode();)vn(Ye),gn(Ye),Ye.content instanceof l&&vi(Ye.content);if(dn)return _e;if(Zn){if(Jr)for(nt=Z.call(X.ownerDocument);X.firstChild;)nt.appendChild(X.firstChild);else nt=X;return(qe.shadowroot||qe.shadowrootmode)&&(nt=Ce.call(i,nt,!0)),nt}let ct=Ot?X.outerHTML:X.innerHTML;return Ot&&pe["!doctype"]&&X.ownerDocument&&X.ownerDocument.doctype&&X.ownerDocument.doctype.name&&Dt(Sc,X.ownerDocument.doctype.name)&&(ct="<!DOCTYPE "+X.ownerDocument.doctype.name+`>
`+ct),Zt&&Li([ce,be,Me],qt=>{ct=Ha(ct,qt," ")}),$&&Jn?$.createHTML(ct):ct},e.setConfig=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wr(_e),Ea=!0},e.clearConfig=function(){ar=null,Ea=!1},e.isValidAttribute=function(_e,x,X){ar||wr({});const ae=ut(_e),Ye=ut(x);return Tr(ae,Ye,X)},e.addHook=function(_e,x){typeof x=="function"&&Ga(ie[_e],x)},e.removeHook=function(_e,x){if(x!==void 0){const X=Iv(ie[_e],x);return X===-1?void 0:Cv(ie[_e],X,1)[0]}return Bl(ie[_e])},e.removeHooks=function(_e){ie[_e]=[]},e.removeAllHooks=function(){ie=Hl()},e}var Wv=Tc();function $v(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${Wl(t.from)} |`),e.push(`| **To** | ${Wl(t.to)} |`),e.push(`| **Date** | ${To(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Yv(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function Wl(t){return(t||"").replace(/\|/g,"\\|")}function Yv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return co(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Vv(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),i=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||i>0&&i<=3)return!0;const s=e.toLowerCase();return s.includes("spacer")||s.includes("transparent")||s.includes("transp.gif")||s.includes("/track")&&s.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(s)?!0:s.includes("mail.google.com/mail/u/")&&s.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(s)||s.endsWith(".gif")&&s.includes("1x1"))}function co(t){var s;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const l=t.getAttribute("src")||"",f=t.getAttribute("alt")||"";return Vv(t,l)?"":`![${f}](${l})`}const r=Array.from(t.childNodes).map(co).join(""),i=r.trim();if(!i&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${i}

`;if(e==="blockquote")return`

> ${i.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const l=Number(e[1]);return`

${"#".repeat(l)} ${i}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((s=t.parentElement)==null?void 0:s.tagName.toLowerCase())==="ol"?"1.":"-"} ${i}
`;if(e==="a"){const l=t.getAttribute("href")||"";return!l||l.startsWith("mailto:")?i:i===l?l:`[${i}](${l})`}if(e==="strong"||e==="b")return`**${i}**`;if(e==="em"||e==="i")return`*${i}*`;if(e==="code")return`\`${i}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(f=>co(f).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const l=r.trim(),f=(l.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(f,1)).fill("---").join(" | ")+" |";return`${l}${d}
`}return r}function Xv(t){const e=Qv(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.md`}function Qv(t){try{const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${r}-${i}-${s}`}catch{return"email"}}function Zv(t,e){const r=new Blob([t],{type:"text/markdown;charset=utf-8"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}var Jv=te('<button title="View as Markdown">.md</button>'),eg=te('<pre class="md-raw svelte-1b0rzpb"> </pre>'),tg=te('<div class="md-preview svelte-1b0rzpb"><!></div>'),ng=te('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),rg=te('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),ag=te('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),ig=te('<pre class="message-text svelte-1b0rzpb"> </pre>'),sg=te('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),og=te('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),lg=te('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function ug(t,e){Et(e,!0);let r=Ne(e,"loading",3,!1);Rt(()=>Qt("MessageModal"));const i=new Ze.Renderer;i.link=({href:W,title:Z,text:Ee})=>{const Ce=Z?` title="${Z}"`:"";return`<a href="${W}"${Ce} target="_blank" rel="noopener">${Ee}</a>`},Ze.setOptions({breaks:!0,gfm:!0,renderer:i});let s=Re(!1),l=Re("raw"),f=gr(()=>e.message.body?$v(e.message):"");function d(){G(s,!R(s)),G(l,"raw")}function v(){Zv(R(f),Xv(e.message))}function h(W){const Z=Ze.parse(W);return Wv.sanitize(Z,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let y=Re(null);Hi(()=>{var W;if(R(y)&&e.message.htmlBody&&!r()&&!R(s)){const Z=R(y).contentDocument||((W=R(y).contentWindow)==null?void 0:W.document);Z&&(Z.open(),Z.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),Z.close())}});var k=lg();k.__click=function(...W){var Z;(Z=e.onclose)==null||Z.apply(this,W)};var b=M(k);b.__click=W=>W.stopPropagation();var _=M(b),q=M(_),j=M(q),P=K(q,2),F=M(P);{var re=W=>{var Z=Jv();let Ee;Z.__click=d,we(()=>Ee=Gr(Z,1,"action-btn svelte-1b0rzpb",null,Ee,{active:R(s)})),Q(W,Z)};Ae(F,W=>{e.message.body&&W(re)})}var ne=K(F,2);ne.__click=function(...W){var Z;(Z=e.onclose)==null||Z.apply(this,W)};var $=K(_,2);{var J=W=>{var Z=ng(),Ee=Vt(Z),Ce=M(Ee),ie=M(Ce);let ce;ie.__click=()=>G(l,"raw");var be=K(ie,2);let Me;be.__click=()=>G(l,"preview");var xe=K(Ce,2);xe.__click=v;var Se=K(Ee,2),Pe=M(Se);{var B=ue=>{var pe=eg(),Oe=M(pe);we(()=>de(Oe,R(f))),Q(ue,pe)},H=ue=>{var pe=tg(),Oe=M(pe);md(Oe,()=>h(R(f))),Q(ue,pe)};Ae(Pe,ue=>{R(l)==="raw"?ue(B):ue(H,!1)})}we(()=>{ce=Gr(ie,1,"md-tab svelte-1b0rzpb",null,ce,{active:R(l)==="raw"}),Me=Gr(be,1,"md-tab svelte-1b0rzpb",null,Me,{active:R(l)==="preview"})}),Q(W,Z)},ve=W=>{var Z=og(),Ee=Vt(Z),Ce=M(Ee),ie=K(M(Ce),2),ce=M(ie),be=K(Ce,2),Me=K(M(be),2),xe=M(Me),Se=K(be,2),Pe=K(M(Se),2),B=M(Pe),H=K(Ee,2),ue=M(H);{var pe=ge=>{var et=rg();Q(ge,et)},Oe=ge=>{var et=ag();Vu(et,Te=>G(y,Te),()=>R(y)),Q(ge,et)},qe=ge=>{var et=ig(),Te=M(et);we(()=>de(Te,e.message.body)),Q(ge,et)},De=ge=>{var et=sg();Q(ge,et)};Ae(ue,ge=>{r()?ge(pe):e.message.htmlBody?ge(Oe,1):e.message.body?ge(qe,2):ge(De,!1)})}we(ge=>{de(ce,e.message.from),de(xe,e.message.to),de(B,ge)},[()=>To(e.message.date)]),Q(W,Z)};Ae($,W=>{R(s)?W(J):W(ve,!1)})}we(()=>de(j,e.message.subject)),Q(t,k),At()}qn(["click"]);var cg=te('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),fg=te('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),dg=te('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),pg=te("<p> </p>"),hg=te('<p>No emails in local storage. Click "Sync New" to download.</p>'),vg=te('<div class="empty-state svelte-6ts5xm"><!></div>'),gg=te('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),mg=te('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function yg(t,e){Et(e,!0),Rt(()=>Qt("DashboardView"));let r=Ne(e,"error",3,null),i=Ne(e,"profile",3,null),s=Ne(e,"loadingProfile",3,!1),l=Ne(e,"emailMessages",19,()=>[]),f=Ne(e,"totalLocalMessages",3,0),d=Ne(e,"hasMoreLocal",3,!1),v=Ne(e,"loadingMessages",3,!1),h=Ne(e,"selectedMessage",3,null),y=Ne(e,"syncStatus",3,null),k=Ne(e,"syncProgress",3,null),b=Ne(e,"isSyncing",3,!1),_=Ne(e,"searchQuery",15);var q=mg(),j=Vt(q),P=M(j);{var F=xe=>{oc(xe,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Ae(P,xe=>{r()&&xe(F)})}var re=K(P,2);bh(re,{get profile(){return i()},get loadingProfile(){return s()},get onsignout(){return e.onsignout}});var ne=K(re,2);Oh(ne,{get syncStatus(){return y()},get syncProgress(){return k()},get isSyncing(){return b()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var $=K(ne,2),J=M($);J.__keydown=xe=>xe.key==="Enter"&&e.onsearch();var ve=K(J,2);ve.__click=function(...xe){var Se;(Se=e.onsearch)==null||Se.apply(this,xe)};var W=M(ve),Z=K($,2);{var Ee=xe=>{var Se=fg(),Pe=Vt(Se),B=M(Pe),H=M(B),ue=K(Pe,2);Lh(ue,{get messages(){return l()},get onselect(){return e.onviewmessage}});var pe=K(ue,2);{var Oe=qe=>{var De=cg(),ge=M(De);ge.__click=function(...Te){var at;(at=e.onloadmore)==null||at.apply(this,Te)};var et=M(ge);we(()=>{ge.disabled=v(),de(et,v()?"Loading...":"Load More")}),Q(qe,De)};Ae(pe,qe=>{d()&&qe(Oe)})}we(qe=>de(H,`Showing ${l().length??""} of ${qe??""}
        ${_()?" matching":""} emails`),[()=>f().toLocaleString()]),Q(xe,Se)},Ce=xe=>{var Se=dg();Q(xe,Se)},ie=xe=>{var Se=vg(),Pe=M(Se);{var B=ue=>{var pe=pg(),Oe=M(pe);we(()=>de(Oe,`No emails match "${_()??""}".`)),Q(ue,pe)},H=ue=>{var pe=hg();Q(ue,pe)};Ae(Pe,ue=>{_()?ue(B):ue(H,!1)})}Q(xe,Se)},ce=xe=>{var Se=gg();Q(xe,Se)};Ae(Z,xe=>{var Se;l().length>0?xe(Ee):v()?xe(Ce,1):(Se=y())!=null&&Se.synced?xe(ie,2):xe(ce,!1)})}var be=K(j,2);{var Me=xe=>{ug(xe,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};Ae(be,xe=>{h()&&xe(Me)})}we(()=>{ve.disabled=v(),de(W,v()?"Searching...":"Search")}),So(J,_),Q(t,q),At()}qn(["keydown","click"]);var bg=te('<div class="dashboard svelte-1q5o2lv"><!></div>');function _g(t,e){Et(e,!0);function r(Te){Te.key==="Escape"&&R(v)&&Pe()}Rt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let i=Re($t(localStorage.getItem("googleClientId")||"")),s=Re($t(localStorage.getItem("googleClientId")||"")),l=Re(!1),f=Re(null),d=Re(null),v=Re(null),h=Re(""),y=Re($t([])),k=Re(0),b=Re(0),_=Re(!1),q=Re(!1),j=Re(!1),P=Re(null),F=Re(null),re=Re(null),ne=Re(!1);const $=50;Hi(()=>{R(f)&&(B(),be())});let J=gr(()=>!R(i)),ve=gr(()=>!!R(f)),W=gr(()=>R(y).length<R(k));Hi(()=>{R(i)&&!R(l)&&Pl(R(i)).then(()=>{G(l,!0)}).catch(Te=>{G(P,`Auth init failed: ${Te.message}`)})});function Z(){const Te=R(s).trim();Te&&(localStorage.setItem("googleClientId",Te),G(i,Te,!0),G(P,null))}function Ee(){localStorage.removeItem("googleClientId"),G(i,""),G(s,""),G(l,!1),G(f,null),G(d,null),G(y,[],!0),G(k,0)}async function Ce(){G(P,null),G(q,!0);try{R(l)||(await Pl(R(i)),G(l,!0));const Te=await Fp();G(f,Te.access_token,!0),await ce()}catch(Te){G(P,Te.message,!0)}finally{G(q,!1)}}async function ie(){if(R(f))try{await Kp(R(f))}catch{}G(f,null),G(d,null),G(y,[],!0),G(k,0),G(v,null),G(P,null)}async function ce(){G(j,!0);try{const Te=await Ju(R(f));if(!R(f))return;G(d,Te,!0)}catch(Te){if(!R(f))return;G(P,`Profile fetch failed: ${Te.message}`)}finally{G(j,!1)}}async function be(Te=!1){G(_,!0);try{const at=Te?R(b):0,vt=await Fd({query:R(h)||void 0,limit:$,offset:at});Te?G(y,[...R(y),...vt.items],!0):G(y,vt.items,!0),G(k,vt.total,!0),G(b,R(y).length,!0)}catch(at){G(P,`Failed to load messages: ${at.message}`)}finally{G(_,!1)}}function Me(){G(b,0),be(!1)}function xe(){be(!0)}function Se(Te){G(v,Te,!0)}function Pe(){G(v,null)}async function B(){try{G(F,await Qp(),!0)}catch{}}async function H(Te){if(R(ne)||!R(f))return;G(P,null),G(ne,!0),G(re,null);const at=new AbortController;try{await Vp(R(f),{limit:Te,onProgress:vt=>{G(re,{...vt},!0)},signal:at.signal}),await B(),await be(!1)}catch(vt){if(vt.name!=="AbortError"){if(!R(f))return;G(P,`Sync failed: ${vt.message}`)}}finally{G(ne,!1)}}async function ue(Te){if(R(ne)||!R(f))return;G(P,null),G(ne,!0),G(re,null);const at=new AbortController;try{await Xp(R(f),{limit:Te,onProgress:vt=>{G(re,{...vt},!0)},signal:at.signal}),await B(),await be(!1)}catch(vt){if(vt.name!=="AbortError"){if(!R(f))return;G(P,`Sync more failed: ${vt.message}`)}}finally{G(ne,!1)}}async function pe(){try{await Zp(),await B(),G(y,[],!0),G(k,0),G(b,0)}catch(Te){G(P,`Failed to clear data: ${Te.message}`)}}var Oe=bg(),qe=M(Oe);{var De=Te=>{ah(Te,{onsave:Z,get clientIdInput(){return R(s)},set clientIdInput(at){G(s,at,!0)}})},ge=Te=>{vh(Te,{get clientId(){return R(i)},get error(){return R(P)},get loadingAuth(){return R(q)},onsignin:Ce,onclear:Ee,onsignout:ie})},et=Te=>{yg(Te,{get error(){return R(P)},get profile(){return R(d)},get loadingProfile(){return R(j)},get emailMessages(){return R(y)},get totalLocalMessages(){return R(k)},get hasMoreLocal(){return R(W)},get loadingMessages(){return R(_)},get selectedMessage(){return R(v)},get syncStatus(){return R(F)},get syncProgress(){return R(re)},get isSyncing(){return R(ne)},onsignout:ie,onsearch:Me,onloadmore:xe,onviewmessage:Se,onclosedetail:Pe,ondismisserror:()=>G(P,null),onsync:H,onsyncmore:ue,oncleardata:pe,get searchQuery(){return R(h)},set searchQuery(at){G(h,at,!0)}})};Ae(qe,Te=>{R(J)?Te(De):R(ve)?Te(et,!1):Te(ge,1)})}Q(t,Oe),At()}var wg=te('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function kg(t,e){Et(e,!0);let r=Re($t(location.hash==="#dashboard"?"dashboard":"chat"));Rt(()=>{function F(){G(r,location.hash==="#dashboard"?"dashboard":"chat",!0)}return window.addEventListener("hashchange",F),()=>window.removeEventListener("hashchange",F)});var i=wg(),s=M(i),l=K(M(s),2),f=M(l);let d;var v=K(f,2);let h;var y=K(s,2),k=M(y);let b;var _=M(k);jp(_,{});var q=K(k,2);let j;var P=M(q);_g(P,{}),we(()=>{d=Gr(f,1,"svelte-1n46o8q",null,d,{active:R(r)==="chat"}),h=Gr(v,1,"svelte-1n46o8q",null,h,{active:R(r)==="dashboard"}),b=Wi(k,"",b,{display:R(r)==="chat"?"flex":"none"}),j=Wi(q,"",j,{display:R(r)==="dashboard"?"flex":"none"})}),Q(t,i),At()}cd(kg,{target:document.getElementById("app")});
