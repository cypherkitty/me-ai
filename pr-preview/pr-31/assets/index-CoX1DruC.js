var vf=Object.defineProperty;var xl=t=>{throw TypeError(t)};var hf=(t,e,r)=>e in t?vf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ve=(t,e,r)=>hf(t,typeof e!="symbol"?e+"":e,r),zi=(t,e,r)=>e.has(t)||xl("Cannot "+r);var Z=(t,e,r)=>(zi(t,e,"read from private field"),r?r.call(t):e.get(t)),Xe=(t,e,r)=>e.has(t)?xl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,a)=>(zi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),Yt=(t,e,r)=>(zi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const $i=!1;var So=Array.isArray,mf=Array.prototype.indexOf,Ca=Array.prototype.includes,ui=Array.from,gf=Object.defineProperty,_a=Object.getOwnPropertyDescriptor,yf=Object.getOwnPropertyDescriptors,_f=Object.prototype,bf=Array.prototype,du=Object.getPrototypeOf,Sl=Object.isExtensible;const wf=()=>{};function kf(t){for(var e=0;e<t.length;e++)t[e]()}function pu(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Kt=2,os=4,ci=8,vu=1<<24,gr=16,Yn=32,ca=64,hu=128,Rn=512,Mt=1024,Ut=2048,Wn=4096,yn=8192,hr=16384,vs=32768,Ia=65536,Tl=1<<17,mu=1<<18,Ma=1<<19,xf=1<<20,vr=1<<25,sa=65536,eo=1<<21,To=1<<22,Rr=1<<23,na=Symbol("$state"),Sf=Symbol("legacy props"),Tf=Symbol(""),Yr=new class extends Error{constructor(){super(...arguments);Ve(this,"name","StaleReactionError");Ve(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Ef(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Af(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Cf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function If(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Rf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Pf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Of(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Df(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Mf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Lf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Nf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function jf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const qf=1,Bf=2,gu=4,zf=8,Ff=16,Kf=1,Uf=4,Gf=8,Hf=16,yu=1,Wf=2,qt=Symbol(),_u="http://www.w3.org/1999/xhtml";function Yf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Vf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function bu(t){return t===this.v}function Xf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function wu(t){return!Xf(t,this.v)}let Qf=!1,_n=null;function Ra(t){_n=t}function mt(t,e=!1,r){_n={p:_n,i:!1,c:null,e:null,s:t,x:null,l:null}}function gt(t){var e=_n,r=e.e;if(r!==null){e.e=null;for(var a of r)Uu(a)}return t!==void 0&&(e.x=t),e.i=!0,_n=e.p,t??{}}function ku(){return!0}let Vr=[];function xu(){var t=Vr;Vr=[],kf(t)}function Pr(t){if(Vr.length===0&&!rs){var e=Vr;queueMicrotask(()=>{e===Vr&&xu()})}Vr.push(t)}function Zf(){for(;Vr.length>0;)xu()}function Su(t){var e=ot;if(e===null)return Ze.f|=Rr,t;if((e.f&vs)===0&&(e.f&os)===0)throw t;Pa(t,e)}function Pa(t,e){for(;e!==null;){if((e.f&hu)!==0){if((e.f&vs)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Jf=-7169;function At(t,e){t.f=t.f&Jf|e}function Eo(t){(t.f&Rn)!==0||t.deps===null?At(t,Mt):At(t,Wn)}function Tu(t){if(t!==null)for(const e of t)(e.f&Kt)===0||(e.f&sa)===0||(e.f^=sa,Tu(e.deps))}function Eu(t,e,r){(t.f&Ut)!==0?e.add(t):(t.f&Wn)!==0&&r.add(t),Tu(t.deps),At(t,Mt)}const qs=new Set;let Ke=null,$s=null,Bt=null,on=[],fi=null,to=!1,rs=!1;var wa,ka,Qr,xa,cs,fs,Zr,cr,Sa,rr,no,ro,Au;const Xo=class Xo{constructor(){Xe(this,rr);Ve(this,"committed",!1);Ve(this,"current",new Map);Ve(this,"previous",new Map);Xe(this,wa,new Set);Xe(this,ka,new Set);Xe(this,Qr,0);Xe(this,xa,0);Xe(this,cs,null);Xe(this,fs,new Set);Xe(this,Zr,new Set);Xe(this,cr,new Map);Ve(this,"is_fork",!1);Xe(this,Sa,!1)}is_deferred(){return this.is_fork||Z(this,xa)>0}skip_effect(e){Z(this,cr).has(e)||Z(this,cr).set(e,{d:[],m:[]})}unskip_effect(e){var r=Z(this,cr).get(e);if(r){Z(this,cr).delete(e);for(var a of r.d)At(a,Ut),Gn(a);for(a of r.m)At(a,Wn),Gn(a)}}process(e){var i;on=[],this.apply();var r=[],a=[];for(const o of e)Yt(this,rr,no).call(this,o,r,a);if(this.is_deferred()){Yt(this,rr,ro).call(this,a),Yt(this,rr,ro).call(this,r);for(const[o,c]of Z(this,cr))Pu(o,c)}else{for(const o of Z(this,wa))o();Z(this,wa).clear(),Z(this,Qr)===0&&Yt(this,rr,Au).call(this),$s=this,Ke=null,El(a),El(r),$s=null,(i=Z(this,cs))==null||i.resolve()}Bt=null}capture(e,r){r!==qt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Rr)===0&&(this.current.set(e,e.v),Bt==null||Bt.set(e,e.v))}activate(){Ke=this,this.apply()}deactivate(){Ke===this&&(Ke=null,Bt=null)}flush(){if(this.activate(),on.length>0){if(Cu(),Ke!==null&&Ke!==this)return}else Z(this,Qr)===0&&this.process([]);this.deactivate()}discard(){for(const e of Z(this,ka))e(this);Z(this,ka).clear()}increment(e){He(this,Qr,Z(this,Qr)+1),e&&He(this,xa,Z(this,xa)+1)}decrement(e){He(this,Qr,Z(this,Qr)-1),e&&He(this,xa,Z(this,xa)-1),!Z(this,Sa)&&(He(this,Sa,!0),Pr(()=>{He(this,Sa,!1),this.is_deferred()?on.length>0&&this.flush():this.revive()}))}revive(){for(const e of Z(this,fs))Z(this,Zr).delete(e),At(e,Ut),Gn(e);for(const e of Z(this,Zr))At(e,Wn),Gn(e);this.flush()}oncommit(e){Z(this,wa).add(e)}ondiscard(e){Z(this,ka).add(e)}settled(){return(Z(this,cs)??He(this,cs,pu())).promise}static ensure(){if(Ke===null){const e=Ke=new Xo;qs.add(Ke),rs||Pr(()=>{Ke===e&&e.flush()})}return Ke}apply(){}};wa=new WeakMap,ka=new WeakMap,Qr=new WeakMap,xa=new WeakMap,cs=new WeakMap,fs=new WeakMap,Zr=new WeakMap,cr=new WeakMap,Sa=new WeakMap,rr=new WeakSet,no=function(e,r,a){e.f^=Mt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(Yn|ca))!==0,h=d&&(c&Mt)!==0,v=h||(c&yn)!==0||Z(this,cr).has(i);if(!v&&i.fn!==null){d?i.f^=Mt:o!==null&&(c&(os|ci|vu))!==0?o.b.defer_effect(i):(c&os)!==0?r.push(i):ms(i)&&((c&gr)!==0&&Z(this,Zr).add(i),Da(i));var y=i.first;if(y!==null){i=y;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},ro=function(e){for(var r=0;r<e.length;r+=1)Eu(e[r],Z(this,fs),Z(this,Zr))},Au=function(){var i;if(qs.size>1){this.previous.clear();var e=Bt,r=!0;for(const o of qs){if(o===this){r=!1;continue}const c=[];for(const[h,v]of this.current){if(o.current.has(h))if(r&&v!==o.current.get(h))o.current.set(h,v);else continue;c.push(h)}if(c.length===0)continue;const d=[...o.current.keys()].filter(h=>!this.current.has(h));if(d.length>0){var a=on;on=[];const h=new Set,v=new Map;for(const y of c)Iu(y,d,h,v);if(on.length>0){Ke=o,o.apply();for(const y of on)Yt(i=o,rr,no).call(i,y,[],[]);o.deactivate()}on=a}}Ke=null,Bt=e}this.committed=!0,qs.delete(this)};let Or=Xo;function $f(t){var e=rs;rs=!0;try{for(var r;;){if(Zf(),on.length===0&&(Ke==null||Ke.flush(),on.length===0))return fi=null,r;Cu()}}finally{rs=e}}function Cu(){to=!0;var t=null;try{for(var e=0;on.length>0;){var r=Or.ensure();if(e++>1e3){var a,i;ed()}r.process(on),Dr.clear()}}finally{on=[],to=!1,fi=null}}function ed(){try{Of()}catch(t){Pa(t,fi)}}let Bn=null;function El(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(hr|yn))===0&&ms(a)&&(Bn=new Set,Da(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Yu(a),(Bn==null?void 0:Bn.size)>0)){Dr.clear();for(const i of Bn){if((i.f&(hr|yn))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)Bn.has(c)&&(Bn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const h=o[d];(h.f&(hr|yn))===0&&Da(h)}}Bn.clear()}}Bn=null}}function Iu(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Kt)!==0?Iu(i,e,r,a):(o&(To|gr))!==0&&(o&Ut)===0&&Ru(i,e,a)&&(At(i,Ut),Gn(i))}}function Ru(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ca.call(e,i))return!0;if((i.f&Kt)!==0&&Ru(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Gn(t){for(var e=fi=t;e.parent!==null;){e=e.parent;var r=e.f;if(to&&e===ot&&(r&gr)!==0&&(r&mu)===0)return;if((r&(ca|Yn))!==0){if((r&Mt)===0)return;e.f^=Mt}}on.push(e)}function Pu(t,e){if(!((t.f&Yn)!==0&&(t.f&Mt)!==0)){(t.f&Ut)!==0?e.d.push(t):(t.f&Wn)!==0&&e.m.push(t),At(t,Mt);for(var r=t.first;r!==null;)Pu(r,e),r=r.next}}function td(t){let e=0,r=ia(0),a;return()=>{Io()&&(g(r),Ro(()=>(e===0&&(a=gs(()=>t(()=>as(r)))),e+=1,()=>{Pr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,as(r))})})))}}var nd=Ia|Ma|hu;function rd(t,e,r){new ad(t,e,r)}var An,xo,Jn,Jr,$n,Cn,an,er,fr,Cr,$r,Ir,Ta,ea,Ea,Aa,dr,oi,Lt,sd,id,ao,Ws,Ys,so;class ad{constructor(e,r,a){Xe(this,Lt);Ve(this,"parent");Ve(this,"is_pending",!1);Xe(this,An);Xe(this,xo,null);Xe(this,Jn);Xe(this,Jr);Xe(this,$n);Xe(this,Cn,null);Xe(this,an,null);Xe(this,er,null);Xe(this,fr,null);Xe(this,Cr,null);Xe(this,$r,0);Xe(this,Ir,0);Xe(this,Ta,!1);Xe(this,ea,!1);Xe(this,Ea,new Set);Xe(this,Aa,new Set);Xe(this,dr,null);Xe(this,oi,td(()=>(He(this,dr,ia(Z(this,$r))),()=>{He(this,dr,null)})));He(this,An,e),He(this,Jn,r),He(this,Jr,a),this.parent=ot.b,this.is_pending=!!Z(this,Jn).pending,He(this,$n,Po(()=>{ot.b=this;{var i=Yt(this,Lt,ao).call(this);try{He(this,Cn,In(()=>a(i)))}catch(o){this.error(o)}Z(this,Ir)>0?Yt(this,Lt,Ys).call(this):this.is_pending=!1}return()=>{var o;(o=Z(this,Cr))==null||o.remove()}},nd))}defer_effect(e){Eu(e,Z(this,Ea),Z(this,Aa))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!Z(this,Jn).pending}update_pending_count(e){Yt(this,Lt,so).call(this,e),He(this,$r,Z(this,$r)+e),!(!Z(this,dr)||Z(this,Ta))&&(He(this,Ta,!0),Pr(()=>{He(this,Ta,!1),Z(this,dr)&&Oa(Z(this,dr),Z(this,$r))}))}get_effect_pending(){return Z(this,oi).call(this),g(Z(this,dr))}error(e){var r=Z(this,Jn).onerror;let a=Z(this,Jn).failed;if(Z(this,ea)||!r&&!a)throw e;Z(this,Cn)&&(un(Z(this,Cn)),He(this,Cn,null)),Z(this,an)&&(un(Z(this,an)),He(this,an,null)),Z(this,er)&&(un(Z(this,er)),He(this,er,null));var i=!1,o=!1;const c=()=>{if(i){Vf();return}i=!0,o&&jf(),Or.ensure(),He(this,$r,0),Z(this,er)!==null&&ra(Z(this,er),()=>{He(this,er,null)}),this.is_pending=this.has_pending_snippet(),He(this,Cn,Yt(this,Lt,Ws).call(this,()=>(He(this,ea,!1),In(()=>Z(this,Jr).call(this,Z(this,An)))))),Z(this,Ir)>0?Yt(this,Lt,Ys).call(this):this.is_pending=!1};Pr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Pa(d,Z(this,$n)&&Z(this,$n).parent)}a&&He(this,er,Yt(this,Lt,Ws).call(this,()=>{Or.ensure(),He(this,ea,!0);try{return In(()=>{a(Z(this,An),()=>e,()=>c)})}catch(d){return Pa(d,Z(this,$n).parent),null}finally{He(this,ea,!1)}}))})}}An=new WeakMap,xo=new WeakMap,Jn=new WeakMap,Jr=new WeakMap,$n=new WeakMap,Cn=new WeakMap,an=new WeakMap,er=new WeakMap,fr=new WeakMap,Cr=new WeakMap,$r=new WeakMap,Ir=new WeakMap,Ta=new WeakMap,ea=new WeakMap,Ea=new WeakMap,Aa=new WeakMap,dr=new WeakMap,oi=new WeakMap,Lt=new WeakSet,sd=function(){try{He(this,Cn,In(()=>Z(this,Jr).call(this,Z(this,An))))}catch(e){this.error(e)}},id=function(){const e=Z(this,Jn).pending;e&&(He(this,an,In(()=>e(Z(this,An)))),Pr(()=>{var r=Yt(this,Lt,ao).call(this);He(this,Cn,Yt(this,Lt,Ws).call(this,()=>(Or.ensure(),In(()=>Z(this,Jr).call(this,r))))),Z(this,Ir)>0?Yt(this,Lt,Ys).call(this):(ra(Z(this,an),()=>{He(this,an,null)}),this.is_pending=!1)}))},ao=function(){var e=Z(this,An);return this.is_pending&&(He(this,Cr,mr()),Z(this,An).before(Z(this,Cr)),e=Z(this,Cr)),e},Ws=function(e){var r=ot,a=Ze,i=_n;nr(Z(this,$n)),On(Z(this,$n)),Ra(Z(this,$n).ctx);try{return e()}catch(o){return Su(o),null}finally{nr(r),On(a),Ra(i)}},Ys=function(){const e=Z(this,Jn).pending;Z(this,Cn)!==null&&(He(this,fr,document.createDocumentFragment()),Z(this,fr).append(Z(this,Cr)),Qu(Z(this,Cn),Z(this,fr))),Z(this,an)===null&&He(this,an,In(()=>e(Z(this,An))))},so=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Yt(r=this.parent,Lt,so).call(r,e);return}if(He(this,Ir,Z(this,Ir)+e),Z(this,Ir)===0){this.is_pending=!1;for(const a of Z(this,Ea))At(a,Ut),Gn(a);for(const a of Z(this,Aa))At(a,Wn),Gn(a);Z(this,Ea).clear(),Z(this,Aa).clear(),Z(this,an)&&ra(Z(this,an),()=>{He(this,an,null)}),Z(this,fr)&&(Z(this,An).before(Z(this,fr)),He(this,fr,null))}};function od(t,e,r,a){const i=di;var o=t.filter(w=>!w.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var c=Ke,d=ot,h=ld(),v=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(w=>w.promise)):null;function y(w){h();try{a(w)}catch(k){(d.f&hr)===0&&Pa(k,d)}c==null||c.deactivate(),io()}if(r.length===0){v.then(()=>y(e.map(i)));return}function x(){h(),Promise.all(r.map(w=>ud(w))).then(w=>y([...e.map(i),...w])).catch(w=>Pa(w,d))}v?v.then(x):x()}function ld(){var t=ot,e=Ze,r=_n,a=Ke;return function(o=!0){nr(t),On(e),Ra(r),o&&(a==null||a.activate())}}function io(){nr(null),On(null),Ra(null)}function di(t){var e=Kt|Ut,r=Ze!==null&&(Ze.f&Kt)!==0?Ze:null;return ot!==null&&(ot.f|=Ma),{ctx:_n,deps:null,effects:null,equals:bu,f:e,fn:t,reactions:null,rv:0,v:qt,wv:0,parent:r??ot,ac:null}}function ud(t,e,r){let a=ot;a===null&&Af();var i=a.b,o=void 0,c=ia(qt),d=!Ze,h=new Map;return xd(()=>{var k;var v=pu();o=v.promise;try{Promise.resolve(t()).then(v.resolve,v.reject).then(()=>{y===Ke&&y.committed&&y.deactivate(),io()})}catch(M){v.reject(M),io()}var y=Ke;if(d){var x=i.is_rendered();i.update_pending_count(1),y.increment(x),(k=h.get(y))==null||k.reject(Yr),h.delete(y),h.set(y,v)}const w=(M,T=void 0)=>{if(y.activate(),T)T!==Yr&&(c.f|=Rr,Oa(c,T));else{(c.f&Rr)!==0&&(c.f^=Rr),Oa(c,M);for(const[E,F]of h){if(h.delete(E),E===y)break;F.reject(Yr)}}d&&(i.update_pending_count(-1),y.decrement(x))};v.promise.then(w,M=>w(null,M||"unknown"))}),Ku(()=>{for(const v of h.values())v.reject(Yr)}),new Promise(v=>{function y(x){function w(){x===o?v(c):y(o)}x.then(w,w)}y(o)})}function pt(t){const e=di(t);return Zu(e),e}function Ou(t){const e=di(t);return e.equals=wu,e}function cd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)un(e[r])}}function fd(t){for(var e=t.parent;e!==null;){if((e.f&Kt)===0)return(e.f&hr)===0?e:null;e=e.parent}return null}function Ao(t){var e,r=ot;nr(fd(t));try{t.f&=~sa,cd(t),e=tc(t)}finally{nr(r)}return e}function Du(t){var e=Ao(t);if(!t.equals(e)&&(t.wv=$u(),(!(Ke!=null&&Ke.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){At(t,Mt);return}Mr||(Bt!==null?(Io()||Ke!=null&&Ke.is_fork)&&Bt.set(t,e):Eo(t))}function dd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Yr),a.teardown=wf,a.ac=null,ls(a,0),Oo(a))}function Mu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Da(e)}let oo=new Set;const Dr=new Map;let Lu=!1;function ia(t,e){var r={f:0,v:t,reactions:null,equals:bu,rv:0,wv:0};return r}function Oe(t,e){const r=ia(t);return Zu(r),r}function pd(t,e=!1,r=!0){const a=ia(t);return e||(a.equals=wu),a}function N(t,e,r=!1){Ze!==null&&(!Hn||(Ze.f&Tl)!==0)&&ku()&&(Ze.f&(Kt|gr|To|Tl))!==0&&(Pn===null||!Ca.call(Pn,t))&&Nf();let a=r?zt(e):e;return Oa(t,a)}function Oa(t,e){if(!t.equals(e)){var r=t.v;Mr?Dr.set(t,e):Dr.set(t,r),t.v=e;var a=Or.ensure();if(a.capture(t,r),(t.f&Kt)!==0){const i=t;(t.f&Ut)!==0&&Ao(i),Eo(i)}t.wv=$u(),Nu(t,Ut),ot!==null&&(ot.f&Mt)!==0&&(ot.f&(Yn|ca))===0&&(En===null?Td([t]):En.push(t)),!a.is_fork&&oo.size>0&&!Lu&&vd()}return e}function vd(){Lu=!1;for(const t of oo)(t.f&Mt)!==0&&At(t,Wn),ms(t)&&Da(t);oo.clear()}function as(t){N(t,t.v+1)}function Nu(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],c=o.f,d=(c&Ut)===0;if(d&&At(o,e),(c&Kt)!==0){var h=o;Bt==null||Bt.delete(h),(c&sa)===0&&(c&Rn&&(o.f|=sa),Nu(h,Wn))}else d&&((c&gr)!==0&&Bn!==null&&Bn.add(o),Gn(o))}}function zt(t){if(typeof t!="object"||t===null||na in t)return t;const e=du(t);if(e!==_f&&e!==bf)return t;var r=new Map,a=So(t),i=Oe(0),o=aa,c=d=>{if(aa===o)return d();var h=Ze,v=aa;On(null),Pl(o);var y=d();return On(h),Pl(v),y};return a&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,h,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Mf();var y=r.get(h);return y===void 0?c(()=>{var x=Oe(v.value);return r.set(h,x),x}):N(y,v.value,!0),!0},deleteProperty(d,h){var v=r.get(h);if(v===void 0){if(h in d){const y=c(()=>Oe(qt));r.set(h,y),as(i)}}else N(v,qt),as(i);return!0},get(d,h,v){var k;if(h===na)return t;var y=r.get(h),x=h in d;if(y===void 0&&(!x||(k=_a(d,h))!=null&&k.writable)&&(y=c(()=>{var M=zt(x?d[h]:qt),T=Oe(M);return T}),r.set(h,y)),y!==void 0){var w=g(y);return w===qt?void 0:w}return Reflect.get(d,h,v)},getOwnPropertyDescriptor(d,h){var v=Reflect.getOwnPropertyDescriptor(d,h);if(v&&"value"in v){var y=r.get(h);y&&(v.value=g(y))}else if(v===void 0){var x=r.get(h),w=x==null?void 0:x.v;if(x!==void 0&&w!==qt)return{enumerable:!0,configurable:!0,value:w,writable:!0}}return v},has(d,h){var w;if(h===na)return!0;var v=r.get(h),y=v!==void 0&&v.v!==qt||Reflect.has(d,h);if(v!==void 0||ot!==null&&(!y||(w=_a(d,h))!=null&&w.writable)){v===void 0&&(v=c(()=>{var k=y?zt(d[h]):qt,M=Oe(k);return M}),r.set(h,v));var x=g(v);if(x===qt)return!1}return y},set(d,h,v,y){var re;var x=r.get(h),w=h in d;if(a&&h==="length")for(var k=v;k<x.v;k+=1){var M=r.get(k+"");M!==void 0?N(M,qt):k in d&&(M=c(()=>Oe(qt)),r.set(k+"",M))}if(x===void 0)(!w||(re=_a(d,h))!=null&&re.writable)&&(x=c(()=>Oe(void 0)),N(x,zt(v)),r.set(h,x));else{w=x.v!==qt;var T=c(()=>zt(v));N(x,T)}var E=Reflect.getOwnPropertyDescriptor(d,h);if(E!=null&&E.set&&E.set.call(y,v),!w){if(a&&typeof h=="string"){var F=r.get("length"),se=Number(h);Number.isInteger(se)&&se>=F.v&&N(F,se+1)}as(i)}return!0},ownKeys(d){g(i);var h=Reflect.ownKeys(d).filter(x=>{var w=r.get(x);return w===void 0||w.v!==qt});for(var[v,y]of r)y.v!==qt&&!(v in d)&&h.push(v);return h},setPrototypeOf(){Lf()}})}function Al(t){try{if(t!==null&&typeof t=="object"&&na in t)return t[na]}catch{}return t}function hd(t,e){return Object.is(Al(t),Al(e))}var Cl,ju,qu,Bu;function md(){if(Cl===void 0){Cl=window,ju=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;qu=_a(e,"firstChild").get,Bu=_a(e,"nextSibling").get,Sl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Sl(r)&&(r.__t=void 0)}}function mr(t=""){return document.createTextNode(t)}function gn(t){return qu.call(t)}function hs(t){return Bu.call(t)}function _(t,e){return gn(t)}function tt(t,e=!1){{var r=gn(t);return r instanceof Comment&&r.data===""?hs(r):r}}function S(t,e=1,r=!1){let a=t;for(;e--;)a=hs(a);return a}function gd(t){t.textContent=""}function zu(){return!1}function yd(t,e,r){return document.createElementNS(_u,t,void 0)}let Il=!1;function _d(){Il||(Il=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Co(t){var e=Ze,r=ot;On(null),nr(null);try{return t()}finally{On(e),nr(r)}}function Fu(t,e,r,a=r){t.addEventListener(e,()=>Co(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),_d()}function bd(t){ot===null&&(Ze===null&&Pf(),Rf()),Mr&&If()}function wd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function yr(t,e,r){var a=ot;a!==null&&(a.f&yn)!==0&&(t|=yn);var i={ctx:_n,deps:null,nodes:null,f:t|Ut|Rn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Da(i)}catch(d){throw un(i),d}else e!==null&&Gn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ma)===0&&(o=o.first,(t&gr)!==0&&(t&Ia)!==0&&o!==null&&(o.f|=Ia)),o!==null&&(o.parent=a,a!==null&&wd(o,a),Ze!==null&&(Ze.f&Kt)!==0&&(t&ca)===0)){var c=Ze;(c.effects??(c.effects=[])).push(o)}return i}function Io(){return Ze!==null&&!Hn}function Ku(t){const e=yr(ci,null,!1);return At(e,Mt),e.teardown=t,e}function ei(t){bd();var e=ot.f,r=!Ze&&(e&Yn)!==0&&(e&vs)===0;if(r){var a=_n;(a.e??(a.e=[])).push(t)}else return Uu(t)}function Uu(t){return yr(os|xf,t,!1)}function kd(t){Or.ensure();const e=yr(ca|Ma,t,!0);return(r={})=>new Promise(a=>{r.outro?ra(e,()=>{un(e),a(void 0)}):(un(e),a(void 0))})}function Gu(t){return yr(os,t,!1)}function xd(t){return yr(To|Ma,t,!0)}function Ro(t,e=0){return yr(ci|e,t,!0)}function ce(t,e=[],r=[],a=[]){od(a,e,r,i=>{yr(ci,()=>t(...i.map(g)),!0)})}function Po(t,e=0){var r=yr(gr|e,t,!0);return r}function In(t){return yr(Yn|Ma,t,!0)}function Hu(t){var e=t.teardown;if(e!==null){const r=Mr,a=Ze;Rl(!0),On(null);try{e.call(null)}finally{Rl(r),On(a)}}}function Oo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Co(()=>{i.abort(Yr)});var a=r.next;(r.f&ca)!==0?r.parent=null:un(r,e),r=a}}function Sd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Yn)===0&&un(e),e=r}}function un(t,e=!0){var r=!1;(e||(t.f&mu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Wu(t.nodes.start,t.nodes.end),r=!0),Oo(t,e&&!r),ls(t,0),At(t,hr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Hu(t);var i=t.parent;i!==null&&i.first!==null&&Yu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Wu(t,e){for(;t!==null;){var r=t===e?null:hs(t);t.remove(),t=r}}function Yu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ra(t,e,r=!0){var a=[];Vu(t,a,!0);var i=()=>{r&&un(t),e&&e()},o=a.length;if(o>0){var c=()=>--o||i();for(var d of a)d.out(c)}else i()}function Vu(t,e,r){if((t.f&yn)===0){t.f^=yn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Ia)!==0||(i.f&Yn)!==0&&(t.f&gr)!==0;Vu(i,e,c?r:!1),i=o}}}function Do(t){Xu(t,!0)}function Xu(t,e){if((t.f&yn)!==0){t.f^=yn,(t.f&Mt)===0&&(At(t,Ut),Gn(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ia)!==0||(r.f&Yn)!==0;Xu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Qu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:hs(r);e.append(r),r=i}}let Vs=!1,Mr=!1;function Rl(t){Mr=t}let Ze=null,Hn=!1;function On(t){Ze=t}let ot=null;function nr(t){ot=t}let Pn=null;function Zu(t){Ze!==null&&(Pn===null?Pn=[t]:Pn.push(t))}let ln=null,hn=0,En=null;function Td(t){En=t}let Ju=1,Xr=0,aa=Xr;function Pl(t){aa=t}function $u(){return++Ju}function ms(t){var e=t.f;if((e&Ut)!==0)return!0;if(e&Kt&&(t.f&=~sa),(e&Wn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(ms(o)&&Du(o),o.wv>t.wv)return!0}(e&Rn)!==0&&Bt===null&&At(t,Mt)}return!1}function ec(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Pn!==null&&Ca.call(Pn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Kt)!==0?ec(o,e,!1):e===o&&(r?At(o,Ut):(o.f&Mt)!==0&&At(o,Wn),Gn(o))}}function tc(t){var T;var e=ln,r=hn,a=En,i=Ze,o=Pn,c=_n,d=Hn,h=aa,v=t.f;ln=null,hn=0,En=null,Ze=(v&(Yn|ca))===0?t:null,Pn=null,Ra(t.ctx),Hn=!1,aa=++Xr,t.ac!==null&&(Co(()=>{t.ac.abort(Yr)}),t.ac=null);try{t.f|=eo;var y=t.fn,x=y();t.f|=vs;var w=t.deps,k=Ke==null?void 0:Ke.is_fork;if(ln!==null){var M;if(k||ls(t,hn),w!==null&&hn>0)for(w.length=hn+ln.length,M=0;M<ln.length;M++)w[hn+M]=ln[M];else t.deps=w=ln;if(Io()&&(t.f&Rn)!==0)for(M=hn;M<w.length;M++)((T=w[M]).reactions??(T.reactions=[])).push(t)}else!k&&w!==null&&hn<w.length&&(ls(t,hn),w.length=hn);if(ku()&&En!==null&&!Hn&&w!==null&&(t.f&(Kt|Wn|Ut))===0)for(M=0;M<En.length;M++)ec(En[M],t);if(i!==null&&i!==t){if(Xr++,i.deps!==null)for(let E=0;E<r;E+=1)i.deps[E].rv=Xr;if(e!==null)for(const E of e)E.rv=Xr;En!==null&&(a===null?a=En:a.push(...En))}return(t.f&Rr)!==0&&(t.f^=Rr),x}catch(E){return Su(E)}finally{t.f^=eo,ln=e,hn=r,En=a,Ze=i,Pn=o,Ra(c),Hn=d,aa=h}}function Ed(t,e){let r=e.reactions;if(r!==null){var a=mf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Kt)!==0&&(ln===null||!Ca.call(ln,e))){var o=e;(o.f&Rn)!==0&&(o.f^=Rn,o.f&=~sa),Eo(o),dd(o),ls(o,0)}}function ls(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Ed(t,r[a])}function Da(t){var e=t.f;if((e&hr)===0){At(t,Mt);var r=ot,a=Vs;ot=t,Vs=!0;try{(e&(gr|vu))!==0?Sd(t):Oo(t),Hu(t);var i=tc(t);t.teardown=typeof i=="function"?i:null,t.wv=Ju;var o;$i&&Qf&&(t.f&Ut)!==0&&t.deps}finally{Vs=a,ot=r}}}async function nc(){await Promise.resolve(),$f()}function g(t){var e=t.f,r=(e&Kt)!==0;if(Ze!==null&&!Hn){var a=ot!==null&&(ot.f&hr)!==0;if(!a&&(Pn===null||!Ca.call(Pn,t))){var i=Ze.deps;if((Ze.f&eo)!==0)t.rv<Xr&&(t.rv=Xr,ln===null&&i!==null&&i[hn]===t?hn++:ln===null?ln=[t]:ln.push(t));else{(Ze.deps??(Ze.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Ze]:Ca.call(o,Ze)||o.push(Ze)}}}if(Mr&&Dr.has(t))return Dr.get(t);if(r){var c=t;if(Mr){var d=c.v;return((c.f&Mt)===0&&c.reactions!==null||ac(c))&&(d=Ao(c)),Dr.set(c,d),d}var h=(c.f&Rn)===0&&!Hn&&Ze!==null&&(Vs||(Ze.f&Rn)!==0),v=(c.f&vs)===0;ms(c)&&(h&&(c.f|=Rn),Du(c)),h&&!v&&(Mu(c),rc(c))}if(Bt!=null&&Bt.has(t))return Bt.get(t);if((t.f&Rr)!==0)throw t.v;return t.v}function rc(t){if(t.f|=Rn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Kt)!==0&&(e.f&Rn)===0&&(Mu(e),rc(e))}function ac(t){if(t.v===qt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Dr.has(e)||(e.f&Kt)!==0&&ac(e))return!0;return!1}function gs(t){var e=Hn;try{return Hn=!0,t()}finally{Hn=e}}const Ad=["touchstart","touchmove"];function Cd(t){return Ad.includes(t)}const sc=new Set,lo=new Set;function Nt(t){for(var e=0;e<t.length;e++)sc.add(t[e]);for(var r of lo)r(t)}let Ol=null;function Dl(t){var E;var e=this,r=e.ownerDocument,a=t.type,i=((E=t.composedPath)==null?void 0:E.call(t))||[],o=i[0]||t.target;Ol=t;var c=0,d=Ol===t&&t.__root;if(d){var h=i.indexOf(d);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var v=i.indexOf(e);if(v===-1)return;h<=v&&(c=h)}if(o=i[c]||t.target,o!==e){gf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Ze,x=ot;On(null),nr(null);try{for(var w,k=[];o!==null;){var M=o.assignedSlot||o.parentNode||o.host||null;try{var T=o["__"+a];T!=null&&(!o.disabled||t.target===o)&&T.call(o,t)}catch(F){w?k.push(F):w=F}if(t.cancelBubble||M===e||M===null)break;o=M}if(w){for(let F of k)queueMicrotask(()=>{throw F});throw w}}finally{t.__root=e,delete t.currentTarget,On(y),nr(x)}}}var uu,cu;const Fi=(cu=(uu=globalThis==null?void 0:globalThis.window)==null?void 0:uu.trustedTypes)==null?void 0:cu.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Id(t){return(Fi==null?void 0:Fi.createHTML(t))??t}function Mo(t,e=!1){var r=yd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Id(t):t,r.content}function oa(t,e){var r=ot;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function U(t,e){var r=(e&yu)!==0,a=(e&Wf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Mo(o?t:"<!>"+t,!0),r||(i=gn(i)));var c=a||ju?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=gn(c),h=c.lastChild;oa(d,h)}else oa(c,c);return c}}function Rd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&yu)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Mo(o,!0),h=gn(d);if(i)for(c=document.createDocumentFragment();gn(h);)c.appendChild(gn(h));else c=gn(h)}var v=c.cloneNode(!0);if(i){var y=gn(v),x=v.lastChild;oa(y,x)}else oa(v,v);return v}}function Lo(t,e){return Rd(t,e,"svg")}function ti(t=""){{var e=mr(t+"");return oa(e,e),e}}function fa(){var t=document.createDocumentFragment(),e=document.createComment(""),r=mr();return t.append(e,r),oa(e,r),t}function B(t,e){t!==null&&t.before(e)}function Q(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Pd(t,e){return Od(t,e)}const Bs=new Map;function Od(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:c=!0}){md();var d=new Set,h=x=>{for(var w=0;w<x.length;w++){var k=x[w];if(!d.has(k)){d.add(k);var M=Cd(k);for(const F of[e,document]){var T=Bs.get(F);T===void 0&&(T=new Map,Bs.set(F,T));var E=T.get(k);E===void 0?(F.addEventListener(k,Dl,{passive:M}),T.set(k,1)):T.set(k,E+1)}}}};h(ui(sc)),lo.add(h);var v=void 0,y=kd(()=>{var x=r??e.appendChild(mr());return rd(x,{pending:()=>{}},w=>{mt({});var k=_n;o&&(k.c=o),i&&(a.$$events=i),v=t(w,a)||{},gt()}),()=>{var T;for(var w of d)for(const E of[e,document]){var k=Bs.get(E),M=k.get(w);--M==0?(E.removeEventListener(w,Dl),k.delete(w),k.size===0&&Bs.delete(E)):k.set(w,M)}lo.delete(h),x!==r&&((T=x.parentNode)==null||T.removeChild(x))}});return Dd.set(v,y),v}let Dd=new WeakMap;var Fn,tr,mn,ta,ds,ps,li;class Md{constructor(e,r=!0){Ve(this,"anchor");Xe(this,Fn,new Map);Xe(this,tr,new Map);Xe(this,mn,new Map);Xe(this,ta,new Set);Xe(this,ds,!0);Xe(this,ps,()=>{var e=Ke;if(Z(this,Fn).has(e)){var r=Z(this,Fn).get(e),a=Z(this,tr).get(r);if(a)Do(a),Z(this,ta).delete(r);else{var i=Z(this,mn).get(r);i&&(Z(this,tr).set(r,i.effect),Z(this,mn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,c]of Z(this,Fn)){if(Z(this,Fn).delete(o),o===e)break;const d=Z(this,mn).get(c);d&&(un(d.effect),Z(this,mn).delete(c))}for(const[o,c]of Z(this,tr)){if(o===r||Z(this,ta).has(o))continue;const d=()=>{if(Array.from(Z(this,Fn).values()).includes(o)){var v=document.createDocumentFragment();Qu(c,v),v.append(mr()),Z(this,mn).set(o,{effect:c,fragment:v})}else un(c);Z(this,ta).delete(o),Z(this,tr).delete(o)};Z(this,ds)||!a?(Z(this,ta).add(o),ra(c,d,!1)):d()}}});Xe(this,li,e=>{Z(this,Fn).delete(e);const r=Array.from(Z(this,Fn).values());for(const[a,i]of Z(this,mn))r.includes(a)||(un(i.effect),Z(this,mn).delete(a))});this.anchor=e,He(this,ds,r)}ensure(e,r){var a=Ke,i=zu();if(r&&!Z(this,tr).has(e)&&!Z(this,mn).has(e))if(i){var o=document.createDocumentFragment(),c=mr();o.append(c),Z(this,mn).set(e,{effect:In(()=>r(c)),fragment:o})}else Z(this,tr).set(e,In(()=>r(this.anchor)));if(Z(this,Fn).set(a,e),i){for(const[d,h]of Z(this,tr))d===e?a.unskip_effect(h):a.skip_effect(h);for(const[d,h]of Z(this,mn))d===e?a.unskip_effect(h.effect):a.skip_effect(h.effect);a.oncommit(Z(this,ps)),a.ondiscard(Z(this,li))}else Z(this,ps).call(this)}}Fn=new WeakMap,tr=new WeakMap,mn=new WeakMap,ta=new WeakMap,ds=new WeakMap,ps=new WeakMap,li=new WeakMap;function he(t,e,r=!1){var a=new Md(t),i=r?Ia:0;function o(c,d){a.ensure(c,d)}Po(()=>{var c=!1;e((d,h=0)=>{c=!0,o(h,d)}),c||o(!1,null)},i)}function _r(t,e){return e}function Ld(t,e,r){for(var a=[],i=e.length,o,c=e.length,d=0;d<i;d++){let x=e[d];ra(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var w=t.outrogroups;uo(ui(o.done)),w.delete(o),w.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var h=a.length===0&&r!==null;if(h){var v=r,y=v.parentNode;gd(y),y.append(v),t.items.clear()}uo(e,!h)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function uo(t,e=!0){for(var r=0;r<t.length;r++)un(t[r],e)}var Ml;function fn(t,e,r,a,i,o=null){var c=t,d=new Map,h=(e&gu)!==0;if(h){var v=t;c=v.appendChild(mr())}var y=null,x=Ou(()=>{var F=r();return So(F)?F:F==null?[]:ui(F)}),w,k=!0;function M(){E.fallback=y,Nd(E,w,c,e,a),y!==null&&(w.length===0?(y.f&vr)===0?Do(y):(y.f^=vr,ts(y,null,c)):ra(y,()=>{y=null}))}var T=Po(()=>{w=g(x);for(var F=w.length,se=new Set,re=Ke,H=zu(),J=0;J<F;J+=1){var te=w[J],G=a(te,J),me=k?null:d.get(G);me?(me.v&&Oa(me.v,te),me.i&&Oa(me.i,J),H&&re.unskip_effect(me.e)):(me=jd(d,k?c:Ml??(Ml=mr()),te,G,J,i,e,r),k||(me.e.f|=vr),d.set(G,me)),se.add(G)}if(F===0&&o&&!y&&(k?y=In(()=>o(c)):(y=In(()=>o(Ml??(Ml=mr()))),y.f|=vr)),F>se.size&&Cf(),!k)if(H){for(const[Ie,Pe]of d)se.has(Ie)||re.skip_effect(Pe.e);re.oncommit(M),re.ondiscard(()=>{})}else M();g(x)}),E={effect:T,items:d,outrogroups:null,fallback:y};k=!1}function Ya(t){for(;t!==null&&(t.f&Yn)===0;)t=t.next;return t}function Nd(t,e,r,a,i){var Pe,ke,V,le,Ee,$,oe,ue,X;var o=(a&zf)!==0,c=e.length,d=t.items,h=Ya(t.effect.first),v,y=null,x,w=[],k=[],M,T,E,F;if(o)for(F=0;F<c;F+=1)M=e[F],T=i(M,F),E=d.get(T).e,(E.f&vr)===0&&((ke=(Pe=E.nodes)==null?void 0:Pe.a)==null||ke.measure(),(x??(x=new Set)).add(E));for(F=0;F<c;F+=1){if(M=e[F],T=i(M,F),E=d.get(T).e,t.outrogroups!==null)for(const ie of t.outrogroups)ie.pending.delete(E),ie.done.delete(E);if((E.f&vr)!==0)if(E.f^=vr,E===h)ts(E,null,r);else{var se=y?y.next:h;E===t.effect.last&&(t.effect.last=E.prev),E.prev&&(E.prev.next=E.next),E.next&&(E.next.prev=E.prev),Er(t,y,E),Er(t,E,se),ts(E,se,r),y=E,w=[],k=[],h=Ya(y.next);continue}if((E.f&yn)!==0&&(Do(E),o&&((le=(V=E.nodes)==null?void 0:V.a)==null||le.unfix(),(x??(x=new Set)).delete(E))),E!==h){if(v!==void 0&&v.has(E)){if(w.length<k.length){var re=k[0],H;y=re.prev;var J=w[0],te=w[w.length-1];for(H=0;H<w.length;H+=1)ts(w[H],re,r);for(H=0;H<k.length;H+=1)v.delete(k[H]);Er(t,J.prev,te.next),Er(t,y,J),Er(t,te,re),h=re,y=te,F-=1,w=[],k=[]}else v.delete(E),ts(E,h,r),Er(t,E.prev,E.next),Er(t,E,y===null?t.effect.first:y.next),Er(t,y,E),y=E;continue}for(w=[],k=[];h!==null&&h!==E;)(v??(v=new Set)).add(h),k.push(h),h=Ya(h.next);if(h===null)continue}(E.f&vr)===0&&w.push(E),y=E,h=Ya(E.next)}if(t.outrogroups!==null){for(const ie of t.outrogroups)ie.pending.size===0&&(uo(ui(ie.done)),(Ee=t.outrogroups)==null||Ee.delete(ie));t.outrogroups.size===0&&(t.outrogroups=null)}if(h!==null||v!==void 0){var G=[];if(v!==void 0)for(E of v)(E.f&yn)===0&&G.push(E);for(;h!==null;)(h.f&yn)===0&&h!==t.fallback&&G.push(h),h=Ya(h.next);var me=G.length;if(me>0){var Ie=(a&gu)!==0&&c===0?r:null;if(o){for(F=0;F<me;F+=1)(oe=($=G[F].nodes)==null?void 0:$.a)==null||oe.measure();for(F=0;F<me;F+=1)(X=(ue=G[F].nodes)==null?void 0:ue.a)==null||X.fix()}Ld(t,G,Ie)}}o&&Pr(()=>{var ie,pe;if(x!==void 0)for(E of x)(pe=(ie=E.nodes)==null?void 0:ie.a)==null||pe.apply()})}function jd(t,e,r,a,i,o,c,d){var h=(c&qf)!==0?(c&Ff)===0?pd(r,!1,!1):ia(r):null,v=(c&Bf)!==0?ia(i):null;return{v:h,i:v,e:In(()=>(o(e,h??r,v??i,d),()=>{t.delete(a)}))}}function ts(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&vr)===0?e.nodes.start:r;a!==null;){var c=hs(a);if(o.before(a),a===i)return;a=c}}function Er(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function qd(t,e,r=!1,a=!1,i=!1){var o=t,c="";ce(()=>{var d=ot;if(c!==(c=e()??"")&&(d.nodes!==null&&(Wu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var h=c+"";r?h=`<svg>${h}</svg>`:a&&(h=`<math>${h}</math>`);var v=Mo(h);if((r||a)&&(v=gn(v)),oa(gn(v),v.lastChild),r||a)for(;gn(v);)o.before(gn(v));else o.before(v)}})}const Ll=[...` 	
\r\fÂ \v\uFEFF`];function Bd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,c=0;(c=a.indexOf(i,c))>=0;){var d=c+o;(c===0||Ll.includes(a[c-1]))&&(d===a.length||Ll.includes(a[d]))?a=(c===0?"":a.substring(0,c))+a.substring(d+1):c=d}}return a===""?null:a}function Nl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Ki(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function zd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,h=[];a&&h.push(...Object.keys(a).map(Ki)),i&&h.push(...Object.keys(i).map(Ki));var v=0,y=-1;const T=t.length;for(var x=0;x<T;x++){var w=t[x];if(d?w==="/"&&t[x-1]==="*"&&(d=!1):o?o===w&&(o=!1):w==="/"&&t[x+1]==="*"?d=!0:w==='"'||w==="'"?o=w:w==="("?c++:w===")"&&c--,!d&&o===!1&&c===0){if(w===":"&&y===-1)y=x;else if(w===";"||x===T-1){if(y!==-1){var k=Ki(t.substring(v,y).trim());if(!h.includes(k)){w!==";"&&x++;var M=t.substring(v,x).trim();r+=" "+M+";"}}v=x+1,y=-1}}}}return a&&(r+=Nl(a)),i&&(r+=Nl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Pt(t,e,r,a,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Bd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var h in o){var v=!!o[h];(i==null||v!==!!i[h])&&t.classList.toggle(h,v)}return o}function Ui(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function cn(t,e,r,a){var i=t.__style;if(i!==e){var o=zd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Ui(t,r==null?void 0:r[0],a[0]),Ui(t,r==null?void 0:r[1],a[1],"important")):Ui(t,r,a));return a}function ic(t,e,r=!1){if(t.multiple){if(e==null)return;if(!So(e))return Yf();for(var a of t.options)a.selected=e.includes(ss(a));return}for(a of t.options){var i=ss(a);if(hd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Fd(t){var e=new MutationObserver(()=>{ic(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ku(()=>{e.disconnect()})}function No(t,e,r=e){var a=new WeakSet,i=!0;Fu(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),ss);else{var h=t.querySelector(c)??t.querySelector("option:not([disabled])");d=h&&ss(h)}r(d),Ke!==null&&a.add(Ke)}),Gu(()=>{var o=e();if(t===document.activeElement){var c=$s??Ke;if(a.has(c))return}if(ic(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=ss(d),r(o))}t.__value=o,i=!1}),Fd(t)}function ss(t){return"__value"in t?t.__value:t.value}const Kd=Symbol("is custom element"),Ud=Symbol("is html");function oc(t,e,r,a){var i=Gd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Tf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Hd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Gd(t){return t.__attributes??(t.__attributes={[Kd]:t.nodeName.includes("-"),[Ud]:t.namespaceURI===_u})}var jl=new Map;function Hd(t){var e=t.getAttribute("is")||t.nodeName,r=jl.get(e);if(r)return r;jl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=yf(i);for(var c in a)a[c].set&&r.push(c);i=du(i)}return r}function jo(t,e,r=e){var a=new WeakSet;Fu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Gi(t)?Hi(o):o,r(o),Ke!==null&&a.add(Ke),await nc(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,h=t.value.length;if(t.value=o??"",d!==null){var v=t.value.length;c===d&&d===h&&v>h?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=c,t.selectionEnd=Math.min(d,v))}}}),gs(e)==null&&t.value&&(r(Gi(t)?Hi(t.value):t.value),Ke!==null&&a.add(Ke)),Ro(()=>{var i=e();if(t===document.activeElement){var o=$s??Ke;if(a.has(o))return}Gi(t)&&i===Hi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Gi(t){var e=t.type;return e==="number"||e==="range"}function Hi(t){return t===""?null:+t}function ql(t,e){return t===e||(t==null?void 0:t[na])===e}function lc(t={},e,r,a){return Gu(()=>{var i,o;return Ro(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&ql(r(...i),t)&&e(null,...i))})}),()=>{Pr(()=>{o&&ql(r(...o),t)&&e(null,...o)})}}),t}let zs=!1;function Wd(t){var e=zs;try{return zs=!1,[t(),zs]}finally{zs=e}}function Re(t,e,r,a){var se;var i=(r&Gf)!==0,o=(r&Hf)!==0,c=a,d=!0,h=()=>(d&&(d=!1,c=o?gs(a):a),c),v;if(i){var y=na in t||Sf in t;v=((se=_a(t,e))==null?void 0:se.set)??(y&&e in t?re=>t[e]=re:void 0)}var x,w=!1;i?[x,w]=Wd(()=>t[e]):x=t[e],x===void 0&&a!==void 0&&(x=h(),v&&(Df(),v(x)));var k;if(k=()=>{var re=t[e];return re===void 0?h():(d=!0,re)},(r&Uf)===0)return k;if(v){var M=t.$$legacy;return(function(re,H){return arguments.length>0?((!H||M||w)&&v(H?k():re),re):k()})}var T=!1,E=((r&Kf)!==0?di:Ou)(()=>(T=!1,k()));i&&g(E);var F=ot;return(function(re,H){if(arguments.length>0){const J=H?g(E):i?zt(re):re;return N(E,J),T=!0,c!==void 0&&(c=J),re}return Mr&&T||(F.f&hr)!==0?E.v:g(E)})}function Gt(t){_n===null&&Ef(),ei(()=>{const e=gs(t);if(typeof e=="function")return e})}const Yd="5";var fu;typeof window<"u"&&((fu=window.__svelte??(window.__svelte={})).v??(fu.v=new Set)).add(Yd);const us=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let sn=null,pr="idle",Xs=null,Hr=new Set;function Fs(){return sn||(sn=new Worker(new URL(""+new URL("worker-BJ8R2iOv.js",import.meta.url).href,import.meta.url),{type:"module"}),sn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(pr="loading"),e.status==="ready"&&(pr="ready"),e.status==="start"&&(pr="generating"),(e.status==="complete"||e.status==="error")&&(pr=Xs?"ready":"idle");for(const r of Hr)try{r(e)}catch{}})),sn}function uc(){return{check(){Fs().postMessage({type:"check"})},loadModel(t){Xs=t,pr="loading",Fs().postMessage({type:"load",modelId:t})},generate(t,e){Fs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",c=null,d=0,h=0;const v=x=>{switch(x.status){case"start":h=x.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=x.output,c=x.tps??c,d=x.numTokens??d,r)try{r({tps:c,numTokens:d})}catch{}break;case"complete":y(),a({text:o,tps:c,numTokens:d,inputTokens:h});break;case"error":y(),i(new Error(x.data));break}},y=()=>{Hr.delete(v)};Hr.add(v),Fs().postMessage({type:"generate",data:t,options:e})})},interrupt(){sn==null||sn.postMessage({type:"interrupt"})},reset(){sn==null||sn.postMessage({type:"reset"})},onMessage(t){return Hr.add(t),()=>Hr.delete(t)},offMessage(t){Hr.delete(t)},get status(){return pr},get isReady(){return pr==="ready"},get isGenerating(){return pr==="generating"},get modelId(){return Xs},terminate(){sn==null||sn.terminate(),sn=null,pr="idle",Xs=null,Hr.clear()}}}var Vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qs={exports:{}},Qd=Qs.exports,Bl;function Zd(){return Bl||(Bl=1,(function(t,e){((r,a)=>{t.exports=a()})(Qd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,u=arguments.length;l<u;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var u,f=0,p=s.length;f<p;f++)!u&&f in s||((u=u||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(u||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Vd,c=Object.keys,d=Array.isArray;function h(n,s){return typeof s=="object"&&c(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var v=Object.getPrototypeOf,y={}.hasOwnProperty;function x(n,s){return y.call(n,s)}function w(n,s){typeof s=="function"&&(s=s(v(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(s).forEach(function(l){M(n,l,s[l])})}var k=Object.defineProperty;function M(n,s,l,u){k(n,s,h(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function T(n){return{from:function(s){return n.prototype=Object.create(s.prototype),M(n.prototype,"constructor",n),{extend:w.bind(null,n.prototype)}}}}var E=Object.getOwnPropertyDescriptor,F=[].slice;function se(n,s,l){return F.call(n,s,l)}function re(n,s){return s(n)}function H(n){if(!n)throw new Error("Assertion Failed")}function J(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function te(n,s){if(typeof s=="string"&&x(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],u=0,f=s.length;u<f;++u){var p=te(n,s[u]);l.push(p)}return l}var m,b=s.indexOf(".");return b===-1||(m=n[s.substr(0,b)])==null?void 0:te(m,s.substr(b+1))}function G(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){H(typeof l!="string"&&"length"in l);for(var u=0,f=s.length;u<f;++u)G(n,s[u],l[u])}else{var p,m,b=s.indexOf(".");b!==-1?(p=s.substr(0,b),(b=s.substr(b+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:G(m=(m=n[p])&&x(n,p)?m:n[p]={},b,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function me(n){var s,l={};for(s in n)x(n,s)&&(l[s]=n[s]);return l}var Ie=[].concat;function Pe(n){return Ie.apply([],n)}var Y="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pe([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ke=new Set(Y.map(function(n){return o[n]})),V=null;function le(n){return V=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var u=V.get(l);if(u)return u;if(d(l)){u=[],V.set(l,u);for(var f=0,p=l.length;f<p;++f)u.push(s(l[f]))}else if(ke.has(l.constructor))u=l;else{var m,b=v(l);for(m in u=b===Object.prototype?{}:Object.create(b),V.set(l,u),l)x(l,m)&&(u[m]=s(l[m]))}return u})(n),V=null,n}var Ee={}.toString;function $(n){return Ee.call(n).slice(8,-1)}var oe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ue=typeof oe=="symbol"?function(n){var s;return n!=null&&(s=n[oe])&&s.apply(n)}:function(){return null};function X(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ie={};function pe(n){var s,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ie&&typeof n=="string")return[n];if(f=ue(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var _e=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Y=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ct=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Y),ne={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(n,s){this.name=n,this.message=s}function ae(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function be(n,s,l,u){this.failures=s,this.failedKeys=u,this.successCount=l,this.message=ae(n,s)}function de(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=ae(n,this.failures)}T(W).from(Error).extend({toString:function(){return this.name+": "+this.message}}),T(be).from(W),T(de).from(W);var je=ct.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ue=W,ye=ct.reduce(function(n,s){var l=s+"Error";function u(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=ne[s]||l,this.inner=null)}return T(u).from(Ue),n[s]=u,n},{}),Fe=(ye.Syntax=SyntaxError,ye.Type=TypeError,ye.Range=RangeError,Y.reduce(function(n,s){return n[s+"Error"]=ye[s],n},{}));Y=ct.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=ye[s]),n},{});function qe(){}function We(n){return n}function vt(n,s){return n==null||n===We?s:function(l){return s(n(l))}}function lt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Qe(n,s){return n===qe?s:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?lt(u,this.onsuccess):u),f&&(this.onerror=this.onerror?lt(f,this.onerror):f),p!==void 0?p:l}}function it(n,s){return n===qe?s:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?lt(l,this.onsuccess):l),u&&(this.onerror=this.onerror?lt(u,this.onerror):u)}}function _t(n,s){return n===qe?s:function(f){var u=n.apply(this,arguments),f=(h(f,u),this.onsuccess),p=this.onerror,m=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?lt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?lt(p,this.onerror):p),u===void 0?m===void 0?void 0:m:h(u,m)}}function Xt(n,s){return n===qe?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function jt(n,s){return n===qe?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(u,p)})}return s.apply(this,arguments)}}Y.ModifyError=be,Y.DexieError=W,Y.BulkError=de;var Rt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ar(n){Rt=n}var xt={},Qt=100,Ct=typeof Promise>"u"?[]:(ct=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Ct=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(Ct),ct]:[ct,v(ct),ct]),ct=Ct[0],ga=Ct[1],ga=ga&&ga.then,yt=ct&&ct.constructor,dn=!!Ct[2],tn=function(n,s){sr.push([n,s]),nn&&(queueMicrotask(wr),nn=!1)},wn=!0,nn=!0,pn=[],kn=[],Mn=We,Ot={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:qe,pgp:!1,env:{},finalize:qe},Le=Ot,sr=[],Ln=0,pa=[];function Ae(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Le;if(typeof n!="function"){if(n!==xt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&ir(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(u,f){try{f(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var m=u._lib&&kr();p&&typeof p.then=="function"?l(u,function(b,R){p instanceof Ae?p._then(b,R):p.then(b,R)}):(u._state=!0,u._value=p,bs(u)),m&&or()}},ir.bind(null,u))}catch(p){ir(u,p)}})(this,n)}var br={get:function(){var n=Le,s=qr;function l(u,f){var p=this,m=!n.global&&(n!==Le||s!==qr),b=m&&!jn(),R=new Ae(function(q,P){La(p,new _s(C(u,n,m,b),C(f,n,m,b),q,P,n))});return this._consoleTask&&(R._consoleTask=this._consoleTask),R}return l.prototype=xt,l},set:function(n){M(this,"then",n&&n.prototype===xt?br:{get:function(){return n},set:br.set})}};function _s(n,s,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=u,this.psd=f}function ir(n,s){var l,u;kn.push(s),n._state===null&&(l=n._lib&&kr(),s=Mn(s),n._state=!1,n._value=s,u=n,pn.some(function(f){return f._value===u._value})||pn.push(u),bs(n),l)&&or()}function bs(n){var s=n._listeners;n._listeners=[];for(var l=0,u=s.length;l<u;++l)La(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),Ln===0&&(++Ln,tn(function(){--Ln==0&&Lr()},[]))}function La(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++Ln,tn(St,[l,n,s])}}function St(n,s,l){try{var u,f=s._value;!s._state&&kn.length&&(kn=[]),u=Rt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||kn.indexOf(f)!==-1||(p=>{for(var m=pn.length;m;)if(pn[--m]._value===p._value)return pn.splice(m,1)})(s),l.resolve(u)}catch(p){l.reject(p)}finally{--Ln==0&&Lr(),--l.psd.ref||l.psd.finalize()}}function wr(){Ne(Ot,function(){kr()&&or()})}function kr(){var n=wn;return nn=wn=!1,n}function or(){var n,s,l;do for(;0<sr.length;)for(n=sr,sr=[],l=n.length,s=0;s<l;++s){var u=n[s];u[0].apply(null,u[1])}while(0<sr.length);nn=wn=!0}function Lr(){for(var n=pn,s=(pn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),pa.slice(0)),l=s.length;l;)s[--l]()}function Nr(n){return new Ae(xt,!1,n)}function ut(n,s){var l=Le;return function(){var u=kr(),f=Le;try{return qn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{qn(f,!1),u&&or()}}}w(Ae.prototype,{then:br,_then:function(n,s){La(this,new _s(null,null,n,s,Le))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(u){return(u instanceof s?l:Nr)(u)}):this.then(null,function(u){return(u&&u.name===s?l:Nr)(u)}))},finally:function(n){return this.then(function(s){return Ae.resolve(n()).then(function(){return s})},function(s){return Ae.resolve(n()).then(function(){return Nr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ae(function(u,f){var p=setTimeout(function(){return f(new ye.Timeout(s))},n);l.then(u,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(Ae.prototype,Symbol.toStringTag,"Dexie.Promise"),Ot.env=ks(),w(Ae,{all:function(){var n=pe.apply(null,arguments).map(Br);return new Ae(function(s,l){n.length===0&&s([]);var u=n.length;n.forEach(function(f,p){return Ae.resolve(f).then(function(m){n[p]=m,--u||s(n)},l)})})},resolve:function(n){return n instanceof Ae?n:n&&typeof n.then=="function"?new Ae(function(s,l){n.then(s,l)}):new Ae(xt,!0,n)},reject:Nr,race:function(){var n=pe.apply(null,arguments).map(Br);return new Ae(function(s,l){n.map(function(u){return Ae.resolve(u).then(s,l)})})},PSD:{get:function(){return Le},set:function(n){return Le=n}},totalEchoes:{get:function(){return qr}},newPSD:Nn,usePSD:Ne,scheduler:{get:function(){return tn},set:function(n){tn=n}},rejectionMapper:{get:function(){return Mn},set:function(n){Mn=n}},follow:function(n,s){return new Ae(function(l,u){return Nn(function(f,p){var m=Le;m.unhandleds=[],m.onunhandled=p,m.finalize=lt(function(){var b,R=this;b=function(){R.unhandleds.length===0?f():p(R.unhandleds[0])},pa.push(function q(){b(),pa.splice(pa.indexOf(q),1)}),++Ln,tn(function(){--Ln==0&&Lr()},[])},m.finalize),n()},s,l,u)})}}),yt&&(yt.allSettled&&M(Ae,"allSettled",function(){var n=pe.apply(null,arguments).map(Br);return new Ae(function(s){n.length===0&&s([]);var l=n.length,u=new Array(l);n.forEach(function(f,p){return Ae.resolve(f).then(function(m){return u[p]={status:"fulfilled",value:m}},function(m){return u[p]={status:"rejected",reason:m}}).then(function(){return--l||s(u)})})})}),yt.any&&typeof AggregateError<"u"&&M(Ae,"any",function(){var n=pe.apply(null,arguments).map(Br);return new Ae(function(s,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(p,m){return Ae.resolve(p).then(function(b){return s(b)},function(b){f[m]=b,--u||l(new AggregateError(f))})})})}),yt.withResolvers)&&(Ae.withResolvers=yt.withResolvers);var It={awaits:0,echoes:0,id:0},xn=0,Sn=[],jr=0,qr=0,Na=0;function Nn(n,m,l,u){var f=Le,p=Object.create(f),m=(p.parent=f,p.ref=0,p.global=!1,p.id=++Na,Ot.env,p.env=dn?{Promise:Ae,PromiseProp:{value:Ae,configurable:!0,writable:!0},all:Ae.all,race:Ae.race,allSettled:Ae.allSettled,any:Ae.any,resolve:Ae.resolve,reject:Ae.reject}:{},m&&h(p,m),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Ne(p,n,l,u));return p.ref===0&&p.finalize(),m}function Ht(){return It.id||(It.id=++xn),++It.awaits,It.echoes+=Qt,It.id}function jn(){return!!It.awaits&&(--It.awaits==0&&(It.id=0),It.echoes=It.awaits*Qt,!0)}function Br(n){return It.echoes&&n&&n.constructor===yt?(Ht(),n.then(function(s){return jn(),s},function(s){return jn(),xe(s)})):n}function ws(){var n=Sn[Sn.length-1];Sn.pop(),qn(n,!1)}function qn(n,s){var l,u,f=Le;(s?!It.echoes||jr++&&n===Le:!jr||--jr&&n===Le)||queueMicrotask(s?(function(p){++qr,It.echoes&&--It.echoes!=0||(It.echoes=It.awaits=It.id=0),Sn.push(Le),qn(p,!0)}).bind(null,n):ws),n!==Le&&(Le=n,f===Ot&&(Ot.env=ks()),dn)&&(l=Ot.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function ks(){var n=o.Promise;return dn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ne(n,s,l,u,f){var p=Le;try{return qn(n,!0),s(l,u,f)}finally{qn(p,!1)}}function C(n,s,l,u){return typeof n!="function"?n:function(){var f=Le;l&&Ht(),qn(s,!0);try{return n.apply(this,arguments)}finally{qn(f,!1),u&&queueMicrotask(jn)}}}function ge(n){Promise===yt&&It.echoes===0?jr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ga).indexOf("[native code]")===-1&&(Ht=jn=qe);var xe=Ae.reject,nt="ï¿¿",ft="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt="String expected.",Tt=[],rn="__dbnames",Vn="readonly",zr="readwrite";function ht(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var ja={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Fr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=le(s))[n],s}}function Qo(){throw ye.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Je(n,s){try{var l=Zo(n),u=Zo(s);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=Jo(n),p=Jo(s),m=f.length,b=p.length,R=m<b?m:b,q=0;q<R;++q)if(f[q]!==p[q])return f[q]<p[q]?-1:1;return m===b?0:m<b?-1:1;case"Array":for(var P=n,A=s,D=P.length,L=A.length,O=D<L?D:L,I=0;I<O;++I){var z=Je(P[I],A[I]);if(z!==0)return z}return D===L?0:D<L?-1:1}}catch{}return NaN}function Zo(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=$(n))==="ArrayBuffer")?"binary":s}function Jo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function xs(n,s,l){var u=n.schema.yProps;return u?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(u.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}$o.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var u=s.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var qa=$o;function $o(n){this["@@propmod"]=n}function el(n,s){for(var l=c(s),u=l.length,f=!1,p=0;p<u;++p){var m=l[p],b=s[m],R=te(n,m);b instanceof qa?(G(n,m,b.execute(R)),f=!0):R!==b&&(G(n,m,b),f=!0)}return f}dt.prototype._trans=function(n,s,l){var u=this._tx||Le.trans,f=this.name,p=Rt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function m(q,P,A){if(A.schema[f])return s(A.idbtrans,A);throw new ye.NotFound("Table "+f+" not part of transaction")}var b=kr();try{var R=u&&u.db._novip===this.db._novip?u===Le.trans?u._promise(n,m,l):Nn(function(){return u._promise(n,m,l)},{trans:u,transless:Le.transless||Le}):(function q(P,A,D,L){if(P.idbdb&&(P._state.openComplete||Le.letThrough||P._vip)){var O=P._createTransaction(A,D,P._dbSchema);try{O.create(),P._state.PR1398_maxLoop=3}catch(I){return I.name===je.InvalidState&&P.isOpen()&&0<--P._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),P.close({disableAutoOpen:!1}),P.open().then(function(){return q(P,A,D,L)})):xe(I)}return O._promise(A,function(I,z){return Nn(function(){return Le.trans=O,L(I,z,O)})}).then(function(I){if(A==="readwrite")try{O.idbtrans.commit()}catch{}return A==="readonly"?I:O._completion.then(function(){return I})})}if(P._state.openComplete)return xe(new ye.DatabaseClosed(P._state.dbOpenError));if(!P._state.isBeingOpened){if(!P._state.autoOpen)return xe(new ye.DatabaseClosed);P.open().catch(qe)}return P._state.dbReadyPromise.then(function(){return q(P,A,D,L)})})(this.db,n,[this.name],m);return p&&(R._consoleTask=p,R=R.catch(function(q){return console.trace(q),xe(q)})),R}finally{b&&or()}},dt.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?xe(new ye.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},dt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=c(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(b){if(b.compound&&s.every(function(q){return 0<=b.keyPath.indexOf(q)})){for(var R=0;R<s.length;++R)if(s.indexOf(b.keyPath[R])===-1)return!1;return!0}return!1}).sort(function(b,R){return b.keyPath.length-R.keyPath.length})[0];if(l&&this.db._maxKey!==nt)return m=l.keyPath.slice(0,s.length),this.where(m).equals(m.map(function(b){return n[b]}));!l&&Rt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var u=this.schema.idxByName;function f(b,R){return Je(b,R)===0}var m=s.reduce(function(P,R){var q=P[0],P=P[1],A=u[R],D=n[R];return[q||A,q||!A?ht(P,A&&A.multi?function(L){return L=te(L,R),d(L)&&L.some(function(O){return f(D,O)})}:function(L){return f(D,te(L,R))}):P]},[null,null]),p=m[0],m=m[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(m):l?this.filter(m):this.where(s).equals("")},dt.prototype.filter=function(n){return this.toCollection().and(n)},dt.prototype.count=function(n){return this.toCollection().count(n)},dt.prototype.offset=function(n){return this.toCollection().offset(n)},dt.prototype.limit=function(n){return this.toCollection().limit(n)},dt.prototype.each=function(n){return this.toCollection().each(n)},dt.prototype.toArray=function(n){return this.toCollection().toArray(n)},dt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},dt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},dt.prototype.reverse=function(){return this.toCollection().reverse()},dt.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Qo&&(n=(m=>{var b=P,R=m;if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function q(){this.constructor=b}function P(){return m!==null&&m.apply(this,arguments)||this}return r(b,R),b.prototype=R===null?Object.create(R):(q.prototype=R.prototype,new q),Object.defineProperty(P.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),P.prototype.table=function(){return l},P})(n)),new Set),f=n.prototype;f;f=v(f))Object.getOwnPropertyNames(f).forEach(function(m){return u.add(m)});function p(m){if(!m)return m;var b,R=Object.create(n.prototype);for(b in m)if(!u.has(b))try{R[b]=m[b]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},dt.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},dt.prototype.add=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,m=n;return p&&f&&(m=Fr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"add",keys:s!=null?[s]:null,values:[m]})}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{G(n,p,b)}catch{}return b})},dt.prototype.upsert=function(n,s){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var m=p??{};return el(m,s),u&&G(m,u,n),l.core.mutate({trans:f,type:"put",values:[m],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):!!p})})})},dt.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=te(n,this.schema.primKey.keyPath))===void 0?xe(new ye.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},dt.prototype.put=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,m=n;return p&&f&&(m=Fr(p)(n)),this._trans("readwrite",function(b){return l.core.mutate({trans:b,type:"put",values:[m],keys:s!=null?[s]:null})}).then(function(b){return b.numFailures?Ae.reject(b.failures[0]):b.lastResult}).then(function(b){if(p)try{G(n,p,b)}catch{}return b})},dt.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return xs(s,[n],u)}).then(function(u){return u.numFailures?Ae.reject(u.failures[0]):void 0})})},dt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:ja}).then(function(l){return xs(n,null,l)})}).then(function(s){return s.numFailures?Ae.reject(s.failures[0]):void 0})},dt.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return s.hook.reading.fire(f)})})})},dt.prototype.bulkAdd=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(m){var b=u.schema.primKey,q=b.auto,b=b.keyPath;if(b&&f)throw new ye.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ye.InvalidArgument("Arguments objects and keys must have the same length");var R=n.length,q=b&&q?n.map(Fr(b)):n;return u.core.mutate({trans:m,type:"add",keys:f,values:q,wantResults:p}).then(function(P){var A=P.numFailures,D=P.failures;if(A===0)return p?P.results:P.lastResult;throw new de("".concat(u.name,".bulkAdd(): ").concat(A," of ").concat(R," operations failed"),D)})})},dt.prototype.bulkPut=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(m){var b=u.schema.primKey,q=b.auto,b=b.keyPath;if(b&&f)throw new ye.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new ye.InvalidArgument("Arguments objects and keys must have the same length");var R=n.length,q=b&&q?n.map(Fr(b)):n;return u.core.mutate({trans:m,type:"put",keys:f,values:q,wantResults:p}).then(function(P){var A=P.numFailures,D=P.failures;if(A===0)return p?P.results:P.lastResult;throw new de("".concat(u.name,".bulkPut(): ").concat(A," of ").concat(R," operations failed"),D)})})},dt.prototype.bulkUpdate=function(n){var s=this,l=this.core,u=n.map(function(m){return m.key}),f=n.map(function(m){return m.changes}),p=[];return this._trans("readwrite",function(m){return l.getMany({trans:m,keys:u,cache:"clone"}).then(function(b){var R=[],q=[],P=(n.forEach(function(A,D){var L=A.key,O=A.changes,I=b[D];if(I){for(var z=0,K=Object.keys(O);z<K.length;z++){var j=K[z],ee=O[j];if(j===s.schema.primKey.keyPath){if(Je(ee,L)!==0)throw new ye.Constraint("Cannot update primary key in bulkUpdate()")}else G(I,j,ee)}p.push(D),R.push(L),q.push(I)}}),R.length);return l.mutate({trans:m,type:"put",keys:R,values:q,updates:{keys:u,changeSpecs:f}}).then(function(A){var D=A.numFailures,L=A.failures;if(D===0)return P;for(var O=0,I=Object.keys(L);O<I.length;O++){var z,K=I[O],j=p[Number(K)];j!=null&&(z=L[K],delete L[K],L[j]=z)}throw new de("".concat(s.name,".bulkUpdate(): ").concat(D," of ").concat(P," operations failed"),L)})})})},dt.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return xs(s,n,f)})}).then(function(u){var f=u.numFailures,p=u.failures;if(f===0)return u.lastResult;throw new de("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var tl=dt;function dt(){}function Ba(n){function s(m,b){if(b){for(var R=arguments.length,q=new Array(R-1);--R;)q[R-1]=arguments[R];return l[m].subscribe.apply(null,q),n}if(typeof m=="string")return l[m]}var l={};s.addEventType=p;for(var u=1,f=arguments.length;u<f;++u)p(arguments[u]);return s;function p(m,b,R){var q,P;if(typeof m!="object")return b=b||Xt,P={subscribers:[],fire:R=R||qe,subscribe:function(A){P.subscribers.indexOf(A)===-1&&(P.subscribers.push(A),P.fire=b(P.fire,A))},unsubscribe:function(A){P.subscribers=P.subscribers.filter(function(D){return D!==A}),P.fire=P.subscribers.reduce(b,R)}},l[m]=s[m]=P;c(q=m).forEach(function(A){var D=q[A];if(d(D))p(A,q[A][0],q[A][1]);else{if(D!=="asap")throw new ye.InvalidArgument("Invalid event config");var L=p(A,We,function(){for(var O=arguments.length,I=new Array(O);O--;)I[O]=arguments[O];L.subscribers.forEach(function(z){J(function(){z.apply(null,I)})})})}})}}function za(n,s){return T(s).from({prototype:n}),s}function va(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function mi(n,s){n.filter=ht(n.filter,s)}function gi(n,s,l){var u=n.replayFilter;n.replayFilter=u?function(){return ht(u(),s())}:s,n.justLimit=l&&!u}function Ss(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new ye.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function nl(n,s,l){var u=Ss(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function Ts(n,s,l,u){var f,p,m=n.replayFilter?ht(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(b,R,q){var P,A;m&&!m(R,q,function(D){return R.stop(D)},function(D){return R.fail(D)})||((A=""+(P=R.primaryKey))=="[object ArrayBuffer]"&&(A=""+new Uint8Array(P)),x(f,A))||(f[A]=!0,s(b,R,q))},Promise.all([n.or._iterate(p,l),rl(nl(n,u,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):rl(nl(n,u,l),ht(n.algorithm,m),s,!n.keysOnly&&n.valueMapper)}function rl(n,s,l,u){var f=ut(u?function(p,m,b){return l(u(p),m,b)}:l);return n.then(function(p){if(p)return p.start(function(){var m=function(){return p.continue()};s&&!s(p,function(b){return m=b},function(b){p.stop(b),m=qe},function(b){p.fail(b),m=qe})||f(p.value,p,function(b){return m=b}),m()})})}rt.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,xe.bind(null,l.error)):l.table._trans("readonly",n).then(s)},rt.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,xe.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},rt.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=ht(s.algorithm,n)},rt.prototype._iterate=function(n,s){return Ts(this._ctx,n,s,this._ctx.table.core)},rt.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&h(l,n),s._ctx=l,s},rt.prototype.raw=function(){return this._ctx.valueMapper=null,this},rt.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Ts(s,n,l,s.table.core)})},rt.prototype.count=function(n){var s=this;return this._read(function(l){var u,f=s._ctx,p=f.table.core;return va(f,!0)?p.count({trans:l,query:{index:Ss(f,p.schema),range:f.range}}).then(function(m){return Math.min(m,f.limit)}):(u=0,Ts(f,function(){return++u,!1},l,p).then(function(){return u}))}).then(n)},rt.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function p(R,q){return q?p(R[l[q]],q-1):R[u]}var m=this._ctx.dir==="next"?1:-1;function b(R,q){return Je(p(R,f),p(q,f))*m}return this.toArray(function(R){return R.sort(b)}).then(s)},rt.prototype.toArray=function(n){var s=this;return this._read(function(l){var u,f,p,m=s._ctx;return m.dir==="next"&&va(m,!0)&&0<m.limit?(u=m.valueMapper,f=Ss(m,m.table.core.schema),m.table.core.query({trans:l,limit:m.limit,values:!0,query:{index:f,range:m.range}}).then(function(b){return b=b.result,u?b.map(u):b})):(p=[],Ts(m,function(b){return p.push(b)},l,m.table.core).then(function(){return p}))},n)},rt.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,va(s)?gi(s,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):gi(s,function(){var l=n;return function(){return--l<0}})),this},rt.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),gi(this._ctx,function(){var s=n;return function(l,u,f){return--s<=0&&u(f),0<=s}},!0),this},rt.prototype.until=function(n,s){return mi(this._ctx,function(l,u,f){return!n(l.value)||(u(f),s)}),this},rt.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},rt.prototype.last=function(n){return this.reverse().first(n)},rt.prototype.filter=function(n){var s;return mi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=ht(s.isMatch,n),this},rt.prototype.and=function(n){return this.filter(n)},rt.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},rt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},rt.prototype.desc=function(){return this.reverse()},rt.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.key,u)})},rt.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},rt.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},rt.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},rt.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&va(s,!0)&&0<s.limit)return this._read(function(u){var f=Ss(s,s.table.core.schema);return s.table.core.query({trans:u,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(u){return u.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},rt.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},rt.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},rt.prototype.lastKey=function(n){return this.reverse().firstKey(n)},rt.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},mi(this._ctx,function(u){var u=u.primaryKey.toString(),f=x(n,u);return n[u]=!0,!f})),this},rt.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(u){function f(I,z){var K=z.failures;D+=I-z.numFailures;for(var j=0,ee=c(K);j<ee.length;j++){var fe=ee[j];A.push(K[fe])}}var p=typeof n=="function"?n:function(I){return el(I,n)},m=l.table.core,P=m.schema.primaryKey,b=P.outbound,R=P.extractKey,q=200,P=s.db._options.modifyChunkSize,A=(P&&(q=typeof P=="object"?P[m.name]||P["*"]||200:P),[]),D=0,L=[],O=n===al;return s.clone().primaryKeys().then(function(I){function z(j){var ee=Math.min(q,I.length-j),fe=I.slice(j,j+ee);return(O?Promise.resolve([]):m.getMany({trans:u,keys:fe,cache:"immutable"})).then(function(Se){var Te=[],ve=[],De=b?[]:null,Ce=O?fe:[];if(!O)for(var we=0;we<ee;++we){var Me=Se[we],$e={value:le(Me),primKey:I[j+we]};p.call($e,$e.value,$e)!==!1&&($e.value==null?Ce.push(I[j+we]):b||Je(R(Me),R($e.value))===0?(ve.push($e.value),b&&De.push(I[j+we])):(Ce.push(I[j+we]),Te.push($e.value)))}return Promise.resolve(0<Te.length&&m.mutate({trans:u,type:"add",values:Te}).then(function(at){for(var Be in at.failures)Ce.splice(parseInt(Be),1);f(Te.length,at)})).then(function(){return(0<ve.length||K&&typeof n=="object")&&m.mutate({trans:u,type:"put",keys:De,values:ve,criteria:K,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<j}).then(function(at){return f(ve.length,at)})}).then(function(){return(0<Ce.length||K&&O)&&m.mutate({trans:u,type:"delete",keys:Ce,criteria:K,isAdditionalChunk:0<j}).then(function(at){return xs(l.table,Ce,at)}).then(function(at){return f(Ce.length,at)})}).then(function(){return I.length>j+ee&&z(j+q)})})}var K=va(l)&&l.limit===1/0&&(typeof n!="function"||O)&&{index:l.index,range:l.range};return z(0).then(function(){if(0<A.length)throw new be("Error modifying one or more objects",A,D,L);return I.length})})})},rt.prototype.delete=function(){var n=this._ctx,s=n.range;return!va(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(al):this._write(function(l){var u=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(R){var b=R.failures,R=R.numFailures;if(R)throw new be("Could not delete some values",Object.keys(b).map(function(q){return b[q]}),p-R);return p-R})})})};var Yc=rt;function rt(){}var al=function(n,s){return s.value=null};function Vc(n,s){return n<s?-1:n===s?0:1}function Xc(n,s){return s<n?-1:n===s?0:1}function vn(n,s,l){return n=n instanceof il?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function ha(n){return new n.Collection(n,function(){return sl("")}).limit(0)}function Es(L,s,l,u){var f,p,m,b,R,q,P,A=l.length;if(!l.every(function(I){return typeof I=="string"}))return vn(L,bt);function D(I){f=I==="next"?function(K){return K.toUpperCase()}:function(K){return K.toLowerCase()},p=I==="next"?function(K){return K.toLowerCase()}:function(K){return K.toUpperCase()},m=I==="next"?Vc:Xc;var z=l.map(function(K){return{lower:p(K),upper:f(K)}}).sort(function(K,j){return m(K.lower,j.lower)});b=z.map(function(K){return K.upper}),R=z.map(function(K){return K.lower}),P=(q=I)==="next"?"":u}D("next");var L=new L.Collection(L,function(){return xr(b[0],R[A-1]+u)}),O=(L._ondirectionchange=function(I){D(I)},0);return L._addAlgorithm(function(I,z,K){var j=I.key;if(typeof j=="string"){var ee=p(j);if(s(ee,R,O))return!0;for(var fe=null,Se=O;Se<A;++Se){var Te=((ve,De,Ce,we,Me,$e)=>{for(var at=Math.min(ve.length,we.length),Be=-1,Ge=0;Ge<at;++Ge){var wt=De[Ge];if(wt!==we[Ge])return Me(ve[Ge],Ce[Ge])<0?ve.substr(0,Ge)+Ce[Ge]+Ce.substr(Ge+1):Me(ve[Ge],we[Ge])<0?ve.substr(0,Ge)+we[Ge]+Ce.substr(Ge+1):0<=Be?ve.substr(0,Be)+De[Be]+Ce.substr(Be+1):null;Me(ve[Ge],wt)<0&&(Be=Ge)}return at<we.length&&$e==="next"?ve+Ce.substr(ve.length):at<ve.length&&$e==="prev"?ve.substr(0,Ce.length):Be<0?null:ve.substr(0,Be)+we[Be]+Ce.substr(Be+1)})(j,ee,b[Se],R[Se],m,q);Te===null&&fe===null?O=Se+1:(fe===null||0<m(fe,Te))&&(fe=Te)}z(fe!==null?function(){I.continue(fe+P)}:K)}return!1}),L}function xr(n,s,l,u){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:u}}function sl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Dt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Dt.prototype.between=function(n,s,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||u)&&(!l||!u)?ha(this):new this.Collection(this,function(){return xr(n,s,!l,!u)})}catch{return vn(this,ft)}},Dt.prototype.equals=function(n){return n==null?vn(this,ft):new this.Collection(this,function(){return sl(n)})},Dt.prototype.above=function(n){return n==null?vn(this,ft):new this.Collection(this,function(){return xr(n,void 0,!0)})},Dt.prototype.aboveOrEqual=function(n){return n==null?vn(this,ft):new this.Collection(this,function(){return xr(n,void 0,!1)})},Dt.prototype.below=function(n){return n==null?vn(this,ft):new this.Collection(this,function(){return xr(void 0,n,!1,!0)})},Dt.prototype.belowOrEqual=function(n){return n==null?vn(this,ft):new this.Collection(this,function(){return xr(void 0,n)})},Dt.prototype.startsWith=function(n){return typeof n!="string"?vn(this,bt):this.between(n,n+nt,!0,!0)},Dt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Es(this,function(s,l){return s.indexOf(l[0])===0},[n],nt)},Dt.prototype.equalsIgnoreCase=function(n){return Es(this,function(s,l){return s===l[0]},[n],"")},Dt.prototype.anyOfIgnoreCase=function(){var n=pe.apply(ie,arguments);return n.length===0?ha(this):Es(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Dt.prototype.startsWithAnyOfIgnoreCase=function(){var n=pe.apply(ie,arguments);return n.length===0?ha(this):Es(this,function(s,l){return l.some(function(u){return s.indexOf(u)===0})},n,nt)},Dt.prototype.anyOf=function(){var n,s,l=this,u=pe.apply(ie,arguments),f=this._cmp;try{u.sort(f)}catch{return vn(this,ft)}return u.length===0?ha(this):((n=new this.Collection(this,function(){return xr(u[0],u[u.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,u.sort(f)},s=0,n._addAlgorithm(function(p,m,b){for(var R=p.key;0<f(R,u[s]);)if(++s===u.length)return m(b),!1;return f(R,u[s])===0||(m(function(){p.continue(u[s])}),!1)}),n)},Dt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Dt.prototype.noneOf=function(){var n=pe.apply(ie,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return vn(this,ft)}var s=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Dt.prototype.inAnyRange=function(n,K){var l=this,u=this._cmp,f=this._ascending,p=this._descending,m=this._min,b=this._max;if(n.length===0)return ha(this);if(!n.every(function(j){return j[0]!==void 0&&j[1]!==void 0&&f(j[0],j[1])<=0}))return vn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ye.InvalidArgument);var R=!K||K.includeLowers!==!1,q=K&&K.includeUppers===!0,P,A=f;function D(j,ee){return A(j[0],ee[0])}try{(P=n.reduce(function(j,ee){for(var fe=0,Se=j.length;fe<Se;++fe){var Te=j[fe];if(u(ee[0],Te[1])<0&&0<u(ee[1],Te[0])){Te[0]=m(Te[0],ee[0]),Te[1]=b(Te[1],ee[1]);break}}return fe===Se&&j.push(ee),j},[])).sort(D)}catch{return vn(this,ft)}var L=0,O=q?function(j){return 0<f(j,P[L][1])}:function(j){return 0<=f(j,P[L][1])},I=R?function(j){return 0<p(j,P[L][0])}:function(j){return 0<=p(j,P[L][0])},z=O,K=new this.Collection(this,function(){return xr(P[0][0],P[P.length-1][1],!R,!q)});return K._ondirectionchange=function(j){A=j==="next"?(z=O,f):(z=I,p),P.sort(D)},K._addAlgorithm(function(j,ee,fe){for(var Se,Te=j.key;z(Te);)if(++L===P.length)return ee(fe),!1;return!O(Se=Te)&&!I(Se)||(l._cmp(Te,P[L][1])===0||l._cmp(Te,P[L][0])===0||ee(function(){A===f?j.continue(P[L][0]):j.continue(P[L][1])}),!1)}),K},Dt.prototype.startsWithAnyOf=function(){var n=pe.apply(ie,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?ha(this):this.inAnyRange(n.map(function(s){return[s,s+nt]})):vn(this,"startsWithAnyOf() only works with strings")};var il=Dt;function Dt(){}function Xn(n){return ut(function(s){return Fa(s),n(s.target.error),!1})}function Fa(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Ka="storagemutated",yi="x-storagemutated-1",Sr=Ba(null,Ka),Qc=(Qn.prototype._lock=function(){return H(!Le.global),++this._reculock,this._reculock!==1||Le.global||(Le.lockOwnerFor=this),this},Qn.prototype._unlock=function(){if(H(!Le.global),--this._reculock==0)for(Le.global||(Le.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ne(n[1],n[0])}catch{}}return this},Qn.prototype._locked=function(){return this._reculock&&Le.lockOwnerFor!==this},Qn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(H(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new ye.DatabaseClosed(u);case"MissingAPIError":throw new ye.MissingAPI(u.message,u);default:throw new ye.OpenFailed(u)}if(!this.active)throw new ye.TransactionInactive;H(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ut(function(f){Fa(f),s._reject(n.error)}),n.onabort=ut(function(f){Fa(f),s.active&&s._reject(new ye.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=ut(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Sr.storagemutated.fire(n.mutatedParts)})}return this},Qn.prototype._promise=function(n,s,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?xe(new ye.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ae(function(p,m){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,m)},Le])}):l?Nn(function(){var p=new Ae(function(m,b){f._lock();var R=s(m,b,f);R&&R.then&&R.then(m,b)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((u=new Ae(function(p,m){var b=s(p,m,f);b&&b.then&&b.then(p,m)}))._lib=!0,u):xe(new ye.TransactionInactive)},Qn.prototype._root=function(){return this.parent?this.parent._root():this},Qn.prototype.waitFor=function(n){var s,l=this._root(),u=Ae.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ae(function(p,m){u.then(function(b){return l._waitingQueue.push(ut(p.bind(null,b)))},function(b){return l._waitingQueue.push(ut(m.bind(null,b)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Qn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ye.Abort))},Qn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(x(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new ye.NotFound("Table "+n+" not part of transaction")},Qn);function Qn(){}function _i(n,s,l,u,f,p,m,b){return{name:n,keyPath:s,unique:l,multi:u,auto:f,compound:p,src:(l&&!m?"&":"")+(u?"*":"")+(f?"++":"")+ol(s),type:b}}function ol(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function bi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,p,m){return p=u(p,m),p&&(f[p[0]]=p[1]),f},{}))};var u}var Ua=function(n){try{return n.only([[]]),Ua=function(){return[[]]},[[]]}catch{return Ua=function(){return nt},nt}};function wi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return te(l,s)}:function(l){return te(l,n)};var s}function ll(n){return[].slice.call(n)}var Zc=0;function Ga(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Jc(n,s,R){function u(O){if(O.type===3)return null;if(O.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var A=O.lower,D=O.upper,L=O.lowerOpen,O=O.upperOpen;return A===void 0?D===void 0?null:s.upperBound(D,!!O):D===void 0?s.lowerBound(A,!!L):s.bound(A,D,!!L,!!O)}function f(P){var A,D=P.name;return{name:D,schema:P,mutate:function(L){var O=L.trans,I=L.type,z=L.keys,K=L.values,j=L.range;return new Promise(function(ee,fe){ee=ut(ee);var Se=O.objectStore(D),Te=Se.keyPath==null,ve=I==="put"||I==="add";if(!ve&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var De,Ce=(z||K||{length:1}).length;if(z&&K&&z.length!==K.length)throw new Error("Given keys array must have same length as given values array.");if(Ce===0)return ee({numFailures:0,failures:{},results:[],lastResult:void 0});function we(kt){++at,Fa(kt)}var Me=[],$e=[],at=0;if(I==="deleteRange"){if(j.type===4)return ee({numFailures:at,failures:$e,results:[],lastResult:void 0});j.type===3?Me.push(De=Se.clear()):Me.push(De=Se.delete(u(j)))}else{var Te=ve?Te?[K,z]:[K,null]:[z,null],Be=Te[0],Ge=Te[1];if(ve)for(var wt=0;wt<Ce;++wt)Me.push(De=Ge&&Ge[wt]!==void 0?Se[I](Be[wt],Ge[wt]):Se[I](Be[wt])),De.onerror=we;else for(wt=0;wt<Ce;++wt)Me.push(De=Se[I](Be[wt])),De.onerror=we}function Tn(kt){kt=kt.target.result,Me.forEach(function(Gr,Bi){return Gr.error!=null&&($e[Bi]=Gr.error)}),ee({numFailures:at,failures:$e,results:I==="delete"?z:Me.map(function(Gr){return Gr.result}),lastResult:kt})}De.onerror=function(kt){we(kt),Tn(kt)},De.onsuccess=Tn})},getMany:function(L){var O=L.trans,I=L.keys;return new Promise(function(z,K){z=ut(z);for(var j,ee=O.objectStore(D),fe=I.length,Se=new Array(fe),Te=0,ve=0,De=function(Me){Me=Me.target,Se[Me._pos]=Me.result,++ve===Te&&z(Se)},Ce=Xn(K),we=0;we<fe;++we)I[we]!=null&&((j=ee.get(I[we]))._pos=we,j.onsuccess=De,j.onerror=Ce,++Te);Te===0&&z(Se)})},get:function(L){var O=L.trans,I=L.key;return new Promise(function(z,K){z=ut(z);var j=O.objectStore(D).get(I);j.onsuccess=function(ee){return z(ee.target.result)},j.onerror=Xn(K)})},query:(A=b,function(L){return new Promise(function(O,I){O=ut(O);var z,K,j,ve=L.trans,ee=L.values,fe=L.limit,Te=L.query,Se=fe===1/0?void 0:fe,De=Te.index,Te=Te.range,ve=ve.objectStore(D),ve=De.isPrimaryKey?ve:ve.index(De.name),De=u(Te);if(fe===0)return O({result:[]});A?((Te=ee?ve.getAll(De,Se):ve.getAllKeys(De,Se)).onsuccess=function(Ce){return O({result:Ce.target.result})},Te.onerror=Xn(I)):(z=0,K=!ee&&"openKeyCursor"in ve?ve.openKeyCursor(De):ve.openCursor(De),j=[],K.onsuccess=function(Ce){var we=K.result;return!we||(j.push(ee?we.value:we.primaryKey),++z===fe)?O({result:j}):void we.continue()},K.onerror=Xn(I))})}),openCursor:function(L){var O=L.trans,I=L.values,z=L.query,K=L.reverse,j=L.unique;return new Promise(function(ee,fe){ee=ut(ee);var ve=z.index,Se=z.range,Te=O.objectStore(D),Te=ve.isPrimaryKey?Te:Te.index(ve.name),ve=K?j?"prevunique":"prev":j?"nextunique":"next",De=!I&&"openKeyCursor"in Te?Te.openKeyCursor(u(Se),ve):Te.openCursor(u(Se),ve);De.onerror=Xn(fe),De.onsuccess=ut(function(Ce){var we,Me,$e,at,Be=De.result;Be?(Be.___id=++Zc,Be.done=!1,we=Be.continue.bind(Be),Me=(Me=Be.continuePrimaryKey)&&Me.bind(Be),$e=Be.advance.bind(Be),at=function(){throw new Error("Cursor not stopped")},Be.trans=O,Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=function(){throw new Error("Cursor not started")},Be.fail=ut(fe),Be.next=function(){var Ge=this,wt=1;return this.start(function(){return wt--?Ge.continue():Ge.stop()}).then(function(){return Ge})},Be.start=function(Ge){function wt(){if(De.result)try{Ge()}catch(kt){Be.fail(kt)}else Be.done=!0,Be.start=function(){throw new Error("Cursor behind last entry")},Be.stop()}var Tn=new Promise(function(kt,Gr){kt=ut(kt),De.onerror=Xn(Gr),Be.fail=Gr,Be.stop=function(Bi){Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=at,kt(Bi)}});return De.onsuccess=ut(function(kt){De.onsuccess=wt,wt()}),Be.continue=we,Be.continuePrimaryKey=Me,Be.advance=$e,wt(),Tn},ee(Be)):ee(null)},fe)})},count:function(L){var O=L.query,I=L.trans,z=O.index,K=O.range;return new Promise(function(j,ee){var fe=I.objectStore(D),fe=z.isPrimaryKey?fe:fe.index(z.name),Se=u(K),Se=Se?fe.count(Se):fe.count();Se.onsuccess=ut(function(Te){return j(Te.target.result)}),Se.onerror=Xn(ee)})}}}p=R,m=ll((R=n).objectStoreNames);var p,R={schema:{name:R.name,tables:m.map(function(P){return p.objectStore(P)}).map(function(P){var A=P.keyPath,D=P.autoIncrement,O=d(A),L={},O={name:P.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:A==null,compound:O,keyPath:A,autoIncrement:D,unique:!0,extractKey:wi(A)},indexes:ll(P.indexNames).map(function(I){return P.index(I)}).map(function(j){var ee=j.name,z=j.unique,K=j.multiEntry,j=j.keyPath,ee={name:ee,compound:d(j),keyPath:j,unique:z,multiEntry:K,extractKey:wi(j)};return L[Ga(j)]=ee}),getIndexByKeyPath:function(I){return L[Ga(I)]}};return L[":id"]=O.primaryKey,A!=null&&(L[Ga(A)]=O.primaryKey),O})},hasGetAll:0<m.length&&"getAll"in p.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},m=R.schema,b=R.hasGetAll,R=m.tables.map(f),q={};return R.forEach(function(P){return q[P.name]=P}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(P){if(q[P])return q[P];throw new Error("Table '".concat(P,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ua(s),schema:m}}function $c(n,s,l,u){return l=l.IDBKeyRange,s=Jc(s,l,u),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function As(n,s){var l=s.db,l=$c(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(p){return p.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function Cs(n,s,l,u){l.forEach(function(f){var p=u[f];s.forEach(function(m){var b=(function R(q,P){return E(q,P)||(q=v(q))&&R(q,P)})(m,f);(!b||"value"in b&&b.value===void 0)&&(m===n.Transaction.prototype||m instanceof n.Transaction?M(m,f,{get:function(){return this.table(f)},set:function(R){k(this,f,{value:R,writable:!0,configurable:!0,enumerable:!0})}}):m[f]=new n.Table(f,p))})})}function ki(n,s){s.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function ef(n,s){return n._cfg.version-s._cfg.version}function tf(n,s,l,u){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=bi("$meta",cl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),m=(p.create(l),p._completion.catch(u),p._reject.bind(p)),b=Le.transless||Le;Nn(function(){if(Le.trans=p,Le.transless=b,s!==0)return As(n,l),q=s,((R=p).storeNames.includes("$meta")?R.table("$meta").get("version").then(function(P){return P??q}):Ae.resolve(q)).then(function(z){var A=n,D=z,L=p,O=l,I=[],z=A._versions,K=A._dbSchema=Rs(0,A.idbdb,O);return(z=z.filter(function(j){return j._cfg.version>=D})).length===0?Ae.resolve():(z.forEach(function(j){I.push(function(){var ee,fe,Se,Te=K,ve=j._cfg.dbschema,De=(Ps(A,Te,O),Ps(A,ve,O),K=A._dbSchema=ve,xi(Te,ve)),Ce=(De.add.forEach(function(we){Si(O,we[0],we[1].primKey,we[1].indexes)}),De.change.forEach(function(we){if(we.recreate)throw new ye.Upgrade("Not yet support for changing primary key");var Me=O.objectStore(we.name);we.add.forEach(function($e){return Is(Me,$e)}),we.change.forEach(function($e){Me.deleteIndex($e.name),Is(Me,$e)}),we.del.forEach(function($e){return Me.deleteIndex($e)})}),j._cfg.contentUpgrade);if(Ce&&j._cfg.version>D)return As(A,O),L._memoizedTables={},ee=me(ve),De.del.forEach(function(we){ee[we]=Te[we]}),ki(A,[A.Transaction.prototype]),Cs(A,[A.Transaction.prototype],c(ee),ee),L.schema=ee,(fe=_e(Ce))&&Ht(),ve=Ae.follow(function(){var we;(Se=Ce(L))&&fe&&(we=jn.bind(null,null),Se.then(we,we))}),Se&&typeof Se.then=="function"?Ae.resolve(Se):ve.then(function(){return Se})}),I.push(function(ee){var fe,Se,Te=j._cfg.dbschema;fe=Te,Se=ee,[].slice.call(Se.db.objectStoreNames).forEach(function(ve){return fe[ve]==null&&Se.db.deleteObjectStore(ve)}),ki(A,[A.Transaction.prototype]),Cs(A,[A.Transaction.prototype],A._storeNames,A._dbSchema),L.schema=A._dbSchema}),I.push(function(ee){A.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(A.idbdb.version/10)===j._cfg.version?(A.idbdb.deleteObjectStore("$meta"),delete A._dbSchema.$meta,A._storeNames=A._storeNames.filter(function(fe){return fe!=="$meta"})):ee.objectStore("$meta").put(j._cfg.version,"version"))})}),(function j(){return I.length?Ae.resolve(I.shift()(L.idbtrans)).then(j):Ae.resolve()})().then(function(){ul(K,O)}))}).catch(m);var R,q;c(f).forEach(function(P){Si(l,P,f[P].primKey,f[P].indexes)}),As(n,l),Ae.follow(function(){return n.on.populate.fire(p)}).catch(m)})}function nf(n,s){ul(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Rs(0,n.idbdb,s);Ps(n,n._dbSchema,s);for(var u=0,f=xi(l,n._dbSchema).change;u<f.length;u++){var p=(m=>{if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=s.objectStore(m.name);m.add.forEach(function(R){Rt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(R.src)),Is(b,R)})})(f[u]);if(typeof p=="object")return p.value}}function xi(n,s){var l,u={del:[],add:[],change:[]};for(l in n)s[l]||u.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var m={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)m.recreate=!0,u.change.push(m);else{var b=f.idxByName,R=p.idxByName,q=void 0;for(q in b)R[q]||m.del.push(q);for(q in R){var P=b[q],A=R[q];P?P.src!==A.src&&m.change.push(A):m.add.push(A)}(0<m.del.length||0<m.add.length||0<m.change.length)&&u.change.push(m)}}else u.add.push([l,p])}return u}function Si(n,s,l,u){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(p){return Is(f,p)})}function ul(n,s){c(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(Rt&&console.debug("Dexie: Creating missing table",l),Si(s,l,n[l].primKey,n[l].indexes))})}function Is(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Rs(n,s,l){var u={};return se(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),m=_i(ol(q=p.keyPath),q||"",!0,!1,!!p.autoIncrement,q&&typeof q!="string",!0),b=[],R=0;R<p.indexNames.length;++R){var P=p.index(p.indexNames[R]),q=P.keyPath,P=_i(P.name,q,!!P.unique,!!P.multiEntry,!1,q&&typeof q!="string",!1);b.push(P)}u[f]=bi(f,m,b)}),u}function Ps(n,s,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var p=u[f],m=l.objectStore(p);n._hasGetAll="getAll"in m;for(var b=0;b<m.indexNames.length;++b){var R,q=m.indexNames[b],P=m.index(q).keyPath,P=typeof P=="string"?P:"["+se(P).join("+")+"]";s[p]&&(R=s[p].idxByName[P])&&(R.name=q,delete s[p].idxByName[P],s[p].idxByName[q]=R)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function cl(n){return n.split(",").map(function(s,l){var f=s.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return _i(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,u)})}ma.prototype._createTableSchema=bi,ma.prototype._parseIndexSyntax=cl,ma.prototype._parseStoresSpec=function(n,s){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),p=f.shift();if(!p)throw new ye.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new ye.Schema("Primary key cannot be multiEntry*");f.forEach(function(m){if(m.auto)throw new ye.Schema("Only primary key can be marked as autoIncrement (++)");if(!m.keyPath)throw new ye.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(u,p,f),s[u]=p}})},ma.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,l):l,s._versions),u={},f={};return l.forEach(function(p){h(u,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(u,f)}),s._dbSchema=f,ki(s,[s._allTables,s,s.Transaction.prototype]),Cs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],c(f),f),s._storeNames=c(f),this},ma.prototype.upgrade=function(n){return this._cfg.contentUpgrade=jt(this._cfg.contentUpgrade||qe,n),this};var rf=ma;function ma(){}function Ti(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new lr(rn,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ei(n){return n&&typeof n.databases=="function"}function Ai(n){return Nn(function(){return Le.letThrough=!0,n()})}function Ci(n){return!("from"in n)}var Wt=function(n,s){var l;if(!this)return l=new Wt,n&&"d"in n&&h(l,n),l;h(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ha(n,s,l){var u=Je(s,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Ci(n))return h(n,{from:s,to:l,d:1});var u=n.l,f=n.r;if(Je(l,n.from)<0)return u?Ha(u,s,l):n.l={from:s,to:l,d:1,l:null,r:null},dl(n);if(0<Je(s,n.to))return f?Ha(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},dl(n);Je(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Je(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,u&&!n.l&&Wa(n,u),f&&s&&Wa(n,f)}}function Wa(n,s){Ci(s)||(function l(u,f){var p=f.from,m=f.l,b=f.r;Ha(u,p,f.to),m&&l(u,m),b&&l(u,b)})(n,s)}function fl(n,s){var l=Os(s),u=l.next();if(!u.done)for(var f=u.value,p=Os(n),m=p.next(f.from),b=m.value;!u.done&&!m.done;){if(Je(b.from,f.to)<=0&&0<=Je(b.to,f.from))return!0;Je(f.from,b.from)<0?f=(u=l.next(b.from)).value:b=(m=p.next(f.from)).value}return!1}function Os(n){var s=Ci(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,u)for(;s.n.l&&Je(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!u||Je(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function dl(n){var s,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[s],(n[s]=l).d=pl(l)),n.d=pl(n)}function pl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Ds(n,s){return c(s).forEach(function(l){n[l]?Wa(n[l],s[l]):n[l]=(function u(f){var p,m,b={};for(p in f)x(f,p)&&(m=f[p],b[p]=!m||typeof m!="object"||ke.has(m.constructor)?m:u(m));return b})(s[l])}),n}function Ii(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&fl(s[l],n[l])})}w(Wt.prototype,((ct={add:function(n){return Wa(this,n),this},addKey:function(n){return Ha(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ha(s,l,l)}),this},hasKey:function(n){var s=Os(this).next(n).value;return s&&Je(s.from,n)<=0&&0<=Je(s.to,n)}})[oe]=function(){return Os(this)},ct));var Kr={},Ri={},Pi=!1;function Ms(n){Ds(Ri,n),Pi||(Pi=!0,setTimeout(function(){Pi=!1,Oi(Ri,!(Ri={}))},0))}function Oi(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Kr);u<f.length;u++)vl(b=f[u],n,l,s);else for(var p in n){var m,b,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(m=p[1],p=p[2],b=Kr["idb://".concat(m,"/").concat(p)])&&vl(b,n,l,s)}l.forEach(function(R){return R()})}function vl(n,s,l,u){for(var f=[],p=0,m=Object.entries(n.queries.query);p<m.length;p++){for(var b=m[p],R=b[0],q=[],P=0,A=b[1];P<A.length;P++){var D=A[P];Ii(s,D.obsSet)?D.subscribers.forEach(function(z){return l.add(z)}):u&&q.push(D)}u&&f.push([R,q])}if(u)for(var L=0,O=f;L<O.length;L++){var I=O[L],R=I[0],q=I[1];n.queries.query[R]=q}}function af(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?xe(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var u=s.openCanceller,f=Math.round(10*n.verno),p=!1;function m(){if(s.openCanceller!==u)throw new ye.DatabaseClosed("db.open() was cancelled")}function b(){return new Ae(function(D,L){if(m(),!l)throw new ye.MissingAPI;var O=n.name,I=s.autoSchema||!f?l.open(O):l.open(O,f);if(!I)throw new ye.MissingAPI;I.onerror=Xn(L),I.onblocked=ut(n._fireOnBlocked),I.onupgradeneeded=ut(function(z){var K;P=I.transaction,s.autoSchema&&!n._options.allowEmptyDB?(I.onerror=Fa,P.abort(),I.result.close(),(K=l.deleteDatabase(O)).onsuccess=K.onerror=ut(function(){L(new ye.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(P.onerror=Xn(L),K=z.oldVersion>Math.pow(2,62)?0:z.oldVersion,A=K<1,n.idbdb=I.result,p&&nf(n,P),tf(n,K/10,P,L))},L),I.onsuccess=ut(function(){P=null;var z,K,j,ee,fe,Se,Te=n.idbdb=I.result,ve=se(Te.objectStoreNames);if(0<ve.length)try{var De=Te.transaction((fe=ve).length===1?fe[0]:fe,"readonly");if(s.autoSchema)Se=Te,ee=De,(j=n).verno=Se.version/10,ee=j._dbSchema=Rs(0,Se,ee),j._storeNames=se(Se.objectStoreNames,0),Cs(j,[j._allTables],c(ee),ee);else if(Ps(n,n._dbSchema,De),K=De,((K=xi(Rs(0,(z=n).idbdb,K),z._dbSchema)).add.length||K.change.some(function(Ce){return Ce.add.length||Ce.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Te.close(),f=Te.version+1,p=!0,D(b());As(n,De)}catch{}Tt.push(n),Te.onversionchange=ut(function(Ce){s.vcFired=!0,n.on("versionchange").fire(Ce)}),Te.onclose=ut(function(){n.close({disableAutoOpen:!1})}),A&&(ve=n._deps,fe=O,Ei(Se=ve.indexedDB)||fe===rn||Ti(Se,ve.IDBKeyRange).put({name:fe}).catch(qe)),D()},L)}).catch(function(D){switch(D==null?void 0:D.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(0<f)return f=0,b()}return Ae.reject(D)})}var R,q=s.dbReadyResolve,P=null,A=!1;return Ae.race([u,(typeof navigator>"u"?Ae.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function L(){return indexedDB.databases().finally(D)}R=setInterval(L,100),L()}).finally(function(){return clearInterval(R)}):Promise.resolve()).then(b)]).then(function(){return m(),s.onReadyBeingFired=[],Ae.resolve(Ai(function(){return n.on.ready.fire(n.vip)})).then(function D(){var L;if(0<s.onReadyBeingFired.length)return L=s.onReadyBeingFired.reduce(jt,qe),s.onReadyBeingFired=[],Ae.resolve(Ai(function(){return L(n.vip)})).then(D)})}).finally(function(){s.openCanceller===u&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(D){s.dbOpenError=D;try{P&&P.abort()}catch{}return u===s.openCanceller&&n._close(),xe(D)}).finally(function(){s.openComplete=!0,q()}).then(function(){var D;return A&&(D={},n.tables.forEach(function(L){L.schema.indexes.forEach(function(O){O.name&&(D["idb://".concat(n.name,"/").concat(L.name,"/").concat(O.name)]=new Wt(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(L.name,"/")]=D["idb://".concat(n.name,"/").concat(L.name,"/:dels")]=new Wt(-1/0,[[[]]])}),Sr(Ka).fire(D),Oi(D,!0)),n})}function Di(n){function s(p){return n.next(p)}var l=f(s),u=f(function(p){return n.throw(p)});function f(p){return function(b){var b=p(b),R=b.value;return b.done?R:R&&typeof R.then=="function"?R.then(l,u):d(R)?Promise.all(R).then(l,u):l(R)}}return f(s)()}function Ls(n,s,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(s);return u}var sf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},p=[];function m(D,L,O){var j=Ga(D),I=f[j]=f[j]||[],z=D==null?0:typeof D=="string"?1:D.length,K=0<L,j=a(a({},O),{name:K?"".concat(j,"(virtual-from:").concat(O.name,")"):O.name,lowLevelIndex:O,isVirtual:K,keyTail:L,keyLength:z,extractKey:wi(D),unique:!K&&O.unique});return I.push(j),j.isPrimaryKey||p.push(j),1<z&&m(z===2?D[0]:D.slice(0,z-1),L+1,O),I.sort(function(ee,fe){return ee.keyTail-fe.keyTail}),j}var b=m(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[b];for(var R=0,q=u.indexes;R<q.length;R++){var P=q[R];m(P.keyPath,0,P)}function A(D){var L,O=D.query.index;return O.isVirtual?a(a({},D),{query:{index:O.lowLevelIndex,range:(L=D.query.range,O=O.keyTail,{type:L.type===1?2:L.type,lower:Ls(L.lower,L.lowerOpen?n.MAX_KEY:n.MIN_KEY,O),lowerOpen:!0,upper:Ls(L.upper,L.upperOpen?n.MIN_KEY:n.MAX_KEY,O),upperOpen:!0})}}):D}return a(a({},l),{schema:a(a({},u),{primaryKey:b,indexes:p,getIndexByKeyPath:function(D){return(D=f[Ga(D)])&&D[0]}}),count:function(D){return l.count(A(D))},query:function(D){return l.query(A(D))},openCursor:function(D){var L=D.query.index,O=L.keyTail,I=L.keyLength;return L.isVirtual?l.openCursor(A(D)).then(function(K){return K&&z(K)}):l.openCursor(D);function z(K){return Object.create(K,{continue:{value:function(j){j!=null?K.continue(Ls(j,D.reverse?n.MAX_KEY:n.MIN_KEY,O)):D.unique?K.continue(K.key.slice(0,I).concat(D.reverse?n.MIN_KEY:n.MAX_KEY,O)):K.continue()}},continuePrimaryKey:{value:function(j,ee){K.continuePrimaryKey(Ls(j,n.MAX_KEY,O),ee)}},primaryKey:{get:function(){return K.primaryKey}},key:{get:function(){var j=K.key;return I===1?j[0]:j.slice(0,I)}},value:{get:function(){return K.value}}})}}})}})}};function Mi(n,s,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var p,m,b;x(s,f)?(p=n[f],m=s[f],typeof p=="object"&&typeof m=="object"&&p&&m?(b=$(p))!==$(m)?l[u+f]=s[f]:b==="Object"?Mi(p,m,l,u+f+"."):p!==m&&(l[u+f]=s[f]):p!==m&&(l[u+f]=s[f])):l[u+f]=void 0}),c(s).forEach(function(f){x(n,f)||(l[u+f]=s[f])}),l}function Li(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var of={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),u=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=Le.trans,m=p.table(s).hook,b=m.deleting,R=m.creating,q=m.updating;switch(f.type){case"add":if(R.fire===qe)break;return p._promise("readwrite",function(){return P(f)},!0);case"put":if(R.fire===qe&&q.fire===qe)break;return p._promise("readwrite",function(){return P(f)},!0);case"delete":if(b.fire===qe)break;return p._promise("readwrite",function(){return P(f)},!0);case"deleteRange":if(b.fire===qe)break;return p._promise("readwrite",function(){return(function A(D,L,O){return l.query({trans:D,values:!1,query:{index:u,range:L},limit:O}).then(function(I){var z=I.result;return P({type:"delete",keys:z,trans:D}).then(function(K){return 0<K.numFailures?Promise.reject(K.failures[0]):z.length<O?{failures:[],numFailures:0,lastResult:void 0}:A(D,a(a({},L),{lower:z[z.length-1],lowerOpen:!0}),O)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function P(A){var D,L,O,I=Le.trans,z=A.keys||Li(u,A);if(z)return(A=A.type==="add"||A.type==="put"?a(a({},A),{keys:z}):a({},A)).type!=="delete"&&(A.values=i([],A.values)),A.keys&&(A.keys=i([],A.keys)),D=l,O=z,((L=A).type==="add"?Promise.resolve([]):D.getMany({trans:L.trans,keys:O,cache:"immutable"})).then(function(K){var j=z.map(function(ee,fe){var Se,Te,ve,De=K[fe],Ce={onerror:null,onsuccess:null};return A.type==="delete"?b.fire.call(Ce,ee,De,I):A.type==="add"||De===void 0?(Se=R.fire.call(Ce,ee,A.values[fe],I),ee==null&&Se!=null&&(A.keys[fe]=ee=Se,u.outbound||G(A.values[fe],u.keyPath,ee))):(Se=Mi(De,A.values[fe]),(Te=q.fire.call(Ce,Se,ee,De,I))&&(ve=A.values[fe],Object.keys(Te).forEach(function(we){x(ve,we)?ve[we]=Te[we]:G(ve,we,Te[we])}))),Ce});return l.mutate(A).then(function(ee){for(var fe=ee.failures,Se=ee.results,Te=ee.numFailures,ee=ee.lastResult,ve=0;ve<z.length;++ve){var De=(Se||z)[ve],Ce=j[ve];De==null?Ce.onerror&&Ce.onerror(fe[ve]):Ce.onsuccess&&Ce.onsuccess(A.type==="put"&&K[ve]?A.values[ve]:De)}return{failures:fe,results:Se,numFailures:Te,lastResult:ee}}).catch(function(ee){return j.forEach(function(fe){return fe.onerror&&fe.onerror(ee)}),Promise.reject(ee)})});throw new Error("Keys missing")}}})}})}};function hl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var u=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)Je(s.keys[f],n[p])===0&&(u.push(l?le(s.values[f]):s.values[f]),++p);return u.length===n.length?u:null}catch{return null}}var lf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(u){var f;return u.cache?(f=hl(u.keys,u.trans._cache,u.cache==="clone"))?Ae.resolve(f):l.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?le(p):p},p}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function ml(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function gl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var uf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Wt(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,f,p){if(Le.subscr&&f!=="readonly")throw new ye.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Le.querier));return n.transaction(u,f,p)},table:function(u){function f(z){var I,z=z.query;return[I=z.index,new Wt((I=(z=z.range).lower)!=null?I:n.MIN_KEY,(I=z.upper)!=null?I:n.MAX_KEY)]}var p=n.table(u),m=p.schema,b=m.primaryKey,R=m.indexes,q=b.extractKey,P=b.outbound,A=b.autoIncrement&&R.filter(function(O){return O.compound&&O.keyPath.includes(b.keyPath)}),D=a(a({},p),{mutate:function(O){function I(Me){return Me="idb://".concat(s,"/").concat(u,"/").concat(Me),fe[Me]||(fe[Me]=new Wt)}var z,K,j,ee=O.trans,fe=O.mutatedParts||(O.mutatedParts={}),Se=I(""),Te=I(":dels"),ve=O.type,Ce=O.type==="deleteRange"?[O.range]:O.type==="delete"?[O.keys]:O.values.length<50?[Li(b,O).filter(function(Me){return Me}),O.values]:[],De=Ce[0],Ce=Ce[1],we=O.trans._cache;return d(De)?(Se.addKeys(De),(ve=ve==="delete"||De.length===Ce.length?hl(De,we):null)||Te.addKeys(De),(ve||Ce)&&(z=I,K=ve,j=Ce,m.indexes.forEach(function(Me){var $e=z(Me.name||"");function at(Ge){return Ge!=null?Me.extractKey(Ge):null}function Be(Ge){Me.multiEntry&&d(Ge)?Ge.forEach(function(wt){return $e.addKey(wt)}):$e.addKey(Ge)}(K||j).forEach(function(Ge,kt){var Tn=K&&at(K[kt]),kt=j&&at(j[kt]);Je(Tn,kt)!==0&&(Tn!=null&&Be(Tn),kt!=null)&&Be(kt)})}))):De?(Ce={from:(we=De.lower)!=null?we:n.MIN_KEY,to:(ve=De.upper)!=null?ve:n.MAX_KEY},Te.add(Ce),Se.add(Ce)):(Se.add(l),Te.add(l),m.indexes.forEach(function(Me){return I(Me.name).add(l)})),p.mutate(O).then(function(Me){return!De||O.type!=="add"&&O.type!=="put"||(Se.addKeys(Me.results),A&&A.forEach(function($e){for(var at=O.values.map(function(Tn){return $e.extractKey(Tn)}),Be=$e.keyPath.findIndex(function(Tn){return Tn===b.keyPath}),Ge=0,wt=Me.results.length;Ge<wt;++Ge)at[Ge][Be]=Me.results[Ge];I($e.name).addKeys(at)})),ee.mutatedParts=Ds(ee.mutatedParts||{},fe),Me})}}),L={get:function(O){return[b,new Wt(O.key)]},getMany:function(O){return[b,new Wt().addKeys(O.keys)]},count:f,query:f,openCursor:f};return c(L).forEach(function(O){D[O]=function(I){var z=Le.subscr,K=!!z,j=ml(Le,p)&&gl(O,I)?I.obsSet={}:z;if(K){var ee,z=function(Ce){return Ce="idb://".concat(s,"/").concat(u,"/").concat(Ce),j[Ce]||(j[Ce]=new Wt)},fe=z(""),Se=z(":dels"),K=L[O](I),Te=K[0],K=K[1];if((O==="query"&&Te.isPrimaryKey&&!I.values?Se:z(Te.name||"")).add(K),!Te.isPrimaryKey){if(O!=="count")return ee=O==="query"&&P&&I.values&&p.query(a(a({},I),{values:!1})),p[O].apply(this,arguments).then(function(Ce){if(O==="query"){if(P&&I.values)return ee.then(function(at){return at=at.result,fe.addKeys(at),Ce});var we=I.values?Ce.result.map(q):Ce.result;(I.values?fe:Se).addKeys(we)}else{var Me,$e;if(O==="openCursor")return $e=I.values,(Me=Ce)&&Object.create(Me,{key:{get:function(){return Se.addKey(Me.primaryKey),Me.key}},primaryKey:{get:function(){var at=Me.primaryKey;return Se.addKey(at),at}},value:{get:function(){return $e&&fe.addKey(Me.primaryKey),Me.value}}})}return Ce});Se.add(l)}}return p[O].apply(this,arguments)}}),D}})}};function yl(n,s,l){var u;return l.numFailures===0?s:s.type==="deleteRange"||(u=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===u)?null:(u=a({},s),d(u.keys)&&(u.keys=u.keys.filter(function(f,p){return!(p in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,p){return!(p in l.failures)})),u)}function Ni(n,s){return l=n,((u=s).lower===void 0||(u.lowerOpen?0<Je(l,u.lower):0<=Je(l,u.lower)))&&(l=n,(u=s).upper===void 0||(u.upperOpen?Je(l,u.upper)<0:Je(l,u.upper)<=0));var l,u}function _l(n,s,l,u,f,p){var m,b,R,q,P,A;return!l||l.length===0||(m=s.query.index,b=m.multiEntry,R=s.query.range,q=u.schema.primaryKey.extractKey,P=m.extractKey,A=(m.lowLevelIndex||m).extractKey,(u=l.reduce(function(D,L){var O=D,I=[];if(L.type==="add"||L.type==="put")for(var z=new Wt,K=L.values.length-1;0<=K;--K){var j,ee=L.values[K],fe=q(ee);!z.hasKey(fe)&&(j=P(ee),b&&d(j)?j.some(function(Ce){return Ni(Ce,R)}):Ni(j,R))&&(z.addKey(fe),I.push(ee))}switch(L.type){case"add":var Se=new Wt().addKeys(s.values?D.map(function(we){return q(we)}):D),O=D.concat(s.values?I.filter(function(we){return we=q(we),!Se.hasKey(we)&&(Se.addKey(we),!0)}):I.map(function(we){return q(we)}).filter(function(we){return!Se.hasKey(we)&&(Se.addKey(we),!0)}));break;case"put":var Te=new Wt().addKeys(L.values.map(function(we){return q(we)}));O=D.filter(function(we){return!Te.hasKey(s.values?q(we):we)}).concat(s.values?I:I.map(function(we){return q(we)}));break;case"delete":var ve=new Wt().addKeys(L.keys);O=D.filter(function(we){return!ve.hasKey(s.values?q(we):we)});break;case"deleteRange":var De=L.range;O=D.filter(function(we){return!Ni(q(we),De)})}return O},n))===n)?n:(u.sort(function(D,L){return Je(A(D),A(L))||Je(q(D),q(L))}),s.limit&&s.limit<1/0&&(u.length>s.limit?u.length=s.limit:n.length===s.limit&&u.length<s.limit&&(f.dirty=!0)),p?Object.freeze(u):u)}function bl(n,s){return Je(n.lower,s.lower)===0&&Je(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function cf(n,s){return((l,u,f,p)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=Je(l,u))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,u,f,p)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=Je(l,u))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function ff(n,s,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&X(p,f)},3e3))})}var df={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,u,f){var p,m,b=n.transaction(l,u,f);return u==="readwrite"&&(f=(p=new AbortController).signal,b.addEventListener("abort",(m=function(R){return function(){if(p.abort(),u==="readwrite"){for(var q=new Set,P=0,A=l;P<A.length;P++){var D=A[P],L=Kr["idb://".concat(s,"/").concat(D)];if(L){var O=n.table(D),I=L.optimisticOps.filter(function(Me){return Me.trans===b});if(b._explicit&&R&&b.mutatedParts)for(var z=0,K=Object.values(L.queries.query);z<K.length;z++)for(var j=0,ee=(Te=K[z]).slice();j<ee.length;j++)Ii((ve=ee[j]).obsSet,b.mutatedParts)&&(X(Te,ve),ve.subscribers.forEach(function(Me){return q.add(Me)}));else if(0<I.length){L.optimisticOps=L.optimisticOps.filter(function(Me){return Me.trans!==b});for(var fe=0,Se=Object.values(L.queries.query);fe<Se.length;fe++)for(var Te,ve,De,Ce=0,we=(Te=Se[fe]).slice();Ce<we.length;Ce++)(ve=we[Ce]).res!=null&&b.mutatedParts&&(R&&!ve.dirty?(De=Object.isFrozen(ve.res),De=_l(ve.res,ve.req,I,O,ve,De),ve.dirty?(X(Te,ve),ve.subscribers.forEach(function(Me){return q.add(Me)})):De!==ve.res&&(ve.res=De,ve.promise=Ae.resolve({result:De}))):(ve.dirty&&X(Te,ve),ve.subscribers.forEach(function(Me){return q.add(Me)})))}}}q.forEach(function(Me){return Me()})}}})(!1),{signal:f}),b.addEventListener("error",m(!1),{signal:f}),b.addEventListener("complete",m(!0),{signal:f})),b},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return a(a({},u),{mutate:function(p){var m,b=Le.trans;return!f.outbound&&b.db._options.cache!=="disabled"&&!b.explicit&&b.idbtrans.mode==="readwrite"&&(m=Kr["idb://".concat(s,"/").concat(l)])?(b=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Li(f,p).some(function(R){return R==null}))?(m.optimisticOps.push(p),p.mutatedParts&&Ms(p.mutatedParts),b.then(function(R){0<R.numFailures&&(X(m.optimisticOps,p),(R=yl(0,p,R))&&m.optimisticOps.push(R),p.mutatedParts)&&Ms(p.mutatedParts)}),b.catch(function(){X(m.optimisticOps,p),p.mutatedParts&&Ms(p.mutatedParts)})):b.then(function(R){var q=yl(0,a(a({},p),{values:p.values.map(function(P,A){var D;return R.failures[A]?P:(G(D=(D=f.keyPath)!=null&&D.includes(".")?le(P):a({},P),f.keyPath,R.results[A]),D)})}),R);m.optimisticOps.push(q),queueMicrotask(function(){return p.mutatedParts&&Ms(p.mutatedParts)})}),b):u.mutate(p)},query:function(p){var m,b,R,q,P,A,D;return ml(Le,u)&&gl("query",p)?(m=((R=Le.trans)==null?void 0:R.db._options.cache)==="immutable",b=(R=Le).requery,R=R.signal,A=((L,O,I,z)=>{var K=Kr["idb://".concat(L,"/").concat(O)];if(!K)return[];if(!(L=K.queries[I]))return[null,!1,K,null];var j=L[(z.query?z.query.index.name:null)||""];if(!j)return[null,!1,K,null];switch(I){case"query":var ee=j.find(function(fe){return fe.req.limit===z.limit&&fe.req.values===z.values&&bl(fe.req.query.range,z.query.range)});return ee?[ee,!0,K,j]:[j.find(function(fe){return("limit"in fe.req?fe.req.limit:1/0)>=z.limit&&(!z.values||fe.req.values)&&cf(fe.req.query.range,z.query.range)}),!1,K,j];case"count":return ee=j.find(function(fe){return bl(fe.req.query.range,z.query.range)}),[ee,!!ee,K,j]}})(s,l,"query",p),D=A[0],q=A[2],P=A[3],D&&A[1]?D.obsSet=p.obsSet:(A=u.query(p).then(function(L){var O=L.result;if(D&&(D.res=O),m){for(var I=0,z=O.length;I<z;++I)Object.freeze(O[I]);Object.freeze(O)}else L.result=le(O);return L}).catch(function(L){return P&&D&&X(P,D),Promise.reject(L)}),D={obsSet:p.obsSet,promise:A,subscribers:new Set,type:"query",req:p,dirty:!1},P?P.push(D):(P=[D],(q=q||(Kr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=P)),ff(D,P,b,R),D.promise.then(function(L){return{result:_l(L.result,p,q==null?void 0:q.optimisticOps,u,D,m)}})):u.query(p)}})}})}};function Ns(n,s){return new Proxy(n,{get:function(l,u,f){return u==="db"?s:Reflect.get(l,u,f)}})}Et.prototype.version=function(n){if(isNaN(n)||n<.1)throw new ye.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new ye.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(ef),l.stores({}),this._state.autoSchema=!1),l},Et.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Le.letThrough||this._vip)?n():new Ae(function(l,u){if(s._state.openComplete)return u(new ye.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void u(new ye.DatabaseClosed);s.open().catch(qe)}s._state.dbReadyPromise.then(l,u)}).then(n)},Et.prototype.use=function(f){var s=f.stack,l=f.create,u=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:u??10,name:f}),p.sort(function(m,b){return m.level-b.level}),this},Et.prototype.unuse=function(n){var s=n.stack,l=n.name,u=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},Et.prototype.open=function(){var n=this;return Ne(Ot,function(){return af(n)})},Et.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=Tt.indexOf(this);if(0<=s&&Tt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ae(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ae(function(l,u){n.cancelOpen=u}))},Et.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new ye.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new ye.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},Et.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new Ae(function(f,p){function m(){s.close(n);var b=s._deps.indexedDB.deleteDatabase(s.name);b.onsuccess=ut(function(){var R,q,P;R=s._deps,q=s.name,Ei(P=R.indexedDB)||q===rn||Ti(P,R.IDBKeyRange).delete(q).catch(qe),f()}),b.onerror=Xn(p),b.onblocked=s._fireOnBlocked}if(l)throw new ye.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(m):m()})},Et.prototype.backendDB=function(){return this.idbdb},Et.prototype.isOpen=function(){return this.idbdb!==null},Et.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Et.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Et.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Et.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),Et.prototype.transaction=function(){var n=(function(s,l,u){var f=arguments.length;if(f<2)throw new ye.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return u=p.pop(),[s,Pe(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},Et.prototype._transaction=function(n,s,l){var u,f,p=this,m=Le.trans,b=(m&&m.db===this&&n.indexOf("!")===-1||(m=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(q){if(q=q instanceof p.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),n=="r"||n===Vn)u=Vn;else{if(n!="rw"&&n!=zr)throw new ye.InvalidArgument("Invalid transaction mode: "+n);u=zr}if(m){if(m.mode===Vn&&u===zr){if(!b)throw new ye.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");m=null}m&&f.forEach(function(q){if(m&&m.storeNames.indexOf(q)===-1){if(!b)throw new ye.SubTransaction("Table "+q+" not included in parent transaction.");m=null}}),b&&m&&!m.active&&(m=null)}}catch(q){return m?m._promise(null,function(P,A){A(q)}):xe(q)}var R=(function q(P,A,D,L,O){return Ae.resolve().then(function(){var j=Le.transless||Le,I=P._createTransaction(A,D,P._dbSchema,L),j=(I.explicit=!0,{trans:I,transless:j});if(L)I.idbtrans=L.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,P._state.PR1398_maxLoop=3}catch(ee){return ee.name===je.InvalidState&&P.isOpen()&&0<--P._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),P.close({disableAutoOpen:!1}),P.open().then(function(){return q(P,A,D,null,O)})):xe(ee)}var z,K=_e(O),j=(K&&Ht(),Ae.follow(function(){var ee;(z=O.call(I,I))&&(K?(ee=jn.bind(null,null),z.then(ee,ee)):typeof z.next=="function"&&typeof z.throw=="function"&&(z=Di(z)))},j));return(z&&typeof z.then=="function"?Ae.resolve(z).then(function(ee){return I.active?ee:xe(new ye.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):j.then(function(){return z})).then(function(ee){return L&&I._resolve(),I._completion.then(function(){return ee})}).catch(function(ee){return I._reject(ee),xe(ee)})})}).bind(null,this,u,f,m,l);return m?m._promise(u,R,"lock"):Le.trans?Ne(Le.transless,function(){return p._whenReady(R)}):this._whenReady(R)},Et.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new ye.InvalidTable("Table ".concat(n," does not exist"))};var lr=Et;function Et(n,s){var l,u,f,p,m,b=this,R=(this._middlewares={},this.verno=0,Et.dependencies),R=(this._options=s=a({addons:Et.addons,autoOpen:!0,indexedDB:R.indexedDB,IDBKeyRange:R.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),q=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:qe,dbReadyPromise:null,cancelOpen:qe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),P=(q.dbReadyPromise=new Ae(function(A){q.dbReadyResolve=A}),q.openCanceller=new Ae(function(A,D){q.cancelOpen=D}),this._state=q,this.name=n,this.on=Ba(this,"populate","blocked","versionchange","close",{ready:[jt,qe]}),this.once=function(A,D){var L=function(){for(var O=[],I=0;I<arguments.length;I++)O[I]=arguments[I];b.on(A).unsubscribe(L),D.apply(b,O)};return b.on(A,L)},this.on.ready.subscribe=re(this.on.ready.subscribe,function(A){return function(D,L){Et.vip(function(){var O,I=b._state;I.openComplete?(I.dbOpenError||Ae.resolve().then(D),L&&A(D)):I.onReadyBeingFired?(I.onReadyBeingFired.push(D),L&&A(D)):(A(D),O=b,L||A(function z(){O.on.ready.unsubscribe(D),O.on.ready.unsubscribe(z)}))})}}),this.Collection=(l=this,za(Yc.prototype,function(z,I){this.db=l;var L=ja,O=null;if(I)try{L=I()}catch(j){O=j}var I=z._ctx,z=I.table,K=z.hook.reading.fire;this._ctx={table:z,index:I.index,isPrimKey:!I.index||z.schema.primKey.keyPath&&I.index===z.schema.primKey.name,range:L,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:I.or,valueMapper:K!==We?K:null}})),this.Table=(u=this,za(tl.prototype,function(A,D,L){this.db=u,this._tx=L,this.name=A,this.schema=D,this.hook=u._allTables[A]?u._allTables[A].hook:Ba(null,{creating:[Qe,qe],reading:[vt,We],updating:[_t,qe],deleting:[it,qe]})})),this.Transaction=(f=this,za(Qc.prototype,function(A,D,L,O,I){var z=this;A!=="readonly"&&D.forEach(function(K){K=(K=L[K])==null?void 0:K.yProps,K&&(D=D.concat(K.map(function(j){return j.updatesTable})))}),this.db=f,this.mode=A,this.storeNames=D,this.schema=L,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Ba(this,"complete","error","abort"),this.parent=I||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ae(function(K,j){z._resolve=K,z._reject=j}),this._completion.then(function(){z.active=!1,z.on.complete.fire()},function(K){var j=z.active;return z.active=!1,z.on.error.fire(K),z.parent?z.parent._reject(K):j&&z.idbtrans&&z.idbtrans.abort(),xe(K)})})),this.Version=(p=this,za(rf.prototype,function(A){this.db=p,this._cfg={version:A,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,za(il.prototype,function(A,D,L){if(this.db=m,this._ctx={table:A,index:D===":id"?null:D,or:L},this._cmp=this._ascending=Je,this._descending=function(O,I){return Je(I,O)},this._max=function(O,I){return 0<Je(O,I)?O:I},this._min=function(O,I){return Je(O,I)<0?O:I},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new ye.MissingAPI})),this.on("versionchange",function(A){0<A.newVersion?console.warn("Another connection wants to upgrade database '".concat(b.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(b.name,"'. Closing db now to resume the delete request.")),b.close({disableAutoOpen:!1})}),this.on("blocked",function(A){!A.newVersion||A.newVersion<A.oldVersion?console.warn("Dexie.delete('".concat(b.name,"') was blocked")):console.warn("Upgrade '".concat(b.name,"' blocked by other connection holding version ").concat(A.oldVersion/10))}),this._maxKey=Ua(s.IDBKeyRange),this._createTransaction=function(A,D,L,O){return new b.Transaction(A,D,L,b._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(A){b.on("blocked").fire(A),Tt.filter(function(D){return D.name===b.name&&D!==b&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(A)})},this.use(lf),this.use(df),this.use(uf),this.use(sf),this.use(of),new Proxy(this,{get:function(A,D,L){var O;return D==="_vip"||(D==="table"?function(I){return Ns(b.table(I),P)}:(O=Reflect.get(A,D,L))instanceof tl?Ns(O,P):D==="tables"?O.map(function(I){return Ns(I,P)}):D==="_createTransaction"?function(){return Ns(O.apply(this,arguments),P)}:O)}}));this.vip=P,R.forEach(function(A){return A(b)})}var js,ga=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",pf=(ji.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},ji.prototype[ga]=function(){return this},ji);function ji(n){this._subscribe=n}try{js={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{js={indexedDB:null,IDBKeyRange:null}}function wl(n){var s,l=!1,u=new pf(function(f){var p=_e(n),m,b=!1,R={},q={},P={get closed(){return b},unsubscribe:function(){b||(b=!0,m&&m.abort(),A&&Sr.storagemutated.unsubscribe(L))}},A=(f.start&&f.start(P),!1),D=function(){return ge(O)},L=function(I){Ds(R,I),Ii(q,R)&&D()},O=function(){var I,z,K;!b&&js.indexedDB&&(R={},I={},m&&m.abort(),m=new AbortController,K=(j=>{var ee=kr();try{p&&Ht();var fe=Nn(n,j);return fe=p?fe.finally(jn):fe}finally{ee&&or()}})(z={subscr:I,signal:m.signal,requery:D,querier:n,trans:null}),Promise.resolve(K).then(function(j){l=!0,s=j,b||z.signal.aborted||(R={},(ee=>{for(var fe in ee)if(x(ee,fe))return;return 1})(q=I)||A||(Sr(Ka,L),A=!0),ge(function(){return!b&&f.next&&f.next(j)}))},function(j){l=!1,["DatabaseClosedError","AbortError"].includes(j==null?void 0:j.name)||b||ge(function(){b||f.error&&f.error(j)})}))};return setTimeout(D,0),P});return u.hasValue=function(){return l},u.getValue=function(){return s},u}var Ur=lr;function qi(n){var s=Tr;try{Tr=!0,Sr.storagemutated.fire(n),Oi(n,!0)}finally{Tr=s}}w(Ur,a(a({},Y),{delete:function(n){return new Ur(n,{addons:[]}).delete()},exists:function(n){return new Ur(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Ur.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ei(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==rn})}):Ti(l,s).toCollection().primaryKeys()).then(n)}catch{return xe(new ye.MissingAPI)}var s,l},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return Le.trans?Ne(Le.transless,n):n()},vip:Ai,async:function(n){return function(){try{var s=Di(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ae.resolve(s)}catch(l){return xe(l)}}},spawn:function(n,s,l){try{var u=Di(n.apply(l,s||[]));return u&&typeof u.then=="function"?u:Ae.resolve(u)}catch(f){return xe(f)}},currentTransaction:{get:function(){return Le.trans||null}},waitFor:function(n,s){return n=Ae.resolve(typeof n=="function"?Ur.ignoreTransaction(n):n).timeout(s||6e4),Le.trans?Le.trans.waitFor(n):n},Promise:Ae,debug:{get:function(){return Rt},set:function(n){ar(n)}},derive:T,extend:h,props:w,override:re,Events:Ba,on:Sr,liveQuery:wl,extendObservabilitySet:Ds,getByKeyPath:te,setByKeyPath:G,delByKeyPath:function(n,s){typeof s=="string"?G(n,s,void 0):"length"in s&&[].map.call(s,function(l){G(n,l,void 0)})},shallowClone:me,deepClone:le,getObjectDiff:Mi,cmp:Je,asap:J,minKey:-1/0,addons:[],connections:Tt,errnames:je,dependencies:js,cache:Kr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Ur.maxKey=Ua(Ur.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Sr(Ka,function(n){Tr||(n=new CustomEvent(yi,{detail:n}),Tr=!0,dispatchEvent(n),Tr=!1)}),addEventListener(yi,function(n){n=n.detail,Tr||qi(n)}));var ya,Tr=!1,kl=function(){};return typeof BroadcastChannel<"u"&&((kl=function(){(ya=new BroadcastChannel(yi)).onmessage=function(n){return n.data&&qi(n.data)}})(),typeof ya.unref=="function"&&ya.unref(),Sr(Ka,function(n){Tr||ya.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!lr.disableBfCache&&n.persisted){Rt&&console.debug("Dexie: handling persisted pagehide"),ya!=null&&ya.close();for(var s=0,l=Tt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!lr.disableBfCache&&n.persisted&&(Rt&&console.debug("Dexie: handling persisted pageshow"),kl(),qi({all:new Wt(-1/0,[[]])}))})),Ae.rejectionMapper=function(n,s){return!n||n instanceof W||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Fe[n.name]?n:(s=new Fe[n.name](s||n.message,n),"stack"in n&&M(s,"stack",{get:function(){return this.inner.stack}}),s)},ar(Rt),a(lr,Object.freeze({__proto__:null,Dexie:lr,Entity:Qo,PropModification:qa,RangeSet:Wt,add:function(n){return new qa({add:n})},cmp:Je,default:lr,liveQuery:wl,mergeRanges:Wa,rangesOverlap:fl,remove:function(n){return new qa({remove:n})},replacePrefix:function(n,s){return new qa({replacePrefix:[n,s]})}}),{default:lr}),lr})})(Qs)),Qs.exports}var Jd=Zd();const co=Xd(Jd),zl=Symbol.for("Dexie"),Vt=globalThis[zl]||(globalThis[zl]=co);if(co.semVer!==Vt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${co.semVer} and ${Vt.semVer}`);const{liveQuery:gy,mergeRanges:yy,rangesOverlap:_y,RangeSet:by,cmp:wy,Entity:ky,PropModification:xy,replacePrefix:Sy,add:Ty,remove:Ey,DexieYProvider:Ay}=Vt,ze=new Vt("me-ai-store");ze.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});ze.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});ze.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});ze.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function cc(t,e){return`${t}:${e}`}function fo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Wi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function $d(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function ep(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function fc(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const tp="https://gmail.googleapis.com/gmail/v1/users/me";class qo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function np(t){return{Authorization:`Bearer ${t}`}}async function pi(t,e){var a,i,o,c;const r=await fetch(`${tp}${e}`,{headers:np(t)});if(!r.ok){const d=await r.json().catch(()=>({})),h=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,v=((c=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:c.reason)||void 0;throw new qo(h,r.status,v)}return r.json()}function dc(t){return pi(t,"/profile")}function pc(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),pi(t,`/messages?${i}`)}function vc(t,e,r="full"){return pi(t,`/messages/${e}?format=${r}`)}function rp(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),pi(t,`/history?${i}`)}function Ar(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function is(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function ap(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return is(e.body.data);const r=e.parts||[],a=ni(r,"text/plain");if((c=a==null?void 0:a.body)!=null&&c.data)return is(a.body.data);const i=ni(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const h=is(i.body.data);return ip(h)}return"(no body)"}function sp(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return is(e.body.data);const r=e.parts||[],a=ni(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?is(a.body.data):null}function ni(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ni(r.parts,e);if(a)return a}}return null}function ip(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Bo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function hc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function mc(t){return hc(t).charAt(0).toUpperCase()}function op(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function lp(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function gc(t,e){return`${op(t.date)}_${lp(t.subject)}.${e}`}function yc(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function up(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await _c();if(a&&i){const o=new Date(a.date).toLocaleDateString(),c=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${c}.`)}return r.join(" ")}async function cp(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await _c();if(a&&i){const o=new Date(a.date).toLocaleDateString(),c=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${c}`)}return r.join(`
`)}async function fp(t=10){const e=await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(bc).join(`

---

`)}async function dp(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await ze.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,h,v,y,x;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(h=o.from)!=null&&h.toLowerCase().includes(r)&&(c+=2),(v=o.to)!=null&&v.toLowerCase().includes(r)&&(c+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>bc(o)).join(`

---

`)}async function Fl(){const t=await ze.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=yc(t);return{groups:e,order:r,total:t.length}}async function pp({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await ze.items.where("sourceType").equals("gmail").filter(d=>{var h,v,y,x;return((h=d.subject)==null?void 0:h.toLowerCase().includes(o))||((v=d.from)==null?void 0:v.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return c.sort((d,h)=>(h.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const a=await ze.items.where("sourceType").equals("gmail").count();return{items:await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function _c(){const t=await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).first(),e=await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).last();return{oldest:t,newest:e}}function bc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=ep(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function vp(){const t=await up();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function hp(t){const e=[],r=await cp();if(e.push(r),t){const a=await dp(t,5);e.push("","## Relevant Emails",a)}else{const a=await fp(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const mp=20,gp={maxTokens:512},ba=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function wc(t,{count:e=mp,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,c=0;if(r)o=await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).reverse().limit(e).toArray();else{const M=new Set(await ze.emailClassifications.toCollection().primaryKeys());c=0,o=[],await ze.items.where("[sourceType+date]").between(["gmail",Vt.minKey],["gmail",Vt.maxKey]).reverse().until(()=>o.length>=e).each(T=>{M.has(T.id)?c++:o.push(T)})}if(o.length===0){const M=r?"No emails to scan.":`All emails already classified (${c} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:M,classified:0}),{scanned:0,classified:0,skipped:c,errors:0}}const d=Date.now(),h=performance.now();let v=0,y=0,x=0,w=0;for(let M=0;M<o.length&&!(i!=null&&i.aborted);M++){const T=o[M],E=Sc(T),F=[{role:"system",content:ba},{role:"user",content:E}];a({phase:"scanning",current:M+1,total:o.length,classified:v,errors:y,email:{subject:T.subject,from:T.from,date:T.date},prompt:{system:ba,user:E},systemPromptLength:ba.length,live:null,lastResult:null,totals:{outputTokens:x,inputTokens:w,elapsed:performance.now()-h}});const se=performance.now();try{const{text:re,tps:H,numTokens:J,inputTokens:te}=await t.generateFull(F,{maxTokens:512,enableThinking:!1},Ie=>{a({phase:"generating",current:M+1,total:o.length,classified:v,errors:y,email:{subject:T.subject,from:T.from,date:T.date},live:{tps:Ie.tps,numTokens:Ie.numTokens},totals:{outputTokens:x,inputTokens:w,elapsed:performance.now()-h}})});x+=J,w+=te;const G=wp(re),me=performance.now()-se;G&&(await ze.emailClassifications.put({emailId:T.id,action:G.action,reason:G.reason,summary:G.summary,tags:G.tags,subject:T.subject||"(no subject)",from:T.from||"",date:T.date,scannedAt:d,status:"pending"}),v++,a({phase:"classified",current:M+1,total:o.length,classified:v,errors:y,email:{subject:T.subject,from:T.from,date:T.date},result:G,emailStats:{tps:H,numTokens:J,inputTokens:te,elapsed:me},totals:{outputTokens:x,inputTokens:w,elapsed:performance.now()-h}}))}catch(re){console.error(`Triage email ${M+1} failed:`,re),y++}}const k=performance.now()-h;return a({phase:"done",classified:v,errors:y,totals:{outputTokens:x,inputTokens:w,elapsed:k}}),{scanned:o.length,classified:v,skipped:c,errors:y}}async function yp(){const t=await ze.emailClassifications.toArray();return yc(t)}async function _p(){const t=await ze.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function ri(t,e){await ze.emailClassifications.update(t,{status:e})}async function bp(){await ze.emailClassifications.clear()}async function kc(t){await ze.emailClassifications.where("action").equals(t).delete()}async function xc(t){await ze.emailClassifications.delete(t)}async function po(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Sc(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function wp(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=kp(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let h=[];return Array.isArray(c.tags)&&(h=c.tags.filter(v=>typeof v=="string"&&v.trim()).map(v=>v.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:h}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function kp(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function vo(t){return`hsl(${fc(t)}, 55%, 55%)`}function xp(t){return`hsl(${fc(t)}, 40%, 35%)`}const Sp=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Kl(...t){Sp&&console.log("[debug]",...t)}function bn(t){return Kl(`[MOUNT] ${t}`),()=>Kl(`[DESTROY] ${t}`)}var Tp=U("<option> </option>"),Ep=U('<p class="model-description svelte-1p89qnn"> </p>'),Ap=U('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Cp=U('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Ip=U('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Rp=U('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Pp=U('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Op=U('<p class="error svelte-1p89qnn"> </p>'),Dp=U('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Mp(t,e){mt(e,!0);let r=Re(e,"selectedModel",15),a=Re(e,"gpuInfo",3,null),i=Re(e,"error",3,null);Gt(()=>bn("ModelSelector"));var o=Dp(),c=S(_(o),2),d=S(_(c),2);fn(d,21,()=>us,_r,(T,E)=>{var F=Tp(),se=_(F),re={};ce(()=>{Q(se,`${g(E).name??""} â ${g(E).size??""}`),re!==(re=g(E).id)&&(F.value=(F.__value=g(E).id)??"")}),B(T,F)});var h=S(d,2);{var v=T=>{const E=pt(()=>us.find(H=>H.id===r()));var F=fa(),se=tt(F);{var re=H=>{var J=Ep(),te=_(J);ce(()=>Q(te,g(E).description)),B(H,J)};he(se,H=>{g(E)&&H(re)})}B(T,F)};he(h,T=>{r()&&T(v)})}var y=S(c,2);{var x=T=>{var E=Pp(),F=S(_(E),2),se=_(F),re=S(_(se)),H=_(re),J=S(se,2),te=S(_(J)),G=_(te),me=S(J,2);{var Ie=oe=>{var ue=Ap(),X=S(_(ue)),ie=_(X);ce(()=>Q(ie,a().device)),B(oe,ue)};he(me,oe=>{a().device&&a().device!=="unknown"&&oe(Ie)})}var Pe=S(me,2);{var ke=oe=>{var ue=Cp(),X=S(_(ue)),ie=_(X);ce(()=>Q(ie,a().description)),B(oe,ue)};he(Pe,oe=>{a().description&&a().description!=="unknown"&&oe(ke)})}var V=S(Pe,2);{var le=oe=>{var ue=Ip(),X=S(_(ue)),ie=_(X);ce(pe=>Q(ie,pe),[()=>fo(a().limits.maxBufferSize)]),B(oe,ue)};he(V,oe=>{var ue;(ue=a().limits)!=null&&ue.maxBufferSize&&oe(le)})}var Ee=S(V,2);{var $=oe=>{var ue=Rp(),X=S(_(ue)),ie=_(X);ce(()=>Q(ie,`${a().features.length??""} supported`)),B(oe,ue)};he(Ee,oe=>{var ue;(ue=a().features)!=null&&ue.length&&oe($)})}ce(()=>{Q(H,a().vendor),Q(G,a().architecture)}),B(T,E)};he(y,T=>{a()&&T(x)})}var w=S(y,2);{var k=T=>{var E=Op(),F=_(E);ce(()=>Q(F,i())),B(T,E)};he(w,T=>{i()&&T(k)})}var M=S(w,2);M.__click=function(...T){var E;(E=e.onload)==null||E.apply(this,T)},ce(()=>M.disabled=i()),No(d,r),B(t,o),gt()}Nt(["click"]);var Lp=U('<span class="progress-percent svelte-r5fnze"> </span>'),Np=U('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),jp=U('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),qp=U('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Bp=U('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),zp=U('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Fp=U('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Kp(t,e){mt(e,!0);let r=Re(e,"message",3,""),a=Re(e,"items",19,()=>[]);Gt(()=>bn("LoadingProgress"));var i=Fp(),o=_(i),c=_(o),d=S(o,2);fn(d,17,a,_r,(h,v)=>{const y=pt(()=>g(v).total?$d(g(v).loaded||0,g(v).total):null);var x=zp(),w=_(x),k=_(w),M=_(k),T=S(k,2);{var E=H=>{var J=Lp(),te=_(J);ce(G=>Q(te,`${G??""}%`),[()=>g(y).toFixed(1)]),B(H,J)};he(T,H=>{g(y)!==null&&H(E)})}var F=S(w,2);{var se=H=>{var J=Np(),te=tt(J),G=_(te),me=S(te,2),Ie=_(me),Pe=_(Ie),ke=S(Ie,4),V=_(ke),le=S(ke,2),Ee=_(le);ce(($,oe,ue,X,ie)=>{cn(G,`width: ${$??""}%`),Q(Pe,oe),Q(V,ue),Q(Ee,`(${X??""} / ${ie??""} B)`)},[()=>Math.max(g(v).progress??0,.5).toFixed(1),()=>Wi(g(v).loaded||0),()=>Wi(g(v).total),()=>(g(v).loaded||0).toLocaleString(),()=>g(v).total.toLocaleString()]),B(H,J)},re=H=>{var J=Bp(),te=S(tt(J),2),G=_(te);{var me=Pe=>{var ke=jp(),V=tt(ke),le=_(V),Ee=S(V,2),$=_(Ee);ce((oe,ue)=>{Q(le,oe),Q($,`(${ue??""} B)`)},[()=>Wi(g(v).loaded),()=>g(v).loaded.toLocaleString()]),B(Pe,ke)},Ie=Pe=>{var ke=qp();B(Pe,ke)};he(G,Pe=>{g(v).loaded?Pe(me):Pe(Ie,!1)})}B(H,J)};he(F,H=>{g(v).total?H(se):H(re,!1)})}ce(()=>{oc(k,"title",g(v).file),Q(M,g(v).file)}),B(h,x)}),ce(()=>Q(c,r())),B(t,i),gt()}var Up=U('<span class="thinking-tokens svelte-11gjw00"> </span>'),Gp=U('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Hp=U('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Wp=U('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Yp=U('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Vp=U('<span class="cursor svelte-11gjw00">|</span>'),Xp=U(" <!>",1),Qp=U('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Zp=U('<div class="content svelte-11gjw00"> </div>'),Jp=U('<div><div class="role svelte-11gjw00"> </div> <!></div>');function $p(t,e){mt(e,!0);let r=Re(e,"isLast",3,!1),a=Re(e,"isRunning",3,!1),i=Re(e,"generationPhase",3,null),o=Re(e,"numTokens",3,null);Gt(()=>bn(`MessageBubble[${e.msg.role}]`));var c=Jp(),d=_(c),h=_(d),v=S(d,2);{var y=w=>{var k=Qp(),M=tt(k);{var T=G=>{var me=Gp(),Ie=S(_(me),4);{var Pe=ke=>{var V=Up(),le=_(V);ce(()=>Q(le,`${o()??""} tokens`)),B(ke,V)};he(Ie,ke=>{o()&&ke(Pe)})}B(G,me)},E=G=>{var me=Hp();B(G,me)};he(M,G=>{a()&&r()&&i()==="thinking"?G(T):a()&&r()&&i()==="preparing"&&G(E,1)})}var F=S(M,2);{var se=G=>{var me=Wp(),Ie=_(me),Pe=S(_(Ie),2),ke=_(Pe),V=S(Ie,2),le=_(V);ce(Ee=>{Q(ke,`${Ee??""} words`),Q(le,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),B(G,me)};he(F,G=>{e.msg.thinking&&G(se)})}var re=S(F,2),H=_(re);{var J=G=>{var me=Yp();B(G,me)},te=G=>{var me=Xp(),Ie=tt(me,!0),Pe=S(Ie);{var ke=V=>{var le=Vp();B(V,le)};he(Pe,V=>{a()&&r()&&V(ke)})}ce(()=>Q(Ie,e.msg.content)),B(G,me)};he(H,G=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?G(J):G(te,!1)})}B(w,k)},x=w=>{var k=Zp(),M=_(k);ce(()=>Q(M,e.msg.content)),B(w,k)};he(v,w=>{e.msg.role==="assistant"?w(y):w(x,!1)})}ce(()=>{Pt(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),Q(h,e.msg.role==="user"?"You":"AI")}),B(t,c),gt()}var ev=U('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),tv=U('<span class="edate svelte-mt5nvh"> </span>'),nv=U('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),rv=U('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),av=U('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),sv=U('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),iv=U('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function ov(t,e){mt(e,!0);let r=Re(e,"pendingData",3,null),a=Oe(null),i=Oe(null);function o(k){N(a,g(a)===k?null:k,!0),N(i,null)}function c(k){return k.split("_").map(M=>M.charAt(0)+M.slice(1).toLowerCase()).join(" ")}function d(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function h(k){if(!k)return"";const M=k.replace(/<.*>/,"").trim();return M.length>24?M.slice(0,22)+"â¦":M}var v={toggleGroup:o},y=fa(),x=tt(y);{var w=k=>{var M=iv(),T=_(M),E=_(T),F=S(T,2);fn(F,20,()=>r().order,H=>H,(H,J)=>{const te=pt(()=>r().groups[J]),G=pt(()=>vo(J)),me=pt(()=>g(a)===J);var Ie=ev();let Pe;Ie.__click=()=>o(J);let ke;var V=_(Ie);let le;var Ee=S(V),$=S(Ee),oe=_($);ce(ue=>{Pe=Pt(Ie,1,"chip svelte-mt5nvh",null,Pe,{active:g(me)}),ke=cn(Ie,"",ke,{"--c":g(G)}),le=cn(V,"",le,{background:g(G)}),Q(Ee,` ${ue??""} `),Q(oe,g(te).length)},[()=>c(J)]),B(H,Ie)});var se=S(F,2);{var re=H=>{const J=pt(()=>r().groups[g(a)]),te=pt(()=>vo(g(a)));var G=sv(),me=_(G);let Ie;var Pe=_(me);Pe.__click=()=>{N(a,null),N(i,null)};var ke=S(Pe,2),V=_(ke),le=S(ke,2),Ee=_(le),$=S(me,2);fn($,21,()=>g(J),pe=>pe.emailId,(pe,_e)=>{var Y=nv(),ne=_(Y);ne.__click=()=>{var We;return(We=e.onaskai)==null?void 0:We.call(e,`Tell me about the email "${g(_e).subject}" from ${g(_e).from}`)};var W=_(ne),ae=_(W),be=S(W,2),de=_(be),je=S(de);{var Ue=We=>{var vt=tv(),lt=_(vt);ce(Qe=>Q(lt,Qe),[()=>d(g(_e).date)]),B(We,vt)};he(je,We=>{g(_e).date&&We(Ue)})}var ye=S(ne,2),Fe=_(ye);Fe.__click=()=>{var We;return(We=e.onmarkacted)==null?void 0:We.call(e,g(_e).emailId)};var qe=S(Fe,2);qe.__click=()=>{var We;return(We=e.ondismiss)==null?void 0:We.call(e,g(_e).emailId)},ce(We=>{Q(ae,g(_e).subject),Q(de,We)},[()=>h(g(_e).from)]),B(pe,Y)});var oe=S($,2),ue=_(oe);{var X=pe=>{var _e=rv(),Y=tt(_e);Y.__click=()=>g(J).forEach(W=>{var ae;return(ae=e.onmarkacted)==null?void 0:ae.call(e,W.emailId)});var ne=S(Y,2);ne.__click=()=>N(i,g(a),!0),B(pe,_e)},ie=pe=>{var _e=av(),Y=tt(_e),ne=_(Y),W=S(Y,2);W.__click=()=>N(i,null);var ae=S(W,2);ae.__click=()=>{var be;(be=e.oncleargroup)==null||be.call(e,g(a)),N(i,null),N(a,null)},ce(()=>Q(ne,`Remove ${g(J).length??""}?`)),B(pe,_e)};he(ue,pe=>{g(i)!==g(a)?pe(X):pe(ie,!1)})}ce(pe=>{Ie=cn(me,"",Ie,{"border-color":g(te)}),Q(V,pe),Q(Ee,g(J).length)},[()=>c(g(a))]),B(H,G)};he(se,H=>{g(a)&&r().groups[g(a)]&&H(re)})}ce(()=>Q(E,`${r().total??""} item${r().total!==1?"s":""} need attention`)),B(k,M)};he(x,k=>{r()&&r().total>0&&k(w)})}return B(t,y),gt(v)}Nt(["click"]);var lv=U('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),uv=U('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),cv=U('<div class="strip svelte-1ed7zw1"><!></div>');function fv(t,e){let r=Re(e,"hasScanData",3,!1),a=Re(e,"engineReady",3,!1),i=Re(e,"isScanning",3,!1),o=pt(()=>a()&&!r()&&!i()),c=pt(()=>g(o)||i());var d=fa(),h=tt(d);{var v=y=>{var x=cv(),w=_(x);{var k=T=>{var E=lv();B(T,E)},M=T=>{var E=uv();E.__click=function(...F){var se;(se=e.onscan)==null||se.apply(this,F)},B(T,E)};he(w,T=>{i()?T(k):g(o)&&T(M,1)})}B(y,x)};he(h,y=>{g(c)&&y(v)})}B(t,d)}Nt(["click"]);var dv=U('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),pv=U('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),vv=U('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),hv=U('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mv=U('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),gv=U('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),yv=U('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function _v(t,e){mt(e,!0),Gt(()=>bn("GpuPanel"));var r=yv(),a=_(r),i=S(_(a),2),o=S(_(i),2),c=_(o),d=S(i,2),h=S(_(d),2),v=_(h),y=S(d,2);{var x=H=>{var J=dv(),te=S(_(J),2),G=_(te);ce(()=>Q(G,e.gpuInfo.device)),B(H,J)};he(y,H=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&H(x)})}var w=S(y,2);{var k=H=>{var J=pv(),te=S(_(J),2),G=_(te);ce(me=>Q(G,me),[()=>fo(e.gpuInfo.limits.maxBufferSize)]),B(H,J)};he(w,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxBufferSize&&H(k)})}var M=S(w,2);{var T=H=>{var J=vv(),te=S(_(J),2),G=_(te);ce(()=>Q(G,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),B(H,J)};he(M,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeInvocationsPerWorkgroup&&H(T)})}var E=S(M,2);{var F=H=>{var J=hv(),te=S(_(J),2),G=_(te);ce(me=>Q(G,me),[()=>fo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),B(H,J)};he(E,H=>{var J;(J=e.gpuInfo.limits)!=null&&J.maxComputeWorkgroupStorageSize&&H(F)})}var se=S(E,2);{var re=H=>{var J=gv(),te=_(J),G=_(te),me=S(te,2);fn(me,21,()=>e.gpuInfo.features,_r,(Ie,Pe)=>{var ke=mv(),V=_(ke);ce(()=>Q(V,g(Pe))),B(Ie,ke)}),ce(()=>Q(G,`Features (${e.gpuInfo.features.length??""})`)),B(H,J)};he(se,H=>{var J;(J=e.gpuInfo.features)!=null&&J.length&&H(re)})}ce(()=>{Q(c,e.gpuInfo.vendor),Q(v,e.gpuInfo.architecture)}),B(t,r),gt()}var bv=U('<button class="gpu-badge svelte-1ktw27c"> </button>'),wv=U('<span class="stats svelte-1ktw27c"> </span>'),kv=U('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),xv=U('<span class="stats preparing svelte-1ktw27c"> </span>'),Sv=U('<span class="stats svelte-1ktw27c"> </span>'),Tv=U('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ev=U('<button class="btn svelte-1ktw27c">Stop</button>'),Av=U('<button class="btn primary svelte-1ktw27c">Send</button>'),Cv=U('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Iv(t,e){mt(e,!0),Gt(()=>bn("ChatView"));let r=Re(e,"messages",19,()=>[]),a=Re(e,"pendingData",3,null),i=Re(e,"hasScanData",3,!1),o=Re(e,"engineReady",3,!1),c=Re(e,"isScanning",3,!1),d=Re(e,"isRunning",3,!1),h=Re(e,"tps",3,null),v=Re(e,"numTokens",3,null),y=Re(e,"generationPhase",3,null),x=Re(e,"gpuInfo",3,null),w=Re(e,"chatContainer",15),k=Oe(""),M=Oe(!1);function T(W){W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),E())}function E(){const W=g(k).trim();!W||d()||(N(k,""),e.onsend(W))}function F(W){W&&!d()&&e.onsend(W)}var se=Cv(),re=_(se),H=_(re);{var J=W=>{var ae=bv();ae.__click=()=>N(M,!g(M));var be=_(ae);ce(()=>Q(be,`WebGPU ${g(M)?"â²":"â¼"}`)),B(W,ae)};he(H,W=>{x()&&W(J)})}var te=S(H,2);{var G=W=>{var ae=wv(),be=_(ae);ce((de,je)=>Q(be,`${v()??""} tokens in ${de??""}s
        (${je??""} tok/s)`),[()=>(v()/h()).toFixed(1),()=>h().toFixed(1)]),B(W,ae)},me=W=>{var ae=kv();B(W,ae)},Ie=W=>{var ae=xv(),be=_(ae);ce(de=>Q(be,`thinking... ${de??""}`),[()=>h()?`${h().toFixed(0)} tok/s`:""]),B(W,ae)},Pe=W=>{var ae=Sv(),be=_(ae);ce(de=>Q(be,`${de??""} tok/s`),[()=>h().toFixed(1)]),B(W,ae)};he(te,W=>{h()&&!d()?W(G):d()&&y()==="preparing"?W(me,1):d()&&y()==="thinking"?W(Ie,2):h()&&d()&&W(Pe,3)})}var ke=S(te,4);ke.__click=function(...W){var ae;(ae=e.onreset)==null||ae.apply(this,W)};var V=S(re,2);{var le=W=>{_v(W,{get gpuInfo(){return x()}})};he(V,W=>{g(M)&&x()&&W(le)})}var Ee=S(V,2),$=_(Ee);{var oe=W=>{var ae=Tv();B(W,ae)};he($,W=>{r().length===0&&!(a()&&a().total>0)&&W(oe)})}var ue=S($,2);fn(ue,17,r,_r,(W,ae,be)=>{var de=fa(),je=tt(de);{var Ue=Fe=>{ov(Fe,{get pendingData(){return g(ae).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:F})},ye=Fe=>{{let qe=pt(()=>be===r().length-1);$p(Fe,{get msg(){return g(ae)},get isLast(){return g(qe)},get isRunning(){return d()},get generationPhase(){return y()},get numTokens(){return v()}})}};he(je,Fe=>{g(ae).type==="dashboard"?Fe(Ue):Fe(ye,!1)})}B(W,de)}),lc(Ee,W=>w(W),()=>w());var X=S(Ee,2);fv(X,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return c()},get onscan(){return e.onscan}});var ie=S(X,2),pe=_(ie);pe.__keydown=T;var _e=S(pe,2);{var Y=W=>{var ae=Ev();ae.__click=function(...be){var de;(de=e.onstop)==null||de.apply(this,be)},B(W,ae)},ne=W=>{var ae=Av();ae.__click=E,ce(be=>ae.disabled=be,[()=>!g(k).trim()]),B(W,ae)};he(_e,W=>{d()?W(Y):W(ne,!1)})}ce(()=>{ke.disabled=d(),pe.disabled=d()}),jo(pe,()=>g(k),W=>N(k,W)),B(t,se),gt()}Nt(["click","keydown"]);var Rv=U('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Pv(t,e){mt(e,!0);const r=!!navigator.gpu,a=uc();let i=Oe(zt(localStorage.getItem("selectedModel")||us[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),h=Oe(zt([])),v=Oe(zt([])),y=Oe(!1),x=Oe(null),w=Oe(null),k=Oe(null),M=Oe(null),T=Oe(null),E=Oe(null),F=Oe(!1),se=Oe(!1),re=!1;Gt(()=>{a.check(),a.isReady&&H();const Y=a.onMessage(ne=>{switch(ne.status){case"webgpu-info":N(M,ne.data,!0);break;case"loading":N(o,"loading"),N(d,ne.data,!0);break;case"initiate":N(h,[...g(h),ne],!0);break;case"progress":N(h,g(h).map(W=>W.file===ne.file?{...W,...ne}:W),!0);break;case"done":N(h,g(h).filter(W=>W.file!==ne.file),!0);break;case"ready":N(o,"ready"),H();break;case"start":if(!g(y))break;N(T,ne.phase||"preparing",!0),N(v,[...g(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!g(y))break;N(T,ne.phase,!0);break;case"thinking":{if(!g(y))break;N(x,ne.tps,!0),N(w,ne.numTokens,!0);const W=g(v)[g(v).length-1];N(v,[...g(v).slice(0,-1),{...W,thinking:(W.thinking||"")+ne.content}],!0),ke();break}case"thinking-done":{if(!g(y))break;N(x,ne.tps,!0),N(w,ne.numTokens,!0);const W=g(v)[g(v).length-1];N(v,[...g(v).slice(0,-1),{...W,thinking:ne.content}],!0);break}case"update":{if(!g(y))break;N(x,ne.tps,!0),N(w,ne.numTokens,!0);const W=g(v)[g(v).length-1];N(v,[...g(v).slice(0,-1),{...W,content:W.content+ne.output}],!0),ke();break}case"complete":if(!g(y))break;N(y,!1),N(T,null),J();break;case"error":if(!g(y))break;N(c,ne.data,!0),N(y,!1),N(T,null);break}});return()=>Y()});async function H(){if(!(re||g(v).length>0))try{const Y=await Fl();N(E,Y,!0),Y&&(re=!0,N(v,[{role:"assistant",type:"dashboard",pendingData:Y}],!0),ke());const ne=await po();N(F,ne.classified>0)}catch{}}async function J(){try{const Y=await Fl();N(E,Y,!0);const ne=g(v).findIndex(ae=>ae.type==="dashboard");ne!==-1&&(Y&&Y.total>0?N(v,g(v).map((ae,be)=>be===ne?{...ae,pendingData:Y}:ae),!0):N(v,g(v).filter((ae,be)=>be!==ne),!0));const W=await po();N(F,W.classified>0)}catch{}}async function te(Y){await ri(Y,"acted"),await J()}async function G(Y){await ri(Y,"dismissed"),await J()}async function me(Y){await xc(Y),await J()}async function Ie(Y){await kc(Y),await J()}async function Pe(){if(!(g(se)||!a.isReady)){N(se,!0);try{await wc(a,{count:20}),await J(),g(E)&&!g(v).some(Y=>Y.type==="dashboard")&&(N(v,[{role:"assistant",type:"dashboard",pendingData:g(E)},...g(v)],!0),ke())}catch(Y){console.error("Scan failed:",Y)}finally{N(se,!1)}}}function ke(){nc().then(()=>{g(k)&&(g(k).scrollTop=g(k).scrollHeight)})}function V(){N(o,"loading"),localStorage.setItem("selectedModel",g(i)),a.loadModel(g(i))}async function le(Y){if(!Y||g(y))return;N(v,[...g(v),{role:"user",content:Y}],!0),N(x,null),N(y,!0);let ne=[];try{const be=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Y)?await hp(Y):await vp();be&&(ne=[{role:"system",content:be}])}catch{}const W=g(v).filter(ae=>ae.type!=="dashboard").map(ae=>({role:ae.role,content:ae.content}));a.generate([...ne,...W]),ke()}function Ee(){a.interrupt()}function $(){a.reset(),N(v,[],!0),N(x,null),N(w,null),re=!1,H()}var oe=fa(),ue=tt(oe);{var X=Y=>{var ne=Rv();B(Y,ne)},ie=Y=>{Mp(Y,{get gpuInfo(){return g(M)},get error(){return g(c)},onload:V,get selectedModel(){return g(i)},set selectedModel(ne){N(i,ne,!0)}})},pe=Y=>{Kp(Y,{get message(){return g(d)},get items(){return g(h)}})},_e=Y=>{Iv(Y,{get messages(){return g(v)},get pendingData(){return g(E)},get hasScanData(){return g(F)},get engineReady(){return a.isReady},get isScanning(){return g(se)},get isRunning(){return g(y)},get tps(){return g(x)},get numTokens(){return g(w)},get generationPhase(){return g(T)},get gpuInfo(){return g(M)},onsend:le,onstop:Ee,onreset:$,onmarkacted:te,ondismiss:G,onremove:me,oncleargroup:Ie,onscan:Pe,get chatContainer(){return g(k)},set chatContainer(ne){N(k,ne,!0)}})};he(ue,Y=>{r?g(o)===null?Y(ie,1):g(o)==="loading"?Y(pe,2):Y(_e,!1):Y(X)})}B(t,oe),gt()}const Ul="https://accounts.google.com/gsi/client",Ov="https://www.googleapis.com/auth/gmail.readonly";let ho=null,Zs=null;function Dv(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Ul}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Ul,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Gl(t){await Dv(),ho=google.accounts.oauth2.initTokenClient({client_id:t,scope:Ov,callback:e=>{Zs&&(Zs(e),Zs=null)}})}function Mv(){return new Promise((t,e)=>{if(!ho){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Zs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},ho.requestAccessToken()})}function Lv(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Ft="gmail",Hl=8,Tc=50,Ec=100;async function Nv(t,{limit:e=Tc,onProgress:r=()=>{},signal:a}={}){var c;const i=await ze.syncState.get(Ft);if(i!=null&&i.historyId)try{return await Kv(t,i,r,a)}catch(d){if(d instanceof qo&&(d.status===404||d.code==="notFound")||((c=d.message)==null?void 0:c.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await ze.syncState.delete(Ft);else throw d}return await zv(t,e===0?1/0:e,r,a)}async function jv(t,{limit:e=Tc,onProgress:r=()=>{},signal:a}={}){const i=await ze.syncState.get(Ft);return i!=null&&i.oldestPageToken?await Fv(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function qv(){const t=await ze.syncState.get(Ft);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Bv(){await ze.transaction("rw",[ze.items,ze.syncState],async()=>{await ze.items.where("sourceType").equals(Ft).delete(),await ze.syncState.delete(Ft)})}async function zv(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),la(a);const i=await dc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){la(a);const x=e-o.length,w=await pc(t,{maxResults:Math.min(Ec,x),pageToken:c}),k=(w.messages||[]).map(M=>M.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=w.nextPageToken,!c||k.length===0)break}if(d=c||null,o.length===0)return await ze.syncState.put({sourceType:Ft,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:h,errors:v}=await Ac(t,o,r,a),y=await ze.items.where("sourceType").equals(Ft).count();return await ze.syncState.put({sourceType:Ft,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${h} messages`,current:h,total:h}),{added:h,deleted:0,errors:v}}async function Fv(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),la(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){la(i);const x=r-o.length,w=await pc(t,{maxResults:Math.min(Ec,x),pageToken:c}),k=(w.messages||[]).map(M=>M.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=w.nextPageToken,!c||k.length===0)break}if(d=c||null,o.length===0)return await ze.syncState.update(Ft,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:h,errors:v}=await Ac(t,o,a,i),y=await ze.items.where("sourceType").equals(Ft).count();return await ze.syncState.update(Ft,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${h} more (more available)`:`Downloaded ${h} more (all synced)`,current:y,total:y}),{added:h,errors:v}}async function Kv(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),la(a);let i=0,o=0,c=0,d,h=e.historyId;do{la(a);const y=await rp(t,{startHistoryId:e.historyId,pageToken:d});if(h=y.historyId||h,d=y.nextPageToken,!!y.history){for(const x of y.history){if(x.messagesAdded){const w=x.messagesAdded.map(M=>M.message.id),k=[...new Set(w.filter(M=>M))];if(k.length>0){const M=await Promise.allSettled(k.map(E=>vc(t,E))),T=[];for(const E of M)E.status==="fulfilled"?T.push(Cc(E.value)):c++;T.length>0&&(await ze.items.bulkPut(T),await Ic(T),i+=T.length)}}if(x.messagesDeleted){const w=x.messagesDeleted.map(k=>cc(Ft,k.message.id)).filter(k=>k);w.length>0&&(await ze.items.bulkDelete(w),o+=w.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const v=await ze.items.where("sourceType").equals(Ft).count();return await ze.syncState.put({sourceType:Ft,historyId:h,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:v,total:v}),{added:i,deleted:o,errors:c}}async function Ac(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Hl){la(a);const d=e.slice(c,c+Hl),h=await Promise.allSettled(d.map(y=>vc(t,y))),v=[];for(const y of h)y.status==="fulfilled"?v.push(Cc(y.value)):o++;v.length>0&&(await ze.items.bulkPut(v),await Ic(v)),i+=v.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Cc(t){const e=Ar(t,"From"),r=Ar(t,"To"),a=Ar(t,"Cc"),i=Ar(t,"Subject")||"(no subject)",o=Ar(t,"Date"),c=Ar(t,"Message-ID"),d=Ar(t,"In-Reply-To"),h=Ar(t,"References");let v;try{v=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{v=Date.now()}return{id:cc(Ft,t.id),sourceType:Ft,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:ap(t),htmlBody:sp(t),date:v,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:h,raw:t,syncedAt:Date.now()}}async function Ic(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Uv(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await ze.contacts.where("email").equals(r).first();if(o){const c={};a&&!o.name&&(c.name=a),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await ze.contacts.update(o.id,c)}else await ze.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Uv(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function la(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Gv=U(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Hv(t,e){mt(e,!0);let r=Re(e,"clientIdInput",15);Gt(()=>bn("SetupGuide"));let a=Oe(null);async function i(W){try{await navigator.clipboard.writeText(W),N(a,W,!0),setTimeout(()=>{N(a,null)},1500)}catch{const ae=document.createElement("input");ae.value=W,document.body.appendChild(ae),ae.select(),document.execCommand("copy"),document.body.removeChild(ae),N(a,W,!0),setTimeout(()=>{N(a,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var h=Gv(),v=_(h),y=S(_(v),4),x=S(_(y),6),w=S(_(x),2),k=S(_(w),2),M=S(_(k),2),T=_(M);T.__click=()=>i(o);var E=_(T);E.textContent="http://localhost:5173";var F=S(E,2),se=_(F),re=S(T,2);re.__click=()=>i(c);var H=_(re);H.textContent="https://cypherkitty.github.io";var J=S(H,2),te=_(J),G=S(k,2),me=S(_(G),2),Ie=_(me);Ie.__click=()=>i(o);var Pe=_(Ie);Pe.textContent="http://localhost:5173";var ke=S(Pe,2),V=_(ke),le=S(Ie,2);le.__click=()=>i(c);var Ee=_(le);Ee.textContent="https://cypherkitty.github.io";var $=S(Ee,2),oe=_($),ue=S(le,2);ue.__click=()=>i(d);var X=_(ue);X.textContent="https://cypherkitty.github.io/me-ai/";var ie=S(X,2),pe=_(ie),_e=S(y,2),Y=_(_e);Y.__keydown=W=>W.key==="Enter"&&e.onsave();var ne=S(Y,2);ne.__click=function(...W){var ae;(ae=e.onsave)==null||ae.apply(this,W)},ce(W=>{Q(se,g(a)===o?"â":"â§"),Q(te,g(a)===c?"â":"â§"),Q(V,g(a)===o?"â":"â§"),Q(oe,g(a)===c?"â":"â§"),Q(pe,g(a)===d?"â":"â§"),ne.disabled=W},[()=>!r().trim()]),jo(Y,r),B(t,h),gt()}Nt(["click","keydown"]);function Wv(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof qo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Yv=U('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Vv=U('<div class="error-card-title svelte-14buhqq"> </div>'),Xv=U('<p class="error-card-fix svelte-14buhqq"> </p>'),Qv=U('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),Zv=U('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),Jv=U('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Rc(t,e){mt(e,!0);let r=Re(e,"ondismiss",3,null),a=Re(e,"onsignout",3,null),i=pt(()=>Wv(e.error));Gt(()=>bn("ErrorCard"));var o=Jv(),c=_(o);{var d=F=>{var se=Yv(),re=_(se),H=_(re),J=S(re,2);J.__click=function(...te){var G;(G=r())==null||G.apply(this,te)},ce(()=>Q(H,g(i).title)),B(F,se)},h=F=>{var se=Vv(),re=_(se);ce(()=>Q(re,g(i).title)),B(F,se)};he(c,F=>{r()?F(d):F(h,!1)})}var v=S(c,2),y=_(v),x=S(v,2);{var w=F=>{var se=Xv(),re=_(se);ce(()=>Q(re,g(i).fix)),B(F,se)};he(x,F=>{g(i).fix&&F(w)})}var k=S(x,2);{var M=F=>{var se=Qv(),re=_(se);ce(()=>{oc(se,"href",g(i).link.url),Q(re,`${g(i).link.label??""} â`)}),B(F,se)};he(k,F=>{g(i).link&&F(M)})}var T=S(k,2);{var E=F=>{var se=Zv();se.__click=function(...re){var H;(H=a())==null||H.apply(this,re)},B(F,se)};he(T,F=>{g(i).action==="signout"&&a()&&F(E)})}ce(()=>Q(y,g(i).description)),B(t,o),gt()}Nt(["click"]);var $v=U('<span class="spinner svelte-nyqevv"></span> Signing in...',1),eh=Lo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),th=U(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function nh(t,e){mt(e,!0);let r=Re(e,"error",3,null),a=Re(e,"loadingAuth",3,!1);Gt(()=>bn("AuthCard"));var i=th(),o=_(i),c=S(_(o),4);{var d=E=>{Rc(E,{get error(){return r()},get onsignout(){return e.onsignout}})};he(c,E=>{r()&&E(d)})}var h=S(c,2);h.__click=function(...E){var F;(F=e.onsignin)==null||F.apply(this,E)};var v=_(h);{var y=E=>{var F=$v();B(E,F)},x=E=>{var F=eh();B(E,F)};he(v,E=>{a()?E(y):E(x,!1)})}var w=S(h,2),k=S(_(w),2),M=_(k),T=S(k,2);T.__click=function(...E){var F;(F=e.onclear)==null||F.apply(this,E)},ce(E=>{h.disabled=a(),Q(M,`${E??""}...`)},[()=>e.clientId.slice(0,20)]),B(t,i),gt()}Nt(["click"]);var rh=U('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),ah=U('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),sh=U('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function ih(t,e){mt(e,!0);let r=Re(e,"profile",3,null),a=Re(e,"loadingProfile",3,!1);Gt(()=>bn("ProfileCard"));var i=sh(),o=_(i),c=_(o),d=S(o,2),h=_(d);{var v=w=>{var k=rh();B(w,k)},y=w=>{var k=ah(),M=tt(k),T=_(M),E=S(M,2),F=_(E);ce((se,re)=>{Q(T,r().emailAddress),Q(F,`${se??""} messages
        Â· ${re??""} threads`)},[()=>{var se;return((se=r().messagesTotal)==null?void 0:se.toLocaleString())||"?"},()=>{var se;return((se=r().threadsTotal)==null?void 0:se.toLocaleString())||"?"}]),B(w,k)};he(h,w=>{a()?w(v):r()&&w(y,1)})}var x=S(d,2);x.__click=function(...w){var k;(k=e.onsignout)==null||k.apply(this,w)},ce(w=>Q(c,w),[()=>r()?mc(r().emailAddress):"?"]),B(t,i),gt()}Nt(["click"]);var oh=U('<span class="spinner svelte-1ds3j4k"></span>'),lh=Lo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),uh=U('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),ch=U('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),fh=U('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),dh=U('<option class="svelte-1ds3j4k"> </option>'),ph=U('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),vh=U('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),hh=U('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),mh=U('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),gh=U('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),yh=U('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function _h(t,e){mt(e,!0),Gt(()=>bn("SyncStatus"));let r=Re(e,"syncStatus",3,null),a=Re(e,"syncProgress",3,null),i=Re(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function h(X){if(!X)return"never";const ie=Math.floor((Date.now()-X)/1e3);if(ie<60)return"just now";const pe=Math.floor(ie/60);if(pe<60)return`${pe}m ago`;const _e=Math.floor(pe/60);return _e<24?`${_e}h ago`:`${Math.floor(_e/24)}d ago`}function v(){var X,ie;return!((X=a())!=null&&X.total)||!((ie=a())!=null&&ie.current)?0:Math.round(a().current/a().total*100)}var y=yh(),x=_(y),w=_(x),k=_(w);{var M=X=>{var ie=oh();B(X,ie)},T=X=>{var ie=lh();B(X,ie)};he(k,X=>{i()?X(M):X(T,!1)})}var E=S(w,2),F=S(_(E),2);{var se=X=>{var ie=uh(),pe=_(ie),_e=S(pe);{var Y=W=>{var ae=ti("Â· more available");B(W,ae)},ne=W=>{var ae=ti("Â· all synced");B(W,ae)};he(_e,W=>{r().hasMore?W(Y):W(ne,!1)})}ce((W,ae)=>Q(pe,`${W??""} emails stored
          Â· synced ${ae??""} `),[()=>r().totalItems.toLocaleString(),()=>h(r().lastSyncAt)]),B(X,ie)},re=X=>{var ie=ch();B(X,ie)};he(F,X=>{var ie;(ie=r())!=null&&ie.synced?X(se):X(re,!1)})}var H=S(E,2),J=_(H);{var te=X=>{var ie=fh();ie.__click=()=>N(o,!g(o)),B(X,ie)};he(J,X=>{var ie;(ie=r())!=null&&ie.synced&&!i()&&X(te)})}var G=S(x,2),me=_(G),Ie=S(_(me),2);fn(Ie,21,()=>d,_r,(X,ie)=>{var pe=dh(),_e=_(pe),Y={};ce(()=>{Q(_e,g(ie).label),Y!==(Y=g(ie).value)&&(pe.value=(pe.__value=g(ie).value)??"")}),B(X,pe)});var Pe=S(me,2),ke=_(Pe);{var V=X=>{var ie=vh(),pe=tt(ie);pe.__click=()=>e.onsync(g(c));var _e=_(pe),Y=S(pe,2);{var ne=W=>{var ae=ph();ae.__click=()=>e.onsyncmore(g(c));var be=_(ae);ce(()=>{ae.disabled=i(),Q(be,i()?"Loading...":"Sync More")}),B(W,ae)};he(Y,W=>{r().hasMore&&W(ne)})}ce(()=>{pe.disabled=i(),Q(_e,i()?"Syncing...":"Sync New")}),B(X,ie)},le=X=>{var ie=hh();ie.__click=()=>e.onsync(g(c));var pe=_(ie);ce(()=>{ie.disabled=i(),Q(pe,i()?"Syncing...":"Download Emails")}),B(X,ie)};he(ke,X=>{var ie;(ie=r())!=null&&ie.synced?X(V):X(le,!1)})}var Ee=S(G,2);{var $=X=>{var ie=mh(),pe=_(ie),_e=_(pe);let Y,ne;var W=S(pe,2),ae=_(W);ce(be=>{Y=Pt(_e,1,"progress-fill svelte-1ds3j4k",null,Y,{indeterminate:!a().total}),ne=cn(_e,"",ne,be),Q(ae,a().message||"Syncing...")},[()=>({width:`${v()??""}%`})]),B(X,ie)};he(Ee,X=>{i()&&a()&&X($)})}var oe=S(Ee,2);{var ue=X=>{var ie=gh(),pe=S(_(ie),2),_e=_(pe);_e.__click=()=>N(o,!1);var Y=S(_e,2);Y.__click=()=>{e.onclear(),N(o,!1)},B(X,ie)};he(oe,X=>{g(o)&&X(ue)})}ce(()=>Ie.disabled=i()),No(Ie,()=>g(c),X=>N(c,X)),B(t,y),gt()}Nt(["click"]);var bh=U('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),wh=U('<div class="message-list svelte-y2uamw"></div>');function kh(t,e){mt(e,!0);let r=Re(e,"messages",19,()=>[]);Gt(()=>bn("MessageList"));var a=wh();fn(a,21,r,_r,(i,o)=>{var c=bh();c.__click=()=>e.onselect(g(o));var d=_(c),h=_(d),v=S(d,2),y=_(v),x=_(y),w=_(x),k=S(x,2),M=_(k),T=S(y,2),E=_(T),F=S(T,2),se=_(F);ce((re,H,J)=>{Q(h,re),Q(w,H),Q(M,J),Q(E,g(o).subject),Q(se,g(o).snippet)},[()=>mc(g(o).from),()=>hc(g(o).from),()=>Bo(g(o).date)]),B(i,c)}),B(t,a),gt()}Nt(["click"]);function zo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var da=zo();function Pc(t){da=t}var Wr={exec:()=>null};function et(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Jt.caret,"$1"),r=r.replace(i,c),a},getRegex:()=>new RegExp(r,e)};return a}var xh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Jt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Sh=/^(?:[ \t]*(?:\n|$))+/,Th=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Eh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ys=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ah=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Fo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Oc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Dc=et(Oc).replace(/bull/g,Fo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Ch=et(Oc).replace(/bull/g,Fo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ko=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Ih=/^[^\n]+/,Uo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Rh=et(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Uo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ph=et(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Fo).getRegex(),vi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Go=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Oh=et("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Go).replace("tag",vi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Mc=et(Ko).replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vi).getRegex(),Dh=et(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Mc).getRegex(),Ho={blockquote:Dh,code:Th,def:Rh,fences:Eh,heading:Ah,hr:ys,html:Oh,lheading:Dc,list:Ph,newline:Sh,paragraph:Mc,table:Wr,text:Ih},Wl=et("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vi).getRegex(),Mh={...Ho,lheading:Ch,table:Wl,paragraph:et(Ko).replace("hr",ys).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",vi).getRegex()},Lh={...Ho,html:et(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Go).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:et(Ko).replace("hr",ys).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Dc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Nh=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jh=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Lc=/^( {2,}|\\)\n(?!\s*$)/,qh=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,hi=/[\p{P}\p{S}]/u,Wo=/[\s\p{P}\p{S}]/u,Nc=/[^\s\p{P}\p{S}]/u,Bh=et(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Wo).getRegex(),jc=/(?!~)[\p{P}\p{S}]/u,zh=/(?!~)[\s\p{P}\p{S}]/u,Fh=/(?:[^\s\p{P}\p{S}]|~)/u,qc=/(?![*_])[\p{P}\p{S}]/u,Kh=/(?![*_])[\s\p{P}\p{S}]/u,Uh=/(?:[^\s\p{P}\p{S}]|[*_])/u,Gh=et(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",xh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Bc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Hh=et(Bc,"u").replace(/punct/g,hi).getRegex(),Wh=et(Bc,"u").replace(/punct/g,jc).getRegex(),zc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Yh=et(zc,"gu").replace(/notPunctSpace/g,Nc).replace(/punctSpace/g,Wo).replace(/punct/g,hi).getRegex(),Vh=et(zc,"gu").replace(/notPunctSpace/g,Fh).replace(/punctSpace/g,zh).replace(/punct/g,jc).getRegex(),Xh=et("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Nc).replace(/punctSpace/g,Wo).replace(/punct/g,hi).getRegex(),Qh=et(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,qc).getRegex(),Zh="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Jh=et(Zh,"gu").replace(/notPunctSpace/g,Uh).replace(/punctSpace/g,Kh).replace(/punct/g,qc).getRegex(),$h=et(/\\(punct)/,"gu").replace(/punct/g,hi).getRegex(),em=et(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tm=et(Go).replace("(?:-->|$)","-->").getRegex(),nm=et("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ai=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,rm=et(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ai).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Fc=et(/^!?\[(label)\]\[(ref)\]/).replace("label",ai).replace("ref",Uo).getRegex(),Kc=et(/^!?\[(ref)\](?:\[\])?/).replace("ref",Uo).getRegex(),am=et("reflink|nolink(?!\\()","g").replace("reflink",Fc).replace("nolink",Kc).getRegex(),Yl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Yo={_backpedal:Wr,anyPunctuation:$h,autolink:em,blockSkip:Gh,br:Lc,code:jh,del:Wr,delLDelim:Wr,delRDelim:Wr,emStrongLDelim:Hh,emStrongRDelimAst:Yh,emStrongRDelimUnd:Xh,escape:Nh,link:rm,nolink:Kc,punctuation:Bh,reflink:Fc,reflinkSearch:am,tag:nm,text:qh,url:Wr},sm={...Yo,link:et(/^!?\[(label)\]\((.*?)\)/).replace("label",ai).getRegex(),reflink:et(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ai).getRegex()},mo={...Yo,emStrongRDelimAst:Vh,emStrongLDelim:Wh,delLDelim:Qh,delRDelim:Jh,url:et(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Yl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:et(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Yl).getRegex()},im={...mo,br:et(Lc).replace("{2,}","*").getRegex(),text:et(mo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ks={normal:Ho,gfm:Mh,pedantic:Lh},Va={normal:Yo,gfm:mo,breaks:im,pedantic:sm},om={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vl=t=>om[t];function ur(t,e){if(e){if(Jt.escapeTest.test(t))return t.replace(Jt.escapeReplace,Vl)}else if(Jt.escapeTestNoEncode.test(t))return t.replace(Jt.escapeReplaceNoEncode,Vl);return t}function Xl(t){try{t=encodeURI(t).replace(Jt.percentDecode,"%")}catch{return null}return t}function Ql(t,e){var o;let r=t.replace(Jt.findPipe,(c,d,h)=>{let v=!1,y=d;for(;--y>=0&&h[y]==="\\";)v=!v;return v?"|":" |"}),a=r.split(Jt.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Jt.slashPipe,"|");return a}function Xa(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function lm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function um(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function Zl(t,e,r,a,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,h}function cm(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var si=class{constructor(t){Ve(this,"options");Ve(this,"rules");Ve(this,"lexer");this.options=t||da}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Xa(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=cm(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Xa(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Xa(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Xa(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let c=!1,d=[],h;for(h=0;h<r.length;h++)if(this.rules.other.blockquoteStart.test(r[h]))d.push(r[h]),c=!0;else if(!c)d.push(r[h]);else break;r=r.slice(h);let v=d.join(`
`),y=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,i=i?`${i}
${y}`:y;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=x,r.length===0)break;let w=o.at(-1);if((w==null?void 0:w.type)==="code")break;if((w==null?void 0:w.type)==="blockquote"){let k=w,M=k.raw+`
`+r.join(`
`),T=this.blockquote(M);o[o.length-1]=T,a=a.substring(0,a.length-k.raw.length)+T.raw,i=i.substring(0,i.length-k.text.length)+T.text;break}else if((w==null?void 0:w.type)==="list"){let k=w,M=k.raw+`
`+r.join(`
`),T=this.list(M);o[o.length-1]=T,a=a.substring(0,a.length-w.raw.length)+T.raw,i=i.substring(0,i.length-k.raw.length)+T.raw,r=M.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),h=!1;for(;t;){let y=!1,x="",w="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let k=um(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],T=!k.trim(),E=0;if(this.options.pedantic?(E=2,w=k.trimStart()):T?E=e[1].length+1:(E=k.search(this.rules.other.nonSpaceChar),E=E>4?1:E,w=k.slice(E),E+=e[1].length),T&&this.rules.other.blankLine.test(M)&&(x+=M+`
`,t=t.substring(M.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(E),se=this.rules.other.hrRegex(E),re=this.rules.other.fencesBeginRegex(E),H=this.rules.other.headingBeginRegex(E),J=this.rules.other.htmlBeginRegex(E),te=this.rules.other.blockquoteBeginRegex(E);for(;t;){let G=t.split(`
`,1)[0],me;if(M=G,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),me=M):me=M.replace(this.rules.other.tabCharGlobal,"    "),re.test(M)||H.test(M)||J.test(M)||te.test(M)||F.test(M)||se.test(M))break;if(me.search(this.rules.other.nonSpaceChar)>=E||!M.trim())w+=`
`+me.slice(E);else{if(T||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||re.test(k)||H.test(k)||se.test(k))break;w+=`
`+M}T=!M.trim(),x+=G+`
`,t=t.substring(G.length+1),k=me.slice(E)}}c.loose||(h?c.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(h=!0)),c.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(w),loose:!1,text:w,tokens:[]}),c.raw+=x}let v=c.items.at(-1);if(v)v.raw=v.raw.trimEnd(),v.text=v.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let w=this.lexer.inlineQueue.length-1;w>=0;w--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[w].src)){this.lexer.inlineQueue[w].src=this.lexer.inlineQueue[w].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(y.raw);if(x){let w={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};y.checked=w.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=w.raw+y.tokens[0].raw,y.tokens[0].text=w.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(w)):y.tokens.unshift({type:"paragraph",raw:w.raw,text:w.raw,tokens:[w]}):y.tokens.unshift(w)}}if(!c.loose){let x=y.tokens.filter(k=>k.type==="space"),w=x.length>0&&x.some(k=>this.rules.other.anyLine.test(k.raw));c.loose=w}}if(c.loose)for(let y of c.items){y.loose=!0;for(let x of y.tokens)x.type==="text"&&(x.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Ql(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Ql(d,o.header.length).map((h,v)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[v]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Xa(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=lm(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Zl(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Zl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,h=0,v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(c=[...o].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&i%3&&!((i+c)%3)){h+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+h);let y=[...a[0]][0].length,x=t.slice(0,i+a.index+y+c);if(Math.min(i,c)%2){let k=x.slice(1,-1);return{type:"em",raw:x,text:k,tokens:this.lexer.inlineTokens(k)}}let w=x.slice(2,-2);return{type:"strong",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,h=this.rules.inline.delRDelim;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(c=[...o].length,c!==i))continue;if(a[3]||a[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let v=[...a[0]][0].length,y=t.slice(0,i+a.index+v+c),x=y.slice(i,-i);return{type:"del",raw:y,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Kn=class go{constructor(e){Ve(this,"tokens");Ve(this,"options");Ve(this,"state");Ve(this,"inlineQueue");Ve(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||da,this.options.tokenizer=this.options.tokenizer||new si,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Jt,block:Ks.normal,inline:Va.normal};this.options.pedantic?(r.block=Ks.pedantic,r.inline=Va.pedantic):this.options.gfm&&(r.block=Ks.gfm,this.options.breaks?r.inline=Va.breaks:r.inline=Va.gfm),this.tokenizer.rules=r}static get rules(){return{block:Ks,inline:Va}}static lex(e,r){return new go(r).lex(e)}static lexInline(e,r){return new go(r).inlineTokens(e)}lex(e){e=e.replace(Jt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Jt.tabCharGlobal,"    ").replace(Jt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(v=>(d=v.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let v=r.at(-1);d.raw.length===1&&v!==void 0?v.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.raw,this.inlineQueue.at(-1).src=v.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let h=e;if((c=this.options.extensions)!=null&&c.startBlock){let v=1/0,y=e.slice(1),x;this.options.extensions.startBlock.forEach(w=>{x=w.call({lexer:this},y),typeof x=="number"&&x>=0&&(v=Math.min(v,x))}),v<1/0&&v>=0&&(h=e.substring(0,v+1))}if(this.state.top&&(d=this.tokenizer.paragraph(h))){let v=r.at(-1);a&&(v==null?void 0:v.type)==="paragraph"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d),a=h.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var h,v,y,x,w;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((v=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:v.call({lexer:this},a))??a;let c=!1,d="";for(;e;){c||(d=""),c=!1;let k;if((x=(y=this.options.extensions)==null?void 0:y.inline)!=null&&x.some(T=>(k=T.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let T=r.at(-1);k.type==="text"&&(T==null?void 0:T.type)==="text"?(T.raw+=k.raw,T.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let M=e;if((w=this.options.extensions)!=null&&w.startInline){let T=1/0,E=e.slice(1),F;this.options.extensions.startInline.forEach(se=>{F=se.call({lexer:this},E),typeof F=="number"&&F>=0&&(T=Math.min(T,F))}),T<1/0&&T>=0&&(M=e.substring(0,T+1))}if(k=this.tokenizer.inlineText(M)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(d=k.raw.slice(-1)),c=!0;let T=r.at(-1);(T==null?void 0:T.type)==="text"?(T.raw+=k.raw,T.text+=k.text):r.push(k);continue}if(e){let T="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(T);break}else throw new Error(T)}}return r}},ii=class{constructor(t){Ve(this,"options");Ve(this,"parser");this.options=t||da}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Jt.notSpaceStart))==null?void 0:o[0],i=t.replace(Jt.endingNewline,"")+`
`;return a?'<pre><code class="language-'+ur(a)+'">'+(r?i:ur(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ur(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let c=0;c<t.items.length;c++){let d=t.items[c];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ur(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Xl(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ur(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Xl(t);if(i===null)return ur(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ur(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ur(t.text)}},Vo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Un=class yo{constructor(e){Ve(this,"options");Ve(this,"renderer");Ve(this,"textRenderer");this.options=e||da,this.options.renderer=this.options.renderer||new ii,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Vo}static parse(e,r){return new yo(r).parse(e)}static parseInline(e,r){return new yo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[c.type]){let h=c,v=this.options.extensions.renderers[h.type].call({parser:this},h);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){r+=v||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let h='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let v=this.options.extensions.renderers[d.type].call({parser:this},d);if(v!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=v||"";continue}}let h=d;switch(h.type){case"escape":{a+=r.text(h);break}case"html":{a+=r.html(h);break}case"link":{a+=r.link(h);break}case"image":{a+=r.image(h);break}case"checkbox":{a+=r.checkbox(h);break}case"strong":{a+=r.strong(h);break}case"em":{a+=r.em(h);break}case"codespan":{a+=r.codespan(h);break}case"br":{a+=r.br(h);break}case"del":{a+=r.del(h);break}case"text":{a+=r.text(h);break}default:{let v='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return a}},Hs,ns=(Hs=class{constructor(t){Ve(this,"options");Ve(this,"block");this.options=t||da}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Kn.lex:Kn.lexInline}provideParser(){return this.block?Un.parse:Un.parseInline}},Ve(Hs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ve(Hs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Hs),fm=class{constructor(...t){Ve(this,"defaults",zo());Ve(this,"options",this.setOptions);Ve(this,"parse",this.parseMarkdown(!0));Ve(this,"parseInline",this.parseMarkdown(!1));Ve(this,"Parser",Un);Ve(this,"Renderer",ii);Ve(this,"TextRenderer",Vo);Ve(this,"Lexer",Kn);Ve(this,"Tokenizer",si);Ve(this,"Hooks",ns);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let h of d)r=r.concat(this.walkTokens(h.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let h=c[d].flat(1/0);r=r.concat(this.walkTokens(h,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ii(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],h=i[c];i[c]=(...v)=>{let y=d.apply(i,v);return y===!1&&(y=h.apply(i,v)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new si(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],h=i[c];i[c]=(...v)=>{let y=d.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ns;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],h=i[c];ns.passThroughHooks.has(o)?i[c]=v=>{if(this.defaults.async&&ns.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,v);return h.call(i,x)})();let y=d.call(i,v);return h.call(i,y)}:i[c]=(...v)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,v);return x===!1&&(x=await h.apply(i,v)),x})();let y=d.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Kn.lex(t,e??this.defaults)}parser(t,e){return Un.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Kn.lex:Kn.lexInline)(c,i),h=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let v=await(i.hooks?await i.hooks.provideParser():t?Un.parse:Un.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(v):v})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Kn.lex:Kn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Un.parse:Un.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+ur(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ua=new fm;function st(t,e){return ua.parse(t,e)}st.options=st.setOptions=function(t){return ua.setOptions(t),st.defaults=ua.defaults,Pc(st.defaults),st};st.getDefaults=zo;st.defaults=da;st.use=function(...t){return ua.use(...t),st.defaults=ua.defaults,Pc(st.defaults),st};st.walkTokens=function(t,e){return ua.walkTokens(t,e)};st.parseInline=ua.parseInline;st.Parser=Un;st.parser=Un.parse;st.Renderer=ii;st.TextRenderer=Vo;st.Lexer=Kn;st.lexer=Kn.lex;st.Tokenizer=si;st.Hooks=ns;st.parse=st;st.options;st.setOptions;st.use;st.walkTokens;st.parseInline;Un.parse;Kn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Uc,setPrototypeOf:Jl,isFrozen:dm,getPrototypeOf:pm,getOwnPropertyDescriptor:vm}=Object;let{freeze:$t,seal:Dn,create:_o}=Object,{apply:bo,construct:wo}=typeof Reflect<"u"&&Reflect;$t||($t=function(e){return e});Dn||(Dn=function(e){return e});bo||(bo=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});wo||(wo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Us=en(Array.prototype.forEach),hm=en(Array.prototype.lastIndexOf),$l=en(Array.prototype.pop),Qa=en(Array.prototype.push),mm=en(Array.prototype.splice),Js=en(String.prototype.toLowerCase),Yi=en(String.prototype.toString),Vi=en(String.prototype.match),Za=en(String.prototype.replace),gm=en(String.prototype.indexOf),ym=en(String.prototype.trim),zn=en(Object.prototype.hasOwnProperty),Zt=en(RegExp.prototype.test),Ja=_m(TypeError);function en(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return bo(t,e,a)}}function _m(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return wo(t,r)}}function Ye(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Js;Jl&&Jl(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(dm(e)||(e[a]=o),i=o)}t[i]=!0}return t}function bm(t){for(let e=0;e<t.length;e++)zn(t,e)||(t[e]=null);return t}function Zn(t){const e=_o(null);for(const[r,a]of Uc(t))zn(t,r)&&(Array.isArray(a)?e[r]=bm(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=Zn(a):e[r]=a);return e}function $a(t,e){for(;t!==null;){const a=vm(t,e);if(a){if(a.get)return en(a.get);if(typeof a.value=="function")return en(a.value)}t=pm(t)}function r(){return null}return r}const eu=$t(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xi=$t(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qi=$t(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wm=$t(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Zi=$t(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),km=$t(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tu=$t(["#text"]),nu=$t(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ji=$t(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ru=$t(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Gs=$t(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xm=Dn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Sm=Dn(/<%[\w\W]*|[\w\W]*%>/gm),Tm=Dn(/\$\{[\w\W]*/gm),Em=Dn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Am=Dn(/^aria-[\-\w]+$/),Gc=Dn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Cm=Dn(/^(?:\w+script|data):/i),Im=Dn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hc=Dn(/^html$/i),Rm=Dn(/^[a-z][.\w]*(-[.\w]+)+$/i);var au=Object.freeze({__proto__:null,ARIA_ATTR:Am,ATTR_WHITESPACE:Im,CUSTOM_ELEMENT:Rm,DATA_ATTR:Em,DOCTYPE_NAME:Hc,ERB_EXPR:Sm,IS_ALLOWED_URI:Gc,IS_SCRIPT_OR_DATA:Cm,MUSTACHE_EXPR:xm,TMPLIT_EXPR:Tm});const es={element:1,text:3,progressingInstruction:7,comment:8,document:9},Pm=function(){return typeof window>"u"?null:window},Om=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},su=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Wc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pm();const e=Ne=>Wc(Ne);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==es.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:h,NodeFilter:v,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:w,trustedTypes:k}=t,M=h.prototype,T=$a(M,"cloneNode"),E=$a(M,"remove"),F=$a(M,"nextSibling"),se=$a(M,"childNodes"),re=$a(M,"parentNode");if(typeof c=="function"){const Ne=r.createElement("template");Ne.content&&Ne.content.ownerDocument&&(r=Ne.content.ownerDocument)}let H,J="";const{implementation:te,createNodeIterator:G,createDocumentFragment:me,getElementsByTagName:Ie}=r,{importNode:Pe}=a;let ke=su();e.isSupported=typeof Uc=="function"&&typeof re=="function"&&te&&te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:V,ERB_EXPR:le,TMPLIT_EXPR:Ee,DATA_ATTR:$,ARIA_ATTR:oe,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:ie}=au;let{IS_ALLOWED_URI:pe}=au,_e=null;const Y=Ye({},[...eu,...Xi,...Qi,...Zi,...tu]);let ne=null;const W=Ye({},[...nu,...Ji,...ru,...Gs]);let ae=Object.seal(_o(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),be=null,de=null;const je=Object.seal(_o(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ue=!0,ye=!0,Fe=!1,qe=!0,We=!1,vt=!0,lt=!1,Qe=!1,it=!1,_t=!1,Xt=!1,jt=!1,Rt=!0,ar=!1;const xt="user-content-";let Qt=!0,Ct=!1,ct={},yt=null;const dn=Ye({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let tn=null;const wn=Ye({},["audio","video","img","source","image","track"]);let nn=null;const pn=Ye({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),kn="http://www.w3.org/1998/Math/MathML",Mn="http://www.w3.org/2000/svg",Ot="http://www.w3.org/1999/xhtml";let Le=Ot,sr=!1,Ln=null;const pa=Ye({},[kn,Mn,Ot],Yi);let Ae=Ye({},["mi","mo","mn","ms","mtext"]),br=Ye({},["annotation-xml"]);const _s=Ye({},["title","style","font","a","script"]);let ir=null;const bs=["application/xhtml+xml","text/html"],La="text/html";let St=null,wr=null;const kr=r.createElement("form"),or=function(C){return C instanceof RegExp||C instanceof Function},Lr=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wr&&wr===C)){if((!C||typeof C!="object")&&(C={}),C=Zn(C),ir=bs.indexOf(C.PARSER_MEDIA_TYPE)===-1?La:C.PARSER_MEDIA_TYPE,St=ir==="application/xhtml+xml"?Yi:Js,_e=zn(C,"ALLOWED_TAGS")?Ye({},C.ALLOWED_TAGS,St):Y,ne=zn(C,"ALLOWED_ATTR")?Ye({},C.ALLOWED_ATTR,St):W,Ln=zn(C,"ALLOWED_NAMESPACES")?Ye({},C.ALLOWED_NAMESPACES,Yi):pa,nn=zn(C,"ADD_URI_SAFE_ATTR")?Ye(Zn(pn),C.ADD_URI_SAFE_ATTR,St):pn,tn=zn(C,"ADD_DATA_URI_TAGS")?Ye(Zn(wn),C.ADD_DATA_URI_TAGS,St):wn,yt=zn(C,"FORBID_CONTENTS")?Ye({},C.FORBID_CONTENTS,St):dn,be=zn(C,"FORBID_TAGS")?Ye({},C.FORBID_TAGS,St):Zn({}),de=zn(C,"FORBID_ATTR")?Ye({},C.FORBID_ATTR,St):Zn({}),ct=zn(C,"USE_PROFILES")?C.USE_PROFILES:!1,Ue=C.ALLOW_ARIA_ATTR!==!1,ye=C.ALLOW_DATA_ATTR!==!1,Fe=C.ALLOW_UNKNOWN_PROTOCOLS||!1,qe=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,We=C.SAFE_FOR_TEMPLATES||!1,vt=C.SAFE_FOR_XML!==!1,lt=C.WHOLE_DOCUMENT||!1,_t=C.RETURN_DOM||!1,Xt=C.RETURN_DOM_FRAGMENT||!1,jt=C.RETURN_TRUSTED_TYPE||!1,it=C.FORCE_BODY||!1,Rt=C.SANITIZE_DOM!==!1,ar=C.SANITIZE_NAMED_PROPS||!1,Qt=C.KEEP_CONTENT!==!1,Ct=C.IN_PLACE||!1,pe=C.ALLOWED_URI_REGEXP||Gc,Le=C.NAMESPACE||Ot,Ae=C.MATHML_TEXT_INTEGRATION_POINTS||Ae,br=C.HTML_INTEGRATION_POINTS||br,ae=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&or(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ae.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&or(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ae.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ae.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),We&&(ye=!1),Xt&&(_t=!0),ct&&(_e=Ye({},tu),ne=[],ct.html===!0&&(Ye(_e,eu),Ye(ne,nu)),ct.svg===!0&&(Ye(_e,Xi),Ye(ne,Ji),Ye(ne,Gs)),ct.svgFilters===!0&&(Ye(_e,Qi),Ye(ne,Ji),Ye(ne,Gs)),ct.mathMl===!0&&(Ye(_e,Zi),Ye(ne,ru),Ye(ne,Gs))),C.ADD_TAGS&&(typeof C.ADD_TAGS=="function"?je.tagCheck=C.ADD_TAGS:(_e===Y&&(_e=Zn(_e)),Ye(_e,C.ADD_TAGS,St))),C.ADD_ATTR&&(typeof C.ADD_ATTR=="function"?je.attributeCheck=C.ADD_ATTR:(ne===W&&(ne=Zn(ne)),Ye(ne,C.ADD_ATTR,St))),C.ADD_URI_SAFE_ATTR&&Ye(nn,C.ADD_URI_SAFE_ATTR,St),C.FORBID_CONTENTS&&(yt===dn&&(yt=Zn(yt)),Ye(yt,C.FORBID_CONTENTS,St)),C.ADD_FORBID_CONTENTS&&(yt===dn&&(yt=Zn(yt)),Ye(yt,C.ADD_FORBID_CONTENTS,St)),Qt&&(_e["#text"]=!0),lt&&Ye(_e,["html","head","body"]),_e.table&&(Ye(_e,["tbody"]),delete be.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ja('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=C.TRUSTED_TYPES_POLICY,J=H.createHTML("")}else H===void 0&&(H=Om(k,i)),H!==null&&typeof J=="string"&&(J=H.createHTML(""));$t&&$t(C),wr=C}},Nr=Ye({},[...Xi,...Qi,...wm]),ut=Ye({},[...Zi,...km]),It=function(C){let ge=re(C);(!ge||!ge.tagName)&&(ge={namespaceURI:Le,tagName:"template"});const xe=Js(C.tagName),nt=Js(ge.tagName);return Ln[C.namespaceURI]?C.namespaceURI===Mn?ge.namespaceURI===Ot?xe==="svg":ge.namespaceURI===kn?xe==="svg"&&(nt==="annotation-xml"||Ae[nt]):!!Nr[xe]:C.namespaceURI===kn?ge.namespaceURI===Ot?xe==="math":ge.namespaceURI===Mn?xe==="math"&&br[nt]:!!ut[xe]:C.namespaceURI===Ot?ge.namespaceURI===Mn&&!br[nt]||ge.namespaceURI===kn&&!Ae[nt]?!1:!ut[xe]&&(_s[xe]||!Nr[xe]):!!(ir==="application/xhtml+xml"&&Ln[C.namespaceURI]):!1},xn=function(C){Qa(e.removed,{element:C});try{re(C).removeChild(C)}catch{E(C)}},Sn=function(C,ge){try{Qa(e.removed,{attribute:ge.getAttributeNode(C),from:ge})}catch{Qa(e.removed,{attribute:null,from:ge})}if(ge.removeAttribute(C),C==="is")if(_t||Xt)try{xn(ge)}catch{}else try{ge.setAttribute(C,"")}catch{}},jr=function(C){let ge=null,xe=null;if(it)C="<remove></remove>"+C;else{const bt=Vi(C,/^[\r\n\t ]+/);xe=bt&&bt[0]}ir==="application/xhtml+xml"&&Le===Ot&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const nt=H?H.createHTML(C):C;if(Le===Ot)try{ge=new w().parseFromString(nt,ir)}catch{}if(!ge||!ge.documentElement){ge=te.createDocument(Le,"template",null);try{ge.documentElement.innerHTML=sr?J:nt}catch{}}const ft=ge.body||ge.documentElement;return C&&xe&&ft.insertBefore(r.createTextNode(xe),ft.childNodes[0]||null),Le===Ot?Ie.call(ge,lt?"html":"body")[0]:lt?ge.documentElement:ft},qr=function(C){return G.call(C.ownerDocument||C,C,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},Na=function(C){return C instanceof x&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof y)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Nn=function(C){return typeof d=="function"&&C instanceof d};function Ht(Ne,C,ge){Us(Ne,xe=>{xe.call(e,C,ge,wr)})}const jn=function(C){let ge=null;if(Ht(ke.beforeSanitizeElements,C,null),Na(C))return xn(C),!0;const xe=St(C.nodeName);if(Ht(ke.uponSanitizeElement,C,{tagName:xe,allowedTags:_e}),vt&&C.hasChildNodes()&&!Nn(C.firstElementChild)&&Zt(/<[/\w!]/g,C.innerHTML)&&Zt(/<[/\w!]/g,C.textContent)||C.nodeType===es.progressingInstruction||vt&&C.nodeType===es.comment&&Zt(/<[/\w]/g,C.data))return xn(C),!0;if(!(je.tagCheck instanceof Function&&je.tagCheck(xe))&&(!_e[xe]||be[xe])){if(!be[xe]&&ws(xe)&&(ae.tagNameCheck instanceof RegExp&&Zt(ae.tagNameCheck,xe)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(xe)))return!1;if(Qt&&!yt[xe]){const nt=re(C)||C.parentNode,ft=se(C)||C.childNodes;if(ft&&nt){const bt=ft.length;for(let Tt=bt-1;Tt>=0;--Tt){const rn=T(ft[Tt],!0);rn.__removalCount=(C.__removalCount||0)+1,nt.insertBefore(rn,F(C))}}}return xn(C),!0}return C instanceof h&&!It(C)||(xe==="noscript"||xe==="noembed"||xe==="noframes")&&Zt(/<\/no(script|embed|frames)/i,C.innerHTML)?(xn(C),!0):(We&&C.nodeType===es.text&&(ge=C.textContent,Us([V,le,Ee],nt=>{ge=Za(ge,nt," ")}),C.textContent!==ge&&(Qa(e.removed,{element:C.cloneNode()}),C.textContent=ge)),Ht(ke.afterSanitizeElements,C,null),!1)},Br=function(C,ge,xe){if(Rt&&(ge==="id"||ge==="name")&&(xe in r||xe in kr))return!1;if(!(ye&&!de[ge]&&Zt($,ge))){if(!(Ue&&Zt(oe,ge))){if(!(je.attributeCheck instanceof Function&&je.attributeCheck(ge,C))){if(!ne[ge]||de[ge]){if(!(ws(C)&&(ae.tagNameCheck instanceof RegExp&&Zt(ae.tagNameCheck,C)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(C))&&(ae.attributeNameCheck instanceof RegExp&&Zt(ae.attributeNameCheck,ge)||ae.attributeNameCheck instanceof Function&&ae.attributeNameCheck(ge,C))||ge==="is"&&ae.allowCustomizedBuiltInElements&&(ae.tagNameCheck instanceof RegExp&&Zt(ae.tagNameCheck,xe)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(xe))))return!1}else if(!nn[ge]){if(!Zt(pe,Za(xe,X,""))){if(!((ge==="src"||ge==="xlink:href"||ge==="href")&&C!=="script"&&gm(xe,"data:")===0&&tn[C])){if(!(Fe&&!Zt(ue,Za(xe,X,"")))){if(xe)return!1}}}}}}}return!0},ws=function(C){return C!=="annotation-xml"&&Vi(C,ie)},qn=function(C){Ht(ke.beforeSanitizeAttributes,C,null);const{attributes:ge}=C;if(!ge||Na(C))return;const xe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ne,forceKeepAttr:void 0};let nt=ge.length;for(;nt--;){const ft=ge[nt],{name:bt,namespaceURI:Tt,value:rn}=ft,Vn=St(bt),zr=rn;let ht=bt==="value"?zr:ym(zr);if(xe.attrName=Vn,xe.attrValue=ht,xe.keepAttr=!0,xe.forceKeepAttr=void 0,Ht(ke.uponSanitizeAttribute,C,xe),ht=xe.attrValue,ar&&(Vn==="id"||Vn==="name")&&(Sn(bt,C),ht=xt+ht),vt&&Zt(/((--!?|])>)|<\/(style|title|textarea)/i,ht)){Sn(bt,C);continue}if(Vn==="attributename"&&Vi(ht,"href")){Sn(bt,C);continue}if(xe.forceKeepAttr)continue;if(!xe.keepAttr){Sn(bt,C);continue}if(!qe&&Zt(/\/>/i,ht)){Sn(bt,C);continue}We&&Us([V,le,Ee],Fr=>{ht=Za(ht,Fr," ")});const ja=St(C.nodeName);if(!Br(ja,Vn,ht)){Sn(bt,C);continue}if(H&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!Tt)switch(k.getAttributeType(ja,Vn)){case"TrustedHTML":{ht=H.createHTML(ht);break}case"TrustedScriptURL":{ht=H.createScriptURL(ht);break}}if(ht!==zr)try{Tt?C.setAttributeNS(Tt,bt,ht):C.setAttribute(bt,ht),Na(C)?xn(C):$l(e.removed)}catch{Sn(bt,C)}}Ht(ke.afterSanitizeAttributes,C,null)},ks=function Ne(C){let ge=null;const xe=qr(C);for(Ht(ke.beforeSanitizeShadowDOM,C,null);ge=xe.nextNode();)Ht(ke.uponSanitizeShadowNode,ge,null),jn(ge),qn(ge),ge.content instanceof o&&Ne(ge.content);Ht(ke.afterSanitizeShadowDOM,C,null)};return e.sanitize=function(Ne){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ge=null,xe=null,nt=null,ft=null;if(sr=!Ne,sr&&(Ne="<!-->"),typeof Ne!="string"&&!Nn(Ne))if(typeof Ne.toString=="function"){if(Ne=Ne.toString(),typeof Ne!="string")throw Ja("dirty is not a string, aborting")}else throw Ja("toString is not a function");if(!e.isSupported)return Ne;if(Qe||Lr(C),e.removed=[],typeof Ne=="string"&&(Ct=!1),Ct){if(Ne.nodeName){const rn=St(Ne.nodeName);if(!_e[rn]||be[rn])throw Ja("root node is forbidden and cannot be sanitized in-place")}}else if(Ne instanceof d)ge=jr("<!---->"),xe=ge.ownerDocument.importNode(Ne,!0),xe.nodeType===es.element&&xe.nodeName==="BODY"||xe.nodeName==="HTML"?ge=xe:ge.appendChild(xe);else{if(!_t&&!We&&!lt&&Ne.indexOf("<")===-1)return H&&jt?H.createHTML(Ne):Ne;if(ge=jr(Ne),!ge)return _t?null:jt?J:""}ge&&it&&xn(ge.firstChild);const bt=qr(Ct?Ne:ge);for(;nt=bt.nextNode();)jn(nt),qn(nt),nt.content instanceof o&&ks(nt.content);if(Ct)return Ne;if(_t){if(Xt)for(ft=me.call(ge.ownerDocument);ge.firstChild;)ft.appendChild(ge.firstChild);else ft=ge;return(ne.shadowroot||ne.shadowrootmode)&&(ft=Pe.call(a,ft,!0)),ft}let Tt=lt?ge.outerHTML:ge.innerHTML;return lt&&_e["!doctype"]&&ge.ownerDocument&&ge.ownerDocument.doctype&&ge.ownerDocument.doctype.name&&Zt(Hc,ge.ownerDocument.doctype.name)&&(Tt="<!DOCTYPE "+ge.ownerDocument.doctype.name+`>
`+Tt),We&&Us([V,le,Ee],rn=>{Tt=Za(Tt,rn," ")}),H&&jt?H.createHTML(Tt):Tt},e.setConfig=function(){let Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lr(Ne),Qe=!0},e.clearConfig=function(){wr=null,Qe=!1},e.isValidAttribute=function(Ne,C,ge){wr||Lr({});const xe=St(Ne),nt=St(C);return Br(xe,nt,ge)},e.addHook=function(Ne,C){typeof C=="function"&&Qa(ke[Ne],C)},e.removeHook=function(Ne,C){if(C!==void 0){const ge=hm(ke[Ne],C);return ge===-1?void 0:mm(ke[Ne],ge,1)[0]}return $l(ke[Ne])},e.removeHooks=function(Ne){ke[Ne]=[]},e.removeAllHooks=function(){ke=su()},e}var Dm=Wc();function Mm(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${iu(t.from)} |`),e.push(`| **To** | ${iu(t.to)} |`),e.push(`| **Date** | ${Bo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Lm(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function iu(t){return(t||"").replace(/\|/g,"\\|")}function Lm(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return ko(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Nm(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function ko(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return Nm(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(ko).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>ko(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function jm(t){return gc(t,"md")}function ou(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function qm(t){return t.raw||null}function Bm(t){const e=qm(t);return e?JSON.stringify(e,null,2):"null"}function zm(t){return gc(t,"json")}var Fm=U('<button title="View as Markdown">.md</button>'),Km=U('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Um=U('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Gm=U('<div class="md-preview svelte-1b0rzpb"><!></div>'),Hm=U('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Wm=U('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Ym=U('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Vm=U('<pre class="message-text svelte-1b0rzpb"> </pre>'),Xm=U('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),Qm=U('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Zm=U('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Jm(t,e){mt(e,!0);let r=Re(e,"loading",3,!1);Gt(()=>bn("MessageModal"));const a=new st.Renderer;a.link=({href:V,title:le,text:Ee})=>{const $=le?` title="${le}"`:"";return`<a href="${V}"${$} target="_blank" rel="noopener">${Ee}</a>`},st.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Oe("email"),o=pt(()=>e.message.body?Mm(e.message):""),c=pt(()=>Bm(e.message)),d=Oe("raw");function h(V){N(i,g(i)===V?"email":V,!0),V==="markdown"&&N(d,"raw")}function v(){ou(g(o),jm(e.message))}function y(){ou(g(c),zm(e.message),"application/json;charset=utf-8")}function x(V){const le=st.parse(V);return Dm.sanitize(le,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let w=Oe(null);ei(()=>{var V;if(g(w)&&e.message.htmlBody&&!r()&&g(i)==="email"){const le=g(w).contentDocument||((V=g(w).contentWindow)==null?void 0:V.document);le&&(le.open(),le.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),le.close())}});var k=Zm();k.__click=function(...V){var le;(le=e.onclose)==null||le.apply(this,V)};var M=_(k);M.__click=V=>V.stopPropagation();var T=_(M),E=_(T),F=_(E),se=S(E,2),re=_(se);let H;re.__click=()=>h("json");var J=S(re,2);{var te=V=>{var le=Fm();let Ee;le.__click=()=>h("markdown"),ce(()=>Ee=Pt(le,1,"action-btn svelte-1b0rzpb",null,Ee,{active:g(i)==="markdown"})),B(V,le)};he(J,V=>{e.message.body&&V(te)})}var G=S(J,2);G.__click=function(...V){var le;(le=e.onclose)==null||le.apply(this,V)};var me=S(T,2);{var Ie=V=>{var le=Km(),Ee=tt(le),$=S(_(Ee),2);$.__click=y;var oe=S(Ee,2),ue=_(oe),X=_(ue);ce(()=>Q(X,g(c))),B(V,le)},Pe=V=>{var le=Hm(),Ee=tt(le),$=_(Ee),oe=_($);let ue;oe.__click=()=>N(d,"raw");var X=S(oe,2);let ie;X.__click=()=>N(d,"preview");var pe=S($,2);pe.__click=v;var _e=S(Ee,2),Y=_(_e);{var ne=ae=>{var be=Um(),de=_(be);ce(()=>Q(de,g(o))),B(ae,be)},W=ae=>{var be=Gm(),de=_(be);qd(de,()=>x(g(o))),B(ae,be)};he(Y,ae=>{g(d)==="raw"?ae(ne):ae(W,!1)})}ce(()=>{ue=Pt(oe,1,"md-tab svelte-1b0rzpb",null,ue,{active:g(d)==="raw"}),ie=Pt(X,1,"md-tab svelte-1b0rzpb",null,ie,{active:g(d)==="preview"})}),B(V,le)},ke=V=>{var le=Qm(),Ee=tt(le),$=_(Ee),oe=S(_($),2),ue=_(oe),X=S($,2),ie=S(_(X),2),pe=_(ie),_e=S(X,2),Y=S(_(_e),2),ne=_(Y),W=S(Ee,2),ae=_(W);{var be=ye=>{var Fe=Wm();B(ye,Fe)},de=ye=>{var Fe=Ym();lc(Fe,qe=>N(w,qe),()=>g(w)),B(ye,Fe)},je=ye=>{var Fe=Vm(),qe=_(Fe);ce(()=>Q(qe,e.message.body)),B(ye,Fe)},Ue=ye=>{var Fe=Xm();B(ye,Fe)};he(ae,ye=>{r()?ye(be):e.message.htmlBody?ye(de,1):e.message.body?ye(je,2):ye(Ue,!1)})}ce(ye=>{Q(ue,e.message.from),Q(pe,e.message.to),Q(ne,ye)},[()=>Bo(e.message.date)]),B(V,le)};he(me,V=>{g(i)==="json"?V(Ie):g(i)==="markdown"?V(Pe,1):V(ke,!1)})}ce(()=>{Q(F,e.message.subject),H=Pt(re,1,"action-btn svelte-1b0rzpb",null,H,{active:g(i)==="json"})}),B(t,k),gt()}Nt(["click"]);var $m=U('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),eg=U('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),tg=U('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),ng=U("<p> </p>"),rg=U('<p>No emails in local storage. Click "Sync New" to download.</p>'),ag=U('<div class="empty-state svelte-6ts5xm"><!></div>'),sg=U('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),ig=U('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function og(t,e){mt(e,!0),Gt(()=>bn("DashboardView"));let r=Re(e,"error",3,null),a=Re(e,"profile",3,null),i=Re(e,"loadingProfile",3,!1),o=Re(e,"emailMessages",19,()=>[]),c=Re(e,"totalLocalMessages",3,0),d=Re(e,"hasMoreLocal",3,!1),h=Re(e,"loadingMessages",3,!1),v=Re(e,"selectedMessage",3,null),y=Re(e,"syncStatus",3,null),x=Re(e,"syncProgress",3,null),w=Re(e,"isSyncing",3,!1),k=Re(e,"searchQuery",15);var M=ig(),T=tt(M),E=_(T);{var F=$=>{Rc($,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};he(E,$=>{r()&&$(F)})}var se=S(E,2);ih(se,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var re=S(se,2);_h(re,{get syncStatus(){return y()},get syncProgress(){return x()},get isSyncing(){return w()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var H=S(re,2),J=_(H);J.__keydown=$=>$.key==="Enter"&&e.onsearch();var te=S(J,2);te.__click=function(...$){var oe;(oe=e.onsearch)==null||oe.apply(this,$)};var G=_(te),me=S(H,2);{var Ie=$=>{var oe=eg(),ue=tt(oe),X=_(ue),ie=_(X),pe=S(ue,2);kh(pe,{get messages(){return o()},get onselect(){return e.onviewmessage}});var _e=S(pe,2);{var Y=ne=>{var W=$m(),ae=_(W);ae.__click=function(...de){var je;(je=e.onloadmore)==null||je.apply(this,de)};var be=_(ae);ce(()=>{ae.disabled=h(),Q(be,h()?"Loading...":"Load More")}),B(ne,W)};he(_e,ne=>{d()&&ne(Y)})}ce(ne=>Q(ie,`Showing ${o().length??""} of ${ne??""}
        ${k()?" matching":""} emails`),[()=>c().toLocaleString()]),B($,oe)},Pe=$=>{var oe=tg();B($,oe)},ke=$=>{var oe=ag(),ue=_(oe);{var X=pe=>{var _e=ng(),Y=_(_e);ce(()=>Q(Y,`No emails match "${k()??""}".`)),B(pe,_e)},ie=pe=>{var _e=rg();B(pe,_e)};he(ue,pe=>{k()?pe(X):pe(ie,!1)})}B($,oe)},V=$=>{var oe=sg();B($,oe)};he(me,$=>{var oe;o().length>0?$(Ie):h()?$(Pe,1):(oe=y())!=null&&oe.synced?$(ke,2):$(V,!1)})}var le=S(T,2);{var Ee=$=>{Jm($,{get message(){return v()},loading:!1,get onclose(){return e.onclosedetail}})};he(le,$=>{v()&&$(Ee)})}ce(()=>{te.disabled=h(),Q(G,h()?"Searching...":"Search")}),jo(J,k),B(t,M),gt()}Nt(["keydown","click"]);var lg=U('<div class="dashboard svelte-1q5o2lv"><!></div>');function ug(t,e){mt(e,!0);function r(de){de.key==="Escape"&&g(h)&&ue()}Gt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Oe(zt(localStorage.getItem("googleClientId")||"")),i=Oe(zt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),h=Oe(null),v=Oe(""),y=Oe(zt([])),x=Oe(0),w=Oe(0),k=Oe(!1),M=Oe(!1),T=Oe(!1),E=Oe(null),F=Oe(null),se=Oe(null),re=Oe(!1);const H=50;ei(()=>{g(c)&&(X(),le())});let J=pt(()=>!g(a)),te=pt(()=>!!g(c)),G=pt(()=>g(y).length<g(x));ei(()=>{g(a)&&!g(o)&&Gl(g(a)).then(()=>{N(o,!0)}).catch(de=>{N(E,`Auth init failed: ${de.message}`)})});function me(){const de=g(i).trim();de&&(localStorage.setItem("googleClientId",de),N(a,de,!0),N(E,null))}function Ie(){localStorage.removeItem("googleClientId"),N(a,""),N(i,""),N(o,!1),N(c,null),N(d,null),N(y,[],!0),N(x,0)}async function Pe(){N(E,null),N(M,!0);try{g(o)||(await Gl(g(a)),N(o,!0));const de=await Mv();N(c,de.access_token,!0),await V()}catch(de){N(E,de.message,!0)}finally{N(M,!1)}}async function ke(){if(g(c))try{await Lv(g(c))}catch{}N(c,null),N(d,null),N(y,[],!0),N(x,0),N(h,null),N(E,null)}async function V(){N(T,!0);try{const de=await dc(g(c));if(!g(c))return;N(d,de,!0)}catch(de){if(!g(c))return;N(E,`Profile fetch failed: ${de.message}`)}finally{N(T,!1)}}async function le(de=!1){N(k,!0);try{const je=de?g(w):0,Ue=await pp({query:g(v)||void 0,limit:H,offset:je});de?N(y,[...g(y),...Ue.items],!0):N(y,Ue.items,!0),N(x,Ue.total,!0),N(w,g(y).length,!0)}catch(je){N(E,`Failed to load messages: ${je.message}`)}finally{N(k,!1)}}function Ee(){N(w,0),le(!1)}function $(){le(!0)}function oe(de){N(h,de,!0)}function ue(){N(h,null)}async function X(){try{N(F,await qv(),!0)}catch{}}async function ie(de){if(g(re)||!g(c))return;N(E,null),N(re,!0),N(se,null);const je=new AbortController;try{await Nv(g(c),{limit:de,onProgress:Ue=>{N(se,{...Ue},!0)},signal:je.signal}),await X(),await le(!1)}catch(Ue){if(Ue.name!=="AbortError"){if(!g(c))return;N(E,`Sync failed: ${Ue.message}`)}}finally{N(re,!1)}}async function pe(de){if(g(re)||!g(c))return;N(E,null),N(re,!0),N(se,null);const je=new AbortController;try{await jv(g(c),{limit:de,onProgress:Ue=>{N(se,{...Ue},!0)},signal:je.signal}),await X(),await le(!1)}catch(Ue){if(Ue.name!=="AbortError"){if(!g(c))return;N(E,`Sync more failed: ${Ue.message}`)}}finally{N(re,!1)}}async function _e(){try{await Bv(),await X(),N(y,[],!0),N(x,0),N(w,0)}catch(de){N(E,`Failed to clear data: ${de.message}`)}}var Y=lg(),ne=_(Y);{var W=de=>{Hv(de,{onsave:me,get clientIdInput(){return g(i)},set clientIdInput(je){N(i,je,!0)}})},ae=de=>{nh(de,{get clientId(){return g(a)},get error(){return g(E)},get loadingAuth(){return g(M)},onsignin:Pe,onclear:Ie,onsignout:ke})},be=de=>{og(de,{get error(){return g(E)},get profile(){return g(d)},get loadingProfile(){return g(T)},get emailMessages(){return g(y)},get totalLocalMessages(){return g(x)},get hasMoreLocal(){return g(G)},get loadingMessages(){return g(k)},get selectedMessage(){return g(h)},get syncStatus(){return g(F)},get syncProgress(){return g(se)},get isSyncing(){return g(re)},onsignout:ke,onsearch:Ee,onloadmore:$,onviewmessage:oe,onclosedetail:ue,ondismisserror:()=>N(E,null),onsync:ie,onsyncmore:pe,oncleardata:_e,get searchQuery(){return g(v)},set searchQuery(je){N(v,je,!0)}})};he(ne,de=>{g(J)?de(W):g(te)?de(be,!1):de(ae,1)})}B(t,Y),gt()}var cg=U('<span class="sep svelte-t1ig66">Â·</span> ',1),fg=U('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),dg=U('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),pg=U('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),vg=U('<span class="result-summary svelte-t1ig66"> </span>'),hg=U('<span class="result-tag svelte-t1ig66"> </span>'),mg=U('<div class="result-tags svelte-t1ig66"></div>'),gg=U('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),yg=U('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),_g=U('<span class="err svelte-t1ig66"> </span>'),bg=U('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),wg=U('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),kg=U('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),xg=U('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Sg=U('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Tg=U('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),Eg=U('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function Ag(t,e){mt(e,!0);let r=Re(e,"progress",3,null),a=Oe(!1),i=Oe("system");function o(T){return!T||T<0?"â":T<1e3?`${Math.round(T)}ms`:`${(T/1e3).toFixed(1)}s`}function c(T){return T?T>=1e3?`${(T/1e3).toFixed(1)}k`:String(T):"0"}function d(T){if(!T)return"â";const E=T.replace(/<.*>/,"").trim();return E.length>30?E.slice(0,28)+"â¦":E}function h(T){if(!T)return"";try{return new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(T){var se;if(!((se=T==null?void 0:T.totals)!=null&&se.elapsed)||!(T!=null&&T.current)||T.current<2)return null;const E=T.totals.elapsed/T.current;return(T.total-T.current)*E}let y=pt(()=>{var T;return(T=r())!=null&&T.total?Math.round(r().current/r().total*100):0}),x=pt(()=>v(r()));var w=fa(),k=tt(w);{var M=T=>{var E=Eg(),F=tt(E),se=_(F),re=_(se),H=_(re);{var J=be=>{var de=ti("Scan complete");B(be,de)},te=be=>{var de=ti();ce(()=>Q(de,`Processing ${r().current??""} of ${r().total??""}`)),B(be,de)};he(H,be=>{r().phase==="done"?be(J):be(te,!1)})}var G=S(re,2),me=_(G),Ie=S(se,2),Pe=_(Ie);let ke,V;var le=S(Ie,2);{var Ee=be=>{var de=fg(),je=_(de),Ue=_(je),ye=S(je,2),Fe=_(ye),qe=S(Fe);{var We=vt=>{var lt=cg(),Qe=S(tt(lt),1,!0);ce(it=>Q(Qe,it),[()=>h(r().email.date)]),B(vt,lt)};he(qe,vt=>{r().email.date&&vt(We)})}ce(vt=>{Q(Ue,r().email.subject||"(no subject)"),Q(Fe,`${vt??""} `)},[()=>d(r().email.from)]),B(be,de)};he(le,be=>{r().email&&r().phase!=="done"&&be(Ee)})}var $=S(le,2);{var oe=be=>{var de=pg(),je=_(de),Ue=_(je),ye=_(Ue),Fe=S(je,2),qe=_(Fe),We=_(qe),vt=S(Fe,2);{var lt=Qe=>{var it=dg(),_t=_(it),Xt=_(_t);ce(jt=>Q(Xt,`~${jt??""}`),[()=>o(g(x))]),B(Qe,it)};he(vt,Qe=>{g(x)&&Qe(lt)})}ce(Qe=>{Q(ye,Qe),Q(We,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),B(be,de)};he($,be=>{r().live&&r().phase==="generating"&&be(oe)})}var ue=S($,2);{var X=be=>{var de=yg(),je=_(de),Ue=_(je),ye=S(je,2);{var Fe=Qe=>{var it=vg(),_t=_(it);ce(()=>Q(_t,r().result.summary)),B(Qe,it)};he(ye,Qe=>{r().result.summary&&Qe(Fe)})}var qe=S(ye,2);{var We=Qe=>{var it=mg();fn(it,21,()=>r().result.tags,_r,(_t,Xt)=>{var jt=hg(),Rt=_(jt);ce(()=>Q(Rt,g(Xt))),B(_t,jt)}),B(Qe,it)};he(qe,Qe=>{var it;(it=r().result.tags)!=null&&it.length&&Qe(We)})}var vt=S(qe,2);{var lt=Qe=>{var it=gg(),_t=_(it),Xt=S(_t,2),jt=S(Xt,2);ce((Rt,ar)=>{Q(_t,`${Rt??""} `),Q(Xt,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),Q(jt,` ${ar??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),B(Qe,it)};he(vt,Qe=>{r().emailStats&&Qe(lt)})}ce(()=>Q(Ue,r().result.action)),B(be,de)};he(ue,be=>{r().result&&be(X)})}var ie=S(ue,2);{var pe=be=>{var de=bg(),je=_(de),Ue=_(je),ye=S(je,2);{var Fe=Qe=>{var it=_g(),_t=_(it);ce(()=>Q(_t,`${r().errors??""} errors`)),B(Qe,it)};he(ye,Qe=>{r().errors&&Qe(Fe)})}var qe=S(ye,4),We=_(qe),vt=S(qe,4),lt=_(vt);ce((Qe,it,_t)=>{Q(Ue,`${(r().classified||0)??""} classified`),Q(We,`${Qe??""} in + ${it??""} out tokens`),Q(lt,_t)},[()=>c(r().totals.inputTokens),()=>c(r().totals.outputTokens),()=>o(r().totals.elapsed)]),B(be,de)};he(ie,be=>{r().totals&&be(pe)})}var _e=S(ie,2),Y=_(_e);{var ne=be=>{var de=wg(),je=tt(de);je.__click=()=>N(a,!0);var Ue=S(je,2);Ue.__click=function(...ye){var Fe;(Fe=e.onstop)==null||Fe.apply(this,ye)},B(be,de)};he(Y,be=>{r().phase!=="done"&&be(ne)})}var W=S(F,2);{var ae=be=>{var de=Tg();de.__click=()=>N(a,!1),de.__keydown=xt=>xt.key==="Escape"&&N(a,!1);var je=_(de);je.__click=xt=>xt.stopPropagation();var Ue=_(je),ye=S(_(Ue),2);ye.__click=()=>N(a,!1);var Fe=S(Ue,2),qe=_(Fe);let We;qe.__click=()=>N(i,"system");var vt=S(qe,2);let lt;vt.__click=()=>N(i,"email");var Qe=S(vt,2);let it;Qe.__click=()=>N(i,"full");var _t=S(Fe,2),Xt=_(_t);{var jt=xt=>{var Qt=kg(),Ct=tt(Qt),ct=_(Ct),yt=S(Ct,2),dn=_(yt);ce(()=>{Q(ct,ba),Q(dn,`${ba.length??""} chars`)}),B(xt,Qt)},Rt=xt=>{var Qt=xg(),Ct=tt(Qt),ct=_(Ct),yt=S(Ct,2),dn=_(yt);ce(()=>{var tn,wn,nn;Q(ct,((tn=r().prompt)==null?void 0:tn.user)||"(no email prompt)"),Q(dn,`${(((nn=(wn=r().prompt)==null?void 0:wn.user)==null?void 0:nn.length)||0)??""} chars`)}),B(xt,Qt)},ar=xt=>{var Qt=Sg(),Ct=tt(Qt),ct=_(Ct),yt=S(Ct,2),dn=_(yt);ce(()=>{var tn,wn,nn,pn,kn,Mn;Q(ct,`${(((tn=r().prompt)==null?void 0:tn.system)||"")??""}

---

${(((wn=r().prompt)==null?void 0:wn.user)||"")??""}`),Q(dn,`${(((pn=(nn=r().prompt)==null?void 0:nn.system)==null?void 0:pn.length)||0)+(((Mn=(kn=r().prompt)==null?void 0:kn.user)==null?void 0:Mn.length)||0)} chars total`)}),B(xt,Qt)};he(Xt,xt=>{g(i)==="system"?xt(jt):g(i)==="email"?xt(Rt,1):xt(ar,!1)})}ce(()=>{We=Pt(qe,1,"mtab svelte-t1ig66",null,We,{active:g(i)==="system"}),lt=Pt(vt,1,"mtab svelte-t1ig66",null,lt,{active:g(i)==="email"}),it=Pt(Qe,1,"mtab svelte-t1ig66",null,it,{active:g(i)==="full"})}),B(be,de)};he(W,be=>{g(a)&&be(ae)})}ce(()=>{Q(me,`${g(y)??""}%`),ke=Pt(Pe,1,"bar-fill svelte-t1ig66",null,ke,{done:r().phase==="done"}),V=cn(Pe,"",V,{width:`${g(y)??""}%`})}),B(T,E)};he(k,T=>{r()&&T(M)})}B(t,w),gt()}Nt(["click","keydown"]);var Cg=U('<span class="spinner svelte-ois7em"></span>'),Ig=Lo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),Rg=U('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),Pg=U("<option> </option>"),Og=U('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),Dg=U('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function Mg(t,e){mt(e,!0);let r=Re(e,"engineStatus",3,"idle"),a=Re(e,"modelName",3,""),i=Re(e,"isScanning",3,!1),o=Re(e,"scanProgress",3,null),c=Re(e,"scanCount",15,20),d=Re(e,"stats",3,null);const h=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function v(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var w=Dg(),k=_(w),M=_(k),T=_(M);{var E=Y=>{var ne=Cg();B(Y,ne)},F=Y=>{var ne=Ig();B(Y,ne)};he(T,Y=>{i()?Y(E):Y(F,!1)})}var se=S(M,2),re=_(se),H=S(_(re),2);H.__click=function(...Y){var ne;(ne=e.oninspect)==null||ne.apply(this,Y)};var J=S(re,2),te=_(J);let G;var me=S(te),Ie=S(k,2);{var Pe=Y=>{var ne=Rg(),W=_(ne),ae=_(W),be=S(W,4),de=_(be),je=S(be,4),Ue=_(je);ce(()=>{Q(ae,`${d().totalEmails??""} emails in storage`),Q(de,`${d().classified??""} classified`),Q(Ue,`${d().unclassified??""} new`)}),B(Y,ne)};he(Ie,Y=>{d()&&Y(Pe)})}var ke=S(Ie,2),V=_(ke),le=S(_(V),2);fn(le,21,()=>h,_r,(Y,ne)=>{var W=Pg(),ae=_(W),be={};ce(()=>{Q(ae,g(ne).label),be!==(be=g(ne).value)&&(W.value=(W.__value=g(ne).value)??"")}),B(Y,W)});var Ee=S(V,2),$=_(Ee);$.__click=function(...Y){var ne;(ne=e.onscan)==null||ne.apply(this,Y)};var oe=_($),ue=S($,2);ue.__click=function(...Y){var ne;(ne=e.onrescan)==null||ne.apply(this,Y)};var X=S(ke,2);{var ie=Y=>{var ne=Og();B(Y,ne)};he(X,Y=>{r()!=="ready"&&r()!=="loading"&&Y(ie)})}var pe=S(X,2);{var _e=Y=>{Ag(Y,{get progress(){return o()},get onstop(){return e.onstop}})};he(pe,Y=>{var ne;(i()||((ne=o())==null?void 0:ne.phase)==="done")&&Y(_e)})}ce((Y,ne,W,ae)=>{G=cn(te,"",G,Y),Q(me,` ${ne??""}`),le.disabled=i(),$.disabled=W,Q(oe,i()?"Scanning...":"Scan New"),ue.disabled=ae},[()=>({background:y()}),v,()=>!x(),()=>!x()]),No(le,c),B(t,w),gt()}Nt(["click"]);var Lg=U('<span class="row-date svelte-1czytqk"> </span>'),Ng=U('<span class="tag svelte-1czytqk"> </span>'),jg=U('<span class="row-tags svelte-1czytqk"></span>'),qg=U('<span class="row-reason svelte-1czytqk"> </span>'),Bg=U('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),zg=U('<span class="status-label svelte-1czytqk"> </span>'),Fg=U('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Kg=U('<p class="summary-reason svelte-1czytqk"> </p>'),Ug=U('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Gg=U('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function lu(t,e){mt(e,!0);let r=Re(e,"actionColor",3,"#666"),a=Re(e,"dimmed",3,!1);function i($){if(!$)return"";try{return new Date($).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=pt(()=>e.item.status==="pending"),c=Oe(!1);var d=Gg(),h=tt(d);let v;var y=_(h);y.__click=()=>N(c,!g(c));let x;var w=_(y),k=_(w),M=S(w,2),T=_(M),E=_(T),F=S(T,2);{var se=$=>{var oe=Lg(),ue=_(oe);ce(X=>Q(ue,X),[()=>i(e.item.date)]),B($,oe)};he(F,$=>{e.item.date&&$(se)})}var re=S(M,2);{var H=$=>{var oe=jg();fn(oe,21,()=>e.item.tags,_r,(ue,X)=>{var ie=Ng();let pe;var _e=_(ie);ce(Y=>{pe=cn(ie,"",pe,Y),Q(_e,g(X))},[()=>({background:xp(g(X))})]),B(ue,ie)}),B($,oe)};he(re,$=>{e.item.tags&&e.item.tags.length>0&&$(H)})}var J=S(re,2);{var te=$=>{var oe=qg(),ue=_(oe);ce(()=>Q(ue,e.item.reason)),B($,oe)};he(J,$=>{e.item.reason&&!g(c)&&$(te)})}var G=S(y,2),me=_(G);{var Ie=$=>{var oe=Bg(),ue=tt(oe);ue.__click=()=>e.onmarkacted(e.item.emailId);var X=S(ue,2);X.__click=()=>e.ondismiss(e.item.emailId),B($,oe)},Pe=$=>{var oe=zg(),ue=_(oe);ce(()=>Q(ue,e.item.status)),B($,oe)};he(me,$=>{g(o)?$(Ie):$(Pe,!1)})}var ke=S(me,2);{var V=$=>{var oe=Fg();oe.__click=()=>e.onremove(e.item.emailId),B($,oe)};he(ke,$=>{e.onremove&&$(V)})}var le=S(h,2);{var Ee=$=>{var oe=Ug();let ue;var X=_(oe),ie=_(X),pe=S(X,2);{var _e=Y=>{var ne=Kg(),W=_(ne);ce(()=>Q(W,e.item.reason)),B(Y,ne)};he(pe,Y=>{e.item.reason&&Y(_e)})}ce(()=>{ue=cn(oe,"",ue,{"border-left-color":r()}),Q(ie,e.item.summary)}),B($,oe)};he(le,$=>{g(c)&&e.item.summary&&$(Ee)})}ce(()=>{v=Pt(h,1,"email-row svelte-1czytqk",null,v,{dimmed:a()}),x=cn(y,"",x,{"border-left-color":r()}),Q(k,e.item.subject),Q(E,e.item.from)}),B(t,d),gt()}Nt(["click"]);var Hg=U('<span class="group-acted svelte-tl1unp"> </span>'),Wg=U('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Yg=U('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Vg=U('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Xg=U('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Qg=U('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Zg=U('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Jg(t,e){mt(e,!0);let r=Re(e,"color",3,"#888");Re(e,"count",3,0);let a=Re(e,"items",19,()=>[]),i=Re(e,"expanded",3,!1),o=pt(()=>a().filter(te=>te.status==="pending")),c=pt(()=>a().filter(te=>te.status!=="pending")),d=Oe(!1);function h(te){return te.split("_").map(G=>G.charAt(0)+G.slice(1).toLowerCase()).join(" ")}var v=Zg(),y=_(v);y.__click=function(...te){var G;(G=e.ontoggle)==null||G.apply(this,te)};var x=_(y);let w;var k=_(x),M=S(x,2),T=_(M),E=S(M,2);{var F=te=>{var G=Hg(),me=_(G);ce(()=>Q(me,`${g(c).length??""} handled`)),B(te,G)};he(E,te=>{g(c).length>0&&te(F)})}var se=S(E,4);let re;var H=S(y,2);{var J=te=>{var G=Qg(),me=_(G);{var Ie=ue=>{var X=Wg();B(ue,X)};he(me,ue=>{g(o).length===0&&g(c).length===0&&ue(Ie)})}var Pe=S(me,2);fn(Pe,17,()=>g(o),ue=>ue.emailId,(ue,X)=>{lu(ue,{get item(){return g(X)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ke=S(Pe,2);{var V=ue=>{var X=Yg(),ie=_(X),pe=_(ie),_e=S(ie,2);fn(_e,17,()=>g(c),Y=>Y.emailId,(Y,ne)=>{lu(Y,{get item(){return g(ne)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ce(()=>Q(pe,`${g(c).length??""} handled`)),B(ue,X)};he(ke,ue=>{g(c).length>0&&ue(V)})}var le=S(ke,2),Ee=_(le);{var $=ue=>{var X=Vg();X.__click=()=>N(d,!0),B(ue,X)},oe=ue=>{var X=Xg(),ie=_(X),pe=S(ie);pe.__click=()=>N(d,!1);var _e=S(pe,2);_e.__click=()=>{e.oncleargroup(),N(d,!1)},ce(()=>Q(ie,`Clear ${a().length??""} items? `)),B(ue,X)};he(Ee,ue=>{g(d)?ue(oe,!1):ue($)})}B(te,G)};he(H,te=>{i()&&te(J)})}ce(te=>{w=cn(x,"",w,{background:r()}),Q(k,te),Q(T,g(o).length),re=Pt(se,0,"chevron svelte-tl1unp",null,re,{open:i()})},[()=>h(e.action)]),B(t,v),gt()}Nt(["click"]);var $g=U(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),ey=U(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),ty=U(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),ny=U('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function ry(t,e){mt(e,!0);let r=Re(e,"open",15,!1),a=Re(e,"sampleEmail",3,null),i=Oe("system");function o(){return a()?Sc(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function c(){r(!1)}function d(x){x.target===x.currentTarget&&c()}var h=fa(),v=tt(h);{var y=x=>{var w=ny();w.__click=d,w.__keydown=V=>V.key==="Escape"&&c();var k=_(w),M=_(k),T=S(_(M),2);T.__click=c;var E=S(M,2),F=_(E);let se;F.__click=()=>N(i,"system");var re=S(F,2);let H;re.__click=()=>N(i,"email");var J=S(re,2);let te;J.__click=()=>N(i,"config");var G=S(E,2),me=_(G);{var Ie=V=>{var le=$g(),Ee=S(tt(le),2),$=_(Ee);ce(()=>Q($,ba)),B(V,le)},Pe=V=>{var le=ey(),Ee=S(tt(le),2),$=S(_(Ee),2);$.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var oe=S(Ee,2),ue=S(_(oe),2),X=_(ue);ce(ie=>Q(X,ie),[o]),B(V,le)},ke=V=>{var le=ty(),Ee=S(tt(le),2),$=_(Ee),oe=S(_($),2),ue=_(oe),X=S($,2),ie=S(_(X),2),pe=_(ie),_e=S(X,2),Y=S(_(_e),2),ne=_(Y),W=S(Ee,4);W.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,ce(()=>{Q(ue,gp.maxTokens),Q(pe,"false"),Q(ne,"false")}),B(V,le)};he(me,V=>{g(i)==="system"?V(Ie):g(i)==="email"?V(Pe,1):g(i)==="config"&&V(ke,2)})}ce(()=>{se=Pt(F,1,"tab svelte-10pcy9j",null,se,{active:g(i)==="system"}),H=Pt(re,1,"tab svelte-10pcy9j",null,H,{active:g(i)==="email"}),te=Pt(J,1,"tab svelte-10pcy9j",null,te,{active:g(i)==="config"})}),B(x,w)};he(v,x=>{r()&&x(y)})}B(t,h),gt()}Nt(["click","keydown"]);var ay=U('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),sy=U('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),iy=U('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),oy=U('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),ly=U('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),uy=U('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!></div>');function cy(t,e){mt(e,!0);let r=Re(e,"groups",19,()=>({})),a=Re(e,"groupOrder",19,()=>[]),i=Re(e,"counts",19,()=>({})),o=Re(e,"stats",3,null),c=Re(e,"expandedGroup",3,null),d=Re(e,"isScanning",3,!1),h=Re(e,"scanProgress",3,null),v=Re(e,"scanCount",15,20),y=Re(e,"error",3,null),x=Oe(!1),w=Oe(!1),k=pt(()=>{for(const te of a()){const G=r()[te];if((G==null?void 0:G.length)>0)return G[0]}return null});var M=uy(),T=_(M);Mg(T,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return h()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>N(w,!0),get scanCount(){return v()},set scanCount(te){v(te)}});var E=S(T,2);ry(E,{get sampleEmail(){return g(k)},get open(){return g(w)},set open(te){N(w,te,!0)}});var F=S(E,2);{var se=te=>{var G=ay(),me=_(G),Ie=_(me),Pe=S(me,2);Pe.__click=function(...ke){var V;(V=e.ondismisserror)==null||V.apply(this,ke)},ce(()=>Q(Ie,y())),B(te,G)};he(F,te=>{y()&&te(se)})}var re=S(F,2);{var H=te=>{var G=oy(),me=tt(G);fn(me,20,a,$=>$,($,oe)=>{{let ue=pt(()=>vo(oe)),X=pt(()=>{var _e;return((_e=r()[oe])==null?void 0:_e.length)||0}),ie=pt(()=>r()[oe]||[]),pe=pt(()=>c()===oe);Jg($,{get action(){return oe},get color(){return g(ue)},get count(){return g(X)},get items(){return g(ie)},get expanded(){return g(pe)},ontoggle:()=>e.ontogglegroup(oe),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(oe)})}});var Ie=S(me,2),Pe=_(Ie),ke=_(Pe),V=S(Pe,2);{var le=$=>{var oe=sy();oe.__click=()=>N(x,!0),B($,oe)},Ee=$=>{var oe=iy(),ue=S(_(oe));ue.__click=()=>N(x,!1);var X=S(ue,2);X.__click=()=>{e.onclear(),N(x,!1)},B($,oe)};he(V,$=>{g(x)?$(Ee,!1):$(le)})}ce(()=>Q(ke,`${i().total??""} emails classified into ${a().length??""} groups`)),B(te,G)},J=te=>{var G=ly();B(te,G)};he(re,te=>{i().total>0?te(H):d()||te(J,1)})}B(t,M),gt()}Nt(["click"]);var fy=U('<div class="actions-page svelte-3tch4q"><!></div>');function dy(t,e){mt(e,!0);const r=uc();let a=Oe(zt(r.status)),i=Oe(""),o=Oe(zt({})),c=Oe(zt([])),d=Oe(zt({total:0})),h=Oe(null),v=Oe(null),y=Oe(!1),x=Oe(null),w=Oe(20),k=Oe(null),M=Oe(null);Gt(()=>{const V=r.onMessage(le=>{if(le.status==="ready"){N(a,"ready");const Ee=us.find($=>$.id===r.modelId);N(i,(Ee==null?void 0:Ee.name)||r.modelId||"",!0)}le.status==="loading"&&N(a,"loading")});if(N(a,r.status,!0),r.modelId){const le=us.find(Ee=>Ee.id===r.modelId);N(i,(le==null?void 0:le.name)||r.modelId||"",!0)}return T(),()=>V()});async function T(){try{const V=await yp();N(o,V.groups,!0),N(c,V.order,!0),N(d,await _p(),!0),N(h,await po(),!0)}catch(V){N(k,`Failed to load data: ${V.message}`)}}async function E(){await se(!1)}async function F(){await se(!0)}async function se(V){if(g(y)||!r.isReady)return;N(k,null),N(y,!0),N(x,null);const le=new AbortController;N(M,le,!0);try{await wc(r,{count:g(w),force:V,signal:le.signal,onProgress:Ee=>{N(x,{...Ee},!0)}}),await T()}catch(Ee){le.signal.aborted||N(k,`Scan failed: ${Ee.message}`)}finally{N(y,!1),N(M,null)}}function re(){var V;(V=g(M))==null||V.abort()}async function H(V){await ri(V,"acted"),await T()}async function J(V){await ri(V,"dismissed"),await T()}async function te(V){await xc(V),await T()}async function G(V){await kc(V),await T()}async function me(){await bp(),await T()}function Ie(V){N(v,g(v)===V?null:V,!0)}var Pe=fy(),ke=_(Pe);cy(ke,{get engineStatus(){return g(a)},get modelName(){return g(i)},get groups(){return g(o)},get groupOrder(){return g(c)},get counts(){return g(d)},get stats(){return g(h)},get expandedGroup(){return g(v)},get isScanning(){return g(y)},get scanProgress(){return g(x)},get error(){return g(k)},onscan:E,onrescan:F,ontogglegroup:Ie,onmarkacted:H,ondismiss:J,onremove:te,oncleargroup:G,onclear:me,ondismisserror:()=>N(k,null),onstop:re,get scanCount(){return g(w)},set scanCount(V){N(w,V,!0)}}),B(t,Pe),gt()}var py=U('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function vy(t,e){mt(e,!0);function r(){const G=location.hash;return G==="#dashboard"?"dashboard":G==="#actions"?"actions":"chat"}let a=Oe(zt(r()));Gt(()=>{function G(){N(a,r(),!0)}return window.addEventListener("hashchange",G),()=>window.removeEventListener("hashchange",G)});var i=py(),o=_(i),c=S(_(o),2),d=_(c);let h;var v=S(d,2);let y;var x=S(v,2);let w;var k=S(o,2),M=_(k);let T;var E=_(M);Pv(E,{});var F=S(M,2);let se;var re=_(F);dy(re,{});var H=S(F,2);let J;var te=_(H);ug(te,{}),ce(()=>{h=Pt(d,1,"svelte-1n46o8q",null,h,{active:g(a)==="chat"}),y=Pt(v,1,"svelte-1n46o8q",null,y,{active:g(a)==="actions"}),w=Pt(x,1,"svelte-1n46o8q",null,w,{active:g(a)==="dashboard"}),T=cn(M,"",T,{display:g(a)==="chat"?"flex":"none"}),se=cn(F,"",se,{display:g(a)==="actions"?"flex":"none"}),J=cn(H,"",J,{display:g(a)==="dashboard"?"flex":"none"})}),B(t,i),gt()}Pd(vy,{target:document.getElementById("app")});
