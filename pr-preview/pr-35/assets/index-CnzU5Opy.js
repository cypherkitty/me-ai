var Tf=Object.defineProperty;var Pl=t=>{throw TypeError(t)};var Ef=(t,e,r)=>e in t?Tf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var rt=(t,e,r)=>Ef(t,typeof e!="symbol"?e+"":e,r),Gi=(t,e,r)=>e.has(t)||Pl("Cannot "+r);var ne=(t,e,r)=>(Gi(t,e,"read from private field"),r?r.call(t):e.get(t)),at=(t,e,r)=>e.has(t)?Pl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),et=(t,e,r,a)=>(Gi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),ln=(t,e,r)=>(Gi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const ro=!1;var Co=Array.isArray,Af=Array.prototype.indexOf,qa=Array.prototype.includes,vi=Array.from,Cf=Object.defineProperty,Ia=Object.getOwnPropertyDescriptor,Pf=Object.getOwnPropertyDescriptors,If=Object.prototype,Rf=Array.prototype,wc=Object.getPrototypeOf,Il=Object.isExtensible;const Of=()=>{};function Df(t){for(var e=0;e<t.length;e++)t[e]()}function kc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const en=2,hs=4,pi=8,xc=1<<24,Rr=16,ar=32,ba=64,Sc=128,Un=512,Vt=1024,tn=2048,nr=4096,Mn=8192,Ar=16384,ks=32768,Ba=65536,Rl=1<<17,Tc=1<<18,Ga=1<<19,jf=1<<20,Er=1<<25,ha=65536,ao=1<<21,Po=1<<22,Kr=1<<23,da=Symbol("$state"),Mf=Symbol("legacy props"),Lf=Symbol(""),ra=new class extends Error{constructor(){super(...arguments);rt(this,"name","StaleReactionError");rt(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Nf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function qf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Bf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function zf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ff(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Kf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Uf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Gf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Hf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Wf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Vf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Yf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Xf=1,Qf=2,Ec=4,Zf=8,Jf=16,$f=1,ed=4,td=8,nd=16,Ac=1,rd=2,Qt=Symbol(),Cc="http://www.w3.org/1999/xhtml";function ad(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function sd(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Pc(t){return t===this.v}function id(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ic(t){return!id(t,this.v)}let od=!1,Ln=null;function za(t){Ln=t}function Ct(t,e=!1,r){Ln={p:Ln,i:!1,c:null,e:null,s:t,x:null,l:null}}function Pt(t){var e=Ln,r=e.e;if(r!==null){e.e=null;for(var a of r)Jc(a)}return t!==void 0&&(e.x=t),e.i=!0,Ln=e.p,t??{}}function Rc(){return!0}let aa=[];function Oc(){var t=aa;aa=[],Df(t)}function Ur(t){if(aa.length===0&&!us){var e=aa;queueMicrotask(()=>{e===aa&&Oc()})}aa.push(t)}function ld(){for(;aa.length>0;)Oc()}function Dc(t){var e=bt;if(e===null)return st.f|=Kr,t;if((e.f&ks)===0&&(e.f&hs)===0)throw t;Fa(t,e)}function Fa(t,e){for(;e!==null;){if((e.f&Sc)!==0){if((e.f&ks)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const cd=-7169;function qt(t,e){t.f=t.f&cd|e}function Io(t){(t.f&Un)!==0||t.deps===null?qt(t,Vt):qt(t,nr)}function jc(t){if(t!==null)for(const e of t)(e.f&en)===0||(e.f&ha)===0||(e.f^=ha,jc(e.deps))}function Mc(t,e,r){(t.f&tn)!==0?e.add(t):(t.f&nr)!==0&&r.add(t),jc(t.deps),qt(t,Vt)}const Us=new Set;let Xe=null,ri=null,Zt=null,wn=[],hi=null,so=!1,us=!1;var Ra,Oa,ia,Da,_s,ys,oa,kr,ja,gr,io,oo,Lc;const rl=class rl{constructor(){at(this,gr);rt(this,"committed",!1);rt(this,"current",new Map);rt(this,"previous",new Map);at(this,Ra,new Set);at(this,Oa,new Set);at(this,ia,0);at(this,Da,0);at(this,_s,null);at(this,ys,new Set);at(this,oa,new Set);at(this,kr,new Map);rt(this,"is_fork",!1);at(this,ja,!1)}is_deferred(){return this.is_fork||ne(this,Da)>0}skip_effect(e){ne(this,kr).has(e)||ne(this,kr).set(e,{d:[],m:[]})}unskip_effect(e){var r=ne(this,kr).get(e);if(r){ne(this,kr).delete(e);for(var a of r.d)qt(a,tn),er(a);for(a of r.m)qt(a,nr),er(a)}}process(e){var i;wn=[],this.apply();var r=[],a=[];for(const o of e)ln(this,gr,io).call(this,o,r,a);if(this.is_deferred()){ln(this,gr,oo).call(this,a),ln(this,gr,oo).call(this,r);for(const[o,u]of ne(this,kr))zc(o,u)}else{for(const o of ne(this,Ra))o();ne(this,Ra).clear(),ne(this,ia)===0&&ln(this,gr,Lc).call(this),ri=this,Xe=null,Ol(a),Ol(r),ri=null,(i=ne(this,_s))==null||i.resolve()}Zt=null}capture(e,r){r!==Qt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Kr)===0&&(this.current.set(e,e.v),Zt==null||Zt.set(e,e.v))}activate(){Xe=this,this.apply()}deactivate(){Xe===this&&(Xe=null,Zt=null)}flush(){if(this.activate(),wn.length>0){if(Nc(),Xe!==null&&Xe!==this)return}else ne(this,ia)===0&&this.process([]);this.deactivate()}discard(){for(const e of ne(this,Oa))e(this);ne(this,Oa).clear()}increment(e){et(this,ia,ne(this,ia)+1),e&&et(this,Da,ne(this,Da)+1)}decrement(e){et(this,ia,ne(this,ia)-1),e&&et(this,Da,ne(this,Da)-1),!ne(this,ja)&&(et(this,ja,!0),Ur(()=>{et(this,ja,!1),this.is_deferred()?wn.length>0&&this.flush():this.revive()}))}revive(){for(const e of ne(this,ys))ne(this,oa).delete(e),qt(e,tn),er(e);for(const e of ne(this,oa))qt(e,nr),er(e);this.flush()}oncommit(e){ne(this,Ra).add(e)}ondiscard(e){ne(this,Oa).add(e)}settled(){return(ne(this,_s)??et(this,_s,kc())).promise}static ensure(){if(Xe===null){const e=Xe=new rl;Us.add(Xe),us||Ur(()=>{Xe===e&&e.flush()})}return Xe}apply(){}};Ra=new WeakMap,Oa=new WeakMap,ia=new WeakMap,Da=new WeakMap,_s=new WeakMap,ys=new WeakMap,oa=new WeakMap,kr=new WeakMap,ja=new WeakMap,gr=new WeakSet,io=function(e,r,a){e.f^=Vt;for(var i=e.first,o=null;i!==null;){var u=i.f,f=(u&(ar|ba))!==0,h=f&&(u&Vt)!==0,v=h||(u&Mn)!==0||ne(this,kr).has(i);if(!v&&i.fn!==null){f?i.f^=Vt:o!==null&&(u&(hs|pi|xc))!==0?o.b.defer_effect(i):(u&hs)!==0?r.push(i):Ss(i)&&((u&Rr)!==0&&ne(this,oa).add(i),Ua(i));var y=i.first;if(y!==null){i=y;continue}}var S=i.parent;for(i=i.next;i===null&&S!==null;)S===o&&(o=null),i=S.next,S=S.parent}},oo=function(e){for(var r=0;r<e.length;r+=1)Mc(e[r],ne(this,ys),ne(this,oa))},Lc=function(){var i;if(Us.size>1){this.previous.clear();var e=Zt,r=!0;for(const o of Us){if(o===this){r=!1;continue}const u=[];for(const[h,v]of this.current){if(o.current.has(h))if(r&&v!==o.current.get(h))o.current.set(h,v);else continue;u.push(h)}if(u.length===0)continue;const f=[...o.current.keys()].filter(h=>!this.current.has(h));if(f.length>0){var a=wn;wn=[];const h=new Set,v=new Map;for(const y of u)qc(y,f,h,v);if(wn.length>0){Xe=o,o.apply();for(const y of wn)ln(i=o,gr,io).call(i,y,[],[]);o.deactivate()}wn=a}}Xe=null,Zt=e}this.committed=!0,Us.delete(this)};let Gr=rl;function ud(t){var e=us;us=!0;try{for(var r;;){if(ld(),wn.length===0&&(Xe==null||Xe.flush(),wn.length===0))return hi=null,r;Nc()}}finally{us=e}}function Nc(){so=!0;var t=null;try{for(var e=0;wn.length>0;){var r=Gr.ensure();if(e++>1e3){var a,i;fd()}r.process(wn),Hr.clear()}}finally{wn=[],so=!1,hi=null}}function fd(){try{Uf()}catch(t){Fa(t,hi)}}let Xn=null;function Ol(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(Ar|Mn))===0&&Ss(a)&&(Xn=new Set,Ua(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&nu(a),(Xn==null?void 0:Xn.size)>0)){Hr.clear();for(const i of Xn){if((i.f&(Ar|Mn))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)Xn.has(u)&&(Xn.delete(u),o.push(u)),u=u.parent;for(let f=o.length-1;f>=0;f--){const h=o[f];(h.f&(Ar|Mn))===0&&Ua(h)}}Xn.clear()}}Xn=null}}function qc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&en)!==0?qc(i,e,r,a):(o&(Po|Rr))!==0&&(o&tn)===0&&Bc(i,e,a)&&(qt(i,tn),er(i))}}function Bc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(qa.call(e,i))return!0;if((i.f&en)!==0&&Bc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function er(t){for(var e=hi=t;e.parent!==null;){e=e.parent;var r=e.f;if(so&&e===bt&&(r&Rr)!==0&&(r&Tc)===0)return;if((r&(ba|ar))!==0){if((r&Vt)===0)return;e.f^=Vt}}wn.push(e)}function zc(t,e){if(!((t.f&ar)!==0&&(t.f&Vt)!==0)){(t.f&tn)!==0?e.d.push(t):(t.f&nr)!==0&&e.m.push(t),qt(t,Vt);for(var r=t.first;r!==null;)zc(r,e),r=r.next}}function dd(t){let e=0,r=ma(0),a;return()=>{Do()&&(g(r),jo(()=>(e===0&&(a=Ts(()=>t(()=>fs(r)))),e+=1,()=>{Ur(()=>{e-=1,e===0&&(a==null||a(),a=void 0,fs(r))})})))}}var vd=Ba|Ga|Sc;function pd(t,e,r){new hd(t,e,r)}var zn,Ao,dr,la,vr,Fn,yn,pr,xr,zr,ca,Fr,Ma,ua,La,Na,Sr,fi,Yt,md,gd,lo,Zs,Js,co;class hd{constructor(e,r,a){at(this,Yt);rt(this,"parent");rt(this,"is_pending",!1);at(this,zn);at(this,Ao,null);at(this,dr);at(this,la);at(this,vr);at(this,Fn,null);at(this,yn,null);at(this,pr,null);at(this,xr,null);at(this,zr,null);at(this,ca,0);at(this,Fr,0);at(this,Ma,!1);at(this,ua,!1);at(this,La,new Set);at(this,Na,new Set);at(this,Sr,null);at(this,fi,dd(()=>(et(this,Sr,ma(ne(this,ca))),()=>{et(this,Sr,null)})));et(this,zn,e),et(this,dr,r),et(this,la,a),this.parent=bt.b,this.is_pending=!!ne(this,dr).pending,et(this,vr,Mo(()=>{bt.b=this;{var i=ln(this,Yt,lo).call(this);try{et(this,Fn,Kn(()=>a(i)))}catch(o){this.error(o)}ne(this,Fr)>0?ln(this,Yt,Js).call(this):this.is_pending=!1}return()=>{var o;(o=ne(this,zr))==null||o.remove()}},vd))}defer_effect(e){Mc(e,ne(this,La),ne(this,Na))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!ne(this,dr).pending}update_pending_count(e){ln(this,Yt,co).call(this,e),et(this,ca,ne(this,ca)+e),!(!ne(this,Sr)||ne(this,Ma))&&(et(this,Ma,!0),Ur(()=>{et(this,Ma,!1),ne(this,Sr)&&Ka(ne(this,Sr),ne(this,ca))}))}get_effect_pending(){return ne(this,fi).call(this),g(ne(this,Sr))}error(e){var r=ne(this,dr).onerror;let a=ne(this,dr).failed;if(ne(this,ua)||!r&&!a)throw e;ne(this,Fn)&&(xn(ne(this,Fn)),et(this,Fn,null)),ne(this,yn)&&(xn(ne(this,yn)),et(this,yn,null)),ne(this,pr)&&(xn(ne(this,pr)),et(this,pr,null));var i=!1,o=!1;const u=()=>{if(i){sd();return}i=!0,o&&Yf(),Gr.ensure(),et(this,ca,0),ne(this,pr)!==null&&va(ne(this,pr),()=>{et(this,pr,null)}),this.is_pending=this.has_pending_snippet(),et(this,Fn,ln(this,Yt,Zs).call(this,()=>(et(this,ua,!1),Kn(()=>ne(this,la).call(this,ne(this,zn)))))),ne(this,Fr)>0?ln(this,Yt,Js).call(this):this.is_pending=!1};Ur(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(f){Fa(f,ne(this,vr)&&ne(this,vr).parent)}a&&et(this,pr,ln(this,Yt,Zs).call(this,()=>{Gr.ensure(),et(this,ua,!0);try{return Kn(()=>{a(ne(this,zn),()=>e,()=>u)})}catch(f){return Fa(f,ne(this,vr).parent),null}finally{et(this,ua,!1)}}))})}}zn=new WeakMap,Ao=new WeakMap,dr=new WeakMap,la=new WeakMap,vr=new WeakMap,Fn=new WeakMap,yn=new WeakMap,pr=new WeakMap,xr=new WeakMap,zr=new WeakMap,ca=new WeakMap,Fr=new WeakMap,Ma=new WeakMap,ua=new WeakMap,La=new WeakMap,Na=new WeakMap,Sr=new WeakMap,fi=new WeakMap,Yt=new WeakSet,md=function(){try{et(this,Fn,Kn(()=>ne(this,la).call(this,ne(this,zn))))}catch(e){this.error(e)}},gd=function(){const e=ne(this,dr).pending;e&&(et(this,yn,Kn(()=>e(ne(this,zn)))),Ur(()=>{var r=ln(this,Yt,lo).call(this);et(this,Fn,ln(this,Yt,Zs).call(this,()=>(Gr.ensure(),Kn(()=>ne(this,la).call(this,r))))),ne(this,Fr)>0?ln(this,Yt,Js).call(this):(va(ne(this,yn),()=>{et(this,yn,null)}),this.is_pending=!1)}))},lo=function(){var e=ne(this,zn);return this.is_pending&&(et(this,zr,Cr()),ne(this,zn).before(ne(this,zr)),e=ne(this,zr)),e},Zs=function(e){var r=bt,a=st,i=Ln;mr(ne(this,vr)),Hn(ne(this,vr)),za(ne(this,vr).ctx);try{return e()}catch(o){return Dc(o),null}finally{mr(r),Hn(a),za(i)}},Js=function(){const e=ne(this,dr).pending;ne(this,Fn)!==null&&(et(this,xr,document.createDocumentFragment()),ne(this,xr).append(ne(this,zr)),su(ne(this,Fn),ne(this,xr))),ne(this,yn)===null&&et(this,yn,Kn(()=>e(ne(this,zn))))},co=function(e){var r;if(!this.has_pending_snippet()){this.parent&&ln(r=this.parent,Yt,co).call(r,e);return}if(et(this,Fr,ne(this,Fr)+e),ne(this,Fr)===0){this.is_pending=!1;for(const a of ne(this,La))qt(a,tn),er(a);for(const a of ne(this,Na))qt(a,nr),er(a);ne(this,La).clear(),ne(this,Na).clear(),ne(this,yn)&&va(ne(this,yn),()=>{et(this,yn,null)}),ne(this,xr)&&(ne(this,zn).before(ne(this,xr)),et(this,xr,null))}};function _d(t,e,r,a){const i=mi;var o=t.filter(x=>!x.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=Xe,f=bt,h=yd(),v=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(x=>x.promise)):null;function y(x){h();try{a(x)}catch(k){(f.f&Ar)===0&&Fa(k,f)}u==null||u.deactivate(),uo()}if(r.length===0){v.then(()=>y(e.map(i)));return}function S(){h(),Promise.all(r.map(x=>bd(x))).then(x=>y([...e.map(i),...x])).catch(x=>Fa(x,f))}v?v.then(S):S()}function yd(){var t=bt,e=st,r=Ln,a=Xe;return function(o=!0){mr(t),Hn(e),za(r),o&&(a==null||a.activate())}}function uo(){mr(null),Hn(null),za(null)}function mi(t){var e=en|tn,r=st!==null&&(st.f&en)!==0?st:null;return bt!==null&&(bt.f|=Ga),{ctx:Ln,deps:null,effects:null,equals:Pc,f:e,fn:t,reactions:null,rv:0,v:Qt,wv:0,parent:r??bt,ac:null}}function bd(t,e,r){let a=bt;a===null&&qf();var i=a.b,o=void 0,u=ma(Qt),f=!st,h=new Map;return jd(()=>{var k;var v=kc();o=v.promise;try{Promise.resolve(t()).then(v.resolve,v.reject).then(()=>{y===Xe&&y.committed&&y.deactivate(),uo()})}catch(A){v.reject(A),uo()}var y=Xe;if(f){var S=i.is_rendered();i.update_pending_count(1),y.increment(S),(k=h.get(y))==null||k.reject(ra),h.delete(y),h.set(y,v)}const x=(A,E=void 0)=>{if(y.activate(),E)E!==ra&&(u.f|=Kr,Ka(u,E));else{(u.f&Kr)!==0&&(u.f^=Kr),Ka(u,A);for(const[T,W]of h){if(h.delete(T),T===y)break;W.reject(ra)}}f&&(i.update_pending_count(-1),y.decrement(S))};v.promise.then(x,A=>x(null,A||"unknown"))}),Zc(()=>{for(const v of h.values())v.reject(ra)}),new Promise(v=>{function y(S){function x(){S===o?v(u):y(o)}S.then(x,x)}y(o)})}function At(t){const e=mi(t);return iu(e),e}function Fc(t){const e=mi(t);return e.equals=Ic,e}function wd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)xn(e[r])}}function kd(t){for(var e=t.parent;e!==null;){if((e.f&en)===0)return(e.f&Ar)===0?e:null;e=e.parent}return null}function Ro(t){var e,r=bt;mr(kd(t));try{t.f&=~ha,wd(t),e=uu(t)}finally{mr(r)}return e}function Kc(t){var e=Ro(t);if(!t.equals(e)&&(t.wv=lu(),(!(Xe!=null&&Xe.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){qt(t,Vt);return}Wr||(Zt!==null?(Do()||Xe!=null&&Xe.is_fork)&&Zt.set(t,e):Io(t))}function xd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(ra),a.teardown=Of,a.ac=null,ms(a,0),Lo(a))}function Uc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Ua(e)}let fo=new Set;const Hr=new Map;let Gc=!1;function ma(t,e){var r={f:0,v:t,reactions:null,equals:Pc,rv:0,wv:0};return r}function Re(t,e){const r=ma(t);return iu(r),r}function Sd(t,e=!1,r=!0){const a=ma(t);return e||(a.equals=Ic),a}function M(t,e,r=!1){st!==null&&(!tr||(st.f&Rl)!==0)&&Rc()&&(st.f&(en|Rr|Po|Rl))!==0&&(Gn===null||!qa.call(Gn,t))&&Vf();let a=r?Jt(e):e;return Ka(t,a)}function Ka(t,e){if(!t.equals(e)){var r=t.v;Wr?Hr.set(t,e):Hr.set(t,r),t.v=e;var a=Gr.ensure();if(a.capture(t,r),(t.f&en)!==0){const i=t;(t.f&tn)!==0&&Ro(i),Io(i)}t.wv=lu(),Hc(t,tn),bt!==null&&(bt.f&Vt)!==0&&(bt.f&(ar|ba))===0&&(Bn===null?Ld([t]):Bn.push(t)),!a.is_fork&&fo.size>0&&!Gc&&Td()}return e}function Td(){Gc=!1;for(const t of fo)(t.f&Vt)!==0&&qt(t,nr),Ss(t)&&Ua(t);fo.clear()}function fs(t){M(t,t.v+1)}function Hc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,f=(u&tn)===0;if(f&&qt(o,e),(u&en)!==0){var h=o;Zt==null||Zt.delete(h),(u&ha)===0&&(u&Un&&(o.f|=ha),Hc(h,nr))}else f&&((u&Rr)!==0&&Xn!==null&&Xn.add(o),er(o))}}function Jt(t){if(typeof t!="object"||t===null||da in t)return t;const e=wc(t);if(e!==If&&e!==Rf)return t;var r=new Map,a=Co(t),i=Re(0),o=pa,u=f=>{if(pa===o)return f();var h=st,v=pa;Hn(null),Nl(o);var y=f();return Hn(h),Nl(v),y};return a&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(f,h,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Hf();var y=r.get(h);return y===void 0?u(()=>{var S=Re(v.value);return r.set(h,S),S}):M(y,v.value,!0),!0},deleteProperty(f,h){var v=r.get(h);if(v===void 0){if(h in f){const y=u(()=>Re(Qt));r.set(h,y),fs(i)}}else M(v,Qt),fs(i);return!0},get(f,h,v){var k;if(h===da)return t;var y=r.get(h),S=h in f;if(y===void 0&&(!S||(k=Ia(f,h))!=null&&k.writable)&&(y=u(()=>{var A=Jt(S?f[h]:Qt),E=Re(A);return E}),r.set(h,y)),y!==void 0){var x=g(y);return x===Qt?void 0:x}return Reflect.get(f,h,v)},getOwnPropertyDescriptor(f,h){var v=Reflect.getOwnPropertyDescriptor(f,h);if(v&&"value"in v){var y=r.get(h);y&&(v.value=g(y))}else if(v===void 0){var S=r.get(h),x=S==null?void 0:S.v;if(S!==void 0&&x!==Qt)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return v},has(f,h){var x;if(h===da)return!0;var v=r.get(h),y=v!==void 0&&v.v!==Qt||Reflect.has(f,h);if(v!==void 0||bt!==null&&(!y||(x=Ia(f,h))!=null&&x.writable)){v===void 0&&(v=u(()=>{var k=y?Jt(f[h]):Qt,A=Re(k);return A}),r.set(h,v));var S=g(v);if(S===Qt)return!1}return y},set(f,h,v,y){var te;var S=r.get(h),x=h in f;if(a&&h==="length")for(var k=v;k<S.v;k+=1){var A=r.get(k+"");A!==void 0?M(A,Qt):k in f&&(A=u(()=>Re(Qt)),r.set(k+"",A))}if(S===void 0)(!x||(te=Ia(f,h))!=null&&te.writable)&&(S=u(()=>Re(void 0)),M(S,Jt(v)),r.set(h,S));else{x=S.v!==Qt;var E=u(()=>Jt(v));M(S,E)}var T=Reflect.getOwnPropertyDescriptor(f,h);if(T!=null&&T.set&&T.set.call(y,v),!x){if(a&&typeof h=="string"){var W=r.get("length"),ce=Number(h);Number.isInteger(ce)&&ce>=W.v&&M(W,ce+1)}fs(i)}return!0},ownKeys(f){g(i);var h=Reflect.ownKeys(f).filter(S=>{var x=r.get(S);return x===void 0||x.v!==Qt});for(var[v,y]of r)y.v!==Qt&&!(v in f)&&h.push(v);return h},setPrototypeOf(){Wf()}})}function Dl(t){try{if(t!==null&&typeof t=="object"&&da in t)return t[da]}catch{}return t}function Ed(t,e){return Object.is(Dl(t),Dl(e))}var jl,Wc,Vc,Yc;function Ad(){if(jl===void 0){jl=window,Wc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Vc=Ia(e,"firstChild").get,Yc=Ia(e,"nextSibling").get,Il(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Il(r)&&(r.__t=void 0)}}function Cr(t=""){return document.createTextNode(t)}function jn(t){return Vc.call(t)}function xs(t){return Yc.call(t)}function m(t,e){return jn(t)}function Qe(t,e=!1){{var r=jn(t);return r instanceof Comment&&r.data===""?xs(r):r}}function b(t,e=1,r=!1){let a=t;for(;e--;)a=xs(a);return a}function Cd(t){t.textContent=""}function Xc(){return!1}function Pd(t,e,r){return document.createElementNS(Cc,t,void 0)}let Ml=!1;function Id(){Ml||(Ml=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Oo(t){var e=st,r=bt;Hn(null),mr(null);try{return t()}finally{Hn(e),mr(r)}}function Qc(t,e,r,a=r){t.addEventListener(e,()=>Oo(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),Id()}function Rd(t){bt===null&&(st===null&&Kf(),Ff()),Wr&&zf()}function Od(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Or(t,e,r){var a=bt;a!==null&&(a.f&Mn)!==0&&(t|=Mn);var i={ctx:Ln,deps:null,nodes:null,f:t|tn|Un,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ua(i)}catch(f){throw xn(i),f}else e!==null&&er(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ga)===0&&(o=o.first,(t&Rr)!==0&&(t&Ba)!==0&&o!==null&&(o.f|=Ba)),o!==null&&(o.parent=a,a!==null&&Od(o,a),st!==null&&(st.f&en)!==0&&(t&ba)===0)){var u=st;(u.effects??(u.effects=[])).push(o)}return i}function Do(){return st!==null&&!tr}function Zc(t){const e=Or(pi,null,!1);return qt(e,Vt),e.teardown=t,e}function ai(t){Rd();var e=bt.f,r=!st&&(e&ar)!==0&&(e&ks)===0;if(r){var a=Ln;(a.e??(a.e=[])).push(t)}else return Jc(t)}function Jc(t){return Or(hs|jf,t,!1)}function Dd(t){Gr.ensure();const e=Or(ba|Ga,t,!0);return(r={})=>new Promise(a=>{r.outro?va(e,()=>{xn(e),a(void 0)}):(xn(e),a(void 0))})}function $c(t){return Or(hs,t,!1)}function jd(t){return Or(Po|Ga,t,!0)}function jo(t,e=0){return Or(pi|e,t,!0)}function $(t,e=[],r=[],a=[]){_d(a,e,r,i=>{Or(pi,()=>t(...i.map(g)),!0)})}function Mo(t,e=0){var r=Or(Rr|e,t,!0);return r}function Kn(t){return Or(ar|Ga,t,!0)}function eu(t){var e=t.teardown;if(e!==null){const r=Wr,a=st;Ll(!0),Hn(null);try{e.call(null)}finally{Ll(r),Hn(a)}}}function Lo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Oo(()=>{i.abort(ra)});var a=r.next;(r.f&ba)!==0?r.parent=null:xn(r,e),r=a}}function Md(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&ar)===0&&xn(e),e=r}}function xn(t,e=!0){var r=!1;(e||(t.f&Tc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(tu(t.nodes.start,t.nodes.end),r=!0),Lo(t,e&&!r),ms(t,0),qt(t,Ar);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();eu(t);var i=t.parent;i!==null&&i.first!==null&&nu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function tu(t,e){for(;t!==null;){var r=t===e?null:xs(t);t.remove(),t=r}}function nu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function va(t,e,r=!0){var a=[];ru(t,a,!0);var i=()=>{r&&xn(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var f of a)f.out(u)}else i()}function ru(t,e,r){if((t.f&Mn)===0){t.f^=Mn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const f of a)(f.is_global||r)&&e.push(f);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&Ba)!==0||(i.f&ar)!==0&&(t.f&Rr)!==0;ru(i,e,u?r:!1),i=o}}}function No(t){au(t,!0)}function au(t,e){if((t.f&Mn)!==0){t.f^=Mn,(t.f&Vt)===0&&(qt(t,tn),er(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ba)!==0||(r.f&ar)!==0;au(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function su(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:xs(r);e.append(r),r=i}}let $s=!1,Wr=!1;function Ll(t){Wr=t}let st=null,tr=!1;function Hn(t){st=t}let bt=null;function mr(t){bt=t}let Gn=null;function iu(t){st!==null&&(Gn===null?Gn=[t]:Gn.push(t))}let kn=null,On=0,Bn=null;function Ld(t){Bn=t}let ou=1,sa=0,pa=sa;function Nl(t){pa=t}function lu(){return++ou}function Ss(t){var e=t.f;if((e&tn)!==0)return!0;if(e&en&&(t.f&=~ha),(e&nr)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(Ss(o)&&Kc(o),o.wv>t.wv)return!0}(e&Un)!==0&&Zt===null&&qt(t,Vt)}return!1}function cu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Gn!==null&&qa.call(Gn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&en)!==0?cu(o,e,!1):e===o&&(r?qt(o,tn):(o.f&Vt)!==0&&qt(o,nr),er(o))}}function uu(t){var E;var e=kn,r=On,a=Bn,i=st,o=Gn,u=Ln,f=tr,h=pa,v=t.f;kn=null,On=0,Bn=null,st=(v&(ar|ba))===0?t:null,Gn=null,za(t.ctx),tr=!1,pa=++sa,t.ac!==null&&(Oo(()=>{t.ac.abort(ra)}),t.ac=null);try{t.f|=ao;var y=t.fn,S=y();t.f|=ks;var x=t.deps,k=Xe==null?void 0:Xe.is_fork;if(kn!==null){var A;if(k||ms(t,On),x!==null&&On>0)for(x.length=On+kn.length,A=0;A<kn.length;A++)x[On+A]=kn[A];else t.deps=x=kn;if(Do()&&(t.f&Un)!==0)for(A=On;A<x.length;A++)((E=x[A]).reactions??(E.reactions=[])).push(t)}else!k&&x!==null&&On<x.length&&(ms(t,On),x.length=On);if(Rc()&&Bn!==null&&!tr&&x!==null&&(t.f&(en|nr|tn))===0)for(A=0;A<Bn.length;A++)cu(Bn[A],t);if(i!==null&&i!==t){if(sa++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=sa;if(e!==null)for(const T of e)T.rv=sa;Bn!==null&&(a===null?a=Bn:a.push(...Bn))}return(t.f&Kr)!==0&&(t.f^=Kr),S}catch(T){return Dc(T)}finally{t.f^=ao,kn=e,On=r,Bn=a,st=i,Gn=o,za(u),tr=f,pa=h}}function Nd(t,e){let r=e.reactions;if(r!==null){var a=Af.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&en)!==0&&(kn===null||!qa.call(kn,e))){var o=e;(o.f&Un)!==0&&(o.f^=Un,o.f&=~ha),Io(o),xd(o),ms(o,0)}}function ms(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)Nd(t,r[a])}function Ua(t){var e=t.f;if((e&Ar)===0){qt(t,Vt);var r=bt,a=$s;bt=t,$s=!0;try{(e&(Rr|xc))!==0?Md(t):Lo(t),eu(t);var i=uu(t);t.teardown=typeof i=="function"?i:null,t.wv=ou;var o;ro&&od&&(t.f&tn)!==0&&t.deps}finally{$s=a,bt=r}}}async function fu(){await Promise.resolve(),ud()}function g(t){var e=t.f,r=(e&en)!==0;if(st!==null&&!tr){var a=bt!==null&&(bt.f&Ar)!==0;if(!a&&(Gn===null||!qa.call(Gn,t))){var i=st.deps;if((st.f&ao)!==0)t.rv<sa&&(t.rv=sa,kn===null&&i!==null&&i[On]===t?On++:kn===null?kn=[t]:kn.push(t));else{(st.deps??(st.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[st]:qa.call(o,st)||o.push(st)}}}if(Wr&&Hr.has(t))return Hr.get(t);if(r){var u=t;if(Wr){var f=u.v;return((u.f&Vt)===0&&u.reactions!==null||vu(u))&&(f=Ro(u)),Hr.set(u,f),f}var h=(u.f&Un)===0&&!tr&&st!==null&&($s||(st.f&Un)!==0),v=(u.f&ks)===0;Ss(u)&&(h&&(u.f|=Un),Kc(u)),h&&!v&&(Uc(u),du(u))}if(Zt!=null&&Zt.has(t))return Zt.get(t);if((t.f&Kr)!==0)throw t.v;return t.v}function du(t){if(t.f|=Un,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&en)!==0&&(e.f&Un)===0&&(Uc(e),du(e))}function vu(t){if(t.v===Qt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Hr.has(e)||(e.f&en)!==0&&vu(e))return!0;return!1}function Ts(t){var e=tr;try{return tr=!0,t()}finally{tr=e}}const qd=["touchstart","touchmove"];function Bd(t){return qd.includes(t)}const pu=new Set,vo=new Set;function Kt(t){for(var e=0;e<t.length;e++)pu.add(t[e]);for(var r of vo)r(t)}let ql=null;function Bl(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;ql=t;var u=0,f=ql===t&&t.__root;if(f){var h=i.indexOf(f);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var v=i.indexOf(e);if(v===-1)return;h<=v&&(u=h)}if(o=i[u]||t.target,o!==e){Cf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=st,S=bt;Hn(null),mr(null);try{for(var x,k=[];o!==null;){var A=o.assignedSlot||o.parentNode||o.host||null;try{var E=o["__"+a];E!=null&&(!o.disabled||t.target===o)&&E.call(o,t)}catch(W){x?k.push(W):x=W}if(t.cancelBubble||A===e||A===null)break;o=A}if(x){for(let W of k)queueMicrotask(()=>{throw W});throw x}}finally{t.__root=e,delete t.currentTarget,Hn(y),mr(S)}}}var _c,yc;const Hi=(yc=(_c=globalThis==null?void 0:globalThis.window)==null?void 0:_c.trustedTypes)==null?void 0:yc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function zd(t){return(Hi==null?void 0:Hi.createHTML(t))??t}function qo(t,e=!1){var r=Pd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?zd(t):t,r.content}function ga(t,e){var r=bt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function B(t,e){var r=(e&Ac)!==0,a=(e&rd)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=qo(o?t:"<!>"+t,!0),r||(i=jn(i)));var u=a||Wc?document.importNode(i,!0):i.cloneNode(!0);if(r){var f=jn(u),h=u.lastChild;ga(f,h)}else ga(u,u);return u}}function Fd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Ac)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var f=qo(o,!0),h=jn(f);if(i)for(u=document.createDocumentFragment();jn(h);)u.appendChild(jn(h));else u=jn(h)}var v=u.cloneNode(!0);if(i){var y=jn(v),S=v.lastChild;ga(y,S)}else ga(v,v);return v}}function Bo(t,e){return Fd(t,e,"svg")}function si(t=""){{var e=Cr(t+"");return ga(e,e),e}}function Pr(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Cr();return t.append(e,r),ga(e,r),t}function L(t,e){t!==null&&t.before(e)}function H(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Kd(t,e){return Ud(t,e)}const Gs=new Map;function Ud(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Ad();var f=new Set,h=S=>{for(var x=0;x<S.length;x++){var k=S[x];if(!f.has(k)){f.add(k);var A=Bd(k);for(const W of[e,document]){var E=Gs.get(W);E===void 0&&(E=new Map,Gs.set(W,E));var T=E.get(k);T===void 0?(W.addEventListener(k,Bl,{passive:A}),E.set(k,1)):E.set(k,T+1)}}}};h(vi(pu)),vo.add(h);var v=void 0,y=Dd(()=>{var S=r??e.appendChild(Cr());return pd(S,{pending:()=>{}},x=>{Ct({});var k=Ln;o&&(k.c=o),i&&(a.$$events=i),v=t(x,a)||{},Pt()}),()=>{var E;for(var x of f)for(const T of[e,document]){var k=Gs.get(T),A=k.get(x);--A==0?(T.removeEventListener(x,Bl),k.delete(x),k.size===0&&Gs.delete(T)):k.set(x,A)}vo.delete(h),S!==r&&((E=S.parentNode)==null||E.removeChild(S))}});return Gd.set(v,y),v}let Gd=new WeakMap;var Zn,hr,Dn,fa,bs,ws,di;class Hd{constructor(e,r=!0){rt(this,"anchor");at(this,Zn,new Map);at(this,hr,new Map);at(this,Dn,new Map);at(this,fa,new Set);at(this,bs,!0);at(this,ws,()=>{var e=Xe;if(ne(this,Zn).has(e)){var r=ne(this,Zn).get(e),a=ne(this,hr).get(r);if(a)No(a),ne(this,fa).delete(r);else{var i=ne(this,Dn).get(r);i&&(ne(this,hr).set(r,i.effect),ne(this,Dn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of ne(this,Zn)){if(ne(this,Zn).delete(o),o===e)break;const f=ne(this,Dn).get(u);f&&(xn(f.effect),ne(this,Dn).delete(u))}for(const[o,u]of ne(this,hr)){if(o===r||ne(this,fa).has(o))continue;const f=()=>{if(Array.from(ne(this,Zn).values()).includes(o)){var v=document.createDocumentFragment();su(u,v),v.append(Cr()),ne(this,Dn).set(o,{effect:u,fragment:v})}else xn(u);ne(this,fa).delete(o),ne(this,hr).delete(o)};ne(this,bs)||!a?(ne(this,fa).add(o),va(u,f,!1)):f()}}});at(this,di,e=>{ne(this,Zn).delete(e);const r=Array.from(ne(this,Zn).values());for(const[a,i]of ne(this,Dn))r.includes(a)||(xn(i.effect),ne(this,Dn).delete(a))});this.anchor=e,et(this,bs,r)}ensure(e,r){var a=Xe,i=Xc();if(r&&!ne(this,hr).has(e)&&!ne(this,Dn).has(e))if(i){var o=document.createDocumentFragment(),u=Cr();o.append(u),ne(this,Dn).set(e,{effect:Kn(()=>r(u)),fragment:o})}else ne(this,hr).set(e,Kn(()=>r(this.anchor)));if(ne(this,Zn).set(a,e),i){for(const[f,h]of ne(this,hr))f===e?a.unskip_effect(h):a.skip_effect(h);for(const[f,h]of ne(this,Dn))f===e?a.unskip_effect(h.effect):a.skip_effect(h.effect);a.oncommit(ne(this,ws)),a.ondiscard(ne(this,di))}else ne(this,ws).call(this)}}Zn=new WeakMap,hr=new WeakMap,Dn=new WeakMap,fa=new WeakMap,bs=new WeakMap,ws=new WeakMap,di=new WeakMap;function ue(t,e,r=!1){var a=new Hd(t),i=r?Ba:0;function o(u,f){a.ensure(u,f)}Mo(()=>{var u=!1;e((f,h=0)=>{u=!0,o(h,f)}),u||o(!1,null)},i)}function rr(t,e){return e}function Wd(t,e,r){for(var a=[],i=e.length,o,u=e.length,f=0;f<i;f++){let S=e[f];va(S,()=>{if(o){if(o.pending.delete(S),o.done.add(S),o.pending.size===0){var x=t.outrogroups;po(vi(o.done)),x.delete(o),x.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var h=a.length===0&&r!==null;if(h){var v=r,y=v.parentNode;Cd(y),y.append(v),t.items.clear()}po(e,!h)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function po(t,e=!0){for(var r=0;r<t.length;r++)xn(t[r],e)}var zl;function un(t,e,r,a,i,o=null){var u=t,f=new Map,h=(e&Ec)!==0;if(h){var v=t;u=v.appendChild(Cr())}var y=null,S=Fc(()=>{var W=r();return Co(W)?W:W==null?[]:vi(W)}),x,k=!0;function A(){T.fallback=y,Vd(T,x,u,e,a),y!==null&&(x.length===0?(y.f&Er)===0?No(y):(y.f^=Er,ls(y,null,u)):va(y,()=>{y=null}))}var E=Mo(()=>{x=g(S);for(var W=x.length,ce=new Set,te=Xe,U=Xc(),F=0;F<W;F+=1){var X=x[F],V=a(X,F),ve=k?null:f.get(V);ve?(ve.v&&Ka(ve.v,X),ve.i&&Ka(ve.i,F),U&&te.unskip_effect(ve.e)):(ve=Yd(f,k?u:zl??(zl=Cr()),X,V,F,i,e,r),k||(ve.e.f|=Er),f.set(V,ve)),ce.add(V)}if(W===0&&o&&!y&&(k?y=Kn(()=>o(u)):(y=Kn(()=>o(zl??(zl=Cr()))),y.f|=Er)),W>ce.size&&Bf(),!k)if(U){for(const[Ce,Pe]of f)ce.has(Ce)||te.skip_effect(Pe.e);te.oncommit(A),te.ondiscard(()=>{})}else A();g(S)}),T={effect:E,items:f,outrogroups:null,fallback:y};k=!1}function es(t){for(;t!==null&&(t.f&ar)===0;)t=t.next;return t}function Vd(t,e,r,a,i){var Pe,ie,J,oe,Ae,re,de,pe,ee;var o=(a&Zf)!==0,u=e.length,f=t.items,h=es(t.effect.first),v,y=null,S,x=[],k=[],A,E,T,W;if(o)for(W=0;W<u;W+=1)A=e[W],E=i(A,W),T=f.get(E).e,(T.f&Er)===0&&((ie=(Pe=T.nodes)==null?void 0:Pe.a)==null||ie.measure(),(S??(S=new Set)).add(T));for(W=0;W<u;W+=1){if(A=e[W],E=i(A,W),T=f.get(E).e,t.outrogroups!==null)for(const fe of t.outrogroups)fe.pending.delete(T),fe.done.delete(T);if((T.f&Er)!==0)if(T.f^=Er,T===h)ls(T,null,r);else{var ce=y?y.next:h;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),Nr(t,y,T),Nr(t,T,ce),ls(T,ce,r),y=T,x=[],k=[],h=es(y.next);continue}if((T.f&Mn)!==0&&(No(T),o&&((oe=(J=T.nodes)==null?void 0:J.a)==null||oe.unfix(),(S??(S=new Set)).delete(T))),T!==h){if(v!==void 0&&v.has(T)){if(x.length<k.length){var te=k[0],U;y=te.prev;var F=x[0],X=x[x.length-1];for(U=0;U<x.length;U+=1)ls(x[U],te,r);for(U=0;U<k.length;U+=1)v.delete(k[U]);Nr(t,F.prev,X.next),Nr(t,y,F),Nr(t,X,te),h=te,y=X,W-=1,x=[],k=[]}else v.delete(T),ls(T,h,r),Nr(t,T.prev,T.next),Nr(t,T,y===null?t.effect.first:y.next),Nr(t,y,T),y=T;continue}for(x=[],k=[];h!==null&&h!==T;)(v??(v=new Set)).add(h),k.push(h),h=es(h.next);if(h===null)continue}(T.f&Er)===0&&x.push(T),y=T,h=es(T.next)}if(t.outrogroups!==null){for(const fe of t.outrogroups)fe.pending.size===0&&(po(vi(fe.done)),(Ae=t.outrogroups)==null||Ae.delete(fe));t.outrogroups.size===0&&(t.outrogroups=null)}if(h!==null||v!==void 0){var V=[];if(v!==void 0)for(T of v)(T.f&Mn)===0&&V.push(T);for(;h!==null;)(h.f&Mn)===0&&h!==t.fallback&&V.push(h),h=es(h.next);var ve=V.length;if(ve>0){var Ce=(a&Ec)!==0&&u===0?r:null;if(o){for(W=0;W<ve;W+=1)(de=(re=V[W].nodes)==null?void 0:re.a)==null||de.measure();for(W=0;W<ve;W+=1)(ee=(pe=V[W].nodes)==null?void 0:pe.a)==null||ee.fix()}Wd(t,V,Ce)}}o&&Ur(()=>{var fe,me;if(S!==void 0)for(T of S)(me=(fe=T.nodes)==null?void 0:fe.a)==null||me.apply()})}function Yd(t,e,r,a,i,o,u,f){var h=(u&Xf)!==0?(u&Jf)===0?Sd(r,!1,!1):ma(r):null,v=(u&Qf)!==0?ma(i):null;return{v:h,i:v,e:Kn(()=>(o(e,h??r,v??i,f),()=>{t.delete(a)}))}}function ls(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&Er)===0?e.nodes.start:r;a!==null;){var u=xs(a);if(o.before(a),a===i)return;a=u}}function Nr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Xd(t,e,r=!1,a=!1,i=!1){var o=t,u="";$(()=>{var f=bt;if(u!==(u=e()??"")&&(f.nodes!==null&&(tu(f.nodes.start,f.nodes.end),f.nodes=null),u!=="")){var h=u+"";r?h=`<svg>${h}</svg>`:a&&(h=`<math>${h}</math>`);var v=qo(h);if((r||a)&&(v=jn(v)),ga(jn(v),v.lastChild),r||a)for(;jn(v);)o.before(jn(v));else o.before(v)}})}const Fl=[...` 	
\r\fÂ \v\uFEFF`];function Qd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var f=u+o;(u===0||Fl.includes(a[u-1]))&&(f===a.length||Fl.includes(a[f]))?a=(u===0?"":a.substring(0,u))+a.substring(f+1):u=f}}return a===""?null:a}function Kl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Wi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Zd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,f=!1,h=[];a&&h.push(...Object.keys(a).map(Wi)),i&&h.push(...Object.keys(i).map(Wi));var v=0,y=-1;const E=t.length;for(var S=0;S<E;S++){var x=t[S];if(f?x==="/"&&t[S-1]==="*"&&(f=!1):o?o===x&&(o=!1):x==="/"&&t[S+1]==="*"?f=!0:x==='"'||x==="'"?o=x:x==="("?u++:x===")"&&u--,!f&&o===!1&&u===0){if(x===":"&&y===-1)y=S;else if(x===";"||S===E-1){if(y!==-1){var k=Wi(t.substring(v,y).trim());if(!h.includes(k)){x!==";"&&S++;var A=t.substring(v,S).trim();r+=" "+A+";"}}v=S+1,y=-1}}}}return a&&(r+=Kl(a)),i&&(r+=Kl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Nt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var f=Qd(r,a,o);f==null?t.removeAttribute("class"):e?t.className=f:t.setAttribute("class",f),t.__className=r}else if(o&&i!==o)for(var h in o){var v=!!o[h];(i==null||v!==!!i[h])&&t.classList.toggle(h,v)}return o}function Vi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function Sn(t,e,r,a){var i=t.__style;if(i!==e){var o=Zd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Vi(t,r==null?void 0:r[0],a[0]),Vi(t,r==null?void 0:r[1],a[1],"important")):Vi(t,r,a));return a}function hu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!Co(e))return ad();for(var a of t.options)a.selected=e.includes(ds(a));return}for(a of t.options){var i=ds(a);if(Ed(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Jd(t){var e=new MutationObserver(()=>{hu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Zc(()=>{e.disconnect()})}function zo(t,e,r=e){var a=new WeakSet,i=!0;Qc(t,"change",o=>{var u=o?"[selected]":":checked",f;if(t.multiple)f=[].map.call(t.querySelectorAll(u),ds);else{var h=t.querySelector(u)??t.querySelector("option:not([disabled])");f=h&&ds(h)}r(f),Xe!==null&&a.add(Xe)}),$c(()=>{var o=e();if(t===document.activeElement){var u=ri??Xe;if(a.has(u))return}if(hu(t,o,i),i&&o===void 0){var f=t.querySelector(":checked");f!==null&&(o=ds(f),r(o))}t.__value=o,i=!1}),Jd(t)}function ds(t){return"__value"in t?t.__value:t.value}const $d=Symbol("is custom element"),ev=Symbol("is html");function mu(t,e,r,a){var i=tv(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Lf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&nv(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function tv(t){return t.__attributes??(t.__attributes={[$d]:t.nodeName.includes("-"),[ev]:t.namespaceURI===Cc})}var Ul=new Map;function nv(t){var e=t.getAttribute("is")||t.nodeName,r=Ul.get(e);if(r)return r;Ul.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=Pf(i);for(var u in a)a[u].set&&r.push(u);i=wc(i)}return r}function Fo(t,e,r=e){var a=new WeakSet;Qc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Yi(t)?Xi(o):o,r(o),Xe!==null&&a.add(Xe),await fu(),o!==(o=e())){var u=t.selectionStart,f=t.selectionEnd,h=t.value.length;if(t.value=o??"",f!==null){var v=t.value.length;u===f&&f===h&&v>h?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=u,t.selectionEnd=Math.min(f,v))}}}),Ts(e)==null&&t.value&&(r(Yi(t)?Xi(t.value):t.value),Xe!==null&&a.add(Xe)),jo(()=>{var i=e();if(t===document.activeElement){var o=ri??Xe;if(a.has(o))return}Yi(t)&&i===Xi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Yi(t){var e=t.type;return e==="number"||e==="range"}function Xi(t){return t===""?null:+t}function Gl(t,e){return t===e||(t==null?void 0:t[da])===e}function gu(t={},e,r,a){return $c(()=>{var i,o;return jo(()=>{i=o,o=[],Ts(()=>{t!==r(...o)&&(e(t,...o),i&&Gl(r(...i),t)&&e(null,...i))})}),()=>{Ur(()=>{o&&Gl(r(...o),t)&&e(null,...o)})}}),t}let Hs=!1;function rv(t){var e=Hs;try{return Hs=!1,[t(),Hs]}finally{Hs=e}}function Oe(t,e,r,a){var ce;var i=(r&td)!==0,o=(r&nd)!==0,u=a,f=!0,h=()=>(f&&(f=!1,u=o?Ts(a):a),u),v;if(i){var y=da in t||Mf in t;v=((ce=Ia(t,e))==null?void 0:ce.set)??(y&&e in t?te=>t[e]=te:void 0)}var S,x=!1;i?[S,x]=rv(()=>t[e]):S=t[e],S===void 0&&a!==void 0&&(S=h(),v&&(Gf(),v(S)));var k;if(k=()=>{var te=t[e];return te===void 0?h():(f=!0,te)},(r&ed)===0)return k;if(v){var A=t.$$legacy;return(function(te,U){return arguments.length>0?((!U||A||x)&&v(U?k():te),te):k()})}var E=!1,T=((r&$f)!==0?mi:Fc)(()=>(E=!1,k()));i&&g(T);var W=bt;return(function(te,U){if(arguments.length>0){const F=U?g(T):i?Jt(te):te;return M(T,F),E=!0,u!==void 0&&(u=F),te}return Wr&&E||(W.f&Ar)!==0?T.v:g(T)})}function nn(t){Ln===null&&Nf(),ai(()=>{const e=Ts(t);if(typeof e=="function")return e})}const av="5";var bc;typeof window<"u"&&((bc=window.__svelte??(window.__svelte={})).v??(bc.v=new Set)).add(av);const Ir=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",contextWindow:32768,maxEmailTokens:4e3,description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",contextWindow:32768,maxEmailTokens:6e3,description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",contextWindow:32768,maxEmailTokens:12e3,description:"Better reasoning, slower, best for email classification",recommendedForEmailProcessing:!0},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",contextWindow:32768,maxEmailTokens:5e3,description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",contextWindow:16384,maxEmailTokens:8e3,description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",contextWindow:131072,maxEmailTokens:16e3,description:"128k context, reliable, excellent for long emails",recommendedForEmailProcessing:!0},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",contextWindow:8192,maxEmailTokens:2e3,description:"Smallest, ultra fast, not for long emails"}];function Ko(t){return Ir.find(e=>e.id===t)}function _u(t,e){var a;const r=Ko(t);return r?e>r.maxEmailTokens?{suitable:!1,reason:`Email too long (~${e} tokens). This model supports up to ${r.maxEmailTokens} tokens. Try ${((a=Ir.find(i=>i.recommendedForEmailProcessing))==null?void 0:a.name)||"a larger model"}.`}:!r.recommendedForEmailProcessing&&e>4e3?{suitable:!0,warning:`For best results with long emails, use ${Ir.filter(i=>i.recommendedForEmailProcessing).map(i=>i.name).join(" or ")}`}:{suitable:!0}:{suitable:!1,reason:"Unknown model"}}const sv=Object.freeze(Object.defineProperty({__proto__:null,MODELS:Ir,getModelInfo:Ko,isModelSuitableForEmail:_u},Symbol.toStringTag,{value:"Module"}));let bn=null,Tr="idle",ei=null,ta=new Set;function Ws(){return bn||(bn=new Worker(new URL(""+new URL("worker-BJ8R2iOv.js",import.meta.url).href,import.meta.url),{type:"module"}),bn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Tr="loading"),e.status==="ready"&&(Tr="ready"),e.status==="start"&&(Tr="generating"),(e.status==="complete"||e.status==="error")&&(Tr=ei?"ready":"idle");for(const r of ta)try{r(e)}catch{}})),bn}function yu(){return{check(){Ws().postMessage({type:"check"})},loadModel(t){ei=t,Tr="loading",Ws().postMessage({type:"load",modelId:t})},generate(t,e){Ws().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,f=0,h=0;const v=S=>{switch(S.status){case"start":h=S.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=S.output,u=S.tps??u,f=S.numTokens??f,r)try{r({tps:u,numTokens:f})}catch{}break;case"complete":y(),a({text:o,tps:u,numTokens:f,inputTokens:h});break;case"error":y(),i(new Error(S.data));break}},y=()=>{ta.delete(v)};ta.add(v),Ws().postMessage({type:"generate",data:t,options:e})})},interrupt(){bn==null||bn.postMessage({type:"interrupt"})},reset(){bn==null||bn.postMessage({type:"reset"})},onMessage(t){return ta.add(t),()=>ta.delete(t)},offMessage(t){ta.delete(t)},get status(){return Tr},get isReady(){return Tr==="ready"},get isGenerating(){return Tr==="generating"},get modelId(){return ei},terminate(){bn==null||bn.terminate(),bn=null,Tr="idle",ei=null,ta.clear()}}}var iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ov(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ti={exports:{}},lv=ti.exports,Hl;function cv(){return Hl||(Hl=1,(function(t,e){((r,a)=>{t.exports=a()})(lv,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(l[d]=c[d])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var d in s=arguments[l])Object.prototype.hasOwnProperty.call(s,d)&&(n[d]=s[d]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,d=0,p=s.length;d<p;d++)!c&&d in s||((c=c||Array.prototype.slice.call(s,0,d))[d]=s[d]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:iv,u=Object.keys,f=Array.isArray;function h(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var v=Object.getPrototypeOf,y={}.hasOwnProperty;function S(n,s){return y.call(n,s)}function x(n,s){typeof s=="function"&&(s=s(v(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){A(n,l,s[l])})}var k=Object.defineProperty;function A(n,s,l,c){k(n,s,h(l&&S(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function E(n){return{from:function(s){return n.prototype=Object.create(s.prototype),A(n.prototype,"constructor",n),{extend:x.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,W=[].slice;function ce(n,s,l){return W.call(n,s,l)}function te(n,s){return s(n)}function U(n){if(!n)throw new Error("Assertion Failed")}function F(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function X(n,s){if(typeof s=="string"&&S(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,d=s.length;c<d;++c){var p=X(n,s[c]);l.push(p)}return l}var _,w=s.indexOf(".");return w===-1||(_=n[s.substr(0,w)])==null?void 0:X(_,s.substr(w+1))}function V(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){U(typeof l!="string"&&"length"in l);for(var c=0,d=s.length;c<d;++c)V(n,s[c],l[c])}else{var p,_,w=s.indexOf(".");w!==-1?(p=s.substr(0,w),(w=s.substr(w+1))===""?l===void 0?f(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:V(_=(_=n[p])&&S(n,p)?_:n[p]={},w,l)):l===void 0?f(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function ve(n){var s,l={};for(s in n)S(n,s)&&(l[s]=n[s]);return l}var Ce=[].concat;function Pe(n){return Ce.apply([],n)}var Z="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pe([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ie=new Set(Z.map(function(n){return o[n]})),J=null;function oe(n){return J=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=J.get(l);if(c)return c;if(f(l)){c=[],J.set(l,c);for(var d=0,p=l.length;d<p;++d)c.push(s(l[d]))}else if(ie.has(l.constructor))c=l;else{var _,w=v(l);for(_ in c=w===Object.prototype?{}:Object.create(w),J.set(l,c),l)S(l,_)&&(c[_]=s(l[_]))}return c})(n),J=null,n}var Ae={}.toString;function re(n){return Ae.call(n).slice(8,-1)}var de=typeof Symbol<"u"?Symbol.iterator:"@@iterator",pe=typeof de=="symbol"?function(n){var s;return n!=null&&(s=n[de])&&s.apply(n)}:function(){return null};function ee(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var fe={};function me(n){var s,l,c,d;if(arguments.length===1){if(f(n))return n.slice();if(this===fe&&typeof n=="string")return[n];if(d=pe(n))for(l=[];!(c=d.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var be=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],mt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Z),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Q(n,s){this.name=n,this.message=s}function le(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,d){return d.indexOf(l)===c}).join(`
`)}function Be(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=le(n,s)}function We(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=le(n,this.failures)}E(Q).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(Be).from(Q),E(We).from(Q);var qe=mt.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ue=Q,q=mt.reduce(function(n,s){var l=s+"Error";function c(d,p){this.name=l,d?typeof d=="string"?(this.message="".concat(d).concat(p?`
 `+p:""),this.inner=p||null):typeof d=="object"&&(this.message="".concat(d.name," ").concat(d.message),this.inner=d):(this.message=ae[s]||l,this.inner=null)}return E(c).from(Ue),n[s]=c,n},{}),ye=(q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError,Z.reduce(function(n,s){return n[s+"Error"]=q[s],n},{}));Z=mt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=q[s]),n},{});function xe(){}function De(n){return n}function it(n,s){return n==null||n===De?s:function(l){return s(n(l))}}function ot(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function dt(n,s){return n===xe?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),d=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?ot(c,this.onsuccess):c),d&&(this.onerror=this.onerror?ot(d,this.onerror):d),p!==void 0?p:l}}function Rt(n,s){return n===xe?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?ot(l,this.onsuccess):l),c&&(this.onerror=this.onerror?ot(c,this.onerror):c)}}function Ve(n,s){return n===xe?s:function(d){var c=n.apply(this,arguments),d=(h(d,c),this.onsuccess),p=this.onerror,_=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return d&&(this.onsuccess=this.onsuccess?ot(d,this.onsuccess):d),p&&(this.onerror=this.onerror?ot(p,this.onerror):p),c===void 0?_===void 0?void 0:_:h(c,_)}}function Ye(n,s){return n===xe?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function lt(n,s){return n===xe?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,d=arguments.length,p=new Array(d);d--;)p[d]=arguments[d];return l.then(function(){return s.apply(c,p)})}return s.apply(this,arguments)}}Z.ModifyError=Be,Z.DexieError=Q,Z.BulkError=We;var ct=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function wt(n){ct=n}var Tt={},Bt=100,kt=typeof Promise>"u"?[]:(mt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[kt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(kt),mt]:[mt,v(mt),mt]),mt=kt[0],Ca=kt[1],Ca=Ca&&Ca.then,yt=mt&&mt.constructor,fn=!!kt[2],rn=function(n,s){Vn.push([n,s]),an&&(queueMicrotask(Ze),an=!1)},gn=!0,an=!0,Ut=[],Gt=[],Tn=De,It={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:xe,pgp:!1,env:{},finalize:xe},je=It,Vn=[],En=0,_r=[];function Ee(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=je;if(typeof n!="function"){if(n!==Tt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Yn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,d){try{d(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var _=c._lib&&nt();p&&typeof p.then=="function"?l(c,function(w,R){p instanceof Ee?p._then(w,R):p.then(w,R)}):(c._state=!0,c._value=p,xa(c)),_&&jt()}},Yn.bind(null,c))}catch(p){Yn(c,p)}})(this,n)}var sr={get:function(){var n=je,s=or;function l(c,d){var p=this,_=!n.global&&(n!==je||s!==or),w=_&&!Pn(),R=new Ee(function(K,O){Yr(p,new ka(C(c,n,_,w),C(d,n,_,w),K,O,n))});return this._consoleTask&&(R._consoleTask=this._consoleTask),R}return l.prototype=Tt,l},set:function(n){A(this,"then",n&&n.prototype===Tt?sr:{get:function(){return n},set:sr.set})}};function ka(n,s,l,c,d){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=d}function Yn(n,s){var l,c;Gt.push(s),n._state===null&&(l=n._lib&&nt(),s=Tn(s),n._state=!1,n._value=s,c=n,Ut.some(function(d){return d._value===c._value})||Ut.push(c),xa(n),l)&&jt()}function xa(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)Yr(n,s[l]);var d=n._PSD;--d.ref||d.finalize(),En===0&&(++En,rn(function(){--En==0&&zt()},[]))}function Yr(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++En,rn(Ot,[l,n,s])}}function Ot(n,s,l){try{var c,d=s._value;!s._state&&Gt.length&&(Gt=[]),c=ct&&s._consoleTask?s._consoleTask.run(function(){return n(d)}):n(d),s._state||Gt.indexOf(d)!==-1||(p=>{for(var _=Ut.length;_;)if(Ut[--_]._value===p._value)return Ut.splice(_,1)})(s),l.resolve(c)}catch(p){l.reject(p)}finally{--En==0&&zt(),--l.psd.ref||l.psd.finalize()}}function Ze(){Ne(It,function(){nt()&&jt()})}function nt(){var n=gn;return an=gn=!1,n}function jt(){var n,s,l;do for(;0<Vn.length;)for(n=Vn,Vn=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<Vn.length);an=gn=!0}function zt(){for(var n=Ut,s=(Ut=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),_r.slice(0)),l=s.length;l;)s[--l]()}function An(n){return new Ee(Tt,!1,n)}function gt(n,s){var l=je;return function(){var c=nt(),d=je;try{return _n(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{_n(d,!1),c&&jt()}}}x(Ee.prototype,{then:sr,_then:function(n,s){Yr(this,new ka(null,null,n,s,je))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:An)(c)}):this.then(null,function(c){return(c&&c.name===s?l:An)(c)}))},finally:function(n){return this.then(function(s){return Ee.resolve(n()).then(function(){return s})},function(s){return Ee.resolve(n()).then(function(){return An(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ee(function(c,d){var p=setTimeout(function(){return d(new q.Timeout(s))},n);l.then(c,d).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&A(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),It.env=Sa(),x(Ee,{all:function(){var n=me.apply(null,arguments).map(yr);return new Ee(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(d,p){return Ee.resolve(d).then(function(_){n[p]=_,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ee?n:n&&typeof n.then=="function"?new Ee(function(s,l){n.then(s,l)}):new Ee(Tt,!0,n)},reject:An,race:function(){var n=me.apply(null,arguments).map(yr);return new Ee(function(s,l){n.map(function(c){return Ee.resolve(c).then(s,l)})})},PSD:{get:function(){return je},set:function(n){return je=n}},totalEchoes:{get:function(){return or}},newPSD:Cn,usePSD:Ne,scheduler:{get:function(){return rn},set:function(n){rn=n}},rejectionMapper:{get:function(){return Tn},set:function(n){Tn=n}},follow:function(n,s){return new Ee(function(l,c){return Cn(function(d,p){var _=je;_.unhandleds=[],_.onunhandled=p,_.finalize=ot(function(){var w,R=this;w=function(){R.unhandleds.length===0?d():p(R.unhandleds[0])},_r.push(function K(){w(),_r.splice(_r.indexOf(K),1)}),++En,rn(function(){--En==0&&zt()},[])},_.finalize),n()},s,l,c)})}}),yt&&(yt.allSettled&&A(Ee,"allSettled",function(){var n=me.apply(null,arguments).map(yr);return new Ee(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(d,p){return Ee.resolve(d).then(function(_){return c[p]={status:"fulfilled",value:_}},function(_){return c[p]={status:"rejected",reason:_}}).then(function(){return--l||s(c)})})})}),yt.any&&typeof AggregateError<"u"&&A(Ee,"any",function(){var n=me.apply(null,arguments).map(yr);return new Ee(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,d=new Array(c);n.forEach(function(p,_){return Ee.resolve(p).then(function(w){return s(w)},function(w){d[_]=w,--c||l(new AggregateError(d))})})})}),yt.withResolvers)&&(Ee.withResolvers=yt.withResolvers);var Ge={awaits:0,echoes:0,id:0},Ft=0,dn=[],ir=0,or=0,Xr=0;function Cn(n,_,l,c){var d=je,p=Object.create(d),_=(p.parent=d,p.ref=0,p.global=!1,p.id=++Xr,It.env,p.env=fn?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},_&&h(p,_),++d.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Ne(p,n,l,c));return p.ref===0&&p.finalize(),_}function Ht(){return Ge.id||(Ge.id=++Ft),++Ge.awaits,Ge.echoes+=Bt,Ge.id}function Pn(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*Bt,!0)}function yr(n){return Ge.echoes&&n&&n.constructor===yt?(Ht(),n.then(function(s){return Pn(),s},function(s){return Pn(),ke(s)})):n}function Qr(){var n=dn[dn.length-1];dn.pop(),_n(n,!1)}function _n(n,s){var l,c,d=je;(s?!Ge.echoes||ir++&&n===je:!ir||--ir&&n===je)||queueMicrotask(s?(function(p){++or,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.awaits=Ge.id=0),dn.push(je),_n(p,!0)}).bind(null,n):Qr),n!==je&&(je=n,d===It&&(It.env=Sa()),fn)&&(l=It.env.Promise,c=n.env,d.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function Sa(){var n=o.Promise;return fn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Ne(n,s,l,c,d){var p=je;try{return _n(n,!0),s(l,c,d)}finally{_n(p,!1)}}function C(n,s,l,c){return typeof n!="function"?n:function(){var d=je;l&&Ht(),_n(s,!0);try{return n.apply(this,arguments)}finally{_n(d,!1),c&&queueMicrotask(Pn)}}}function _e(n){Promise===yt&&Ge.echoes===0?ir===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ca).indexOf("[native code]")===-1&&(Ht=Pn=xe);var ke=Ee.reject,Fe="ï¿¿",He="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vt="String expected.",xt=[],sn="__dbnames",In="readonly",lr="readwrite";function St(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Zr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Xt(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=oe(s))[n],s}}function Dr(){throw q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Je(n,s){try{var l=As(n),c=As(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var d=al(n),p=al(s),_=d.length,w=p.length,R=_<w?_:w,K=0;K<R;++K)if(d[K]!==p[K])return d[K]<p[K]?-1:1;return _===w?0:_<w?-1:1;case"Array":for(var O=n,P=s,j=O.length,N=P.length,D=j<N?j:N,I=0;I<D;++I){var G=Je(O[I],P[I]);if(G!==0)return G}return j===N?0:j<N?-1:1}}catch{}return NaN}function As(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=re(n))==="ArrayBuffer")?"binary":s}function al(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Cs(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(d,p){return!l.failures[p]})),Promise.all(c.map(function(d){return d=d.updatesTable,s?n.db.table(d).where("k").anyOf(s).delete():n.db.table(d).clear()})).then(function(){return l})):l}sl.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(f(l))return i(i([],f(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(f(c))return f(n)?n.filter(function(d){return!c.includes(d)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Ha=sl;function sl(n){this["@@propmod"]=n}function il(n,s){for(var l=u(s),c=l.length,d=!1,p=0;p<c;++p){var _=l[p],w=s[_],R=X(n,_);w instanceof Ha?(V(n,_,w.execute(R)),d=!0):R!==w&&(V(n,_,w),d=!0)}return d}Et.prototype._trans=function(n,s,l){var c=this._tx||je.trans,d=this.name,p=ct&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function _(K,O,P){if(P.schema[d])return s(P.idbtrans,P);throw new q.NotFound("Table "+d+" not part of transaction")}var w=nt();try{var R=c&&c.db._novip===this.db._novip?c===je.trans?c._promise(n,_,l):Cn(function(){return c._promise(n,_,l)},{trans:c,transless:je.transless||je}):(function K(O,P,j,N){if(O.idbdb&&(O._state.openComplete||je.letThrough||O._vip)){var D=O._createTransaction(P,j,O._dbSchema);try{D.create(),O._state.PR1398_maxLoop=3}catch(I){return I.name===qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return K(O,P,j,N)})):ke(I)}return D._promise(P,function(I,G){return Cn(function(){return je.trans=D,N(I,G,D)})}).then(function(I){if(P==="readwrite")try{D.idbtrans.commit()}catch{}return P==="readonly"?I:D._completion.then(function(){return I})})}if(O._state.openComplete)return ke(new q.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return ke(new q.DatabaseClosed);O.open().catch(xe)}return O._state.dbReadyPromise.then(function(){return K(O,P,j,N)})})(this.db,n,[this.name],_);return p&&(R._consoleTask=p,R=R.catch(function(K){return console.trace(K),ke(K)})),R}finally{w&&jt()}},Et.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ke(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(d){return l.hook.reading.fire(d)})}).then(s)},Et.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(f(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(w){if(w.compound&&s.every(function(K){return 0<=w.keyPath.indexOf(K)})){for(var R=0;R<s.length;++R)if(s.indexOf(w.keyPath[R])===-1)return!1;return!0}return!1}).sort(function(w,R){return w.keyPath.length-R.keyPath.length})[0];if(l&&this.db._maxKey!==Fe)return _=l.keyPath.slice(0,s.length),this.where(_).equals(_.map(function(w){return n[w]}));!l&&ct&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function d(w,R){return Je(w,R)===0}var _=s.reduce(function(O,R){var K=O[0],O=O[1],P=c[R],j=n[R];return[K||P,K||!P?St(O,P&&P.multi?function(N){return N=X(N,R),f(N)&&N.some(function(D){return d(j,D)})}:function(N){return d(j,X(N,R))}):O]},[null,null]),p=_[0],_=_[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(_):l?this.filter(_):this.where(s).equals("")},Et.prototype.filter=function(n){return this.toCollection().and(n)},Et.prototype.count=function(n){return this.toCollection().count(n)},Et.prototype.offset=function(n){return this.toCollection().offset(n)},Et.prototype.limit=function(n){return this.toCollection().limit(n)},Et.prototype.each=function(n){return this.toCollection().each(n)},Et.prototype.toArray=function(n){return this.toCollection().toArray(n)},Et.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Et.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,f(n)?"[".concat(n.join("+"),"]"):n))},Et.prototype.reverse=function(){return this.toCollection().reverse()},Et.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof Dr&&(n=(_=>{var w=O,R=_;if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function K(){this.constructor=w}function O(){return _!==null&&_.apply(this,arguments)||this}return r(w,R),w.prototype=R===null?Object.create(R):(K.prototype=R.prototype,new K),Object.defineProperty(O.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),O.prototype.table=function(){return l},O})(n)),new Set),d=n.prototype;d;d=v(d))Object.getOwnPropertyNames(d).forEach(function(_){return c.add(_)});function p(_){if(!_)return _;var w,R=Object.create(n.prototype);for(w in _)if(!c.has(w))try{R[w]=_[w]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},Et.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},Et.prototype.add=function(n,s){var l=this,c=this.schema.primKey,d=c.auto,p=c.keyPath,_=n;return p&&d&&(_=Xt(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"add",keys:s!=null?[s]:null,values:[_]})}).then(function(w){return w.numFailures?Ee.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{V(n,p,w)}catch{}return w})},Et.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(d){return l.core.get({trans:d,key:n}).then(function(p){var _=p??{};return il(_,s),c&&V(_,c,n),l.core.mutate({trans:d,type:"put",values:[_],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(w){return w.numFailures?Ee.reject(w.failures[0]):!!p})})})},Et.prototype.update=function(n,s){return typeof n!="object"||f(n)?this.where(":id").equals(n).modify(s):(n=X(n,this.schema.primKey.keyPath))===void 0?ke(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},Et.prototype.put=function(n,s){var l=this,c=this.schema.primKey,d=c.auto,p=c.keyPath,_=n;return p&&d&&(_=Xt(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"put",values:[_],keys:s!=null?[s]:null})}).then(function(w){return w.numFailures?Ee.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{V(n,p,w)}catch{}return w})},Et.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Cs(s,[n],c)}).then(function(c){return c.numFailures?Ee.reject(c.failures[0]):void 0})})},Et.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Zr}).then(function(l){return Cs(n,null,l)})}).then(function(s){return s.numFailures?Ee.reject(s.failures[0]):void 0})},Et.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(d){return s.hook.reading.fire(d)})})})},Et.prototype.bulkAdd=function(n,s,l){var c=this,d=Array.isArray(s)?s:void 0,p=(l=l||(d?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(_){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&d)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var R=n.length,K=w&&K?n.map(Xt(w)):n;return c.core.mutate({trans:_,type:"add",keys:d,values:K,wantResults:p}).then(function(O){var P=O.numFailures,j=O.failures;if(P===0)return p?O.results:O.lastResult;throw new We("".concat(c.name,".bulkAdd(): ").concat(P," of ").concat(R," operations failed"),j)})})},Et.prototype.bulkPut=function(n,s,l){var c=this,d=Array.isArray(s)?s:void 0,p=(l=l||(d?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(_){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&d)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var R=n.length,K=w&&K?n.map(Xt(w)):n;return c.core.mutate({trans:_,type:"put",keys:d,values:K,wantResults:p}).then(function(O){var P=O.numFailures,j=O.failures;if(P===0)return p?O.results:O.lastResult;throw new We("".concat(c.name,".bulkPut(): ").concat(P," of ").concat(R," operations failed"),j)})})},Et.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(_){return _.key}),d=n.map(function(_){return _.changes}),p=[];return this._trans("readwrite",function(_){return l.getMany({trans:_,keys:c,cache:"clone"}).then(function(w){var R=[],K=[],O=(n.forEach(function(P,j){var N=P.key,D=P.changes,I=w[j];if(I){for(var G=0,Y=Object.keys(D);G<Y.length;G++){var z=Y[G],se=D[z];if(z===s.schema.primKey.keyPath){if(Je(se,N)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else V(I,z,se)}p.push(j),R.push(N),K.push(I)}}),R.length);return l.mutate({trans:_,type:"put",keys:R,values:K,updates:{keys:c,changeSpecs:d}}).then(function(P){var j=P.numFailures,N=P.failures;if(j===0)return O;for(var D=0,I=Object.keys(N);D<I.length;D++){var G,Y=I[D],z=p[Number(Y)];z!=null&&(G=N[Y],delete N[Y],N[z]=G)}throw new We("".concat(s.name,".bulkUpdate(): ").concat(j," of ").concat(O," operations failed"),N)})})})},Et.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(d){return Cs(s,n,d)})}).then(function(c){var d=c.numFailures,p=c.failures;if(d===0)return c.lastResult;throw new We("".concat(s.name,".bulkDelete(): ").concat(d," of ").concat(l," operations failed"),p)})};var ol=Et;function Et(){}function Wa(n){function s(_,w){if(w){for(var R=arguments.length,K=new Array(R-1);--R;)K[R-1]=arguments[R];return l[_].subscribe.apply(null,K),n}if(typeof _=="string")return l[_]}var l={};s.addEventType=p;for(var c=1,d=arguments.length;c<d;++c)p(arguments[c]);return s;function p(_,w,R){var K,O;if(typeof _!="object")return w=w||Ye,O={subscribers:[],fire:R=R||xe,subscribe:function(P){O.subscribers.indexOf(P)===-1&&(O.subscribers.push(P),O.fire=w(O.fire,P))},unsubscribe:function(P){O.subscribers=O.subscribers.filter(function(j){return j!==P}),O.fire=O.subscribers.reduce(w,R)}},l[_]=s[_]=O;u(K=_).forEach(function(P){var j=K[P];if(f(j))p(P,K[P][0],K[P][1]);else{if(j!=="asap")throw new q.InvalidArgument("Invalid event config");var N=p(P,De,function(){for(var D=arguments.length,I=new Array(D);D--;)I[D]=arguments[D];N.subscribers.forEach(function(G){F(function(){G.apply(null,I)})})})}})}}function Va(n,s){return E(s).from({prototype:n}),s}function Ta(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function bi(n,s){n.filter=St(n.filter,s)}function wi(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return St(c(),s())}:s,n.justLimit=l&&!c}function Ps(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new q.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function ll(n,s,l){var c=Ps(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function Is(n,s,l,c){var d,p,_=n.replayFilter?St(n.filter,n.replayFilter()):n.filter;return n.or?(d={},p=function(w,R,K){var O,P;_&&!_(R,K,function(j){return R.stop(j)},function(j){return R.fail(j)})||((P=""+(O=R.primaryKey))=="[object ArrayBuffer]"&&(P=""+new Uint8Array(O)),S(d,P))||(d[P]=!0,s(w,R,K))},Promise.all([n.or._iterate(p,l),cl(ll(n,c,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):cl(ll(n,c,l),St(n.algorithm,_),s,!n.keysOnly&&n.valueMapper)}function cl(n,s,l,c){var d=gt(c?function(p,_,w){return l(c(p),_,w)}:l);return n.then(function(p){if(p)return p.start(function(){var _=function(){return p.continue()};s&&!s(p,function(w){return _=w},function(w){p.stop(w),_=xe},function(w){p.fail(w),_=xe})||d(p.value,p,function(w){return _=w}),_()})})}pt.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ke.bind(null,l.error)):l.table._trans("readonly",n).then(s)},pt.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ke.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},pt.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=St(s.algorithm,n)},pt.prototype._iterate=function(n,s){return Is(this._ctx,n,s,this._ctx.table.core)},pt.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&h(l,n),s._ctx=l,s},pt.prototype.raw=function(){return this._ctx.valueMapper=null,this},pt.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Is(s,n,l,s.table.core)})},pt.prototype.count=function(n){var s=this;return this._read(function(l){var c,d=s._ctx,p=d.table.core;return Ta(d,!0)?p.count({trans:l,query:{index:Ps(d,p.schema),range:d.range}}).then(function(_){return Math.min(_,d.limit)}):(c=0,Is(d,function(){return++c,!1},l,p).then(function(){return c}))}).then(n)},pt.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],d=l.length-1;function p(R,K){return K?p(R[l[K]],K-1):R[c]}var _=this._ctx.dir==="next"?1:-1;function w(R,K){return Je(p(R,d),p(K,d))*_}return this.toArray(function(R){return R.sort(w)}).then(s)},pt.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,d,p,_=s._ctx;return _.dir==="next"&&Ta(_,!0)&&0<_.limit?(c=_.valueMapper,d=Ps(_,_.table.core.schema),_.table.core.query({trans:l,limit:_.limit,values:!0,query:{index:d,range:_.range}}).then(function(w){return w=w.result,c?w.map(c):w})):(p=[],Is(_,function(w){return p.push(w)},l,_.table.core).then(function(){return p}))},n)},pt.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,Ta(s)?wi(s,function(){var l=n;return function(c,d){return l===0||(l===1?--l:d(function(){c.advance(l),l=0}),!1)}}):wi(s,function(){var l=n;return function(){return--l<0}})),this},pt.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),wi(this._ctx,function(){var s=n;return function(l,c,d){return--s<=0&&c(d),0<=s}},!0),this},pt.prototype.until=function(n,s){return bi(this._ctx,function(l,c,d){return!n(l.value)||(c(d),s)}),this},pt.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},pt.prototype.last=function(n){return this.reverse().first(n)},pt.prototype.filter=function(n){var s;return bi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=St(s.isMatch,n),this},pt.prototype.and=function(n){return this.filter(n)},pt.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},pt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},pt.prototype.desc=function(){return this.reverse()},pt.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},pt.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},pt.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},pt.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,d){l.push(d.key)}).then(function(){return l}).then(n)},pt.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&Ta(s,!0)&&0<s.limit)return this._read(function(c){var d=Ps(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:d,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,d){l.push(d.primaryKey)}).then(function(){return l}).then(n)},pt.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},pt.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},pt.prototype.lastKey=function(n){return this.reverse().firstKey(n)},pt.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},bi(this._ctx,function(c){var c=c.primaryKey.toString(),d=S(n,c);return n[c]=!0,!d})),this},pt.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function d(I,G){var Y=G.failures;j+=I-G.numFailures;for(var z=0,se=u(Y);z<se.length;z++){var he=se[z];P.push(Y[he])}}var p=typeof n=="function"?n:function(I){return il(I,n)},_=l.table.core,O=_.schema.primaryKey,w=O.outbound,R=O.extractKey,K=200,O=s.db._options.modifyChunkSize,P=(O&&(K=typeof O=="object"?O[_.name]||O["*"]||200:O),[]),j=0,N=[],D=n===ul;return s.clone().primaryKeys().then(function(I){function G(z){var se=Math.min(K,I.length-z),he=I.slice(z,z+se);return(D?Promise.resolve([]):_.getMany({trans:c,keys:he,cache:"immutable"})).then(function(Se){var Te=[],ge=[],Me=w?[]:null,Ie=D?he:[];if(!D)for(var we=0;we<se;++we){var Le=Se[we],ut={value:oe(Le),primKey:I[z+we]};p.call(ut,ut.value,ut)!==!1&&(ut.value==null?Ie.push(I[z+we]):w||Je(R(Le),R(ut.value))===0?(ge.push(ut.value),w&&Me.push(I[z+we])):(Ie.push(I[z+we]),Te.push(ut.value)))}return Promise.resolve(0<Te.length&&_.mutate({trans:c,type:"add",values:Te}).then(function(ht){for(var Ke in ht.failures)Ie.splice(parseInt(Ke),1);d(Te.length,ht)})).then(function(){return(0<ge.length||Y&&typeof n=="object")&&_.mutate({trans:c,type:"put",keys:Me,values:ge,criteria:Y,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<z}).then(function(ht){return d(ge.length,ht)})}).then(function(){return(0<Ie.length||Y&&D)&&_.mutate({trans:c,type:"delete",keys:Ie,criteria:Y,isAdditionalChunk:0<z}).then(function(ht){return Cs(l.table,Ie,ht)}).then(function(ht){return d(Ie.length,ht)})}).then(function(){return I.length>z+se&&G(z+K)})})}var Y=Ta(l)&&l.limit===1/0&&(typeof n!="function"||D)&&{index:l.index,range:l.range};return G(0).then(function(){if(0<P.length)throw new Be("Error modifying one or more objects",P,j,N);return I.length})})})},pt.prototype.delete=function(){var n=this._ctx,s=n.range;return!Ta(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(ul):this._write(function(l){var c=n.table.core.schema.primaryKey,d=s;return n.table.core.count({trans:l,query:{index:c,range:d}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:d}).then(function(R){var w=R.failures,R=R.numFailures;if(R)throw new Be("Could not delete some values",Object.keys(w).map(function(K){return w[K]}),p-R);return p-R})})})};var af=pt;function pt(){}var ul=function(n,s){return s.value=null};function sf(n,s){return n<s?-1:n===s?0:1}function of(n,s){return s<n?-1:n===s?0:1}function Rn(n,s,l){return n=n instanceof dl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function Ea(n){return new n.Collection(n,function(){return fl("")}).limit(0)}function Rs(N,s,l,c){var d,p,_,w,R,K,O,P=l.length;if(!l.every(function(I){return typeof I=="string"}))return Rn(N,vt);function j(I){d=I==="next"?function(Y){return Y.toUpperCase()}:function(Y){return Y.toLowerCase()},p=I==="next"?function(Y){return Y.toLowerCase()}:function(Y){return Y.toUpperCase()},_=I==="next"?sf:of;var G=l.map(function(Y){return{lower:p(Y),upper:d(Y)}}).sort(function(Y,z){return _(Y.lower,z.lower)});w=G.map(function(Y){return Y.upper}),R=G.map(function(Y){return Y.lower}),O=(K=I)==="next"?"":c}j("next");var N=new N.Collection(N,function(){return jr(w[0],R[P-1]+c)}),D=(N._ondirectionchange=function(I){j(I)},0);return N._addAlgorithm(function(I,G,Y){var z=I.key;if(typeof z=="string"){var se=p(z);if(s(se,R,D))return!0;for(var he=null,Se=D;Se<P;++Se){var Te=((ge,Me,Ie,we,Le,ut)=>{for(var ht=Math.min(ge.length,we.length),Ke=-1,$e=0;$e<ht;++$e){var Dt=Me[$e];if(Dt!==we[$e])return Le(ge[$e],Ie[$e])<0?ge.substr(0,$e)+Ie[$e]+Ie.substr($e+1):Le(ge[$e],we[$e])<0?ge.substr(0,$e)+we[$e]+Ie.substr($e+1):0<=Ke?ge.substr(0,Ke)+Me[Ke]+Ie.substr(Ke+1):null;Le(ge[$e],Dt)<0&&(Ke=$e)}return ht<we.length&&ut==="next"?ge+Ie.substr(ge.length):ht<ge.length&&ut==="prev"?ge.substr(0,Ie.length):Ke<0?null:ge.substr(0,Ke)+we[Ke]+Ie.substr(Ke+1)})(z,se,w[Se],R[Se],_,K);Te===null&&he===null?D=Se+1:(he===null||0<_(he,Te))&&(he=Te)}G(he!==null?function(){I.continue(he+O)}:Y)}return!1}),N}function jr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function fl(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Wt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Wt.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?Ea(this):new this.Collection(this,function(){return jr(n,s,!l,!c)})}catch{return Rn(this,He)}},Wt.prototype.equals=function(n){return n==null?Rn(this,He):new this.Collection(this,function(){return fl(n)})},Wt.prototype.above=function(n){return n==null?Rn(this,He):new this.Collection(this,function(){return jr(n,void 0,!0)})},Wt.prototype.aboveOrEqual=function(n){return n==null?Rn(this,He):new this.Collection(this,function(){return jr(n,void 0,!1)})},Wt.prototype.below=function(n){return n==null?Rn(this,He):new this.Collection(this,function(){return jr(void 0,n,!1,!0)})},Wt.prototype.belowOrEqual=function(n){return n==null?Rn(this,He):new this.Collection(this,function(){return jr(void 0,n)})},Wt.prototype.startsWith=function(n){return typeof n!="string"?Rn(this,vt):this.between(n,n+Fe,!0,!0)},Wt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Rs(this,function(s,l){return s.indexOf(l[0])===0},[n],Fe)},Wt.prototype.equalsIgnoreCase=function(n){return Rs(this,function(s,l){return s===l[0]},[n],"")},Wt.prototype.anyOfIgnoreCase=function(){var n=me.apply(fe,arguments);return n.length===0?Ea(this):Rs(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Wt.prototype.startsWithAnyOfIgnoreCase=function(){var n=me.apply(fe,arguments);return n.length===0?Ea(this):Rs(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,Fe)},Wt.prototype.anyOf=function(){var n,s,l=this,c=me.apply(fe,arguments),d=this._cmp;try{c.sort(d)}catch{return Rn(this,He)}return c.length===0?Ea(this):((n=new this.Collection(this,function(){return jr(c[0],c[c.length-1])}))._ondirectionchange=function(p){d=p==="next"?l._ascending:l._descending,c.sort(d)},s=0,n._addAlgorithm(function(p,_,w){for(var R=p.key;0<d(R,c[s]);)if(++s===c.length)return _(w),!1;return d(R,c[s])===0||(_(function(){p.continue(c[s])}),!1)}),n)},Wt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Wt.prototype.noneOf=function(){var n=me.apply(fe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Rn(this,He)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Wt.prototype.inAnyRange=function(n,Y){var l=this,c=this._cmp,d=this._ascending,p=this._descending,_=this._min,w=this._max;if(n.length===0)return Ea(this);if(!n.every(function(z){return z[0]!==void 0&&z[1]!==void 0&&d(z[0],z[1])<=0}))return Rn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var R=!Y||Y.includeLowers!==!1,K=Y&&Y.includeUppers===!0,O,P=d;function j(z,se){return P(z[0],se[0])}try{(O=n.reduce(function(z,se){for(var he=0,Se=z.length;he<Se;++he){var Te=z[he];if(c(se[0],Te[1])<0&&0<c(se[1],Te[0])){Te[0]=_(Te[0],se[0]),Te[1]=w(Te[1],se[1]);break}}return he===Se&&z.push(se),z},[])).sort(j)}catch{return Rn(this,He)}var N=0,D=K?function(z){return 0<d(z,O[N][1])}:function(z){return 0<=d(z,O[N][1])},I=R?function(z){return 0<p(z,O[N][0])}:function(z){return 0<=p(z,O[N][0])},G=D,Y=new this.Collection(this,function(){return jr(O[0][0],O[O.length-1][1],!R,!K)});return Y._ondirectionchange=function(z){P=z==="next"?(G=D,d):(G=I,p),O.sort(j)},Y._addAlgorithm(function(z,se,he){for(var Se,Te=z.key;G(Te);)if(++N===O.length)return se(he),!1;return!D(Se=Te)&&!I(Se)||(l._cmp(Te,O[N][1])===0||l._cmp(Te,O[N][0])===0||se(function(){P===d?z.continue(O[N][0]):z.continue(O[N][1])}),!1)}),Y},Wt.prototype.startsWithAnyOf=function(){var n=me.apply(fe,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?Ea(this):this.inAnyRange(n.map(function(s){return[s,s+Fe]})):Rn(this,"startsWithAnyOf() only works with strings")};var dl=Wt;function Wt(){}function cr(n){return gt(function(s){return Ya(s),n(s.target.error),!1})}function Ya(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Xa="storagemutated",ki="x-storagemutated-1",Mr=Wa(null,Xa),lf=(ur.prototype._lock=function(){return U(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},ur.prototype._unlock=function(){if(U(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Ne(n[1],n[0])}catch{}}return this},ur.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},ur.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(U(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new q.DatabaseClosed(c);case"MissingAPIError":throw new q.MissingAPI(c.message,c);default:throw new q.OpenFailed(c)}if(!this.active)throw new q.TransactionInactive;U(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=gt(function(d){Ya(d),s._reject(n.error)}),n.onabort=gt(function(d){Ya(d),s.active&&s._reject(new q.Abort(n.error)),s.active=!1,s.on("abort").fire(d)}),n.oncomplete=gt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Mr.storagemutated.fire(n.mutatedParts)})}return this},ur.prototype._promise=function(n,s,l){var c,d=this;return n==="readwrite"&&this.mode!=="readwrite"?ke(new q.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ee(function(p,_){d._blockedFuncs.push([function(){d._promise(n,s,l).then(p,_)},je])}):l?Cn(function(){var p=new Ee(function(_,w){d._lock();var R=s(_,w,d);R&&R.then&&R.then(_,w)});return p.finally(function(){return d._unlock()}),p._lib=!0,p}):((c=new Ee(function(p,_){var w=s(p,_,d);w&&w.then&&w.then(p,_)}))._lib=!0,c):ke(new q.TransactionInactive)},ur.prototype._root=function(){return this.parent?this.parent._root():this},ur.prototype.waitFor=function(n){var s,l=this._root(),c=Ee.resolve(n),d=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ee(function(p,_){c.then(function(w){return l._waitingQueue.push(gt(p.bind(null,w)))},function(w){return l._waitingQueue.push(gt(_.bind(null,w)))}).finally(function(){l._waitingFor===d&&(l._waitingFor=null)})})},ur.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},ur.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(S(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new q.NotFound("Table "+n+" not part of transaction")},ur);function ur(){}function xi(n,s,l,c,d,p,_,w){return{name:n,keyPath:s,unique:l,multi:c,auto:d,compound:p,src:(l&&!_?"&":"")+(c?"*":"")+(d?"++":"")+vl(s),type:w}}function vl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Si(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(d){return[d.name,d]},l.reduce(function(d,p,_){return p=c(p,_),p&&(d[p[0]]=p[1]),d},{}))};var c}var Qa=function(n){try{return n.only([[]]),Qa=function(){return[[]]},[[]]}catch{return Qa=function(){return Fe},Fe}};function Ti(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return X(l,s)}:function(l){return X(l,n)};var s}function pl(n){return[].slice.call(n)}var cf=0;function Za(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function uf(n,s,R){function c(D){if(D.type===3)return null;if(D.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var P=D.lower,j=D.upper,N=D.lowerOpen,D=D.upperOpen;return P===void 0?j===void 0?null:s.upperBound(j,!!D):j===void 0?s.lowerBound(P,!!N):s.bound(P,j,!!N,!!D)}function d(O){var P,j=O.name;return{name:j,schema:O,mutate:function(N){var D=N.trans,I=N.type,G=N.keys,Y=N.values,z=N.range;return new Promise(function(se,he){se=gt(se);var Se=D.objectStore(j),Te=Se.keyPath==null,ge=I==="put"||I==="add";if(!ge&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var Me,Ie=(G||Y||{length:1}).length;if(G&&Y&&G.length!==Y.length)throw new Error("Given keys array must have same length as given values array.");if(Ie===0)return se({numFailures:0,failures:{},results:[],lastResult:void 0});function we(Mt){++ht,Ya(Mt)}var Le=[],ut=[],ht=0;if(I==="deleteRange"){if(z.type===4)return se({numFailures:ht,failures:ut,results:[],lastResult:void 0});z.type===3?Le.push(Me=Se.clear()):Le.push(Me=Se.delete(c(z)))}else{var Te=ge?Te?[Y,G]:[Y,null]:[G,null],Ke=Te[0],$e=Te[1];if(ge)for(var Dt=0;Dt<Ie;++Dt)Le.push(Me=$e&&$e[Dt]!==void 0?Se[I](Ke[Dt],$e[Dt]):Se[I](Ke[Dt])),Me.onerror=we;else for(Dt=0;Dt<Ie;++Dt)Le.push(Me=Se[I](Ke[Dt])),Me.onerror=we}function qn(Mt){Mt=Mt.target.result,Le.forEach(function(ea,Ui){return ea.error!=null&&(ut[Ui]=ea.error)}),se({numFailures:ht,failures:ut,results:I==="delete"?G:Le.map(function(ea){return ea.result}),lastResult:Mt})}Me.onerror=function(Mt){we(Mt),qn(Mt)},Me.onsuccess=qn})},getMany:function(N){var D=N.trans,I=N.keys;return new Promise(function(G,Y){G=gt(G);for(var z,se=D.objectStore(j),he=I.length,Se=new Array(he),Te=0,ge=0,Me=function(Le){Le=Le.target,Se[Le._pos]=Le.result,++ge===Te&&G(Se)},Ie=cr(Y),we=0;we<he;++we)I[we]!=null&&((z=se.get(I[we]))._pos=we,z.onsuccess=Me,z.onerror=Ie,++Te);Te===0&&G(Se)})},get:function(N){var D=N.trans,I=N.key;return new Promise(function(G,Y){G=gt(G);var z=D.objectStore(j).get(I);z.onsuccess=function(se){return G(se.target.result)},z.onerror=cr(Y)})},query:(P=w,function(N){return new Promise(function(D,I){D=gt(D);var G,Y,z,ge=N.trans,se=N.values,he=N.limit,Te=N.query,Se=he===1/0?void 0:he,Me=Te.index,Te=Te.range,ge=ge.objectStore(j),ge=Me.isPrimaryKey?ge:ge.index(Me.name),Me=c(Te);if(he===0)return D({result:[]});P?((Te=se?ge.getAll(Me,Se):ge.getAllKeys(Me,Se)).onsuccess=function(Ie){return D({result:Ie.target.result})},Te.onerror=cr(I)):(G=0,Y=!se&&"openKeyCursor"in ge?ge.openKeyCursor(Me):ge.openCursor(Me),z=[],Y.onsuccess=function(Ie){var we=Y.result;return!we||(z.push(se?we.value:we.primaryKey),++G===he)?D({result:z}):void we.continue()},Y.onerror=cr(I))})}),openCursor:function(N){var D=N.trans,I=N.values,G=N.query,Y=N.reverse,z=N.unique;return new Promise(function(se,he){se=gt(se);var ge=G.index,Se=G.range,Te=D.objectStore(j),Te=ge.isPrimaryKey?Te:Te.index(ge.name),ge=Y?z?"prevunique":"prev":z?"nextunique":"next",Me=!I&&"openKeyCursor"in Te?Te.openKeyCursor(c(Se),ge):Te.openCursor(c(Se),ge);Me.onerror=cr(he),Me.onsuccess=gt(function(Ie){var we,Le,ut,ht,Ke=Me.result;Ke?(Ke.___id=++cf,Ke.done=!1,we=Ke.continue.bind(Ke),Le=(Le=Ke.continuePrimaryKey)&&Le.bind(Ke),ut=Ke.advance.bind(Ke),ht=function(){throw new Error("Cursor not stopped")},Ke.trans=D,Ke.stop=Ke.continue=Ke.continuePrimaryKey=Ke.advance=function(){throw new Error("Cursor not started")},Ke.fail=gt(he),Ke.next=function(){var $e=this,Dt=1;return this.start(function(){return Dt--?$e.continue():$e.stop()}).then(function(){return $e})},Ke.start=function($e){function Dt(){if(Me.result)try{$e()}catch(Mt){Ke.fail(Mt)}else Ke.done=!0,Ke.start=function(){throw new Error("Cursor behind last entry")},Ke.stop()}var qn=new Promise(function(Mt,ea){Mt=gt(Mt),Me.onerror=cr(ea),Ke.fail=ea,Ke.stop=function(Ui){Ke.stop=Ke.continue=Ke.continuePrimaryKey=Ke.advance=ht,Mt(Ui)}});return Me.onsuccess=gt(function(Mt){Me.onsuccess=Dt,Dt()}),Ke.continue=we,Ke.continuePrimaryKey=Le,Ke.advance=ut,Dt(),qn},se(Ke)):se(null)},he)})},count:function(N){var D=N.query,I=N.trans,G=D.index,Y=D.range;return new Promise(function(z,se){var he=I.objectStore(j),he=G.isPrimaryKey?he:he.index(G.name),Se=c(Y),Se=Se?he.count(Se):he.count();Se.onsuccess=gt(function(Te){return z(Te.target.result)}),Se.onerror=cr(se)})}}}p=R,_=pl((R=n).objectStoreNames);var p,R={schema:{name:R.name,tables:_.map(function(O){return p.objectStore(O)}).map(function(O){var P=O.keyPath,j=O.autoIncrement,D=f(P),N={},D={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:P==null,compound:D,keyPath:P,autoIncrement:j,unique:!0,extractKey:Ti(P)},indexes:pl(O.indexNames).map(function(I){return O.index(I)}).map(function(z){var se=z.name,G=z.unique,Y=z.multiEntry,z=z.keyPath,se={name:se,compound:f(z),keyPath:z,unique:G,multiEntry:Y,extractKey:Ti(z)};return N[Za(z)]=se}),getIndexByKeyPath:function(I){return N[Za(I)]}};return N[":id"]=D.primaryKey,P!=null&&(N[Za(P)]=D.primaryKey),D})},hasGetAll:0<_.length&&"getAll"in p.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},_=R.schema,w=R.hasGetAll,R=_.tables.map(d),K={};return R.forEach(function(O){return K[O.name]=O}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(O){if(K[O])return K[O];throw new Error("Table '".concat(O,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Qa(s),schema:_}}function ff(n,s,l,c){return l=l.IDBKeyRange,s=uf(s,l,c),{dbcore:n.dbcore.reduce(function(d,p){return p=p.create,a(a({},d),p(d))},s)}}function Os(n,s){var l=s.db,l=ff(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var d=c.name;n.core.schema.tables.some(function(p){return p.name===d})&&(c.core=n.core.table(d),n[d]instanceof n.Table)&&(n[d].core=c.core)})}function Ds(n,s,l,c){l.forEach(function(d){var p=c[d];s.forEach(function(_){var w=(function R(K,O){return T(K,O)||(K=v(K))&&R(K,O)})(_,d);(!w||"value"in w&&w.value===void 0)&&(_===n.Transaction.prototype||_ instanceof n.Transaction?A(_,d,{get:function(){return this.table(d)},set:function(R){k(this,d,{value:R,writable:!0,configurable:!0,enumerable:!0})}}):_[d]=new n.Table(d,p))})})}function Ei(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function df(n,s){return n._cfg.version-s._cfg.version}function vf(n,s,l,c){var d=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!d.$meta&&(d.$meta=Si("$meta",ml("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,d)),_=(p.create(l),p._completion.catch(c),p._reject.bind(p)),w=je.transless||je;Cn(function(){if(je.trans=p,je.transless=w,s!==0)return Os(n,l),K=s,((R=p).storeNames.includes("$meta")?R.table("$meta").get("version").then(function(O){return O??K}):Ee.resolve(K)).then(function(G){var P=n,j=G,N=p,D=l,I=[],G=P._versions,Y=P._dbSchema=Ms(0,P.idbdb,D);return(G=G.filter(function(z){return z._cfg.version>=j})).length===0?Ee.resolve():(G.forEach(function(z){I.push(function(){var se,he,Se,Te=Y,ge=z._cfg.dbschema,Me=(Ls(P,Te,D),Ls(P,ge,D),Y=P._dbSchema=ge,Ai(Te,ge)),Ie=(Me.add.forEach(function(we){Ci(D,we[0],we[1].primKey,we[1].indexes)}),Me.change.forEach(function(we){if(we.recreate)throw new q.Upgrade("Not yet support for changing primary key");var Le=D.objectStore(we.name);we.add.forEach(function(ut){return js(Le,ut)}),we.change.forEach(function(ut){Le.deleteIndex(ut.name),js(Le,ut)}),we.del.forEach(function(ut){return Le.deleteIndex(ut)})}),z._cfg.contentUpgrade);if(Ie&&z._cfg.version>j)return Os(P,D),N._memoizedTables={},se=ve(ge),Me.del.forEach(function(we){se[we]=Te[we]}),Ei(P,[P.Transaction.prototype]),Ds(P,[P.Transaction.prototype],u(se),se),N.schema=se,(he=be(Ie))&&Ht(),ge=Ee.follow(function(){var we;(Se=Ie(N))&&he&&(we=Pn.bind(null,null),Se.then(we,we))}),Se&&typeof Se.then=="function"?Ee.resolve(Se):ge.then(function(){return Se})}),I.push(function(se){var he,Se,Te=z._cfg.dbschema;he=Te,Se=se,[].slice.call(Se.db.objectStoreNames).forEach(function(ge){return he[ge]==null&&Se.db.deleteObjectStore(ge)}),Ei(P,[P.Transaction.prototype]),Ds(P,[P.Transaction.prototype],P._storeNames,P._dbSchema),N.schema=P._dbSchema}),I.push(function(se){P.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(P.idbdb.version/10)===z._cfg.version?(P.idbdb.deleteObjectStore("$meta"),delete P._dbSchema.$meta,P._storeNames=P._storeNames.filter(function(he){return he!=="$meta"})):se.objectStore("$meta").put(z._cfg.version,"version"))})}),(function z(){return I.length?Ee.resolve(I.shift()(N.idbtrans)).then(z):Ee.resolve()})().then(function(){hl(Y,D)}))}).catch(_);var R,K;u(d).forEach(function(O){Ci(l,O,d[O].primKey,d[O].indexes)}),Os(n,l),Ee.follow(function(){return n.on.populate.fire(p)}).catch(_)})}function pf(n,s){hl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Ms(0,n.idbdb,s);Ls(n,n._dbSchema,s);for(var c=0,d=Ai(l,n._dbSchema).change;c<d.length;c++){var p=(_=>{if(_.change.length||_.recreate)return console.warn("Unable to patch indexes of table ".concat(_.name," because it has changes on the type of index or primary key.")),{value:void 0};var w=s.objectStore(_.name);_.add.forEach(function(R){ct&&console.debug("Dexie upgrade patch: Creating missing index ".concat(_.name,".").concat(R.src)),js(w,R)})})(d[c]);if(typeof p=="object")return p.value}}function Ai(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var d=n[l],p=s[l];if(d){var _={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(d.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||d.primKey.auto!==p.primKey.auto)_.recreate=!0,c.change.push(_);else{var w=d.idxByName,R=p.idxByName,K=void 0;for(K in w)R[K]||_.del.push(K);for(K in R){var O=w[K],P=R[K];O?O.src!==P.src&&_.change.push(P):_.add.push(P)}(0<_.del.length||0<_.add.length||0<_.change.length)&&c.change.push(_)}}else c.add.push([l,p])}return c}function Ci(n,s,l,c){var d=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(p){return js(d,p)})}function hl(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(ct&&console.debug("Dexie: Creating missing table",l),Ci(s,l,n[l].primKey,n[l].indexes))})}function js(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ms(n,s,l){var c={};return ce(s.objectStoreNames,0).forEach(function(d){for(var p=l.objectStore(d),_=xi(vl(K=p.keyPath),K||"",!0,!1,!!p.autoIncrement,K&&typeof K!="string",!0),w=[],R=0;R<p.indexNames.length;++R){var O=p.index(p.indexNames[R]),K=O.keyPath,O=xi(O.name,K,!!O.unique,!!O.multiEntry,!1,K&&typeof K!="string",!1);w.push(O)}c[d]=Si(d,_,w)}),c}function Ls(n,s,l){for(var c=l.db.objectStoreNames,d=0;d<c.length;++d){var p=c[d],_=l.objectStore(p);n._hasGetAll="getAll"in _;for(var w=0;w<_.indexNames.length;++w){var R,K=_.indexNames[w],O=_.index(K).keyPath,O=typeof O=="string"?O:"["+ce(O).join("+")+"]";s[p]&&(R=s[p].idxByName[O])&&(R.name=K,delete s[p].idxByName[O],s[p].idxByName[K]=R)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ml(n){return n.split(",").map(function(s,l){var d=s.split(":"),c=(c=d[1])==null?void 0:c.trim(),d=(s=d[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(d)?d.match(/^\[(.*)\]$/)[1].split("+"):d;return xi(d,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),f(p),l===0,c)})}Aa.prototype._createTableSchema=Si,Aa.prototype._parseIndexSyntax=ml,Aa.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var d=l._parseIndexSyntax(n[c]),p=d.shift();if(!p)throw new q.Schema("Invalid schema for table "+c+": "+n[c]);if(p.unique=!0,p.multi)throw new q.Schema("Primary key cannot be multiEntry*");d.forEach(function(_){if(_.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!_.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(c,p,d),s[c]=p}})},Aa.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,l):l,s._versions),c={},d={};return l.forEach(function(p){h(c,p._cfg.storesSource),d=p._cfg.dbschema={},p._parseStoresSpec(c,d)}),s._dbSchema=d,Ei(s,[s._allTables,s,s.Transaction.prototype]),Ds(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(d),d),s._storeNames=u(d),this},Aa.prototype.upgrade=function(n){return this._cfg.contentUpgrade=lt(this._cfg.contentUpgrade||xe,n),this};var hf=Aa;function Aa(){}function Pi(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new br(sn,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ii(n){return n&&typeof n.databases=="function"}function Ri(n){return Cn(function(){return je.letThrough=!0,n()})}function Oi(n){return!("from"in n)}var on=function(n,s){var l;if(!this)return l=new on,n&&"d"in n&&h(l,n),l;h(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ja(n,s,l){var c=Je(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Oi(n))return h(n,{from:s,to:l,d:1});var c=n.l,d=n.r;if(Je(l,n.from)<0)return c?Ja(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},_l(n);if(0<Je(s,n.to))return d?Ja(d,s,l):n.r={from:s,to:l,d:1,l:null,r:null},_l(n);Je(s,n.from)<0&&(n.from=s,n.l=null,n.d=d?d.d+1:1),0<Je(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&$a(n,c),d&&s&&$a(n,d)}}function $a(n,s){Oi(s)||(function l(c,d){var p=d.from,_=d.l,w=d.r;Ja(c,p,d.to),_&&l(c,_),w&&l(c,w)})(n,s)}function gl(n,s){var l=Ns(s),c=l.next();if(!c.done)for(var d=c.value,p=Ns(n),_=p.next(d.from),w=_.value;!c.done&&!_.done;){if(Je(w.from,d.to)<=0&&0<=Je(w.to,d.from))return!0;Je(d.from,w.from)<0?d=(c=l.next(w.from)).value:w=(_=p.next(d.from)).value}return!1}function Ns(n){var s=Oi(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&Je(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||Je(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function _l(n){var s,l,c,d=(((d=n.r)==null?void 0:d.d)||0)-(((d=n.l)==null?void 0:d.d)||0),d=1<d?"r":d<-1?"l":"";d&&(s=d=="r"?"l":"r",l=a({},n),c=n[d],n.from=c.from,n.to=c.to,n[d]=c[d],l[d]=c[s],(n[s]=l).d=yl(l)),n.d=yl(n)}function yl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function qs(n,s){return u(s).forEach(function(l){n[l]?$a(n[l],s[l]):n[l]=(function c(d){var p,_,w={};for(p in d)S(d,p)&&(_=d[p],w[p]=!_||typeof _!="object"||ie.has(_.constructor)?_:c(_));return w})(s[l])}),n}function Di(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&gl(s[l],n[l])})}x(on.prototype,((mt={add:function(n){return $a(this,n),this},addKey:function(n){return Ja(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ja(s,l,l)}),this},hasKey:function(n){var s=Ns(this).next(n).value;return s&&Je(s.from,n)<=0&&0<=Je(s.to,n)}})[de]=function(){return Ns(this)},mt));var Jr={},ji={},Mi=!1;function Bs(n){qs(ji,n),Mi||(Mi=!0,setTimeout(function(){Mi=!1,Li(ji,!(ji={}))},0))}function Li(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,d=Object.values(Jr);c<d.length;c++)bl(w=d[c],n,l,s);else for(var p in n){var _,w,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(_=p[1],p=p[2],w=Jr["idb://".concat(_,"/").concat(p)])&&bl(w,n,l,s)}l.forEach(function(R){return R()})}function bl(n,s,l,c){for(var d=[],p=0,_=Object.entries(n.queries.query);p<_.length;p++){for(var w=_[p],R=w[0],K=[],O=0,P=w[1];O<P.length;O++){var j=P[O];Di(s,j.obsSet)?j.subscribers.forEach(function(G){return l.add(G)}):c&&K.push(j)}c&&d.push([R,K])}if(c)for(var N=0,D=d;N<D.length;N++){var I=D[N],R=I[0],K=I[1];n.queries.query[R]=K}}function mf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ke(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,d=Math.round(10*n.verno),p=!1;function _(){if(s.openCanceller!==c)throw new q.DatabaseClosed("db.open() was cancelled")}function w(){return new Ee(function(j,N){if(_(),!l)throw new q.MissingAPI;var D=n.name,I=s.autoSchema||!d?l.open(D):l.open(D,d);if(!I)throw new q.MissingAPI;I.onerror=cr(N),I.onblocked=gt(n._fireOnBlocked),I.onupgradeneeded=gt(function(G){var Y;O=I.transaction,s.autoSchema&&!n._options.allowEmptyDB?(I.onerror=Ya,O.abort(),I.result.close(),(Y=l.deleteDatabase(D)).onsuccess=Y.onerror=gt(function(){N(new q.NoSuchDatabase("Database ".concat(D," doesnt exist")))})):(O.onerror=cr(N),Y=G.oldVersion>Math.pow(2,62)?0:G.oldVersion,P=Y<1,n.idbdb=I.result,p&&pf(n,O),vf(n,Y/10,O,N))},N),I.onsuccess=gt(function(){O=null;var G,Y,z,se,he,Se,Te=n.idbdb=I.result,ge=ce(Te.objectStoreNames);if(0<ge.length)try{var Me=Te.transaction((he=ge).length===1?he[0]:he,"readonly");if(s.autoSchema)Se=Te,se=Me,(z=n).verno=Se.version/10,se=z._dbSchema=Ms(0,Se,se),z._storeNames=ce(Se.objectStoreNames,0),Ds(z,[z._allTables],u(se),se);else if(Ls(n,n._dbSchema,Me),Y=Me,((Y=Ai(Ms(0,(G=n).idbdb,Y),G._dbSchema)).add.length||Y.change.some(function(Ie){return Ie.add.length||Ie.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Te.close(),d=Te.version+1,p=!0,j(w());Os(n,Me)}catch{}xt.push(n),Te.onversionchange=gt(function(Ie){s.vcFired=!0,n.on("versionchange").fire(Ie)}),Te.onclose=gt(function(){n.close({disableAutoOpen:!1})}),P&&(ge=n._deps,he=D,Ii(Se=ge.indexedDB)||he===sn||Pi(Se,ge.IDBKeyRange).put({name:he}).catch(xe)),j()},N)}).catch(function(j){switch(j==null?void 0:j.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),w();break;case"VersionError":if(0<d)return d=0,w()}return Ee.reject(j)})}var R,K=s.dbReadyResolve,O=null,P=!1;return Ee.race([c,(typeof navigator>"u"?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(j){function N(){return indexedDB.databases().finally(j)}R=setInterval(N,100),N()}).finally(function(){return clearInterval(R)}):Promise.resolve()).then(w)]).then(function(){return _(),s.onReadyBeingFired=[],Ee.resolve(Ri(function(){return n.on.ready.fire(n.vip)})).then(function j(){var N;if(0<s.onReadyBeingFired.length)return N=s.onReadyBeingFired.reduce(lt,xe),s.onReadyBeingFired=[],Ee.resolve(Ri(function(){return N(n.vip)})).then(j)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(j){s.dbOpenError=j;try{O&&O.abort()}catch{}return c===s.openCanceller&&n._close(),ke(j)}).finally(function(){s.openComplete=!0,K()}).then(function(){var j;return P&&(j={},n.tables.forEach(function(N){N.schema.indexes.forEach(function(D){D.name&&(j["idb://".concat(n.name,"/").concat(N.name,"/").concat(D.name)]=new on(-1/0,[[[]]]))}),j["idb://".concat(n.name,"/").concat(N.name,"/")]=j["idb://".concat(n.name,"/").concat(N.name,"/:dels")]=new on(-1/0,[[[]]])}),Mr(Xa).fire(j),Li(j,!0)),n})}function Ni(n){function s(p){return n.next(p)}var l=d(s),c=d(function(p){return n.throw(p)});function d(p){return function(w){var w=p(w),R=w.value;return w.done?R:R&&typeof R.then=="function"?R.then(l,c):f(R)?Promise.all(R).then(l,c):l(R)}}return d(s)()}function zs(n,s,l){for(var c=f(n)?n.slice():[n],d=0;d<l;++d)c.push(s);return c}var gf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,d={},p=[];function _(j,N,D){var z=Za(j),I=d[z]=d[z]||[],G=j==null?0:typeof j=="string"?1:j.length,Y=0<N,z=a(a({},D),{name:Y?"".concat(z,"(virtual-from:").concat(D.name,")"):D.name,lowLevelIndex:D,isVirtual:Y,keyTail:N,keyLength:G,extractKey:Ti(j),unique:!Y&&D.unique});return I.push(z),z.isPrimaryKey||p.push(z),1<G&&_(G===2?j[0]:j.slice(0,G-1),N+1,D),I.sort(function(se,he){return se.keyTail-he.keyTail}),z}var w=_(c.primaryKey.keyPath,0,c.primaryKey);d[":id"]=[w];for(var R=0,K=c.indexes;R<K.length;R++){var O=K[R];_(O.keyPath,0,O)}function P(j){var N,D=j.query.index;return D.isVirtual?a(a({},j),{query:{index:D.lowLevelIndex,range:(N=j.query.range,D=D.keyTail,{type:N.type===1?2:N.type,lower:zs(N.lower,N.lowerOpen?n.MAX_KEY:n.MIN_KEY,D),lowerOpen:!0,upper:zs(N.upper,N.upperOpen?n.MIN_KEY:n.MAX_KEY,D),upperOpen:!0})}}):j}return a(a({},l),{schema:a(a({},c),{primaryKey:w,indexes:p,getIndexByKeyPath:function(j){return(j=d[Za(j)])&&j[0]}}),count:function(j){return l.count(P(j))},query:function(j){return l.query(P(j))},openCursor:function(j){var N=j.query.index,D=N.keyTail,I=N.keyLength;return N.isVirtual?l.openCursor(P(j)).then(function(Y){return Y&&G(Y)}):l.openCursor(j);function G(Y){return Object.create(Y,{continue:{value:function(z){z!=null?Y.continue(zs(z,j.reverse?n.MAX_KEY:n.MIN_KEY,D)):j.unique?Y.continue(Y.key.slice(0,I).concat(j.reverse?n.MIN_KEY:n.MAX_KEY,D)):Y.continue()}},continuePrimaryKey:{value:function(z,se){Y.continuePrimaryKey(zs(z,n.MAX_KEY,D),se)}},primaryKey:{get:function(){return Y.primaryKey}},key:{get:function(){var z=Y.key;return I===1?z[0]:z.slice(0,I)}},value:{get:function(){return Y.value}}})}}})}})}};function qi(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(d){var p,_,w;S(s,d)?(p=n[d],_=s[d],typeof p=="object"&&typeof _=="object"&&p&&_?(w=re(p))!==re(_)?l[c+d]=s[d]:w==="Object"?qi(p,_,l,c+d+"."):p!==_&&(l[c+d]=s[d]):p!==_&&(l[c+d]=s[d])):l[c+d]=void 0}),u(s).forEach(function(d){S(n,d)||(l[c+d]=s[d])}),l}function Bi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var _f={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(d){var p=je.trans,_=p.table(s).hook,w=_.deleting,R=_.creating,K=_.updating;switch(d.type){case"add":if(R.fire===xe)break;return p._promise("readwrite",function(){return O(d)},!0);case"put":if(R.fire===xe&&K.fire===xe)break;return p._promise("readwrite",function(){return O(d)},!0);case"delete":if(w.fire===xe)break;return p._promise("readwrite",function(){return O(d)},!0);case"deleteRange":if(w.fire===xe)break;return p._promise("readwrite",function(){return(function P(j,N,D){return l.query({trans:j,values:!1,query:{index:c,range:N},limit:D}).then(function(I){var G=I.result;return O({type:"delete",keys:G,trans:j}).then(function(Y){return 0<Y.numFailures?Promise.reject(Y.failures[0]):G.length<D?{failures:[],numFailures:0,lastResult:void 0}:P(j,a(a({},N),{lower:G[G.length-1],lowerOpen:!0}),D)})})})(d.trans,d.range,1e4)},!0)}return l.mutate(d);function O(P){var j,N,D,I=je.trans,G=P.keys||Bi(c,P);if(G)return(P=P.type==="add"||P.type==="put"?a(a({},P),{keys:G}):a({},P)).type!=="delete"&&(P.values=i([],P.values)),P.keys&&(P.keys=i([],P.keys)),j=l,D=G,((N=P).type==="add"?Promise.resolve([]):j.getMany({trans:N.trans,keys:D,cache:"immutable"})).then(function(Y){var z=G.map(function(se,he){var Se,Te,ge,Me=Y[he],Ie={onerror:null,onsuccess:null};return P.type==="delete"?w.fire.call(Ie,se,Me,I):P.type==="add"||Me===void 0?(Se=R.fire.call(Ie,se,P.values[he],I),se==null&&Se!=null&&(P.keys[he]=se=Se,c.outbound||V(P.values[he],c.keyPath,se))):(Se=qi(Me,P.values[he]),(Te=K.fire.call(Ie,Se,se,Me,I))&&(ge=P.values[he],Object.keys(Te).forEach(function(we){S(ge,we)?ge[we]=Te[we]:V(ge,we,Te[we])}))),Ie});return l.mutate(P).then(function(se){for(var he=se.failures,Se=se.results,Te=se.numFailures,se=se.lastResult,ge=0;ge<G.length;++ge){var Me=(Se||G)[ge],Ie=z[ge];Me==null?Ie.onerror&&Ie.onerror(he[ge]):Ie.onsuccess&&Ie.onsuccess(P.type==="put"&&Y[ge]?P.values[ge]:Me)}return{failures:he,results:Se,numFailures:Te,lastResult:se}}).catch(function(se){return z.forEach(function(he){return he.onerror&&he.onerror(se)}),Promise.reject(se)})});throw new Error("Keys missing")}}})}})}};function wl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],d=0,p=0;d<s.keys.length&&p<n.length;++d)Je(s.keys[d],n[p])===0&&(c.push(l?oe(s.values[d]):s.values[d]),++p);return c.length===n.length?c:null}catch{return null}}var yf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var d;return c.cache?(d=wl(c.keys,c.trans._cache,c.cache==="clone"))?Ee.resolve(d):l.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?oe(p):p},p}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function kl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function xl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var bf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new on(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,d,p){if(je.subscr&&d!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return n.transaction(c,d,p)},table:function(c){function d(G){var I,G=G.query;return[I=G.index,new on((I=(G=G.range).lower)!=null?I:n.MIN_KEY,(I=G.upper)!=null?I:n.MAX_KEY)]}var p=n.table(c),_=p.schema,w=_.primaryKey,R=_.indexes,K=w.extractKey,O=w.outbound,P=w.autoIncrement&&R.filter(function(D){return D.compound&&D.keyPath.includes(w.keyPath)}),j=a(a({},p),{mutate:function(D){function I(Le){return Le="idb://".concat(s,"/").concat(c,"/").concat(Le),he[Le]||(he[Le]=new on)}var G,Y,z,se=D.trans,he=D.mutatedParts||(D.mutatedParts={}),Se=I(""),Te=I(":dels"),ge=D.type,Ie=D.type==="deleteRange"?[D.range]:D.type==="delete"?[D.keys]:D.values.length<50?[Bi(w,D).filter(function(Le){return Le}),D.values]:[],Me=Ie[0],Ie=Ie[1],we=D.trans._cache;return f(Me)?(Se.addKeys(Me),(ge=ge==="delete"||Me.length===Ie.length?wl(Me,we):null)||Te.addKeys(Me),(ge||Ie)&&(G=I,Y=ge,z=Ie,_.indexes.forEach(function(Le){var ut=G(Le.name||"");function ht($e){return $e!=null?Le.extractKey($e):null}function Ke($e){Le.multiEntry&&f($e)?$e.forEach(function(Dt){return ut.addKey(Dt)}):ut.addKey($e)}(Y||z).forEach(function($e,Mt){var qn=Y&&ht(Y[Mt]),Mt=z&&ht(z[Mt]);Je(qn,Mt)!==0&&(qn!=null&&Ke(qn),Mt!=null)&&Ke(Mt)})}))):Me?(Ie={from:(we=Me.lower)!=null?we:n.MIN_KEY,to:(ge=Me.upper)!=null?ge:n.MAX_KEY},Te.add(Ie),Se.add(Ie)):(Se.add(l),Te.add(l),_.indexes.forEach(function(Le){return I(Le.name).add(l)})),p.mutate(D).then(function(Le){return!Me||D.type!=="add"&&D.type!=="put"||(Se.addKeys(Le.results),P&&P.forEach(function(ut){for(var ht=D.values.map(function(qn){return ut.extractKey(qn)}),Ke=ut.keyPath.findIndex(function(qn){return qn===w.keyPath}),$e=0,Dt=Le.results.length;$e<Dt;++$e)ht[$e][Ke]=Le.results[$e];I(ut.name).addKeys(ht)})),se.mutatedParts=qs(se.mutatedParts||{},he),Le})}}),N={get:function(D){return[w,new on(D.key)]},getMany:function(D){return[w,new on().addKeys(D.keys)]},count:d,query:d,openCursor:d};return u(N).forEach(function(D){j[D]=function(I){var G=je.subscr,Y=!!G,z=kl(je,p)&&xl(D,I)?I.obsSet={}:G;if(Y){var se,G=function(Ie){return Ie="idb://".concat(s,"/").concat(c,"/").concat(Ie),z[Ie]||(z[Ie]=new on)},he=G(""),Se=G(":dels"),Y=N[D](I),Te=Y[0],Y=Y[1];if((D==="query"&&Te.isPrimaryKey&&!I.values?Se:G(Te.name||"")).add(Y),!Te.isPrimaryKey){if(D!=="count")return se=D==="query"&&O&&I.values&&p.query(a(a({},I),{values:!1})),p[D].apply(this,arguments).then(function(Ie){if(D==="query"){if(O&&I.values)return se.then(function(ht){return ht=ht.result,he.addKeys(ht),Ie});var we=I.values?Ie.result.map(K):Ie.result;(I.values?he:Se).addKeys(we)}else{var Le,ut;if(D==="openCursor")return ut=I.values,(Le=Ie)&&Object.create(Le,{key:{get:function(){return Se.addKey(Le.primaryKey),Le.key}},primaryKey:{get:function(){var ht=Le.primaryKey;return Se.addKey(ht),ht}},value:{get:function(){return ut&&he.addKey(Le.primaryKey),Le.value}}})}return Ie});Se.add(l)}}return p[D].apply(this,arguments)}}),j}})}};function Sl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),f(c.keys)&&(c.keys=c.keys.filter(function(d,p){return!(p in l.failures)})),"values"in c&&f(c.values)&&(c.values=c.values.filter(function(d,p){return!(p in l.failures)})),c)}function zi(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<Je(l,c.lower):0<=Je(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?Je(l,c.upper)<0:Je(l,c.upper)<=0));var l,c}function Tl(n,s,l,c,d,p){var _,w,R,K,O,P;return!l||l.length===0||(_=s.query.index,w=_.multiEntry,R=s.query.range,K=c.schema.primaryKey.extractKey,O=_.extractKey,P=(_.lowLevelIndex||_).extractKey,(c=l.reduce(function(j,N){var D=j,I=[];if(N.type==="add"||N.type==="put")for(var G=new on,Y=N.values.length-1;0<=Y;--Y){var z,se=N.values[Y],he=K(se);!G.hasKey(he)&&(z=O(se),w&&f(z)?z.some(function(Ie){return zi(Ie,R)}):zi(z,R))&&(G.addKey(he),I.push(se))}switch(N.type){case"add":var Se=new on().addKeys(s.values?j.map(function(we){return K(we)}):j),D=j.concat(s.values?I.filter(function(we){return we=K(we),!Se.hasKey(we)&&(Se.addKey(we),!0)}):I.map(function(we){return K(we)}).filter(function(we){return!Se.hasKey(we)&&(Se.addKey(we),!0)}));break;case"put":var Te=new on().addKeys(N.values.map(function(we){return K(we)}));D=j.filter(function(we){return!Te.hasKey(s.values?K(we):we)}).concat(s.values?I:I.map(function(we){return K(we)}));break;case"delete":var ge=new on().addKeys(N.keys);D=j.filter(function(we){return!ge.hasKey(s.values?K(we):we)});break;case"deleteRange":var Me=N.range;D=j.filter(function(we){return!zi(K(we),Me)})}return D},n))===n)?n:(c.sort(function(j,N){return Je(P(j),P(N))||Je(K(j),K(N))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(d.dirty=!0)),p?Object.freeze(c):c)}function El(n,s){return Je(n.lower,s.lower)===0&&Je(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function wf(n,s){return((l,c,d,p)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=Je(l,c))===0){if(d&&p)return 0;if(d)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,d,p)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=Je(l,c))===0){if(d&&p)return 0;if(d)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function kf(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var d,p;n.subscribers.delete(l),n.subscribers.size===0&&(d=n,p=s,setTimeout(function(){d.subscribers.size===0&&ee(p,d)},3e3))})}var xf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,d){var p,_,w=n.transaction(l,c,d);return c==="readwrite"&&(d=(p=new AbortController).signal,w.addEventListener("abort",(_=function(R){return function(){if(p.abort(),c==="readwrite"){for(var K=new Set,O=0,P=l;O<P.length;O++){var j=P[O],N=Jr["idb://".concat(s,"/").concat(j)];if(N){var D=n.table(j),I=N.optimisticOps.filter(function(Le){return Le.trans===w});if(w._explicit&&R&&w.mutatedParts)for(var G=0,Y=Object.values(N.queries.query);G<Y.length;G++)for(var z=0,se=(Te=Y[G]).slice();z<se.length;z++)Di((ge=se[z]).obsSet,w.mutatedParts)&&(ee(Te,ge),ge.subscribers.forEach(function(Le){return K.add(Le)}));else if(0<I.length){N.optimisticOps=N.optimisticOps.filter(function(Le){return Le.trans!==w});for(var he=0,Se=Object.values(N.queries.query);he<Se.length;he++)for(var Te,ge,Me,Ie=0,we=(Te=Se[he]).slice();Ie<we.length;Ie++)(ge=we[Ie]).res!=null&&w.mutatedParts&&(R&&!ge.dirty?(Me=Object.isFrozen(ge.res),Me=Tl(ge.res,ge.req,I,D,ge,Me),ge.dirty?(ee(Te,ge),ge.subscribers.forEach(function(Le){return K.add(Le)})):Me!==ge.res&&(ge.res=Me,ge.promise=Ee.resolve({result:Me}))):(ge.dirty&&ee(Te,ge),ge.subscribers.forEach(function(Le){return K.add(Le)})))}}}K.forEach(function(Le){return Le()})}}})(!1),{signal:d}),w.addEventListener("error",_(!1),{signal:d}),w.addEventListener("complete",_(!0),{signal:d})),w},table:function(l){var c=n.table(l),d=c.schema.primaryKey;return a(a({},c),{mutate:function(p){var _,w=je.trans;return!d.outbound&&w.db._options.cache!=="disabled"&&!w.explicit&&w.idbtrans.mode==="readwrite"&&(_=Jr["idb://".concat(s,"/").concat(l)])?(w=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Bi(d,p).some(function(R){return R==null}))?(_.optimisticOps.push(p),p.mutatedParts&&Bs(p.mutatedParts),w.then(function(R){0<R.numFailures&&(ee(_.optimisticOps,p),(R=Sl(0,p,R))&&_.optimisticOps.push(R),p.mutatedParts)&&Bs(p.mutatedParts)}),w.catch(function(){ee(_.optimisticOps,p),p.mutatedParts&&Bs(p.mutatedParts)})):w.then(function(R){var K=Sl(0,a(a({},p),{values:p.values.map(function(O,P){var j;return R.failures[P]?O:(V(j=(j=d.keyPath)!=null&&j.includes(".")?oe(O):a({},O),d.keyPath,R.results[P]),j)})}),R);_.optimisticOps.push(K),queueMicrotask(function(){return p.mutatedParts&&Bs(p.mutatedParts)})}),w):c.mutate(p)},query:function(p){var _,w,R,K,O,P,j;return kl(je,c)&&xl("query",p)?(_=((R=je.trans)==null?void 0:R.db._options.cache)==="immutable",w=(R=je).requery,R=R.signal,P=((N,D,I,G)=>{var Y=Jr["idb://".concat(N,"/").concat(D)];if(!Y)return[];if(!(N=Y.queries[I]))return[null,!1,Y,null];var z=N[(G.query?G.query.index.name:null)||""];if(!z)return[null,!1,Y,null];switch(I){case"query":var se=z.find(function(he){return he.req.limit===G.limit&&he.req.values===G.values&&El(he.req.query.range,G.query.range)});return se?[se,!0,Y,z]:[z.find(function(he){return("limit"in he.req?he.req.limit:1/0)>=G.limit&&(!G.values||he.req.values)&&wf(he.req.query.range,G.query.range)}),!1,Y,z];case"count":return se=z.find(function(he){return El(he.req.query.range,G.query.range)}),[se,!!se,Y,z]}})(s,l,"query",p),j=P[0],K=P[2],O=P[3],j&&P[1]?j.obsSet=p.obsSet:(P=c.query(p).then(function(N){var D=N.result;if(j&&(j.res=D),_){for(var I=0,G=D.length;I<G;++I)Object.freeze(D[I]);Object.freeze(D)}else N.result=oe(D);return N}).catch(function(N){return O&&j&&ee(O,j),Promise.reject(N)}),j={obsSet:p.obsSet,promise:P,subscribers:new Set,type:"query",req:p,dirty:!1},O?O.push(j):(O=[j],(K=K||(Jr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=O)),kf(j,O,w,R),j.promise.then(function(N){return{result:Tl(N.result,p,K==null?void 0:K.optimisticOps,c,j,_)}})):c.query(p)}})}})}};function Fs(n,s){return new Proxy(n,{get:function(l,c,d){return c==="db"?s:Reflect.get(l,c,d)}})}Lt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new q.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(df),l.stores({}),this._state.autoSchema=!1),l},Lt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?n():new Ee(function(l,c){if(s._state.openComplete)return c(new q.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new q.DatabaseClosed);s.open().catch(xe)}s._state.dbReadyPromise.then(l,c)}).then(n)},Lt.prototype.use=function(d){var s=d.stack,l=d.create,c=d.level,d=d.name,p=(d&&this.unuse({stack:s,name:d}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:c??10,name:d}),p.sort(function(_,w){return _.level-w.level}),this},Lt.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(d){return c?d.create!==c:!!l&&d.name!==l})),this},Lt.prototype.open=function(){var n=this;return Ne(It,function(){return mf(n)})},Lt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=xt.indexOf(this);if(0<=s&&xt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ee(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ee(function(l,c){n.cancelOpen=c}))},Lt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new q.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new q.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},Lt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ee(function(d,p){function _(){s.close(n);var w=s._deps.indexedDB.deleteDatabase(s.name);w.onsuccess=gt(function(){var R,K,O;R=s._deps,K=s.name,Ii(O=R.indexedDB)||K===sn||Pi(O,R.IDBKeyRange).delete(K).catch(xe),d()}),w.onerror=cr(p),w.onblocked=s._fireOnBlocked}if(l)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(_):_()})},Lt.prototype.backendDB=function(){return this.idbdb},Lt.prototype.isOpen=function(){return this.idbdb!==null},Lt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Lt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Lt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Lt.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),Lt.prototype.transaction=function(){var n=(function(s,l,c){var d=arguments.length;if(d<2)throw new q.InvalidArgument("Too few arguments");for(var p=new Array(d-1);--d;)p[d-1]=arguments[d];return c=p.pop(),[s,Pe(p),c]}).apply(this,arguments);return this._transaction.apply(this,n)},Lt.prototype._transaction=function(n,s,l){var c,d,p=this,_=je.trans,w=(_&&_.db===this&&n.indexOf("!")===-1||(_=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(d=s.map(function(K){if(K=K instanceof p.Table?K.name:K,typeof K!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return K}),n=="r"||n===In)c=In;else{if(n!="rw"&&n!=lr)throw new q.InvalidArgument("Invalid transaction mode: "+n);c=lr}if(_){if(_.mode===In&&c===lr){if(!w)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");_=null}_&&d.forEach(function(K){if(_&&_.storeNames.indexOf(K)===-1){if(!w)throw new q.SubTransaction("Table "+K+" not included in parent transaction.");_=null}}),w&&_&&!_.active&&(_=null)}}catch(K){return _?_._promise(null,function(O,P){P(K)}):ke(K)}var R=(function K(O,P,j,N,D){return Ee.resolve().then(function(){var z=je.transless||je,I=O._createTransaction(P,j,O._dbSchema,N),z=(I.explicit=!0,{trans:I,transless:z});if(N)I.idbtrans=N.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(se){return se.name===qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return K(O,P,j,null,D)})):ke(se)}var G,Y=be(D),z=(Y&&Ht(),Ee.follow(function(){var se;(G=D.call(I,I))&&(Y?(se=Pn.bind(null,null),G.then(se,se)):typeof G.next=="function"&&typeof G.throw=="function"&&(G=Ni(G)))},z));return(G&&typeof G.then=="function"?Ee.resolve(G).then(function(se){return I.active?se:ke(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):z.then(function(){return G})).then(function(se){return N&&I._resolve(),I._completion.then(function(){return se})}).catch(function(se){return I._reject(se),ke(se)})})}).bind(null,this,c,d,_,l);return _?_._promise(c,R,"lock"):je.trans?Ne(je.transless,function(){return p._whenReady(R)}):this._whenReady(R)},Lt.prototype.table=function(n){if(S(this._allTables,n))return this._allTables[n];throw new q.InvalidTable("Table ".concat(n," does not exist"))};var br=Lt;function Lt(n,s){var l,c,d,p,_,w=this,R=(this._middlewares={},this.verno=0,Lt.dependencies),R=(this._options=s=a({addons:Lt.addons,autoOpen:!0,indexedDB:R.indexedDB,IDBKeyRange:R.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),K=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:xe,dbReadyPromise:null,cancelOpen:xe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),O=(K.dbReadyPromise=new Ee(function(P){K.dbReadyResolve=P}),K.openCanceller=new Ee(function(P,j){K.cancelOpen=j}),this._state=K,this.name=n,this.on=Wa(this,"populate","blocked","versionchange","close",{ready:[lt,xe]}),this.once=function(P,j){var N=function(){for(var D=[],I=0;I<arguments.length;I++)D[I]=arguments[I];w.on(P).unsubscribe(N),j.apply(w,D)};return w.on(P,N)},this.on.ready.subscribe=te(this.on.ready.subscribe,function(P){return function(j,N){Lt.vip(function(){var D,I=w._state;I.openComplete?(I.dbOpenError||Ee.resolve().then(j),N&&P(j)):I.onReadyBeingFired?(I.onReadyBeingFired.push(j),N&&P(j)):(P(j),D=w,N||P(function G(){D.on.ready.unsubscribe(j),D.on.ready.unsubscribe(G)}))})}}),this.Collection=(l=this,Va(af.prototype,function(G,I){this.db=l;var N=Zr,D=null;if(I)try{N=I()}catch(z){D=z}var I=G._ctx,G=I.table,Y=G.hook.reading.fire;this._ctx={table:G,index:I.index,isPrimKey:!I.index||G.schema.primKey.keyPath&&I.index===G.schema.primKey.name,range:N,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:D,or:I.or,valueMapper:Y!==De?Y:null}})),this.Table=(c=this,Va(ol.prototype,function(P,j,N){this.db=c,this._tx=N,this.name=P,this.schema=j,this.hook=c._allTables[P]?c._allTables[P].hook:Wa(null,{creating:[dt,xe],reading:[it,De],updating:[Ve,xe],deleting:[Rt,xe]})})),this.Transaction=(d=this,Va(lf.prototype,function(P,j,N,D,I){var G=this;P!=="readonly"&&j.forEach(function(Y){Y=(Y=N[Y])==null?void 0:Y.yProps,Y&&(j=j.concat(Y.map(function(z){return z.updatesTable})))}),this.db=d,this.mode=P,this.storeNames=j,this.schema=N,this.chromeTransactionDurability=D,this.idbtrans=null,this.on=Wa(this,"complete","error","abort"),this.parent=I||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee(function(Y,z){G._resolve=Y,G._reject=z}),this._completion.then(function(){G.active=!1,G.on.complete.fire()},function(Y){var z=G.active;return G.active=!1,G.on.error.fire(Y),G.parent?G.parent._reject(Y):z&&G.idbtrans&&G.idbtrans.abort(),ke(Y)})})),this.Version=(p=this,Va(hf.prototype,function(P){this.db=p,this._cfg={version:P,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,Va(dl.prototype,function(P,j,N){if(this.db=_,this._ctx={table:P,index:j===":id"?null:j,or:N},this._cmp=this._ascending=Je,this._descending=function(D,I){return Je(I,D)},this._max=function(D,I){return 0<Je(D,I)?D:I},this._min=function(D,I){return Je(D,I)<0?D:I},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})),this.on("versionchange",function(P){0<P.newVersion?console.warn("Another connection wants to upgrade database '".concat(w.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(w.name,"'. Closing db now to resume the delete request.")),w.close({disableAutoOpen:!1})}),this.on("blocked",function(P){!P.newVersion||P.newVersion<P.oldVersion?console.warn("Dexie.delete('".concat(w.name,"') was blocked")):console.warn("Upgrade '".concat(w.name,"' blocked by other connection holding version ").concat(P.oldVersion/10))}),this._maxKey=Qa(s.IDBKeyRange),this._createTransaction=function(P,j,N,D){return new w.Transaction(P,j,N,w._options.chromeTransactionDurability,D)},this._fireOnBlocked=function(P){w.on("blocked").fire(P),xt.filter(function(j){return j.name===w.name&&j!==w&&!j._state.vcFired}).map(function(j){return j.on("versionchange").fire(P)})},this.use(yf),this.use(xf),this.use(bf),this.use(gf),this.use(_f),new Proxy(this,{get:function(P,j,N){var D;return j==="_vip"||(j==="table"?function(I){return Fs(w.table(I),O)}:(D=Reflect.get(P,j,N))instanceof ol?Fs(D,O):j==="tables"?D.map(function(I){return Fs(I,O)}):j==="_createTransaction"?function(){return Fs(D.apply(this,arguments),O)}:D)}}));this.vip=O,R.forEach(function(P){return P(w)})}var Ks,Ca=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Sf=(Fi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Fi.prototype[Ca]=function(){return this},Fi);function Fi(n){this._subscribe=n}try{Ks={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ks={indexedDB:null,IDBKeyRange:null}}function Al(n){var s,l=!1,c=new Sf(function(d){var p=be(n),_,w=!1,R={},K={},O={get closed(){return w},unsubscribe:function(){w||(w=!0,_&&_.abort(),P&&Mr.storagemutated.unsubscribe(N))}},P=(d.start&&d.start(O),!1),j=function(){return _e(D)},N=function(I){qs(R,I),Di(K,R)&&j()},D=function(){var I,G,Y;!w&&Ks.indexedDB&&(R={},I={},_&&_.abort(),_=new AbortController,Y=(z=>{var se=nt();try{p&&Ht();var he=Cn(n,z);return he=p?he.finally(Pn):he}finally{se&&jt()}})(G={subscr:I,signal:_.signal,requery:j,querier:n,trans:null}),Promise.resolve(Y).then(function(z){l=!0,s=z,w||G.signal.aborted||(R={},(se=>{for(var he in se)if(S(se,he))return;return 1})(K=I)||P||(Mr(Xa,N),P=!0),_e(function(){return!w&&d.next&&d.next(z)}))},function(z){l=!1,["DatabaseClosedError","AbortError"].includes(z==null?void 0:z.name)||w||_e(function(){w||d.error&&d.error(z)})}))};return setTimeout(j,0),O});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var $r=br;function Ki(n){var s=Lr;try{Lr=!0,Mr.storagemutated.fire(n),Li(n,!0)}finally{Lr=s}}x($r,a(a({},Z),{delete:function(n){return new $r(n,{addons:[]}).delete()},exists:function(n){return new $r(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=$r.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ii(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(d){return d.name}).filter(function(d){return d!==sn})}):Pi(l,s).toCollection().primaryKeys()).then(n)}catch{return ke(new q.MissingAPI)}var s,l},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return je.trans?Ne(je.transless,n):n()},vip:Ri,async:function(n){return function(){try{var s=Ni(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ee.resolve(s)}catch(l){return ke(l)}}},spawn:function(n,s,l){try{var c=Ni(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ee.resolve(c)}catch(d){return ke(d)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(n,s){return n=Ee.resolve(typeof n=="function"?$r.ignoreTransaction(n):n).timeout(s||6e4),je.trans?je.trans.waitFor(n):n},Promise:Ee,debug:{get:function(){return ct},set:function(n){wt(n)}},derive:E,extend:h,props:x,override:te,Events:Wa,on:Mr,liveQuery:Al,extendObservabilitySet:qs,getByKeyPath:X,setByKeyPath:V,delByKeyPath:function(n,s){typeof s=="string"?V(n,s,void 0):"length"in s&&[].map.call(s,function(l){V(n,l,void 0)})},shallowClone:ve,deepClone:oe,getObjectDiff:qi,cmp:Je,asap:F,minKey:-1/0,addons:[],connections:xt,errnames:qe,dependencies:Ks,cache:Jr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),$r.maxKey=Qa($r.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Mr(Xa,function(n){Lr||(n=new CustomEvent(ki,{detail:n}),Lr=!0,dispatchEvent(n),Lr=!1)}),addEventListener(ki,function(n){n=n.detail,Lr||Ki(n)}));var Pa,Lr=!1,Cl=function(){};return typeof BroadcastChannel<"u"&&((Cl=function(){(Pa=new BroadcastChannel(ki)).onmessage=function(n){return n.data&&Ki(n.data)}})(),typeof Pa.unref=="function"&&Pa.unref(),Mr(Xa,function(n){Lr||Pa.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!br.disableBfCache&&n.persisted){ct&&console.debug("Dexie: handling persisted pagehide"),Pa!=null&&Pa.close();for(var s=0,l=xt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!br.disableBfCache&&n.persisted&&(ct&&console.debug("Dexie: handling persisted pageshow"),Cl(),Ki({all:new on(-1/0,[[]])}))})),Ee.rejectionMapper=function(n,s){return!n||n instanceof Q||n instanceof TypeError||n instanceof SyntaxError||!n.name||!ye[n.name]?n:(s=new ye[n.name](s||n.message,n),"stack"in n&&A(s,"stack",{get:function(){return this.inner.stack}}),s)},wt(ct),a(br,Object.freeze({__proto__:null,Dexie:br,Entity:Dr,PropModification:Ha,RangeSet:on,add:function(n){return new Ha({add:n})},cmp:Je,default:br,liveQuery:Al,mergeRanges:$a,rangesOverlap:gl,remove:function(n){return new Ha({remove:n})},replacePrefix:function(n,s){return new Ha({replacePrefix:[n,s]})}}),{default:br}),br})})(ti)),ti.exports}var uv=cv();const ho=ov(uv),Wl=Symbol.for("Dexie"),cn=globalThis[Wl]||(globalThis[Wl]=ho);if(ho.semVer!==cn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ho.semVer} and ${cn.semVer}`);const{liveQuery:fy,mergeRanges:dy,rangesOverlap:vy,RangeSet:py,cmp:hy,Entity:my,PropModification:gy,replacePrefix:_y,add:yy,remove:by,DexieYProvider:wy}=cn,ze=new cn("me-ai-store");ze.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});ze.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});ze.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});ze.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function bu(t,e){return`${t}:${e}`}function mo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Qi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function fv(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function dv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function wu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const vv="https://gmail.googleapis.com/gmail/v1/users/me";class Uo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function pv(t){return{Authorization:`Bearer ${t}`}}async function gi(t,e){var a,i,o,u;const r=await fetch(`${vv}${e}`,{headers:pv(t)});if(!r.ok){const f=await r.json().catch(()=>({})),h=((a=f.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,v=((u=(o=(i=f.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new Uo(h,r.status,v)}return r.json()}function ku(t){return gi(t,"/profile")}function xu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),gi(t,`/messages?${i}`)}function Su(t,e,r="full"){return gi(t,`/messages/${e}?format=${r}`)}function hv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),gi(t,`/history?${i}`)}function qr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function vs(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function mv(t){var o,u,f;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return vs(e.body.data);const r=e.parts||[],a=ii(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return vs(a.body.data);const i=ii(r,"text/html");if((f=i==null?void 0:i.body)!=null&&f.data){const h=vs(i.body.data);return _v(h)}return"(no body)"}function gv(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return vs(e.body.data);const r=e.parts||[],a=ii(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?vs(a.body.data):null}function ii(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ii(r.parts,e);if(a)return a}}return null}function _v(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Go(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function Tu(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function Eu(t){return Tu(t).charAt(0).toUpperCase()}function yv(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function bv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Au(t,e){return`${yv(t.date)}_${bv(t.subject)}.${e}`}function Cu(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function wv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Pu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function kv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Pu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function xv(t=10){const e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Iu).join(`

---

`)}async function Sv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await ze.items.where("sourceType").equals("gmail").toArray()).map(o=>{var f,h,v,y,S;let u=0;return(f=o.subject)!=null&&f.toLowerCase().includes(r)&&(u+=3),(h=o.from)!=null&&h.toLowerCase().includes(r)&&(u+=2),(v=o.to)!=null&&v.toLowerCase().includes(r)&&(u+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(u+=1),(S=o.body)!=null&&S.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>Iu(o)).join(`

---

`)}async function Vl(){const t=await ze.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=Cu(t);return{groups:e,order:r,total:t.length}}async function Tv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await ze.items.where("sourceType").equals("gmail").filter(f=>{var h,v,y,S;return((h=f.subject)==null?void 0:h.toLowerCase().includes(o))||((v=f.from)==null?void 0:v.toLowerCase().includes(o))||((y=f.to)==null?void 0:y.toLowerCase().includes(o))||((S=f.snippet)==null?void 0:S.toLowerCase().includes(o))}).toArray();return u.sort((f,h)=>(h.date||0)-(f.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await ze.items.where("sourceType").equals("gmail").count();return{items:await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Pu(){const t=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).first(),e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).last();return{oldest:t,newest:e}}function Iu(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=dv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function Ev(){const t=await wv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Av(t){const e=[],r=await kv();if(e.push(r),t){const a=await Sv(t,5);e.push("","## Relevant Emails",a)}else{const a=await xv(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Cv="modulepreload",Pv=function(t,e){return new URL(t,e).href},Yl={},Iv=function(e,r,a){let i=Promise.resolve();if(r&&r.length>0){let u=function(y){return Promise.all(y.map(S=>Promise.resolve(S).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const f=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),v=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));i=u(r.map(y=>{if(y=Pv(y,a),y in Yl)return;Yl[y]=!0;const S=y.endsWith(".css"),x=S?'[rel="stylesheet"]':"";if(!!a)for(let E=f.length-1;E>=0;E--){const T=f[E];if(T.href===y&&(!S||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${x}`))return;const A=document.createElement("link");if(A.rel=S?"stylesheet":Cv,S||(A.as="script"),A.crossOrigin="",A.href=y,v&&A.setAttribute("nonce",v),document.head.appendChild(A),S)return new Promise((E,T)=>{A.addEventListener("load",E),A.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${y}`)))})}))}function o(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return i.then(u=>{for(const f of u||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})},Rv=20,Ov={maxTokens:512},Br=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Ru(t,{count:e=Rv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(e).toArray();else{const U=new Set(await ze.emailClassifications.toCollection().primaryKeys());u=0,o=[],await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().until(()=>o.length>=e).each(F=>{U.has(F.id)?u++:o.push(F)})}if(o.length===0){const U=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:U,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const f=Date.now(),h=performance.now();let v=0,y=0,S=0,x=0,k=0;const A=[],E=t.modelId,T=Ko(E);if(!T)throw new Error(`Unknown model: ${E}`);if(!T.recommendedForEmailProcessing&&o.length>0){const{MODELS:U}=await Iv(async()=>{const{MODELS:X}=await Promise.resolve().then(()=>sv);return{MODELS:X}},void 0,import.meta.url),F=U.filter(X=>X.recommendedForEmailProcessing).map(X=>X.name);console.warn(`â ï¸ Current model (${T.name}) is not optimized for email processing. For best results with long emails, consider using: ${F.join(", ")}`)}for(let U=0;U<o.length&&!(i!=null&&i.aborted);U++){const F=o[U],X=Du(F),V=Mv(Br+X),ve=_u(E,V);if(!ve.suitable){console.warn(`Skipping email "${F.subject}": ${ve.reason}`),S++,A.push({success:!1,email:{subject:F.subject,from:F.from,date:F.date},error:`Email too long for ${T.name} (${ve.reason})`,promptSize:X.length,skipped:!0});continue}const Ce=[{role:"system",content:Br},{role:"user",content:X}];a({phase:"scanning",current:U+1,total:o.length,classified:v,errors:y,email:{subject:F.subject,from:F.from,date:F.date},prompt:{system:Br,user:X},systemPromptLength:Br.length,live:null,lastResult:null,totals:{outputTokens:x,inputTokens:k,elapsed:performance.now()-h}});const Pe=performance.now();try{const{text:ie,tps:J,numTokens:oe,inputTokens:Ae}=await t.generateFull(Ce,{maxTokens:512,enableThinking:!1},pe=>{a({phase:"generating",current:U+1,total:o.length,classified:v,errors:y,email:{subject:F.subject,from:F.from,date:F.date},live:{tps:pe.tps,numTokens:pe.numTokens},totals:{outputTokens:x,inputTokens:k,elapsed:performance.now()-h}})});x+=oe,k+=Ae;const re=Lv(ie),de=performance.now()-Pe;if(re){await ze.emailClassifications.put({emailId:F.id,action:re.action,reason:re.reason,summary:re.summary,tags:re.tags,subject:F.subject||"(no subject)",from:F.from||"",date:F.date,scannedAt:f,status:"pending"}),v++;const pe={success:!0,email:{subject:F.subject,from:F.from,date:F.date},classification:re,stats:{tps:J,numTokens:oe,inputTokens:Ae,elapsed:de},promptSize:X.length};A.push(pe),a({phase:"classified",current:U+1,total:o.length,classified:v,errors:y,email:{subject:F.subject,from:F.from,date:F.date},result:re,emailStats:{tps:J,numTokens:oe,inputTokens:Ae,elapsed:de},totals:{outputTokens:x,inputTokens:k,elapsed:performance.now()-h}})}}catch(ie){console.error(`Triage email ${U+1} failed:`,ie),y++;const J=ie.message||String(ie),oe=J.length>200?J.slice(0,200)+"...":J;A.push({success:!1,email:{subject:F.subject,from:F.from,date:F.date},error:oe,promptSize:X.length})}}const W=performance.now()-h,ce=A.length>0?Math.round(A.reduce((U,F)=>U+F.promptSize,0)/A.length):0,te=A.filter(U=>{var F;return U.success&&((F=U.stats)==null?void 0:F.tps)}).length>0?Math.round(A.filter(U=>U.success).reduce((U,F)=>{var X;return U+(((X=F.stats)==null?void 0:X.tps)||0)},0)/A.filter(U=>{var F;return U.success&&((F=U.stats)==null?void 0:F.tps)}).length):null;return a({phase:"done",current:o.length,total:o.length,classified:v,errors:y,results:A,summary:{avgPromptSize:ce,avgTps:te,systemPromptSize:Br.length,processed:o.length,skipped:u,skippedLong:S,modelName:T.name,modelMaxEmailTokens:T.maxEmailTokens},totals:{outputTokens:x,inputTokens:k,elapsed:W}}),{scanned:o.length,classified:v,skipped:u,skippedLong:S,errors:y}}async function Dv(){const t=await ze.emailClassifications.toArray();return Cu(t)}async function jv(){const t=await ze.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function oi(t,e){await ze.emailClassifications.update(t,{status:e})}async function Xl(){await ze.emailClassifications.clear()}async function Ho(t){await ze.emailClassifications.where("action").equals(t).delete()}async function Ou(t){await ze.emailClassifications.delete(t)}async function go(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Mv(t){return Math.ceil(t.length/4)}function Du(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"";return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Lv(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const f=Nv(u.action);if(!f)return console.warn("Triage: missing or invalid action field"),null;let h=[];return Array.isArray(u.tags)&&(h=u.tags.filter(v=>typeof v=="string"&&v.trim()).map(v=>v.trim().toLowerCase()).slice(0,10)),{action:f,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:h}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function Nv(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function _o(t){return`hsl(${wu(t)}, 55%, 55%)`}function qv(t){return`hsl(${wu(t)}, 40%, 35%)`}const Bv=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Ql(...t){Bv&&console.log("[debug]",...t)}function Nn(t){return Ql(`[MOUNT] ${t}`),()=>Ql(`[DESTROY] ${t}`)}var zv=B("<option> </option>"),Fv=B('<p class="model-description svelte-1p89qnn"> </p>'),Kv=B('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Uv=B('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Gv=B('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Hv=B('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Wv=B('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Vv=B('<p class="error svelte-1p89qnn"> </p>'),Yv=B('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Xv(t,e){Ct(e,!0);let r=Oe(e,"selectedModel",15),a=Oe(e,"gpuInfo",3,null),i=Oe(e,"error",3,null);nn(()=>Nn("ModelSelector"));var o=Yv(),u=b(m(o),2),f=b(m(u),2);un(f,21,()=>Ir,rr,(E,T)=>{var W=zv(),ce=m(W),te={};$(()=>{H(ce,`${g(T).name??""} â ${g(T).size??""}`),te!==(te=g(T).id)&&(W.value=(W.__value=g(T).id)??"")}),L(E,W)});var h=b(f,2);{var v=E=>{const T=At(()=>Ir.find(U=>U.id===r()));var W=Pr(),ce=Qe(W);{var te=U=>{var F=Fv(),X=m(F);$(()=>H(X,g(T).description)),L(U,F)};ue(ce,U=>{g(T)&&U(te)})}L(E,W)};ue(h,E=>{r()&&E(v)})}var y=b(u,2);{var S=E=>{var T=Wv(),W=b(m(T),2),ce=m(W),te=b(m(ce)),U=m(te),F=b(ce,2),X=b(m(F)),V=m(X),ve=b(F,2);{var Ce=de=>{var pe=Kv(),ee=b(m(pe)),fe=m(ee);$(()=>H(fe,a().device)),L(de,pe)};ue(ve,de=>{a().device&&a().device!=="unknown"&&de(Ce)})}var Pe=b(ve,2);{var ie=de=>{var pe=Uv(),ee=b(m(pe)),fe=m(ee);$(()=>H(fe,a().description)),L(de,pe)};ue(Pe,de=>{a().description&&a().description!=="unknown"&&de(ie)})}var J=b(Pe,2);{var oe=de=>{var pe=Gv(),ee=b(m(pe)),fe=m(ee);$(me=>H(fe,me),[()=>mo(a().limits.maxBufferSize)]),L(de,pe)};ue(J,de=>{var pe;(pe=a().limits)!=null&&pe.maxBufferSize&&de(oe)})}var Ae=b(J,2);{var re=de=>{var pe=Hv(),ee=b(m(pe)),fe=m(ee);$(()=>H(fe,`${a().features.length??""} supported`)),L(de,pe)};ue(Ae,de=>{var pe;(pe=a().features)!=null&&pe.length&&de(re)})}$(()=>{H(U,a().vendor),H(V,a().architecture)}),L(E,T)};ue(y,E=>{a()&&E(S)})}var x=b(y,2);{var k=E=>{var T=Vv(),W=m(T);$(()=>H(W,i())),L(E,T)};ue(x,E=>{i()&&E(k)})}var A=b(x,2);A.__click=function(...E){var T;(T=e.onload)==null||T.apply(this,E)},$(()=>A.disabled=i()),zo(f,r),L(t,o),Pt()}Kt(["click"]);var Qv=B('<span class="progress-percent svelte-r5fnze"> </span>'),Zv=B('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Jv=B('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),$v=B('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),ep=B('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),tp=B('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),np=B('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function rp(t,e){Ct(e,!0);let r=Oe(e,"message",3,""),a=Oe(e,"items",19,()=>[]);nn(()=>Nn("LoadingProgress"));var i=np(),o=m(i),u=m(o),f=b(o,2);un(f,17,a,rr,(h,v)=>{const y=At(()=>g(v).total?fv(g(v).loaded||0,g(v).total):null);var S=tp(),x=m(S),k=m(x),A=m(k),E=b(k,2);{var T=U=>{var F=Qv(),X=m(F);$(V=>H(X,`${V??""}%`),[()=>g(y).toFixed(1)]),L(U,F)};ue(E,U=>{g(y)!==null&&U(T)})}var W=b(x,2);{var ce=U=>{var F=Zv(),X=Qe(F),V=m(X),ve=b(X,2),Ce=m(ve),Pe=m(Ce),ie=b(Ce,4),J=m(ie),oe=b(ie,2),Ae=m(oe);$((re,de,pe,ee,fe)=>{Sn(V,`width: ${re??""}%`),H(Pe,de),H(J,pe),H(Ae,`(${ee??""} / ${fe??""} B)`)},[()=>Math.max(g(v).progress??0,.5).toFixed(1),()=>Qi(g(v).loaded||0),()=>Qi(g(v).total),()=>(g(v).loaded||0).toLocaleString(),()=>g(v).total.toLocaleString()]),L(U,F)},te=U=>{var F=ep(),X=b(Qe(F),2),V=m(X);{var ve=Pe=>{var ie=Jv(),J=Qe(ie),oe=m(J),Ae=b(J,2),re=m(Ae);$((de,pe)=>{H(oe,de),H(re,`(${pe??""} B)`)},[()=>Qi(g(v).loaded),()=>g(v).loaded.toLocaleString()]),L(Pe,ie)},Ce=Pe=>{var ie=$v();L(Pe,ie)};ue(V,Pe=>{g(v).loaded?Pe(ve):Pe(Ce,!1)})}L(U,F)};ue(W,U=>{g(v).total?U(ce):U(te,!1)})}$(()=>{mu(k,"title",g(v).file),H(A,g(v).file)}),L(h,S)}),$(()=>H(u,r())),L(t,i),Pt()}var ap=B('<span class="thinking-tokens svelte-11gjw00"> </span>'),sp=B('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),ip=B('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),op=B('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),lp=B('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),cp=B('<span class="cursor svelte-11gjw00">|</span>'),up=B(" <!>",1),fp=B('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),dp=B('<div class="content svelte-11gjw00"> </div>'),vp=B('<div><div class="role svelte-11gjw00"> </div> <!></div>');function pp(t,e){Ct(e,!0);let r=Oe(e,"isLast",3,!1),a=Oe(e,"isRunning",3,!1),i=Oe(e,"generationPhase",3,null),o=Oe(e,"numTokens",3,null);nn(()=>Nn(`MessageBubble[${e.msg.role}]`));var u=vp(),f=m(u),h=m(f),v=b(f,2);{var y=x=>{var k=fp(),A=Qe(k);{var E=V=>{var ve=sp(),Ce=b(m(ve),4);{var Pe=ie=>{var J=ap(),oe=m(J);$(()=>H(oe,`${o()??""} tokens`)),L(ie,J)};ue(Ce,ie=>{o()&&ie(Pe)})}L(V,ve)},T=V=>{var ve=ip();L(V,ve)};ue(A,V=>{a()&&r()&&i()==="thinking"?V(E):a()&&r()&&i()==="preparing"&&V(T,1)})}var W=b(A,2);{var ce=V=>{var ve=op(),Ce=m(ve),Pe=b(m(Ce),2),ie=m(Pe),J=b(Ce,2),oe=m(J);$(Ae=>{H(ie,`${Ae??""} words`),H(oe,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),L(V,ve)};ue(W,V=>{e.msg.thinking&&V(ce)})}var te=b(W,2),U=m(te);{var F=V=>{var ve=lp();L(V,ve)},X=V=>{var ve=up(),Ce=Qe(ve,!0),Pe=b(Ce);{var ie=J=>{var oe=cp();L(J,oe)};ue(Pe,J=>{a()&&r()&&J(ie)})}$(()=>H(Ce,e.msg.content)),L(V,ve)};ue(U,V=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?V(F):V(X,!1)})}L(x,k)},S=x=>{var k=dp(),A=m(k);$(()=>H(A,e.msg.content)),L(x,k)};ue(v,x=>{e.msg.role==="assistant"?x(y):x(S,!1)})}$(()=>{Nt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),H(h,e.msg.role==="user"?"You":"AI")}),L(t,u),Pt()}var hp=B('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),mp=B('<span class="edate svelte-mt5nvh"> </span>'),gp=B('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),_p=B('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),yp=B('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),bp=B('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),wp=B('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function kp(t,e){Ct(e,!0);let r=Oe(e,"pendingData",3,null),a=Re(null),i=Re(null);function o(k){M(a,g(a)===k?null:k,!0),M(i,null)}function u(k){return k.split("_").map(A=>A.charAt(0)+A.slice(1).toLowerCase()).join(" ")}function f(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function h(k){if(!k)return"";const A=k.replace(/<.*>/,"").trim();return A.length>24?A.slice(0,22)+"â¦":A}var v={toggleGroup:o},y=Pr(),S=Qe(y);{var x=k=>{var A=wp(),E=m(A),T=m(E),W=b(E,2);un(W,20,()=>r().order,U=>U,(U,F)=>{const X=At(()=>r().groups[F]),V=At(()=>_o(F)),ve=At(()=>g(a)===F);var Ce=hp();let Pe;Ce.__click=()=>o(F);let ie;var J=m(Ce);let oe;var Ae=b(J),re=b(Ae),de=m(re);$(pe=>{Pe=Nt(Ce,1,"chip svelte-mt5nvh",null,Pe,{active:g(ve)}),ie=Sn(Ce,"",ie,{"--c":g(V)}),oe=Sn(J,"",oe,{background:g(V)}),H(Ae,` ${pe??""} `),H(de,g(X).length)},[()=>u(F)]),L(U,Ce)});var ce=b(W,2);{var te=U=>{const F=At(()=>r().groups[g(a)]),X=At(()=>_o(g(a)));var V=bp(),ve=m(V);let Ce;var Pe=m(ve);Pe.__click=()=>{M(a,null),M(i,null)};var ie=b(Pe,2),J=m(ie),oe=b(ie,2),Ae=m(oe),re=b(ve,2);un(re,21,()=>g(F),me=>me.emailId,(me,be)=>{var Z=gp(),ae=m(Z);ae.__click=()=>{var De;return(De=e.onaskai)==null?void 0:De.call(e,`Tell me about the email "${g(be).subject}" from ${g(be).from}`)};var Q=m(ae),le=m(Q),Be=b(Q,2),We=m(Be),qe=b(We);{var Ue=De=>{var it=mp(),ot=m(it);$(dt=>H(ot,dt),[()=>f(g(be).date)]),L(De,it)};ue(qe,De=>{g(be).date&&De(Ue)})}var q=b(ae,2),ye=m(q);ye.__click=()=>{var De;return(De=e.onmarkacted)==null?void 0:De.call(e,g(be).emailId)};var xe=b(ye,2);xe.__click=()=>{var De;return(De=e.ondismiss)==null?void 0:De.call(e,g(be).emailId)},$(De=>{H(le,g(be).subject),H(We,De)},[()=>h(g(be).from)]),L(me,Z)});var de=b(re,2),pe=m(de);{var ee=me=>{var be=_p(),Z=Qe(be);Z.__click=()=>g(F).forEach(Q=>{var le;return(le=e.onmarkacted)==null?void 0:le.call(e,Q.emailId)});var ae=b(Z,2);ae.__click=()=>M(i,g(a),!0),L(me,be)},fe=me=>{var be=yp(),Z=Qe(be),ae=m(Z),Q=b(Z,2);Q.__click=()=>M(i,null);var le=b(Q,2);le.__click=()=>{var Be;(Be=e.oncleargroup)==null||Be.call(e,g(a)),M(i,null),M(a,null)},$(()=>H(ae,`Remove ${g(F).length??""}?`)),L(me,be)};ue(pe,me=>{g(i)!==g(a)?me(ee):me(fe,!1)})}$(me=>{Ce=Sn(ve,"",Ce,{"border-color":g(X)}),H(J,me),H(Ae,g(F).length)},[()=>u(g(a))]),L(U,V)};ue(ce,U=>{g(a)&&r().groups[g(a)]&&U(te)})}$(()=>H(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),L(k,A)};ue(S,k=>{r()&&r().total>0&&k(x)})}return L(t,y),Pt(v)}Kt(["click"]);var xp=B('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),Sp=B('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),Tp=B('<div class="strip svelte-1ed7zw1"><!></div>');function Ep(t,e){let r=Oe(e,"hasScanData",3,!1),a=Oe(e,"engineReady",3,!1),i=Oe(e,"isScanning",3,!1),o=At(()=>a()&&!r()&&!i()),u=At(()=>g(o)||i());var f=Pr(),h=Qe(f);{var v=y=>{var S=Tp(),x=m(S);{var k=E=>{var T=xp();L(E,T)},A=E=>{var T=Sp();T.__click=function(...W){var ce;(ce=e.onscan)==null||ce.apply(this,W)},L(E,T)};ue(x,E=>{i()?E(k):g(o)&&E(A,1)})}L(y,S)};ue(h,y=>{g(u)&&y(v)})}L(t,f)}Kt(["click"]);var Ap=B('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Cp=B('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Pp=B('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Ip=B('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Rp=B('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Op=B('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Dp=B('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function jp(t,e){Ct(e,!0),nn(()=>Nn("GpuPanel"));var r=Dp(),a=m(r),i=b(m(a),2),o=b(m(i),2),u=m(o),f=b(i,2),h=b(m(f),2),v=m(h),y=b(f,2);{var S=U=>{var F=Ap(),X=b(m(F),2),V=m(X);$(()=>H(V,e.gpuInfo.device)),L(U,F)};ue(y,U=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&U(S)})}var x=b(y,2);{var k=U=>{var F=Cp(),X=b(m(F),2),V=m(X);$(ve=>H(V,ve),[()=>mo(e.gpuInfo.limits.maxBufferSize)]),L(U,F)};ue(x,U=>{var F;(F=e.gpuInfo.limits)!=null&&F.maxBufferSize&&U(k)})}var A=b(x,2);{var E=U=>{var F=Pp(),X=b(m(F),2),V=m(X);$(()=>H(V,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),L(U,F)};ue(A,U=>{var F;(F=e.gpuInfo.limits)!=null&&F.maxComputeInvocationsPerWorkgroup&&U(E)})}var T=b(A,2);{var W=U=>{var F=Ip(),X=b(m(F),2),V=m(X);$(ve=>H(V,ve),[()=>mo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),L(U,F)};ue(T,U=>{var F;(F=e.gpuInfo.limits)!=null&&F.maxComputeWorkgroupStorageSize&&U(W)})}var ce=b(T,2);{var te=U=>{var F=Op(),X=m(F),V=m(X),ve=b(X,2);un(ve,21,()=>e.gpuInfo.features,rr,(Ce,Pe)=>{var ie=Rp(),J=m(ie);$(()=>H(J,g(Pe))),L(Ce,ie)}),$(()=>H(V,`Features (${e.gpuInfo.features.length??""})`)),L(U,F)};ue(ce,U=>{var F;(F=e.gpuInfo.features)!=null&&F.length&&U(te)})}$(()=>{H(u,e.gpuInfo.vendor),H(v,e.gpuInfo.architecture)}),L(t,r),Pt()}var Mp=B('<button class="gpu-badge svelte-1ktw27c"> </button>'),Lp=B('<span class="stats svelte-1ktw27c"> </span>'),Np=B('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),qp=B('<span class="stats preparing svelte-1ktw27c"> </span>'),Bp=B('<span class="stats svelte-1ktw27c"> </span>'),zp=B('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Fp=B('<button class="btn svelte-1ktw27c">Stop</button>'),Kp=B('<button class="btn primary svelte-1ktw27c">Send</button>'),Up=B('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Gp(t,e){Ct(e,!0),nn(()=>Nn("ChatView"));let r=Oe(e,"messages",19,()=>[]),a=Oe(e,"pendingData",3,null),i=Oe(e,"hasScanData",3,!1),o=Oe(e,"engineReady",3,!1),u=Oe(e,"isScanning",3,!1),f=Oe(e,"isRunning",3,!1),h=Oe(e,"tps",3,null),v=Oe(e,"numTokens",3,null),y=Oe(e,"generationPhase",3,null),S=Oe(e,"gpuInfo",3,null),x=Oe(e,"chatContainer",15),k=Re(""),A=Re(!1);function E(Q){Q.key==="Enter"&&!Q.shiftKey&&(Q.preventDefault(),T())}function T(){const Q=g(k).trim();!Q||f()||(M(k,""),e.onsend(Q))}function W(Q){Q&&!f()&&e.onsend(Q)}var ce=Up(),te=m(ce),U=m(te);{var F=Q=>{var le=Mp();le.__click=()=>M(A,!g(A));var Be=m(le);$(()=>H(Be,`WebGPU ${g(A)?"â²":"â¼"}`)),L(Q,le)};ue(U,Q=>{S()&&Q(F)})}var X=b(U,2);{var V=Q=>{var le=Lp(),Be=m(le);$((We,qe)=>H(Be,`${v()??""} tokens in ${We??""}s
        (${qe??""} tok/s)`),[()=>(v()/h()).toFixed(1),()=>h().toFixed(1)]),L(Q,le)},ve=Q=>{var le=Np();L(Q,le)},Ce=Q=>{var le=qp(),Be=m(le);$(We=>H(Be,`thinking... ${We??""}`),[()=>h()?`${h().toFixed(0)} tok/s`:""]),L(Q,le)},Pe=Q=>{var le=Bp(),Be=m(le);$(We=>H(Be,`${We??""} tok/s`),[()=>h().toFixed(1)]),L(Q,le)};ue(X,Q=>{h()&&!f()?Q(V):f()&&y()==="preparing"?Q(ve,1):f()&&y()==="thinking"?Q(Ce,2):h()&&f()&&Q(Pe,3)})}var ie=b(X,4);ie.__click=function(...Q){var le;(le=e.onreset)==null||le.apply(this,Q)};var J=b(te,2);{var oe=Q=>{jp(Q,{get gpuInfo(){return S()}})};ue(J,Q=>{g(A)&&S()&&Q(oe)})}var Ae=b(J,2),re=m(Ae);{var de=Q=>{var le=zp();L(Q,le)};ue(re,Q=>{r().length===0&&!(a()&&a().total>0)&&Q(de)})}var pe=b(re,2);un(pe,17,r,rr,(Q,le,Be)=>{var We=Pr(),qe=Qe(We);{var Ue=ye=>{kp(ye,{get pendingData(){return g(le).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:W})},q=ye=>{{let xe=At(()=>Be===r().length-1);pp(ye,{get msg(){return g(le)},get isLast(){return g(xe)},get isRunning(){return f()},get generationPhase(){return y()},get numTokens(){return v()}})}};ue(qe,ye=>{g(le).type==="dashboard"?ye(Ue):ye(q,!1)})}L(Q,We)}),gu(Ae,Q=>x(Q),()=>x());var ee=b(Ae,2);Ep(ee,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var fe=b(ee,2),me=m(fe);me.__keydown=E;var be=b(me,2);{var Z=Q=>{var le=Fp();le.__click=function(...Be){var We;(We=e.onstop)==null||We.apply(this,Be)},L(Q,le)},ae=Q=>{var le=Kp();le.__click=T,$(Be=>le.disabled=Be,[()=>!g(k).trim()]),L(Q,le)};ue(be,Q=>{f()?Q(Z):Q(ae,!1)})}$(()=>{ie.disabled=f(),me.disabled=f()}),Fo(me,()=>g(k),Q=>M(k,Q)),L(t,ce),Pt()}Kt(["click","keydown"]);var Hp=B('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Wp(t,e){Ct(e,!0);const r=!!navigator.gpu,a=yu();let i=Re(Jt(localStorage.getItem("selectedModel")||Ir[0].id)),o=Re(null),u=Re(null),f=Re(""),h=Re(Jt([])),v=Re(Jt([])),y=Re(!1),S=Re(null),x=Re(null),k=Re(null),A=Re(null),E=Re(null),T=Re(null),W=Re(!1),ce=Re(!1),te=!1;nn(()=>{a.check(),a.isReady&&U();const Z=a.onMessage(ae=>{switch(ae.status){case"webgpu-info":M(A,ae.data,!0);break;case"loading":M(o,"loading"),M(f,ae.data,!0);break;case"initiate":M(h,[...g(h),ae],!0);break;case"progress":M(h,g(h).map(Q=>Q.file===ae.file?{...Q,...ae}:Q),!0);break;case"done":M(h,g(h).filter(Q=>Q.file!==ae.file),!0);break;case"ready":M(o,"ready"),U();break;case"start":if(!g(y))break;M(E,ae.phase||"preparing",!0),M(v,[...g(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!g(y))break;M(E,ae.phase,!0);break;case"thinking":{if(!g(y))break;M(S,ae.tps,!0),M(x,ae.numTokens,!0);const Q=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Q,thinking:(Q.thinking||"")+ae.content}],!0),ie();break}case"thinking-done":{if(!g(y))break;M(S,ae.tps,!0),M(x,ae.numTokens,!0);const Q=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Q,thinking:ae.content}],!0);break}case"update":{if(!g(y))break;M(S,ae.tps,!0),M(x,ae.numTokens,!0);const Q=g(v)[g(v).length-1];M(v,[...g(v).slice(0,-1),{...Q,content:Q.content+ae.output}],!0),ie();break}case"complete":if(!g(y))break;M(y,!1),M(E,null),F();break;case"error":if(!g(y))break;M(u,ae.data,!0),M(y,!1),M(E,null);break}});return()=>Z()});async function U(){if(!(te||g(v).length>0))try{const Z=await Vl();M(T,Z,!0),Z&&(te=!0,M(v,[{role:"assistant",type:"dashboard",pendingData:Z}],!0),ie());const ae=await go();M(W,ae.classified>0)}catch{}}async function F(){try{const Z=await Vl();M(T,Z,!0);const ae=g(v).findIndex(le=>le.type==="dashboard");ae!==-1&&(Z&&Z.total>0?M(v,g(v).map((le,Be)=>Be===ae?{...le,pendingData:Z}:le),!0):M(v,g(v).filter((le,Be)=>Be!==ae),!0));const Q=await go();M(W,Q.classified>0)}catch{}}async function X(Z){await oi(Z,"acted"),await F()}async function V(Z){await oi(Z,"dismissed"),await F()}async function ve(Z){await Ou(Z),await F()}async function Ce(Z){await Ho(Z),await F()}async function Pe(){if(!(g(ce)||!a.isReady)){M(ce,!0);try{await Ru(a,{count:20}),await F(),g(T)&&!g(v).some(Z=>Z.type==="dashboard")&&(M(v,[{role:"assistant",type:"dashboard",pendingData:g(T)},...g(v)],!0),ie())}catch(Z){console.error("Scan failed:",Z)}finally{M(ce,!1)}}}function ie(){fu().then(()=>{g(k)&&(g(k).scrollTop=g(k).scrollHeight)})}function J(){M(o,"loading"),localStorage.setItem("selectedModel",g(i)),a.loadModel(g(i))}async function oe(Z){if(!Z||g(y))return;M(v,[...g(v),{role:"user",content:Z}],!0),M(S,null),M(y,!0);let ae=[];try{const Be=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Z)?await Av(Z):await Ev();Be&&(ae=[{role:"system",content:Be}])}catch{}const Q=g(v).filter(le=>le.type!=="dashboard").map(le=>({role:le.role,content:le.content}));a.generate([...ae,...Q]),ie()}function Ae(){a.interrupt()}function re(){a.reset(),M(v,[],!0),M(S,null),M(x,null),te=!1,U()}var de=Pr(),pe=Qe(de);{var ee=Z=>{var ae=Hp();L(Z,ae)},fe=Z=>{Xv(Z,{get gpuInfo(){return g(A)},get error(){return g(u)},onload:J,get selectedModel(){return g(i)},set selectedModel(ae){M(i,ae,!0)}})},me=Z=>{rp(Z,{get message(){return g(f)},get items(){return g(h)}})},be=Z=>{Gp(Z,{get messages(){return g(v)},get pendingData(){return g(T)},get hasScanData(){return g(W)},get engineReady(){return a.isReady},get isScanning(){return g(ce)},get isRunning(){return g(y)},get tps(){return g(S)},get numTokens(){return g(x)},get generationPhase(){return g(E)},get gpuInfo(){return g(A)},onsend:oe,onstop:Ae,onreset:re,onmarkacted:X,ondismiss:V,onremove:ve,oncleargroup:Ce,onscan:Pe,get chatContainer(){return g(k)},set chatContainer(ae){M(k,ae,!0)}})};ue(pe,Z=>{r?g(o)===null?Z(fe,1):g(o)==="loading"?Z(me,2):Z(be,!1):Z(ee)})}L(t,de),Pt()}const Zl="https://accounts.google.com/gsi/client",Vp="https://www.googleapis.com/auth/gmail.readonly",Wo="me-ai:oauth-token",Vo=300*1e3;let gs=null,ps=null,Vr=0;function ju(t,e){Vr=Date.now()+e*1e3;try{sessionStorage.setItem(Wo,JSON.stringify({access_token:t,expires_at:Vr}))}catch{}}function yo(){Vr=0;try{sessionStorage.removeItem(Wo)}catch{}}function Yp(){try{const t=sessionStorage.getItem(Wo);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-Vo?(yo(),null):(Vr=r,{access_token:e})}catch{return yo(),null}}function Xp(){return Vr>0&&Date.now()<Vr-Vo}function Qp(){return Vr<=0?0:Math.max(0,Vr-Vo-Date.now())}function Jl(){return new Promise((t,e)=>{if(!gs){e(new Error("Google Auth not initialized."));return}ps=r=>{r.error?e(new Error(r.error_description||r.error)):(ju(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},gs.requestAccessToken({prompt:""})})}function Zp(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Zl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Zl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function $l(t){await Zp(),gs=google.accounts.oauth2.initTokenClient({client_id:t,scope:Vp,callback:e=>{ps&&(ps(e),ps=null)}})}function Jp(){return new Promise((t,e)=>{if(!gs){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}ps=r=>{r.error?e(new Error(r.error_description||r.error)):(ju(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},gs.requestAccessToken()})}function $p(t){return yo(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const $t="gmail",ec=8,Mu=50,Lu=100;async function eh(t,{limit:e=Mu,onProgress:r=()=>{},signal:a}={}){var u;const i=await ze.syncState.get($t);if(i!=null&&i.historyId)try{return await sh(t,i,r,a)}catch(f){if(f instanceof Uo&&(f.status===404||f.code==="notFound")||((u=f.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await ze.syncState.delete($t);else throw f}return await rh(t,e===0?1/0:e,r,a)}async function th(t,{limit:e=Mu,onProgress:r=()=>{},signal:a}={}){const i=await ze.syncState.get($t);return i!=null&&i.oldestPageToken?await ah(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function nh(){const t=await ze.syncState.get($t);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Nu(){await ze.transaction("rw",[ze.items,ze.syncState],async()=>{await ze.items.where("sourceType").equals($t).delete(),await ze.syncState.delete($t)})}async function rh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),_a(a);const i=await ku(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,f=null;for(;o.length<e;){_a(a);const S=e-o.length,x=await xu(t,{maxResults:Math.min(Lu,S),pageToken:u}),k=(x.messages||[]).map(A=>A.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=x.nextPageToken,!u||k.length===0)break}if(f=u||null,o.length===0)return await ze.syncState.put({sourceType:$t,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:h,errors:v}=await qu(t,o,r,a),y=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.put({sourceType:$t,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:f}),r({phase:"done",message:`Synced ${h} messages`,current:h,total:h}),{added:h,deleted:0,errors:v}}async function ah(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),_a(i);const o=[];let u=e.oldestPageToken,f=null;for(;o.length<r;){_a(i);const S=r-o.length,x=await xu(t,{maxResults:Math.min(Lu,S),pageToken:u}),k=(x.messages||[]).map(A=>A.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=x.nextPageToken,!u||k.length===0)break}if(f=u||null,o.length===0)return await ze.syncState.update($t,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:h,errors:v}=await qu(t,o,a,i),y=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.update($t,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:f}),a({phase:"done",message:f?`Downloaded ${h} more (more available)`:`Downloaded ${h} more (all synced)`,current:y,total:y}),{added:h,errors:v}}async function sh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),_a(a);let i=0,o=0,u=0,f,h=e.historyId;do{_a(a);const y=await hv(t,{startHistoryId:e.historyId,pageToken:f});if(h=y.historyId||h,f=y.nextPageToken,!!y.history){for(const S of y.history){if(S.messagesAdded){const x=S.messagesAdded.map(A=>A.message.id),k=[...new Set(x.filter(A=>A))];if(k.length>0){const A=await Promise.allSettled(k.map(T=>Su(t,T))),E=[];for(const T of A)T.status==="fulfilled"?E.push(Bu(T.value)):u++;E.length>0&&(await ze.items.bulkPut(E),await zu(E),i+=E.length)}}if(S.messagesDeleted){const x=S.messagesDeleted.map(k=>bu($t,k.message.id)).filter(k=>k);x.length>0&&(await ze.items.bulkDelete(x),o+=x.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(f);const v=await ze.items.where("sourceType").equals($t).count();return await ze.syncState.put({sourceType:$t,historyId:h,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:v,total:v}),{added:i,deleted:o,errors:u}}async function qu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=ec){_a(a);const f=e.slice(u,u+ec),h=await Promise.allSettled(f.map(y=>Su(t,y))),v=[];for(const y of h)y.status==="fulfilled"?v.push(Bu(y.value)):o++;v.length>0&&(await ze.items.bulkPut(v),await zu(v)),i+=v.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Bu(t){const e=qr(t,"From"),r=qr(t,"To"),a=qr(t,"Cc"),i=qr(t,"Subject")||"(no subject)",o=qr(t,"Date"),u=qr(t,"Message-ID"),f=qr(t,"In-Reply-To"),h=qr(t,"References");let v;try{v=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{v=Date.now()}return{id:bu($t,t.id),sourceType:$t,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:mv(t),htmlBody:gv(t),date:v,labels:t.labelIds||[],messageId:u,inReplyTo:f,references:h,raw:t,syncedAt:Date.now()}}async function zu(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=ih(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await ze.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await ze.contacts.update(o.id,u)}else await ze.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function ih(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function _a(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var oh=B(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function lh(t,e){Ct(e,!0);let r=Oe(e,"clientIdInput",15);nn(()=>Nn("SetupGuide"));let a=Re(null);async function i(Q){try{await navigator.clipboard.writeText(Q),M(a,Q,!0),setTimeout(()=>{M(a,null)},1500)}catch{const le=document.createElement("input");le.value=Q,document.body.appendChild(le),le.select(),document.execCommand("copy"),document.body.removeChild(le),M(a,Q,!0),setTimeout(()=>{M(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",f="https://cypherkitty.github.io/me-ai/";var h=oh(),v=m(h),y=b(m(v),4),S=b(m(y),6),x=b(m(S),2),k=b(m(x),2),A=b(m(k),2),E=m(A);E.__click=()=>i(o);var T=m(E);T.textContent="http://localhost:5173";var W=b(T,2),ce=m(W),te=b(E,2);te.__click=()=>i(u);var U=m(te);U.textContent="https://cypherkitty.github.io";var F=b(U,2),X=m(F),V=b(k,2),ve=b(m(V),2),Ce=m(ve);Ce.__click=()=>i(o);var Pe=m(Ce);Pe.textContent="http://localhost:5173";var ie=b(Pe,2),J=m(ie),oe=b(Ce,2);oe.__click=()=>i(u);var Ae=m(oe);Ae.textContent="https://cypherkitty.github.io";var re=b(Ae,2),de=m(re),pe=b(oe,2);pe.__click=()=>i(f);var ee=m(pe);ee.textContent="https://cypherkitty.github.io/me-ai/";var fe=b(ee,2),me=m(fe),be=b(y,2),Z=m(be);Z.__keydown=Q=>Q.key==="Enter"&&e.onsave();var ae=b(Z,2);ae.__click=function(...Q){var le;(le=e.onsave)==null||le.apply(this,Q)},$(Q=>{H(ce,g(a)===o?"â":"â§"),H(X,g(a)===u?"â":"â§"),H(J,g(a)===o?"â":"â§"),H(de,g(a)===u?"â":"â§"),H(me,g(a)===f?"â":"â§"),ae.disabled=Q},[()=>!r().trim()]),Fo(Z,r),L(t,h),Pt()}Kt(["click","keydown"]);function ch(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof Uo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var uh=B('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),fh=B('<div class="error-card-title svelte-14buhqq"> </div>'),dh=B('<p class="error-card-fix svelte-14buhqq"> </p>'),vh=B('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),ph=B('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),hh=B('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Fu(t,e){Ct(e,!0);let r=Oe(e,"ondismiss",3,null),a=Oe(e,"onsignout",3,null),i=At(()=>ch(e.error));nn(()=>Nn("ErrorCard"));var o=hh(),u=m(o);{var f=W=>{var ce=uh(),te=m(ce),U=m(te),F=b(te,2);F.__click=function(...X){var V;(V=r())==null||V.apply(this,X)},$(()=>H(U,g(i).title)),L(W,ce)},h=W=>{var ce=fh(),te=m(ce);$(()=>H(te,g(i).title)),L(W,ce)};ue(u,W=>{r()?W(f):W(h,!1)})}var v=b(u,2),y=m(v),S=b(v,2);{var x=W=>{var ce=dh(),te=m(ce);$(()=>H(te,g(i).fix)),L(W,ce)};ue(S,W=>{g(i).fix&&W(x)})}var k=b(S,2);{var A=W=>{var ce=vh(),te=m(ce);$(()=>{mu(ce,"href",g(i).link.url),H(te,`${g(i).link.label??""} â`)}),L(W,ce)};ue(k,W=>{g(i).link&&W(A)})}var E=b(k,2);{var T=W=>{var ce=ph();ce.__click=function(...te){var U;(U=a())==null||U.apply(this,te)},L(W,ce)};ue(E,W=>{g(i).action==="signout"&&a()&&W(T)})}$(()=>H(y,g(i).description)),L(t,o),Pt()}Kt(["click"]);var mh=B('<span class="spinner svelte-nyqevv"></span> Signing in...',1),gh=Bo('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),_h=B(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function yh(t,e){Ct(e,!0);let r=Oe(e,"error",3,null),a=Oe(e,"loadingAuth",3,!1);nn(()=>Nn("AuthCard"));var i=_h(),o=m(i),u=b(m(o),4);{var f=T=>{Fu(T,{get error(){return r()},get onsignout(){return e.onsignout}})};ue(u,T=>{r()&&T(f)})}var h=b(u,2);h.__click=function(...T){var W;(W=e.onsignin)==null||W.apply(this,T)};var v=m(h);{var y=T=>{var W=mh();L(T,W)},S=T=>{var W=gh();L(T,W)};ue(v,T=>{a()?T(y):T(S,!1)})}var x=b(h,2),k=b(m(x),2),A=m(k),E=b(k,2);E.__click=function(...T){var W;(W=e.onclear)==null||W.apply(this,T)},$(T=>{h.disabled=a(),H(A,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),L(t,i),Pt()}Kt(["click"]);var bh=B('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),wh=B('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),kh=B('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function xh(t,e){Ct(e,!0);let r=Oe(e,"profile",3,null),a=Oe(e,"loadingProfile",3,!1);nn(()=>Nn("ProfileCard"));var i=kh(),o=m(i),u=m(o),f=b(o,2),h=m(f);{var v=x=>{var k=bh();L(x,k)},y=x=>{var k=wh(),A=Qe(k),E=m(A),T=b(A,2),W=m(T);$((ce,te)=>{H(E,r().emailAddress),H(W,`${ce??""} messages
        Â· ${te??""} threads`)},[()=>{var ce;return((ce=r().messagesTotal)==null?void 0:ce.toLocaleString())||"?"},()=>{var ce;return((ce=r().threadsTotal)==null?void 0:ce.toLocaleString())||"?"}]),L(x,k)};ue(h,x=>{a()?x(v):r()&&x(y,1)})}var S=b(f,2);S.__click=function(...x){var k;(k=e.onsignout)==null||k.apply(this,x)},$(x=>H(u,x),[()=>r()?Eu(r().emailAddress):"?"]),L(t,i),Pt()}Kt(["click"]);var Sh=B('<span class="spinner svelte-1ds3j4k"></span>'),Th=Bo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),Eh=B('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),Ah=B('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),Ch=B('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),Ph=B('<option class="svelte-1ds3j4k"> </option>'),Ih=B('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Rh=B('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Oh=B('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Dh=B('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),jh=B('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Mh=B('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Lh(t,e){Ct(e,!0),nn(()=>Nn("SyncStatus"));let r=Oe(e,"syncStatus",3,null),a=Oe(e,"syncProgress",3,null),i=Oe(e,"isSyncing",3,!1),o=Re(!1),u=Re(50);const f=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function h(ee){if(!ee)return"never";const fe=Math.floor((Date.now()-ee)/1e3);if(fe<60)return"just now";const me=Math.floor(fe/60);if(me<60)return`${me}m ago`;const be=Math.floor(me/60);return be<24?`${be}h ago`:`${Math.floor(be/24)}d ago`}function v(){var ee,fe;return!((ee=a())!=null&&ee.total)||!((fe=a())!=null&&fe.current)?0:Math.round(a().current/a().total*100)}var y=Mh(),S=m(y),x=m(S),k=m(x);{var A=ee=>{var fe=Sh();L(ee,fe)},E=ee=>{var fe=Th();L(ee,fe)};ue(k,ee=>{i()?ee(A):ee(E,!1)})}var T=b(x,2),W=b(m(T),2);{var ce=ee=>{var fe=Eh(),me=m(fe),be=b(me);{var Z=Q=>{var le=si("Â· more available");L(Q,le)},ae=Q=>{var le=si("Â· all synced");L(Q,le)};ue(be,Q=>{r().hasMore?Q(Z):Q(ae,!1)})}$((Q,le)=>H(me,`${Q??""} emails stored
          Â· synced ${le??""} `),[()=>r().totalItems.toLocaleString(),()=>h(r().lastSyncAt)]),L(ee,fe)},te=ee=>{var fe=Ah();L(ee,fe)};ue(W,ee=>{var fe;(fe=r())!=null&&fe.synced?ee(ce):ee(te,!1)})}var U=b(T,2),F=m(U);{var X=ee=>{var fe=Ch();fe.__click=()=>M(o,!g(o)),L(ee,fe)};ue(F,ee=>{var fe;(fe=r())!=null&&fe.synced&&!i()&&ee(X)})}var V=b(S,2),ve=m(V),Ce=b(m(ve),2);un(Ce,21,()=>f,rr,(ee,fe)=>{var me=Ph(),be=m(me),Z={};$(()=>{H(be,g(fe).label),Z!==(Z=g(fe).value)&&(me.value=(me.__value=g(fe).value)??"")}),L(ee,me)});var Pe=b(ve,2),ie=m(Pe);{var J=ee=>{var fe=Rh(),me=Qe(fe);me.__click=()=>e.onsync(g(u));var be=m(me),Z=b(me,2);{var ae=Q=>{var le=Ih();le.__click=()=>e.onsyncmore(g(u));var Be=m(le);$(()=>{le.disabled=i(),H(Be,i()?"Loading...":"Sync More")}),L(Q,le)};ue(Z,Q=>{r().hasMore&&Q(ae)})}$(()=>{me.disabled=i(),H(be,i()?"Syncing...":"Sync New")}),L(ee,fe)},oe=ee=>{var fe=Oh();fe.__click=()=>e.onsync(g(u));var me=m(fe);$(()=>{fe.disabled=i(),H(me,i()?"Syncing...":"Download Emails")}),L(ee,fe)};ue(ie,ee=>{var fe;(fe=r())!=null&&fe.synced?ee(J):ee(oe,!1)})}var Ae=b(V,2);{var re=ee=>{var fe=Dh(),me=m(fe),be=m(me);let Z,ae;var Q=b(me,2),le=m(Q);$(Be=>{Z=Nt(be,1,"progress-fill svelte-1ds3j4k",null,Z,{indeterminate:!a().total}),ae=Sn(be,"",ae,Be),H(le,a().message||"Syncing...")},[()=>({width:`${v()??""}%`})]),L(ee,fe)};ue(Ae,ee=>{i()&&a()&&ee(re)})}var de=b(Ae,2);{var pe=ee=>{var fe=jh(),me=b(m(fe),2),be=m(me);be.__click=()=>M(o,!1);var Z=b(be,2);Z.__click=()=>{e.onclear(),M(o,!1)},L(ee,fe)};ue(de,ee=>{g(o)&&ee(pe)})}$(()=>Ce.disabled=i()),zo(Ce,()=>g(u),ee=>M(u,ee)),L(t,y),Pt()}Kt(["click"]);var Nh=B('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),qh=B('<div class="message-list svelte-y2uamw"></div>');function Bh(t,e){Ct(e,!0);let r=Oe(e,"messages",19,()=>[]);nn(()=>Nn("MessageList"));var a=qh();un(a,21,r,rr,(i,o)=>{var u=Nh();u.__click=()=>e.onselect(g(o));var f=m(u),h=m(f),v=b(f,2),y=m(v),S=m(y),x=m(S),k=b(S,2),A=m(k),E=b(y,2),T=m(E),W=b(E,2),ce=m(W);$((te,U,F)=>{H(h,te),H(x,U),H(A,F),H(T,g(o).subject),H(ce,g(o).snippet)},[()=>Eu(g(o).from),()=>Tu(g(o).from),()=>Go(g(o).date)]),L(i,u)}),L(t,a),Pt()}Kt(["click"]);function Yo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var wa=Yo();function Ku(t){wa=t}var na={exec:()=>null};function ft(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(pn.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var zh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),pn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Fh=/^(?:[ \t]*(?:\n|$))+/,Kh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Uh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Es=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Gh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Xo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Uu=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Gu=ft(Uu).replace(/bull/g,Xo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Hh=ft(Uu).replace(/bull/g,Xo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Qo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Wh=/^[^\n]+/,Zo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Vh=ft(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Zo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Yh=ft(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Xo).getRegex(),_i="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Jo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Xh=ft("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Jo).replace("tag",_i).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Hu=ft(Qo).replace("hr",Es).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_i).getRegex(),Qh=ft(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Hu).getRegex(),$o={blockquote:Qh,code:Kh,def:Vh,fences:Uh,heading:Gh,hr:Es,html:Xh,lheading:Gu,list:Yh,newline:Fh,paragraph:Hu,table:na,text:Wh},tc=ft("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Es).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_i).getRegex(),Zh={...$o,lheading:Hh,table:tc,paragraph:ft(Qo).replace("hr",Es).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",tc).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",_i).getRegex()},Jh={...$o,html:ft(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Jo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:na,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ft(Qo).replace("hr",Es).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Gu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},$h=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,em=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Wu=/^( {2,}|\\)\n(?!\s*$)/,tm=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,yi=/[\p{P}\p{S}]/u,el=/[\s\p{P}\p{S}]/u,Vu=/[^\s\p{P}\p{S}]/u,nm=ft(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,el).getRegex(),Yu=/(?!~)[\p{P}\p{S}]/u,rm=/(?!~)[\s\p{P}\p{S}]/u,am=/(?:[^\s\p{P}\p{S}]|~)/u,Xu=/(?![*_])[\p{P}\p{S}]/u,sm=/(?![*_])[\s\p{P}\p{S}]/u,im=/(?:[^\s\p{P}\p{S}]|[*_])/u,om=ft(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",zh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Qu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,lm=ft(Qu,"u").replace(/punct/g,yi).getRegex(),cm=ft(Qu,"u").replace(/punct/g,Yu).getRegex(),Zu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",um=ft(Zu,"gu").replace(/notPunctSpace/g,Vu).replace(/punctSpace/g,el).replace(/punct/g,yi).getRegex(),fm=ft(Zu,"gu").replace(/notPunctSpace/g,am).replace(/punctSpace/g,rm).replace(/punct/g,Yu).getRegex(),dm=ft("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Vu).replace(/punctSpace/g,el).replace(/punct/g,yi).getRegex(),vm=ft(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Xu).getRegex(),pm="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",hm=ft(pm,"gu").replace(/notPunctSpace/g,im).replace(/punctSpace/g,sm).replace(/punct/g,Xu).getRegex(),mm=ft(/\\(punct)/,"gu").replace(/punct/g,yi).getRegex(),gm=ft(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_m=ft(Jo).replace("(?:-->|$)","-->").getRegex(),ym=ft("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_m).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),li=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,bm=ft(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",li).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ju=ft(/^!?\[(label)\]\[(ref)\]/).replace("label",li).replace("ref",Zo).getRegex(),$u=ft(/^!?\[(ref)\](?:\[\])?/).replace("ref",Zo).getRegex(),wm=ft("reflink|nolink(?!\\()","g").replace("reflink",Ju).replace("nolink",$u).getRegex(),nc=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,tl={_backpedal:na,anyPunctuation:mm,autolink:gm,blockSkip:om,br:Wu,code:em,del:na,delLDelim:na,delRDelim:na,emStrongLDelim:lm,emStrongRDelimAst:um,emStrongRDelimUnd:dm,escape:$h,link:bm,nolink:$u,punctuation:nm,reflink:Ju,reflinkSearch:wm,tag:ym,text:tm,url:na},km={...tl,link:ft(/^!?\[(label)\]\((.*?)\)/).replace("label",li).getRegex(),reflink:ft(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",li).getRegex()},bo={...tl,emStrongRDelimAst:fm,emStrongLDelim:cm,delLDelim:vm,delRDelim:hm,url:ft(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",nc).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ft(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",nc).getRegex()},xm={...bo,br:ft(Wu).replace("{2,}","*").getRegex(),text:ft(bo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Vs={normal:$o,gfm:Zh,pedantic:Jh},ts={normal:tl,gfm:bo,breaks:xm,pedantic:km},Sm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rc=t=>Sm[t];function wr(t,e){if(e){if(pn.escapeTest.test(t))return t.replace(pn.escapeReplace,rc)}else if(pn.escapeTestNoEncode.test(t))return t.replace(pn.escapeReplaceNoEncode,rc);return t}function ac(t){try{t=encodeURI(t).replace(pn.percentDecode,"%")}catch{return null}return t}function sc(t,e){var o;let r=t.replace(pn.findPipe,(u,f,h)=>{let v=!1,y=f;for(;--y>=0&&h[y]==="\\";)v=!v;return v?"|":" |"}),a=r.split(pn.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(pn.slashPipe,"|");return a}function ns(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function Tm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function Em(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function ic(t,e,r,a,i){let o=e.href,u=e.title||null,f=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:f,tokens:a.inlineTokens(f)};return a.state.inLink=!1,h}function Am(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[f]=u;return f.length>=i.length?o.slice(i.length):o}).join(`
`)}var ci=class{constructor(t){rt(this,"options");rt(this,"rules");rt(this,"lexer");this.options=t||wa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:ns(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=Am(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=ns(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:ns(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=ns(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,f=[],h;for(h=0;h<r.length;h++)if(this.rules.other.blockquoteStart.test(r[h]))f.push(r[h]),u=!0;else if(!u)f.push(r[h]);else break;r=r.slice(h);let v=f.join(`
`),y=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,i=i?`${i}
${y}`:y;let S=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=S,r.length===0)break;let x=o.at(-1);if((x==null?void 0:x.type)==="code")break;if((x==null?void 0:x.type)==="blockquote"){let k=x,A=k.raw+`
`+r.join(`
`),E=this.blockquote(A);o[o.length-1]=E,a=a.substring(0,a.length-k.raw.length)+E.raw,i=i.substring(0,i.length-k.text.length)+E.text;break}else if((x==null?void 0:x.type)==="list"){let k=x,A=k.raw+`
`+r.join(`
`),E=this.list(A);o[o.length-1]=E,a=a.substring(0,a.length-x.raw.length)+E.raw,i=i.substring(0,i.length-k.raw.length)+E.raw,r=A.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let f=this.rules.other.listItemRegex(i),h=!1;for(;t;){let y=!1,S="",x="";if(!(e=f.exec(t))||this.rules.block.hr.test(t))break;S=e[0],t=t.substring(S.length);let k=Em(e[2].split(`
`,1)[0],e[1].length),A=t.split(`
`,1)[0],E=!k.trim(),T=0;if(this.options.pedantic?(T=2,x=k.trimStart()):E?T=e[1].length+1:(T=k.search(this.rules.other.nonSpaceChar),T=T>4?1:T,x=k.slice(T),T+=e[1].length),E&&this.rules.other.blankLine.test(A)&&(S+=A+`
`,t=t.substring(A.length+1),y=!0),!y){let W=this.rules.other.nextBulletRegex(T),ce=this.rules.other.hrRegex(T),te=this.rules.other.fencesBeginRegex(T),U=this.rules.other.headingBeginRegex(T),F=this.rules.other.htmlBeginRegex(T),X=this.rules.other.blockquoteBeginRegex(T);for(;t;){let V=t.split(`
`,1)[0],ve;if(A=V,this.options.pedantic?(A=A.replace(this.rules.other.listReplaceNesting,"  "),ve=A):ve=A.replace(this.rules.other.tabCharGlobal,"    "),te.test(A)||U.test(A)||F.test(A)||X.test(A)||W.test(A)||ce.test(A))break;if(ve.search(this.rules.other.nonSpaceChar)>=T||!A.trim())x+=`
`+ve.slice(T);else{if(E||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||te.test(k)||U.test(k)||ce.test(k))break;x+=`
`+A}E=!A.trim(),S+=V+`
`,t=t.substring(V.length+1),k=ve.slice(T)}}u.loose||(h?u.loose=!0:this.rules.other.doubleBlankLine.test(S)&&(h=!0)),u.items.push({type:"list_item",raw:S,task:!!this.options.gfm&&this.rules.other.listIsTask.test(x),loose:!1,text:x,tokens:[]}),u.raw+=S}let v=u.items.at(-1);if(v)v.raw=v.raw.trimEnd(),v.text=v.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let y of u.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((a=y.tokens[0])==null?void 0:a.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let x=this.lexer.inlineQueue.length-1;x>=0;x--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[x].src)){this.lexer.inlineQueue[x].src=this.lexer.inlineQueue[x].src.replace(this.rules.other.listReplaceTask,"");break}}let S=this.rules.other.listTaskCheckbox.exec(y.raw);if(S){let x={type:"checkbox",raw:S[0]+" ",checked:S[0]!=="[ ]"};y.checked=x.checked,u.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=x.raw+y.tokens[0].raw,y.tokens[0].text=x.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(x)):y.tokens.unshift({type:"paragraph",raw:x.raw,text:x.raw,tokens:[x]}):y.tokens.unshift(x)}}if(!u.loose){let S=y.tokens.filter(k=>k.type==="space"),x=S.length>0&&S.some(k=>this.rules.other.anyLine.test(k.raw));u.loose=x}}if(u.loose)for(let y of u.items){y.loose=!0;for(let S of y.tokens)S.type==="text"&&(S.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=sc(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let f of a)this.rules.other.tableAlignRight.test(f)?o.align.push("right"):this.rules.other.tableAlignCenter.test(f)?o.align.push("center"):this.rules.other.tableAlignLeft.test(f)?o.align.push("left"):o.align.push(null);for(let f=0;f<r.length;f++)o.header.push({text:r[f],tokens:this.lexer.inline(r[f]),header:!0,align:o.align[f]});for(let f of i)o.rows.push(sc(f,o.header.length).map((h,v)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[v]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=ns(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=Tm(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),ic(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return ic(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,f=i,h=0,v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){f+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){h+=u;continue}if(f-=u,f>0)continue;u=Math.min(u,u+f+h);let y=[...a[0]][0].length,S=t.slice(0,i+a.index+y+u);if(Math.min(i,u)%2){let k=S.slice(1,-1);return{type:"em",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}let x=S.slice(2,-2);return{type:"strong",raw:S,text:x,tokens:this.lexer.inlineTokens(x)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,f=i,h=this.rules.inline.delRDelim;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){f+=u;continue}if(f-=u,f>0)continue;u=Math.min(u,u+f);let v=[...a[0]][0].length,y=t.slice(0,i+a.index+v+u),S=y.slice(i,-i);return{type:"del",raw:y,text:S,tokens:this.lexer.inlineTokens(S)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Jn=class wo{constructor(e){rt(this,"tokens");rt(this,"options");rt(this,"state");rt(this,"inlineQueue");rt(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||wa,this.options.tokenizer=this.options.tokenizer||new ci,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:pn,block:Vs.normal,inline:ts.normal};this.options.pedantic?(r.block=Vs.pedantic,r.inline=ts.pedantic):this.options.gfm&&(r.block=Vs.gfm,this.options.breaks?r.inline=ts.breaks:r.inline=ts.gfm),this.tokenizer.rules=r}static get rules(){return{block:Vs,inline:ts}}static lex(e,r){return new wo(r).lex(e)}static lexInline(e,r){return new wo(r).inlineTokens(e)}lex(e){e=e.replace(pn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(pn.tabCharGlobal,"    ").replace(pn.spaceLine,""));e;){let f;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(v=>(f=v.call({lexer:this},e,r))?(e=e.substring(f.raw.length),r.push(f),!0):!1))continue;if(f=this.tokenizer.space(e)){e=e.substring(f.raw.length);let v=r.at(-1);f.raw.length===1&&v!==void 0?v.raw+=`
`:r.push(f);continue}if(f=this.tokenizer.code(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.at(-1).src=v.text):r.push(f);continue}if(f=this.tokenizer.fences(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.heading(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.hr(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.blockquote(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.list(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.html(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.def(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.raw,this.inlineQueue.at(-1).src=v.text):this.tokens.links[f.tag]||(this.tokens.links[f.tag]={href:f.href,title:f.title},r.push(f));continue}if(f=this.tokenizer.table(e)){e=e.substring(f.raw.length),r.push(f);continue}if(f=this.tokenizer.lheading(e)){e=e.substring(f.raw.length),r.push(f);continue}let h=e;if((u=this.options.extensions)!=null&&u.startBlock){let v=1/0,y=e.slice(1),S;this.options.extensions.startBlock.forEach(x=>{S=x.call({lexer:this},y),typeof S=="number"&&S>=0&&(v=Math.min(v,S))}),v<1/0&&v>=0&&(h=e.substring(0,v+1))}if(this.state.top&&(f=this.tokenizer.paragraph(h))){let v=r.at(-1);a&&(v==null?void 0:v.type)==="paragraph"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(f),a=h.length!==e.length,e=e.substring(f.raw.length);continue}if(f=this.tokenizer.text(e)){e=e.substring(f.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+f.raw,v.text+=`
`+f.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(f);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var h,v,y,S,x;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((v=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:v.call({lexer:this},a))??a;let u=!1,f="";for(;e;){u||(f=""),u=!1;let k;if((S=(y=this.options.extensions)==null?void 0:y.inline)!=null&&S.some(E=>(k=E.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let E=r.at(-1);k.type==="text"&&(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,f)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,f)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let A=e;if((x=this.options.extensions)!=null&&x.startInline){let E=1/0,T=e.slice(1),W;this.options.extensions.startInline.forEach(ce=>{W=ce.call({lexer:this},T),typeof W=="number"&&W>=0&&(E=Math.min(E,W))}),E<1/0&&E>=0&&(A=e.substring(0,E+1))}if(k=this.tokenizer.inlineText(A)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(f=k.raw.slice(-1)),u=!0;let E=r.at(-1);(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(e){let E="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(E);break}else throw new Error(E)}}return r}},ui=class{constructor(t){rt(this,"options");rt(this,"parser");this.options=t||wa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(pn.notSpaceStart))==null?void 0:o[0],i=t.replace(pn.endingNewline,"")+`
`;return a?'<pre><code class="language-'+wr(a)+'">'+(r?i:wr(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:wr(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let f=t.items[u];a+=this.listitem(f)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${wr(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=ac(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+wr(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=ac(t);if(i===null)return wr(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${wr(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:wr(t.text)}},nl=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},$n=class ko{constructor(e){rt(this,"options");rt(this,"renderer");rt(this,"textRenderer");this.options=e||wa,this.options.renderer=this.options.renderer||new ui,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new nl}static parse(e,r){return new ko(r).parse(e)}static parseInline(e,r){return new ko(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let h=u,v=this.options.extensions.renderers[h.type].call({parser:this},h);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){r+=v||"";continue}}let f=u;switch(f.type){case"space":{r+=this.renderer.space(f);break}case"hr":{r+=this.renderer.hr(f);break}case"heading":{r+=this.renderer.heading(f);break}case"code":{r+=this.renderer.code(f);break}case"table":{r+=this.renderer.table(f);break}case"blockquote":{r+=this.renderer.blockquote(f);break}case"list":{r+=this.renderer.list(f);break}case"checkbox":{r+=this.renderer.checkbox(f);break}case"html":{r+=this.renderer.html(f);break}case"def":{r+=this.renderer.def(f);break}case"paragraph":{r+=this.renderer.paragraph(f);break}case"text":{r+=this.renderer.text(f);break}default:{let h='Token with "'+f.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let f=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[f.type]){let v=this.options.extensions.renderers[f.type].call({parser:this},f);if(v!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(f.type)){a+=v||"";continue}}let h=f;switch(h.type){case"escape":{a+=r.text(h);break}case"html":{a+=r.html(h);break}case"link":{a+=r.link(h);break}case"image":{a+=r.image(h);break}case"checkbox":{a+=r.checkbox(h);break}case"strong":{a+=r.strong(h);break}case"em":{a+=r.em(h);break}case"codespan":{a+=r.codespan(h);break}case"br":{a+=r.br(h);break}case"del":{a+=r.del(h);break}case"text":{a+=r.text(h);break}default:{let v='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return a}},Qs,cs=(Qs=class{constructor(t){rt(this,"options");rt(this,"block");this.options=t||wa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Jn.lex:Jn.lexInline}provideParser(){return this.block?$n.parse:$n.parseInline}},rt(Qs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),rt(Qs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Qs),Cm=class{constructor(...t){rt(this,"defaults",Yo());rt(this,"options",this.setOptions);rt(this,"parse",this.parseMarkdown(!0));rt(this,"parseInline",this.parseMarkdown(!1));rt(this,"Parser",$n);rt(this,"Renderer",ui);rt(this,"TextRenderer",nl);rt(this,"Lexer",Jn);rt(this,"Tokenizer",ci);rt(this,"Hooks",cs);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let f of u.header)r=r.concat(this.walkTokens(f.tokens,e));for(let f of u.rows)for(let h of f)r=r.concat(this.walkTokens(h.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(f=>{let h=u[f].flat(1/0);r=r.concat(this.walkTokens(h,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let f=i.renderer.apply(this,u);return f===!1&&(f=o.apply(this,u)),f}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ui(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,f=r.renderer[u],h=i[u];i[u]=(...v)=>{let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ci(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,f=r.tokenizer[u],h=i[u];i[u]=(...v)=>{let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new cs;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,f=r.hooks[u],h=i[u];cs.passThroughHooks.has(o)?i[u]=v=>{if(this.defaults.async&&cs.passThroughHooksRespectAsync.has(o))return(async()=>{let S=await f.call(i,v);return h.call(i,S)})();let y=f.call(i,v);return h.call(i,y)}:i[u]=(...v)=>{if(this.defaults.async)return(async()=>{let S=await f.apply(i,v);return S===!1&&(S=await h.apply(i,v)),S})();let y=f.apply(i,v);return y===!1&&(y=h.apply(i,v)),y}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let f=[];return f.push(o.call(this,u)),i&&(f=f.concat(i.call(this,u))),f}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Jn.lex(t,e??this.defaults)}parser(t,e){return $n.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,f=await(i.hooks?await i.hooks.provideLexer():t?Jn.lex:Jn.lexInline)(u,i),h=i.hooks?await i.hooks.processAllTokens(f):f;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let v=await(i.hooks?await i.hooks.provideParser():t?$n.parse:$n.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(v):v})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?Jn.lex:Jn.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let f=(i.hooks?i.hooks.provideParser():t?$n.parse:$n.parseInline)(u,i);return i.hooks&&(f=i.hooks.postprocess(f)),f}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+wr(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ya=new Cm;function _t(t,e){return ya.parse(t,e)}_t.options=_t.setOptions=function(t){return ya.setOptions(t),_t.defaults=ya.defaults,Ku(_t.defaults),_t};_t.getDefaults=Yo;_t.defaults=wa;_t.use=function(...t){return ya.use(...t),_t.defaults=ya.defaults,Ku(_t.defaults),_t};_t.walkTokens=function(t,e){return ya.walkTokens(t,e)};_t.parseInline=ya.parseInline;_t.Parser=$n;_t.parser=$n.parse;_t.Renderer=ui;_t.TextRenderer=nl;_t.Lexer=Jn;_t.lexer=Jn.lex;_t.Tokenizer=ci;_t.Hooks=cs;_t.parse=_t;_t.options;_t.setOptions;_t.use;_t.walkTokens;_t.parseInline;$n.parse;Jn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:ef,setPrototypeOf:oc,isFrozen:Pm,getPrototypeOf:Im,getOwnPropertyDescriptor:Rm}=Object;let{freeze:hn,seal:Wn,create:xo}=Object,{apply:So,construct:To}=typeof Reflect<"u"&&Reflect;hn||(hn=function(e){return e});Wn||(Wn=function(e){return e});So||(So=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});To||(To=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ys=mn(Array.prototype.forEach),Om=mn(Array.prototype.lastIndexOf),lc=mn(Array.prototype.pop),rs=mn(Array.prototype.push),Dm=mn(Array.prototype.splice),ni=mn(String.prototype.toLowerCase),Zi=mn(String.prototype.toString),Ji=mn(String.prototype.match),as=mn(String.prototype.replace),jm=mn(String.prototype.indexOf),Mm=mn(String.prototype.trim),Qn=mn(Object.prototype.hasOwnProperty),vn=mn(RegExp.prototype.test),ss=Lm(TypeError);function mn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return So(t,e,a)}}function Lm(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return To(t,r)}}function tt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ni;oc&&oc(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(Pm(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Nm(t){for(let e=0;e<t.length;e++)Qn(t,e)||(t[e]=null);return t}function fr(t){const e=xo(null);for(const[r,a]of ef(t))Qn(t,r)&&(Array.isArray(a)?e[r]=Nm(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=fr(a):e[r]=a);return e}function is(t,e){for(;t!==null;){const a=Rm(t,e);if(a){if(a.get)return mn(a.get);if(typeof a.value=="function")return mn(a.value)}t=Im(t)}function r(){return null}return r}const cc=hn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),$i=hn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),eo=hn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),qm=hn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),to=hn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Bm=hn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),uc=hn(["#text"]),fc=hn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),no=hn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),dc=hn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Xs=hn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zm=Wn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Fm=Wn(/<%[\w\W]*|[\w\W]*%>/gm),Km=Wn(/\$\{[\w\W]*/gm),Um=Wn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Gm=Wn(/^aria-[\-\w]+$/),tf=Wn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Hm=Wn(/^(?:\w+script|data):/i),Wm=Wn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),nf=Wn(/^html$/i),Vm=Wn(/^[a-z][.\w]*(-[.\w]+)+$/i);var vc=Object.freeze({__proto__:null,ARIA_ATTR:Gm,ATTR_WHITESPACE:Wm,CUSTOM_ELEMENT:Vm,DATA_ATTR:Um,DOCTYPE_NAME:nf,ERB_EXPR:Fm,IS_ALLOWED_URI:tf,IS_SCRIPT_OR_DATA:Hm,MUSTACHE_EXPR:zm,TMPLIT_EXPR:Km});const os={element:1,text:3,progressingInstruction:7,comment:8,document:9},Ym=function(){return typeof window>"u"?null:window},Xm=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},pc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function rf(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ym();const e=Ne=>rf(Ne);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==os.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:f,Element:h,NodeFilter:v,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:S,DOMParser:x,trustedTypes:k}=t,A=h.prototype,E=is(A,"cloneNode"),T=is(A,"remove"),W=is(A,"nextSibling"),ce=is(A,"childNodes"),te=is(A,"parentNode");if(typeof u=="function"){const Ne=r.createElement("template");Ne.content&&Ne.content.ownerDocument&&(r=Ne.content.ownerDocument)}let U,F="";const{implementation:X,createNodeIterator:V,createDocumentFragment:ve,getElementsByTagName:Ce}=r,{importNode:Pe}=a;let ie=pc();e.isSupported=typeof ef=="function"&&typeof te=="function"&&X&&X.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:oe,TMPLIT_EXPR:Ae,DATA_ATTR:re,ARIA_ATTR:de,IS_SCRIPT_OR_DATA:pe,ATTR_WHITESPACE:ee,CUSTOM_ELEMENT:fe}=vc;let{IS_ALLOWED_URI:me}=vc,be=null;const Z=tt({},[...cc,...$i,...eo,...to,...uc]);let ae=null;const Q=tt({},[...fc,...no,...dc,...Xs]);let le=Object.seal(xo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Be=null,We=null;const qe=Object.seal(xo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ue=!0,q=!0,ye=!1,xe=!0,De=!1,it=!0,ot=!1,dt=!1,Rt=!1,Ve=!1,Ye=!1,lt=!1,ct=!0,wt=!1;const Tt="user-content-";let Bt=!0,kt=!1,mt={},yt=null;const fn=tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rn=null;const gn=tt({},["audio","video","img","source","image","track"]);let an=null;const Ut=tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gt="http://www.w3.org/1998/Math/MathML",Tn="http://www.w3.org/2000/svg",It="http://www.w3.org/1999/xhtml";let je=It,Vn=!1,En=null;const _r=tt({},[Gt,Tn,It],Zi);let Ee=tt({},["mi","mo","mn","ms","mtext"]),sr=tt({},["annotation-xml"]);const ka=tt({},["title","style","font","a","script"]);let Yn=null;const xa=["application/xhtml+xml","text/html"],Yr="text/html";let Ot=null,Ze=null;const nt=r.createElement("form"),jt=function(C){return C instanceof RegExp||C instanceof Function},zt=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ze&&Ze===C)){if((!C||typeof C!="object")&&(C={}),C=fr(C),Yn=xa.indexOf(C.PARSER_MEDIA_TYPE)===-1?Yr:C.PARSER_MEDIA_TYPE,Ot=Yn==="application/xhtml+xml"?Zi:ni,be=Qn(C,"ALLOWED_TAGS")?tt({},C.ALLOWED_TAGS,Ot):Z,ae=Qn(C,"ALLOWED_ATTR")?tt({},C.ALLOWED_ATTR,Ot):Q,En=Qn(C,"ALLOWED_NAMESPACES")?tt({},C.ALLOWED_NAMESPACES,Zi):_r,an=Qn(C,"ADD_URI_SAFE_ATTR")?tt(fr(Ut),C.ADD_URI_SAFE_ATTR,Ot):Ut,rn=Qn(C,"ADD_DATA_URI_TAGS")?tt(fr(gn),C.ADD_DATA_URI_TAGS,Ot):gn,yt=Qn(C,"FORBID_CONTENTS")?tt({},C.FORBID_CONTENTS,Ot):fn,Be=Qn(C,"FORBID_TAGS")?tt({},C.FORBID_TAGS,Ot):fr({}),We=Qn(C,"FORBID_ATTR")?tt({},C.FORBID_ATTR,Ot):fr({}),mt=Qn(C,"USE_PROFILES")?C.USE_PROFILES:!1,Ue=C.ALLOW_ARIA_ATTR!==!1,q=C.ALLOW_DATA_ATTR!==!1,ye=C.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=C.SAFE_FOR_TEMPLATES||!1,it=C.SAFE_FOR_XML!==!1,ot=C.WHOLE_DOCUMENT||!1,Ve=C.RETURN_DOM||!1,Ye=C.RETURN_DOM_FRAGMENT||!1,lt=C.RETURN_TRUSTED_TYPE||!1,Rt=C.FORCE_BODY||!1,ct=C.SANITIZE_DOM!==!1,wt=C.SANITIZE_NAMED_PROPS||!1,Bt=C.KEEP_CONTENT!==!1,kt=C.IN_PLACE||!1,me=C.ALLOWED_URI_REGEXP||tf,je=C.NAMESPACE||It,Ee=C.MATHML_TEXT_INTEGRATION_POINTS||Ee,sr=C.HTML_INTEGRATION_POINTS||sr,le=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&jt(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&jt(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(q=!1),Ye&&(Ve=!0),mt&&(be=tt({},uc),ae=[],mt.html===!0&&(tt(be,cc),tt(ae,fc)),mt.svg===!0&&(tt(be,$i),tt(ae,no),tt(ae,Xs)),mt.svgFilters===!0&&(tt(be,eo),tt(ae,no),tt(ae,Xs)),mt.mathMl===!0&&(tt(be,to),tt(ae,dc),tt(ae,Xs))),C.ADD_TAGS&&(typeof C.ADD_TAGS=="function"?qe.tagCheck=C.ADD_TAGS:(be===Z&&(be=fr(be)),tt(be,C.ADD_TAGS,Ot))),C.ADD_ATTR&&(typeof C.ADD_ATTR=="function"?qe.attributeCheck=C.ADD_ATTR:(ae===Q&&(ae=fr(ae)),tt(ae,C.ADD_ATTR,Ot))),C.ADD_URI_SAFE_ATTR&&tt(an,C.ADD_URI_SAFE_ATTR,Ot),C.FORBID_CONTENTS&&(yt===fn&&(yt=fr(yt)),tt(yt,C.FORBID_CONTENTS,Ot)),C.ADD_FORBID_CONTENTS&&(yt===fn&&(yt=fr(yt)),tt(yt,C.ADD_FORBID_CONTENTS,Ot)),Bt&&(be["#text"]=!0),ot&&tt(be,["html","head","body"]),be.table&&(tt(be,["tbody"]),delete Be.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw ss('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ss('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=C.TRUSTED_TYPES_POLICY,F=U.createHTML("")}else U===void 0&&(U=Xm(k,i)),U!==null&&typeof F=="string"&&(F=U.createHTML(""));hn&&hn(C),Ze=C}},An=tt({},[...$i,...eo,...qm]),gt=tt({},[...to,...Bm]),Ge=function(C){let _e=te(C);(!_e||!_e.tagName)&&(_e={namespaceURI:je,tagName:"template"});const ke=ni(C.tagName),Fe=ni(_e.tagName);return En[C.namespaceURI]?C.namespaceURI===Tn?_e.namespaceURI===It?ke==="svg":_e.namespaceURI===Gt?ke==="svg"&&(Fe==="annotation-xml"||Ee[Fe]):!!An[ke]:C.namespaceURI===Gt?_e.namespaceURI===It?ke==="math":_e.namespaceURI===Tn?ke==="math"&&sr[Fe]:!!gt[ke]:C.namespaceURI===It?_e.namespaceURI===Tn&&!sr[Fe]||_e.namespaceURI===Gt&&!Ee[Fe]?!1:!gt[ke]&&(ka[ke]||!An[ke]):!!(Yn==="application/xhtml+xml"&&En[C.namespaceURI]):!1},Ft=function(C){rs(e.removed,{element:C});try{te(C).removeChild(C)}catch{T(C)}},dn=function(C,_e){try{rs(e.removed,{attribute:_e.getAttributeNode(C),from:_e})}catch{rs(e.removed,{attribute:null,from:_e})}if(_e.removeAttribute(C),C==="is")if(Ve||Ye)try{Ft(_e)}catch{}else try{_e.setAttribute(C,"")}catch{}},ir=function(C){let _e=null,ke=null;if(Rt)C="<remove></remove>"+C;else{const vt=Ji(C,/^[\r\n\t ]+/);ke=vt&&vt[0]}Yn==="application/xhtml+xml"&&je===It&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const Fe=U?U.createHTML(C):C;if(je===It)try{_e=new x().parseFromString(Fe,Yn)}catch{}if(!_e||!_e.documentElement){_e=X.createDocument(je,"template",null);try{_e.documentElement.innerHTML=Vn?F:Fe}catch{}}const He=_e.body||_e.documentElement;return C&&ke&&He.insertBefore(r.createTextNode(ke),He.childNodes[0]||null),je===It?Ce.call(_e,ot?"html":"body")[0]:ot?_e.documentElement:He},or=function(C){return V.call(C.ownerDocument||C,C,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},Xr=function(C){return C instanceof S&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof y)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Cn=function(C){return typeof f=="function"&&C instanceof f};function Ht(Ne,C,_e){Ys(Ne,ke=>{ke.call(e,C,_e,Ze)})}const Pn=function(C){let _e=null;if(Ht(ie.beforeSanitizeElements,C,null),Xr(C))return Ft(C),!0;const ke=Ot(C.nodeName);if(Ht(ie.uponSanitizeElement,C,{tagName:ke,allowedTags:be}),it&&C.hasChildNodes()&&!Cn(C.firstElementChild)&&vn(/<[/\w!]/g,C.innerHTML)&&vn(/<[/\w!]/g,C.textContent)||C.nodeType===os.progressingInstruction||it&&C.nodeType===os.comment&&vn(/<[/\w]/g,C.data))return Ft(C),!0;if(!(qe.tagCheck instanceof Function&&qe.tagCheck(ke))&&(!be[ke]||Be[ke])){if(!Be[ke]&&Qr(ke)&&(le.tagNameCheck instanceof RegExp&&vn(le.tagNameCheck,ke)||le.tagNameCheck instanceof Function&&le.tagNameCheck(ke)))return!1;if(Bt&&!yt[ke]){const Fe=te(C)||C.parentNode,He=ce(C)||C.childNodes;if(He&&Fe){const vt=He.length;for(let xt=vt-1;xt>=0;--xt){const sn=E(He[xt],!0);sn.__removalCount=(C.__removalCount||0)+1,Fe.insertBefore(sn,W(C))}}}return Ft(C),!0}return C instanceof h&&!Ge(C)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&vn(/<\/no(script|embed|frames)/i,C.innerHTML)?(Ft(C),!0):(De&&C.nodeType===os.text&&(_e=C.textContent,Ys([J,oe,Ae],Fe=>{_e=as(_e,Fe," ")}),C.textContent!==_e&&(rs(e.removed,{element:C.cloneNode()}),C.textContent=_e)),Ht(ie.afterSanitizeElements,C,null),!1)},yr=function(C,_e,ke){if(ct&&(_e==="id"||_e==="name")&&(ke in r||ke in nt))return!1;if(!(q&&!We[_e]&&vn(re,_e))){if(!(Ue&&vn(de,_e))){if(!(qe.attributeCheck instanceof Function&&qe.attributeCheck(_e,C))){if(!ae[_e]||We[_e]){if(!(Qr(C)&&(le.tagNameCheck instanceof RegExp&&vn(le.tagNameCheck,C)||le.tagNameCheck instanceof Function&&le.tagNameCheck(C))&&(le.attributeNameCheck instanceof RegExp&&vn(le.attributeNameCheck,_e)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(_e,C))||_e==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&vn(le.tagNameCheck,ke)||le.tagNameCheck instanceof Function&&le.tagNameCheck(ke))))return!1}else if(!an[_e]){if(!vn(me,as(ke,ee,""))){if(!((_e==="src"||_e==="xlink:href"||_e==="href")&&C!=="script"&&jm(ke,"data:")===0&&rn[C])){if(!(ye&&!vn(pe,as(ke,ee,"")))){if(ke)return!1}}}}}}}return!0},Qr=function(C){return C!=="annotation-xml"&&Ji(C,fe)},_n=function(C){Ht(ie.beforeSanitizeAttributes,C,null);const{attributes:_e}=C;if(!_e||Xr(C))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ae,forceKeepAttr:void 0};let Fe=_e.length;for(;Fe--;){const He=_e[Fe],{name:vt,namespaceURI:xt,value:sn}=He,In=Ot(vt),lr=sn;let St=vt==="value"?lr:Mm(lr);if(ke.attrName=In,ke.attrValue=St,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Ht(ie.uponSanitizeAttribute,C,ke),St=ke.attrValue,wt&&(In==="id"||In==="name")&&(dn(vt,C),St=Tt+St),it&&vn(/((--!?|])>)|<\/(style|title|textarea)/i,St)){dn(vt,C);continue}if(In==="attributename"&&Ji(St,"href")){dn(vt,C);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){dn(vt,C);continue}if(!xe&&vn(/\/>/i,St)){dn(vt,C);continue}De&&Ys([J,oe,Ae],Xt=>{St=as(St,Xt," ")});const Zr=Ot(C.nodeName);if(!yr(Zr,In,St)){dn(vt,C);continue}if(U&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!xt)switch(k.getAttributeType(Zr,In)){case"TrustedHTML":{St=U.createHTML(St);break}case"TrustedScriptURL":{St=U.createScriptURL(St);break}}if(St!==lr)try{xt?C.setAttributeNS(xt,vt,St):C.setAttribute(vt,St),Xr(C)?Ft(C):lc(e.removed)}catch{dn(vt,C)}}Ht(ie.afterSanitizeAttributes,C,null)},Sa=function Ne(C){let _e=null;const ke=or(C);for(Ht(ie.beforeSanitizeShadowDOM,C,null);_e=ke.nextNode();)Ht(ie.uponSanitizeShadowNode,_e,null),Pn(_e),_n(_e),_e.content instanceof o&&Ne(_e.content);Ht(ie.afterSanitizeShadowDOM,C,null)};return e.sanitize=function(Ne){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_e=null,ke=null,Fe=null,He=null;if(Vn=!Ne,Vn&&(Ne="<!-->"),typeof Ne!="string"&&!Cn(Ne))if(typeof Ne.toString=="function"){if(Ne=Ne.toString(),typeof Ne!="string")throw ss("dirty is not a string, aborting")}else throw ss("toString is not a function");if(!e.isSupported)return Ne;if(dt||zt(C),e.removed=[],typeof Ne=="string"&&(kt=!1),kt){if(Ne.nodeName){const sn=Ot(Ne.nodeName);if(!be[sn]||Be[sn])throw ss("root node is forbidden and cannot be sanitized in-place")}}else if(Ne instanceof f)_e=ir("<!---->"),ke=_e.ownerDocument.importNode(Ne,!0),ke.nodeType===os.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?_e=ke:_e.appendChild(ke);else{if(!Ve&&!De&&!ot&&Ne.indexOf("<")===-1)return U&&lt?U.createHTML(Ne):Ne;if(_e=ir(Ne),!_e)return Ve?null:lt?F:""}_e&&Rt&&Ft(_e.firstChild);const vt=or(kt?Ne:_e);for(;Fe=vt.nextNode();)Pn(Fe),_n(Fe),Fe.content instanceof o&&Sa(Fe.content);if(kt)return Ne;if(Ve){if(Ye)for(He=ve.call(_e.ownerDocument);_e.firstChild;)He.appendChild(_e.firstChild);else He=_e;return(ae.shadowroot||ae.shadowrootmode)&&(He=Pe.call(a,He,!0)),He}let xt=ot?_e.outerHTML:_e.innerHTML;return ot&&be["!doctype"]&&_e.ownerDocument&&_e.ownerDocument.doctype&&_e.ownerDocument.doctype.name&&vn(nf,_e.ownerDocument.doctype.name)&&(xt="<!DOCTYPE "+_e.ownerDocument.doctype.name+`>
`+xt),De&&Ys([J,oe,Ae],sn=>{xt=as(xt,sn," ")}),U&&lt?U.createHTML(xt):xt},e.setConfig=function(){let Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zt(Ne),dt=!0},e.clearConfig=function(){Ze=null,dt=!1},e.isValidAttribute=function(Ne,C,_e){Ze||zt({});const ke=Ot(Ne),Fe=Ot(C);return yr(ke,Fe,_e)},e.addHook=function(Ne,C){typeof C=="function"&&rs(ie[Ne],C)},e.removeHook=function(Ne,C){if(C!==void 0){const _e=Om(ie[Ne],C);return _e===-1?void 0:Dm(ie[Ne],_e,1)[0]}return lc(ie[Ne])},e.removeHooks=function(Ne){ie[Ne]=[]},e.removeAllHooks=function(){ie=pc()},e}var Qm=rf();function Zm(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${hc(t.from)} |`),e.push(`| **To** | ${hc(t.to)} |`),e.push(`| **Date** | ${Go(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Jm(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function hc(t){return(t||"").replace(/\|/g,"\\|")}function Jm(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return Eo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function $m(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function Eo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return $m(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(Eo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>Eo(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,f="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${f}
`}return r}function eg(t){return Au(t,"md")}function mc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function tg(t){return t.raw||null}function ng(t){const e=tg(t);return e?JSON.stringify(e,null,2):"null"}function rg(t){return Au(t,"json")}var ag=B('<button title="View as Markdown">.md</button>'),sg=B('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),ig=B('<pre class="md-raw svelte-1b0rzpb"> </pre>'),og=B('<div class="md-preview svelte-1b0rzpb"><!></div>'),lg=B('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),cg=B('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),ug=B('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),fg=B('<pre class="message-text svelte-1b0rzpb"> </pre>'),dg=B('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),vg=B('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),pg=B('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function hg(t,e){Ct(e,!0);let r=Oe(e,"loading",3,!1);nn(()=>Nn("MessageModal"));const a=new _t.Renderer;a.link=({href:J,title:oe,text:Ae})=>{const re=oe?` title="${oe}"`:"";return`<a href="${J}"${re} target="_blank" rel="noopener">${Ae}</a>`},_t.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Re("email"),o=At(()=>e.message.body?Zm(e.message):""),u=At(()=>ng(e.message)),f=Re("raw");function h(J){M(i,g(i)===J?"email":J,!0),J==="markdown"&&M(f,"raw")}function v(){mc(g(o),eg(e.message))}function y(){mc(g(u),rg(e.message),"application/json;charset=utf-8")}function S(J){const oe=_t.parse(J);return Qm.sanitize(oe,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let x=Re(null);ai(()=>{var J;if(g(x)&&e.message.htmlBody&&!r()&&g(i)==="email"){const oe=g(x).contentDocument||((J=g(x).contentWindow)==null?void 0:J.document);oe&&(oe.open(),oe.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),oe.close())}});var k=pg();k.__click=function(...J){var oe;(oe=e.onclose)==null||oe.apply(this,J)};var A=m(k);A.__click=J=>J.stopPropagation();var E=m(A),T=m(E),W=m(T),ce=b(T,2),te=m(ce);let U;te.__click=()=>h("json");var F=b(te,2);{var X=J=>{var oe=ag();let Ae;oe.__click=()=>h("markdown"),$(()=>Ae=Nt(oe,1,"action-btn svelte-1b0rzpb",null,Ae,{active:g(i)==="markdown"})),L(J,oe)};ue(F,J=>{e.message.body&&J(X)})}var V=b(F,2);V.__click=function(...J){var oe;(oe=e.onclose)==null||oe.apply(this,J)};var ve=b(E,2);{var Ce=J=>{var oe=sg(),Ae=Qe(oe),re=b(m(Ae),2);re.__click=y;var de=b(Ae,2),pe=m(de),ee=m(pe);$(()=>H(ee,g(u))),L(J,oe)},Pe=J=>{var oe=lg(),Ae=Qe(oe),re=m(Ae),de=m(re);let pe;de.__click=()=>M(f,"raw");var ee=b(de,2);let fe;ee.__click=()=>M(f,"preview");var me=b(re,2);me.__click=v;var be=b(Ae,2),Z=m(be);{var ae=le=>{var Be=ig(),We=m(Be);$(()=>H(We,g(o))),L(le,Be)},Q=le=>{var Be=og(),We=m(Be);Xd(We,()=>S(g(o))),L(le,Be)};ue(Z,le=>{g(f)==="raw"?le(ae):le(Q,!1)})}$(()=>{pe=Nt(de,1,"md-tab svelte-1b0rzpb",null,pe,{active:g(f)==="raw"}),fe=Nt(ee,1,"md-tab svelte-1b0rzpb",null,fe,{active:g(f)==="preview"})}),L(J,oe)},ie=J=>{var oe=vg(),Ae=Qe(oe),re=m(Ae),de=b(m(re),2),pe=m(de),ee=b(re,2),fe=b(m(ee),2),me=m(fe),be=b(ee,2),Z=b(m(be),2),ae=m(Z),Q=b(Ae,2),le=m(Q);{var Be=q=>{var ye=cg();L(q,ye)},We=q=>{var ye=ug();gu(ye,xe=>M(x,xe),()=>g(x)),L(q,ye)},qe=q=>{var ye=fg(),xe=m(ye);$(()=>H(xe,e.message.body)),L(q,ye)},Ue=q=>{var ye=dg();L(q,ye)};ue(le,q=>{r()?q(Be):e.message.htmlBody?q(We,1):e.message.body?q(qe,2):q(Ue,!1)})}$(q=>{H(pe,e.message.from),H(me,e.message.to),H(ae,q)},[()=>Go(e.message.date)]),L(J,oe)};ue(ve,J=>{g(i)==="json"?J(Ce):g(i)==="markdown"?J(Pe,1):J(ie,!1)})}$(()=>{H(W,e.message.subject),U=Nt(te,1,"action-btn svelte-1b0rzpb",null,U,{active:g(i)==="json"})}),L(t,k),Pt()}Kt(["click"]);var mg=B('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),gg=B('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),_g=B('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),yg=B("<p> </p>"),bg=B('<p>No emails in local storage. Click "Sync New" to download.</p>'),wg=B('<div class="empty-state svelte-6ts5xm"><!></div>'),kg=B('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),xg=B('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function Sg(t,e){Ct(e,!0),nn(()=>Nn("DashboardView"));let r=Oe(e,"error",3,null),a=Oe(e,"profile",3,null),i=Oe(e,"loadingProfile",3,!1),o=Oe(e,"emailMessages",19,()=>[]),u=Oe(e,"totalLocalMessages",3,0),f=Oe(e,"hasMoreLocal",3,!1),h=Oe(e,"loadingMessages",3,!1),v=Oe(e,"selectedMessage",3,null),y=Oe(e,"syncStatus",3,null),S=Oe(e,"syncProgress",3,null),x=Oe(e,"isSyncing",3,!1),k=Oe(e,"searchQuery",15);var A=xg(),E=Qe(A),T=m(E);{var W=re=>{Fu(re,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};ue(T,re=>{r()&&re(W)})}var ce=b(T,2);xh(ce,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var te=b(ce,2);Lh(te,{get syncStatus(){return y()},get syncProgress(){return S()},get isSyncing(){return x()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var U=b(te,2),F=m(U);F.__keydown=re=>re.key==="Enter"&&e.onsearch();var X=b(F,2);X.__click=function(...re){var de;(de=e.onsearch)==null||de.apply(this,re)};var V=m(X),ve=b(U,2);{var Ce=re=>{var de=gg(),pe=Qe(de),ee=m(pe),fe=m(ee),me=b(pe,2);Bh(me,{get messages(){return o()},get onselect(){return e.onviewmessage}});var be=b(me,2);{var Z=ae=>{var Q=mg(),le=m(Q);le.__click=function(...We){var qe;(qe=e.onloadmore)==null||qe.apply(this,We)};var Be=m(le);$(()=>{le.disabled=h(),H(Be,h()?"Loading...":"Load More")}),L(ae,Q)};ue(be,ae=>{f()&&ae(Z)})}$(ae=>H(fe,`Showing ${o().length??""} of ${ae??""}
        ${k()?" matching":""} emails`),[()=>u().toLocaleString()]),L(re,de)},Pe=re=>{var de=_g();L(re,de)},ie=re=>{var de=wg(),pe=m(de);{var ee=me=>{var be=yg(),Z=m(be);$(()=>H(Z,`No emails match "${k()??""}".`)),L(me,be)},fe=me=>{var be=bg();L(me,be)};ue(pe,me=>{k()?me(ee):me(fe,!1)})}L(re,de)},J=re=>{var de=kg();L(re,de)};ue(ve,re=>{var de;o().length>0?re(Ce):h()?re(Pe,1):(de=y())!=null&&de.synced?re(ie,2):re(J,!1)})}var oe=b(E,2);{var Ae=re=>{hg(re,{get message(){return v()},loading:!1,get onclose(){return e.onclosedetail}})};ue(oe,re=>{v()&&re(Ae)})}$(()=>{X.disabled=h(),H(V,h()?"Searching...":"Search")}),Fo(F,k),L(t,A),Pt()}Kt(["keydown","click"]);var Tg=B('<div class="dashboard svelte-1q5o2lv"><!></div>');function Eg(t,e){Ct(e,!0);function r(q){q.key==="Escape"&&g(S)&&me()}let a=null;nn(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const q=Qp();if(q<=0)return;const ye=Math.max(0,q-120*1e3);a=setTimeout(async()=>{try{const xe=await Jl();M(v,xe.access_token,!0),i()}catch{M(v,null),M(y,null),M(te,"Session expired. Please sign in again.")}},ye)}async function o(){if(Xp())return g(v);try{const q=await Jl();return M(v,q.access_token,!0),i(),g(v)}catch{return M(v,null),M(y,null),M(te,"Session expired. Please sign in again."),null}}let u=Re(Jt(localStorage.getItem("googleClientId")||"")),f=Re(Jt(localStorage.getItem("googleClientId")||"")),h=Re(!1),v=Re(null),y=Re(null),S=Re(null),x=Re(""),k=Re(Jt([])),A=Re(0),E=Re(0),T=Re(!1),W=Re(!1),ce=Re(!1),te=Re(null),U=Re(null),F=Re(null),X=Re(!1);const V=50;ai(()=>{g(v)&&(be(),de())});let ve=At(()=>!g(u)),Ce=At(()=>!!g(v)),Pe=At(()=>g(k).length<g(A));ai(()=>{g(u)&&!g(h)&&$l(g(u)).then(()=>{if(M(h,!0),!g(v)){const q=Yp();q&&(M(v,q.access_token,!0),i(),re())}}).catch(q=>{M(te,`Auth init failed: ${q.message}`)})});function ie(){const q=g(f).trim();q&&(localStorage.setItem("googleClientId",q),M(u,q,!0),M(te,null))}function J(){localStorage.removeItem("googleClientId"),M(u,""),M(f,""),M(h,!1),M(v,null),M(y,null),M(k,[],!0),M(A,0)}async function oe(){M(te,null),M(W,!0);try{g(h)||(await $l(g(u)),M(h,!0));const q=await Jp();M(v,q.access_token,!0),i(),await re()}catch(q){M(te,q.message,!0)}finally{M(W,!1)}}async function Ae(){if(a&&clearTimeout(a),g(v))try{await $p(g(v))}catch{}M(v,null),M(y,null),M(k,[],!0),M(A,0),M(S,null),M(te,null)}async function re(){M(ce,!0);try{const q=await ku(g(v));if(!g(v))return;M(y,q,!0)}catch(q){if(!g(v))return;M(te,`Profile fetch failed: ${q.message}`)}finally{M(ce,!1)}}async function de(q=!1){M(T,!0);try{const ye=q?g(E):0,xe=await Tv({query:g(x)||void 0,limit:V,offset:ye});q?M(k,[...g(k),...xe.items],!0):M(k,xe.items,!0),M(A,xe.total,!0),M(E,g(k).length,!0)}catch(ye){M(te,`Failed to load messages: ${ye.message}`)}finally{M(T,!1)}}function pe(){M(E,0),de(!1)}function ee(){de(!0)}function fe(q){M(S,q,!0)}function me(){M(S,null)}async function be(){try{M(U,await nh(),!0)}catch{}}async function Z(q){if(g(X)||!g(v))return;const ye=await o();if(!ye)return;M(te,null),M(X,!0),M(F,null);const xe=new AbortController;try{await eh(ye,{limit:q,onProgress:De=>{M(F,{...De},!0)},signal:xe.signal}),await be(),await de(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;M(te,`Sync failed: ${De.message}`)}}finally{M(X,!1)}}async function ae(q){if(g(X)||!g(v))return;const ye=await o();if(!ye)return;M(te,null),M(X,!0),M(F,null);const xe=new AbortController;try{await th(ye,{limit:q,onProgress:De=>{M(F,{...De},!0)},signal:xe.signal}),await be(),await de(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;M(te,`Sync more failed: ${De.message}`)}}finally{M(X,!1)}}async function Q(){try{await Nu(),await be(),M(k,[],!0),M(A,0),M(E,0)}catch(q){M(te,`Failed to clear data: ${q.message}`)}}var le=Tg(),Be=m(le);{var We=q=>{lh(q,{onsave:ie,get clientIdInput(){return g(f)},set clientIdInput(ye){M(f,ye,!0)}})},qe=q=>{yh(q,{get clientId(){return g(u)},get error(){return g(te)},get loadingAuth(){return g(W)},onsignin:oe,onclear:J,onsignout:Ae})},Ue=q=>{Sg(q,{get error(){return g(te)},get profile(){return g(y)},get loadingProfile(){return g(ce)},get emailMessages(){return g(k)},get totalLocalMessages(){return g(A)},get hasMoreLocal(){return g(Pe)},get loadingMessages(){return g(T)},get selectedMessage(){return g(S)},get syncStatus(){return g(U)},get syncProgress(){return g(F)},get isSyncing(){return g(X)},onsignout:Ae,onsearch:pe,onloadmore:ee,onviewmessage:fe,onclosedetail:me,ondismisserror:()=>M(te,null),onsync:Z,onsyncmore:ae,oncleardata:Q,get searchQuery(){return g(x)},set searchQuery(ye){M(x,ye,!0)}})};ue(Be,q=>{g(ve)?q(We):g(Ce)?q(Ue,!1):q(qe,1)})}L(t,le),Pt()}var Ag=B('<span class="sep svelte-t1ig66">Â·</span> ',1),Cg=B('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),Pg=B('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),Ig=B('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),Rg=B('<span class="result-summary svelte-t1ig66"> </span>'),Og=B('<span class="result-tag svelte-t1ig66"> </span>'),Dg=B('<div class="result-tags svelte-t1ig66"></div>'),jg=B('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),Mg=B('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),Lg=B('<div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">already classified</span></div>'),Ng=B('<div class="summary-stat svelte-t1ig66"><span class="sstat-val warn svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">too long</span></div>'),qg=B('<div class="summary-stat svelte-t1ig66"><span class="sstat-val err svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">errors</span></div>'),Bg=B('<span class="ssec-item svelte-t1ig66">Avg speed: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span>',1),zg=B('<span class="ri-action svelte-t1ig66"> </span>'),Fg=B('<span class="ri-skipped svelte-t1ig66">SKIPPED</span>'),Kg=B('<span class="ri-error svelte-t1ig66">ERROR</span>'),Ug=B('<span class="sep svelte-t1ig66">Â·</span> ',1),Gg=B('<div class="ri-summary svelte-t1ig66"> </div>'),Hg=B('<span class="sep svelte-t1ig66">Â·</span> ',1),Wg=B('<!> <div class="ri-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <!></div>',1),Vg=B('<details class="ri-err-details svelte-t1ig66"><summary class="ri-err-summary svelte-t1ig66">View error details</summary> <div class="ri-err-msg svelte-t1ig66"> </div></details>'),Yg=B('<div><div class="ri-head svelte-t1ig66"><span class="ri-subj svelte-t1ig66"> </span> <!></div> <div class="ri-meta svelte-t1ig66"> <!></div> <!></div>'),Xg=B('<details class="results-details svelte-t1ig66"><summary class="results-summary svelte-t1ig66"> </summary> <div class="results-list svelte-t1ig66"></div></details>'),Qg=B('<div class="summary-card svelte-t1ig66"><div class="summary-head svelte-t1ig66"><span class="summary-title svelte-t1ig66">Scan Summary</span></div> <div class="summary-grid svelte-t1ig66"><div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">emails processed</span></div> <!> <div class="summary-stat svelte-t1ig66"><span class="sstat-val success svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">classified</span></div> <!> <!></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">LLM Performance</div> <div class="ssec-items svelte-t1ig66"><!> <span class="ssec-item svelte-t1ig66">Total tokens: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Duration: <strong class="svelte-t1ig66"> </strong></span></div></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">Model & Prompts</div> <div class="ssec-items svelte-t1ig66"><span class="ssec-item svelte-t1ig66">Model: <strong class="svelte-t1ig66"> </strong> </span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">System prompt: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Avg email: <strong class="svelte-t1ig66"> </strong></span></div></div> <!></div>'),Zg=B('<span class="err svelte-t1ig66"> </span>'),Jg=B('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),$g=B('<button class="action-btn svelte-t1ig66">View Prompt Config</button>'),e_=B('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),t_=B('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),n_=B('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),r_=B('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),a_=B('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),s_=B('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function i_(t,e){Ct(e,!0);let r=Oe(e,"progress",3,null),a=Re(!1),i=Re("system");function o(E){return!E||E<0?"â":E<1e3?`${Math.round(E)}ms`:`${(E/1e3).toFixed(1)}s`}function u(E){return E?E>=1e3?`${(E/1e3).toFixed(1)}k`:String(E):"0"}function f(E){if(!E)return"â";const T=E.replace(/<.*>/,"").trim();return T.length>30?T.slice(0,28)+"â¦":T}function h(E){if(!E)return"";try{return new Date(E).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(E){var ce;if(!((ce=E==null?void 0:E.totals)!=null&&ce.elapsed)||!(E!=null&&E.current)||E.current<2)return null;const T=E.totals.elapsed/E.current;return(E.total-E.current)*T}let y=At(()=>{var E;return(E=r())!=null&&E.total?Math.round(r().current/r().total*100):0}),S=At(()=>v(r()));var x=Pr(),k=Qe(x);{var A=E=>{var T=s_(),W=Qe(T),ce=m(W),te=m(ce),U=m(te);{var F=qe=>{var Ue=si("Scan complete");L(qe,Ue)},X=qe=>{var Ue=si();$(()=>H(Ue,`Processing ${r().current??""} of ${r().total??""}`)),L(qe,Ue)};ue(U,qe=>{r().phase==="done"?qe(F):qe(X,!1)})}var V=b(te,2),ve=m(V),Ce=b(ce,2),Pe=m(Ce);let ie,J;var oe=b(Ce,2);{var Ae=qe=>{var Ue=Cg(),q=m(Ue),ye=m(q),xe=b(q,2),De=m(xe),it=b(De);{var ot=dt=>{var Rt=Ag(),Ve=b(Qe(Rt),1,!0);$(Ye=>H(Ve,Ye),[()=>h(r().email.date)]),L(dt,Rt)};ue(it,dt=>{r().email.date&&dt(ot)})}$(dt=>{H(ye,r().email.subject||"(no subject)"),H(De,`${dt??""} `)},[()=>f(r().email.from)]),L(qe,Ue)};ue(oe,qe=>{r().email&&r().phase!=="done"&&qe(Ae)})}var re=b(oe,2);{var de=qe=>{var Ue=Ig(),q=m(Ue),ye=m(q),xe=m(ye),De=b(q,2),it=m(De),ot=m(it),dt=b(De,2);{var Rt=Ve=>{var Ye=Pg(),lt=m(Ye),ct=m(lt);$(wt=>H(ct,`~${wt??""}`),[()=>o(g(S))]),L(Ve,Ye)};ue(dt,Ve=>{g(S)&&Ve(Rt)})}$(Ve=>{H(xe,Ve),H(ot,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),L(qe,Ue)};ue(re,qe=>{r().live&&r().phase==="generating"&&qe(de)})}var pe=b(re,2);{var ee=qe=>{var Ue=Mg(),q=m(Ue),ye=m(q),xe=b(q,2);{var De=Ve=>{var Ye=Rg(),lt=m(Ye);$(()=>H(lt,r().result.summary)),L(Ve,Ye)};ue(xe,Ve=>{r().result.summary&&Ve(De)})}var it=b(xe,2);{var ot=Ve=>{var Ye=Dg();un(Ye,21,()=>r().result.tags,rr,(lt,ct)=>{var wt=Og(),Tt=m(wt);$(()=>H(Tt,g(ct))),L(lt,wt)}),L(Ve,Ye)};ue(it,Ve=>{var Ye;(Ye=r().result.tags)!=null&&Ye.length&&Ve(ot)})}var dt=b(it,2);{var Rt=Ve=>{var Ye=jg(),lt=m(Ye),ct=b(lt,2),wt=b(ct,2);$((Tt,Bt)=>{H(lt,`${Tt??""} `),H(ct,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),H(wt,` ${Bt??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),L(Ve,Ye)};ue(dt,Ve=>{r().emailStats&&Ve(Rt)})}$(()=>H(ye,r().result.action)),L(qe,Ue)};ue(pe,qe=>{r().result&&qe(ee)})}var fe=b(pe,2);{var me=qe=>{var Ue=Qg(),q=b(m(Ue),2),ye=m(q),xe=m(ye),De=m(xe),it=b(ye,2);{var ot=Ze=>{var nt=Lg(),jt=m(nt),zt=m(jt);$(()=>H(zt,r().summary.skipped)),L(Ze,nt)};ue(it,Ze=>{var nt;(nt=r().summary)!=null&&nt.skipped&&Ze(ot)})}var dt=b(it,2),Rt=m(dt),Ve=m(Rt),Ye=b(dt,2);{var lt=Ze=>{var nt=Ng(),jt=m(nt),zt=m(jt);$(()=>H(zt,r().summary.skippedLong)),L(Ze,nt)};ue(Ye,Ze=>{var nt;((nt=r().summary)==null?void 0:nt.skippedLong)>0&&Ze(lt)})}var ct=b(Ye,2);{var wt=Ze=>{var nt=qg(),jt=m(nt),zt=m(jt);$(()=>H(zt,r().errors)),L(Ze,nt)};ue(ct,Ze=>{r().errors>0&&Ze(wt)})}var Tt=b(q,2),Bt=b(m(Tt),2),kt=m(Bt);{var mt=Ze=>{var nt=Bg(),jt=Qe(nt),zt=b(m(jt)),An=m(zt);$(()=>H(An,`${r().summary.avgTps??""} tok/s`)),L(Ze,nt)};ue(kt,Ze=>{var nt;(nt=r().summary)!=null&&nt.avgTps&&Ze(mt)})}var yt=b(kt,2),fn=b(m(yt)),rn=m(fn),gn=b(yt,4),an=b(m(gn)),Ut=m(an),Gt=b(Tt,2),Tn=b(m(Gt),2),It=m(Tn),je=b(m(It)),Vn=m(je),En=b(je),_r=b(It,4),Ee=b(m(_r)),sr=m(Ee),ka=b(_r,4),Yn=b(m(ka)),xa=m(Yn),Yr=b(Gt,2);{var Ot=Ze=>{var nt=Xg(),jt=m(nt),zt=m(jt),An=b(jt,2);un(An,21,()=>r().results,rr,(gt,Ge)=>{var Ft=Yg();let dn;var ir=m(Ft),or=m(ir),Xr=m(or),Cn=b(or,2);{var Ht=Fe=>{var He=zg(),vt=m(He);$(()=>H(vt,g(Ge).classification.action)),L(Fe,He)},Pn=Fe=>{var He=Fg();L(Fe,He)},yr=Fe=>{var He=Kg();L(Fe,He)};ue(Cn,Fe=>{g(Ge).success?Fe(Ht):g(Ge).skipped?Fe(Pn,1):Fe(yr,!1)})}var Qr=b(ir,2),_n=m(Qr),Sa=b(_n);{var Ne=Fe=>{var He=Ug(),vt=b(Qe(He),1,!0);$(xt=>H(vt,xt),[()=>h(g(Ge).email.date)]),L(Fe,He)};ue(Sa,Fe=>{g(Ge).email.date&&Fe(Ne)})}var C=b(Qr,2);{var _e=Fe=>{var He=Wg(),vt=Qe(He);{var xt=Xt=>{var Dr=Gg(),Je=m(Dr);$(()=>H(Je,g(Ge).classification.summary)),L(Xt,Dr)};ue(vt,Xt=>{g(Ge).classification.summary&&Xt(xt)})}var sn=b(vt,2),In=m(sn),lr=b(In,2),St=b(lr);{var Zr=Xt=>{var Dr=Hg(),Je=b(Qe(Dr));$(As=>H(Je,` ${As??""} tok/s`),[()=>g(Ge).stats.tps.toFixed(0)]),L(Xt,Dr)};ue(St,Xt=>{g(Ge).stats.tps&&Xt(Zr)})}$(Xt=>{H(In,`${g(Ge).stats.inputTokens??""} in + ${g(Ge).stats.numTokens??""} out tokens `),H(lr,` ${Xt??""} `)},[()=>o(g(Ge).stats.elapsed)]),L(Fe,He)},ke=Fe=>{var He=Vg(),vt=b(m(He),2),xt=m(vt);$(()=>H(xt,g(Ge).error)),L(Fe,He)};ue(C,Fe=>{g(Ge).success?Fe(_e):Fe(ke,!1)})}$(Fe=>{dn=Nt(Ft,1,"result-item svelte-t1ig66",null,dn,{failed:!g(Ge).success,skipped:g(Ge).skipped}),H(Xr,g(Ge).email.subject||"(no subject)"),H(_n,`${Fe??""} `)},[()=>f(g(Ge).email.from)]),L(gt,Ft)}),$(()=>H(zt,`View ${r().results.length??""} email results`)),L(Ze,nt)};ue(Yr,Ze=>{var nt;((nt=r().results)==null?void 0:nt.length)>0&&Ze(Ot)})}$((Ze,nt,jt,zt,An,gt)=>{var Ge,Ft;H(De,((Ge=r().summary)==null?void 0:Ge.processed)||r().total||0),H(Ve,r().classified||0),H(rn,`${Ze??""} in + ${nt??""} out`),H(Ut,jt),H(Vn,((Ft=r().summary)==null?void 0:Ft.modelName)||"Unknown"),H(En,` (max ${zt??""} tokens)`),H(sr,`${An??""} chars`),H(xa,`${gt??""} chars`)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed),()=>{var Ze;return u(((Ze=r().summary)==null?void 0:Ze.modelMaxEmailTokens)||0)},()=>{var Ze;return u(((Ze=r().summary)==null?void 0:Ze.systemPromptSize)||0)},()=>{var Ze;return u(((Ze=r().summary)==null?void 0:Ze.avgPromptSize)||0)}]),L(qe,Ue)},be=qe=>{var Ue=Pr(),q=Qe(Ue);{var ye=xe=>{var De=Jg(),it=m(De),ot=m(it),dt=b(it,2);{var Rt=wt=>{var Tt=Zg(),Bt=m(Tt);$(()=>H(Bt,`${r().errors??""} errors`)),L(wt,Tt)};ue(dt,wt=>{r().errors&&wt(Rt)})}var Ve=b(dt,4),Ye=m(Ve),lt=b(Ve,4),ct=m(lt);$((wt,Tt,Bt)=>{H(ot,`${(r().classified||0)??""} classified`),H(Ye,`${wt??""} in + ${Tt??""} out tokens`),H(ct,Bt)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),L(xe,De)};ue(q,xe=>{r().totals&&xe(ye)})}L(qe,Ue)};ue(fe,qe=>{r().phase==="done"?qe(me):qe(be,!1)})}var Z=b(fe,2),ae=m(Z);{var Q=qe=>{var Ue=$g();Ue.__click=()=>M(a,!0),L(qe,Ue)},le=qe=>{var Ue=e_(),q=Qe(Ue);q.__click=()=>M(a,!0);var ye=b(q,2);ye.__click=function(...xe){var De;(De=e.onstop)==null||De.apply(this,xe)},L(qe,Ue)};ue(ae,qe=>{r().phase==="done"?qe(Q):qe(le,!1)})}var Be=b(W,2);{var We=qe=>{var Ue=a_();Ue.__click=()=>M(a,!1),Ue.__keydown=kt=>kt.key==="Escape"&&M(a,!1);var q=m(Ue);q.__click=kt=>kt.stopPropagation();var ye=m(q),xe=b(m(ye),2);xe.__click=()=>M(a,!1);var De=b(ye,2),it=m(De);let ot;it.__click=()=>M(i,"system");var dt=b(it,2);let Rt;dt.__click=()=>M(i,"email");var Ve=b(dt,2);let Ye;Ve.__click=()=>M(i,"full");var lt=b(De,2),ct=m(lt);{var wt=kt=>{var mt=t_(),yt=Qe(mt),fn=m(yt),rn=b(yt,2),gn=m(rn);$(()=>{H(fn,Br),H(gn,`${Br.length??""} chars`)}),L(kt,mt)},Tt=kt=>{var mt=n_(),yt=Qe(mt),fn=m(yt),rn=b(yt,2),gn=m(rn);$(()=>{var an,Ut,Gt;H(fn,((an=r().prompt)==null?void 0:an.user)||"(no email prompt)"),H(gn,`${(((Gt=(Ut=r().prompt)==null?void 0:Ut.user)==null?void 0:Gt.length)||0)??""} chars`)}),L(kt,mt)},Bt=kt=>{var mt=r_(),yt=Qe(mt),fn=m(yt),rn=b(yt,2),gn=m(rn);$(()=>{var an,Ut,Gt,Tn,It,je;H(fn,`${(((an=r().prompt)==null?void 0:an.system)||"")??""}

---

${(((Ut=r().prompt)==null?void 0:Ut.user)||"")??""}`),H(gn,`${(((Tn=(Gt=r().prompt)==null?void 0:Gt.system)==null?void 0:Tn.length)||0)+(((je=(It=r().prompt)==null?void 0:It.user)==null?void 0:je.length)||0)} chars total`)}),L(kt,mt)};ue(ct,kt=>{g(i)==="system"?kt(wt):g(i)==="email"?kt(Tt,1):kt(Bt,!1)})}$(()=>{ot=Nt(it,1,"mtab svelte-t1ig66",null,ot,{active:g(i)==="system"}),Rt=Nt(dt,1,"mtab svelte-t1ig66",null,Rt,{active:g(i)==="email"}),Ye=Nt(Ve,1,"mtab svelte-t1ig66",null,Ye,{active:g(i)==="full"})}),L(qe,Ue)};ue(Be,qe=>{g(a)&&qe(We)})}$(()=>{H(ve,`${g(y)??""}%`),ie=Nt(Pe,1,"bar-fill svelte-t1ig66",null,ie,{done:r().phase==="done"}),J=Sn(Pe,"",J,{width:`${g(y)??""}%`})}),L(E,T)};ue(k,E=>{r()&&E(A)})}L(t,x),Pt()}Kt(["click","keydown"]);var o_=B('<span class="spinner svelte-ois7em"></span>'),l_=Bo('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),c_=B('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),u_=B("<option> </option>"),f_=B('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),d_=B('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function v_(t,e){Ct(e,!0);let r=Oe(e,"engineStatus",3,"idle"),a=Oe(e,"modelName",3,""),i=Oe(e,"isScanning",3,!1),o=Oe(e,"scanProgress",3,null),u=Oe(e,"scanCount",15,20),f=Oe(e,"stats",3,null);const h=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function v(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function S(){return r()==="ready"&&!i()}var x=d_(),k=m(x),A=m(k),E=m(A);{var T=Z=>{var ae=o_();L(Z,ae)},W=Z=>{var ae=l_();L(Z,ae)};ue(E,Z=>{i()?Z(T):Z(W,!1)})}var ce=b(A,2),te=m(ce),U=b(m(te),2);U.__click=function(...Z){var ae;(ae=e.oninspect)==null||ae.apply(this,Z)};var F=b(te,2),X=m(F);let V;var ve=b(X),Ce=b(k,2);{var Pe=Z=>{var ae=c_(),Q=m(ae),le=m(Q),Be=b(Q,4),We=m(Be),qe=b(Be,4),Ue=m(qe);$(()=>{H(le,`${f().totalEmails??""} emails in storage`),H(We,`${f().classified??""} classified`),H(Ue,`${f().unclassified??""} new`)}),L(Z,ae)};ue(Ce,Z=>{f()&&Z(Pe)})}var ie=b(Ce,2),J=m(ie),oe=b(m(J),2);un(oe,21,()=>h,rr,(Z,ae)=>{var Q=u_(),le=m(Q),Be={};$(()=>{H(le,g(ae).label),Be!==(Be=g(ae).value)&&(Q.value=(Q.__value=g(ae).value)??"")}),L(Z,Q)});var Ae=b(J,2),re=m(Ae);re.__click=function(...Z){var ae;(ae=e.onscan)==null||ae.apply(this,Z)};var de=m(re),pe=b(re,2);pe.__click=function(...Z){var ae;(ae=e.onrescan)==null||ae.apply(this,Z)};var ee=b(ie,2);{var fe=Z=>{var ae=f_();L(Z,ae)};ue(ee,Z=>{r()!=="ready"&&r()!=="loading"&&Z(fe)})}var me=b(ee,2);{var be=Z=>{i_(Z,{get progress(){return o()},get onstop(){return e.onstop}})};ue(me,Z=>{var ae;(i()||((ae=o())==null?void 0:ae.phase)==="done")&&Z(be)})}$((Z,ae,Q,le)=>{V=Sn(X,"",V,Z),H(ve,` ${ae??""}`),oe.disabled=i(),re.disabled=Q,H(de,i()?"Scanning...":"Scan New"),pe.disabled=le},[()=>({background:y()}),v,()=>!S(),()=>!S()]),zo(oe,u),L(t,x),Pt()}Kt(["click"]);var p_=B('<span class="row-date svelte-1czytqk"> </span>'),h_=B('<span class="tag svelte-1czytqk"> </span>'),m_=B('<span class="row-tags svelte-1czytqk"></span>'),g_=B('<span class="row-reason svelte-1czytqk"> </span>'),__=B('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),y_=B('<span class="status-label svelte-1czytqk"> </span>'),b_=B('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),w_=B('<p class="summary-reason svelte-1czytqk"> </p>'),k_=B('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),x_=B('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function gc(t,e){Ct(e,!0);let r=Oe(e,"actionColor",3,"#666"),a=Oe(e,"dimmed",3,!1);function i(re){if(!re)return"";try{return new Date(re).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=At(()=>e.item.status==="pending"),u=Re(!1);var f=x_(),h=Qe(f);let v;var y=m(h);y.__click=()=>M(u,!g(u));let S;var x=m(y),k=m(x),A=b(x,2),E=m(A),T=m(E),W=b(E,2);{var ce=re=>{var de=p_(),pe=m(de);$(ee=>H(pe,ee),[()=>i(e.item.date)]),L(re,de)};ue(W,re=>{e.item.date&&re(ce)})}var te=b(A,2);{var U=re=>{var de=m_();un(de,21,()=>e.item.tags,rr,(pe,ee)=>{var fe=h_();let me;var be=m(fe);$(Z=>{me=Sn(fe,"",me,Z),H(be,g(ee))},[()=>({background:qv(g(ee))})]),L(pe,fe)}),L(re,de)};ue(te,re=>{e.item.tags&&e.item.tags.length>0&&re(U)})}var F=b(te,2);{var X=re=>{var de=g_(),pe=m(de);$(()=>H(pe,e.item.reason)),L(re,de)};ue(F,re=>{e.item.reason&&!g(u)&&re(X)})}var V=b(y,2),ve=m(V);{var Ce=re=>{var de=__(),pe=Qe(de);pe.__click=()=>e.onmarkacted(e.item.emailId);var ee=b(pe,2);ee.__click=()=>e.ondismiss(e.item.emailId),L(re,de)},Pe=re=>{var de=y_(),pe=m(de);$(()=>H(pe,e.item.status)),L(re,de)};ue(ve,re=>{g(o)?re(Ce):re(Pe,!1)})}var ie=b(ve,2);{var J=re=>{var de=b_();de.__click=()=>e.onremove(e.item.emailId),L(re,de)};ue(ie,re=>{e.onremove&&re(J)})}var oe=b(h,2);{var Ae=re=>{var de=k_();let pe;var ee=m(de),fe=m(ee),me=b(ee,2);{var be=Z=>{var ae=w_(),Q=m(ae);$(()=>H(Q,e.item.reason)),L(Z,ae)};ue(me,Z=>{e.item.reason&&Z(be)})}$(()=>{pe=Sn(de,"",pe,{"border-left-color":r()}),H(fe,e.item.summary)}),L(re,de)};ue(oe,re=>{g(u)&&e.item.summary&&re(Ae)})}$(()=>{v=Nt(h,1,"email-row svelte-1czytqk",null,v,{dimmed:a()}),S=Sn(y,"",S,{"border-left-color":r()}),H(k,e.item.subject),H(T,e.item.from)}),L(t,f),Pt()}Kt(["click"]);var S_=B('<span class="group-acted svelte-tl1unp"> </span>'),T_=B('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),E_=B('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),A_=B('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),C_=B('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),P_=B('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),I_=B('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function R_(t,e){Ct(e,!0);let r=Oe(e,"color",3,"#888");Oe(e,"count",3,0);let a=Oe(e,"items",19,()=>[]),i=Oe(e,"expanded",3,!1),o=At(()=>a().filter(X=>X.status==="pending")),u=At(()=>a().filter(X=>X.status!=="pending")),f=Re(!1);function h(X){return X.split("_").map(V=>V.charAt(0)+V.slice(1).toLowerCase()).join(" ")}var v=I_(),y=m(v);y.__click=function(...X){var V;(V=e.ontoggle)==null||V.apply(this,X)};var S=m(y);let x;var k=m(S),A=b(S,2),E=m(A),T=b(A,2);{var W=X=>{var V=S_(),ve=m(V);$(()=>H(ve,`${g(u).length??""} handled`)),L(X,V)};ue(T,X=>{g(u).length>0&&X(W)})}var ce=b(T,4);let te;var U=b(y,2);{var F=X=>{var V=P_(),ve=m(V);{var Ce=pe=>{var ee=T_();L(pe,ee)};ue(ve,pe=>{g(o).length===0&&g(u).length===0&&pe(Ce)})}var Pe=b(ve,2);un(Pe,17,()=>g(o),pe=>pe.emailId,(pe,ee)=>{gc(pe,{get item(){return g(ee)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ie=b(Pe,2);{var J=pe=>{var ee=E_(),fe=m(ee),me=m(fe),be=b(fe,2);un(be,17,()=>g(u),Z=>Z.emailId,(Z,ae)=>{gc(Z,{get item(){return g(ae)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),$(()=>H(me,`${g(u).length??""} handled`)),L(pe,ee)};ue(ie,pe=>{g(u).length>0&&pe(J)})}var oe=b(ie,2),Ae=m(oe);{var re=pe=>{var ee=A_();ee.__click=()=>M(f,!0),L(pe,ee)},de=pe=>{var ee=C_(),fe=m(ee),me=b(fe);me.__click=()=>M(f,!1);var be=b(me,2);be.__click=()=>{e.oncleargroup(),M(f,!1)},$(()=>H(fe,`Clear ${a().length??""} items? `)),L(pe,ee)};ue(Ae,pe=>{g(f)?pe(de,!1):pe(re)})}L(X,V)};ue(U,X=>{i()&&X(F)})}$(X=>{x=Sn(S,"",x,{background:r()}),H(k,X),H(E,g(o).length),te=Nt(ce,0,"chevron svelte-tl1unp",null,te,{open:i()})},[()=>h(e.action)]),L(t,v),Pt()}Kt(["click"]);var O_=B(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),D_=B(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),j_=B(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),M_=B('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function L_(t,e){Ct(e,!0);let r=Oe(e,"open",15,!1),a=Oe(e,"sampleEmail",3,null),i=Re("system");function o(){return a()?Du(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function f(S){S.target===S.currentTarget&&u()}var h=Pr(),v=Qe(h);{var y=S=>{var x=M_();x.__click=f,x.__keydown=J=>J.key==="Escape"&&u();var k=m(x),A=m(k),E=b(m(A),2);E.__click=u;var T=b(A,2),W=m(T);let ce;W.__click=()=>M(i,"system");var te=b(W,2);let U;te.__click=()=>M(i,"email");var F=b(te,2);let X;F.__click=()=>M(i,"config");var V=b(T,2),ve=m(V);{var Ce=J=>{var oe=O_(),Ae=b(Qe(oe),2),re=m(Ae);$(()=>H(re,Br)),L(J,oe)},Pe=J=>{var oe=D_(),Ae=b(Qe(oe),2),re=b(m(Ae),2);re.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var de=b(Ae,2),pe=b(m(de),2),ee=m(pe);$(fe=>H(ee,fe),[o]),L(J,oe)},ie=J=>{var oe=j_(),Ae=b(Qe(oe),2),re=m(Ae),de=b(m(re),2),pe=m(de),ee=b(re,2),fe=b(m(ee),2),me=m(fe),be=b(ee,2),Z=b(m(be),2),ae=m(Z),Q=b(Ae,4);Q.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,$(()=>{H(pe,Ov.maxTokens),H(me,"false"),H(ae,"false")}),L(J,oe)};ue(ve,J=>{g(i)==="system"?J(Ce):g(i)==="email"?J(Pe,1):g(i)==="config"&&J(ie,2)})}$(()=>{ce=Nt(W,1,"tab svelte-10pcy9j",null,ce,{active:g(i)==="system"}),U=Nt(te,1,"tab svelte-10pcy9j",null,U,{active:g(i)==="email"}),X=Nt(F,1,"tab svelte-10pcy9j",null,X,{active:g(i)==="config"})}),L(S,x)};ue(v,S=>{r()&&S(y)})}L(t,h),Pt()}Kt(["click","keydown"]);var N_=B('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),q_=B('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),B_=B('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),z_=B('<button class="chip svelte-s2dwjj"> </button>'),F_=B('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),K_=B('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),U_=B('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),G_=B('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),H_=B('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),W_=B('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),V_=B('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),Y_=B('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),X_=B('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),Q_=B('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),Z_=B('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),J_=B('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function $_(t,e){Ct(e,!0);let r=Oe(e,"groupOrder",19,()=>[]),a=Re(!1),i=Re(null),o=Re(!1),u=Re(null);async function f(){var ie;const[V,ve,Ce]=await Promise.all([ze.items.where("sourceType").equals("gmail").count(),ze.emailClassifications.count(),ze.contacts.count()]);let Pe=0;try{const J=await((ie=navigator.storage)==null?void 0:ie.estimate());Pe=(J==null?void 0:J.usage)??0}catch{}M(u,{emailCount:V,classCount:ve,contactCount:Ce,totalBytes:Pe},!0)}function h(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(1)} MB`:"â"}function v(){M(a,!g(a)),g(a)&&f()}async function y(V){var ve;M(o,!0),M(i,null);try{await V(),await f(),(ve=e.onrefresh)==null||ve.call(e)}finally{M(o,!1)}}async function S(){await y(()=>Xl())}async function x(V){await y(()=>Ho(V))}async function k(){await y(async()=>{await Nu(),await Xl()})}async function A(){await y(()=>ze.contacts.clear())}async function E(){await y(async()=>{await ze.delete(),window.location.reload()})}function T(V){return V.split("_").map(ve=>ve.charAt(0)+ve.slice(1).toLowerCase()).join(" ")}var W=J_(),ce=m(W);ce.__click=v;var te=b(m(ce),2);let U;var F=b(ce,2);{var X=V=>{var ve=Z_(),Ce=m(ve);{var Pe=q=>{var ye=q_(),xe=m(ye),De=m(xe),it=b(xe,4),ot=m(it),dt=b(it,4),Rt=m(dt),Ve=b(dt,2);{var Ye=lt=>{var ct=N_(),wt=b(Qe(ct),2),Tt=m(wt);$(Bt=>H(Tt,`${Bt??""} used`),[()=>h(g(u).totalBytes)]),L(lt,ct)};ue(Ve,lt=>{g(u).totalBytes&&lt(Ye)})}$(()=>{H(De,`${g(u).emailCount??""} emails`),H(ot,`${g(u).classCount??""} classifications`),H(Rt,`${g(u).contactCount??""} contacts`)}),L(q,ye)};ue(Ce,q=>{g(u)&&q(Pe)})}var ie=b(Ce,2);{var J=q=>{var ye=F_(),xe=b(m(ye),2);un(xe,21,r,rr,(De,it)=>{var ot=Pr(),dt=Qe(ot);{var Rt=Ye=>{var lt=B_(),ct=m(lt),wt=b(ct);wt.__click=()=>M(i,null);var Tt=b(wt,2);Tt.__click=()=>x(g(it)),$(Bt=>{H(ct,`Delete ${Bt??""}? `),Tt.disabled=g(o)},[()=>T(g(it))]),L(Ye,lt)},Ve=Ye=>{var lt=z_();lt.__click=()=>M(i,`group:${g(it)}`);var ct=m(lt);$(wt=>{lt.disabled=g(o),H(ct,`${wt??""} â`)},[()=>T(g(it))]),L(Ye,lt)};ue(dt,Ye=>{g(i)===`group:${g(it)}`?Ye(Rt):Ye(Ve,!1)})}L(De,ot)}),L(q,ye)};ue(ie,q=>{r().length>0&&q(J)})}var oe=b(ie,2),Ae=b(m(oe),2),re=m(Ae);{var de=q=>{var ye=K_(),xe=b(m(ye),2);xe.__click=()=>M(i,null);var De=b(xe,2);De.__click=S,$(()=>De.disabled=g(o)),L(q,ye)},pe=q=>{var ye=U_();ye.__click=()=>M(i,"classifications"),$(()=>ye.disabled=g(o)),L(q,ye)};ue(re,q=>{g(i)==="classifications"?q(de):q(pe,!1)})}var ee=b(re,2);{var fe=q=>{var ye=G_(),xe=b(m(ye),2);xe.__click=()=>M(i,null);var De=b(xe,2);De.__click=k,$(()=>De.disabled=g(o)),L(q,ye)},me=q=>{var ye=H_();ye.__click=()=>M(i,"emails"),$(()=>ye.disabled=g(o)),L(q,ye)};ue(ee,q=>{g(i)==="emails"?q(fe):q(me,!1)})}var be=b(ee,2);{var Z=q=>{var ye=W_(),xe=b(m(ye),2);xe.__click=()=>M(i,null);var De=b(xe,2);De.__click=A,$(()=>De.disabled=g(o)),L(q,ye)},ae=q=>{var ye=V_();ye.__click=()=>M(i,"contacts"),$(()=>ye.disabled=g(o)),L(q,ye)};ue(be,q=>{g(i)==="contacts"?q(Z):q(ae,!1)})}var Q=b(oe,2),le=m(Q);{var Be=q=>{var ye=Y_(),xe=b(m(ye),2);xe.__click=()=>M(i,null);var De=b(xe,2);De.__click=E,$(()=>De.disabled=g(o)),L(q,ye)},We=q=>{var ye=X_();ye.__click=()=>M(i,"nuke"),$(()=>ye.disabled=g(o)),L(q,ye)};ue(le,q=>{g(i)==="nuke"?q(Be):q(We,!1)})}var qe=b(Q,2);{var Ue=q=>{var ye=Q_();L(q,ye)};ue(qe,q=>{g(o)&&q(Ue)})}L(V,ve)};ue(F,V=>{g(a)&&V(X)})}$(()=>U=Nt(te,0,"chev svelte-s2dwjj",null,U,{open:g(a)})),L(t,W),Pt()}Kt(["click"]);var ey=B('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),ty=B('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),ny=B('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),ry=B('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function ay(t,e){Ct(e,!0);let r=Oe(e,"groups",19,()=>({})),a=Oe(e,"groupOrder",19,()=>[]),i=Oe(e,"counts",19,()=>({})),o=Oe(e,"stats",3,null),u=Oe(e,"expandedGroup",3,null),f=Oe(e,"isScanning",3,!1),h=Oe(e,"scanProgress",3,null),v=Oe(e,"scanCount",15,20),y=Oe(e,"error",3,null),S=Re(!1),x=At(()=>{for(const X of a()){const V=r()[X];if((V==null?void 0:V.length)>0)return V[0]}return null});var k=ry(),A=m(k);v_(A,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return f()},get scanProgress(){return h()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>M(S,!0),get scanCount(){return v()},set scanCount(X){v(X)}});var E=b(A,2);L_(E,{get sampleEmail(){return g(x)},get open(){return g(S)},set open(X){M(S,X,!0)}});var T=b(E,2);{var W=X=>{var V=ey(),ve=m(V),Ce=m(ve),Pe=b(ve,2);Pe.__click=function(...ie){var J;(J=e.ondismisserror)==null||J.apply(this,ie)},$(()=>H(Ce,y())),L(X,V)};ue(T,X=>{y()&&X(W)})}var ce=b(T,2);{var te=X=>{var V=ty(),ve=Qe(V);un(ve,20,a,J=>J,(J,oe)=>{{let Ae=At(()=>_o(oe)),re=At(()=>{var ee;return((ee=r()[oe])==null?void 0:ee.length)||0}),de=At(()=>r()[oe]||[]),pe=At(()=>u()===oe);R_(J,{get action(){return oe},get color(){return g(Ae)},get count(){return g(re)},get items(){return g(de)},get expanded(){return g(pe)},ontoggle:()=>e.ontogglegroup(oe),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(oe)})}});var Ce=b(ve,2),Pe=m(Ce),ie=m(Pe);$(()=>H(ie,`${i().total??""} emails classified into ${a().length??""} groups`)),L(X,V)},U=X=>{var V=ny();L(X,V)};ue(ce,X=>{i().total>0?X(te):f()||X(U,1)})}var F=b(ce,2);$_(F,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),L(t,k),Pt()}Kt(["click"]);var sy=B('<div class="actions-page svelte-3tch4q"><!></div>');function iy(t,e){Ct(e,!0);const r=yu();let a=Re(Jt(r.status)),i=Re(""),o=Re(Jt({})),u=Re(Jt([])),f=Re(Jt({total:0})),h=Re(null),v=Re(null),y=Re(!1),S=Re(null),x=Re(20),k=Re(null),A=Re(null);nn(()=>{const ie=r.onMessage(J=>{if(J.status==="ready"){M(a,"ready");const oe=Ir.find(Ae=>Ae.id===r.modelId);M(i,(oe==null?void 0:oe.name)||r.modelId||"",!0)}J.status==="loading"&&M(a,"loading")});if(M(a,r.status,!0),r.modelId){const J=Ir.find(oe=>oe.id===r.modelId);M(i,(J==null?void 0:J.name)||r.modelId||"",!0)}return E(),()=>ie()});async function E(){try{const ie=await Dv();M(o,ie.groups,!0),M(u,ie.order,!0),M(f,await jv(),!0),M(h,await go(),!0)}catch(ie){M(k,`Failed to load data: ${ie.message}`)}}async function T(){await ce(!1)}async function W(){await ce(!0)}async function ce(ie){if(g(y)||!r.isReady)return;M(k,null),M(y,!0),M(S,null);const J=new AbortController;M(A,J,!0);try{await Ru(r,{count:g(x),force:ie,signal:J.signal,onProgress:oe=>{M(S,{...oe},!0)}}),await E()}catch(oe){J.signal.aborted||M(k,`Scan failed: ${oe.message}`)}finally{M(y,!1),M(A,null)}}function te(){var ie;(ie=g(A))==null||ie.abort()}async function U(ie){await oi(ie,"acted"),await E()}async function F(ie){await oi(ie,"dismissed"),await E()}async function X(ie){await Ou(ie),await E()}async function V(ie){await Ho(ie),await E()}function ve(ie){M(v,g(v)===ie?null:ie,!0)}var Ce=sy(),Pe=m(Ce);ay(Pe,{get engineStatus(){return g(a)},get modelName(){return g(i)},get groups(){return g(o)},get groupOrder(){return g(u)},get counts(){return g(f)},get stats(){return g(h)},get expandedGroup(){return g(v)},get isScanning(){return g(y)},get scanProgress(){return g(S)},get error(){return g(k)},onscan:T,onrescan:W,ontogglegroup:ve,onmarkacted:U,ondismiss:F,onremove:X,oncleargroup:V,ondismisserror:()=>M(k,null),onstop:te,onrefresh:E,get scanCount(){return g(x)},set scanCount(ie){M(x,ie,!0)}}),L(t,Ce),Pt()}var oy=B('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function ly(t,e){Ct(e,!0);function r(){const V=location.hash;return V==="#dashboard"?"dashboard":V==="#actions"?"actions":"chat"}let a=Re(Jt(r()));nn(()=>{function V(){M(a,r(),!0)}return window.addEventListener("hashchange",V),()=>window.removeEventListener("hashchange",V)});var i=oy(),o=m(i),u=b(m(o),2),f=m(u);let h;var v=b(f,2);let y;var S=b(v,2);let x;var k=b(o,2),A=m(k);let E;var T=m(A);Wp(T,{});var W=b(A,2);let ce;var te=m(W);iy(te,{});var U=b(W,2);let F;var X=m(U);Eg(X,{}),$(()=>{h=Nt(f,1,"svelte-1n46o8q",null,h,{active:g(a)==="chat"}),y=Nt(v,1,"svelte-1n46o8q",null,y,{active:g(a)==="actions"}),x=Nt(S,1,"svelte-1n46o8q",null,x,{active:g(a)==="dashboard"}),E=Sn(A,"",E,{display:g(a)==="chat"?"flex":"none"}),ce=Sn(W,"",ce,{display:g(a)==="actions"?"flex":"none"}),F=Sn(U,"",F,{display:g(a)==="dashboard"?"flex":"none"})}),L(t,i),Pt()}Kd(ly,{target:document.getElementById("app")});
