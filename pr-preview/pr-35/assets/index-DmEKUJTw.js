var kf=Object.defineProperty;var Cl=t=>{throw TypeError(t)};var xf=(t,e,r)=>e in t?kf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ze=(t,e,r)=>xf(t,typeof e!="symbol"?e+"":e,r),Ki=(t,e,r)=>e.has(t)||Cl("Cannot "+r);var re=(t,e,r)=>(Ki(t,e,"read from private field"),r?r.call(t):e.get(t)),Je=(t,e,r)=>e.has(t)?Cl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Xe=(t,e,r,a)=>(Ki(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),ln=(t,e,r)=>(Ki(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const to=!1;var Eo=Array.isArray,Sf=Array.prototype.indexOf,Ma=Array.prototype.includes,fi=Array.from,Tf=Object.defineProperty,Aa=Object.getOwnPropertyDescriptor,Ef=Object.getOwnPropertyDescriptors,Af=Object.prototype,Cf=Array.prototype,_c=Object.getPrototypeOf,Il=Object.isExtensible;const If=()=>{};function Pf(t){for(var e=0;e<t.length;e++)t[e]()}function bc(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const nn=2,vs=4,di=8,wc=1<<24,Or=16,or=32,ba=64,kc=128,Wn=512,Xt=1024,rn=2048,sr=4096,Mn=8192,Ir=16384,ws=32768,La=65536,Pl=1<<17,xc=1<<18,Fa=1<<19,Rf=1<<20,Cr=1<<25,ha=65536,no=1<<21,Ao=1<<22,Kr=1<<23,da=Symbol("$state"),Of=Symbol("legacy props"),Df=Symbol(""),na=new class extends Error{constructor(){super(...arguments);Ze(this,"name","StaleReactionError");Ze(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function jf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Mf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Lf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Nf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function qf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Bf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function zf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ff(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Kf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Uf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Gf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Hf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Wf=1,Vf=2,Sc=4,Yf=8,Xf=16,Qf=1,Zf=4,Jf=8,$f=16,Tc=1,ed=2,Jt=Symbol(),Ec="http://www.w3.org/1999/xhtml";function td(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function nd(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ac(t){return t===this.v}function rd(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Cc(t){return!rd(t,this.v)}let ad=!1,Ln=null;function Na(t){Ln=t}function At(t,e=!1,r){Ln={p:Ln,i:!1,c:null,e:null,s:t,x:null,l:null}}function Ct(t){var e=Ln,r=e.e;if(r!==null){e.e=null;for(var a of r)Qc(a)}return t!==void 0&&(e.x=t),e.i=!0,Ln=e.p,t??{}}function Ic(){return!0}let ra=[];function Pc(){var t=ra;ra=[],Pf(t)}function Ur(t){if(ra.length===0&&!ls){var e=ra;queueMicrotask(()=>{e===ra&&Pc()})}ra.push(t)}function sd(){for(;ra.length>0;)Pc()}function Rc(t){var e=ht;if(e===null)return $e.f|=Kr,t;if((e.f&ws)===0&&(e.f&vs)===0)throw t;qa(t,e)}function qa(t,e){for(;e!==null;){if((e.f&kc)!==0){if((e.f&ws)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const id=-7169;function zt(t,e){t.f=t.f&id|e}function Co(t){(t.f&Wn)!==0||t.deps===null?zt(t,Xt):zt(t,sr)}function Oc(t){if(t!==null)for(const e of t)(e.f&nn)===0||(e.f&ha)===0||(e.f^=ha,Oc(e.deps))}function Dc(t,e,r){(t.f&rn)!==0?e.add(t):(t.f&sr)!==0&&r.add(t),Oc(t.deps),zt(t,Xt)}const Fs=new Set;let He=null,ti=null,$t=null,kn=[],vi=null,ro=!1,ls=!1;var Ca,Ia,ia,Pa,gs,ys,oa,Sr,Ra,br,ao,so,jc;const el=class el{constructor(){Je(this,br);Ze(this,"committed",!1);Ze(this,"current",new Map);Ze(this,"previous",new Map);Je(this,Ca,new Set);Je(this,Ia,new Set);Je(this,ia,0);Je(this,Pa,0);Je(this,gs,null);Je(this,ys,new Set);Je(this,oa,new Set);Je(this,Sr,new Map);Ze(this,"is_fork",!1);Je(this,Ra,!1)}is_deferred(){return this.is_fork||re(this,Pa)>0}skip_effect(e){re(this,Sr).has(e)||re(this,Sr).set(e,{d:[],m:[]})}unskip_effect(e){var r=re(this,Sr).get(e);if(r){re(this,Sr).delete(e);for(var a of r.d)zt(a,rn),rr(a);for(a of r.m)zt(a,sr),rr(a)}}process(e){var i;kn=[],this.apply();var r=[],a=[];for(const o of e)ln(this,br,ao).call(this,o,r,a);if(this.is_deferred()){ln(this,br,so).call(this,a),ln(this,br,so).call(this,r);for(const[o,u]of re(this,Sr))qc(o,u)}else{for(const o of re(this,Ca))o();re(this,Ca).clear(),re(this,ia)===0&&ln(this,br,jc).call(this),ti=this,He=null,Rl(a),Rl(r),ti=null,(i=re(this,gs))==null||i.resolve()}$t=null}capture(e,r){r!==Jt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Kr)===0&&(this.current.set(e,e.v),$t==null||$t.set(e,e.v))}activate(){He=this,this.apply()}deactivate(){He===this&&(He=null,$t=null)}flush(){if(this.activate(),kn.length>0){if(Mc(),He!==null&&He!==this)return}else re(this,ia)===0&&this.process([]);this.deactivate()}discard(){for(const e of re(this,Ia))e(this);re(this,Ia).clear()}increment(e){Xe(this,ia,re(this,ia)+1),e&&Xe(this,Pa,re(this,Pa)+1)}decrement(e){Xe(this,ia,re(this,ia)-1),e&&Xe(this,Pa,re(this,Pa)-1),!re(this,Ra)&&(Xe(this,Ra,!0),Ur(()=>{Xe(this,Ra,!1),this.is_deferred()?kn.length>0&&this.flush():this.revive()}))}revive(){for(const e of re(this,ys))re(this,oa).delete(e),zt(e,rn),rr(e);for(const e of re(this,oa))zt(e,sr),rr(e);this.flush()}oncommit(e){re(this,Ca).add(e)}ondiscard(e){re(this,Ia).add(e)}settled(){return(re(this,gs)??Xe(this,gs,bc())).promise}static ensure(){if(He===null){const e=He=new el;Fs.add(He),ls||Ur(()=>{He===e&&e.flush()})}return He}apply(){}};Ca=new WeakMap,Ia=new WeakMap,ia=new WeakMap,Pa=new WeakMap,gs=new WeakMap,ys=new WeakMap,oa=new WeakMap,Sr=new WeakMap,Ra=new WeakMap,br=new WeakSet,ao=function(e,r,a){e.f^=Xt;for(var i=e.first,o=null;i!==null;){var u=i.f,d=(u&(or|ba))!==0,h=d&&(u&Xt)!==0,v=h||(u&Mn)!==0||re(this,Sr).has(i);if(!v&&i.fn!==null){d?i.f^=Xt:o!==null&&(u&(vs|di|wc))!==0?o.b.defer_effect(i):(u&vs)!==0?r.push(i):xs(i)&&((u&Or)!==0&&re(this,oa).add(i),za(i));var _=i.first;if(_!==null){i=_;continue}}var S=i.parent;for(i=i.next;i===null&&S!==null;)S===o&&(o=null),i=S.next,S=S.parent}},so=function(e){for(var r=0;r<e.length;r+=1)Dc(e[r],re(this,ys),re(this,oa))},jc=function(){var i;if(Fs.size>1){this.previous.clear();var e=$t,r=!0;for(const o of Fs){if(o===this){r=!1;continue}const u=[];for(const[h,v]of this.current){if(o.current.has(h))if(r&&v!==o.current.get(h))o.current.set(h,v);else continue;u.push(h)}if(u.length===0)continue;const d=[...o.current.keys()].filter(h=>!this.current.has(h));if(d.length>0){var a=kn;kn=[];const h=new Set,v=new Map;for(const _ of u)Lc(_,d,h,v);if(kn.length>0){He=o,o.apply();for(const _ of kn)ln(i=o,br,ao).call(i,_,[],[]);o.deactivate()}kn=a}}He=null,$t=e}this.committed=!0,Fs.delete(this)};let Gr=el;function od(t){var e=ls;ls=!0;try{for(var r;;){if(sd(),kn.length===0&&(He==null||He.flush(),kn.length===0))return vi=null,r;Mc()}}finally{ls=e}}function Mc(){ro=!0;var t=null;try{for(var e=0;kn.length>0;){var r=Gr.ensure();if(e++>1e3){var a,i;ld()}r.process(kn),Hr.clear()}}finally{kn=[],ro=!1,vi=null}}function ld(){try{zf()}catch(t){qa(t,vi)}}let Jn=null;function Rl(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(Ir|Mn))===0&&xs(a)&&(Jn=new Set,za(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&eu(a),(Jn==null?void 0:Jn.size)>0)){Hr.clear();for(const i of Jn){if((i.f&(Ir|Mn))!==0)continue;const o=[i];let u=i.parent;for(;u!==null;)Jn.has(u)&&(Jn.delete(u),o.push(u)),u=u.parent;for(let d=o.length-1;d>=0;d--){const h=o[d];(h.f&(Ir|Mn))===0&&za(h)}}Jn.clear()}}Jn=null}}function Lc(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&nn)!==0?Lc(i,e,r,a):(o&(Ao|Or))!==0&&(o&rn)===0&&Nc(i,e,a)&&(zt(i,rn),rr(i))}}function Nc(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ma.call(e,i))return!0;if((i.f&nn)!==0&&Nc(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function rr(t){for(var e=vi=t;e.parent!==null;){e=e.parent;var r=e.f;if(ro&&e===ht&&(r&Or)!==0&&(r&xc)===0)return;if((r&(ba|or))!==0){if((r&Xt)===0)return;e.f^=Xt}}kn.push(e)}function qc(t,e){if(!((t.f&or)!==0&&(t.f&Xt)!==0)){(t.f&rn)!==0?e.d.push(t):(t.f&sr)!==0&&e.m.push(t),zt(t,Xt);for(var r=t.first;r!==null;)qc(r,e),r=r.next}}function cd(t){let e=0,r=ma(0),a;return()=>{Ro()&&(g(r),Oo(()=>(e===0&&(a=Ss(()=>t(()=>cs(r)))),e+=1,()=>{Ur(()=>{e-=1,e===0&&(a==null||a(),a=void 0,cs(r))})})))}}var ud=La|Fa|kc;function fd(t,e,r){new dd(t,e,r)}var Un,To,hr,la,mr,Gn,bn,gr,Tr,zr,ca,Fr,Oa,ua,Da,ja,Er,ci,Qt,vd,pd,io,Xs,Qs,oo;class dd{constructor(e,r,a){Je(this,Qt);Ze(this,"parent");Ze(this,"is_pending",!1);Je(this,Un);Je(this,To,null);Je(this,hr);Je(this,la);Je(this,mr);Je(this,Gn,null);Je(this,bn,null);Je(this,gr,null);Je(this,Tr,null);Je(this,zr,null);Je(this,ca,0);Je(this,Fr,0);Je(this,Oa,!1);Je(this,ua,!1);Je(this,Da,new Set);Je(this,ja,new Set);Je(this,Er,null);Je(this,ci,cd(()=>(Xe(this,Er,ma(re(this,ca))),()=>{Xe(this,Er,null)})));Xe(this,Un,e),Xe(this,hr,r),Xe(this,la,a),this.parent=ht.b,this.is_pending=!!re(this,hr).pending,Xe(this,mr,Do(()=>{ht.b=this;{var i=ln(this,Qt,io).call(this);try{Xe(this,Gn,Hn(()=>a(i)))}catch(o){this.error(o)}re(this,Fr)>0?ln(this,Qt,Qs).call(this):this.is_pending=!1}return()=>{var o;(o=re(this,zr))==null||o.remove()}},ud))}defer_effect(e){Dc(e,re(this,Da),re(this,ja))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!re(this,hr).pending}update_pending_count(e){ln(this,Qt,oo).call(this,e),Xe(this,ca,re(this,ca)+e),!(!re(this,Er)||re(this,Oa))&&(Xe(this,Oa,!0),Ur(()=>{Xe(this,Oa,!1),re(this,Er)&&Ba(re(this,Er),re(this,ca))}))}get_effect_pending(){return re(this,ci).call(this),g(re(this,Er))}error(e){var r=re(this,hr).onerror;let a=re(this,hr).failed;if(re(this,ua)||!r&&!a)throw e;re(this,Gn)&&(Sn(re(this,Gn)),Xe(this,Gn,null)),re(this,bn)&&(Sn(re(this,bn)),Xe(this,bn,null)),re(this,gr)&&(Sn(re(this,gr)),Xe(this,gr,null));var i=!1,o=!1;const u=()=>{if(i){nd();return}i=!0,o&&Hf(),Gr.ensure(),Xe(this,ca,0),re(this,gr)!==null&&va(re(this,gr),()=>{Xe(this,gr,null)}),this.is_pending=this.has_pending_snippet(),Xe(this,Gn,ln(this,Qt,Xs).call(this,()=>(Xe(this,ua,!1),Hn(()=>re(this,la).call(this,re(this,Un)))))),re(this,Fr)>0?ln(this,Qt,Qs).call(this):this.is_pending=!1};Ur(()=>{try{o=!0,r==null||r(e,u),o=!1}catch(d){qa(d,re(this,mr)&&re(this,mr).parent)}a&&Xe(this,gr,ln(this,Qt,Xs).call(this,()=>{Gr.ensure(),Xe(this,ua,!0);try{return Hn(()=>{a(re(this,Un),()=>e,()=>u)})}catch(d){return qa(d,re(this,mr).parent),null}finally{Xe(this,ua,!1)}}))})}}Un=new WeakMap,To=new WeakMap,hr=new WeakMap,la=new WeakMap,mr=new WeakMap,Gn=new WeakMap,bn=new WeakMap,gr=new WeakMap,Tr=new WeakMap,zr=new WeakMap,ca=new WeakMap,Fr=new WeakMap,Oa=new WeakMap,ua=new WeakMap,Da=new WeakMap,ja=new WeakMap,Er=new WeakMap,ci=new WeakMap,Qt=new WeakSet,vd=function(){try{Xe(this,Gn,Hn(()=>re(this,la).call(this,re(this,Un))))}catch(e){this.error(e)}},pd=function(){const e=re(this,hr).pending;e&&(Xe(this,bn,Hn(()=>e(re(this,Un)))),Ur(()=>{var r=ln(this,Qt,io).call(this);Xe(this,Gn,ln(this,Qt,Xs).call(this,()=>(Gr.ensure(),Hn(()=>re(this,la).call(this,r))))),re(this,Fr)>0?ln(this,Qt,Qs).call(this):(va(re(this,bn),()=>{Xe(this,bn,null)}),this.is_pending=!1)}))},io=function(){var e=re(this,Un);return this.is_pending&&(Xe(this,zr,Pr()),re(this,Un).before(re(this,zr)),e=re(this,zr)),e},Xs=function(e){var r=ht,a=$e,i=Ln;_r(re(this,mr)),Yn(re(this,mr)),Na(re(this,mr).ctx);try{return e()}catch(o){return Rc(o),null}finally{_r(r),Yn(a),Na(i)}},Qs=function(){const e=re(this,hr).pending;re(this,Gn)!==null&&(Xe(this,Tr,document.createDocumentFragment()),re(this,Tr).append(re(this,zr)),ru(re(this,Gn),re(this,Tr))),re(this,bn)===null&&Xe(this,bn,Hn(()=>e(re(this,Un))))},oo=function(e){var r;if(!this.has_pending_snippet()){this.parent&&ln(r=this.parent,Qt,oo).call(r,e);return}if(Xe(this,Fr,re(this,Fr)+e),re(this,Fr)===0){this.is_pending=!1;for(const a of re(this,Da))zt(a,rn),rr(a);for(const a of re(this,ja))zt(a,sr),rr(a);re(this,Da).clear(),re(this,ja).clear(),re(this,bn)&&va(re(this,bn),()=>{Xe(this,bn,null)}),re(this,Tr)&&(re(this,Un).before(re(this,Tr)),Xe(this,Tr,null))}};function hd(t,e,r,a){const i=pi;var o=t.filter(x=>!x.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var u=He,d=ht,h=md(),v=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(x=>x.promise)):null;function _(x){h();try{a(x)}catch(k){(d.f&Ir)===0&&qa(k,d)}u==null||u.deactivate(),lo()}if(r.length===0){v.then(()=>_(e.map(i)));return}function S(){h(),Promise.all(r.map(x=>gd(x))).then(x=>_([...e.map(i),...x])).catch(x=>qa(x,d))}v?v.then(S):S()}function md(){var t=ht,e=$e,r=Ln,a=He;return function(o=!0){_r(t),Yn(e),Na(r),o&&(a==null||a.activate())}}function lo(){_r(null),Yn(null),Na(null)}function pi(t){var e=nn|rn,r=$e!==null&&($e.f&nn)!==0?$e:null;return ht!==null&&(ht.f|=Fa),{ctx:Ln,deps:null,effects:null,equals:Ac,f:e,fn:t,reactions:null,rv:0,v:Jt,wv:0,parent:r??ht,ac:null}}function gd(t,e,r){let a=ht;a===null&&Mf();var i=a.b,o=void 0,u=ma(Jt),d=!$e,h=new Map;return Rd(()=>{var k;var v=bc();o=v.promise;try{Promise.resolve(t()).then(v.resolve,v.reject).then(()=>{_===He&&_.committed&&_.deactivate(),lo()})}catch(N){v.reject(N),lo()}var _=He;if(d){var S=i.is_rendered();i.update_pending_count(1),_.increment(S),(k=h.get(_))==null||k.reject(na),h.delete(_),h.set(_,v)}const x=(N,E=void 0)=>{if(_.activate(),E)E!==na&&(u.f|=Kr,Ba(u,E));else{(u.f&Kr)!==0&&(u.f^=Kr),Ba(u,N);for(const[T,B]of h){if(h.delete(T),T===_)break;B.reject(na)}}d&&(i.update_pending_count(-1),_.decrement(S))};v.promise.then(x,N=>x(null,N||"unknown"))}),Xc(()=>{for(const v of h.values())v.reject(na)}),new Promise(v=>{function _(S){function x(){S===o?v(u):_(o)}S.then(x,x)}_(o)})}function Et(t){const e=pi(t);return au(e),e}function Bc(t){const e=pi(t);return e.equals=Cc,e}function yd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Sn(e[r])}}function _d(t){for(var e=t.parent;e!==null;){if((e.f&nn)===0)return(e.f&Ir)===0?e:null;e=e.parent}return null}function Io(t){var e,r=ht;_r(_d(t));try{t.f&=~ha,yd(t),e=lu(t)}finally{_r(r)}return e}function zc(t){var e=Io(t);if(!t.equals(e)&&(t.wv=iu(),(!(He!=null&&He.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){zt(t,Xt);return}Wr||($t!==null?(Ro()||He!=null&&He.is_fork)&&$t.set(t,e):Co(t))}function bd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(na),a.teardown=If,a.ac=null,ps(a,0),jo(a))}function Fc(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&za(e)}let co=new Set;const Hr=new Map;let Kc=!1;function ma(t,e){var r={f:0,v:t,reactions:null,equals:Ac,rv:0,wv:0};return r}function Re(t,e){const r=ma(t);return au(r),r}function wd(t,e=!1,r=!0){const a=ma(t);return e||(a.equals=Cc),a}function j(t,e,r=!1){$e!==null&&(!ar||($e.f&Pl)!==0)&&Ic()&&($e.f&(nn|Or|Ao|Pl))!==0&&(Vn===null||!Ma.call(Vn,t))&&Gf();let a=r?en(e):e;return Ba(t,a)}function Ba(t,e){if(!t.equals(e)){var r=t.v;Wr?Hr.set(t,e):Hr.set(t,r),t.v=e;var a=Gr.ensure();if(a.capture(t,r),(t.f&nn)!==0){const i=t;(t.f&rn)!==0&&Io(i),Co(i)}t.wv=iu(),Uc(t,rn),ht!==null&&(ht.f&Xt)!==0&&(ht.f&(or|ba))===0&&(Kn===null?Dd([t]):Kn.push(t)),!a.is_fork&&co.size>0&&!Kc&&kd()}return e}function kd(){Kc=!1;for(const t of co)(t.f&Xt)!==0&&zt(t,sr),xs(t)&&za(t);co.clear()}function cs(t){j(t,t.v+1)}function Uc(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],u=o.f,d=(u&rn)===0;if(d&&zt(o,e),(u&nn)!==0){var h=o;$t==null||$t.delete(h),(u&ha)===0&&(u&Wn&&(o.f|=ha),Uc(h,sr))}else d&&((u&Or)!==0&&Jn!==null&&Jn.add(o),rr(o))}}function en(t){if(typeof t!="object"||t===null||da in t)return t;const e=_c(t);if(e!==Af&&e!==Cf)return t;var r=new Map,a=Eo(t),i=Re(0),o=pa,u=d=>{if(pa===o)return d();var h=$e,v=pa;Yn(null),Ll(o);var _=d();return Yn(h),Ll(v),_};return a&&r.set("length",Re(t.length)),new Proxy(t,{defineProperty(d,h,v){(!("value"in v)||v.configurable===!1||v.enumerable===!1||v.writable===!1)&&Kf();var _=r.get(h);return _===void 0?u(()=>{var S=Re(v.value);return r.set(h,S),S}):j(_,v.value,!0),!0},deleteProperty(d,h){var v=r.get(h);if(v===void 0){if(h in d){const _=u(()=>Re(Jt));r.set(h,_),cs(i)}}else j(v,Jt),cs(i);return!0},get(d,h,v){var k;if(h===da)return t;var _=r.get(h),S=h in d;if(_===void 0&&(!S||(k=Aa(d,h))!=null&&k.writable)&&(_=u(()=>{var N=en(S?d[h]:Jt),E=Re(N);return E}),r.set(h,_)),_!==void 0){var x=g(_);return x===Jt?void 0:x}return Reflect.get(d,h,v)},getOwnPropertyDescriptor(d,h){var v=Reflect.getOwnPropertyDescriptor(d,h);if(v&&"value"in v){var _=r.get(h);_&&(v.value=g(_))}else if(v===void 0){var S=r.get(h),x=S==null?void 0:S.v;if(S!==void 0&&x!==Jt)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return v},has(d,h){var x;if(h===da)return!0;var v=r.get(h),_=v!==void 0&&v.v!==Jt||Reflect.has(d,h);if(v!==void 0||ht!==null&&(!_||(x=Aa(d,h))!=null&&x.writable)){v===void 0&&(v=u(()=>{var k=_?en(d[h]):Jt,N=Re(k);return N}),r.set(h,v));var S=g(v);if(S===Jt)return!1}return _},set(d,h,v,_){var Z;var S=r.get(h),x=h in d;if(a&&h==="length")for(var k=v;k<S.v;k+=1){var N=r.get(k+"");N!==void 0?j(N,Jt):k in d&&(N=u(()=>Re(Jt)),r.set(k+"",N))}if(S===void 0)(!x||(Z=Aa(d,h))!=null&&Z.writable)&&(S=u(()=>Re(void 0)),j(S,en(v)),r.set(h,S));else{x=S.v!==Jt;var E=u(()=>en(v));j(S,E)}var T=Reflect.getOwnPropertyDescriptor(d,h);if(T!=null&&T.set&&T.set.call(_,v),!x){if(a&&typeof h=="string"){var B=r.get("length"),W=Number(h);Number.isInteger(W)&&W>=B.v&&j(B,W+1)}cs(i)}return!0},ownKeys(d){g(i);var h=Reflect.ownKeys(d).filter(S=>{var x=r.get(S);return x===void 0||x.v!==Jt});for(var[v,_]of r)_.v!==Jt&&!(v in d)&&h.push(v);return h},setPrototypeOf(){Uf()}})}function Ol(t){try{if(t!==null&&typeof t=="object"&&da in t)return t[da]}catch{}return t}function xd(t,e){return Object.is(Ol(t),Ol(e))}var Dl,Gc,Hc,Wc;function Sd(){if(Dl===void 0){Dl=window,Gc=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Hc=Aa(e,"firstChild").get,Wc=Aa(e,"nextSibling").get,Il(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Il(r)&&(r.__t=void 0)}}function Pr(t=""){return document.createTextNode(t)}function jn(t){return Hc.call(t)}function ks(t){return Wc.call(t)}function m(t,e){return jn(t)}function We(t,e=!1){{var r=jn(t);return r instanceof Comment&&r.data===""?ks(r):r}}function b(t,e=1,r=!1){let a=t;for(;e--;)a=ks(a);return a}function Td(t){t.textContent=""}function Vc(){return!1}function Ed(t,e,r){return document.createElementNS(Ec,t,void 0)}let jl=!1;function Ad(){jl||(jl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function Po(t){var e=$e,r=ht;Yn(null),_r(null);try{return t()}finally{Yn(e),_r(r)}}function Yc(t,e,r,a=r){t.addEventListener(e,()=>Po(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),Ad()}function Cd(t){ht===null&&($e===null&&Bf(),qf()),Wr&&Nf()}function Id(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Dr(t,e,r){var a=ht;a!==null&&(a.f&Mn)!==0&&(t|=Mn);var i={ctx:Ln,deps:null,nodes:null,f:t|rn|Wn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{za(i)}catch(d){throw Sn(i),d}else e!==null&&rr(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Fa)===0&&(o=o.first,(t&Or)!==0&&(t&La)!==0&&o!==null&&(o.f|=La)),o!==null&&(o.parent=a,a!==null&&Id(o,a),$e!==null&&($e.f&nn)!==0&&(t&ba)===0)){var u=$e;(u.effects??(u.effects=[])).push(o)}return i}function Ro(){return $e!==null&&!ar}function Xc(t){const e=Dr(di,null,!1);return zt(e,Xt),e.teardown=t,e}function ni(t){Cd();var e=ht.f,r=!$e&&(e&or)!==0&&(e&ws)===0;if(r){var a=Ln;(a.e??(a.e=[])).push(t)}else return Qc(t)}function Qc(t){return Dr(vs|Rf,t,!1)}function Pd(t){Gr.ensure();const e=Dr(ba|Fa,t,!0);return(r={})=>new Promise(a=>{r.outro?va(e,()=>{Sn(e),a(void 0)}):(Sn(e),a(void 0))})}function Zc(t){return Dr(vs,t,!1)}function Rd(t){return Dr(Ao|Fa,t,!0)}function Oo(t,e=0){return Dr(di|e,t,!0)}function ne(t,e=[],r=[],a=[]){hd(a,e,r,i=>{Dr(di,()=>t(...i.map(g)),!0)})}function Do(t,e=0){var r=Dr(Or|e,t,!0);return r}function Hn(t){return Dr(or|Fa,t,!0)}function Jc(t){var e=t.teardown;if(e!==null){const r=Wr,a=$e;Ml(!0),Yn(null);try{e.call(null)}finally{Ml(r),Yn(a)}}}function jo(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Po(()=>{i.abort(na)});var a=r.next;(r.f&ba)!==0?r.parent=null:Sn(r,e),r=a}}function Od(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&or)===0&&Sn(e),e=r}}function Sn(t,e=!0){var r=!1;(e||(t.f&xc)!==0)&&t.nodes!==null&&t.nodes.end!==null&&($c(t.nodes.start,t.nodes.end),r=!0),jo(t,e&&!r),ps(t,0),zt(t,Ir);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Jc(t);var i=t.parent;i!==null&&i.first!==null&&eu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function $c(t,e){for(;t!==null;){var r=t===e?null:ks(t);t.remove(),t=r}}function eu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function va(t,e,r=!0){var a=[];tu(t,a,!0);var i=()=>{r&&Sn(t),e&&e()},o=a.length;if(o>0){var u=()=>--o||i();for(var d of a)d.out(u)}else i()}function tu(t,e,r){if((t.f&Mn)===0){t.f^=Mn;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,u=(i.f&La)!==0||(i.f&or)!==0&&(t.f&Or)!==0;tu(i,e,u?r:!1),i=o}}}function Mo(t){nu(t,!0)}function nu(t,e){if((t.f&Mn)!==0){t.f^=Mn,(t.f&Xt)===0&&(zt(t,rn),rr(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&La)!==0||(r.f&or)!==0;nu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const u of o)(u.is_global||e)&&u.in()}}function ru(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:ks(r);e.append(r),r=i}}let Zs=!1,Wr=!1;function Ml(t){Wr=t}let $e=null,ar=!1;function Yn(t){$e=t}let ht=null;function _r(t){ht=t}let Vn=null;function au(t){$e!==null&&(Vn===null?Vn=[t]:Vn.push(t))}let xn=null,On=0,Kn=null;function Dd(t){Kn=t}let su=1,aa=0,pa=aa;function Ll(t){pa=t}function iu(){return++su}function xs(t){var e=t.f;if((e&rn)!==0)return!0;if(e&nn&&(t.f&=~ha),(e&sr)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(xs(o)&&zc(o),o.wv>t.wv)return!0}(e&Wn)!==0&&$t===null&&zt(t,Xt)}return!1}function ou(t,e,r=!0){var a=t.reactions;if(a!==null&&!(Vn!==null&&Ma.call(Vn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&nn)!==0?ou(o,e,!1):e===o&&(r?zt(o,rn):(o.f&Xt)!==0&&zt(o,sr),rr(o))}}function lu(t){var E;var e=xn,r=On,a=Kn,i=$e,o=Vn,u=Ln,d=ar,h=pa,v=t.f;xn=null,On=0,Kn=null,$e=(v&(or|ba))===0?t:null,Vn=null,Na(t.ctx),ar=!1,pa=++aa,t.ac!==null&&(Po(()=>{t.ac.abort(na)}),t.ac=null);try{t.f|=no;var _=t.fn,S=_();t.f|=ws;var x=t.deps,k=He==null?void 0:He.is_fork;if(xn!==null){var N;if(k||ps(t,On),x!==null&&On>0)for(x.length=On+xn.length,N=0;N<xn.length;N++)x[On+N]=xn[N];else t.deps=x=xn;if(Ro()&&(t.f&Wn)!==0)for(N=On;N<x.length;N++)((E=x[N]).reactions??(E.reactions=[])).push(t)}else!k&&x!==null&&On<x.length&&(ps(t,On),x.length=On);if(Ic()&&Kn!==null&&!ar&&x!==null&&(t.f&(nn|sr|rn))===0)for(N=0;N<Kn.length;N++)ou(Kn[N],t);if(i!==null&&i!==t){if(aa++,i.deps!==null)for(let T=0;T<r;T+=1)i.deps[T].rv=aa;if(e!==null)for(const T of e)T.rv=aa;Kn!==null&&(a===null?a=Kn:a.push(...Kn))}return(t.f&Kr)!==0&&(t.f^=Kr),S}catch(T){return Rc(T)}finally{t.f^=no,xn=e,On=r,Kn=a,$e=i,Vn=o,Na(u),ar=d,pa=h}}function jd(t,e){let r=e.reactions;if(r!==null){var a=Sf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&nn)!==0&&(xn===null||!Ma.call(xn,e))){var o=e;(o.f&Wn)!==0&&(o.f^=Wn,o.f&=~ha),Co(o),bd(o),ps(o,0)}}function ps(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)jd(t,r[a])}function za(t){var e=t.f;if((e&Ir)===0){zt(t,Xt);var r=ht,a=Zs;ht=t,Zs=!0;try{(e&(Or|wc))!==0?Od(t):jo(t),Jc(t);var i=lu(t);t.teardown=typeof i=="function"?i:null,t.wv=su;var o;to&&ad&&(t.f&rn)!==0&&t.deps}finally{Zs=a,ht=r}}}async function cu(){await Promise.resolve(),od()}function g(t){var e=t.f,r=(e&nn)!==0;if($e!==null&&!ar){var a=ht!==null&&(ht.f&Ir)!==0;if(!a&&(Vn===null||!Ma.call(Vn,t))){var i=$e.deps;if(($e.f&no)!==0)t.rv<aa&&(t.rv=aa,xn===null&&i!==null&&i[On]===t?On++:xn===null?xn=[t]:xn.push(t));else{($e.deps??($e.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[$e]:Ma.call(o,$e)||o.push($e)}}}if(Wr&&Hr.has(t))return Hr.get(t);if(r){var u=t;if(Wr){var d=u.v;return((u.f&Xt)===0&&u.reactions!==null||fu(u))&&(d=Io(u)),Hr.set(u,d),d}var h=(u.f&Wn)===0&&!ar&&$e!==null&&(Zs||($e.f&Wn)!==0),v=(u.f&ws)===0;xs(u)&&(h&&(u.f|=Wn),zc(u)),h&&!v&&(Fc(u),uu(u))}if($t!=null&&$t.has(t))return $t.get(t);if((t.f&Kr)!==0)throw t.v;return t.v}function uu(t){if(t.f|=Wn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&nn)!==0&&(e.f&Wn)===0&&(Fc(e),uu(e))}function fu(t){if(t.v===Jt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Hr.has(e)||(e.f&nn)!==0&&fu(e))return!0;return!1}function Ss(t){var e=ar;try{return ar=!0,t()}finally{ar=e}}const Md=["touchstart","touchmove"];function Ld(t){return Md.includes(t)}const du=new Set,uo=new Set;function Ut(t){for(var e=0;e<t.length;e++)du.add(t[e]);for(var r of uo)r(t)}let Nl=null;function ql(t){var T;var e=this,r=e.ownerDocument,a=t.type,i=((T=t.composedPath)==null?void 0:T.call(t))||[],o=i[0]||t.target;Nl=t;var u=0,d=Nl===t&&t.__root;if(d){var h=i.indexOf(d);if(h!==-1&&(e===document||e===window)){t.__root=e;return}var v=i.indexOf(e);if(v===-1)return;h<=v&&(u=h)}if(o=i[u]||t.target,o!==e){Tf(t,"currentTarget",{configurable:!0,get(){return o||r}});var _=$e,S=ht;Yn(null),_r(null);try{for(var x,k=[];o!==null;){var N=o.assignedSlot||o.parentNode||o.host||null;try{var E=o["__"+a];E!=null&&(!o.disabled||t.target===o)&&E.call(o,t)}catch(B){x?k.push(B):x=B}if(t.cancelBubble||N===e||N===null)break;o=N}if(x){for(let B of k)queueMicrotask(()=>{throw B});throw x}}finally{t.__root=e,delete t.currentTarget,Yn(_),_r(S)}}}var mc,gc;const Ui=(gc=(mc=globalThis==null?void 0:globalThis.window)==null?void 0:mc.trustedTypes)==null?void 0:gc.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Nd(t){return(Ui==null?void 0:Ui.createHTML(t))??t}function Lo(t,e=!1){var r=Ed("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Nd(t):t,r.content}function ga(t,e){var r=ht;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function z(t,e){var r=(e&Tc)!==0,a=(e&ed)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Lo(o?t:"<!>"+t,!0),r||(i=jn(i)));var u=a||Gc?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=jn(u),h=u.lastChild;ga(d,h)}else ga(u,u);return u}}function qd(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&Tc)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,u;return()=>{if(!u){var d=Lo(o,!0),h=jn(d);if(i)for(u=document.createDocumentFragment();jn(h);)u.appendChild(jn(h));else u=jn(h)}var v=u.cloneNode(!0);if(i){var _=jn(v),S=v.lastChild;ga(_,S)}else ga(v,v);return v}}function No(t,e){return qd(t,e,"svg")}function ri(t=""){{var e=Pr(t+"");return ga(e,e),e}}function Rr(){var t=document.createDocumentFragment(),e=document.createComment(""),r=Pr();return t.append(e,r),ga(e,r),t}function L(t,e){t!==null&&t.before(e)}function H(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Bd(t,e){return zd(t,e)}const Ks=new Map;function zd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:u=!0}){Sd();var d=new Set,h=S=>{for(var x=0;x<S.length;x++){var k=S[x];if(!d.has(k)){d.add(k);var N=Ld(k);for(const B of[e,document]){var E=Ks.get(B);E===void 0&&(E=new Map,Ks.set(B,E));var T=E.get(k);T===void 0?(B.addEventListener(k,ql,{passive:N}),E.set(k,1)):E.set(k,T+1)}}}};h(fi(du)),uo.add(h);var v=void 0,_=Pd(()=>{var S=r??e.appendChild(Pr());return fd(S,{pending:()=>{}},x=>{At({});var k=Ln;o&&(k.c=o),i&&(a.$$events=i),v=t(x,a)||{},Ct()}),()=>{var E;for(var x of d)for(const T of[e,document]){var k=Ks.get(T),N=k.get(x);--N==0?(T.removeEventListener(x,ql),k.delete(x),k.size===0&&Ks.delete(T)):k.set(x,N)}uo.delete(h),S!==r&&((E=S.parentNode)==null||E.removeChild(S))}});return Fd.set(v,_),v}let Fd=new WeakMap;var er,yr,Dn,fa,_s,bs,ui;class Kd{constructor(e,r=!0){Ze(this,"anchor");Je(this,er,new Map);Je(this,yr,new Map);Je(this,Dn,new Map);Je(this,fa,new Set);Je(this,_s,!0);Je(this,bs,()=>{var e=He;if(re(this,er).has(e)){var r=re(this,er).get(e),a=re(this,yr).get(r);if(a)Mo(a),re(this,fa).delete(r);else{var i=re(this,Dn).get(r);i&&(re(this,yr).set(r,i.effect),re(this,Dn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,u]of re(this,er)){if(re(this,er).delete(o),o===e)break;const d=re(this,Dn).get(u);d&&(Sn(d.effect),re(this,Dn).delete(u))}for(const[o,u]of re(this,yr)){if(o===r||re(this,fa).has(o))continue;const d=()=>{if(Array.from(re(this,er).values()).includes(o)){var v=document.createDocumentFragment();ru(u,v),v.append(Pr()),re(this,Dn).set(o,{effect:u,fragment:v})}else Sn(u);re(this,fa).delete(o),re(this,yr).delete(o)};re(this,_s)||!a?(re(this,fa).add(o),va(u,d,!1)):d()}}});Je(this,ui,e=>{re(this,er).delete(e);const r=Array.from(re(this,er).values());for(const[a,i]of re(this,Dn))r.includes(a)||(Sn(i.effect),re(this,Dn).delete(a))});this.anchor=e,Xe(this,_s,r)}ensure(e,r){var a=He,i=Vc();if(r&&!re(this,yr).has(e)&&!re(this,Dn).has(e))if(i){var o=document.createDocumentFragment(),u=Pr();o.append(u),re(this,Dn).set(e,{effect:Hn(()=>r(u)),fragment:o})}else re(this,yr).set(e,Hn(()=>r(this.anchor)));if(re(this,er).set(a,e),i){for(const[d,h]of re(this,yr))d===e?a.unskip_effect(h):a.skip_effect(h);for(const[d,h]of re(this,Dn))d===e?a.unskip_effect(h.effect):a.skip_effect(h.effect);a.oncommit(re(this,bs)),a.ondiscard(re(this,ui))}else re(this,bs).call(this)}}er=new WeakMap,yr=new WeakMap,Dn=new WeakMap,fa=new WeakMap,_s=new WeakMap,bs=new WeakMap,ui=new WeakMap;function fe(t,e,r=!1){var a=new Kd(t),i=r?La:0;function o(u,d){a.ensure(u,d)}Do(()=>{var u=!1;e((d,h=0)=>{u=!0,o(h,d)}),u||o(!1,null)},i)}function ir(t,e){return e}function Ud(t,e,r){for(var a=[],i=e.length,o,u=e.length,d=0;d<i;d++){let S=e[d];va(S,()=>{if(o){if(o.pending.delete(S),o.done.add(S),o.pending.size===0){var x=t.outrogroups;fo(fi(o.done)),x.delete(o),x.size===0&&(t.outrogroups=null)}}else u-=1},!1)}if(u===0){var h=a.length===0&&r!==null;if(h){var v=r,_=v.parentNode;Td(_),_.append(v),t.items.clear()}fo(e,!h)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function fo(t,e=!0){for(var r=0;r<t.length;r++)Sn(t[r],e)}var Bl;function un(t,e,r,a,i,o=null){var u=t,d=new Map,h=(e&Sc)!==0;if(h){var v=t;u=v.appendChild(Pr())}var _=null,S=Bc(()=>{var B=r();return Eo(B)?B:B==null?[]:fi(B)}),x,k=!0;function N(){T.fallback=_,Gd(T,x,u,e,a),_!==null&&(x.length===0?(_.f&Cr)===0?Mo(_):(_.f^=Cr,is(_,null,u)):va(_,()=>{_=null}))}var E=Do(()=>{x=g(S);for(var B=x.length,W=new Set,Z=He,Y=Vc(),ee=0;ee<B;ee+=1){var J=x[ee],U=a(J,ee),de=k?null:d.get(U);de?(de.v&&Ba(de.v,J),de.i&&Ba(de.i,ee),Y&&Z.unskip_effect(de.e)):(de=Hd(d,k?u:Bl??(Bl=Pr()),J,U,ee,i,e,r),k||(de.e.f|=Cr),d.set(U,de)),W.add(U)}if(B===0&&o&&!_&&(k?_=Hn(()=>o(u)):(_=Hn(()=>o(Bl??(Bl=Pr()))),_.f|=Cr)),B>W.size&&Lf(),!k)if(Y){for(const[Ce,Ee]of d)W.has(Ce)||Z.skip_effect(Ee.e);Z.oncommit(N),Z.ondiscard(()=>{})}else N();g(S)}),T={effect:E,items:d,outrogroups:null,fallback:_};k=!1}function Ja(t){for(;t!==null&&(t.f&or)===0;)t=t.next;return t}function Gd(t,e,r,a,i){var Ee,oe,$,ce,Ie,le,ve,pe,te;var o=(a&Yf)!==0,u=e.length,d=t.items,h=Ja(t.effect.first),v,_=null,S,x=[],k=[],N,E,T,B;if(o)for(B=0;B<u;B+=1)N=e[B],E=i(N,B),T=d.get(E).e,(T.f&Cr)===0&&((oe=(Ee=T.nodes)==null?void 0:Ee.a)==null||oe.measure(),(S??(S=new Set)).add(T));for(B=0;B<u;B+=1){if(N=e[B],E=i(N,B),T=d.get(E).e,t.outrogroups!==null)for(const ue of t.outrogroups)ue.pending.delete(T),ue.done.delete(T);if((T.f&Cr)!==0)if(T.f^=Cr,T===h)is(T,null,r);else{var W=_?_.next:h;T===t.effect.last&&(t.effect.last=T.prev),T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),qr(t,_,T),qr(t,T,W),is(T,W,r),_=T,x=[],k=[],h=Ja(_.next);continue}if((T.f&Mn)!==0&&(Mo(T),o&&((ce=($=T.nodes)==null?void 0:$.a)==null||ce.unfix(),(S??(S=new Set)).delete(T))),T!==h){if(v!==void 0&&v.has(T)){if(x.length<k.length){var Z=k[0],Y;_=Z.prev;var ee=x[0],J=x[x.length-1];for(Y=0;Y<x.length;Y+=1)is(x[Y],Z,r);for(Y=0;Y<k.length;Y+=1)v.delete(k[Y]);qr(t,ee.prev,J.next),qr(t,_,ee),qr(t,J,Z),h=Z,_=J,B-=1,x=[],k=[]}else v.delete(T),is(T,h,r),qr(t,T.prev,T.next),qr(t,T,_===null?t.effect.first:_.next),qr(t,_,T),_=T;continue}for(x=[],k=[];h!==null&&h!==T;)(v??(v=new Set)).add(h),k.push(h),h=Ja(h.next);if(h===null)continue}(T.f&Cr)===0&&x.push(T),_=T,h=Ja(T.next)}if(t.outrogroups!==null){for(const ue of t.outrogroups)ue.pending.size===0&&(fo(fi(ue.done)),(Ie=t.outrogroups)==null||Ie.delete(ue));t.outrogroups.size===0&&(t.outrogroups=null)}if(h!==null||v!==void 0){var U=[];if(v!==void 0)for(T of v)(T.f&Mn)===0&&U.push(T);for(;h!==null;)(h.f&Mn)===0&&h!==t.fallback&&U.push(h),h=Ja(h.next);var de=U.length;if(de>0){var Ce=(a&Sc)!==0&&u===0?r:null;if(o){for(B=0;B<de;B+=1)(ve=(le=U[B].nodes)==null?void 0:le.a)==null||ve.measure();for(B=0;B<de;B+=1)(te=(pe=U[B].nodes)==null?void 0:pe.a)==null||te.fix()}Ud(t,U,Ce)}}o&&Ur(()=>{var ue,me;if(S!==void 0)for(T of S)(me=(ue=T.nodes)==null?void 0:ue.a)==null||me.apply()})}function Hd(t,e,r,a,i,o,u,d){var h=(u&Wf)!==0?(u&Xf)===0?wd(r,!1,!1):ma(r):null,v=(u&Vf)!==0?ma(i):null;return{v:h,i:v,e:Hn(()=>(o(e,h??r,v??i,d),()=>{t.delete(a)}))}}function is(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&Cr)===0?e.nodes.start:r;a!==null;){var u=ks(a);if(o.before(a),a===i)return;a=u}}function qr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Wd(t,e,r=!1,a=!1,i=!1){var o=t,u="";ne(()=>{var d=ht;if(u!==(u=e()??"")&&(d.nodes!==null&&($c(d.nodes.start,d.nodes.end),d.nodes=null),u!=="")){var h=u+"";r?h=`<svg>${h}</svg>`:a&&(h=`<math>${h}</math>`);var v=Lo(h);if((r||a)&&(v=jn(v)),ga(jn(v),v.lastChild),r||a)for(;jn(v);)o.before(jn(v));else o.before(v)}})}const zl=[...` 	
\r\fÂ \v\uFEFF`];function Vd(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,u=0;(u=a.indexOf(i,u))>=0;){var d=u+o;(u===0||zl.includes(a[u-1]))&&(d===a.length||zl.includes(a[d]))?a=(u===0?"":a.substring(0,u))+a.substring(d+1):u=d}}return a===""?null:a}function Fl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Gi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Yd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,u=0,d=!1,h=[];a&&h.push(...Object.keys(a).map(Gi)),i&&h.push(...Object.keys(i).map(Gi));var v=0,_=-1;const E=t.length;for(var S=0;S<E;S++){var x=t[S];if(d?x==="/"&&t[S-1]==="*"&&(d=!1):o?o===x&&(o=!1):x==="/"&&t[S+1]==="*"?d=!0:x==='"'||x==="'"?o=x:x==="("?u++:x===")"&&u--,!d&&o===!1&&u===0){if(x===":"&&_===-1)_=S;else if(x===";"||S===E-1){if(_!==-1){var k=Gi(t.substring(v,_).trim());if(!h.includes(k)){x!==";"&&S++;var N=t.substring(v,S).trim();r+=" "+N+";"}}v=S+1,_=-1}}}}return a&&(r+=Fl(a)),i&&(r+=Fl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Bt(t,e,r,a,i,o){var u=t.__className;if(u!==r||u===void 0){var d=Vd(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var h in o){var v=!!o[h];(i==null||v!==!!i[h])&&t.classList.toggle(h,v)}return o}function Hi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function Tn(t,e,r,a){var i=t.__style;if(i!==e){var o=Yd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(Hi(t,r==null?void 0:r[0],a[0]),Hi(t,r==null?void 0:r[1],a[1],"important")):Hi(t,r,a));return a}function vu(t,e,r=!1){if(t.multiple){if(e==null)return;if(!Eo(e))return td();for(var a of t.options)a.selected=e.includes(us(a));return}for(a of t.options){var i=us(a);if(xd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Xd(t){var e=new MutationObserver(()=>{vu(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Xc(()=>{e.disconnect()})}function qo(t,e,r=e){var a=new WeakSet,i=!0;Yc(t,"change",o=>{var u=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(u),us);else{var h=t.querySelector(u)??t.querySelector("option:not([disabled])");d=h&&us(h)}r(d),He!==null&&a.add(He)}),Zc(()=>{var o=e();if(t===document.activeElement){var u=ti??He;if(a.has(u))return}if(vu(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=us(d),r(o))}t.__value=o,i=!1}),Xd(t)}function us(t){return"__value"in t?t.__value:t.value}const Qd=Symbol("is custom element"),Zd=Symbol("is html");function pu(t,e,r,a){var i=Jd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Df]=r),r==null?t.removeAttribute(e):typeof r!="string"&&$d(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Jd(t){return t.__attributes??(t.__attributes={[Qd]:t.nodeName.includes("-"),[Zd]:t.namespaceURI===Ec})}var Kl=new Map;function $d(t){var e=t.getAttribute("is")||t.nodeName,r=Kl.get(e);if(r)return r;Kl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=Ef(i);for(var u in a)a[u].set&&r.push(u);i=_c(i)}return r}function Bo(t,e,r=e){var a=new WeakSet;Yc(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Wi(t)?Vi(o):o,r(o),He!==null&&a.add(He),await cu(),o!==(o=e())){var u=t.selectionStart,d=t.selectionEnd,h=t.value.length;if(t.value=o??"",d!==null){var v=t.value.length;u===d&&d===h&&v>h?(t.selectionStart=v,t.selectionEnd=v):(t.selectionStart=u,t.selectionEnd=Math.min(d,v))}}}),Ss(e)==null&&t.value&&(r(Wi(t)?Vi(t.value):t.value),He!==null&&a.add(He)),Oo(()=>{var i=e();if(t===document.activeElement){var o=ti??He;if(a.has(o))return}Wi(t)&&i===Vi(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Wi(t){var e=t.type;return e==="number"||e==="range"}function Vi(t){return t===""?null:+t}function Ul(t,e){return t===e||(t==null?void 0:t[da])===e}function hu(t={},e,r,a){return Zc(()=>{var i,o;return Oo(()=>{i=o,o=[],Ss(()=>{t!==r(...o)&&(e(t,...o),i&&Ul(r(...i),t)&&e(null,...i))})}),()=>{Ur(()=>{o&&Ul(r(...o),t)&&e(null,...o)})}}),t}let Us=!1;function ev(t){var e=Us;try{return Us=!1,[t(),Us]}finally{Us=e}}function Oe(t,e,r,a){var W;var i=(r&Jf)!==0,o=(r&$f)!==0,u=a,d=!0,h=()=>(d&&(d=!1,u=o?Ss(a):a),u),v;if(i){var _=da in t||Of in t;v=((W=Aa(t,e))==null?void 0:W.set)??(_&&e in t?Z=>t[e]=Z:void 0)}var S,x=!1;i?[S,x]=ev(()=>t[e]):S=t[e],S===void 0&&a!==void 0&&(S=h(),v&&(Ff(),v(S)));var k;if(k=()=>{var Z=t[e];return Z===void 0?h():(d=!0,Z)},(r&Zf)===0)return k;if(v){var N=t.$$legacy;return(function(Z,Y){return arguments.length>0?((!Y||N||x)&&v(Y?k():Z),Z):k()})}var E=!1,T=((r&Qf)!==0?pi:Bc)(()=>(E=!1,k()));i&&g(T);var B=ht;return(function(Z,Y){if(arguments.length>0){const ee=Y?g(T):i?en(Z):Z;return j(T,ee),E=!0,u!==void 0&&(u=ee),Z}return Wr&&E||(B.f&Ir)!==0?T.v:g(T)})}function an(t){Ln===null&&jf(),ni(()=>{const e=Ss(t);if(typeof e=="function")return e})}const tv="5";var yc;typeof window<"u"&&((yc=window.__svelte??(window.__svelte={})).v??(yc.v=new Set)).add(tv);const hs=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let wn=null,Ar="idle",Js=null,ea=new Set;function Gs(){return wn||(wn=new Worker(new URL(""+new URL("worker-BJ8R2iOv.js",import.meta.url).href,import.meta.url),{type:"module"}),wn.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(Ar="loading"),e.status==="ready"&&(Ar="ready"),e.status==="start"&&(Ar="generating"),(e.status==="complete"||e.status==="error")&&(Ar=Js?"ready":"idle");for(const r of ea)try{r(e)}catch{}})),wn}function mu(){return{check(){Gs().postMessage({type:"check"})},loadModel(t){Js=t,Ar="loading",Gs().postMessage({type:"load",modelId:t})},generate(t,e){Gs().postMessage({type:"generate",data:t,options:e})},generateFull(t,e,r){return new Promise((a,i)=>{let o="",u=null,d=0,h=0;const v=S=>{switch(S.status){case"start":h=S.inputTokens||0;break;case"thinking":break;case"thinking-done":break;case"update":if(o+=S.output,u=S.tps??u,d=S.numTokens??d,r)try{r({tps:u,numTokens:d})}catch{}break;case"complete":_(),a({text:o,tps:u,numTokens:d,inputTokens:h});break;case"error":_(),i(new Error(S.data));break}},_=()=>{ea.delete(v)};ea.add(v),Gs().postMessage({type:"generate",data:t,options:e})})},interrupt(){wn==null||wn.postMessage({type:"interrupt"})},reset(){wn==null||wn.postMessage({type:"reset"})},onMessage(t){return ea.add(t),()=>ea.delete(t)},offMessage(t){ea.delete(t)},get status(){return Ar},get isReady(){return Ar==="ready"},get isGenerating(){return Ar==="generating"},get modelId(){return Js},terminate(){wn==null||wn.terminate(),wn=null,Ar="idle",Js=null,ea.clear()}}}var nv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $s={exports:{}},av=$s.exports,Gl;function sv(){return Gl||(Gl=1,(function(t,e){((r,a)=>{t.exports=a()})(av,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,c){l.__proto__=c}:function(l,c){for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l[f]=c[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,c=arguments.length;l<c;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var c,f=0,p=s.length;f<p;f++)!c&&f in s||((c=c||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(c||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:nv,u=Object.keys,d=Array.isArray;function h(n,s){return typeof s=="object"&&u(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var v=Object.getPrototypeOf,_={}.hasOwnProperty;function S(n,s){return _.call(n,s)}function x(n,s){typeof s=="function"&&(s=s(v(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(s).forEach(function(l){N(n,l,s[l])})}var k=Object.defineProperty;function N(n,s,l,c){k(n,s,h(l&&S(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},c))}function E(n){return{from:function(s){return n.prototype=Object.create(s.prototype),N(n.prototype,"constructor",n),{extend:x.bind(null,n.prototype)}}}}var T=Object.getOwnPropertyDescriptor,B=[].slice;function W(n,s,l){return B.call(n,s,l)}function Z(n,s){return s(n)}function Y(n){if(!n)throw new Error("Assertion Failed")}function ee(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function J(n,s){if(typeof s=="string"&&S(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],c=0,f=s.length;c<f;++c){var p=J(n,s[c]);l.push(p)}return l}var y,w=s.indexOf(".");return w===-1||(y=n[s.substr(0,w)])==null?void 0:J(y,s.substr(w+1))}function U(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){Y(typeof l!="string"&&"length"in l);for(var c=0,f=s.length;c<f;++c)U(n,s[c],l[c])}else{var p,y,w=s.indexOf(".");w!==-1?(p=s.substr(0,w),(w=s.substr(w+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:U(y=(y=n[p])&&S(n,p)?y:n[p]={},w,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function de(n){var s,l={};for(s in n)S(n,s)&&(l[s]=n[s]);return l}var Ce=[].concat;function Ee(n){return Ce.apply([],n)}var Q="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ee([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),oe=new Set(Q.map(function(n){return o[n]})),$=null;function ce(n){return $=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var c=$.get(l);if(c)return c;if(d(l)){c=[],$.set(l,c);for(var f=0,p=l.length;f<p;++f)c.push(s(l[f]))}else if(oe.has(l.constructor))c=l;else{var y,w=v(l);for(y in c=w===Object.prototype?{}:Object.create(w),$.set(l,c),l)S(l,y)&&(c[y]=s(l[y]))}return c})(n),$=null,n}var Ie={}.toString;function le(n){return Ie.call(n).slice(8,-1)}var ve=typeof Symbol<"u"?Symbol.iterator:"@@iterator",pe=typeof ve=="symbol"?function(n){var s;return n!=null&&(s=n[ve])&&s.apply(n)}:function(){return null};function te(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var ue={};function me(n){var s,l,c,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ue&&typeof n=="string")return[n];if(f=pe(n))for(l=[];!(c=f.next()).done;)l.push(c.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var be=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],vt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Q),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function X(n,s){this.name=n,this.message=s}function ie(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,c,f){return f.indexOf(l)===c}).join(`
`)}function Be(n,s,l,c){this.failures=s,this.failedKeys=c,this.successCount=l,this.message=ie(n,s)}function Ue(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=ie(n,this.failures)}E(X).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(Be).from(X),E(Ue).from(X);var qe=vt.reduce(function(n,s){return n[s]=s+"Error",n},{}),Ke=X,q=vt.reduce(function(n,s){var l=s+"Error";function c(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=ae[s]||l,this.inner=null)}return E(c).from(Ke),n[s]=c,n},{}),_e=(q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError,Q.reduce(function(n,s){return n[s+"Error"]=q[s],n},{}));Q=vt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=q[s]),n},{});function xe(){}function De(n){return n}function et(n,s){return n==null||n===De?s:function(l){return s(n(l))}}function tt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function ct(n,s){return n===xe?s:function(){var l=n.apply(this,arguments),c=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return c&&(this.onsuccess=this.onsuccess?tt(c,this.onsuccess):c),f&&(this.onerror=this.onerror?tt(f,this.onerror):f),p!==void 0?p:l}}function Dt(n,s){return n===xe?s:function(){n.apply(this,arguments);var l=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?tt(l,this.onsuccess):l),c&&(this.onerror=this.onerror?tt(c,this.onerror):c)}}function Ge(n,s){return n===xe?s:function(f){var c=n.apply(this,arguments),f=(h(f,c),this.onsuccess),p=this.onerror,y=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?tt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?tt(p,this.onerror):p),c===void 0?y===void 0?void 0:y:h(c,y)}}function Ve(n,s){return n===xe?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function nt(n,s){return n===xe?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var c=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(c,p)})}return s.apply(this,arguments)}}Q.ModifyError=Be,Q.DexieError=X,Q.BulkError=Ue;var rt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function mt(n){rt=n}var xt={},Ft=100,_t=typeof Promise>"u"?[]:(vt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[_t=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(_t),vt]:[vt,v(vt),vt]),vt=_t[0],Ta=_t[1],Ta=Ta&&Ta.then,gt=vt&&vt.constructor,fn=!!_t[2],sn=function(n,s){Qn.push([n,s]),Zt&&(queueMicrotask(It),Zt=!1)},mn=!0,Zt=!0,Gt=[],Ht=[],En=De,jt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:xe,pgp:!1,env:{},finalize:xe},je=jt,Qn=[],An=0,jr=[];function Ae(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=je;if(typeof n!="function"){if(n!==xt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Kt(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(c,f){try{f(function(p){if(c._state===null){if(p===c)throw new TypeError("A promise cannot be resolved with itself.");var y=c._lib&&qn();p&&typeof p.then=="function"?l(c,function(w,P){p instanceof Ae?p._then(w,P):p.then(w,P)}):(c._state=!0,c._value=p,gn(c)),y&&Bn()}},Kt.bind(null,c))}catch(p){Kt(c,p)}})(this,n)}var ut={get:function(){var n=je,s=fr;function l(c,f){var p=this,y=!n.global&&(n!==je||s!==fr),w=y&&!In(),P=new Ae(function(K,R){Zn(p,new wt(A(c,n,y,w),A(f,n,y,w),K,R,n))});return this._consoleTask&&(P._consoleTask=this._consoleTask),P}return l.prototype=xt,l},set:function(n){N(this,"then",n&&n.prototype===xt?ut:{get:function(){return n},set:ut.set})}};function wt(n,s,l,c,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=c,this.psd=f}function Kt(n,s){var l,c;Ht.push(s),n._state===null&&(l=n._lib&&qn(),s=En(s),n._state=!1,n._value=s,c=n,Gt.some(function(f){return f._value===c._value})||Gt.push(c),gn(n),l)&&Bn()}function gn(n){var s=n._listeners;n._listeners=[];for(var l=0,c=s.length;l<c;++l)Zn(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),An===0&&(++An,sn(function(){--An==0&&lr()},[]))}function Zn(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++An,sn(St,[l,n,s])}}function St(n,s,l){try{var c,f=s._value;!s._state&&Ht.length&&(Ht=[]),c=rt&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||Ht.indexOf(f)!==-1||(p=>{for(var y=Gt.length;y;)if(Gt[--y]._value===p._value)return Gt.splice(y,1)})(s),l.resolve(c)}catch(p){l.reject(p)}finally{--An==0&&lr(),--l.psd.ref||l.psd.finalize()}}function It(){Me(jt,function(){qn()&&Bn()})}function qn(){var n=mn;return Zt=mn=!1,n}function Bn(){var n,s,l;do for(;0<Qn.length;)for(n=Qn,Qn=[],l=n.length,s=0;s<l;++s){var c=n[s];c[0].apply(null,c[1])}while(0<Qn.length);Zt=mn=!0}function lr(){for(var n=Gt,s=(Gt=[],n.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)}),jr.slice(0)),l=s.length;l;)s[--l]()}function cr(n){return new Ae(xt,!1,n)}function yt(n,s){var l=je;return function(){var c=qn(),f=je;try{return Pt(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Pt(f,!1),c&&Bn()}}}x(Ae.prototype,{then:ut,_then:function(n,s){Zn(this,new wt(null,null,n,s,je))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(c){return(c instanceof s?l:cr)(c)}):this.then(null,function(c){return(c&&c.name===s?l:cr)(c)}))},finally:function(n){return this.then(function(s){return Ae.resolve(n()).then(function(){return s})},function(s){return Ae.resolve(n()).then(function(){return cr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new Ae(function(c,f){var p=setTimeout(function(){return f(new q.Timeout(s))},n);l.then(c,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&N(Ae.prototype,Symbol.toStringTag,"Dexie.Promise"),jt.env=Pn(),x(Ae,{all:function(){var n=me.apply(null,arguments).map(wr);return new Ae(function(s,l){n.length===0&&s([]);var c=n.length;n.forEach(function(f,p){return Ae.resolve(f).then(function(y){n[p]=y,--c||s(n)},l)})})},resolve:function(n){return n instanceof Ae?n:n&&typeof n.then=="function"?new Ae(function(s,l){n.then(s,l)}):new Ae(xt,!0,n)},reject:cr,race:function(){var n=me.apply(null,arguments).map(wr);return new Ae(function(s,l){n.map(function(c){return Ae.resolve(c).then(s,l)})})},PSD:{get:function(){return je},set:function(n){return je=n}},totalEchoes:{get:function(){return fr}},newPSD:Cn,usePSD:Me,scheduler:{get:function(){return sn},set:function(n){sn=n}},rejectionMapper:{get:function(){return En},set:function(n){En=n}},follow:function(n,s){return new Ae(function(l,c){return Cn(function(f,p){var y=je;y.unhandleds=[],y.onunhandled=p,y.finalize=tt(function(){var w,P=this;w=function(){P.unhandleds.length===0?f():p(P.unhandleds[0])},jr.push(function K(){w(),jr.splice(jr.indexOf(K),1)}),++An,sn(function(){--An==0&&lr()},[])},y.finalize),n()},s,l,c)})}}),gt&&(gt.allSettled&&N(Ae,"allSettled",function(){var n=me.apply(null,arguments).map(wr);return new Ae(function(s){n.length===0&&s([]);var l=n.length,c=new Array(l);n.forEach(function(f,p){return Ae.resolve(f).then(function(y){return c[p]={status:"fulfilled",value:y}},function(y){return c[p]={status:"rejected",reason:y}}).then(function(){return--l||s(c)})})})}),gt.any&&typeof AggregateError<"u"&&N(Ae,"any",function(){var n=me.apply(null,arguments).map(wr);return new Ae(function(s,l){n.length===0&&l(new AggregateError([]));var c=n.length,f=new Array(c);n.forEach(function(p,y){return Ae.resolve(p).then(function(w){return s(w)},function(w){f[y]=w,--c||l(new AggregateError(f))})})})}),gt.withResolvers)&&(Ae.withResolvers=gt.withResolvers);var Lt={awaits:0,echoes:0,id:0},yn=0,_n=[],ur=0,fr=0,Yr=0;function Cn(n,y,l,c){var f=je,p=Object.create(f),y=(p.parent=f,p.ref=0,p.global=!1,p.id=++Yr,jt.env,p.env=fn?{Promise:Ae,PromiseProp:{value:Ae,configurable:!0,writable:!0},all:Ae.all,race:Ae.race,allSettled:Ae.allSettled,any:Ae.any,resolve:Ae.resolve,reject:Ae.reject}:{},y&&h(p,y),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Me(p,n,l,c));return p.ref===0&&p.finalize(),y}function Wt(){return Lt.id||(Lt.id=++yn),++Lt.awaits,Lt.echoes+=Ft,Lt.id}function In(){return!!Lt.awaits&&(--Lt.awaits==0&&(Lt.id=0),Lt.echoes=Lt.awaits*Ft,!0)}function wr(n){return Lt.echoes&&n&&n.constructor===gt?(Wt(),n.then(function(s){return In(),s},function(s){return In(),ke(s)})):n}function Ot(){var n=_n[_n.length-1];_n.pop(),Pt(n,!1)}function Pt(n,s){var l,c,f=je;(s?!Lt.echoes||ur++&&n===je:!ur||--ur&&n===je)||queueMicrotask(s?(function(p){++fr,Lt.echoes&&--Lt.echoes!=0||(Lt.echoes=Lt.awaits=Lt.id=0),_n.push(je),Pt(p,!0)}).bind(null,n):Ot),n!==je&&(je=n,f===jt&&(jt.env=Pn()),fn)&&(l=jt.env.Promise,c=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",c.PromiseProp),l.all=c.all,l.race=c.race,l.resolve=c.resolve,l.reject=c.reject,c.allSettled&&(l.allSettled=c.allSettled),c.any)&&(l.any=c.any)}function Pn(){var n=o.Promise;return fn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Me(n,s,l,c,f){var p=je;try{return Pt(n,!0),s(l,c,f)}finally{Pt(p,!1)}}function A(n,s,l,c){return typeof n!="function"?n:function(){var f=je;l&&Wt(),Pt(s,!0);try{return n.apply(this,arguments)}finally{Pt(f,!1),c&&queueMicrotask(In)}}}function ge(n){Promise===gt&&Lt.echoes===0?ur===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+Ta).indexOf("[native code]")===-1&&(Wt=In=xe);var ke=Ae.reject,st="ï¿¿",bt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",lt="String expected.",kt=[],Vt="__dbnames",zn="readonly",Xr="readwrite";function Rt(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var Ka={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Qr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=ce(s))[n],s}}function tl(){throw q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function at(n,s){try{var l=nl(n),c=nl(s);if(l!==c)return l==="Array"?1:c==="Array"?-1:l==="binary"?1:c==="binary"?-1:l==="string"?1:c==="string"?-1:l==="Date"?1:c!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=rl(n),p=rl(s),y=f.length,w=p.length,P=y<w?y:w,K=0;K<P;++K)if(f[K]!==p[K])return f[K]<p[K]?-1:1;return y===w?0:y<w?-1:1;case"Array":for(var R=n,C=s,D=R.length,M=C.length,O=D<M?D:M,I=0;I<O;++I){var G=at(R[I],C[I]);if(G!==0)return G}return D===M?0:D<M?-1:1}}catch{}return NaN}function nl(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=le(n))==="ArrayBuffer")?"binary":s}function rl(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Es(n,s,l){var c=n.schema.yProps;return c?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(c.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}al.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var c=s.remove;if(d(c))return d(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Ua=al;function al(n){this["@@propmod"]=n}function sl(n,s){for(var l=u(s),c=l.length,f=!1,p=0;p<c;++p){var y=l[p],w=s[y],P=J(n,y);w instanceof Ua?(U(n,y,w.execute(P)),f=!0):P!==w&&(U(n,y,w),f=!0)}return f}Tt.prototype._trans=function(n,s,l){var c=this._tx||je.trans,f=this.name,p=rt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function y(K,R,C){if(C.schema[f])return s(C.idbtrans,C);throw new q.NotFound("Table "+f+" not part of transaction")}var w=qn();try{var P=c&&c.db._novip===this.db._novip?c===je.trans?c._promise(n,y,l):Cn(function(){return c._promise(n,y,l)},{trans:c,transless:je.transless||je}):(function K(R,C,D,M){if(R.idbdb&&(R._state.openComplete||je.letThrough||R._vip)){var O=R._createTransaction(C,D,R._dbSchema);try{O.create(),R._state.PR1398_maxLoop=3}catch(I){return I.name===qe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return K(R,C,D,M)})):ke(I)}return O._promise(C,function(I,G){return Cn(function(){return je.trans=O,M(I,G,O)})}).then(function(I){if(C==="readwrite")try{O.idbtrans.commit()}catch{}return C==="readonly"?I:O._completion.then(function(){return I})})}if(R._state.openComplete)return ke(new q.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return ke(new q.DatabaseClosed);R.open().catch(xe)}return R._state.dbReadyPromise.then(function(){return K(R,C,D,M)})})(this.db,n,[this.name],y);return p&&(P._consoleTask=p,P=P.catch(function(K){return console.trace(K),ke(K)})),P}finally{w&&Bn()}},Tt.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?ke(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return l.core.get({trans:c,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},Tt.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=u(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(w){if(w.compound&&s.every(function(K){return 0<=w.keyPath.indexOf(K)})){for(var P=0;P<s.length;++P)if(s.indexOf(w.keyPath[P])===-1)return!1;return!0}return!1}).sort(function(w,P){return w.keyPath.length-P.keyPath.length})[0];if(l&&this.db._maxKey!==st)return y=l.keyPath.slice(0,s.length),this.where(y).equals(y.map(function(w){return n[w]}));!l&&rt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function f(w,P){return at(w,P)===0}var y=s.reduce(function(R,P){var K=R[0],R=R[1],C=c[P],D=n[P];return[K||C,K||!C?Rt(R,C&&C.multi?function(M){return M=J(M,P),d(M)&&M.some(function(O){return f(D,O)})}:function(M){return f(D,J(M,P))}):R]},[null,null]),p=y[0],y=y[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(y):l?this.filter(y):this.where(s).equals("")},Tt.prototype.filter=function(n){return this.toCollection().and(n)},Tt.prototype.count=function(n){return this.toCollection().count(n)},Tt.prototype.offset=function(n){return this.toCollection().offset(n)},Tt.prototype.limit=function(n){return this.toCollection().limit(n)},Tt.prototype.each=function(n){return this.toCollection().each(n)},Tt.prototype.toArray=function(n){return this.toCollection().toArray(n)},Tt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Tt.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},Tt.prototype.reverse=function(){return this.toCollection().reverse()},Tt.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,c=((this.schema.mappedClass=n).prototype instanceof tl&&(n=(y=>{var w=R,P=y;if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");function K(){this.constructor=w}function R(){return y!==null&&y.apply(this,arguments)||this}return r(w,P),w.prototype=P===null?Object.create(P):(K.prototype=P.prototype,new K),Object.defineProperty(R.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),R.prototype.table=function(){return l},R})(n)),new Set),f=n.prototype;f;f=v(f))Object.getOwnPropertyNames(f).forEach(function(y){return c.add(y)});function p(y){if(!y)return y;var w,P=Object.create(n.prototype);for(w in y)if(!c.has(w))try{P[w]=y[w]}catch{}return P}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},Tt.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},Tt.prototype.add=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,y=n;return p&&f&&(y=Qr(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"add",keys:s!=null?[s]:null,values:[y]})}).then(function(w){return w.numFailures?Ae.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{U(n,p,w)}catch{}return w})},Tt.prototype.upsert=function(n,s){var l=this,c=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var y=p??{};return sl(y,s),c&&U(y,c,n),l.core.mutate({trans:f,type:"put",values:[y],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(w){return w.numFailures?Ae.reject(w.failures[0]):!!p})})})},Tt.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=J(n,this.schema.primKey.keyPath))===void 0?ke(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},Tt.prototype.put=function(n,s){var l=this,c=this.schema.primKey,f=c.auto,p=c.keyPath,y=n;return p&&f&&(y=Qr(p)(n)),this._trans("readwrite",function(w){return l.core.mutate({trans:w,type:"put",values:[y],keys:s!=null?[s]:null})}).then(function(w){return w.numFailures?Ae.reject(w.failures[0]):w.lastResult}).then(function(w){if(p)try{U(n,p,w)}catch{}return w})},Tt.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(c){return Es(s,[n],c)}).then(function(c){return c.numFailures?Ae.reject(c.failures[0]):void 0})})},Tt.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:Ka}).then(function(l){return Es(n,null,l)})}).then(function(s){return s.numFailures?Ae.reject(s.failures[0]):void 0})},Tt.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(c){return c.map(function(f){return s.hook.reading.fire(f)})})})},Tt.prototype.bulkAdd=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&f)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var P=n.length,K=w&&K?n.map(Qr(w)):n;return c.core.mutate({trans:y,type:"add",keys:f,values:K,wantResults:p}).then(function(R){var C=R.numFailures,D=R.failures;if(C===0)return p?R.results:R.lastResult;throw new Ue("".concat(c.name,".bulkAdd(): ").concat(C," of ").concat(P," operations failed"),D)})})},Tt.prototype.bulkPut=function(n,s,l){var c=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(y){var w=c.schema.primKey,K=w.auto,w=w.keyPath;if(w&&f)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var P=n.length,K=w&&K?n.map(Qr(w)):n;return c.core.mutate({trans:y,type:"put",keys:f,values:K,wantResults:p}).then(function(R){var C=R.numFailures,D=R.failures;if(C===0)return p?R.results:R.lastResult;throw new Ue("".concat(c.name,".bulkPut(): ").concat(C," of ").concat(P," operations failed"),D)})})},Tt.prototype.bulkUpdate=function(n){var s=this,l=this.core,c=n.map(function(y){return y.key}),f=n.map(function(y){return y.changes}),p=[];return this._trans("readwrite",function(y){return l.getMany({trans:y,keys:c,cache:"clone"}).then(function(w){var P=[],K=[],R=(n.forEach(function(C,D){var M=C.key,O=C.changes,I=w[D];if(I){for(var G=0,V=Object.keys(O);G<V.length;G++){var F=V[G],se=O[F];if(F===s.schema.primKey.keyPath){if(at(se,M)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else U(I,F,se)}p.push(D),P.push(M),K.push(I)}}),P.length);return l.mutate({trans:y,type:"put",keys:P,values:K,updates:{keys:c,changeSpecs:f}}).then(function(C){var D=C.numFailures,M=C.failures;if(D===0)return R;for(var O=0,I=Object.keys(M);O<I.length;O++){var G,V=I[O],F=p[Number(V)];F!=null&&(G=M[V],delete M[V],M[F]=G)}throw new Ue("".concat(s.name,".bulkUpdate(): ").concat(D," of ").concat(R," operations failed"),M)})})})},Tt.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:n}).then(function(f){return Es(s,n,f)})}).then(function(c){var f=c.numFailures,p=c.failures;if(f===0)return c.lastResult;throw new Ue("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var il=Tt;function Tt(){}function Ga(n){function s(y,w){if(w){for(var P=arguments.length,K=new Array(P-1);--P;)K[P-1]=arguments[P];return l[y].subscribe.apply(null,K),n}if(typeof y=="string")return l[y]}var l={};s.addEventType=p;for(var c=1,f=arguments.length;c<f;++c)p(arguments[c]);return s;function p(y,w,P){var K,R;if(typeof y!="object")return w=w||Ve,R={subscribers:[],fire:P=P||xe,subscribe:function(C){R.subscribers.indexOf(C)===-1&&(R.subscribers.push(C),R.fire=w(R.fire,C))},unsubscribe:function(C){R.subscribers=R.subscribers.filter(function(D){return D!==C}),R.fire=R.subscribers.reduce(w,P)}},l[y]=s[y]=R;u(K=y).forEach(function(C){var D=K[C];if(d(D))p(C,K[C][0],K[C][1]);else{if(D!=="asap")throw new q.InvalidArgument("Invalid event config");var M=p(C,De,function(){for(var O=arguments.length,I=new Array(O);O--;)I[O]=arguments[O];M.subscribers.forEach(function(G){ee(function(){G.apply(null,I)})})})}})}}function Ha(n,s){return E(s).from({prototype:n}),s}function ka(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function yi(n,s){n.filter=Rt(n.filter,s)}function _i(n,s,l){var c=n.replayFilter;n.replayFilter=c?function(){return Rt(c(),s())}:s,n.justLimit=l&&!c}function As(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new q.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function ol(n,s,l){var c=As(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:c,range:n.range}})}function Cs(n,s,l,c){var f,p,y=n.replayFilter?Rt(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(w,P,K){var R,C;y&&!y(P,K,function(D){return P.stop(D)},function(D){return P.fail(D)})||((C=""+(R=P.primaryKey))=="[object ArrayBuffer]"&&(C=""+new Uint8Array(R)),S(f,C))||(f[C]=!0,s(w,P,K))},Promise.all([n.or._iterate(p,l),ll(ol(n,c,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):ll(ol(n,c,l),Rt(n.algorithm,y),s,!n.keysOnly&&n.valueMapper)}function ll(n,s,l,c){var f=yt(c?function(p,y,w){return l(c(p),y,w)}:l);return n.then(function(p){if(p)return p.start(function(){var y=function(){return p.continue()};s&&!s(p,function(w){return y=w},function(w){p.stop(w),y=xe},function(w){p.fail(w),y=xe})||f(p.value,p,function(w){return y=w}),y()})})}ft.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,ke.bind(null,l.error)):l.table._trans("readonly",n).then(s)},ft.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,ke.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},ft.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=Rt(s.algorithm,n)},ft.prototype._iterate=function(n,s){return Cs(this._ctx,n,s,this._ctx.table.core)},ft.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&h(l,n),s._ctx=l,s},ft.prototype.raw=function(){return this._ctx.valueMapper=null,this},ft.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return Cs(s,n,l,s.table.core)})},ft.prototype.count=function(n){var s=this;return this._read(function(l){var c,f=s._ctx,p=f.table.core;return ka(f,!0)?p.count({trans:l,query:{index:As(f,p.schema),range:f.range}}).then(function(y){return Math.min(y,f.limit)}):(c=0,Cs(f,function(){return++c,!1},l,p).then(function(){return c}))}).then(n)},ft.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),c=l[0],f=l.length-1;function p(P,K){return K?p(P[l[K]],K-1):P[c]}var y=this._ctx.dir==="next"?1:-1;function w(P,K){return at(p(P,f),p(K,f))*y}return this.toArray(function(P){return P.sort(w)}).then(s)},ft.prototype.toArray=function(n){var s=this;return this._read(function(l){var c,f,p,y=s._ctx;return y.dir==="next"&&ka(y,!0)&&0<y.limit?(c=y.valueMapper,f=As(y,y.table.core.schema),y.table.core.query({trans:l,limit:y.limit,values:!0,query:{index:f,range:y.range}}).then(function(w){return w=w.result,c?w.map(c):w})):(p=[],Cs(y,function(w){return p.push(w)},l,y.table.core).then(function(){return p}))},n)},ft.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,ka(s)?_i(s,function(){var l=n;return function(c,f){return l===0||(l===1?--l:f(function(){c.advance(l),l=0}),!1)}}):_i(s,function(){var l=n;return function(){return--l<0}})),this},ft.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),_i(this._ctx,function(){var s=n;return function(l,c,f){return--s<=0&&c(f),0<=s}},!0),this},ft.prototype.until=function(n,s){return yi(this._ctx,function(l,c,f){return!n(l.value)||(c(f),s)}),this},ft.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},ft.prototype.last=function(n){return this.reverse().first(n)},ft.prototype.filter=function(n){var s;return yi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=Rt(s.isMatch,n),this},ft.prototype.and=function(n){return this.filter(n)},ft.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},ft.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ft.prototype.desc=function(){return this.reverse()},ft.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.key,c)})},ft.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},ft.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,c){n(c.primaryKey,c)})},ft.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(c,f){l.push(f.key)}).then(function(){return l}).then(n)},ft.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&ka(s,!0)&&0<s.limit)return this._read(function(c){var f=As(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(c){return c.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(c,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},ft.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},ft.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},ft.prototype.lastKey=function(n){return this.reverse().firstKey(n)},ft.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},yi(this._ctx,function(c){var c=c.primaryKey.toString(),f=S(n,c);return n[c]=!0,!f})),this},ft.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(c){function f(I,G){var V=G.failures;D+=I-G.numFailures;for(var F=0,se=u(V);F<se.length;F++){var he=se[F];C.push(V[he])}}var p=typeof n=="function"?n:function(I){return sl(I,n)},y=l.table.core,R=y.schema.primaryKey,w=R.outbound,P=R.extractKey,K=200,R=s.db._options.modifyChunkSize,C=(R&&(K=typeof R=="object"?R[y.name]||R["*"]||200:R),[]),D=0,M=[],O=n===cl;return s.clone().primaryKeys().then(function(I){function G(F){var se=Math.min(K,I.length-F),he=I.slice(F,F+se);return(O?Promise.resolve([]):y.getMany({trans:c,keys:he,cache:"immutable"})).then(function(Se){var Te=[],ye=[],Le=w?[]:null,Pe=O?he:[];if(!O)for(var we=0;we<se;++we){var Ne=Se[we],it={value:ce(Ne),primKey:I[F+we]};p.call(it,it.value,it)!==!1&&(it.value==null?Pe.push(I[F+we]):w||at(P(Ne),P(it.value))===0?(ye.push(it.value),w&&Le.push(I[F+we])):(Pe.push(I[F+we]),Te.push(it.value)))}return Promise.resolve(0<Te.length&&y.mutate({trans:c,type:"add",values:Te}).then(function(dt){for(var Fe in dt.failures)Pe.splice(parseInt(Fe),1);f(Te.length,dt)})).then(function(){return(0<ye.length||V&&typeof n=="object")&&y.mutate({trans:c,type:"put",keys:Le,values:ye,criteria:V,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<F}).then(function(dt){return f(ye.length,dt)})}).then(function(){return(0<Pe.length||V&&O)&&y.mutate({trans:c,type:"delete",keys:Pe,criteria:V,isAdditionalChunk:0<F}).then(function(dt){return Es(l.table,Pe,dt)}).then(function(dt){return f(Pe.length,dt)})}).then(function(){return I.length>F+se&&G(F+K)})})}var V=ka(l)&&l.limit===1/0&&(typeof n!="function"||O)&&{index:l.index,range:l.range};return G(0).then(function(){if(0<C.length)throw new Be("Error modifying one or more objects",C,D,M);return I.length})})})},ft.prototype.delete=function(){var n=this._ctx,s=n.range;return!ka(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify(cl):this._write(function(l){var c=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:c,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(P){var w=P.failures,P=P.numFailures;if(P)throw new Be("Could not delete some values",Object.keys(w).map(function(K){return w[K]}),p-P);return p-P})})})};var tf=ft;function ft(){}var cl=function(n,s){return s.value=null};function nf(n,s){return n<s?-1:n===s?0:1}function rf(n,s){return s<n?-1:n===s?0:1}function Rn(n,s,l){return n=n instanceof fl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function xa(n){return new n.Collection(n,function(){return ul("")}).limit(0)}function Is(M,s,l,c){var f,p,y,w,P,K,R,C=l.length;if(!l.every(function(I){return typeof I=="string"}))return Rn(M,lt);function D(I){f=I==="next"?function(V){return V.toUpperCase()}:function(V){return V.toLowerCase()},p=I==="next"?function(V){return V.toLowerCase()}:function(V){return V.toUpperCase()},y=I==="next"?nf:rf;var G=l.map(function(V){return{lower:p(V),upper:f(V)}}).sort(function(V,F){return y(V.lower,F.lower)});w=G.map(function(V){return V.upper}),P=G.map(function(V){return V.lower}),R=(K=I)==="next"?"":c}D("next");var M=new M.Collection(M,function(){return Mr(w[0],P[C-1]+c)}),O=(M._ondirectionchange=function(I){D(I)},0);return M._addAlgorithm(function(I,G,V){var F=I.key;if(typeof F=="string"){var se=p(F);if(s(se,P,O))return!0;for(var he=null,Se=O;Se<C;++Se){var Te=((ye,Le,Pe,we,Ne,it)=>{for(var dt=Math.min(ye.length,we.length),Fe=-1,Ye=0;Ye<dt;++Ye){var Mt=Le[Ye];if(Mt!==we[Ye])return Ne(ye[Ye],Pe[Ye])<0?ye.substr(0,Ye)+Pe[Ye]+Pe.substr(Ye+1):Ne(ye[Ye],we[Ye])<0?ye.substr(0,Ye)+we[Ye]+Pe.substr(Ye+1):0<=Fe?ye.substr(0,Fe)+Le[Fe]+Pe.substr(Fe+1):null;Ne(ye[Ye],Mt)<0&&(Fe=Ye)}return dt<we.length&&it==="next"?ye+Pe.substr(ye.length):dt<ye.length&&it==="prev"?ye.substr(0,Pe.length):Fe<0?null:ye.substr(0,Fe)+we[Fe]+Pe.substr(Fe+1)})(F,se,w[Se],P[Se],y,K);Te===null&&he===null?O=Se+1:(he===null||0<y(he,Te))&&(he=Te)}G(he!==null?function(){I.continue(he+R)}:V)}return!1}),M}function Mr(n,s,l,c){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:c}}function ul(n){return{type:1,lower:n,upper:n}}Object.defineProperty(Yt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Yt.prototype.between=function(n,s,l,c){l=l!==!1,c=c===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||c)&&(!l||!c)?xa(this):new this.Collection(this,function(){return Mr(n,s,!l,!c)})}catch{return Rn(this,bt)}},Yt.prototype.equals=function(n){return n==null?Rn(this,bt):new this.Collection(this,function(){return ul(n)})},Yt.prototype.above=function(n){return n==null?Rn(this,bt):new this.Collection(this,function(){return Mr(n,void 0,!0)})},Yt.prototype.aboveOrEqual=function(n){return n==null?Rn(this,bt):new this.Collection(this,function(){return Mr(n,void 0,!1)})},Yt.prototype.below=function(n){return n==null?Rn(this,bt):new this.Collection(this,function(){return Mr(void 0,n,!1,!0)})},Yt.prototype.belowOrEqual=function(n){return n==null?Rn(this,bt):new this.Collection(this,function(){return Mr(void 0,n)})},Yt.prototype.startsWith=function(n){return typeof n!="string"?Rn(this,lt):this.between(n,n+st,!0,!0)},Yt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Is(this,function(s,l){return s.indexOf(l[0])===0},[n],st)},Yt.prototype.equalsIgnoreCase=function(n){return Is(this,function(s,l){return s===l[0]},[n],"")},Yt.prototype.anyOfIgnoreCase=function(){var n=me.apply(ue,arguments);return n.length===0?xa(this):Is(this,function(s,l){return l.indexOf(s)!==-1},n,"")},Yt.prototype.startsWithAnyOfIgnoreCase=function(){var n=me.apply(ue,arguments);return n.length===0?xa(this):Is(this,function(s,l){return l.some(function(c){return s.indexOf(c)===0})},n,st)},Yt.prototype.anyOf=function(){var n,s,l=this,c=me.apply(ue,arguments),f=this._cmp;try{c.sort(f)}catch{return Rn(this,bt)}return c.length===0?xa(this):((n=new this.Collection(this,function(){return Mr(c[0],c[c.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,c.sort(f)},s=0,n._addAlgorithm(function(p,y,w){for(var P=p.key;0<f(P,c[s]);)if(++s===c.length)return y(w),!1;return f(P,c[s])===0||(y(function(){p.continue(c[s])}),!1)}),n)},Yt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Yt.prototype.noneOf=function(){var n=me.apply(ue,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Rn(this,bt)}var s=n.reduce(function(l,c){return l?l.concat([[l[l.length-1][1],c]]):[[-1/0,c]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Yt.prototype.inAnyRange=function(n,V){var l=this,c=this._cmp,f=this._ascending,p=this._descending,y=this._min,w=this._max;if(n.length===0)return xa(this);if(!n.every(function(F){return F[0]!==void 0&&F[1]!==void 0&&f(F[0],F[1])<=0}))return Rn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var P=!V||V.includeLowers!==!1,K=V&&V.includeUppers===!0,R,C=f;function D(F,se){return C(F[0],se[0])}try{(R=n.reduce(function(F,se){for(var he=0,Se=F.length;he<Se;++he){var Te=F[he];if(c(se[0],Te[1])<0&&0<c(se[1],Te[0])){Te[0]=y(Te[0],se[0]),Te[1]=w(Te[1],se[1]);break}}return he===Se&&F.push(se),F},[])).sort(D)}catch{return Rn(this,bt)}var M=0,O=K?function(F){return 0<f(F,R[M][1])}:function(F){return 0<=f(F,R[M][1])},I=P?function(F){return 0<p(F,R[M][0])}:function(F){return 0<=p(F,R[M][0])},G=O,V=new this.Collection(this,function(){return Mr(R[0][0],R[R.length-1][1],!P,!K)});return V._ondirectionchange=function(F){C=F==="next"?(G=O,f):(G=I,p),R.sort(D)},V._addAlgorithm(function(F,se,he){for(var Se,Te=F.key;G(Te);)if(++M===R.length)return se(he),!1;return!O(Se=Te)&&!I(Se)||(l._cmp(Te,R[M][1])===0||l._cmp(Te,R[M][0])===0||se(function(){C===f?F.continue(R[M][0]):F.continue(R[M][1])}),!1)}),V},Yt.prototype.startsWithAnyOf=function(){var n=me.apply(ue,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?xa(this):this.inAnyRange(n.map(function(s){return[s,s+st]})):Rn(this,"startsWithAnyOf() only works with strings")};var fl=Yt;function Yt(){}function dr(n){return yt(function(s){return Wa(s),n(s.target.error),!1})}function Wa(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Va="storagemutated",bi="x-storagemutated-1",Lr=Ga(null,Va),af=(vr.prototype._lock=function(){return Y(!je.global),++this._reculock,this._reculock!==1||je.global||(je.lockOwnerFor=this),this},vr.prototype._unlock=function(){if(Y(!je.global),--this._reculock==0)for(je.global||(je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Me(n[1],n[0])}catch{}}return this},vr.prototype._locked=function(){return this._reculock&&je.lockOwnerFor!==this},vr.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,c=this.db._state.dbOpenError;if(Y(!this.idbtrans),!n&&!l)switch(c&&c.name){case"DatabaseClosedError":throw new q.DatabaseClosed(c);case"MissingAPIError":throw new q.MissingAPI(c.message,c);default:throw new q.OpenFailed(c)}if(!this.active)throw new q.TransactionInactive;Y(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=yt(function(f){Wa(f),s._reject(n.error)}),n.onabort=yt(function(f){Wa(f),s.active&&s._reject(new q.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=yt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&Lr.storagemutated.fire(n.mutatedParts)})}return this},vr.prototype._promise=function(n,s,l){var c,f=this;return n==="readwrite"&&this.mode!=="readwrite"?ke(new q.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ae(function(p,y){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,y)},je])}):l?Cn(function(){var p=new Ae(function(y,w){f._lock();var P=s(y,w,f);P&&P.then&&P.then(y,w)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((c=new Ae(function(p,y){var w=s(p,y,f);w&&w.then&&w.then(p,y)}))._lib=!0,c):ke(new q.TransactionInactive)},vr.prototype._root=function(){return this.parent?this.parent._root():this},vr.prototype.waitFor=function(n){var s,l=this._root(),c=Ae.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return c}):(l._waitingFor=c,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new Ae(function(p,y){c.then(function(w){return l._waitingQueue.push(yt(p.bind(null,w)))},function(w){return l._waitingQueue.push(yt(y.bind(null,w)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},vr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},vr.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(S(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new q.NotFound("Table "+n+" not part of transaction")},vr);function vr(){}function wi(n,s,l,c,f,p,y,w){return{name:n,keyPath:s,unique:l,multi:c,auto:f,compound:p,src:(l&&!y?"&":"")+(c?"*":"")+(f?"++":"")+dl(s),type:w}}function dl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function ki(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(c=function(f){return[f.name,f]},l.reduce(function(f,p,y){return p=c(p,y),p&&(f[p[0]]=p[1]),f},{}))};var c}var Ya=function(n){try{return n.only([[]]),Ya=function(){return[[]]},[[]]}catch{return Ya=function(){return st},st}};function xi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return J(l,s)}:function(l){return J(l,n)};var s}function vl(n){return[].slice.call(n)}var sf=0;function Xa(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function of(n,s,P){function c(O){if(O.type===3)return null;if(O.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var C=O.lower,D=O.upper,M=O.lowerOpen,O=O.upperOpen;return C===void 0?D===void 0?null:s.upperBound(D,!!O):D===void 0?s.lowerBound(C,!!M):s.bound(C,D,!!M,!!O)}function f(R){var C,D=R.name;return{name:D,schema:R,mutate:function(M){var O=M.trans,I=M.type,G=M.keys,V=M.values,F=M.range;return new Promise(function(se,he){se=yt(se);var Se=O.objectStore(D),Te=Se.keyPath==null,ye=I==="put"||I==="add";if(!ye&&I!=="delete"&&I!=="deleteRange")throw new Error("Invalid operation type: "+I);var Le,Pe=(G||V||{length:1}).length;if(G&&V&&G.length!==V.length)throw new Error("Given keys array must have same length as given values array.");if(Pe===0)return se({numFailures:0,failures:{},results:[],lastResult:void 0});function we(Nt){++dt,Wa(Nt)}var Ne=[],it=[],dt=0;if(I==="deleteRange"){if(F.type===4)return se({numFailures:dt,failures:it,results:[],lastResult:void 0});F.type===3?Ne.push(Le=Se.clear()):Ne.push(Le=Se.delete(c(F)))}else{var Te=ye?Te?[V,G]:[V,null]:[G,null],Fe=Te[0],Ye=Te[1];if(ye)for(var Mt=0;Mt<Pe;++Mt)Ne.push(Le=Ye&&Ye[Mt]!==void 0?Se[I](Fe[Mt],Ye[Mt]):Se[I](Fe[Mt])),Le.onerror=we;else for(Mt=0;Mt<Pe;++Mt)Ne.push(Le=Se[I](Fe[Mt])),Le.onerror=we}function Fn(Nt){Nt=Nt.target.result,Ne.forEach(function($r,Fi){return $r.error!=null&&(it[Fi]=$r.error)}),se({numFailures:dt,failures:it,results:I==="delete"?G:Ne.map(function($r){return $r.result}),lastResult:Nt})}Le.onerror=function(Nt){we(Nt),Fn(Nt)},Le.onsuccess=Fn})},getMany:function(M){var O=M.trans,I=M.keys;return new Promise(function(G,V){G=yt(G);for(var F,se=O.objectStore(D),he=I.length,Se=new Array(he),Te=0,ye=0,Le=function(Ne){Ne=Ne.target,Se[Ne._pos]=Ne.result,++ye===Te&&G(Se)},Pe=dr(V),we=0;we<he;++we)I[we]!=null&&((F=se.get(I[we]))._pos=we,F.onsuccess=Le,F.onerror=Pe,++Te);Te===0&&G(Se)})},get:function(M){var O=M.trans,I=M.key;return new Promise(function(G,V){G=yt(G);var F=O.objectStore(D).get(I);F.onsuccess=function(se){return G(se.target.result)},F.onerror=dr(V)})},query:(C=w,function(M){return new Promise(function(O,I){O=yt(O);var G,V,F,ye=M.trans,se=M.values,he=M.limit,Te=M.query,Se=he===1/0?void 0:he,Le=Te.index,Te=Te.range,ye=ye.objectStore(D),ye=Le.isPrimaryKey?ye:ye.index(Le.name),Le=c(Te);if(he===0)return O({result:[]});C?((Te=se?ye.getAll(Le,Se):ye.getAllKeys(Le,Se)).onsuccess=function(Pe){return O({result:Pe.target.result})},Te.onerror=dr(I)):(G=0,V=!se&&"openKeyCursor"in ye?ye.openKeyCursor(Le):ye.openCursor(Le),F=[],V.onsuccess=function(Pe){var we=V.result;return!we||(F.push(se?we.value:we.primaryKey),++G===he)?O({result:F}):void we.continue()},V.onerror=dr(I))})}),openCursor:function(M){var O=M.trans,I=M.values,G=M.query,V=M.reverse,F=M.unique;return new Promise(function(se,he){se=yt(se);var ye=G.index,Se=G.range,Te=O.objectStore(D),Te=ye.isPrimaryKey?Te:Te.index(ye.name),ye=V?F?"prevunique":"prev":F?"nextunique":"next",Le=!I&&"openKeyCursor"in Te?Te.openKeyCursor(c(Se),ye):Te.openCursor(c(Se),ye);Le.onerror=dr(he),Le.onsuccess=yt(function(Pe){var we,Ne,it,dt,Fe=Le.result;Fe?(Fe.___id=++sf,Fe.done=!1,we=Fe.continue.bind(Fe),Ne=(Ne=Fe.continuePrimaryKey)&&Ne.bind(Fe),it=Fe.advance.bind(Fe),dt=function(){throw new Error("Cursor not stopped")},Fe.trans=O,Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=function(){throw new Error("Cursor not started")},Fe.fail=yt(he),Fe.next=function(){var Ye=this,Mt=1;return this.start(function(){return Mt--?Ye.continue():Ye.stop()}).then(function(){return Ye})},Fe.start=function(Ye){function Mt(){if(Le.result)try{Ye()}catch(Nt){Fe.fail(Nt)}else Fe.done=!0,Fe.start=function(){throw new Error("Cursor behind last entry")},Fe.stop()}var Fn=new Promise(function(Nt,$r){Nt=yt(Nt),Le.onerror=dr($r),Fe.fail=$r,Fe.stop=function(Fi){Fe.stop=Fe.continue=Fe.continuePrimaryKey=Fe.advance=dt,Nt(Fi)}});return Le.onsuccess=yt(function(Nt){Le.onsuccess=Mt,Mt()}),Fe.continue=we,Fe.continuePrimaryKey=Ne,Fe.advance=it,Mt(),Fn},se(Fe)):se(null)},he)})},count:function(M){var O=M.query,I=M.trans,G=O.index,V=O.range;return new Promise(function(F,se){var he=I.objectStore(D),he=G.isPrimaryKey?he:he.index(G.name),Se=c(V),Se=Se?he.count(Se):he.count();Se.onsuccess=yt(function(Te){return F(Te.target.result)}),Se.onerror=dr(se)})}}}p=P,y=vl((P=n).objectStoreNames);var p,P={schema:{name:P.name,tables:y.map(function(R){return p.objectStore(R)}).map(function(R){var C=R.keyPath,D=R.autoIncrement,O=d(C),M={},O={name:R.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:C==null,compound:O,keyPath:C,autoIncrement:D,unique:!0,extractKey:xi(C)},indexes:vl(R.indexNames).map(function(I){return R.index(I)}).map(function(F){var se=F.name,G=F.unique,V=F.multiEntry,F=F.keyPath,se={name:se,compound:d(F),keyPath:F,unique:G,multiEntry:V,extractKey:xi(F)};return M[Xa(F)]=se}),getIndexByKeyPath:function(I){return M[Xa(I)]}};return M[":id"]=O.primaryKey,C!=null&&(M[Xa(C)]=O.primaryKey),O})},hasGetAll:0<y.length&&"getAll"in p.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},y=P.schema,w=P.hasGetAll,P=y.tables.map(f),K={};return P.forEach(function(R){return K[R.name]=R}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(R){if(K[R])return K[R];throw new Error("Table '".concat(R,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ya(s),schema:y}}function lf(n,s,l,c){return l=l.IDBKeyRange,s=of(s,l,c),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function Ps(n,s){var l=s.db,l=lf(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(c){var f=c.name;n.core.schema.tables.some(function(p){return p.name===f})&&(c.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=c.core)})}function Rs(n,s,l,c){l.forEach(function(f){var p=c[f];s.forEach(function(y){var w=(function P(K,R){return T(K,R)||(K=v(K))&&P(K,R)})(y,f);(!w||"value"in w&&w.value===void 0)&&(y===n.Transaction.prototype||y instanceof n.Transaction?N(y,f,{get:function(){return this.table(f)},set:function(P){k(this,f,{value:P,writable:!0,configurable:!0,enumerable:!0})}}):y[f]=new n.Table(f,p))})})}function Si(n,s){s.forEach(function(l){for(var c in l)l[c]instanceof n.Table&&delete l[c]})}function cf(n,s){return n._cfg.version-s._cfg.version}function uf(n,s,l,c){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=ki("$meta",hl("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),y=(p.create(l),p._completion.catch(c),p._reject.bind(p)),w=je.transless||je;Cn(function(){if(je.trans=p,je.transless=w,s!==0)return Ps(n,l),K=s,((P=p).storeNames.includes("$meta")?P.table("$meta").get("version").then(function(R){return R??K}):Ae.resolve(K)).then(function(G){var C=n,D=G,M=p,O=l,I=[],G=C._versions,V=C._dbSchema=Ds(0,C.idbdb,O);return(G=G.filter(function(F){return F._cfg.version>=D})).length===0?Ae.resolve():(G.forEach(function(F){I.push(function(){var se,he,Se,Te=V,ye=F._cfg.dbschema,Le=(js(C,Te,O),js(C,ye,O),V=C._dbSchema=ye,Ti(Te,ye)),Pe=(Le.add.forEach(function(we){Ei(O,we[0],we[1].primKey,we[1].indexes)}),Le.change.forEach(function(we){if(we.recreate)throw new q.Upgrade("Not yet support for changing primary key");var Ne=O.objectStore(we.name);we.add.forEach(function(it){return Os(Ne,it)}),we.change.forEach(function(it){Ne.deleteIndex(it.name),Os(Ne,it)}),we.del.forEach(function(it){return Ne.deleteIndex(it)})}),F._cfg.contentUpgrade);if(Pe&&F._cfg.version>D)return Ps(C,O),M._memoizedTables={},se=de(ye),Le.del.forEach(function(we){se[we]=Te[we]}),Si(C,[C.Transaction.prototype]),Rs(C,[C.Transaction.prototype],u(se),se),M.schema=se,(he=be(Pe))&&Wt(),ye=Ae.follow(function(){var we;(Se=Pe(M))&&he&&(we=In.bind(null,null),Se.then(we,we))}),Se&&typeof Se.then=="function"?Ae.resolve(Se):ye.then(function(){return Se})}),I.push(function(se){var he,Se,Te=F._cfg.dbschema;he=Te,Se=se,[].slice.call(Se.db.objectStoreNames).forEach(function(ye){return he[ye]==null&&Se.db.deleteObjectStore(ye)}),Si(C,[C.Transaction.prototype]),Rs(C,[C.Transaction.prototype],C._storeNames,C._dbSchema),M.schema=C._dbSchema}),I.push(function(se){C.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(C.idbdb.version/10)===F._cfg.version?(C.idbdb.deleteObjectStore("$meta"),delete C._dbSchema.$meta,C._storeNames=C._storeNames.filter(function(he){return he!=="$meta"})):se.objectStore("$meta").put(F._cfg.version,"version"))})}),(function F(){return I.length?Ae.resolve(I.shift()(M.idbtrans)).then(F):Ae.resolve()})().then(function(){pl(V,O)}))}).catch(y);var P,K;u(f).forEach(function(R){Ei(l,R,f[R].primKey,f[R].indexes)}),Ps(n,l),Ae.follow(function(){return n.on.populate.fire(p)}).catch(y)})}function ff(n,s){pl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Ds(0,n.idbdb,s);js(n,n._dbSchema,s);for(var c=0,f=Ti(l,n._dbSchema).change;c<f.length;c++){var p=(y=>{if(y.change.length||y.recreate)return console.warn("Unable to patch indexes of table ".concat(y.name," because it has changes on the type of index or primary key.")),{value:void 0};var w=s.objectStore(y.name);y.add.forEach(function(P){rt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(y.name,".").concat(P.src)),Os(w,P)})})(f[c]);if(typeof p=="object")return p.value}}function Ti(n,s){var l,c={del:[],add:[],change:[]};for(l in n)s[l]||c.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var y={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)y.recreate=!0,c.change.push(y);else{var w=f.idxByName,P=p.idxByName,K=void 0;for(K in w)P[K]||y.del.push(K);for(K in P){var R=w[K],C=P[K];R?R.src!==C.src&&y.change.push(C):y.add.push(C)}(0<y.del.length||0<y.add.length||0<y.change.length)&&c.change.push(y)}}else c.add.push([l,p])}return c}function Ei(n,s,l,c){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});c.forEach(function(p){return Os(f,p)})}function pl(n,s){u(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(rt&&console.debug("Dexie: Creating missing table",l),Ei(s,l,n[l].primKey,n[l].indexes))})}function Os(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Ds(n,s,l){var c={};return W(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),y=wi(dl(K=p.keyPath),K||"",!0,!1,!!p.autoIncrement,K&&typeof K!="string",!0),w=[],P=0;P<p.indexNames.length;++P){var R=p.index(p.indexNames[P]),K=R.keyPath,R=wi(R.name,K,!!R.unique,!!R.multiEntry,!1,K&&typeof K!="string",!1);w.push(R)}c[f]=ki(f,y,w)}),c}function js(n,s,l){for(var c=l.db.objectStoreNames,f=0;f<c.length;++f){var p=c[f],y=l.objectStore(p);n._hasGetAll="getAll"in y;for(var w=0;w<y.indexNames.length;++w){var P,K=y.indexNames[w],R=y.index(K).keyPath,R=typeof R=="string"?R:"["+W(R).join("+")+"]";s[p]&&(P=s[p].idxByName[R])&&(P.name=K,delete s[p].idxByName[R],s[p].idxByName[K]=P)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function hl(n){return n.split(",").map(function(s,l){var f=s.split(":"),c=(c=f[1])==null?void 0:c.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return wi(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,c)})}Sa.prototype._createTableSchema=ki,Sa.prototype._parseIndexSyntax=hl,Sa.prototype._parseStoresSpec=function(n,s){var l=this;u(n).forEach(function(c){if(n[c]!==null){var f=l._parseIndexSyntax(n[c]),p=f.shift();if(!p)throw new q.Schema("Invalid schema for table "+c+": "+n[c]);if(p.unique=!0,p.multi)throw new q.Schema("Primary key cannot be multiEntry*");f.forEach(function(y){if(y.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(c,p,f),s[c]=p}})},Sa.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,l):l,s._versions),c={},f={};return l.forEach(function(p){h(c,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(c,f)}),s._dbSchema=f,Si(s,[s._allTables,s,s.Transaction.prototype]),Rs(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],u(f),f),s._storeNames=u(f),this},Sa.prototype.upgrade=function(n){return this._cfg.contentUpgrade=nt(this._cfg.contentUpgrade||xe,n),this};var df=Sa;function Sa(){}function Ai(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new kr(Vt,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Ci(n){return n&&typeof n.databases=="function"}function Ii(n){return Cn(function(){return je.letThrough=!0,n()})}function Pi(n){return!("from"in n)}var on=function(n,s){var l;if(!this)return l=new on,n&&"d"in n&&h(l,n),l;h(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Qa(n,s,l){var c=at(s,l);if(!isNaN(c)){if(0<c)throw RangeError();if(Pi(n))return h(n,{from:s,to:l,d:1});var c=n.l,f=n.r;if(at(l,n.from)<0)return c?Qa(c,s,l):n.l={from:s,to:l,d:1,l:null,r:null},gl(n);if(0<at(s,n.to))return f?Qa(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},gl(n);at(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<at(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,c&&!n.l&&Za(n,c),f&&s&&Za(n,f)}}function Za(n,s){Pi(s)||(function l(c,f){var p=f.from,y=f.l,w=f.r;Qa(c,p,f.to),y&&l(c,y),w&&l(c,w)})(n,s)}function ml(n,s){var l=Ms(s),c=l.next();if(!c.done)for(var f=c.value,p=Ms(n),y=p.next(f.from),w=y.value;!c.done&&!y.done;){if(at(w.from,f.to)<=0&&0<=at(w.to,f.from))return!0;at(f.from,w.from)<0?f=(c=l.next(w.from)).value:w=(y=p.next(f.from)).value}return!1}function Ms(n){var s=Pi(n)?null:{s:0,n};return{next:function(l){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&at(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||at(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function gl(n){var s,l,c,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),c=n[f],n.from=c.from,n.to=c.to,n[f]=c[f],l[f]=c[s],(n[s]=l).d=yl(l)),n.d=yl(n)}function yl(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Ls(n,s){return u(s).forEach(function(l){n[l]?Za(n[l],s[l]):n[l]=(function c(f){var p,y,w={};for(p in f)S(f,p)&&(y=f[p],w[p]=!y||typeof y!="object"||oe.has(y.constructor)?y:c(y));return w})(s[l])}),n}function Ri(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&ml(s[l],n[l])})}x(on.prototype,((vt={add:function(n){return Za(this,n),this},addKey:function(n){return Qa(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Qa(s,l,l)}),this},hasKey:function(n){var s=Ms(this).next(n).value;return s&&at(s.from,n)<=0&&0<=at(s.to,n)}})[ve]=function(){return Ms(this)},vt));var Zr={},Oi={},Di=!1;function Ns(n){Ls(Oi,n),Di||(Di=!0,setTimeout(function(){Di=!1,ji(Oi,!(Oi={}))},0))}function ji(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var c=0,f=Object.values(Zr);c<f.length;c++)_l(w=f[c],n,l,s);else for(var p in n){var y,w,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(y=p[1],p=p[2],w=Zr["idb://".concat(y,"/").concat(p)])&&_l(w,n,l,s)}l.forEach(function(P){return P()})}function _l(n,s,l,c){for(var f=[],p=0,y=Object.entries(n.queries.query);p<y.length;p++){for(var w=y[p],P=w[0],K=[],R=0,C=w[1];R<C.length;R++){var D=C[R];Ri(s,D.obsSet)?D.subscribers.forEach(function(G){return l.add(G)}):c&&K.push(D)}c&&f.push([P,K])}if(c)for(var M=0,O=f;M<O.length;M++){var I=O[M],P=I[0],K=I[1];n.queries.query[P]=K}}function vf(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?ke(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,f=Math.round(10*n.verno),p=!1;function y(){if(s.openCanceller!==c)throw new q.DatabaseClosed("db.open() was cancelled")}function w(){return new Ae(function(D,M){if(y(),!l)throw new q.MissingAPI;var O=n.name,I=s.autoSchema||!f?l.open(O):l.open(O,f);if(!I)throw new q.MissingAPI;I.onerror=dr(M),I.onblocked=yt(n._fireOnBlocked),I.onupgradeneeded=yt(function(G){var V;R=I.transaction,s.autoSchema&&!n._options.allowEmptyDB?(I.onerror=Wa,R.abort(),I.result.close(),(V=l.deleteDatabase(O)).onsuccess=V.onerror=yt(function(){M(new q.NoSuchDatabase("Database ".concat(O," doesnt exist")))})):(R.onerror=dr(M),V=G.oldVersion>Math.pow(2,62)?0:G.oldVersion,C=V<1,n.idbdb=I.result,p&&ff(n,R),uf(n,V/10,R,M))},M),I.onsuccess=yt(function(){R=null;var G,V,F,se,he,Se,Te=n.idbdb=I.result,ye=W(Te.objectStoreNames);if(0<ye.length)try{var Le=Te.transaction((he=ye).length===1?he[0]:he,"readonly");if(s.autoSchema)Se=Te,se=Le,(F=n).verno=Se.version/10,se=F._dbSchema=Ds(0,Se,se),F._storeNames=W(Se.objectStoreNames,0),Rs(F,[F._allTables],u(se),se);else if(js(n,n._dbSchema,Le),V=Le,((V=Ti(Ds(0,(G=n).idbdb,V),G._dbSchema)).add.length||V.change.some(function(Pe){return Pe.add.length||Pe.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Te.close(),f=Te.version+1,p=!0,D(w());Ps(n,Le)}catch{}kt.push(n),Te.onversionchange=yt(function(Pe){s.vcFired=!0,n.on("versionchange").fire(Pe)}),Te.onclose=yt(function(){n.close({disableAutoOpen:!1})}),C&&(ye=n._deps,he=O,Ci(Se=ye.indexedDB)||he===Vt||Ai(Se,ye.IDBKeyRange).put({name:he}).catch(xe)),D()},M)}).catch(function(D){switch(D==null?void 0:D.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),w();break;case"VersionError":if(0<f)return f=0,w()}return Ae.reject(D)})}var P,K=s.dbReadyResolve,R=null,C=!1;return Ae.race([c,(typeof navigator>"u"?Ae.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(D){function M(){return indexedDB.databases().finally(D)}P=setInterval(M,100),M()}).finally(function(){return clearInterval(P)}):Promise.resolve()).then(w)]).then(function(){return y(),s.onReadyBeingFired=[],Ae.resolve(Ii(function(){return n.on.ready.fire(n.vip)})).then(function D(){var M;if(0<s.onReadyBeingFired.length)return M=s.onReadyBeingFired.reduce(nt,xe),s.onReadyBeingFired=[],Ae.resolve(Ii(function(){return M(n.vip)})).then(D)})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(D){s.dbOpenError=D;try{R&&R.abort()}catch{}return c===s.openCanceller&&n._close(),ke(D)}).finally(function(){s.openComplete=!0,K()}).then(function(){var D;return C&&(D={},n.tables.forEach(function(M){M.schema.indexes.forEach(function(O){O.name&&(D["idb://".concat(n.name,"/").concat(M.name,"/").concat(O.name)]=new on(-1/0,[[[]]]))}),D["idb://".concat(n.name,"/").concat(M.name,"/")]=D["idb://".concat(n.name,"/").concat(M.name,"/:dels")]=new on(-1/0,[[[]]])}),Lr(Va).fire(D),ji(D,!0)),n})}function Mi(n){function s(p){return n.next(p)}var l=f(s),c=f(function(p){return n.throw(p)});function f(p){return function(w){var w=p(w),P=w.value;return w.done?P:P&&typeof P.then=="function"?P.then(l,c):d(P)?Promise.all(P).then(l,c):l(P)}}return f(s)()}function qs(n,s,l){for(var c=d(n)?n.slice():[n],f=0;f<l;++f)c.push(s);return c}var pf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(c){var l=n.table(c),c=l.schema,f={},p=[];function y(D,M,O){var F=Xa(D),I=f[F]=f[F]||[],G=D==null?0:typeof D=="string"?1:D.length,V=0<M,F=a(a({},O),{name:V?"".concat(F,"(virtual-from:").concat(O.name,")"):O.name,lowLevelIndex:O,isVirtual:V,keyTail:M,keyLength:G,extractKey:xi(D),unique:!V&&O.unique});return I.push(F),F.isPrimaryKey||p.push(F),1<G&&y(G===2?D[0]:D.slice(0,G-1),M+1,O),I.sort(function(se,he){return se.keyTail-he.keyTail}),F}var w=y(c.primaryKey.keyPath,0,c.primaryKey);f[":id"]=[w];for(var P=0,K=c.indexes;P<K.length;P++){var R=K[P];y(R.keyPath,0,R)}function C(D){var M,O=D.query.index;return O.isVirtual?a(a({},D),{query:{index:O.lowLevelIndex,range:(M=D.query.range,O=O.keyTail,{type:M.type===1?2:M.type,lower:qs(M.lower,M.lowerOpen?n.MAX_KEY:n.MIN_KEY,O),lowerOpen:!0,upper:qs(M.upper,M.upperOpen?n.MIN_KEY:n.MAX_KEY,O),upperOpen:!0})}}):D}return a(a({},l),{schema:a(a({},c),{primaryKey:w,indexes:p,getIndexByKeyPath:function(D){return(D=f[Xa(D)])&&D[0]}}),count:function(D){return l.count(C(D))},query:function(D){return l.query(C(D))},openCursor:function(D){var M=D.query.index,O=M.keyTail,I=M.keyLength;return M.isVirtual?l.openCursor(C(D)).then(function(V){return V&&G(V)}):l.openCursor(D);function G(V){return Object.create(V,{continue:{value:function(F){F!=null?V.continue(qs(F,D.reverse?n.MAX_KEY:n.MIN_KEY,O)):D.unique?V.continue(V.key.slice(0,I).concat(D.reverse?n.MIN_KEY:n.MAX_KEY,O)):V.continue()}},continuePrimaryKey:{value:function(F,se){V.continuePrimaryKey(qs(F,n.MAX_KEY,O),se)}},primaryKey:{get:function(){return V.primaryKey}},key:{get:function(){var F=V.key;return I===1?F[0]:F.slice(0,I)}},value:{get:function(){return V.value}}})}}})}})}};function Li(n,s,l,c){return l=l||{},c=c||"",u(n).forEach(function(f){var p,y,w;S(s,f)?(p=n[f],y=s[f],typeof p=="object"&&typeof y=="object"&&p&&y?(w=le(p))!==le(y)?l[c+f]=s[f]:w==="Object"?Li(p,y,l,c+f+"."):p!==y&&(l[c+f]=s[f]):p!==y&&(l[c+f]=s[f])):l[c+f]=void 0}),u(s).forEach(function(f){S(n,f)||(l[c+f]=s[f])}),l}function Ni(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var hf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),c=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=je.trans,y=p.table(s).hook,w=y.deleting,P=y.creating,K=y.updating;switch(f.type){case"add":if(P.fire===xe)break;return p._promise("readwrite",function(){return R(f)},!0);case"put":if(P.fire===xe&&K.fire===xe)break;return p._promise("readwrite",function(){return R(f)},!0);case"delete":if(w.fire===xe)break;return p._promise("readwrite",function(){return R(f)},!0);case"deleteRange":if(w.fire===xe)break;return p._promise("readwrite",function(){return(function C(D,M,O){return l.query({trans:D,values:!1,query:{index:c,range:M},limit:O}).then(function(I){var G=I.result;return R({type:"delete",keys:G,trans:D}).then(function(V){return 0<V.numFailures?Promise.reject(V.failures[0]):G.length<O?{failures:[],numFailures:0,lastResult:void 0}:C(D,a(a({},M),{lower:G[G.length-1],lowerOpen:!0}),O)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function R(C){var D,M,O,I=je.trans,G=C.keys||Ni(c,C);if(G)return(C=C.type==="add"||C.type==="put"?a(a({},C),{keys:G}):a({},C)).type!=="delete"&&(C.values=i([],C.values)),C.keys&&(C.keys=i([],C.keys)),D=l,O=G,((M=C).type==="add"?Promise.resolve([]):D.getMany({trans:M.trans,keys:O,cache:"immutable"})).then(function(V){var F=G.map(function(se,he){var Se,Te,ye,Le=V[he],Pe={onerror:null,onsuccess:null};return C.type==="delete"?w.fire.call(Pe,se,Le,I):C.type==="add"||Le===void 0?(Se=P.fire.call(Pe,se,C.values[he],I),se==null&&Se!=null&&(C.keys[he]=se=Se,c.outbound||U(C.values[he],c.keyPath,se))):(Se=Li(Le,C.values[he]),(Te=K.fire.call(Pe,Se,se,Le,I))&&(ye=C.values[he],Object.keys(Te).forEach(function(we){S(ye,we)?ye[we]=Te[we]:U(ye,we,Te[we])}))),Pe});return l.mutate(C).then(function(se){for(var he=se.failures,Se=se.results,Te=se.numFailures,se=se.lastResult,ye=0;ye<G.length;++ye){var Le=(Se||G)[ye],Pe=F[ye];Le==null?Pe.onerror&&Pe.onerror(he[ye]):Pe.onsuccess&&Pe.onsuccess(C.type==="put"&&V[ye]?C.values[ye]:Le)}return{failures:he,results:Se,numFailures:Te,lastResult:se}}).catch(function(se){return F.forEach(function(he){return he.onerror&&he.onerror(se)}),Promise.reject(se)})});throw new Error("Keys missing")}}})}})}};function bl(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var c=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)at(s.keys[f],n[p])===0&&(c.push(l?ce(s.values[f]):s.values[f]),++p);return c.length===n.length?c:null}catch{return null}}var mf={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(c){var f;return c.cache?(f=bl(c.keys,c.trans._cache,c.cache==="clone"))?Ae.resolve(f):l.getMany(c).then(function(p){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?ce(p):p},p}):l.getMany(c)},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),l.mutate(c)}})}}}};function wl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function kl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var gf={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new on(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(c,f,p){if(je.subscr&&f!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(je.querier));return n.transaction(c,f,p)},table:function(c){function f(G){var I,G=G.query;return[I=G.index,new on((I=(G=G.range).lower)!=null?I:n.MIN_KEY,(I=G.upper)!=null?I:n.MAX_KEY)]}var p=n.table(c),y=p.schema,w=y.primaryKey,P=y.indexes,K=w.extractKey,R=w.outbound,C=w.autoIncrement&&P.filter(function(O){return O.compound&&O.keyPath.includes(w.keyPath)}),D=a(a({},p),{mutate:function(O){function I(Ne){return Ne="idb://".concat(s,"/").concat(c,"/").concat(Ne),he[Ne]||(he[Ne]=new on)}var G,V,F,se=O.trans,he=O.mutatedParts||(O.mutatedParts={}),Se=I(""),Te=I(":dels"),ye=O.type,Pe=O.type==="deleteRange"?[O.range]:O.type==="delete"?[O.keys]:O.values.length<50?[Ni(w,O).filter(function(Ne){return Ne}),O.values]:[],Le=Pe[0],Pe=Pe[1],we=O.trans._cache;return d(Le)?(Se.addKeys(Le),(ye=ye==="delete"||Le.length===Pe.length?bl(Le,we):null)||Te.addKeys(Le),(ye||Pe)&&(G=I,V=ye,F=Pe,y.indexes.forEach(function(Ne){var it=G(Ne.name||"");function dt(Ye){return Ye!=null?Ne.extractKey(Ye):null}function Fe(Ye){Ne.multiEntry&&d(Ye)?Ye.forEach(function(Mt){return it.addKey(Mt)}):it.addKey(Ye)}(V||F).forEach(function(Ye,Nt){var Fn=V&&dt(V[Nt]),Nt=F&&dt(F[Nt]);at(Fn,Nt)!==0&&(Fn!=null&&Fe(Fn),Nt!=null)&&Fe(Nt)})}))):Le?(Pe={from:(we=Le.lower)!=null?we:n.MIN_KEY,to:(ye=Le.upper)!=null?ye:n.MAX_KEY},Te.add(Pe),Se.add(Pe)):(Se.add(l),Te.add(l),y.indexes.forEach(function(Ne){return I(Ne.name).add(l)})),p.mutate(O).then(function(Ne){return!Le||O.type!=="add"&&O.type!=="put"||(Se.addKeys(Ne.results),C&&C.forEach(function(it){for(var dt=O.values.map(function(Fn){return it.extractKey(Fn)}),Fe=it.keyPath.findIndex(function(Fn){return Fn===w.keyPath}),Ye=0,Mt=Ne.results.length;Ye<Mt;++Ye)dt[Ye][Fe]=Ne.results[Ye];I(it.name).addKeys(dt)})),se.mutatedParts=Ls(se.mutatedParts||{},he),Ne})}}),M={get:function(O){return[w,new on(O.key)]},getMany:function(O){return[w,new on().addKeys(O.keys)]},count:f,query:f,openCursor:f};return u(M).forEach(function(O){D[O]=function(I){var G=je.subscr,V=!!G,F=wl(je,p)&&kl(O,I)?I.obsSet={}:G;if(V){var se,G=function(Pe){return Pe="idb://".concat(s,"/").concat(c,"/").concat(Pe),F[Pe]||(F[Pe]=new on)},he=G(""),Se=G(":dels"),V=M[O](I),Te=V[0],V=V[1];if((O==="query"&&Te.isPrimaryKey&&!I.values?Se:G(Te.name||"")).add(V),!Te.isPrimaryKey){if(O!=="count")return se=O==="query"&&R&&I.values&&p.query(a(a({},I),{values:!1})),p[O].apply(this,arguments).then(function(Pe){if(O==="query"){if(R&&I.values)return se.then(function(dt){return dt=dt.result,he.addKeys(dt),Pe});var we=I.values?Pe.result.map(K):Pe.result;(I.values?he:Se).addKeys(we)}else{var Ne,it;if(O==="openCursor")return it=I.values,(Ne=Pe)&&Object.create(Ne,{key:{get:function(){return Se.addKey(Ne.primaryKey),Ne.key}},primaryKey:{get:function(){var dt=Ne.primaryKey;return Se.addKey(dt),dt}},value:{get:function(){return it&&he.addKey(Ne.primaryKey),Ne.value}}})}return Pe});Se.add(l)}}return p[O].apply(this,arguments)}}),D}})}};function xl(n,s,l){var c;return l.numFailures===0?s:s.type==="deleteRange"||(c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===c)?null:(c=a({},s),d(c.keys)&&(c.keys=c.keys.filter(function(f,p){return!(p in l.failures)})),"values"in c&&d(c.values)&&(c.values=c.values.filter(function(f,p){return!(p in l.failures)})),c)}function qi(n,s){return l=n,((c=s).lower===void 0||(c.lowerOpen?0<at(l,c.lower):0<=at(l,c.lower)))&&(l=n,(c=s).upper===void 0||(c.upperOpen?at(l,c.upper)<0:at(l,c.upper)<=0));var l,c}function Sl(n,s,l,c,f,p){var y,w,P,K,R,C;return!l||l.length===0||(y=s.query.index,w=y.multiEntry,P=s.query.range,K=c.schema.primaryKey.extractKey,R=y.extractKey,C=(y.lowLevelIndex||y).extractKey,(c=l.reduce(function(D,M){var O=D,I=[];if(M.type==="add"||M.type==="put")for(var G=new on,V=M.values.length-1;0<=V;--V){var F,se=M.values[V],he=K(se);!G.hasKey(he)&&(F=R(se),w&&d(F)?F.some(function(Pe){return qi(Pe,P)}):qi(F,P))&&(G.addKey(he),I.push(se))}switch(M.type){case"add":var Se=new on().addKeys(s.values?D.map(function(we){return K(we)}):D),O=D.concat(s.values?I.filter(function(we){return we=K(we),!Se.hasKey(we)&&(Se.addKey(we),!0)}):I.map(function(we){return K(we)}).filter(function(we){return!Se.hasKey(we)&&(Se.addKey(we),!0)}));break;case"put":var Te=new on().addKeys(M.values.map(function(we){return K(we)}));O=D.filter(function(we){return!Te.hasKey(s.values?K(we):we)}).concat(s.values?I:I.map(function(we){return K(we)}));break;case"delete":var ye=new on().addKeys(M.keys);O=D.filter(function(we){return!ye.hasKey(s.values?K(we):we)});break;case"deleteRange":var Le=M.range;O=D.filter(function(we){return!qi(K(we),Le)})}return O},n))===n)?n:(c.sort(function(D,M){return at(C(D),C(M))||at(K(D),K(M))}),s.limit&&s.limit<1/0&&(c.length>s.limit?c.length=s.limit:n.length===s.limit&&c.length<s.limit&&(f.dirty=!0)),p?Object.freeze(c):c)}function Tl(n,s){return at(n.lower,s.lower)===0&&at(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function yf(n,s){return((l,c,f,p)=>{if(l===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((l=at(l,c))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,c,f,p)=>{if(l===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((l=at(l,c))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function _f(n,s,l,c){n.subscribers.add(l),c.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&te(p,f)},3e3))})}var bf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,c,f){var p,y,w=n.transaction(l,c,f);return c==="readwrite"&&(f=(p=new AbortController).signal,w.addEventListener("abort",(y=function(P){return function(){if(p.abort(),c==="readwrite"){for(var K=new Set,R=0,C=l;R<C.length;R++){var D=C[R],M=Zr["idb://".concat(s,"/").concat(D)];if(M){var O=n.table(D),I=M.optimisticOps.filter(function(Ne){return Ne.trans===w});if(w._explicit&&P&&w.mutatedParts)for(var G=0,V=Object.values(M.queries.query);G<V.length;G++)for(var F=0,se=(Te=V[G]).slice();F<se.length;F++)Ri((ye=se[F]).obsSet,w.mutatedParts)&&(te(Te,ye),ye.subscribers.forEach(function(Ne){return K.add(Ne)}));else if(0<I.length){M.optimisticOps=M.optimisticOps.filter(function(Ne){return Ne.trans!==w});for(var he=0,Se=Object.values(M.queries.query);he<Se.length;he++)for(var Te,ye,Le,Pe=0,we=(Te=Se[he]).slice();Pe<we.length;Pe++)(ye=we[Pe]).res!=null&&w.mutatedParts&&(P&&!ye.dirty?(Le=Object.isFrozen(ye.res),Le=Sl(ye.res,ye.req,I,O,ye,Le),ye.dirty?(te(Te,ye),ye.subscribers.forEach(function(Ne){return K.add(Ne)})):Le!==ye.res&&(ye.res=Le,ye.promise=Ae.resolve({result:Le}))):(ye.dirty&&te(Te,ye),ye.subscribers.forEach(function(Ne){return K.add(Ne)})))}}}K.forEach(function(Ne){return Ne()})}}})(!1),{signal:f}),w.addEventListener("error",y(!1),{signal:f}),w.addEventListener("complete",y(!0),{signal:f})),w},table:function(l){var c=n.table(l),f=c.schema.primaryKey;return a(a({},c),{mutate:function(p){var y,w=je.trans;return!f.outbound&&w.db._options.cache!=="disabled"&&!w.explicit&&w.idbtrans.mode==="readwrite"&&(y=Zr["idb://".concat(s,"/").concat(l)])?(w=c.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Ni(f,p).some(function(P){return P==null}))?(y.optimisticOps.push(p),p.mutatedParts&&Ns(p.mutatedParts),w.then(function(P){0<P.numFailures&&(te(y.optimisticOps,p),(P=xl(0,p,P))&&y.optimisticOps.push(P),p.mutatedParts)&&Ns(p.mutatedParts)}),w.catch(function(){te(y.optimisticOps,p),p.mutatedParts&&Ns(p.mutatedParts)})):w.then(function(P){var K=xl(0,a(a({},p),{values:p.values.map(function(R,C){var D;return P.failures[C]?R:(U(D=(D=f.keyPath)!=null&&D.includes(".")?ce(R):a({},R),f.keyPath,P.results[C]),D)})}),P);y.optimisticOps.push(K),queueMicrotask(function(){return p.mutatedParts&&Ns(p.mutatedParts)})}),w):c.mutate(p)},query:function(p){var y,w,P,K,R,C,D;return wl(je,c)&&kl("query",p)?(y=((P=je.trans)==null?void 0:P.db._options.cache)==="immutable",w=(P=je).requery,P=P.signal,C=((M,O,I,G)=>{var V=Zr["idb://".concat(M,"/").concat(O)];if(!V)return[];if(!(M=V.queries[I]))return[null,!1,V,null];var F=M[(G.query?G.query.index.name:null)||""];if(!F)return[null,!1,V,null];switch(I){case"query":var se=F.find(function(he){return he.req.limit===G.limit&&he.req.values===G.values&&Tl(he.req.query.range,G.query.range)});return se?[se,!0,V,F]:[F.find(function(he){return("limit"in he.req?he.req.limit:1/0)>=G.limit&&(!G.values||he.req.values)&&yf(he.req.query.range,G.query.range)}),!1,V,F];case"count":return se=F.find(function(he){return Tl(he.req.query.range,G.query.range)}),[se,!!se,V,F]}})(s,l,"query",p),D=C[0],K=C[2],R=C[3],D&&C[1]?D.obsSet=p.obsSet:(C=c.query(p).then(function(M){var O=M.result;if(D&&(D.res=O),y){for(var I=0,G=O.length;I<G;++I)Object.freeze(O[I]);Object.freeze(O)}else M.result=ce(O);return M}).catch(function(M){return R&&D&&te(R,D),Promise.reject(M)}),D={obsSet:p.obsSet,promise:C,subscribers:new Set,type:"query",req:p,dirty:!1},R?R.push(D):(R=[D],(K=K||(Zr["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=R)),_f(D,R,w,P),D.promise.then(function(M){return{result:Sl(M.result,p,K==null?void 0:K.optimisticOps,c,D,y)}})):c.query(p)}})}})}};function Bs(n,s){return new Proxy(n,{get:function(l,c,f){return c==="db"?s:Reflect.get(l,c,f)}})}qt.prototype.version=function(n){if(isNaN(n)||n<.1)throw new q.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(c){return c._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(cf),l.stores({}),this._state.autoSchema=!1),l},qt.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||je.letThrough||this._vip)?n():new Ae(function(l,c){if(s._state.openComplete)return c(new q.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new q.DatabaseClosed);s.open().catch(xe)}s._state.dbReadyPromise.then(l,c)}).then(n)},qt.prototype.use=function(f){var s=f.stack,l=f.create,c=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:c??10,name:f}),p.sort(function(y,w){return y.level-w.level}),this},qt.prototype.unuse=function(n){var s=n.stack,l=n.name,c=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return c?f.create!==c:!!l&&f.name!==l})),this},qt.prototype.open=function(){var n=this;return Me(jt,function(){return vf(n)})},qt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=kt.indexOf(this);if(0<=s&&kt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Ae(function(l){n.dbReadyResolve=l}),n.openCanceller=new Ae(function(l,c){n.cancelOpen=c}))},qt.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new q.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new q.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},qt.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),c=this._state;return new Ae(function(f,p){function y(){s.close(n);var w=s._deps.indexedDB.deleteDatabase(s.name);w.onsuccess=yt(function(){var P,K,R;P=s._deps,K=s.name,Ci(R=P.indexedDB)||K===Vt||Ai(R,P.IDBKeyRange).delete(K).catch(xe),f()}),w.onerror=dr(p),w.onblocked=s._fireOnBlocked}if(l)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(y):y()})},qt.prototype.backendDB=function(){return this.idbdb},qt.prototype.isOpen=function(){return this.idbdb!==null},qt.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},qt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qt.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),qt.prototype.transaction=function(){var n=(function(s,l,c){var f=arguments.length;if(f<2)throw new q.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return c=p.pop(),[s,Ee(p),c]}).apply(this,arguments);return this._transaction.apply(this,n)},qt.prototype._transaction=function(n,s,l){var c,f,p=this,y=je.trans,w=(y&&y.db===this&&n.indexOf("!")===-1||(y=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(K){if(K=K instanceof p.Table?K.name:K,typeof K!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return K}),n=="r"||n===zn)c=zn;else{if(n!="rw"&&n!=Xr)throw new q.InvalidArgument("Invalid transaction mode: "+n);c=Xr}if(y){if(y.mode===zn&&c===Xr){if(!w)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");y=null}y&&f.forEach(function(K){if(y&&y.storeNames.indexOf(K)===-1){if(!w)throw new q.SubTransaction("Table "+K+" not included in parent transaction.");y=null}}),w&&y&&!y.active&&(y=null)}}catch(K){return y?y._promise(null,function(R,C){C(K)}):ke(K)}var P=(function K(R,C,D,M,O){return Ae.resolve().then(function(){var F=je.transless||je,I=R._createTransaction(C,D,R._dbSchema,M),F=(I.explicit=!0,{trans:I,transless:F});if(M)I.idbtrans=M.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(se){return se.name===qe.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return K(R,C,D,null,O)})):ke(se)}var G,V=be(O),F=(V&&Wt(),Ae.follow(function(){var se;(G=O.call(I,I))&&(V?(se=In.bind(null,null),G.then(se,se)):typeof G.next=="function"&&typeof G.throw=="function"&&(G=Mi(G)))},F));return(G&&typeof G.then=="function"?Ae.resolve(G).then(function(se){return I.active?se:ke(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):F.then(function(){return G})).then(function(se){return M&&I._resolve(),I._completion.then(function(){return se})}).catch(function(se){return I._reject(se),ke(se)})})}).bind(null,this,c,f,y,l);return y?y._promise(c,P,"lock"):je.trans?Me(je.transless,function(){return p._whenReady(P)}):this._whenReady(P)},qt.prototype.table=function(n){if(S(this._allTables,n))return this._allTables[n];throw new q.InvalidTable("Table ".concat(n," does not exist"))};var kr=qt;function qt(n,s){var l,c,f,p,y,w=this,P=(this._middlewares={},this.verno=0,qt.dependencies),P=(this._options=s=a({addons:qt.addons,autoOpen:!0,indexedDB:P.indexedDB,IDBKeyRange:P.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),K=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:xe,dbReadyPromise:null,cancelOpen:xe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),R=(K.dbReadyPromise=new Ae(function(C){K.dbReadyResolve=C}),K.openCanceller=new Ae(function(C,D){K.cancelOpen=D}),this._state=K,this.name=n,this.on=Ga(this,"populate","blocked","versionchange","close",{ready:[nt,xe]}),this.once=function(C,D){var M=function(){for(var O=[],I=0;I<arguments.length;I++)O[I]=arguments[I];w.on(C).unsubscribe(M),D.apply(w,O)};return w.on(C,M)},this.on.ready.subscribe=Z(this.on.ready.subscribe,function(C){return function(D,M){qt.vip(function(){var O,I=w._state;I.openComplete?(I.dbOpenError||Ae.resolve().then(D),M&&C(D)):I.onReadyBeingFired?(I.onReadyBeingFired.push(D),M&&C(D)):(C(D),O=w,M||C(function G(){O.on.ready.unsubscribe(D),O.on.ready.unsubscribe(G)}))})}}),this.Collection=(l=this,Ha(tf.prototype,function(G,I){this.db=l;var M=Ka,O=null;if(I)try{M=I()}catch(F){O=F}var I=G._ctx,G=I.table,V=G.hook.reading.fire;this._ctx={table:G,index:I.index,isPrimKey:!I.index||G.schema.primKey.keyPath&&I.index===G.schema.primKey.name,range:M,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:O,or:I.or,valueMapper:V!==De?V:null}})),this.Table=(c=this,Ha(il.prototype,function(C,D,M){this.db=c,this._tx=M,this.name=C,this.schema=D,this.hook=c._allTables[C]?c._allTables[C].hook:Ga(null,{creating:[ct,xe],reading:[et,De],updating:[Ge,xe],deleting:[Dt,xe]})})),this.Transaction=(f=this,Ha(af.prototype,function(C,D,M,O,I){var G=this;C!=="readonly"&&D.forEach(function(V){V=(V=M[V])==null?void 0:V.yProps,V&&(D=D.concat(V.map(function(F){return F.updatesTable})))}),this.db=f,this.mode=C,this.storeNames=D,this.schema=M,this.chromeTransactionDurability=O,this.idbtrans=null,this.on=Ga(this,"complete","error","abort"),this.parent=I||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ae(function(V,F){G._resolve=V,G._reject=F}),this._completion.then(function(){G.active=!1,G.on.complete.fire()},function(V){var F=G.active;return G.active=!1,G.on.error.fire(V),G.parent?G.parent._reject(V):F&&G.idbtrans&&G.idbtrans.abort(),ke(V)})})),this.Version=(p=this,Ha(df.prototype,function(C){this.db=p,this._cfg={version:C,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(y=this,Ha(fl.prototype,function(C,D,M){if(this.db=y,this._ctx={table:C,index:D===":id"?null:D,or:M},this._cmp=this._ascending=at,this._descending=function(O,I){return at(I,O)},this._max=function(O,I){return 0<at(O,I)?O:I},this._min=function(O,I){return at(O,I)<0?O:I},this._IDBKeyRange=y._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})),this.on("versionchange",function(C){0<C.newVersion?console.warn("Another connection wants to upgrade database '".concat(w.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(w.name,"'. Closing db now to resume the delete request.")),w.close({disableAutoOpen:!1})}),this.on("blocked",function(C){!C.newVersion||C.newVersion<C.oldVersion?console.warn("Dexie.delete('".concat(w.name,"') was blocked")):console.warn("Upgrade '".concat(w.name,"' blocked by other connection holding version ").concat(C.oldVersion/10))}),this._maxKey=Ya(s.IDBKeyRange),this._createTransaction=function(C,D,M,O){return new w.Transaction(C,D,M,w._options.chromeTransactionDurability,O)},this._fireOnBlocked=function(C){w.on("blocked").fire(C),kt.filter(function(D){return D.name===w.name&&D!==w&&!D._state.vcFired}).map(function(D){return D.on("versionchange").fire(C)})},this.use(mf),this.use(bf),this.use(gf),this.use(pf),this.use(hf),new Proxy(this,{get:function(C,D,M){var O;return D==="_vip"||(D==="table"?function(I){return Bs(w.table(I),R)}:(O=Reflect.get(C,D,M))instanceof il?Bs(O,R):D==="tables"?O.map(function(I){return Bs(I,R)}):D==="_createTransaction"?function(){return Bs(O.apply(this,arguments),R)}:O)}}));this.vip=R,P.forEach(function(C){return C(w)})}var zs,Ta=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wf=(Bi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Bi.prototype[Ta]=function(){return this},Bi);function Bi(n){this._subscribe=n}try{zs={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{zs={indexedDB:null,IDBKeyRange:null}}function El(n){var s,l=!1,c=new wf(function(f){var p=be(n),y,w=!1,P={},K={},R={get closed(){return w},unsubscribe:function(){w||(w=!0,y&&y.abort(),C&&Lr.storagemutated.unsubscribe(M))}},C=(f.start&&f.start(R),!1),D=function(){return ge(O)},M=function(I){Ls(P,I),Ri(K,P)&&D()},O=function(){var I,G,V;!w&&zs.indexedDB&&(P={},I={},y&&y.abort(),y=new AbortController,V=(F=>{var se=qn();try{p&&Wt();var he=Cn(n,F);return he=p?he.finally(In):he}finally{se&&Bn()}})(G={subscr:I,signal:y.signal,requery:D,querier:n,trans:null}),Promise.resolve(V).then(function(F){l=!0,s=F,w||G.signal.aborted||(P={},(se=>{for(var he in se)if(S(se,he))return;return 1})(K=I)||C||(Lr(Va,M),C=!0),ge(function(){return!w&&f.next&&f.next(F)}))},function(F){l=!1,["DatabaseClosedError","AbortError"].includes(F==null?void 0:F.name)||w||ge(function(){w||f.error&&f.error(F)})}))};return setTimeout(D,0),R});return c.hasValue=function(){return l},c.getValue=function(){return s},c}var Jr=kr;function zi(n){var s=Nr;try{Nr=!0,Lr.storagemutated.fire(n),ji(n,!0)}finally{Nr=s}}x(Jr,a(a({},Q),{delete:function(n){return new Jr(n,{addons:[]}).delete()},exists:function(n){return new Jr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=Jr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(Ci(l)?Promise.resolve(l.databases()).then(function(c){return c.map(function(f){return f.name}).filter(function(f){return f!==Vt})}):Ai(l,s).toCollection().primaryKeys()).then(n)}catch{return ke(new q.MissingAPI)}var s,l},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return je.trans?Me(je.transless,n):n()},vip:Ii,async:function(n){return function(){try{var s=Mi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:Ae.resolve(s)}catch(l){return ke(l)}}},spawn:function(n,s,l){try{var c=Mi(n.apply(l,s||[]));return c&&typeof c.then=="function"?c:Ae.resolve(c)}catch(f){return ke(f)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(n,s){return n=Ae.resolve(typeof n=="function"?Jr.ignoreTransaction(n):n).timeout(s||6e4),je.trans?je.trans.waitFor(n):n},Promise:Ae,debug:{get:function(){return rt},set:function(n){mt(n)}},derive:E,extend:h,props:x,override:Z,Events:Ga,on:Lr,liveQuery:El,extendObservabilitySet:Ls,getByKeyPath:J,setByKeyPath:U,delByKeyPath:function(n,s){typeof s=="string"?U(n,s,void 0):"length"in s&&[].map.call(s,function(l){U(n,l,void 0)})},shallowClone:de,deepClone:ce,getObjectDiff:Li,cmp:at,asap:ee,minKey:-1/0,addons:[],connections:kt,errnames:qe,dependencies:zs,cache:Zr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),Jr.maxKey=Ya(Jr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Lr(Va,function(n){Nr||(n=new CustomEvent(bi,{detail:n}),Nr=!0,dispatchEvent(n),Nr=!1)}),addEventListener(bi,function(n){n=n.detail,Nr||zi(n)}));var Ea,Nr=!1,Al=function(){};return typeof BroadcastChannel<"u"&&((Al=function(){(Ea=new BroadcastChannel(bi)).onmessage=function(n){return n.data&&zi(n.data)}})(),typeof Ea.unref=="function"&&Ea.unref(),Lr(Va,function(n){Nr||Ea.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!kr.disableBfCache&&n.persisted){rt&&console.debug("Dexie: handling persisted pagehide"),Ea!=null&&Ea.close();for(var s=0,l=kt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!kr.disableBfCache&&n.persisted&&(rt&&console.debug("Dexie: handling persisted pageshow"),Al(),zi({all:new on(-1/0,[[]])}))})),Ae.rejectionMapper=function(n,s){return!n||n instanceof X||n instanceof TypeError||n instanceof SyntaxError||!n.name||!_e[n.name]?n:(s=new _e[n.name](s||n.message,n),"stack"in n&&N(s,"stack",{get:function(){return this.inner.stack}}),s)},mt(rt),a(kr,Object.freeze({__proto__:null,Dexie:kr,Entity:tl,PropModification:Ua,RangeSet:on,add:function(n){return new Ua({add:n})},cmp:at,default:kr,liveQuery:El,mergeRanges:Za,rangesOverlap:ml,remove:function(n){return new Ua({remove:n})},replacePrefix:function(n,s){return new Ua({replacePrefix:[n,s]})}}),{default:kr}),kr})})($s)),$s.exports}var iv=sv();const vo=rv(iv),Hl=Symbol.for("Dexie"),cn=globalThis[Hl]||(globalThis[Hl]=vo);if(vo.semVer!==cn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${vo.semVer} and ${cn.semVer}`);const{liveQuery:t_,mergeRanges:n_,rangesOverlap:r_,RangeSet:a_,cmp:s_,Entity:i_,PropModification:o_,replacePrefix:l_,add:c_,remove:u_,DexieYProvider:f_}=cn,ze=new cn("me-ai-store");ze.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});ze.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});ze.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});ze.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function gu(t,e){return`${t}:${e}`}function po(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Yi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function ov(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function lv(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function yu(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const cv="https://gmail.googleapis.com/gmail/v1/users/me";class zo extends Error{constructor(e,r,a){super(e),this.name="GmailApiError",this.status=r,this.code=a||null}}function uv(t){return{Authorization:`Bearer ${t}`}}async function hi(t,e){var a,i,o,u;const r=await fetch(`${cv}${e}`,{headers:uv(t)});if(!r.ok){const d=await r.json().catch(()=>({})),h=((a=d.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`,v=((u=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:u.reason)||void 0;throw new zo(h,r.status,v)}return r.json()}function _u(t){return hi(t,"/profile")}function bu(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),hi(t,`/messages?${i}`)}function wu(t,e,r="full"){return hi(t,`/messages/${e}?format=${r}`)}function fv(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),hi(t,`/history?${i}`)}function Br(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(u=>u.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function fs(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function dv(t){var o,u,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return fs(e.body.data);const r=e.parts||[],a=ai(r,"text/plain");if((u=a==null?void 0:a.body)!=null&&u.data)return fs(a.body.data);const i=ai(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const h=fs(i.body.data);return pv(h)}return"(no body)"}function vv(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return fs(e.body.data);const r=e.parts||[],a=ai(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?fs(a.body.data):null}function ai(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=ai(r.parts,e);if(a)return a}}return null}function pv(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function Fo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function ku(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function xu(t){return ku(t).charAt(0).toUpperCase()}function hv(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function mv(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function Su(t,e){return`${hv(t.date)}_${mv(t.subject)}.${e}`}function Tu(t){const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function gv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:a,newest:i}=await Eu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${u}.`)}return r.join(" ")}async function yv(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:a,newest:i}=await Eu();if(a&&i){const o=new Date(a.date).toLocaleDateString(),u=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${u}`)}return r.join(`
`)}async function _v(t=10){const e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(Au).join(`

---

`)}async function bv(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await ze.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,h,v,_,S;let u=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(u+=3),(h=o.from)!=null&&h.toLowerCase().includes(r)&&(u+=2),(v=o.to)!=null&&v.toLowerCase().includes(r)&&(u+=2),(_=o.snippet)!=null&&_.toLowerCase().includes(r)&&(u+=1),(S=o.body)!=null&&S.toLowerCase().includes(r)&&(u+=1),{item:o,score:u}}).filter(({score:o})=>o>0).sort((o,u)=>u.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>Au(o)).join(`

---

`)}async function Wl(){const t=await ze.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=Tu(t);return{groups:e,order:r,total:t.length}}async function wv({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),u=await ze.items.where("sourceType").equals("gmail").filter(d=>{var h,v,_,S;return((h=d.subject)==null?void 0:h.toLowerCase().includes(o))||((v=d.from)==null?void 0:v.toLowerCase().includes(o))||((_=d.to)==null?void 0:_.toLowerCase().includes(o))||((S=d.snippet)==null?void 0:S.toLowerCase().includes(o))}).toArray();return u.sort((d,h)=>(h.date||0)-(d.date||0)),{items:u.slice(r,r+e),total:u.length}}const a=await ze.items.where("sourceType").equals("gmail").count();return{items:await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}async function Eu(){const t=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).first(),e=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).last();return{oldest:t,newest:e}}function Au(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=lv(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function kv(){const t=await gv();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function xv(t){const e=[],r=await yv();if(e.push(r),t){const a=await bv(t,5);e.push("","## Relevant Emails",a)}else{const a=await _v(5);e.push("","## Recent Emails",a)}return e.join(`
`)}const Sv=20,Tv={maxTokens:512},sa=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Cu(t,{count:e=Sv,force:r=!1,onProgress:a=()=>{},signal:i}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let o,u=0;if(r)o=await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().limit(e).toArray();else{const B=new Set(await ze.emailClassifications.toCollection().primaryKeys());u=0,o=[],await ze.items.where("[sourceType+date]").between(["gmail",cn.minKey],["gmail",cn.maxKey]).reverse().until(()=>o.length>=e).each(W=>{B.has(W.id)?u++:o.push(W)})}if(o.length===0){const B=r?"No emails to scan.":`All emails already classified (${u} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:B,classified:0}),{scanned:0,classified:0,skipped:u,errors:0}}const d=Date.now(),h=performance.now();let v=0,_=0,S=0,x=0;const k=[];for(let B=0;B<o.length&&!(i!=null&&i.aborted);B++){const W=o[B],Z=Pu(W),Y=[{role:"system",content:sa},{role:"user",content:Z}];a({phase:"scanning",current:B+1,total:o.length,classified:v,errors:_,email:{subject:W.subject,from:W.from,date:W.date},prompt:{system:sa,user:Z},systemPromptLength:sa.length,live:null,lastResult:null,totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}});const ee=performance.now();try{const{text:J,tps:U,numTokens:de,inputTokens:Ce}=await t.generateFull(Y,{maxTokens:512,enableThinking:!1},$=>{a({phase:"generating",current:B+1,total:o.length,classified:v,errors:_,email:{subject:W.subject,from:W.from,date:W.date},live:{tps:$.tps,numTokens:$.numTokens},totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}})});S+=de,x+=Ce;const Ee=Cv(J),oe=performance.now()-ee;if(Ee){await ze.emailClassifications.put({emailId:W.id,action:Ee.action,reason:Ee.reason,summary:Ee.summary,tags:Ee.tags,subject:W.subject||"(no subject)",from:W.from||"",date:W.date,scannedAt:d,status:"pending"}),v++;const $={success:!0,email:{subject:W.subject,from:W.from,date:W.date},classification:Ee,stats:{tps:U,numTokens:de,inputTokens:Ce,elapsed:oe},promptSize:Z.length};k.push($),a({phase:"classified",current:B+1,total:o.length,classified:v,errors:_,email:{subject:W.subject,from:W.from,date:W.date},result:Ee,emailStats:{tps:U,numTokens:de,inputTokens:Ce,elapsed:oe},totals:{outputTokens:S,inputTokens:x,elapsed:performance.now()-h}})}}catch(J){console.error(`Triage email ${B+1} failed:`,J),_++;const U=J.message||String(J),de=U.length>200?U.slice(0,200)+"...":U;k.push({success:!1,email:{subject:W.subject,from:W.from,date:W.date},error:de,promptSize:Z.length})}}const N=performance.now()-h,E=k.length>0?Math.round(k.reduce((B,W)=>B+W.promptSize,0)/k.length):0,T=k.filter(B=>{var W;return B.success&&((W=B.stats)==null?void 0:W.tps)}).length>0?Math.round(k.filter(B=>B.success).reduce((B,W)=>{var Z;return B+(((Z=W.stats)==null?void 0:Z.tps)||0)},0)/k.filter(B=>{var W;return B.success&&((W=B.stats)==null?void 0:W.tps)}).length):null;return a({phase:"done",current:o.length,total:o.length,classified:v,errors:_,results:k,summary:{avgPromptSize:E,avgTps:T,systemPromptSize:sa.length,processed:o.length,skipped:u},totals:{outputTokens:S,inputTokens:x,elapsed:N}}),{scanned:o.length,classified:v,skipped:u,errors:_}}async function Ev(){const t=await ze.emailClassifications.toArray();return Tu(t)}async function Av(){const t=await ze.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function si(t,e){await ze.emailClassifications.update(t,{status:e})}async function Vl(){await ze.emailClassifications.clear()}async function Ko(t){await ze.emailClassifications.where("action").equals(t).delete()}async function Iu(t){await ze.emailClassifications.delete(t)}async function ho(){const t=await ze.items.where("sourceType").equals("gmail").count(),e=await ze.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function Pu(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=t.body||t.snippet||"",a=r.length>8e3?r.slice(0,8e3)+`

[... email truncated for processing ...]`:r;return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",a].join(`
`)}function Cv(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const u=JSON.parse(o);if(!u||typeof u!="object"||Array.isArray(u))return null;const d=Iv(u.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let h=[];return Array.isArray(u.tags)&&(h=u.tags.filter(v=>typeof v=="string"&&v.trim()).map(v=>v.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(u.reason||"").slice(0,300),summary:String(u.summary||"").slice(0,500),tags:h}}catch(u){return console.warn("Triage: failed to parse JSON response:",u.message),null}}function Iv(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function mo(t){return`hsl(${yu(t)}, 55%, 55%)`}function Pv(t){return`hsl(${yu(t)}, 40%, 35%)`}const Rv=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Yl(...t){Rv&&console.log("[debug]",...t)}function Nn(t){return Yl(`[MOUNT] ${t}`),()=>Yl(`[DESTROY] ${t}`)}var Ov=z("<option> </option>"),Dv=z('<p class="model-description svelte-1p89qnn"> </p>'),jv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Mv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Lv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Nv=z('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),qv=z('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Bv=z('<p class="error svelte-1p89qnn"> </p>'),zv=z('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Fv(t,e){At(e,!0);let r=Oe(e,"selectedModel",15),a=Oe(e,"gpuInfo",3,null),i=Oe(e,"error",3,null);an(()=>Nn("ModelSelector"));var o=zv(),u=b(m(o),2),d=b(m(u),2);un(d,21,()=>hs,ir,(E,T)=>{var B=Ov(),W=m(B),Z={};ne(()=>{H(W,`${g(T).name??""} â ${g(T).size??""}`),Z!==(Z=g(T).id)&&(B.value=(B.__value=g(T).id)??"")}),L(E,B)});var h=b(d,2);{var v=E=>{const T=Et(()=>hs.find(Y=>Y.id===r()));var B=Rr(),W=We(B);{var Z=Y=>{var ee=Dv(),J=m(ee);ne(()=>H(J,g(T).description)),L(Y,ee)};fe(W,Y=>{g(T)&&Y(Z)})}L(E,B)};fe(h,E=>{r()&&E(v)})}var _=b(u,2);{var S=E=>{var T=qv(),B=b(m(T),2),W=m(B),Z=b(m(W)),Y=m(Z),ee=b(W,2),J=b(m(ee)),U=m(J),de=b(ee,2);{var Ce=ve=>{var pe=jv(),te=b(m(pe)),ue=m(te);ne(()=>H(ue,a().device)),L(ve,pe)};fe(de,ve=>{a().device&&a().device!=="unknown"&&ve(Ce)})}var Ee=b(de,2);{var oe=ve=>{var pe=Mv(),te=b(m(pe)),ue=m(te);ne(()=>H(ue,a().description)),L(ve,pe)};fe(Ee,ve=>{a().description&&a().description!=="unknown"&&ve(oe)})}var $=b(Ee,2);{var ce=ve=>{var pe=Lv(),te=b(m(pe)),ue=m(te);ne(me=>H(ue,me),[()=>po(a().limits.maxBufferSize)]),L(ve,pe)};fe($,ve=>{var pe;(pe=a().limits)!=null&&pe.maxBufferSize&&ve(ce)})}var Ie=b($,2);{var le=ve=>{var pe=Nv(),te=b(m(pe)),ue=m(te);ne(()=>H(ue,`${a().features.length??""} supported`)),L(ve,pe)};fe(Ie,ve=>{var pe;(pe=a().features)!=null&&pe.length&&ve(le)})}ne(()=>{H(Y,a().vendor),H(U,a().architecture)}),L(E,T)};fe(_,E=>{a()&&E(S)})}var x=b(_,2);{var k=E=>{var T=Bv(),B=m(T);ne(()=>H(B,i())),L(E,T)};fe(x,E=>{i()&&E(k)})}var N=b(x,2);N.__click=function(...E){var T;(T=e.onload)==null||T.apply(this,E)},ne(()=>N.disabled=i()),qo(d,r),L(t,o),Ct()}Ut(["click"]);var Kv=z('<span class="progress-percent svelte-r5fnze"> </span>'),Uv=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Gv=z('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),Hv=z('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),Wv=z('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Vv=z('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),Yv=z('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Xv(t,e){At(e,!0);let r=Oe(e,"message",3,""),a=Oe(e,"items",19,()=>[]);an(()=>Nn("LoadingProgress"));var i=Yv(),o=m(i),u=m(o),d=b(o,2);un(d,17,a,ir,(h,v)=>{const _=Et(()=>g(v).total?ov(g(v).loaded||0,g(v).total):null);var S=Vv(),x=m(S),k=m(x),N=m(k),E=b(k,2);{var T=Y=>{var ee=Kv(),J=m(ee);ne(U=>H(J,`${U??""}%`),[()=>g(_).toFixed(1)]),L(Y,ee)};fe(E,Y=>{g(_)!==null&&Y(T)})}var B=b(x,2);{var W=Y=>{var ee=Uv(),J=We(ee),U=m(J),de=b(J,2),Ce=m(de),Ee=m(Ce),oe=b(Ce,4),$=m(oe),ce=b(oe,2),Ie=m(ce);ne((le,ve,pe,te,ue)=>{Tn(U,`width: ${le??""}%`),H(Ee,ve),H($,pe),H(Ie,`(${te??""} / ${ue??""} B)`)},[()=>Math.max(g(v).progress??0,.5).toFixed(1),()=>Yi(g(v).loaded||0),()=>Yi(g(v).total),()=>(g(v).loaded||0).toLocaleString(),()=>g(v).total.toLocaleString()]),L(Y,ee)},Z=Y=>{var ee=Wv(),J=b(We(ee),2),U=m(J);{var de=Ee=>{var oe=Gv(),$=We(oe),ce=m($),Ie=b($,2),le=m(Ie);ne((ve,pe)=>{H(ce,ve),H(le,`(${pe??""} B)`)},[()=>Yi(g(v).loaded),()=>g(v).loaded.toLocaleString()]),L(Ee,oe)},Ce=Ee=>{var oe=Hv();L(Ee,oe)};fe(U,Ee=>{g(v).loaded?Ee(de):Ee(Ce,!1)})}L(Y,ee)};fe(B,Y=>{g(v).total?Y(W):Y(Z,!1)})}ne(()=>{pu(k,"title",g(v).file),H(N,g(v).file)}),L(h,S)}),ne(()=>H(u,r())),L(t,i),Ct()}var Qv=z('<span class="thinking-tokens svelte-11gjw00"> </span>'),Zv=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Jv=z('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),$v=z('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),ep=z('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),tp=z('<span class="cursor svelte-11gjw00">|</span>'),np=z(" <!>",1),rp=z('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),ap=z('<div class="content svelte-11gjw00"> </div>'),sp=z('<div><div class="role svelte-11gjw00"> </div> <!></div>');function ip(t,e){At(e,!0);let r=Oe(e,"isLast",3,!1),a=Oe(e,"isRunning",3,!1),i=Oe(e,"generationPhase",3,null),o=Oe(e,"numTokens",3,null);an(()=>Nn(`MessageBubble[${e.msg.role}]`));var u=sp(),d=m(u),h=m(d),v=b(d,2);{var _=x=>{var k=rp(),N=We(k);{var E=U=>{var de=Zv(),Ce=b(m(de),4);{var Ee=oe=>{var $=Qv(),ce=m($);ne(()=>H(ce,`${o()??""} tokens`)),L(oe,$)};fe(Ce,oe=>{o()&&oe(Ee)})}L(U,de)},T=U=>{var de=Jv();L(U,de)};fe(N,U=>{a()&&r()&&i()==="thinking"?U(E):a()&&r()&&i()==="preparing"&&U(T,1)})}var B=b(N,2);{var W=U=>{var de=$v(),Ce=m(de),Ee=b(m(Ce),2),oe=m(Ee),$=b(Ce,2),ce=m($);ne(Ie=>{H(oe,`${Ie??""} words`),H(ce,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),L(U,de)};fe(B,U=>{e.msg.thinking&&U(W)})}var Z=b(B,2),Y=m(Z);{var ee=U=>{var de=ep();L(U,de)},J=U=>{var de=np(),Ce=We(de,!0),Ee=b(Ce);{var oe=$=>{var ce=tp();L($,ce)};fe(Ee,$=>{a()&&r()&&$(oe)})}ne(()=>H(Ce,e.msg.content)),L(U,de)};fe(Y,U=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?U(ee):U(J,!1)})}L(x,k)},S=x=>{var k=ap(),N=m(k);ne(()=>H(N,e.msg.content)),L(x,k)};fe(v,x=>{e.msg.role==="assistant"?x(_):x(S,!1)})}ne(()=>{Bt(u,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),H(h,e.msg.role==="user"?"You":"AI")}),L(t,u),Ct()}var op=z('<button><span class="dot svelte-mt5nvh"></span> <span class="cnt svelte-mt5nvh"> </span></button>'),lp=z('<span class="edate svelte-mt5nvh"> </span>'),cp=z('<div class="erow svelte-mt5nvh"><button class="einfo svelte-mt5nvh" title="Ask AI about this email"><span class="esubj svelte-mt5nvh"> </span> <span class="emeta svelte-mt5nvh"> <!></span></button> <div class="ebtns svelte-mt5nvh"><button class="abtn ok svelte-mt5nvh" title="Handled">â</button> <button class="abtn no svelte-mt5nvh" title="Dismiss">â</button></div></div>'),up=z('<button class="bbtn svelte-mt5nvh">All handled</button> <button class="bbtn muted svelte-mt5nvh">Clear group</button>',1),fp=z('<span class="bconf svelte-mt5nvh"> </span> <button class="bbtn svelte-mt5nvh">Cancel</button> <button class="bbtn danger svelte-mt5nvh">Delete</button>',1),dp=z('<div class="detail svelte-mt5nvh"><div class="detail-head svelte-mt5nvh"><button class="back-btn svelte-mt5nvh">â</button> <span class="detail-title svelte-mt5nvh"> </span> <span class="detail-cnt svelte-mt5nvh"> </span></div> <div class="emails svelte-mt5nvh"></div> <div class="batch svelte-mt5nvh"><!></div></div>'),vp=z('<div class="widget svelte-mt5nvh"><div class="summary svelte-mt5nvh"> </div> <div class="chips svelte-mt5nvh"></div> <!></div>');function pp(t,e){At(e,!0);let r=Oe(e,"pendingData",3,null),a=Re(null),i=Re(null);function o(k){j(a,g(a)===k?null:k,!0),j(i,null)}function u(k){return k.split("_").map(N=>N.charAt(0)+N.slice(1).toLowerCase()).join(" ")}function d(k){if(!k)return"";try{return new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function h(k){if(!k)return"";const N=k.replace(/<.*>/,"").trim();return N.length>24?N.slice(0,22)+"â¦":N}var v={toggleGroup:o},_=Rr(),S=We(_);{var x=k=>{var N=vp(),E=m(N),T=m(E),B=b(E,2);un(B,20,()=>r().order,Y=>Y,(Y,ee)=>{const J=Et(()=>r().groups[ee]),U=Et(()=>mo(ee)),de=Et(()=>g(a)===ee);var Ce=op();let Ee;Ce.__click=()=>o(ee);let oe;var $=m(Ce);let ce;var Ie=b($),le=b(Ie),ve=m(le);ne(pe=>{Ee=Bt(Ce,1,"chip svelte-mt5nvh",null,Ee,{active:g(de)}),oe=Tn(Ce,"",oe,{"--c":g(U)}),ce=Tn($,"",ce,{background:g(U)}),H(Ie,` ${pe??""} `),H(ve,g(J).length)},[()=>u(ee)]),L(Y,Ce)});var W=b(B,2);{var Z=Y=>{const ee=Et(()=>r().groups[g(a)]),J=Et(()=>mo(g(a)));var U=dp(),de=m(U);let Ce;var Ee=m(de);Ee.__click=()=>{j(a,null),j(i,null)};var oe=b(Ee,2),$=m(oe),ce=b(oe,2),Ie=m(ce),le=b(de,2);un(le,21,()=>g(ee),me=>me.emailId,(me,be)=>{var Q=cp(),ae=m(Q);ae.__click=()=>{var De;return(De=e.onaskai)==null?void 0:De.call(e,`Tell me about the email "${g(be).subject}" from ${g(be).from}`)};var X=m(ae),ie=m(X),Be=b(X,2),Ue=m(Be),qe=b(Ue);{var Ke=De=>{var et=lp(),tt=m(et);ne(ct=>H(tt,ct),[()=>d(g(be).date)]),L(De,et)};fe(qe,De=>{g(be).date&&De(Ke)})}var q=b(ae,2),_e=m(q);_e.__click=()=>{var De;return(De=e.onmarkacted)==null?void 0:De.call(e,g(be).emailId)};var xe=b(_e,2);xe.__click=()=>{var De;return(De=e.ondismiss)==null?void 0:De.call(e,g(be).emailId)},ne(De=>{H(ie,g(be).subject),H(Ue,De)},[()=>h(g(be).from)]),L(me,Q)});var ve=b(le,2),pe=m(ve);{var te=me=>{var be=up(),Q=We(be);Q.__click=()=>g(ee).forEach(X=>{var ie;return(ie=e.onmarkacted)==null?void 0:ie.call(e,X.emailId)});var ae=b(Q,2);ae.__click=()=>j(i,g(a),!0),L(me,be)},ue=me=>{var be=fp(),Q=We(be),ae=m(Q),X=b(Q,2);X.__click=()=>j(i,null);var ie=b(X,2);ie.__click=()=>{var Be;(Be=e.oncleargroup)==null||Be.call(e,g(a)),j(i,null),j(a,null)},ne(()=>H(ae,`Remove ${g(ee).length??""}?`)),L(me,be)};fe(pe,me=>{g(i)!==g(a)?me(te):me(ue,!1)})}ne(me=>{Ce=Tn(de,"",Ce,{"border-color":g(J)}),H($,me),H(Ie,g(ee).length)},[()=>u(g(a))]),L(Y,U)};fe(W,Y=>{g(a)&&r().groups[g(a)]&&Y(Z)})}ne(()=>H(T,`${r().total??""} item${r().total!==1?"s":""} need attention`)),L(k,N)};fe(S,k=>{r()&&r().total>0&&k(x)})}return L(t,_),Ct(v)}Ut(["click"]);var hp=z('<div class="chip scanning svelte-1ed7zw1"><span class="spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),mp=z('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),gp=z('<div class="strip svelte-1ed7zw1"><!></div>');function yp(t,e){let r=Oe(e,"hasScanData",3,!1),a=Oe(e,"engineReady",3,!1),i=Oe(e,"isScanning",3,!1),o=Et(()=>a()&&!r()&&!i()),u=Et(()=>g(o)||i());var d=Rr(),h=We(d);{var v=_=>{var S=gp(),x=m(S);{var k=E=>{var T=hp();L(E,T)},N=E=>{var T=mp();T.__click=function(...B){var W;(W=e.onscan)==null||W.apply(this,B)},L(E,T)};fe(x,E=>{i()?E(k):g(o)&&E(N,1)})}L(_,S)};fe(h,_=>{g(u)&&_(v)})}L(t,d)}Ut(["click"]);var _p=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),bp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),wp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),kp=z('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),xp=z('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),Sp=z('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),Tp=z('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function Ep(t,e){At(e,!0),an(()=>Nn("GpuPanel"));var r=Tp(),a=m(r),i=b(m(a),2),o=b(m(i),2),u=m(o),d=b(i,2),h=b(m(d),2),v=m(h),_=b(d,2);{var S=Y=>{var ee=_p(),J=b(m(ee),2),U=m(J);ne(()=>H(U,e.gpuInfo.device)),L(Y,ee)};fe(_,Y=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&Y(S)})}var x=b(_,2);{var k=Y=>{var ee=bp(),J=b(m(ee),2),U=m(J);ne(de=>H(U,de),[()=>po(e.gpuInfo.limits.maxBufferSize)]),L(Y,ee)};fe(x,Y=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxBufferSize&&Y(k)})}var N=b(x,2);{var E=Y=>{var ee=wp(),J=b(m(ee),2),U=m(J);ne(()=>H(U,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),L(Y,ee)};fe(N,Y=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeInvocationsPerWorkgroup&&Y(E)})}var T=b(N,2);{var B=Y=>{var ee=kp(),J=b(m(ee),2),U=m(J);ne(de=>H(U,de),[()=>po(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),L(Y,ee)};fe(T,Y=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeWorkgroupStorageSize&&Y(B)})}var W=b(T,2);{var Z=Y=>{var ee=Sp(),J=m(ee),U=m(J),de=b(J,2);un(de,21,()=>e.gpuInfo.features,ir,(Ce,Ee)=>{var oe=xp(),$=m(oe);ne(()=>H($,g(Ee))),L(Ce,oe)}),ne(()=>H(U,`Features (${e.gpuInfo.features.length??""})`)),L(Y,ee)};fe(W,Y=>{var ee;(ee=e.gpuInfo.features)!=null&&ee.length&&Y(Z)})}ne(()=>{H(u,e.gpuInfo.vendor),H(v,e.gpuInfo.architecture)}),L(t,r),Ct()}var Ap=z('<button class="gpu-badge svelte-1ktw27c"> </button>'),Cp=z('<span class="stats svelte-1ktw27c"> </span>'),Ip=z('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Pp=z('<span class="stats preparing svelte-1ktw27c"> </span>'),Rp=z('<span class="stats svelte-1ktw27c"> </span>'),Op=z('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Dp=z('<button class="btn svelte-1ktw27c">Stop</button>'),jp=z('<button class="btn primary svelte-1ktw27c">Send</button>'),Mp=z('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Lp(t,e){At(e,!0),an(()=>Nn("ChatView"));let r=Oe(e,"messages",19,()=>[]),a=Oe(e,"pendingData",3,null),i=Oe(e,"hasScanData",3,!1),o=Oe(e,"engineReady",3,!1),u=Oe(e,"isScanning",3,!1),d=Oe(e,"isRunning",3,!1),h=Oe(e,"tps",3,null),v=Oe(e,"numTokens",3,null),_=Oe(e,"generationPhase",3,null),S=Oe(e,"gpuInfo",3,null),x=Oe(e,"chatContainer",15),k=Re(""),N=Re(!1);function E(X){X.key==="Enter"&&!X.shiftKey&&(X.preventDefault(),T())}function T(){const X=g(k).trim();!X||d()||(j(k,""),e.onsend(X))}function B(X){X&&!d()&&e.onsend(X)}var W=Mp(),Z=m(W),Y=m(Z);{var ee=X=>{var ie=Ap();ie.__click=()=>j(N,!g(N));var Be=m(ie);ne(()=>H(Be,`WebGPU ${g(N)?"â²":"â¼"}`)),L(X,ie)};fe(Y,X=>{S()&&X(ee)})}var J=b(Y,2);{var U=X=>{var ie=Cp(),Be=m(ie);ne((Ue,qe)=>H(Be,`${v()??""} tokens in ${Ue??""}s
        (${qe??""} tok/s)`),[()=>(v()/h()).toFixed(1),()=>h().toFixed(1)]),L(X,ie)},de=X=>{var ie=Ip();L(X,ie)},Ce=X=>{var ie=Pp(),Be=m(ie);ne(Ue=>H(Be,`thinking... ${Ue??""}`),[()=>h()?`${h().toFixed(0)} tok/s`:""]),L(X,ie)},Ee=X=>{var ie=Rp(),Be=m(ie);ne(Ue=>H(Be,`${Ue??""} tok/s`),[()=>h().toFixed(1)]),L(X,ie)};fe(J,X=>{h()&&!d()?X(U):d()&&_()==="preparing"?X(de,1):d()&&_()==="thinking"?X(Ce,2):h()&&d()&&X(Ee,3)})}var oe=b(J,4);oe.__click=function(...X){var ie;(ie=e.onreset)==null||ie.apply(this,X)};var $=b(Z,2);{var ce=X=>{Ep(X,{get gpuInfo(){return S()}})};fe($,X=>{g(N)&&S()&&X(ce)})}var Ie=b($,2),le=m(Ie);{var ve=X=>{var ie=Op();L(X,ie)};fe(le,X=>{r().length===0&&!(a()&&a().total>0)&&X(ve)})}var pe=b(le,2);un(pe,17,r,ir,(X,ie,Be)=>{var Ue=Rr(),qe=We(Ue);{var Ke=_e=>{pp(_e,{get pendingData(){return g(ie).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:B})},q=_e=>{{let xe=Et(()=>Be===r().length-1);ip(_e,{get msg(){return g(ie)},get isLast(){return g(xe)},get isRunning(){return d()},get generationPhase(){return _()},get numTokens(){return v()}})}};fe(qe,_e=>{g(ie).type==="dashboard"?_e(Ke):_e(q,!1)})}L(X,Ue)}),hu(Ie,X=>x(X),()=>x());var te=b(Ie,2);yp(te,{get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return u()},get onscan(){return e.onscan}});var ue=b(te,2),me=m(ue);me.__keydown=E;var be=b(me,2);{var Q=X=>{var ie=Dp();ie.__click=function(...Be){var Ue;(Ue=e.onstop)==null||Ue.apply(this,Be)},L(X,ie)},ae=X=>{var ie=jp();ie.__click=T,ne(Be=>ie.disabled=Be,[()=>!g(k).trim()]),L(X,ie)};fe(be,X=>{d()?X(Q):X(ae,!1)})}ne(()=>{oe.disabled=d(),me.disabled=d()}),Bo(me,()=>g(k),X=>j(k,X)),L(t,W),Ct()}Ut(["click","keydown"]);var Np=z('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function qp(t,e){At(e,!0);const r=!!navigator.gpu,a=mu();let i=Re(en(localStorage.getItem("selectedModel")||hs[0].id)),o=Re(null),u=Re(null),d=Re(""),h=Re(en([])),v=Re(en([])),_=Re(!1),S=Re(null),x=Re(null),k=Re(null),N=Re(null),E=Re(null),T=Re(null),B=Re(!1),W=Re(!1),Z=!1;an(()=>{a.check(),a.isReady&&Y();const Q=a.onMessage(ae=>{switch(ae.status){case"webgpu-info":j(N,ae.data,!0);break;case"loading":j(o,"loading"),j(d,ae.data,!0);break;case"initiate":j(h,[...g(h),ae],!0);break;case"progress":j(h,g(h).map(X=>X.file===ae.file?{...X,...ae}:X),!0);break;case"done":j(h,g(h).filter(X=>X.file!==ae.file),!0);break;case"ready":j(o,"ready"),Y();break;case"start":if(!g(_))break;j(E,ae.phase||"preparing",!0),j(v,[...g(v),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!g(_))break;j(E,ae.phase,!0);break;case"thinking":{if(!g(_))break;j(S,ae.tps,!0),j(x,ae.numTokens,!0);const X=g(v)[g(v).length-1];j(v,[...g(v).slice(0,-1),{...X,thinking:(X.thinking||"")+ae.content}],!0),oe();break}case"thinking-done":{if(!g(_))break;j(S,ae.tps,!0),j(x,ae.numTokens,!0);const X=g(v)[g(v).length-1];j(v,[...g(v).slice(0,-1),{...X,thinking:ae.content}],!0);break}case"update":{if(!g(_))break;j(S,ae.tps,!0),j(x,ae.numTokens,!0);const X=g(v)[g(v).length-1];j(v,[...g(v).slice(0,-1),{...X,content:X.content+ae.output}],!0),oe();break}case"complete":if(!g(_))break;j(_,!1),j(E,null),ee();break;case"error":if(!g(_))break;j(u,ae.data,!0),j(_,!1),j(E,null);break}});return()=>Q()});async function Y(){if(!(Z||g(v).length>0))try{const Q=await Wl();j(T,Q,!0),Q&&(Z=!0,j(v,[{role:"assistant",type:"dashboard",pendingData:Q}],!0),oe());const ae=await ho();j(B,ae.classified>0)}catch{}}async function ee(){try{const Q=await Wl();j(T,Q,!0);const ae=g(v).findIndex(ie=>ie.type==="dashboard");ae!==-1&&(Q&&Q.total>0?j(v,g(v).map((ie,Be)=>Be===ae?{...ie,pendingData:Q}:ie),!0):j(v,g(v).filter((ie,Be)=>Be!==ae),!0));const X=await ho();j(B,X.classified>0)}catch{}}async function J(Q){await si(Q,"acted"),await ee()}async function U(Q){await si(Q,"dismissed"),await ee()}async function de(Q){await Iu(Q),await ee()}async function Ce(Q){await Ko(Q),await ee()}async function Ee(){if(!(g(W)||!a.isReady)){j(W,!0);try{await Cu(a,{count:20}),await ee(),g(T)&&!g(v).some(Q=>Q.type==="dashboard")&&(j(v,[{role:"assistant",type:"dashboard",pendingData:g(T)},...g(v)],!0),oe())}catch(Q){console.error("Scan failed:",Q)}finally{j(W,!1)}}}function oe(){cu().then(()=>{g(k)&&(g(k).scrollTop=g(k).scrollHeight)})}function $(){j(o,"loading"),localStorage.setItem("selectedModel",g(i)),a.loadModel(g(i))}async function ce(Q){if(!Q||g(_))return;j(v,[...g(v),{role:"user",content:Q}],!0),j(S,null),j(_,!0);let ae=[];try{const Be=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Q)?await xv(Q):await kv();Be&&(ae=[{role:"system",content:Be}])}catch{}const X=g(v).filter(ie=>ie.type!=="dashboard").map(ie=>({role:ie.role,content:ie.content}));a.generate([...ae,...X]),oe()}function Ie(){a.interrupt()}function le(){a.reset(),j(v,[],!0),j(S,null),j(x,null),Z=!1,Y()}var ve=Rr(),pe=We(ve);{var te=Q=>{var ae=Np();L(Q,ae)},ue=Q=>{Fv(Q,{get gpuInfo(){return g(N)},get error(){return g(u)},onload:$,get selectedModel(){return g(i)},set selectedModel(ae){j(i,ae,!0)}})},me=Q=>{Xv(Q,{get message(){return g(d)},get items(){return g(h)}})},be=Q=>{Lp(Q,{get messages(){return g(v)},get pendingData(){return g(T)},get hasScanData(){return g(B)},get engineReady(){return a.isReady},get isScanning(){return g(W)},get isRunning(){return g(_)},get tps(){return g(S)},get numTokens(){return g(x)},get generationPhase(){return g(E)},get gpuInfo(){return g(N)},onsend:ce,onstop:Ie,onreset:le,onmarkacted:J,ondismiss:U,onremove:de,oncleargroup:Ce,onscan:Ee,get chatContainer(){return g(k)},set chatContainer(ae){j(k,ae,!0)}})};fe(pe,Q=>{r?g(o)===null?Q(ue,1):g(o)==="loading"?Q(me,2):Q(be,!1):Q(te)})}L(t,ve),Ct()}const Xl="https://accounts.google.com/gsi/client",Bp="https://www.googleapis.com/auth/gmail.readonly",Uo="me-ai:oauth-token",Go=300*1e3;let ms=null,ds=null,Vr=0;function Ru(t,e){Vr=Date.now()+e*1e3;try{sessionStorage.setItem(Uo,JSON.stringify({access_token:t,expires_at:Vr}))}catch{}}function go(){Vr=0;try{sessionStorage.removeItem(Uo)}catch{}}function zp(){try{const t=sessionStorage.getItem(Uo);if(!t)return null;const{access_token:e,expires_at:r}=JSON.parse(t);return!e||Date.now()>r-Go?(go(),null):(Vr=r,{access_token:e})}catch{return go(),null}}function Fp(){return Vr>0&&Date.now()<Vr-Go}function Kp(){return Vr<=0?0:Math.max(0,Vr-Go-Date.now())}function Ql(){return new Promise((t,e)=>{if(!ms){e(new Error("Google Auth not initialized."));return}ds=r=>{r.error?e(new Error(r.error_description||r.error)):(Ru(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},ms.requestAccessToken({prompt:""})})}function Up(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Xl}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=Xl,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function Zl(t){await Up(),ms=google.accounts.oauth2.initTokenClient({client_id:t,scope:Bp,callback:e=>{ds&&(ds(e),ds=null)}})}function Gp(){return new Promise((t,e)=>{if(!ms){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}ds=r=>{r.error?e(new Error(r.error_description||r.error)):(Ru(r.access_token,r.expires_in),t({access_token:r.access_token,expires_in:r.expires_in}))},ms.requestAccessToken()})}function Hp(t){return go(),new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const tn="gmail",Jl=8,Ou=50,Du=100;async function Wp(t,{limit:e=Ou,onProgress:r=()=>{},signal:a}={}){var u;const i=await ze.syncState.get(tn);if(i!=null&&i.historyId)try{return await Zp(t,i,r,a)}catch(d){if(d instanceof zo&&(d.status===404||d.code==="notFound")||((u=d.message)==null?void 0:u.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await ze.syncState.delete(tn);else throw d}return await Xp(t,e===0?1/0:e,r,a)}async function Vp(t,{limit:e=Ou,onProgress:r=()=>{},signal:a}={}){const i=await ze.syncState.get(tn);return i!=null&&i.oldestPageToken?await Qp(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Yp(){const t=await ze.syncState.get(tn);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function ju(){await ze.transaction("rw",[ze.items,ze.syncState],async()=>{await ze.items.where("sourceType").equals(tn).delete(),await ze.syncState.delete(tn)})}async function Xp(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),ya(a);const i=await _u(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let u,d=null;for(;o.length<e;){ya(a);const S=e-o.length,x=await bu(t,{maxResults:Math.min(Du,S),pageToken:u}),k=(x.messages||[]).map(N=>N.id);if(o.push(...k),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),u=x.nextPageToken,!u||k.length===0)break}if(d=u||null,o.length===0)return await ze.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:h,errors:v}=await Mu(t,o,r,a),_=await ze.items.where("sourceType").equals(tn).count();return await ze.syncState.put({sourceType:tn,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:_,oldestPageToken:d}),r({phase:"done",message:`Synced ${h} messages`,current:h,total:h}),{added:h,deleted:0,errors:v}}async function Qp(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),ya(i);const o=[];let u=e.oldestPageToken,d=null;for(;o.length<r;){ya(i);const S=r-o.length,x=await bu(t,{maxResults:Math.min(Du,S),pageToken:u}),k=(x.messages||[]).map(N=>N.id);if(o.push(...k),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),u=x.nextPageToken,!u||k.length===0)break}if(d=u||null,o.length===0)return await ze.syncState.update(tn,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:h,errors:v}=await Mu(t,o,a,i),_=await ze.items.where("sourceType").equals(tn).count();return await ze.syncState.update(tn,{totalItems:_,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${h} more (more available)`:`Downloaded ${h} more (all synced)`,current:_,total:_}),{added:h,errors:v}}async function Zp(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),ya(a);let i=0,o=0,u=0,d,h=e.historyId;do{ya(a);const _=await fv(t,{startHistoryId:e.historyId,pageToken:d});if(h=_.historyId||h,d=_.nextPageToken,!!_.history){for(const S of _.history){if(S.messagesAdded){const x=S.messagesAdded.map(N=>N.message.id),k=[...new Set(x.filter(N=>N))];if(k.length>0){const N=await Promise.allSettled(k.map(T=>wu(t,T))),E=[];for(const T of N)T.status==="fulfilled"?E.push(Lu(T.value)):u++;E.length>0&&(await ze.items.bulkPut(E),await Nu(E),i+=E.length)}}if(S.messagesDeleted){const x=S.messagesDeleted.map(k=>gu(tn,k.message.id)).filter(k=>k);x.length>0&&(await ze.items.bulkDelete(x),o+=x.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const v=await ze.items.where("sourceType").equals(tn).count();return await ze.syncState.put({sourceType:tn,historyId:h,lastSyncAt:Date.now(),totalItems:v,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:v,total:v}),{added:i,deleted:o,errors:u}}async function Mu(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let u=0;u<e.length;u+=Jl){ya(a);const d=e.slice(u,u+Jl),h=await Promise.allSettled(d.map(_=>wu(t,_))),v=[];for(const _ of h)_.status==="fulfilled"?v.push(Lu(_.value)):o++;v.length>0&&(await ze.items.bulkPut(v),await Nu(v)),i+=v.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Lu(t){const e=Br(t,"From"),r=Br(t,"To"),a=Br(t,"Cc"),i=Br(t,"Subject")||"(no subject)",o=Br(t,"Date"),u=Br(t,"Message-ID"),d=Br(t,"In-Reply-To"),h=Br(t,"References");let v;try{v=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{v=Date.now()}return{id:gu(tn,t.id),sourceType:tn,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:dv(t),htmlBody:vv(t),date:v,labels:t.labelIds||[],messageId:u,inReplyTo:d,references:h,raw:t,syncedAt:Date.now()}}async function Nu(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const u=Jp(o);u&&!e.has(u.email)&&e.set(u.email,{...u,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await ze.contacts.where("email").equals(r).first();if(o){const u={};a&&!o.name&&(u.name=a),i>(o.lastSeen||0)&&(u.lastSeen=i),Object.keys(u).length>0&&await ze.contacts.update(o.id,u)}else await ze.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Jp(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function ya(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var $p=z(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function eh(t,e){At(e,!0);let r=Oe(e,"clientIdInput",15);an(()=>Nn("SetupGuide"));let a=Re(null);async function i(X){try{await navigator.clipboard.writeText(X),j(a,X,!0),setTimeout(()=>{j(a,null)},1500)}catch{const ie=document.createElement("input");ie.value=X,document.body.appendChild(ie),ie.select(),document.execCommand("copy"),document.body.removeChild(ie),j(a,X,!0),setTimeout(()=>{j(a,null)},1500)}}const o="http://localhost:5173",u="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var h=$p(),v=m(h),_=b(m(v),4),S=b(m(_),6),x=b(m(S),2),k=b(m(x),2),N=b(m(k),2),E=m(N);E.__click=()=>i(o);var T=m(E);T.textContent="http://localhost:5173";var B=b(T,2),W=m(B),Z=b(E,2);Z.__click=()=>i(u);var Y=m(Z);Y.textContent="https://cypherkitty.github.io";var ee=b(Y,2),J=m(ee),U=b(k,2),de=b(m(U),2),Ce=m(de);Ce.__click=()=>i(o);var Ee=m(Ce);Ee.textContent="http://localhost:5173";var oe=b(Ee,2),$=m(oe),ce=b(Ce,2);ce.__click=()=>i(u);var Ie=m(ce);Ie.textContent="https://cypherkitty.github.io";var le=b(Ie,2),ve=m(le),pe=b(ce,2);pe.__click=()=>i(d);var te=m(pe);te.textContent="https://cypherkitty.github.io/me-ai/";var ue=b(te,2),me=m(ue),be=b(_,2),Q=m(be);Q.__keydown=X=>X.key==="Enter"&&e.onsave();var ae=b(Q,2);ae.__click=function(...X){var ie;(ie=e.onsave)==null||ie.apply(this,X)},ne(X=>{H(W,g(a)===o?"â":"â§"),H(J,g(a)===u?"â":"â§"),H($,g(a)===o?"â":"â§"),H(ve,g(a)===u?"â":"â§"),H(me,g(a)===d?"â":"â§"),ae.disabled=X},[()=>!r().trim()]),Bo(Q,r),L(t,h),Ct()}Ut(["click","keydown"]);function th(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),a=e instanceof zo?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return a===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:a===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:a===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var nh=z('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),rh=z('<div class="error-card-title svelte-14buhqq"> </div>'),ah=z('<p class="error-card-fix svelte-14buhqq"> </p>'),sh=z('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),ih=z('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),oh=z('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function qu(t,e){At(e,!0);let r=Oe(e,"ondismiss",3,null),a=Oe(e,"onsignout",3,null),i=Et(()=>th(e.error));an(()=>Nn("ErrorCard"));var o=oh(),u=m(o);{var d=B=>{var W=nh(),Z=m(W),Y=m(Z),ee=b(Z,2);ee.__click=function(...J){var U;(U=r())==null||U.apply(this,J)},ne(()=>H(Y,g(i).title)),L(B,W)},h=B=>{var W=rh(),Z=m(W);ne(()=>H(Z,g(i).title)),L(B,W)};fe(u,B=>{r()?B(d):B(h,!1)})}var v=b(u,2),_=m(v),S=b(v,2);{var x=B=>{var W=ah(),Z=m(W);ne(()=>H(Z,g(i).fix)),L(B,W)};fe(S,B=>{g(i).fix&&B(x)})}var k=b(S,2);{var N=B=>{var W=sh(),Z=m(W);ne(()=>{pu(W,"href",g(i).link.url),H(Z,`${g(i).link.label??""} â`)}),L(B,W)};fe(k,B=>{g(i).link&&B(N)})}var E=b(k,2);{var T=B=>{var W=ih();W.__click=function(...Z){var Y;(Y=a())==null||Y.apply(this,Z)},L(B,W)};fe(E,B=>{g(i).action==="signout"&&a()&&B(T)})}ne(()=>H(_,g(i).description)),L(t,o),Ct()}Ut(["click"]);var lh=z('<span class="spinner svelte-nyqevv"></span> Signing in...',1),ch=No('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),uh=z(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function fh(t,e){At(e,!0);let r=Oe(e,"error",3,null),a=Oe(e,"loadingAuth",3,!1);an(()=>Nn("AuthCard"));var i=uh(),o=m(i),u=b(m(o),4);{var d=T=>{qu(T,{get error(){return r()},get onsignout(){return e.onsignout}})};fe(u,T=>{r()&&T(d)})}var h=b(u,2);h.__click=function(...T){var B;(B=e.onsignin)==null||B.apply(this,T)};var v=m(h);{var _=T=>{var B=lh();L(T,B)},S=T=>{var B=ch();L(T,B)};fe(v,T=>{a()?T(_):T(S,!1)})}var x=b(h,2),k=b(m(x),2),N=m(k),E=b(k,2);E.__click=function(...T){var B;(B=e.onclear)==null||B.apply(this,T)},ne(T=>{h.disabled=a(),H(N,`${T??""}...`)},[()=>e.clientId.slice(0,20)]),L(t,i),Ct()}Ut(["click"]);var dh=z('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),vh=z('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),ph=z('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function hh(t,e){At(e,!0);let r=Oe(e,"profile",3,null),a=Oe(e,"loadingProfile",3,!1);an(()=>Nn("ProfileCard"));var i=ph(),o=m(i),u=m(o),d=b(o,2),h=m(d);{var v=x=>{var k=dh();L(x,k)},_=x=>{var k=vh(),N=We(k),E=m(N),T=b(N,2),B=m(T);ne((W,Z)=>{H(E,r().emailAddress),H(B,`${W??""} messages
        Â· ${Z??""} threads`)},[()=>{var W;return((W=r().messagesTotal)==null?void 0:W.toLocaleString())||"?"},()=>{var W;return((W=r().threadsTotal)==null?void 0:W.toLocaleString())||"?"}]),L(x,k)};fe(h,x=>{a()?x(v):r()&&x(_,1)})}var S=b(d,2);S.__click=function(...x){var k;(k=e.onsignout)==null||k.apply(this,x)},ne(x=>H(u,x),[()=>r()?xu(r().emailAddress):"?"]),L(t,i),Ct()}Ut(["click"]);var mh=z('<span class="spinner svelte-1ds3j4k"></span>'),gh=No('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),yh=z('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),_h=z('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),bh=z('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),wh=z('<option class="svelte-1ds3j4k"> </option>'),kh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),xh=z('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),Sh=z('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),Th=z('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),Eh=z('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),Ah=z('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function Ch(t,e){At(e,!0),an(()=>Nn("SyncStatus"));let r=Oe(e,"syncStatus",3,null),a=Oe(e,"syncProgress",3,null),i=Oe(e,"isSyncing",3,!1),o=Re(!1),u=Re(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function h(te){if(!te)return"never";const ue=Math.floor((Date.now()-te)/1e3);if(ue<60)return"just now";const me=Math.floor(ue/60);if(me<60)return`${me}m ago`;const be=Math.floor(me/60);return be<24?`${be}h ago`:`${Math.floor(be/24)}d ago`}function v(){var te,ue;return!((te=a())!=null&&te.total)||!((ue=a())!=null&&ue.current)?0:Math.round(a().current/a().total*100)}var _=Ah(),S=m(_),x=m(S),k=m(x);{var N=te=>{var ue=mh();L(te,ue)},E=te=>{var ue=gh();L(te,ue)};fe(k,te=>{i()?te(N):te(E,!1)})}var T=b(x,2),B=b(m(T),2);{var W=te=>{var ue=yh(),me=m(ue),be=b(me);{var Q=X=>{var ie=ri("Â· more available");L(X,ie)},ae=X=>{var ie=ri("Â· all synced");L(X,ie)};fe(be,X=>{r().hasMore?X(Q):X(ae,!1)})}ne((X,ie)=>H(me,`${X??""} emails stored
          Â· synced ${ie??""} `),[()=>r().totalItems.toLocaleString(),()=>h(r().lastSyncAt)]),L(te,ue)},Z=te=>{var ue=_h();L(te,ue)};fe(B,te=>{var ue;(ue=r())!=null&&ue.synced?te(W):te(Z,!1)})}var Y=b(T,2),ee=m(Y);{var J=te=>{var ue=bh();ue.__click=()=>j(o,!g(o)),L(te,ue)};fe(ee,te=>{var ue;(ue=r())!=null&&ue.synced&&!i()&&te(J)})}var U=b(S,2),de=m(U),Ce=b(m(de),2);un(Ce,21,()=>d,ir,(te,ue)=>{var me=wh(),be=m(me),Q={};ne(()=>{H(be,g(ue).label),Q!==(Q=g(ue).value)&&(me.value=(me.__value=g(ue).value)??"")}),L(te,me)});var Ee=b(de,2),oe=m(Ee);{var $=te=>{var ue=xh(),me=We(ue);me.__click=()=>e.onsync(g(u));var be=m(me),Q=b(me,2);{var ae=X=>{var ie=kh();ie.__click=()=>e.onsyncmore(g(u));var Be=m(ie);ne(()=>{ie.disabled=i(),H(Be,i()?"Loading...":"Sync More")}),L(X,ie)};fe(Q,X=>{r().hasMore&&X(ae)})}ne(()=>{me.disabled=i(),H(be,i()?"Syncing...":"Sync New")}),L(te,ue)},ce=te=>{var ue=Sh();ue.__click=()=>e.onsync(g(u));var me=m(ue);ne(()=>{ue.disabled=i(),H(me,i()?"Syncing...":"Download Emails")}),L(te,ue)};fe(oe,te=>{var ue;(ue=r())!=null&&ue.synced?te($):te(ce,!1)})}var Ie=b(U,2);{var le=te=>{var ue=Th(),me=m(ue),be=m(me);let Q,ae;var X=b(me,2),ie=m(X);ne(Be=>{Q=Bt(be,1,"progress-fill svelte-1ds3j4k",null,Q,{indeterminate:!a().total}),ae=Tn(be,"",ae,Be),H(ie,a().message||"Syncing...")},[()=>({width:`${v()??""}%`})]),L(te,ue)};fe(Ie,te=>{i()&&a()&&te(le)})}var ve=b(Ie,2);{var pe=te=>{var ue=Eh(),me=b(m(ue),2),be=m(me);be.__click=()=>j(o,!1);var Q=b(be,2);Q.__click=()=>{e.onclear(),j(o,!1)},L(te,ue)};fe(ve,te=>{g(o)&&te(pe)})}ne(()=>Ce.disabled=i()),qo(Ce,()=>g(u),te=>j(u,te)),L(t,_),Ct()}Ut(["click"]);var Ih=z('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Ph=z('<div class="message-list svelte-y2uamw"></div>');function Rh(t,e){At(e,!0);let r=Oe(e,"messages",19,()=>[]);an(()=>Nn("MessageList"));var a=Ph();un(a,21,r,ir,(i,o)=>{var u=Ih();u.__click=()=>e.onselect(g(o));var d=m(u),h=m(d),v=b(d,2),_=m(v),S=m(_),x=m(S),k=b(S,2),N=m(k),E=b(_,2),T=m(E),B=b(E,2),W=m(B);ne((Z,Y,ee)=>{H(h,Z),H(x,Y),H(N,ee),H(T,g(o).subject),H(W,g(o).snippet)},[()=>xu(g(o).from),()=>ku(g(o).from),()=>Fo(g(o).date)]),L(i,u)}),L(t,a),Ct()}Ut(["click"]);function Ho(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var wa=Ho();function Bu(t){wa=t}var ta={exec:()=>null};function ot(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let u=typeof o=="string"?o:o.source;return u=u.replace(vn.caret,"$1"),r=r.replace(i,u),a},getRegex:()=>new RegExp(r,e)};return a}var Oh=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),vn={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Dh=/^(?:[ \t]*(?:\n|$))+/,jh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Mh=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ts=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Lh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Wo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,zu=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Fu=ot(zu).replace(/bull/g,Wo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Nh=ot(zu).replace(/bull/g,Wo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Vo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,qh=/^[^\n]+/,Yo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Bh=ot(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Yo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),zh=ot(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Wo).getRegex(),mi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Xo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Fh=ot("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Xo).replace("tag",mi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ku=ot(Vo).replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex(),Kh=ot(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ku).getRegex(),Qo={blockquote:Kh,code:jh,def:Bh,fences:Mh,heading:Lh,hr:Ts,html:Fh,lheading:Fu,list:zh,newline:Dh,paragraph:Ku,table:ta,text:qh},$l=ot("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex(),Uh={...Qo,lheading:Nh,table:$l,paragraph:ot(Vo).replace("hr",Ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",$l).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",mi).getRegex()},Gh={...Qo,html:ot(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Xo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ta,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ot(Vo).replace("hr",Ts).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Fu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Hh=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Wh=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Uu=/^( {2,}|\\)\n(?!\s*$)/,Vh=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,gi=/[\p{P}\p{S}]/u,Zo=/[\s\p{P}\p{S}]/u,Gu=/[^\s\p{P}\p{S}]/u,Yh=ot(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Zo).getRegex(),Hu=/(?!~)[\p{P}\p{S}]/u,Xh=/(?!~)[\s\p{P}\p{S}]/u,Qh=/(?:[^\s\p{P}\p{S}]|~)/u,Wu=/(?![*_])[\p{P}\p{S}]/u,Zh=/(?![*_])[\s\p{P}\p{S}]/u,Jh=/(?:[^\s\p{P}\p{S}]|[*_])/u,$h=ot(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Oh?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Vu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,em=ot(Vu,"u").replace(/punct/g,gi).getRegex(),tm=ot(Vu,"u").replace(/punct/g,Hu).getRegex(),Yu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",nm=ot(Yu,"gu").replace(/notPunctSpace/g,Gu).replace(/punctSpace/g,Zo).replace(/punct/g,gi).getRegex(),rm=ot(Yu,"gu").replace(/notPunctSpace/g,Qh).replace(/punctSpace/g,Xh).replace(/punct/g,Hu).getRegex(),am=ot("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Gu).replace(/punctSpace/g,Zo).replace(/punct/g,gi).getRegex(),sm=ot(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Wu).getRegex(),im="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",om=ot(im,"gu").replace(/notPunctSpace/g,Jh).replace(/punctSpace/g,Zh).replace(/punct/g,Wu).getRegex(),lm=ot(/\\(punct)/,"gu").replace(/punct/g,gi).getRegex(),cm=ot(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),um=ot(Xo).replace("(?:-->|$)","-->").getRegex(),fm=ot("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",um).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ii=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,dm=ot(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ii).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Xu=ot(/^!?\[(label)\]\[(ref)\]/).replace("label",ii).replace("ref",Yo).getRegex(),Qu=ot(/^!?\[(ref)\](?:\[\])?/).replace("ref",Yo).getRegex(),vm=ot("reflink|nolink(?!\\()","g").replace("reflink",Xu).replace("nolink",Qu).getRegex(),ec=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Jo={_backpedal:ta,anyPunctuation:lm,autolink:cm,blockSkip:$h,br:Uu,code:Wh,del:ta,delLDelim:ta,delRDelim:ta,emStrongLDelim:em,emStrongRDelimAst:nm,emStrongRDelimUnd:am,escape:Hh,link:dm,nolink:Qu,punctuation:Yh,reflink:Xu,reflinkSearch:vm,tag:fm,text:Vh,url:ta},pm={...Jo,link:ot(/^!?\[(label)\]\((.*?)\)/).replace("label",ii).getRegex(),reflink:ot(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ii).getRegex()},yo={...Jo,emStrongRDelimAst:rm,emStrongLDelim:tm,delLDelim:sm,delRDelim:om,url:ot(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",ec).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ot(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",ec).getRegex()},hm={...yo,br:ot(Uu).replace("{2,}","*").getRegex(),text:ot(yo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Hs={normal:Qo,gfm:Uh,pedantic:Gh},$a={normal:Jo,gfm:yo,breaks:hm,pedantic:pm},mm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tc=t=>mm[t];function xr(t,e){if(e){if(vn.escapeTest.test(t))return t.replace(vn.escapeReplace,tc)}else if(vn.escapeTestNoEncode.test(t))return t.replace(vn.escapeReplaceNoEncode,tc);return t}function nc(t){try{t=encodeURI(t).replace(vn.percentDecode,"%")}catch{return null}return t}function rc(t,e){var o;let r=t.replace(vn.findPipe,(u,d,h)=>{let v=!1,_=d;for(;--_>=0&&h[_]==="\\";)v=!v;return v?"|":" |"}),a=r.split(vn.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(vn.slashPipe,"|");return a}function es(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function gm(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function ym(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function ac(t,e,r,a,i){let o=e.href,u=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:u,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,h}function _m(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let u=o.match(r.other.beginningSpace);if(u===null)return o;let[d]=u;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var oi=class{constructor(t){Ze(this,"options");Ze(this,"rules");Ze(this,"lexer");this.options=t||wa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:es(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=_m(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=es(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:es(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=es(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let u=!1,d=[],h;for(h=0;h<r.length;h++)if(this.rules.other.blockquoteStart.test(r[h]))d.push(r[h]),u=!0;else if(!u)d.push(r[h]);else break;r=r.slice(h);let v=d.join(`
`),_=v.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${v}`:v,i=i?`${i}
${_}`:_;let S=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(_,o,!0),this.lexer.state.top=S,r.length===0)break;let x=o.at(-1);if((x==null?void 0:x.type)==="code")break;if((x==null?void 0:x.type)==="blockquote"){let k=x,N=k.raw+`
`+r.join(`
`),E=this.blockquote(N);o[o.length-1]=E,a=a.substring(0,a.length-k.raw.length)+E.raw,i=i.substring(0,i.length-k.text.length)+E.text;break}else if((x==null?void 0:x.type)==="list"){let k=x,N=k.raw+`
`+r.join(`
`),E=this.list(N);o[o.length-1]=E,a=a.substring(0,a.length-x.raw.length)+E.raw,i=i.substring(0,i.length-k.raw.length)+E.raw,r=N.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,u={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),h=!1;for(;t;){let _=!1,S="",x="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;S=e[0],t=t.substring(S.length);let k=ym(e[2].split(`
`,1)[0],e[1].length),N=t.split(`
`,1)[0],E=!k.trim(),T=0;if(this.options.pedantic?(T=2,x=k.trimStart()):E?T=e[1].length+1:(T=k.search(this.rules.other.nonSpaceChar),T=T>4?1:T,x=k.slice(T),T+=e[1].length),E&&this.rules.other.blankLine.test(N)&&(S+=N+`
`,t=t.substring(N.length+1),_=!0),!_){let B=this.rules.other.nextBulletRegex(T),W=this.rules.other.hrRegex(T),Z=this.rules.other.fencesBeginRegex(T),Y=this.rules.other.headingBeginRegex(T),ee=this.rules.other.htmlBeginRegex(T),J=this.rules.other.blockquoteBeginRegex(T);for(;t;){let U=t.split(`
`,1)[0],de;if(N=U,this.options.pedantic?(N=N.replace(this.rules.other.listReplaceNesting,"  "),de=N):de=N.replace(this.rules.other.tabCharGlobal,"    "),Z.test(N)||Y.test(N)||ee.test(N)||J.test(N)||B.test(N)||W.test(N))break;if(de.search(this.rules.other.nonSpaceChar)>=T||!N.trim())x+=`
`+de.slice(T);else{if(E||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||Z.test(k)||Y.test(k)||W.test(k))break;x+=`
`+N}E=!N.trim(),S+=U+`
`,t=t.substring(U.length+1),k=de.slice(T)}}u.loose||(h?u.loose=!0:this.rules.other.doubleBlankLine.test(S)&&(h=!0)),u.items.push({type:"list_item",raw:S,task:!!this.options.gfm&&this.rules.other.listIsTask.test(x),loose:!1,text:x,tokens:[]}),u.raw+=S}let v=u.items.at(-1);if(v)v.raw=v.raw.trimEnd(),v.text=v.text.trimEnd();else return;u.raw=u.raw.trimEnd();for(let _ of u.items){if(this.lexer.state.top=!1,_.tokens=this.lexer.blockTokens(_.text,[]),_.task){if(_.text=_.text.replace(this.rules.other.listReplaceTask,""),((r=_.tokens[0])==null?void 0:r.type)==="text"||((a=_.tokens[0])==null?void 0:a.type)==="paragraph"){_.tokens[0].raw=_.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),_.tokens[0].text=_.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let x=this.lexer.inlineQueue.length-1;x>=0;x--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[x].src)){this.lexer.inlineQueue[x].src=this.lexer.inlineQueue[x].src.replace(this.rules.other.listReplaceTask,"");break}}let S=this.rules.other.listTaskCheckbox.exec(_.raw);if(S){let x={type:"checkbox",raw:S[0]+" ",checked:S[0]!=="[ ]"};_.checked=x.checked,u.loose?_.tokens[0]&&["paragraph","text"].includes(_.tokens[0].type)&&"tokens"in _.tokens[0]&&_.tokens[0].tokens?(_.tokens[0].raw=x.raw+_.tokens[0].raw,_.tokens[0].text=x.raw+_.tokens[0].text,_.tokens[0].tokens.unshift(x)):_.tokens.unshift({type:"paragraph",raw:x.raw,text:x.raw,tokens:[x]}):_.tokens.unshift(x)}}if(!u.loose){let S=_.tokens.filter(k=>k.type==="space"),x=S.length>0&&S.some(k=>this.rules.other.anyLine.test(k.raw));u.loose=x}}if(u.loose)for(let _ of u.items){_.loose=!0;for(let S of _.tokens)S.type==="text"&&(S.type="paragraph")}return u}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var u;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=rc(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(u=e[3])!=null&&u.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(rc(d,o.header.length).map((h,v)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[v]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=es(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=gm(e[2],"()");if(o===-2)return;if(o>-1){let u=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,u).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),ac(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return ac(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,h=0,v=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(u=[...o].length,a[3]||a[4]){d+=u;continue}else if((a[5]||a[6])&&i%3&&!((i+u)%3)){h+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d+h);let _=[...a[0]][0].length,S=t.slice(0,i+a.index+_+u);if(Math.min(i,u)%2){let k=S.slice(1,-1);return{type:"em",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}let x=S.slice(2,-2);return{type:"strong",raw:S,text:x,tokens:this.lexer.inlineTokens(x)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,u,d=i,h=this.rules.inline.delRDelim;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(u=[...o].length,u!==i))continue;if(a[3]||a[4]){d+=u;continue}if(d-=u,d>0)continue;u=Math.min(u,u+d);let v=[...a[0]][0].length,_=t.slice(0,i+a.index+v+u),S=_.slice(i,-i);return{type:"del",raw:_,text:S,tokens:this.lexer.inlineTokens(S)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},tr=class _o{constructor(e){Ze(this,"tokens");Ze(this,"options");Ze(this,"state");Ze(this,"inlineQueue");Ze(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||wa,this.options.tokenizer=this.options.tokenizer||new oi,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:vn,block:Hs.normal,inline:$a.normal};this.options.pedantic?(r.block=Hs.pedantic,r.inline=$a.pedantic):this.options.gfm&&(r.block=Hs.gfm,this.options.breaks?r.inline=$a.breaks:r.inline=$a.gfm),this.tokenizer.rules=r}static get rules(){return{block:Hs,inline:$a}}static lex(e,r){return new _o(r).lex(e)}static lexInline(e,r){return new _o(r).inlineTokens(e)}lex(e){e=e.replace(vn.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,u;for(this.options.pedantic&&(e=e.replace(vn.tabCharGlobal,"    ").replace(vn.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(v=>(d=v.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let v=r.at(-1);d.raw.length===1&&v!==void 0?v.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="paragraph"||(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.raw,this.inlineQueue.at(-1).src=v.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let h=e;if((u=this.options.extensions)!=null&&u.startBlock){let v=1/0,_=e.slice(1),S;this.options.extensions.startBlock.forEach(x=>{S=x.call({lexer:this},_),typeof S=="number"&&S>=0&&(v=Math.min(v,S))}),v<1/0&&v>=0&&(h=e.substring(0,v+1))}if(this.state.top&&(d=this.tokenizer.paragraph(h))){let v=r.at(-1);a&&(v==null?void 0:v.type)==="paragraph"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d),a=h.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let v=r.at(-1);(v==null?void 0:v.type)==="text"?(v.raw+=(v.raw.endsWith(`
`)?"":`
`)+d.raw,v.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=v.text):r.push(d);continue}if(e){let v="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(v);break}else throw new Error(v)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var h,v,_,S,x;let a=e,i=null;if(this.tokens.links){let k=Object.keys(this.tokens.links);if(k.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)k.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((v=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:v.call({lexer:this},a))??a;let u=!1,d="";for(;e;){u||(d=""),u=!1;let k;if((S=(_=this.options.extensions)==null?void 0:_.inline)!=null&&S.some(E=>(k=E.call({lexer:this},e,r))?(e=e.substring(k.raw.length),r.push(k),!0):!1))continue;if(k=this.tokenizer.escape(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.tag(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.link(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(k.raw.length);let E=r.at(-1);k.type==="text"&&(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(k=this.tokenizer.emStrong(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.codespan(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.br(e)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.del(e,a,d)){e=e.substring(k.raw.length),r.push(k);continue}if(k=this.tokenizer.autolink(e)){e=e.substring(k.raw.length),r.push(k);continue}if(!this.state.inLink&&(k=this.tokenizer.url(e))){e=e.substring(k.raw.length),r.push(k);continue}let N=e;if((x=this.options.extensions)!=null&&x.startInline){let E=1/0,T=e.slice(1),B;this.options.extensions.startInline.forEach(W=>{B=W.call({lexer:this},T),typeof B=="number"&&B>=0&&(E=Math.min(E,B))}),E<1/0&&E>=0&&(N=e.substring(0,E+1))}if(k=this.tokenizer.inlineText(N)){e=e.substring(k.raw.length),k.raw.slice(-1)!=="_"&&(d=k.raw.slice(-1)),u=!0;let E=r.at(-1);(E==null?void 0:E.type)==="text"?(E.raw+=k.raw,E.text+=k.text):r.push(k);continue}if(e){let E="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(E);break}else throw new Error(E)}}return r}},li=class{constructor(t){Ze(this,"options");Ze(this,"parser");this.options=t||wa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(vn.notSpaceStart))==null?void 0:o[0],i=t.replace(vn.endingNewline,"")+`
`;return a?'<pre><code class="language-'+xr(a)+'">'+(r?i:xr(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:xr(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let u=0;u<t.items.length;u++){let d=t.items[u];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let u=0;u<o.length;u++)r+=this.tablecell(o[u]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${xr(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=nc(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+xr(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=nc(t);if(i===null)return xr(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${xr(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:xr(t.text)}},$o=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},nr=class bo{constructor(e){Ze(this,"options");Ze(this,"renderer");Ze(this,"textRenderer");this.options=e||wa,this.options.renderer=this.options.renderer||new li,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new $o}static parse(e,r){return new bo(r).parse(e)}static parseInline(e,r){return new bo(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let u=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[u.type]){let h=u,v=this.options.extensions.renderers[h.type].call({parser:this},h);if(v!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){r+=v||"";continue}}let d=u;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let h='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let u=0;u<e.length;u++){let d=e[u];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let v=this.options.extensions.renderers[d.type].call({parser:this},d);if(v!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=v||"";continue}}let h=d;switch(h.type){case"escape":{a+=r.text(h);break}case"html":{a+=r.html(h);break}case"link":{a+=r.link(h);break}case"image":{a+=r.image(h);break}case"checkbox":{a+=r.checkbox(h);break}case"strong":{a+=r.strong(h);break}case"em":{a+=r.em(h);break}case"codespan":{a+=r.codespan(h);break}case"br":{a+=r.br(h);break}case"del":{a+=r.del(h);break}case"text":{a+=r.text(h);break}default:{let v='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return a}},Ys,os=(Ys=class{constructor(t){Ze(this,"options");Ze(this,"block");this.options=t||wa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?tr.lex:tr.lexInline}provideParser(){return this.block?nr.parse:nr.parseInline}},Ze(Ys,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ze(Ys,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Ys),bm=class{constructor(...t){Ze(this,"defaults",Ho());Ze(this,"options",this.setOptions);Ze(this,"parse",this.parseMarkdown(!0));Ze(this,"parseInline",this.parseMarkdown(!1));Ze(this,"Parser",nr);Ze(this,"Renderer",li);Ze(this,"TextRenderer",$o);Ze(this,"Lexer",tr);Ze(this,"Tokenizer",oi);Ze(this,"Hooks",os);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let u=o;for(let d of u.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of u.rows)for(let h of d)r=r.concat(this.walkTokens(h.tokens,e));break}case"list":{let u=o;r=r.concat(this.walkTokens(u.items,e));break}default:{let u=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[u.type]?this.defaults.extensions.childTokens[u.type].forEach(d=>{let h=u[d].flat(1/0);r=r.concat(this.walkTokens(h,e))}):u.tokens&&(r=r.concat(this.walkTokens(u.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...u){let d=i.renderer.apply(this,u);return d===!1&&(d=o.apply(this,u)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new li(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let u=o,d=r.renderer[u],h=i[u];i[u]=(...v)=>{let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new oi(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let u=o,d=r.tokenizer[u],h=i[u];i[u]=(...v)=>{let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new os;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let u=o,d=r.hooks[u],h=i[u];os.passThroughHooks.has(o)?i[u]=v=>{if(this.defaults.async&&os.passThroughHooksRespectAsync.has(o))return(async()=>{let S=await d.call(i,v);return h.call(i,S)})();let _=d.call(i,v);return h.call(i,_)}:i[u]=(...v)=>{if(this.defaults.async)return(async()=>{let S=await d.apply(i,v);return S===!1&&(S=await h.apply(i,v)),S})();let _=d.apply(i,v);return _===!1&&(_=h.apply(i,v)),_}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(u){let d=[];return d.push(o.call(this,u)),i&&(d=d.concat(i.call(this,u))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return tr.lex(t,e??this.defaults)}parser(t,e){return nr.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let u=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?tr.lex:tr.lexInline)(u,i),h=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let v=await(i.hooks?await i.hooks.provideParser():t?nr.parse:nr.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(v):v})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let u=(i.hooks?i.hooks.provideLexer():t?tr.lex:tr.lexInline)(e,i);i.hooks&&(u=i.hooks.processAllTokens(u)),i.walkTokens&&this.walkTokens(u,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?nr.parse:nr.parseInline)(u,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(u){return o(u)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+xr(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},_a=new bm;function pt(t,e){return _a.parse(t,e)}pt.options=pt.setOptions=function(t){return _a.setOptions(t),pt.defaults=_a.defaults,Bu(pt.defaults),pt};pt.getDefaults=Ho;pt.defaults=wa;pt.use=function(...t){return _a.use(...t),pt.defaults=_a.defaults,Bu(pt.defaults),pt};pt.walkTokens=function(t,e){return _a.walkTokens(t,e)};pt.parseInline=_a.parseInline;pt.Parser=nr;pt.parser=nr.parse;pt.Renderer=li;pt.TextRenderer=$o;pt.Lexer=tr;pt.lexer=tr.lex;pt.Tokenizer=oi;pt.Hooks=os;pt.parse=pt;pt.options;pt.setOptions;pt.use;pt.walkTokens;pt.parseInline;nr.parse;tr.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Zu,setPrototypeOf:sc,isFrozen:wm,getPrototypeOf:km,getOwnPropertyDescriptor:xm}=Object;let{freeze:pn,seal:Xn,create:wo}=Object,{apply:ko,construct:xo}=typeof Reflect<"u"&&Reflect;pn||(pn=function(e){return e});Xn||(Xn=function(e){return e});ko||(ko=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});xo||(xo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Ws=hn(Array.prototype.forEach),Sm=hn(Array.prototype.lastIndexOf),ic=hn(Array.prototype.pop),ts=hn(Array.prototype.push),Tm=hn(Array.prototype.splice),ei=hn(String.prototype.toLowerCase),Xi=hn(String.prototype.toString),Qi=hn(String.prototype.match),ns=hn(String.prototype.replace),Em=hn(String.prototype.indexOf),Am=hn(String.prototype.trim),$n=hn(Object.prototype.hasOwnProperty),dn=hn(RegExp.prototype.test),rs=Cm(TypeError);function hn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return ko(t,e,a)}}function Cm(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return xo(t,r)}}function Qe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ei;sc&&sc(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(wm(e)||(e[a]=o),i=o)}t[i]=!0}return t}function Im(t){for(let e=0;e<t.length;e++)$n(t,e)||(t[e]=null);return t}function pr(t){const e=wo(null);for(const[r,a]of Zu(t))$n(t,r)&&(Array.isArray(a)?e[r]=Im(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=pr(a):e[r]=a);return e}function as(t,e){for(;t!==null;){const a=xm(t,e);if(a){if(a.get)return hn(a.get);if(typeof a.value=="function")return hn(a.value)}t=km(t)}function r(){return null}return r}const oc=pn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zi=pn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ji=pn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Pm=pn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$i=pn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Rm=pn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lc=pn(["#text"]),cc=pn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),eo=pn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),uc=pn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vs=pn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Om=Xn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Dm=Xn(/<%[\w\W]*|[\w\W]*%>/gm),jm=Xn(/\$\{[\w\W]*/gm),Mm=Xn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Lm=Xn(/^aria-[\-\w]+$/),Ju=Xn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Nm=Xn(/^(?:\w+script|data):/i),qm=Xn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$u=Xn(/^html$/i),Bm=Xn(/^[a-z][.\w]*(-[.\w]+)+$/i);var fc=Object.freeze({__proto__:null,ARIA_ATTR:Lm,ATTR_WHITESPACE:qm,CUSTOM_ELEMENT:Bm,DATA_ATTR:Mm,DOCTYPE_NAME:$u,ERB_EXPR:Dm,IS_ALLOWED_URI:Ju,IS_SCRIPT_OR_DATA:Nm,MUSTACHE_EXPR:Om,TMPLIT_EXPR:jm});const ss={element:1,text:3,progressingInstruction:7,comment:8,document:9},zm=function(){return typeof window>"u"?null:window},Fm=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},dc=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function ef(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zm();const e=Me=>ef(Me);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==ss.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:h,NodeFilter:v,NamedNodeMap:_=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:S,DOMParser:x,trustedTypes:k}=t,N=h.prototype,E=as(N,"cloneNode"),T=as(N,"remove"),B=as(N,"nextSibling"),W=as(N,"childNodes"),Z=as(N,"parentNode");if(typeof u=="function"){const Me=r.createElement("template");Me.content&&Me.content.ownerDocument&&(r=Me.content.ownerDocument)}let Y,ee="";const{implementation:J,createNodeIterator:U,createDocumentFragment:de,getElementsByTagName:Ce}=r,{importNode:Ee}=a;let oe=dc();e.isSupported=typeof Zu=="function"&&typeof Z=="function"&&J&&J.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:$,ERB_EXPR:ce,TMPLIT_EXPR:Ie,DATA_ATTR:le,ARIA_ATTR:ve,IS_SCRIPT_OR_DATA:pe,ATTR_WHITESPACE:te,CUSTOM_ELEMENT:ue}=fc;let{IS_ALLOWED_URI:me}=fc,be=null;const Q=Qe({},[...oc,...Zi,...Ji,...$i,...lc]);let ae=null;const X=Qe({},[...cc,...eo,...uc,...Vs]);let ie=Object.seal(wo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Be=null,Ue=null;const qe=Object.seal(wo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ke=!0,q=!0,_e=!1,xe=!0,De=!1,et=!0,tt=!1,ct=!1,Dt=!1,Ge=!1,Ve=!1,nt=!1,rt=!0,mt=!1;const xt="user-content-";let Ft=!0,_t=!1,vt={},gt=null;const fn=Qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let sn=null;const mn=Qe({},["audio","video","img","source","image","track"]);let Zt=null;const Gt=Qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ht="http://www.w3.org/1998/Math/MathML",En="http://www.w3.org/2000/svg",jt="http://www.w3.org/1999/xhtml";let je=jt,Qn=!1,An=null;const jr=Qe({},[Ht,En,jt],Xi);let Ae=Qe({},["mi","mo","mn","ms","mtext"]),ut=Qe({},["annotation-xml"]);const wt=Qe({},["title","style","font","a","script"]);let Kt=null;const gn=["application/xhtml+xml","text/html"],Zn="text/html";let St=null,It=null;const qn=r.createElement("form"),Bn=function(A){return A instanceof RegExp||A instanceof Function},lr=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(It&&It===A)){if((!A||typeof A!="object")&&(A={}),A=pr(A),Kt=gn.indexOf(A.PARSER_MEDIA_TYPE)===-1?Zn:A.PARSER_MEDIA_TYPE,St=Kt==="application/xhtml+xml"?Xi:ei,be=$n(A,"ALLOWED_TAGS")?Qe({},A.ALLOWED_TAGS,St):Q,ae=$n(A,"ALLOWED_ATTR")?Qe({},A.ALLOWED_ATTR,St):X,An=$n(A,"ALLOWED_NAMESPACES")?Qe({},A.ALLOWED_NAMESPACES,Xi):jr,Zt=$n(A,"ADD_URI_SAFE_ATTR")?Qe(pr(Gt),A.ADD_URI_SAFE_ATTR,St):Gt,sn=$n(A,"ADD_DATA_URI_TAGS")?Qe(pr(mn),A.ADD_DATA_URI_TAGS,St):mn,gt=$n(A,"FORBID_CONTENTS")?Qe({},A.FORBID_CONTENTS,St):fn,Be=$n(A,"FORBID_TAGS")?Qe({},A.FORBID_TAGS,St):pr({}),Ue=$n(A,"FORBID_ATTR")?Qe({},A.FORBID_ATTR,St):pr({}),vt=$n(A,"USE_PROFILES")?A.USE_PROFILES:!1,Ke=A.ALLOW_ARIA_ATTR!==!1,q=A.ALLOW_DATA_ATTR!==!1,_e=A.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=A.SAFE_FOR_TEMPLATES||!1,et=A.SAFE_FOR_XML!==!1,tt=A.WHOLE_DOCUMENT||!1,Ge=A.RETURN_DOM||!1,Ve=A.RETURN_DOM_FRAGMENT||!1,nt=A.RETURN_TRUSTED_TYPE||!1,Dt=A.FORCE_BODY||!1,rt=A.SANITIZE_DOM!==!1,mt=A.SANITIZE_NAMED_PROPS||!1,Ft=A.KEEP_CONTENT!==!1,_t=A.IN_PLACE||!1,me=A.ALLOWED_URI_REGEXP||Ju,je=A.NAMESPACE||jt,Ae=A.MATHML_TEXT_INTEGRATION_POINTS||Ae,ut=A.HTML_INTEGRATION_POINTS||ut,ie=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&Bn(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ie.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&Bn(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ie.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ie.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(q=!1),Ve&&(Ge=!0),vt&&(be=Qe({},lc),ae=[],vt.html===!0&&(Qe(be,oc),Qe(ae,cc)),vt.svg===!0&&(Qe(be,Zi),Qe(ae,eo),Qe(ae,Vs)),vt.svgFilters===!0&&(Qe(be,Ji),Qe(ae,eo),Qe(ae,Vs)),vt.mathMl===!0&&(Qe(be,$i),Qe(ae,uc),Qe(ae,Vs))),A.ADD_TAGS&&(typeof A.ADD_TAGS=="function"?qe.tagCheck=A.ADD_TAGS:(be===Q&&(be=pr(be)),Qe(be,A.ADD_TAGS,St))),A.ADD_ATTR&&(typeof A.ADD_ATTR=="function"?qe.attributeCheck=A.ADD_ATTR:(ae===X&&(ae=pr(ae)),Qe(ae,A.ADD_ATTR,St))),A.ADD_URI_SAFE_ATTR&&Qe(Zt,A.ADD_URI_SAFE_ATTR,St),A.FORBID_CONTENTS&&(gt===fn&&(gt=pr(gt)),Qe(gt,A.FORBID_CONTENTS,St)),A.ADD_FORBID_CONTENTS&&(gt===fn&&(gt=pr(gt)),Qe(gt,A.ADD_FORBID_CONTENTS,St)),Ft&&(be["#text"]=!0),tt&&Qe(be,["html","head","body"]),be.table&&(Qe(be,["tbody"]),delete Be.tbody),A.TRUSTED_TYPES_POLICY){if(typeof A.TRUSTED_TYPES_POLICY.createHTML!="function")throw rs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof A.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw rs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');Y=A.TRUSTED_TYPES_POLICY,ee=Y.createHTML("")}else Y===void 0&&(Y=Fm(k,i)),Y!==null&&typeof ee=="string"&&(ee=Y.createHTML(""));pn&&pn(A),It=A}},cr=Qe({},[...Zi,...Ji,...Pm]),yt=Qe({},[...$i,...Rm]),Lt=function(A){let ge=Z(A);(!ge||!ge.tagName)&&(ge={namespaceURI:je,tagName:"template"});const ke=ei(A.tagName),st=ei(ge.tagName);return An[A.namespaceURI]?A.namespaceURI===En?ge.namespaceURI===jt?ke==="svg":ge.namespaceURI===Ht?ke==="svg"&&(st==="annotation-xml"||Ae[st]):!!cr[ke]:A.namespaceURI===Ht?ge.namespaceURI===jt?ke==="math":ge.namespaceURI===En?ke==="math"&&ut[st]:!!yt[ke]:A.namespaceURI===jt?ge.namespaceURI===En&&!ut[st]||ge.namespaceURI===Ht&&!Ae[st]?!1:!yt[ke]&&(wt[ke]||!cr[ke]):!!(Kt==="application/xhtml+xml"&&An[A.namespaceURI]):!1},yn=function(A){ts(e.removed,{element:A});try{Z(A).removeChild(A)}catch{T(A)}},_n=function(A,ge){try{ts(e.removed,{attribute:ge.getAttributeNode(A),from:ge})}catch{ts(e.removed,{attribute:null,from:ge})}if(ge.removeAttribute(A),A==="is")if(Ge||Ve)try{yn(ge)}catch{}else try{ge.setAttribute(A,"")}catch{}},ur=function(A){let ge=null,ke=null;if(Dt)A="<remove></remove>"+A;else{const lt=Qi(A,/^[\r\n\t ]+/);ke=lt&&lt[0]}Kt==="application/xhtml+xml"&&je===jt&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");const st=Y?Y.createHTML(A):A;if(je===jt)try{ge=new x().parseFromString(st,Kt)}catch{}if(!ge||!ge.documentElement){ge=J.createDocument(je,"template",null);try{ge.documentElement.innerHTML=Qn?ee:st}catch{}}const bt=ge.body||ge.documentElement;return A&&ke&&bt.insertBefore(r.createTextNode(ke),bt.childNodes[0]||null),je===jt?Ce.call(ge,tt?"html":"body")[0]:tt?ge.documentElement:bt},fr=function(A){return U.call(A.ownerDocument||A,A,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},Yr=function(A){return A instanceof S&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof _)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},Cn=function(A){return typeof d=="function"&&A instanceof d};function Wt(Me,A,ge){Ws(Me,ke=>{ke.call(e,A,ge,It)})}const In=function(A){let ge=null;if(Wt(oe.beforeSanitizeElements,A,null),Yr(A))return yn(A),!0;const ke=St(A.nodeName);if(Wt(oe.uponSanitizeElement,A,{tagName:ke,allowedTags:be}),et&&A.hasChildNodes()&&!Cn(A.firstElementChild)&&dn(/<[/\w!]/g,A.innerHTML)&&dn(/<[/\w!]/g,A.textContent)||A.nodeType===ss.progressingInstruction||et&&A.nodeType===ss.comment&&dn(/<[/\w]/g,A.data))return yn(A),!0;if(!(qe.tagCheck instanceof Function&&qe.tagCheck(ke))&&(!be[ke]||Be[ke])){if(!Be[ke]&&Ot(ke)&&(ie.tagNameCheck instanceof RegExp&&dn(ie.tagNameCheck,ke)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(ke)))return!1;if(Ft&&!gt[ke]){const st=Z(A)||A.parentNode,bt=W(A)||A.childNodes;if(bt&&st){const lt=bt.length;for(let kt=lt-1;kt>=0;--kt){const Vt=E(bt[kt],!0);Vt.__removalCount=(A.__removalCount||0)+1,st.insertBefore(Vt,B(A))}}}return yn(A),!0}return A instanceof h&&!Lt(A)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&dn(/<\/no(script|embed|frames)/i,A.innerHTML)?(yn(A),!0):(De&&A.nodeType===ss.text&&(ge=A.textContent,Ws([$,ce,Ie],st=>{ge=ns(ge,st," ")}),A.textContent!==ge&&(ts(e.removed,{element:A.cloneNode()}),A.textContent=ge)),Wt(oe.afterSanitizeElements,A,null),!1)},wr=function(A,ge,ke){if(rt&&(ge==="id"||ge==="name")&&(ke in r||ke in qn))return!1;if(!(q&&!Ue[ge]&&dn(le,ge))){if(!(Ke&&dn(ve,ge))){if(!(qe.attributeCheck instanceof Function&&qe.attributeCheck(ge,A))){if(!ae[ge]||Ue[ge]){if(!(Ot(A)&&(ie.tagNameCheck instanceof RegExp&&dn(ie.tagNameCheck,A)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(A))&&(ie.attributeNameCheck instanceof RegExp&&dn(ie.attributeNameCheck,ge)||ie.attributeNameCheck instanceof Function&&ie.attributeNameCheck(ge,A))||ge==="is"&&ie.allowCustomizedBuiltInElements&&(ie.tagNameCheck instanceof RegExp&&dn(ie.tagNameCheck,ke)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(ke))))return!1}else if(!Zt[ge]){if(!dn(me,ns(ke,te,""))){if(!((ge==="src"||ge==="xlink:href"||ge==="href")&&A!=="script"&&Em(ke,"data:")===0&&sn[A])){if(!(_e&&!dn(pe,ns(ke,te,"")))){if(ke)return!1}}}}}}}return!0},Ot=function(A){return A!=="annotation-xml"&&Qi(A,ue)},Pt=function(A){Wt(oe.beforeSanitizeAttributes,A,null);const{attributes:ge}=A;if(!ge||Yr(A))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ae,forceKeepAttr:void 0};let st=ge.length;for(;st--;){const bt=ge[st],{name:lt,namespaceURI:kt,value:Vt}=bt,zn=St(lt),Xr=Vt;let Rt=lt==="value"?Xr:Am(Xr);if(ke.attrName=zn,ke.attrValue=Rt,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Wt(oe.uponSanitizeAttribute,A,ke),Rt=ke.attrValue,mt&&(zn==="id"||zn==="name")&&(_n(lt,A),Rt=xt+Rt),et&&dn(/((--!?|])>)|<\/(style|title|textarea)/i,Rt)){_n(lt,A);continue}if(zn==="attributename"&&Qi(Rt,"href")){_n(lt,A);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){_n(lt,A);continue}if(!xe&&dn(/\/>/i,Rt)){_n(lt,A);continue}De&&Ws([$,ce,Ie],Qr=>{Rt=ns(Rt,Qr," ")});const Ka=St(A.nodeName);if(!wr(Ka,zn,Rt)){_n(lt,A);continue}if(Y&&typeof k=="object"&&typeof k.getAttributeType=="function"&&!kt)switch(k.getAttributeType(Ka,zn)){case"TrustedHTML":{Rt=Y.createHTML(Rt);break}case"TrustedScriptURL":{Rt=Y.createScriptURL(Rt);break}}if(Rt!==Xr)try{kt?A.setAttributeNS(kt,lt,Rt):A.setAttribute(lt,Rt),Yr(A)?yn(A):ic(e.removed)}catch{_n(lt,A)}}Wt(oe.afterSanitizeAttributes,A,null)},Pn=function Me(A){let ge=null;const ke=fr(A);for(Wt(oe.beforeSanitizeShadowDOM,A,null);ge=ke.nextNode();)Wt(oe.uponSanitizeShadowNode,ge,null),In(ge),Pt(ge),ge.content instanceof o&&Me(ge.content);Wt(oe.afterSanitizeShadowDOM,A,null)};return e.sanitize=function(Me){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ge=null,ke=null,st=null,bt=null;if(Qn=!Me,Qn&&(Me="<!-->"),typeof Me!="string"&&!Cn(Me))if(typeof Me.toString=="function"){if(Me=Me.toString(),typeof Me!="string")throw rs("dirty is not a string, aborting")}else throw rs("toString is not a function");if(!e.isSupported)return Me;if(ct||lr(A),e.removed=[],typeof Me=="string"&&(_t=!1),_t){if(Me.nodeName){const Vt=St(Me.nodeName);if(!be[Vt]||Be[Vt])throw rs("root node is forbidden and cannot be sanitized in-place")}}else if(Me instanceof d)ge=ur("<!---->"),ke=ge.ownerDocument.importNode(Me,!0),ke.nodeType===ss.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?ge=ke:ge.appendChild(ke);else{if(!Ge&&!De&&!tt&&Me.indexOf("<")===-1)return Y&&nt?Y.createHTML(Me):Me;if(ge=ur(Me),!ge)return Ge?null:nt?ee:""}ge&&Dt&&yn(ge.firstChild);const lt=fr(_t?Me:ge);for(;st=lt.nextNode();)In(st),Pt(st),st.content instanceof o&&Pn(st.content);if(_t)return Me;if(Ge){if(Ve)for(bt=de.call(ge.ownerDocument);ge.firstChild;)bt.appendChild(ge.firstChild);else bt=ge;return(ae.shadowroot||ae.shadowrootmode)&&(bt=Ee.call(a,bt,!0)),bt}let kt=tt?ge.outerHTML:ge.innerHTML;return tt&&be["!doctype"]&&ge.ownerDocument&&ge.ownerDocument.doctype&&ge.ownerDocument.doctype.name&&dn($u,ge.ownerDocument.doctype.name)&&(kt="<!DOCTYPE "+ge.ownerDocument.doctype.name+`>
`+kt),De&&Ws([$,ce,Ie],Vt=>{kt=ns(kt,Vt," ")}),Y&&nt?Y.createHTML(kt):kt},e.setConfig=function(){let Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lr(Me),ct=!0},e.clearConfig=function(){It=null,ct=!1},e.isValidAttribute=function(Me,A,ge){It||lr({});const ke=St(Me),st=St(A);return wr(ke,st,ge)},e.addHook=function(Me,A){typeof A=="function"&&ts(oe[Me],A)},e.removeHook=function(Me,A){if(A!==void 0){const ge=Sm(oe[Me],A);return ge===-1?void 0:Tm(oe[Me],ge,1)[0]}return ic(oe[Me])},e.removeHooks=function(Me){oe[Me]=[]},e.removeAllHooks=function(){oe=dc()},e}var Km=ef();function Um(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${vc(t.from)} |`),e.push(`| **To** | ${vc(t.to)} |`),e.push(`| **Date** | ${Fo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Gm(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function vc(t){return(t||"").replace(/\|/g,"\\|")}function Gm(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return So(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Hm(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function So(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",u=t.getAttribute("alt")||"";return Hm(t,o)?"":`![${u}](${o})`}const r=Array.from(t.childNodes).map(So).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(u=>So(u).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),u=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(u,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Wm(t){return Su(t,"md")}function pc(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Vm(t){return t.raw||null}function Ym(t){const e=Vm(t);return e?JSON.stringify(e,null,2):"null"}function Xm(t){return Su(t,"json")}var Qm=z('<button title="View as Markdown">.md</button>'),Zm=z('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Jm=z('<pre class="md-raw svelte-1b0rzpb"> </pre>'),$m=z('<div class="md-preview svelte-1b0rzpb"><!></div>'),eg=z('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),tg=z('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),ng=z('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),rg=z('<pre class="message-text svelte-1b0rzpb"> </pre>'),ag=z('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),sg=z('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),ig=z('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function og(t,e){At(e,!0);let r=Oe(e,"loading",3,!1);an(()=>Nn("MessageModal"));const a=new pt.Renderer;a.link=({href:$,title:ce,text:Ie})=>{const le=ce?` title="${ce}"`:"";return`<a href="${$}"${le} target="_blank" rel="noopener">${Ie}</a>`},pt.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Re("email"),o=Et(()=>e.message.body?Um(e.message):""),u=Et(()=>Ym(e.message)),d=Re("raw");function h($){j(i,g(i)===$?"email":$,!0),$==="markdown"&&j(d,"raw")}function v(){pc(g(o),Wm(e.message))}function _(){pc(g(u),Xm(e.message),"application/json;charset=utf-8")}function S($){const ce=pt.parse($);return Km.sanitize(ce,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let x=Re(null);ni(()=>{var $;if(g(x)&&e.message.htmlBody&&!r()&&g(i)==="email"){const ce=g(x).contentDocument||(($=g(x).contentWindow)==null?void 0:$.document);ce&&(ce.open(),ce.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ce.close())}});var k=ig();k.__click=function(...$){var ce;(ce=e.onclose)==null||ce.apply(this,$)};var N=m(k);N.__click=$=>$.stopPropagation();var E=m(N),T=m(E),B=m(T),W=b(T,2),Z=m(W);let Y;Z.__click=()=>h("json");var ee=b(Z,2);{var J=$=>{var ce=Qm();let Ie;ce.__click=()=>h("markdown"),ne(()=>Ie=Bt(ce,1,"action-btn svelte-1b0rzpb",null,Ie,{active:g(i)==="markdown"})),L($,ce)};fe(ee,$=>{e.message.body&&$(J)})}var U=b(ee,2);U.__click=function(...$){var ce;(ce=e.onclose)==null||ce.apply(this,$)};var de=b(E,2);{var Ce=$=>{var ce=Zm(),Ie=We(ce),le=b(m(Ie),2);le.__click=_;var ve=b(Ie,2),pe=m(ve),te=m(pe);ne(()=>H(te,g(u))),L($,ce)},Ee=$=>{var ce=eg(),Ie=We(ce),le=m(Ie),ve=m(le);let pe;ve.__click=()=>j(d,"raw");var te=b(ve,2);let ue;te.__click=()=>j(d,"preview");var me=b(le,2);me.__click=v;var be=b(Ie,2),Q=m(be);{var ae=ie=>{var Be=Jm(),Ue=m(Be);ne(()=>H(Ue,g(o))),L(ie,Be)},X=ie=>{var Be=$m(),Ue=m(Be);Wd(Ue,()=>S(g(o))),L(ie,Be)};fe(Q,ie=>{g(d)==="raw"?ie(ae):ie(X,!1)})}ne(()=>{pe=Bt(ve,1,"md-tab svelte-1b0rzpb",null,pe,{active:g(d)==="raw"}),ue=Bt(te,1,"md-tab svelte-1b0rzpb",null,ue,{active:g(d)==="preview"})}),L($,ce)},oe=$=>{var ce=sg(),Ie=We(ce),le=m(Ie),ve=b(m(le),2),pe=m(ve),te=b(le,2),ue=b(m(te),2),me=m(ue),be=b(te,2),Q=b(m(be),2),ae=m(Q),X=b(Ie,2),ie=m(X);{var Be=q=>{var _e=tg();L(q,_e)},Ue=q=>{var _e=ng();hu(_e,xe=>j(x,xe),()=>g(x)),L(q,_e)},qe=q=>{var _e=rg(),xe=m(_e);ne(()=>H(xe,e.message.body)),L(q,_e)},Ke=q=>{var _e=ag();L(q,_e)};fe(ie,q=>{r()?q(Be):e.message.htmlBody?q(Ue,1):e.message.body?q(qe,2):q(Ke,!1)})}ne(q=>{H(pe,e.message.from),H(me,e.message.to),H(ae,q)},[()=>Fo(e.message.date)]),L($,ce)};fe(de,$=>{g(i)==="json"?$(Ce):g(i)==="markdown"?$(Ee,1):$(oe,!1)})}ne(()=>{H(B,e.message.subject),Y=Bt(Z,1,"action-btn svelte-1b0rzpb",null,Y,{active:g(i)==="json"})}),L(t,k),Ct()}Ut(["click"]);var lg=z('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),cg=z('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),ug=z('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),fg=z("<p> </p>"),dg=z('<p>No emails in local storage. Click "Sync New" to download.</p>'),vg=z('<div class="empty-state svelte-6ts5xm"><!></div>'),pg=z('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),hg=z('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function mg(t,e){At(e,!0),an(()=>Nn("DashboardView"));let r=Oe(e,"error",3,null),a=Oe(e,"profile",3,null),i=Oe(e,"loadingProfile",3,!1),o=Oe(e,"emailMessages",19,()=>[]),u=Oe(e,"totalLocalMessages",3,0),d=Oe(e,"hasMoreLocal",3,!1),h=Oe(e,"loadingMessages",3,!1),v=Oe(e,"selectedMessage",3,null),_=Oe(e,"syncStatus",3,null),S=Oe(e,"syncProgress",3,null),x=Oe(e,"isSyncing",3,!1),k=Oe(e,"searchQuery",15);var N=hg(),E=We(N),T=m(E);{var B=le=>{qu(le,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};fe(T,le=>{r()&&le(B)})}var W=b(T,2);hh(W,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var Z=b(W,2);Ch(Z,{get syncStatus(){return _()},get syncProgress(){return S()},get isSyncing(){return x()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var Y=b(Z,2),ee=m(Y);ee.__keydown=le=>le.key==="Enter"&&e.onsearch();var J=b(ee,2);J.__click=function(...le){var ve;(ve=e.onsearch)==null||ve.apply(this,le)};var U=m(J),de=b(Y,2);{var Ce=le=>{var ve=cg(),pe=We(ve),te=m(pe),ue=m(te),me=b(pe,2);Rh(me,{get messages(){return o()},get onselect(){return e.onviewmessage}});var be=b(me,2);{var Q=ae=>{var X=lg(),ie=m(X);ie.__click=function(...Ue){var qe;(qe=e.onloadmore)==null||qe.apply(this,Ue)};var Be=m(ie);ne(()=>{ie.disabled=h(),H(Be,h()?"Loading...":"Load More")}),L(ae,X)};fe(be,ae=>{d()&&ae(Q)})}ne(ae=>H(ue,`Showing ${o().length??""} of ${ae??""}
        ${k()?" matching":""} emails`),[()=>u().toLocaleString()]),L(le,ve)},Ee=le=>{var ve=ug();L(le,ve)},oe=le=>{var ve=vg(),pe=m(ve);{var te=me=>{var be=fg(),Q=m(be);ne(()=>H(Q,`No emails match "${k()??""}".`)),L(me,be)},ue=me=>{var be=dg();L(me,be)};fe(pe,me=>{k()?me(te):me(ue,!1)})}L(le,ve)},$=le=>{var ve=pg();L(le,ve)};fe(de,le=>{var ve;o().length>0?le(Ce):h()?le(Ee,1):(ve=_())!=null&&ve.synced?le(oe,2):le($,!1)})}var ce=b(E,2);{var Ie=le=>{og(le,{get message(){return v()},loading:!1,get onclose(){return e.onclosedetail}})};fe(ce,le=>{v()&&le(Ie)})}ne(()=>{J.disabled=h(),H(U,h()?"Searching...":"Search")}),Bo(ee,k),L(t,N),Ct()}Ut(["keydown","click"]);var gg=z('<div class="dashboard svelte-1q5o2lv"><!></div>');function yg(t,e){At(e,!0);function r(q){q.key==="Escape"&&g(S)&&me()}let a=null;an(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r),a&&clearTimeout(a)}));function i(){a&&clearTimeout(a);const q=Kp();if(q<=0)return;const _e=Math.max(0,q-120*1e3);a=setTimeout(async()=>{try{const xe=await Ql();j(v,xe.access_token,!0),i()}catch{j(v,null),j(_,null),j(Z,"Session expired. Please sign in again.")}},_e)}async function o(){if(Fp())return g(v);try{const q=await Ql();return j(v,q.access_token,!0),i(),g(v)}catch{return j(v,null),j(_,null),j(Z,"Session expired. Please sign in again."),null}}let u=Re(en(localStorage.getItem("googleClientId")||"")),d=Re(en(localStorage.getItem("googleClientId")||"")),h=Re(!1),v=Re(null),_=Re(null),S=Re(null),x=Re(""),k=Re(en([])),N=Re(0),E=Re(0),T=Re(!1),B=Re(!1),W=Re(!1),Z=Re(null),Y=Re(null),ee=Re(null),J=Re(!1);const U=50;ni(()=>{g(v)&&(be(),ve())});let de=Et(()=>!g(u)),Ce=Et(()=>!!g(v)),Ee=Et(()=>g(k).length<g(N));ni(()=>{g(u)&&!g(h)&&Zl(g(u)).then(()=>{if(j(h,!0),!g(v)){const q=zp();q&&(j(v,q.access_token,!0),i(),le())}}).catch(q=>{j(Z,`Auth init failed: ${q.message}`)})});function oe(){const q=g(d).trim();q&&(localStorage.setItem("googleClientId",q),j(u,q,!0),j(Z,null))}function $(){localStorage.removeItem("googleClientId"),j(u,""),j(d,""),j(h,!1),j(v,null),j(_,null),j(k,[],!0),j(N,0)}async function ce(){j(Z,null),j(B,!0);try{g(h)||(await Zl(g(u)),j(h,!0));const q=await Gp();j(v,q.access_token,!0),i(),await le()}catch(q){j(Z,q.message,!0)}finally{j(B,!1)}}async function Ie(){if(a&&clearTimeout(a),g(v))try{await Hp(g(v))}catch{}j(v,null),j(_,null),j(k,[],!0),j(N,0),j(S,null),j(Z,null)}async function le(){j(W,!0);try{const q=await _u(g(v));if(!g(v))return;j(_,q,!0)}catch(q){if(!g(v))return;j(Z,`Profile fetch failed: ${q.message}`)}finally{j(W,!1)}}async function ve(q=!1){j(T,!0);try{const _e=q?g(E):0,xe=await wv({query:g(x)||void 0,limit:U,offset:_e});q?j(k,[...g(k),...xe.items],!0):j(k,xe.items,!0),j(N,xe.total,!0),j(E,g(k).length,!0)}catch(_e){j(Z,`Failed to load messages: ${_e.message}`)}finally{j(T,!1)}}function pe(){j(E,0),ve(!1)}function te(){ve(!0)}function ue(q){j(S,q,!0)}function me(){j(S,null)}async function be(){try{j(Y,await Yp(),!0)}catch{}}async function Q(q){if(g(J)||!g(v))return;const _e=await o();if(!_e)return;j(Z,null),j(J,!0),j(ee,null);const xe=new AbortController;try{await Wp(_e,{limit:q,onProgress:De=>{j(ee,{...De},!0)},signal:xe.signal}),await be(),await ve(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;j(Z,`Sync failed: ${De.message}`)}}finally{j(J,!1)}}async function ae(q){if(g(J)||!g(v))return;const _e=await o();if(!_e)return;j(Z,null),j(J,!0),j(ee,null);const xe=new AbortController;try{await Vp(_e,{limit:q,onProgress:De=>{j(ee,{...De},!0)},signal:xe.signal}),await be(),await ve(!1)}catch(De){if(De.name!=="AbortError"){if(!g(v))return;j(Z,`Sync more failed: ${De.message}`)}}finally{j(J,!1)}}async function X(){try{await ju(),await be(),j(k,[],!0),j(N,0),j(E,0)}catch(q){j(Z,`Failed to clear data: ${q.message}`)}}var ie=gg(),Be=m(ie);{var Ue=q=>{eh(q,{onsave:oe,get clientIdInput(){return g(d)},set clientIdInput(_e){j(d,_e,!0)}})},qe=q=>{fh(q,{get clientId(){return g(u)},get error(){return g(Z)},get loadingAuth(){return g(B)},onsignin:ce,onclear:$,onsignout:Ie})},Ke=q=>{mg(q,{get error(){return g(Z)},get profile(){return g(_)},get loadingProfile(){return g(W)},get emailMessages(){return g(k)},get totalLocalMessages(){return g(N)},get hasMoreLocal(){return g(Ee)},get loadingMessages(){return g(T)},get selectedMessage(){return g(S)},get syncStatus(){return g(Y)},get syncProgress(){return g(ee)},get isSyncing(){return g(J)},onsignout:Ie,onsearch:pe,onloadmore:te,onviewmessage:ue,onclosedetail:me,ondismisserror:()=>j(Z,null),onsync:Q,onsyncmore:ae,oncleardata:X,get searchQuery(){return g(x)},set searchQuery(_e){j(x,_e,!0)}})};fe(Be,q=>{g(de)?q(Ue):g(Ce)?q(Ke,!1):q(qe,1)})}L(t,ie),Ct()}var _g=z('<span class="sep svelte-t1ig66">Â·</span> ',1),bg=z('<div class="email-card svelte-t1ig66"><div class="email-subj svelte-t1ig66"> </div> <div class="email-meta svelte-t1ig66"> <!></div></div>'),wg=z('<div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">remaining</span></div>'),kg=z('<div class="stats-row svelte-t1ig66"><div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tok/s</span></div> <div class="stat svelte-t1ig66"><span class="stat-val svelte-t1ig66"> </span> <span class="stat-label svelte-t1ig66">tokens</span></div> <!></div>'),xg=z('<span class="result-summary svelte-t1ig66"> </span>'),Sg=z('<span class="result-tag svelte-t1ig66"> </span>'),Tg=z('<div class="result-tags svelte-t1ig66"></div>'),Eg=z('<div class="result-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <span class="sep svelte-t1ig66">Â·</span> </div>'),Ag=z('<div class="result-card svelte-t1ig66"><span class="result-action svelte-t1ig66"> </span> <!> <!> <!></div>'),Cg=z('<div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">already classified</span></div>'),Ig=z('<div class="summary-stat svelte-t1ig66"><span class="sstat-val err svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">errors</span></div>'),Pg=z('<span class="ssec-item svelte-t1ig66">Avg speed: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span>',1),Rg=z('<span class="ri-action svelte-t1ig66"> </span>'),Og=z('<span class="ri-error svelte-t1ig66">ERROR</span>'),Dg=z('<span class="sep svelte-t1ig66">Â·</span> ',1),jg=z('<div class="ri-summary svelte-t1ig66"> </div>'),Mg=z('<span class="sep svelte-t1ig66">Â·</span> ',1),Lg=z('<!> <div class="ri-stats svelte-t1ig66"> <span class="sep svelte-t1ig66">Â·</span> <!></div>',1),Ng=z('<details class="ri-err-details svelte-t1ig66"><summary class="ri-err-summary svelte-t1ig66">View error details</summary> <div class="ri-err-msg svelte-t1ig66"> </div></details>'),qg=z('<div><div class="ri-head svelte-t1ig66"><span class="ri-subj svelte-t1ig66"> </span> <!></div> <div class="ri-meta svelte-t1ig66"> <!></div> <!></div>'),Bg=z('<details class="results-details svelte-t1ig66"><summary class="results-summary svelte-t1ig66"> </summary> <div class="results-list svelte-t1ig66"></div></details>'),zg=z('<div class="summary-card svelte-t1ig66"><div class="summary-head svelte-t1ig66"><span class="summary-title svelte-t1ig66">Scan Summary</span></div> <div class="summary-grid svelte-t1ig66"><div class="summary-stat svelte-t1ig66"><span class="sstat-val svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">emails processed</span></div> <!> <div class="summary-stat svelte-t1ig66"><span class="sstat-val success svelte-t1ig66"> </span> <span class="sstat-label svelte-t1ig66">classified</span></div> <!></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">LLM Performance</div> <div class="ssec-items svelte-t1ig66"><!> <span class="ssec-item svelte-t1ig66">Total tokens: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Duration: <strong class="svelte-t1ig66"> </strong></span></div></div> <div class="summary-section svelte-t1ig66"><div class="ssec-title svelte-t1ig66">Prompt Configuration</div> <div class="ssec-items svelte-t1ig66"><span class="ssec-item svelte-t1ig66">System prompt: <strong class="svelte-t1ig66"> </strong></span> <span class="sep svelte-t1ig66">Â·</span> <span class="ssec-item svelte-t1ig66">Avg email prompt: <strong class="svelte-t1ig66"> </strong></span></div></div> <!></div>'),Fg=z('<span class="err svelte-t1ig66"> </span>'),Kg=z('<div class="totals svelte-t1ig66"><span> </span> <!> <span class="sep svelte-t1ig66">Â·</span> <span> </span> <span class="sep svelte-t1ig66">Â·</span> <span> </span></div>'),Ug=z('<button class="action-btn svelte-t1ig66">View Prompt Config</button>'),Gg=z('<button class="action-btn svelte-t1ig66">View Prompt</button> <button class="action-btn stop svelte-t1ig66">Stop</button>',1),Hg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Wg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Vg=z('<pre class="prompt-code svelte-t1ig66"> </pre> <div class="prompt-meta svelte-t1ig66"> </div>',1),Yg=z('<div class="modal-bg svelte-t1ig66"><div class="modal svelte-t1ig66" role="dialog"><div class="modal-head svelte-t1ig66"><h3 class="svelte-t1ig66">Current Prompt</h3> <button class="modal-close svelte-t1ig66">â</button></div> <div class="modal-tabs svelte-t1ig66"><button>System</button> <button>Email</button> <button>Full Prompt</button></div> <div class="modal-body svelte-t1ig66"><!></div></div></div>'),Xg=z('<div class="live svelte-t1ig66"><div class="live-head svelte-t1ig66"><span class="live-title svelte-t1ig66"><!></span> <span class="live-pct svelte-t1ig66"> </span></div> <div class="bar-track svelte-t1ig66"><div></div></div> <!> <!> <!> <!> <div class="actions svelte-t1ig66"><!></div></div> <!>',1);function Qg(t,e){At(e,!0);let r=Oe(e,"progress",3,null),a=Re(!1),i=Re("system");function o(E){return!E||E<0?"â":E<1e3?`${Math.round(E)}ms`:`${(E/1e3).toFixed(1)}s`}function u(E){return E?E>=1e3?`${(E/1e3).toFixed(1)}k`:String(E):"0"}function d(E){if(!E)return"â";const T=E.replace(/<.*>/,"").trim();return T.length>30?T.slice(0,28)+"â¦":T}function h(E){if(!E)return"";try{return new Date(E).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}function v(E){var W;if(!((W=E==null?void 0:E.totals)!=null&&W.elapsed)||!(E!=null&&E.current)||E.current<2)return null;const T=E.totals.elapsed/E.current;return(E.total-E.current)*T}let _=Et(()=>{var E;return(E=r())!=null&&E.total?Math.round(r().current/r().total*100):0}),S=Et(()=>v(r()));var x=Rr(),k=We(x);{var N=E=>{var T=Xg(),B=We(T),W=m(B),Z=m(W),Y=m(Z);{var ee=qe=>{var Ke=ri("Scan complete");L(qe,Ke)},J=qe=>{var Ke=ri();ne(()=>H(Ke,`Processing ${r().current??""} of ${r().total??""}`)),L(qe,Ke)};fe(Y,qe=>{r().phase==="done"?qe(ee):qe(J,!1)})}var U=b(Z,2),de=m(U),Ce=b(W,2),Ee=m(Ce);let oe,$;var ce=b(Ce,2);{var Ie=qe=>{var Ke=bg(),q=m(Ke),_e=m(q),xe=b(q,2),De=m(xe),et=b(De);{var tt=ct=>{var Dt=_g(),Ge=b(We(Dt),1,!0);ne(Ve=>H(Ge,Ve),[()=>h(r().email.date)]),L(ct,Dt)};fe(et,ct=>{r().email.date&&ct(tt)})}ne(ct=>{H(_e,r().email.subject||"(no subject)"),H(De,`${ct??""} `)},[()=>d(r().email.from)]),L(qe,Ke)};fe(ce,qe=>{r().email&&r().phase!=="done"&&qe(Ie)})}var le=b(ce,2);{var ve=qe=>{var Ke=kg(),q=m(Ke),_e=m(q),xe=m(_e),De=b(q,2),et=m(De),tt=m(et),ct=b(De,2);{var Dt=Ge=>{var Ve=wg(),nt=m(Ve),rt=m(nt);ne(mt=>H(rt,`~${mt??""}`),[()=>o(g(S))]),L(Ge,Ve)};fe(ct,Ge=>{g(S)&&Ge(Dt)})}ne(Ge=>{H(xe,Ge),H(tt,r().live.numTokens||0)},[()=>r().live.tps?r().live.tps.toFixed(0):"â"]),L(qe,Ke)};fe(le,qe=>{r().live&&r().phase==="generating"&&qe(ve)})}var pe=b(le,2);{var te=qe=>{var Ke=Ag(),q=m(Ke),_e=m(q),xe=b(q,2);{var De=Ge=>{var Ve=xg(),nt=m(Ve);ne(()=>H(nt,r().result.summary)),L(Ge,Ve)};fe(xe,Ge=>{r().result.summary&&Ge(De)})}var et=b(xe,2);{var tt=Ge=>{var Ve=Tg();un(Ve,21,()=>r().result.tags,ir,(nt,rt)=>{var mt=Sg(),xt=m(mt);ne(()=>H(xt,g(rt))),L(nt,mt)}),L(Ge,Ve)};fe(et,Ge=>{var Ve;(Ve=r().result.tags)!=null&&Ve.length&&Ge(tt)})}var ct=b(et,2);{var Dt=Ge=>{var Ve=Eg(),nt=m(Ve),rt=b(nt,2),mt=b(rt,2);ne((xt,Ft)=>{H(nt,`${xt??""} `),H(rt,` ${r().emailStats.inputTokens??""} in + ${r().emailStats.numTokens??""} out tokens `),H(mt,` ${Ft??""}`)},[()=>r().emailStats.tps?`${r().emailStats.tps.toFixed(0)} tok/s`:"",()=>o(r().emailStats.elapsed)]),L(Ge,Ve)};fe(ct,Ge=>{r().emailStats&&Ge(Dt)})}ne(()=>H(_e,r().result.action)),L(qe,Ke)};fe(pe,qe=>{r().result&&qe(te)})}var ue=b(pe,2);{var me=qe=>{var Ke=zg(),q=b(m(Ke),2),_e=m(q),xe=m(_e),De=m(xe),et=b(_e,2);{var tt=ut=>{var wt=Cg(),Kt=m(wt),gn=m(Kt);ne(()=>H(gn,r().summary.skipped)),L(ut,wt)};fe(et,ut=>{var wt;(wt=r().summary)!=null&&wt.skipped&&ut(tt)})}var ct=b(et,2),Dt=m(ct),Ge=m(Dt),Ve=b(ct,2);{var nt=ut=>{var wt=Ig(),Kt=m(wt),gn=m(Kt);ne(()=>H(gn,r().errors)),L(ut,wt)};fe(Ve,ut=>{r().errors>0&&ut(nt)})}var rt=b(q,2),mt=b(m(rt),2),xt=m(mt);{var Ft=ut=>{var wt=Pg(),Kt=We(wt),gn=b(m(Kt)),Zn=m(gn);ne(()=>H(Zn,`${r().summary.avgTps??""} tok/s`)),L(ut,wt)};fe(xt,ut=>{var wt;(wt=r().summary)!=null&&wt.avgTps&&ut(Ft)})}var _t=b(xt,2),vt=b(m(_t)),gt=m(vt),fn=b(_t,4),sn=b(m(fn)),mn=m(sn),Zt=b(rt,2),Gt=b(m(Zt),2),Ht=m(Gt),En=b(m(Ht)),jt=m(En),je=b(Ht,4),Qn=b(m(je)),An=m(Qn),jr=b(Zt,2);{var Ae=ut=>{var wt=Bg(),Kt=m(wt),gn=m(Kt),Zn=b(Kt,2);un(Zn,21,()=>r().results,ir,(St,It)=>{var qn=qg();let Bn;var lr=m(qn),cr=m(lr),yt=m(cr),Lt=b(cr,2);{var yn=Ot=>{var Pt=Rg(),Pn=m(Pt);ne(()=>H(Pn,g(It).classification.action)),L(Ot,Pt)},_n=Ot=>{var Pt=Og();L(Ot,Pt)};fe(Lt,Ot=>{g(It).success?Ot(yn):Ot(_n,!1)})}var ur=b(lr,2),fr=m(ur),Yr=b(fr);{var Cn=Ot=>{var Pt=Dg(),Pn=b(We(Pt),1,!0);ne(Me=>H(Pn,Me),[()=>h(g(It).email.date)]),L(Ot,Pt)};fe(Yr,Ot=>{g(It).email.date&&Ot(Cn)})}var Wt=b(ur,2);{var In=Ot=>{var Pt=Lg(),Pn=We(Pt);{var Me=lt=>{var kt=jg(),Vt=m(kt);ne(()=>H(Vt,g(It).classification.summary)),L(lt,kt)};fe(Pn,lt=>{g(It).classification.summary&&lt(Me)})}var A=b(Pn,2),ge=m(A),ke=b(ge,2),st=b(ke);{var bt=lt=>{var kt=Mg(),Vt=b(We(kt));ne(zn=>H(Vt,` ${zn??""} tok/s`),[()=>g(It).stats.tps.toFixed(0)]),L(lt,kt)};fe(st,lt=>{g(It).stats.tps&&lt(bt)})}ne(lt=>{H(ge,`${g(It).stats.inputTokens??""} in + ${g(It).stats.numTokens??""} out tokens `),H(ke,` ${lt??""} `)},[()=>o(g(It).stats.elapsed)]),L(Ot,Pt)},wr=Ot=>{var Pt=Ng(),Pn=b(m(Pt),2),Me=m(Pn);ne(()=>H(Me,g(It).error)),L(Ot,Pt)};fe(Wt,Ot=>{g(It).success?Ot(In):Ot(wr,!1)})}ne(Ot=>{Bn=Bt(qn,1,"result-item svelte-t1ig66",null,Bn,{failed:!g(It).success}),H(yt,g(It).email.subject||"(no subject)"),H(fr,`${Ot??""} `)},[()=>d(g(It).email.from)]),L(St,qn)}),ne(()=>H(gn,`View ${r().results.length??""} email results`)),L(ut,wt)};fe(jr,ut=>{var wt;((wt=r().results)==null?void 0:wt.length)>0&&ut(Ae)})}ne((ut,wt,Kt,gn,Zn)=>{var St;H(De,((St=r().summary)==null?void 0:St.processed)||r().total||0),H(Ge,r().classified||0),H(gt,`${ut??""} in + ${wt??""} out`),H(mn,Kt),H(jt,`${gn??""} chars`),H(An,`${Zn??""} chars`)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed),()=>{var ut;return u(((ut=r().summary)==null?void 0:ut.systemPromptSize)||0)},()=>{var ut;return u(((ut=r().summary)==null?void 0:ut.avgPromptSize)||0)}]),L(qe,Ke)},be=qe=>{var Ke=Rr(),q=We(Ke);{var _e=xe=>{var De=Kg(),et=m(De),tt=m(et),ct=b(et,2);{var Dt=mt=>{var xt=Fg(),Ft=m(xt);ne(()=>H(Ft,`${r().errors??""} errors`)),L(mt,xt)};fe(ct,mt=>{r().errors&&mt(Dt)})}var Ge=b(ct,4),Ve=m(Ge),nt=b(Ge,4),rt=m(nt);ne((mt,xt,Ft)=>{H(tt,`${(r().classified||0)??""} classified`),H(Ve,`${mt??""} in + ${xt??""} out tokens`),H(rt,Ft)},[()=>u(r().totals.inputTokens),()=>u(r().totals.outputTokens),()=>o(r().totals.elapsed)]),L(xe,De)};fe(q,xe=>{r().totals&&xe(_e)})}L(qe,Ke)};fe(ue,qe=>{r().phase==="done"?qe(me):qe(be,!1)})}var Q=b(ue,2),ae=m(Q);{var X=qe=>{var Ke=Ug();Ke.__click=()=>j(a,!0),L(qe,Ke)},ie=qe=>{var Ke=Gg(),q=We(Ke);q.__click=()=>j(a,!0);var _e=b(q,2);_e.__click=function(...xe){var De;(De=e.onstop)==null||De.apply(this,xe)},L(qe,Ke)};fe(ae,qe=>{r().phase==="done"?qe(X):qe(ie,!1)})}var Be=b(B,2);{var Ue=qe=>{var Ke=Yg();Ke.__click=()=>j(a,!1),Ke.__keydown=_t=>_t.key==="Escape"&&j(a,!1);var q=m(Ke);q.__click=_t=>_t.stopPropagation();var _e=m(q),xe=b(m(_e),2);xe.__click=()=>j(a,!1);var De=b(_e,2),et=m(De);let tt;et.__click=()=>j(i,"system");var ct=b(et,2);let Dt;ct.__click=()=>j(i,"email");var Ge=b(ct,2);let Ve;Ge.__click=()=>j(i,"full");var nt=b(De,2),rt=m(nt);{var mt=_t=>{var vt=Hg(),gt=We(vt),fn=m(gt),sn=b(gt,2),mn=m(sn);ne(()=>{H(fn,sa),H(mn,`${sa.length??""} chars`)}),L(_t,vt)},xt=_t=>{var vt=Wg(),gt=We(vt),fn=m(gt),sn=b(gt,2),mn=m(sn);ne(()=>{var Zt,Gt,Ht;H(fn,((Zt=r().prompt)==null?void 0:Zt.user)||"(no email prompt)"),H(mn,`${(((Ht=(Gt=r().prompt)==null?void 0:Gt.user)==null?void 0:Ht.length)||0)??""} chars`)}),L(_t,vt)},Ft=_t=>{var vt=Vg(),gt=We(vt),fn=m(gt),sn=b(gt,2),mn=m(sn);ne(()=>{var Zt,Gt,Ht,En,jt,je;H(fn,`${(((Zt=r().prompt)==null?void 0:Zt.system)||"")??""}

---

${(((Gt=r().prompt)==null?void 0:Gt.user)||"")??""}`),H(mn,`${(((En=(Ht=r().prompt)==null?void 0:Ht.system)==null?void 0:En.length)||0)+(((je=(jt=r().prompt)==null?void 0:jt.user)==null?void 0:je.length)||0)} chars total`)}),L(_t,vt)};fe(rt,_t=>{g(i)==="system"?_t(mt):g(i)==="email"?_t(xt,1):_t(Ft,!1)})}ne(()=>{tt=Bt(et,1,"mtab svelte-t1ig66",null,tt,{active:g(i)==="system"}),Dt=Bt(ct,1,"mtab svelte-t1ig66",null,Dt,{active:g(i)==="email"}),Ve=Bt(Ge,1,"mtab svelte-t1ig66",null,Ve,{active:g(i)==="full"})}),L(qe,Ke)};fe(Be,qe=>{g(a)&&qe(Ue)})}ne(()=>{H(de,`${g(_)??""}%`),oe=Bt(Ee,1,"bar-fill svelte-t1ig66",null,oe,{done:r().phase==="done"}),$=Tn(Ee,"",$,{width:`${g(_)??""}%`})}),L(E,T)};fe(k,E=>{r()&&E(N)})}L(t,x),Ct()}Ut(["click","keydown"]);var Zg=z('<span class="spinner svelte-ois7em"></span>'),Jg=No('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'),$g=z('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),ey=z("<option> </option>"),ty=z('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),ny=z('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><div class="scan-title-row svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <button class="inspect-btn svelte-ois7em" title="View system prompt and LLM config"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg> Prompt</button></div> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function ry(t,e){At(e,!0);let r=Oe(e,"engineStatus",3,"idle"),a=Oe(e,"modelName",3,""),i=Oe(e,"isScanning",3,!1),o=Oe(e,"scanProgress",3,null),u=Oe(e,"scanCount",15,20),d=Oe(e,"stats",3,null);const h=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function v(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function _(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function S(){return r()==="ready"&&!i()}var x=ny(),k=m(x),N=m(k),E=m(N);{var T=Q=>{var ae=Zg();L(Q,ae)},B=Q=>{var ae=Jg();L(Q,ae)};fe(E,Q=>{i()?Q(T):Q(B,!1)})}var W=b(N,2),Z=m(W),Y=b(m(Z),2);Y.__click=function(...Q){var ae;(ae=e.oninspect)==null||ae.apply(this,Q)};var ee=b(Z,2),J=m(ee);let U;var de=b(J),Ce=b(k,2);{var Ee=Q=>{var ae=$g(),X=m(ae),ie=m(X),Be=b(X,4),Ue=m(Be),qe=b(Be,4),Ke=m(qe);ne(()=>{H(ie,`${d().totalEmails??""} emails in storage`),H(Ue,`${d().classified??""} classified`),H(Ke,`${d().unclassified??""} new`)}),L(Q,ae)};fe(Ce,Q=>{d()&&Q(Ee)})}var oe=b(Ce,2),$=m(oe),ce=b(m($),2);un(ce,21,()=>h,ir,(Q,ae)=>{var X=ey(),ie=m(X),Be={};ne(()=>{H(ie,g(ae).label),Be!==(Be=g(ae).value)&&(X.value=(X.__value=g(ae).value)??"")}),L(Q,X)});var Ie=b($,2),le=m(Ie);le.__click=function(...Q){var ae;(ae=e.onscan)==null||ae.apply(this,Q)};var ve=m(le),pe=b(le,2);pe.__click=function(...Q){var ae;(ae=e.onrescan)==null||ae.apply(this,Q)};var te=b(oe,2);{var ue=Q=>{var ae=ty();L(Q,ae)};fe(te,Q=>{r()!=="ready"&&r()!=="loading"&&Q(ue)})}var me=b(te,2);{var be=Q=>{Qg(Q,{get progress(){return o()},get onstop(){return e.onstop}})};fe(me,Q=>{var ae;(i()||((ae=o())==null?void 0:ae.phase)==="done")&&Q(be)})}ne((Q,ae,X,ie)=>{U=Tn(J,"",U,Q),H(de,` ${ae??""}`),ce.disabled=i(),le.disabled=X,H(ve,i()?"Scanning...":"Scan New"),pe.disabled=ie},[()=>({background:_()}),v,()=>!S(),()=>!S()]),qo(ce,u),L(t,x),Ct()}Ut(["click"]);var ay=z('<span class="row-date svelte-1czytqk"> </span>'),sy=z('<span class="tag svelte-1czytqk"> </span>'),iy=z('<span class="row-tags svelte-1czytqk"></span>'),oy=z('<span class="row-reason svelte-1czytqk"> </span>'),ly=z('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),cy=z('<span class="status-label svelte-1czytqk"> </span>'),uy=z('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),fy=z('<p class="summary-reason svelte-1czytqk"> </p>'),dy=z('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),vy=z('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function hc(t,e){At(e,!0);let r=Oe(e,"actionColor",3,"#666"),a=Oe(e,"dimmed",3,!1);function i(le){if(!le)return"";try{return new Date(le).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=Et(()=>e.item.status==="pending"),u=Re(!1);var d=vy(),h=We(d);let v;var _=m(h);_.__click=()=>j(u,!g(u));let S;var x=m(_),k=m(x),N=b(x,2),E=m(N),T=m(E),B=b(E,2);{var W=le=>{var ve=ay(),pe=m(ve);ne(te=>H(pe,te),[()=>i(e.item.date)]),L(le,ve)};fe(B,le=>{e.item.date&&le(W)})}var Z=b(N,2);{var Y=le=>{var ve=iy();un(ve,21,()=>e.item.tags,ir,(pe,te)=>{var ue=sy();let me;var be=m(ue);ne(Q=>{me=Tn(ue,"",me,Q),H(be,g(te))},[()=>({background:Pv(g(te))})]),L(pe,ue)}),L(le,ve)};fe(Z,le=>{e.item.tags&&e.item.tags.length>0&&le(Y)})}var ee=b(Z,2);{var J=le=>{var ve=oy(),pe=m(ve);ne(()=>H(pe,e.item.reason)),L(le,ve)};fe(ee,le=>{e.item.reason&&!g(u)&&le(J)})}var U=b(_,2),de=m(U);{var Ce=le=>{var ve=ly(),pe=We(ve);pe.__click=()=>e.onmarkacted(e.item.emailId);var te=b(pe,2);te.__click=()=>e.ondismiss(e.item.emailId),L(le,ve)},Ee=le=>{var ve=cy(),pe=m(ve);ne(()=>H(pe,e.item.status)),L(le,ve)};fe(de,le=>{g(o)?le(Ce):le(Ee,!1)})}var oe=b(de,2);{var $=le=>{var ve=uy();ve.__click=()=>e.onremove(e.item.emailId),L(le,ve)};fe(oe,le=>{e.onremove&&le($)})}var ce=b(h,2);{var Ie=le=>{var ve=dy();let pe;var te=m(ve),ue=m(te),me=b(te,2);{var be=Q=>{var ae=fy(),X=m(ae);ne(()=>H(X,e.item.reason)),L(Q,ae)};fe(me,Q=>{e.item.reason&&Q(be)})}ne(()=>{pe=Tn(ve,"",pe,{"border-left-color":r()}),H(ue,e.item.summary)}),L(le,ve)};fe(ce,le=>{g(u)&&e.item.summary&&le(Ie)})}ne(()=>{v=Bt(h,1,"email-row svelte-1czytqk",null,v,{dimmed:a()}),S=Tn(_,"",S,{"border-left-color":r()}),H(k,e.item.subject),H(T,e.item.from)}),L(t,d),Ct()}Ut(["click"]);var py=z('<span class="group-acted svelte-tl1unp"> </span>'),hy=z('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),my=z('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),gy=z('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),yy=z('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),_y=z('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),by=z('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function wy(t,e){At(e,!0);let r=Oe(e,"color",3,"#888");Oe(e,"count",3,0);let a=Oe(e,"items",19,()=>[]),i=Oe(e,"expanded",3,!1),o=Et(()=>a().filter(J=>J.status==="pending")),u=Et(()=>a().filter(J=>J.status!=="pending")),d=Re(!1);function h(J){return J.split("_").map(U=>U.charAt(0)+U.slice(1).toLowerCase()).join(" ")}var v=by(),_=m(v);_.__click=function(...J){var U;(U=e.ontoggle)==null||U.apply(this,J)};var S=m(_);let x;var k=m(S),N=b(S,2),E=m(N),T=b(N,2);{var B=J=>{var U=py(),de=m(U);ne(()=>H(de,`${g(u).length??""} handled`)),L(J,U)};fe(T,J=>{g(u).length>0&&J(B)})}var W=b(T,4);let Z;var Y=b(_,2);{var ee=J=>{var U=_y(),de=m(U);{var Ce=pe=>{var te=hy();L(pe,te)};fe(de,pe=>{g(o).length===0&&g(u).length===0&&pe(Ce)})}var Ee=b(de,2);un(Ee,17,()=>g(o),pe=>pe.emailId,(pe,te)=>{hc(pe,{get item(){return g(te)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var oe=b(Ee,2);{var $=pe=>{var te=my(),ue=m(te),me=m(ue),be=b(ue,2);un(be,17,()=>g(u),Q=>Q.emailId,(Q,ae)=>{hc(Q,{get item(){return g(ae)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ne(()=>H(me,`${g(u).length??""} handled`)),L(pe,te)};fe(oe,pe=>{g(u).length>0&&pe($)})}var ce=b(oe,2),Ie=m(ce);{var le=pe=>{var te=gy();te.__click=()=>j(d,!0),L(pe,te)},ve=pe=>{var te=yy(),ue=m(te),me=b(ue);me.__click=()=>j(d,!1);var be=b(me,2);be.__click=()=>{e.oncleargroup(),j(d,!1)},ne(()=>H(ue,`Clear ${a().length??""} items? `)),L(pe,te)};fe(Ie,pe=>{g(d)?pe(ve,!1):pe(le)})}L(J,U)};fe(Y,J=>{i()&&J(ee)})}ne(J=>{x=Tn(S,"",x,{background:r()}),H(k,J),H(E,g(o).length),Z=Bt(W,0,"chevron svelte-tl1unp",null,Z,{open:i()})},[()=>h(e.action)]),L(t,v),Ct()}Ut(["click"]);var ky=z(`<div class="section-desc svelte-10pcy9j">This is the system prompt sent to the LLM before each email. It instructs the model
            on how to classify emails and what JSON format to produce.</div> <pre class="code-block svelte-10pcy9j"> </pre>`,1),xy=z(`<div class="section-desc svelte-10pcy9j">Each email is formatted into this template and sent as the user message.
            The full email body is included.</div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Format:</div> <pre class="code-block template svelte-10pcy9j"></pre></div> <div class="template-format svelte-10pcy9j"><div class="format-label svelte-10pcy9j">Sample:</div> <pre class="code-block sample svelte-10pcy9j"> </pre></div>`,1),Sy=z(`<div class="section-desc svelte-10pcy9j">These generation parameters control how the LLM produces its output
            for email classification.</div> <div class="config-grid svelte-10pcy9j"><div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">max_new_tokens</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Maximum tokens in the response (classification needs ~150)</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">enable_thinking</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Thinking mode disabled â structured JSON doesn't need reasoning</span></div> <div class="config-row svelte-10pcy9j"><span class="config-key svelte-10pcy9j">do_sample</span> <span class="config-val svelte-10pcy9j"> </span> <span class="config-desc svelte-10pcy9j">Greedy decoding â deterministic, consistent output</span></div></div> <div class="section-desc svelte-10pcy9j" style="margin-top: 1rem;">The full message array sent to the model:</div> <pre class="code-block svelte-10pcy9j"></pre>`,1),Ty=z('<div class="backdrop svelte-10pcy9j"><div class="modal svelte-10pcy9j" role="dialog" aria-label="Prompt Inspector"><div class="modal-header svelte-10pcy9j"><h2 class="svelte-10pcy9j">Prompt Inspector</h2> <button class="close-btn svelte-10pcy9j" aria-label="Close">â</button></div> <div class="tabs svelte-10pcy9j"><button>System Prompt</button> <button>Email Template</button> <button>Generation Config</button></div> <div class="modal-body svelte-10pcy9j"><!></div></div></div>');function Ey(t,e){At(e,!0);let r=Oe(e,"open",15,!1),a=Oe(e,"sampleEmail",3,null),i=Re("system");function o(){return a()?Pu(a()):["Subject: Your order has shipped!","From: orders@example.com","To: me","Date: Sat, Feb 15, 2026","Labels: INBOX, CATEGORY_UPDATES","","Hi! Your order #12345 has shipped via FedEx. Tracking number: 7891011..."].join(`
`)}function u(){r(!1)}function d(S){S.target===S.currentTarget&&u()}var h=Rr(),v=We(h);{var _=S=>{var x=Ty();x.__click=d,x.__keydown=$=>$.key==="Escape"&&u();var k=m(x),N=m(k),E=b(m(N),2);E.__click=u;var T=b(N,2),B=m(T);let W;B.__click=()=>j(i,"system");var Z=b(B,2);let Y;Z.__click=()=>j(i,"email");var ee=b(Z,2);let J;ee.__click=()=>j(i,"config");var U=b(T,2),de=m(U);{var Ce=$=>{var ce=ky(),Ie=b(We(ce),2),le=m(Ie);ne(()=>H(le,sa)),L($,ce)},Ee=$=>{var ce=xy(),Ie=b(We(ce),2),le=b(m(Ie),2);le.textContent=`Subject: {email.subject}
From: {email.from}
To: {email.to}
Date: {formatted date}
Labels: {email.labels}

{email.body (full content)`;var ve=b(Ie,2),pe=b(m(ve),2),te=m(pe);ne(ue=>H(te,ue),[o]),L($,ce)},oe=$=>{var ce=Sy(),Ie=b(We(ce),2),le=m(Ie),ve=b(m(le),2),pe=m(ve),te=b(le,2),ue=b(m(te),2),me=m(ue),be=b(te,2),Q=b(m(be),2),ae=m(Q),X=b(Ie,4);X.textContent=`[
  { role: "system", content: SYSTEM_PROMPT },
  { role: "user",   content: formatEmailPrompt(email) }
]`,ne(()=>{H(pe,Tv.maxTokens),H(me,"false"),H(ae,"false")}),L($,ce)};fe(de,$=>{g(i)==="system"?$(Ce):g(i)==="email"?$(Ee,1):g(i)==="config"&&$(oe,2)})}ne(()=>{W=Bt(B,1,"tab svelte-10pcy9j",null,W,{active:g(i)==="system"}),Y=Bt(Z,1,"tab svelte-10pcy9j",null,Y,{active:g(i)==="email"}),J=Bt(ee,1,"tab svelte-10pcy9j",null,J,{active:g(i)==="config"})}),L(S,x)};fe(v,S=>{r()&&S(_)})}L(t,h),Ct()}Ut(["click","keydown"]);var Ay=z('<span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span>',1),Cy=z('<div class="summary-row svelte-s2dwjj"><span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <span class="sep svelte-s2dwjj">Â·</span> <span class="s-item"> </span> <!></div>'),Iy=z('<span class="confirm-inline svelte-s2dwjj"> <button class="link-btn svelte-s2dwjj">No</button> <button class="link-btn danger svelte-s2dwjj">Yes</button></span>'),Py=z('<button class="chip svelte-s2dwjj"> </button>'),Ry=z('<div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Clear by action group</div> <div class="group-chips svelte-s2dwjj"></div></div>'),Oy=z('<div class="confirm-row svelte-s2dwjj"><span>Clear all classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Dy=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear all classifications</span> <span class="action-desc svelte-s2dwjj">Remove all LLM scan results. Emails stay.</span></button>'),jy=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all synced emails &amp; classifications?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),My=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear emails &amp; classifications</span> <span class="action-desc svelte-s2dwjj">Remove all synced Gmail data and scan results.</span></button>'),Ly=z('<div class="confirm-row svelte-s2dwjj"><span>Delete all contacts?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Delete</button></div>'),Ny=z('<button class="action-row svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Clear contacts</span> <span class="action-desc svelte-s2dwjj">Remove extracted contacts from the database.</span></button>'),qy=z('<div class="confirm-row nuke svelte-s2dwjj"><span>This will delete the entire database and reload the page. Are you sure?</span> <button class="link-btn svelte-s2dwjj">Cancel</button> <button class="link-btn danger svelte-s2dwjj">Wipe Everything</button></div>'),By=z('<button class="action-row nuke-btn svelte-s2dwjj"><span class="action-label svelte-s2dwjj">Wipe entire local storage</span> <span class="action-desc svelte-s2dwjj">Delete the IndexedDB database and reload. All data will be lost.</span></button>'),zy=z('<div class="busy-overlay svelte-s2dwjj">Working...</div>'),Fy=z('<div class="dm-panel svelte-s2dwjj"><!> <!> <div class="section svelte-s2dwjj"><div class="section-title svelte-s2dwjj">Bulk actions</div> <div class="btn-list svelte-s2dwjj"><!> <!> <!></div></div> <div class="section danger-section svelte-s2dwjj"><!></div> <!></div>'),Ky=z('<div class="dm svelte-s2dwjj"><button class="dm-toggle svelte-s2dwjj"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg> Data Management <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Uy(t,e){At(e,!0);let r=Oe(e,"groupOrder",19,()=>[]),a=Re(!1),i=Re(null),o=Re(!1),u=Re(null);async function d(){var oe;const[U,de,Ce]=await Promise.all([ze.items.where("sourceType").equals("gmail").count(),ze.emailClassifications.count(),ze.contacts.count()]);let Ee=0;try{const $=await((oe=navigator.storage)==null?void 0:oe.estimate());Ee=($==null?void 0:$.usage)??0}catch{}j(u,{emailCount:U,classCount:de,contactCount:Ce,totalBytes:Ee},!0)}function h(U){return U?U<1024?`${U} B`:U<1024*1024?`${(U/1024).toFixed(1)} KB`:`${(U/(1024*1024)).toFixed(1)} MB`:"â"}function v(){j(a,!g(a)),g(a)&&d()}async function _(U){var de;j(o,!0),j(i,null);try{await U(),await d(),(de=e.onrefresh)==null||de.call(e)}finally{j(o,!1)}}async function S(){await _(()=>Vl())}async function x(U){await _(()=>Ko(U))}async function k(){await _(async()=>{await ju(),await Vl()})}async function N(){await _(()=>ze.contacts.clear())}async function E(){await _(async()=>{await ze.delete(),window.location.reload()})}function T(U){return U.split("_").map(de=>de.charAt(0)+de.slice(1).toLowerCase()).join(" ")}var B=Ky(),W=m(B);W.__click=v;var Z=b(m(W),2);let Y;var ee=b(W,2);{var J=U=>{var de=Fy(),Ce=m(de);{var Ee=q=>{var _e=Cy(),xe=m(_e),De=m(xe),et=b(xe,4),tt=m(et),ct=b(et,4),Dt=m(ct),Ge=b(ct,2);{var Ve=nt=>{var rt=Ay(),mt=b(We(rt),2),xt=m(mt);ne(Ft=>H(xt,`${Ft??""} used`),[()=>h(g(u).totalBytes)]),L(nt,rt)};fe(Ge,nt=>{g(u).totalBytes&&nt(Ve)})}ne(()=>{H(De,`${g(u).emailCount??""} emails`),H(tt,`${g(u).classCount??""} classifications`),H(Dt,`${g(u).contactCount??""} contacts`)}),L(q,_e)};fe(Ce,q=>{g(u)&&q(Ee)})}var oe=b(Ce,2);{var $=q=>{var _e=Ry(),xe=b(m(_e),2);un(xe,21,r,ir,(De,et)=>{var tt=Rr(),ct=We(tt);{var Dt=Ve=>{var nt=Iy(),rt=m(nt),mt=b(rt);mt.__click=()=>j(i,null);var xt=b(mt,2);xt.__click=()=>x(g(et)),ne(Ft=>{H(rt,`Delete ${Ft??""}? `),xt.disabled=g(o)},[()=>T(g(et))]),L(Ve,nt)},Ge=Ve=>{var nt=Py();nt.__click=()=>j(i,`group:${g(et)}`);var rt=m(nt);ne(mt=>{nt.disabled=g(o),H(rt,`${mt??""} â`)},[()=>T(g(et))]),L(Ve,nt)};fe(ct,Ve=>{g(i)===`group:${g(et)}`?Ve(Dt):Ve(Ge,!1)})}L(De,tt)}),L(q,_e)};fe(oe,q=>{r().length>0&&q($)})}var ce=b(oe,2),Ie=b(m(ce),2),le=m(Ie);{var ve=q=>{var _e=Oy(),xe=b(m(_e),2);xe.__click=()=>j(i,null);var De=b(xe,2);De.__click=S,ne(()=>De.disabled=g(o)),L(q,_e)},pe=q=>{var _e=Dy();_e.__click=()=>j(i,"classifications"),ne(()=>_e.disabled=g(o)),L(q,_e)};fe(le,q=>{g(i)==="classifications"?q(ve):q(pe,!1)})}var te=b(le,2);{var ue=q=>{var _e=jy(),xe=b(m(_e),2);xe.__click=()=>j(i,null);var De=b(xe,2);De.__click=k,ne(()=>De.disabled=g(o)),L(q,_e)},me=q=>{var _e=My();_e.__click=()=>j(i,"emails"),ne(()=>_e.disabled=g(o)),L(q,_e)};fe(te,q=>{g(i)==="emails"?q(ue):q(me,!1)})}var be=b(te,2);{var Q=q=>{var _e=Ly(),xe=b(m(_e),2);xe.__click=()=>j(i,null);var De=b(xe,2);De.__click=N,ne(()=>De.disabled=g(o)),L(q,_e)},ae=q=>{var _e=Ny();_e.__click=()=>j(i,"contacts"),ne(()=>_e.disabled=g(o)),L(q,_e)};fe(be,q=>{g(i)==="contacts"?q(Q):q(ae,!1)})}var X=b(ce,2),ie=m(X);{var Be=q=>{var _e=qy(),xe=b(m(_e),2);xe.__click=()=>j(i,null);var De=b(xe,2);De.__click=E,ne(()=>De.disabled=g(o)),L(q,_e)},Ue=q=>{var _e=By();_e.__click=()=>j(i,"nuke"),ne(()=>_e.disabled=g(o)),L(q,_e)};fe(ie,q=>{g(i)==="nuke"?q(Be):q(Ue,!1)})}var qe=b(X,2);{var Ke=q=>{var _e=zy();L(q,_e)};fe(qe,q=>{g(o)&&q(Ke)})}L(U,de)};fe(ee,U=>{g(a)&&U(J)})}ne(()=>Y=Bt(Z,0,"chev svelte-s2dwjj",null,Y,{open:g(a)})),L(t,B),Ct()}Ut(["click"]);var Gy=z('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Hy=z('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span></div>',1),Wy=z('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Vy=z('<div class="actions-container svelte-12gkq0i"><!> <!> <!> <!> <!></div>');function Yy(t,e){At(e,!0);let r=Oe(e,"groups",19,()=>({})),a=Oe(e,"groupOrder",19,()=>[]),i=Oe(e,"counts",19,()=>({})),o=Oe(e,"stats",3,null),u=Oe(e,"expandedGroup",3,null),d=Oe(e,"isScanning",3,!1),h=Oe(e,"scanProgress",3,null),v=Oe(e,"scanCount",15,20),_=Oe(e,"error",3,null),S=Re(!1),x=Et(()=>{for(const J of a()){const U=r()[J];if((U==null?void 0:U.length)>0)return U[0]}return null});var k=Vy(),N=m(k);ry(N,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return h()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get onstop(){return e.onstop},oninspect:()=>j(S,!0),get scanCount(){return v()},set scanCount(J){v(J)}});var E=b(N,2);Ey(E,{get sampleEmail(){return g(x)},get open(){return g(S)},set open(J){j(S,J,!0)}});var T=b(E,2);{var B=J=>{var U=Gy(),de=m(U),Ce=m(de),Ee=b(de,2);Ee.__click=function(...oe){var $;($=e.ondismisserror)==null||$.apply(this,oe)},ne(()=>H(Ce,_())),L(J,U)};fe(T,J=>{_()&&J(B)})}var W=b(T,2);{var Z=J=>{var U=Hy(),de=We(U);un(de,20,a,$=>$,($,ce)=>{{let Ie=Et(()=>mo(ce)),le=Et(()=>{var te;return((te=r()[ce])==null?void 0:te.length)||0}),ve=Et(()=>r()[ce]||[]),pe=Et(()=>u()===ce);wy($,{get action(){return ce},get color(){return g(Ie)},get count(){return g(le)},get items(){return g(ve)},get expanded(){return g(pe)},ontoggle:()=>e.ontogglegroup(ce),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ce)})}});var Ce=b(de,2),Ee=m(Ce),oe=m(Ee);ne(()=>H(oe,`${i().total??""} emails classified into ${a().length??""} groups`)),L(J,U)},Y=J=>{var U=Wy();L(J,U)};fe(W,J=>{i().total>0?J(Z):d()||J(Y,1)})}var ee=b(W,2);Uy(ee,{get groupOrder(){return a()},get onrefresh(){return e.onrefresh}}),L(t,k),Ct()}Ut(["click"]);var Xy=z('<div class="actions-page svelte-3tch4q"><!></div>');function Qy(t,e){At(e,!0);const r=mu();let a=Re(en(r.status)),i=Re(""),o=Re(en({})),u=Re(en([])),d=Re(en({total:0})),h=Re(null),v=Re(null),_=Re(!1),S=Re(null),x=Re(20),k=Re(null),N=Re(null);an(()=>{const oe=r.onMessage($=>{if($.status==="ready"){j(a,"ready");const ce=hs.find(Ie=>Ie.id===r.modelId);j(i,(ce==null?void 0:ce.name)||r.modelId||"",!0)}$.status==="loading"&&j(a,"loading")});if(j(a,r.status,!0),r.modelId){const $=hs.find(ce=>ce.id===r.modelId);j(i,($==null?void 0:$.name)||r.modelId||"",!0)}return E(),()=>oe()});async function E(){try{const oe=await Ev();j(o,oe.groups,!0),j(u,oe.order,!0),j(d,await Av(),!0),j(h,await ho(),!0)}catch(oe){j(k,`Failed to load data: ${oe.message}`)}}async function T(){await W(!1)}async function B(){await W(!0)}async function W(oe){if(g(_)||!r.isReady)return;j(k,null),j(_,!0),j(S,null);const $=new AbortController;j(N,$,!0);try{await Cu(r,{count:g(x),force:oe,signal:$.signal,onProgress:ce=>{j(S,{...ce},!0)}}),await E()}catch(ce){$.signal.aborted||j(k,`Scan failed: ${ce.message}`)}finally{j(_,!1),j(N,null)}}function Z(){var oe;(oe=g(N))==null||oe.abort()}async function Y(oe){await si(oe,"acted"),await E()}async function ee(oe){await si(oe,"dismissed"),await E()}async function J(oe){await Iu(oe),await E()}async function U(oe){await Ko(oe),await E()}function de(oe){j(v,g(v)===oe?null:oe,!0)}var Ce=Xy(),Ee=m(Ce);Yy(Ee,{get engineStatus(){return g(a)},get modelName(){return g(i)},get groups(){return g(o)},get groupOrder(){return g(u)},get counts(){return g(d)},get stats(){return g(h)},get expandedGroup(){return g(v)},get isScanning(){return g(_)},get scanProgress(){return g(S)},get error(){return g(k)},onscan:T,onrescan:B,ontogglegroup:de,onmarkacted:Y,ondismiss:ee,onremove:J,oncleargroup:U,ondismisserror:()=>j(k,null),onstop:Z,onrefresh:E,get scanCount(){return g(x)},set scanCount(oe){j(x,oe,!0)}}),L(t,Ce),Ct()}var Zy=z('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Jy(t,e){At(e,!0);function r(){const U=location.hash;return U==="#dashboard"?"dashboard":U==="#actions"?"actions":"chat"}let a=Re(en(r()));an(()=>{function U(){j(a,r(),!0)}return window.addEventListener("hashchange",U),()=>window.removeEventListener("hashchange",U)});var i=Zy(),o=m(i),u=b(m(o),2),d=m(u);let h;var v=b(d,2);let _;var S=b(v,2);let x;var k=b(o,2),N=m(k);let E;var T=m(N);qp(T,{});var B=b(N,2);let W;var Z=m(B);Qy(Z,{});var Y=b(B,2);let ee;var J=m(Y);yg(J,{}),ne(()=>{h=Bt(d,1,"svelte-1n46o8q",null,h,{active:g(a)==="chat"}),_=Bt(v,1,"svelte-1n46o8q",null,_,{active:g(a)==="actions"}),x=Bt(S,1,"svelte-1n46o8q",null,x,{active:g(a)==="dashboard"}),E=Tn(N,"",E,{display:g(a)==="chat"?"flex":"none"}),W=Tn(B,"",W,{display:g(a)==="actions"?"flex":"none"}),ee=Tn(Y,"",ee,{display:g(a)==="dashboard"?"flex":"none"})}),L(t,i),Ct()}Bd(Jy,{target:document.getElementById("app")});
