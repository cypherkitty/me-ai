var rf=Object.defineProperty;var ml=t=>{throw TypeError(t)};var af=(t,e,r)=>e in t?rf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ue=(t,e,r)=>af(t,typeof e!="symbol"?e+"":e,r),qi=(t,e,r)=>e.has(t)||ml("Cannot "+r);var H=(t,e,r)=>(qi(t,e,"read from private field"),r?r.call(t):e.get(t)),Ge=(t,e,r)=>e.has(t)?ml("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),ze=(t,e,r,a)=>(qi(t,e,"write to private field"),a?a.call(t,r):e.set(t,r),r),qt=(t,e,r)=>(qi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Xi=!1;var _o=Array.isArray,sf=Array.prototype.indexOf,Ta=Array.prototype.includes,si=Array.from,of=Object.defineProperty,ma=Object.getOwnPropertyDescriptor,lf=Object.getOwnPropertyDescriptors,uf=Object.prototype,cf=Array.prototype,iu=Object.getPrototypeOf,yl=Object.isExtensible;const ff=()=>{};function df(t){for(var e=0;e<t.length;e++)t[e]()}function ou(){var t,e,r=new Promise((a,i)=>{t=a,e=i});return{promise:r,resolve:t,reject:e}}const Ot=2,ss=4,ii=8,lu=1<<24,or=16,Mn=32,oa=64,uu=128,gn=512,xt=1024,Dt=2048,Dn=4096,an=8192,sr=16384,ds=32768,Ea=65536,bl=1<<17,cu=1<<18,Ra=1<<19,pf=1<<20,ar=1<<25,na=65536,Zi=1<<21,wo=1<<22,kr=1<<23,Jr=Symbol("$state"),hf=Symbol("legacy props"),vf=Symbol(""),Gr=new class extends Error{constructor(){super(...arguments);Ue(this,"name","StaleReactionError");Ue(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function gf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function mf(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function yf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function bf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function _f(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function wf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function kf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function xf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Sf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Tf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ef(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Af(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Cf=1,If=2,fu=4,Pf=8,Rf=16,Of=1,Df=4,Mf=8,Lf=16,du=1,Nf=2,At=Symbol(),pu="http://www.w3.org/1999/xhtml";function qf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function jf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function hu(t){return t===this.v}function Bf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function vu(t){return!Bf(t,this.v)}let zf=!1,sn=null;function Aa(t){sn=t}function ut(t,e=!1,r){sn={p:sn,i:!1,c:null,e:null,s:t,x:null,l:null}}function ct(t){var e=sn,r=e.e;if(r!==null){e.e=null;for(var a of r)qu(a)}return e.i=!0,sn=e.p,{}}function gu(){return!0}let Hr=[];function mu(){var t=Hr;Hr=[],df(t)}function xr(t){if(Hr.length===0&&!ts){var e=Hr;queueMicrotask(()=>{e===Hr&&mu()})}Hr.push(t)}function Ff(){for(;Hr.length>0;)mu()}function yu(t){var e=nt;if(e===null)return He.f|=kr,t;if((e.f&ds)===0&&(e.f&ss)===0)throw t;Ca(t,e)}function Ca(t,e){for(;e!==null;){if((e.f&uu)!==0){if((e.f&ds)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Kf=-7169;function vt(t,e){t.f=t.f&Kf|e}function ko(t){(t.f&gn)!==0||t.deps===null?vt(t,xt):vt(t,Dn)}function bu(t){if(t!==null)for(const e of t)(e.f&Ot)===0||(e.f&na)===0||(e.f^=na,bu(e.deps))}function _u(t,e,r){(t.f&Dt)!==0?e.add(t):(t.f&Dn)!==0&&r.add(t),bu(t.deps),vt(t,xt)}const Ns=new Set;let je=null,Zs=null,Ct=null,Xt=[],oi=null,$i=!1,ts=!1;var ya,ba,Yr,_a,ls,us,Vr,er,wa,Wn,Ji,eo,wu;const Uo=class Uo{constructor(){Ge(this,Wn);Ue(this,"committed",!1);Ue(this,"current",new Map);Ue(this,"previous",new Map);Ge(this,ya,new Set);Ge(this,ba,new Set);Ge(this,Yr,0);Ge(this,_a,0);Ge(this,ls,null);Ge(this,us,new Set);Ge(this,Vr,new Set);Ge(this,er,new Map);Ue(this,"is_fork",!1);Ge(this,wa,!1)}is_deferred(){return this.is_fork||H(this,_a)>0}skip_effect(e){H(this,er).has(e)||H(this,er).set(e,{d:[],m:[]})}unskip_effect(e){var r=H(this,er).get(e);if(r){H(this,er).delete(e);for(var a of r.d)vt(a,Dt),Rn(a);for(a of r.m)vt(a,Dn),Rn(a)}}process(e){var i;Xt=[],this.apply();var r=[],a=[];for(const o of e)qt(this,Wn,Ji).call(this,o,r,a);if(this.is_deferred()){qt(this,Wn,eo).call(this,a),qt(this,Wn,eo).call(this,r);for(const[o,c]of H(this,er))Tu(o,c)}else{for(const o of H(this,ya))o();H(this,ya).clear(),H(this,Yr)===0&&qt(this,Wn,wu).call(this),Zs=this,je=null,_l(a),_l(r),Zs=null,(i=H(this,ls))==null||i.resolve()}Ct=null}capture(e,r){r!==At&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&kr)===0&&(this.current.set(e,e.v),Ct==null||Ct.set(e,e.v))}activate(){je=this,this.apply()}deactivate(){je===this&&(je=null,Ct=null)}flush(){if(this.activate(),Xt.length>0){if(ku(),je!==null&&je!==this)return}else H(this,Yr)===0&&this.process([]);this.deactivate()}discard(){for(const e of H(this,ba))e(this);H(this,ba).clear()}increment(e){ze(this,Yr,H(this,Yr)+1),e&&ze(this,_a,H(this,_a)+1)}decrement(e){ze(this,Yr,H(this,Yr)-1),e&&ze(this,_a,H(this,_a)-1),!H(this,wa)&&(ze(this,wa,!0),xr(()=>{ze(this,wa,!1),this.is_deferred()?Xt.length>0&&this.flush():this.revive()}))}revive(){for(const e of H(this,us))H(this,Vr).delete(e),vt(e,Dt),Rn(e);for(const e of H(this,Vr))vt(e,Dn),Rn(e);this.flush()}oncommit(e){H(this,ya).add(e)}ondiscard(e){H(this,ba).add(e)}settled(){return(H(this,ls)??ze(this,ls,ou())).promise}static ensure(){if(je===null){const e=je=new Uo;Ns.add(je),ts||xr(()=>{je===e&&e.flush()})}return je}apply(){}};ya=new WeakMap,ba=new WeakMap,Yr=new WeakMap,_a=new WeakMap,ls=new WeakMap,us=new WeakMap,Vr=new WeakMap,er=new WeakMap,wa=new WeakMap,Wn=new WeakSet,Ji=function(e,r,a){e.f^=xt;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(Mn|oa))!==0,v=d&&(c&xt)!==0,h=v||(c&an)!==0||H(this,er).has(i);if(!h&&i.fn!==null){d?i.f^=xt:o!==null&&(c&(ss|ii|lu))!==0?o.b.defer_effect(i):(c&ss)!==0?r.push(i):hs(i)&&((c&or)!==0&&H(this,Vr).add(i),Pa(i));var m=i.first;if(m!==null){i=m;continue}}var k=i.parent;for(i=i.next;i===null&&k!==null;)k===o&&(o=null),i=k.next,k=k.parent}},eo=function(e){for(var r=0;r<e.length;r+=1)_u(e[r],H(this,us),H(this,Vr))},wu=function(){var i;if(Ns.size>1){this.previous.clear();var e=Ct,r=!0;for(const o of Ns){if(o===this){r=!1;continue}const c=[];for(const[v,h]of this.current){if(o.current.has(v))if(r&&h!==o.current.get(v))o.current.set(v,h);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var a=Xt;Xt=[];const v=new Set,h=new Map;for(const m of c)xu(m,d,v,h);if(Xt.length>0){je=o,o.apply();for(const m of Xt)qt(i=o,Wn,Ji).call(i,m,[],[]);o.deactivate()}Xt=a}}je=null,Ct=e}this.committed=!0,Ns.delete(this)};let Sr=Uo;function Uf(t){var e=ts;ts=!0;try{for(var r;;){if(Ff(),Xt.length===0&&(je==null||je.flush(),Xt.length===0))return oi=null,r;ku()}}finally{ts=e}}function ku(){$i=!0;var t=null;try{for(var e=0;Xt.length>0;){var r=Sr.ensure();if(e++>1e3){var a,i;Gf()}r.process(Xt),Tr.clear()}}finally{Xt=[],$i=!1,oi=null}}function Gf(){try{kf()}catch(t){Ca(t,oi)}}let En=null;function _l(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var a=t[r++];if((a.f&(sr|an))===0&&hs(a)&&(En=new Set,Pa(a),a.deps===null&&a.first===null&&a.nodes===null&&a.teardown===null&&a.ac===null&&Fu(a),(En==null?void 0:En.size)>0)){Tr.clear();for(const i of En){if((i.f&(sr|an))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)En.has(c)&&(En.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(sr|an))===0&&Pa(v)}}En.clear()}}En=null}}function xu(t,e,r,a){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ot)!==0?xu(i,e,r,a):(o&(wo|or))!==0&&(o&Dt)===0&&Su(i,e,a)&&(vt(i,Dt),Rn(i))}}function Su(t,e,r){const a=r.get(t);if(a!==void 0)return a;if(t.deps!==null)for(const i of t.deps){if(Ta.call(e,i))return!0;if((i.f&Ot)!==0&&Su(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Rn(t){for(var e=oi=t;e.parent!==null;){e=e.parent;var r=e.f;if($i&&e===nt&&(r&or)!==0&&(r&cu)===0)return;if((r&(oa|Mn))!==0){if((r&xt)===0)return;e.f^=xt}}Xt.push(e)}function Tu(t,e){if(!((t.f&Mn)!==0&&(t.f&xt)!==0)){(t.f&Dt)!==0?e.d.push(t):(t.f&Dn)!==0&&e.m.push(t),vt(t,xt);for(var r=t.first;r!==null;)Tu(r,e),r=r.next}}function Hf(t){let e=0,r=ra(0),a;return()=>{To()&&(b(r),Eo(()=>(e===0&&(a=vs(()=>t(()=>ns(r)))),e+=1,()=>{xr(()=>{e-=1,e===0&&(a==null||a(),a=void 0,ns(r))})})))}}var Wf=Ea|Ra|uu;function Yf(t,e,r){new Vf(t,e,r)}var pn,bo,Fn,Qr,Kn,hn,Vt,Un,tr,_r,Xr,wr,ka,Zr,xa,Sa,nr,ri,St,Qf,Xf,to,Gs,Hs,no;class Vf{constructor(e,r,a){Ge(this,St);Ue(this,"parent");Ue(this,"is_pending",!1);Ge(this,pn);Ge(this,bo,null);Ge(this,Fn);Ge(this,Qr);Ge(this,Kn);Ge(this,hn,null);Ge(this,Vt,null);Ge(this,Un,null);Ge(this,tr,null);Ge(this,_r,null);Ge(this,Xr,0);Ge(this,wr,0);Ge(this,ka,!1);Ge(this,Zr,!1);Ge(this,xa,new Set);Ge(this,Sa,new Set);Ge(this,nr,null);Ge(this,ri,Hf(()=>(ze(this,nr,ra(H(this,Xr))),()=>{ze(this,nr,null)})));ze(this,pn,e),ze(this,Fn,r),ze(this,Qr,a),this.parent=nt.b,this.is_pending=!!H(this,Fn).pending,ze(this,Kn,Ao(()=>{nt.b=this;{var i=qt(this,St,to).call(this);try{ze(this,hn,vn(()=>a(i)))}catch(o){this.error(o)}H(this,wr)>0?qt(this,St,Hs).call(this):this.is_pending=!1}return()=>{var o;(o=H(this,_r))==null||o.remove()}},Wf))}defer_effect(e){_u(e,H(this,xa),H(this,Sa))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!H(this,Fn).pending}update_pending_count(e){qt(this,St,no).call(this,e),ze(this,Xr,H(this,Xr)+e),!(!H(this,nr)||H(this,ka))&&(ze(this,ka,!0),xr(()=>{ze(this,ka,!1),H(this,nr)&&Ia(H(this,nr),H(this,Xr))}))}get_effect_pending(){return H(this,ri).call(this),b(H(this,nr))}error(e){var r=H(this,Fn).onerror;let a=H(this,Fn).failed;if(H(this,Zr)||!r&&!a)throw e;H(this,hn)&&($t(H(this,hn)),ze(this,hn,null)),H(this,Vt)&&($t(H(this,Vt)),ze(this,Vt,null)),H(this,Un)&&($t(H(this,Un)),ze(this,Un,null));var i=!1,o=!1;const c=()=>{if(i){jf();return}i=!0,o&&Af(),Sr.ensure(),ze(this,Xr,0),H(this,Un)!==null&&ea(H(this,Un),()=>{ze(this,Un,null)}),this.is_pending=this.has_pending_snippet(),ze(this,hn,qt(this,St,Gs).call(this,()=>(ze(this,Zr,!1),vn(()=>H(this,Qr).call(this,H(this,pn)))))),H(this,wr)>0?qt(this,St,Hs).call(this):this.is_pending=!1};xr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Ca(d,H(this,Kn)&&H(this,Kn).parent)}a&&ze(this,Un,qt(this,St,Gs).call(this,()=>{Sr.ensure(),ze(this,Zr,!0);try{return vn(()=>{a(H(this,pn),()=>e,()=>c)})}catch(d){return Ca(d,H(this,Kn).parent),null}finally{ze(this,Zr,!1)}}))})}}pn=new WeakMap,bo=new WeakMap,Fn=new WeakMap,Qr=new WeakMap,Kn=new WeakMap,hn=new WeakMap,Vt=new WeakMap,Un=new WeakMap,tr=new WeakMap,_r=new WeakMap,Xr=new WeakMap,wr=new WeakMap,ka=new WeakMap,Zr=new WeakMap,xa=new WeakMap,Sa=new WeakMap,nr=new WeakMap,ri=new WeakMap,St=new WeakSet,Qf=function(){try{ze(this,hn,vn(()=>H(this,Qr).call(this,H(this,pn))))}catch(e){this.error(e)}},Xf=function(){const e=H(this,Fn).pending;e&&(ze(this,Vt,vn(()=>e(H(this,pn)))),xr(()=>{var r=qt(this,St,to).call(this);ze(this,hn,qt(this,St,Gs).call(this,()=>(Sr.ensure(),vn(()=>H(this,Qr).call(this,r))))),H(this,wr)>0?qt(this,St,Hs).call(this):(ea(H(this,Vt),()=>{ze(this,Vt,null)}),this.is_pending=!1)}))},to=function(){var e=H(this,pn);return this.is_pending&&(ze(this,_r,ir()),H(this,pn).before(H(this,_r)),e=H(this,_r)),e},Gs=function(e){var r=nt,a=He,i=sn;Hn(H(this,Kn)),bn(H(this,Kn)),Aa(H(this,Kn).ctx);try{return e()}catch(o){return yu(o),null}finally{Hn(r),bn(a),Aa(i)}},Hs=function(){const e=H(this,Fn).pending;H(this,hn)!==null&&(ze(this,tr,document.createDocumentFragment()),H(this,tr).append(H(this,_r)),Gu(H(this,hn),H(this,tr))),H(this,Vt)===null&&ze(this,Vt,vn(()=>e(H(this,pn))))},no=function(e){var r;if(!this.has_pending_snippet()){this.parent&&qt(r=this.parent,St,no).call(r,e);return}if(ze(this,wr,H(this,wr)+e),H(this,wr)===0){this.is_pending=!1;for(const a of H(this,xa))vt(a,Dt),Rn(a);for(const a of H(this,Sa))vt(a,Dn),Rn(a);H(this,xa).clear(),H(this,Sa).clear(),H(this,Vt)&&ea(H(this,Vt),()=>{ze(this,Vt,null)}),H(this,tr)&&(H(this,pn).before(H(this,tr)),ze(this,tr,null))}};function Zf(t,e,r,a){const i=li;var o=t.filter(_=>!_.settled);if(r.length===0&&o.length===0){a(e.map(i));return}var c=je,d=nt,v=$f(),h=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(_=>_.promise)):null;function m(_){v();try{a(_)}catch(x){(d.f&sr)===0&&Ca(x,d)}c==null||c.deactivate(),ro()}if(r.length===0){h.then(()=>m(e.map(i)));return}function k(){v(),Promise.all(r.map(_=>Jf(_))).then(_=>m([...e.map(i),..._])).catch(_=>Ca(_,d))}h?h.then(k):k()}function $f(){var t=nt,e=He,r=sn,a=je;return function(o=!0){Hn(t),bn(e),Aa(r),o&&(a==null||a.activate())}}function ro(){Hn(null),bn(null),Aa(null)}function li(t){var e=Ot|Dt,r=He!==null&&(He.f&Ot)!==0?He:null;return nt!==null&&(nt.f|=Ra),{ctx:sn,deps:null,effects:null,equals:hu,f:e,fn:t,reactions:null,rv:0,v:At,wv:0,parent:r??nt,ac:null}}function Jf(t,e,r){let a=nt;a===null&&mf();var i=a.b,o=void 0,c=ra(At),d=!He,v=new Map;return pd(()=>{var x;var h=ou();o=h.promise;try{Promise.resolve(t()).then(h.resolve,h.reject).then(()=>{m===je&&m.committed&&m.deactivate(),ro()})}catch(M){h.reject(M),ro()}var m=je;if(d){var k=i.is_rendered();i.update_pending_count(1),m.increment(k),(x=v.get(m))==null||x.reject(Gr),v.delete(m),v.set(m,h)}const _=(M,q=void 0)=>{if(m.activate(),q)q!==Gr&&(c.f|=kr,Ia(c,q));else{(c.f&kr)!==0&&(c.f^=kr),Ia(c,M);for(const[S,K]of v){if(v.delete(S),S===m)break;K.reject(Gr)}}d&&(i.update_pending_count(-1),m.decrement(k))};h.promise.then(_,M=>_(null,M||"unknown"))}),Nu(()=>{for(const h of v.values())h.reject(Gr)}),new Promise(h=>{function m(k){function _(){k===o?h(c):m(o)}k.then(_,_)}m(o)})}function kt(t){const e=li(t);return Hu(e),e}function Eu(t){const e=li(t);return e.equals=vu,e}function ed(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)$t(e[r])}}function td(t){for(var e=t.parent;e!==null;){if((e.f&Ot)===0)return(e.f&sr)===0?e:null;e=e.parent}return null}function xo(t){var e,r=nt;Hn(td(t));try{t.f&=~na,ed(t),e=Qu(t)}finally{Hn(r)}return e}function Au(t){var e=xo(t);if(!t.equals(e)&&(t.wv=Yu(),(!(je!=null&&je.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){vt(t,xt);return}Er||(Ct!==null?(To()||je!=null&&je.is_fork)&&Ct.set(t,e):ko(t))}function nd(t){var e,r;if(t.effects!==null)for(const a of t.effects)(a.teardown||a.ac)&&((e=a.teardown)==null||e.call(a),(r=a.ac)==null||r.abort(Gr),a.teardown=ff,a.ac=null,is(a,0),Co(a))}function Cu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Pa(e)}let ao=new Set;const Tr=new Map;let Iu=!1;function ra(t,e){var r={f:0,v:t,reactions:null,equals:hu,rv:0,wv:0};return r}function Oe(t,e){const r=ra(t);return Hu(r),r}function rd(t,e=!1,r=!0){const a=ra(t);return e||(a.equals=vu),a}function F(t,e,r=!1){He!==null&&(!On||(He.f&bl)!==0)&&gu()&&(He.f&(Ot|or|wo|bl))!==0&&(mn===null||!Ta.call(mn,t))&&Ef();let a=r?It(e):e;return Ia(t,a)}function Ia(t,e){if(!t.equals(e)){var r=t.v;Er?Tr.set(t,e):Tr.set(t,r),t.v=e;var a=Sr.ensure();if(a.capture(t,r),(t.f&Ot)!==0){const i=t;(t.f&Dt)!==0&&xo(i),ko(i)}t.wv=Yu(),Pu(t,Dt),nt!==null&&(nt.f&xt)!==0&&(nt.f&(Mn|oa))===0&&(dn===null?vd([t]):dn.push(t)),!a.is_fork&&ao.size>0&&!Iu&&ad()}return e}function ad(){Iu=!1;for(const t of ao)(t.f&xt)!==0&&vt(t,Dn),hs(t)&&Pa(t);ao.clear()}function ns(t){F(t,t.v+1)}function Pu(t,e){var r=t.reactions;if(r!==null)for(var a=r.length,i=0;i<a;i++){var o=r[i],c=o.f,d=(c&Dt)===0;if(d&&vt(o,e),(c&Ot)!==0){var v=o;Ct==null||Ct.delete(v),(c&na)===0&&(c&gn&&(o.f|=na),Pu(v,Dn))}else d&&((c&or)!==0&&En!==null&&En.add(o),Rn(o))}}function It(t){if(typeof t!="object"||t===null||Jr in t)return t;const e=iu(t);if(e!==uf&&e!==cf)return t;var r=new Map,a=_o(t),i=Oe(0),o=ta,c=d=>{if(ta===o)return d();var v=He,h=ta;bn(null),Tl(o);var m=d();return bn(v),Tl(h),m};return a&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Sf();var m=r.get(v);return m===void 0?c(()=>{var k=Oe(h.value);return r.set(v,k),k}):F(m,h.value,!0),!0},deleteProperty(d,v){var h=r.get(v);if(h===void 0){if(v in d){const m=c(()=>Oe(At));r.set(v,m),ns(i)}}else F(h,At),ns(i);return!0},get(d,v,h){var x;if(v===Jr)return t;var m=r.get(v),k=v in d;if(m===void 0&&(!k||(x=ma(d,v))!=null&&x.writable)&&(m=c(()=>{var M=It(k?d[v]:At),q=Oe(M);return q}),r.set(v,m)),m!==void 0){var _=b(m);return _===At?void 0:_}return Reflect.get(d,v,h)},getOwnPropertyDescriptor(d,v){var h=Reflect.getOwnPropertyDescriptor(d,v);if(h&&"value"in h){var m=r.get(v);m&&(h.value=b(m))}else if(h===void 0){var k=r.get(v),_=k==null?void 0:k.v;if(k!==void 0&&_!==At)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return h},has(d,v){var _;if(v===Jr)return!0;var h=r.get(v),m=h!==void 0&&h.v!==At||Reflect.has(d,v);if(h!==void 0||nt!==null&&(!m||(_=ma(d,v))!=null&&_.writable)){h===void 0&&(h=c(()=>{var x=m?It(d[v]):At,M=Oe(x);return M}),r.set(v,h));var k=b(h);if(k===At)return!1}return m},set(d,v,h,m){var J;var k=r.get(v),_=v in d;if(a&&v==="length")for(var x=h;x<k.v;x+=1){var M=r.get(x+"");M!==void 0?F(M,At):x in d&&(M=c(()=>Oe(At)),r.set(x+"",M))}if(k===void 0)(!_||(J=ma(d,v))!=null&&J.writable)&&(k=c(()=>Oe(void 0)),F(k,It(h)),r.set(v,k));else{_=k.v!==At;var q=c(()=>It(h));F(k,q)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(m,h),!_){if(a&&typeof v=="string"){var K=r.get("length"),ne=Number(v);Number.isInteger(ne)&&ne>=K.v&&F(K,ne+1)}ns(i)}return!0},ownKeys(d){b(i);var v=Reflect.ownKeys(d).filter(k=>{var _=r.get(k);return _===void 0||_.v!==At});for(var[h,m]of r)m.v!==At&&!(h in d)&&v.push(h);return v},setPrototypeOf(){Tf()}})}function wl(t){try{if(t!==null&&typeof t=="object"&&Jr in t)return t[Jr]}catch{}return t}function sd(t,e){return Object.is(wl(t),wl(e))}var kl,Ru,Ou,Du;function id(){if(kl===void 0){kl=window,Ru=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;Ou=ma(e,"firstChild").get,Du=ma(e,"nextSibling").get,yl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),yl(r)&&(r.__t=void 0)}}function ir(t=""){return document.createTextNode(t)}function nn(t){return Ou.call(t)}function ps(t){return Du.call(t)}function w(t,e){return nn(t)}function Pt(t,e=!1){{var r=nn(t);return r instanceof Comment&&r.data===""?ps(r):r}}function D(t,e=1,r=!1){let a=t;for(;e--;)a=ps(a);return a}function od(t){t.textContent=""}function Mu(){return!1}function ld(t,e,r){return document.createElementNS(pu,t,void 0)}let xl=!1;function ud(){xl||(xl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function So(t){var e=He,r=nt;bn(null),Hn(null);try{return t()}finally{bn(e),Hn(r)}}function Lu(t,e,r,a=r){t.addEventListener(e,()=>So(r));const i=t.__on_r;i?t.__on_r=()=>{i(),a(!0)}:t.__on_r=()=>a(!0),ud()}function cd(t){nt===null&&(He===null&&wf(),_f()),Er&&bf()}function fd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function lr(t,e,r){var a=nt;a!==null&&(a.f&an)!==0&&(t|=an);var i={ctx:sn,deps:null,nodes:null,f:t|Dt|gn,first:null,fn:e,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Pa(i)}catch(d){throw $t(i),d}else e!==null&&Rn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ra)===0&&(o=o.first,(t&or)!==0&&(t&Ea)!==0&&o!==null&&(o.f|=Ea)),o!==null&&(o.parent=a,a!==null&&fd(o,a),He!==null&&(He.f&Ot)!==0&&(t&oa)===0)){var c=He;(c.effects??(c.effects=[])).push(o)}return i}function To(){return He!==null&&!On}function Nu(t){const e=lr(ii,null,!1);return vt(e,xt),e.teardown=t,e}function $s(t){cd();var e=nt.f,r=!He&&(e&Mn)!==0&&(e&ds)===0;if(r){var a=sn;(a.e??(a.e=[])).push(t)}else return qu(t)}function qu(t){return lr(ss|pf,t,!1)}function dd(t){Sr.ensure();const e=lr(oa|Ra,t,!0);return(r={})=>new Promise(a=>{r.outro?ea(e,()=>{$t(e),a(void 0)}):($t(e),a(void 0))})}function ju(t){return lr(ss,t,!1)}function pd(t){return lr(wo|Ra,t,!0)}function Eo(t,e=0){return lr(ii|e,t,!0)}function ge(t,e=[],r=[],a=[]){Zf(a,e,r,i=>{lr(ii,()=>t(...i.map(b)),!0)})}function Ao(t,e=0){var r=lr(or|e,t,!0);return r}function vn(t){return lr(Mn|Ra,t,!0)}function Bu(t){var e=t.teardown;if(e!==null){const r=Er,a=He;Sl(!0),bn(null);try{e.call(null)}finally{Sl(r),bn(a)}}}function Co(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&So(()=>{i.abort(Gr)});var a=r.next;(r.f&oa)!==0?r.parent=null:$t(r,e),r=a}}function hd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Mn)===0&&$t(e),e=r}}function $t(t,e=!0){var r=!1;(e||(t.f&cu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(zu(t.nodes.start,t.nodes.end),r=!0),Co(t,e&&!r),is(t,0),vt(t,sr);var a=t.nodes&&t.nodes.t;if(a!==null)for(const o of a)o.stop();Bu(t);var i=t.parent;i!==null&&i.first!==null&&Fu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function zu(t,e){for(;t!==null;){var r=t===e?null:ps(t);t.remove(),t=r}}function Fu(t){var e=t.parent,r=t.prev,a=t.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function ea(t,e,r=!0){var a=[];Ku(t,a,!0);var i=()=>{r&&$t(t),e&&e()},o=a.length;if(o>0){var c=()=>--o||i();for(var d of a)d.out(c)}else i()}function Ku(t,e,r){if((t.f&an)===0){t.f^=an;var a=t.nodes&&t.nodes.t;if(a!==null)for(const d of a)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Ea)!==0||(i.f&Mn)!==0&&(t.f&or)!==0;Ku(i,e,c?r:!1),i=o}}}function Io(t){Uu(t,!0)}function Uu(t,e){if((t.f&an)!==0){t.f^=an,(t.f&xt)===0&&(vt(t,Dt),Rn(t));for(var r=t.first;r!==null;){var a=r.next,i=(r.f&Ea)!==0||(r.f&Mn)!==0;Uu(r,i?e:!1),r=a}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Gu(t,e){if(t.nodes)for(var r=t.nodes.start,a=t.nodes.end;r!==null;){var i=r===a?null:ps(r);e.append(r),r=i}}let Ws=!1,Er=!1;function Sl(t){Er=t}let He=null,On=!1;function bn(t){He=t}let nt=null;function Hn(t){nt=t}let mn=null;function Hu(t){He!==null&&(mn===null?mn=[t]:mn.push(t))}let Zt=null,en=0,dn=null;function vd(t){dn=t}let Wu=1,Wr=0,ta=Wr;function Tl(t){ta=t}function Yu(){return++Wu}function hs(t){var e=t.f;if((e&Dt)!==0)return!0;if(e&Ot&&(t.f&=~na),(e&Dn)!==0){for(var r=t.deps,a=r.length,i=0;i<a;i++){var o=r[i];if(hs(o)&&Au(o),o.wv>t.wv)return!0}(e&gn)!==0&&Ct===null&&vt(t,xt)}return!1}function Vu(t,e,r=!0){var a=t.reactions;if(a!==null&&!(mn!==null&&Ta.call(mn,t)))for(var i=0;i<a.length;i++){var o=a[i];(o.f&Ot)!==0?Vu(o,e,!1):e===o&&(r?vt(o,Dt):(o.f&xt)!==0&&vt(o,Dn),Rn(o))}}function Qu(t){var q;var e=Zt,r=en,a=dn,i=He,o=mn,c=sn,d=On,v=ta,h=t.f;Zt=null,en=0,dn=null,He=(h&(Mn|oa))===0?t:null,mn=null,Aa(t.ctx),On=!1,ta=++Wr,t.ac!==null&&(So(()=>{t.ac.abort(Gr)}),t.ac=null);try{t.f|=Zi;var m=t.fn,k=m();t.f|=ds;var _=t.deps,x=je==null?void 0:je.is_fork;if(Zt!==null){var M;if(x||is(t,en),_!==null&&en>0)for(_.length=en+Zt.length,M=0;M<Zt.length;M++)_[en+M]=Zt[M];else t.deps=_=Zt;if(To()&&(t.f&gn)!==0)for(M=en;M<_.length;M++)((q=_[M]).reactions??(q.reactions=[])).push(t)}else!x&&_!==null&&en<_.length&&(is(t,en),_.length=en);if(gu()&&dn!==null&&!On&&_!==null&&(t.f&(Ot|Dn|Dt))===0)for(M=0;M<dn.length;M++)Vu(dn[M],t);if(i!==null&&i!==t){if(Wr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Wr;if(e!==null)for(const S of e)S.rv=Wr;dn!==null&&(a===null?a=dn:a.push(...dn))}return(t.f&kr)!==0&&(t.f^=kr),k}catch(S){return yu(S)}finally{t.f^=Zi,Zt=e,en=r,dn=a,He=i,mn=o,Aa(c),On=d,ta=v}}function gd(t,e){let r=e.reactions;if(r!==null){var a=sf.call(r,t);if(a!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[a]=r[i],r.pop())}}if(r===null&&(e.f&Ot)!==0&&(Zt===null||!Ta.call(Zt,e))){var o=e;(o.f&gn)!==0&&(o.f^=gn,o.f&=~na),ko(o),nd(o),is(o,0)}}function is(t,e){var r=t.deps;if(r!==null)for(var a=e;a<r.length;a++)gd(t,r[a])}function Pa(t){var e=t.f;if((e&sr)===0){vt(t,xt);var r=nt,a=Ws;nt=t,Ws=!0;try{(e&(or|lu))!==0?hd(t):Co(t),Bu(t);var i=Qu(t);t.teardown=typeof i=="function"?i:null,t.wv=Wu;var o;Xi&&zf&&(t.f&Dt)!==0&&t.deps}finally{Ws=a,nt=r}}}async function Xu(){await Promise.resolve(),Uf()}function b(t){var e=t.f,r=(e&Ot)!==0;if(He!==null&&!On){var a=nt!==null&&(nt.f&sr)!==0;if(!a&&(mn===null||!Ta.call(mn,t))){var i=He.deps;if((He.f&Zi)!==0)t.rv<Wr&&(t.rv=Wr,Zt===null&&i!==null&&i[en]===t?en++:Zt===null?Zt=[t]:Zt.push(t));else{(He.deps??(He.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[He]:Ta.call(o,He)||o.push(He)}}}if(Er&&Tr.has(t))return Tr.get(t);if(r){var c=t;if(Er){var d=c.v;return((c.f&xt)===0&&c.reactions!==null||$u(c))&&(d=xo(c)),Tr.set(c,d),d}var v=(c.f&gn)===0&&!On&&He!==null&&(Ws||(He.f&gn)!==0),h=(c.f&ds)===0;hs(c)&&(v&&(c.f|=gn),Au(c)),v&&!h&&(Cu(c),Zu(c))}if(Ct!=null&&Ct.has(t))return Ct.get(t);if((t.f&kr)!==0)throw t.v;return t.v}function Zu(t){if(t.f|=gn,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ot)!==0&&(e.f&gn)===0&&(Cu(e),Zu(e))}function $u(t){if(t.v===At)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Tr.has(e)||(e.f&Ot)!==0&&$u(e))return!0;return!1}function vs(t){var e=On;try{return On=!0,t()}finally{On=e}}const md=["touchstart","touchmove"];function yd(t){return md.includes(t)}const Ju=new Set,so=new Set;function Gt(t){for(var e=0;e<t.length;e++)Ju.add(t[e]);for(var r of so)r(t)}let El=null;function Al(t){var S;var e=this,r=e.ownerDocument,a=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;El=t;var c=0,d=El===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var h=i.indexOf(e);if(h===-1)return;v<=h&&(c=v)}if(o=i[c]||t.target,o!==e){of(t,"currentTarget",{configurable:!0,get(){return o||r}});var m=He,k=nt;bn(null),Hn(null);try{for(var _,x=[];o!==null;){var M=o.assignedSlot||o.parentNode||o.host||null;try{var q=o["__"+a];q!=null&&(!o.disabled||t.target===o)&&q.call(o,t)}catch(K){_?x.push(K):_=K}if(t.cancelBubble||M===e||M===null)break;o=M}if(_){for(let K of x)queueMicrotask(()=>{throw K});throw _}}finally{t.__root=e,delete t.currentTarget,bn(m),Hn(k)}}}var ru,au;const ji=(au=(ru=globalThis==null?void 0:globalThis.window)==null?void 0:ru.trustedTypes)==null?void 0:au.createPolicy("svelte-trusted-html",{createHTML:t=>t});function bd(t){return(ji==null?void 0:ji.createHTML(t))??t}function Po(t,e=!1){var r=ld("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?bd(t):t,r.content}function aa(t,e){var r=nt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function Y(t,e){var r=(e&du)!==0,a=(e&Nf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Po(o?t:"<!>"+t,!0),r||(i=nn(i)));var c=a||Ru?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=nn(c),v=c.lastChild;aa(d,v)}else aa(c,c);return c}}function _d(t,e,r="svg"){var a=!t.startsWith("<!>"),i=(e&du)!==0,o=`<${r}>${a?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Po(o,!0),v=nn(d);if(i)for(c=document.createDocumentFragment();nn(v);)c.appendChild(nn(v));else c=nn(v)}var h=c.cloneNode(!0);if(i){var m=nn(h),k=h.lastChild;aa(m,k)}else aa(h,h);return h}}function Ro(t,e){return _d(t,e,"svg")}function io(t=""){{var e=ir(t+"");return aa(e,e),e}}function ec(){var t=document.createDocumentFragment(),e=document.createComment(""),r=ir();return t.append(e,r),aa(e,r),t}function U(t,e){t!==null&&t.before(e)}function se(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function wd(t,e){return kd(t,e)}const qs=new Map;function kd(t,{target:e,anchor:r,props:a={},events:i,context:o,intro:c=!0}){id();var d=new Set,v=k=>{for(var _=0;_<k.length;_++){var x=k[_];if(!d.has(x)){d.add(x);var M=yd(x);for(const K of[e,document]){var q=qs.get(K);q===void 0&&(q=new Map,qs.set(K,q));var S=q.get(x);S===void 0?(K.addEventListener(x,Al,{passive:M}),q.set(x,1)):q.set(x,S+1)}}}};v(si(Ju)),so.add(v);var h=void 0,m=dd(()=>{var k=r??e.appendChild(ir());return Yf(k,{pending:()=>{}},_=>{ut({});var x=sn;o&&(x.c=o),i&&(a.$$events=i),h=t(_,a)||{},ct()}),()=>{var q;for(var _ of d)for(const S of[e,document]){var x=qs.get(S),M=x.get(_);--M==0?(S.removeEventListener(_,Al),x.delete(_),x.size===0&&qs.delete(S)):x.set(_,M)}so.delete(v),k!==r&&((q=k.parentNode)==null||q.removeChild(k))}});return xd.set(h,m),h}let xd=new WeakMap;var Cn,Gn,tn,$r,cs,fs,ai;class Sd{constructor(e,r=!0){Ue(this,"anchor");Ge(this,Cn,new Map);Ge(this,Gn,new Map);Ge(this,tn,new Map);Ge(this,$r,new Set);Ge(this,cs,!0);Ge(this,fs,()=>{var e=je;if(H(this,Cn).has(e)){var r=H(this,Cn).get(e),a=H(this,Gn).get(r);if(a)Io(a),H(this,$r).delete(r);else{var i=H(this,tn).get(r);i&&(H(this,Gn).set(r,i.effect),H(this,tn).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[o,c]of H(this,Cn)){if(H(this,Cn).delete(o),o===e)break;const d=H(this,tn).get(c);d&&($t(d.effect),H(this,tn).delete(c))}for(const[o,c]of H(this,Gn)){if(o===r||H(this,$r).has(o))continue;const d=()=>{if(Array.from(H(this,Cn).values()).includes(o)){var h=document.createDocumentFragment();Gu(c,h),h.append(ir()),H(this,tn).set(o,{effect:c,fragment:h})}else $t(c);H(this,$r).delete(o),H(this,Gn).delete(o)};H(this,cs)||!a?(H(this,$r).add(o),ea(c,d,!1)):d()}}});Ge(this,ai,e=>{H(this,Cn).delete(e);const r=Array.from(H(this,Cn).values());for(const[a,i]of H(this,tn))r.includes(a)||($t(i.effect),H(this,tn).delete(a))});this.anchor=e,ze(this,cs,r)}ensure(e,r){var a=je,i=Mu();if(r&&!H(this,Gn).has(e)&&!H(this,tn).has(e))if(i){var o=document.createDocumentFragment(),c=ir();o.append(c),H(this,tn).set(e,{effect:vn(()=>r(c)),fragment:o})}else H(this,Gn).set(e,vn(()=>r(this.anchor)));if(H(this,Cn).set(a,e),i){for(const[d,v]of H(this,Gn))d===e?a.unskip_effect(v):a.skip_effect(v);for(const[d,v]of H(this,tn))d===e?a.unskip_effect(v.effect):a.skip_effect(v.effect);a.oncommit(H(this,fs)),a.ondiscard(H(this,ai))}else H(this,fs).call(this)}}Cn=new WeakMap,Gn=new WeakMap,tn=new WeakMap,$r=new WeakMap,cs=new WeakMap,fs=new WeakMap,ai=new WeakMap;function Se(t,e,r=!1){var a=new Sd(t),i=r?Ea:0;function o(c,d){a.ensure(c,d)}Ao(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function Ar(t,e){return e}function Td(t,e,r){for(var a=[],i=e.length,o,c=e.length,d=0;d<i;d++){let k=e[d];ea(k,()=>{if(o){if(o.pending.delete(k),o.done.add(k),o.pending.size===0){var _=t.outrogroups;oo(si(o.done)),_.delete(o),_.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=a.length===0&&r!==null;if(v){var h=r,m=h.parentNode;od(m),m.append(h),t.items.clear()}oo(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function oo(t,e=!0){for(var r=0;r<t.length;r++)$t(t[r],e)}var Cl;function on(t,e,r,a,i,o=null){var c=t,d=new Map,v=(e&fu)!==0;if(v){var h=t;c=h.appendChild(ir())}var m=null,k=Eu(()=>{var K=r();return _o(K)?K:K==null?[]:si(K)}),_,x=!0;function M(){S.fallback=m,Ed(S,_,c,e,a),m!==null&&(_.length===0?(m.f&ar)===0?Io(m):(m.f^=ar,Ja(m,null,c)):ea(m,()=>{m=null}))}var q=Ao(()=>{_=b(k);for(var K=_.length,ne=new Set,J=je,G=Mu(),ee=0;ee<K;ee+=1){var oe=_[ee],Q=a(oe,ee),pe=x?null:d.get(Q);pe?(pe.v&&Ia(pe.v,oe),pe.i&&Ia(pe.i,ee),G&&J.unskip_effect(pe.e)):(pe=Ad(d,x?c:Cl??(Cl=ir()),oe,Q,ee,i,e,r),x||(pe.e.f|=ar),d.set(Q,pe)),ne.add(Q)}if(K===0&&o&&!m&&(x?m=vn(()=>o(c)):(m=vn(()=>o(Cl??(Cl=ir()))),m.f|=ar)),K>ne.size&&yf(),!x)if(G){for(const[ke,de]of d)ne.has(ke)||J.skip_effect(de.e);J.oncommit(M),J.ondiscard(()=>{})}else M();b(k)}),S={effect:q,items:d,outrogroups:null,fallback:m};x=!1}function Ha(t){for(;t!==null&&(t.f&Mn)===0;)t=t.next;return t}function Ed(t,e,r,a,i){var de,ve,re,X,he,Z,ae,ce,W;var o=(a&Pf)!==0,c=e.length,d=t.items,v=Ha(t.effect.first),h,m=null,k,_=[],x=[],M,q,S,K;if(o)for(K=0;K<c;K+=1)M=e[K],q=i(M,K),S=d.get(q).e,(S.f&ar)===0&&((ve=(de=S.nodes)==null?void 0:de.a)==null||ve.measure(),(k??(k=new Set)).add(S));for(K=0;K<c;K+=1){if(M=e[K],q=i(M,K),S=d.get(q).e,t.outrogroups!==null)for(const te of t.outrogroups)te.pending.delete(S),te.done.delete(S);if((S.f&ar)!==0)if(S.f^=ar,S===v)Ja(S,null,r);else{var ne=m?m.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),yr(t,m,S),yr(t,S,ne),Ja(S,ne,r),m=S,_=[],x=[],v=Ha(m.next);continue}if((S.f&an)!==0&&(Io(S),o&&((X=(re=S.nodes)==null?void 0:re.a)==null||X.unfix(),(k??(k=new Set)).delete(S))),S!==v){if(h!==void 0&&h.has(S)){if(_.length<x.length){var J=x[0],G;m=J.prev;var ee=_[0],oe=_[_.length-1];for(G=0;G<_.length;G+=1)Ja(_[G],J,r);for(G=0;G<x.length;G+=1)h.delete(x[G]);yr(t,ee.prev,oe.next),yr(t,m,ee),yr(t,oe,J),v=J,m=oe,K-=1,_=[],x=[]}else h.delete(S),Ja(S,v,r),yr(t,S.prev,S.next),yr(t,S,m===null?t.effect.first:m.next),yr(t,m,S),m=S;continue}for(_=[],x=[];v!==null&&v!==S;)(h??(h=new Set)).add(v),x.push(v),v=Ha(v.next);if(v===null)continue}(S.f&ar)===0&&_.push(S),m=S,v=Ha(S.next)}if(t.outrogroups!==null){for(const te of t.outrogroups)te.pending.size===0&&(oo(si(te.done)),(he=t.outrogroups)==null||he.delete(te));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||h!==void 0){var Q=[];if(h!==void 0)for(S of h)(S.f&an)===0&&Q.push(S);for(;v!==null;)(v.f&an)===0&&v!==t.fallback&&Q.push(v),v=Ha(v.next);var pe=Q.length;if(pe>0){var ke=(a&fu)!==0&&c===0?r:null;if(o){for(K=0;K<pe;K+=1)(ae=(Z=Q[K].nodes)==null?void 0:Z.a)==null||ae.measure();for(K=0;K<pe;K+=1)(W=(ce=Q[K].nodes)==null?void 0:ce.a)==null||W.fix()}Td(t,Q,ke)}}o&&xr(()=>{var te,z;if(k!==void 0)for(S of k)(z=(te=S.nodes)==null?void 0:te.a)==null||z.apply()})}function Ad(t,e,r,a,i,o,c,d){var v=(c&Cf)!==0?(c&Rf)===0?rd(r,!1,!1):ra(r):null,h=(c&If)!==0?ra(i):null;return{v,i:h,e:vn(()=>(o(e,v??r,h??i,d),()=>{t.delete(a)}))}}function Ja(t,e,r){if(t.nodes)for(var a=t.nodes.start,i=t.nodes.end,o=e&&(e.f&ar)===0?e.nodes.start:r;a!==null;){var c=ps(a);if(o.before(a),a===i)return;a=c}}function yr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Cd(t,e,r=!1,a=!1,i=!1){var o=t,c="";ge(()=>{var d=nt;if(c!==(c=e()??"")&&(d.nodes!==null&&(zu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var h=Po(v);if((r||a)&&(h=nn(h)),aa(nn(h),h.lastChild),r||a)for(;nn(h);)o.before(nn(h));else o.before(h)}})}const Il=[...` 	
\r\fÂ \v\uFEFF`];function Id(t,e,r){var a=t==null?"":""+t;if(e&&(a=a?a+" "+e:e),r){for(var i in r)if(r[i])a=a?a+" "+i:i;else if(a.length)for(var o=i.length,c=0;(c=a.indexOf(i,c))>=0;){var d=c+o;(c===0||Il.includes(a[c-1]))&&(d===a.length||Il.includes(a[d]))?a=(c===0?"":a.substring(0,c))+a.substring(d+1):c=d}}return a===""?null:a}function Pl(t,e=!1){var r=e?" !important;":";",a="";for(var i in t){var o=t[i];o!=null&&o!==""&&(a+=" "+i+": "+o+r)}return a}function Bi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Pd(t,e){if(e){var r="",a,i;if(Array.isArray(e)?(a=e[0],i=e[1]):a=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];a&&v.push(...Object.keys(a).map(Bi)),i&&v.push(...Object.keys(i).map(Bi));var h=0,m=-1;const q=t.length;for(var k=0;k<q;k++){var _=t[k];if(d?_==="/"&&t[k-1]==="*"&&(d=!1):o?o===_&&(o=!1):_==="/"&&t[k+1]==="*"?d=!0:_==='"'||_==="'"?o=_:_==="("?c++:_===")"&&c--,!d&&o===!1&&c===0){if(_===":"&&m===-1)m=k;else if(_===";"||k===q-1){if(m!==-1){var x=Bi(t.substring(h,m).trim());if(!v.includes(x)){_!==";"&&k++;var M=t.substring(h,k).trim();r+=" "+M+";"}}h=k+1,m=-1}}}}return a&&(r+=Pl(a)),i&&(r+=Pl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function rn(t,e,r,a,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Id(r,a,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var h=!!o[v];(i==null||h!==!!i[v])&&t.classList.toggle(v,h)}return o}function zi(t,e={},r,a){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,a))}}function yn(t,e,r,a){var i=t.__style;if(i!==e){var o=Pd(e,a);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else a&&(Array.isArray(a)?(zi(t,r==null?void 0:r[0],a[0]),zi(t,r==null?void 0:r[1],a[1],"important")):zi(t,r,a));return a}function tc(t,e,r=!1){if(t.multiple){if(e==null)return;if(!_o(e))return qf();for(var a of t.options)a.selected=e.includes(rs(a));return}for(a of t.options){var i=rs(a);if(sd(i,e)){a.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Rd(t){var e=new MutationObserver(()=>{tc(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Nu(()=>{e.disconnect()})}function Oo(t,e,r=e){var a=new WeakSet,i=!0;Lu(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),rs);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&rs(v)}r(d),je!==null&&a.add(je)}),ju(()=>{var o=e();if(t===document.activeElement){var c=Zs??je;if(a.has(c))return}if(tc(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=rs(d),r(o))}t.__value=o,i=!1}),Rd(t)}function rs(t){return"__value"in t?t.__value:t.value}const Od=Symbol("is custom element"),Dd=Symbol("is html");function nc(t,e,r,a){var i=Md(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[vf]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Ld(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Md(t){return t.__attributes??(t.__attributes={[Od]:t.nodeName.includes("-"),[Dd]:t.namespaceURI===pu})}var Rl=new Map;function Ld(t){var e=t.getAttribute("is")||t.nodeName,r=Rl.get(e);if(r)return r;Rl.set(e,r=[]);for(var a,i=t,o=Element.prototype;o!==i;){a=lf(i);for(var c in a)a[c].set&&r.push(c);i=iu(i)}return r}function ui(t,e,r=e){var a=new WeakSet;Lu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Fi(t)?Ki(o):o,r(o),je!==null&&a.add(je),await Xu(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var h=t.value.length;c===d&&d===v&&h>v?(t.selectionStart=h,t.selectionEnd=h):(t.selectionStart=c,t.selectionEnd=Math.min(d,h))}}}),vs(e)==null&&t.value&&(r(Fi(t)?Ki(t.value):t.value),je!==null&&a.add(je)),Eo(()=>{var i=e();if(t===document.activeElement){var o=Zs??je;if(a.has(o))return}Fi(t)&&i===Ki(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Fi(t){var e=t.type;return e==="number"||e==="range"}function Ki(t){return t===""?null:+t}function Ol(t,e){return t===e||(t==null?void 0:t[Jr])===e}function rc(t={},e,r,a){return ju(()=>{var i,o;return Eo(()=>{i=o,o=[],vs(()=>{t!==r(...o)&&(e(t,...o),i&&Ol(r(...i),t)&&e(null,...i))})}),()=>{xr(()=>{o&&Ol(r(...o),t)&&e(null,...o)})}}),t}let js=!1;function Nd(t){var e=js;try{return js=!1,[t(),js]}finally{js=e}}function Me(t,e,r,a){var ne;var i=(r&Mf)!==0,o=(r&Lf)!==0,c=a,d=!0,v=()=>(d&&(d=!1,c=o?vs(a):a),c),h;if(i){var m=Jr in t||hf in t;h=((ne=ma(t,e))==null?void 0:ne.set)??(m&&e in t?J=>t[e]=J:void 0)}var k,_=!1;i?[k,_]=Nd(()=>t[e]):k=t[e],k===void 0&&a!==void 0&&(k=v(),h&&(xf(),h(k)));var x;if(x=()=>{var J=t[e];return J===void 0?v():(d=!0,J)},(r&Df)===0)return x;if(h){var M=t.$$legacy;return(function(J,G){return arguments.length>0?((!G||M||_)&&h(G?x():J),J):x()})}var q=!1,S=((r&Of)!==0?li:Eu)(()=>(q=!1,x()));i&&b(S);var K=nt;return(function(J,G){if(arguments.length>0){const ee=G?b(S):i?It(J):J;return F(S,ee),q=!0,c!==void 0&&(c=ee),J}return Er&&q||(K.f&sr)!==0?S.v:b(S)})}function Mt(t){sn===null&&gf(),$s(()=>{const e=vs(t);if(typeof e=="function")return e})}const qd="5";var su;typeof window<"u"&&((su=window.__svelte??(window.__svelte={})).v??(su.v=new Set)).add(qd);const os=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Qt=null,rr="idle",Ys=null,Kr=new Set;function Bs(){return Qt||(Qt=new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),Qt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(rr="loading"),e.status==="ready"&&(rr="ready"),e.status==="start"&&(rr="generating"),(e.status==="complete"||e.status==="error")&&(rr=Ys?"ready":"idle");for(const r of Kr)try{r(e)}catch{}})),Qt}function ac(){return{check(){Bs().postMessage({type:"check"})},loadModel(t){Ys=t,rr="loading",Bs().postMessage({type:"load",modelId:t})},generate(t){Bs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let a="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":a+=c.output;break;case"complete":o(),e(a);break;case"error":o(),r(new Error(c.data));break}},o=()=>{Kr.delete(i)};Kr.add(i),Bs().postMessage({type:"generate",data:t})})},interrupt(){Qt==null||Qt.postMessage({type:"interrupt"})},reset(){Qt==null||Qt.postMessage({type:"reset"})},onMessage(t){return Kr.add(t),()=>Kr.delete(t)},offMessage(t){Kr.delete(t)},get status(){return rr},get isReady(){return rr==="ready"},get isGenerating(){return rr==="generating"},get modelId(){return Ys},terminate(){Qt==null||Qt.terminate(),Qt=null,rr="idle",Ys=null,Kr.clear()}}}var jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Vs={exports:{}},zd=Vs.exports,Dl;function Fd(){return Dl||(Dl=1,(function(t,e){((r,a)=>{t.exports=a()})(zd,function(){var r=function(n,s){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,s)},a=function(){return(a=Object.assign||function(n){for(var s,l=1,u=arguments.length;l<u;l++)for(var f in s=arguments[l])Object.prototype.hasOwnProperty.call(s,f)&&(n[f]=s[f]);return n}).apply(this,arguments)};function i(n,s,l){for(var u,f=0,p=s.length;f<p;f++)!u&&f in s||((u=u||Array.prototype.slice.call(s,0,f))[f]=s[f]);return n.concat(u||Array.prototype.slice.call(s))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:jd,c=Object.keys,d=Array.isArray;function v(n,s){return typeof s=="object"&&c(s).forEach(function(l){n[l]=s[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var h=Object.getPrototypeOf,m={}.hasOwnProperty;function k(n,s){return m.call(n,s)}function _(n,s){typeof s=="function"&&(s=s(h(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(s).forEach(function(l){M(n,l,s[l])})}var x=Object.defineProperty;function M(n,s,l,u){x(n,s,v(l&&k(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function q(n){return{from:function(s){return n.prototype=Object.create(s.prototype),M(n.prototype,"constructor",n),{extend:_.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,K=[].slice;function ne(n,s,l){return K.call(n,s,l)}function J(n,s){return s(n)}function G(n){if(!n)throw new Error("Assertion Failed")}function ee(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function oe(n,s){if(typeof s=="string"&&k(n,s))return n[s];if(!s)return n;if(typeof s!="string"){for(var l=[],u=0,f=s.length;u<f;++u){var p=oe(n,s[u]);l.push(p)}return l}var g,y=s.indexOf(".");return y===-1||(g=n[s.substr(0,y)])==null?void 0:oe(g,s.substr(y+1))}function Q(n,s,l){if(n&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof s!="string"&&"length"in s){G(typeof l!="string"&&"length"in l);for(var u=0,f=s.length;u<f;++u)Q(n,s[u],l[u])}else{var p,g,y=s.indexOf(".");y!==-1?(p=s.substr(0,y),(y=s.substr(y+1))===""?l===void 0?d(n)&&!isNaN(parseInt(p))?n.splice(p,1):delete n[p]:n[p]=l:Q(g=(g=n[p])&&k(n,p)?g:n[p]={},y,l)):l===void 0?d(n)&&!isNaN(parseInt(s))?n.splice(s,1):delete n[s]:n[s]=l}}function pe(n){var s,l={};for(s in n)k(n,s)&&(l[s]=n[s]);return l}var ke=[].concat;function de(n){return ke.apply([],n)}var _e="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(de([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(s){return s+n+"Array"})}))).filter(function(n){return o[n]}),ve=new Set(_e.map(function(n){return o[n]})),re=null;function X(n){return re=new WeakMap,n=(function s(l){if(!l||typeof l!="object")return l;var u=re.get(l);if(u)return u;if(d(l)){u=[],re.set(l,u);for(var f=0,p=l.length;f<p;++f)u.push(s(l[f]))}else if(ve.has(l.constructor))u=l;else{var g,y=h(l);for(g in u=y===Object.prototype?{}:Object.create(y),re.set(l,u),l)k(l,g)&&(u[g]=s(l[g]))}return u})(n),re=null,n}var he={}.toString;function Z(n){return he.call(n).slice(8,-1)}var ae=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ce=typeof ae=="symbol"?function(n){var s;return n!=null&&(s=n[ae])&&s.apply(n)}:function(){return null};function W(n,s){s=n.indexOf(s),0<=s&&n.splice(s,1)}var te={};function z(n){var s,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===te&&typeof n=="string")return[n];if(f=ce(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(s=n.length)!="number")return[n];for(l=new Array(s);s--;)l[s]=n[s]}}else for(s=arguments.length,l=new Array(s);s--;)l[s]=arguments[s];return l}var $=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},_e=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],gt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(_e),Ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Le(n,s){this.name=n,this.message=s}function Ae(n,s){return n+". Errors: "+Object.keys(s).map(function(l){return s[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function Xe(n,s,l,u){this.failures=s,this.failedKeys=u,this.successCount=l,this.message=Ae(n,s)}function De(n,s){this.name="BulkError",this.failures=Object.keys(s).map(function(l){return s[l]}),this.failuresByPos=s,this.message=Ae(n,this.failures)}q(Le).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(Xe).from(Le),q(De).from(Le);var We=gt.reduce(function(n,s){return n[s]=s+"Error",n},{}),tt=Le,xe=gt.reduce(function(n,s){var l=s+"Error";function u(f,p){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(p?`
 `+p:""),this.inner=p||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=Ee[s]||l,this.inner=null)}return q(u).from(tt),n[s]=u,n},{}),yt=(xe.Syntax=SyntaxError,xe.Type=TypeError,xe.Range=RangeError,_e.reduce(function(n,s){return n[s+"Error"]=xe[s],n},{}));_e=gt.reduce(function(n,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(n[s+"Error"]=xe[s]),n},{});function Ke(){}function Bt(n){return n}function Yn(n,s){return n==null||n===Bt?s:function(l){return s(n(l))}}function Tt(n,s){return function(){n.apply(this,arguments),s.apply(this,arguments)}}function Cr(n,s){return n===Ke?s:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Tt(u,this.onsuccess):u),f&&(this.onerror=this.onerror?Tt(f,this.onerror):f),p!==void 0?p:l}}function Ir(n,s){return n===Ke?s:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?Tt(l,this.onsuccess):l),u&&(this.onerror=this.onerror?Tt(u,this.onerror):u)}}function Ln(n,s){return n===Ke?s:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),p=this.onerror,g=(this.onsuccess=null,this.onerror=null,s.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?Tt(f,this.onsuccess):f),p&&(this.onerror=this.onerror?Tt(p,this.onerror):p),u===void 0?g===void 0?void 0:g:v(u,g)}}function Ht(n,s){return n===Ke?s:function(){return s.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function Wt(n,s){return n===Ke?s:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,p=new Array(f);f--;)p[f]=arguments[f];return l.then(function(){return s.apply(u,p)})}return s.apply(this,arguments)}}_e.ModifyError=Xe,_e.DexieError=Le,_e.BulkError=De;var Et=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Oa(n){Et=n}var Pr={},ua=100,wn=typeof Promise>"u"?[]:(gt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[wn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),h(wn),gt]:[gt,h(gt),gt]),gt=wn[0],va=wn[1],va=va&&va.then,bt=gt&&gt.constructor,Rr=!!wn[2],ur=function(n,s){Qn.push([n,s]),cr&&(queueMicrotask(pr),cr=!1)},ca=!0,cr=!0,Nn=[],Vn=[],fr=Bt,_t={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ke,pgp:!1,env:{},finalize:Ke},Pe=_t,Qn=[],kn=0,fa=[];function we(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Pe;if(typeof n!="function"){if(n!==Pr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xn(this,this._value)}else this._state=null,this._value=null,++s.ref,(function l(u,f){try{f(function(p){if(u._state===null){if(p===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&hr();p&&typeof p.then=="function"?l(u,function(y,C){p instanceof we?p._then(y,C):p.then(y,C)}):(u._state=!0,u._value=p,ys(u)),g&&Zn()}},Xn.bind(null,u))}catch(p){Xn(u,p)}})(this,n)}var dr={get:function(){var n=Pe,s=Lr;function l(u,f){var p=this,g=!n.global&&(n!==Pe||s!==Lr),y=g&&!Sn(),C=new we(function(N,I){Da(p,new ms(E(u,n,g,y),E(f,n,g,y),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return l.prototype=Pr,l},set:function(n){M(this,"then",n&&n.prototype===Pr?dr:{get:function(){return n},set:dr.set})}};function ms(n,s,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof s=="function"?s:null,this.resolve=l,this.reject=u,this.psd=f}function Xn(n,s){var l,u;Vn.push(s),n._state===null&&(l=n._lib&&hr(),s=fr(s),n._state=!1,n._value=s,u=n,Nn.some(function(f){return f._value===u._value})||Nn.push(u),ys(n),l)&&Zn()}function ys(n){var s=n._listeners;n._listeners=[];for(var l=0,u=s.length;l<u;++l)Da(n,s[l]);var f=n._PSD;--f.ref||f.finalize(),kn===0&&(++kn,ur(function(){--kn==0&&Or()},[]))}function Da(n,s){if(n._state===null)n._listeners.push(s);else{var l=n._state?s.onFulfilled:s.onRejected;if(l===null)return(n._state?s.resolve:s.reject)(n._value);++s.psd.ref,++kn,ur(dt,[l,n,s])}}function dt(n,s,l){try{var u,f=s._value;!s._state&&Vn.length&&(Vn=[]),u=Et&&s._consoleTask?s._consoleTask.run(function(){return n(f)}):n(f),s._state||Vn.indexOf(f)!==-1||(p=>{for(var g=Nn.length;g;)if(Nn[--g]._value===p._value)return Nn.splice(g,1)})(s),l.resolve(u)}catch(p){l.reject(p)}finally{--kn==0&&Or(),--l.psd.ref||l.psd.finalize()}}function pr(){Re(_t,function(){hr()&&Zn()})}function hr(){var n=ca;return cr=ca=!1,n}function Zn(){var n,s,l;do for(;0<Qn.length;)for(n=Qn,Qn=[],l=n.length,s=0;s<l;++s){var u=n[s];u[0].apply(null,u[1])}while(0<Qn.length);cr=ca=!0}function Or(){for(var n=Nn,s=(Nn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),fa.slice(0)),l=s.length;l;)s[--l]()}function Dr(n){return new we(Pr,!1,n)}function rt(n,s){var l=Pe;return function(){var u=hr(),f=Pe;try{return Tn(l,!0),n.apply(this,arguments)}catch(p){s&&s(p)}finally{Tn(f,!1),u&&Zn()}}}_(we.prototype,{then:dr,_then:function(n,s){Da(this,new ms(null,null,n,s,Pe))},catch:function(n){var s,l;return arguments.length===1?this.then(null,n):(s=n,l=arguments[1],typeof s=="function"?this.then(null,function(u){return(u instanceof s?l:Dr)(u)}):this.then(null,function(u){return(u&&u.name===s?l:Dr)(u)}))},finally:function(n){return this.then(function(s){return we.resolve(n()).then(function(){return s})},function(s){return we.resolve(n()).then(function(){return Dr(s)})})},timeout:function(n,s){var l=this;return n<1/0?new we(function(u,f){var p=setTimeout(function(){return f(new xe.Timeout(s))},n);l.then(u,f).finally(clearTimeout.bind(null,p))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(we.prototype,Symbol.toStringTag,"Dexie.Promise"),_t.env=_s(),_(we,{all:function(){var n=z.apply(null,arguments).map(Nr);return new we(function(s,l){n.length===0&&s([]);var u=n.length;n.forEach(function(f,p){return we.resolve(f).then(function(g){n[p]=g,--u||s(n)},l)})})},resolve:function(n){return n instanceof we?n:n&&typeof n.then=="function"?new we(function(s,l){n.then(s,l)}):new we(Pr,!0,n)},reject:Dr,race:function(){var n=z.apply(null,arguments).map(Nr);return new we(function(s,l){n.map(function(u){return we.resolve(u).then(s,l)})})},PSD:{get:function(){return Pe},set:function(n){return Pe=n}},totalEchoes:{get:function(){return Lr}},newPSD:xn,usePSD:Re,scheduler:{get:function(){return ur},set:function(n){ur=n}},rejectionMapper:{get:function(){return fr},set:function(n){fr=n}},follow:function(n,s){return new we(function(l,u){return xn(function(f,p){var g=Pe;g.unhandleds=[],g.onunhandled=p,g.finalize=Tt(function(){var y,C=this;y=function(){C.unhandleds.length===0?f():p(C.unhandleds[0])},fa.push(function N(){y(),fa.splice(fa.indexOf(N),1)}),++kn,ur(function(){--kn==0&&Or()},[])},g.finalize),n()},s,l,u)})}}),bt&&(bt.allSettled&&M(we,"allSettled",function(){var n=z.apply(null,arguments).map(Nr);return new we(function(s){n.length===0&&s([]);var l=n.length,u=new Array(l);n.forEach(function(f,p){return we.resolve(f).then(function(g){return u[p]={status:"fulfilled",value:g}},function(g){return u[p]={status:"rejected",reason:g}}).then(function(){return--l||s(u)})})})}),bt.any&&typeof AggregateError<"u"&&M(we,"any",function(){var n=z.apply(null,arguments).map(Nr);return new we(function(s,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(p,g){return we.resolve(p).then(function(y){return s(y)},function(y){f[g]=y,--u||l(new AggregateError(f))})})})}),bt.withResolvers)&&(we.withResolvers=bt.withResolvers);var mt={awaits:0,echoes:0,id:0},un=0,cn=[],Mr=0,Lr=0,Ma=0;function xn(n,g,l,u){var f=Pe,p=Object.create(f),g=(p.parent=f,p.ref=0,p.global=!1,p.id=++Ma,_t.env,p.env=Rr?{Promise:we,PromiseProp:{value:we,configurable:!0,writable:!0},all:we.all,race:we.race,allSettled:we.allSettled,any:we.any,resolve:we.resolve,reject:we.reject}:{},g&&v(p,g),++f.ref,p.finalize=function(){--this.parent.ref||this.parent.finalize()},Re(p,n,l,u));return p.ref===0&&p.finalize(),g}function Lt(){return mt.id||(mt.id=++un),++mt.awaits,mt.echoes+=ua,mt.id}function Sn(){return!!mt.awaits&&(--mt.awaits==0&&(mt.id=0),mt.echoes=mt.awaits*ua,!0)}function Nr(n){return mt.echoes&&n&&n.constructor===bt?(Lt(),n.then(function(s){return Sn(),s},function(s){return Sn(),me(s)})):n}function bs(){var n=cn[cn.length-1];cn.pop(),Tn(n,!1)}function Tn(n,s){var l,u,f=Pe;(s?!mt.echoes||Mr++&&n===Pe:!Mr||--Mr&&n===Pe)||queueMicrotask(s?(function(p){++Lr,mt.echoes&&--mt.echoes!=0||(mt.echoes=mt.awaits=mt.id=0),cn.push(Pe),Tn(p,!0)}).bind(null,n):bs),n!==Pe&&(Pe=n,f===_t&&(_t.env=_s()),Rr)&&(l=_t.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function _s(){var n=o.Promise;return Rr?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Re(n,s,l,u,f){var p=Pe;try{return Tn(n,!0),s(l,u,f)}finally{Tn(p,!1)}}function E(n,s,l,u){return typeof n!="function"?n:function(){var f=Pe;l&&Lt(),Tn(s,!0);try{return n.apply(this,arguments)}finally{Tn(f,!1),u&&queueMicrotask(Sn)}}}function ue(n){Promise===bt&&mt.echoes===0?Mr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+va).indexOf("[native code]")===-1&&(Lt=Sn=Ke);var me=we.reject,Ze="ï¿¿",at="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ot="String expected.",pt=[],Yt="__dbnames",qn="readonly",qr="readwrite";function it(n,s){return n?s?function(){return n.apply(this,arguments)&&s.apply(this,arguments)}:n:s}var La={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function jr(n){return typeof n!="string"||/\./.test(n)?function(s){return s}:function(s){return s[n]===void 0&&n in s&&delete(s=X(s))[n],s}}function Go(){throw xe.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ye(n,s){try{var l=Ho(n),u=Ho(s);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return s<n?1:n<s?-1:0;case"binary":for(var f=Wo(n),p=Wo(s),g=f.length,y=p.length,C=g<y?g:y,N=0;N<C;++N)if(f[N]!==p[N])return f[N]<p[N]?-1:1;return g===y?0:g<y?-1:1;case"Array":for(var I=n,T=s,R=I.length,O=T.length,P=R<O?R:O,A=0;A<P;++A){var j=Ye(I[A],T[A]);if(j!==0)return j}return R===O?0:R<O?-1:1}}catch{}return NaN}function Ho(n){var s=typeof n;return s=="object"&&(ArrayBuffer.isView(n)||(s=Z(n))==="ArrayBuffer")?"binary":s}function Wo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ws(n,s,l){var u=n.schema.yProps;return u?(s&&0<l.numFailures&&(s=s.filter(function(f,p){return!l.failures[p]})),Promise.all(u.map(function(f){return f=f.updatesTable,s?n.db.table(f).where("k").anyOf(s).delete():n.db.table(f).clear()})).then(function(){return l})):l}Yo.prototype.execute=function(n){var s=this["@@propmod"];if(s.add!==void 0){var l=s.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(s.remove!==void 0){var u=s.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=s.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?s.replacePrefix[1]+n.substring(l.length):n};var Na=Yo;function Yo(n){this["@@propmod"]=n}function Vo(n,s){for(var l=c(s),u=l.length,f=!1,p=0;p<u;++p){var g=l[p],y=s[g],C=oe(n,g);y instanceof Na?(Q(n,g,y.execute(C)),f=!0):C!==y&&(Q(n,g,y),f=!0)}return f}st.prototype._trans=function(n,s,l){var u=this._tx||Pe.trans,f=this.name,p=Et&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,T){if(T.schema[f])return s(T.idbtrans,T);throw new xe.NotFound("Table "+f+" not part of transaction")}var y=hr();try{var C=u&&u.db._novip===this.db._novip?u===Pe.trans?u._promise(n,g,l):xn(function(){return u._promise(n,g,l)},{trans:u,transless:Pe.transless||Pe}):(function N(I,T,R,O){if(I.idbdb&&(I._state.openComplete||Pe.letThrough||I._vip)){var P=I._createTransaction(T,R,I._dbSchema);try{P.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===We.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,T,R,O)})):me(A)}return P._promise(T,function(A,j){return xn(function(){return Pe.trans=P,O(A,j,P)})}).then(function(A){if(T==="readwrite")try{P.idbtrans.commit()}catch{}return T==="readonly"?A:P._completion.then(function(){return A})})}if(I._state.openComplete)return me(new xe.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return me(new xe.DatabaseClosed);I.open().catch(Ke)}return I._state.dbReadyPromise.then(function(){return N(I,T,R,O)})})(this.db,n,[this.name],g);return p&&(C._consoleTask=p,C=C.catch(function(N){return console.trace(N),me(N)})),C}finally{y&&Zn()}},st.prototype.get=function(n,s){var l=this;return n&&n.constructor===Object?this.where(n).first(s):n==null?me(new xe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(s)},st.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var s=c(n);if(s.length===1)return this.where(s[0]).equals(n[s[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&s.every(function(N){return 0<=y.keyPath.indexOf(N)})){for(var C=0;C<s.length;++C)if(s.indexOf(y.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(y,C){return y.keyPath.length-C.keyPath.length})[0];if(l&&this.db._maxKey!==Ze)return g=l.keyPath.slice(0,s.length),this.where(g).equals(g.map(function(y){return n[y]}));!l&&Et&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var u=this.schema.idxByName;function f(y,C){return Ye(y,C)===0}var g=s.reduce(function(I,C){var N=I[0],I=I[1],T=u[C],R=n[C];return[N||T,N||!T?it(I,T&&T.multi?function(O){return O=oe(O,C),d(O)&&O.some(function(P){return f(R,P)})}:function(O){return f(R,oe(O,C))}):I]},[null,null]),p=g[0],g=g[1];return p?this.where(p.name).equals(n[p.keyPath]).filter(g):l?this.filter(g):this.where(s).equals("")},st.prototype.filter=function(n){return this.toCollection().and(n)},st.prototype.count=function(n){return this.toCollection().count(n)},st.prototype.offset=function(n){return this.toCollection().offset(n)},st.prototype.limit=function(n){return this.toCollection().limit(n)},st.prototype.each=function(n){return this.toCollection().each(n)},st.prototype.toArray=function(n){return this.toCollection().toArray(n)},st.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},st.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},st.prototype.reverse=function(){return this.toCollection().reverse()},st.prototype.mapToClass=function(n){for(var s=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Go&&(n=(g=>{var y=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=y}function I(){return g!==null&&g.apply(this,arguments)||this}return r(y,C),y.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return s},enumerable:!1,configurable:!0}),I.prototype.table=function(){return l},I})(n)),new Set),f=n.prototype;f;f=h(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function p(g){if(!g)return g;var y,C=Object.create(n.prototype);for(y in g)if(!u.has(y))try{C[y]=g[y]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),n},st.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},st.prototype.add=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=jr(p)(n)),this._trans("readwrite",function(y){return l.core.mutate({trans:y,type:"add",keys:s!=null?[s]:null,values:[g]})}).then(function(y){return y.numFailures?we.reject(y.failures[0]):y.lastResult}).then(function(y){if(p)try{Q(n,p,y)}catch{}return y})},st.prototype.upsert=function(n,s){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(p){var g=p??{};return Vo(g,s),u&&Q(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[s]}}).then(function(y){return y.numFailures?we.reject(y.failures[0]):!!p})})})},st.prototype.update=function(n,s){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(s):(n=oe(n,this.schema.primKey.keyPath))===void 0?me(new xe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(s)},st.prototype.put=function(n,s){var l=this,u=this.schema.primKey,f=u.auto,p=u.keyPath,g=n;return p&&f&&(g=jr(p)(n)),this._trans("readwrite",function(y){return l.core.mutate({trans:y,type:"put",values:[g],keys:s!=null?[s]:null})}).then(function(y){return y.numFailures?we.reject(y.failures[0]):y.lastResult}).then(function(y){if(p)try{Q(n,p,y)}catch{}return y})},st.prototype.delete=function(n){var s=this;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ws(s,[n],u)}).then(function(u){return u.numFailures?we.reject(u.failures[0]):void 0})})},st.prototype.clear=function(){var n=this;return this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"deleteRange",range:La}).then(function(l){return ws(n,null,l)})}).then(function(s){return s.numFailures?we.reject(s.failures[0]):void 0})},st.prototype.bulkGet=function(n){var s=this;return this._trans("readonly",function(l){return s.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return s.hook.reading.fire(f)})})})},st.prototype.bulkAdd=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var y=u.schema.primKey,N=y.auto,y=y.keyPath;if(y&&f)throw new xe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new xe.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=y&&N?n.map(jr(y)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:p}).then(function(I){var T=I.numFailures,R=I.failures;if(T===0)return p?I.results:I.lastResult;throw new De("".concat(u.name,".bulkAdd(): ").concat(T," of ").concat(C," operations failed"),R)})})},st.prototype.bulkPut=function(n,s,l){var u=this,f=Array.isArray(s)?s:void 0,p=(l=l||(f?void 0:s))?l.allKeys:void 0;return this._trans("readwrite",function(g){var y=u.schema.primKey,N=y.auto,y=y.keyPath;if(y&&f)throw new xe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new xe.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=y&&N?n.map(jr(y)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:p}).then(function(I){var T=I.numFailures,R=I.failures;if(T===0)return p?I.results:I.lastResult;throw new De("".concat(u.name,".bulkPut(): ").concat(T," of ").concat(C," operations failed"),R)})})},st.prototype.bulkUpdate=function(n){var s=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),p=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(y){var C=[],N=[],I=(n.forEach(function(T,R){var O=T.key,P=T.changes,A=y[R];if(A){for(var j=0,B=Object.keys(P);j<B.length;j++){var L=B[j],V=P[L];if(L===s.schema.primKey.keyPath){if(Ye(V,O)!==0)throw new xe.Constraint("Cannot update primary key in bulkUpdate()")}else Q(A,L,V)}p.push(R),C.push(O),N.push(A)}}),C.length);return l.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(T){var R=T.numFailures,O=T.failures;if(R===0)return I;for(var P=0,A=Object.keys(O);P<A.length;P++){var j,B=A[P],L=p[Number(B)];L!=null&&(j=O[B],delete O[B],O[L]=j)}throw new De("".concat(s.name,".bulkUpdate(): ").concat(R," of ").concat(I," operations failed"),O)})})})},st.prototype.bulkDelete=function(n){var s=this,l=n.length;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ws(s,n,f)})}).then(function(u){var f=u.numFailures,p=u.failures;if(f===0)return u.lastResult;throw new De("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),p)})};var Qo=st;function st(){}function qa(n){function s(g,y){if(y){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return l[g].subscribe.apply(null,N),n}if(typeof g=="string")return l[g]}var l={};s.addEventType=p;for(var u=1,f=arguments.length;u<f;++u)p(arguments[u]);return s;function p(g,y,C){var N,I;if(typeof g!="object")return y=y||Ht,I={subscribers:[],fire:C=C||Ke,subscribe:function(T){I.subscribers.indexOf(T)===-1&&(I.subscribers.push(T),I.fire=y(I.fire,T))},unsubscribe:function(T){I.subscribers=I.subscribers.filter(function(R){return R!==T}),I.fire=I.subscribers.reduce(y,C)}},l[g]=s[g]=I;c(N=g).forEach(function(T){var R=N[T];if(d(R))p(T,N[T][0],N[T][1]);else{if(R!=="asap")throw new xe.InvalidArgument("Invalid event config");var O=p(T,Bt,function(){for(var P=arguments.length,A=new Array(P);P--;)A[P]=arguments[P];O.subscribers.forEach(function(j){ee(function(){j.apply(null,A)})})})}})}}function ja(n,s){return q(s).from({prototype:n}),s}function da(n,s){return!(n.filter||n.algorithm||n.or)&&(s?n.justLimit:!n.replayFilter)}function pi(n,s){n.filter=it(n.filter,s)}function hi(n,s,l){var u=n.replayFilter;n.replayFilter=u?function(){return it(u(),s())}:s,n.justLimit=l&&!u}function ks(n,s){if(n.isPrimKey)return s.primaryKey;var l=s.getIndexByKeyPath(n.index);if(l)return l;throw new xe.Schema("KeyPath "+n.index+" on object store "+s.name+" is not indexed")}function Xo(n,s,l){var u=ks(n,s.schema);return s.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function xs(n,s,l,u){var f,p,g=n.replayFilter?it(n.filter,n.replayFilter()):n.filter;return n.or?(f={},p=function(y,C,N){var I,T;g&&!g(C,N,function(R){return C.stop(R)},function(R){return C.fail(R)})||((T=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(T=""+new Uint8Array(I)),k(f,T))||(f[T]=!0,s(y,C,N))},Promise.all([n.or._iterate(p,l),Zo(Xo(n,u,l),n.algorithm,p,!n.keysOnly&&n.valueMapper)])):Zo(Xo(n,u,l),it(n.algorithm,g),s,!n.keysOnly&&n.valueMapper)}function Zo(n,s,l,u){var f=rt(u?function(p,g,y){return l(u(p),g,y)}:l);return n.then(function(p){if(p)return p.start(function(){var g=function(){return p.continue()};s&&!s(p,function(y){return g=y},function(y){p.stop(y),g=Ke},function(y){p.fail(y),g=Ke})||f(p.value,p,function(y){return g=y}),g()})})}$e.prototype._read=function(n,s){var l=this._ctx;return l.error?l.table._trans(null,me.bind(null,l.error)):l.table._trans("readonly",n).then(s)},$e.prototype._write=function(n){var s=this._ctx;return s.error?s.table._trans(null,me.bind(null,s.error)):s.table._trans("readwrite",n,"locked")},$e.prototype._addAlgorithm=function(n){var s=this._ctx;s.algorithm=it(s.algorithm,n)},$e.prototype._iterate=function(n,s){return xs(this._ctx,n,s,this._ctx.table.core)},$e.prototype.clone=function(n){var s=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),s._ctx=l,s},$e.prototype.raw=function(){return this._ctx.valueMapper=null,this},$e.prototype.each=function(n){var s=this._ctx;return this._read(function(l){return xs(s,n,l,s.table.core)})},$e.prototype.count=function(n){var s=this;return this._read(function(l){var u,f=s._ctx,p=f.table.core;return da(f,!0)?p.count({trans:l,query:{index:ks(f,p.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,xs(f,function(){return++u,!1},l,p).then(function(){return u}))}).then(n)},$e.prototype.sortBy=function(n,s){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function p(C,N){return N?p(C[l[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function y(C,N){return Ye(p(C,f),p(N,f))*g}return this.toArray(function(C){return C.sort(y)}).then(s)},$e.prototype.toArray=function(n){var s=this;return this._read(function(l){var u,f,p,g=s._ctx;return g.dir==="next"&&da(g,!0)&&0<g.limit?(u=g.valueMapper,f=ks(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(y){return y=y.result,u?y.map(u):y})):(p=[],xs(g,function(y){return p.push(y)},l,g.table.core).then(function(){return p}))},n)},$e.prototype.offset=function(n){var s=this._ctx;return n<=0||(s.offset+=n,da(s)?hi(s,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):hi(s,function(){var l=n;return function(){return--l<0}})),this},$e.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),hi(this._ctx,function(){var s=n;return function(l,u,f){return--s<=0&&u(f),0<=s}},!0),this},$e.prototype.until=function(n,s){return pi(this._ctx,function(l,u,f){return!n(l.value)||(u(f),s)}),this},$e.prototype.first=function(n){return this.limit(1).toArray(function(s){return s[0]}).then(n)},$e.prototype.last=function(n){return this.reverse().first(n)},$e.prototype.filter=function(n){var s;return pi(this._ctx,function(l){return n(l.value)}),(s=this._ctx).isMatch=it(s.isMatch,n),this},$e.prototype.and=function(n){return this.filter(n)},$e.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},$e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$e.prototype.desc=function(){return this.reverse()},$e.prototype.eachKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.key,u)})},$e.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},$e.prototype.eachPrimaryKey=function(n){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},$e.prototype.keys=function(n){var s=this._ctx,l=(s.keysOnly=!s.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},$e.prototype.primaryKeys=function(n){var s=this._ctx;if(s.dir==="next"&&da(s,!0)&&0<s.limit)return this._read(function(u){var f=ks(s,s.table.core.schema);return s.table.core.query({trans:u,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(u){return u.result}).then(n);s.keysOnly=!s.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},$e.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},$e.prototype.firstKey=function(n){return this.limit(1).keys(function(s){return s[0]}).then(n)},$e.prototype.lastKey=function(n){return this.reverse().firstKey(n)},$e.prototype.distinct=function(){var n,s=this._ctx,s=s.index&&s.table.schema.idxByName[s.index];return s&&s.multi&&(n={},pi(this._ctx,function(u){var u=u.primaryKey.toString(),f=k(n,u);return n[u]=!0,!f})),this},$e.prototype.modify=function(n){var s=this,l=this._ctx;return this._write(function(u){function f(A,j){var B=j.failures;R+=A-j.numFailures;for(var L=0,V=c(B);L<V.length;L++){var ie=V[L];T.push(B[ie])}}var p=typeof n=="function"?n:function(A){return Vo(A,n)},g=l.table.core,I=g.schema.primaryKey,y=I.outbound,C=I.extractKey,N=200,I=s.db._options.modifyChunkSize,T=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),R=0,O=[],P=n===$o;return s.clone().primaryKeys().then(function(A){function j(L){var V=Math.min(N,A.length-L),ie=A.slice(L,L+V);return(P?Promise.resolve([]):g.getMany({trans:u,keys:ie,cache:"immutable"})).then(function(ye){var be=[],le=[],Ce=y?[]:null,Te=P?ie:[];if(!P)for(var fe=0;fe<V;++fe){var Ie=ye[fe],Ve={value:X(Ie),primKey:A[L+fe]};p.call(Ve,Ve.value,Ve)!==!1&&(Ve.value==null?Te.push(A[L+fe]):y||Ye(C(Ie),C(Ve.value))===0?(le.push(Ve.value),y&&Ce.push(A[L+fe])):(Te.push(A[L+fe]),be.push(Ve.value)))}return Promise.resolve(0<be.length&&g.mutate({trans:u,type:"add",values:be}).then(function(Je){for(var qe in Je.failures)Te.splice(parseInt(qe),1);f(be.length,Je)})).then(function(){return(0<le.length||B&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Ce,values:le,criteria:B,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<L}).then(function(Je){return f(le.length,Je)})}).then(function(){return(0<Te.length||B&&P)&&g.mutate({trans:u,type:"delete",keys:Te,criteria:B,isAdditionalChunk:0<L}).then(function(Je){return ws(l.table,Te,Je)}).then(function(Je){return f(Te.length,Je)})}).then(function(){return A.length>L+V&&j(L+N)})})}var B=da(l)&&l.limit===1/0&&(typeof n!="function"||P)&&{index:l.index,range:l.range};return j(0).then(function(){if(0<T.length)throw new Xe("Error modifying one or more objects",T,R,O);return A.length})})})},$e.prototype.delete=function(){var n=this._ctx,s=n.range;return!da(n)||n.table.schema.yProps||!n.isPrimKey&&s.type!==3?this.modify($o):this._write(function(l){var u=n.table.core.schema.primaryKey,f=s;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(p){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(C){var y=C.failures,C=C.numFailures;if(C)throw new Xe("Could not delete some values",Object.keys(y).map(function(N){return y[N]}),p-C);return p-C})})})};var qc=$e;function $e(){}var $o=function(n,s){return s.value=null};function jc(n,s){return n<s?-1:n===s?0:1}function Bc(n,s){return s<n?-1:n===s?0:1}function Jt(n,s,l){return n=n instanceof el?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(s),n}function pa(n){return new n.Collection(n,function(){return Jo("")}).limit(0)}function Ss(O,s,l,u){var f,p,g,y,C,N,I,T=l.length;if(!l.every(function(A){return typeof A=="string"}))return Jt(O,ot);function R(A){f=A==="next"?function(B){return B.toUpperCase()}:function(B){return B.toLowerCase()},p=A==="next"?function(B){return B.toLowerCase()}:function(B){return B.toUpperCase()},g=A==="next"?jc:Bc;var j=l.map(function(B){return{lower:p(B),upper:f(B)}}).sort(function(B,L){return g(B.lower,L.lower)});y=j.map(function(B){return B.upper}),C=j.map(function(B){return B.lower}),I=(N=A)==="next"?"":u}R("next");var O=new O.Collection(O,function(){return vr(y[0],C[T-1]+u)}),P=(O._ondirectionchange=function(A){R(A)},0);return O._addAlgorithm(function(A,j,B){var L=A.key;if(typeof L=="string"){var V=p(L);if(s(V,C,P))return!0;for(var ie=null,ye=P;ye<T;++ye){var be=((le,Ce,Te,fe,Ie,Ve)=>{for(var Je=Math.min(le.length,fe.length),qe=-1,Be=0;Be<Je;++Be){var lt=Ce[Be];if(lt!==fe[Be])return Ie(le[Be],Te[Be])<0?le.substr(0,Be)+Te[Be]+Te.substr(Be+1):Ie(le[Be],fe[Be])<0?le.substr(0,Be)+fe[Be]+Te.substr(Be+1):0<=qe?le.substr(0,qe)+Ce[qe]+Te.substr(qe+1):null;Ie(le[Be],lt)<0&&(qe=Be)}return Je<fe.length&&Ve==="next"?le+Te.substr(le.length):Je<le.length&&Ve==="prev"?le.substr(0,Te.length):qe<0?null:le.substr(0,qe)+fe[qe]+Te.substr(qe+1)})(L,V,y[ye],C[ye],g,N);be===null&&ie===null?P=ye+1:(ie===null||0<g(ie,be))&&(ie=be)}j(ie!==null?function(){A.continue(ie+I)}:B)}return!1}),O}function vr(n,s,l,u){return{type:2,lower:n,upper:s,lowerOpen:l,upperOpen:u}}function Jo(n){return{type:1,lower:n,upper:n}}Object.defineProperty(wt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),wt.prototype.between=function(n,s,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,s)||this._cmp(n,s)===0&&(l||u)&&(!l||!u)?pa(this):new this.Collection(this,function(){return vr(n,s,!l,!u)})}catch{return Jt(this,at)}},wt.prototype.equals=function(n){return n==null?Jt(this,at):new this.Collection(this,function(){return Jo(n)})},wt.prototype.above=function(n){return n==null?Jt(this,at):new this.Collection(this,function(){return vr(n,void 0,!0)})},wt.prototype.aboveOrEqual=function(n){return n==null?Jt(this,at):new this.Collection(this,function(){return vr(n,void 0,!1)})},wt.prototype.below=function(n){return n==null?Jt(this,at):new this.Collection(this,function(){return vr(void 0,n,!1,!0)})},wt.prototype.belowOrEqual=function(n){return n==null?Jt(this,at):new this.Collection(this,function(){return vr(void 0,n)})},wt.prototype.startsWith=function(n){return typeof n!="string"?Jt(this,ot):this.between(n,n+Ze,!0,!0)},wt.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Ss(this,function(s,l){return s.indexOf(l[0])===0},[n],Ze)},wt.prototype.equalsIgnoreCase=function(n){return Ss(this,function(s,l){return s===l[0]},[n],"")},wt.prototype.anyOfIgnoreCase=function(){var n=z.apply(te,arguments);return n.length===0?pa(this):Ss(this,function(s,l){return l.indexOf(s)!==-1},n,"")},wt.prototype.startsWithAnyOfIgnoreCase=function(){var n=z.apply(te,arguments);return n.length===0?pa(this):Ss(this,function(s,l){return l.some(function(u){return s.indexOf(u)===0})},n,Ze)},wt.prototype.anyOf=function(){var n,s,l=this,u=z.apply(te,arguments),f=this._cmp;try{u.sort(f)}catch{return Jt(this,at)}return u.length===0?pa(this):((n=new this.Collection(this,function(){return vr(u[0],u[u.length-1])}))._ondirectionchange=function(p){f=p==="next"?l._ascending:l._descending,u.sort(f)},s=0,n._addAlgorithm(function(p,g,y){for(var C=p.key;0<f(C,u[s]);)if(++s===u.length)return g(y),!1;return f(C,u[s])===0||(g(function(){p.continue(u[s])}),!1)}),n)},wt.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},wt.prototype.noneOf=function(){var n=z.apply(te,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Jt(this,at)}var s=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return s.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},wt.prototype.inAnyRange=function(n,B){var l=this,u=this._cmp,f=this._ascending,p=this._descending,g=this._min,y=this._max;if(n.length===0)return pa(this);if(!n.every(function(L){return L[0]!==void 0&&L[1]!==void 0&&f(L[0],L[1])<=0}))return Jt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",xe.InvalidArgument);var C=!B||B.includeLowers!==!1,N=B&&B.includeUppers===!0,I,T=f;function R(L,V){return T(L[0],V[0])}try{(I=n.reduce(function(L,V){for(var ie=0,ye=L.length;ie<ye;++ie){var be=L[ie];if(u(V[0],be[1])<0&&0<u(V[1],be[0])){be[0]=g(be[0],V[0]),be[1]=y(be[1],V[1]);break}}return ie===ye&&L.push(V),L},[])).sort(R)}catch{return Jt(this,at)}var O=0,P=N?function(L){return 0<f(L,I[O][1])}:function(L){return 0<=f(L,I[O][1])},A=C?function(L){return 0<p(L,I[O][0])}:function(L){return 0<=p(L,I[O][0])},j=P,B=new this.Collection(this,function(){return vr(I[0][0],I[I.length-1][1],!C,!N)});return B._ondirectionchange=function(L){T=L==="next"?(j=P,f):(j=A,p),I.sort(R)},B._addAlgorithm(function(L,V,ie){for(var ye,be=L.key;j(be);)if(++O===I.length)return V(ie),!1;return!P(ye=be)&&!A(ye)||(l._cmp(be,I[O][1])===0||l._cmp(be,I[O][0])===0||V(function(){T===f?L.continue(I[O][0]):L.continue(I[O][1])}),!1)}),B},wt.prototype.startsWithAnyOf=function(){var n=z.apply(te,arguments);return n.every(function(s){return typeof s=="string"})?n.length===0?pa(this):this.inAnyRange(n.map(function(s){return[s,s+Ze]})):Jt(this,"startsWithAnyOf() only works with strings")};var el=wt;function wt(){}function jn(n){return rt(function(s){return Ba(s),n(s.target.error),!1})}function Ba(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var za="storagemutated",vi="x-storagemutated-1",gr=qa(null,za),zc=(Bn.prototype._lock=function(){return G(!Pe.global),++this._reculock,this._reculock!==1||Pe.global||(Pe.lockOwnerFor=this),this},Bn.prototype._unlock=function(){if(G(!Pe.global),--this._reculock==0)for(Pe.global||(Pe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Re(n[1],n[0])}catch{}}return this},Bn.prototype._locked=function(){return this._reculock&&Pe.lockOwnerFor!==this},Bn.prototype.create=function(n){var s=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(G(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new xe.DatabaseClosed(u);case"MissingAPIError":throw new xe.MissingAPI(u.message,u);default:throw new xe.OpenFailed(u)}if(!this.active)throw new xe.TransactionInactive;G(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=rt(function(f){Ba(f),s._reject(n.error)}),n.onabort=rt(function(f){Ba(f),s.active&&s._reject(new xe.Abort(n.error)),s.active=!1,s.on("abort").fire(f)}),n.oncomplete=rt(function(){s.active=!1,s._resolve(),"mutatedParts"in n&&gr.storagemutated.fire(n.mutatedParts)})}return this},Bn.prototype._promise=function(n,s,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?me(new xe.ReadOnly("Transaction is readonly")):this.active?this._locked()?new we(function(p,g){f._blockedFuncs.push([function(){f._promise(n,s,l).then(p,g)},Pe])}):l?xn(function(){var p=new we(function(g,y){f._lock();var C=s(g,y,f);C&&C.then&&C.then(g,y)});return p.finally(function(){return f._unlock()}),p._lib=!0,p}):((u=new we(function(p,g){var y=s(p,g,f);y&&y.then&&y.then(p,g)}))._lib=!0,u):me(new xe.TransactionInactive)},Bn.prototype._root=function(){return this.parent?this.parent._root():this},Bn.prototype.waitFor=function(n){var s,l=this._root(),u=we.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],s=l.idbtrans.objectStore(l.storeNames[0]),(function p(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(s.get(-1/0).onsuccess=p)})()),l._waitingFor);return new we(function(p,g){u.then(function(y){return l._waitingQueue.push(rt(p.bind(null,y)))},function(y){return l._waitingQueue.push(rt(g.bind(null,y)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Bn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new xe.Abort))},Bn.prototype.table=function(n){var s=this._memoizedTables||(this._memoizedTables={});if(k(s,n))return s[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),s[n]=l;throw new xe.NotFound("Table "+n+" not part of transaction")},Bn);function Bn(){}function gi(n,s,l,u,f,p,g,y){return{name:n,keyPath:s,unique:l,multi:u,auto:f,compound:p,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+tl(s),type:y}}function tl(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function mi(n,s,l){return{name:n,primKey:s,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,p,g){return p=u(p,g),p&&(f[p[0]]=p[1]),f},{}))};var u}var Fa=function(n){try{return n.only([[]]),Fa=function(){return[[]]},[[]]}catch{return Fa=function(){return Ze},Ze}};function yi(n){return n==null?function(){}:typeof n=="string"?(s=n).split(".").length===1?function(l){return l[s]}:function(l){return oe(l,s)}:function(l){return oe(l,n)};var s}function nl(n){return[].slice.call(n)}var Fc=0;function Ka(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Kc(n,s,C){function u(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=P.lower,R=P.upper,O=P.lowerOpen,P=P.upperOpen;return T===void 0?R===void 0?null:s.upperBound(R,!!P):R===void 0?s.lowerBound(T,!!O):s.bound(T,R,!!O,!!P)}function f(I){var T,R=I.name;return{name:R,schema:I,mutate:function(O){var P=O.trans,A=O.type,j=O.keys,B=O.values,L=O.range;return new Promise(function(V,ie){V=rt(V);var ye=P.objectStore(R),be=ye.keyPath==null,le=A==="put"||A==="add";if(!le&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var Ce,Te=(j||B||{length:1}).length;if(j&&B&&j.length!==B.length)throw new Error("Given keys array must have same length as given values array.");if(Te===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function fe(ft){++Je,Ba(ft)}var Ie=[],Ve=[],Je=0;if(A==="deleteRange"){if(L.type===4)return V({numFailures:Je,failures:Ve,results:[],lastResult:void 0});L.type===3?Ie.push(Ce=ye.clear()):Ie.push(Ce=ye.delete(u(L)))}else{var be=le?be?[B,j]:[B,null]:[j,null],qe=be[0],Be=be[1];if(le)for(var lt=0;lt<Te;++lt)Ie.push(Ce=Be&&Be[lt]!==void 0?ye[A](qe[lt],Be[lt]):ye[A](qe[lt])),Ce.onerror=fe;else for(lt=0;lt<Te;++lt)Ie.push(Ce=ye[A](qe[lt])),Ce.onerror=fe}function fn(ft){ft=ft.target.result,Ie.forEach(function(Fr,Ni){return Fr.error!=null&&(Ve[Ni]=Fr.error)}),V({numFailures:Je,failures:Ve,results:A==="delete"?j:Ie.map(function(Fr){return Fr.result}),lastResult:ft})}Ce.onerror=function(ft){fe(ft),fn(ft)},Ce.onsuccess=fn})},getMany:function(O){var P=O.trans,A=O.keys;return new Promise(function(j,B){j=rt(j);for(var L,V=P.objectStore(R),ie=A.length,ye=new Array(ie),be=0,le=0,Ce=function(Ie){Ie=Ie.target,ye[Ie._pos]=Ie.result,++le===be&&j(ye)},Te=jn(B),fe=0;fe<ie;++fe)A[fe]!=null&&((L=V.get(A[fe]))._pos=fe,L.onsuccess=Ce,L.onerror=Te,++be);be===0&&j(ye)})},get:function(O){var P=O.trans,A=O.key;return new Promise(function(j,B){j=rt(j);var L=P.objectStore(R).get(A);L.onsuccess=function(V){return j(V.target.result)},L.onerror=jn(B)})},query:(T=y,function(O){return new Promise(function(P,A){P=rt(P);var j,B,L,le=O.trans,V=O.values,ie=O.limit,be=O.query,ye=ie===1/0?void 0:ie,Ce=be.index,be=be.range,le=le.objectStore(R),le=Ce.isPrimaryKey?le:le.index(Ce.name),Ce=u(be);if(ie===0)return P({result:[]});T?((be=V?le.getAll(Ce,ye):le.getAllKeys(Ce,ye)).onsuccess=function(Te){return P({result:Te.target.result})},be.onerror=jn(A)):(j=0,B=!V&&"openKeyCursor"in le?le.openKeyCursor(Ce):le.openCursor(Ce),L=[],B.onsuccess=function(Te){var fe=B.result;return!fe||(L.push(V?fe.value:fe.primaryKey),++j===ie)?P({result:L}):void fe.continue()},B.onerror=jn(A))})}),openCursor:function(O){var P=O.trans,A=O.values,j=O.query,B=O.reverse,L=O.unique;return new Promise(function(V,ie){V=rt(V);var le=j.index,ye=j.range,be=P.objectStore(R),be=le.isPrimaryKey?be:be.index(le.name),le=B?L?"prevunique":"prev":L?"nextunique":"next",Ce=!A&&"openKeyCursor"in be?be.openKeyCursor(u(ye),le):be.openCursor(u(ye),le);Ce.onerror=jn(ie),Ce.onsuccess=rt(function(Te){var fe,Ie,Ve,Je,qe=Ce.result;qe?(qe.___id=++Fc,qe.done=!1,fe=qe.continue.bind(qe),Ie=(Ie=qe.continuePrimaryKey)&&Ie.bind(qe),Ve=qe.advance.bind(qe),Je=function(){throw new Error("Cursor not stopped")},qe.trans=P,qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=function(){throw new Error("Cursor not started")},qe.fail=rt(ie),qe.next=function(){var Be=this,lt=1;return this.start(function(){return lt--?Be.continue():Be.stop()}).then(function(){return Be})},qe.start=function(Be){function lt(){if(Ce.result)try{Be()}catch(ft){qe.fail(ft)}else qe.done=!0,qe.start=function(){throw new Error("Cursor behind last entry")},qe.stop()}var fn=new Promise(function(ft,Fr){ft=rt(ft),Ce.onerror=jn(Fr),qe.fail=Fr,qe.stop=function(Ni){qe.stop=qe.continue=qe.continuePrimaryKey=qe.advance=Je,ft(Ni)}});return Ce.onsuccess=rt(function(ft){Ce.onsuccess=lt,lt()}),qe.continue=fe,qe.continuePrimaryKey=Ie,qe.advance=Ve,lt(),fn},V(qe)):V(null)},ie)})},count:function(O){var P=O.query,A=O.trans,j=P.index,B=P.range;return new Promise(function(L,V){var ie=A.objectStore(R),ie=j.isPrimaryKey?ie:ie.index(j.name),ye=u(B),ye=ye?ie.count(ye):ie.count();ye.onsuccess=rt(function(be){return L(be.target.result)}),ye.onerror=jn(V)})}}}p=C,g=nl((C=n).objectStoreNames);var p,C={schema:{name:C.name,tables:g.map(function(I){return p.objectStore(I)}).map(function(I){var T=I.keyPath,R=I.autoIncrement,P=d(T),O={},P={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T==null,compound:P,keyPath:T,autoIncrement:R,unique:!0,extractKey:yi(T)},indexes:nl(I.indexNames).map(function(A){return I.index(A)}).map(function(L){var V=L.name,j=L.unique,B=L.multiEntry,L=L.keyPath,V={name:V,compound:d(L),keyPath:L,unique:j,multiEntry:B,extractKey:yi(L)};return O[Ka(L)]=V}),getIndexByKeyPath:function(A){return O[Ka(A)]}};return O[":id"]=P.primaryKey,T!=null&&(O[Ka(T)]=P.primaryKey),P})},hasGetAll:0<g.length&&"getAll"in p.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,y=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Fa(s),schema:g}}function Uc(n,s,l,u){return l=l.IDBKeyRange,s=Kc(s,l,u),{dbcore:n.dbcore.reduce(function(f,p){return p=p.create,a(a({},f),p(f))},s)}}function Ts(n,s){var l=s.db,l=Uc(n._middlewares,l,n._deps,s);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(p){return p.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function Es(n,s,l,u){l.forEach(function(f){var p=u[f];s.forEach(function(g){var y=(function C(N,I){return S(N,I)||(N=h(N))&&C(N,I)})(g,f);(!y||"value"in y&&y.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?M(g,f,{get:function(){return this.table(f)},set:function(C){x(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,p))})})}function bi(n,s){s.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function Gc(n,s){return n._cfg.version-s._cfg.version}function Hc(n,s,l,u){var f=n._dbSchema,p=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=mi("$meta",al("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(p.create(l),p._completion.catch(u),p._reject.bind(p)),y=Pe.transless||Pe;xn(function(){if(Pe.trans=p,Pe.transless=y,s!==0)return Ts(n,l),N=s,((C=p).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):we.resolve(N)).then(function(j){var T=n,R=j,O=p,P=l,A=[],j=T._versions,B=T._dbSchema=Cs(0,T.idbdb,P);return(j=j.filter(function(L){return L._cfg.version>=R})).length===0?we.resolve():(j.forEach(function(L){A.push(function(){var V,ie,ye,be=B,le=L._cfg.dbschema,Ce=(Is(T,be,P),Is(T,le,P),B=T._dbSchema=le,_i(be,le)),Te=(Ce.add.forEach(function(fe){wi(P,fe[0],fe[1].primKey,fe[1].indexes)}),Ce.change.forEach(function(fe){if(fe.recreate)throw new xe.Upgrade("Not yet support for changing primary key");var Ie=P.objectStore(fe.name);fe.add.forEach(function(Ve){return As(Ie,Ve)}),fe.change.forEach(function(Ve){Ie.deleteIndex(Ve.name),As(Ie,Ve)}),fe.del.forEach(function(Ve){return Ie.deleteIndex(Ve)})}),L._cfg.contentUpgrade);if(Te&&L._cfg.version>R)return Ts(T,P),O._memoizedTables={},V=pe(le),Ce.del.forEach(function(fe){V[fe]=be[fe]}),bi(T,[T.Transaction.prototype]),Es(T,[T.Transaction.prototype],c(V),V),O.schema=V,(ie=$(Te))&&Lt(),le=we.follow(function(){var fe;(ye=Te(O))&&ie&&(fe=Sn.bind(null,null),ye.then(fe,fe))}),ye&&typeof ye.then=="function"?we.resolve(ye):le.then(function(){return ye})}),A.push(function(V){var ie,ye,be=L._cfg.dbschema;ie=be,ye=V,[].slice.call(ye.db.objectStoreNames).forEach(function(le){return ie[le]==null&&ye.db.deleteObjectStore(le)}),bi(T,[T.Transaction.prototype]),Es(T,[T.Transaction.prototype],T._storeNames,T._dbSchema),O.schema=T._dbSchema}),A.push(function(V){T.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(T.idbdb.version/10)===L._cfg.version?(T.idbdb.deleteObjectStore("$meta"),delete T._dbSchema.$meta,T._storeNames=T._storeNames.filter(function(ie){return ie!=="$meta"})):V.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return A.length?we.resolve(A.shift()(O.idbtrans)).then(L):we.resolve()})().then(function(){rl(B,P)}))}).catch(g);var C,N;c(f).forEach(function(I){wi(l,I,f[I].primKey,f[I].indexes)}),Ts(n,l),we.follow(function(){return n.on.populate.fire(p)}).catch(g)})}function Wc(n,s){rl(n._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var l=Cs(0,n.idbdb,s);Is(n,n._dbSchema,s);for(var u=0,f=_i(l,n._dbSchema).change;u<f.length;u++){var p=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=s.objectStore(g.name);g.add.forEach(function(C){Et&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),As(y,C)})})(f[u]);if(typeof p=="object")return p.value}}function _i(n,s){var l,u={del:[],add:[],change:[]};for(l in n)s[l]||u.del.push(l);for(l in s){var f=n[l],p=s[l];if(f){var g={name:l,def:p,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(p.primKey.keyPath||"")||f.primKey.auto!==p.primKey.auto)g.recreate=!0,u.change.push(g);else{var y=f.idxByName,C=p.idxByName,N=void 0;for(N in y)C[N]||g.del.push(N);for(N in C){var I=y[N],T=C[N];I?I.src!==T.src&&g.change.push(T):g.add.push(T)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,p])}return u}function wi(n,s,l,u){var f=n.db.createObjectStore(s,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(p){return As(f,p)})}function rl(n,s){c(n).forEach(function(l){s.db.objectStoreNames.contains(l)||(Et&&console.debug("Dexie: Creating missing table",l),wi(s,l,n[l].primKey,n[l].indexes))})}function As(n,s){n.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Cs(n,s,l){var u={};return ne(s.objectStoreNames,0).forEach(function(f){for(var p=l.objectStore(f),g=gi(tl(N=p.keyPath),N||"",!0,!1,!!p.autoIncrement,N&&typeof N!="string",!0),y=[],C=0;C<p.indexNames.length;++C){var I=p.index(p.indexNames[C]),N=I.keyPath,I=gi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);y.push(I)}u[f]=mi(f,g,y)}),u}function Is(n,s,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var p=u[f],g=l.objectStore(p);n._hasGetAll="getAll"in g;for(var y=0;y<g.indexNames.length;++y){var C,N=g.indexNames[y],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+ne(I).join("+")+"]";s[p]&&(C=s[p].idxByName[I])&&(C.name=N,delete s[p].idxByName[I],s[p].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function al(n){return n.split(",").map(function(s,l){var f=s.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(s=f[0].trim()).replace(/([&*]|\+\+)/g,""),p=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return gi(f,p||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),d(p),l===0,u)})}ha.prototype._createTableSchema=mi,ha.prototype._parseIndexSyntax=al,ha.prototype._parseStoresSpec=function(n,s){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),p=f.shift();if(!p)throw new xe.Schema("Invalid schema for table "+u+": "+n[u]);if(p.unique=!0,p.multi)throw new xe.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new xe.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new xe.Schema("Index must have a name and cannot be an empty string")}),p=l._createTableSchema(u,p,f),s[u]=p}})},ha.prototype.stores=function(l){var s=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,s._versions),u={},f={};return l.forEach(function(p){v(u,p._cfg.storesSource),f=p._cfg.dbschema={},p._parseStoresSpec(u,f)}),s._dbSchema=f,bi(s,[s._allTables,s,s.Transaction.prototype]),Es(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],c(f),f),s._storeNames=c(f),this},ha.prototype.upgrade=function(n){return this._cfg.contentUpgrade=Wt(this._cfg.contentUpgrade||Ke,n),this};var Yc=ha;function ha(){}function ki(n,s){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new $n(Yt,{addons:[],indexedDB:n,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function xi(n){return n&&typeof n.databases=="function"}function Si(n){return xn(function(){return Pe.letThrough=!0,n()})}function Ti(n){return!("from"in n)}var Nt=function(n,s){var l;if(!this)return l=new Nt,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?s:n}:{d:0})};function Ua(n,s,l){var u=Ye(s,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Ti(n))return v(n,{from:s,to:l,d:1});var u=n.l,f=n.r;if(Ye(l,n.from)<0)return u?Ua(u,s,l):n.l={from:s,to:l,d:1,l:null,r:null},il(n);if(0<Ye(s,n.to))return f?Ua(f,s,l):n.r={from:s,to:l,d:1,l:null,r:null},il(n);Ye(s,n.from)<0&&(n.from=s,n.l=null,n.d=f?f.d+1:1),0<Ye(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),s=!n.r,u&&!n.l&&Ga(n,u),f&&s&&Ga(n,f)}}function Ga(n,s){Ti(s)||(function l(u,f){var p=f.from,g=f.l,y=f.r;Ua(u,p,f.to),g&&l(u,g),y&&l(u,y)})(n,s)}function sl(n,s){var l=Ps(s),u=l.next();if(!u.done)for(var f=u.value,p=Ps(n),g=p.next(f.from),y=g.value;!u.done&&!g.done;){if(Ye(y.from,f.to)<=0&&0<=Ye(y.to,f.from))return!0;Ye(f.from,y.from)<0?f=(u=l.next(y.from)).value:y=(g=p.next(f.from)).value}return!1}function Ps(n){var s=Ti(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,u)for(;s.n.l&&Ye(l,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!u||Ye(l,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function il(n){var s,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(s=f=="r"?"l":"r",l=a({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[s],(n[s]=l).d=ol(l)),n.d=ol(n)}function ol(l){var s=l.r,l=l.l;return(s?l?Math.max(s.d,l.d):s.d:l?l.d:0)+1}function Rs(n,s){return c(s).forEach(function(l){n[l]?Ga(n[l],s[l]):n[l]=(function u(f){var p,g,y={};for(p in f)k(f,p)&&(g=f[p],y[p]=!g||typeof g!="object"||ve.has(g.constructor)?g:u(g));return y})(s[l])}),n}function Ei(n,s){return n.all||s.all||Object.keys(n).some(function(l){return s[l]&&sl(s[l],n[l])})}_(Nt.prototype,((gt={add:function(n){return Ga(this,n),this},addKey:function(n){return Ua(this,n,n),this},addKeys:function(n){var s=this;return n.forEach(function(l){return Ua(s,l,l)}),this},hasKey:function(n){var s=Ps(this).next(n).value;return s&&Ye(s.from,n)<=0&&0<=Ye(s.to,n)}})[ae]=function(){return Ps(this)},gt));var Br={},Ai={},Ci=!1;function Os(n){Rs(Ai,n),Ci||(Ci=!0,setTimeout(function(){Ci=!1,Ii(Ai,!(Ai={}))},0))}function Ii(n,s){s===void 0&&(s=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Br);u<f.length;u++)ll(y=f[u],n,l,s);else for(var p in n){var g,y,p=/^idb\:\/\/(.*)\/(.*)\//.exec(p);p&&(g=p[1],p=p[2],y=Br["idb://".concat(g,"/").concat(p)])&&ll(y,n,l,s)}l.forEach(function(C){return C()})}function ll(n,s,l,u){for(var f=[],p=0,g=Object.entries(n.queries.query);p<g.length;p++){for(var y=g[p],C=y[0],N=[],I=0,T=y[1];I<T.length;I++){var R=T[I];Ei(s,R.obsSet)?R.subscribers.forEach(function(j){return l.add(j)}):u&&N.push(R)}u&&f.push([C,N])}if(u)for(var O=0,P=f;O<P.length;O++){var A=P[O],C=A[0],N=A[1];n.queries.query[C]=N}}function Vc(n){var s=n._state,l=n._deps.indexedDB;if(s.isBeingOpened||n.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?me(s.dbOpenError):n});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var u=s.openCanceller,f=Math.round(10*n.verno),p=!1;function g(){if(s.openCanceller!==u)throw new xe.DatabaseClosed("db.open() was cancelled")}function y(){return new we(function(R,O){if(g(),!l)throw new xe.MissingAPI;var P=n.name,A=s.autoSchema||!f?l.open(P):l.open(P,f);if(!A)throw new xe.MissingAPI;A.onerror=jn(O),A.onblocked=rt(n._fireOnBlocked),A.onupgradeneeded=rt(function(j){var B;I=A.transaction,s.autoSchema&&!n._options.allowEmptyDB?(A.onerror=Ba,I.abort(),A.result.close(),(B=l.deleteDatabase(P)).onsuccess=B.onerror=rt(function(){O(new xe.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(I.onerror=jn(O),B=j.oldVersion>Math.pow(2,62)?0:j.oldVersion,T=B<1,n.idbdb=A.result,p&&Wc(n,I),Hc(n,B/10,I,O))},O),A.onsuccess=rt(function(){I=null;var j,B,L,V,ie,ye,be=n.idbdb=A.result,le=ne(be.objectStoreNames);if(0<le.length)try{var Ce=be.transaction((ie=le).length===1?ie[0]:ie,"readonly");if(s.autoSchema)ye=be,V=Ce,(L=n).verno=ye.version/10,V=L._dbSchema=Cs(0,ye,V),L._storeNames=ne(ye.objectStoreNames,0),Es(L,[L._allTables],c(V),V);else if(Is(n,n._dbSchema,Ce),B=Ce,((B=_i(Cs(0,(j=n).idbdb,B),j._dbSchema)).add.length||B.change.some(function(Te){return Te.add.length||Te.change.length}))&&!p)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),be.close(),f=be.version+1,p=!0,R(y());Ts(n,Ce)}catch{}pt.push(n),be.onversionchange=rt(function(Te){s.vcFired=!0,n.on("versionchange").fire(Te)}),be.onclose=rt(function(){n.close({disableAutoOpen:!1})}),T&&(le=n._deps,ie=P,xi(ye=le.indexedDB)||ie===Yt||ki(ye,le.IDBKeyRange).put({name:ie}).catch(Ke)),R()},O)}).catch(function(R){switch(R==null?void 0:R.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(0<f)return f=0,y()}return we.reject(R)})}var C,N=s.dbReadyResolve,I=null,T=!1;return we.race([u,(typeof navigator>"u"?we.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(R){function O(){return indexedDB.databases().finally(R)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(y)]).then(function(){return g(),s.onReadyBeingFired=[],we.resolve(Si(function(){return n.on.ready.fire(n.vip)})).then(function R(){var O;if(0<s.onReadyBeingFired.length)return O=s.onReadyBeingFired.reduce(Wt,Ke),s.onReadyBeingFired=[],we.resolve(Si(function(){return O(n.vip)})).then(R)})}).finally(function(){s.openCanceller===u&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(R){s.dbOpenError=R;try{I&&I.abort()}catch{}return u===s.openCanceller&&n._close(),me(R)}).finally(function(){s.openComplete=!0,N()}).then(function(){var R;return T&&(R={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(P){P.name&&(R["idb://".concat(n.name,"/").concat(O.name,"/").concat(P.name)]=new Nt(-1/0,[[[]]]))}),R["idb://".concat(n.name,"/").concat(O.name,"/")]=R["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Nt(-1/0,[[[]]])}),gr(za).fire(R),Ii(R,!0)),n})}function Pi(n){function s(p){return n.next(p)}var l=f(s),u=f(function(p){return n.throw(p)});function f(p){return function(y){var y=p(y),C=y.value;return y.done?C:C&&typeof C.then=="function"?C.then(l,u):d(C)?Promise.all(C).then(l,u):l(C)}}return f(s)()}function Ds(n,s,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(s);return u}var Qc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},p=[];function g(R,O,P){var L=Ka(R),A=f[L]=f[L]||[],j=R==null?0:typeof R=="string"?1:R.length,B=0<O,L=a(a({},P),{name:B?"".concat(L,"(virtual-from:").concat(P.name,")"):P.name,lowLevelIndex:P,isVirtual:B,keyTail:O,keyLength:j,extractKey:yi(R),unique:!B&&P.unique});return A.push(L),L.isPrimaryKey||p.push(L),1<j&&g(j===2?R[0]:R.slice(0,j-1),O+1,P),A.sort(function(V,ie){return V.keyTail-ie.keyTail}),L}var y=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[y];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function T(R){var O,P=R.query.index;return P.isVirtual?a(a({},R),{query:{index:P.lowLevelIndex,range:(O=R.query.range,P=P.keyTail,{type:O.type===1?2:O.type,lower:Ds(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,P),lowerOpen:!0,upper:Ds(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,P),upperOpen:!0})}}):R}return a(a({},l),{schema:a(a({},u),{primaryKey:y,indexes:p,getIndexByKeyPath:function(R){return(R=f[Ka(R)])&&R[0]}}),count:function(R){return l.count(T(R))},query:function(R){return l.query(T(R))},openCursor:function(R){var O=R.query.index,P=O.keyTail,A=O.keyLength;return O.isVirtual?l.openCursor(T(R)).then(function(B){return B&&j(B)}):l.openCursor(R);function j(B){return Object.create(B,{continue:{value:function(L){L!=null?B.continue(Ds(L,R.reverse?n.MAX_KEY:n.MIN_KEY,P)):R.unique?B.continue(B.key.slice(0,A).concat(R.reverse?n.MIN_KEY:n.MAX_KEY,P)):B.continue()}},continuePrimaryKey:{value:function(L,V){B.continuePrimaryKey(Ds(L,n.MAX_KEY,P),V)}},primaryKey:{get:function(){return B.primaryKey}},key:{get:function(){var L=B.key;return A===1?L[0]:L.slice(0,A)}},value:{get:function(){return B.value}}})}}})}})}};function Ri(n,s,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var p,g,y;k(s,f)?(p=n[f],g=s[f],typeof p=="object"&&typeof g=="object"&&p&&g?(y=Z(p))!==Z(g)?l[u+f]=s[f]:y==="Object"?Ri(p,g,l,u+f+"."):p!==g&&(l[u+f]=s[f]):p!==g&&(l[u+f]=s[f])):l[u+f]=void 0}),c(s).forEach(function(f){k(n,f)||(l[u+f]=s[f])}),l}function Oi(n,s){return s.type==="delete"?s.keys:s.keys||s.values.map(n.extractKey)}var Xc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(s){var l=n.table(s),u=l.schema.primaryKey;return a(a({},l),{mutate:function(f){var p=Pe.trans,g=p.table(s).hook,y=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===Ke&&N.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"delete":if(y.fire===Ke)break;return p._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(y.fire===Ke)break;return p._promise("readwrite",function(){return(function T(R,O,P){return l.query({trans:R,values:!1,query:{index:u,range:O},limit:P}).then(function(A){var j=A.result;return I({type:"delete",keys:j,trans:R}).then(function(B){return 0<B.numFailures?Promise.reject(B.failures[0]):j.length<P?{failures:[],numFailures:0,lastResult:void 0}:T(R,a(a({},O),{lower:j[j.length-1],lowerOpen:!0}),P)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function I(T){var R,O,P,A=Pe.trans,j=T.keys||Oi(u,T);if(j)return(T=T.type==="add"||T.type==="put"?a(a({},T),{keys:j}):a({},T)).type!=="delete"&&(T.values=i([],T.values)),T.keys&&(T.keys=i([],T.keys)),R=l,P=j,((O=T).type==="add"?Promise.resolve([]):R.getMany({trans:O.trans,keys:P,cache:"immutable"})).then(function(B){var L=j.map(function(V,ie){var ye,be,le,Ce=B[ie],Te={onerror:null,onsuccess:null};return T.type==="delete"?y.fire.call(Te,V,Ce,A):T.type==="add"||Ce===void 0?(ye=C.fire.call(Te,V,T.values[ie],A),V==null&&ye!=null&&(T.keys[ie]=V=ye,u.outbound||Q(T.values[ie],u.keyPath,V))):(ye=Ri(Ce,T.values[ie]),(be=N.fire.call(Te,ye,V,Ce,A))&&(le=T.values[ie],Object.keys(be).forEach(function(fe){k(le,fe)?le[fe]=be[fe]:Q(le,fe,be[fe])}))),Te});return l.mutate(T).then(function(V){for(var ie=V.failures,ye=V.results,be=V.numFailures,V=V.lastResult,le=0;le<j.length;++le){var Ce=(ye||j)[le],Te=L[le];Ce==null?Te.onerror&&Te.onerror(ie[le]):Te.onsuccess&&Te.onsuccess(T.type==="put"&&B[le]?T.values[le]:Ce)}return{failures:ie,results:ye,numFailures:be,lastResult:V}}).catch(function(V){return L.forEach(function(ie){return ie.onerror&&ie.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function ul(n,s,l){try{if(!s||s.keys.length<n.length)return null;for(var u=[],f=0,p=0;f<s.keys.length&&p<n.length;++f)Ye(s.keys[f],n[p])===0&&(u.push(l?X(s.values[f]):s.values[f]),++p);return u.length===n.length?u:null}catch{return null}}var Zc={stack:"dbcore",level:-1,create:function(n){return{table:function(s){var l=n.table(s);return a(a({},l),{getMany:function(u){var f;return u.cache?(f=ul(u.keys,u.trans._cache,u.cache==="clone"))?we.resolve(f):l.getMany(u).then(function(p){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?X(p):p},p}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function cl(n,s){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function fl(n,s){switch(n){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var $c={stack:"dbcore",level:0,name:"Observability",create:function(n){var s=n.schema.name,l=new Nt(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,f,p){if(Pe.subscr&&f!=="readonly")throw new xe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Pe.querier));return n.transaction(u,f,p)},table:function(u){function f(j){var A,j=j.query;return[A=j.index,new Nt((A=(j=j.range).lower)!=null?A:n.MIN_KEY,(A=j.upper)!=null?A:n.MAX_KEY)]}var p=n.table(u),g=p.schema,y=g.primaryKey,C=g.indexes,N=y.extractKey,I=y.outbound,T=y.autoIncrement&&C.filter(function(P){return P.compound&&P.keyPath.includes(y.keyPath)}),R=a(a({},p),{mutate:function(P){function A(Ie){return Ie="idb://".concat(s,"/").concat(u,"/").concat(Ie),ie[Ie]||(ie[Ie]=new Nt)}var j,B,L,V=P.trans,ie=P.mutatedParts||(P.mutatedParts={}),ye=A(""),be=A(":dels"),le=P.type,Te=P.type==="deleteRange"?[P.range]:P.type==="delete"?[P.keys]:P.values.length<50?[Oi(y,P).filter(function(Ie){return Ie}),P.values]:[],Ce=Te[0],Te=Te[1],fe=P.trans._cache;return d(Ce)?(ye.addKeys(Ce),(le=le==="delete"||Ce.length===Te.length?ul(Ce,fe):null)||be.addKeys(Ce),(le||Te)&&(j=A,B=le,L=Te,g.indexes.forEach(function(Ie){var Ve=j(Ie.name||"");function Je(Be){return Be!=null?Ie.extractKey(Be):null}function qe(Be){Ie.multiEntry&&d(Be)?Be.forEach(function(lt){return Ve.addKey(lt)}):Ve.addKey(Be)}(B||L).forEach(function(Be,ft){var fn=B&&Je(B[ft]),ft=L&&Je(L[ft]);Ye(fn,ft)!==0&&(fn!=null&&qe(fn),ft!=null)&&qe(ft)})}))):Ce?(Te={from:(fe=Ce.lower)!=null?fe:n.MIN_KEY,to:(le=Ce.upper)!=null?le:n.MAX_KEY},be.add(Te),ye.add(Te)):(ye.add(l),be.add(l),g.indexes.forEach(function(Ie){return A(Ie.name).add(l)})),p.mutate(P).then(function(Ie){return!Ce||P.type!=="add"&&P.type!=="put"||(ye.addKeys(Ie.results),T&&T.forEach(function(Ve){for(var Je=P.values.map(function(fn){return Ve.extractKey(fn)}),qe=Ve.keyPath.findIndex(function(fn){return fn===y.keyPath}),Be=0,lt=Ie.results.length;Be<lt;++Be)Je[Be][qe]=Ie.results[Be];A(Ve.name).addKeys(Je)})),V.mutatedParts=Rs(V.mutatedParts||{},ie),Ie})}}),O={get:function(P){return[y,new Nt(P.key)]},getMany:function(P){return[y,new Nt().addKeys(P.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(P){R[P]=function(A){var j=Pe.subscr,B=!!j,L=cl(Pe,p)&&fl(P,A)?A.obsSet={}:j;if(B){var V,j=function(Te){return Te="idb://".concat(s,"/").concat(u,"/").concat(Te),L[Te]||(L[Te]=new Nt)},ie=j(""),ye=j(":dels"),B=O[P](A),be=B[0],B=B[1];if((P==="query"&&be.isPrimaryKey&&!A.values?ye:j(be.name||"")).add(B),!be.isPrimaryKey){if(P!=="count")return V=P==="query"&&I&&A.values&&p.query(a(a({},A),{values:!1})),p[P].apply(this,arguments).then(function(Te){if(P==="query"){if(I&&A.values)return V.then(function(Je){return Je=Je.result,ie.addKeys(Je),Te});var fe=A.values?Te.result.map(N):Te.result;(A.values?ie:ye).addKeys(fe)}else{var Ie,Ve;if(P==="openCursor")return Ve=A.values,(Ie=Te)&&Object.create(Ie,{key:{get:function(){return ye.addKey(Ie.primaryKey),Ie.key}},primaryKey:{get:function(){var Je=Ie.primaryKey;return ye.addKey(Je),Je}},value:{get:function(){return Ve&&ie.addKey(Ie.primaryKey),Ie.value}}})}return Te});ye.add(l)}}return p[P].apply(this,arguments)}}),R}})}};function dl(n,s,l){var u;return l.numFailures===0?s:s.type==="deleteRange"||(u=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1,l.numFailures===u)?null:(u=a({},s),d(u.keys)&&(u.keys=u.keys.filter(function(f,p){return!(p in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,p){return!(p in l.failures)})),u)}function Di(n,s){return l=n,((u=s).lower===void 0||(u.lowerOpen?0<Ye(l,u.lower):0<=Ye(l,u.lower)))&&(l=n,(u=s).upper===void 0||(u.upperOpen?Ye(l,u.upper)<0:Ye(l,u.upper)<=0));var l,u}function pl(n,s,l,u,f,p){var g,y,C,N,I,T;return!l||l.length===0||(g=s.query.index,y=g.multiEntry,C=s.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,T=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(R,O){var P=R,A=[];if(O.type==="add"||O.type==="put")for(var j=new Nt,B=O.values.length-1;0<=B;--B){var L,V=O.values[B],ie=N(V);!j.hasKey(ie)&&(L=I(V),y&&d(L)?L.some(function(Te){return Di(Te,C)}):Di(L,C))&&(j.addKey(ie),A.push(V))}switch(O.type){case"add":var ye=new Nt().addKeys(s.values?R.map(function(fe){return N(fe)}):R),P=R.concat(s.values?A.filter(function(fe){return fe=N(fe),!ye.hasKey(fe)&&(ye.addKey(fe),!0)}):A.map(function(fe){return N(fe)}).filter(function(fe){return!ye.hasKey(fe)&&(ye.addKey(fe),!0)}));break;case"put":var be=new Nt().addKeys(O.values.map(function(fe){return N(fe)}));P=R.filter(function(fe){return!be.hasKey(s.values?N(fe):fe)}).concat(s.values?A:A.map(function(fe){return N(fe)}));break;case"delete":var le=new Nt().addKeys(O.keys);P=R.filter(function(fe){return!le.hasKey(s.values?N(fe):fe)});break;case"deleteRange":var Ce=O.range;P=R.filter(function(fe){return!Di(N(fe),Ce)})}return P},n))===n)?n:(u.sort(function(R,O){return Ye(T(R),T(O))||Ye(N(R),N(O))}),s.limit&&s.limit<1/0&&(u.length>s.limit?u.length=s.limit:n.length===s.limit&&u.length<s.limit&&(f.dirty=!0)),p?Object.freeze(u):u)}function hl(n,s){return Ye(n.lower,s.lower)===0&&Ye(n.upper,s.upper)===0&&!!n.lowerOpen==!!s.lowerOpen&&!!n.upperOpen==!!s.upperOpen}function Jc(n,s){return((l,u,f,p)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=Ye(l,u))===0){if(f&&p)return 0;if(f)return 1;if(p)return-1}return l})(n.lower,s.lower,n.lowerOpen,s.lowerOpen)<=0&&0<=((l,u,f,p)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=Ye(l,u))===0){if(f&&p)return 0;if(f)return-1;if(p)return 1}return l})(n.upper,s.upper,n.upperOpen,s.upperOpen)}function ef(n,s,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,p;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,p=s,setTimeout(function(){f.subscribers.size===0&&W(p,f)},3e3))})}var tf={stack:"dbcore",level:0,name:"Cache",create:function(n){var s=n.schema.name;return a(a({},n),{transaction:function(l,u,f){var p,g,y=n.transaction(l,u,f);return u==="readwrite"&&(f=(p=new AbortController).signal,y.addEventListener("abort",(g=function(C){return function(){if(p.abort(),u==="readwrite"){for(var N=new Set,I=0,T=l;I<T.length;I++){var R=T[I],O=Br["idb://".concat(s,"/").concat(R)];if(O){var P=n.table(R),A=O.optimisticOps.filter(function(Ie){return Ie.trans===y});if(y._explicit&&C&&y.mutatedParts)for(var j=0,B=Object.values(O.queries.query);j<B.length;j++)for(var L=0,V=(be=B[j]).slice();L<V.length;L++)Ei((le=V[L]).obsSet,y.mutatedParts)&&(W(be,le),le.subscribers.forEach(function(Ie){return N.add(Ie)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Ie){return Ie.trans!==y});for(var ie=0,ye=Object.values(O.queries.query);ie<ye.length;ie++)for(var be,le,Ce,Te=0,fe=(be=ye[ie]).slice();Te<fe.length;Te++)(le=fe[Te]).res!=null&&y.mutatedParts&&(C&&!le.dirty?(Ce=Object.isFrozen(le.res),Ce=pl(le.res,le.req,A,P,le,Ce),le.dirty?(W(be,le),le.subscribers.forEach(function(Ie){return N.add(Ie)})):Ce!==le.res&&(le.res=Ce,le.promise=we.resolve({result:Ce}))):(le.dirty&&W(be,le),le.subscribers.forEach(function(Ie){return N.add(Ie)})))}}}N.forEach(function(Ie){return Ie()})}}})(!1),{signal:f}),y.addEventListener("error",g(!1),{signal:f}),y.addEventListener("complete",g(!0),{signal:f})),y},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return a(a({},u),{mutate:function(p){var g,y=Pe.trans;return!f.outbound&&y.db._options.cache!=="disabled"&&!y.explicit&&y.idbtrans.mode==="readwrite"&&(g=Br["idb://".concat(s,"/").concat(l)])?(y=u.mutate(p),p.type!=="add"&&p.type!=="put"||!(50<=p.values.length||Oi(f,p).some(function(C){return C==null}))?(g.optimisticOps.push(p),p.mutatedParts&&Os(p.mutatedParts),y.then(function(C){0<C.numFailures&&(W(g.optimisticOps,p),(C=dl(0,p,C))&&g.optimisticOps.push(C),p.mutatedParts)&&Os(p.mutatedParts)}),y.catch(function(){W(g.optimisticOps,p),p.mutatedParts&&Os(p.mutatedParts)})):y.then(function(C){var N=dl(0,a(a({},p),{values:p.values.map(function(I,T){var R;return C.failures[T]?I:(Q(R=(R=f.keyPath)!=null&&R.includes(".")?X(I):a({},I),f.keyPath,C.results[T]),R)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return p.mutatedParts&&Os(p.mutatedParts)})}),y):u.mutate(p)},query:function(p){var g,y,C,N,I,T,R;return cl(Pe,u)&&fl("query",p)?(g=((C=Pe.trans)==null?void 0:C.db._options.cache)==="immutable",y=(C=Pe).requery,C=C.signal,T=((O,P,A,j)=>{var B=Br["idb://".concat(O,"/").concat(P)];if(!B)return[];if(!(O=B.queries[A]))return[null,!1,B,null];var L=O[(j.query?j.query.index.name:null)||""];if(!L)return[null,!1,B,null];switch(A){case"query":var V=L.find(function(ie){return ie.req.limit===j.limit&&ie.req.values===j.values&&hl(ie.req.query.range,j.query.range)});return V?[V,!0,B,L]:[L.find(function(ie){return("limit"in ie.req?ie.req.limit:1/0)>=j.limit&&(!j.values||ie.req.values)&&Jc(ie.req.query.range,j.query.range)}),!1,B,L];case"count":return V=L.find(function(ie){return hl(ie.req.query.range,j.query.range)}),[V,!!V,B,L]}})(s,l,"query",p),R=T[0],N=T[2],I=T[3],R&&T[1]?R.obsSet=p.obsSet:(T=u.query(p).then(function(O){var P=O.result;if(R&&(R.res=P),g){for(var A=0,j=P.length;A<j;++A)Object.freeze(P[A]);Object.freeze(P)}else O.result=X(P);return O}).catch(function(O){return I&&R&&W(I,R),Promise.reject(O)}),R={obsSet:p.obsSet,promise:T,subscribers:new Set,type:"query",req:p,dirty:!1},I?I.push(R):(I=[R],(N=N||(Br["idb://".concat(s,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[p.query.index.name||""]=I)),ef(R,I,y,C),R.promise.then(function(O){return{result:pl(O.result,p,N==null?void 0:N.optimisticOps,u,R,g)}})):u.query(p)}})}})}};function Ms(n,s){return new Proxy(n,{get:function(l,u,f){return u==="db"?s:Reflect.get(l,u,f)}})}ht.prototype.version=function(n){if(isNaN(n)||n<.1)throw new xe.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new xe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var s=this._versions,l=s.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),s.push(l),s.sort(Gc),l.stores({}),this._state.autoSchema=!1),l},ht.prototype._whenReady=function(n){var s=this;return this.idbdb&&(this._state.openComplete||Pe.letThrough||this._vip)?n():new we(function(l,u){if(s._state.openComplete)return u(new xe.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void u(new xe.DatabaseClosed);s.open().catch(Ke)}s._state.dbReadyPromise.then(l,u)}).then(n)},ht.prototype.use=function(f){var s=f.stack,l=f.create,u=f.level,f=f.name,p=(f&&this.unuse({stack:s,name:f}),this._middlewares[s]||(this._middlewares[s]=[]));return p.push({stack:s,create:l,level:u??10,name:f}),p.sort(function(g,y){return g.level-y.level}),this},ht.prototype.unuse=function(n){var s=n.stack,l=n.name,u=n.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},ht.prototype.open=function(){var n=this;return Re(_t,function(){return Vc(n)})},ht.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,s=pt.indexOf(this);if(0<=s&&pt.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new we(function(l){n.dbReadyResolve=l}),n.openCanceller=new we(function(l,u){n.cancelOpen=u}))},ht.prototype.close=function(s){var s=(s===void 0?{disableAutoOpen:!0}:s).disableAutoOpen,l=this._state;s?(l.isBeingOpened&&l.cancelOpen(new xe.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new xe.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},ht.prototype.delete=function(n){var s=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new we(function(f,p){function g(){s.close(n);var y=s._deps.indexedDB.deleteDatabase(s.name);y.onsuccess=rt(function(){var C,N,I;C=s._deps,N=s.name,xi(I=C.indexedDB)||N===Yt||ki(I,C.IDBKeyRange).delete(N).catch(Ke),f()}),y.onerror=jn(p),y.onblocked=s._fireOnBlocked}if(l)throw new xe.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},ht.prototype.backendDB=function(){return this.idbdb},ht.prototype.isOpen=function(){return this.idbdb!==null},ht.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},ht.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ht.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ht.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(s){return n._allTables[s]})},enumerable:!1,configurable:!0}),ht.prototype.transaction=function(){var n=(function(s,l,u){var f=arguments.length;if(f<2)throw new xe.InvalidArgument("Too few arguments");for(var p=new Array(f-1);--f;)p[f-1]=arguments[f];return u=p.pop(),[s,de(p),u]}).apply(this,arguments);return this._transaction.apply(this,n)},ht.prototype._transaction=function(n,s,l){var u,f,p=this,g=Pe.trans,y=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=s.map(function(N){if(N=N instanceof p.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===qn)u=qn;else{if(n!="rw"&&n!=qr)throw new xe.InvalidArgument("Invalid transaction mode: "+n);u=qr}if(g){if(g.mode===qn&&u===qr){if(!y)throw new xe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!y)throw new xe.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),y&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,T){T(N)}):me(N)}var C=(function N(I,T,R,O,P){return we.resolve().then(function(){var L=Pe.transless||Pe,A=I._createTransaction(T,R,I._dbSchema,O),L=(A.explicit=!0,{trans:A,transless:L});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===We.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,T,R,null,P)})):me(V)}var j,B=$(P),L=(B&&Lt(),we.follow(function(){var V;(j=P.call(A,A))&&(B?(V=Sn.bind(null,null),j.then(V,V)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=Pi(j)))},L));return(j&&typeof j.then=="function"?we.resolve(j).then(function(V){return A.active?V:me(new xe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return j})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),me(V)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,C,"lock"):Pe.trans?Re(Pe.transless,function(){return p._whenReady(C)}):this._whenReady(C)},ht.prototype.table=function(n){if(k(this._allTables,n))return this._allTables[n];throw new xe.InvalidTable("Table ".concat(n," does not exist"))};var $n=ht;function ht(n,s){var l,u,f,p,g,y=this,C=(this._middlewares={},this.verno=0,ht.dependencies),C=(this._options=s=a({addons:ht.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},s.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ke,dbReadyPromise:null,cancelOpen:Ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen}),I=(N.dbReadyPromise=new we(function(T){N.dbReadyResolve=T}),N.openCanceller=new we(function(T,R){N.cancelOpen=R}),this._state=N,this.name=n,this.on=qa(this,"populate","blocked","versionchange","close",{ready:[Wt,Ke]}),this.once=function(T,R){var O=function(){for(var P=[],A=0;A<arguments.length;A++)P[A]=arguments[A];y.on(T).unsubscribe(O),R.apply(y,P)};return y.on(T,O)},this.on.ready.subscribe=J(this.on.ready.subscribe,function(T){return function(R,O){ht.vip(function(){var P,A=y._state;A.openComplete?(A.dbOpenError||we.resolve().then(R),O&&T(R)):A.onReadyBeingFired?(A.onReadyBeingFired.push(R),O&&T(R)):(T(R),P=y,O||T(function j(){P.on.ready.unsubscribe(R),P.on.ready.unsubscribe(j)}))})}}),this.Collection=(l=this,ja(qc.prototype,function(j,A){this.db=l;var O=La,P=null;if(A)try{O=A()}catch(L){P=L}var A=j._ctx,j=A.table,B=j.hook.reading.fire;this._ctx={table:j,index:A.index,isPrimKey:!A.index||j.schema.primKey.keyPath&&A.index===j.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:A.or,valueMapper:B!==Bt?B:null}})),this.Table=(u=this,ja(Qo.prototype,function(T,R,O){this.db=u,this._tx=O,this.name=T,this.schema=R,this.hook=u._allTables[T]?u._allTables[T].hook:qa(null,{creating:[Cr,Ke],reading:[Yn,Bt],updating:[Ln,Ke],deleting:[Ir,Ke]})})),this.Transaction=(f=this,ja(zc.prototype,function(T,R,O,P,A){var j=this;T!=="readonly"&&R.forEach(function(B){B=(B=O[B])==null?void 0:B.yProps,B&&(R=R.concat(B.map(function(L){return L.updatesTable})))}),this.db=f,this.mode=T,this.storeNames=R,this.schema=O,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=qa(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new we(function(B,L){j._resolve=B,j._reject=L}),this._completion.then(function(){j.active=!1,j.on.complete.fire()},function(B){var L=j.active;return j.active=!1,j.on.error.fire(B),j.parent?j.parent._reject(B):L&&j.idbtrans&&j.idbtrans.abort(),me(B)})})),this.Version=(p=this,ja(Yc.prototype,function(T){this.db=p,this._cfg={version:T,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,ja(el.prototype,function(T,R,O){if(this.db=g,this._ctx={table:T,index:R===":id"?null:R,or:O},this._cmp=this._ascending=Ye,this._descending=function(P,A){return Ye(A,P)},this._max=function(P,A){return 0<Ye(P,A)?P:A},this._min=function(P,A){return Ye(P,A)<0?P:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new xe.MissingAPI})),this.on("versionchange",function(T){0<T.newVersion?console.warn("Another connection wants to upgrade database '".concat(y.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(y.name,"'. Closing db now to resume the delete request.")),y.close({disableAutoOpen:!1})}),this.on("blocked",function(T){!T.newVersion||T.newVersion<T.oldVersion?console.warn("Dexie.delete('".concat(y.name,"') was blocked")):console.warn("Upgrade '".concat(y.name,"' blocked by other connection holding version ").concat(T.oldVersion/10))}),this._maxKey=Fa(s.IDBKeyRange),this._createTransaction=function(T,R,O,P){return new y.Transaction(T,R,O,y._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(T){y.on("blocked").fire(T),pt.filter(function(R){return R.name===y.name&&R!==y&&!R._state.vcFired}).map(function(R){return R.on("versionchange").fire(T)})},this.use(Zc),this.use(tf),this.use($c),this.use(Qc),this.use(Xc),new Proxy(this,{get:function(T,R,O){var P;return R==="_vip"||(R==="table"?function(A){return Ms(y.table(A),I)}:(P=Reflect.get(T,R,O))instanceof Qo?Ms(P,I):R==="tables"?P.map(function(A){return Ms(A,I)}):R==="_createTransaction"?function(){return Ms(P.apply(this,arguments),I)}:P)}}));this.vip=I,C.forEach(function(T){return T(y)})}var Ls,va=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",nf=(Mi.prototype.subscribe=function(n,s,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:s,complete:l})},Mi.prototype[va]=function(){return this},Mi);function Mi(n){this._subscribe=n}try{Ls={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ls={indexedDB:null,IDBKeyRange:null}}function vl(n){var s,l=!1,u=new nf(function(f){var p=$(n),g,y=!1,C={},N={},I={get closed(){return y},unsubscribe:function(){y||(y=!0,g&&g.abort(),T&&gr.storagemutated.unsubscribe(O))}},T=(f.start&&f.start(I),!1),R=function(){return ue(P)},O=function(A){Rs(C,A),Ei(N,C)&&R()},P=function(){var A,j,B;!y&&Ls.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,B=(L=>{var V=hr();try{p&&Lt();var ie=xn(n,L);return ie=p?ie.finally(Sn):ie}finally{V&&Zn()}})(j={subscr:A,signal:g.signal,requery:R,querier:n,trans:null}),Promise.resolve(B).then(function(L){l=!0,s=L,y||j.signal.aborted||(C={},(V=>{for(var ie in V)if(k(V,ie))return;return 1})(N=A)||T||(gr(za,O),T=!0),ue(function(){return!y&&f.next&&f.next(L)}))},function(L){l=!1,["DatabaseClosedError","AbortError"].includes(L==null?void 0:L.name)||y||ue(function(){y||f.error&&f.error(L)})}))};return setTimeout(R,0),I});return u.hasValue=function(){return l},u.getValue=function(){return s},u}var zr=$n;function Li(n){var s=mr;try{mr=!0,gr.storagemutated.fire(n),Ii(n,!0)}finally{mr=s}}_(zr,a(a({},_e),{delete:function(n){return new zr(n,{addons:[]}).delete()},exists:function(n){return new zr(n,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return s=zr.dependencies,l=s.indexedDB,s=s.IDBKeyRange,(xi(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Yt})}):ki(l,s).toCollection().primaryKeys()).then(n)}catch{return me(new xe.MissingAPI)}var s,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return Pe.trans?Re(Pe.transless,n):n()},vip:Si,async:function(n){return function(){try{var s=Pi(n.apply(this,arguments));return s&&typeof s.then=="function"?s:we.resolve(s)}catch(l){return me(l)}}},spawn:function(n,s,l){try{var u=Pi(n.apply(l,s||[]));return u&&typeof u.then=="function"?u:we.resolve(u)}catch(f){return me(f)}},currentTransaction:{get:function(){return Pe.trans||null}},waitFor:function(n,s){return n=we.resolve(typeof n=="function"?zr.ignoreTransaction(n):n).timeout(s||6e4),Pe.trans?Pe.trans.waitFor(n):n},Promise:we,debug:{get:function(){return Et},set:function(n){Oa(n)}},derive:q,extend:v,props:_,override:J,Events:qa,on:gr,liveQuery:vl,extendObservabilitySet:Rs,getByKeyPath:oe,setByKeyPath:Q,delByKeyPath:function(n,s){typeof s=="string"?Q(n,s,void 0):"length"in s&&[].map.call(s,function(l){Q(n,l,void 0)})},shallowClone:pe,deepClone:X,getObjectDiff:Ri,cmp:Ye,asap:ee,minKey:-1/0,addons:[],connections:pt,errnames:We,dependencies:Ls,cache:Br,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,s,l){return n+s/Math.pow(10,2*l)})})),zr.maxKey=Fa(zr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(gr(za,function(n){mr||(n=new CustomEvent(vi,{detail:n}),mr=!0,dispatchEvent(n),mr=!1)}),addEventListener(vi,function(n){n=n.detail,mr||Li(n)}));var ga,mr=!1,gl=function(){};return typeof BroadcastChannel<"u"&&((gl=function(){(ga=new BroadcastChannel(vi)).onmessage=function(n){return n.data&&Li(n.data)}})(),typeof ga.unref=="function"&&ga.unref(),gr(za,function(n){mr||ga.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!$n.disableBfCache&&n.persisted){Et&&console.debug("Dexie: handling persisted pagehide"),ga!=null&&ga.close();for(var s=0,l=pt;s<l.length;s++)l[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!$n.disableBfCache&&n.persisted&&(Et&&console.debug("Dexie: handling persisted pageshow"),gl(),Li({all:new Nt(-1/0,[[]])}))})),we.rejectionMapper=function(n,s){return!n||n instanceof Le||n instanceof TypeError||n instanceof SyntaxError||!n.name||!yt[n.name]?n:(s=new yt[n.name](s||n.message,n),"stack"in n&&M(s,"stack",{get:function(){return this.inner.stack}}),s)},Oa(Et),a($n,Object.freeze({__proto__:null,Dexie:$n,Entity:Go,PropModification:Na,RangeSet:Nt,add:function(n){return new Na({add:n})},cmp:Ye,default:$n,liveQuery:vl,mergeRanges:Ga,rangesOverlap:sl,remove:function(n){return new Na({remove:n})},replacePrefix:function(n,s){return new Na({replacePrefix:[n,s]})}}),{default:$n}),$n})})(Vs)),Vs.exports}var Kd=Fd();const lo=Bd(Kd),Ml=Symbol.for("Dexie"),jt=globalThis[Ml]||(globalThis[Ml]=lo);if(lo.semVer!==jt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${lo.semVer} and ${jt.semVer}`);const{liveQuery:Um,mergeRanges:Gm,rangesOverlap:Hm,RangeSet:Wm,cmp:Ym,Entity:Vm,PropModification:Qm,replacePrefix:Xm,add:Zm,remove:$m,DexieYProvider:Jm}=jt,Ne=new jt("me-ai-store");Ne.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Ne.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Ne.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Ne.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function sc(t,e){return`${t}:${e}`}async function Ud(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],a=await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).first(),i=await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).last();if(a&&i){const c=new Date(a.date).toLocaleDateString(),d=new Date(i.date).toLocaleDateString();r.push(`Date range: ${c} to ${d}.`)}const o=await oc(5);return o.length>0&&r.push("Top senders: "+o.map(([c,d])=>`${$d(c)} (${d})`).join(", ")+"."),r.join(" ")}async function Gd(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.contacts.count();if(t===0)return"No emails stored locally.";const r=await oc(10),a=await Xd(10),i=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],o=await Ne.items.where("sourceType").equals("gmail").sortBy("date");if(o.length>0){const c=new Date(o[0].date).toLocaleDateString(),d=new Date(o[o.length-1].date).toLocaleDateString();i.push(`- **Date range:** ${c} â ${d}`)}if(r.length>0){i.push("","### Top Senders");for(const[c,d]of r)i.push(`- ${c}: ${d}`)}if(a.length>0){i.push("","### Labels");for(const[c,d]of a)i.push(`- ${c}: ${d}`)}return i.join(`
`)}async function Hd(t=10){const e=await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(lc).join(`

---

`)}async function Wd(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Ne.items.toArray()).map(o=>{var d,v,h,m,k;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(h=o.to)!=null&&h.toLowerCase().includes(r)&&(c+=2),(m=o.snippet)!=null&&m.toLowerCase().includes(r)&&(c+=1),(k=o.body)!=null&&k.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>lc(o)).join(`

---

`)}async function ic(){const t=await Ne.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r,total:t.length}}async function Yd(){const t=await ic();if(!t)return null;const e=["## Pending Action Items",`You have ${t.total} pending email action items that need attention:`,""];for(const r of t.order){const a=t.groups[r],i=r.replace(/_/g," ");e.push(`### ${i} (${a.length})`);for(const o of a.slice(0,5)){const c=o.date?new Date(o.date).toLocaleDateString():"unknown date";e.push(`- **${o.subject}** from ${o.from} (${c})`),o.summary&&e.push(`  ${o.summary}`)}a.length>5&&e.push(`  ...and ${a.length-5} more`),e.push("")}return e.push("The user is seeing these pending items in their chat. Help them decide what to do with these items. You can suggest specific actions like archiving, replying, following up, etc."),e.join(`
`)}async function Vd(){const t=await Ud();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function Qd(t){const e=[],r=await Gd();if(e.push(r),t){const a=await Wd(t,5);e.push("","## Relevant Emails",a)}else{const a=await Hd(5);e.push("","## Recent Emails",a)}return e.join(`
`)}async function oc(t){const e=await Ne.items.where("sourceType").equals("gmail").toArray(),r={};for(const a of e){const i=a.from||"Unknown";r[i]=(r[i]||0)+1}return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,t)}async function Xd(t){const e=await Ne.items.where("sourceType").equals("gmail").toArray(),r={};for(const a of e)for(const i of a.labels||[])r[i]=(r[i]||0)+1;return Object.entries(r).sort((a,i)=>i[1]-a[1]).slice(0,t)}function lc(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=Zd(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}function Zd(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function $d(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}async function Jd({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await Ne.items.where("sourceType").equals("gmail").filter(d=>{var v,h,m,k;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((h=d.from)==null?void 0:h.toLowerCase().includes(o))||((m=d.to)==null?void 0:m.toLowerCase().includes(o))||((k=d.snippet)==null?void 0:k.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const a=await Ne.items.where("sourceType").equals("gmail").count();return{items:await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().offset(r).limit(e).toArray(),total:a}}function uo(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toFixed(1)+" "+r[a]}function Ui(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,a),o=a>=2?2:a>=1?1:0;return i.toFixed(o)+" "+r[a]}function ep(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}const tp=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Ll(...t){tp&&console.log("[debug]",...t)}function ln(t){return Ll(`[MOUNT] ${t}`),()=>Ll(`[DESTROY] ${t}`)}var np=Y("<option> </option>"),rp=Y('<p class="model-description svelte-1p89qnn"> </p>'),ap=Y('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),sp=Y('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),ip=Y('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),op=Y('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),lp=Y('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),up=Y('<p class="error svelte-1p89qnn"> </p>'),cp=Y('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function fp(t,e){ut(e,!0);let r=Me(e,"selectedModel",15),a=Me(e,"gpuInfo",3,null),i=Me(e,"error",3,null);Mt(()=>ln("ModelSelector"));var o=cp(),c=D(w(o),2),d=D(w(c),2);on(d,21,()=>os,Ar,(q,S)=>{var K=np(),ne=w(K),J={};ge(()=>{se(ne,`${b(S).name??""} â ${b(S).size??""}`),J!==(J=b(S).id)&&(K.value=(K.__value=b(S).id)??"")}),U(q,K)});var v=D(d,2);{var h=q=>{const S=kt(()=>os.find(G=>G.id===r()));var K=ec(),ne=Pt(K);{var J=G=>{var ee=rp(),oe=w(ee);ge(()=>se(oe,b(S).description)),U(G,ee)};Se(ne,G=>{b(S)&&G(J)})}U(q,K)};Se(v,q=>{r()&&q(h)})}var m=D(c,2);{var k=q=>{var S=lp(),K=D(w(S),2),ne=w(K),J=D(w(ne)),G=w(J),ee=D(ne,2),oe=D(w(ee)),Q=w(oe),pe=D(ee,2);{var ke=ae=>{var ce=ap(),W=D(w(ce)),te=w(W);ge(()=>se(te,a().device)),U(ae,ce)};Se(pe,ae=>{a().device&&a().device!=="unknown"&&ae(ke)})}var de=D(pe,2);{var ve=ae=>{var ce=sp(),W=D(w(ce)),te=w(W);ge(()=>se(te,a().description)),U(ae,ce)};Se(de,ae=>{a().description&&a().description!=="unknown"&&ae(ve)})}var re=D(de,2);{var X=ae=>{var ce=ip(),W=D(w(ce)),te=w(W);ge(z=>se(te,z),[()=>uo(a().limits.maxBufferSize)]),U(ae,ce)};Se(re,ae=>{var ce;(ce=a().limits)!=null&&ce.maxBufferSize&&ae(X)})}var he=D(re,2);{var Z=ae=>{var ce=op(),W=D(w(ce)),te=w(W);ge(()=>se(te,`${a().features.length??""} supported`)),U(ae,ce)};Se(he,ae=>{var ce;(ce=a().features)!=null&&ce.length&&ae(Z)})}ge(()=>{se(G,a().vendor),se(Q,a().architecture)}),U(q,S)};Se(m,q=>{a()&&q(k)})}var _=D(m,2);{var x=q=>{var S=up(),K=w(S);ge(()=>se(K,i())),U(q,S)};Se(_,q=>{i()&&q(x)})}var M=D(_,2);M.__click=function(...q){var S;(S=e.onload)==null||S.apply(this,q)},ge(()=>M.disabled=i()),Oo(d,r),U(t,o),ct()}Gt(["click"]);var dp=Y('<span class="progress-percent svelte-r5fnze"> </span>'),pp=Y('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),hp=Y('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),vp=Y('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),gp=Y('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),mp=Y('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),yp=Y('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function bp(t,e){ut(e,!0);let r=Me(e,"message",3,""),a=Me(e,"items",19,()=>[]);Mt(()=>ln("LoadingProgress"));var i=yp(),o=w(i),c=w(o),d=D(o,2);on(d,17,a,Ar,(v,h)=>{const m=kt(()=>b(h).total?ep(b(h).loaded||0,b(h).total):null);var k=mp(),_=w(k),x=w(_),M=w(x),q=D(x,2);{var S=G=>{var ee=dp(),oe=w(ee);ge(Q=>se(oe,`${Q??""}%`),[()=>b(m).toFixed(1)]),U(G,ee)};Se(q,G=>{b(m)!==null&&G(S)})}var K=D(_,2);{var ne=G=>{var ee=pp(),oe=Pt(ee),Q=w(oe),pe=D(oe,2),ke=w(pe),de=w(ke),ve=D(ke,4),re=w(ve),X=D(ve,2),he=w(X);ge((Z,ae,ce,W,te)=>{yn(Q,`width: ${Z??""}%`),se(de,ae),se(re,ce),se(he,`(${W??""} / ${te??""} B)`)},[()=>Math.max(b(h).progress??0,.5).toFixed(1),()=>Ui(b(h).loaded||0),()=>Ui(b(h).total),()=>(b(h).loaded||0).toLocaleString(),()=>b(h).total.toLocaleString()]),U(G,ee)},J=G=>{var ee=gp(),oe=D(Pt(ee),2),Q=w(oe);{var pe=de=>{var ve=hp(),re=Pt(ve),X=w(re),he=D(re,2),Z=w(he);ge((ae,ce)=>{se(X,ae),se(Z,`(${ce??""} B)`)},[()=>Ui(b(h).loaded),()=>b(h).loaded.toLocaleString()]),U(de,ve)},ke=de=>{var ve=vp();U(de,ve)};Se(Q,de=>{b(h).loaded?de(pe):de(ke,!1)})}U(G,ee)};Se(K,G=>{b(h).total?G(ne):G(J,!1)})}ge(()=>{nc(x,"title",b(h).file),se(M,b(h).file)}),U(v,k)}),ge(()=>se(c,r())),U(t,i),ct()}var _p=Y('<span class="thinking-tokens svelte-11gjw00"> </span>'),wp=Y('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),kp=Y('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),xp=Y('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Sp=Y('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Tp=Y('<span class="cursor svelte-11gjw00">|</span>'),Ep=Y(" <!>",1),Ap=Y('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Cp=Y('<div class="content svelte-11gjw00"> </div>'),Ip=Y('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Pp(t,e){ut(e,!0);let r=Me(e,"isLast",3,!1),a=Me(e,"isRunning",3,!1),i=Me(e,"generationPhase",3,null),o=Me(e,"numTokens",3,null);Mt(()=>ln(`MessageBubble[${e.msg.role}]`));var c=Ip(),d=w(c),v=w(d),h=D(d,2);{var m=_=>{var x=Ap(),M=Pt(x);{var q=Q=>{var pe=wp(),ke=D(w(pe),4);{var de=ve=>{var re=_p(),X=w(re);ge(()=>se(X,`${o()??""} tokens`)),U(ve,re)};Se(ke,ve=>{o()&&ve(de)})}U(Q,pe)},S=Q=>{var pe=kp();U(Q,pe)};Se(M,Q=>{a()&&r()&&i()==="thinking"?Q(q):a()&&r()&&i()==="preparing"&&Q(S,1)})}var K=D(M,2);{var ne=Q=>{var pe=xp(),ke=w(pe),de=D(w(ke),2),ve=w(de),re=D(ke,2),X=w(re);ge(he=>{se(ve,`${he??""} words`),se(X,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),U(Q,pe)};Se(K,Q=>{e.msg.thinking&&Q(ne)})}var J=D(K,2),G=w(J);{var ee=Q=>{var pe=Sp();U(Q,pe)},oe=Q=>{var pe=Ep(),ke=Pt(pe,!0),de=D(ke);{var ve=re=>{var X=Tp();U(re,X)};Se(de,re=>{a()&&r()&&re(ve)})}ge(()=>se(ke,e.msg.content)),U(Q,pe)};Se(G,Q=>{a()&&r()&&!e.msg.content&&i()!=="thinking"?Q(ee):Q(oe,!1)})}U(_,x)},k=_=>{var x=Cp(),M=w(x);ge(()=>se(M,e.msg.content)),U(_,x)};Se(h,_=>{e.msg.role==="assistant"?_(m):_(k,!1)})}ge(()=>{rn(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),se(v,e.msg.role==="user"?"You":"AI")}),U(t,c),ct()}const Rp=20,Op=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function Dp(t,{count:e=Rp,force:r=!1,onProgress:a=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");a({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(e).toArray();else{const h=new Set((await Ne.emailClassifications.toArray()).map(k=>k.emailId)),m=await Ne.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().toArray();o=0,i=[];for(const k of m)if(h.has(k.id))o++;else if(i.push(k),i.length>=e)break}if(i.length===0){const h=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return a({phase:"done",message:h,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let h=0;h<i.length;h++){const m=i[h];a({phase:"scanning",message:`Classifying email ${h+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:h+1,total:i.length,classified:d});try{const k=zp(m),_=[{role:"system",content:Op},{role:"user",content:k}],x=await t.generateFull(_),M=Kp(x);M&&(await Ne.emailClassifications.put({emailId:m.id,action:M.action,reason:M.reason,summary:M.summary,tags:M.tags,subject:m.subject||"(no subject)",from:m.from||"",date:m.date,scannedAt:c,status:"pending"}),d++)}catch(k){console.error(`Triage email ${h+1} failed:`,k),v++}}return a({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function Mp(){const t=await Ne.emailClassifications.toArray(),e={};for(const a of t){const i=a.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(a)}for(const a of Object.keys(e))e[a].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((a,i)=>e[i].length-e[a].length);return{groups:e,order:r}}async function Lp(){const t=await Ne.emailClassifications.toArray(),e={total:t.length};for(const r of t){const a=r.action||"UNKNOWN";e[a]=(e[a]||0)+1}return e}async function Nl(t,e){await Ne.emailClassifications.update(t,{status:e})}async function Np(){await Ne.emailClassifications.clear()}async function qp(t){await Ne.emailClassifications.where("action").equals(t).delete()}async function jp(t){await Ne.emailClassifications.delete(t)}async function Bp(){const t=await Ne.items.where("sourceType").equals("gmail").count(),e=await Ne.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function zp(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=Fp(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function Fp(t,e){return!t||t.length<=e?t:t.slice(0,e)+"..."}function Kp(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),a=e.lastIndexOf("}");if(r===-1||a===-1||a<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,a+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=Up(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(h=>typeof h=="string"&&h.trim()).map(h=>h.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function Up(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function uc(t){let e=0;for(let a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 55%, 55%)`}function Gp(t){let e=0;for(let a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return`hsl(${Math.abs(e)%360}, 40%, 35%)`}var Hp=Y('<div class="item-summary svelte-1kiwlxf"> </div>'),Wp=Y('<div class="item svelte-1kiwlxf"><div class="item-subject svelte-1kiwlxf"> </div> <div class="item-meta svelte-1kiwlxf"> <!></div> <!></div>'),Yp=Y('<div class="more svelte-1kiwlxf"> </div>'),Vp=Y('<div class="group-items svelte-1kiwlxf"><!> <!></div>'),Qp=Y('<div class="group"><button class="group-header svelte-1kiwlxf"><span class="action-badge svelte-1kiwlxf"> </span> <span class="count svelte-1kiwlxf"> </span> <span>&#9654;</span></button> <!></div>'),Xp=Y(`<div class="pending-card svelte-1kiwlxf"><div class="card-header svelte-1kiwlxf"><span class="icon svelte-1kiwlxf">&#128276;</span> <div><h3 class="svelte-1kiwlxf"> </h3> <p class="subtitle svelte-1kiwlxf">Here's what needs your attention:</p></div></div> <div class="groups svelte-1kiwlxf"></div> <div class="suggestions svelte-1kiwlxf"><p class="suggestions-label svelte-1kiwlxf">Quick actions:</p> <div class="chips svelte-1kiwlxf"><button class="chip svelte-1kiwlxf">Prioritize all</button> <button class="chip svelte-1kiwlxf">What to archive?</button> <button class="chip svelte-1kiwlxf">Urgent replies?</button> <button class="chip svelte-1kiwlxf">Draft replies</button></div></div> <div class="custom-action svelte-1kiwlxf"><p class="custom-label svelte-1kiwlxf">Or describe what you'd like to do:</p> <div class="custom-input-row svelte-1kiwlxf"><textarea rows="1" placeholder="e.g. 'Mark all newsletters as read' or 'What deliveries am I waiting for?'" class="svelte-1kiwlxf"></textarea> <button class="send-btn svelte-1kiwlxf">Go</button></div></div></div>`);function Zp(t,e){ut(e,!0);let r=Oe(""),a=Oe(null);function i(ke){return ke.replace(/_/g," ").replace(/\b\w/g,de=>de.toUpperCase())}function o(ke){e.onsend(ke)}function c(){const ke=b(r).trim();ke&&(e.onsend(ke),F(r,""))}function d(ke){ke.key==="Enter"&&!ke.shiftKey&&(ke.preventDefault(),c())}function v(ke){F(a,b(a)===ke?null:ke,!0)}var h=Xp(),m=w(h),k=D(w(m),2),_=w(k),x=w(_),M=D(m,2);on(M,20,()=>e.pendingData.order,ke=>ke,(ke,de)=>{const ve=kt(()=>e.pendingData.groups[de]),re=kt(()=>uc(de));var X=Qp(),he=w(X);he.__click=()=>v(de);var Z=w(he),ae=w(Z),ce=D(Z,2),W=w(ce),te=D(ce,2);let z;var $=D(he,2);{var _e=Ee=>{var Le=Vp(),Ae=w(Le);on(Ae,17,()=>b(ve).slice(0,5),We=>We.emailId,(We,tt)=>{var xe=Wp(),yt=w(xe),Ke=w(yt),Bt=D(yt,2),Yn=w(Bt),Tt=D(Yn);{var Cr=Ht=>{var Wt=io();ge(Et=>se(Wt,`Â· ${Et??""}`),[()=>new Date(b(tt).date).toLocaleDateString()]),U(Ht,Wt)};Se(Tt,Ht=>{b(tt).date&&Ht(Cr)})}var Ir=D(Bt,2);{var Ln=Ht=>{var Wt=Hp(),Et=w(Wt);ge(()=>se(Et,b(tt).summary)),U(Ht,Wt)};Se(Ir,Ht=>{b(tt).summary&&Ht(Ln)})}ge(()=>{se(Ke,b(tt).subject),se(Yn,`${b(tt).from??""} `)}),U(We,xe)});var Xe=D(Ae,2);{var De=We=>{var tt=Yp(),xe=w(tt);ge(()=>se(xe,`...and ${b(ve).length-5} more`)),U(We,tt)};Se(Xe,We=>{b(ve).length>5&&We(De)})}U(Ee,Le)};Se($,Ee=>{b(a)===de&&Ee(_e)})}ge(Ee=>{yn(Z,`background: ${b(re)??""}20; color: ${b(re)??""}; border-color: ${b(re)??""}40`),se(ae,Ee),se(W,b(ve).length),z=rn(te,1,"chevron svelte-1kiwlxf",null,z,{expanded:b(a)===de})},[()=>i(de)]),U(ke,X)});var q=D(M,2),S=D(w(q),2),K=w(S);K.__click=()=>o("Summarize all my pending action items and help me prioritize them");var ne=D(K,2);ne.__click=()=>o("Which pending emails can I safely archive or delete?");var J=D(ne,2);J.__click=()=>o("Which pending emails need an urgent reply?");var G=D(J,2);G.__click=()=>o("Help me write replies for pending emails that need a response");var ee=D(q,2),oe=D(w(ee),2),Q=w(oe);Q.__keydown=d;var pe=D(Q,2);pe.__click=c,ge(ke=>{se(x,`You have ${e.pendingData.total??""} pending action${e.pendingData.total!==1?"s":""}`),pe.disabled=ke},[()=>!b(r).trim()]),ui(Q,()=>b(r),ke=>F(r,ke)),U(t,h),ct()}Gt(["click","keydown"]);var $p=Y('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),Jp=Y('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),eh=Y('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),th=Y('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),nh=Y('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),rh=Y('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),ah=Y('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function sh(t,e){ut(e,!0),Mt(()=>ln("GpuPanel"));var r=ah(),a=w(r),i=D(w(a),2),o=D(w(i),2),c=w(o),d=D(i,2),v=D(w(d),2),h=w(v),m=D(d,2);{var k=G=>{var ee=$p(),oe=D(w(ee),2),Q=w(oe);ge(()=>se(Q,e.gpuInfo.device)),U(G,ee)};Se(m,G=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&G(k)})}var _=D(m,2);{var x=G=>{var ee=Jp(),oe=D(w(ee),2),Q=w(oe);ge(pe=>se(Q,pe),[()=>uo(e.gpuInfo.limits.maxBufferSize)]),U(G,ee)};Se(_,G=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxBufferSize&&G(x)})}var M=D(_,2);{var q=G=>{var ee=eh(),oe=D(w(ee),2),Q=w(oe);ge(()=>se(Q,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),U(G,ee)};Se(M,G=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeInvocationsPerWorkgroup&&G(q)})}var S=D(M,2);{var K=G=>{var ee=th(),oe=D(w(ee),2),Q=w(oe);ge(pe=>se(Q,pe),[()=>uo(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),U(G,ee)};Se(S,G=>{var ee;(ee=e.gpuInfo.limits)!=null&&ee.maxComputeWorkgroupStorageSize&&G(K)})}var ne=D(S,2);{var J=G=>{var ee=rh(),oe=w(ee),Q=w(oe),pe=D(oe,2);on(pe,21,()=>e.gpuInfo.features,Ar,(ke,de)=>{var ve=nh(),re=w(ve);ge(()=>se(re,b(de))),U(ke,ve)}),ge(()=>se(Q,`Features (${e.gpuInfo.features.length??""})`)),U(G,ee)};Se(ne,G=>{var ee;(ee=e.gpuInfo.features)!=null&&ee.length&&G(J)})}ge(()=>{se(c,e.gpuInfo.vendor),se(h,e.gpuInfo.architecture)}),U(t,r),ct()}var ih=Y('<button class="gpu-badge svelte-1ktw27c"> </button>'),oh=Y('<span class="stats svelte-1ktw27c"> </span>'),lh=Y('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),uh=Y('<span class="stats preparing svelte-1ktw27c"> </span>'),ch=Y('<span class="stats svelte-1ktw27c"> </span>'),fh=Y('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),dh=Y('<button class="btn svelte-1ktw27c">Stop</button>'),ph=Y('<button class="btn primary svelte-1ktw27c">Send</button>'),hh=Y('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function vh(t,e){ut(e,!0),Mt(()=>ln("ChatView"));let r=Me(e,"messages",19,()=>[]),a=Me(e,"pendingActions",3,null),i=Me(e,"isRunning",3,!1),o=Me(e,"tps",3,null),c=Me(e,"numTokens",3,null),d=Me(e,"generationPhase",3,null),v=Me(e,"gpuInfo",3,null),h=Me(e,"chatContainer",15),m=Oe(""),k=Oe(!1);function _(z){z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),x())}function x(){const z=b(m).trim();!z||i()||(F(m,""),e.onsend(z))}var M=hh(),q=w(M),S=w(q);{var K=z=>{var $=ih();$.__click=()=>F(k,!b(k));var _e=w($);ge(()=>se(_e,`WebGPU ${b(k)?"â²":"â¼"}`)),U(z,$)};Se(S,z=>{v()&&z(K)})}var ne=D(S,2);{var J=z=>{var $=oh(),_e=w($);ge((Ee,Le)=>se(_e,`${c()??""} tokens in ${Ee??""}s
        (${Le??""} tok/s)`),[()=>(c()/o()).toFixed(1),()=>o().toFixed(1)]),U(z,$)},G=z=>{var $=lh();U(z,$)},ee=z=>{var $=uh(),_e=w($);ge(Ee=>se(_e,`thinking... ${Ee??""}`),[()=>o()?`${o().toFixed(0)} tok/s`:""]),U(z,$)},oe=z=>{var $=ch(),_e=w($);ge(Ee=>se(_e,`${Ee??""} tok/s`),[()=>o().toFixed(1)]),U(z,$)};Se(ne,z=>{o()&&!i()?z(J):i()&&d()==="preparing"?z(G,1):i()&&d()==="thinking"?z(ee,2):o()&&i()&&z(oe,3)})}var Q=D(ne,4);Q.__click=function(...z){var $;($=e.onreset)==null||$.apply(this,z)};var pe=D(q,2);{var ke=z=>{sh(z,{get gpuInfo(){return v()}})};Se(pe,z=>{b(k)&&v()&&z(ke)})}var de=D(pe,2),ve=w(de);{var re=z=>{Zp(z,{get pendingData(){return a()},get onsend(){return e.onsend}})},X=z=>{var $=fh();U(z,$)};Se(ve,z=>{a()&&r().length===0?z(re):r().length===0&&z(X,1)})}var he=D(ve,2);on(he,17,r,Ar,(z,$,_e)=>{{let Ee=kt(()=>_e===r().length-1);Pp(z,{get msg(){return b($)},get isLast(){return b(Ee)},get isRunning(){return i()},get generationPhase(){return d()},get numTokens(){return c()}})}}),rc(de,z=>h(z),()=>h());var Z=D(de,2),ae=w(Z);ae.__keydown=_;var ce=D(ae,2);{var W=z=>{var $=dh();$.__click=function(..._e){var Ee;(Ee=e.onstop)==null||Ee.apply(this,_e)},U(z,$)},te=z=>{var $=ph();$.__click=x,ge(_e=>$.disabled=_e,[()=>!b(m).trim()]),U(z,$)};Se(ce,z=>{i()?z(W):z(te,!1)})}ge(()=>{Q.disabled=i(),ae.disabled=i()}),ui(ae,()=>b(m),z=>F(m,z)),U(t,M),ct()}Gt(["click","keydown"]);var gh=Y('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function mh(t,e){ut(e,!0);const r=!!navigator.gpu,a=ac();let i=Oe(It(localStorage.getItem("selectedModel")||os[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),v=Oe(It([])),h=Oe(It([])),m=Oe(!1),k=Oe(null),_=Oe(null),x=Oe(null),M=Oe(null),q=Oe(null),S=Oe(null);Mt(()=>{a.check(),a.isReady&&K();const X=a.onMessage(he=>{switch(he.status){case"webgpu-info":F(M,he.data,!0);break;case"loading":F(o,"loading"),F(d,he.data,!0);break;case"initiate":F(v,[...b(v),he],!0);break;case"progress":F(v,b(v).map(Z=>Z.file===he.file?{...Z,...he}:Z),!0);break;case"done":F(v,b(v).filter(Z=>Z.file!==he.file),!0);break;case"ready":F(o,"ready"),K();break;case"start":if(!b(m))break;F(q,he.phase||"preparing",!0),F(h,[...b(h),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!b(m))break;F(q,he.phase,!0);break;case"thinking":{if(!b(m))break;F(k,he.tps,!0),F(_,he.numTokens,!0);const Z=b(h)[b(h).length-1];F(h,[...b(h).slice(0,-1),{...Z,thinking:(Z.thinking||"")+he.content}],!0),ne();break}case"thinking-done":{if(!b(m))break;F(k,he.tps,!0),F(_,he.numTokens,!0);const Z=b(h)[b(h).length-1];F(h,[...b(h).slice(0,-1),{...Z,thinking:he.content}],!0);break}case"update":{if(!b(m))break;F(k,he.tps,!0),F(_,he.numTokens,!0);const Z=b(h)[b(h).length-1];F(h,[...b(h).slice(0,-1),{...Z,content:Z.content+he.output}],!0),ne();break}case"complete":if(!b(m))break;F(m,!1),F(q,null);break;case"error":if(!b(m))break;F(c,he.data,!0),F(m,!1),F(q,null);break}});return()=>X()});async function K(){try{F(S,await ic(),!0)}catch{}}function ne(){Xu().then(()=>{b(x)&&(b(x).scrollTop=b(x).scrollHeight)})}function J(){F(o,"loading"),localStorage.setItem("selectedModel",b(i)),a.loadModel(b(i))}async function G(X){if(!X||b(m))return;F(h,[...b(h),{role:"user",content:X}],!0),F(k,null),F(m,!0);let he=[];try{const ae=await Yd(),ce=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i;let W;ce.test(X)||ae?(W=await Qd(X),ae&&(W=(W||"")+`

`+ae)):W=await Vd(),W&&(he=[{role:"system",content:W}])}catch{}const Z=b(h).map(ae=>({role:ae.role,content:ae.content}));a.generate([...he,...Z]),ne()}function ee(){a.interrupt()}function oe(){a.reset(),F(h,[],!0),F(k,null),F(_,null)}var Q=ec(),pe=Pt(Q);{var ke=X=>{var he=gh();U(X,he)},de=X=>{fp(X,{get gpuInfo(){return b(M)},get error(){return b(c)},onload:J,get selectedModel(){return b(i)},set selectedModel(he){F(i,he,!0)}})},ve=X=>{bp(X,{get message(){return b(d)},get items(){return b(v)}})},re=X=>{vh(X,{get messages(){return b(h)},get pendingActions(){return b(S)},get isRunning(){return b(m)},get tps(){return b(k)},get numTokens(){return b(_)},get generationPhase(){return b(q)},get gpuInfo(){return b(M)},onsend:G,onstop:ee,onreset:oe,get chatContainer(){return b(x)},set chatContainer(he){F(x,he,!0)}})};Se(pe,X=>{r?b(o)===null?X(de,1):b(o)==="loading"?X(ve,2):X(re,!1):X(ke)})}U(t,Q),ct()}const ql="https://accounts.google.com/gsi/client",yh="https://www.googleapis.com/auth/gmail.readonly";let co=null,Qs=null;function bh(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${ql}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const a=document.createElement("script");a.src=ql,a.async=!0,a.defer=!0,a.onload=()=>t(),a.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)})}async function jl(t){await bh(),co=google.accounts.oauth2.initTokenClient({client_id:t,scope:yh,callback:e=>{Qs&&(Qs(e),Qs=null)}})}function _h(){return new Promise((t,e)=>{if(!co){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Qs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},co.requestAccessToken()})}function wh(t){return new Promise(e=>{var r,a;(a=(r=window.google)==null?void 0:r.accounts)!=null&&a.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const kh="https://gmail.googleapis.com/gmail/v1/users/me";function xh(t){return{Authorization:`Bearer ${t}`}}async function ci(t,e){var a;const r=await fetch(`${kh}${e}`,{headers:xh(t)});if(!r.ok){const i=await r.json().catch(()=>({}));throw new Error(((a=i.error)==null?void 0:a.message)||`Gmail API error: ${r.status}`)}return r.json()}function cc(t){return ci(t,"/profile")}function fc(t,{maxResults:e=20,pageToken:r,q:a}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),a&&i.set("q",a),ci(t,`/messages?${i}`)}function dc(t,e,r="full"){return ci(t,`/messages/${e}?format=${r}`)}function Sh(t,{startHistoryId:e,pageToken:r,maxResults:a=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(a)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),ci(t,`/history?${i}`)}function br(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],a=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===a);return(i==null?void 0:i.value)||""}function as(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const a=atob(e),i=Uint8Array.from(a,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function Th(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return as(e.body.data);const r=e.parts||[],a=Js(r,"text/plain");if((c=a==null?void 0:a.body)!=null&&c.data)return as(a.body.data);const i=Js(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=as(i.body.data);return Ah(v)}return"(no body)"}function Eh(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return as(e.body.data);const r=e.parts||[],a=Js(r,"text/html");return(o=a==null?void 0:a.body)!=null&&o.data?as(a.body.data):null}function Js(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const a=Js(r.parts,e);if(a)return a}}return null}function Ah(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}const Rt="gmail",Bl=8,pc=50,hc=100;async function Ch(t,{limit:e=pc,onProgress:r=()=>{},signal:a}={}){var c,d,v,h;const i=await Ne.syncState.get(Rt);if(i!=null&&i.historyId)try{return await Mh(t,i,r,a)}catch(m){if((c=m.message)!=null&&c.includes("404")||(d=m.message)!=null&&d.includes("notFound")||(v=m.message)!=null&&v.includes("Start history id")||(h=m.message)!=null&&h.includes("history_types"))r({phase:"info",message:"History expired, performing full re-sync..."}),await Ne.syncState.delete(Rt);else throw m}return await Oh(t,e===0?1/0:e,r,a)}async function Ih(t,{limit:e=pc,onProgress:r=()=>{},signal:a}={}){const i=await Ne.syncState.get(Rt);return i!=null&&i.oldestPageToken?await Dh(t,i,e===0?1/0:e,r,a):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Ph(){const t=await Ne.syncState.get(Rt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Rh(){await Ne.transaction("rw",[Ne.items,Ne.syncState],async()=>{await Ne.items.where("sourceType").equals(Rt).delete(),await Ne.syncState.delete(Rt)})}async function Oh(t,e,r,a){r({phase:"counting",message:"Getting mailbox info..."}),sa(a);const i=await cc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){sa(a);const k=e-o.length,_=await fc(t,{maxResults:Math.min(hc,k),pageToken:c}),x=(_.messages||[]).map(M=>M.id);if(o.push(...x),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=_.nextPageToken,!c||x.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.put({sourceType:Rt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:h}=await vc(t,o,r,a),m=await Ne.items.where("sourceType").equals(Rt).count();return await Ne.syncState.put({sourceType:Rt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:m,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:h}}async function Dh(t,e,r,a,i){a({phase:"listing",message:"Loading more messages...",current:0}),sa(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){sa(i);const k=r-o.length,_=await fc(t,{maxResults:Math.min(hc,k),pageToken:c}),x=(_.messages||[]).map(M=>M.id);if(o.push(...x),a({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=_.nextPageToken,!c||x.length===0)break}if(d=c||null,o.length===0)return await Ne.syncState.update(Rt,{oldestPageToken:null,lastSyncAt:Date.now()}),a({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:h}=await vc(t,o,a,i),m=await Ne.items.where("sourceType").equals(Rt).count();return await Ne.syncState.update(Rt,{totalItems:m,lastSyncAt:Date.now(),oldestPageToken:d}),a({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:m,total:m}),{added:v,errors:h}}async function Mh(t,e,r,a){r({phase:"syncing",message:"Checking for changes..."}),sa(a);let i=0,o=0,c=0,d,v=e.historyId;do{sa(a);const m=await Sh(t,{startHistoryId:e.historyId,pageToken:d});if(v=m.historyId||v,d=m.nextPageToken,!!m.history){for(const k of m.history){if(k.messagesAdded){const _=k.messagesAdded.map(M=>M.message.id),x=[...new Set(_.filter(M=>M))];if(x.length>0){const M=await Promise.allSettled(x.map(S=>dc(t,S))),q=[];for(const S of M)S.status==="fulfilled"?q.push(gc(S.value)):c++;q.length>0&&(await Ne.items.bulkPut(q),await mc(q),i+=q.length)}}if(k.messagesDeleted){const _=k.messagesDeleted.map(x=>sc(Rt,x.message.id)).filter(x=>x);_.length>0&&(await Ne.items.bulkDelete(_),o+=_.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const h=await Ne.items.where("sourceType").equals(Rt).count();return await Ne.syncState.put({sourceType:Rt,historyId:v,lastSyncAt:Date.now(),totalItems:h,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:h,total:h}),{added:i,deleted:o,errors:c}}async function vc(t,e,r,a){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Bl){sa(a);const d=e.slice(c,c+Bl),v=await Promise.allSettled(d.map(m=>dc(t,m))),h=[];for(const m of v)m.status==="fulfilled"?h.push(gc(m.value)):o++;h.length>0&&(await Ne.items.bulkPut(h),await mc(h)),i+=h.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function gc(t){const e=br(t,"From"),r=br(t,"To"),a=br(t,"Cc"),i=br(t,"Subject")||"(no subject)",o=br(t,"Date"),c=br(t,"Message-ID"),d=br(t,"In-Reply-To"),v=br(t,"References");let h;try{h=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{h=Date.now()}return{id:sc(Rt,t.id),sourceType:Rt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:a,subject:i,snippet:t.snippet||"",body:Th(t),htmlBody:Eh(t),date:h,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function mc(t){const e=new Map;for(const r of t)for(const a of[r.from,r.to,r.cc]){if(!a)continue;const i=a.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Lh(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:a,date:i}]of e)try{const o=await Ne.contacts.where("email").equals(r).first();if(o){const c={};a&&!o.name&&(c.name=a),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await Ne.contacts.update(o.id,c)}else await Ne.contacts.add({email:r,name:a||"",firstSeen:i,lastSeen:i})}catch{}}function Lh(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const a=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:a,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function sa(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Nh=Y(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function qh(t,e){ut(e,!0);let r=Me(e,"clientIdInput",15);Mt(()=>ln("SetupGuide"));let a=Oe(null);async function i(Le){try{await navigator.clipboard.writeText(Le),F(a,Le,!0),setTimeout(()=>{F(a,null)},1500)}catch{const Ae=document.createElement("input");Ae.value=Le,document.body.appendChild(Ae),Ae.select(),document.execCommand("copy"),document.body.removeChild(Ae),F(a,Le,!0),setTimeout(()=>{F(a,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Nh(),h=w(v),m=D(w(h),4),k=D(w(m),6),_=D(w(k),2),x=D(w(_),2),M=D(w(x),2),q=w(M);q.__click=()=>i(o);var S=w(q);S.textContent="http://localhost:5173";var K=D(S,2),ne=w(K),J=D(q,2);J.__click=()=>i(c);var G=w(J);G.textContent="https://cypherkitty.github.io";var ee=D(G,2),oe=w(ee),Q=D(x,2),pe=D(w(Q),2),ke=w(pe);ke.__click=()=>i(o);var de=w(ke);de.textContent="http://localhost:5173";var ve=D(de,2),re=w(ve),X=D(ke,2);X.__click=()=>i(c);var he=w(X);he.textContent="https://cypherkitty.github.io";var Z=D(he,2),ae=w(Z),ce=D(X,2);ce.__click=()=>i(d);var W=w(ce);W.textContent="https://cypherkitty.github.io/me-ai/";var te=D(W,2),z=w(te),$=D(m,2),_e=w($);_e.__keydown=Le=>Le.key==="Enter"&&e.onsave();var Ee=D(_e,2);Ee.__click=function(...Le){var Ae;(Ae=e.onsave)==null||Ae.apply(this,Le)},ge(Le=>{se(ne,b(a)===o?"â":"â§"),se(oe,b(a)===c?"â":"â§"),se(re,b(a)===o?"â":"â§"),se(ae,b(a)===c?"â":"â§"),se(z,b(a)===d?"â":"â§"),Ee.disabled=Le},[()=>!r().trim()]),ui(_e,r),U(t,v),ct()}Gt(["click","keydown"]);function jh(t){const e=t||"";if(e.includes("has not been used in project")||e.includes("is disabled")){const r=e.match(/project\s+(\d+)/),a=r==null?void 0:r[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:a?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${a}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return e.includes("Invalid Credentials")||e.includes("401")||e.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:e.includes("insufficient")&&e.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:e.includes("access_denied")||e.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:e.includes("popup")||e.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:e.includes("Rate Limit")||e.includes("429")||e.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:e,fix:null}}var Bh=Y('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),zh=Y('<div class="error-card-title svelte-14buhqq"> </div>'),Fh=Y('<p class="error-card-fix svelte-14buhqq"> </p>'),Kh=Y('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),Uh=Y('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),Gh=Y('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function yc(t,e){ut(e,!0);let r=Me(e,"ondismiss",3,null),a=Me(e,"onsignout",3,null),i=kt(()=>jh(e.error));Mt(()=>ln("ErrorCard"));var o=Gh(),c=w(o);{var d=K=>{var ne=Bh(),J=w(ne),G=w(J),ee=D(J,2);ee.__click=function(...oe){var Q;(Q=r())==null||Q.apply(this,oe)},ge(()=>se(G,b(i).title)),U(K,ne)},v=K=>{var ne=zh(),J=w(ne);ge(()=>se(J,b(i).title)),U(K,ne)};Se(c,K=>{r()?K(d):K(v,!1)})}var h=D(c,2),m=w(h),k=D(h,2);{var _=K=>{var ne=Fh(),J=w(ne);ge(()=>se(J,b(i).fix)),U(K,ne)};Se(k,K=>{b(i).fix&&K(_)})}var x=D(k,2);{var M=K=>{var ne=Kh(),J=w(ne);ge(()=>{nc(ne,"href",b(i).link.url),se(J,`${b(i).link.label??""} â`)}),U(K,ne)};Se(x,K=>{b(i).link&&K(M)})}var q=D(x,2);{var S=K=>{var ne=Uh();ne.__click=function(...J){var G;(G=a())==null||G.apply(this,J)},U(K,ne)};Se(q,K=>{b(i).action==="signout"&&a()&&K(S)})}ge(()=>se(m,b(i).description)),U(t,o),ct()}Gt(["click"]);var Hh=Y('<span class="spinner svelte-nyqevv"></span> Signing in...',1),Wh=Ro('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),Yh=Y(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function Vh(t,e){ut(e,!0);let r=Me(e,"error",3,null),a=Me(e,"loadingAuth",3,!1);Mt(()=>ln("AuthCard"));var i=Yh(),o=w(i),c=D(w(o),4);{var d=S=>{yc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};Se(c,S=>{r()&&S(d)})}var v=D(c,2);v.__click=function(...S){var K;(K=e.onsignin)==null||K.apply(this,S)};var h=w(v);{var m=S=>{var K=Hh();U(S,K)},k=S=>{var K=Wh();U(S,K)};Se(h,S=>{a()?S(m):S(k,!1)})}var _=D(v,2),x=D(w(_),2),M=w(x),q=D(x,2);q.__click=function(...S){var K;(K=e.onclear)==null||K.apply(this,S)},ge(S=>{v.disabled=a(),se(M,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),U(t,i),ct()}Gt(["click"]);function Do(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function bc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function _c(t){return bc(t).charAt(0).toUpperCase()}var Qh=Y('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),Xh=Y('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),Zh=Y('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function $h(t,e){ut(e,!0);let r=Me(e,"profile",3,null),a=Me(e,"loadingProfile",3,!1);Mt(()=>ln("ProfileCard"));var i=Zh(),o=w(i),c=w(o),d=D(o,2),v=w(d);{var h=_=>{var x=Qh();U(_,x)},m=_=>{var x=Xh(),M=Pt(x),q=w(M),S=D(M,2),K=w(S);ge((ne,J)=>{se(q,r().emailAddress),se(K,`${ne??""} messages
        Â· ${J??""} threads`)},[()=>{var ne;return((ne=r().messagesTotal)==null?void 0:ne.toLocaleString())||"?"},()=>{var ne;return((ne=r().threadsTotal)==null?void 0:ne.toLocaleString())||"?"}]),U(_,x)};Se(v,_=>{a()?_(h):r()&&_(m,1)})}var k=D(d,2);k.__click=function(..._){var x;(x=e.onsignout)==null||x.apply(this,_)},ge(_=>se(c,_),[()=>r()?_c(r().emailAddress):"?"]),U(t,i),ct()}Gt(["click"]);var Jh=Y('<span class="spinner svelte-1ds3j4k"></span>'),ev=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),tv=Y('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),nv=Y('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),rv=Y('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),av=Y('<option class="svelte-1ds3j4k"> </option>'),sv=Y('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),iv=Y('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),ov=Y('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),lv=Y('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),uv=Y('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),cv=Y('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function fv(t,e){ut(e,!0),Mt(()=>ln("SyncStatus"));let r=Me(e,"syncStatus",3,null),a=Me(e,"syncProgress",3,null),i=Me(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(W){if(!W)return"never";const te=Math.floor((Date.now()-W)/1e3);if(te<60)return"just now";const z=Math.floor(te/60);if(z<60)return`${z}m ago`;const $=Math.floor(z/60);return $<24?`${$}h ago`:`${Math.floor($/24)}d ago`}function h(){var W,te;return!((W=a())!=null&&W.total)||!((te=a())!=null&&te.current)?0:Math.round(a().current/a().total*100)}var m=cv(),k=w(m),_=w(k),x=w(_);{var M=W=>{var te=Jh();U(W,te)},q=W=>{var te=ev();U(W,te)};Se(x,W=>{i()?W(M):W(q,!1)})}var S=D(_,2),K=D(w(S),2);{var ne=W=>{var te=tv(),z=w(te),$=D(z);{var _e=Le=>{var Ae=io("Â· more available");U(Le,Ae)},Ee=Le=>{var Ae=io("Â· all synced");U(Le,Ae)};Se($,Le=>{r().hasMore?Le(_e):Le(Ee,!1)})}ge((Le,Ae)=>se(z,`${Le??""} emails stored
          Â· synced ${Ae??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),U(W,te)},J=W=>{var te=nv();U(W,te)};Se(K,W=>{var te;(te=r())!=null&&te.synced?W(ne):W(J,!1)})}var G=D(S,2),ee=w(G);{var oe=W=>{var te=rv();te.__click=()=>F(o,!b(o)),U(W,te)};Se(ee,W=>{var te;(te=r())!=null&&te.synced&&!i()&&W(oe)})}var Q=D(k,2),pe=w(Q),ke=D(w(pe),2);on(ke,21,()=>d,Ar,(W,te)=>{var z=av(),$=w(z),_e={};ge(()=>{se($,b(te).label),_e!==(_e=b(te).value)&&(z.value=(z.__value=b(te).value)??"")}),U(W,z)});var de=D(pe,2),ve=w(de);{var re=W=>{var te=iv(),z=Pt(te);z.__click=()=>e.onsync(b(c));var $=w(z),_e=D(z,2);{var Ee=Le=>{var Ae=sv();Ae.__click=()=>e.onsyncmore(b(c));var Xe=w(Ae);ge(()=>{Ae.disabled=i(),se(Xe,i()?"Loading...":"Sync More")}),U(Le,Ae)};Se(_e,Le=>{r().hasMore&&Le(Ee)})}ge(()=>{z.disabled=i(),se($,i()?"Syncing...":"Sync New")}),U(W,te)},X=W=>{var te=ov();te.__click=()=>e.onsync(b(c));var z=w(te);ge(()=>{te.disabled=i(),se(z,i()?"Syncing...":"Download Emails")}),U(W,te)};Se(ve,W=>{var te;(te=r())!=null&&te.synced?W(re):W(X,!1)})}var he=D(Q,2);{var Z=W=>{var te=lv(),z=w(te),$=w(z);let _e,Ee;var Le=D(z,2),Ae=w(Le);ge(Xe=>{_e=rn($,1,"progress-fill svelte-1ds3j4k",null,_e,{indeterminate:!a().total}),Ee=yn($,"",Ee,Xe),se(Ae,a().message||"Syncing...")},[()=>({width:`${h()??""}%`})]),U(W,te)};Se(he,W=>{i()&&a()&&W(Z)})}var ae=D(he,2);{var ce=W=>{var te=uv(),z=D(w(te),2),$=w(z);$.__click=()=>F(o,!1);var _e=D($,2);_e.__click=()=>{e.onclear(),F(o,!1)},U(W,te)};Se(ae,W=>{b(o)&&W(ce)})}ge(()=>ke.disabled=i()),Oo(ke,()=>b(c),W=>F(c,W)),U(t,m),ct()}Gt(["click"]);var dv=Y('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),pv=Y('<div class="message-list svelte-y2uamw"></div>');function hv(t,e){ut(e,!0);let r=Me(e,"messages",19,()=>[]);Mt(()=>ln("MessageList"));var a=pv();on(a,21,r,Ar,(i,o)=>{var c=dv();c.__click=()=>e.onselect(b(o));var d=w(c),v=w(d),h=D(d,2),m=w(h),k=w(m),_=w(k),x=D(k,2),M=w(x),q=D(m,2),S=w(q),K=D(q,2),ne=w(K);ge((J,G,ee)=>{se(v,J),se(_,G),se(M,ee),se(S,b(o).subject),se(ne,b(o).snippet)},[()=>_c(b(o).from),()=>bc(b(o).from),()=>Do(b(o).date)]),U(i,c)}),U(t,a),ct()}Gt(["click"]);function Mo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var la=Mo();function wc(t){la=t}var Ur={exec:()=>null};function Qe(t,e=""){let r=typeof t=="string"?t:t.source,a={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Ft.caret,"$1"),r=r.replace(i,c),a},getRegex:()=>new RegExp(r,e)};return a}var vv=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Ft={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},gv=/^(?:[ \t]*(?:\n|$))+/,mv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,yv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,gs=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,bv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Lo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,kc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,xc=Qe(kc).replace(/bull/g,Lo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),_v=Qe(kc).replace(/bull/g,Lo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),No=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,wv=/^[^\n]+/,qo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,kv=Qe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",qo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),xv=Qe(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Lo).getRegex(),fi="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",jo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Sv=Qe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",jo).replace("tag",fi).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Sc=Qe(No).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fi).getRegex(),Tv=Qe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Sc).getRegex(),Bo={blockquote:Tv,code:mv,def:kv,fences:yv,heading:bv,hr:gs,html:Sv,lheading:xc,list:xv,newline:gv,paragraph:Sc,table:Ur,text:wv},zl=Qe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fi).getRegex(),Ev={...Bo,lheading:_v,table:zl,paragraph:Qe(No).replace("hr",gs).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",zl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",fi).getRegex()},Av={...Bo,html:Qe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",jo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ur,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Qe(No).replace("hr",gs).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Cv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Iv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Tc=/^( {2,}|\\)\n(?!\s*$)/,Pv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,di=/[\p{P}\p{S}]/u,zo=/[\s\p{P}\p{S}]/u,Ec=/[^\s\p{P}\p{S}]/u,Rv=Qe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,zo).getRegex(),Ac=/(?!~)[\p{P}\p{S}]/u,Ov=/(?!~)[\s\p{P}\p{S}]/u,Dv=/(?:[^\s\p{P}\p{S}]|~)/u,Cc=/(?![*_])[\p{P}\p{S}]/u,Mv=/(?![*_])[\s\p{P}\p{S}]/u,Lv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Nv=Qe(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",vv?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ic=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,qv=Qe(Ic,"u").replace(/punct/g,di).getRegex(),jv=Qe(Ic,"u").replace(/punct/g,Ac).getRegex(),Pc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Bv=Qe(Pc,"gu").replace(/notPunctSpace/g,Ec).replace(/punctSpace/g,zo).replace(/punct/g,di).getRegex(),zv=Qe(Pc,"gu").replace(/notPunctSpace/g,Dv).replace(/punctSpace/g,Ov).replace(/punct/g,Ac).getRegex(),Fv=Qe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ec).replace(/punctSpace/g,zo).replace(/punct/g,di).getRegex(),Kv=Qe(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,Cc).getRegex(),Uv="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Gv=Qe(Uv,"gu").replace(/notPunctSpace/g,Lv).replace(/punctSpace/g,Mv).replace(/punct/g,Cc).getRegex(),Hv=Qe(/\\(punct)/,"gu").replace(/punct/g,di).getRegex(),Wv=Qe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Yv=Qe(jo).replace("(?:-->|$)","-->").getRegex(),Vv=Qe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Yv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ei=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Qv=Qe(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ei).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Rc=Qe(/^!?\[(label)\]\[(ref)\]/).replace("label",ei).replace("ref",qo).getRegex(),Oc=Qe(/^!?\[(ref)\](?:\[\])?/).replace("ref",qo).getRegex(),Xv=Qe("reflink|nolink(?!\\()","g").replace("reflink",Rc).replace("nolink",Oc).getRegex(),Fl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Fo={_backpedal:Ur,anyPunctuation:Hv,autolink:Wv,blockSkip:Nv,br:Tc,code:Iv,del:Ur,delLDelim:Ur,delRDelim:Ur,emStrongLDelim:qv,emStrongRDelimAst:Bv,emStrongRDelimUnd:Fv,escape:Cv,link:Qv,nolink:Oc,punctuation:Rv,reflink:Rc,reflinkSearch:Xv,tag:Vv,text:Pv,url:Ur},Zv={...Fo,link:Qe(/^!?\[(label)\]\((.*?)\)/).replace("label",ei).getRegex(),reflink:Qe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ei).getRegex()},fo={...Fo,emStrongRDelimAst:zv,emStrongLDelim:jv,delLDelim:Kv,delRDelim:Gv,url:Qe(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Fl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Qe(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Fl).getRegex()},$v={...fo,br:Qe(Tc).replace("{2,}","*").getRegex(),text:Qe(fo.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},zs={normal:Bo,gfm:Ev,pedantic:Av},Wa={normal:Fo,gfm:fo,breaks:$v,pedantic:Zv},Jv={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Kl=t=>Jv[t];function Jn(t,e){if(e){if(Ft.escapeTest.test(t))return t.replace(Ft.escapeReplace,Kl)}else if(Ft.escapeTestNoEncode.test(t))return t.replace(Ft.escapeReplaceNoEncode,Kl);return t}function Ul(t){try{t=encodeURI(t).replace(Ft.percentDecode,"%")}catch{return null}return t}function Gl(t,e){var o;let r=t.replace(Ft.findPipe,(c,d,v)=>{let h=!1,m=d;for(;--m>=0&&v[m]==="\\";)h=!h;return h?"|":" |"}),a=r.split(Ft.splitPipe),i=0;if(a[0].trim()||a.shift(),a.length>0&&!((o=a.at(-1))!=null&&o.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;i<a.length;i++)a[i]=a[i].trim().replace(Ft.slashPipe,"|");return a}function Ya(t,e,r){let a=t.length;if(a===0)return"";let i=0;for(;i<a&&t.charAt(a-i-1)===e;)i++;return t.slice(0,a-i)}function eg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let a=0;a<t.length;a++)if(t[a]==="\\")a++;else if(t[a]===e[0])r++;else if(t[a]===e[1]&&(r--,r<0))return a;return r>0?-2:-1}function tg(t,e=0){let r=e,a="";for(let i of t)if(i==="	"){let o=4-r%4;a+=" ".repeat(o),r+=o}else a+=i,r++;return a}function Hl(t,e,r,a,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");a.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:a.inlineTokens(d)};return a.state.inLink=!1,v}function ng(t,e,r){let a=t.match(r.other.indentCodeCompensation);if(a===null)return e;let i=a[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ti=class{constructor(t){Ue(this,"options");Ue(this,"rules");Ue(this,"lexer");this.options=t||la}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Ya(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],a=ng(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:a}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let a=Ya(r,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(r=a.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Ya(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Ya(e[0],`
`).split(`
`),a="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let h=d.join(`
`),m=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${h}`:h,i=i?`${i}
${m}`:m;let k=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(m,o,!0),this.lexer.state.top=k,r.length===0)break;let _=o.at(-1);if((_==null?void 0:_.type)==="code")break;if((_==null?void 0:_.type)==="blockquote"){let x=_,M=x.raw+`
`+r.join(`
`),q=this.blockquote(M);o[o.length-1]=q,a=a.substring(0,a.length-x.raw.length)+q.raw,i=i.substring(0,i.length-x.text.length)+q.text;break}else if((_==null?void 0:_.type)==="list"){let x=_,M=x.raw+`
`+r.join(`
`),q=this.list(M);o[o.length-1]=q,a=a.substring(0,a.length-_.raw.length)+q.raw,i=i.substring(0,i.length-x.raw.length)+q.raw,r=M.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:o,text:i}}}list(t){var r,a;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let m=!1,k="",_="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;k=e[0],t=t.substring(k.length);let x=tg(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],q=!x.trim(),S=0;if(this.options.pedantic?(S=2,_=x.trimStart()):q?S=e[1].length+1:(S=x.search(this.rules.other.nonSpaceChar),S=S>4?1:S,_=x.slice(S),S+=e[1].length),q&&this.rules.other.blankLine.test(M)&&(k+=M+`
`,t=t.substring(M.length+1),m=!0),!m){let K=this.rules.other.nextBulletRegex(S),ne=this.rules.other.hrRegex(S),J=this.rules.other.fencesBeginRegex(S),G=this.rules.other.headingBeginRegex(S),ee=this.rules.other.htmlBeginRegex(S),oe=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Q=t.split(`
`,1)[0],pe;if(M=Q,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),pe=M):pe=M.replace(this.rules.other.tabCharGlobal,"    "),J.test(M)||G.test(M)||ee.test(M)||oe.test(M)||K.test(M)||ne.test(M))break;if(pe.search(this.rules.other.nonSpaceChar)>=S||!M.trim())_+=`
`+pe.slice(S);else{if(q||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||J.test(x)||G.test(x)||ne.test(x))break;_+=`
`+M}q=!M.trim(),k+=Q+`
`,t=t.substring(Q.length+1),x=pe.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(k)&&(v=!0)),c.items.push({type:"list_item",raw:k,task:!!this.options.gfm&&this.rules.other.listIsTask.test(_),loose:!1,text:_,tokens:[]}),c.raw+=k}let h=c.items.at(-1);if(h)h.raw=h.raw.trimEnd(),h.text=h.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let m of c.items){if(this.lexer.state.top=!1,m.tokens=this.lexer.blockTokens(m.text,[]),m.task){if(m.text=m.text.replace(this.rules.other.listReplaceTask,""),((r=m.tokens[0])==null?void 0:r.type)==="text"||((a=m.tokens[0])==null?void 0:a.type)==="paragraph"){m.tokens[0].raw=m.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),m.tokens[0].text=m.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let _=this.lexer.inlineQueue.length-1;_>=0;_--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[_].src)){this.lexer.inlineQueue[_].src=this.lexer.inlineQueue[_].src.replace(this.rules.other.listReplaceTask,"");break}}let k=this.rules.other.listTaskCheckbox.exec(m.raw);if(k){let _={type:"checkbox",raw:k[0]+" ",checked:k[0]!=="[ ]"};m.checked=_.checked,c.loose?m.tokens[0]&&["paragraph","text"].includes(m.tokens[0].type)&&"tokens"in m.tokens[0]&&m.tokens[0].tokens?(m.tokens[0].raw=_.raw+m.tokens[0].raw,m.tokens[0].text=_.raw+m.tokens[0].text,m.tokens[0].tokens.unshift(_)):m.tokens.unshift({type:"paragraph",raw:_.raw,text:_.raw,tokens:[_]}):m.tokens.unshift(_)}}if(!c.loose){let k=m.tokens.filter(x=>x.type==="space"),_=k.length>0&&k.some(x=>this.rules.other.anyLine.test(x.raw));c.loose=_}}if(c.loose)for(let m of c.items){m.loose=!0;for(let k of m.tokens)k.type==="text"&&(k.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:a,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Gl(e[1]),a=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===a.length){for(let d of a)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Gl(d,o.header.length).map((v,h)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[h]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Ya(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=eg(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let a=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(a);o&&(a=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?a=a.slice(1):a=a.slice(1,-1)),Hl(e,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let a=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[a.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Hl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let a=this.rules.inline.emStrongLDelim.exec(t);if(!(!a||a[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=0,h=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+i);(a=h.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o)continue;if(c=[...o].length,a[3]||a[4]){d+=c;continue}else if((a[5]||a[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let m=[...a[0]][0].length,k=t.slice(0,i+a.index+m+c);if(Math.min(i,c)%2){let x=k.slice(1,-1);return{type:"em",raw:k,text:x,tokens:this.lexer.inlineTokens(x)}}let _=k.slice(2,-2);return{type:"strong",raw:k,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return a&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let a=this.rules.inline.delLDelim.exec(t);if(a&&(!a[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...a[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(a=v.exec(e))!=null;){if(o=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!o||(c=[...o].length,c!==i))continue;if(a[3]||a[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let h=[...a[0]][0].length,m=t.slice(0,i+a.index+h+c),k=m.slice(i,-i);return{type:"del",raw:m,text:k,tokens:this.lexer.inlineTokens(k)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,a;return e[2]==="@"?(r=e[1],a="mailto:"+r):(r=e[1],a=r),{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let a,i;if(e[2]==="@")a=e[0],i="mailto:"+a;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);a=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:a,href:i,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},In=class po{constructor(e){Ue(this,"tokens");Ue(this,"options");Ue(this,"state");Ue(this,"inlineQueue");Ue(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||la,this.options.tokenizer=this.options.tokenizer||new ti,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Ft,block:zs.normal,inline:Wa.normal};this.options.pedantic?(r.block=zs.pedantic,r.inline=Wa.pedantic):this.options.gfm&&(r.block=zs.gfm,this.options.breaks?r.inline=Wa.breaks:r.inline=Wa.gfm),this.tokenizer.rules=r}static get rules(){return{block:zs,inline:Wa}}static lex(e,r){return new po(r).lex(e)}static lexInline(e,r){return new po(r).inlineTokens(e)}lex(e){e=e.replace(Ft.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let a=this.inlineQueue[r];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],a=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Ft.tabCharGlobal,"    ").replace(Ft.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(h=>(d=h.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let h=r.at(-1);d.raw.length===1&&h!==void 0?h.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let h=1/0,m=e.slice(1),k;this.options.extensions.startBlock.forEach(_=>{k=_.call({lexer:this},m),typeof k=="number"&&k>=0&&(h=Math.min(h,k))}),h<1/0&&h>=0&&(v=e.substring(0,h+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let h=r.at(-1);a&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d),a=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let h=r.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=(h.raw.endsWith(`
`)?"":`
`)+d.raw,h.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):r.push(d);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,h,m,k,_;let a=e,i=null;if(this.tokens.links){let x=Object.keys(this.tokens.links);if(x.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)x.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,i.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)o=i[2]?i[2].length:0,a=a.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);a=((h=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:h.call({lexer:this},a))??a;let c=!1,d="";for(;e;){c||(d=""),c=!1;let x;if((k=(m=this.options.extensions)==null?void 0:m.inline)!=null&&k.some(q=>(x=q.call({lexer:this},e,r))?(e=e.substring(x.raw.length),r.push(x),!0):!1))continue;if(x=this.tokenizer.escape(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.tag(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.link(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(x.raw.length);let q=r.at(-1);x.type==="text"&&(q==null?void 0:q.type)==="text"?(q.raw+=x.raw,q.text+=x.text):r.push(x);continue}if(x=this.tokenizer.emStrong(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.codespan(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.br(e)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.del(e,a,d)){e=e.substring(x.raw.length),r.push(x);continue}if(x=this.tokenizer.autolink(e)){e=e.substring(x.raw.length),r.push(x);continue}if(!this.state.inLink&&(x=this.tokenizer.url(e))){e=e.substring(x.raw.length),r.push(x);continue}let M=e;if((_=this.options.extensions)!=null&&_.startInline){let q=1/0,S=e.slice(1),K;this.options.extensions.startInline.forEach(ne=>{K=ne.call({lexer:this},S),typeof K=="number"&&K>=0&&(q=Math.min(q,K))}),q<1/0&&q>=0&&(M=e.substring(0,q+1))}if(x=this.tokenizer.inlineText(M)){e=e.substring(x.raw.length),x.raw.slice(-1)!=="_"&&(d=x.raw.slice(-1)),c=!0;let q=r.at(-1);(q==null?void 0:q.type)==="text"?(q.raw+=x.raw,q.text+=x.text):r.push(x);continue}if(e){let q="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(q);break}else throw new Error(q)}}return r}},ni=class{constructor(t){Ue(this,"options");Ue(this,"parser");this.options=t||la}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let a=(o=(e||"").match(Ft.notSpaceStart))==null?void 0:o[0],i=t.replace(Ft.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Jn(a)+'">'+(r?i:Jn(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:Jn(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,a="";for(let c=0;c<t.items.length;c++){let d=t.items[c];a+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+a+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let a="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);a+=this.tablerow({text:r})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+a+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Jn(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let a=this.parser.parseInline(r),i=Ul(t);if(i===null)return a;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+Jn(e)+'"'),o+=">"+a+"</a>",o}image({href:t,title:e,text:r,tokens:a}){a&&(r=this.parser.parseInline(a,this.parser.textRenderer));let i=Ul(t);if(i===null)return Jn(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${Jn(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Jn(t.text)}},Ko=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Pn=class ho{constructor(e){Ue(this,"options");Ue(this,"renderer");Ue(this,"textRenderer");this.options=e||la,this.options.renderer=this.options.renderer||new ni,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ko}static parse(e,r){return new ho(r).parse(e)}static parseInline(e,r){return new ho(r).parseInline(e)}parse(e){var a,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&i[c.type]){let v=c,h=this.options.extensions.renderers[v.type].call({parser:this},v);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=h||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let a="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let h=this.options.extensions.renderers[d.type].call({parser:this},d);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){a+=h||"";continue}}let v=d;switch(v.type){case"escape":{a+=r.text(v);break}case"html":{a+=r.html(v);break}case"link":{a+=r.link(v);break}case"image":{a+=r.image(v);break}case"checkbox":{a+=r.checkbox(v);break}case"strong":{a+=r.strong(v);break}case"em":{a+=r.em(v);break}case"codespan":{a+=r.codespan(v);break}case"br":{a+=r.br(v);break}case"del":{a+=r.del(v);break}case"text":{a+=r.text(v);break}default:{let h='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return a}},Us,es=(Us=class{constructor(t){Ue(this,"options");Ue(this,"block");this.options=t||la}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?In.lex:In.lexInline}provideParser(){return this.block?Pn.parse:Pn.parseInline}},Ue(Us,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ue(Us,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Us),rg=class{constructor(...t){Ue(this,"defaults",Mo());Ue(this,"options",this.setOptions);Ue(this,"parse",this.parseMarkdown(!0));Ue(this,"parseInline",this.parseMarkdown(!1));Ue(this,"Parser",Pn);Ue(this,"Renderer",ni);Ue(this,"TextRenderer",Ko);Ue(this,"Lexer",In);Ue(this,"Tokenizer",ti);Ue(this,"Hooks",es);this.use(...t)}walkTokens(t,e){var a,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let a={...r};if(a.async=this.defaults.async||a.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),a.extensions=e),r.renderer){let i=this.defaults.renderer||new ni(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...h)=>{let m=d.apply(i,h);return m===!1&&(m=v.apply(i,h)),m||""}}a.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ti(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...h)=>{let m=d.apply(i,h);return m===!1&&(m=v.apply(i,h)),m}}a.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new es;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];es.passThroughHooks.has(o)?i[c]=h=>{if(this.defaults.async&&es.passThroughHooksRespectAsync.has(o))return(async()=>{let k=await d.call(i,h);return v.call(i,k)})();let m=d.call(i,h);return v.call(i,m)}:i[c]=(...h)=>{if(this.defaults.async)return(async()=>{let k=await d.apply(i,h);return k===!1&&(k=await v.apply(i,h)),k})();let m=d.apply(i,h);return m===!1&&(m=v.apply(i,h)),m}}a.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;a.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return In.lex(t,e??this.defaults)}parser(t,e){return Pn.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let a={...r},i={...this.defaults,...a},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&a.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?In.lex:In.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let h=await(i.hooks?await i.hooks.provideParser():t?Pn.parse:Pn.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(h):h})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?In.lex:In.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Pn.parse:Pn.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Jn(r.message+"",!0)+"</pre>";return e?Promise.resolve(a):a}if(e)return Promise.reject(r);throw r}}},ia=new rg;function et(t,e){return ia.parse(t,e)}et.options=et.setOptions=function(t){return ia.setOptions(t),et.defaults=ia.defaults,wc(et.defaults),et};et.getDefaults=Mo;et.defaults=la;et.use=function(...t){return ia.use(...t),et.defaults=ia.defaults,wc(et.defaults),et};et.walkTokens=function(t,e){return ia.walkTokens(t,e)};et.parseInline=ia.parseInline;et.Parser=Pn;et.parser=Pn.parse;et.Renderer=ni;et.TextRenderer=Ko;et.Lexer=In;et.lexer=In.lex;et.Tokenizer=ti;et.Hooks=es;et.parse=et;et.options;et.setOptions;et.use;et.walkTokens;et.parseInline;Pn.parse;In.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Dc,setPrototypeOf:Wl,isFrozen:ag,getPrototypeOf:sg,getOwnPropertyDescriptor:ig}=Object;let{freeze:Kt,seal:_n,create:vo}=Object,{apply:go,construct:mo}=typeof Reflect<"u"&&Reflect;Kt||(Kt=function(e){return e});_n||(_n=function(e){return e});go||(go=function(e,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return e.apply(r,i)});mo||(mo=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return new e(...a)});const Fs=Ut(Array.prototype.forEach),og=Ut(Array.prototype.lastIndexOf),Yl=Ut(Array.prototype.pop),Va=Ut(Array.prototype.push),lg=Ut(Array.prototype.splice),Xs=Ut(String.prototype.toLowerCase),Gi=Ut(String.prototype.toString),Hi=Ut(String.prototype.match),Qa=Ut(String.prototype.replace),ug=Ut(String.prototype.indexOf),cg=Ut(String.prototype.trim),An=Ut(Object.prototype.hasOwnProperty),zt=Ut(RegExp.prototype.test),Xa=fg(TypeError);function Ut(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return go(t,e,a)}}function fg(t){return function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return mo(t,r)}}function Fe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xs;Wl&&Wl(t,null);let a=e.length;for(;a--;){let i=e[a];if(typeof i=="string"){const o=r(i);o!==i&&(ag(e)||(e[a]=o),i=o)}t[i]=!0}return t}function dg(t){for(let e=0;e<t.length;e++)An(t,e)||(t[e]=null);return t}function zn(t){const e=vo(null);for(const[r,a]of Dc(t))An(t,r)&&(Array.isArray(a)?e[r]=dg(a):a&&typeof a=="object"&&a.constructor===Object?e[r]=zn(a):e[r]=a);return e}function Za(t,e){for(;t!==null;){const a=ig(t,e);if(a){if(a.get)return Ut(a.get);if(typeof a.value=="function")return Ut(a.value)}t=sg(t)}function r(){return null}return r}const Vl=Kt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Wi=Kt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Yi=Kt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pg=Kt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Vi=Kt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),hg=Kt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ql=Kt(["#text"]),Xl=Kt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Qi=Kt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Zl=Kt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ks=Kt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vg=_n(/\{\{[\w\W]*|[\w\W]*\}\}/gm),gg=_n(/<%[\w\W]*|[\w\W]*%>/gm),mg=_n(/\$\{[\w\W]*/gm),yg=_n(/^data-[\-\w.\u00B7-\uFFFF]+$/),bg=_n(/^aria-[\-\w]+$/),Mc=_n(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),_g=_n(/^(?:\w+script|data):/i),wg=_n(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Lc=_n(/^html$/i),kg=_n(/^[a-z][.\w]*(-[.\w]+)+$/i);var $l=Object.freeze({__proto__:null,ARIA_ATTR:bg,ATTR_WHITESPACE:wg,CUSTOM_ELEMENT:kg,DATA_ATTR:yg,DOCTYPE_NAME:Lc,ERB_EXPR:gg,IS_ALLOWED_URI:Mc,IS_SCRIPT_OR_DATA:_g,MUSTACHE_EXPR:vg,TMPLIT_EXPR:mg});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},xg=function(){return typeof window>"u"?null:window},Sg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(a=r.getAttribute(i));const o="dompurify"+(a?"#"+a:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Jl=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Nc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xg();const e=Re=>Nc(Re);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const a=r,i=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:h,NamedNodeMap:m=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:k,DOMParser:_,trustedTypes:x}=t,M=v.prototype,q=Za(M,"cloneNode"),S=Za(M,"remove"),K=Za(M,"nextSibling"),ne=Za(M,"childNodes"),J=Za(M,"parentNode");if(typeof c=="function"){const Re=r.createElement("template");Re.content&&Re.content.ownerDocument&&(r=Re.content.ownerDocument)}let G,ee="";const{implementation:oe,createNodeIterator:Q,createDocumentFragment:pe,getElementsByTagName:ke}=r,{importNode:de}=a;let ve=Jl();e.isSupported=typeof Dc=="function"&&typeof J=="function"&&oe&&oe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:re,ERB_EXPR:X,TMPLIT_EXPR:he,DATA_ATTR:Z,ARIA_ATTR:ae,IS_SCRIPT_OR_DATA:ce,ATTR_WHITESPACE:W,CUSTOM_ELEMENT:te}=$l;let{IS_ALLOWED_URI:z}=$l,$=null;const _e=Fe({},[...Vl,...Wi,...Yi,...Vi,...Ql]);let Ee=null;const Le=Fe({},[...Xl,...Qi,...Zl,...Ks]);let Ae=Object.seal(vo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Xe=null,De=null;const We=Object.seal(vo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let tt=!0,xe=!0,yt=!1,Ke=!0,Bt=!1,Yn=!0,Tt=!1,Cr=!1,Ir=!1,Ln=!1,Ht=!1,Wt=!1,Et=!0,Oa=!1;const Pr="user-content-";let ua=!0,wn=!1,gt={},bt=null;const Rr=Fe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ur=null;const ca=Fe({},["audio","video","img","source","image","track"]);let cr=null;const Nn=Fe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Vn="http://www.w3.org/1998/Math/MathML",fr="http://www.w3.org/2000/svg",_t="http://www.w3.org/1999/xhtml";let Pe=_t,Qn=!1,kn=null;const fa=Fe({},[Vn,fr,_t],Gi);let we=Fe({},["mi","mo","mn","ms","mtext"]),dr=Fe({},["annotation-xml"]);const ms=Fe({},["title","style","font","a","script"]);let Xn=null;const ys=["application/xhtml+xml","text/html"],Da="text/html";let dt=null,pr=null;const hr=r.createElement("form"),Zn=function(E){return E instanceof RegExp||E instanceof Function},Or=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(pr&&pr===E)){if((!E||typeof E!="object")&&(E={}),E=zn(E),Xn=ys.indexOf(E.PARSER_MEDIA_TYPE)===-1?Da:E.PARSER_MEDIA_TYPE,dt=Xn==="application/xhtml+xml"?Gi:Xs,$=An(E,"ALLOWED_TAGS")?Fe({},E.ALLOWED_TAGS,dt):_e,Ee=An(E,"ALLOWED_ATTR")?Fe({},E.ALLOWED_ATTR,dt):Le,kn=An(E,"ALLOWED_NAMESPACES")?Fe({},E.ALLOWED_NAMESPACES,Gi):fa,cr=An(E,"ADD_URI_SAFE_ATTR")?Fe(zn(Nn),E.ADD_URI_SAFE_ATTR,dt):Nn,ur=An(E,"ADD_DATA_URI_TAGS")?Fe(zn(ca),E.ADD_DATA_URI_TAGS,dt):ca,bt=An(E,"FORBID_CONTENTS")?Fe({},E.FORBID_CONTENTS,dt):Rr,Xe=An(E,"FORBID_TAGS")?Fe({},E.FORBID_TAGS,dt):zn({}),De=An(E,"FORBID_ATTR")?Fe({},E.FORBID_ATTR,dt):zn({}),gt=An(E,"USE_PROFILES")?E.USE_PROFILES:!1,tt=E.ALLOW_ARIA_ATTR!==!1,xe=E.ALLOW_DATA_ATTR!==!1,yt=E.ALLOW_UNKNOWN_PROTOCOLS||!1,Ke=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Bt=E.SAFE_FOR_TEMPLATES||!1,Yn=E.SAFE_FOR_XML!==!1,Tt=E.WHOLE_DOCUMENT||!1,Ln=E.RETURN_DOM||!1,Ht=E.RETURN_DOM_FRAGMENT||!1,Wt=E.RETURN_TRUSTED_TYPE||!1,Ir=E.FORCE_BODY||!1,Et=E.SANITIZE_DOM!==!1,Oa=E.SANITIZE_NAMED_PROPS||!1,ua=E.KEEP_CONTENT!==!1,wn=E.IN_PLACE||!1,z=E.ALLOWED_URI_REGEXP||Mc,Pe=E.NAMESPACE||_t,we=E.MATHML_TEXT_INTEGRATION_POINTS||we,dr=E.HTML_INTEGRATION_POINTS||dr,Ae=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&Zn(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ae.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&Zn(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ae.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ae.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Bt&&(xe=!1),Ht&&(Ln=!0),gt&&($=Fe({},Ql),Ee=[],gt.html===!0&&(Fe($,Vl),Fe(Ee,Xl)),gt.svg===!0&&(Fe($,Wi),Fe(Ee,Qi),Fe(Ee,Ks)),gt.svgFilters===!0&&(Fe($,Yi),Fe(Ee,Qi),Fe(Ee,Ks)),gt.mathMl===!0&&(Fe($,Vi),Fe(Ee,Zl),Fe(Ee,Ks))),E.ADD_TAGS&&(typeof E.ADD_TAGS=="function"?We.tagCheck=E.ADD_TAGS:($===_e&&($=zn($)),Fe($,E.ADD_TAGS,dt))),E.ADD_ATTR&&(typeof E.ADD_ATTR=="function"?We.attributeCheck=E.ADD_ATTR:(Ee===Le&&(Ee=zn(Ee)),Fe(Ee,E.ADD_ATTR,dt))),E.ADD_URI_SAFE_ATTR&&Fe(cr,E.ADD_URI_SAFE_ATTR,dt),E.FORBID_CONTENTS&&(bt===Rr&&(bt=zn(bt)),Fe(bt,E.FORBID_CONTENTS,dt)),E.ADD_FORBID_CONTENTS&&(bt===Rr&&(bt=zn(bt)),Fe(bt,E.ADD_FORBID_CONTENTS,dt)),ua&&($["#text"]=!0),Tt&&Fe($,["html","head","body"]),$.table&&(Fe($,["tbody"]),delete Xe.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xa('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xa('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');G=E.TRUSTED_TYPES_POLICY,ee=G.createHTML("")}else G===void 0&&(G=Sg(x,i)),G!==null&&typeof ee=="string"&&(ee=G.createHTML(""));Kt&&Kt(E),pr=E}},Dr=Fe({},[...Wi,...Yi,...pg]),rt=Fe({},[...Vi,...hg]),mt=function(E){let ue=J(E);(!ue||!ue.tagName)&&(ue={namespaceURI:Pe,tagName:"template"});const me=Xs(E.tagName),Ze=Xs(ue.tagName);return kn[E.namespaceURI]?E.namespaceURI===fr?ue.namespaceURI===_t?me==="svg":ue.namespaceURI===Vn?me==="svg"&&(Ze==="annotation-xml"||we[Ze]):!!Dr[me]:E.namespaceURI===Vn?ue.namespaceURI===_t?me==="math":ue.namespaceURI===fr?me==="math"&&dr[Ze]:!!rt[me]:E.namespaceURI===_t?ue.namespaceURI===fr&&!dr[Ze]||ue.namespaceURI===Vn&&!we[Ze]?!1:!rt[me]&&(ms[me]||!Dr[me]):!!(Xn==="application/xhtml+xml"&&kn[E.namespaceURI]):!1},un=function(E){Va(e.removed,{element:E});try{J(E).removeChild(E)}catch{S(E)}},cn=function(E,ue){try{Va(e.removed,{attribute:ue.getAttributeNode(E),from:ue})}catch{Va(e.removed,{attribute:null,from:ue})}if(ue.removeAttribute(E),E==="is")if(Ln||Ht)try{un(ue)}catch{}else try{ue.setAttribute(E,"")}catch{}},Mr=function(E){let ue=null,me=null;if(Ir)E="<remove></remove>"+E;else{const ot=Hi(E,/^[\r\n\t ]+/);me=ot&&ot[0]}Xn==="application/xhtml+xml"&&Pe===_t&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Ze=G?G.createHTML(E):E;if(Pe===_t)try{ue=new _().parseFromString(Ze,Xn)}catch{}if(!ue||!ue.documentElement){ue=oe.createDocument(Pe,"template",null);try{ue.documentElement.innerHTML=Qn?ee:Ze}catch{}}const at=ue.body||ue.documentElement;return E&&me&&at.insertBefore(r.createTextNode(me),at.childNodes[0]||null),Pe===_t?ke.call(ue,Tt?"html":"body")[0]:Tt?ue.documentElement:at},Lr=function(E){return Q.call(E.ownerDocument||E,E,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Ma=function(E){return E instanceof k&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof m)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},xn=function(E){return typeof d=="function"&&E instanceof d};function Lt(Re,E,ue){Fs(Re,me=>{me.call(e,E,ue,pr)})}const Sn=function(E){let ue=null;if(Lt(ve.beforeSanitizeElements,E,null),Ma(E))return un(E),!0;const me=dt(E.nodeName);if(Lt(ve.uponSanitizeElement,E,{tagName:me,allowedTags:$}),Yn&&E.hasChildNodes()&&!xn(E.firstElementChild)&&zt(/<[/\w!]/g,E.innerHTML)&&zt(/<[/\w!]/g,E.textContent)||E.nodeType===$a.progressingInstruction||Yn&&E.nodeType===$a.comment&&zt(/<[/\w]/g,E.data))return un(E),!0;if(!(We.tagCheck instanceof Function&&We.tagCheck(me))&&(!$[me]||Xe[me])){if(!Xe[me]&&bs(me)&&(Ae.tagNameCheck instanceof RegExp&&zt(Ae.tagNameCheck,me)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(me)))return!1;if(ua&&!bt[me]){const Ze=J(E)||E.parentNode,at=ne(E)||E.childNodes;if(at&&Ze){const ot=at.length;for(let pt=ot-1;pt>=0;--pt){const Yt=q(at[pt],!0);Yt.__removalCount=(E.__removalCount||0)+1,Ze.insertBefore(Yt,K(E))}}}return un(E),!0}return E instanceof v&&!mt(E)||(me==="noscript"||me==="noembed"||me==="noframes")&&zt(/<\/no(script|embed|frames)/i,E.innerHTML)?(un(E),!0):(Bt&&E.nodeType===$a.text&&(ue=E.textContent,Fs([re,X,he],Ze=>{ue=Qa(ue,Ze," ")}),E.textContent!==ue&&(Va(e.removed,{element:E.cloneNode()}),E.textContent=ue)),Lt(ve.afterSanitizeElements,E,null),!1)},Nr=function(E,ue,me){if(Et&&(ue==="id"||ue==="name")&&(me in r||me in hr))return!1;if(!(xe&&!De[ue]&&zt(Z,ue))){if(!(tt&&zt(ae,ue))){if(!(We.attributeCheck instanceof Function&&We.attributeCheck(ue,E))){if(!Ee[ue]||De[ue]){if(!(bs(E)&&(Ae.tagNameCheck instanceof RegExp&&zt(Ae.tagNameCheck,E)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(E))&&(Ae.attributeNameCheck instanceof RegExp&&zt(Ae.attributeNameCheck,ue)||Ae.attributeNameCheck instanceof Function&&Ae.attributeNameCheck(ue,E))||ue==="is"&&Ae.allowCustomizedBuiltInElements&&(Ae.tagNameCheck instanceof RegExp&&zt(Ae.tagNameCheck,me)||Ae.tagNameCheck instanceof Function&&Ae.tagNameCheck(me))))return!1}else if(!cr[ue]){if(!zt(z,Qa(me,W,""))){if(!((ue==="src"||ue==="xlink:href"||ue==="href")&&E!=="script"&&ug(me,"data:")===0&&ur[E])){if(!(yt&&!zt(ce,Qa(me,W,"")))){if(me)return!1}}}}}}}return!0},bs=function(E){return E!=="annotation-xml"&&Hi(E,te)},Tn=function(E){Lt(ve.beforeSanitizeAttributes,E,null);const{attributes:ue}=E;if(!ue||Ma(E))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ee,forceKeepAttr:void 0};let Ze=ue.length;for(;Ze--;){const at=ue[Ze],{name:ot,namespaceURI:pt,value:Yt}=at,qn=dt(ot),qr=Yt;let it=ot==="value"?qr:cg(qr);if(me.attrName=qn,me.attrValue=it,me.keepAttr=!0,me.forceKeepAttr=void 0,Lt(ve.uponSanitizeAttribute,E,me),it=me.attrValue,Oa&&(qn==="id"||qn==="name")&&(cn(ot,E),it=Pr+it),Yn&&zt(/((--!?|])>)|<\/(style|title|textarea)/i,it)){cn(ot,E);continue}if(qn==="attributename"&&Hi(it,"href")){cn(ot,E);continue}if(me.forceKeepAttr)continue;if(!me.keepAttr){cn(ot,E);continue}if(!Ke&&zt(/\/>/i,it)){cn(ot,E);continue}Bt&&Fs([re,X,he],jr=>{it=Qa(it,jr," ")});const La=dt(E.nodeName);if(!Nr(La,qn,it)){cn(ot,E);continue}if(G&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!pt)switch(x.getAttributeType(La,qn)){case"TrustedHTML":{it=G.createHTML(it);break}case"TrustedScriptURL":{it=G.createScriptURL(it);break}}if(it!==qr)try{pt?E.setAttributeNS(pt,ot,it):E.setAttribute(ot,it),Ma(E)?un(E):Yl(e.removed)}catch{cn(ot,E)}}Lt(ve.afterSanitizeAttributes,E,null)},_s=function Re(E){let ue=null;const me=Lr(E);for(Lt(ve.beforeSanitizeShadowDOM,E,null);ue=me.nextNode();)Lt(ve.uponSanitizeShadowNode,ue,null),Sn(ue),Tn(ue),ue.content instanceof o&&Re(ue.content);Lt(ve.afterSanitizeShadowDOM,E,null)};return e.sanitize=function(Re){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=null,me=null,Ze=null,at=null;if(Qn=!Re,Qn&&(Re="<!-->"),typeof Re!="string"&&!xn(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Xa("dirty is not a string, aborting")}else throw Xa("toString is not a function");if(!e.isSupported)return Re;if(Cr||Or(E),e.removed=[],typeof Re=="string"&&(wn=!1),wn){if(Re.nodeName){const Yt=dt(Re.nodeName);if(!$[Yt]||Xe[Yt])throw Xa("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof d)ue=Mr("<!---->"),me=ue.ownerDocument.importNode(Re,!0),me.nodeType===$a.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?ue=me:ue.appendChild(me);else{if(!Ln&&!Bt&&!Tt&&Re.indexOf("<")===-1)return G&&Wt?G.createHTML(Re):Re;if(ue=Mr(Re),!ue)return Ln?null:Wt?ee:""}ue&&Ir&&un(ue.firstChild);const ot=Lr(wn?Re:ue);for(;Ze=ot.nextNode();)Sn(Ze),Tn(Ze),Ze.content instanceof o&&_s(Ze.content);if(wn)return Re;if(Ln){if(Ht)for(at=pe.call(ue.ownerDocument);ue.firstChild;)at.appendChild(ue.firstChild);else at=ue;return(Ee.shadowroot||Ee.shadowrootmode)&&(at=de.call(a,at,!0)),at}let pt=Tt?ue.outerHTML:ue.innerHTML;return Tt&&$["!doctype"]&&ue.ownerDocument&&ue.ownerDocument.doctype&&ue.ownerDocument.doctype.name&&zt(Lc,ue.ownerDocument.doctype.name)&&(pt="<!DOCTYPE "+ue.ownerDocument.doctype.name+`>
`+pt),Bt&&Fs([re,X,he],Yt=>{pt=Qa(pt,Yt," ")}),G&&Wt?G.createHTML(pt):pt},e.setConfig=function(){let Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Or(Re),Cr=!0},e.clearConfig=function(){pr=null,Cr=!1},e.isValidAttribute=function(Re,E,ue){pr||Or({});const me=dt(Re),Ze=dt(E);return Nr(me,Ze,ue)},e.addHook=function(Re,E){typeof E=="function"&&Va(ve[Re],E)},e.removeHook=function(Re,E){if(E!==void 0){const ue=og(ve[Re],E);return ue===-1?void 0:lg(ve[Re],ue,1)[0]}return Yl(ve[Re])},e.removeHooks=function(Re){ve[Re]=[]},e.removeAllHooks=function(){ve=Jl()},e}var Tg=Nc();function Eg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${eu(t.from)} |`),e.push(`| **To** | ${eu(t.to)} |`),e.push(`| **Date** | ${Do(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?Ag(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function eu(t){return(t||"").replace(/\|/g,"\\|")}function Ag(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return yo(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Cg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),a=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||a>0&&a<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function yo(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return Cg(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(yo).join(""),a=r.trim();if(!a&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${a}

`;if(e==="blockquote")return`

> ${a.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${a}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${a}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?a:a===o?o:`[${a}](${o})`}if(e==="strong"||e==="b")return`**${a}**`;if(e==="em"||e==="i")return`*${a}*`;if(e==="code")return`\`${a}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>yo(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function Ig(t){const e=Pg(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.md`}function Pg(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}function tu(t,e,r="text/markdown;charset=utf-8"){const a=new Blob([t],{type:r}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Rg(t){return t.raw||null}function Og(t){const e=Rg(t);return e?JSON.stringify(e,null,2):"null"}function Dg(t){const e=Mg(t.date),r=(t.subject||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"");return`${e}_${r}.json`}function Mg(t){try{const e=new Date(t),r=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}catch{return"email"}}var Lg=Y('<button title="View as Markdown">.md</button>'),Ng=Y('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),qg=Y('<pre class="md-raw svelte-1b0rzpb"> </pre>'),jg=Y('<div class="md-preview svelte-1b0rzpb"><!></div>'),Bg=Y('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),zg=Y('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Fg=Y('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Kg=Y('<pre class="message-text svelte-1b0rzpb"> </pre>'),Ug=Y('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),Gg=Y('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),Hg=Y('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function Wg(t,e){ut(e,!0);let r=Me(e,"loading",3,!1);Mt(()=>ln("MessageModal"));const a=new et.Renderer;a.link=({href:re,title:X,text:he})=>{const Z=X?` title="${X}"`:"";return`<a href="${re}"${Z} target="_blank" rel="noopener">${he}</a>`},et.setOptions({breaks:!0,gfm:!0,renderer:a});let i=Oe("email"),o=kt(()=>e.message.body?Eg(e.message):""),c=kt(()=>Og(e.message)),d=Oe("raw");function v(re){F(i,b(i)===re?"email":re,!0),re==="markdown"&&F(d,"raw")}function h(){tu(b(o),Ig(e.message))}function m(){tu(b(c),Dg(e.message),"application/json;charset=utf-8")}function k(re){const X=et.parse(re);return Tg.sanitize(X,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let _=Oe(null);$s(()=>{var re;if(b(_)&&e.message.htmlBody&&!r()&&b(i)==="email"){const X=b(_).contentDocument||((re=b(_).contentWindow)==null?void 0:re.document);X&&(X.open(),X.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),X.close())}});var x=Hg();x.__click=function(...re){var X;(X=e.onclose)==null||X.apply(this,re)};var M=w(x);M.__click=re=>re.stopPropagation();var q=w(M),S=w(q),K=w(S),ne=D(S,2),J=w(ne);let G;J.__click=()=>v("json");var ee=D(J,2);{var oe=re=>{var X=Lg();let he;X.__click=()=>v("markdown"),ge(()=>he=rn(X,1,"action-btn svelte-1b0rzpb",null,he,{active:b(i)==="markdown"})),U(re,X)};Se(ee,re=>{e.message.body&&re(oe)})}var Q=D(ee,2);Q.__click=function(...re){var X;(X=e.onclose)==null||X.apply(this,re)};var pe=D(q,2);{var ke=re=>{var X=Ng(),he=Pt(X),Z=D(w(he),2);Z.__click=m;var ae=D(he,2),ce=w(ae),W=w(ce);ge(()=>se(W,b(c))),U(re,X)},de=re=>{var X=Bg(),he=Pt(X),Z=w(he),ae=w(Z);let ce;ae.__click=()=>F(d,"raw");var W=D(ae,2);let te;W.__click=()=>F(d,"preview");var z=D(Z,2);z.__click=h;var $=D(he,2),_e=w($);{var Ee=Ae=>{var Xe=qg(),De=w(Xe);ge(()=>se(De,b(o))),U(Ae,Xe)},Le=Ae=>{var Xe=jg(),De=w(Xe);Cd(De,()=>k(b(o))),U(Ae,Xe)};Se(_e,Ae=>{b(d)==="raw"?Ae(Ee):Ae(Le,!1)})}ge(()=>{ce=rn(ae,1,"md-tab svelte-1b0rzpb",null,ce,{active:b(d)==="raw"}),te=rn(W,1,"md-tab svelte-1b0rzpb",null,te,{active:b(d)==="preview"})}),U(re,X)},ve=re=>{var X=Gg(),he=Pt(X),Z=w(he),ae=D(w(Z),2),ce=w(ae),W=D(Z,2),te=D(w(W),2),z=w(te),$=D(W,2),_e=D(w($),2),Ee=w(_e),Le=D(he,2),Ae=w(Le);{var Xe=xe=>{var yt=zg();U(xe,yt)},De=xe=>{var yt=Fg();rc(yt,Ke=>F(_,Ke),()=>b(_)),U(xe,yt)},We=xe=>{var yt=Kg(),Ke=w(yt);ge(()=>se(Ke,e.message.body)),U(xe,yt)},tt=xe=>{var yt=Ug();U(xe,yt)};Se(Ae,xe=>{r()?xe(Xe):e.message.htmlBody?xe(De,1):e.message.body?xe(We,2):xe(tt,!1)})}ge(xe=>{se(ce,e.message.from),se(z,e.message.to),se(Ee,xe)},[()=>Do(e.message.date)]),U(re,X)};Se(pe,re=>{b(i)==="json"?re(ke):b(i)==="markdown"?re(de,1):re(ve,!1)})}ge(()=>{se(K,e.message.subject),G=rn(J,1,"action-btn svelte-1b0rzpb",null,G,{active:b(i)==="json"})}),U(t,x),ct()}Gt(["click"]);var Yg=Y('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),Vg=Y('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),Qg=Y('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),Xg=Y("<p> </p>"),Zg=Y('<p>No emails in local storage. Click "Sync New" to download.</p>'),$g=Y('<div class="empty-state svelte-6ts5xm"><!></div>'),Jg=Y('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),em=Y('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function tm(t,e){ut(e,!0),Mt(()=>ln("DashboardView"));let r=Me(e,"error",3,null),a=Me(e,"profile",3,null),i=Me(e,"loadingProfile",3,!1),o=Me(e,"emailMessages",19,()=>[]),c=Me(e,"totalLocalMessages",3,0),d=Me(e,"hasMoreLocal",3,!1),v=Me(e,"loadingMessages",3,!1),h=Me(e,"selectedMessage",3,null),m=Me(e,"syncStatus",3,null),k=Me(e,"syncProgress",3,null),_=Me(e,"isSyncing",3,!1),x=Me(e,"searchQuery",15);var M=em(),q=Pt(M),S=w(q);{var K=Z=>{yc(Z,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Se(S,Z=>{r()&&Z(K)})}var ne=D(S,2);$h(ne,{get profile(){return a()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var J=D(ne,2);fv(J,{get syncStatus(){return m()},get syncProgress(){return k()},get isSyncing(){return _()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var G=D(J,2),ee=w(G);ee.__keydown=Z=>Z.key==="Enter"&&e.onsearch();var oe=D(ee,2);oe.__click=function(...Z){var ae;(ae=e.onsearch)==null||ae.apply(this,Z)};var Q=w(oe),pe=D(G,2);{var ke=Z=>{var ae=Vg(),ce=Pt(ae),W=w(ce),te=w(W),z=D(ce,2);hv(z,{get messages(){return o()},get onselect(){return e.onviewmessage}});var $=D(z,2);{var _e=Ee=>{var Le=Yg(),Ae=w(Le);Ae.__click=function(...De){var We;(We=e.onloadmore)==null||We.apply(this,De)};var Xe=w(Ae);ge(()=>{Ae.disabled=v(),se(Xe,v()?"Loading...":"Load More")}),U(Ee,Le)};Se($,Ee=>{d()&&Ee(_e)})}ge(Ee=>se(te,`Showing ${o().length??""} of ${Ee??""}
        ${x()?" matching":""} emails`),[()=>c().toLocaleString()]),U(Z,ae)},de=Z=>{var ae=Qg();U(Z,ae)},ve=Z=>{var ae=$g(),ce=w(ae);{var W=z=>{var $=Xg(),_e=w($);ge(()=>se(_e,`No emails match "${x()??""}".`)),U(z,$)},te=z=>{var $=Zg();U(z,$)};Se(ce,z=>{x()?z(W):z(te,!1)})}U(Z,ae)},re=Z=>{var ae=Jg();U(Z,ae)};Se(pe,Z=>{var ae;o().length>0?Z(ke):v()?Z(de,1):(ae=m())!=null&&ae.synced?Z(ve,2):Z(re,!1)})}var X=D(q,2);{var he=Z=>{Wg(Z,{get message(){return h()},loading:!1,get onclose(){return e.onclosedetail}})};Se(X,Z=>{h()&&Z(he)})}ge(()=>{oe.disabled=v(),se(Q,v()?"Searching...":"Search")}),ui(ee,x),U(t,M),ct()}Gt(["keydown","click"]);var nm=Y('<div class="dashboard svelte-1q5o2lv"><!></div>');function rm(t,e){ut(e,!0);function r(De){De.key==="Escape"&&b(v)&&ce()}Mt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let a=Oe(It(localStorage.getItem("googleClientId")||"")),i=Oe(It(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),h=Oe(""),m=Oe(It([])),k=Oe(0),_=Oe(0),x=Oe(!1),M=Oe(!1),q=Oe(!1),S=Oe(null),K=Oe(null),ne=Oe(null),J=Oe(!1);const G=50;$s(()=>{b(c)&&(W(),X())});let ee=kt(()=>!b(a)),oe=kt(()=>!!b(c)),Q=kt(()=>b(m).length<b(k));$s(()=>{b(a)&&!b(o)&&jl(b(a)).then(()=>{F(o,!0)}).catch(De=>{F(S,`Auth init failed: ${De.message}`)})});function pe(){const De=b(i).trim();De&&(localStorage.setItem("googleClientId",De),F(a,De,!0),F(S,null))}function ke(){localStorage.removeItem("googleClientId"),F(a,""),F(i,""),F(o,!1),F(c,null),F(d,null),F(m,[],!0),F(k,0)}async function de(){F(S,null),F(M,!0);try{b(o)||(await jl(b(a)),F(o,!0));const De=await _h();F(c,De.access_token,!0),await re()}catch(De){F(S,De.message,!0)}finally{F(M,!1)}}async function ve(){if(b(c))try{await wh(b(c))}catch{}F(c,null),F(d,null),F(m,[],!0),F(k,0),F(v,null),F(S,null)}async function re(){F(q,!0);try{const De=await cc(b(c));if(!b(c))return;F(d,De,!0)}catch(De){if(!b(c))return;F(S,`Profile fetch failed: ${De.message}`)}finally{F(q,!1)}}async function X(De=!1){F(x,!0);try{const We=De?b(_):0,tt=await Jd({query:b(h)||void 0,limit:G,offset:We});De?F(m,[...b(m),...tt.items],!0):F(m,tt.items,!0),F(k,tt.total,!0),F(_,b(m).length,!0)}catch(We){F(S,`Failed to load messages: ${We.message}`)}finally{F(x,!1)}}function he(){F(_,0),X(!1)}function Z(){X(!0)}function ae(De){F(v,De,!0)}function ce(){F(v,null)}async function W(){try{F(K,await Ph(),!0)}catch{}}async function te(De){if(b(J)||!b(c))return;F(S,null),F(J,!0),F(ne,null);const We=new AbortController;try{await Ch(b(c),{limit:De,onProgress:tt=>{F(ne,{...tt},!0)},signal:We.signal}),await W(),await X(!1)}catch(tt){if(tt.name!=="AbortError"){if(!b(c))return;F(S,`Sync failed: ${tt.message}`)}}finally{F(J,!1)}}async function z(De){if(b(J)||!b(c))return;F(S,null),F(J,!0),F(ne,null);const We=new AbortController;try{await Ih(b(c),{limit:De,onProgress:tt=>{F(ne,{...tt},!0)},signal:We.signal}),await W(),await X(!1)}catch(tt){if(tt.name!=="AbortError"){if(!b(c))return;F(S,`Sync more failed: ${tt.message}`)}}finally{F(J,!1)}}async function $(){try{await Rh(),await W(),F(m,[],!0),F(k,0),F(_,0)}catch(De){F(S,`Failed to clear data: ${De.message}`)}}var _e=nm(),Ee=w(_e);{var Le=De=>{qh(De,{onsave:pe,get clientIdInput(){return b(i)},set clientIdInput(We){F(i,We,!0)}})},Ae=De=>{Vh(De,{get clientId(){return b(a)},get error(){return b(S)},get loadingAuth(){return b(M)},onsignin:de,onclear:ke,onsignout:ve})},Xe=De=>{tm(De,{get error(){return b(S)},get profile(){return b(d)},get loadingProfile(){return b(q)},get emailMessages(){return b(m)},get totalLocalMessages(){return b(k)},get hasMoreLocal(){return b(Q)},get loadingMessages(){return b(x)},get selectedMessage(){return b(v)},get syncStatus(){return b(K)},get syncProgress(){return b(ne)},get isSyncing(){return b(J)},onsignout:ve,onsearch:he,onloadmore:Z,onviewmessage:ae,onclosedetail:ce,ondismisserror:()=>F(S,null),onsync:te,onsyncmore:z,oncleardata:$,get searchQuery(){return b(h)},set searchQuery(We){F(h,We,!0)}})};Se(Ee,De=>{b(ee)?De(Le):b(oe)?De(Xe,!1):De(Ae,1)})}U(t,_e),ct()}var am=Y('<span class="spinner svelte-ois7em"></span>'),sm=Ro('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),im=Y('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),om=Y('<option class="svelte-ois7em"> </option>'),lm=Y('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),um=Y('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),cm=Y('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function fm(t,e){ut(e,!0);let r=Me(e,"engineStatus",3,"idle"),a=Me(e,"modelName",3,""),i=Me(e,"isScanning",3,!1),o=Me(e,"scanProgress",3,null),c=Me(e,"scanCount",15,20),d=Me(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function h(){return r()==="ready"?`${a()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function m(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function k(){return r()==="ready"&&!i()}var _=cm(),x=w(_),M=w(x),q=w(M);{var S=z=>{var $=am();U(z,$)},K=z=>{var $=sm();U(z,$)};Se(q,z=>{i()?z(S):z(K,!1)})}var ne=D(M,2),J=D(w(ne),2),G=w(J);let ee;var oe=D(G),Q=D(x,2);{var pe=z=>{var $=im(),_e=w($),Ee=w(_e),Le=D(_e,4),Ae=w(Le),Xe=D(Le,4),De=w(Xe);ge(()=>{se(Ee,`${d().totalEmails??""} emails in storage`),se(Ae,`${d().classified??""} classified`),se(De,`${d().unclassified??""} new`)}),U(z,$)};Se(Q,z=>{d()&&z(pe)})}var ke=D(Q,2),de=w(ke),ve=D(w(de),2);on(ve,21,()=>v,Ar,(z,$)=>{var _e=om(),Ee=w(_e),Le={};ge(()=>{se(Ee,b($).label),Le!==(Le=b($).value)&&(_e.value=(_e.__value=b($).value)??"")}),U(z,_e)});var re=D(de,2),X=w(re);X.__click=function(...z){var $;($=e.onscan)==null||$.apply(this,z)};var he=w(X),Z=D(X,2);Z.__click=function(...z){var $;($=e.onrescan)==null||$.apply(this,z)};var ae=D(ke,2);{var ce=z=>{var $=lm();U(z,$)};Se(ae,z=>{r()!=="ready"&&r()!=="loading"&&z(ce)})}var W=D(ae,2);{var te=z=>{var $=um(),_e=w($),Ee=w(_e);let Le,Ae;var Xe=D(_e,2),De=w(Xe);ge(()=>{Le=rn(Ee,1,"progress-fill svelte-ois7em",null,Le,{indeterminate:!o().total}),Ae=yn(Ee,"",Ae,{width:`${o().total?o().current/o().total*100:0}%`}),se(De,o().message||"Scanning...")}),U(z,$)};Se(W,z=>{i()&&o()&&z(te)})}ge((z,$,_e,Ee)=>{ee=yn(G,"",ee,z),se(oe,` ${$??""}`),ve.disabled=i(),X.disabled=_e,se(he,i()?"Scanning...":"Scan New"),Z.disabled=Ee},[()=>({background:m()}),h,()=>!k(),()=>!k()]),Oo(ve,c),U(t,_),ct()}Gt(["click"]);var dm=Y('<span class="row-date svelte-1czytqk"> </span>'),pm=Y('<span class="tag svelte-1czytqk"> </span>'),hm=Y('<span class="row-tags svelte-1czytqk"></span>'),vm=Y('<span class="row-reason svelte-1czytqk"> </span>'),gm=Y('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),mm=Y('<span class="status-label svelte-1czytqk"> </span>'),ym=Y('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),bm=Y('<p class="summary-reason svelte-1czytqk"> </p>'),_m=Y('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),wm=Y('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function nu(t,e){ut(e,!0);let r=Me(e,"actionColor",3,"#666"),a=Me(e,"dimmed",3,!1);function i(Z){if(!Z)return"";try{return new Date(Z).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=kt(()=>e.item.status==="pending"),c=Oe(!1);var d=wm(),v=Pt(d);let h;var m=w(v);m.__click=()=>F(c,!b(c));let k;var _=w(m),x=w(_),M=D(_,2),q=w(M),S=w(q),K=D(q,2);{var ne=Z=>{var ae=dm(),ce=w(ae);ge(W=>se(ce,W),[()=>i(e.item.date)]),U(Z,ae)};Se(K,Z=>{e.item.date&&Z(ne)})}var J=D(M,2);{var G=Z=>{var ae=hm();on(ae,21,()=>e.item.tags,Ar,(ce,W)=>{var te=pm();let z;var $=w(te);ge(_e=>{z=yn(te,"",z,_e),se($,b(W))},[()=>({background:Gp(b(W))})]),U(ce,te)}),U(Z,ae)};Se(J,Z=>{e.item.tags&&e.item.tags.length>0&&Z(G)})}var ee=D(J,2);{var oe=Z=>{var ae=vm(),ce=w(ae);ge(()=>se(ce,e.item.reason)),U(Z,ae)};Se(ee,Z=>{e.item.reason&&!b(c)&&Z(oe)})}var Q=D(m,2),pe=w(Q);{var ke=Z=>{var ae=gm(),ce=Pt(ae);ce.__click=()=>e.onmarkacted(e.item.emailId);var W=D(ce,2);W.__click=()=>e.ondismiss(e.item.emailId),U(Z,ae)},de=Z=>{var ae=mm(),ce=w(ae);ge(()=>se(ce,e.item.status)),U(Z,ae)};Se(pe,Z=>{b(o)?Z(ke):Z(de,!1)})}var ve=D(pe,2);{var re=Z=>{var ae=ym();ae.__click=()=>e.onremove(e.item.emailId),U(Z,ae)};Se(ve,Z=>{e.onremove&&Z(re)})}var X=D(v,2);{var he=Z=>{var ae=_m();let ce;var W=w(ae),te=w(W),z=D(W,2);{var $=_e=>{var Ee=bm(),Le=w(Ee);ge(()=>se(Le,e.item.reason)),U(_e,Ee)};Se(z,_e=>{e.item.reason&&_e($)})}ge(()=>{ce=yn(ae,"",ce,{"border-left-color":r()}),se(te,e.item.summary)}),U(Z,ae)};Se(X,Z=>{b(c)&&e.item.summary&&Z(he)})}ge(()=>{h=rn(v,1,"email-row svelte-1czytqk",null,h,{dimmed:a()}),k=yn(m,"",k,{"border-left-color":r()}),se(x,e.item.subject),se(S,e.item.from)}),U(t,d),ct()}Gt(["click"]);var km=Y('<span class="group-acted svelte-tl1unp"> </span>'),xm=Y('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Sm=Y('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Tm=Y('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Em=Y('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Am=Y('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),Cm=Y('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function Im(t,e){ut(e,!0);let r=Me(e,"color",3,"#888");Me(e,"count",3,0);let a=Me(e,"items",19,()=>[]),i=Me(e,"expanded",3,!1),o=kt(()=>a().filter(oe=>oe.status==="pending")),c=kt(()=>a().filter(oe=>oe.status!=="pending")),d=Oe(!1);function v(oe){return oe.split("_").map(Q=>Q.charAt(0)+Q.slice(1).toLowerCase()).join(" ")}var h=Cm(),m=w(h);m.__click=function(...oe){var Q;(Q=e.ontoggle)==null||Q.apply(this,oe)};var k=w(m);let _;var x=w(k),M=D(k,2),q=w(M),S=D(M,2);{var K=oe=>{var Q=km(),pe=w(Q);ge(()=>se(pe,`${b(c).length??""} handled`)),U(oe,Q)};Se(S,oe=>{b(c).length>0&&oe(K)})}var ne=D(S,4);let J;var G=D(m,2);{var ee=oe=>{var Q=Am(),pe=w(Q);{var ke=ce=>{var W=xm();U(ce,W)};Se(pe,ce=>{b(o).length===0&&b(c).length===0&&ce(ke)})}var de=D(pe,2);on(de,17,()=>b(o),ce=>ce.emailId,(ce,W)=>{nu(ce,{get item(){return b(W)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ve=D(de,2);{var re=ce=>{var W=Sm(),te=w(W),z=w(te),$=D(te,2);on($,17,()=>b(c),_e=>_e.emailId,(_e,Ee)=>{nu(_e,{get item(){return b(Ee)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ge(()=>se(z,`${b(c).length??""} handled`)),U(ce,W)};Se(ve,ce=>{b(c).length>0&&ce(re)})}var X=D(ve,2),he=w(X);{var Z=ce=>{var W=Tm();W.__click=()=>F(d,!0),U(ce,W)},ae=ce=>{var W=Em(),te=w(W),z=D(te);z.__click=()=>F(d,!1);var $=D(z,2);$.__click=()=>{e.oncleargroup(),F(d,!1)},ge(()=>se(te,`Clear ${a().length??""} items? `)),U(ce,W)};Se(he,ce=>{b(d)?ce(ae,!1):ce(Z)})}U(oe,Q)};Se(G,oe=>{i()&&oe(ee)})}ge(oe=>{_=yn(k,"",_,{background:r()}),se(x,oe),se(q,b(o).length),J=rn(ne,0,"chevron svelte-tl1unp",null,J,{open:i()})},[()=>v(e.action)]),U(t,h),ct()}Gt(["click"]);var Pm=Y('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),Rm=Y('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Om=Y('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Dm=Y('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Mm=Y('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Lm=Y('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Nm(t,e){ut(e,!0);let r=Me(e,"groups",19,()=>({})),a=Me(e,"groupOrder",19,()=>[]),i=Me(e,"counts",19,()=>({})),o=Me(e,"stats",3,null),c=Me(e,"expandedGroup",3,null),d=Me(e,"isScanning",3,!1),v=Me(e,"scanProgress",3,null),h=Me(e,"scanCount",15,20),m=Me(e,"error",3,null),k=Oe(!1);var _=Lm(),x=w(_);fm(x,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return h()},set scanCount(J){h(J)}});var M=D(x,2);{var q=J=>{var G=Pm(),ee=w(G),oe=w(ee),Q=D(ee,2);Q.__click=function(...pe){var ke;(ke=e.ondismisserror)==null||ke.apply(this,pe)},ge(()=>se(oe,m())),U(J,G)};Se(M,J=>{m()&&J(q)})}var S=D(M,2);{var K=J=>{var G=Dm(),ee=Pt(G);on(ee,20,a,re=>re,(re,X)=>{{let he=kt(()=>uc(X)),Z=kt(()=>{var W;return((W=r()[X])==null?void 0:W.length)||0}),ae=kt(()=>r()[X]||[]),ce=kt(()=>c()===X);Im(re,{get action(){return X},get color(){return b(he)},get count(){return b(Z)},get items(){return b(ae)},get expanded(){return b(ce)},ontoggle:()=>e.ontogglegroup(X),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(X)})}});var oe=D(ee,2),Q=w(oe),pe=w(Q),ke=D(Q,2);{var de=re=>{var X=Rm();X.__click=()=>F(k,!0),U(re,X)},ve=re=>{var X=Om(),he=D(w(X));he.__click=()=>F(k,!1);var Z=D(he,2);Z.__click=()=>{e.onclear(),F(k,!1)},U(re,X)};Se(ke,re=>{b(k)?re(ve,!1):re(de)})}ge(()=>se(pe,`${i().total??""} emails classified into ${a().length??""} groups`)),U(J,G)},ne=J=>{var G=Mm();U(J,G)};Se(S,J=>{i().total>0?J(K):d()||J(ne,1)})}U(t,_),ct()}Gt(["click"]);var qm=Y('<div class="actions-page svelte-3tch4q"><!></div>');function jm(t,e){ut(e,!0);const r=ac();let a=Oe(It(r.status)),i=Oe(""),o=Oe(It({})),c=Oe(It([])),d=Oe(It({total:0})),v=Oe(null),h=Oe(null),m=Oe(!1),k=Oe(null),_=Oe(20),x=Oe(null);Mt(()=>{const de=r.onMessage(ve=>{if(ve.status==="ready"){F(a,"ready");const re=os.find(X=>X.id===r.modelId);F(i,(re==null?void 0:re.name)||r.modelId||"",!0)}ve.status==="loading"&&F(a,"loading")});if(F(a,r.status,!0),r.modelId){const ve=os.find(re=>re.id===r.modelId);F(i,(ve==null?void 0:ve.name)||r.modelId||"",!0)}return M(),()=>de()});async function M(){try{const de=await Mp();F(o,de.groups,!0),F(c,de.order,!0),F(d,await Lp(),!0),F(v,await Bp(),!0)}catch(de){F(x,`Failed to load data: ${de.message}`)}}async function q(){await K(!1)}async function S(){await K(!0)}async function K(de){if(!(b(m)||!r.isReady)){F(x,null),F(m,!0),F(k,null);try{await Dp(r,{count:b(_),force:de,onProgress:ve=>{F(k,{...ve},!0)}}),await M()}catch(ve){F(x,`Scan failed: ${ve.message}`)}finally{F(m,!1)}}}async function ne(de){await Nl(de,"acted"),await M()}async function J(de){await Nl(de,"dismissed"),await M()}async function G(de){await jp(de),await M()}async function ee(de){await qp(de),await M()}async function oe(){await Np(),await M()}function Q(de){F(h,b(h)===de?null:de,!0)}var pe=qm(),ke=w(pe);Nm(ke,{get engineStatus(){return b(a)},get modelName(){return b(i)},get groups(){return b(o)},get groupOrder(){return b(c)},get counts(){return b(d)},get stats(){return b(v)},get expandedGroup(){return b(h)},get isScanning(){return b(m)},get scanProgress(){return b(k)},get error(){return b(x)},onscan:q,onrescan:S,ontogglegroup:Q,onmarkacted:ne,ondismiss:J,onremove:G,oncleargroup:ee,onclear:oe,ondismisserror:()=>F(x,null),get scanCount(){return b(_)},set scanCount(de){F(_,de,!0)}}),U(t,pe),ct()}var Bm=Y('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function zm(t,e){ut(e,!0);function r(){const Q=location.hash;return Q==="#dashboard"?"dashboard":Q==="#actions"?"actions":"chat"}let a=Oe(It(r()));Mt(()=>{function Q(){F(a,r(),!0)}return window.addEventListener("hashchange",Q),()=>window.removeEventListener("hashchange",Q)});var i=Bm(),o=w(i),c=D(w(o),2),d=w(c);let v;var h=D(d,2);let m;var k=D(h,2);let _;var x=D(o,2),M=w(x);let q;var S=w(M);mh(S,{});var K=D(M,2);let ne;var J=w(K);jm(J,{});var G=D(K,2);let ee;var oe=w(G);rm(oe,{}),ge(()=>{v=rn(d,1,"svelte-1n46o8q",null,v,{active:b(a)==="chat"}),m=rn(h,1,"svelte-1n46o8q",null,m,{active:b(a)==="actions"}),_=rn(k,1,"svelte-1n46o8q",null,_,{active:b(a)==="dashboard"}),q=yn(M,"",q,{display:b(a)==="chat"?"flex":"none"}),ne=yn(K,"",ne,{display:b(a)==="actions"?"flex":"none"}),ee=yn(G,"",ee,{display:b(a)==="dashboard"?"flex":"none"})}),U(t,i),ct()}wd(zm,{target:document.getElementById("app")});
