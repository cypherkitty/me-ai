var pf=Object.defineProperty;var kl=t=>{throw TypeError(t)};var vf=(t,e,r)=>e in t?pf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ye=(t,e,r)=>vf(t,typeof e!="symbol"?e+"":e,r),ji=(t,e,r)=>e.has(t)||kl("Cannot "+r);var W=(t,e,r)=>(ji(t,e,"read from private field"),r?r.call(t):e.get(t)),Ve=(t,e,r)=>e.has(t)?kl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),He=(t,e,r,s)=>(ji(t,e,"write to private field"),s?s.call(t,r):e.set(t,r),r),qt=(t,e,r)=>(ji(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const Zi=!1;var ko=Array.isArray,gf=Array.prototype.indexOf,Ta=Array.prototype.includes,oi=Array.from,mf=Object.defineProperty,ya=Object.getOwnPropertyDescriptor,yf=Object.getOwnPropertyDescriptors,bf=Object.prototype,_f=Array.prototype,du=Object.getPrototypeOf,xl=Object.isExtensible;const wf=()=>{};function kf(t){for(var e=0;e<t.length;e++)t[e]()}function hu(){var t,e,r=new Promise((s,i)=>{t=s,e=i});return{promise:r,resolve:t,reject:e}}const Ot=2,is=4,li=8,pu=1<<24,dr=16,Bn=32,ca=64,vu=128,_n=512,Et=1024,Dt=2048,jn=4096,un=8192,cr=16384,hs=32768,Aa=65536,Sl=1<<17,gu=1<<18,Da=1<<19,xf=1<<20,ur=1<<25,sa=65536,Ji=1<<21,xo=1<<22,Ar=1<<23,na=Symbol("$state"),Sf=Symbol("legacy props"),Ef=Symbol(""),Yr=new class extends Error{constructor(){super(...arguments);Ye(this,"name","StaleReactionError");Ye(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Tf(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Af(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Cf(t,e,r){throw new Error("https://svelte.dev/e/each_key_duplicate")}function If(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Rf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Pf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Of(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Df(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Mf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Lf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Nf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function qf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const jf=1,Bf=2,mu=4,zf=8,Ff=16,Kf=1,Uf=4,Gf=8,Hf=16,yu=1,Wf=2,Ct=Symbol(),bu="http://www.w3.org/1999/xhtml";function Yf(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Vf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function _u(t){return t===this.v}function Qf(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function wu(t){return!Qf(t,this.v)}let Xf=!1,cn=null;function Ca(t){cn=t}function ft(t,e=!1,r){cn={p:cn,i:!1,c:null,e:null,s:t,x:null,l:null}}function dt(t){var e=cn,r=e.e;if(r!==null){e.e=null;for(var s of r)Uu(s)}return t!==void 0&&(e.x=t),e.i=!0,cn=e.p,t??{}}function ku(){return!0}let Vr=[];function xu(){var t=Vr;Vr=[],kf(t)}function Cr(t){if(Vr.length===0&&!ns){var e=Vr;queueMicrotask(()=>{e===Vr&&xu()})}Vr.push(t)}function Zf(){for(;Vr.length>0;)xu()}function Su(t){var e=rt;if(e===null)return Qe.f|=Ar,t;if((e.f&hs)===0&&(e.f&is)===0)throw t;Ia(t,e)}function Ia(t,e){for(;e!==null;){if((e.f&vu)!==0){if((e.f&hs)===0)throw t;try{e.b.error(t);return}catch(r){t=r}}e=e.parent}throw t}const Jf=-7169;function wt(t,e){t.f=t.f&Jf|e}function So(t){(t.f&_n)!==0||t.deps===null?wt(t,Et):wt(t,jn)}function Eu(t){if(t!==null)for(const e of t)(e.f&Ot)===0||(e.f&sa)===0||(e.f^=sa,Eu(e.deps))}function Tu(t,e,r){(t.f&Dt)!==0?e.add(t):(t.f&jn)!==0&&r.add(t),Eu(t.deps),wt(t,Et)}const qs=new Set;let Ue=null,Js=null,It=null,Qt=[],ui=null,$i=!1,ns=!1;var ba,_a,Xr,wa,us,cs,Zr,sr,ka,Jn,eo,to,Au;const Vo=class Vo{constructor(){Ve(this,Jn);Ye(this,"committed",!1);Ye(this,"current",new Map);Ye(this,"previous",new Map);Ve(this,ba,new Set);Ve(this,_a,new Set);Ve(this,Xr,0);Ve(this,wa,0);Ve(this,us,null);Ve(this,cs,new Set);Ve(this,Zr,new Set);Ve(this,sr,new Map);Ye(this,"is_fork",!1);Ve(this,ka,!1)}is_deferred(){return this.is_fork||W(this,wa)>0}skip_effect(e){W(this,sr).has(e)||W(this,sr).set(e,{d:[],m:[]})}unskip_effect(e){var r=W(this,sr).get(e);if(r){W(this,sr).delete(e);for(var s of r.d)wt(s,Dt),Nn(s);for(s of r.m)wt(s,jn),Nn(s)}}process(e){var i;Qt=[],this.apply();var r=[],s=[];for(const o of e)qt(this,Jn,eo).call(this,o,r,s);if(this.is_deferred()){qt(this,Jn,to).call(this,s),qt(this,Jn,to).call(this,r);for(const[o,c]of W(this,sr))Pu(o,c)}else{for(const o of W(this,ba))o();W(this,ba).clear(),W(this,Xr)===0&&qt(this,Jn,Au).call(this),Js=this,Ue=null,El(s),El(r),Js=null,(i=W(this,us))==null||i.resolve()}It=null}capture(e,r){r!==Ct&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Ar)===0&&(this.current.set(e,e.v),It==null||It.set(e,e.v))}activate(){Ue=this,this.apply()}deactivate(){Ue===this&&(Ue=null,It=null)}flush(){if(this.activate(),Qt.length>0){if(Cu(),Ue!==null&&Ue!==this)return}else W(this,Xr)===0&&this.process([]);this.deactivate()}discard(){for(const e of W(this,_a))e(this);W(this,_a).clear()}increment(e){He(this,Xr,W(this,Xr)+1),e&&He(this,wa,W(this,wa)+1)}decrement(e){He(this,Xr,W(this,Xr)-1),e&&He(this,wa,W(this,wa)-1),!W(this,ka)&&(He(this,ka,!0),Cr(()=>{He(this,ka,!1),this.is_deferred()?Qt.length>0&&this.flush():this.revive()}))}revive(){for(const e of W(this,cs))W(this,Zr).delete(e),wt(e,Dt),Nn(e);for(const e of W(this,Zr))wt(e,jn),Nn(e);this.flush()}oncommit(e){W(this,ba).add(e)}ondiscard(e){W(this,_a).add(e)}settled(){return(W(this,us)??He(this,us,hu())).promise}static ensure(){if(Ue===null){const e=Ue=new Vo;qs.add(Ue),ns||Cr(()=>{Ue===e&&e.flush()})}return Ue}apply(){}};ba=new WeakMap,_a=new WeakMap,Xr=new WeakMap,wa=new WeakMap,us=new WeakMap,cs=new WeakMap,Zr=new WeakMap,sr=new WeakMap,ka=new WeakMap,Jn=new WeakSet,eo=function(e,r,s){e.f^=Et;for(var i=e.first,o=null;i!==null;){var c=i.f,d=(c&(Bn|ca))!==0,v=d&&(c&Et)!==0,p=v||(c&un)!==0||W(this,sr).has(i);if(!p&&i.fn!==null){d?i.f^=Et:o!==null&&(c&(is|li|pu))!==0?o.b.defer_effect(i):(c&is)!==0?r.push(i):vs(i)&&((c&dr)!==0&&W(this,Zr).add(i),Pa(i));var y=i.first;if(y!==null){i=y;continue}}var x=i.parent;for(i=i.next;i===null&&x!==null;)x===o&&(o=null),i=x.next,x=x.parent}},to=function(e){for(var r=0;r<e.length;r+=1)Tu(e[r],W(this,cs),W(this,Zr))},Au=function(){var i;if(qs.size>1){this.previous.clear();var e=It,r=!0;for(const o of qs){if(o===this){r=!1;continue}const c=[];for(const[v,p]of this.current){if(o.current.has(v))if(r&&p!==o.current.get(v))o.current.set(v,p);else continue;c.push(v)}if(c.length===0)continue;const d=[...o.current.keys()].filter(v=>!this.current.has(v));if(d.length>0){var s=Qt;Qt=[];const v=new Set,p=new Map;for(const y of c)Iu(y,d,v,p);if(Qt.length>0){Ue=o,o.apply();for(const y of Qt)qt(i=o,Jn,eo).call(i,y,[],[]);o.deactivate()}Qt=s}}Ue=null,It=e}this.committed=!0,qs.delete(this)};let Ir=Vo;function $f(t){var e=ns;ns=!0;try{for(var r;;){if(Zf(),Qt.length===0&&(Ue==null||Ue.flush(),Qt.length===0))return ui=null,r;Cu()}}finally{ns=e}}function Cu(){$i=!0;var t=null;try{for(var e=0;Qt.length>0;){var r=Ir.ensure();if(e++>1e3){var s,i;ed()}r.process(Qt),Rr.clear()}}finally{Qt=[],$i=!1,ui=null}}function ed(){try{Of()}catch(t){Ia(t,ui)}}let Pn=null;function El(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var s=t[r++];if((s.f&(cr|un))===0&&vs(s)&&(Pn=new Set,Pa(s),s.deps===null&&s.first===null&&s.nodes===null&&s.teardown===null&&s.ac===null&&Yu(s),(Pn==null?void 0:Pn.size)>0)){Rr.clear();for(const i of Pn){if((i.f&(cr|un))!==0)continue;const o=[i];let c=i.parent;for(;c!==null;)Pn.has(c)&&(Pn.delete(c),o.push(c)),c=c.parent;for(let d=o.length-1;d>=0;d--){const v=o[d];(v.f&(cr|un))===0&&Pa(v)}}Pn.clear()}}Pn=null}}function Iu(t,e,r,s){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ot)!==0?Iu(i,e,r,s):(o&(xo|dr))!==0&&(o&Dt)===0&&Ru(i,e,s)&&(wt(i,Dt),Nn(i))}}function Ru(t,e,r){const s=r.get(t);if(s!==void 0)return s;if(t.deps!==null)for(const i of t.deps){if(Ta.call(e,i))return!0;if((i.f&Ot)!==0&&Ru(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Nn(t){for(var e=ui=t;e.parent!==null;){e=e.parent;var r=e.f;if($i&&e===rt&&(r&dr)!==0&&(r&gu)===0)return;if((r&(ca|Bn))!==0){if((r&Et)===0)return;e.f^=Et}}Qt.push(e)}function Pu(t,e){if(!((t.f&Bn)!==0&&(t.f&Et)!==0)){(t.f&Dt)!==0?e.d.push(t):(t.f&jn)!==0&&e.m.push(t),wt(t,Et);for(var r=t.first;r!==null;)Pu(r,e),r=r.next}}function td(t){let e=0,r=ia(0),s;return()=>{Ao()&&(b(r),Co(()=>(e===0&&(s=gs(()=>t(()=>rs(r)))),e+=1,()=>{Cr(()=>{e-=1,e===0&&(s==null||s(),s=void 0,rs(r))})})))}}var nd=Aa|Da|vu;function rd(t,e,r){new ad(t,e,r)}var mn,wo,Yn,Jr,Vn,yn,Yt,Qn,ir,Er,$r,Tr,xa,ea,Sa,Ea,or,si,Tt,sd,id,no,Hs,Ws,ro;class ad{constructor(e,r,s){Ve(this,Tt);Ye(this,"parent");Ye(this,"is_pending",!1);Ve(this,mn);Ve(this,wo,null);Ve(this,Yn);Ve(this,Jr);Ve(this,Vn);Ve(this,yn,null);Ve(this,Yt,null);Ve(this,Qn,null);Ve(this,ir,null);Ve(this,Er,null);Ve(this,$r,0);Ve(this,Tr,0);Ve(this,xa,!1);Ve(this,ea,!1);Ve(this,Sa,new Set);Ve(this,Ea,new Set);Ve(this,or,null);Ve(this,si,td(()=>(He(this,or,ia(W(this,$r))),()=>{He(this,or,null)})));He(this,mn,e),He(this,Yn,r),He(this,Jr,s),this.parent=rt.b,this.is_pending=!!W(this,Yn).pending,He(this,Vn,Io(()=>{rt.b=this;{var i=qt(this,Tt,no).call(this);try{He(this,yn,bn(()=>s(i)))}catch(o){this.error(o)}W(this,Tr)>0?qt(this,Tt,Ws).call(this):this.is_pending=!1}return()=>{var o;(o=W(this,Er))==null||o.remove()}},nd))}defer_effect(e){Tu(e,W(this,Sa),W(this,Ea))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!W(this,Yn).pending}update_pending_count(e){qt(this,Tt,ro).call(this,e),He(this,$r,W(this,$r)+e),!(!W(this,or)||W(this,xa))&&(He(this,xa,!0),Cr(()=>{He(this,xa,!1),W(this,or)&&Ra(W(this,or),W(this,$r))}))}get_effect_pending(){return W(this,si).call(this),b(W(this,or))}error(e){var r=W(this,Yn).onerror;let s=W(this,Yn).failed;if(W(this,ea)||!r&&!s)throw e;W(this,yn)&&(Jt(W(this,yn)),He(this,yn,null)),W(this,Yt)&&(Jt(W(this,Yt)),He(this,Yt,null)),W(this,Qn)&&(Jt(W(this,Qn)),He(this,Qn,null));var i=!1,o=!1;const c=()=>{if(i){Vf();return}i=!0,o&&qf(),Ir.ensure(),He(this,$r,0),W(this,Qn)!==null&&ra(W(this,Qn),()=>{He(this,Qn,null)}),this.is_pending=this.has_pending_snippet(),He(this,yn,qt(this,Tt,Hs).call(this,()=>(He(this,ea,!1),bn(()=>W(this,Jr).call(this,W(this,mn)))))),W(this,Tr)>0?qt(this,Tt,Ws).call(this):this.is_pending=!1};Cr(()=>{try{o=!0,r==null||r(e,c),o=!1}catch(d){Ia(d,W(this,Vn)&&W(this,Vn).parent)}s&&He(this,Qn,qt(this,Tt,Hs).call(this,()=>{Ir.ensure(),He(this,ea,!0);try{return bn(()=>{s(W(this,mn),()=>e,()=>c)})}catch(d){return Ia(d,W(this,Vn).parent),null}finally{He(this,ea,!1)}}))})}}mn=new WeakMap,wo=new WeakMap,Yn=new WeakMap,Jr=new WeakMap,Vn=new WeakMap,yn=new WeakMap,Yt=new WeakMap,Qn=new WeakMap,ir=new WeakMap,Er=new WeakMap,$r=new WeakMap,Tr=new WeakMap,xa=new WeakMap,ea=new WeakMap,Sa=new WeakMap,Ea=new WeakMap,or=new WeakMap,si=new WeakMap,Tt=new WeakSet,sd=function(){try{He(this,yn,bn(()=>W(this,Jr).call(this,W(this,mn))))}catch(e){this.error(e)}},id=function(){const e=W(this,Yn).pending;e&&(He(this,Yt,bn(()=>e(W(this,mn)))),Cr(()=>{var r=qt(this,Tt,no).call(this);He(this,yn,qt(this,Tt,Hs).call(this,()=>(Ir.ensure(),bn(()=>W(this,Jr).call(this,r))))),W(this,Tr)>0?qt(this,Tt,Ws).call(this):(ra(W(this,Yt),()=>{He(this,Yt,null)}),this.is_pending=!1)}))},no=function(){var e=W(this,mn);return this.is_pending&&(He(this,Er,fr()),W(this,mn).before(W(this,Er)),e=W(this,Er)),e},Hs=function(e){var r=rt,s=Qe,i=cn;Zn(W(this,Vn)),kn(W(this,Vn)),Ca(W(this,Vn).ctx);try{return e()}catch(o){return Su(o),null}finally{Zn(r),kn(s),Ca(i)}},Ws=function(){const e=W(this,Yn).pending;W(this,yn)!==null&&(He(this,ir,document.createDocumentFragment()),W(this,ir).append(W(this,Er)),Xu(W(this,yn),W(this,ir))),W(this,Yt)===null&&He(this,Yt,bn(()=>e(W(this,mn))))},ro=function(e){var r;if(!this.has_pending_snippet()){this.parent&&qt(r=this.parent,Tt,ro).call(r,e);return}if(He(this,Tr,W(this,Tr)+e),W(this,Tr)===0){this.is_pending=!1;for(const s of W(this,Sa))wt(s,Dt),Nn(s);for(const s of W(this,Ea))wt(s,jn),Nn(s);W(this,Sa).clear(),W(this,Ea).clear(),W(this,Yt)&&ra(W(this,Yt),()=>{He(this,Yt,null)}),W(this,ir)&&(W(this,mn).before(W(this,ir)),He(this,ir,null))}};function od(t,e,r,s){const i=ci;var o=t.filter(_=>!_.settled);if(r.length===0&&o.length===0){s(e.map(i));return}var c=Ue,d=rt,v=ld(),p=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(_=>_.promise)):null;function y(_){v();try{s(_)}catch(w){(d.f&cr)===0&&Ia(w,d)}c==null||c.deactivate(),ao()}if(r.length===0){p.then(()=>y(e.map(i)));return}function x(){v(),Promise.all(r.map(_=>ud(_))).then(_=>y([...e.map(i),..._])).catch(_=>Ia(_,d))}p?p.then(x):x()}function ld(){var t=rt,e=Qe,r=cn,s=Ue;return function(o=!0){Zn(t),kn(e),Ca(r),o&&(s==null||s.activate())}}function ao(){Zn(null),kn(null),Ca(null)}function ci(t){var e=Ot|Dt,r=Qe!==null&&(Qe.f&Ot)!==0?Qe:null;return rt!==null&&(rt.f|=Da),{ctx:cn,deps:null,effects:null,equals:_u,f:e,fn:t,reactions:null,rv:0,v:Ct,wv:0,parent:r??rt,ac:null}}function ud(t,e,r){let s=rt;s===null&&Af();var i=s.b,o=void 0,c=ia(Ct),d=!Qe,v=new Map;return xd(()=>{var w;var p=hu();o=p.promise;try{Promise.resolve(t()).then(p.resolve,p.reject).then(()=>{y===Ue&&y.committed&&y.deactivate(),ao()})}catch(M){p.reject(M),ao()}var y=Ue;if(d){var x=i.is_rendered();i.update_pending_count(1),y.increment(x),(w=v.get(y))==null||w.reject(Yr),v.delete(y),v.set(y,p)}const _=(M,q=void 0)=>{if(y.activate(),q)q!==Yr&&(c.f|=Ar,Ra(c,q));else{(c.f&Ar)!==0&&(c.f^=Ar),Ra(c,M);for(const[S,F]of v){if(v.delete(S),S===y)break;F.reject(Yr)}}d&&(i.update_pending_count(-1),y.decrement(x))};p.promise.then(_,M=>_(null,M||"unknown"))}),Ku(()=>{for(const p of v.values())p.reject(Yr)}),new Promise(p=>{function y(x){function _(){x===o?p(c):y(o)}x.then(_,_)}y(o)})}function vt(t){const e=ci(t);return Zu(e),e}function Ou(t){const e=ci(t);return e.equals=wu,e}function cd(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Jt(e[r])}}function fd(t){for(var e=t.parent;e!==null;){if((e.f&Ot)===0)return(e.f&cr)===0?e:null;e=e.parent}return null}function Eo(t){var e,r=rt;Zn(fd(t));try{t.f&=~sa,cd(t),e=tc(t)}finally{Zn(r)}return e}function Du(t){var e=Eo(t);if(!t.equals(e)&&(t.wv=$u(),(!(Ue!=null&&Ue.is_fork)||t.deps===null)&&(t.v=e,t.deps===null))){wt(t,Et);return}Pr||(It!==null?(Ao()||Ue!=null&&Ue.is_fork)&&It.set(t,e):So(t))}function dd(t){var e,r;if(t.effects!==null)for(const s of t.effects)(s.teardown||s.ac)&&((e=s.teardown)==null||e.call(s),(r=s.ac)==null||r.abort(Yr),s.teardown=wf,s.ac=null,os(s,0),Ro(s))}function Mu(t){if(t.effects!==null)for(const e of t.effects)e.teardown&&Pa(e)}let so=new Set;const Rr=new Map;let Lu=!1;function ia(t,e){var r={f:0,v:t,reactions:null,equals:_u,rv:0,wv:0};return r}function Oe(t,e){const r=ia(t);return Zu(r),r}function hd(t,e=!1,r=!0){const s=ia(t);return e||(s.equals=wu),s}function B(t,e,r=!1){Qe!==null&&(!qn||(Qe.f&Sl)!==0)&&ku()&&(Qe.f&(Ot|dr|xo|Sl))!==0&&(wn===null||!Ta.call(wn,t))&&Nf();let s=r?Rt(e):e;return Ra(t,s)}function Ra(t,e){if(!t.equals(e)){var r=t.v;Pr?Rr.set(t,e):Rr.set(t,r),t.v=e;var s=Ir.ensure();if(s.capture(t,r),(t.f&Ot)!==0){const i=t;(t.f&Dt)!==0&&Eo(i),So(i)}t.wv=$u(),Nu(t,Dt),rt!==null&&(rt.f&Et)!==0&&(rt.f&(Bn|ca))===0&&(gn===null?Ed([t]):gn.push(t)),!s.is_fork&&so.size>0&&!Lu&&pd()}return e}function pd(){Lu=!1;for(const t of so)(t.f&Et)!==0&&wt(t,jn),vs(t)&&Pa(t);so.clear()}function rs(t){B(t,t.v+1)}function Nu(t,e){var r=t.reactions;if(r!==null)for(var s=r.length,i=0;i<s;i++){var o=r[i],c=o.f,d=(c&Dt)===0;if(d&&wt(o,e),(c&Ot)!==0){var v=o;It==null||It.delete(v),(c&sa)===0&&(c&_n&&(o.f|=sa),Nu(v,jn))}else d&&((c&dr)!==0&&Pn!==null&&Pn.add(o),Nn(o))}}function Rt(t){if(typeof t!="object"||t===null||na in t)return t;const e=du(t);if(e!==bf&&e!==_f)return t;var r=new Map,s=ko(t),i=Oe(0),o=aa,c=d=>{if(aa===o)return d();var v=Qe,p=aa;kn(null),Rl(o);var y=d();return kn(v),Rl(p),y};return s&&r.set("length",Oe(t.length)),new Proxy(t,{defineProperty(d,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Mf();var y=r.get(v);return y===void 0?c(()=>{var x=Oe(p.value);return r.set(v,x),x}):B(y,p.value,!0),!0},deleteProperty(d,v){var p=r.get(v);if(p===void 0){if(v in d){const y=c(()=>Oe(Ct));r.set(v,y),rs(i)}}else B(p,Ct),rs(i);return!0},get(d,v,p){var w;if(v===na)return t;var y=r.get(v),x=v in d;if(y===void 0&&(!x||(w=ya(d,v))!=null&&w.writable)&&(y=c(()=>{var M=Rt(x?d[v]:Ct),q=Oe(M);return q}),r.set(v,y)),y!==void 0){var _=b(y);return _===Ct?void 0:_}return Reflect.get(d,v,p)},getOwnPropertyDescriptor(d,v){var p=Reflect.getOwnPropertyDescriptor(d,v);if(p&&"value"in p){var y=r.get(v);y&&(p.value=b(y))}else if(p===void 0){var x=r.get(v),_=x==null?void 0:x.v;if(x!==void 0&&_!==Ct)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return p},has(d,v){var _;if(v===na)return!0;var p=r.get(v),y=p!==void 0&&p.v!==Ct||Reflect.has(d,v);if(p!==void 0||rt!==null&&(!y||(_=ya(d,v))!=null&&_.writable)){p===void 0&&(p=c(()=>{var w=y?Rt(d[v]):Ct,M=Oe(w);return M}),r.set(v,p));var x=b(p);if(x===Ct)return!1}return y},set(d,v,p,y){var G;var x=r.get(v),_=v in d;if(s&&v==="length")for(var w=p;w<x.v;w+=1){var M=r.get(w+"");M!==void 0?B(M,Ct):w in d&&(M=c(()=>Oe(Ct)),r.set(w+"",M))}if(x===void 0)(!_||(G=ya(d,v))!=null&&G.writable)&&(x=c(()=>Oe(void 0)),B(x,Rt(p)),r.set(v,x));else{_=x.v!==Ct;var q=c(()=>Rt(p));B(x,q)}var S=Reflect.getOwnPropertyDescriptor(d,v);if(S!=null&&S.set&&S.set.call(y,p),!_){if(s&&typeof v=="string"){var F=r.get("length"),te=Number(v);Number.isInteger(te)&&te>=F.v&&B(F,te+1)}rs(i)}return!0},ownKeys(d){b(i);var v=Reflect.ownKeys(d).filter(x=>{var _=r.get(x);return _===void 0||_.v!==Ct});for(var[p,y]of r)y.v!==Ct&&!(p in d)&&v.push(p);return v},setPrototypeOf(){Lf()}})}function Tl(t){try{if(t!==null&&typeof t=="object"&&na in t)return t[na]}catch{}return t}function vd(t,e){return Object.is(Tl(t),Tl(e))}var Al,qu,ju,Bu;function gd(){if(Al===void 0){Al=window,qu=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;ju=ya(e,"firstChild").get,Bu=ya(e,"nextSibling").get,xl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),xl(r)&&(r.__t=void 0)}}function fr(t=""){return document.createTextNode(t)}function ln(t){return ju.call(t)}function ps(t){return Bu.call(t)}function k(t,e){return ln(t)}function gt(t,e=!1){{var r=ln(t);return r instanceof Comment&&r.data===""?ps(r):r}}function D(t,e=1,r=!1){let s=t;for(;e--;)s=ps(s);return s}function md(t){t.textContent=""}function zu(){return!1}function yd(t,e,r){return document.createElementNS(bu,t,void 0)}let Cl=!1;function bd(){Cl||(Cl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function To(t){var e=Qe,r=rt;kn(null),Zn(null);try{return t()}finally{kn(e),Zn(r)}}function Fu(t,e,r,s=r){t.addEventListener(e,()=>To(r));const i=t.__on_r;i?t.__on_r=()=>{i(),s(!0)}:t.__on_r=()=>s(!0),bd()}function _d(t){rt===null&&(Qe===null&&Pf(),Rf()),Pr&&If()}function wd(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function hr(t,e,r){var s=rt;s!==null&&(s.f&un)!==0&&(t|=un);var i={ctx:cn,deps:null,nodes:null,f:t|Dt|_n,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Pa(i)}catch(d){throw Jt(i),d}else e!==null&&Nn(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Da)===0&&(o=o.first,(t&dr)!==0&&(t&Aa)!==0&&o!==null&&(o.f|=Aa)),o!==null&&(o.parent=s,s!==null&&wd(o,s),Qe!==null&&(Qe.f&Ot)!==0&&(t&ca)===0)){var c=Qe;(c.effects??(c.effects=[])).push(o)}return i}function Ao(){return Qe!==null&&!qn}function Ku(t){const e=hr(li,null,!1);return wt(e,Et),e.teardown=t,e}function $s(t){_d();var e=rt.f,r=!Qe&&(e&Bn)!==0&&(e&hs)===0;if(r){var s=cn;(s.e??(s.e=[])).push(t)}else return Uu(t)}function Uu(t){return hr(is|xf,t,!1)}function kd(t){Ir.ensure();const e=hr(ca|Da,t,!0);return(r={})=>new Promise(s=>{r.outro?ra(e,()=>{Jt(e),s(void 0)}):(Jt(e),s(void 0))})}function Gu(t){return hr(is,t,!1)}function xd(t){return hr(xo|Da,t,!0)}function Co(t,e=0){return hr(li|e,t,!0)}function ye(t,e=[],r=[],s=[]){od(s,e,r,i=>{hr(li,()=>t(...i.map(b)),!0)})}function Io(t,e=0){var r=hr(dr|e,t,!0);return r}function bn(t){return hr(Bn|Da,t,!0)}function Hu(t){var e=t.teardown;if(e!==null){const r=Pr,s=Qe;Il(!0),kn(null);try{e.call(null)}finally{Il(r),kn(s)}}}function Ro(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&To(()=>{i.abort(Yr)});var s=r.next;(r.f&ca)!==0?r.parent=null:Jt(r,e),r=s}}function Sd(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Bn)===0&&Jt(e),e=r}}function Jt(t,e=!0){var r=!1;(e||(t.f&gu)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Wu(t.nodes.start,t.nodes.end),r=!0),Ro(t,e&&!r),os(t,0),wt(t,cr);var s=t.nodes&&t.nodes.t;if(s!==null)for(const o of s)o.stop();Hu(t);var i=t.parent;i!==null&&i.first!==null&&Yu(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Wu(t,e){for(;t!==null;){var r=t===e?null:ps(t);t.remove(),t=r}}function Yu(t){var e=t.parent,r=t.prev,s=t.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),e!==null&&(e.first===t&&(e.first=s),e.last===t&&(e.last=r))}function ra(t,e,r=!0){var s=[];Vu(t,s,!0);var i=()=>{r&&Jt(t),e&&e()},o=s.length;if(o>0){var c=()=>--o||i();for(var d of s)d.out(c)}else i()}function Vu(t,e,r){if((t.f&un)===0){t.f^=un;var s=t.nodes&&t.nodes.t;if(s!==null)for(const d of s)(d.is_global||r)&&e.push(d);for(var i=t.first;i!==null;){var o=i.next,c=(i.f&Aa)!==0||(i.f&Bn)!==0&&(t.f&dr)!==0;Vu(i,e,c?r:!1),i=o}}}function Po(t){Qu(t,!0)}function Qu(t,e){if((t.f&un)!==0){t.f^=un,(t.f&Et)===0&&(wt(t,Dt),Nn(t));for(var r=t.first;r!==null;){var s=r.next,i=(r.f&Aa)!==0||(r.f&Bn)!==0;Qu(r,i?e:!1),r=s}var o=t.nodes&&t.nodes.t;if(o!==null)for(const c of o)(c.is_global||e)&&c.in()}}function Xu(t,e){if(t.nodes)for(var r=t.nodes.start,s=t.nodes.end;r!==null;){var i=r===s?null:ps(r);e.append(r),r=i}}let Ys=!1,Pr=!1;function Il(t){Pr=t}let Qe=null,qn=!1;function kn(t){Qe=t}let rt=null;function Zn(t){rt=t}let wn=null;function Zu(t){Qe!==null&&(wn===null?wn=[t]:wn.push(t))}let Xt=null,sn=0,gn=null;function Ed(t){gn=t}let Ju=1,Qr=0,aa=Qr;function Rl(t){aa=t}function $u(){return++Ju}function vs(t){var e=t.f;if((e&Dt)!==0)return!0;if(e&Ot&&(t.f&=~sa),(e&jn)!==0){for(var r=t.deps,s=r.length,i=0;i<s;i++){var o=r[i];if(vs(o)&&Du(o),o.wv>t.wv)return!0}(e&_n)!==0&&It===null&&wt(t,Et)}return!1}function ec(t,e,r=!0){var s=t.reactions;if(s!==null&&!(wn!==null&&Ta.call(wn,t)))for(var i=0;i<s.length;i++){var o=s[i];(o.f&Ot)!==0?ec(o,e,!1):e===o&&(r?wt(o,Dt):(o.f&Et)!==0&&wt(o,jn),Nn(o))}}function tc(t){var q;var e=Xt,r=sn,s=gn,i=Qe,o=wn,c=cn,d=qn,v=aa,p=t.f;Xt=null,sn=0,gn=null,Qe=(p&(Bn|ca))===0?t:null,wn=null,Ca(t.ctx),qn=!1,aa=++Qr,t.ac!==null&&(To(()=>{t.ac.abort(Yr)}),t.ac=null);try{t.f|=Ji;var y=t.fn,x=y();t.f|=hs;var _=t.deps,w=Ue==null?void 0:Ue.is_fork;if(Xt!==null){var M;if(w||os(t,sn),_!==null&&sn>0)for(_.length=sn+Xt.length,M=0;M<Xt.length;M++)_[sn+M]=Xt[M];else t.deps=_=Xt;if(Ao()&&(t.f&_n)!==0)for(M=sn;M<_.length;M++)((q=_[M]).reactions??(q.reactions=[])).push(t)}else!w&&_!==null&&sn<_.length&&(os(t,sn),_.length=sn);if(ku()&&gn!==null&&!qn&&_!==null&&(t.f&(Ot|jn|Dt))===0)for(M=0;M<gn.length;M++)ec(gn[M],t);if(i!==null&&i!==t){if(Qr++,i.deps!==null)for(let S=0;S<r;S+=1)i.deps[S].rv=Qr;if(e!==null)for(const S of e)S.rv=Qr;gn!==null&&(s===null?s=gn:s.push(...gn))}return(t.f&Ar)!==0&&(t.f^=Ar),x}catch(S){return Su(S)}finally{t.f^=Ji,Xt=e,sn=r,gn=s,Qe=i,wn=o,Ca(c),qn=d,aa=v}}function Td(t,e){let r=e.reactions;if(r!==null){var s=gf.call(r,t);if(s!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[s]=r[i],r.pop())}}if(r===null&&(e.f&Ot)!==0&&(Xt===null||!Ta.call(Xt,e))){var o=e;(o.f&_n)!==0&&(o.f^=_n,o.f&=~sa),So(o),dd(o),os(o,0)}}function os(t,e){var r=t.deps;if(r!==null)for(var s=e;s<r.length;s++)Td(t,r[s])}function Pa(t){var e=t.f;if((e&cr)===0){wt(t,Et);var r=rt,s=Ys;rt=t,Ys=!0;try{(e&(dr|pu))!==0?Sd(t):Ro(t),Hu(t);var i=tc(t);t.teardown=typeof i=="function"?i:null,t.wv=Ju;var o;Zi&&Xf&&(t.f&Dt)!==0&&t.deps}finally{Ys=s,rt=r}}}async function nc(){await Promise.resolve(),$f()}function b(t){var e=t.f,r=(e&Ot)!==0;if(Qe!==null&&!qn){var s=rt!==null&&(rt.f&cr)!==0;if(!s&&(wn===null||!Ta.call(wn,t))){var i=Qe.deps;if((Qe.f&Ji)!==0)t.rv<Qr&&(t.rv=Qr,Xt===null&&i!==null&&i[sn]===t?sn++:Xt===null?Xt=[t]:Xt.push(t));else{(Qe.deps??(Qe.deps=[])).push(t);var o=t.reactions;o===null?t.reactions=[Qe]:Ta.call(o,Qe)||o.push(Qe)}}}if(Pr&&Rr.has(t))return Rr.get(t);if(r){var c=t;if(Pr){var d=c.v;return((c.f&Et)===0&&c.reactions!==null||ac(c))&&(d=Eo(c)),Rr.set(c,d),d}var v=(c.f&_n)===0&&!qn&&Qe!==null&&(Ys||(Qe.f&_n)!==0),p=(c.f&hs)===0;vs(c)&&(v&&(c.f|=_n),Du(c)),v&&!p&&(Mu(c),rc(c))}if(It!=null&&It.has(t))return It.get(t);if((t.f&Ar)!==0)throw t.v;return t.v}function rc(t){if(t.f|=_n,t.deps!==null)for(const e of t.deps)(e.reactions??(e.reactions=[])).push(t),(e.f&Ot)!==0&&(e.f&_n)===0&&(Mu(e),rc(e))}function ac(t){if(t.v===Ct)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Rr.has(e)||(e.f&Ot)!==0&&ac(e))return!0;return!1}function gs(t){var e=qn;try{return qn=!0,t()}finally{qn=e}}const Ad=["touchstart","touchmove"];function Cd(t){return Ad.includes(t)}const sc=new Set,io=new Set;function Bt(t){for(var e=0;e<t.length;e++)sc.add(t[e]);for(var r of io)r(t)}let Pl=null;function Ol(t){var S;var e=this,r=e.ownerDocument,s=t.type,i=((S=t.composedPath)==null?void 0:S.call(t))||[],o=i[0]||t.target;Pl=t;var c=0,d=Pl===t&&t.__root;if(d){var v=i.indexOf(d);if(v!==-1&&(e===document||e===window)){t.__root=e;return}var p=i.indexOf(e);if(p===-1)return;v<=p&&(c=v)}if(o=i[c]||t.target,o!==e){mf(t,"currentTarget",{configurable:!0,get(){return o||r}});var y=Qe,x=rt;kn(null),Zn(null);try{for(var _,w=[];o!==null;){var M=o.assignedSlot||o.parentNode||o.host||null;try{var q=o["__"+s];q!=null&&(!o.disabled||t.target===o)&&q.call(o,t)}catch(F){_?w.push(F):_=F}if(t.cancelBubble||M===e||M===null)break;o=M}if(_){for(let F of w)queueMicrotask(()=>{throw F});throw _}}finally{t.__root=e,delete t.currentTarget,kn(y),Zn(x)}}}var uu,cu;const Bi=(cu=(uu=globalThis==null?void 0:globalThis.window)==null?void 0:uu.trustedTypes)==null?void 0:cu.createPolicy("svelte-trusted-html",{createHTML:t=>t});function Id(t){return(Bi==null?void 0:Bi.createHTML(t))??t}function Oo(t,e=!1){var r=yd("template");return t=t.replaceAll("<!>","<!---->"),r.innerHTML=e?Id(t):t,r.content}function oa(t,e){var r=rt;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function H(t,e){var r=(e&yu)!==0,s=(e&Wf)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=Oo(o?t:"<!>"+t,!0),r||(i=ln(i)));var c=s||qu?document.importNode(i,!0):i.cloneNode(!0);if(r){var d=ln(c),v=c.lastChild;oa(d,v)}else oa(c,c);return c}}function Rd(t,e,r="svg"){var s=!t.startsWith("<!>"),i=(e&yu)!==0,o=`<${r}>${s?t:"<!>"+t}</${r}>`,c;return()=>{if(!c){var d=Oo(o,!0),v=ln(d);if(i)for(c=document.createDocumentFragment();ln(v);)c.appendChild(ln(v));else c=ln(v)}var p=c.cloneNode(!0);if(i){var y=ln(p),x=p.lastChild;oa(y,x)}else oa(p,p);return p}}function Do(t,e){return Rd(t,e,"svg")}function Dl(t=""){{var e=fr(t+"");return oa(e,e),e}}function Oa(){var t=document.createDocumentFragment(),e=document.createComment(""),r=fr();return t.append(e,r),oa(e,r),t}function K(t,e){t!==null&&t.before(e)}function re(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Pd(t,e){return Od(t,e)}const js=new Map;function Od(t,{target:e,anchor:r,props:s={},events:i,context:o,intro:c=!0}){gd();var d=new Set,v=x=>{for(var _=0;_<x.length;_++){var w=x[_];if(!d.has(w)){d.add(w);var M=Cd(w);for(const F of[e,document]){var q=js.get(F);q===void 0&&(q=new Map,js.set(F,q));var S=q.get(w);S===void 0?(F.addEventListener(w,Ol,{passive:M}),q.set(w,1)):q.set(w,S+1)}}}};v(oi(sc)),io.add(v);var p=void 0,y=kd(()=>{var x=r??e.appendChild(fr());return rd(x,{pending:()=>{}},_=>{ft({});var w=cn;o&&(w.c=o),i&&(s.$$events=i),p=t(_,s)||{},dt()}),()=>{var q;for(var _ of d)for(const S of[e,document]){var w=js.get(S),M=w.get(_);--M==0?(S.removeEventListener(_,Ol),w.delete(_),w.size===0&&js.delete(S)):w.set(_,M)}io.delete(v),x!==r&&((q=x.parentNode)==null||q.removeChild(x))}});return Dd.set(p,y),p}let Dd=new WeakMap;var Dn,Xn,on,ta,fs,ds,ii;class Md{constructor(e,r=!0){Ye(this,"anchor");Ve(this,Dn,new Map);Ve(this,Xn,new Map);Ve(this,on,new Map);Ve(this,ta,new Set);Ve(this,fs,!0);Ve(this,ds,()=>{var e=Ue;if(W(this,Dn).has(e)){var r=W(this,Dn).get(e),s=W(this,Xn).get(r);if(s)Po(s),W(this,ta).delete(r);else{var i=W(this,on).get(r);i&&(W(this,Xn).set(r,i.effect),W(this,on).delete(r),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),s=i.effect)}for(const[o,c]of W(this,Dn)){if(W(this,Dn).delete(o),o===e)break;const d=W(this,on).get(c);d&&(Jt(d.effect),W(this,on).delete(c))}for(const[o,c]of W(this,Xn)){if(o===r||W(this,ta).has(o))continue;const d=()=>{if(Array.from(W(this,Dn).values()).includes(o)){var p=document.createDocumentFragment();Xu(c,p),p.append(fr()),W(this,on).set(o,{effect:c,fragment:p})}else Jt(c);W(this,ta).delete(o),W(this,Xn).delete(o)};W(this,fs)||!s?(W(this,ta).add(o),ra(c,d,!1)):d()}}});Ve(this,ii,e=>{W(this,Dn).delete(e);const r=Array.from(W(this,Dn).values());for(const[s,i]of W(this,on))r.includes(s)||(Jt(i.effect),W(this,on).delete(s))});this.anchor=e,He(this,fs,r)}ensure(e,r){var s=Ue,i=zu();if(r&&!W(this,Xn).has(e)&&!W(this,on).has(e))if(i){var o=document.createDocumentFragment(),c=fr();o.append(c),W(this,on).set(e,{effect:bn(()=>r(c)),fragment:o})}else W(this,Xn).set(e,bn(()=>r(this.anchor)));if(W(this,Dn).set(s,e),i){for(const[d,v]of W(this,Xn))d===e?s.unskip_effect(v):s.skip_effect(v);for(const[d,v]of W(this,on))d===e?s.unskip_effect(v.effect):s.skip_effect(v.effect);s.oncommit(W(this,ds)),s.ondiscard(W(this,ii))}else W(this,ds).call(this)}}Dn=new WeakMap,Xn=new WeakMap,on=new WeakMap,ta=new WeakMap,fs=new WeakMap,ds=new WeakMap,ii=new WeakMap;function Se(t,e,r=!1){var s=new Md(t),i=r?Aa:0;function o(c,d){s.ensure(c,d)}Io(()=>{var c=!1;e((d,v=0)=>{c=!0,o(v,d)}),c||o(!1,null)},i)}function pr(t,e){return e}function Ld(t,e,r){for(var s=[],i=e.length,o,c=e.length,d=0;d<i;d++){let x=e[d];ra(x,()=>{if(o){if(o.pending.delete(x),o.done.add(x),o.pending.size===0){var _=t.outrogroups;oo(oi(o.done)),_.delete(o),_.size===0&&(t.outrogroups=null)}}else c-=1},!1)}if(c===0){var v=s.length===0&&r!==null;if(v){var p=r,y=p.parentNode;md(y),y.append(p),t.items.clear()}oo(e,!v)}else o={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(o)}function oo(t,e=!0){for(var r=0;r<t.length;r++)Jt(t[r],e)}var Ml;function Ut(t,e,r,s,i,o=null){var c=t,d=new Map,v=(e&mu)!==0;if(v){var p=t;c=p.appendChild(fr())}var y=null,x=Ou(()=>{var F=r();return ko(F)?F:F==null?[]:oi(F)}),_,w=!0;function M(){S.fallback=y,Nd(S,_,c,e,s),y!==null&&(_.length===0?(y.f&ur)===0?Po(y):(y.f^=ur,es(y,null,c)):ra(y,()=>{y=null}))}var q=Io(()=>{_=b(x);for(var F=_.length,te=new Set,G=Ue,U=zu(),X=0;X<F;X+=1){var J=_[X],Y=s(J,X),ge=w?null:d.get(Y);ge?(ge.v&&Ra(ge.v,J),ge.i&&Ra(ge.i,X),U&&G.unskip_effect(ge.e)):(ge=qd(d,w?c:Ml??(Ml=fr()),J,Y,X,i,e,r),w||(ge.e.f|=ur),d.set(Y,ge)),te.add(Y)}if(F===0&&o&&!y&&(w?y=bn(()=>o(c)):(y=bn(()=>o(Ml??(Ml=fr()))),y.f|=ur)),F>te.size&&Cf(),!w)if(U){for(const[Le,_e]of d)te.has(Le)||G.skip_effect(_e.e);G.oncommit(M),G.ondiscard(()=>{})}else M();b(x)}),S={effect:q,items:d,outrogroups:null,fallback:y};w=!1}function Wa(t){for(;t!==null&&(t.f&Bn)===0;)t=t.next;return t}function Nd(t,e,r,s,i){var _e,ve,ae,ne,qe,se,le,ue,Q;var o=(s&zf)!==0,c=e.length,d=t.items,v=Wa(t.effect.first),p,y=null,x,_=[],w=[],M,q,S,F;if(o)for(F=0;F<c;F+=1)M=e[F],q=i(M,F),S=d.get(q).e,(S.f&ur)===0&&((ve=(_e=S.nodes)==null?void 0:_e.a)==null||ve.measure(),(x??(x=new Set)).add(S));for(F=0;F<c;F+=1){if(M=e[F],q=i(M,F),S=d.get(q).e,t.outrogroups!==null)for(const ee of t.outrogroups)ee.pending.delete(S),ee.done.delete(S);if((S.f&ur)!==0)if(S.f^=ur,S===v)es(S,null,r);else{var te=y?y.next:v;S===t.effect.last&&(t.effect.last=S.prev),S.prev&&(S.prev.next=S.next),S.next&&(S.next.prev=S.prev),xr(t,y,S),xr(t,S,te),es(S,te,r),y=S,_=[],w=[],v=Wa(y.next);continue}if((S.f&un)!==0&&(Po(S),o&&((ne=(ae=S.nodes)==null?void 0:ae.a)==null||ne.unfix(),(x??(x=new Set)).delete(S))),S!==v){if(p!==void 0&&p.has(S)){if(_.length<w.length){var G=w[0],U;y=G.prev;var X=_[0],J=_[_.length-1];for(U=0;U<_.length;U+=1)es(_[U],G,r);for(U=0;U<w.length;U+=1)p.delete(w[U]);xr(t,X.prev,J.next),xr(t,y,X),xr(t,J,G),v=G,y=J,F-=1,_=[],w=[]}else p.delete(S),es(S,v,r),xr(t,S.prev,S.next),xr(t,S,y===null?t.effect.first:y.next),xr(t,y,S),y=S;continue}for(_=[],w=[];v!==null&&v!==S;)(p??(p=new Set)).add(v),w.push(v),v=Wa(v.next);if(v===null)continue}(S.f&ur)===0&&_.push(S),y=S,v=Wa(S.next)}if(t.outrogroups!==null){for(const ee of t.outrogroups)ee.pending.size===0&&(oo(oi(ee.done)),(qe=t.outrogroups)==null||qe.delete(ee));t.outrogroups.size===0&&(t.outrogroups=null)}if(v!==null||p!==void 0){var Y=[];if(p!==void 0)for(S of p)(S.f&un)===0&&Y.push(S);for(;v!==null;)(v.f&un)===0&&v!==t.fallback&&Y.push(v),v=Wa(v.next);var ge=Y.length;if(ge>0){var Le=(s&mu)!==0&&c===0?r:null;if(o){for(F=0;F<ge;F+=1)(le=(se=Y[F].nodes)==null?void 0:se.a)==null||le.measure();for(F=0;F<ge;F+=1)(Q=(ue=Y[F].nodes)==null?void 0:ue.a)==null||Q.fix()}Ld(t,Y,Le)}}o&&Cr(()=>{var ee,$;if(x!==void 0)for(S of x)($=(ee=S.nodes)==null?void 0:ee.a)==null||$.apply()})}function qd(t,e,r,s,i,o,c,d){var v=(c&jf)!==0?(c&Ff)===0?hd(r,!1,!1):ia(r):null,p=(c&Bf)!==0?ia(i):null;return{v,i:p,e:bn(()=>(o(e,v??r,p??i,d),()=>{t.delete(s)}))}}function es(t,e,r){if(t.nodes)for(var s=t.nodes.start,i=t.nodes.end,o=e&&(e.f&ur)===0?e.nodes.start:r;s!==null;){var c=ps(s);if(o.before(s),s===i)return;s=c}}function xr(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function jd(t,e,r=!1,s=!1,i=!1){var o=t,c="";ye(()=>{var d=rt;if(c!==(c=e()??"")&&(d.nodes!==null&&(Wu(d.nodes.start,d.nodes.end),d.nodes=null),c!=="")){var v=c+"";r?v=`<svg>${v}</svg>`:s&&(v=`<math>${v}</math>`);var p=Oo(v);if((r||s)&&(p=ln(p)),oa(ln(p),p.lastChild),r||s)for(;ln(p);)o.before(ln(p));else o.before(p)}})}const Ll=[...` 	
\r\fÂ \v\uFEFF`];function Bd(t,e,r){var s=t==null?"":""+t;if(e&&(s=s?s+" "+e:e),r){for(var i in r)if(r[i])s=s?s+" "+i:i;else if(s.length)for(var o=i.length,c=0;(c=s.indexOf(i,c))>=0;){var d=c+o;(c===0||Ll.includes(s[c-1]))&&(d===s.length||Ll.includes(s[d]))?s=(c===0?"":s.substring(0,c))+s.substring(d+1):c=d}}return s===""?null:s}function Nl(t,e=!1){var r=e?" !important;":";",s="";for(var i in t){var o=t[i];o!=null&&o!==""&&(s+=" "+i+": "+o+r)}return s}function zi(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function zd(t,e){if(e){var r="",s,i;if(Array.isArray(e)?(s=e[0],i=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var o=!1,c=0,d=!1,v=[];s&&v.push(...Object.keys(s).map(zi)),i&&v.push(...Object.keys(i).map(zi));var p=0,y=-1;const q=t.length;for(var x=0;x<q;x++){var _=t[x];if(d?_==="/"&&t[x-1]==="*"&&(d=!1):o?o===_&&(o=!1):_==="/"&&t[x+1]==="*"?d=!0:_==='"'||_==="'"?o=_:_==="("?c++:_===")"&&c--,!d&&o===!1&&c===0){if(_===":"&&y===-1)y=x;else if(_===";"||x===q-1){if(y!==-1){var w=zi(t.substring(p,y).trim());if(!v.includes(w)){_!==";"&&x++;var M=t.substring(p,x).trim();r+=" "+M+";"}}p=x+1,y=-1}}}}return s&&(r+=Nl(s)),i&&(r+=Nl(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Zt(t,e,r,s,i,o){var c=t.__className;if(c!==r||c===void 0){var d=Bd(r,s,o);d==null?t.removeAttribute("class"):e?t.className=d:t.setAttribute("class",d),t.__className=r}else if(o&&i!==o)for(var v in o){var p=!!o[v];(i==null||p!==!!i[v])&&t.classList.toggle(v,p)}return o}function Fi(t,e={},r,s){for(var i in r){var o=r[i];e[i]!==o&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,o,s))}}function $t(t,e,r,s){var i=t.__style;if(i!==e){var o=zd(e,s);o==null?t.removeAttribute("style"):t.style.cssText=o,t.__style=e}else s&&(Array.isArray(s)?(Fi(t,r==null?void 0:r[0],s[0]),Fi(t,r==null?void 0:r[1],s[1],"important")):Fi(t,r,s));return s}function ic(t,e,r=!1){if(t.multiple){if(e==null)return;if(!ko(e))return Yf();for(var s of t.options)s.selected=e.includes(as(s));return}for(s of t.options){var i=as(s);if(vd(i,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Fd(t){var e=new MutationObserver(()=>{ic(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ku(()=>{e.disconnect()})}function Mo(t,e,r=e){var s=new WeakSet,i=!0;Fu(t,"change",o=>{var c=o?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(c),as);else{var v=t.querySelector(c)??t.querySelector("option:not([disabled])");d=v&&as(v)}r(d),Ue!==null&&s.add(Ue)}),Gu(()=>{var o=e();if(t===document.activeElement){var c=Js??Ue;if(s.has(c))return}if(ic(t,o,i),i&&o===void 0){var d=t.querySelector(":checked");d!==null&&(o=as(d),r(o))}t.__value=o,i=!1}),Fd(t)}function as(t){return"__value"in t?t.__value:t.value}const Kd=Symbol("is custom element"),Ud=Symbol("is html");function oc(t,e,r,s){var i=Gd(t);i[e]!==(i[e]=r)&&(e==="loading"&&(t[Ef]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Hd(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Gd(t){return t.__attributes??(t.__attributes={[Kd]:t.nodeName.includes("-"),[Ud]:t.namespaceURI===bu})}var ql=new Map;function Hd(t){var e=t.getAttribute("is")||t.nodeName,r=ql.get(e);if(r)return r;ql.set(e,r=[]);for(var s,i=t,o=Element.prototype;o!==i;){s=yf(i);for(var c in s)s[c].set&&r.push(c);i=du(i)}return r}function Lo(t,e,r=e){var s=new WeakSet;Fu(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Ki(t)?Ui(o):o,r(o),Ue!==null&&s.add(Ue),await nc(),o!==(o=e())){var c=t.selectionStart,d=t.selectionEnd,v=t.value.length;if(t.value=o??"",d!==null){var p=t.value.length;c===d&&d===v&&p>v?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=c,t.selectionEnd=Math.min(d,p))}}}),gs(e)==null&&t.value&&(r(Ki(t)?Ui(t.value):t.value),Ue!==null&&s.add(Ue)),Co(()=>{var i=e();if(t===document.activeElement){var o=Js??Ue;if(s.has(o))return}Ki(t)&&i===Ui(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Ki(t){var e=t.type;return e==="number"||e==="range"}function Ui(t){return t===""?null:+t}function jl(t,e){return t===e||(t==null?void 0:t[na])===e}function lo(t={},e,r,s){return Gu(()=>{var i,o;return Co(()=>{i=o,o=[],gs(()=>{t!==r(...o)&&(e(t,...o),i&&jl(r(...i),t)&&e(null,...i))})}),()=>{Cr(()=>{o&&jl(r(...o),t)&&e(null,...o)})}}),t}let Bs=!1;function Wd(t){var e=Bs;try{return Bs=!1,[t(),Bs]}finally{Bs=e}}function Ie(t,e,r,s){var te;var i=(r&Gf)!==0,o=(r&Hf)!==0,c=s,d=!0,v=()=>(d&&(d=!1,c=o?gs(s):s),c),p;if(i){var y=na in t||Sf in t;p=((te=ya(t,e))==null?void 0:te.set)??(y&&e in t?G=>t[e]=G:void 0)}var x,_=!1;i?[x,_]=Wd(()=>t[e]):x=t[e],x===void 0&&s!==void 0&&(x=v(),p&&(Df(),p(x)));var w;if(w=()=>{var G=t[e];return G===void 0?v():(d=!0,G)},(r&Uf)===0)return w;if(p){var M=t.$$legacy;return(function(G,U){return arguments.length>0?((!U||M||_)&&p(U?w():G),G):w()})}var q=!1,S=((r&Kf)!==0?ci:Ou)(()=>(q=!1,w()));i&&b(S);var F=rt;return(function(G,U){if(arguments.length>0){const X=U?b(S):i?Rt(G):G;return B(S,X),q=!0,c!==void 0&&(c=X),G}return Pr&&q||(F.f&cr)!==0?S.v:b(S)})}function Mt(t){cn===null&&Tf(),$s(()=>{const e=gs(t);if(typeof e=="function")return e})}const Yd="5";var fu;typeof window<"u"&&((fu=window.__svelte??(window.__svelte={})).v??(fu.v=new Set)).add(Yd);const ls=[{id:"onnx-community/Qwen3-0.6B-ONNX",name:"Qwen3 0.6B",size:"~400 MB",description:"Fastest, best for quick answers"},{id:"onnx-community/Qwen3-1.7B-ONNX",name:"Qwen3 1.7B",size:"~1.1 GB",description:"Balanced speed and quality"},{id:"onnx-community/Qwen3-4B-ONNX",name:"Qwen3 4B",size:"~2.6 GB",description:"Better reasoning, slower"},{id:"onnx-community/DeepSeek-R1-Distill-Qwen-1.5B-ONNX",name:"DeepSeek R1 1.5B",size:"~1 GB",description:"Strong reasoning, CoT focused"},{id:"onnx-community/Phi-4-mini-instruct-ONNX",name:"Phi-4 Mini",size:"~2.5 GB",description:"Microsoft, good at reasoning"},{id:"onnx-community/Phi-3-mini-128k-instruct-ONNX",name:"Phi-3 Mini 128k",size:"~2.6 GB",description:"128k context, reliable"},{id:"onnx-community/gemma-3-270m-it-ONNX",name:"Gemma 3 270M",size:"~190 MB",description:"Smallest, ultra fast"}];let Vt=null,lr="idle",Vs=null,Hr=new Set;function zs(){return Vt||(Vt=new Worker(new URL(""+new URL("worker-BMpOIBP_.js",import.meta.url).href,import.meta.url),{type:"module"}),Vt.addEventListener("message",t=>{const e=t.data;e.status==="loading"&&(lr="loading"),e.status==="ready"&&(lr="ready"),e.status==="start"&&(lr="generating"),(e.status==="complete"||e.status==="error")&&(lr=Vs?"ready":"idle");for(const r of Hr)try{r(e)}catch{}})),Vt}function lc(){return{check(){zs().postMessage({type:"check"})},loadModel(t){Vs=t,lr="loading",zs().postMessage({type:"load",modelId:t})},generate(t){zs().postMessage({type:"generate",data:t})},generateFull(t){return new Promise((e,r)=>{let s="";const i=c=>{switch(c.status){case"thinking":break;case"thinking-done":break;case"update":s+=c.output;break;case"complete":o(),e(s);break;case"error":o(),r(new Error(c.data));break}},o=()=>{Hr.delete(i)};Hr.add(i),zs().postMessage({type:"generate",data:t})})},interrupt(){Vt==null||Vt.postMessage({type:"interrupt"})},reset(){Vt==null||Vt.postMessage({type:"reset"})},onMessage(t){return Hr.add(t),()=>Hr.delete(t)},offMessage(t){Hr.delete(t)},get status(){return lr},get isReady(){return lr==="ready"},get isGenerating(){return lr==="generating"},get modelId(){return Vs},terminate(){Vt==null||Vt.terminate(),Vt=null,lr="idle",Vs=null,Hr.clear()}}}var Vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qs={exports:{}},Xd=Qs.exports,Bl;function Zd(){return Bl||(Bl=1,(function(t,e){((r,s)=>{t.exports=s()})(Xd,function(){var r=function(n,a){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}))(n,a)},s=function(){return(s=Object.assign||function(n){for(var a,l=1,u=arguments.length;l<u;l++)for(var f in a=arguments[l])Object.prototype.hasOwnProperty.call(a,f)&&(n[f]=a[f]);return n}).apply(this,arguments)};function i(n,a,l){for(var u,f=0,h=a.length;f<h;f++)!u&&f in a||((u=u||Array.prototype.slice.call(a,0,f))[f]=a[f]);return n.concat(u||Array.prototype.slice.call(a))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Vd,c=Object.keys,d=Array.isArray;function v(n,a){return typeof a=="object"&&c(a).forEach(function(l){n[l]=a[l]}),n}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var p=Object.getPrototypeOf,y={}.hasOwnProperty;function x(n,a){return y.call(n,a)}function _(n,a){typeof a=="function"&&(a=a(p(n))),(typeof Reflect>"u"?c:Reflect.ownKeys)(a).forEach(function(l){M(n,l,a[l])})}var w=Object.defineProperty;function M(n,a,l,u){w(n,a,v(l&&x(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},u))}function q(n){return{from:function(a){return n.prototype=Object.create(a.prototype),M(n.prototype,"constructor",n),{extend:_.bind(null,n.prototype)}}}}var S=Object.getOwnPropertyDescriptor,F=[].slice;function te(n,a,l){return F.call(n,a,l)}function G(n,a){return a(n)}function U(n){if(!n)throw new Error("Assertion Failed")}function X(n){o.setImmediate?setImmediate(n):setTimeout(n,0)}function J(n,a){if(typeof a=="string"&&x(n,a))return n[a];if(!a)return n;if(typeof a!="string"){for(var l=[],u=0,f=a.length;u<f;++u){var h=J(n,a[u]);l.push(h)}return l}var g,m=a.indexOf(".");return m===-1||(g=n[a.substr(0,m)])==null?void 0:J(g,a.substr(m+1))}function Y(n,a,l){if(n&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof a!="string"&&"length"in a){U(typeof l!="string"&&"length"in l);for(var u=0,f=a.length;u<f;++u)Y(n,a[u],l[u])}else{var h,g,m=a.indexOf(".");m!==-1?(h=a.substr(0,m),(m=a.substr(m+1))===""?l===void 0?d(n)&&!isNaN(parseInt(h))?n.splice(h,1):delete n[h]:n[h]=l:Y(g=(g=n[h])&&x(n,h)?g:n[h]={},m,l)):l===void 0?d(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=l}}function ge(n){var a,l={};for(a in n)x(n,a)&&(l[a]=n[a]);return l}var Le=[].concat;function _e(n){return Le.apply([],n)}var Z="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_e([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(a){return a+n+"Array"})}))).filter(function(n){return o[n]}),ve=new Set(Z.map(function(n){return o[n]})),ae=null;function ne(n){return ae=new WeakMap,n=(function a(l){if(!l||typeof l!="object")return l;var u=ae.get(l);if(u)return u;if(d(l)){u=[],ae.set(l,u);for(var f=0,h=l.length;f<h;++f)u.push(a(l[f]))}else if(ve.has(l.constructor))u=l;else{var g,m=p(l);for(g in u=m===Object.prototype?{}:Object.create(m),ae.set(l,u),l)x(l,g)&&(u[g]=a(l[g]))}return u})(n),ae=null,n}var qe={}.toString;function se(n){return qe.call(n).slice(8,-1)}var le=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ue=typeof le=="symbol"?function(n){var a;return n!=null&&(a=n[le])&&a.apply(n)}:function(){return null};function Q(n,a){a=n.indexOf(a),0<=a&&n.splice(a,1)}var ee={};function $(n){var a,l,u,f;if(arguments.length===1){if(d(n))return n.slice();if(this===ee&&typeof n=="string")return[n];if(f=ue(n))for(l=[];!(u=f.next()).done;)l.push(u.value);else{if(n==null)return[n];if(typeof(a=n.length)!="number")return[n];for(l=new Array(a);a--;)l[a]=n[a]}}else for(a=arguments.length,l=new Array(a);a--;)l[a]=arguments[a];return l}var he=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ze=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Z),fe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ae(n,a){this.name=n,this.message=a}function Ee(n,a){return n+". Errors: "+Object.keys(a).map(function(l){return a[l].toString()}).filter(function(l,u,f){return f.indexOf(l)===u}).join(`
`)}function pe(n,a,l,u){this.failures=a,this.failedKeys=u,this.successCount=l,this.message=Ee(n,a)}function ie(n,a){this.name="BulkError",this.failures=Object.keys(a).map(function(l){return a[l]}),this.failuresByPos=a,this.message=Ee(n,this.failures)}q(Ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(pe).from(Ae),q(ie).from(Ae);var Ne=ze.reduce(function(n,a){return n[a]=a+"Error",n},{}),Fe=Ae,be=ze.reduce(function(n,a){var l=a+"Error";function u(f,h){this.name=l,f?typeof f=="string"?(this.message="".concat(f).concat(h?`
 `+h:""),this.inner=h||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=fe[a]||l,this.inner=null)}return q(u).from(Fe),n[a]=u,n},{}),lt=(be.Syntax=SyntaxError,be.Type=TypeError,be.Range=RangeError,Z.reduce(function(n,a){return n[a+"Error"]=be[a],n},{}));Z=ze.reduce(function(n,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(n[a+"Error"]=be[a]),n},{});function Ke(){}function ut(n){return n}function en(n,a){return n==null||n===ut?a:function(l){return a(n(l))}}function At(n,a){return function(){n.apply(this,arguments),a.apply(this,arguments)}}function Or(n,a){return n===Ke?a:function(){var l=n.apply(this,arguments),u=(l!==void 0&&(arguments[0]=l),this.onsuccess),f=this.onerror,h=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?At(u,this.onsuccess):u),f&&(this.onerror=this.onerror?At(f,this.onerror):f),h!==void 0?h:l}}function Dr(n,a){return n===Ke?a:function(){n.apply(this,arguments);var l=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?At(l,this.onsuccess):l),u&&(this.onerror=this.onerror?At(u,this.onerror):u)}}function Sn(n,a){return n===Ke?a:function(f){var u=n.apply(this,arguments),f=(v(f,u),this.onsuccess),h=this.onerror,g=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return f&&(this.onsuccess=this.onsuccess?At(f,this.onsuccess):f),h&&(this.onerror=this.onerror?At(h,this.onerror):h),u===void 0?g===void 0?void 0:g:v(u,g)}}function vr(n,a){return n===Ke?a:function(){return a.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function zn(n,a){return n===Ke?a:function(){var l=n.apply(this,arguments);if(l&&typeof l.then=="function"){for(var u=this,f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];return l.then(function(){return a.apply(u,h)})}return a.apply(this,arguments)}}Z.ModifyError=pe,Z.DexieError=Ae,Z.BulkError=ie;var zt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Mr(n){zt=n}var Fn={},$n=100,tn=typeof Promise>"u"?[]:(ze=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[tn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),p(tn),ze]:[ze,p(ze),ze]),ze=tn[0],ga=tn[1],ga=ga&&ga.then,at=ze&&ze.constructor,nn=!!tn[2],rn=function(n,a){er.push([n,a]),En&&(queueMicrotask(yr),En=!1)},Kn=!0,En=!0,dn=[],Tn=[],gr=ut,xt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ke,pgp:!1,env:{},finalize:Ke},De=xt,er=[],An=0,da=[];function Te(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=De;if(typeof n!="function"){if(n!==Fn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&tr(this,this._value)}else this._state=null,this._value=null,++a.ref,(function l(u,f){try{f(function(h){if(u._state===null){if(h===u)throw new TypeError("A promise cannot be resolved with itself.");var g=u._lib&&br();h&&typeof h.then=="function"?l(u,function(m,C){h instanceof Te?h._then(m,C):h.then(m,C)}):(u._state=!0,u._value=h,bs(u)),g&&nr()}},tr.bind(null,u))}catch(h){tr(u,h)}})(this,n)}var mr={get:function(){var n=De,a=jr;function l(u,f){var h=this,g=!n.global&&(n!==De||a!==jr),m=g&&!In(),C=new Te(function(N,I){Ma(h,new ys(T(u,n,g,m),T(f,n,g,m),N,I,n))});return this._consoleTask&&(C._consoleTask=this._consoleTask),C}return l.prototype=Fn,l},set:function(n){M(this,"then",n&&n.prototype===Fn?mr:{get:function(){return n},set:mr.set})}};function ys(n,a,l,u,f){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof a=="function"?a:null,this.resolve=l,this.reject=u,this.psd=f}function tr(n,a){var l,u;Tn.push(a),n._state===null&&(l=n._lib&&br(),a=gr(a),n._state=!1,n._value=a,u=n,dn.some(function(f){return f._value===u._value})||dn.push(u),bs(n),l)&&nr()}function bs(n){var a=n._listeners;n._listeners=[];for(var l=0,u=a.length;l<u;++l)Ma(n,a[l]);var f=n._PSD;--f.ref||f.finalize(),An===0&&(++An,rn(function(){--An==0&&Lr()},[]))}function Ma(n,a){if(n._state===null)n._listeners.push(a);else{var l=n._state?a.onFulfilled:a.onRejected;if(l===null)return(n._state?a.resolve:a.reject)(n._value);++a.psd.ref,++An,rn(yt,[l,n,a])}}function yt(n,a,l){try{var u,f=a._value;!a._state&&Tn.length&&(Tn=[]),u=zt&&a._consoleTask?a._consoleTask.run(function(){return n(f)}):n(f),a._state||Tn.indexOf(f)!==-1||(h=>{for(var g=dn.length;g;)if(dn[--g]._value===h._value)return dn.splice(g,1)})(a),l.resolve(u)}catch(h){l.reject(h)}finally{--An==0&&Lr(),--l.psd.ref||l.psd.finalize()}}function yr(){Me(xt,function(){br()&&nr()})}function br(){var n=Kn;return En=Kn=!1,n}function nr(){var n,a,l;do for(;0<er.length;)for(n=er,er=[],l=n.length,a=0;a<l;++a){var u=n[a];u[0].apply(null,u[1])}while(0<er.length);En=Kn=!0}function Lr(){for(var n=dn,a=(dn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),da.slice(0)),l=a.length;l;)a[--l]()}function Nr(n){return new Te(Fn,!1,n)}function st(n,a){var l=De;return function(){var u=br(),f=De;try{return Rn(l,!0),n.apply(this,arguments)}catch(h){a&&a(h)}finally{Rn(f,!1),u&&nr()}}}_(Te.prototype,{then:mr,_then:function(n,a){Ma(this,new ys(null,null,n,a,De))},catch:function(n){var a,l;return arguments.length===1?this.then(null,n):(a=n,l=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?l:Nr)(u)}):this.then(null,function(u){return(u&&u.name===a?l:Nr)(u)}))},finally:function(n){return this.then(function(a){return Te.resolve(n()).then(function(){return a})},function(a){return Te.resolve(n()).then(function(){return Nr(a)})})},timeout:function(n,a){var l=this;return n<1/0?new Te(function(u,f){var h=setTimeout(function(){return f(new be.Timeout(a))},n);l.then(u,f).finally(clearTimeout.bind(null,h))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(Te.prototype,Symbol.toStringTag,"Dexie.Promise"),xt.env=ws(),_(Te,{all:function(){var n=$.apply(null,arguments).map(Br);return new Te(function(a,l){n.length===0&&a([]);var u=n.length;n.forEach(function(f,h){return Te.resolve(f).then(function(g){n[h]=g,--u||a(n)},l)})})},resolve:function(n){return n instanceof Te?n:n&&typeof n.then=="function"?new Te(function(a,l){n.then(a,l)}):new Te(Fn,!0,n)},reject:Nr,race:function(){var n=$.apply(null,arguments).map(Br);return new Te(function(a,l){n.map(function(u){return Te.resolve(u).then(a,l)})})},PSD:{get:function(){return De},set:function(n){return De=n}},totalEchoes:{get:function(){return jr}},newPSD:Cn,usePSD:Me,scheduler:{get:function(){return rn},set:function(n){rn=n}},rejectionMapper:{get:function(){return gr},set:function(n){gr=n}},follow:function(n,a){return new Te(function(l,u){return Cn(function(f,h){var g=De;g.unhandleds=[],g.onunhandled=h,g.finalize=At(function(){var m,C=this;m=function(){C.unhandleds.length===0?f():h(C.unhandleds[0])},da.push(function N(){m(),da.splice(da.indexOf(N),1)}),++An,rn(function(){--An==0&&Lr()},[])},g.finalize),n()},a,l,u)})}}),at&&(at.allSettled&&M(Te,"allSettled",function(){var n=$.apply(null,arguments).map(Br);return new Te(function(a){n.length===0&&a([]);var l=n.length,u=new Array(l);n.forEach(function(f,h){return Te.resolve(f).then(function(g){return u[h]={status:"fulfilled",value:g}},function(g){return u[h]={status:"rejected",reason:g}}).then(function(){return--l||a(u)})})})}),at.any&&typeof AggregateError<"u"&&M(Te,"any",function(){var n=$.apply(null,arguments).map(Br);return new Te(function(a,l){n.length===0&&l(new AggregateError([]));var u=n.length,f=new Array(u);n.forEach(function(h,g){return Te.resolve(h).then(function(m){return a(m)},function(m){f[g]=m,--u||l(new AggregateError(f))})})})}),at.withResolvers)&&(Te.withResolvers=at.withResolvers);var kt={awaits:0,echoes:0,id:0},hn=0,pn=[],qr=0,jr=0,La=0;function Cn(n,g,l,u){var f=De,h=Object.create(f),g=(h.parent=f,h.ref=0,h.global=!1,h.id=++La,xt.env,h.env=nn?{Promise:Te,PromiseProp:{value:Te,configurable:!0,writable:!0},all:Te.all,race:Te.race,allSettled:Te.allSettled,any:Te.any,resolve:Te.resolve,reject:Te.reject}:{},g&&v(h,g),++f.ref,h.finalize=function(){--this.parent.ref||this.parent.finalize()},Me(h,n,l,u));return h.ref===0&&h.finalize(),g}function Lt(){return kt.id||(kt.id=++hn),++kt.awaits,kt.echoes+=$n,kt.id}function In(){return!!kt.awaits&&(--kt.awaits==0&&(kt.id=0),kt.echoes=kt.awaits*$n,!0)}function Br(n){return kt.echoes&&n&&n.constructor===at?(Lt(),n.then(function(a){return In(),a},function(a){return In(),we(a)})):n}function _s(){var n=pn[pn.length-1];pn.pop(),Rn(n,!1)}function Rn(n,a){var l,u,f=De;(a?!kt.echoes||qr++&&n===De:!qr||--qr&&n===De)||queueMicrotask(a?(function(h){++jr,kt.echoes&&--kt.echoes!=0||(kt.echoes=kt.awaits=kt.id=0),pn.push(De),Rn(h,!0)}).bind(null,n):_s),n!==De&&(De=n,f===xt&&(xt.env=ws()),nn)&&(l=xt.env.Promise,u=n.env,f.global||n.global)&&(Object.defineProperty(o,"Promise",u.PromiseProp),l.all=u.all,l.race=u.race,l.resolve=u.resolve,l.reject=u.reject,u.allSettled&&(l.allSettled=u.allSettled),u.any)&&(l.any=u.any)}function ws(){var n=o.Promise;return nn?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Me(n,a,l,u,f){var h=De;try{return Rn(n,!0),a(l,u,f)}finally{Rn(h,!1)}}function T(n,a,l,u){return typeof n!="function"?n:function(){var f=De;l&&Lt(),Rn(a,!0);try{return n.apply(this,arguments)}finally{Rn(f,!1),u&&queueMicrotask(In)}}}function de(n){Promise===at&&kt.echoes===0?qr===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ga).indexOf("[native code]")===-1&&(Lt=In=Ke);var we=Te.reject,$e="ï¿¿",it="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ht="String expected.",bt=[],Wt="__dbnames",Un="readonly",zr="readwrite";function ct(n,a){return n?a?function(){return n.apply(this,arguments)&&a.apply(this,arguments)}:n:a}var Na={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Fr(n){return typeof n!="string"||/\./.test(n)?function(a){return a}:function(a){return a[n]===void 0&&n in a&&delete(a=ne(a))[n],a}}function Qo(){throw be.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Xe(n,a){try{var l=Xo(n),u=Xo(a);if(l!==u)return l==="Array"?1:u==="Array"?-1:l==="binary"?1:u==="binary"?-1:l==="string"?1:u==="string"?-1:l==="Date"?1:u!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return a<n?1:n<a?-1:0;case"binary":for(var f=Zo(n),h=Zo(a),g=f.length,m=h.length,C=g<m?g:m,N=0;N<C;++N)if(f[N]!==h[N])return f[N]<h[N]?-1:1;return g===m?0:g<m?-1:1;case"Array":for(var I=n,E=a,P=I.length,O=E.length,R=P<O?P:O,A=0;A<R;++A){var j=Xe(I[A],E[A]);if(j!==0)return j}return P===O?0:P<O?-1:1}}catch{}return NaN}function Xo(n){var a=typeof n;return a=="object"&&(ArrayBuffer.isView(n)||(a=se(n))==="ArrayBuffer")?"binary":a}function Zo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function ks(n,a,l){var u=n.schema.yProps;return u?(a&&0<l.numFailures&&(a=a.filter(function(f,h){return!l.failures[h]})),Promise.all(u.map(function(f){return f=f.updatesTable,a?n.db.table(f).where("k").anyOf(a).delete():n.db.table(f).clear()})).then(function(){return l})):l}Jo.prototype.execute=function(n){var a=this["@@propmod"];if(a.add!==void 0){var l=a.add;if(d(l))return i(i([],d(n)?n:[],!0),l).sort();if(typeof l=="number")return(Number(n)||0)+l;if(typeof l=="bigint")try{return BigInt(n)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(a.remove!==void 0){var u=a.remove;if(d(u))return d(n)?n.filter(function(f){return!u.includes(f)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return l=(l=a.replacePrefix)==null?void 0:l[0],l&&typeof n=="string"&&n.startsWith(l)?a.replacePrefix[1]+n.substring(l.length):n};var qa=Jo;function Jo(n){this["@@propmod"]=n}function $o(n,a){for(var l=c(a),u=l.length,f=!1,h=0;h<u;++h){var g=l[h],m=a[g],C=J(n,g);m instanceof qa?(Y(n,g,m.execute(C)),f=!0):C!==m&&(Y(n,g,m),f=!0)}return f}ot.prototype._trans=function(n,a,l){var u=this._tx||De.trans,f=this.name,h=zt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function g(N,I,E){if(E.schema[f])return a(E.idbtrans,E);throw new be.NotFound("Table "+f+" not part of transaction")}var m=br();try{var C=u&&u.db._novip===this.db._novip?u===De.trans?u._promise(n,g,l):Cn(function(){return u._promise(n,g,l)},{trans:u,transless:De.transless||De}):(function N(I,E,P,O){if(I.idbdb&&(I._state.openComplete||De.letThrough||I._vip)){var R=I._createTransaction(E,P,I._dbSchema);try{R.create(),I._state.PR1398_maxLoop=3}catch(A){return A.name===Ne.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,O)})):we(A)}return R._promise(E,function(A,j){return Cn(function(){return De.trans=R,O(A,j,R)})}).then(function(A){if(E==="readwrite")try{R.idbtrans.commit()}catch{}return E==="readonly"?A:R._completion.then(function(){return A})})}if(I._state.openComplete)return we(new be.DatabaseClosed(I._state.dbOpenError));if(!I._state.isBeingOpened){if(!I._state.autoOpen)return we(new be.DatabaseClosed);I.open().catch(Ke)}return I._state.dbReadyPromise.then(function(){return N(I,E,P,O)})})(this.db,n,[this.name],g);return h&&(C._consoleTask=h,C=C.catch(function(N){return console.trace(N),we(N)})),C}finally{m&&nr()}},ot.prototype.get=function(n,a){var l=this;return n&&n.constructor===Object?this.where(n).first(a):n==null?we(new be.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return l.core.get({trans:u,key:n}).then(function(f){return l.hook.reading.fire(f)})}).then(a)},ot.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(d(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var a=c(n);if(a.length===1)return this.where(a[0]).equals(n[a[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(N){return 0<=m.keyPath.indexOf(N)})){for(var C=0;C<a.length;++C)if(a.indexOf(m.keyPath[C])===-1)return!1;return!0}return!1}).sort(function(m,C){return m.keyPath.length-C.keyPath.length})[0];if(l&&this.db._maxKey!==$e)return g=l.keyPath.slice(0,a.length),this.where(g).equals(g.map(function(m){return n[m]}));!l&&zt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function f(m,C){return Xe(m,C)===0}var g=a.reduce(function(I,C){var N=I[0],I=I[1],E=u[C],P=n[C];return[N||E,N||!E?ct(I,E&&E.multi?function(O){return O=J(O,C),d(O)&&O.some(function(R){return f(P,R)})}:function(O){return f(P,J(O,C))}):I]},[null,null]),h=g[0],g=g[1];return h?this.where(h.name).equals(n[h.keyPath]).filter(g):l?this.filter(g):this.where(a).equals("")},ot.prototype.filter=function(n){return this.toCollection().and(n)},ot.prototype.count=function(n){return this.toCollection().count(n)},ot.prototype.offset=function(n){return this.toCollection().offset(n)},ot.prototype.limit=function(n){return this.toCollection().limit(n)},ot.prototype.each=function(n){return this.toCollection().each(n)},ot.prototype.toArray=function(n){return this.toCollection().toArray(n)},ot.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ot.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,d(n)?"[".concat(n.join("+"),"]"):n))},ot.prototype.reverse=function(){return this.toCollection().reverse()},ot.prototype.mapToClass=function(n){for(var a=this.db,l=this.name,u=((this.schema.mappedClass=n).prototype instanceof Qo&&(n=(g=>{var m=I,C=g;if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function N(){this.constructor=m}function I(){return g!==null&&g.apply(this,arguments)||this}return r(m,C),m.prototype=C===null?Object.create(C):(N.prototype=C.prototype,new N),Object.defineProperty(I.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),I.prototype.table=function(){return l},I})(n)),new Set),f=n.prototype;f;f=p(f))Object.getOwnPropertyNames(f).forEach(function(g){return u.add(g)});function h(g){if(!g)return g;var m,C=Object.create(n.prototype);for(m in g)if(!u.has(m))try{C[m]=g[m]}catch{}return C}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},ot.prototype.defineClass=function(){return this.mapToClass(function(n){v(this,n)})},ot.prototype.add=function(n,a){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Fr(h)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[g]})}).then(function(m){return m.numFailures?Te.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Y(n,h,m)}catch{}return m})},ot.prototype.upsert=function(n,a){var l=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return l.core.get({trans:f,key:n}).then(function(h){var g=h??{};return $o(g,a),u&&Y(g,u,n),l.core.mutate({trans:f,type:"put",values:[g],keys:[n],upsert:!0,updates:{keys:[n],changeSpecs:[a]}}).then(function(m){return m.numFailures?Te.reject(m.failures[0]):!!h})})})},ot.prototype.update=function(n,a){return typeof n!="object"||d(n)?this.where(":id").equals(n).modify(a):(n=J(n,this.schema.primKey.keyPath))===void 0?we(new be.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(a)},ot.prototype.put=function(n,a){var l=this,u=this.schema.primKey,f=u.auto,h=u.keyPath,g=n;return h&&f&&(g=Fr(h)(n)),this._trans("readwrite",function(m){return l.core.mutate({trans:m,type:"put",values:[g],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?Te.reject(m.failures[0]):m.lastResult}).then(function(m){if(h)try{Y(n,h,m)}catch{}return m})},ot.prototype.delete=function(n){var a=this;return this._trans("readwrite",function(l){return a.core.mutate({trans:l,type:"delete",keys:[n]}).then(function(u){return ks(a,[n],u)}).then(function(u){return u.numFailures?Te.reject(u.failures[0]):void 0})})},ot.prototype.clear=function(){var n=this;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"deleteRange",range:Na}).then(function(l){return ks(n,null,l)})}).then(function(a){return a.numFailures?Te.reject(a.failures[0]):void 0})},ot.prototype.bulkGet=function(n){var a=this;return this._trans("readonly",function(l){return a.core.getMany({keys:n,trans:l}).then(function(u){return u.map(function(f){return a.hook.reading.fire(f)})})})},ot.prototype.bulkAdd=function(n,a,l){var u=this,f=Array.isArray(a)?a:void 0,h=(l=l||(f?void 0:a))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new be.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new be.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Fr(m)):n;return u.core.mutate({trans:g,type:"add",keys:f,values:N,wantResults:h}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return h?I.results:I.lastResult;throw new ie("".concat(u.name,".bulkAdd(): ").concat(E," of ").concat(C," operations failed"),P)})})},ot.prototype.bulkPut=function(n,a,l){var u=this,f=Array.isArray(a)?a:void 0,h=(l=l||(f?void 0:a))?l.allKeys:void 0;return this._trans("readwrite",function(g){var m=u.schema.primKey,N=m.auto,m=m.keyPath;if(m&&f)throw new be.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==n.length)throw new be.InvalidArgument("Arguments objects and keys must have the same length");var C=n.length,N=m&&N?n.map(Fr(m)):n;return u.core.mutate({trans:g,type:"put",keys:f,values:N,wantResults:h}).then(function(I){var E=I.numFailures,P=I.failures;if(E===0)return h?I.results:I.lastResult;throw new ie("".concat(u.name,".bulkPut(): ").concat(E," of ").concat(C," operations failed"),P)})})},ot.prototype.bulkUpdate=function(n){var a=this,l=this.core,u=n.map(function(g){return g.key}),f=n.map(function(g){return g.changes}),h=[];return this._trans("readwrite",function(g){return l.getMany({trans:g,keys:u,cache:"clone"}).then(function(m){var C=[],N=[],I=(n.forEach(function(E,P){var O=E.key,R=E.changes,A=m[P];if(A){for(var j=0,z=Object.keys(R);j<z.length;j++){var L=z[j],V=R[L];if(L===a.schema.primKey.keyPath){if(Xe(V,O)!==0)throw new be.Constraint("Cannot update primary key in bulkUpdate()")}else Y(A,L,V)}h.push(P),C.push(O),N.push(A)}}),C.length);return l.mutate({trans:g,type:"put",keys:C,values:N,updates:{keys:u,changeSpecs:f}}).then(function(E){var P=E.numFailures,O=E.failures;if(P===0)return I;for(var R=0,A=Object.keys(O);R<A.length;R++){var j,z=A[R],L=h[Number(z)];L!=null&&(j=O[z],delete O[z],O[L]=j)}throw new ie("".concat(a.name,".bulkUpdate(): ").concat(P," of ").concat(I," operations failed"),O)})})})},ot.prototype.bulkDelete=function(n){var a=this,l=n.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:n}).then(function(f){return ks(a,n,f)})}).then(function(u){var f=u.numFailures,h=u.failures;if(f===0)return u.lastResult;throw new ie("".concat(a.name,".bulkDelete(): ").concat(f," of ").concat(l," operations failed"),h)})};var el=ot;function ot(){}function ja(n){function a(g,m){if(m){for(var C=arguments.length,N=new Array(C-1);--C;)N[C-1]=arguments[C];return l[g].subscribe.apply(null,N),n}if(typeof g=="string")return l[g]}var l={};a.addEventType=h;for(var u=1,f=arguments.length;u<f;++u)h(arguments[u]);return a;function h(g,m,C){var N,I;if(typeof g!="object")return m=m||vr,I={subscribers:[],fire:C=C||Ke,subscribe:function(E){I.subscribers.indexOf(E)===-1&&(I.subscribers.push(E),I.fire=m(I.fire,E))},unsubscribe:function(E){I.subscribers=I.subscribers.filter(function(P){return P!==E}),I.fire=I.subscribers.reduce(m,C)}},l[g]=a[g]=I;c(N=g).forEach(function(E){var P=N[E];if(d(P))h(E,N[E][0],N[E][1]);else{if(P!=="asap")throw new be.InvalidArgument("Invalid event config");var O=h(E,ut,function(){for(var R=arguments.length,A=new Array(R);R--;)A[R]=arguments[R];O.subscribers.forEach(function(j){X(function(){j.apply(null,A)})})})}})}}function Ba(n,a){return q(a).from({prototype:n}),a}function ha(n,a){return!(n.filter||n.algorithm||n.or)&&(a?n.justLimit:!n.replayFilter)}function pi(n,a){n.filter=ct(n.filter,a)}function vi(n,a,l){var u=n.replayFilter;n.replayFilter=u?function(){return ct(u(),a())}:a,n.justLimit=l&&!u}function xs(n,a){if(n.isPrimKey)return a.primaryKey;var l=a.getIndexByKeyPath(n.index);if(l)return l;throw new be.Schema("KeyPath "+n.index+" on object store "+a.name+" is not indexed")}function tl(n,a,l){var u=xs(n,a.schema);return a.openCursor({trans:l,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function Ss(n,a,l,u){var f,h,g=n.replayFilter?ct(n.filter,n.replayFilter()):n.filter;return n.or?(f={},h=function(m,C,N){var I,E;g&&!g(C,N,function(P){return C.stop(P)},function(P){return C.fail(P)})||((E=""+(I=C.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(I)),x(f,E))||(f[E]=!0,a(m,C,N))},Promise.all([n.or._iterate(h,l),nl(tl(n,u,l),n.algorithm,h,!n.keysOnly&&n.valueMapper)])):nl(tl(n,u,l),ct(n.algorithm,g),a,!n.keysOnly&&n.valueMapper)}function nl(n,a,l,u){var f=st(u?function(h,g,m){return l(u(h),g,m)}:l);return n.then(function(h){if(h)return h.start(function(){var g=function(){return h.continue()};a&&!a(h,function(m){return g=m},function(m){h.stop(m),g=Ke},function(m){h.fail(m),g=Ke})||f(h.value,h,function(m){return g=m}),g()})})}et.prototype._read=function(n,a){var l=this._ctx;return l.error?l.table._trans(null,we.bind(null,l.error)):l.table._trans("readonly",n).then(a)},et.prototype._write=function(n){var a=this._ctx;return a.error?a.table._trans(null,we.bind(null,a.error)):a.table._trans("readwrite",n,"locked")},et.prototype._addAlgorithm=function(n){var a=this._ctx;a.algorithm=ct(a.algorithm,n)},et.prototype._iterate=function(n,a){return Ss(this._ctx,n,a,this._ctx.table.core)},et.prototype.clone=function(n){var a=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return n&&v(l,n),a._ctx=l,a},et.prototype.raw=function(){return this._ctx.valueMapper=null,this},et.prototype.each=function(n){var a=this._ctx;return this._read(function(l){return Ss(a,n,l,a.table.core)})},et.prototype.count=function(n){var a=this;return this._read(function(l){var u,f=a._ctx,h=f.table.core;return ha(f,!0)?h.count({trans:l,query:{index:xs(f,h.schema),range:f.range}}).then(function(g){return Math.min(g,f.limit)}):(u=0,Ss(f,function(){return++u,!1},l,h).then(function(){return u}))}).then(n)},et.prototype.sortBy=function(n,a){var l=n.split(".").reverse(),u=l[0],f=l.length-1;function h(C,N){return N?h(C[l[N]],N-1):C[u]}var g=this._ctx.dir==="next"?1:-1;function m(C,N){return Xe(h(C,f),h(N,f))*g}return this.toArray(function(C){return C.sort(m)}).then(a)},et.prototype.toArray=function(n){var a=this;return this._read(function(l){var u,f,h,g=a._ctx;return g.dir==="next"&&ha(g,!0)&&0<g.limit?(u=g.valueMapper,f=xs(g,g.table.core.schema),g.table.core.query({trans:l,limit:g.limit,values:!0,query:{index:f,range:g.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(h=[],Ss(g,function(m){return h.push(m)},l,g.table.core).then(function(){return h}))},n)},et.prototype.offset=function(n){var a=this._ctx;return n<=0||(a.offset+=n,ha(a)?vi(a,function(){var l=n;return function(u,f){return l===0||(l===1?--l:f(function(){u.advance(l),l=0}),!1)}}):vi(a,function(){var l=n;return function(){return--l<0}})),this},et.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),vi(this._ctx,function(){var a=n;return function(l,u,f){return--a<=0&&u(f),0<=a}},!0),this},et.prototype.until=function(n,a){return pi(this._ctx,function(l,u,f){return!n(l.value)||(u(f),a)}),this},et.prototype.first=function(n){return this.limit(1).toArray(function(a){return a[0]}).then(n)},et.prototype.last=function(n){return this.reverse().first(n)},et.prototype.filter=function(n){var a;return pi(this._ctx,function(l){return n(l.value)}),(a=this._ctx).isMatch=ct(a.isMatch,n),this},et.prototype.and=function(n){return this.filter(n)},et.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},et.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},et.prototype.desc=function(){return this.reverse()},et.prototype.eachKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(l,u){n(u.key,u)})},et.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},et.prototype.eachPrimaryKey=function(n){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(l,u){n(u.primaryKey,u)})},et.prototype.keys=function(n){var a=this._ctx,l=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,f){l.push(f.key)}).then(function(){return l}).then(n)},et.prototype.primaryKeys=function(n){var a=this._ctx;if(a.dir==="next"&&ha(a,!0)&&0<a.limit)return this._read(function(u){var f=xs(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:f,range:a.range}})}).then(function(u){return u.result}).then(n);a.keysOnly=!a.isMatch;var l=[];return this.each(function(u,f){l.push(f.primaryKey)}).then(function(){return l}).then(n)},et.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},et.prototype.firstKey=function(n){return this.limit(1).keys(function(a){return a[0]}).then(n)},et.prototype.lastKey=function(n){return this.reverse().firstKey(n)},et.prototype.distinct=function(){var n,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(n={},pi(this._ctx,function(u){var u=u.primaryKey.toString(),f=x(n,u);return n[u]=!0,!f})),this},et.prototype.modify=function(n){var a=this,l=this._ctx;return this._write(function(u){function f(A,j){var z=j.failures;P+=A-j.numFailures;for(var L=0,V=c(z);L<V.length;L++){var oe=V[L];E.push(z[oe])}}var h=typeof n=="function"?n:function(A){return $o(A,n)},g=l.table.core,I=g.schema.primaryKey,m=I.outbound,C=I.extractKey,N=200,I=a.db._options.modifyChunkSize,E=(I&&(N=typeof I=="object"?I[g.name]||I["*"]||200:I),[]),P=0,O=[],R=n===rl;return a.clone().primaryKeys().then(function(A){function j(L){var V=Math.min(N,A.length-L),oe=A.slice(L,L+V);return(R?Promise.resolve([]):g.getMany({trans:u,keys:oe,cache:"immutable"})).then(function(ke){var xe=[],ce=[],Re=m?[]:null,Ce=R?oe:[];if(!R)for(var me=0;me<V;++me){var Pe=ke[me],Ze={value:ne(Pe),primKey:A[L+me]};h.call(Ze,Ze.value,Ze)!==!1&&(Ze.value==null?Ce.push(A[L+me]):m||Xe(C(Pe),C(Ze.value))===0?(ce.push(Ze.value),m&&Re.push(A[L+me])):(Ce.push(A[L+me]),xe.push(Ze.value)))}return Promise.resolve(0<xe.length&&g.mutate({trans:u,type:"add",values:xe}).then(function(tt){for(var je in tt.failures)Ce.splice(parseInt(je),1);f(xe.length,tt)})).then(function(){return(0<ce.length||z&&typeof n=="object")&&g.mutate({trans:u,type:"put",keys:Re,values:ce,criteria:z,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<L}).then(function(tt){return f(ce.length,tt)})}).then(function(){return(0<Ce.length||z&&R)&&g.mutate({trans:u,type:"delete",keys:Ce,criteria:z,isAdditionalChunk:0<L}).then(function(tt){return ks(l.table,Ce,tt)}).then(function(tt){return f(Ce.length,tt)})}).then(function(){return A.length>L+V&&j(L+N)})})}var z=ha(l)&&l.limit===1/0&&(typeof n!="function"||R)&&{index:l.index,range:l.range};return j(0).then(function(){if(0<E.length)throw new pe("Error modifying one or more objects",E,P,O);return A.length})})})},et.prototype.delete=function(){var n=this._ctx,a=n.range;return!ha(n)||n.table.schema.yProps||!n.isPrimKey&&a.type!==3?this.modify(rl):this._write(function(l){var u=n.table.core.schema.primaryKey,f=a;return n.table.core.count({trans:l,query:{index:u,range:f}}).then(function(h){return n.table.core.mutate({trans:l,type:"deleteRange",range:f}).then(function(C){var m=C.failures,C=C.numFailures;if(C)throw new pe("Could not delete some values",Object.keys(m).map(function(N){return m[N]}),h-C);return h-C})})})};var Yc=et;function et(){}var rl=function(n,a){return a.value=null};function Vc(n,a){return n<a?-1:n===a?0:1}function Qc(n,a){return a<n?-1:n===a?0:1}function an(n,a,l){return n=n instanceof sl?new n.Collection(n):n,n._ctx.error=new(l||TypeError)(a),n}function pa(n){return new n.Collection(n,function(){return al("")}).limit(0)}function Es(O,a,l,u){var f,h,g,m,C,N,I,E=l.length;if(!l.every(function(A){return typeof A=="string"}))return an(O,ht);function P(A){f=A==="next"?function(z){return z.toUpperCase()}:function(z){return z.toLowerCase()},h=A==="next"?function(z){return z.toLowerCase()}:function(z){return z.toUpperCase()},g=A==="next"?Vc:Qc;var j=l.map(function(z){return{lower:h(z),upper:f(z)}}).sort(function(z,L){return g(z.lower,L.lower)});m=j.map(function(z){return z.upper}),C=j.map(function(z){return z.lower}),I=(N=A)==="next"?"":u}P("next");var O=new O.Collection(O,function(){return _r(m[0],C[E-1]+u)}),R=(O._ondirectionchange=function(A){P(A)},0);return O._addAlgorithm(function(A,j,z){var L=A.key;if(typeof L=="string"){var V=h(L);if(a(V,C,R))return!0;for(var oe=null,ke=R;ke<E;++ke){var xe=((ce,Re,Ce,me,Pe,Ze)=>{for(var tt=Math.min(ce.length,me.length),je=-1,Ge=0;Ge<tt;++Ge){var pt=Re[Ge];if(pt!==me[Ge])return Pe(ce[Ge],Ce[Ge])<0?ce.substr(0,Ge)+Ce[Ge]+Ce.substr(Ge+1):Pe(ce[Ge],me[Ge])<0?ce.substr(0,Ge)+me[Ge]+Ce.substr(Ge+1):0<=je?ce.substr(0,je)+Re[je]+Ce.substr(je+1):null;Pe(ce[Ge],pt)<0&&(je=Ge)}return tt<me.length&&Ze==="next"?ce+Ce.substr(ce.length):tt<ce.length&&Ze==="prev"?ce.substr(0,Ce.length):je<0?null:ce.substr(0,je)+me[je]+Ce.substr(je+1)})(L,V,m[ke],C[ke],g,N);xe===null&&oe===null?R=ke+1:(oe===null||0<g(oe,xe))&&(oe=xe)}j(oe!==null?function(){A.continue(oe+I)}:z)}return!1}),O}function _r(n,a,l,u){return{type:2,lower:n,upper:a,lowerOpen:l,upperOpen:u}}function al(n){return{type:1,lower:n,upper:n}}Object.defineProperty(St.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),St.prototype.between=function(n,a,l,u){l=l!==!1,u=u===!0;try{return 0<this._cmp(n,a)||this._cmp(n,a)===0&&(l||u)&&(!l||!u)?pa(this):new this.Collection(this,function(){return _r(n,a,!l,!u)})}catch{return an(this,it)}},St.prototype.equals=function(n){return n==null?an(this,it):new this.Collection(this,function(){return al(n)})},St.prototype.above=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(n,void 0,!0)})},St.prototype.aboveOrEqual=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(n,void 0,!1)})},St.prototype.below=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(void 0,n,!1,!0)})},St.prototype.belowOrEqual=function(n){return n==null?an(this,it):new this.Collection(this,function(){return _r(void 0,n)})},St.prototype.startsWith=function(n){return typeof n!="string"?an(this,ht):this.between(n,n+$e,!0,!0)},St.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Es(this,function(a,l){return a.indexOf(l[0])===0},[n],$e)},St.prototype.equalsIgnoreCase=function(n){return Es(this,function(a,l){return a===l[0]},[n],"")},St.prototype.anyOfIgnoreCase=function(){var n=$.apply(ee,arguments);return n.length===0?pa(this):Es(this,function(a,l){return l.indexOf(a)!==-1},n,"")},St.prototype.startsWithAnyOfIgnoreCase=function(){var n=$.apply(ee,arguments);return n.length===0?pa(this):Es(this,function(a,l){return l.some(function(u){return a.indexOf(u)===0})},n,$e)},St.prototype.anyOf=function(){var n,a,l=this,u=$.apply(ee,arguments),f=this._cmp;try{u.sort(f)}catch{return an(this,it)}return u.length===0?pa(this):((n=new this.Collection(this,function(){return _r(u[0],u[u.length-1])}))._ondirectionchange=function(h){f=h==="next"?l._ascending:l._descending,u.sort(f)},a=0,n._addAlgorithm(function(h,g,m){for(var C=h.key;0<f(C,u[a]);)if(++a===u.length)return g(m),!1;return f(C,u[a])===0||(g(function(){h.continue(u[a])}),!1)}),n)},St.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},St.prototype.noneOf=function(){var n=$.apply(ee,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return an(this,it)}var a=n.reduce(function(l,u){return l?l.concat([[l[l.length-1][1],u]]):[[-1/0,u]]},null);return a.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},St.prototype.inAnyRange=function(n,z){var l=this,u=this._cmp,f=this._ascending,h=this._descending,g=this._min,m=this._max;if(n.length===0)return pa(this);if(!n.every(function(L){return L[0]!==void 0&&L[1]!==void 0&&f(L[0],L[1])<=0}))return an(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",be.InvalidArgument);var C=!z||z.includeLowers!==!1,N=z&&z.includeUppers===!0,I,E=f;function P(L,V){return E(L[0],V[0])}try{(I=n.reduce(function(L,V){for(var oe=0,ke=L.length;oe<ke;++oe){var xe=L[oe];if(u(V[0],xe[1])<0&&0<u(V[1],xe[0])){xe[0]=g(xe[0],V[0]),xe[1]=m(xe[1],V[1]);break}}return oe===ke&&L.push(V),L},[])).sort(P)}catch{return an(this,it)}var O=0,R=N?function(L){return 0<f(L,I[O][1])}:function(L){return 0<=f(L,I[O][1])},A=C?function(L){return 0<h(L,I[O][0])}:function(L){return 0<=h(L,I[O][0])},j=R,z=new this.Collection(this,function(){return _r(I[0][0],I[I.length-1][1],!C,!N)});return z._ondirectionchange=function(L){E=L==="next"?(j=R,f):(j=A,h),I.sort(P)},z._addAlgorithm(function(L,V,oe){for(var ke,xe=L.key;j(xe);)if(++O===I.length)return V(oe),!1;return!R(ke=xe)&&!A(ke)||(l._cmp(xe,I[O][1])===0||l._cmp(xe,I[O][0])===0||V(function(){E===f?L.continue(I[O][0]):L.continue(I[O][1])}),!1)}),z},St.prototype.startsWithAnyOf=function(){var n=$.apply(ee,arguments);return n.every(function(a){return typeof a=="string"})?n.length===0?pa(this):this.inAnyRange(n.map(function(a){return[a,a+$e]})):an(this,"startsWithAnyOf() only works with strings")};var sl=St;function St(){}function Gn(n){return st(function(a){return za(a),n(a.target.error),!1})}function za(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Fa="storagemutated",gi="x-storagemutated-1",wr=ja(null,Fa),Xc=(Hn.prototype._lock=function(){return U(!De.global),++this._reculock,this._reculock!==1||De.global||(De.lockOwnerFor=this),this},Hn.prototype._unlock=function(){if(U(!De.global),--this._reculock==0)for(De.global||(De.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Me(n[1],n[0])}catch{}}return this},Hn.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},Hn.prototype.create=function(n){var a=this;if(this.mode){var l=this.db.idbdb,u=this.db._state.dbOpenError;if(U(!this.idbtrans),!n&&!l)switch(u&&u.name){case"DatabaseClosedError":throw new be.DatabaseClosed(u);case"MissingAPIError":throw new be.MissingAPI(u.message,u);default:throw new be.OpenFailed(u)}if(!this.active)throw new be.TransactionInactive;U(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=st(function(f){za(f),a._reject(n.error)}),n.onabort=st(function(f){za(f),a.active&&a._reject(new be.Abort(n.error)),a.active=!1,a.on("abort").fire(f)}),n.oncomplete=st(function(){a.active=!1,a._resolve(),"mutatedParts"in n&&wr.storagemutated.fire(n.mutatedParts)})}return this},Hn.prototype._promise=function(n,a,l){var u,f=this;return n==="readwrite"&&this.mode!=="readwrite"?we(new be.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Te(function(h,g){f._blockedFuncs.push([function(){f._promise(n,a,l).then(h,g)},De])}):l?Cn(function(){var h=new Te(function(g,m){f._lock();var C=a(g,m,f);C&&C.then&&C.then(g,m)});return h.finally(function(){return f._unlock()}),h._lib=!0,h}):((u=new Te(function(h,g){var m=a(h,g,f);m&&m.then&&m.then(h,g)}))._lib=!0,u):we(new be.TransactionInactive)},Hn.prototype._root=function(){return this.parent?this.parent._root():this},Hn.prototype.waitFor=function(n){var a,l=this._root(),u=Te.resolve(n),f=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return u}):(l._waitingFor=u,l._waitingQueue=[],a=l.idbtrans.objectStore(l.storeNames[0]),(function h(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(a.get(-1/0).onsuccess=h)})()),l._waitingFor);return new Te(function(h,g){u.then(function(m){return l._waitingQueue.push(st(h.bind(null,m)))},function(m){return l._waitingQueue.push(st(g.bind(null,m)))}).finally(function(){l._waitingFor===f&&(l._waitingFor=null)})})},Hn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new be.Abort))},Hn.prototype.table=function(n){var a=this._memoizedTables||(this._memoizedTables={});if(x(a,n))return a[n];var l=this.schema[n];if(l)return(l=new this.db.Table(n,l,this)).core=this.db.core.table(n),a[n]=l;throw new be.NotFound("Table "+n+" not part of transaction")},Hn);function Hn(){}function mi(n,a,l,u,f,h,g,m){return{name:n,keyPath:a,unique:l,multi:u,auto:f,compound:h,src:(l&&!g?"&":"")+(u?"*":"")+(f?"++":"")+il(a),type:m}}function il(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function yi(n,a,l){return{name:n,primKey:a,indexes:l,mappedClass:null,idxByName:(u=function(f){return[f.name,f]},l.reduce(function(f,h,g){return h=u(h,g),h&&(f[h[0]]=h[1]),f},{}))};var u}var Ka=function(n){try{return n.only([[]]),Ka=function(){return[[]]},[[]]}catch{return Ka=function(){return $e},$e}};function bi(n){return n==null?function(){}:typeof n=="string"?(a=n).split(".").length===1?function(l){return l[a]}:function(l){return J(l,a)}:function(l){return J(l,n)};var a}function ol(n){return[].slice.call(n)}var Zc=0;function Ua(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Jc(n,a,C){function u(R){if(R.type===3)return null;if(R.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=R.lower,P=R.upper,O=R.lowerOpen,R=R.upperOpen;return E===void 0?P===void 0?null:a.upperBound(P,!!R):P===void 0?a.lowerBound(E,!!O):a.bound(E,P,!!O,!!R)}function f(I){var E,P=I.name;return{name:P,schema:I,mutate:function(O){var R=O.trans,A=O.type,j=O.keys,z=O.values,L=O.range;return new Promise(function(V,oe){V=st(V);var ke=R.objectStore(P),xe=ke.keyPath==null,ce=A==="put"||A==="add";if(!ce&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var Re,Ce=(j||z||{length:1}).length;if(j&&z&&j.length!==z.length)throw new Error("Given keys array must have same length as given values array.");if(Ce===0)return V({numFailures:0,failures:{},results:[],lastResult:void 0});function me(mt){++tt,za(mt)}var Pe=[],Ze=[],tt=0;if(A==="deleteRange"){if(L.type===4)return V({numFailures:tt,failures:Ze,results:[],lastResult:void 0});L.type===3?Pe.push(Re=ke.clear()):Pe.push(Re=ke.delete(u(L)))}else{var xe=ce?xe?[z,j]:[z,null]:[j,null],je=xe[0],Ge=xe[1];if(ce)for(var pt=0;pt<Ce;++pt)Pe.push(Re=Ge&&Ge[pt]!==void 0?ke[A](je[pt],Ge[pt]):ke[A](je[pt])),Re.onerror=me;else for(pt=0;pt<Ce;++pt)Pe.push(Re=ke[A](je[pt])),Re.onerror=me}function vn(mt){mt=mt.target.result,Pe.forEach(function(Gr,qi){return Gr.error!=null&&(Ze[qi]=Gr.error)}),V({numFailures:tt,failures:Ze,results:A==="delete"?j:Pe.map(function(Gr){return Gr.result}),lastResult:mt})}Re.onerror=function(mt){me(mt),vn(mt)},Re.onsuccess=vn})},getMany:function(O){var R=O.trans,A=O.keys;return new Promise(function(j,z){j=st(j);for(var L,V=R.objectStore(P),oe=A.length,ke=new Array(oe),xe=0,ce=0,Re=function(Pe){Pe=Pe.target,ke[Pe._pos]=Pe.result,++ce===xe&&j(ke)},Ce=Gn(z),me=0;me<oe;++me)A[me]!=null&&((L=V.get(A[me]))._pos=me,L.onsuccess=Re,L.onerror=Ce,++xe);xe===0&&j(ke)})},get:function(O){var R=O.trans,A=O.key;return new Promise(function(j,z){j=st(j);var L=R.objectStore(P).get(A);L.onsuccess=function(V){return j(V.target.result)},L.onerror=Gn(z)})},query:(E=m,function(O){return new Promise(function(R,A){R=st(R);var j,z,L,ce=O.trans,V=O.values,oe=O.limit,xe=O.query,ke=oe===1/0?void 0:oe,Re=xe.index,xe=xe.range,ce=ce.objectStore(P),ce=Re.isPrimaryKey?ce:ce.index(Re.name),Re=u(xe);if(oe===0)return R({result:[]});E?((xe=V?ce.getAll(Re,ke):ce.getAllKeys(Re,ke)).onsuccess=function(Ce){return R({result:Ce.target.result})},xe.onerror=Gn(A)):(j=0,z=!V&&"openKeyCursor"in ce?ce.openKeyCursor(Re):ce.openCursor(Re),L=[],z.onsuccess=function(Ce){var me=z.result;return!me||(L.push(V?me.value:me.primaryKey),++j===oe)?R({result:L}):void me.continue()},z.onerror=Gn(A))})}),openCursor:function(O){var R=O.trans,A=O.values,j=O.query,z=O.reverse,L=O.unique;return new Promise(function(V,oe){V=st(V);var ce=j.index,ke=j.range,xe=R.objectStore(P),xe=ce.isPrimaryKey?xe:xe.index(ce.name),ce=z?L?"prevunique":"prev":L?"nextunique":"next",Re=!A&&"openKeyCursor"in xe?xe.openKeyCursor(u(ke),ce):xe.openCursor(u(ke),ce);Re.onerror=Gn(oe),Re.onsuccess=st(function(Ce){var me,Pe,Ze,tt,je=Re.result;je?(je.___id=++Zc,je.done=!1,me=je.continue.bind(je),Pe=(Pe=je.continuePrimaryKey)&&Pe.bind(je),Ze=je.advance.bind(je),tt=function(){throw new Error("Cursor not stopped")},je.trans=R,je.stop=je.continue=je.continuePrimaryKey=je.advance=function(){throw new Error("Cursor not started")},je.fail=st(oe),je.next=function(){var Ge=this,pt=1;return this.start(function(){return pt--?Ge.continue():Ge.stop()}).then(function(){return Ge})},je.start=function(Ge){function pt(){if(Re.result)try{Ge()}catch(mt){je.fail(mt)}else je.done=!0,je.start=function(){throw new Error("Cursor behind last entry")},je.stop()}var vn=new Promise(function(mt,Gr){mt=st(mt),Re.onerror=Gn(Gr),je.fail=Gr,je.stop=function(qi){je.stop=je.continue=je.continuePrimaryKey=je.advance=tt,mt(qi)}});return Re.onsuccess=st(function(mt){Re.onsuccess=pt,pt()}),je.continue=me,je.continuePrimaryKey=Pe,je.advance=Ze,pt(),vn},V(je)):V(null)},oe)})},count:function(O){var R=O.query,A=O.trans,j=R.index,z=R.range;return new Promise(function(L,V){var oe=A.objectStore(P),oe=j.isPrimaryKey?oe:oe.index(j.name),ke=u(z),ke=ke?oe.count(ke):oe.count();ke.onsuccess=st(function(xe){return L(xe.target.result)}),ke.onerror=Gn(V)})}}}h=C,g=ol((C=n).objectStoreNames);var h,C={schema:{name:C.name,tables:g.map(function(I){return h.objectStore(I)}).map(function(I){var E=I.keyPath,P=I.autoIncrement,R=d(E),O={},R={name:I.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:E==null,compound:R,keyPath:E,autoIncrement:P,unique:!0,extractKey:bi(E)},indexes:ol(I.indexNames).map(function(A){return I.index(A)}).map(function(L){var V=L.name,j=L.unique,z=L.multiEntry,L=L.keyPath,V={name:V,compound:d(L),keyPath:L,unique:j,multiEntry:z,extractKey:bi(L)};return O[Ua(L)]=V}),getIndexByKeyPath:function(A){return O[Ua(A)]}};return O[":id"]=R.primaryKey,E!=null&&(O[Ua(E)]=R.primaryKey),R})},hasGetAll:0<g.length&&"getAll"in h.objectStore(g[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},g=C.schema,m=C.hasGetAll,C=g.tables.map(f),N={};return C.forEach(function(I){return N[I.name]=I}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(I){if(N[I])return N[I];throw new Error("Table '".concat(I,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ka(a),schema:g}}function $c(n,a,l,u){return l=l.IDBKeyRange,a=Jc(a,l,u),{dbcore:n.dbcore.reduce(function(f,h){return h=h.create,s(s({},f),h(f))},a)}}function Ts(n,a){var l=a.db,l=$c(n._middlewares,l,n._deps,a);n.core=l.dbcore,n.tables.forEach(function(u){var f=u.name;n.core.schema.tables.some(function(h){return h.name===f})&&(u.core=n.core.table(f),n[f]instanceof n.Table)&&(n[f].core=u.core)})}function As(n,a,l,u){l.forEach(function(f){var h=u[f];a.forEach(function(g){var m=(function C(N,I){return S(N,I)||(N=p(N))&&C(N,I)})(g,f);(!m||"value"in m&&m.value===void 0)&&(g===n.Transaction.prototype||g instanceof n.Transaction?M(g,f,{get:function(){return this.table(f)},set:function(C){w(this,f,{value:C,writable:!0,configurable:!0,enumerable:!0})}}):g[f]=new n.Table(f,h))})})}function _i(n,a){a.forEach(function(l){for(var u in l)l[u]instanceof n.Table&&delete l[u]})}function ef(n,a){return n._cfg.version-a._cfg.version}function tf(n,a,l,u){var f=n._dbSchema,h=(l.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=yi("$meta",ul("")[0],[]),n._storeNames.push("$meta")),n._createTransaction("readwrite",n._storeNames,f)),g=(h.create(l),h._completion.catch(u),h._reject.bind(h)),m=De.transless||De;Cn(function(){if(De.trans=h,De.transless=m,a!==0)return Ts(n,l),N=a,((C=h).storeNames.includes("$meta")?C.table("$meta").get("version").then(function(I){return I??N}):Te.resolve(N)).then(function(j){var E=n,P=j,O=h,R=l,A=[],j=E._versions,z=E._dbSchema=Is(0,E.idbdb,R);return(j=j.filter(function(L){return L._cfg.version>=P})).length===0?Te.resolve():(j.forEach(function(L){A.push(function(){var V,oe,ke,xe=z,ce=L._cfg.dbschema,Re=(Rs(E,xe,R),Rs(E,ce,R),z=E._dbSchema=ce,wi(xe,ce)),Ce=(Re.add.forEach(function(me){ki(R,me[0],me[1].primKey,me[1].indexes)}),Re.change.forEach(function(me){if(me.recreate)throw new be.Upgrade("Not yet support for changing primary key");var Pe=R.objectStore(me.name);me.add.forEach(function(Ze){return Cs(Pe,Ze)}),me.change.forEach(function(Ze){Pe.deleteIndex(Ze.name),Cs(Pe,Ze)}),me.del.forEach(function(Ze){return Pe.deleteIndex(Ze)})}),L._cfg.contentUpgrade);if(Ce&&L._cfg.version>P)return Ts(E,R),O._memoizedTables={},V=ge(ce),Re.del.forEach(function(me){V[me]=xe[me]}),_i(E,[E.Transaction.prototype]),As(E,[E.Transaction.prototype],c(V),V),O.schema=V,(oe=he(Ce))&&Lt(),ce=Te.follow(function(){var me;(ke=Ce(O))&&oe&&(me=In.bind(null,null),ke.then(me,me))}),ke&&typeof ke.then=="function"?Te.resolve(ke):ce.then(function(){return ke})}),A.push(function(V){var oe,ke,xe=L._cfg.dbschema;oe=xe,ke=V,[].slice.call(ke.db.objectStoreNames).forEach(function(ce){return oe[ce]==null&&ke.db.deleteObjectStore(ce)}),_i(E,[E.Transaction.prototype]),As(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),O.schema=E._dbSchema}),A.push(function(V){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===L._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(oe){return oe!=="$meta"})):V.objectStore("$meta").put(L._cfg.version,"version"))})}),(function L(){return A.length?Te.resolve(A.shift()(O.idbtrans)).then(L):Te.resolve()})().then(function(){ll(z,R)}))}).catch(g);var C,N;c(f).forEach(function(I){ki(l,I,f[I].primKey,f[I].indexes)}),Ts(n,l),Te.follow(function(){return n.on.populate.fire(h)}).catch(g)})}function nf(n,a){ll(n._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var l=Is(0,n.idbdb,a);Rs(n,n._dbSchema,a);for(var u=0,f=wi(l,n._dbSchema).change;u<f.length;u++){var h=(g=>{if(g.change.length||g.recreate)return console.warn("Unable to patch indexes of table ".concat(g.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(g.name);g.add.forEach(function(C){zt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(g.name,".").concat(C.src)),Cs(m,C)})})(f[u]);if(typeof h=="object")return h.value}}function wi(n,a){var l,u={del:[],add:[],change:[]};for(l in n)a[l]||u.del.push(l);for(l in a){var f=n[l],h=a[l];if(f){var g={name:l,def:h,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(h.primKey.keyPath||"")||f.primKey.auto!==h.primKey.auto)g.recreate=!0,u.change.push(g);else{var m=f.idxByName,C=h.idxByName,N=void 0;for(N in m)C[N]||g.del.push(N);for(N in C){var I=m[N],E=C[N];I?I.src!==E.src&&g.change.push(E):g.add.push(E)}(0<g.del.length||0<g.add.length||0<g.change.length)&&u.change.push(g)}}else u.add.push([l,h])}return u}function ki(n,a,l,u){var f=n.db.createObjectStore(a,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});u.forEach(function(h){return Cs(f,h)})}function ll(n,a){c(n).forEach(function(l){a.db.objectStoreNames.contains(l)||(zt&&console.debug("Dexie: Creating missing table",l),ki(a,l,n[l].primKey,n[l].indexes))})}function Cs(n,a){n.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function Is(n,a,l){var u={};return te(a.objectStoreNames,0).forEach(function(f){for(var h=l.objectStore(f),g=mi(il(N=h.keyPath),N||"",!0,!1,!!h.autoIncrement,N&&typeof N!="string",!0),m=[],C=0;C<h.indexNames.length;++C){var I=h.index(h.indexNames[C]),N=I.keyPath,I=mi(I.name,N,!!I.unique,!!I.multiEntry,!1,N&&typeof N!="string",!1);m.push(I)}u[f]=yi(f,g,m)}),u}function Rs(n,a,l){for(var u=l.db.objectStoreNames,f=0;f<u.length;++f){var h=u[f],g=l.objectStore(h);n._hasGetAll="getAll"in g;for(var m=0;m<g.indexNames.length;++m){var C,N=g.indexNames[m],I=g.index(N).keyPath,I=typeof I=="string"?I:"["+te(I).join("+")+"]";a[h]&&(C=a[h].idxByName[I])&&(C.name=N,delete a[h].idxByName[I],a[h].idxByName[N]=C)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ul(n){return n.split(",").map(function(a,l){var f=a.split(":"),u=(u=f[1])==null?void 0:u.trim(),f=(a=f[0].trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return mi(f,h||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),d(h),l===0,u)})}va.prototype._createTableSchema=yi,va.prototype._parseIndexSyntax=ul,va.prototype._parseStoresSpec=function(n,a){var l=this;c(n).forEach(function(u){if(n[u]!==null){var f=l._parseIndexSyntax(n[u]),h=f.shift();if(!h)throw new be.Schema("Invalid schema for table "+u+": "+n[u]);if(h.unique=!0,h.multi)throw new be.Schema("Primary key cannot be multiEntry*");f.forEach(function(g){if(g.auto)throw new be.Schema("Only primary key can be marked as autoIncrement (++)");if(!g.keyPath)throw new be.Schema("Index must have a name and cannot be an empty string")}),h=l._createTableSchema(u,h,f),a[u]=h}})},va.prototype.stores=function(l){var a=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?v(this._cfg.storesSource,l):l,a._versions),u={},f={};return l.forEach(function(h){v(u,h._cfg.storesSource),f=h._cfg.dbschema={},h._parseStoresSpec(u,f)}),a._dbSchema=f,_i(a,[a._allTables,a,a.Transaction.prototype]),As(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],c(f),f),a._storeNames=c(f),this},va.prototype.upgrade=function(n){return this._cfg.contentUpgrade=zn(this._cfg.contentUpgrade||Ke,n),this};var rf=va;function va(){}function xi(n,a){var l=n._dbNamesDB;return l||(l=n._dbNamesDB=new rr(Wt,{addons:[],indexedDB:n,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Si(n){return n&&typeof n.databases=="function"}function Ei(n){return Cn(function(){return De.letThrough=!0,n()})}function Ti(n){return!("from"in n)}var Nt=function(n,a){var l;if(!this)return l=new Nt,n&&"d"in n&&v(l,n),l;v(this,arguments.length?{d:1,from:n,to:1<arguments.length?a:n}:{d:0})};function Ga(n,a,l){var u=Xe(a,l);if(!isNaN(u)){if(0<u)throw RangeError();if(Ti(n))return v(n,{from:a,to:l,d:1});var u=n.l,f=n.r;if(Xe(l,n.from)<0)return u?Ga(u,a,l):n.l={from:a,to:l,d:1,l:null,r:null},fl(n);if(0<Xe(a,n.to))return f?Ga(f,a,l):n.r={from:a,to:l,d:1,l:null,r:null},fl(n);Xe(a,n.from)<0&&(n.from=a,n.l=null,n.d=f?f.d+1:1),0<Xe(l,n.to)&&(n.to=l,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,u&&!n.l&&Ha(n,u),f&&a&&Ha(n,f)}}function Ha(n,a){Ti(a)||(function l(u,f){var h=f.from,g=f.l,m=f.r;Ga(u,h,f.to),g&&l(u,g),m&&l(u,m)})(n,a)}function cl(n,a){var l=Ps(a),u=l.next();if(!u.done)for(var f=u.value,h=Ps(n),g=h.next(f.from),m=g.value;!u.done&&!g.done;){if(Xe(m.from,f.to)<=0&&0<=Xe(m.to,f.from))return!0;Xe(f.from,m.from)<0?f=(u=l.next(m.from)).value:m=(g=h.next(f.from)).value}return!1}function Ps(n){var a=Ti(n)?null:{s:0,n};return{next:function(l){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&Xe(l,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||Xe(l,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function fl(n){var a,l,u,f=(((f=n.r)==null?void 0:f.d)||0)-(((f=n.l)==null?void 0:f.d)||0),f=1<f?"r":f<-1?"l":"";f&&(a=f=="r"?"l":"r",l=s({},n),u=n[f],n.from=u.from,n.to=u.to,n[f]=u[f],l[f]=u[a],(n[a]=l).d=dl(l)),n.d=dl(n)}function dl(l){var a=l.r,l=l.l;return(a?l?Math.max(a.d,l.d):a.d:l?l.d:0)+1}function Os(n,a){return c(a).forEach(function(l){n[l]?Ha(n[l],a[l]):n[l]=(function u(f){var h,g,m={};for(h in f)x(f,h)&&(g=f[h],m[h]=!g||typeof g!="object"||ve.has(g.constructor)?g:u(g));return m})(a[l])}),n}function Ai(n,a){return n.all||a.all||Object.keys(n).some(function(l){return a[l]&&cl(a[l],n[l])})}_(Nt.prototype,((ze={add:function(n){return Ha(this,n),this},addKey:function(n){return Ga(this,n,n),this},addKeys:function(n){var a=this;return n.forEach(function(l){return Ga(a,l,l)}),this},hasKey:function(n){var a=Ps(this).next(n).value;return a&&Xe(a.from,n)<=0&&0<=Xe(a.to,n)}})[le]=function(){return Ps(this)},ze));var Kr={},Ci={},Ii=!1;function Ds(n){Os(Ci,n),Ii||(Ii=!0,setTimeout(function(){Ii=!1,Ri(Ci,!(Ci={}))},0))}function Ri(n,a){a===void 0&&(a=!1);var l=new Set;if(n.all)for(var u=0,f=Object.values(Kr);u<f.length;u++)hl(m=f[u],n,l,a);else for(var h in n){var g,m,h=/^idb\:\/\/(.*)\/(.*)\//.exec(h);h&&(g=h[1],h=h[2],m=Kr["idb://".concat(g,"/").concat(h)])&&hl(m,n,l,a)}l.forEach(function(C){return C()})}function hl(n,a,l,u){for(var f=[],h=0,g=Object.entries(n.queries.query);h<g.length;h++){for(var m=g[h],C=m[0],N=[],I=0,E=m[1];I<E.length;I++){var P=E[I];Ai(a,P.obsSet)?P.subscribers.forEach(function(j){return l.add(j)}):u&&N.push(P)}u&&f.push([C,N])}if(u)for(var O=0,R=f;O<R.length;O++){var A=R[O],C=A[0],N=A[1];n.queries.query[C]=N}}function af(n){var a=n._state,l=n._deps.indexedDB;if(a.isBeingOpened||n.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?we(a.dbOpenError):n});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,f=Math.round(10*n.verno),h=!1;function g(){if(a.openCanceller!==u)throw new be.DatabaseClosed("db.open() was cancelled")}function m(){return new Te(function(P,O){if(g(),!l)throw new be.MissingAPI;var R=n.name,A=a.autoSchema||!f?l.open(R):l.open(R,f);if(!A)throw new be.MissingAPI;A.onerror=Gn(O),A.onblocked=st(n._fireOnBlocked),A.onupgradeneeded=st(function(j){var z;I=A.transaction,a.autoSchema&&!n._options.allowEmptyDB?(A.onerror=za,I.abort(),A.result.close(),(z=l.deleteDatabase(R)).onsuccess=z.onerror=st(function(){O(new be.NoSuchDatabase("Database ".concat(R," doesnt exist")))})):(I.onerror=Gn(O),z=j.oldVersion>Math.pow(2,62)?0:j.oldVersion,E=z<1,n.idbdb=A.result,h&&nf(n,I),tf(n,z/10,I,O))},O),A.onsuccess=st(function(){I=null;var j,z,L,V,oe,ke,xe=n.idbdb=A.result,ce=te(xe.objectStoreNames);if(0<ce.length)try{var Re=xe.transaction((oe=ce).length===1?oe[0]:oe,"readonly");if(a.autoSchema)ke=xe,V=Re,(L=n).verno=ke.version/10,V=L._dbSchema=Is(0,ke,V),L._storeNames=te(ke.objectStoreNames,0),As(L,[L._allTables],c(V),V);else if(Rs(n,n._dbSchema,Re),z=Re,((z=wi(Is(0,(j=n).idbdb,z),j._dbSchema)).add.length||z.change.some(function(Ce){return Ce.add.length||Ce.change.length}))&&!h)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),xe.close(),f=xe.version+1,h=!0,P(m());Ts(n,Re)}catch{}bt.push(n),xe.onversionchange=st(function(Ce){a.vcFired=!0,n.on("versionchange").fire(Ce)}),xe.onclose=st(function(){n.close({disableAutoOpen:!1})}),E&&(ce=n._deps,oe=R,Si(ke=ce.indexedDB)||oe===Wt||xi(ke,ce.IDBKeyRange).put({name:oe}).catch(Ke)),P()},O)}).catch(function(P){switch(P==null?void 0:P.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<f)return f=0,m()}return Te.reject(P)})}var C,N=a.dbReadyResolve,I=null,E=!1;return Te.race([u,(typeof navigator>"u"?Te.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function O(){return indexedDB.databases().finally(P)}C=setInterval(O,100),O()}).finally(function(){return clearInterval(C)}):Promise.resolve()).then(m)]).then(function(){return g(),a.onReadyBeingFired=[],Te.resolve(Ei(function(){return n.on.ready.fire(n.vip)})).then(function P(){var O;if(0<a.onReadyBeingFired.length)return O=a.onReadyBeingFired.reduce(zn,Ke),a.onReadyBeingFired=[],Te.resolve(Ei(function(){return O(n.vip)})).then(P)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(P){a.dbOpenError=P;try{I&&I.abort()}catch{}return u===a.openCanceller&&n._close(),we(P)}).finally(function(){a.openComplete=!0,N()}).then(function(){var P;return E&&(P={},n.tables.forEach(function(O){O.schema.indexes.forEach(function(R){R.name&&(P["idb://".concat(n.name,"/").concat(O.name,"/").concat(R.name)]=new Nt(-1/0,[[[]]]))}),P["idb://".concat(n.name,"/").concat(O.name,"/")]=P["idb://".concat(n.name,"/").concat(O.name,"/:dels")]=new Nt(-1/0,[[[]]])}),wr(Fa).fire(P),Ri(P,!0)),n})}function Pi(n){function a(h){return n.next(h)}var l=f(a),u=f(function(h){return n.throw(h)});function f(h){return function(m){var m=h(m),C=m.value;return m.done?C:C&&typeof C.then=="function"?C.then(l,u):d(C)?Promise.all(C).then(l,u):l(C)}}return f(a)()}function Ms(n,a,l){for(var u=d(n)?n.slice():[n],f=0;f<l;++f)u.push(a);return u}var sf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return s(s({},n),{table:function(u){var l=n.table(u),u=l.schema,f={},h=[];function g(P,O,R){var L=Ua(P),A=f[L]=f[L]||[],j=P==null?0:typeof P=="string"?1:P.length,z=0<O,L=s(s({},R),{name:z?"".concat(L,"(virtual-from:").concat(R.name,")"):R.name,lowLevelIndex:R,isVirtual:z,keyTail:O,keyLength:j,extractKey:bi(P),unique:!z&&R.unique});return A.push(L),L.isPrimaryKey||h.push(L),1<j&&g(j===2?P[0]:P.slice(0,j-1),O+1,R),A.sort(function(V,oe){return V.keyTail-oe.keyTail}),L}var m=g(u.primaryKey.keyPath,0,u.primaryKey);f[":id"]=[m];for(var C=0,N=u.indexes;C<N.length;C++){var I=N[C];g(I.keyPath,0,I)}function E(P){var O,R=P.query.index;return R.isVirtual?s(s({},P),{query:{index:R.lowLevelIndex,range:(O=P.query.range,R=R.keyTail,{type:O.type===1?2:O.type,lower:Ms(O.lower,O.lowerOpen?n.MAX_KEY:n.MIN_KEY,R),lowerOpen:!0,upper:Ms(O.upper,O.upperOpen?n.MIN_KEY:n.MAX_KEY,R),upperOpen:!0})}}):P}return s(s({},l),{schema:s(s({},u),{primaryKey:m,indexes:h,getIndexByKeyPath:function(P){return(P=f[Ua(P)])&&P[0]}}),count:function(P){return l.count(E(P))},query:function(P){return l.query(E(P))},openCursor:function(P){var O=P.query.index,R=O.keyTail,A=O.keyLength;return O.isVirtual?l.openCursor(E(P)).then(function(z){return z&&j(z)}):l.openCursor(P);function j(z){return Object.create(z,{continue:{value:function(L){L!=null?z.continue(Ms(L,P.reverse?n.MAX_KEY:n.MIN_KEY,R)):P.unique?z.continue(z.key.slice(0,A).concat(P.reverse?n.MIN_KEY:n.MAX_KEY,R)):z.continue()}},continuePrimaryKey:{value:function(L,V){z.continuePrimaryKey(Ms(L,n.MAX_KEY,R),V)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var L=z.key;return A===1?L[0]:L.slice(0,A)}},value:{get:function(){return z.value}}})}}})}})}};function Oi(n,a,l,u){return l=l||{},u=u||"",c(n).forEach(function(f){var h,g,m;x(a,f)?(h=n[f],g=a[f],typeof h=="object"&&typeof g=="object"&&h&&g?(m=se(h))!==se(g)?l[u+f]=a[f]:m==="Object"?Oi(h,g,l,u+f+"."):h!==g&&(l[u+f]=a[f]):h!==g&&(l[u+f]=a[f])):l[u+f]=void 0}),c(a).forEach(function(f){x(n,f)||(l[u+f]=a[f])}),l}function Di(n,a){return a.type==="delete"?a.keys:a.keys||a.values.map(n.extractKey)}var of={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return s(s({},n),{table:function(a){var l=n.table(a),u=l.schema.primaryKey;return s(s({},l),{mutate:function(f){var h=De.trans,g=h.table(a).hook,m=g.deleting,C=g.creating,N=g.updating;switch(f.type){case"add":if(C.fire===Ke)break;return h._promise("readwrite",function(){return I(f)},!0);case"put":if(C.fire===Ke&&N.fire===Ke)break;return h._promise("readwrite",function(){return I(f)},!0);case"delete":if(m.fire===Ke)break;return h._promise("readwrite",function(){return I(f)},!0);case"deleteRange":if(m.fire===Ke)break;return h._promise("readwrite",function(){return(function E(P,O,R){return l.query({trans:P,values:!1,query:{index:u,range:O},limit:R}).then(function(A){var j=A.result;return I({type:"delete",keys:j,trans:P}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):j.length<R?{failures:[],numFailures:0,lastResult:void 0}:E(P,s(s({},O),{lower:j[j.length-1],lowerOpen:!0}),R)})})})(f.trans,f.range,1e4)},!0)}return l.mutate(f);function I(E){var P,O,R,A=De.trans,j=E.keys||Di(u,E);if(j)return(E=E.type==="add"||E.type==="put"?s(s({},E),{keys:j}):s({},E)).type!=="delete"&&(E.values=i([],E.values)),E.keys&&(E.keys=i([],E.keys)),P=l,R=j,((O=E).type==="add"?Promise.resolve([]):P.getMany({trans:O.trans,keys:R,cache:"immutable"})).then(function(z){var L=j.map(function(V,oe){var ke,xe,ce,Re=z[oe],Ce={onerror:null,onsuccess:null};return E.type==="delete"?m.fire.call(Ce,V,Re,A):E.type==="add"||Re===void 0?(ke=C.fire.call(Ce,V,E.values[oe],A),V==null&&ke!=null&&(E.keys[oe]=V=ke,u.outbound||Y(E.values[oe],u.keyPath,V))):(ke=Oi(Re,E.values[oe]),(xe=N.fire.call(Ce,ke,V,Re,A))&&(ce=E.values[oe],Object.keys(xe).forEach(function(me){x(ce,me)?ce[me]=xe[me]:Y(ce,me,xe[me])}))),Ce});return l.mutate(E).then(function(V){for(var oe=V.failures,ke=V.results,xe=V.numFailures,V=V.lastResult,ce=0;ce<j.length;++ce){var Re=(ke||j)[ce],Ce=L[ce];Re==null?Ce.onerror&&Ce.onerror(oe[ce]):Ce.onsuccess&&Ce.onsuccess(E.type==="put"&&z[ce]?E.values[ce]:Re)}return{failures:oe,results:ke,numFailures:xe,lastResult:V}}).catch(function(V){return L.forEach(function(oe){return oe.onerror&&oe.onerror(V)}),Promise.reject(V)})});throw new Error("Keys missing")}}})}})}};function pl(n,a,l){try{if(!a||a.keys.length<n.length)return null;for(var u=[],f=0,h=0;f<a.keys.length&&h<n.length;++f)Xe(a.keys[f],n[h])===0&&(u.push(l?ne(a.values[f]):a.values[f]),++h);return u.length===n.length?u:null}catch{return null}}var lf={stack:"dbcore",level:-1,create:function(n){return{table:function(a){var l=n.table(a);return s(s({},l),{getMany:function(u){var f;return u.cache?(f=pl(u.keys,u.trans._cache,u.cache==="clone"))?Te.resolve(f):l.getMany(u).then(function(h){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?ne(h):h},h}):l.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),l.mutate(u)}})}}}};function vl(n,a){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function gl(n,a){switch(n){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var uf={stack:"dbcore",level:0,name:"Observability",create:function(n){var a=n.schema.name,l=new Nt(n.MIN_KEY,n.MAX_KEY);return s(s({},n),{transaction:function(u,f,h){if(De.subscr&&f!=="readonly")throw new be.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(De.querier));return n.transaction(u,f,h)},table:function(u){function f(j){var A,j=j.query;return[A=j.index,new Nt((A=(j=j.range).lower)!=null?A:n.MIN_KEY,(A=j.upper)!=null?A:n.MAX_KEY)]}var h=n.table(u),g=h.schema,m=g.primaryKey,C=g.indexes,N=m.extractKey,I=m.outbound,E=m.autoIncrement&&C.filter(function(R){return R.compound&&R.keyPath.includes(m.keyPath)}),P=s(s({},h),{mutate:function(R){function A(Pe){return Pe="idb://".concat(a,"/").concat(u,"/").concat(Pe),oe[Pe]||(oe[Pe]=new Nt)}var j,z,L,V=R.trans,oe=R.mutatedParts||(R.mutatedParts={}),ke=A(""),xe=A(":dels"),ce=R.type,Ce=R.type==="deleteRange"?[R.range]:R.type==="delete"?[R.keys]:R.values.length<50?[Di(m,R).filter(function(Pe){return Pe}),R.values]:[],Re=Ce[0],Ce=Ce[1],me=R.trans._cache;return d(Re)?(ke.addKeys(Re),(ce=ce==="delete"||Re.length===Ce.length?pl(Re,me):null)||xe.addKeys(Re),(ce||Ce)&&(j=A,z=ce,L=Ce,g.indexes.forEach(function(Pe){var Ze=j(Pe.name||"");function tt(Ge){return Ge!=null?Pe.extractKey(Ge):null}function je(Ge){Pe.multiEntry&&d(Ge)?Ge.forEach(function(pt){return Ze.addKey(pt)}):Ze.addKey(Ge)}(z||L).forEach(function(Ge,mt){var vn=z&&tt(z[mt]),mt=L&&tt(L[mt]);Xe(vn,mt)!==0&&(vn!=null&&je(vn),mt!=null)&&je(mt)})}))):Re?(Ce={from:(me=Re.lower)!=null?me:n.MIN_KEY,to:(ce=Re.upper)!=null?ce:n.MAX_KEY},xe.add(Ce),ke.add(Ce)):(ke.add(l),xe.add(l),g.indexes.forEach(function(Pe){return A(Pe.name).add(l)})),h.mutate(R).then(function(Pe){return!Re||R.type!=="add"&&R.type!=="put"||(ke.addKeys(Pe.results),E&&E.forEach(function(Ze){for(var tt=R.values.map(function(vn){return Ze.extractKey(vn)}),je=Ze.keyPath.findIndex(function(vn){return vn===m.keyPath}),Ge=0,pt=Pe.results.length;Ge<pt;++Ge)tt[Ge][je]=Pe.results[Ge];A(Ze.name).addKeys(tt)})),V.mutatedParts=Os(V.mutatedParts||{},oe),Pe})}}),O={get:function(R){return[m,new Nt(R.key)]},getMany:function(R){return[m,new Nt().addKeys(R.keys)]},count:f,query:f,openCursor:f};return c(O).forEach(function(R){P[R]=function(A){var j=De.subscr,z=!!j,L=vl(De,h)&&gl(R,A)?A.obsSet={}:j;if(z){var V,j=function(Ce){return Ce="idb://".concat(a,"/").concat(u,"/").concat(Ce),L[Ce]||(L[Ce]=new Nt)},oe=j(""),ke=j(":dels"),z=O[R](A),xe=z[0],z=z[1];if((R==="query"&&xe.isPrimaryKey&&!A.values?ke:j(xe.name||"")).add(z),!xe.isPrimaryKey){if(R!=="count")return V=R==="query"&&I&&A.values&&h.query(s(s({},A),{values:!1})),h[R].apply(this,arguments).then(function(Ce){if(R==="query"){if(I&&A.values)return V.then(function(tt){return tt=tt.result,oe.addKeys(tt),Ce});var me=A.values?Ce.result.map(N):Ce.result;(A.values?oe:ke).addKeys(me)}else{var Pe,Ze;if(R==="openCursor")return Ze=A.values,(Pe=Ce)&&Object.create(Pe,{key:{get:function(){return ke.addKey(Pe.primaryKey),Pe.key}},primaryKey:{get:function(){var tt=Pe.primaryKey;return ke.addKey(tt),tt}},value:{get:function(){return Ze&&oe.addKey(Pe.primaryKey),Pe.value}}})}return Ce});ke.add(l)}}return h[R].apply(this,arguments)}}),P}})}};function ml(n,a,l){var u;return l.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,l.numFailures===u)?null:(u=s({},a),d(u.keys)&&(u.keys=u.keys.filter(function(f,h){return!(h in l.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(f,h){return!(h in l.failures)})),u)}function Mi(n,a){return l=n,((u=a).lower===void 0||(u.lowerOpen?0<Xe(l,u.lower):0<=Xe(l,u.lower)))&&(l=n,(u=a).upper===void 0||(u.upperOpen?Xe(l,u.upper)<0:Xe(l,u.upper)<=0));var l,u}function yl(n,a,l,u,f,h){var g,m,C,N,I,E;return!l||l.length===0||(g=a.query.index,m=g.multiEntry,C=a.query.range,N=u.schema.primaryKey.extractKey,I=g.extractKey,E=(g.lowLevelIndex||g).extractKey,(u=l.reduce(function(P,O){var R=P,A=[];if(O.type==="add"||O.type==="put")for(var j=new Nt,z=O.values.length-1;0<=z;--z){var L,V=O.values[z],oe=N(V);!j.hasKey(oe)&&(L=I(V),m&&d(L)?L.some(function(Ce){return Mi(Ce,C)}):Mi(L,C))&&(j.addKey(oe),A.push(V))}switch(O.type){case"add":var ke=new Nt().addKeys(a.values?P.map(function(me){return N(me)}):P),R=P.concat(a.values?A.filter(function(me){return me=N(me),!ke.hasKey(me)&&(ke.addKey(me),!0)}):A.map(function(me){return N(me)}).filter(function(me){return!ke.hasKey(me)&&(ke.addKey(me),!0)}));break;case"put":var xe=new Nt().addKeys(O.values.map(function(me){return N(me)}));R=P.filter(function(me){return!xe.hasKey(a.values?N(me):me)}).concat(a.values?A:A.map(function(me){return N(me)}));break;case"delete":var ce=new Nt().addKeys(O.keys);R=P.filter(function(me){return!ce.hasKey(a.values?N(me):me)});break;case"deleteRange":var Re=O.range;R=P.filter(function(me){return!Mi(N(me),Re)})}return R},n))===n)?n:(u.sort(function(P,O){return Xe(E(P),E(O))||Xe(N(P),N(O))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:n.length===a.limit&&u.length<a.limit&&(f.dirty=!0)),h?Object.freeze(u):u)}function bl(n,a){return Xe(n.lower,a.lower)===0&&Xe(n.upper,a.upper)===0&&!!n.lowerOpen==!!a.lowerOpen&&!!n.upperOpen==!!a.upperOpen}function cf(n,a){return((l,u,f,h)=>{if(l===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((l=Xe(l,u))===0){if(f&&h)return 0;if(f)return 1;if(h)return-1}return l})(n.lower,a.lower,n.lowerOpen,a.lowerOpen)<=0&&0<=((l,u,f,h)=>{if(l===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((l=Xe(l,u))===0){if(f&&h)return 0;if(f)return-1;if(h)return 1}return l})(n.upper,a.upper,n.upperOpen,a.upperOpen)}function ff(n,a,l,u){n.subscribers.add(l),u.addEventListener("abort",function(){var f,h;n.subscribers.delete(l),n.subscribers.size===0&&(f=n,h=a,setTimeout(function(){f.subscribers.size===0&&Q(h,f)},3e3))})}var df={stack:"dbcore",level:0,name:"Cache",create:function(n){var a=n.schema.name;return s(s({},n),{transaction:function(l,u,f){var h,g,m=n.transaction(l,u,f);return u==="readwrite"&&(f=(h=new AbortController).signal,m.addEventListener("abort",(g=function(C){return function(){if(h.abort(),u==="readwrite"){for(var N=new Set,I=0,E=l;I<E.length;I++){var P=E[I],O=Kr["idb://".concat(a,"/").concat(P)];if(O){var R=n.table(P),A=O.optimisticOps.filter(function(Pe){return Pe.trans===m});if(m._explicit&&C&&m.mutatedParts)for(var j=0,z=Object.values(O.queries.query);j<z.length;j++)for(var L=0,V=(xe=z[j]).slice();L<V.length;L++)Ai((ce=V[L]).obsSet,m.mutatedParts)&&(Q(xe,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)}));else if(0<A.length){O.optimisticOps=O.optimisticOps.filter(function(Pe){return Pe.trans!==m});for(var oe=0,ke=Object.values(O.queries.query);oe<ke.length;oe++)for(var xe,ce,Re,Ce=0,me=(xe=ke[oe]).slice();Ce<me.length;Ce++)(ce=me[Ce]).res!=null&&m.mutatedParts&&(C&&!ce.dirty?(Re=Object.isFrozen(ce.res),Re=yl(ce.res,ce.req,A,R,ce,Re),ce.dirty?(Q(xe,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)})):Re!==ce.res&&(ce.res=Re,ce.promise=Te.resolve({result:Re}))):(ce.dirty&&Q(xe,ce),ce.subscribers.forEach(function(Pe){return N.add(Pe)})))}}}N.forEach(function(Pe){return Pe()})}}})(!1),{signal:f}),m.addEventListener("error",g(!1),{signal:f}),m.addEventListener("complete",g(!0),{signal:f})),m},table:function(l){var u=n.table(l),f=u.schema.primaryKey;return s(s({},u),{mutate:function(h){var g,m=De.trans;return!f.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(g=Kr["idb://".concat(a,"/").concat(l)])?(m=u.mutate(h),h.type!=="add"&&h.type!=="put"||!(50<=h.values.length||Di(f,h).some(function(C){return C==null}))?(g.optimisticOps.push(h),h.mutatedParts&&Ds(h.mutatedParts),m.then(function(C){0<C.numFailures&&(Q(g.optimisticOps,h),(C=ml(0,h,C))&&g.optimisticOps.push(C),h.mutatedParts)&&Ds(h.mutatedParts)}),m.catch(function(){Q(g.optimisticOps,h),h.mutatedParts&&Ds(h.mutatedParts)})):m.then(function(C){var N=ml(0,s(s({},h),{values:h.values.map(function(I,E){var P;return C.failures[E]?I:(Y(P=(P=f.keyPath)!=null&&P.includes(".")?ne(I):s({},I),f.keyPath,C.results[E]),P)})}),C);g.optimisticOps.push(N),queueMicrotask(function(){return h.mutatedParts&&Ds(h.mutatedParts)})}),m):u.mutate(h)},query:function(h){var g,m,C,N,I,E,P;return vl(De,u)&&gl("query",h)?(g=((C=De.trans)==null?void 0:C.db._options.cache)==="immutable",m=(C=De).requery,C=C.signal,E=((O,R,A,j)=>{var z=Kr["idb://".concat(O,"/").concat(R)];if(!z)return[];if(!(O=z.queries[A]))return[null,!1,z,null];var L=O[(j.query?j.query.index.name:null)||""];if(!L)return[null,!1,z,null];switch(A){case"query":var V=L.find(function(oe){return oe.req.limit===j.limit&&oe.req.values===j.values&&bl(oe.req.query.range,j.query.range)});return V?[V,!0,z,L]:[L.find(function(oe){return("limit"in oe.req?oe.req.limit:1/0)>=j.limit&&(!j.values||oe.req.values)&&cf(oe.req.query.range,j.query.range)}),!1,z,L];case"count":return V=L.find(function(oe){return bl(oe.req.query.range,j.query.range)}),[V,!!V,z,L]}})(a,l,"query",h),P=E[0],N=E[2],I=E[3],P&&E[1]?P.obsSet=h.obsSet:(E=u.query(h).then(function(O){var R=O.result;if(P&&(P.res=R),g){for(var A=0,j=R.length;A<j;++A)Object.freeze(R[A]);Object.freeze(R)}else O.result=ne(R);return O}).catch(function(O){return I&&P&&Q(I,P),Promise.reject(O)}),P={obsSet:h.obsSet,promise:E,subscribers:new Set,type:"query",req:h,dirty:!1},I?I.push(P):(I=[P],(N=N||(Kr["idb://".concat(a,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[h.query.index.name||""]=I)),ff(P,I,m,C),P.promise.then(function(O){return{result:yl(O.result,h,N==null?void 0:N.optimisticOps,u,P,g)}})):u.query(h)}})}})}};function Ls(n,a){return new Proxy(n,{get:function(l,u,f){return u==="db"?a:Reflect.get(l,u,f)}})}_t.prototype.version=function(n){if(isNaN(n)||n<.1)throw new be.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new be.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var a=this._versions,l=a.filter(function(u){return u._cfg.version===n})[0];return l||(l=new this.Version(n),a.push(l),a.sort(ef),l.stores({}),this._state.autoSchema=!1),l},_t.prototype._whenReady=function(n){var a=this;return this.idbdb&&(this._state.openComplete||De.letThrough||this._vip)?n():new Te(function(l,u){if(a._state.openComplete)return u(new be.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new be.DatabaseClosed);a.open().catch(Ke)}a._state.dbReadyPromise.then(l,u)}).then(n)},_t.prototype.use=function(f){var a=f.stack,l=f.create,u=f.level,f=f.name,h=(f&&this.unuse({stack:a,name:f}),this._middlewares[a]||(this._middlewares[a]=[]));return h.push({stack:a,create:l,level:u??10,name:f}),h.sort(function(g,m){return g.level-m.level}),this},_t.prototype.unuse=function(n){var a=n.stack,l=n.name,u=n.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(f){return u?f.create!==u:!!l&&f.name!==l})),this},_t.prototype.open=function(){var n=this;return Me(xt,function(){return af(n)})},_t.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,a=bt.indexOf(this);if(0<=a&&bt.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new Te(function(l){n.dbReadyResolve=l}),n.openCanceller=new Te(function(l,u){n.cancelOpen=u}))},_t.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,l=this._state;a?(l.isBeingOpened&&l.cancelOpen(new be.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new be.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},_t.prototype.delete=function(n){var a=this,l=(n===void 0&&(n={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new Te(function(f,h){function g(){a.close(n);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=st(function(){var C,N,I;C=a._deps,N=a.name,Si(I=C.indexedDB)||N===Wt||xi(I,C.IDBKeyRange).delete(N).catch(Ke),f()}),m.onerror=Gn(h),m.onblocked=a._fireOnBlocked}if(l)throw new be.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(g):g()})},_t.prototype.backendDB=function(){return this.idbdb},_t.prototype.isOpen=function(){return this.idbdb!==null},_t.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},_t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_t.prototype,"tables",{get:function(){var n=this;return c(this._allTables).map(function(a){return n._allTables[a]})},enumerable:!1,configurable:!0}),_t.prototype.transaction=function(){var n=(function(a,l,u){var f=arguments.length;if(f<2)throw new be.InvalidArgument("Too few arguments");for(var h=new Array(f-1);--f;)h[f-1]=arguments[f];return u=h.pop(),[a,_e(h),u]}).apply(this,arguments);return this._transaction.apply(this,n)},_t.prototype._transaction=function(n,a,l){var u,f,h=this,g=De.trans,m=(g&&g.db===this&&n.indexOf("!")===-1||(g=null),n.indexOf("?")!==-1);n=n.replace("!","").replace("?","");try{if(f=a.map(function(N){if(N=N instanceof h.Table?N.name:N,typeof N!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return N}),n=="r"||n===Un)u=Un;else{if(n!="rw"&&n!=zr)throw new be.InvalidArgument("Invalid transaction mode: "+n);u=zr}if(g){if(g.mode===Un&&u===zr){if(!m)throw new be.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");g=null}g&&f.forEach(function(N){if(g&&g.storeNames.indexOf(N)===-1){if(!m)throw new be.SubTransaction("Table "+N+" not included in parent transaction.");g=null}}),m&&g&&!g.active&&(g=null)}}catch(N){return g?g._promise(null,function(I,E){E(N)}):we(N)}var C=(function N(I,E,P,O,R){return Te.resolve().then(function(){var L=De.transless||De,A=I._createTransaction(E,P,I._dbSchema,O),L=(A.explicit=!0,{trans:A,transless:L});if(O)A.idbtrans=O.idbtrans;else try{A.create(),A.idbtrans._explicit=!0,I._state.PR1398_maxLoop=3}catch(V){return V.name===Ne.InvalidState&&I.isOpen()&&0<--I._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),I.close({disableAutoOpen:!1}),I.open().then(function(){return N(I,E,P,null,R)})):we(V)}var j,z=he(R),L=(z&&Lt(),Te.follow(function(){var V;(j=R.call(A,A))&&(z?(V=In.bind(null,null),j.then(V,V)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=Pi(j)))},L));return(j&&typeof j.then=="function"?Te.resolve(j).then(function(V){return A.active?V:we(new be.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):L.then(function(){return j})).then(function(V){return O&&A._resolve(),A._completion.then(function(){return V})}).catch(function(V){return A._reject(V),we(V)})})}).bind(null,this,u,f,g,l);return g?g._promise(u,C,"lock"):De.trans?Me(De.transless,function(){return h._whenReady(C)}):this._whenReady(C)},_t.prototype.table=function(n){if(x(this._allTables,n))return this._allTables[n];throw new be.InvalidTable("Table ".concat(n," does not exist"))};var rr=_t;function _t(n,a){var l,u,f,h,g,m=this,C=(this._middlewares={},this.verno=0,_t.dependencies),C=(this._options=a=s({addons:_t.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),N=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ke,dbReadyPromise:null,cancelOpen:Ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),I=(N.dbReadyPromise=new Te(function(E){N.dbReadyResolve=E}),N.openCanceller=new Te(function(E,P){N.cancelOpen=P}),this._state=N,this.name=n,this.on=ja(this,"populate","blocked","versionchange","close",{ready:[zn,Ke]}),this.once=function(E,P){var O=function(){for(var R=[],A=0;A<arguments.length;A++)R[A]=arguments[A];m.on(E).unsubscribe(O),P.apply(m,R)};return m.on(E,O)},this.on.ready.subscribe=G(this.on.ready.subscribe,function(E){return function(P,O){_t.vip(function(){var R,A=m._state;A.openComplete?(A.dbOpenError||Te.resolve().then(P),O&&E(P)):A.onReadyBeingFired?(A.onReadyBeingFired.push(P),O&&E(P)):(E(P),R=m,O||E(function j(){R.on.ready.unsubscribe(P),R.on.ready.unsubscribe(j)}))})}}),this.Collection=(l=this,Ba(Yc.prototype,function(j,A){this.db=l;var O=Na,R=null;if(A)try{O=A()}catch(L){R=L}var A=j._ctx,j=A.table,z=j.hook.reading.fire;this._ctx={table:j,index:A.index,isPrimKey:!A.index||j.schema.primKey.keyPath&&A.index===j.schema.primKey.name,range:O,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:R,or:A.or,valueMapper:z!==ut?z:null}})),this.Table=(u=this,Ba(el.prototype,function(E,P,O){this.db=u,this._tx=O,this.name=E,this.schema=P,this.hook=u._allTables[E]?u._allTables[E].hook:ja(null,{creating:[Or,Ke],reading:[en,ut],updating:[Sn,Ke],deleting:[Dr,Ke]})})),this.Transaction=(f=this,Ba(Xc.prototype,function(E,P,O,R,A){var j=this;E!=="readonly"&&P.forEach(function(z){z=(z=O[z])==null?void 0:z.yProps,z&&(P=P.concat(z.map(function(L){return L.updatesTable})))}),this.db=f,this.mode=E,this.storeNames=P,this.schema=O,this.chromeTransactionDurability=R,this.idbtrans=null,this.on=ja(this,"complete","error","abort"),this.parent=A||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Te(function(z,L){j._resolve=z,j._reject=L}),this._completion.then(function(){j.active=!1,j.on.complete.fire()},function(z){var L=j.active;return j.active=!1,j.on.error.fire(z),j.parent?j.parent._reject(z):L&&j.idbtrans&&j.idbtrans.abort(),we(z)})})),this.Version=(h=this,Ba(rf.prototype,function(E){this.db=h,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(g=this,Ba(sl.prototype,function(E,P,O){if(this.db=g,this._ctx={table:E,index:P===":id"?null:P,or:O},this._cmp=this._ascending=Xe,this._descending=function(R,A){return Xe(A,R)},this._max=function(R,A){return 0<Xe(R,A)?R:A},this._min=function(R,A){return Xe(R,A)<0?R:A},this._IDBKeyRange=g._deps.IDBKeyRange,!this._IDBKeyRange)throw new be.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=Ka(a.IDBKeyRange),this._createTransaction=function(E,P,O,R){return new m.Transaction(E,P,O,m._options.chromeTransactionDurability,R)},this._fireOnBlocked=function(E){m.on("blocked").fire(E),bt.filter(function(P){return P.name===m.name&&P!==m&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(E)})},this.use(lf),this.use(df),this.use(uf),this.use(sf),this.use(of),new Proxy(this,{get:function(E,P,O){var R;return P==="_vip"||(P==="table"?function(A){return Ls(m.table(A),I)}:(R=Reflect.get(E,P,O))instanceof el?Ls(R,I):P==="tables"?R.map(function(A){return Ls(A,I)}):P==="_createTransaction"?function(){return Ls(R.apply(this,arguments),I)}:R)}}));this.vip=I,C.forEach(function(E){return E(m)})}var Ns,ga=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",hf=(Li.prototype.subscribe=function(n,a,l){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:a,complete:l})},Li.prototype[ga]=function(){return this},Li);function Li(n){this._subscribe=n}try{Ns={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{Ns={indexedDB:null,IDBKeyRange:null}}function _l(n){var a,l=!1,u=new hf(function(f){var h=he(n),g,m=!1,C={},N={},I={get closed(){return m},unsubscribe:function(){m||(m=!0,g&&g.abort(),E&&wr.storagemutated.unsubscribe(O))}},E=(f.start&&f.start(I),!1),P=function(){return de(R)},O=function(A){Os(C,A),Ai(N,C)&&P()},R=function(){var A,j,z;!m&&Ns.indexedDB&&(C={},A={},g&&g.abort(),g=new AbortController,z=(L=>{var V=br();try{h&&Lt();var oe=Cn(n,L);return oe=h?oe.finally(In):oe}finally{V&&nr()}})(j={subscr:A,signal:g.signal,requery:P,querier:n,trans:null}),Promise.resolve(z).then(function(L){l=!0,a=L,m||j.signal.aborted||(C={},(V=>{for(var oe in V)if(x(V,oe))return;return 1})(N=A)||E||(wr(Fa,O),E=!0),de(function(){return!m&&f.next&&f.next(L)}))},function(L){l=!1,["DatabaseClosedError","AbortError"].includes(L==null?void 0:L.name)||m||de(function(){m||f.error&&f.error(L)})}))};return setTimeout(P,0),I});return u.hasValue=function(){return l},u.getValue=function(){return a},u}var Ur=rr;function Ni(n){var a=kr;try{kr=!0,wr.storagemutated.fire(n),Ri(n,!0)}finally{kr=a}}_(Ur,s(s({},Z),{delete:function(n){return new Ur(n,{addons:[]}).delete()},exists:function(n){return new Ur(n,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return a=Ur.dependencies,l=a.indexedDB,a=a.IDBKeyRange,(Si(l)?Promise.resolve(l.databases()).then(function(u){return u.map(function(f){return f.name}).filter(function(f){return f!==Wt})}):xi(l,a).toCollection().primaryKeys()).then(n)}catch{return we(new be.MissingAPI)}var a,l},defineClass:function(){return function(n){v(this,n)}},ignoreTransaction:function(n){return De.trans?Me(De.transless,n):n()},vip:Ei,async:function(n){return function(){try{var a=Pi(n.apply(this,arguments));return a&&typeof a.then=="function"?a:Te.resolve(a)}catch(l){return we(l)}}},spawn:function(n,a,l){try{var u=Pi(n.apply(l,a||[]));return u&&typeof u.then=="function"?u:Te.resolve(u)}catch(f){return we(f)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(n,a){return n=Te.resolve(typeof n=="function"?Ur.ignoreTransaction(n):n).timeout(a||6e4),De.trans?De.trans.waitFor(n):n},Promise:Te,debug:{get:function(){return zt},set:function(n){Mr(n)}},derive:q,extend:v,props:_,override:G,Events:ja,on:wr,liveQuery:_l,extendObservabilitySet:Os,getByKeyPath:J,setByKeyPath:Y,delByKeyPath:function(n,a){typeof a=="string"?Y(n,a,void 0):"length"in a&&[].map.call(a,function(l){Y(n,l,void 0)})},shallowClone:ge,deepClone:ne,getObjectDiff:Oi,cmp:Xe,asap:X,minKey:-1/0,addons:[],connections:bt,errnames:Ne,dependencies:Ns,cache:Kr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,a,l){return n+a/Math.pow(10,2*l)})})),Ur.maxKey=Ka(Ur.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(wr(Fa,function(n){kr||(n=new CustomEvent(gi,{detail:n}),kr=!0,dispatchEvent(n),kr=!1)}),addEventListener(gi,function(n){n=n.detail,kr||Ni(n)}));var ma,kr=!1,wl=function(){};return typeof BroadcastChannel<"u"&&((wl=function(){(ma=new BroadcastChannel(gi)).onmessage=function(n){return n.data&&Ni(n.data)}})(),typeof ma.unref=="function"&&ma.unref(),wr(Fa,function(n){kr||ma.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!rr.disableBfCache&&n.persisted){zt&&console.debug("Dexie: handling persisted pagehide"),ma!=null&&ma.close();for(var a=0,l=bt;a<l.length;a++)l[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!rr.disableBfCache&&n.persisted&&(zt&&console.debug("Dexie: handling persisted pageshow"),wl(),Ni({all:new Nt(-1/0,[[]])}))})),Te.rejectionMapper=function(n,a){return!n||n instanceof Ae||n instanceof TypeError||n instanceof SyntaxError||!n.name||!lt[n.name]?n:(a=new lt[n.name](a||n.message,n),"stack"in n&&M(a,"stack",{get:function(){return this.inner.stack}}),a)},Mr(zt),s(rr,Object.freeze({__proto__:null,Dexie:rr,Entity:Qo,PropModification:qa,RangeSet:Nt,add:function(n){return new qa({add:n})},cmp:Xe,default:rr,liveQuery:_l,mergeRanges:Ha,rangesOverlap:cl,remove:function(n){return new qa({remove:n})},replacePrefix:function(n,a){return new qa({replacePrefix:[n,a]})}}),{default:rr}),rr})})(Qs)),Qs.exports}var Jd=Zd();const uo=Qd(Jd),zl=Symbol.for("Dexie"),jt=globalThis[zl]||(globalThis[zl]=uo);if(uo.semVer!==jt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${uo.semVer} and ${jt.semVer}`);const{liveQuery:Jm,mergeRanges:$m,rangesOverlap:ey,RangeSet:ty,cmp:ny,Entity:ry,PropModification:ay,replacePrefix:sy,add:iy,remove:oy,DexieYProvider:ly}=jt,Be=new jt("me-ai-store");Be.version(1).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType"});Be.version(2).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",actionItems:"++id, type, status, sourceItemId, createdAt, dueDate, [type+status]"});Be.version(3).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, [action+status]",actionItems:null});Be.version(4).stores({items:"id, sourceType, sourceId, threadKey, date, from, *labels, [sourceType+date]",contacts:"++id, &email, name, lastSeen",syncState:"sourceType",emailClassifications:"emailId, action, date, scannedAt, status, *tags, [action+status]"});function uc(t,e){return`${t}:${e}`}function co(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,s)).toFixed(1)+" "+r[s]}function Gi(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e)),i=t/Math.pow(e,s),o=s>=2?2:s>=1?1:0;return i.toFixed(o)+" "+r[s]}function $d(t,e){return!e||e<=0?null:Math.min(100,t/e*100)}function cc(t,e){return t?t.length<=e?t:t.slice(0,e)+"...":""}function fc(t){let e=0;for(let r=0;r<t.length;r++)e=t.charCodeAt(r)+((e<<5)-e);return Math.abs(e)%360}const eh="https://gmail.googleapis.com/gmail/v1/users/me";class No extends Error{constructor(e,r,s){super(e),this.name="GmailApiError",this.status=r,this.code=s||null}}function th(t){return{Authorization:`Bearer ${t}`}}async function fi(t,e){var s,i,o,c;const r=await fetch(`${eh}${e}`,{headers:th(t)});if(!r.ok){const d=await r.json().catch(()=>({})),v=((s=d.error)==null?void 0:s.message)||`Gmail API error: ${r.status}`,p=((c=(o=(i=d.error)==null?void 0:i.errors)==null?void 0:o[0])==null?void 0:c.reason)||void 0;throw new No(v,r.status,p)}return r.json()}function dc(t){return fi(t,"/profile")}function hc(t,{maxResults:e=20,pageToken:r,q:s}={}){const i=new URLSearchParams;return i.set("maxResults",String(e)),r&&i.set("pageToken",r),s&&i.set("q",s),fi(t,`/messages?${i}`)}function pc(t,e,r="full"){return fi(t,`/messages/${e}?format=${r}`)}function nh(t,{startHistoryId:e,pageToken:r,maxResults:s=500}={}){const i=new URLSearchParams;return i.set("startHistoryId",e),i.set("maxResults",String(s)),i.append("historyTypes","messageAdded"),i.append("historyTypes","messageDeleted"),r&&i.set("pageToken",r),fi(t,`/history?${i}`)}function Sr(t,e){var o;const r=((o=t==null?void 0:t.payload)==null?void 0:o.headers)||[],s=e.toLowerCase(),i=r.find(c=>c.name.toLowerCase()===s);return(i==null?void 0:i.value)||""}function ss(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;r&&(e+="=".repeat(4-r));const s=atob(e),i=Uint8Array.from(s,o=>o.charCodeAt(0));return new TextDecoder().decode(i)}function rh(t){var o,c,d;const e=t==null?void 0:t.payload;if(!e)return"";if((o=e.body)!=null&&o.data)return ss(e.body.data);const r=e.parts||[],s=ei(r,"text/plain");if((c=s==null?void 0:s.body)!=null&&c.data)return ss(s.body.data);const i=ei(r,"text/html");if((d=i==null?void 0:i.body)!=null&&d.data){const v=ss(i.body.data);return sh(v)}return"(no body)"}function ah(t){var i,o;const e=t==null?void 0:t.payload;if(!e)return null;if(e.mimeType==="text/html"&&((i=e.body)!=null&&i.data))return ss(e.body.data);const r=e.parts||[],s=ei(r,"text/html");return(o=s==null?void 0:s.body)!=null&&o.data?ss(s.body.data):null}function ei(t,e){for(const r of t){if(r.mimeType===e)return r;if(r.parts){const s=ei(r.parts,e);if(s)return s}}return null}function sh(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script"))r.remove();return(e.body.textContent||"").replace(/\s+/g," ").trim()}catch{return t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<[^>]+>/g," ").replace(/&#x([0-9a-f]+);/gi,(e,r)=>String.fromCodePoint(parseInt(r,16))).replace(/&#(\d+);/g,(e,r)=>String.fromCodePoint(Number(r))).replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/\s+/g," ").trim()}}function qo(t){if(!t)return"";try{return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}catch{return t}}function vc(t){if(!t)return"Unknown";const e=t.match(/^"?([^"<]+)"?\s*</);return e?e[1].trim():t.split("@")[0]}function gc(t){return vc(t).charAt(0).toUpperCase()}function ih(t){try{const e=new Date(t),r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${i}`}catch{return"email"}}function oh(t){return(t||"email").replace(/[^a-zA-Z0-9 _-]/g,"").replace(/\s+/g,"-").slice(0,60).replace(/-+$/,"")}function mc(t,e){return`${ih(t.date)}_${oh(t.subject)}.${e}`}function yc(t){const e={};for(const s of t){const i=s.action||"UNKNOWN";e[i]||(e[i]=[]),e[i].push(s)}for(const s of Object.keys(e))e[s].sort((i,o)=>(o.date||0)-(i.date||0));const r=Object.keys(e).sort((s,i)=>e[i].length-e[s].length);return{groups:e,order:r}}async function lh(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return null;const r=[`Stored data: ${t} emails, ${e} contacts.`],{oldest:s,newest:i}=await bc();if(s&&i){const o=new Date(s.date).toLocaleDateString(),c=new Date(i.date).toLocaleDateString();r.push(`Date range: ${o} to ${c}.`)}return r.join(" ")}async function uh(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.contacts.count();if(t===0)return"No emails stored locally.";const r=["## Data Summary",`- **Emails:** ${t}`,`- **Contacts:** ${e}`],{oldest:s,newest:i}=await bc();if(s&&i){const o=new Date(s.date).toLocaleDateString(),c=new Date(i.date).toLocaleDateString();r.push(`- **Date range:** ${o} â ${c}`)}return r.join(`
`)}async function ch(t=10){const e=await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(t).toArray();return e.length===0?"No emails stored locally.":e.map(_c).join(`

---

`)}async function fh(t,e=10){if(!t)return"No search query provided.";const r=t.toLowerCase(),i=(await Be.items.where("sourceType").equals("gmail").toArray()).map(o=>{var d,v,p,y,x;let c=0;return(d=o.subject)!=null&&d.toLowerCase().includes(r)&&(c+=3),(v=o.from)!=null&&v.toLowerCase().includes(r)&&(c+=2),(p=o.to)!=null&&p.toLowerCase().includes(r)&&(c+=2),(y=o.snippet)!=null&&y.toLowerCase().includes(r)&&(c+=1),(x=o.body)!=null&&x.toLowerCase().includes(r)&&(c+=1),{item:o,score:c}}).filter(({score:o})=>o>0).sort((o,c)=>c.score-o.score).slice(0,e);return i.length===0?`No results found for "${t}".`:i.map(({item:o})=>_c(o)).join(`

---

`)}async function Fl(){const t=await Be.emailClassifications.where("status").equals("pending").toArray();if(t.length===0)return null;const{groups:e,order:r}=yc(t);return{groups:e,order:r,total:t.length}}async function dh({query:t,limit:e=50,offset:r=0}={}){if(t){const o=t.toLowerCase(),c=await Be.items.where("sourceType").equals("gmail").filter(d=>{var v,p,y,x;return((v=d.subject)==null?void 0:v.toLowerCase().includes(o))||((p=d.from)==null?void 0:p.toLowerCase().includes(o))||((y=d.to)==null?void 0:y.toLowerCase().includes(o))||((x=d.snippet)==null?void 0:x.toLowerCase().includes(o))}).toArray();return c.sort((d,v)=>(v.date||0)-(d.date||0)),{items:c.slice(r,r+e),total:c.length}}const s=await Be.items.where("sourceType").equals("gmail").count();return{items:await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().offset(r).limit(e).toArray(),total:s}}async function bc(){const t=await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).first(),e=await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).last();return{oldest:t,newest:e}}function _c(t){const e=t.date?new Date(t.date).toLocaleString():"Unknown date",r=cc(t.body||t.snippet||"",500);switch(t.type){case"email":return[`**Subject:** ${t.subject}`,`**From:** ${t.from}`,`**To:** ${t.to}`,t.cc?`**CC:** ${t.cc}`:"",`**Date:** ${e}`,`**Labels:** ${(t.labels||[]).join(", ")}`,"",r].filter(Boolean).join(`
`);default:return[`**From:** ${t.from}`,`**Date:** ${e}`,"",r].join(`
`)}}async function hh(){const t=await lh();return t?["You have access to the user's locally stored data.",t,"The user can ask you about their emails. If they do, you can see recent emails and search results that will be provided."].join(" "):null}async function ph(t){const e=[],r=await uh();if(e.push(r),t){const s=await fh(t,5);e.push("","## Relevant Emails",s)}else{const s=await ch(5);e.push("","## Recent Emails",s)}return e.join(`
`)}const vh=20,gh=`You are an email classifier. Analyze this email and produce a classification.

Output ONLY a valid JSON object â no markdown, no explanation, no extra text.

Format:
{
  "action": "SHORT_ACTION_NAME",
  "reason": "One sentence explaining why",
  "summary": "2-3 sentence summary of the email content",
  "tags": ["tag1", "tag2", "tag3"]
}

Guidelines for "action":
- Use a short UPPER_SNAKE_CASE label that describes what the user should do
- Examples: DELETE, REPLY, REVIEW, READ_LATER, ARCHIVE, PAY_BILL, TRACK_DELIVERY, SCHEDULE_MEETING, UNSUBSCRIBE, SAVE_RECEIPT, FOLLOW_UP, ACKNOWLEDGE, IGNORE
- Be specific: prefer "TRACK_DELIVERY" over "NOTIFY", prefer "PAY_BILL" over "REVIEW"
- If genuinely nothing to do, use "NO_ACTION"

Guidelines for "tags":
- 2-5 short lowercase tags describing the email's nature
- Examples: ad, promotion, newsletter, delivery, billing, personal, work, social, receipt, shipping, subscription, security, update, notification, newsletter, finance, travel
- Be descriptive and specific

Guidelines for "summary":
- 2-3 sentences capturing the key information
- Include specific details: amounts, dates, names, tracking numbers, deadlines
- Write from the perspective of what matters to the recipient

Rules:
- Output ONLY the JSON object, nothing else
- "action" must be UPPER_SNAKE_CASE
- "tags" must be an array of lowercase strings
- "summary" must be a string`;async function wc(t,{count:e=vh,force:r=!1,onProgress:s=()=>{}}={}){if(!t.isReady)throw new Error("Model not loaded. Please load a model first.");s({phase:"loading",message:"Loading recent emails..."});let i,o=0;if(r)i=await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().limit(e).toArray();else{const p=new Set((await Be.emailClassifications.toArray()).map(x=>x.emailId)),y=await Be.items.where("[sourceType+date]").between(["gmail",jt.minKey],["gmail",jt.maxKey]).reverse().toArray();o=0,i=[];for(const x of y)if(p.has(x.id))o++;else if(i.push(x),i.length>=e)break}if(i.length===0){const p=r?"No emails to scan.":`All emails already classified (${o} total). Use "Rescan All" to reclassify.`;return s({phase:"done",message:p,classified:0}),{scanned:0,classified:0,skipped:o,errors:0}}const c=Date.now();let d=0,v=0;for(let p=0;p<i.length;p++){const y=i[p];s({phase:"scanning",message:`Classifying email ${p+1} of ${i.length}${o?` (${o} skipped)`:""}...`,current:p+1,total:i.length,classified:d});try{const x=_h(y),_=[{role:"system",content:gh},{role:"user",content:x}],w=await t.generateFull(_),M=wh(w);M&&(await Be.emailClassifications.put({emailId:y.id,action:M.action,reason:M.reason,summary:M.summary,tags:M.tags,subject:y.subject||"(no subject)",from:y.from||"",date:y.date,scannedAt:c,status:"pending"}),d++)}catch(x){console.error(`Triage email ${p+1} failed:`,x),v++}}return s({phase:"done",message:`Classified ${d} of ${i.length} emails${o?`, ${o} already done`:""}.`,classified:d}),{scanned:i.length,classified:d,skipped:o,errors:v}}async function mh(){const t=await Be.emailClassifications.toArray();return yc(t)}async function yh(){const t=await Be.emailClassifications.toArray(),e={total:t.length};for(const r of t){const s=r.action||"UNKNOWN";e[s]=(e[s]||0)+1}return e}async function ti(t,e){await Be.emailClassifications.update(t,{status:e})}async function bh(){await Be.emailClassifications.clear()}async function kc(t){await Be.emailClassifications.where("action").equals(t).delete()}async function xc(t){await Be.emailClassifications.delete(t)}async function fo(){const t=await Be.items.where("sourceType").equals("gmail").count(),e=await Be.emailClassifications.count();return{totalEmails:t,classified:e,unclassified:Math.max(0,t-e)}}function _h(t){const e=t.date?new Date(t.date).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Unknown date",r=cc(t.body||t.snippet||"",500);return[`Subject: ${t.subject}`,`From: ${t.from}`,`To: ${t.to||"me"}`,`Date: ${e}`,`Labels: ${(t.labels||[]).join(", ")}`,"",r].join(`
`)}function wh(t){if(!t||!t.trim())return null;let e=t.trim();e=e.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,""),e=e.trim();const r=e.indexOf("{"),s=e.lastIndexOf("}");if(r===-1||s===-1||s<=r)return console.warn("Triage: no JSON object found in response"),null;const i=e.indexOf("[");if(i!==-1&&i<r)return console.warn("Triage: expected JSON object, got array"),null;const o=e.slice(r,s+1);try{const c=JSON.parse(o);if(!c||typeof c!="object"||Array.isArray(c))return null;const d=kh(c.action);if(!d)return console.warn("Triage: missing or invalid action field"),null;let v=[];return Array.isArray(c.tags)&&(v=c.tags.filter(p=>typeof p=="string"&&p.trim()).map(p=>p.trim().toLowerCase()).slice(0,10)),{action:d,reason:String(c.reason||"").slice(0,300),summary:String(c.summary||"").slice(0,500),tags:v}}catch(c){return console.warn("Triage: failed to parse JSON response:",c.message),null}}function kh(t){return!t||typeof t!="string"?null:t.trim().toUpperCase().replace(/[\s-]+/g,"_").replace(/[^A-Z0-9_]/g,"")||null}function jo(t){return`hsl(${fc(t)}, 55%, 55%)`}function Sc(t){return`hsl(${fc(t)}, 40%, 35%)`}const xh=typeof localStorage<"u"&&localStorage.getItem("debug")==="true";function Kl(...t){xh&&console.log("[debug]",...t)}function fn(t){return Kl(`[MOUNT] ${t}`),()=>Kl(`[DESTROY] ${t}`)}var Sh=H("<option> </option>"),Eh=H('<p class="model-description svelte-1p89qnn"> </p>'),Th=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Device</span><span class="svelte-1p89qnn"> </span></div>'),Ah=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Description</span><span class="svelte-1p89qnn"> </span></div>'),Ch=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Max buffer</span><span class="svelte-1p89qnn"> </span></div>'),Ih=H('<div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Features</span><span class="svelte-1p89qnn"> </span></div>'),Rh=H('<div class="gpu-card svelte-1p89qnn"><div class="gpu-card-header svelte-1p89qnn"><span class="gpu-dot svelte-1p89qnn"></span> <span>WebGPU Active</span></div> <div class="gpu-card-body svelte-1p89qnn"><div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Vendor</span><span class="svelte-1p89qnn"> </span></div> <div class="gpu-row svelte-1p89qnn"><span class="svelte-1p89qnn">Architecture</span><span class="svelte-1p89qnn"> </span></div> <!> <!> <!> <!></div></div>'),Ph=H('<p class="error svelte-1p89qnn"> </p>'),Oh=H('<div class="container center svelte-1p89qnn"><p class="subtitle svelte-1p89qnn">A private AI chat that runs <strong>entirely in your browser</strong> using WebGPU.</p> <div class="model-selector svelte-1p89qnn"><label for="model-select" class="svelte-1p89qnn">Choose Model:</label> <select id="model-select" class="svelte-1p89qnn"></select> <!></div> <!> <!> <button class="btn primary svelte-1p89qnn">Load Model</button></div>');function Dh(t,e){ft(e,!0);let r=Ie(e,"selectedModel",15),s=Ie(e,"gpuInfo",3,null),i=Ie(e,"error",3,null);Mt(()=>fn("ModelSelector"));var o=Oh(),c=D(k(o),2),d=D(k(c),2);Ut(d,21,()=>ls,pr,(q,S)=>{var F=Sh(),te=k(F),G={};ye(()=>{re(te,`${b(S).name??""} â ${b(S).size??""}`),G!==(G=b(S).id)&&(F.value=(F.__value=b(S).id)??"")}),K(q,F)});var v=D(d,2);{var p=q=>{const S=vt(()=>ls.find(U=>U.id===r()));var F=Oa(),te=gt(F);{var G=U=>{var X=Eh(),J=k(X);ye(()=>re(J,b(S).description)),K(U,X)};Se(te,U=>{b(S)&&U(G)})}K(q,F)};Se(v,q=>{r()&&q(p)})}var y=D(c,2);{var x=q=>{var S=Rh(),F=D(k(S),2),te=k(F),G=D(k(te)),U=k(G),X=D(te,2),J=D(k(X)),Y=k(J),ge=D(X,2);{var Le=le=>{var ue=Th(),Q=D(k(ue)),ee=k(Q);ye(()=>re(ee,s().device)),K(le,ue)};Se(ge,le=>{s().device&&s().device!=="unknown"&&le(Le)})}var _e=D(ge,2);{var ve=le=>{var ue=Ah(),Q=D(k(ue)),ee=k(Q);ye(()=>re(ee,s().description)),K(le,ue)};Se(_e,le=>{s().description&&s().description!=="unknown"&&le(ve)})}var ae=D(_e,2);{var ne=le=>{var ue=Ch(),Q=D(k(ue)),ee=k(Q);ye($=>re(ee,$),[()=>co(s().limits.maxBufferSize)]),K(le,ue)};Se(ae,le=>{var ue;(ue=s().limits)!=null&&ue.maxBufferSize&&le(ne)})}var qe=D(ae,2);{var se=le=>{var ue=Ih(),Q=D(k(ue)),ee=k(Q);ye(()=>re(ee,`${s().features.length??""} supported`)),K(le,ue)};Se(qe,le=>{var ue;(ue=s().features)!=null&&ue.length&&le(se)})}ye(()=>{re(U,s().vendor),re(Y,s().architecture)}),K(q,S)};Se(y,q=>{s()&&q(x)})}var _=D(y,2);{var w=q=>{var S=Ph(),F=k(S);ye(()=>re(F,i())),K(q,S)};Se(_,q=>{i()&&q(w)})}var M=D(_,2);M.__click=function(...q){var S;(S=e.onload)==null||S.apply(this,q)},ye(()=>M.disabled=i()),Mo(d,r),K(t,o),dt()}Bt(["click"]);var Mh=H('<span class="progress-percent svelte-r5fnze"> </span>'),Lh=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-sep svelte-r5fnze">/</span> <span class="progress-total svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span></div>',1),Nh=H('<span class="progress-loaded svelte-r5fnze"> </span> <span class="progress-raw svelte-r5fnze" title="Exact bytes"> </span>',1),qh=H('<span class="progress-indeterminate svelte-r5fnze">downloadingâ¦</span>'),jh=H('<div class="progress-bar svelte-r5fnze"><div class="progress-fill indeterminate svelte-r5fnze"></div></div> <div class="progress-numbers svelte-r5fnze"><!></div>',1),Bh=H('<div class="progress-card svelte-r5fnze"><div class="progress-header svelte-r5fnze"><span class="progress-file svelte-r5fnze"> </span> <!></div> <!></div>'),zh=H('<div class="container center loading-container svelte-r5fnze"><p class="loading-msg svelte-r5fnze"> </p> <!></div>');function Fh(t,e){ft(e,!0);let r=Ie(e,"message",3,""),s=Ie(e,"items",19,()=>[]);Mt(()=>fn("LoadingProgress"));var i=zh(),o=k(i),c=k(o),d=D(o,2);Ut(d,17,s,pr,(v,p)=>{const y=vt(()=>b(p).total?$d(b(p).loaded||0,b(p).total):null);var x=Bh(),_=k(x),w=k(_),M=k(w),q=D(w,2);{var S=U=>{var X=Mh(),J=k(X);ye(Y=>re(J,`${Y??""}%`),[()=>b(y).toFixed(1)]),K(U,X)};Se(q,U=>{b(y)!==null&&U(S)})}var F=D(_,2);{var te=U=>{var X=Lh(),J=gt(X),Y=k(J),ge=D(J,2),Le=k(ge),_e=k(Le),ve=D(Le,4),ae=k(ve),ne=D(ve,2),qe=k(ne);ye((se,le,ue,Q,ee)=>{$t(Y,`width: ${se??""}%`),re(_e,le),re(ae,ue),re(qe,`(${Q??""} / ${ee??""} B)`)},[()=>Math.max(b(p).progress??0,.5).toFixed(1),()=>Gi(b(p).loaded||0),()=>Gi(b(p).total),()=>(b(p).loaded||0).toLocaleString(),()=>b(p).total.toLocaleString()]),K(U,X)},G=U=>{var X=jh(),J=D(gt(X),2),Y=k(J);{var ge=_e=>{var ve=Nh(),ae=gt(ve),ne=k(ae),qe=D(ae,2),se=k(qe);ye((le,ue)=>{re(ne,le),re(se,`(${ue??""} B)`)},[()=>Gi(b(p).loaded),()=>b(p).loaded.toLocaleString()]),K(_e,ve)},Le=_e=>{var ve=qh();K(_e,ve)};Se(Y,_e=>{b(p).loaded?_e(ge):_e(Le,!1)})}K(U,X)};Se(F,U=>{b(p).total?U(te):U(G,!1)})}ye(()=>{oc(w,"title",b(p).file),re(M,b(p).file)}),K(v,x)}),ye(()=>re(c,r())),K(t,i),dt()}var Kh=H('<span class="thinking-tokens svelte-11gjw00"> </span>'),Uh=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Thinking...</span> <!></div>'),Gh=H('<div class="thinking-bar active svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> <span class="svelte-11gjw00">Preparing...</span></div>'),Hh=H('<details class="thinking-details svelte-11gjw00"><summary class="thinking-summary svelte-11gjw00"><span class="thinking-icon svelte-11gjw00">ð­</span> Thinking <span class="thinking-token-count svelte-11gjw00"> </span></summary> <div class="thinking-content svelte-11gjw00"> </div></details>'),Wh=H('<div class="gen-status svelte-11gjw00"><span class="gen-dots svelte-11gjw00"><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span><span class="svelte-11gjw00"></span></span> Generating...</div>'),Yh=H('<span class="cursor svelte-11gjw00">|</span>'),Vh=H(" <!>",1),Qh=H('<!> <!> <div class="content svelte-11gjw00"><!></div>',1),Xh=H('<div class="content svelte-11gjw00"> </div>'),Zh=H('<div><div class="role svelte-11gjw00"> </div> <!></div>');function Jh(t,e){ft(e,!0);let r=Ie(e,"isLast",3,!1),s=Ie(e,"isRunning",3,!1),i=Ie(e,"generationPhase",3,null),o=Ie(e,"numTokens",3,null);Mt(()=>fn(`MessageBubble[${e.msg.role}]`));var c=Zh(),d=k(c),v=k(d),p=D(d,2);{var y=_=>{var w=Qh(),M=gt(w);{var q=Y=>{var ge=Uh(),Le=D(k(ge),4);{var _e=ve=>{var ae=Kh(),ne=k(ae);ye(()=>re(ne,`${o()??""} tokens`)),K(ve,ae)};Se(Le,ve=>{o()&&ve(_e)})}K(Y,ge)},S=Y=>{var ge=Gh();K(Y,ge)};Se(M,Y=>{s()&&r()&&i()==="thinking"?Y(q):s()&&r()&&i()==="preparing"&&Y(S,1)})}var F=D(M,2);{var te=Y=>{var ge=Hh(),Le=k(ge),_e=D(k(Le),2),ve=k(_e),ae=D(Le,2),ne=k(ae);ye(qe=>{re(ve,`${qe??""} words`),re(ne,e.msg.thinking)},[()=>e.msg.thinking.split(/\s+/).length]),K(Y,ge)};Se(F,Y=>{e.msg.thinking&&Y(te)})}var G=D(F,2),U=k(G);{var X=Y=>{var ge=Wh();K(Y,ge)},J=Y=>{var ge=Vh(),Le=gt(ge,!0),_e=D(Le);{var ve=ae=>{var ne=Yh();K(ae,ne)};Se(_e,ae=>{s()&&r()&&ae(ve)})}ye(()=>re(Le,e.msg.content)),K(Y,ge)};Se(U,Y=>{s()&&r()&&!e.msg.content&&i()!=="thinking"?Y(X):Y(J,!1)})}K(_,w)},x=_=>{var w=Xh(),M=k(w);ye(()=>re(M,e.msg.content)),K(_,w)};Se(p,_=>{e.msg.role==="assistant"?_(y):_(x,!1)})}ye(()=>{Zt(c,1,`bubble ${e.msg.role??""}`,"svelte-11gjw00"),re(v,e.msg.role==="user"?"You":"AI")}),K(t,c),dt()}var $h=H('<span class="email-date svelte-mt5nvh"> </span>'),ep=H('<span class="email-summary svelte-mt5nvh"> </span>'),tp=H('<span class="tag svelte-mt5nvh"> </span>'),np=H('<span class="email-tags svelte-mt5nvh"></span>'),rp=H('<div class="email-row svelte-mt5nvh"><button class="email-info svelte-mt5nvh"><span class="email-subject svelte-mt5nvh"> </span> <span class="email-meta svelte-mt5nvh"><span class="email-from svelte-mt5nvh"> </span> <!></span> <!> <!></button> <div class="email-actions svelte-mt5nvh"><button class="icon-btn done-btn svelte-mt5nvh" title="Mark handled"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-mt5nvh" title="Dismiss"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <button class="icon-btn remove-btn svelte-mt5nvh" title="Remove"><svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button></div></div>'),ap=H('<button class="batch-btn svelte-mt5nvh"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg> Mark All Handled</button> <button class="batch-btn danger svelte-mt5nvh">Clear Group</button>',1),sp=H('<span class="confirm-text svelte-mt5nvh"> </span> <button class="batch-btn svelte-mt5nvh">Cancel</button> <button class="batch-btn danger svelte-mt5nvh">Delete</button>',1),ip=H('<div class="group-body svelte-mt5nvh"><!> <div class="batch-bar svelte-mt5nvh"><!></div></div>'),op=H('<div><button class="group-btn svelte-mt5nvh"><span class="group-dot svelte-mt5nvh"></span> <span class="group-label svelte-mt5nvh"> </span> <span class="group-count svelte-mt5nvh"> </span> <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>'),lp=H('<div class="dashboard svelte-mt5nvh"><div class="dash-header svelte-mt5nvh"><svg class="dash-icon svelte-mt5nvh" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"></rect><rect x="14" y="3" width="7" height="7" rx="1"></rect><rect x="3" y="14" width="7" height="7" rx="1"></rect><rect x="14" y="14" width="7" height="7" rx="1"></rect></svg> <span class="dash-title svelte-mt5nvh"> </span></div> <div class="group-grid svelte-mt5nvh"></div></div>');function up(t,e){ft(e,!0);let r=Ie(e,"pendingData",3,null),s=Oe(null),i=Oe(null);function o(_){B(s,b(s)===_?null:_,!0)}function c(_){return _.split("_").map(w=>w.charAt(0)+w.slice(1).toLowerCase()).join(" ")}function d(_){if(!_)return"";try{return new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}var v={toggleGroup:o},p=Oa(),y=gt(p);{var x=_=>{var w=lp(),M=k(w),q=D(k(M),2),S=k(q),F=D(M,2);Ut(F,20,()=>r().order,te=>te,(te,G)=>{const U=vt(()=>r().groups[G]),X=vt(()=>jo(G)),J=vt(()=>b(s)===G);var Y=op();let ge;var Le=k(Y);Le.__click=()=>o(G);var _e=k(Le);let ve;var ae=D(_e,2),ne=k(ae),qe=D(ae,2),se=k(qe),le=D(qe,2);let ue;var Q=D(Le,2);{var ee=$=>{var he=ip(),Z=k(he);Ut(Z,17,()=>b(U),ie=>ie.emailId,(ie,Ne)=>{var Fe=rp(),be=k(Fe);be.__click=()=>{var ze;return(ze=e.onaskai)==null?void 0:ze.call(e,`Tell me about the email "${b(Ne).subject}" from ${b(Ne).from}`)};var lt=k(be),Ke=k(lt),ut=D(lt,2),en=k(ut),At=k(en),Or=D(en,2);{var Dr=ze=>{var at=$h(),nn=k(at);ye(rn=>re(nn,rn),[()=>d(b(Ne).date)]),K(ze,at)};Se(Or,ze=>{b(Ne).date&&ze(Dr)})}var Sn=D(ut,2);{var vr=ze=>{var at=ep(),nn=k(at);ye(()=>re(nn,b(Ne).summary)),K(ze,at)};Se(Sn,ze=>{b(Ne).summary&&ze(vr)})}var zn=D(Sn,2);{var zt=ze=>{var at=np();Ut(at,21,()=>b(Ne).tags,pr,(nn,rn)=>{var Kn=tp();let En;var dn=k(Kn);ye(Tn=>{En=$t(Kn,"",En,Tn),re(dn,b(rn))},[()=>({background:Sc(b(rn))})]),K(nn,Kn)}),K(ze,at)};Se(zn,ze=>{b(Ne).tags&&b(Ne).tags.length>0&&ze(zt)})}var Mr=D(be,2),Fn=k(Mr);Fn.__click=()=>{var ze;return(ze=e.onmarkacted)==null?void 0:ze.call(e,b(Ne).emailId)};var $n=D(Fn,2);$n.__click=()=>{var ze;return(ze=e.ondismiss)==null?void 0:ze.call(e,b(Ne).emailId)};var tn=D($n,2);tn.__click=()=>{var ze;return(ze=e.onremove)==null?void 0:ze.call(e,b(Ne).emailId)},ye(()=>{re(Ke,b(Ne).subject),re(At,b(Ne).from)}),K(ie,Fe)});var fe=D(Z,2),Ae=k(fe);{var Ee=ie=>{var Ne=ap(),Fe=gt(Ne);Fe.__click=()=>e.onmarkacted&&b(U).forEach(lt=>e.onmarkacted(lt.emailId));var be=D(Fe,2);be.__click=()=>B(i,G,!0),K(ie,Ne)},pe=ie=>{var Ne=sp(),Fe=gt(Ne),be=k(Fe),lt=D(Fe,2);lt.__click=()=>B(i,null);var Ke=D(lt,2);Ke.__click=()=>{var ut;(ut=e.oncleargroup)==null||ut.call(e,G),B(i,null)},ye(()=>re(be,`Clear ${b(U).length??""} items?`)),K(ie,Ne)};Se(Ae,ie=>{b(i)!==G?ie(Ee):ie(pe,!1)})}K($,he)};Se(Q,$=>{b(J)&&$(ee)})}ye($=>{ge=Zt(Y,1,"group-card svelte-mt5nvh",null,ge,{expanded:b(J)}),ve=$t(_e,"",ve,{background:b(X)}),re(ne,$),re(se,b(U).length),ue=Zt(le,0,"group-chevron svelte-mt5nvh",null,ue,{open:b(J)})},[()=>c(G)]),K(te,Y)}),ye(()=>re(S,`${r().total??""} pending action${r().total!==1?"s":""}`)),K(_,w)};Se(y,_=>{r()&&r().total>0&&_(x)})}return K(t,p),dt(v)}Bt(["click"]);var cp=H('<div class="chip scanning svelte-1ed7zw1"><span class="scan-spinner svelte-1ed7zw1"></span> <span>Scanning...</span></div>'),fp=H('<button class="chip scan-chip svelte-1ed7zw1"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg> Scan Emails</button>'),dp=H('<button class="chip action-chip svelte-1ed7zw1"><span class="chip-dot svelte-1ed7zw1"></span> <span class="chip-label svelte-1ed7zw1"> </span> <span class="chip-count svelte-1ed7zw1"> </span></button>'),hp=H('<div class="quick-strip svelte-1ed7zw1"><!> <!></div>');function pp(t,e){ft(e,!0);let r=Ie(e,"pendingData",3,null),s=Ie(e,"hasScanData",3,!1),i=Ie(e,"engineReady",3,!1),o=Ie(e,"isScanning",3,!1);function c(_){return _.split("_").map(w=>w.charAt(0)+w.slice(1).toLowerCase()).join(" ")}let d=vt(()=>i()&&!s()&&!o()),v=vt(()=>r()&&r().total>0||b(d)||o());var p=Oa(),y=gt(p);{var x=_=>{var w=hp(),M=k(w);{var q=G=>{var U=cp();K(G,U)},S=G=>{var U=fp();U.__click=function(...X){var J;(J=e.onscan)==null||J.apply(this,X)},K(G,U)};Se(M,G=>{o()?G(q):b(d)&&G(S,1)})}var F=D(M,2);{var te=G=>{var U=Oa(),X=gt(U);Ut(X,16,()=>r().order,J=>J,(J,Y)=>{const ge=vt(()=>r().groups[Y]),Le=vt(()=>jo(Y));var _e=dp();_e.__click=()=>{var ue;return(ue=e.ontogglegroup)==null?void 0:ue.call(e,Y)};var ve=k(_e);let ae;var ne=D(ve,2),qe=k(ne),se=D(ne,2),le=k(se);ye(ue=>{ae=$t(ve,"",ae,{background:b(Le)}),re(qe,ue),re(le,b(ge).length)},[()=>c(Y)]),K(J,_e)}),K(G,U)};Se(F,G=>{r()&&r().total>0&&G(te)})}K(_,w)};Se(y,_=>{b(v)&&_(x)})}K(t,p),dt()}Bt(["click"]);var vp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Device</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),gp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Buffer</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),mp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Max Compute Invocations</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),yp=H('<div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Workgroup Storage</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div>'),bp=H('<span class="gpu-feature-tag svelte-1qmgokn"> </span>'),_p=H('<div class="gpu-panel-item full svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn"> </div> <div class="gpu-panel-features svelte-1qmgokn"></div></div>'),wp=H('<div class="gpu-panel svelte-1qmgokn"><div class="gpu-panel-grid svelte-1qmgokn"><div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Status</div> <div class="gpu-panel-value ok svelte-1qmgokn">Active</div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Vendor</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <div class="gpu-panel-item svelte-1qmgokn"><div class="gpu-panel-label svelte-1qmgokn">Architecture</div> <div class="gpu-panel-value svelte-1qmgokn"> </div></div> <!> <!> <!> <!> <!></div></div>');function kp(t,e){ft(e,!0),Mt(()=>fn("GpuPanel"));var r=wp(),s=k(r),i=D(k(s),2),o=D(k(i),2),c=k(o),d=D(i,2),v=D(k(d),2),p=k(v),y=D(d,2);{var x=U=>{var X=vp(),J=D(k(X),2),Y=k(J);ye(()=>re(Y,e.gpuInfo.device)),K(U,X)};Se(y,U=>{e.gpuInfo.device&&e.gpuInfo.device!=="unknown"&&U(x)})}var _=D(y,2);{var w=U=>{var X=gp(),J=D(k(X),2),Y=k(J);ye(ge=>re(Y,ge),[()=>co(e.gpuInfo.limits.maxBufferSize)]),K(U,X)};Se(_,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxBufferSize&&U(w)})}var M=D(_,2);{var q=U=>{var X=mp(),J=D(k(X),2),Y=k(J);ye(()=>re(Y,e.gpuInfo.limits.maxComputeInvocationsPerWorkgroup)),K(U,X)};Se(M,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeInvocationsPerWorkgroup&&U(q)})}var S=D(M,2);{var F=U=>{var X=yp(),J=D(k(X),2),Y=k(J);ye(ge=>re(Y,ge),[()=>co(e.gpuInfo.limits.maxComputeWorkgroupStorageSize)]),K(U,X)};Se(S,U=>{var X;(X=e.gpuInfo.limits)!=null&&X.maxComputeWorkgroupStorageSize&&U(F)})}var te=D(S,2);{var G=U=>{var X=_p(),J=k(X),Y=k(J),ge=D(J,2);Ut(ge,21,()=>e.gpuInfo.features,pr,(Le,_e)=>{var ve=bp(),ae=k(ve);ye(()=>re(ae,b(_e))),K(Le,ve)}),ye(()=>re(Y,`Features (${e.gpuInfo.features.length??""})`)),K(U,X)};Se(te,U=>{var X;(X=e.gpuInfo.features)!=null&&X.length&&U(G)})}ye(()=>{re(c,e.gpuInfo.vendor),re(p,e.gpuInfo.architecture)}),K(t,r),dt()}var xp=H('<button class="gpu-badge svelte-1ktw27c"> </button>'),Sp=H('<span class="stats svelte-1ktw27c"> </span>'),Ep=H('<span class="stats preparing svelte-1ktw27c">preparing...</span>'),Tp=H('<span class="stats preparing svelte-1ktw27c"> </span>'),Ap=H('<span class="stats svelte-1ktw27c"> </span>'),Cp=H('<div class="empty svelte-1ktw27c">Send a message to start chatting.</div>'),Ip=H('<button class="btn svelte-1ktw27c">Stop</button>'),Rp=H('<button class="btn primary svelte-1ktw27c">Send</button>'),Pp=H('<div class="chat-wrapper svelte-1ktw27c"><header class="svelte-1ktw27c"><!> <!> <span class="spacer svelte-1ktw27c"></span> <button class="btn small svelte-1ktw27c">Reset</button></header> <!> <div class="messages svelte-1ktw27c"><!> <!></div> <!> <div class="input-row svelte-1ktw27c"><textarea rows="1" placeholder="Type a message..." class="svelte-1ktw27c"></textarea> <!></div></div>');function Op(t,e){ft(e,!0),Mt(()=>fn("ChatView"));let r=Ie(e,"messages",19,()=>[]),s=Ie(e,"pendingData",3,null),i=Ie(e,"hasScanData",3,!1),o=Ie(e,"engineReady",3,!1),c=Ie(e,"isScanning",3,!1),d=Ie(e,"isRunning",3,!1),v=Ie(e,"tps",3,null),p=Ie(e,"numTokens",3,null),y=Ie(e,"generationPhase",3,null),x=Ie(e,"gpuInfo",3,null),_=Ie(e,"chatContainer",15),w=Oe(""),M=Oe(!1),q=Oe(null);function S(pe){pe.key==="Enter"&&!pe.shiftKey&&(pe.preventDefault(),F())}function F(){const pe=b(w).trim();!pe||d()||(B(w,""),e.onsend(pe))}function te(pe){b(q)&&b(q).toggleGroup(pe)}function G(pe){pe&&!d()&&e.onsend(pe)}var U=Pp(),X=k(U),J=k(X);{var Y=pe=>{var ie=xp();ie.__click=()=>B(M,!b(M));var Ne=k(ie);ye(()=>re(Ne,`WebGPU ${b(M)?"â²":"â¼"}`)),K(pe,ie)};Se(J,pe=>{x()&&pe(Y)})}var ge=D(J,2);{var Le=pe=>{var ie=Sp(),Ne=k(ie);ye((Fe,be)=>re(Ne,`${p()??""} tokens in ${Fe??""}s
        (${be??""} tok/s)`),[()=>(p()/v()).toFixed(1),()=>v().toFixed(1)]),K(pe,ie)},_e=pe=>{var ie=Ep();K(pe,ie)},ve=pe=>{var ie=Tp(),Ne=k(ie);ye(Fe=>re(Ne,`thinking... ${Fe??""}`),[()=>v()?`${v().toFixed(0)} tok/s`:""]),K(pe,ie)},ae=pe=>{var ie=Ap(),Ne=k(ie);ye(Fe=>re(Ne,`${Fe??""} tok/s`),[()=>v().toFixed(1)]),K(pe,ie)};Se(ge,pe=>{v()&&!d()?pe(Le):d()&&y()==="preparing"?pe(_e,1):d()&&y()==="thinking"?pe(ve,2):v()&&d()&&pe(ae,3)})}var ne=D(ge,4);ne.__click=function(...pe){var ie;(ie=e.onreset)==null||ie.apply(this,pe)};var qe=D(X,2);{var se=pe=>{kp(pe,{get gpuInfo(){return x()}})};Se(qe,pe=>{b(M)&&x()&&pe(se)})}var le=D(qe,2),ue=k(le);{var Q=pe=>{var ie=Cp();K(pe,ie)};Se(ue,pe=>{r().length===0&&!(s()&&s().total>0)&&pe(Q)})}var ee=D(ue,2);Ut(ee,17,r,pr,(pe,ie,Ne)=>{var Fe=Oa(),be=gt(Fe);{var lt=ut=>{lo(up(ut,{get pendingData(){return b(ie).pendingData},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},get oncleargroup(){return e.oncleargroup},onaskai:G}),en=>B(q,en,!0),()=>b(q))},Ke=ut=>{{let en=vt(()=>Ne===r().length-1);Jh(ut,{get msg(){return b(ie)},get isLast(){return b(en)},get isRunning(){return d()},get generationPhase(){return y()},get numTokens(){return p()}})}};Se(be,ut=>{b(ie).type==="dashboard"?ut(lt):ut(Ke,!1)})}K(pe,Fe)}),lo(le,pe=>_(pe),()=>_());var $=D(le,2);pp($,{get pendingData(){return s()},get hasScanData(){return i()},get engineReady(){return o()},get isScanning(){return c()},ontogglegroup:te,get onscan(){return e.onscan}});var he=D($,2),Z=k(he);Z.__keydown=S;var fe=D(Z,2);{var Ae=pe=>{var ie=Ip();ie.__click=function(...Ne){var Fe;(Fe=e.onstop)==null||Fe.apply(this,Ne)},K(pe,ie)},Ee=pe=>{var ie=Rp();ie.__click=F,ye(Ne=>ie.disabled=Ne,[()=>!b(w).trim()]),K(pe,ie)};Se(fe,pe=>{d()?pe(Ae):pe(Ee,!1)})}ye(()=>{ne.disabled=d(),Z.disabled=d()}),Lo(Z,()=>b(w),pe=>B(w,pe)),K(t,U),dt()}Bt(["click","keydown"]);var Dp=H('<div class="container center svelte-1bi93vx"><h1 class="svelte-1bi93vx">WebGPU Not Available</h1> <p>Your browser does not support WebGPU. Please try Chrome 113+ or Edge 113+.</p></div>');function Mp(t,e){ft(e,!0);const r=!!navigator.gpu,s=lc();let i=Oe(Rt(localStorage.getItem("selectedModel")||ls[0].id)),o=Oe(null),c=Oe(null),d=Oe(""),v=Oe(Rt([])),p=Oe(Rt([])),y=Oe(!1),x=Oe(null),_=Oe(null),w=Oe(null),M=Oe(null),q=Oe(null),S=Oe(null),F=Oe(!1),te=Oe(!1),G=!1;Mt(()=>{s.check(),s.isReady&&U();const Z=s.onMessage(fe=>{switch(fe.status){case"webgpu-info":B(M,fe.data,!0);break;case"loading":B(o,"loading"),B(d,fe.data,!0);break;case"initiate":B(v,[...b(v),fe],!0);break;case"progress":B(v,b(v).map(Ae=>Ae.file===fe.file?{...Ae,...fe}:Ae),!0);break;case"done":B(v,b(v).filter(Ae=>Ae.file!==fe.file),!0);break;case"ready":B(o,"ready"),U();break;case"start":if(!b(y))break;B(q,fe.phase||"preparing",!0),B(p,[...b(p),{role:"assistant",content:"",thinking:""}],!0);break;case"phase":if(!b(y))break;B(q,fe.phase,!0);break;case"thinking":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(p)[b(p).length-1];B(p,[...b(p).slice(0,-1),{...Ae,thinking:(Ae.thinking||"")+fe.content}],!0),ve();break}case"thinking-done":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(p)[b(p).length-1];B(p,[...b(p).slice(0,-1),{...Ae,thinking:fe.content}],!0);break}case"update":{if(!b(y))break;B(x,fe.tps,!0),B(_,fe.numTokens,!0);const Ae=b(p)[b(p).length-1];B(p,[...b(p).slice(0,-1),{...Ae,content:Ae.content+fe.output}],!0),ve();break}case"complete":if(!b(y))break;B(y,!1),B(q,null),X();break;case"error":if(!b(y))break;B(c,fe.data,!0),B(y,!1),B(q,null);break}});return()=>Z()});async function U(){if(!(G||b(p).length>0))try{const Z=await Fl();B(S,Z,!0),Z&&(G=!0,B(p,[{role:"assistant",type:"dashboard",pendingData:Z}],!0),ve());const fe=await fo();B(F,fe.classified>0)}catch{}}async function X(){try{const Z=await Fl();B(S,Z,!0);const fe=b(p).findIndex(Ee=>Ee.type==="dashboard");fe!==-1&&(Z&&Z.total>0?B(p,b(p).map((Ee,pe)=>pe===fe?{...Ee,pendingData:Z}:Ee),!0):B(p,b(p).filter((Ee,pe)=>pe!==fe),!0));const Ae=await fo();B(F,Ae.classified>0)}catch{}}async function J(Z){await ti(Z,"acted"),await X()}async function Y(Z){await ti(Z,"dismissed"),await X()}async function ge(Z){await xc(Z),await X()}async function Le(Z){await kc(Z),await X()}async function _e(){if(!(b(te)||!s.isReady)){B(te,!0);try{await wc(s,{count:20}),await X(),b(S)&&!b(p).some(Z=>Z.type==="dashboard")&&(B(p,[{role:"assistant",type:"dashboard",pendingData:b(S)},...b(p)],!0),ve())}catch(Z){console.error("Scan failed:",Z)}finally{B(te,!1)}}}function ve(){nc().then(()=>{b(w)&&(b(w).scrollTop=b(w).scrollHeight)})}function ae(){B(o,"loading"),localStorage.setItem("selectedModel",b(i)),s.loadModel(b(i))}async function ne(Z){if(!Z||b(y))return;B(p,[...b(p),{role:"user",content:Z}],!0),B(x,null),B(y,!0);let fe=[];try{const pe=/\b(email|mail|inbox|message|sent|sender|from|subject|unread|gmail|pending|action|archive|delete|reply|follow.?up|prioriti|triage|urgent)\b/i.test(Z)?await ph(Z):await hh();pe&&(fe=[{role:"system",content:pe}])}catch{}const Ae=b(p).filter(Ee=>Ee.type!=="dashboard").map(Ee=>({role:Ee.role,content:Ee.content}));s.generate([...fe,...Ae]),ve()}function qe(){s.interrupt()}function se(){s.reset(),B(p,[],!0),B(x,null),B(_,null),G=!1,U()}var le=Oa(),ue=gt(le);{var Q=Z=>{var fe=Dp();K(Z,fe)},ee=Z=>{Dh(Z,{get gpuInfo(){return b(M)},get error(){return b(c)},onload:ae,get selectedModel(){return b(i)},set selectedModel(fe){B(i,fe,!0)}})},$=Z=>{Fh(Z,{get message(){return b(d)},get items(){return b(v)}})},he=Z=>{Op(Z,{get messages(){return b(p)},get pendingData(){return b(S)},get hasScanData(){return b(F)},get engineReady(){return s.isReady},get isScanning(){return b(te)},get isRunning(){return b(y)},get tps(){return b(x)},get numTokens(){return b(_)},get generationPhase(){return b(q)},get gpuInfo(){return b(M)},onsend:ne,onstop:qe,onreset:se,onmarkacted:J,ondismiss:Y,onremove:ge,oncleargroup:Le,onscan:_e,get chatContainer(){return b(w)},set chatContainer(fe){B(w,fe,!0)}})};Se(ue,Z=>{r?b(o)===null?Z(ee,1):b(o)==="loading"?Z($,2):Z(he,!1):Z(Q)})}K(t,le),dt()}const Ul="https://accounts.google.com/gsi/client",Lp="https://www.googleapis.com/auth/gmail.readonly";let ho=null,Xs=null;function Np(){return new Promise((t,e)=>{var i,o;if((o=(i=window.google)==null?void 0:i.accounts)!=null&&o.oauth2){t();return}const r=document.querySelector(`script[src="${Ul}"]`);if(r){r.addEventListener("load",()=>t()),r.addEventListener("error",()=>e(new Error("Failed to load Google Identity Services")));return}const s=document.createElement("script");s.src=Ul,s.async=!0,s.defer=!0,s.onload=()=>t(),s.onerror=()=>e(new Error("Failed to load Google Identity Services")),document.head.appendChild(s)})}async function Gl(t){await Np(),ho=google.accounts.oauth2.initTokenClient({client_id:t,scope:Lp,callback:e=>{Xs&&(Xs(e),Xs=null)}})}function qp(){return new Promise((t,e)=>{if(!ho){e(new Error("Google Auth not initialized. Call initGoogleAuth first."));return}Xs=r=>{r.error?e(new Error(r.error_description||r.error)):t({access_token:r.access_token,expires_in:r.expires_in})},ho.requestAccessToken()})}function jp(t){return new Promise(e=>{var r,s;(s=(r=window.google)==null?void 0:r.accounts)!=null&&s.oauth2?google.accounts.oauth2.revoke(t,()=>e()):e()})}const Pt="gmail",Hl=8,Ec=50,Tc=100;async function Bp(t,{limit:e=Ec,onProgress:r=()=>{},signal:s}={}){var c;const i=await Be.syncState.get(Pt);if(i!=null&&i.historyId)try{return await Hp(t,i,r,s)}catch(d){if(d instanceof No&&(d.status===404||d.code==="notFound")||((c=d.message)==null?void 0:c.includes("Start history id")))r({phase:"info",message:"History expired, performing full re-sync..."}),await Be.syncState.delete(Pt);else throw d}return await Up(t,e===0?1/0:e,r,s)}async function zp(t,{limit:e=Ec,onProgress:r=()=>{},signal:s}={}){const i=await Be.syncState.get(Pt);return i!=null&&i.oldestPageToken?await Gp(t,i,e===0?1/0:e,r,s):(r({phase:"done",message:"All messages already synced"}),{added:0,errors:0})}async function Fp(){const t=await Be.syncState.get(Pt);return t?{synced:!0,totalItems:t.totalItems||0,lastSyncAt:t.lastSyncAt,historyId:t.historyId,hasMore:!!t.oldestPageToken}:{synced:!1,totalItems:0,lastSyncAt:null,hasMore:!1}}async function Kp(){await Be.transaction("rw",[Be.items,Be.syncState],async()=>{await Be.items.where("sourceType").equals(Pt).delete(),await Be.syncState.delete(Pt)})}async function Up(t,e,r,s){r({phase:"counting",message:"Getting mailbox info..."}),la(s);const i=await dc(t);r({phase:"listing",message:"Listing messages...",current:0,total:Math.min(i.messagesTotal||e,e)});const o=[];let c,d=null;for(;o.length<e;){la(s);const x=e-o.length,_=await hc(t,{maxResults:Math.min(Tc,x),pageToken:c}),w=(_.messages||[]).map(M=>M.id);if(o.push(...w),r({phase:"listing",message:`Listed ${o.length} messages...`,current:o.length,total:Math.min(i.messagesTotal||e,e)}),c=_.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Be.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:0,oldestPageToken:null}),{added:0,deleted:0,errors:0};const{added:v,errors:p}=await Ac(t,o,r,s),y=await Be.items.where("sourceType").equals(Pt).count();return await Be.syncState.put({sourceType:Pt,historyId:i.historyId,lastSyncAt:Date.now(),totalItems:y,oldestPageToken:d}),r({phase:"done",message:`Synced ${v} messages`,current:v,total:v}),{added:v,deleted:0,errors:p}}async function Gp(t,e,r,s,i){s({phase:"listing",message:"Loading more messages...",current:0}),la(i);const o=[];let c=e.oldestPageToken,d=null;for(;o.length<r;){la(i);const x=r-o.length,_=await hc(t,{maxResults:Math.min(Tc,x),pageToken:c}),w=(_.messages||[]).map(M=>M.id);if(o.push(...w),s({phase:"listing",message:`Listed ${o.length} more messages...`,current:o.length}),c=_.nextPageToken,!c||w.length===0)break}if(d=c||null,o.length===0)return await Be.syncState.update(Pt,{oldestPageToken:null,lastSyncAt:Date.now()}),s({phase:"done",message:"All messages synced"}),{added:0,errors:0};const{added:v,errors:p}=await Ac(t,o,s,i),y=await Be.items.where("sourceType").equals(Pt).count();return await Be.syncState.update(Pt,{totalItems:y,lastSyncAt:Date.now(),oldestPageToken:d}),s({phase:"done",message:d?`Downloaded ${v} more (more available)`:`Downloaded ${v} more (all synced)`,current:y,total:y}),{added:v,errors:p}}async function Hp(t,e,r,s){r({phase:"syncing",message:"Checking for changes..."}),la(s);let i=0,o=0,c=0,d,v=e.historyId;do{la(s);const y=await nh(t,{startHistoryId:e.historyId,pageToken:d});if(v=y.historyId||v,d=y.nextPageToken,!!y.history){for(const x of y.history){if(x.messagesAdded){const _=x.messagesAdded.map(M=>M.message.id),w=[...new Set(_.filter(M=>M))];if(w.length>0){const M=await Promise.allSettled(w.map(S=>pc(t,S))),q=[];for(const S of M)S.status==="fulfilled"?q.push(Cc(S.value)):c++;q.length>0&&(await Be.items.bulkPut(q),await Ic(q),i+=q.length)}}if(x.messagesDeleted){const _=x.messagesDeleted.map(w=>uc(Pt,w.message.id)).filter(w=>w);_.length>0&&(await Be.items.bulkDelete(_),o+=_.length)}}r({phase:"syncing",message:`Changes: +${i} -${o}`,current:i+o})}}while(d);const p=await Be.items.where("sourceType").equals(Pt).count();return await Be.syncState.put({sourceType:Pt,historyId:v,lastSyncAt:Date.now(),totalItems:p,oldestPageToken:e.oldestPageToken}),r({phase:"done",message:i===0&&o===0?"Already up to date":`Synced: +${i} -${o}`,current:p,total:p}),{added:i,deleted:o,errors:c}}async function Ac(t,e,r,s){r({phase:"downloading",message:"Downloading messages...",current:0,total:e.length});let i=0,o=0;for(let c=0;c<e.length;c+=Hl){la(s);const d=e.slice(c,c+Hl),v=await Promise.allSettled(d.map(y=>pc(t,y))),p=[];for(const y of v)y.status==="fulfilled"?p.push(Cc(y.value)):o++;p.length>0&&(await Be.items.bulkPut(p),await Ic(p)),i+=p.length,r({phase:"downloading",message:`Downloaded ${i} of ${e.length} messages`,current:i,total:e.length})}return{added:i,errors:o}}function Cc(t){const e=Sr(t,"From"),r=Sr(t,"To"),s=Sr(t,"Cc"),i=Sr(t,"Subject")||"(no subject)",o=Sr(t,"Date"),c=Sr(t,"Message-ID"),d=Sr(t,"In-Reply-To"),v=Sr(t,"References");let p;try{p=o?new Date(o).getTime():t.internalDate?Number(t.internalDate):Date.now()}catch{p=Date.now()}return{id:uc(Pt,t.id),sourceType:Pt,sourceId:t.id,threadKey:`gmail:${t.threadId}`,type:"email",from:e,to:r,cc:s,subject:i,snippet:t.snippet||"",body:rh(t),htmlBody:ah(t),date:p,labels:t.labelIds||[],messageId:c,inReplyTo:d,references:v,raw:t,syncedAt:Date.now()}}async function Ic(t){const e=new Map;for(const r of t)for(const s of[r.from,r.to,r.cc]){if(!s)continue;const i=s.split(",").map(o=>o.trim()).filter(Boolean);for(const o of i){const c=Wp(o);c&&!e.has(c.email)&&e.set(c.email,{...c,date:r.date})}}for(const[r,{name:s,date:i}]of e)try{const o=await Be.contacts.where("email").equals(r).first();if(o){const c={};s&&!o.name&&(c.name=s),i>(o.lastSeen||0)&&(c.lastSeen=i),Object.keys(c).length>0&&await Be.contacts.update(o.id,c)}else await Be.contacts.add({email:r,name:s||"",firstSeen:i,lastSeen:i})}catch(o){(o==null?void 0:o.name)!=="ConstraintError"&&console.debug("Contact upsert skipped:",r,(o==null?void 0:o.message)||o)}}function Wp(t){if(!t)return null;const e=t.match(/<([^>]+)>/);if(e){const s=e[1].toLowerCase().trim(),i=t.slice(0,t.indexOf("<")).replace(/"/g,"").trim();return{email:s,name:i}}const r=t.toLowerCase().trim();return r.includes("@")?{email:r,name:""}:null}function la(t){if(t!=null&&t.aborted)throw new DOMException("Sync was cancelled","AbortError")}var Yp=H(`<div class="setup-container svelte-1mdd5r2"><div class="setup-card svelte-1mdd5r2"><h2 class="svelte-1mdd5r2">Connect Gmail</h2> <p class="setup-intro svelte-1mdd5r2">To access Gmail from the browser, you need a Google Cloud OAuth Client ID.
      This stays in your browser â no data is sent to any server.</p> <div class="setup-steps svelte-1mdd5r2"><div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">1</span> <div><a href="https://console.cloud.google.com/projectcreate" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create a Google Cloud project</a> (or use an existing one)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">2</span> <div><a href="https://console.cloud.google.com/apis/library/gmail.googleapis.com" target="_blank" rel="noopener" class="svelte-1mdd5r2">Enable the Gmail API</a> for your project</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">3</span> <div><a href="https://console.cloud.google.com/apis/credentials/oauthclient" target="_blank" rel="noopener" class="svelte-1mdd5r2">Create an OAuth 2.0 Client ID</a> (type: <strong>Web application</strong>)</div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">4</span> <div><p class="step-label svelte-1mdd5r2">Add these URLs to your OAuth client. Click to copy:</p> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized JavaScript origins (no trailing slash):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <div class="url-section svelte-1mdd5r2"><span class="url-section-title svelte-1mdd5r2">Authorized redirect URIs (add all three):</span> <div class="url-chips svelte-1mdd5r2"><button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button> <button class="url-chip svelte-1mdd5r2"><code class="svelte-1mdd5r2"></code> <span class="copy-icon svelte-1mdd5r2"> </span></button></div></div> <p class="step-hint svelte-1mdd5r2">Both localhost (dev) and GitHub Pages (prod) are needed. The /me-ai/ path
            is required because the app is deployed at a subpath. Changes may take a
            few minutes to propagate after saving.</p></div></div> <div class="step svelte-1mdd5r2"><span class="step-num svelte-1mdd5r2">5</span> <div>Copy the <strong>Client ID</strong> and paste it below</div></div></div> <div class="client-id-form svelte-1mdd5r2"><input type="text" placeholder="xxxx.apps.googleusercontent.com" class="svelte-1mdd5r2"/> <button class="btn primary svelte-1mdd5r2">Save</button></div></div></div>`);function Vp(t,e){ft(e,!0);let r=Ie(e,"clientIdInput",15);Mt(()=>fn("SetupGuide"));let s=Oe(null);async function i(Ae){try{await navigator.clipboard.writeText(Ae),B(s,Ae,!0),setTimeout(()=>{B(s,null)},1500)}catch{const Ee=document.createElement("input");Ee.value=Ae,document.body.appendChild(Ee),Ee.select(),document.execCommand("copy"),document.body.removeChild(Ee),B(s,Ae,!0),setTimeout(()=>{B(s,null)},1500)}}const o="http://localhost:5173",c="https://cypherkitty.github.io",d="https://cypherkitty.github.io/me-ai/";var v=Yp(),p=k(v),y=D(k(p),4),x=D(k(y),6),_=D(k(x),2),w=D(k(_),2),M=D(k(w),2),q=k(M);q.__click=()=>i(o);var S=k(q);S.textContent="http://localhost:5173";var F=D(S,2),te=k(F),G=D(q,2);G.__click=()=>i(c);var U=k(G);U.textContent="https://cypherkitty.github.io";var X=D(U,2),J=k(X),Y=D(w,2),ge=D(k(Y),2),Le=k(ge);Le.__click=()=>i(o);var _e=k(Le);_e.textContent="http://localhost:5173";var ve=D(_e,2),ae=k(ve),ne=D(Le,2);ne.__click=()=>i(c);var qe=k(ne);qe.textContent="https://cypherkitty.github.io";var se=D(qe,2),le=k(se),ue=D(ne,2);ue.__click=()=>i(d);var Q=k(ue);Q.textContent="https://cypherkitty.github.io/me-ai/";var ee=D(Q,2),$=k(ee),he=D(y,2),Z=k(he);Z.__keydown=Ae=>Ae.key==="Enter"&&e.onsave();var fe=D(Z,2);fe.__click=function(...Ae){var Ee;(Ee=e.onsave)==null||Ee.apply(this,Ae)},ye(Ae=>{re(te,b(s)===o?"â":"â§"),re(J,b(s)===c?"â":"â§"),re(ae,b(s)===o?"â":"â§"),re(le,b(s)===c?"â":"â§"),re($,b(s)===d?"â":"â§"),fe.disabled=Ae},[()=>!r().trim()]),Lo(Z,r),K(t,v),dt()}Bt(["click","keydown"]);function Qp(t){const e=typeof t=="object"&&t!==null?t:null,r=(e==null?void 0:e.message)||String(t||""),s=e instanceof No?e.status:null;if(r.includes("has not been used in project")||r.includes("is disabled")){const i=r.match(/project\s+(\d+)/),o=i==null?void 0:i[1];return{title:"Gmail API not enabled",description:"The Gmail API needs to be enabled in your Google Cloud project before it can be used.",fix:"Click the link below to enable it, then wait ~30 seconds and retry.",link:{url:o?`https://console.developers.google.com/apis/api/gmail.googleapis.com/overview?project=${o}`:"https://console.cloud.google.com/apis/library/gmail.googleapis.com",label:"Enable Gmail API"}}}return s===401||r.includes("Invalid Credentials")||r.includes("invalid_token")?{title:"Session expired",description:"Your access token has expired or is invalid.",fix:"Sign out and sign in again to get a fresh token.",action:"signout"}:s===403||r.includes("insufficient")&&r.includes("scope")?{title:"Insufficient permissions",description:"The app doesn't have the required permissions to access Gmail.",fix:"Sign out, sign in again, and make sure to grant the Gmail read permission in the consent screen.",action:"signout"}:r.includes("access_denied")||r.includes("user_denied")?{title:"Access denied",description:"You declined the Gmail permission request.",fix:"Click 'Sign in with Google' again and grant the Gmail read-only permission when prompted."}:r.includes("popup")||r.includes("blocked")?{title:"Popup blocked",description:"The sign-in popup was blocked by your browser.",fix:"Allow popups for localhost:5173 in your browser settings, then try again."}:s===429||r.includes("Rate Limit")||r.includes("quota")?{title:"Rate limit exceeded",description:"Too many requests to the Gmail API.",fix:"Wait a minute and try again."}:r.includes("Failed to fetch")||r.includes("NetworkError")||r.includes("network")?{title:"Network error",description:"Could not reach the Gmail API.",fix:"Check your internet connection and try again."}:{title:"Something went wrong",description:r,fix:null}}var Xp=H('<div class="error-card-header svelte-14buhqq"><div class="error-card-title svelte-14buhqq"> </div> <button class="error-dismiss svelte-14buhqq">â</button></div>'),Zp=H('<div class="error-card-title svelte-14buhqq"> </div>'),Jp=H('<p class="error-card-fix svelte-14buhqq"> </p>'),$p=H('<a class="error-card-link svelte-14buhqq" target="_blank" rel="noopener"> </a>'),ev=H('<button class="btn small error-action svelte-14buhqq">Sign Out & Retry</button>'),tv=H('<div class="error-card svelte-14buhqq"><!> <p class="error-card-desc svelte-14buhqq"> </p> <!> <!> <!></div>');function Rc(t,e){ft(e,!0);let r=Ie(e,"ondismiss",3,null),s=Ie(e,"onsignout",3,null),i=vt(()=>Qp(e.error));Mt(()=>fn("ErrorCard"));var o=tv(),c=k(o);{var d=F=>{var te=Xp(),G=k(te),U=k(G),X=D(G,2);X.__click=function(...J){var Y;(Y=r())==null||Y.apply(this,J)},ye(()=>re(U,b(i).title)),K(F,te)},v=F=>{var te=Zp(),G=k(te);ye(()=>re(G,b(i).title)),K(F,te)};Se(c,F=>{r()?F(d):F(v,!1)})}var p=D(c,2),y=k(p),x=D(p,2);{var _=F=>{var te=Jp(),G=k(te);ye(()=>re(G,b(i).fix)),K(F,te)};Se(x,F=>{b(i).fix&&F(_)})}var w=D(x,2);{var M=F=>{var te=$p(),G=k(te);ye(()=>{oc(te,"href",b(i).link.url),re(G,`${b(i).link.label??""} â`)}),K(F,te)};Se(w,F=>{b(i).link&&F(M)})}var q=D(w,2);{var S=F=>{var te=ev();te.__click=function(...G){var U;(U=s())==null||U.apply(this,G)},K(F,te)};Se(q,F=>{b(i).action==="signout"&&s()&&F(S)})}ye(()=>re(y,b(i).description)),K(t,o),dt()}Bt(["click"]);var nv=H('<span class="spinner svelte-nyqevv"></span> Signing in...',1),rv=Do('<svg viewBox="0 0 24 24" width="18" height="18" class="google-icon svelte-nyqevv"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg> Sign in with Google',1),av=H(`<div class="auth-container svelte-nyqevv"><div class="auth-card svelte-nyqevv"><h2 class="svelte-nyqevv">Gmail Dashboard</h2> <p class="auth-desc svelte-nyqevv">Sign in with your Google account to browse your Gmail messages.
      Read-only access â nothing is modified.</p> <!> <button class="btn google-btn svelte-nyqevv"><!></button> <div class="client-id-info svelte-nyqevv"><span class="client-id-label">Client ID:</span> <span class="client-id-value svelte-nyqevv"> </span> <button class="btn-link svelte-nyqevv">Change</button></div></div></div>`);function sv(t,e){ft(e,!0);let r=Ie(e,"error",3,null),s=Ie(e,"loadingAuth",3,!1);Mt(()=>fn("AuthCard"));var i=av(),o=k(i),c=D(k(o),4);{var d=S=>{Rc(S,{get error(){return r()},get onsignout(){return e.onsignout}})};Se(c,S=>{r()&&S(d)})}var v=D(c,2);v.__click=function(...S){var F;(F=e.onsignin)==null||F.apply(this,S)};var p=k(v);{var y=S=>{var F=nv();K(S,F)},x=S=>{var F=rv();K(S,F)};Se(p,S=>{s()?S(y):S(x,!1)})}var _=D(v,2),w=D(k(_),2),M=k(w),q=D(w,2);q.__click=function(...S){var F;(F=e.onclear)==null||F.apply(this,S)},ye(S=>{v.disabled=s(),re(M,`${S??""}...`)},[()=>e.clientId.slice(0,20)]),K(t,i),dt()}Bt(["click"]);var iv=H('<span class="profile-email svelte-1w180uc">Loading profile...</span>'),ov=H('<span class="profile-email svelte-1w180uc"> </span> <span class="profile-stats svelte-1w180uc"> </span>',1),lv=H('<div class="profile-card svelte-1w180uc"><div class="profile-avatar svelte-1w180uc"> </div> <div class="profile-info svelte-1w180uc"><!></div> <button class="btn small svelte-1w180uc">Sign Out</button></div>');function uv(t,e){ft(e,!0);let r=Ie(e,"profile",3,null),s=Ie(e,"loadingProfile",3,!1);Mt(()=>fn("ProfileCard"));var i=lv(),o=k(i),c=k(o),d=D(o,2),v=k(d);{var p=_=>{var w=iv();K(_,w)},y=_=>{var w=ov(),M=gt(w),q=k(M),S=D(M,2),F=k(S);ye((te,G)=>{re(q,r().emailAddress),re(F,`${te??""} messages
        Â· ${G??""} threads`)},[()=>{var te;return((te=r().messagesTotal)==null?void 0:te.toLocaleString())||"?"},()=>{var te;return((te=r().threadsTotal)==null?void 0:te.toLocaleString())||"?"}]),K(_,w)};Se(v,_=>{s()?_(p):r()&&_(y,1)})}var x=D(d,2);x.__click=function(..._){var w;(w=e.onsignout)==null||w.apply(this,_)},ye(_=>re(c,_),[()=>r()?gc(r().emailAddress):"?"]),K(t,i),dt()}Bt(["click"]);var cv=H('<span class="spinner svelte-1ds3j4k"></span>'),fv=Do('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m0 0a9 9 0 0 1 9-9m-9 9a9 9 0 0 0 9 9" class="svelte-1ds3j4k"></path></svg>'),dv=H('<span class="sync-meta svelte-1ds3j4k"> <!></span>'),hv=H('<span class="sync-meta svelte-1ds3j4k">Not synced yet</span>'),pv=H('<button class="btn-icon svelte-1ds3j4k" title="Clear local data"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1ds3j4k"><path d="M3 6h18M8 6V4h8v2m1 0v14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V6h10z" class="svelte-1ds3j4k"></path></svg></button>'),vv=H('<option class="svelte-1ds3j4k"> </option>'),gv=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),mv=H('<button class="btn sync-btn svelte-1ds3j4k"> </button> <!>',1),yv=H('<button class="btn sync-btn primary svelte-1ds3j4k"> </button>'),bv=H('<div class="sync-progress svelte-1ds3j4k"><div class="progress-bar svelte-1ds3j4k"><div></div></div> <span class="progress-text svelte-1ds3j4k"> </span></div>'),_v=H('<div class="clear-confirm svelte-1ds3j4k"><span class="svelte-1ds3j4k">Delete all locally stored emails?</span> <div class="clear-actions svelte-1ds3j4k"><button class="btn small svelte-1ds3j4k">Cancel</button> <button class="btn small danger svelte-1ds3j4k">Delete</button></div></div>'),wv=H('<div class="sync-card svelte-1ds3j4k"><div class="sync-header svelte-1ds3j4k"><div class="sync-icon svelte-1ds3j4k"><!></div> <div class="sync-info svelte-1ds3j4k"><span class="sync-title svelte-1ds3j4k">Local Storage</span> <!></div> <div class="sync-actions svelte-1ds3j4k"><!></div></div> <div class="sync-controls svelte-1ds3j4k"><div class="limit-group svelte-1ds3j4k"><label class="limit-label svelte-1ds3j4k" for="sync-limit">Batch:</label> <select id="sync-limit" class="limit-select svelte-1ds3j4k"></select></div> <div class="sync-buttons svelte-1ds3j4k"><!></div></div> <!> <!></div>');function kv(t,e){ft(e,!0),Mt(()=>fn("SyncStatus"));let r=Ie(e,"syncStatus",3,null),s=Ie(e,"syncProgress",3,null),i=Ie(e,"isSyncing",3,!1),o=Oe(!1),c=Oe(50);const d=[{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:0,label:"All"}];function v(Q){if(!Q)return"never";const ee=Math.floor((Date.now()-Q)/1e3);if(ee<60)return"just now";const $=Math.floor(ee/60);if($<60)return`${$}m ago`;const he=Math.floor($/60);return he<24?`${he}h ago`:`${Math.floor(he/24)}d ago`}function p(){var Q,ee;return!((Q=s())!=null&&Q.total)||!((ee=s())!=null&&ee.current)?0:Math.round(s().current/s().total*100)}var y=wv(),x=k(y),_=k(x),w=k(_);{var M=Q=>{var ee=cv();K(Q,ee)},q=Q=>{var ee=fv();K(Q,ee)};Se(w,Q=>{i()?Q(M):Q(q,!1)})}var S=D(_,2),F=D(k(S),2);{var te=Q=>{var ee=dv(),$=k(ee),he=D($);{var Z=Ae=>{var Ee=Dl("Â· more available");K(Ae,Ee)},fe=Ae=>{var Ee=Dl("Â· all synced");K(Ae,Ee)};Se(he,Ae=>{r().hasMore?Ae(Z):Ae(fe,!1)})}ye((Ae,Ee)=>re($,`${Ae??""} emails stored
          Â· synced ${Ee??""} `),[()=>r().totalItems.toLocaleString(),()=>v(r().lastSyncAt)]),K(Q,ee)},G=Q=>{var ee=hv();K(Q,ee)};Se(F,Q=>{var ee;(ee=r())!=null&&ee.synced?Q(te):Q(G,!1)})}var U=D(S,2),X=k(U);{var J=Q=>{var ee=pv();ee.__click=()=>B(o,!b(o)),K(Q,ee)};Se(X,Q=>{var ee;(ee=r())!=null&&ee.synced&&!i()&&Q(J)})}var Y=D(x,2),ge=k(Y),Le=D(k(ge),2);Ut(Le,21,()=>d,pr,(Q,ee)=>{var $=vv(),he=k($),Z={};ye(()=>{re(he,b(ee).label),Z!==(Z=b(ee).value)&&($.value=($.__value=b(ee).value)??"")}),K(Q,$)});var _e=D(ge,2),ve=k(_e);{var ae=Q=>{var ee=mv(),$=gt(ee);$.__click=()=>e.onsync(b(c));var he=k($),Z=D($,2);{var fe=Ae=>{var Ee=gv();Ee.__click=()=>e.onsyncmore(b(c));var pe=k(Ee);ye(()=>{Ee.disabled=i(),re(pe,i()?"Loading...":"Sync More")}),K(Ae,Ee)};Se(Z,Ae=>{r().hasMore&&Ae(fe)})}ye(()=>{$.disabled=i(),re(he,i()?"Syncing...":"Sync New")}),K(Q,ee)},ne=Q=>{var ee=yv();ee.__click=()=>e.onsync(b(c));var $=k(ee);ye(()=>{ee.disabled=i(),re($,i()?"Syncing...":"Download Emails")}),K(Q,ee)};Se(ve,Q=>{var ee;(ee=r())!=null&&ee.synced?Q(ae):Q(ne,!1)})}var qe=D(Y,2);{var se=Q=>{var ee=bv(),$=k(ee),he=k($);let Z,fe;var Ae=D($,2),Ee=k(Ae);ye(pe=>{Z=Zt(he,1,"progress-fill svelte-1ds3j4k",null,Z,{indeterminate:!s().total}),fe=$t(he,"",fe,pe),re(Ee,s().message||"Syncing...")},[()=>({width:`${p()??""}%`})]),K(Q,ee)};Se(qe,Q=>{i()&&s()&&Q(se)})}var le=D(qe,2);{var ue=Q=>{var ee=_v(),$=D(k(ee),2),he=k($);he.__click=()=>B(o,!1);var Z=D(he,2);Z.__click=()=>{e.onclear(),B(o,!1)},K(Q,ee)};Se(le,Q=>{b(o)&&Q(ue)})}ye(()=>Le.disabled=i()),Mo(Le,()=>b(c),Q=>B(c,Q)),K(t,y),dt()}Bt(["click"]);var xv=H('<button class="message-row svelte-y2uamw"><div class="msg-avatar svelte-y2uamw"> </div> <div class="msg-body svelte-y2uamw"><div class="msg-top svelte-y2uamw"><span class="msg-from svelte-y2uamw"> </span> <span class="msg-date svelte-y2uamw"> </span></div> <div class="msg-subject svelte-y2uamw"> </div> <div class="msg-snippet svelte-y2uamw"> </div></div></button>'),Sv=H('<div class="message-list svelte-y2uamw"></div>');function Ev(t,e){ft(e,!0);let r=Ie(e,"messages",19,()=>[]);Mt(()=>fn("MessageList"));var s=Sv();Ut(s,21,r,pr,(i,o)=>{var c=xv();c.__click=()=>e.onselect(b(o));var d=k(c),v=k(d),p=D(d,2),y=k(p),x=k(y),_=k(x),w=D(x,2),M=k(w),q=D(y,2),S=k(q),F=D(q,2),te=k(F);ye((G,U,X)=>{re(v,G),re(_,U),re(M,X),re(S,b(o).subject),re(te,b(o).snippet)},[()=>gc(b(o).from),()=>vc(b(o).from),()=>qo(b(o).date)]),K(i,c)}),K(t,s),dt()}Bt(["click"]);function Bo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var fa=Bo();function Pc(t){fa=t}var Wr={exec:()=>null};function Je(t,e=""){let r=typeof t=="string"?t:t.source,s={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Kt.caret,"$1"),r=r.replace(i,c),s},getRegex:()=>new RegExp(r,e)};return s}var Tv=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Kt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}>`)},Av=/^(?:[ \t]*(?:\n|$))+/,Cv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Iv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ms=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Rv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,zo=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,Oc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Dc=Je(Oc).replace(/bull/g,zo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Pv=Je(Oc).replace(/bull/g,zo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Fo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Ov=/^[^\n]+/,Ko=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Dv=Je(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ko).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Mv=Je(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,zo).getRegex(),di="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Uo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Lv=Je("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Uo).replace("tag",di).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Mc=Je(Fo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),Nv=Je(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Mc).getRegex(),Go={blockquote:Nv,code:Cv,def:Dv,fences:Iv,heading:Rv,hr:ms,html:Lv,lheading:Dc,list:Mv,newline:Av,paragraph:Mc,table:Wr,text:Ov},Wl=Je("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex(),qv={...Go,lheading:Pv,table:Wl,paragraph:Je(Fo).replace("hr",ms).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",di).getRegex()},jv={...Go,html:Je(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Uo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Wr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Je(Fo).replace("hr",ms).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Dc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Bv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Lc=/^( {2,}|\\)\n(?!\s*$)/,Fv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,hi=/[\p{P}\p{S}]/u,Ho=/[\s\p{P}\p{S}]/u,Nc=/[^\s\p{P}\p{S}]/u,Kv=Je(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ho).getRegex(),qc=/(?!~)[\p{P}\p{S}]/u,Uv=/(?!~)[\s\p{P}\p{S}]/u,Gv=/(?:[^\s\p{P}\p{S}]|~)/u,jc=/(?![*_])[\p{P}\p{S}]/u,Hv=/(?![*_])[\s\p{P}\p{S}]/u,Wv=/(?:[^\s\p{P}\p{S}]|[*_])/u,Yv=Je(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Tv?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Bc=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Vv=Je(Bc,"u").replace(/punct/g,hi).getRegex(),Qv=Je(Bc,"u").replace(/punct/g,qc).getRegex(),zc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Xv=Je(zc,"gu").replace(/notPunctSpace/g,Nc).replace(/punctSpace/g,Ho).replace(/punct/g,hi).getRegex(),Zv=Je(zc,"gu").replace(/notPunctSpace/g,Gv).replace(/punctSpace/g,Uv).replace(/punct/g,qc).getRegex(),Jv=Je("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Nc).replace(/punctSpace/g,Ho).replace(/punct/g,hi).getRegex(),$v=Je(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,jc).getRegex(),eg="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",tg=Je(eg,"gu").replace(/notPunctSpace/g,Wv).replace(/punctSpace/g,Hv).replace(/punct/g,jc).getRegex(),ng=Je(/\\(punct)/,"gu").replace(/punct/g,hi).getRegex(),rg=Je(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ag=Je(Uo).replace("(?:-->|$)","-->").getRegex(),sg=Je("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ag).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ig=Je(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Fc=Je(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",Ko).getRegex(),Kc=Je(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ko).getRegex(),og=Je("reflink|nolink(?!\\()","g").replace("reflink",Fc).replace("nolink",Kc).getRegex(),Yl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Wo={_backpedal:Wr,anyPunctuation:ng,autolink:rg,blockSkip:Yv,br:Lc,code:zv,del:Wr,delLDelim:Wr,delRDelim:Wr,emStrongLDelim:Vv,emStrongRDelimAst:Xv,emStrongRDelimUnd:Jv,escape:Bv,link:ig,nolink:Kc,punctuation:Kv,reflink:Fc,reflinkSearch:og,tag:sg,text:Fv,url:Wr},lg={...Wo,link:Je(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:Je(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},po={...Wo,emStrongRDelimAst:Zv,emStrongLDelim:Qv,delLDelim:$v,delRDelim:tg,url:Je(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Yl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Je(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Yl).getRegex()},ug={...po,br:Je(Lc).replace("{2,}","*").getRegex(),text:Je(po.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Fs={normal:Go,gfm:qv,pedantic:jv},Ya={normal:Wo,gfm:po,breaks:ug,pedantic:lg},cg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Vl=t=>cg[t];function ar(t,e){if(e){if(Kt.escapeTest.test(t))return t.replace(Kt.escapeReplace,Vl)}else if(Kt.escapeTestNoEncode.test(t))return t.replace(Kt.escapeReplaceNoEncode,Vl);return t}function Ql(t){try{t=encodeURI(t).replace(Kt.percentDecode,"%")}catch{return null}return t}function Xl(t,e){var o;let r=t.replace(Kt.findPipe,(c,d,v)=>{let p=!1,y=d;for(;--y>=0&&v[y]==="\\";)p=!p;return p?"|":" |"}),s=r.split(Kt.splitPipe),i=0;if(s[0].trim()||s.shift(),s.length>0&&!((o=s.at(-1))!=null&&o.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(Kt.slashPipe,"|");return s}function Va(t,e,r){let s=t.length;if(s===0)return"";let i=0;for(;i<s&&t.charAt(s-i-1)===e;)i++;return t.slice(0,s-i)}function fg(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let s=0;s<t.length;s++)if(t[s]==="\\")s++;else if(t[s]===e[0])r++;else if(t[s]===e[1]&&(r--,r<0))return s;return r>0?-2:-1}function dg(t,e=0){let r=e,s="";for(let i of t)if(i==="	"){let o=4-r%4;s+=" ".repeat(o),r+=o}else s+=i,r++;return s}function Zl(t,e,r,s,i){let o=e.href,c=e.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");s.state.inLink=!0;let v={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:o,title:c,text:d,tokens:s.inlineTokens(d)};return s.state.inLink=!1,v}function hg(t,e,r){let s=t.match(r.other.indentCodeCompensation);if(s===null)return e;let i=s[1];return e.split(`
`).map(o=>{let c=o.match(r.other.beginningSpace);if(c===null)return o;let[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var ri=class{constructor(t){Ye(this,"options");Ye(this,"rules");Ye(this,"lexer");this.options=t||fa}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let r=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Va(r,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let r=e[0],s=hg(r,e[3]||"",this.rules);return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let r=e[2].trim();if(this.rules.other.endingHash.test(r)){let s=Va(r,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(r=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Va(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let r=Va(e[0],`
`).split(`
`),s="",i="",o=[];for(;r.length>0;){let c=!1,d=[],v;for(v=0;v<r.length;v++)if(this.rules.other.blockquoteStart.test(r[v]))d.push(r[v]),c=!0;else if(!c)d.push(r[v]);else break;r=r.slice(v);let p=d.join(`
`),y=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${p}`:p,i=i?`${i}
${y}`:y;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(y,o,!0),this.lexer.state.top=x,r.length===0)break;let _=o.at(-1);if((_==null?void 0:_.type)==="code")break;if((_==null?void 0:_.type)==="blockquote"){let w=_,M=w.raw+`
`+r.join(`
`),q=this.blockquote(M);o[o.length-1]=q,s=s.substring(0,s.length-w.raw.length)+q.raw,i=i.substring(0,i.length-w.text.length)+q.text;break}else if((_==null?void 0:_.type)==="list"){let w=_,M=w.raw+`
`+r.join(`
`),q=this.list(M);o[o.length-1]=q,s=s.substring(0,s.length-_.raw.length)+q.raw,i=i.substring(0,i.length-w.raw.length)+q.raw,r=M.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:o,text:i}}}list(t){var r,s;let e=this.rules.block.list.exec(t);if(e){let i=e[1].trim(),o=i.length>1,c={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");let d=this.rules.other.listItemRegex(i),v=!1;for(;t;){let y=!1,x="",_="";if(!(e=d.exec(t))||this.rules.block.hr.test(t))break;x=e[0],t=t.substring(x.length);let w=dg(e[2].split(`
`,1)[0],e[1].length),M=t.split(`
`,1)[0],q=!w.trim(),S=0;if(this.options.pedantic?(S=2,_=w.trimStart()):q?S=e[1].length+1:(S=w.search(this.rules.other.nonSpaceChar),S=S>4?1:S,_=w.slice(S),S+=e[1].length),q&&this.rules.other.blankLine.test(M)&&(x+=M+`
`,t=t.substring(M.length+1),y=!0),!y){let F=this.rules.other.nextBulletRegex(S),te=this.rules.other.hrRegex(S),G=this.rules.other.fencesBeginRegex(S),U=this.rules.other.headingBeginRegex(S),X=this.rules.other.htmlBeginRegex(S),J=this.rules.other.blockquoteBeginRegex(S);for(;t;){let Y=t.split(`
`,1)[0],ge;if(M=Y,this.options.pedantic?(M=M.replace(this.rules.other.listReplaceNesting,"  "),ge=M):ge=M.replace(this.rules.other.tabCharGlobal,"    "),G.test(M)||U.test(M)||X.test(M)||J.test(M)||F.test(M)||te.test(M))break;if(ge.search(this.rules.other.nonSpaceChar)>=S||!M.trim())_+=`
`+ge.slice(S);else{if(q||w.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||G.test(w)||U.test(w)||te.test(w))break;_+=`
`+M}q=!M.trim(),x+=Y+`
`,t=t.substring(Y.length+1),w=ge.slice(S)}}c.loose||(v?c.loose=!0:this.rules.other.doubleBlankLine.test(x)&&(v=!0)),c.items.push({type:"list_item",raw:x,task:!!this.options.gfm&&this.rules.other.listIsTask.test(_),loose:!1,text:_,tokens:[]}),c.raw+=x}let p=c.items.at(-1);if(p)p.raw=p.raw.trimEnd(),p.text=p.text.trimEnd();else return;c.raw=c.raw.trimEnd();for(let y of c.items){if(this.lexer.state.top=!1,y.tokens=this.lexer.blockTokens(y.text,[]),y.task){if(y.text=y.text.replace(this.rules.other.listReplaceTask,""),((r=y.tokens[0])==null?void 0:r.type)==="text"||((s=y.tokens[0])==null?void 0:s.type)==="paragraph"){y.tokens[0].raw=y.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),y.tokens[0].text=y.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let _=this.lexer.inlineQueue.length-1;_>=0;_--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[_].src)){this.lexer.inlineQueue[_].src=this.lexer.inlineQueue[_].src.replace(this.rules.other.listReplaceTask,"");break}}let x=this.rules.other.listTaskCheckbox.exec(y.raw);if(x){let _={type:"checkbox",raw:x[0]+" ",checked:x[0]!=="[ ]"};y.checked=_.checked,c.loose?y.tokens[0]&&["paragraph","text"].includes(y.tokens[0].type)&&"tokens"in y.tokens[0]&&y.tokens[0].tokens?(y.tokens[0].raw=_.raw+y.tokens[0].raw,y.tokens[0].text=_.raw+y.tokens[0].text,y.tokens[0].tokens.unshift(_)):y.tokens.unshift({type:"paragraph",raw:_.raw,text:_.raw,tokens:[_]}):y.tokens.unshift(_)}}if(!c.loose){let x=y.tokens.filter(w=>w.type==="space"),_=x.length>0&&x.some(w=>this.rules.other.anyLine.test(w.raw));c.loose=_}}if(c.loose)for(let y of c.items){y.loose=!0;for(let x of y.tokens)x.type==="text"&&(x.type="paragraph")}return c}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let r=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:s,title:i}}}table(t){var c;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let r=Xl(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(r.length===s.length){for(let d of s)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<r.length;d++)o.header.push({text:r[d],tokens:this.lexer.inline(r[d]),header:!0,align:o.align[d]});for(let d of i)o.rows.push(Xl(d,o.header.length).map((v,p)=>({text:v,tokens:this.lexer.inline(v),header:!1,align:o.align[p]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let r=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let r=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let o=Va(r.slice(0,-1),"\\");if((r.length-o.length)%2===0)return}else{let o=fg(e[2],"()");if(o===-2)return;if(o>-1){let c=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,c).trim(),e[3]=""}}let s=e[2],i="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(s);o&&(s=o[1],i=o[3])}else i=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?s=s.slice(1):s=s.slice(1,-1)),Zl(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){let s=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[s.toLowerCase()];if(!i){let o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return Zl(r,i,r[0],this.lexer,this.rules)}}emStrong(t,e,r=""){let s=this.rules.inline.emStrongLDelim.exec(t);if(!(!s||s[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,o,c,d=i,v=0,p=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+i);(s=p.exec(e))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(c=[...o].length,s[3]||s[4]){d+=c;continue}else if((s[5]||s[6])&&i%3&&!((i+c)%3)){v+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d+v);let y=[...s[0]][0].length,x=t.slice(0,i+s.index+y+c);if(Math.min(i,c)%2){let w=x.slice(1,-1);return{type:"em",raw:x,text:w,tokens:this.lexer.inlineTokens(w)}}let _=x.slice(2,-2);return{type:"strong",raw:x,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let r=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(r),i=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return s&&i&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:e[0],text:r}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t,e,r=""){let s=this.rules.inline.delLDelim.exec(t);if(s&&(!s[1]||!r||this.rules.inline.punctuation.exec(r))){let i=[...s[0]].length-1,o,c,d=i,v=this.rules.inline.delRDelim;for(v.lastIndex=0,e=e.slice(-1*t.length+i);(s=v.exec(e))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o||(c=[...o].length,c!==i))continue;if(s[3]||s[4]){d+=c;continue}if(d-=c,d>0)continue;c=Math.min(c,c+d);let p=[...s[0]][0].length,y=t.slice(0,i+s.index+p+c),x=y.slice(i,-i);return{type:"del",raw:y,text:x,tokens:this.lexer.inlineTokens(x)}}}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let r,s;return e[2]==="@"?(r=e[1],s="mailto:"+r):(r=e[1],s=r),{type:"link",raw:e[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}url(t){var r;let e;if(e=this.rules.inline.url.exec(t)){let s,i;if(e[2]==="@")s=e[0],i="mailto:"+s;else{let o;do o=e[0],e[0]=((r=this.rules.inline._backpedal.exec(e[0]))==null?void 0:r[0])??"";while(o!==e[0]);s=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let r=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:r}}}},Mn=class vo{constructor(e){Ye(this,"tokens");Ye(this,"options");Ye(this,"state");Ye(this,"inlineQueue");Ye(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||fa,this.options.tokenizer=this.options.tokenizer||new ri,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Kt,block:Fs.normal,inline:Ya.normal};this.options.pedantic?(r.block=Fs.pedantic,r.inline=Ya.pedantic):this.options.gfm&&(r.block=Fs.gfm,this.options.breaks?r.inline=Ya.breaks:r.inline=Ya.gfm),this.tokenizer.rules=r}static get rules(){return{block:Fs,inline:Ya}}static lex(e,r){return new vo(r).lex(e)}static lexInline(e,r){return new vo(r).inlineTokens(e)}lex(e){e=e.replace(Kt.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let s=this.inlineQueue[r];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],s=!1){var i,o,c;for(this.options.pedantic&&(e=e.replace(Kt.tabCharGlobal,"    ").replace(Kt.spaceLine,""));e;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(p=>(d=p.call({lexer:this},e,r))?(e=e.substring(d.raw.length),r.push(d),!0):!1))continue;if(d=this.tokenizer.space(e)){e=e.substring(d.raw.length);let p=r.at(-1);d.raw.length===1&&p!==void 0?p.raw+=`
`:r.push(d);continue}if(d=this.tokenizer.code(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(d=this.tokenizer.fences(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.heading(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.hr(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.blockquote(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.list(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.html(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.def(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="paragraph"||(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.raw,this.inlineQueue.at(-1).src=p.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title},r.push(d));continue}if(d=this.tokenizer.table(e)){e=e.substring(d.raw.length),r.push(d);continue}if(d=this.tokenizer.lheading(e)){e=e.substring(d.raw.length),r.push(d);continue}let v=e;if((c=this.options.extensions)!=null&&c.startBlock){let p=1/0,y=e.slice(1),x;this.options.extensions.startBlock.forEach(_=>{x=_.call({lexer:this},y),typeof x=="number"&&x>=0&&(p=Math.min(p,x))}),p<1/0&&p>=0&&(v=e.substring(0,p+1))}if(this.state.top&&(d=this.tokenizer.paragraph(v))){let p=r.at(-1);s&&(p==null?void 0:p.type)==="paragraph"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d),s=v.length!==e.length,e=e.substring(d.raw.length);continue}if(d=this.tokenizer.text(e)){e=e.substring(d.raw.length);let p=r.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=(p.raw.endsWith(`
`)?"":`
`)+d.raw,p.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=p.text):r.push(d);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){var v,p,y,x,_;let s=e,i=null;if(this.tokens.links){let w=Object.keys(this.tokens.links);if(w.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)w.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)o=i[2]?i[2].length:0,s=s.slice(0,i.index+o)+"["+"a".repeat(i[0].length-o-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((p=(v=this.options.hooks)==null?void 0:v.emStrongMask)==null?void 0:p.call({lexer:this},s))??s;let c=!1,d="";for(;e;){c||(d=""),c=!1;let w;if((x=(y=this.options.extensions)==null?void 0:y.inline)!=null&&x.some(q=>(w=q.call({lexer:this},e,r))?(e=e.substring(w.raw.length),r.push(w),!0):!1))continue;if(w=this.tokenizer.escape(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.tag(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.link(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(w.raw.length);let q=r.at(-1);w.type==="text"&&(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(w=this.tokenizer.emStrong(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.codespan(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.br(e)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.del(e,s,d)){e=e.substring(w.raw.length),r.push(w);continue}if(w=this.tokenizer.autolink(e)){e=e.substring(w.raw.length),r.push(w);continue}if(!this.state.inLink&&(w=this.tokenizer.url(e))){e=e.substring(w.raw.length),r.push(w);continue}let M=e;if((_=this.options.extensions)!=null&&_.startInline){let q=1/0,S=e.slice(1),F;this.options.extensions.startInline.forEach(te=>{F=te.call({lexer:this},S),typeof F=="number"&&F>=0&&(q=Math.min(q,F))}),q<1/0&&q>=0&&(M=e.substring(0,q+1))}if(w=this.tokenizer.inlineText(M)){e=e.substring(w.raw.length),w.raw.slice(-1)!=="_"&&(d=w.raw.slice(-1)),c=!0;let q=r.at(-1);(q==null?void 0:q.type)==="text"?(q.raw+=w.raw,q.text+=w.text):r.push(w);continue}if(e){let q="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(q);break}else throw new Error(q)}}return r}},ai=class{constructor(t){Ye(this,"options");Ye(this,"parser");this.options=t||fa}space(t){return""}code({text:t,lang:e,escaped:r}){var o;let s=(o=(e||"").match(Kt.notSpaceStart))==null?void 0:o[0],i=t.replace(Kt.endingNewline,"")+`
`;return s?'<pre><code class="language-'+ar(s)+'">'+(r?i:ar(i,!0))+`</code></pre>
`:"<pre><code>"+(r?i:ar(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,r=t.start,s="";for(let c=0;c<t.items.length;c++){let d=t.items[c];s+=this.listitem(d)}let i=e?"ol":"ul",o=e&&r!==1?' start="'+r+'"':"";return"<"+i+o+`>
`+s+"</"+i+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",r="";for(let i=0;i<t.header.length;i++)r+=this.tablecell(t.header[i]);e+=this.tablerow({text:r});let s="";for(let i=0;i<t.rows.length;i++){let o=t.rows[i];r="";for(let c=0;c<o.length;c++)r+=this.tablecell(o[c]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),r=t.header?"th":"td";return(t.align?`<${r} align="${t.align}">`:`<${r}>`)+e+`</${r}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ar(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:r}){let s=this.parser.parseInline(r),i=Ql(t);if(i===null)return s;t=i;let o='<a href="'+t+'"';return e&&(o+=' title="'+ar(e)+'"'),o+=">"+s+"</a>",o}image({href:t,title:e,text:r,tokens:s}){s&&(r=this.parser.parseInline(s,this.parser.textRenderer));let i=Ql(t);if(i===null)return ar(r);t=i;let o=`<img src="${t}" alt="${r}"`;return e&&(o+=` title="${ar(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ar(t.text)}},Yo=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Ln=class go{constructor(e){Ye(this,"options");Ye(this,"renderer");Ye(this,"textRenderer");this.options=e||fa,this.options.renderer=this.options.renderer||new ai,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Yo}static parse(e,r){return new go(r).parse(e)}static parseInline(e,r){return new go(r).parseInline(e)}parse(e){var s,i;let r="";for(let o=0;o<e.length;o++){let c=e[o];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[c.type]){let v=c,p=this.options.extensions.renderers[v.type].call({parser:this},v);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(v.type)){r+=p||"";continue}}let d=c;switch(d.type){case"space":{r+=this.renderer.space(d);break}case"hr":{r+=this.renderer.hr(d);break}case"heading":{r+=this.renderer.heading(d);break}case"code":{r+=this.renderer.code(d);break}case"table":{r+=this.renderer.table(d);break}case"blockquote":{r+=this.renderer.blockquote(d);break}case"list":{r+=this.renderer.list(d);break}case"checkbox":{r+=this.renderer.checkbox(d);break}case"html":{r+=this.renderer.html(d);break}case"def":{r+=this.renderer.def(d);break}case"paragraph":{r+=this.renderer.paragraph(d);break}case"text":{r+=this.renderer.text(d);break}default:{let v='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(v),"";throw new Error(v)}}}return r}parseInline(e,r=this.renderer){var i,o;let s="";for(let c=0;c<e.length;c++){let d=e[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){let p=this.options.extensions.renderers[d.type].call({parser:this},d);if(p!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){s+=p||"";continue}}let v=d;switch(v.type){case"escape":{s+=r.text(v);break}case"html":{s+=r.html(v);break}case"link":{s+=r.link(v);break}case"image":{s+=r.image(v);break}case"checkbox":{s+=r.checkbox(v);break}case"strong":{s+=r.strong(v);break}case"em":{s+=r.em(v);break}case"codespan":{s+=r.codespan(v);break}case"br":{s+=r.br(v);break}case"del":{s+=r.del(v);break}case"text":{s+=r.text(v);break}default:{let p='Token with "'+v.type+'" type was not found.';if(this.options.silent)return console.error(p),"";throw new Error(p)}}}return s}},Gs,ts=(Gs=class{constructor(t){Ye(this,"options");Ye(this,"block");this.options=t||fa}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?Mn.lex:Mn.lexInline}provideParser(){return this.block?Ln.parse:Ln.parseInline}},Ye(Gs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),Ye(Gs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),Gs),pg=class{constructor(...t){Ye(this,"defaults",Bo());Ye(this,"options",this.setOptions);Ye(this,"parse",this.parseMarkdown(!0));Ye(this,"parseInline",this.parseMarkdown(!1));Ye(this,"Parser",Ln);Ye(this,"Renderer",ai);Ye(this,"TextRenderer",Yo);Ye(this,"Lexer",Mn);Ye(this,"Tokenizer",ri);Ye(this,"Hooks",ts);this.use(...t)}walkTokens(t,e){var s,i;let r=[];for(let o of t)switch(r=r.concat(e.call(this,o)),o.type){case"table":{let c=o;for(let d of c.header)r=r.concat(this.walkTokens(d.tokens,e));for(let d of c.rows)for(let v of d)r=r.concat(this.walkTokens(v.tokens,e));break}case"list":{let c=o;r=r.concat(this.walkTokens(c.items,e));break}default:{let c=o;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{let v=c[d].flat(1/0);r=r.concat(this.walkTokens(v,e))}):c.tokens&&(r=r.concat(this.walkTokens(c.tokens,e)))}}return r}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(r=>{let s={...r};if(s.async=this.defaults.async||s.async||!1,r.extensions&&(r.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let o=e.renderers[i.name];o?e.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[i.level];o?o.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),s.extensions=e),r.renderer){let i=this.defaults.renderer||new ai(this.defaults);for(let o in r.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let c=o,d=r.renderer[c],v=i[c];i[c]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y||""}}s.renderer=i}if(r.tokenizer){let i=this.defaults.tokenizer||new ri(this.defaults);for(let o in r.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let c=o,d=r.tokenizer[c],v=i[c];i[c]=(...p)=>{let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}s.tokenizer=i}if(r.hooks){let i=this.defaults.hooks||new ts;for(let o in r.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let c=o,d=r.hooks[c],v=i[c];ts.passThroughHooks.has(o)?i[c]=p=>{if(this.defaults.async&&ts.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await d.call(i,p);return v.call(i,x)})();let y=d.call(i,p);return v.call(i,y)}:i[c]=(...p)=>{if(this.defaults.async)return(async()=>{let x=await d.apply(i,p);return x===!1&&(x=await v.apply(i,p)),x})();let y=d.apply(i,p);return y===!1&&(y=v.apply(i,p)),y}}s.hooks=i}if(r.walkTokens){let i=this.defaults.walkTokens,o=r.walkTokens;s.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...s}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Mn.lex(t,e??this.defaults)}parser(t,e){return Ln.parse(t,e??this.defaults)}parseMarkdown(t){return(e,r)=>{let s={...r},i={...this.defaults,...s},o=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=t),i.async)return(async()=>{let c=i.hooks?await i.hooks.preprocess(e):e,d=await(i.hooks?await i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(c,i),v=i.hooks?await i.hooks.processAllTokens(d):d;i.walkTokens&&await Promise.all(this.walkTokens(v,i.walkTokens));let p=await(i.hooks?await i.hooks.provideParser():t?Ln.parse:Ln.parseInline)(v,i);return i.hooks?await i.hooks.postprocess(p):p})().catch(o);try{i.hooks&&(e=i.hooks.preprocess(e));let c=(i.hooks?i.hooks.provideLexer():t?Mn.lex:Mn.lexInline)(e,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let d=(i.hooks?i.hooks.provideParser():t?Ln.parse:Ln.parseInline)(c,i);return i.hooks&&(d=i.hooks.postprocess(d)),d}catch(c){return o(c)}}}onError(t,e){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let s="<p>An error occurred:</p><pre>"+ar(r.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(r);throw r}}},ua=new pg;function nt(t,e){return ua.parse(t,e)}nt.options=nt.setOptions=function(t){return ua.setOptions(t),nt.defaults=ua.defaults,Pc(nt.defaults),nt};nt.getDefaults=Bo;nt.defaults=fa;nt.use=function(...t){return ua.use(...t),nt.defaults=ua.defaults,Pc(nt.defaults),nt};nt.walkTokens=function(t,e){return ua.walkTokens(t,e)};nt.parseInline=ua.parseInline;nt.Parser=Ln;nt.parser=Ln.parse;nt.Renderer=ai;nt.TextRenderer=Yo;nt.Lexer=Mn;nt.lexer=Mn.lex;nt.Tokenizer=ri;nt.Hooks=ts;nt.parse=nt;nt.options;nt.setOptions;nt.use;nt.walkTokens;nt.parseInline;Ln.parse;Mn.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Uc,setPrototypeOf:Jl,isFrozen:vg,getPrototypeOf:gg,getOwnPropertyDescriptor:mg}=Object;let{freeze:Gt,seal:xn,create:mo}=Object,{apply:yo,construct:bo}=typeof Reflect<"u"&&Reflect;Gt||(Gt=function(e){return e});xn||(xn=function(e){return e});yo||(yo=function(e,r){for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o];return e.apply(r,i)});bo||(bo=function(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return new e(...s)});const Ks=Ht(Array.prototype.forEach),yg=Ht(Array.prototype.lastIndexOf),$l=Ht(Array.prototype.pop),Qa=Ht(Array.prototype.push),bg=Ht(Array.prototype.splice),Zs=Ht(String.prototype.toLowerCase),Hi=Ht(String.prototype.toString),Wi=Ht(String.prototype.match),Xa=Ht(String.prototype.replace),_g=Ht(String.prototype.indexOf),wg=Ht(String.prototype.trim),On=Ht(Object.prototype.hasOwnProperty),Ft=Ht(RegExp.prototype.test),Za=kg(TypeError);function Ht(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return yo(t,e,s)}}function kg(t){return function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return bo(t,r)}}function We(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs;Jl&&Jl(t,null);let s=e.length;for(;s--;){let i=e[s];if(typeof i=="string"){const o=r(i);o!==i&&(vg(e)||(e[s]=o),i=o)}t[i]=!0}return t}function xg(t){for(let e=0;e<t.length;e++)On(t,e)||(t[e]=null);return t}function Wn(t){const e=mo(null);for(const[r,s]of Uc(t))On(t,r)&&(Array.isArray(s)?e[r]=xg(s):s&&typeof s=="object"&&s.constructor===Object?e[r]=Wn(s):e[r]=s);return e}function Ja(t,e){for(;t!==null;){const s=mg(t,e);if(s){if(s.get)return Ht(s.get);if(typeof s.value=="function")return Ht(s.value)}t=gg(t)}function r(){return null}return r}const eu=Gt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yi=Gt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Vi=Gt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sg=Gt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Qi=Gt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Eg=Gt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tu=Gt(["#text"]),nu=Gt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Xi=Gt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ru=Gt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Us=Gt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tg=xn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ag=xn(/<%[\w\W]*|[\w\W]*%>/gm),Cg=xn(/\$\{[\w\W]*/gm),Ig=xn(/^data-[\-\w.\u00B7-\uFFFF]+$/),Rg=xn(/^aria-[\-\w]+$/),Gc=xn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Pg=xn(/^(?:\w+script|data):/i),Og=xn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hc=xn(/^html$/i),Dg=xn(/^[a-z][.\w]*(-[.\w]+)+$/i);var au=Object.freeze({__proto__:null,ARIA_ATTR:Rg,ATTR_WHITESPACE:Og,CUSTOM_ELEMENT:Dg,DATA_ATTR:Ig,DOCTYPE_NAME:Hc,ERB_EXPR:Ag,IS_ALLOWED_URI:Gc,IS_SCRIPT_OR_DATA:Pg,MUSTACHE_EXPR:Tg,TMPLIT_EXPR:Cg});const $a={element:1,text:3,progressingInstruction:7,comment:8,document:9},Mg=function(){return typeof window>"u"?null:window},Lg=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(s=r.getAttribute(i));const o="dompurify"+(s?"#"+s:"");try{return e.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},su=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Wc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mg();const e=Me=>Wc(Me);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==$a.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const s=r,i=s.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:v,NodeFilter:p,NamedNodeMap:y=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:_,trustedTypes:w}=t,M=v.prototype,q=Ja(M,"cloneNode"),S=Ja(M,"remove"),F=Ja(M,"nextSibling"),te=Ja(M,"childNodes"),G=Ja(M,"parentNode");if(typeof c=="function"){const Me=r.createElement("template");Me.content&&Me.content.ownerDocument&&(r=Me.content.ownerDocument)}let U,X="";const{implementation:J,createNodeIterator:Y,createDocumentFragment:ge,getElementsByTagName:Le}=r,{importNode:_e}=s;let ve=su();e.isSupported=typeof Uc=="function"&&typeof G=="function"&&J&&J.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ae,ERB_EXPR:ne,TMPLIT_EXPR:qe,DATA_ATTR:se,ARIA_ATTR:le,IS_SCRIPT_OR_DATA:ue,ATTR_WHITESPACE:Q,CUSTOM_ELEMENT:ee}=au;let{IS_ALLOWED_URI:$}=au,he=null;const Z=We({},[...eu,...Yi,...Vi,...Qi,...tu]);let fe=null;const Ae=We({},[...nu,...Xi,...ru,...Us]);let Ee=Object.seal(mo(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),pe=null,ie=null;const Ne=Object.seal(mo(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Fe=!0,be=!0,lt=!1,Ke=!0,ut=!1,en=!0,At=!1,Or=!1,Dr=!1,Sn=!1,vr=!1,zn=!1,zt=!0,Mr=!1;const Fn="user-content-";let $n=!0,tn=!1,ze={},at=null;const nn=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rn=null;const Kn=We({},["audio","video","img","source","image","track"]);let En=null;const dn=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Tn="http://www.w3.org/1998/Math/MathML",gr="http://www.w3.org/2000/svg",xt="http://www.w3.org/1999/xhtml";let De=xt,er=!1,An=null;const da=We({},[Tn,gr,xt],Hi);let Te=We({},["mi","mo","mn","ms","mtext"]),mr=We({},["annotation-xml"]);const ys=We({},["title","style","font","a","script"]);let tr=null;const bs=["application/xhtml+xml","text/html"],Ma="text/html";let yt=null,yr=null;const br=r.createElement("form"),nr=function(T){return T instanceof RegExp||T instanceof Function},Lr=function(){let T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(yr&&yr===T)){if((!T||typeof T!="object")&&(T={}),T=Wn(T),tr=bs.indexOf(T.PARSER_MEDIA_TYPE)===-1?Ma:T.PARSER_MEDIA_TYPE,yt=tr==="application/xhtml+xml"?Hi:Zs,he=On(T,"ALLOWED_TAGS")?We({},T.ALLOWED_TAGS,yt):Z,fe=On(T,"ALLOWED_ATTR")?We({},T.ALLOWED_ATTR,yt):Ae,An=On(T,"ALLOWED_NAMESPACES")?We({},T.ALLOWED_NAMESPACES,Hi):da,En=On(T,"ADD_URI_SAFE_ATTR")?We(Wn(dn),T.ADD_URI_SAFE_ATTR,yt):dn,rn=On(T,"ADD_DATA_URI_TAGS")?We(Wn(Kn),T.ADD_DATA_URI_TAGS,yt):Kn,at=On(T,"FORBID_CONTENTS")?We({},T.FORBID_CONTENTS,yt):nn,pe=On(T,"FORBID_TAGS")?We({},T.FORBID_TAGS,yt):Wn({}),ie=On(T,"FORBID_ATTR")?We({},T.FORBID_ATTR,yt):Wn({}),ze=On(T,"USE_PROFILES")?T.USE_PROFILES:!1,Fe=T.ALLOW_ARIA_ATTR!==!1,be=T.ALLOW_DATA_ATTR!==!1,lt=T.ALLOW_UNKNOWN_PROTOCOLS||!1,Ke=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ut=T.SAFE_FOR_TEMPLATES||!1,en=T.SAFE_FOR_XML!==!1,At=T.WHOLE_DOCUMENT||!1,Sn=T.RETURN_DOM||!1,vr=T.RETURN_DOM_FRAGMENT||!1,zn=T.RETURN_TRUSTED_TYPE||!1,Dr=T.FORCE_BODY||!1,zt=T.SANITIZE_DOM!==!1,Mr=T.SANITIZE_NAMED_PROPS||!1,$n=T.KEEP_CONTENT!==!1,tn=T.IN_PLACE||!1,$=T.ALLOWED_URI_REGEXP||Gc,De=T.NAMESPACE||xt,Te=T.MATHML_TEXT_INTEGRATION_POINTS||Te,mr=T.HTML_INTEGRATION_POINTS||mr,Ee=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&nr(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&nr(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ee.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ut&&(be=!1),vr&&(Sn=!0),ze&&(he=We({},tu),fe=[],ze.html===!0&&(We(he,eu),We(fe,nu)),ze.svg===!0&&(We(he,Yi),We(fe,Xi),We(fe,Us)),ze.svgFilters===!0&&(We(he,Vi),We(fe,Xi),We(fe,Us)),ze.mathMl===!0&&(We(he,Qi),We(fe,ru),We(fe,Us))),T.ADD_TAGS&&(typeof T.ADD_TAGS=="function"?Ne.tagCheck=T.ADD_TAGS:(he===Z&&(he=Wn(he)),We(he,T.ADD_TAGS,yt))),T.ADD_ATTR&&(typeof T.ADD_ATTR=="function"?Ne.attributeCheck=T.ADD_ATTR:(fe===Ae&&(fe=Wn(fe)),We(fe,T.ADD_ATTR,yt))),T.ADD_URI_SAFE_ATTR&&We(En,T.ADD_URI_SAFE_ATTR,yt),T.FORBID_CONTENTS&&(at===nn&&(at=Wn(at)),We(at,T.FORBID_CONTENTS,yt)),T.ADD_FORBID_CONTENTS&&(at===nn&&(at=Wn(at)),We(at,T.ADD_FORBID_CONTENTS,yt)),$n&&(he["#text"]=!0),At&&We(he,["html","head","body"]),he.table&&(We(he,["tbody"]),delete pe.tbody),T.TRUSTED_TYPES_POLICY){if(typeof T.TRUSTED_TYPES_POLICY.createHTML!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof T.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Za('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=T.TRUSTED_TYPES_POLICY,X=U.createHTML("")}else U===void 0&&(U=Lg(w,i)),U!==null&&typeof X=="string"&&(X=U.createHTML(""));Gt&&Gt(T),yr=T}},Nr=We({},[...Yi,...Vi,...Sg]),st=We({},[...Qi,...Eg]),kt=function(T){let de=G(T);(!de||!de.tagName)&&(de={namespaceURI:De,tagName:"template"});const we=Zs(T.tagName),$e=Zs(de.tagName);return An[T.namespaceURI]?T.namespaceURI===gr?de.namespaceURI===xt?we==="svg":de.namespaceURI===Tn?we==="svg"&&($e==="annotation-xml"||Te[$e]):!!Nr[we]:T.namespaceURI===Tn?de.namespaceURI===xt?we==="math":de.namespaceURI===gr?we==="math"&&mr[$e]:!!st[we]:T.namespaceURI===xt?de.namespaceURI===gr&&!mr[$e]||de.namespaceURI===Tn&&!Te[$e]?!1:!st[we]&&(ys[we]||!Nr[we]):!!(tr==="application/xhtml+xml"&&An[T.namespaceURI]):!1},hn=function(T){Qa(e.removed,{element:T});try{G(T).removeChild(T)}catch{S(T)}},pn=function(T,de){try{Qa(e.removed,{attribute:de.getAttributeNode(T),from:de})}catch{Qa(e.removed,{attribute:null,from:de})}if(de.removeAttribute(T),T==="is")if(Sn||vr)try{hn(de)}catch{}else try{de.setAttribute(T,"")}catch{}},qr=function(T){let de=null,we=null;if(Dr)T="<remove></remove>"+T;else{const ht=Wi(T,/^[\r\n\t ]+/);we=ht&&ht[0]}tr==="application/xhtml+xml"&&De===xt&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");const $e=U?U.createHTML(T):T;if(De===xt)try{de=new _().parseFromString($e,tr)}catch{}if(!de||!de.documentElement){de=J.createDocument(De,"template",null);try{de.documentElement.innerHTML=er?X:$e}catch{}}const it=de.body||de.documentElement;return T&&we&&it.insertBefore(r.createTextNode(we),it.childNodes[0]||null),De===xt?Le.call(de,At?"html":"body")[0]:At?de.documentElement:it},jr=function(T){return Y.call(T.ownerDocument||T,T,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},La=function(T){return T instanceof x&&(typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof y)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},Cn=function(T){return typeof d=="function"&&T instanceof d};function Lt(Me,T,de){Ks(Me,we=>{we.call(e,T,de,yr)})}const In=function(T){let de=null;if(Lt(ve.beforeSanitizeElements,T,null),La(T))return hn(T),!0;const we=yt(T.nodeName);if(Lt(ve.uponSanitizeElement,T,{tagName:we,allowedTags:he}),en&&T.hasChildNodes()&&!Cn(T.firstElementChild)&&Ft(/<[/\w!]/g,T.innerHTML)&&Ft(/<[/\w!]/g,T.textContent)||T.nodeType===$a.progressingInstruction||en&&T.nodeType===$a.comment&&Ft(/<[/\w]/g,T.data))return hn(T),!0;if(!(Ne.tagCheck instanceof Function&&Ne.tagCheck(we))&&(!he[we]||pe[we])){if(!pe[we]&&_s(we)&&(Ee.tagNameCheck instanceof RegExp&&Ft(Ee.tagNameCheck,we)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(we)))return!1;if($n&&!at[we]){const $e=G(T)||T.parentNode,it=te(T)||T.childNodes;if(it&&$e){const ht=it.length;for(let bt=ht-1;bt>=0;--bt){const Wt=q(it[bt],!0);Wt.__removalCount=(T.__removalCount||0)+1,$e.insertBefore(Wt,F(T))}}}return hn(T),!0}return T instanceof v&&!kt(T)||(we==="noscript"||we==="noembed"||we==="noframes")&&Ft(/<\/no(script|embed|frames)/i,T.innerHTML)?(hn(T),!0):(ut&&T.nodeType===$a.text&&(de=T.textContent,Ks([ae,ne,qe],$e=>{de=Xa(de,$e," ")}),T.textContent!==de&&(Qa(e.removed,{element:T.cloneNode()}),T.textContent=de)),Lt(ve.afterSanitizeElements,T,null),!1)},Br=function(T,de,we){if(zt&&(de==="id"||de==="name")&&(we in r||we in br))return!1;if(!(be&&!ie[de]&&Ft(se,de))){if(!(Fe&&Ft(le,de))){if(!(Ne.attributeCheck instanceof Function&&Ne.attributeCheck(de,T))){if(!fe[de]||ie[de]){if(!(_s(T)&&(Ee.tagNameCheck instanceof RegExp&&Ft(Ee.tagNameCheck,T)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(T))&&(Ee.attributeNameCheck instanceof RegExp&&Ft(Ee.attributeNameCheck,de)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(de,T))||de==="is"&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&Ft(Ee.tagNameCheck,we)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(we))))return!1}else if(!En[de]){if(!Ft($,Xa(we,Q,""))){if(!((de==="src"||de==="xlink:href"||de==="href")&&T!=="script"&&_g(we,"data:")===0&&rn[T])){if(!(lt&&!Ft(ue,Xa(we,Q,"")))){if(we)return!1}}}}}}}return!0},_s=function(T){return T!=="annotation-xml"&&Wi(T,ee)},Rn=function(T){Lt(ve.beforeSanitizeAttributes,T,null);const{attributes:de}=T;if(!de||La(T))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:fe,forceKeepAttr:void 0};let $e=de.length;for(;$e--;){const it=de[$e],{name:ht,namespaceURI:bt,value:Wt}=it,Un=yt(ht),zr=Wt;let ct=ht==="value"?zr:wg(zr);if(we.attrName=Un,we.attrValue=ct,we.keepAttr=!0,we.forceKeepAttr=void 0,Lt(ve.uponSanitizeAttribute,T,we),ct=we.attrValue,Mr&&(Un==="id"||Un==="name")&&(pn(ht,T),ct=Fn+ct),en&&Ft(/((--!?|])>)|<\/(style|title|textarea)/i,ct)){pn(ht,T);continue}if(Un==="attributename"&&Wi(ct,"href")){pn(ht,T);continue}if(we.forceKeepAttr)continue;if(!we.keepAttr){pn(ht,T);continue}if(!Ke&&Ft(/\/>/i,ct)){pn(ht,T);continue}ut&&Ks([ae,ne,qe],Fr=>{ct=Xa(ct,Fr," ")});const Na=yt(T.nodeName);if(!Br(Na,Un,ct)){pn(ht,T);continue}if(U&&typeof w=="object"&&typeof w.getAttributeType=="function"&&!bt)switch(w.getAttributeType(Na,Un)){case"TrustedHTML":{ct=U.createHTML(ct);break}case"TrustedScriptURL":{ct=U.createScriptURL(ct);break}}if(ct!==zr)try{bt?T.setAttributeNS(bt,ht,ct):T.setAttribute(ht,ct),La(T)?hn(T):$l(e.removed)}catch{pn(ht,T)}}Lt(ve.afterSanitizeAttributes,T,null)},ws=function Me(T){let de=null;const we=jr(T);for(Lt(ve.beforeSanitizeShadowDOM,T,null);de=we.nextNode();)Lt(ve.uponSanitizeShadowNode,de,null),In(de),Rn(de),de.content instanceof o&&Me(de.content);Lt(ve.afterSanitizeShadowDOM,T,null)};return e.sanitize=function(Me){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},de=null,we=null,$e=null,it=null;if(er=!Me,er&&(Me="<!-->"),typeof Me!="string"&&!Cn(Me))if(typeof Me.toString=="function"){if(Me=Me.toString(),typeof Me!="string")throw Za("dirty is not a string, aborting")}else throw Za("toString is not a function");if(!e.isSupported)return Me;if(Or||Lr(T),e.removed=[],typeof Me=="string"&&(tn=!1),tn){if(Me.nodeName){const Wt=yt(Me.nodeName);if(!he[Wt]||pe[Wt])throw Za("root node is forbidden and cannot be sanitized in-place")}}else if(Me instanceof d)de=qr("<!---->"),we=de.ownerDocument.importNode(Me,!0),we.nodeType===$a.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?de=we:de.appendChild(we);else{if(!Sn&&!ut&&!At&&Me.indexOf("<")===-1)return U&&zn?U.createHTML(Me):Me;if(de=qr(Me),!de)return Sn?null:zn?X:""}de&&Dr&&hn(de.firstChild);const ht=jr(tn?Me:de);for(;$e=ht.nextNode();)In($e),Rn($e),$e.content instanceof o&&ws($e.content);if(tn)return Me;if(Sn){if(vr)for(it=ge.call(de.ownerDocument);de.firstChild;)it.appendChild(de.firstChild);else it=de;return(fe.shadowroot||fe.shadowrootmode)&&(it=_e.call(s,it,!0)),it}let bt=At?de.outerHTML:de.innerHTML;return At&&he["!doctype"]&&de.ownerDocument&&de.ownerDocument.doctype&&de.ownerDocument.doctype.name&&Ft(Hc,de.ownerDocument.doctype.name)&&(bt="<!DOCTYPE "+de.ownerDocument.doctype.name+`>
`+bt),ut&&Ks([ae,ne,qe],Wt=>{bt=Xa(bt,Wt," ")}),U&&zn?U.createHTML(bt):bt},e.setConfig=function(){let Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lr(Me),Or=!0},e.clearConfig=function(){yr=null,Or=!1},e.isValidAttribute=function(Me,T,de){yr||Lr({});const we=yt(Me),$e=yt(T);return Br(we,$e,de)},e.addHook=function(Me,T){typeof T=="function"&&Qa(ve[Me],T)},e.removeHook=function(Me,T){if(T!==void 0){const de=yg(ve[Me],T);return de===-1?void 0:bg(ve[Me],de,1)[0]}return $l(ve[Me])},e.removeHooks=function(Me){ve[Me]=[]},e.removeAllHooks=function(){ve=su()},e}var Ng=Wc();function qg(t){const e=[];e.push(`# ${t.subject}`),e.push(""),e.push("| | |"),e.push("|---|---|"),e.push(`| **From** | ${iu(t.from)} |`),e.push(`| **To** | ${iu(t.to)} |`),e.push(`| **Date** | ${qo(t.date)} |`),e.push(""),e.push("---"),e.push("");const r=t.htmlBody?jg(t.htmlBody):null;return e.push(r||t.body||"*(no body)*"),e.push(""),e.join(`
`)}function iu(t){return(t||"").replace(/\|/g,"\\|")}function jg(t){try{const e=new DOMParser().parseFromString(t,"text/html");for(const r of e.querySelectorAll("style, script, head"))r.remove();return _o(e.body).replace(/\n{3,}/g,`

`).trim()}catch{return null}}function Bg(t,e){if(!e||e.startsWith("data:"))return!0;const r=parseInt(t.getAttribute("width"),10),s=parseInt(t.getAttribute("height"),10);if(r>0&&r<=3||s>0&&s<=3)return!0;const i=e.toLowerCase();return i.includes("spacer")||i.includes("transparent")||i.includes("transp.gif")||i.includes("/track")&&i.includes("pixel")||/amazon\.com\/gp\/r\.html\?/.test(e)||/[?&](open|track|beacon|pixel|img)=/i.test(i)?!0:i.includes("mail.google.com/mail/u/")&&i.includes("view=fimg")?!1:!!(/ci\d+\.\w+\.com\//.test(i)||i.endsWith(".gif")&&i.includes("1x1"))}function _o(t){var i;if(t.nodeType===3)return t.textContent.replace(/[ \t]+/g," ");if(t.nodeType!==1)return"";const e=t.tagName.toLowerCase();if(e==="br")return`
`;if(e==="hr")return`

---

`;if(e==="img"){const o=t.getAttribute("src")||"",c=t.getAttribute("alt")||"";return Bg(t,o)?"":`![${c}](${o})`}const r=Array.from(t.childNodes).map(_o).join(""),s=r.trim();if(!s&&!["img","br","hr"].includes(e))return r;if(e==="p"||e==="div")return`

${s}

`;if(e==="blockquote")return`

> ${s.replace(/\n/g,`
> `)}

`;if(/^h[1-6]$/.test(e)){const o=Number(e[1]);return`

${"#".repeat(o)} ${s}

`}if(e==="ul"||e==="ol")return`

${r}

`;if(e==="li")return`${((i=t.parentElement)==null?void 0:i.tagName.toLowerCase())==="ol"?"1.":"-"} ${s}
`;if(e==="a"){const o=t.getAttribute("href")||"";return!o||o.startsWith("mailto:")?s:s===o?o:`[${s}](${o})`}if(e==="strong"||e==="b")return`**${s}**`;if(e==="em"||e==="i")return`*${s}*`;if(e==="code")return`\`${s}\``;if(e==="table")return`

${r}

`;if(e==="tr")return`| ${Array.from(t.children).map(c=>_o(c).trim()).join(" | ")} |
`;if(e==="td"||e==="th")return r;if(e==="thead"){const o=r.trim(),c=(o.match(/\|/g)||[]).length-1,d="| "+Array(Math.max(c,1)).fill("---").join(" | ")+" |";return`${o}${d}
`}return r}function zg(t){return mc(t,"md")}function ou(t,e,r="text/markdown;charset=utf-8"){const s=new Blob([t],{type:r}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}function Fg(t){return t.raw||null}function Kg(t){const e=Fg(t);return e?JSON.stringify(e,null,2):"null"}function Ug(t){return mc(t,"json")}var Gg=H('<button title="View as Markdown">.md</button>'),Hg=H('<div class="md-toolbar svelte-1b0rzpb"><span class="toolbar-label svelte-1b0rzpb">JSON</span> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .json file">Download</button></div> <div class="md-body svelte-1b0rzpb"><pre class="md-raw svelte-1b0rzpb"> </pre></div>',1),Wg=H('<pre class="md-raw svelte-1b0rzpb"> </pre>'),Yg=H('<div class="md-preview svelte-1b0rzpb"><!></div>'),Vg=H('<div class="md-toolbar svelte-1b0rzpb"><div class="md-tabs svelte-1b0rzpb"><button>Raw</button> <button>Preview</button></div> <button class="action-btn download-btn svelte-1b0rzpb" title="Download .md file">Download</button></div> <div class="md-body svelte-1b0rzpb"><!></div>',1),Qg=H('<div class="loading-state svelte-1b0rzpb"><span class="spinner svelte-1b0rzpb"></span> <span>Loading message...</span></div>'),Xg=H('<iframe class="html-frame svelte-1b0rzpb" sandbox="allow-same-origin" title="Email content"></iframe>'),Zg=H('<pre class="message-text svelte-1b0rzpb"> </pre>'),Jg=H('<p class="empty-body svelte-1b0rzpb">Loading...</p>'),$g=H('<div class="modal-meta svelte-1b0rzpb"><div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">From:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">To:</span> <span> </span></div> <div class="meta-row svelte-1b0rzpb"><span class="meta-label svelte-1b0rzpb">Date:</span> <span> </span></div></div> <div class="modal-body svelte-1b0rzpb"><!></div>',1),em=H('<div class="modal-overlay svelte-1b0rzpb" role="dialog" aria-modal="true"><div class="modal-content svelte-1b0rzpb" role="document"><div class="modal-header svelte-1b0rzpb"><h3 class="modal-subject svelte-1b0rzpb"> </h3> <div class="header-actions svelte-1b0rzpb"><button title="View as JSON">.json</button> <!> <button class="modal-close svelte-1b0rzpb">â</button></div></div> <!></div></div>');function tm(t,e){ft(e,!0);let r=Ie(e,"loading",3,!1);Mt(()=>fn("MessageModal"));const s=new nt.Renderer;s.link=({href:ae,title:ne,text:qe})=>{const se=ne?` title="${ne}"`:"";return`<a href="${ae}"${se} target="_blank" rel="noopener">${qe}</a>`},nt.setOptions({breaks:!0,gfm:!0,renderer:s});let i=Oe("email"),o=vt(()=>e.message.body?qg(e.message):""),c=vt(()=>Kg(e.message)),d=Oe("raw");function v(ae){B(i,b(i)===ae?"email":ae,!0),ae==="markdown"&&B(d,"raw")}function p(){ou(b(o),zg(e.message))}function y(){ou(b(c),Ug(e.message),"application/json;charset=utf-8")}function x(ae){const ne=nt.parse(ae);return Ng.sanitize(ne,{ADD_ATTR:["target"],ALLOW_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","blockquote","pre","code","strong","b","em","i","a","img","ul","ol","li","table","thead","tbody","tr","th","td","del","s"]})}let _=Oe(null);$s(()=>{var ae;if(b(_)&&e.message.htmlBody&&!r()&&b(i)==="email"){const ne=b(_).contentDocument||((ae=b(_).contentWindow)==null?void 0:ae.document);ne&&(ne.open(),ne.write(`
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="utf-8">
            <style>
              body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                color: #e0e0e0;
                background: #1a1a1a;
                margin: 0;
                padding: 16px;
                word-break: break-word;
              }
              a { color: #60a5fa; }
              img { max-width: 100%; height: auto; }
              table { border-collapse: collapse; max-width: 100%; }
              td, th { padding: 4px 8px; }
            </style>
          </head>
          <body>${e.message.htmlBody}</body>
          </html>
        `),ne.close())}});var w=em();w.__click=function(...ae){var ne;(ne=e.onclose)==null||ne.apply(this,ae)};var M=k(w);M.__click=ae=>ae.stopPropagation();var q=k(M),S=k(q),F=k(S),te=D(S,2),G=k(te);let U;G.__click=()=>v("json");var X=D(G,2);{var J=ae=>{var ne=Gg();let qe;ne.__click=()=>v("markdown"),ye(()=>qe=Zt(ne,1,"action-btn svelte-1b0rzpb",null,qe,{active:b(i)==="markdown"})),K(ae,ne)};Se(X,ae=>{e.message.body&&ae(J)})}var Y=D(X,2);Y.__click=function(...ae){var ne;(ne=e.onclose)==null||ne.apply(this,ae)};var ge=D(q,2);{var Le=ae=>{var ne=Hg(),qe=gt(ne),se=D(k(qe),2);se.__click=y;var le=D(qe,2),ue=k(le),Q=k(ue);ye(()=>re(Q,b(c))),K(ae,ne)},_e=ae=>{var ne=Vg(),qe=gt(ne),se=k(qe),le=k(se);let ue;le.__click=()=>B(d,"raw");var Q=D(le,2);let ee;Q.__click=()=>B(d,"preview");var $=D(se,2);$.__click=p;var he=D(qe,2),Z=k(he);{var fe=Ee=>{var pe=Wg(),ie=k(pe);ye(()=>re(ie,b(o))),K(Ee,pe)},Ae=Ee=>{var pe=Yg(),ie=k(pe);jd(ie,()=>x(b(o))),K(Ee,pe)};Se(Z,Ee=>{b(d)==="raw"?Ee(fe):Ee(Ae,!1)})}ye(()=>{ue=Zt(le,1,"md-tab svelte-1b0rzpb",null,ue,{active:b(d)==="raw"}),ee=Zt(Q,1,"md-tab svelte-1b0rzpb",null,ee,{active:b(d)==="preview"})}),K(ae,ne)},ve=ae=>{var ne=$g(),qe=gt(ne),se=k(qe),le=D(k(se),2),ue=k(le),Q=D(se,2),ee=D(k(Q),2),$=k(ee),he=D(Q,2),Z=D(k(he),2),fe=k(Z),Ae=D(qe,2),Ee=k(Ae);{var pe=be=>{var lt=Qg();K(be,lt)},ie=be=>{var lt=Xg();lo(lt,Ke=>B(_,Ke),()=>b(_)),K(be,lt)},Ne=be=>{var lt=Zg(),Ke=k(lt);ye(()=>re(Ke,e.message.body)),K(be,lt)},Fe=be=>{var lt=Jg();K(be,lt)};Se(Ee,be=>{r()?be(pe):e.message.htmlBody?be(ie,1):e.message.body?be(Ne,2):be(Fe,!1)})}ye(be=>{re(ue,e.message.from),re($,e.message.to),re(fe,be)},[()=>qo(e.message.date)]),K(ae,ne)};Se(ge,ae=>{b(i)==="json"?ae(Le):b(i)==="markdown"?ae(_e,1):ae(ve,!1)})}ye(()=>{re(F,e.message.subject),U=Zt(G,1,"action-btn svelte-1b0rzpb",null,U,{active:b(i)==="json"})}),K(t,w),dt()}Bt(["click"]);var nm=H('<div class="load-more svelte-6ts5xm"><button class="btn svelte-6ts5xm"> </button></div>'),rm=H('<div class="list-header svelte-6ts5xm"><span class="list-count svelte-6ts5xm"> </span></div> <!> <!>',1),am=H('<div class="loading-state svelte-6ts5xm"><span class="spinner svelte-6ts5xm"></span> <span>Loading messages...</span></div>'),sm=H("<p> </p>"),im=H('<p>No emails in local storage. Click "Sync New" to download.</p>'),om=H('<div class="empty-state svelte-6ts5xm"><!></div>'),lm=H('<div class="empty-state svelte-6ts5xm"><p>Sync your emails to browse them locally.</p></div>'),um=H('<div class="main-content svelte-6ts5xm"><!> <!> <!> <div class="toolbar svelte-6ts5xm"><input type="text" class="search-input svelte-6ts5xm" placeholder="Search stored emails (subject, sender, snippet)..."/> <button class="btn primary svelte-6ts5xm"> </button></div> <!></div> <!>',1);function cm(t,e){ft(e,!0),Mt(()=>fn("DashboardView"));let r=Ie(e,"error",3,null),s=Ie(e,"profile",3,null),i=Ie(e,"loadingProfile",3,!1),o=Ie(e,"emailMessages",19,()=>[]),c=Ie(e,"totalLocalMessages",3,0),d=Ie(e,"hasMoreLocal",3,!1),v=Ie(e,"loadingMessages",3,!1),p=Ie(e,"selectedMessage",3,null),y=Ie(e,"syncStatus",3,null),x=Ie(e,"syncProgress",3,null),_=Ie(e,"isSyncing",3,!1),w=Ie(e,"searchQuery",15);var M=um(),q=gt(M),S=k(q);{var F=se=>{Rc(se,{get error(){return r()},get ondismiss(){return e.ondismisserror},get onsignout(){return e.onsignout}})};Se(S,se=>{r()&&se(F)})}var te=D(S,2);uv(te,{get profile(){return s()},get loadingProfile(){return i()},get onsignout(){return e.onsignout}});var G=D(te,2);kv(G,{get syncStatus(){return y()},get syncProgress(){return x()},get isSyncing(){return _()},get onsync(){return e.onsync},get onsyncmore(){return e.onsyncmore},get onclear(){return e.oncleardata}});var U=D(G,2),X=k(U);X.__keydown=se=>se.key==="Enter"&&e.onsearch();var J=D(X,2);J.__click=function(...se){var le;(le=e.onsearch)==null||le.apply(this,se)};var Y=k(J),ge=D(U,2);{var Le=se=>{var le=rm(),ue=gt(le),Q=k(ue),ee=k(Q),$=D(ue,2);Ev($,{get messages(){return o()},get onselect(){return e.onviewmessage}});var he=D($,2);{var Z=fe=>{var Ae=nm(),Ee=k(Ae);Ee.__click=function(...ie){var Ne;(Ne=e.onloadmore)==null||Ne.apply(this,ie)};var pe=k(Ee);ye(()=>{Ee.disabled=v(),re(pe,v()?"Loading...":"Load More")}),K(fe,Ae)};Se(he,fe=>{d()&&fe(Z)})}ye(fe=>re(ee,`Showing ${o().length??""} of ${fe??""}
        ${w()?" matching":""} emails`),[()=>c().toLocaleString()]),K(se,le)},_e=se=>{var le=am();K(se,le)},ve=se=>{var le=om(),ue=k(le);{var Q=$=>{var he=sm(),Z=k(he);ye(()=>re(Z,`No emails match "${w()??""}".`)),K($,he)},ee=$=>{var he=im();K($,he)};Se(ue,$=>{w()?$(Q):$(ee,!1)})}K(se,le)},ae=se=>{var le=lm();K(se,le)};Se(ge,se=>{var le;o().length>0?se(Le):v()?se(_e,1):(le=y())!=null&&le.synced?se(ve,2):se(ae,!1)})}var ne=D(q,2);{var qe=se=>{tm(se,{get message(){return p()},loading:!1,get onclose(){return e.onclosedetail}})};Se(ne,se=>{p()&&se(qe)})}ye(()=>{J.disabled=v(),re(Y,v()?"Searching...":"Search")}),Lo(X,w),K(t,M),dt()}Bt(["keydown","click"]);var fm=H('<div class="dashboard svelte-1q5o2lv"><!></div>');function dm(t,e){ft(e,!0);function r(ie){ie.key==="Escape"&&b(v)&&ue()}Mt(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)));let s=Oe(Rt(localStorage.getItem("googleClientId")||"")),i=Oe(Rt(localStorage.getItem("googleClientId")||"")),o=Oe(!1),c=Oe(null),d=Oe(null),v=Oe(null),p=Oe(""),y=Oe(Rt([])),x=Oe(0),_=Oe(0),w=Oe(!1),M=Oe(!1),q=Oe(!1),S=Oe(null),F=Oe(null),te=Oe(null),G=Oe(!1);const U=50;$s(()=>{b(c)&&(Q(),ne())});let X=vt(()=>!b(s)),J=vt(()=>!!b(c)),Y=vt(()=>b(y).length<b(x));$s(()=>{b(s)&&!b(o)&&Gl(b(s)).then(()=>{B(o,!0)}).catch(ie=>{B(S,`Auth init failed: ${ie.message}`)})});function ge(){const ie=b(i).trim();ie&&(localStorage.setItem("googleClientId",ie),B(s,ie,!0),B(S,null))}function Le(){localStorage.removeItem("googleClientId"),B(s,""),B(i,""),B(o,!1),B(c,null),B(d,null),B(y,[],!0),B(x,0)}async function _e(){B(S,null),B(M,!0);try{b(o)||(await Gl(b(s)),B(o,!0));const ie=await qp();B(c,ie.access_token,!0),await ae()}catch(ie){B(S,ie.message,!0)}finally{B(M,!1)}}async function ve(){if(b(c))try{await jp(b(c))}catch{}B(c,null),B(d,null),B(y,[],!0),B(x,0),B(v,null),B(S,null)}async function ae(){B(q,!0);try{const ie=await dc(b(c));if(!b(c))return;B(d,ie,!0)}catch(ie){if(!b(c))return;B(S,`Profile fetch failed: ${ie.message}`)}finally{B(q,!1)}}async function ne(ie=!1){B(w,!0);try{const Ne=ie?b(_):0,Fe=await dh({query:b(p)||void 0,limit:U,offset:Ne});ie?B(y,[...b(y),...Fe.items],!0):B(y,Fe.items,!0),B(x,Fe.total,!0),B(_,b(y).length,!0)}catch(Ne){B(S,`Failed to load messages: ${Ne.message}`)}finally{B(w,!1)}}function qe(){B(_,0),ne(!1)}function se(){ne(!0)}function le(ie){B(v,ie,!0)}function ue(){B(v,null)}async function Q(){try{B(F,await Fp(),!0)}catch{}}async function ee(ie){if(b(G)||!b(c))return;B(S,null),B(G,!0),B(te,null);const Ne=new AbortController;try{await Bp(b(c),{limit:ie,onProgress:Fe=>{B(te,{...Fe},!0)},signal:Ne.signal}),await Q(),await ne(!1)}catch(Fe){if(Fe.name!=="AbortError"){if(!b(c))return;B(S,`Sync failed: ${Fe.message}`)}}finally{B(G,!1)}}async function $(ie){if(b(G)||!b(c))return;B(S,null),B(G,!0),B(te,null);const Ne=new AbortController;try{await zp(b(c),{limit:ie,onProgress:Fe=>{B(te,{...Fe},!0)},signal:Ne.signal}),await Q(),await ne(!1)}catch(Fe){if(Fe.name!=="AbortError"){if(!b(c))return;B(S,`Sync more failed: ${Fe.message}`)}}finally{B(G,!1)}}async function he(){try{await Kp(),await Q(),B(y,[],!0),B(x,0),B(_,0)}catch(ie){B(S,`Failed to clear data: ${ie.message}`)}}var Z=fm(),fe=k(Z);{var Ae=ie=>{Vp(ie,{onsave:ge,get clientIdInput(){return b(i)},set clientIdInput(Ne){B(i,Ne,!0)}})},Ee=ie=>{sv(ie,{get clientId(){return b(s)},get error(){return b(S)},get loadingAuth(){return b(M)},onsignin:_e,onclear:Le,onsignout:ve})},pe=ie=>{cm(ie,{get error(){return b(S)},get profile(){return b(d)},get loadingProfile(){return b(q)},get emailMessages(){return b(y)},get totalLocalMessages(){return b(x)},get hasMoreLocal(){return b(Y)},get loadingMessages(){return b(w)},get selectedMessage(){return b(v)},get syncStatus(){return b(F)},get syncProgress(){return b(te)},get isSyncing(){return b(G)},onsignout:ve,onsearch:qe,onloadmore:se,onviewmessage:le,onclosedetail:ue,ondismisserror:()=>B(S,null),onsync:ee,onsyncmore:$,oncleardata:he,get searchQuery(){return b(p)},set searchQuery(Ne){B(p,Ne,!0)}})};Se(fe,ie=>{b(X)?ie(Ae):b(J)?ie(pe,!1):ie(Ee,1)})}K(t,Z),dt()}var hm=H('<span class="spinner svelte-ois7em"></span>'),pm=Do('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-ois7em"><circle cx="11" cy="11" r="8" class="svelte-ois7em"></circle><path d="m21 21-4.35-4.35" class="svelte-ois7em"></path></svg>'),vm=H('<div class="scan-stats svelte-ois7em"><span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span> <span class="stat-sep svelte-ois7em">Â·</span> <span class="stat svelte-ois7em"> </span></div>'),gm=H('<option class="svelte-ois7em"> </option>'),mm=H('<p class="scan-hint svelte-ois7em">Load a model on the Chat page first, then come back to scan.</p>'),ym=H('<div class="scan-progress svelte-ois7em"><div class="progress-bar svelte-ois7em"><div></div></div> <span class="progress-text svelte-ois7em"> </span></div>'),bm=H('<div class="scan-card svelte-ois7em"><div class="scan-header svelte-ois7em"><div class="scan-icon svelte-ois7em"><!></div> <div class="scan-info svelte-ois7em"><span class="scan-title svelte-ois7em">Email Triage</span> <span class="scan-status svelte-ois7em"><span class="status-dot svelte-ois7em"></span> </span></div></div> <!> <div class="scan-controls svelte-ois7em"><div class="control-group svelte-ois7em"><label class="control-label svelte-ois7em" for="scan-count">Emails:</label> <select id="scan-count" class="control-select svelte-ois7em"></select></div> <div class="btn-group svelte-ois7em"><button class="btn scan-btn primary svelte-ois7em"> </button> <button class="btn scan-btn svelte-ois7em" title="Rescan all (including already classified)">Rescan All</button></div></div> <!> <!></div>');function _m(t,e){ft(e,!0);let r=Ie(e,"engineStatus",3,"idle"),s=Ie(e,"modelName",3,""),i=Ie(e,"isScanning",3,!1),o=Ie(e,"scanProgress",3,null),c=Ie(e,"scanCount",15,20),d=Ie(e,"stats",3,null);const v=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:500,label:"500"}];function p(){return r()==="ready"?`${s()} ready`:r()==="loading"?"Loading model...":r()==="generating"?"Model busy...":"No model loaded"}function y(){return r()==="ready"?"#34d399":r()==="loading"?"#fbbf24":"#666"}function x(){return r()==="ready"&&!i()}var _=bm(),w=k(_),M=k(w),q=k(M);{var S=$=>{var he=hm();K($,he)},F=$=>{var he=pm();K($,he)};Se(q,$=>{i()?$(S):$(F,!1)})}var te=D(M,2),G=D(k(te),2),U=k(G);let X;var J=D(U),Y=D(w,2);{var ge=$=>{var he=vm(),Z=k(he),fe=k(Z),Ae=D(Z,4),Ee=k(Ae),pe=D(Ae,4),ie=k(pe);ye(()=>{re(fe,`${d().totalEmails??""} emails in storage`),re(Ee,`${d().classified??""} classified`),re(ie,`${d().unclassified??""} new`)}),K($,he)};Se(Y,$=>{d()&&$(ge)})}var Le=D(Y,2),_e=k(Le),ve=D(k(_e),2);Ut(ve,21,()=>v,pr,($,he)=>{var Z=gm(),fe=k(Z),Ae={};ye(()=>{re(fe,b(he).label),Ae!==(Ae=b(he).value)&&(Z.value=(Z.__value=b(he).value)??"")}),K($,Z)});var ae=D(_e,2),ne=k(ae);ne.__click=function(...$){var he;(he=e.onscan)==null||he.apply(this,$)};var qe=k(ne),se=D(ne,2);se.__click=function(...$){var he;(he=e.onrescan)==null||he.apply(this,$)};var le=D(Le,2);{var ue=$=>{var he=mm();K($,he)};Se(le,$=>{r()!=="ready"&&r()!=="loading"&&$(ue)})}var Q=D(le,2);{var ee=$=>{var he=ym(),Z=k(he),fe=k(Z);let Ae,Ee;var pe=D(Z,2),ie=k(pe);ye(()=>{Ae=Zt(fe,1,"progress-fill svelte-ois7em",null,Ae,{indeterminate:!o().total}),Ee=$t(fe,"",Ee,{width:`${o().total?o().current/o().total*100:0}%`}),re(ie,o().message||"Scanning...")}),K($,he)};Se(Q,$=>{i()&&o()&&$(ee)})}ye(($,he,Z,fe)=>{X=$t(U,"",X,$),re(J,` ${he??""}`),ve.disabled=i(),ne.disabled=Z,re(qe,i()?"Scanning...":"Scan New"),se.disabled=fe},[()=>({background:y()}),p,()=>!x(),()=>!x()]),Mo(ve,c),K(t,_),dt()}Bt(["click"]);var wm=H('<span class="row-date svelte-1czytqk"> </span>'),km=H('<span class="tag svelte-1czytqk"> </span>'),xm=H('<span class="row-tags svelte-1czytqk"></span>'),Sm=H('<span class="row-reason svelte-1czytqk"> </span>'),Em=H('<button class="icon-btn done-btn svelte-1czytqk" title="Mark handled"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></button> <button class="icon-btn dismiss-btn svelte-1czytqk" title="Dismiss"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>',1),Tm=H('<span class="status-label svelte-1czytqk"> </span>'),Am=H('<button class="icon-btn remove-btn svelte-1czytqk" title="Remove classification"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"></path><path d="M8 6V4h8v2"></path><path d="m19 6-.867 12.142A2 2 0 0 1 16.138 20H7.862a2 2 0 0 1-1.995-1.858L5 6"></path></svg></button>'),Cm=H('<p class="summary-reason svelte-1czytqk"> </p>'),Im=H('<div class="summary-panel svelte-1czytqk"><p class="summary-text svelte-1czytqk"> </p> <!></div>'),Rm=H('<div><button class="row-left svelte-1czytqk"><span class="row-subject svelte-1czytqk"> </span> <span class="row-meta svelte-1czytqk"><span class="row-from svelte-1czytqk"> </span> <!></span> <!> <!></button> <div class="row-actions svelte-1czytqk"><!> <!></div></div> <!>',1);function lu(t,e){ft(e,!0);let r=Ie(e,"actionColor",3,"#666"),s=Ie(e,"dimmed",3,!1);function i(se){if(!se)return"";try{return new Date(se).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return""}}let o=vt(()=>e.item.status==="pending"),c=Oe(!1);var d=Rm(),v=gt(d);let p;var y=k(v);y.__click=()=>B(c,!b(c));let x;var _=k(y),w=k(_),M=D(_,2),q=k(M),S=k(q),F=D(q,2);{var te=se=>{var le=wm(),ue=k(le);ye(Q=>re(ue,Q),[()=>i(e.item.date)]),K(se,le)};Se(F,se=>{e.item.date&&se(te)})}var G=D(M,2);{var U=se=>{var le=xm();Ut(le,21,()=>e.item.tags,pr,(ue,Q)=>{var ee=km();let $;var he=k(ee);ye(Z=>{$=$t(ee,"",$,Z),re(he,b(Q))},[()=>({background:Sc(b(Q))})]),K(ue,ee)}),K(se,le)};Se(G,se=>{e.item.tags&&e.item.tags.length>0&&se(U)})}var X=D(G,2);{var J=se=>{var le=Sm(),ue=k(le);ye(()=>re(ue,e.item.reason)),K(se,le)};Se(X,se=>{e.item.reason&&!b(c)&&se(J)})}var Y=D(y,2),ge=k(Y);{var Le=se=>{var le=Em(),ue=gt(le);ue.__click=()=>e.onmarkacted(e.item.emailId);var Q=D(ue,2);Q.__click=()=>e.ondismiss(e.item.emailId),K(se,le)},_e=se=>{var le=Tm(),ue=k(le);ye(()=>re(ue,e.item.status)),K(se,le)};Se(ge,se=>{b(o)?se(Le):se(_e,!1)})}var ve=D(ge,2);{var ae=se=>{var le=Am();le.__click=()=>e.onremove(e.item.emailId),K(se,le)};Se(ve,se=>{e.onremove&&se(ae)})}var ne=D(v,2);{var qe=se=>{var le=Im();let ue;var Q=k(le),ee=k(Q),$=D(Q,2);{var he=Z=>{var fe=Cm(),Ae=k(fe);ye(()=>re(Ae,e.item.reason)),K(Z,fe)};Se($,Z=>{e.item.reason&&Z(he)})}ye(()=>{ue=$t(le,"",ue,{"border-left-color":r()}),re(ee,e.item.summary)}),K(se,le)};Se(ne,se=>{b(c)&&e.item.summary&&se(qe)})}ye(()=>{p=Zt(v,1,"email-row svelte-1czytqk",null,p,{dimmed:s()}),x=$t(y,"",x,{"border-left-color":r()}),re(w,e.item.subject),re(S,e.item.from)}),K(t,d),dt()}Bt(["click"]);var Pm=H('<span class="group-acted svelte-tl1unp"> </span>'),Om=H('<p class="group-empty svelte-tl1unp">No emails in this category.</p>'),Dm=H('<details class="handled-section svelte-tl1unp"><summary class="handled-summary svelte-tl1unp"> </summary> <!></details>'),Mm=H('<button class="group-action-btn svelte-tl1unp">Clear group</button>'),Lm=H('<span class="confirm-row svelte-tl1unp"> <button class="group-action-btn svelte-tl1unp">Cancel</button> <button class="group-action-btn danger svelte-tl1unp">Delete</button></span>'),Nm=H('<div class="group-body svelte-tl1unp"><!> <!> <!> <div class="group-footer svelte-tl1unp"><!></div></div>'),qm=H('<div class="action-group svelte-tl1unp"><button class="group-header svelte-tl1unp"><span class="group-badge svelte-tl1unp"> </span> <span class="group-count svelte-tl1unp"> </span> <!> <span class="spacer svelte-tl1unp"></span> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg></button> <!></div>');function jm(t,e){ft(e,!0);let r=Ie(e,"color",3,"#888");Ie(e,"count",3,0);let s=Ie(e,"items",19,()=>[]),i=Ie(e,"expanded",3,!1),o=vt(()=>s().filter(J=>J.status==="pending")),c=vt(()=>s().filter(J=>J.status!=="pending")),d=Oe(!1);function v(J){return J.split("_").map(Y=>Y.charAt(0)+Y.slice(1).toLowerCase()).join(" ")}var p=qm(),y=k(p);y.__click=function(...J){var Y;(Y=e.ontoggle)==null||Y.apply(this,J)};var x=k(y);let _;var w=k(x),M=D(x,2),q=k(M),S=D(M,2);{var F=J=>{var Y=Pm(),ge=k(Y);ye(()=>re(ge,`${b(c).length??""} handled`)),K(J,Y)};Se(S,J=>{b(c).length>0&&J(F)})}var te=D(S,4);let G;var U=D(y,2);{var X=J=>{var Y=Nm(),ge=k(Y);{var Le=ue=>{var Q=Om();K(ue,Q)};Se(ge,ue=>{b(o).length===0&&b(c).length===0&&ue(Le)})}var _e=D(ge,2);Ut(_e,17,()=>b(o),ue=>ue.emailId,(ue,Q)=>{lu(ue,{get item(){return b(Q)},get actionColor(){return r()},get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove}})});var ve=D(_e,2);{var ae=ue=>{var Q=Dm(),ee=k(Q),$=k(ee),he=D(ee,2);Ut(he,17,()=>b(c),Z=>Z.emailId,(Z,fe)=>{lu(Z,{get item(){return b(fe)},get actionColor(){return r()},get onremove(){return e.onremove},dimmed:!0})}),ye(()=>re($,`${b(c).length??""} handled`)),K(ue,Q)};Se(ve,ue=>{b(c).length>0&&ue(ae)})}var ne=D(ve,2),qe=k(ne);{var se=ue=>{var Q=Mm();Q.__click=()=>B(d,!0),K(ue,Q)},le=ue=>{var Q=Lm(),ee=k(Q),$=D(ee);$.__click=()=>B(d,!1);var he=D($,2);he.__click=()=>{e.oncleargroup(),B(d,!1)},ye(()=>re(ee,`Clear ${s().length??""} items? `)),K(ue,Q)};Se(qe,ue=>{b(d)?ue(le,!1):ue(se)})}K(J,Y)};Se(U,J=>{i()&&J(X)})}ye(J=>{_=$t(x,"",_,{background:r()}),re(w,J),re(q,b(o).length),G=Zt(te,0,"chevron svelte-tl1unp",null,G,{open:i()})},[()=>v(e.action)]),K(t,p),dt()}Bt(["click"]);var Bm=H('<div class="error-card svelte-12gkq0i"><span> </span> <button class="error-dismiss svelte-12gkq0i">â</button></div>'),zm=H('<button class="btn-link danger svelte-12gkq0i">Clear all</button>'),Fm=H('<span class="clear-confirm svelte-12gkq0i">Clear all classifications? <button class="btn-link svelte-12gkq0i">Cancel</button> <button class="btn-link danger svelte-12gkq0i">Delete</button></span>'),Km=H('<div class="groups-list svelte-12gkq0i"></div> <div class="actions-footer svelte-12gkq0i"><span class="footer-stat svelte-12gkq0i"> </span> <!></div>',1),Um=H('<div class="empty-state svelte-12gkq0i"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.3"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"></path><rect x="9" y="3" width="6" height="4" rx="1"></rect><path d="m9 14 2 2 4-4"></path></svg> <h3 class="svelte-12gkq0i">No emails classified yet</h3> <p class="svelte-12gkq0i">Click <strong>Scan New</strong> to classify your recent emails. The LLM will determine action types, tags, and summaries automatically.</p></div>'),Gm=H('<div class="actions-container svelte-12gkq0i"><!> <!> <!></div>');function Hm(t,e){ft(e,!0);let r=Ie(e,"groups",19,()=>({})),s=Ie(e,"groupOrder",19,()=>[]),i=Ie(e,"counts",19,()=>({})),o=Ie(e,"stats",3,null),c=Ie(e,"expandedGroup",3,null),d=Ie(e,"isScanning",3,!1),v=Ie(e,"scanProgress",3,null),p=Ie(e,"scanCount",15,20),y=Ie(e,"error",3,null),x=Oe(!1);var _=Gm(),w=k(_);_m(w,{get engineStatus(){return e.engineStatus},get modelName(){return e.modelName},get isScanning(){return d()},get scanProgress(){return v()},get stats(){return o()},get onscan(){return e.onscan},get onrescan(){return e.onrescan},get scanCount(){return p()},set scanCount(G){p(G)}});var M=D(w,2);{var q=G=>{var U=Bm(),X=k(U),J=k(X),Y=D(X,2);Y.__click=function(...ge){var Le;(Le=e.ondismisserror)==null||Le.apply(this,ge)},ye(()=>re(J,y())),K(G,U)};Se(M,G=>{y()&&G(q)})}var S=D(M,2);{var F=G=>{var U=Km(),X=gt(U);Ut(X,20,s,ae=>ae,(ae,ne)=>{{let qe=vt(()=>jo(ne)),se=vt(()=>{var Q;return((Q=r()[ne])==null?void 0:Q.length)||0}),le=vt(()=>r()[ne]||[]),ue=vt(()=>c()===ne);jm(ae,{get action(){return ne},get color(){return b(qe)},get count(){return b(se)},get items(){return b(le)},get expanded(){return b(ue)},ontoggle:()=>e.ontogglegroup(ne),get onmarkacted(){return e.onmarkacted},get ondismiss(){return e.ondismiss},get onremove(){return e.onremove},oncleargroup:()=>e.oncleargroup(ne)})}});var J=D(X,2),Y=k(J),ge=k(Y),Le=D(Y,2);{var _e=ae=>{var ne=zm();ne.__click=()=>B(x,!0),K(ae,ne)},ve=ae=>{var ne=Fm(),qe=D(k(ne));qe.__click=()=>B(x,!1);var se=D(qe,2);se.__click=()=>{e.onclear(),B(x,!1)},K(ae,ne)};Se(Le,ae=>{b(x)?ae(ve,!1):ae(_e)})}ye(()=>re(ge,`${i().total??""} emails classified into ${s().length??""} groups`)),K(G,U)},te=G=>{var U=Um();K(G,U)};Se(S,G=>{i().total>0?G(F):d()||G(te,1)})}K(t,_),dt()}Bt(["click"]);var Wm=H('<div class="actions-page svelte-3tch4q"><!></div>');function Ym(t,e){ft(e,!0);const r=lc();let s=Oe(Rt(r.status)),i=Oe(""),o=Oe(Rt({})),c=Oe(Rt([])),d=Oe(Rt({total:0})),v=Oe(null),p=Oe(null),y=Oe(!1),x=Oe(null),_=Oe(20),w=Oe(null);Mt(()=>{const _e=r.onMessage(ve=>{if(ve.status==="ready"){B(s,"ready");const ae=ls.find(ne=>ne.id===r.modelId);B(i,(ae==null?void 0:ae.name)||r.modelId||"",!0)}ve.status==="loading"&&B(s,"loading")});if(B(s,r.status,!0),r.modelId){const ve=ls.find(ae=>ae.id===r.modelId);B(i,(ve==null?void 0:ve.name)||r.modelId||"",!0)}return M(),()=>_e()});async function M(){try{const _e=await mh();B(o,_e.groups,!0),B(c,_e.order,!0),B(d,await yh(),!0),B(v,await fo(),!0)}catch(_e){B(w,`Failed to load data: ${_e.message}`)}}async function q(){await F(!1)}async function S(){await F(!0)}async function F(_e){if(!(b(y)||!r.isReady)){B(w,null),B(y,!0),B(x,null);try{await wc(r,{count:b(_),force:_e,onProgress:ve=>{B(x,{...ve},!0)}}),await M()}catch(ve){B(w,`Scan failed: ${ve.message}`)}finally{B(y,!1)}}}async function te(_e){await ti(_e,"acted"),await M()}async function G(_e){await ti(_e,"dismissed"),await M()}async function U(_e){await xc(_e),await M()}async function X(_e){await kc(_e),await M()}async function J(){await bh(),await M()}function Y(_e){B(p,b(p)===_e?null:_e,!0)}var ge=Wm(),Le=k(ge);Hm(Le,{get engineStatus(){return b(s)},get modelName(){return b(i)},get groups(){return b(o)},get groupOrder(){return b(c)},get counts(){return b(d)},get stats(){return b(v)},get expandedGroup(){return b(p)},get isScanning(){return b(y)},get scanProgress(){return b(x)},get error(){return b(w)},onscan:q,onrescan:S,ontogglegroup:Y,onmarkacted:te,ondismiss:G,onremove:U,oncleargroup:X,onclear:J,ondismisserror:()=>B(w,null),get scanCount(){return b(_)},set scanCount(_e){B(_,_e,!0)}}),K(t,ge),dt()}var Vm=H('<div class="app-shell svelte-1n46o8q"><nav class="top-nav svelte-1n46o8q"><a class="nav-brand svelte-1n46o8q" href="#chat">me-ai</a> <div class="nav-links svelte-1n46o8q"><a href="#chat">Chat</a> <a href="#actions">Actions</a> <a href="#dashboard">Dashboard</a></div></nav> <main class="svelte-1n46o8q"><div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div> <div class="page-view svelte-1n46o8q"><!></div></main></div>');function Qm(t,e){ft(e,!0);function r(){const Y=location.hash;return Y==="#dashboard"?"dashboard":Y==="#actions"?"actions":"chat"}let s=Oe(Rt(r()));Mt(()=>{function Y(){B(s,r(),!0)}return window.addEventListener("hashchange",Y),()=>window.removeEventListener("hashchange",Y)});var i=Vm(),o=k(i),c=D(k(o),2),d=k(c);let v;var p=D(d,2);let y;var x=D(p,2);let _;var w=D(o,2),M=k(w);let q;var S=k(M);Mp(S,{});var F=D(M,2);let te;var G=k(F);Ym(G,{});var U=D(F,2);let X;var J=k(U);dm(J,{}),ye(()=>{v=Zt(d,1,"svelte-1n46o8q",null,v,{active:b(s)==="chat"}),y=Zt(p,1,"svelte-1n46o8q",null,y,{active:b(s)==="actions"}),_=Zt(x,1,"svelte-1n46o8q",null,_,{active:b(s)==="dashboard"}),q=$t(M,"",q,{display:b(s)==="chat"?"flex":"none"}),te=$t(F,"",te,{display:b(s)==="actions"?"flex":"none"}),X=$t(U,"",X,{display:b(s)==="dashboard"?"flex":"none"})}),K(t,i),dt()}Pd(Qm,{target:document.getElementById("app")});
